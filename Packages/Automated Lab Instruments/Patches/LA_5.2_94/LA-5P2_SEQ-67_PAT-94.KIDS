Released LA*5.2*94 SEQ #67
Extracted from mail message
**KIDS**:LA*5.2*94^

**INSTALL NAME**
LA*5.2*94
"BLD",9785,0)
LA*5.2*94^AUTOMATED LAB INSTRUMENTS^0^3160926^y
"BLD",9785,4,0)
^9.64PA^^
"BLD",9785,6.3)
1
"BLD",9785,"ABPKG")
n
"BLD",9785,"KRN",0)
^9.67PA^779.2^20
"BLD",9785,"KRN",.4,0)
.4
"BLD",9785,"KRN",.4,"NM",0)
^9.68A^^
"BLD",9785,"KRN",.401,0)
.401
"BLD",9785,"KRN",.402,0)
.402
"BLD",9785,"KRN",.403,0)
.403
"BLD",9785,"KRN",.5,0)
.5
"BLD",9785,"KRN",.84,0)
.84
"BLD",9785,"KRN",3.6,0)
3.6
"BLD",9785,"KRN",3.8,0)
3.8
"BLD",9785,"KRN",9.2,0)
9.2
"BLD",9785,"KRN",9.8,0)
9.8
"BLD",9785,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9785,"KRN",9.8,"NM",1,0)
LA7UCFG^^0^B137340339
"BLD",9785,"KRN",9.8,"NM","B","LA7UCFG",1)

"BLD",9785,"KRN",19,0)
19
"BLD",9785,"KRN",19,"NM",0)
^9.68A^^
"BLD",9785,"KRN",19.1,0)
19.1
"BLD",9785,"KRN",101,0)
101
"BLD",9785,"KRN",409.61,0)
409.61
"BLD",9785,"KRN",771,0)
771
"BLD",9785,"KRN",779.2,0)
779.2
"BLD",9785,"KRN",870,0)
870
"BLD",9785,"KRN",8989.51,0)
8989.51
"BLD",9785,"KRN",8989.52,0)
8989.52
"BLD",9785,"KRN",8994,0)
8994
"BLD",9785,"KRN","B",.4,.4)

"BLD",9785,"KRN","B",.401,.401)

"BLD",9785,"KRN","B",.402,.402)

"BLD",9785,"KRN","B",.403,.403)

"BLD",9785,"KRN","B",.5,.5)

"BLD",9785,"KRN","B",.84,.84)

"BLD",9785,"KRN","B",3.6,3.6)

"BLD",9785,"KRN","B",3.8,3.8)

"BLD",9785,"KRN","B",9.2,9.2)

"BLD",9785,"KRN","B",9.8,9.8)

"BLD",9785,"KRN","B",19,19)

"BLD",9785,"KRN","B",19.1,19.1)

"BLD",9785,"KRN","B",101,101)

"BLD",9785,"KRN","B",409.61,409.61)

"BLD",9785,"KRN","B",771,771)

"BLD",9785,"KRN","B",779.2,779.2)

"BLD",9785,"KRN","B",870,870)

"BLD",9785,"KRN","B",8989.51,8989.51)

"BLD",9785,"KRN","B",8989.52,8989.52)

"BLD",9785,"KRN","B",8994,8994)

"BLD",9785,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",9785,"QUES",0)
^9.62^^
"BLD",9785,"REQB",0)
^9.611^1^1
"BLD",9785,"REQB",1,0)
LA*5.2*88^2
"BLD",9785,"REQB","B","LA*5.2*88",1)

"MBREQ")
0
"PKG",11,-1)
1^1
"PKG",11,0)
AUTOMATED LAB INSTRUMENTS^LA^Lab Auto-Instrument Package
"PKG",11,20,0)
^9.402P^^
"PKG",11,22,0)
^9.49I^1^1
"PKG",11,22,1,0)
5.2^2940927^2960605
"PKG",11,22,1,"PAH",1,0)
94^3160926
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","LA7UCFG")
0^1^B137340339^B137316017
"RTN","LA7UCFG",1,0)
LA7UCFG ;DALOI/JMC - Configure Lab Universal Interface ;9/26/16  12:13
"RTN","LA7UCFG",2,0)
 ;;5.2;AUTOMATED LAB INSTRUMENTS;**66,88,94**;Sep 27, 1994;Build 1
"RTN","LA7UCFG",3,0)
 ;
"RTN","LA7UCFG",4,0)
 ; ZEXCEPT is used to identify variables which are external to a specific TAG
"RTN","LA7UCFG",5,0)
 ;         used in conjunction with Eclipse M-editor.
"RTN","LA7UCFG",6,0)
 ;
"RTN","LA7UCFG",7,0)
 Q
"RTN","LA7UCFG",8,0)
 ;
"RTN","LA7UCFG",9,0)
EN ; Configure files #62.48 and #62.4 and auto release
"RTN","LA7UCFG",10,0)
 N DIR,DIROUT,DIRUT,DUOUT,LA7QUIT,X,Y
"RTN","LA7UCFG",11,0)
 F  D  Q:$D(DIRUT)
"RTN","LA7UCFG",12,0)
 . S DIR(0)="SO^1:LA7 MESSAGE PARAMETER (#62.48);2:AUTO INSTRUMENT (#62.4);3:Auto Release System Parameter;4:Configuration Report (132 COL);5:Holders of Lab keys;6:Ordering Provider Contact Parameter"
"RTN","LA7UCFG",13,0)
 . S DIR(0)=DIR(0)_";7:Convert LAB UI 1.6 to Enhanced Acknowledgement Mode"
"RTN","LA7UCFG",14,0)
 . S DIR("A")="Select which function to configure/report"
"RTN","LA7UCFG",15,0)
 . D ^DIR
"RTN","LA7UCFG",16,0)
 . I $D(DIRUT) Q
"RTN","LA7UCFG",17,0)
 . I Y=1 D E6248 Q
"RTN","LA7UCFG",18,0)
 . I Y=2 D  Q
"RTN","LA7UCFG",19,0)
 . . S LA7QUIT=0
"RTN","LA7UCFG",20,0)
 . . F  D E624 Q:LA7QUIT
"RTN","LA7UCFG",21,0)
 . I Y=3 D EDITPAR^XPAREDIT("LA UI AUTO RELEASE MASTER") Q
"RTN","LA7UCFG",22,0)
 . I Y=4 D PRINT Q
"RTN","LA7UCFG",23,0)
 . I Y=5 D ENKEY Q
"RTN","LA7UCFG",24,0)
 . I Y=6 D EDITPAR^XPAREDIT("LA UI PROVIDER CONTACT INFO") Q
"RTN","LA7UCFG",25,0)
 . I Y=7 D ENACK^LA7UCFG1 Q
"RTN","LA7UCFG",26,0)
 Q
"RTN","LA7UCFG",27,0)
 ;
"RTN","LA7UCFG",28,0)
 ;
"RTN","LA7UCFG",29,0)
E6248 ; Setup/edit file #62.48
"RTN","LA7UCFG",30,0)
 ;
"RTN","LA7UCFG",31,0)
 N DA,DIC,DIE,DLAYGO,DR,LA76248,X,Y
"RTN","LA7UCFG",32,0)
 W !
"RTN","LA7UCFG",33,0)
 S DIC="^LAHM(62.48,",DIC(0)="AELMQ",DIC("S")="I $P(^(0),U,9)=1",DLAYGO=62.48
"RTN","LA7UCFG",34,0)
 D ^DIC K DIC("S")
"RTN","LA7UCFG",35,0)
 I Y<1 Q
"RTN","LA7UCFG",36,0)
 S (DA,LA76248)=+Y
"RTN","LA7UCFG",37,0)
 L +^LAHM(62.48,LA76248):DILOCKTM
"RTN","LA7UCFG",38,0)
 I '$T W !?5,"Another user is editing this entry." Q
"RTN","LA7UCFG",39,0)
 S DIE=DIC,DR="2;3;4;20"
"RTN","LA7UCFG",40,0)
 D ^DIE
"RTN","LA7UCFG",41,0)
 L -^LAHM(62.48,LA76248)
"RTN","LA7UCFG",42,0)
 Q
"RTN","LA7UCFG",43,0)
 ;
"RTN","LA7UCFG",44,0)
 ;
"RTN","LA7UCFG",45,0)
E624 ; Setup/edit file #62.4
"RTN","LA7UCFG",46,0)
 ;
"RTN","LA7UCFG",47,0)
 N DA,DIC,DIE,DLAYGO,DR,FDA,LA7624,LA76248,LA7ERR,X,Y
"RTN","LA7UCFG",48,0)
 ;
"RTN","LA7UCFG",49,0)
 ;ZEXCEPT: LA7QUIT
"RTN","LA7UCFG",50,0)
 ;
"RTN","LA7UCFG",51,0)
 W !
"RTN","LA7UCFG",52,0)
 S DIC="^LAB(62.4,",DIC(0)="AELMQ",DIC("S")="I $P(^(0),U)'[""LA7V"",$P(^(0),U)'[""LA7P""",DLAYGO=62.4
"RTN","LA7UCFG",53,0)
 D ^DIC K DIC("S")
"RTN","LA7UCFG",54,0)
 I Y<1 S LA7QUIT=1 Q
"RTN","LA7UCFG",55,0)
 S (DA,LA7624)=+Y
"RTN","LA7UCFG",56,0)
 ;
"RTN","LA7UCFG",57,0)
 L +^LAB(62.4,LA7624):DILOCKTM
"RTN","LA7UCFG",58,0)
 I '$T W !?5,"Another user is editing this entry." Q
"RTN","LA7UCFG",59,0)
 ;
"RTN","LA7UCFG",60,0)
 S DIE=DIC,DR=".01;3;5;6;8;10;11;12;18;.02;95;98;99;30;107"
"RTN","LA7UCFG",61,0)
 I DUZ(0)="@" S DR(2,62.41)=".01;2;6;15;7;8;9;12;13;14;16;17;18;19"
"RTN","LA7UCFG",62,0)
 E  S DR(2,62.41)=".01;6;15;7;8;9;12;13;14;16;17;18;19"
"RTN","LA7UCFG",63,0)
 D ^DIE
"RTN","LA7UCFG",64,0)
 ;
"RTN","LA7UCFG",65,0)
 ; Stuff file build logic into entry if UI interface
"RTN","LA7UCFG",66,0)
 S LA76248=$P($G(^LAB(62.4,LA7624,0)),"^",8)
"RTN","LA7UCFG",67,0)
 I $D(DA),LA76248,$P($G(^LAHM(62.48,LA76248,0)),"^",9)=1 D
"RTN","LA7UCFG",68,0)
 . W !!,"Setting fields for auto download  FILE BUILD ENTRY (#93) to: EN"
"RTN","LA7UCFG",69,0)
 . W !,"                                FILE BUILD ROUTINE (#94) to: LA7UID"
"RTN","LA7UCFG",70,0)
 . S FDA(1,62.4,LA7624_",",93)="EN"
"RTN","LA7UCFG",71,0)
 . S FDA(1,62.4,LA7624_",",94)="LA7UID"
"RTN","LA7UCFG",72,0)
 . D FILE^DIE("","FDA(1)","LA7ERR(1)")
"RTN","LA7UCFG",73,0)
 . W " ...",$S('$D(LA7ERR(1)):"Done",1:"Update FAILED")
"RTN","LA7UCFG",74,0)
 . I $D(LA7ERR(1)) W !,"Error Reported by FileMan: ",$G(LA7ERR(1,"DIERR",1,"TEXT",1))
"RTN","LA7UCFG",75,0)
 ;
"RTN","LA7UCFG",76,0)
 ; If entry set for Auto Release then check related load list for desginated auto release profile.
"RTN","LA7UCFG",77,0)
 I $P($G(^LAB(62.4,LA7624,9)),U,11) D
"RTN","LA7UCFG",78,0)
 . N DA,DIE,DR,LA7682
"RTN","LA7UCFG",79,0)
 . S LA7682=$P($G(^LAB(62.4,LA7624,0)),U,4)
"RTN","LA7UCFG",80,0)
 . I $D(^LRO(68.2,"AR",1,LA7682)) Q  ; Loadlist already have profile flagged for auto release
"RTN","LA7UCFG",81,0)
 . W !!,"As this auto instrument is configured for auto release,"
"RTN","LA7UCFG",82,0)
 . W !,"please designate the associated load list profile to be used for auto release.",!
"RTN","LA7UCFG",83,0)
 . W !,"Editing load list: ",$P(^LRO(68.2,LA7682,0),U),!
"RTN","LA7UCFG",84,0)
 . S DIE="^LRO(68.2,",DA=LA7682,DR=50,DR(2,68.23)="2.4"
"RTN","LA7UCFG",85,0)
 . D ^DIE
"RTN","LA7UCFG",86,0)
 ;
"RTN","LA7UCFG",87,0)
 L -^LAB(62.4,LA7624)
"RTN","LA7UCFG",88,0)
 Q
"RTN","LA7UCFG",89,0)
 ;
"RTN","LA7UCFG",90,0)
 ;
"RTN","LA7UCFG",91,0)
PRINT ; Print lab universal interface configuration report
"RTN","LA7UCFG",92,0)
 N %ZIS,DIC,LA7624,ZTDTH,ZTSK,ZTRTN,ZTIO,ZTSAVE,X,Y
"RTN","LA7UCFG",93,0)
 ;
"RTN","LA7UCFG",94,0)
 D EN^DDIOL("","","!")
"RTN","LA7UCFG",95,0)
 S DIC="^LAB(62.4,",DIC(0)="AEMQ",DIC("S")="I $P(^(0),U)'[""LA7V"",$P(^(0),U)'[""LA7P"""
"RTN","LA7UCFG",96,0)
 D ^DIC
"RTN","LA7UCFG",97,0)
 I Y<1 Q
"RTN","LA7UCFG",98,0)
 S LA7624=+Y
"RTN","LA7UCFG",99,0)
 ;
"RTN","LA7UCFG",100,0)
 S %ZIS="MQ" D ^%ZIS
"RTN","LA7UCFG",101,0)
 I POP D HOME^%ZIS Q
"RTN","LA7UCFG",102,0)
 I $D(IO("Q")) D  Q
"RTN","LA7UCFG",103,0)
 . S ZTRTN="DQP^LA7UCFG",ZTSAVE("LA7624")="",ZTDESC="Print Lab Universal Interface Configuration Report"
"RTN","LA7UCFG",104,0)
 . D ^%ZTLOAD,^%ZISC
"RTN","LA7UCFG",105,0)
 . D EN^DDIOL("Request "_$S($G(ZTSK):"queued - Task #"_ZTSK,1:"NOT queued"),"","!")
"RTN","LA7UCFG",106,0)
 ;
"RTN","LA7UCFG",107,0)
DQP ; entry point from above and TaskMan
"RTN","LA7UCFG",108,0)
 ;
"RTN","LA7UCFG",109,0)
 N X,Y
"RTN","LA7UCFG",110,0)
 N LA7EXIT,LA7LINE,LA7LINE2,LA7NOW,LA7PAGE
"RTN","LA7UCFG",111,0)
 N LRLL,LRPROF
"RTN","LA7UCFG",112,0)
 S LA7NOW=$$HTE^XLFDT($H),(LA7EXIT,LA7PAGE)=0
"RTN","LA7UCFG",113,0)
 S LA7624(0)=$G(^LAB(62.4,LA7624,0))
"RTN","LA7UCFG",114,0)
 S LA7LINE=$$REPEAT^XLFSTR("=",IOM)
"RTN","LA7UCFG",115,0)
 S LA7LINE2=$$REPEAT^XLFSTR("-",IOM)
"RTN","LA7UCFG",116,0)
 D HDR
"RTN","LA7UCFG",117,0)
 N ARPCNT,LA7PROXY,LA7PROXID,LA7DIV,LA7SITE,LA7VAF,PCNT,LR60,LRD,LRDN,LRX,XURET
"RTN","LA7UCFG",118,0)
 W !,"VistA Lab Auto Release Master: ",$S($$GET^XPAR("SYS^PKG","LA UI AUTO RELEASE MASTER",1,"E")="":"NO (DISABLED)",1:$$GET^XPAR("SYS^PKG","LA UI AUTO RELEASE MASTER",1,"E"))
"RTN","LA7UCFG",119,0)
 ;
"RTN","LA7UCFG",120,0)
 W !!,"VistA Application Proxy",?28,"ID/DUZ",?45,"HL7 encoding format",!,LA7LINE2
"RTN","LA7UCFG",121,0)
 F LA7PROXY="LRLAB, AUTO VERIFY","LRLAB, AUTO RELEASE" D
"RTN","LA7UCFG",122,0)
 . S LA7PROXID=$$FIND1^DIC(200,,"X",LA7PROXY,"B")
"RTN","LA7UCFG",123,0)
 . S LA7DIV=+$$KSP^XUPARAM("INST")
"RTN","LA7UCFG",124,0)
 . S LA7SITE=$$RETFACID^LA7VHLU2(LA7DIV,0,1)
"RTN","LA7UCFG",125,0)
 . S LA7VAF=$$GET1^DIQ(4,LA7DIV_",","AGENCY CODE","I")
"RTN","LA7UCFG",126,0)
 . I LA7VAF="V" S LA7SITE="VA"_LA7SITE
"RTN","LA7UCFG",127,0)
 . W !,?2,LA7PROXY,?25,$S(LA7PROXID'=0:$J(LA7PROXID,10),1:"** NOT DEFINED **")
"RTN","LA7UCFG",128,0)
 . I LA7PROXID'=0 W ?38," ",LA7PROXID_"-"_LA7SITE_"^"_$$HLNAME^XLFNAME(LA7PROXY,"S","^")_"^^^^99VA4"
"RTN","LA7UCFG",129,0)
 W !!,"HL7 Components: <ID Number (ST)> ^ <Family Name (FN)> ^ <Given Name (ST)> ^ ^ ^ ^ ^ <Source Table (IS)> ^"
"RTN","LA7UCFG",130,0)
 ;
"RTN","LA7UCFG",131,0)
 W !!!,"Instrument Auto Download Status.: ",$$GET1^DIQ(62.4,LA7624_",",98)
"RTN","LA7UCFG",132,0)
 I $$GET1^DIQ(62.4,LA7624_",",98)'="YES" W !?10,"**Warning - Auto Download not enabled for auto instrument: ",$P(LA7624(0),"^",1)
"RTN","LA7UCFG",133,0)
 W !,"Instrument Auto Download Routine: ",$S($$GET1^DIQ(62.4,LA7624_",",93)'="":$$GET1^DIQ(62.4,LA7624_",",93),1:"(Entry Not Defined)"),$S($$GET1^DIQ(62.4,LA7624_",",94)'="":"^"_$$GET1^DIQ(62.4,LA7624_",",94),1:"(Routine Not Defined)")
"RTN","LA7UCFG",134,0)
 ;
"RTN","LA7UCFG",135,0)
 W !!,"Instrument Auto Release Status: ",$$GET1^DIQ(62.4,LA7624_",",99)
"RTN","LA7UCFG",136,0)
 ;I $$GET1^DIQ(62.4,LA7624_",",99)'="YES" W !?10,"**Warning - Auto Release not enabled for auto instrument: ",$P(LA7624(0),"^",1)
"RTN","LA7UCFG",137,0)
 ;
"RTN","LA7UCFG",138,0)
 W !!,"Associated Lab UI Message Configuration: ",$$GET1^DIQ(62.4,LA7624_",",8)
"RTN","LA7UCFG",139,0)
 I $$GET1^DIQ(62.4,LA7624_",",8)="" W !?10,"**Warning - Message Configuration not defined for auto instrument: ",$P(LA7624(0),"^",1)
"RTN","LA7UCFG",140,0)
 ;
"RTN","LA7UCFG",141,0)
 W !!,"Associated Load/Work List: ",$$GET1^DIQ(62.4,LA7624_",",3)
"RTN","LA7UCFG",142,0)
 S LRLL=$P(LA7624(0),"^",4) ;load/work list
"RTN","LA7UCFG",143,0)
 I 'LRLL W !?10,"**Warning - No load/work list defined for auto instrument: ",$P(LA7624(0),"^",1)
"RTN","LA7UCFG",144,0)
 ;
"RTN","LA7UCFG",145,0)
 S LRX=$$FIND1^DIC(200,"","OX","LRLAB,AUTO RELEASE","B","") I LRX<1 W !?10,"**Warning - Unable to identify proxy 'LRLAB,AUTO RELEASE' in NEW PERSON file" ;find duz of proxy
"RTN","LA7UCFG",146,0)
 I LRX S XURET=$$DIV4^XUSER(.XURET,.LRX) ;return proxy's divisions
"RTN","LA7UCFG",147,0)
 S PCNT=0,ARPCNT=0,LRPROF=0
"RTN","LA7UCFG",148,0)
 I LRLL F  S LRPROF=$O(^LRO(68.2,LRLL,10,LRPROF)) Q:'LRPROF  D
"RTN","LA7UCFG",149,0)
 . S PCNT=PCNT+1 ; count profiles
"RTN","LA7UCFG",150,0)
 . I $$GET1^DIQ(68.23,LRPROF_","_LRLL_",",2.4)="YES" D
"RTN","LA7UCFG",151,0)
 . . S ARPCNT=ARPCNT+1 ;count auto release profiles
"RTN","LA7UCFG",152,0)
 . . W !?5,"Auto Release Profile: ",$$GET1^DIQ(68.23,LRPROF_","_LRLL_",",.01)
"RTN","LA7UCFG",153,0)
 . . S LRD=+$P($G(^LRO(68.2,LRLL,10,LRPROF,0)),"^",5),LRDN=$$GET1^DIQ(68.23,LRPROF_","_LRLL_",",2.3) ;default reference lab and name
"RTN","LA7UCFG",154,0)
 . . W !?11,"Performing Lab: ",$S(LRDN'="":LRDN,1:"** None Defined **")
"RTN","LA7UCFG",155,0)
 . . I '$D(XURET(LRD)) D
"RTN","LA7UCFG",156,0)
 . . . I LRDN'="" W !?11,"**Warning - 'LRLAB,AUTO RELEASE' proxy has not been assigned division '",LRDN,"' in",!?24,"the file NEW PERSON (#200), field DIVISION (#16)."
"RTN","LA7UCFG",157,0)
 . . . I LRDN="" W !?11,"**Warning - Performing lab required to be specified for Auto Release."
"RTN","LA7UCFG",158,0)
 I 'PCNT W !?10,"**Warning - No profile defined for auto release"
"RTN","LA7UCFG",159,0)
 I 'ARPCNT W !?10,"**Warning - No profile enabled for auto release"
"RTN","LA7UCFG",160,0)
 I ARPCNT>1 W !?10,"**Warning - Multiple profiles enabled for auto release (should only be one)"
"RTN","LA7UCFG",161,0)
 ;
"RTN","LA7UCFG",162,0)
 I ($Y+6)>IOSL D HDR
"RTN","LA7UCFG",163,0)
 I LA7EXIT D CLEAN Q
"RTN","LA7UCFG",164,0)
 D SH1
"RTN","LA7UCFG",165,0)
 S I=0 F  S I=$O(^LAB(62.4,LA7624,3,I)) Q:'I  S X(0)=$G(^(I,0)),X(2)=$G(^(2)) I $P(X(2),"^",4)=1 D  Q:LA7EXIT
"RTN","LA7UCFG",166,0)
 . S LR60=+$P(X(0),"^",1)
"RTN","LA7UCFG",167,0)
 . I ($Y+6)>IOSL D HDR Q:LA7EXIT  D SH1 Q:LA7EXIT
"RTN","LA7UCFG",168,0)
 . W !,$J("["_I_"]",4),?5,$$GET1^DIQ(62.41,I_","_LA7624_",",.01),?45,$$GET1^DIQ(62.41,I_","_LA7624_",",6),?75,$$GET1^DIQ(62.41,I_","_LA7624_",",7),?95,$$GET1^DIQ(60,LR60_",",400)," [",$P($G(^LAB(60,LR60,.2)),"^",1),"]"
"RTN","LA7UCFG",169,0)
 . I $S($P(X(2),"^",13)'="":1,$P(X(2),"^",14)'="":1,1:0) D
"RTN","LA7UCFG",170,0)
 . . W !
"RTN","LA7UCFG",171,0)
 . . I $P(X(2),"^",13)'="" W ?10,"Specimen: ",$$GET1^DIQ(62.41,I_","_LA7624_",",8)
"RTN","LA7UCFG",172,0)
 . . I $P(X(2),"^",14)'="" W ?90,"Urgency: ",$$GET1^DIQ(62.41,I_","_LA7624_",",9)
"RTN","LA7UCFG",173,0)
 ;
"RTN","LA7UCFG",174,0)
 I LA7EXIT D CLEAN Q
"RTN","LA7UCFG",175,0)
 I ($Y+6)>IOSL D HDR
"RTN","LA7UCFG",176,0)
 I LA7EXIT D CLEAN Q
"RTN","LA7UCFG",177,0)
 D SH2
"RTN","LA7UCFG",178,0)
 S I=0 F  S I=$O(^LAB(62.4,LA7624,3,I)) Q:'I  S X(2)=$G(^(I,2)) I $P(X(2),"^",3)'=0 D  Q:LA7EXIT
"RTN","LA7UCFG",179,0)
 . I ($Y+6)>IOSL D HDR Q:LA7EXIT  D SH2 Q:LA7EXIT
"RTN","LA7UCFG",180,0)
 . W !,$J("["_I_"]",4),?5,$$GET1^DIQ(62.41,I_","_LA7624_",",.01),?45,$$GET1^DIQ(62.41,I_","_LA7624_",",6),?75,$J($$GET1^DIQ(62.41,I_","_LA7624_",",12),5),?85,$$GET1^DIQ(62.41,I_","_LA7624_",",13),?95,$$GET1^DIQ(62.41,I_","_LA7624_",",14)
"RTN","LA7UCFG",181,0)
 . W ?105,$$GET1^DIQ(62.41,I_","_LA7624_",",16),?115,$$GET1^DIQ(62.41,I_","_LA7624_",",17),?125,$$GET1^DIQ(62.41,I_","_LA7624_",",18)
"RTN","LA7UCFG",182,0)
 . I $P(X(2),"^",8)'="" W !?10,"Remark Prefix: ",$$GET1^DIQ(62.41,I_","_LA7624_",",19)
"RTN","LA7UCFG",183,0)
 . I $$GET1^DIQ(62.41,I_","_LA7624_",",2)'="" W !?10,"Param 1: ",$$GET1^DIQ(62.41,I_","_LA7624_",",2)
"RTN","LA7UCFG",184,0)
 ;
"RTN","LA7UCFG",185,0)
 I '$D(ZTQUEUED),'LA7EXIT,$E(IOST,1,2)="C-" D TERM
"RTN","LA7UCFG",186,0)
 D CLEAN
"RTN","LA7UCFG",187,0)
 Q
"RTN","LA7UCFG",188,0)
 ;
"RTN","LA7UCFG",189,0)
 ;
"RTN","LA7UCFG",190,0)
CLEAN ; Clean up and quit
"RTN","LA7UCFG",191,0)
 I $E(IOST,1,2)'="C-"  W @IOF
"RTN","LA7UCFG",192,0)
 I '$D(ZTQUEUED) D ^%ZISC
"RTN","LA7UCFG",193,0)
 E  S ZTREQ="@"
"RTN","LA7UCFG",194,0)
 Q
"RTN","LA7UCFG",195,0)
 ;
"RTN","LA7UCFG",196,0)
 ;
"RTN","LA7UCFG",197,0)
HDR ; Header for lab universal interface configuration report
"RTN","LA7UCFG",198,0)
 I '$D(ZTQUEUED),LA7PAGE,$E(IOST,1,2)="C-" D TERM Q:$G(LA7EXIT)
"RTN","LA7UCFG",199,0)
 W @IOF S $X=0
"RTN","LA7UCFG",200,0)
 S LA7PAGE=LA7PAGE+1
"RTN","LA7UCFG",201,0)
 W !,"Lab Universal Interface Configuration Report",?IOM-29," Page: ",LA7PAGE
"RTN","LA7UCFG",202,0)
 W !," for interface: ",$P(LA7624(0),"^"),?IOM-32," Printed: ",LA7NOW
"RTN","LA7UCFG",203,0)
 W !,LA7LINE,!
"RTN","LA7UCFG",204,0)
 Q
"RTN","LA7UCFG",205,0)
 ;
"RTN","LA7UCFG",206,0)
 ;
"RTN","LA7UCFG",207,0)
SH1 ;Sub header #1
"RTN","LA7UCFG",208,0)
 W !!,"ORDERABLE TESTS"
"RTN","LA7UCFG",209,0)
 W !,"Entry",?10,"Name",?45,"UI Test Code",?75,"Accession Area",?95,"Data Name [IEN]"
"RTN","LA7UCFG",210,0)
 W !,LA7LINE2
"RTN","LA7UCFG",211,0)
 Q
"RTN","LA7UCFG",212,0)
 ;
"RTN","LA7UCFG",213,0)
 ;
"RTN","LA7UCFG",214,0)
SH2 ;Sub head #2
"RTN","LA7UCFG",215,0)
 W !!,"REPORTABLE TESTS"
"RTN","LA7UCFG",216,0)
 W ?75,"Decimal",?84,"Result to",?95,"Accept",?105,"Ignore",?115,"Remove",?125,"Store"
"RTN","LA7UCFG",217,0)
 W !,"Entry",?10,"Name",?45,"UI Test Code",?75,"Places",?85,"Remark",?95,"Results",?105,"Results",?115,"Spaces",?125,"Remarks"
"RTN","LA7UCFG",218,0)
 W !,LA7LINE2
"RTN","LA7UCFG",219,0)
 Q
"RTN","LA7UCFG",220,0)
 ;
"RTN","LA7UCFG",221,0)
 ;
"RTN","LA7UCFG",222,0)
TERM ;
"RTN","LA7UCFG",223,0)
 N DIR,DIRUT,DTOUT,DUOUT,X,Y
"RTN","LA7UCFG",224,0)
 S DIR(0)="E" D ^DIR S:$D(DIRUT) LA7EXIT=1
"RTN","LA7UCFG",225,0)
 Q
"RTN","LA7UCFG",226,0)
 ;
"RTN","LA7UCFG",227,0)
 ;
"RTN","LA7UCFG",228,0)
ENKEY ;entry point to holder(s) of lab key(s) option
"RTN","LA7UCFG",229,0)
 N DIC,X,Y,LRKEY,LRUSER
"RTN","LA7UCFG",230,0)
 W ! F  S DIC="^DIC(19.1,",DIC(0)="QEAM",DIC("S")="I $E($P(^(0),U,1),1,2)=""LR""",DIC("A")="Select "_$S($D(LRKEY):"Another ",1:"")_"LAB SECURITY KEY NAME: " D  Q:Y<0
"RTN","LA7UCFG",231,0)
 . D ^DIC I Y<0 Q
"RTN","LA7UCFG",232,0)
 . I '$D(^XUSEC($P(Y,"^",2))) W !!?5,"There are no holders of this key." Q
"RTN","LA7UCFG",233,0)
 . S LRKEY($P(Y,"^",2))="" ;array of lab keys
"RTN","LA7UCFG",234,0)
 I '$D(LRKEY) W !!,"No security keys selected." Q
"RTN","LA7UCFG",235,0)
 I X="^" Q
"RTN","LA7UCFG",236,0)
 W ! S DIR(0)="Y",DIR("B")="Yes",DIR("A")="All USERS" D ^DIR K DIR I $D(DIRUT) Q
"RTN","LA7UCFG",237,0)
 I Y=1 S LRUSER="ALL" ;selecting all lab keys
"RTN","LA7UCFG",238,0)
 I 'Y W ! F  K DIC S DIC="^VA(200,",DIC(0)="QEAM",DIC("A")="Select "_$S($D(LRUSER):"Another ",1:"")_"USER: " D  Q:Y<0
"RTN","LA7UCFG",239,0)
 . D ^DIC I Y<0 Q
"RTN","LA7UCFG",240,0)
 . S LRUSER(+Y)="" ;array of lab keys
"RTN","LA7UCFG",241,0)
 I X="^" Q
"RTN","LA7UCFG",242,0)
 S ZTSAVE("LRKEY*")="",ZTSAVE("LRUSER*")=""
"RTN","LA7UCFG",243,0)
 W ! D EN^XUTMDEVQ("START^LA7UCFG","USERS HOLDING LAB KEYS",.ZTSAVE,"M") I 'POP Q
"RTN","LA7UCFG",244,0)
 W !,"NO DEVICE SELECTED OR REPORT PRINTED!!"
"RTN","LA7UCFG",245,0)
 Q
"RTN","LA7UCFG",246,0)
 ;
"RTN","LA7UCFG",247,0)
 ;
"RTN","LA7UCFG",248,0)
START ;print users holding lab keys
"RTN","LA7UCFG",249,0)
 N %,I,JJ,KTAB,LIN,LN,LRID,LRK,LRNAM,PG,POP,PRTDT,QFLG,SS,TAB,X,Y
"RTN","LA7UCFG",250,0)
 S (PG,QFLG)=0,U="^",$P(LN,"-",IOM+1)="" K ^TMP("LA7UCFG",$J)
"RTN","LA7UCFG",251,0)
 D NOW^%DTC S PRTDT=$$FMTE^XLFDT($E(%,1,12))
"RTN","LA7UCFG",252,0)
 ;
"RTN","LA7UCFG",253,0)
 I $G(LRUSER)="ALL" S LRK="" F  S LRK=$O(LRKEY(LRK)) Q:LRK=""  S LRID=0 F  S LRID=$O(^XUSEC(LRK,LRID)) Q:'LRID  D
"RTN","LA7UCFG",254,0)
 . S ^TMP("LA7UCFG",$J,$P($G(^VA(200,LRID,0)),"^",1),LRID,LRK)=""
"RTN","LA7UCFG",255,0)
 I $O(LRUSER(0)) S LRID=0 F  S LRID=$O(LRUSER(LRID)) Q:'LRID  S LRK="" F  S LRK=$O(LRKEY(LRK)) Q:LRK=""  I $D(^XUSEC(LRK,LRID)) D
"RTN","LA7UCFG",256,0)
 . S ^TMP("LA7UCFG",$J,$P($G(^VA(200,LRID,0)),"^",1),LRID,LRK)=""
"RTN","LA7UCFG",257,0)
 ;
"RTN","LA7UCFG",258,0)
 D KEYHDR I QFLG D EXIT Q
"RTN","LA7UCFG",259,0)
 S LRNAM="" F  S LRNAM=$O(^TMP("LA7UCFG",$J,LRNAM)) Q:LRNAM=""!(QFLG)  D
"RTN","LA7UCFG",260,0)
 . S LRID=0 F  S LRID=$O(^TMP("LA7UCFG",$J,LRNAM,LRID)) Q:'LRID  D
"RTN","LA7UCFG",261,0)
 . . I $Y+4>IOSL!'PG D KEYHDR I QFLG Q
"RTN","LA7UCFG",262,0)
 . . W !,$J(LRID,9),?10,LRNAM
"RTN","LA7UCFG",263,0)
 . . S LRK="" F  S LRK=$O(^TMP("LA7UCFG",$J,LRNAM,LRID,LRK)) Q:LRK=""  D
"RTN","LA7UCFG",264,0)
 . . . W ?KTAB(LRK),"X"
"RTN","LA7UCFG",265,0)
 I '$D(^TMP("LA7UCFG",$J)) W !," ** NO USERS FOR SELECTED LAB KEY(S) **"
"RTN","LA7UCFG",266,0)
 ;
"RTN","LA7UCFG",267,0)
 ;
"RTN","LA7UCFG",268,0)
EXIT ;
"RTN","LA7UCFG",269,0)
 K ^TMP("LA7UCFG",$J)
"RTN","LA7UCFG",270,0)
 I $E(IOST,1,2)="C-"&('QFLG) S DIR(0)="E" D  D ^DIR K DIR
"RTN","LA7UCFG",271,0)
 .S SS=22-$Y F JJ=1:1:SS W !
"RTN","LA7UCFG",272,0)
 D ^%ZISC
"RTN","LA7UCFG",273,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","LA7UCFG",274,0)
 Q
"RTN","LA7UCFG",275,0)
 ;
"RTN","LA7UCFG",276,0)
 ;
"RTN","LA7UCFG",277,0)
KEYHDR ;header for security key report
"RTN","LA7UCFG",278,0)
 I $E(IOST,1,2)="C-" S SS=22-$Y F JJ=1:1:SS W !
"RTN","LA7UCFG",279,0)
 I $E(IOST,1,2)="C-",PG>0 S DIR(0)="E" W ! D ^DIR K DIR I 'Y S QFLG=1 Q
"RTN","LA7UCFG",280,0)
 I $Y!($E(IOST,1,2)="C-") W @IOF
"RTN","LA7UCFG",281,0)
 S PG=PG+1
"RTN","LA7UCFG",282,0)
 W !,PRTDT,?IOM-10,"Page: ",PG
"RTN","LA7UCFG",283,0)
 S LIN(1)="HOLDERS OF LAB KEYS"
"RTN","LA7UCFG",284,0)
 F I=1:1 Q:'$D(LIN(I))  W !,?(IOM\2-($L(LIN(I))\2)),LIN(I)
"RTN","LA7UCFG",285,0)
 W !!?1,"DUZ/ID",?10,"NAME" S TAB=40,I="" F  S I=$O(LRKEY(I)) Q:I=""  S KTAB(I)=TAB+($L(I)/2) W ?TAB,I S TAB=TAB+$L(I)+1
"RTN","LA7UCFG",286,0)
 W !,LN
"RTN","LA7UCFG",287,0)
 Q
"RTN","LA7UCFG",288,0)
 ;
"RTN","LA7UCFG",289,0)
 ;
"VER")
8.0^22.0
"BLD",9785,6)
^67
**END**
**END**

