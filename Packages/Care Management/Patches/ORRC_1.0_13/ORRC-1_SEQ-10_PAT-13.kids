Released ORRC*1*13 SEQ #10
Extracted from mail message
**KIDS**:ORRC*1.0*13^

**INSTALL NAME**
ORRC*1.0*13
"BLD",11435,0)
ORRC*1.0*13^CARE MANAGEMENT^0^3190415^y
"BLD",11435,1,0)
^^2^2^3190411^
"BLD",11435,1,1,0)
The purpose of this patch is to remove unused routines in the Care 
"BLD",11435,1,2,0)
Management (CM) package from VistA. 
"BLD",11435,4,0)
^9.64PA^^0
"BLD",11435,6.3)
8
"BLD",11435,"INI")

"BLD",11435,"INID")
^y^
"BLD",11435,"INIT")
ORRC13P
"BLD",11435,"KRN",0)
^9.67PA^1.5^24
"BLD",11435,"KRN",.4,0)
.4
"BLD",11435,"KRN",.401,0)
.401
"BLD",11435,"KRN",.402,0)
.402
"BLD",11435,"KRN",.403,0)
.403
"BLD",11435,"KRN",.5,0)
.5
"BLD",11435,"KRN",.84,0)
.84
"BLD",11435,"KRN",1.5,0)
1.5
"BLD",11435,"KRN",1.6,0)
1.6
"BLD",11435,"KRN",1.61,0)
1.61
"BLD",11435,"KRN",1.62,0)
1.62
"BLD",11435,"KRN",3.6,0)
3.6
"BLD",11435,"KRN",3.8,0)
3.8
"BLD",11435,"KRN",9.2,0)
9.2
"BLD",11435,"KRN",9.8,0)
9.8
"BLD",11435,"KRN",9.8,"NM",0)
^9.68A^17^17
"BLD",11435,"KRN",9.8,"NM",1,0)
ORRCDPT^^1^
"BLD",11435,"KRN",9.8,"NM",2,0)
ORRCDPT1^^1^
"BLD",11435,"KRN",9.8,"NM",3,0)
ORRCEVT^^1^
"BLD",11435,"KRN",9.8,"NM",4,0)
ORRCLPT^^1^
"BLD",11435,"KRN",9.8,"NM",5,0)
ORRCOA^^1^
"BLD",11435,"KRN",9.8,"NM",6,0)
ORRCOR^^1^
"BLD",11435,"KRN",9.8,"NM",7,0)
ORRCSIG^^1^
"BLD",11435,"KRN",9.8,"NM",8,0)
ORRCTIU^^1^
"BLD",11435,"KRN",9.8,"NM",9,0)
ORRCTSK^^1^
"BLD",11435,"KRN",9.8,"NM",10,0)
ORRCVIT^^1^
"BLD",11435,"KRN",9.8,"NM",11,0)
ORRCXQ^^1^
"BLD",11435,"KRN",9.8,"NM",12,0)
ORRCY08^^1^
"BLD",11435,"KRN",9.8,"NM",13,0)
ORRCY7^^1^
"BLD",11435,"KRN",9.8,"NM",14,0)
ORRCYP01^^1^
"BLD",11435,"KRN",9.8,"NM",15,0)
ORRCACK^^0^B69951493
"BLD",11435,"KRN",9.8,"NM",16,0)
ORRCLNP^^0^B585941
"BLD",11435,"KRN",9.8,"NM",17,0)
ORRCQLPT^^0^B1006284
"BLD",11435,"KRN",9.8,"NM","B","ORRCACK",15)

"BLD",11435,"KRN",9.8,"NM","B","ORRCDPT",1)

"BLD",11435,"KRN",9.8,"NM","B","ORRCDPT1",2)

"BLD",11435,"KRN",9.8,"NM","B","ORRCEVT",3)

"BLD",11435,"KRN",9.8,"NM","B","ORRCLNP",16)

"BLD",11435,"KRN",9.8,"NM","B","ORRCLPT",4)

"BLD",11435,"KRN",9.8,"NM","B","ORRCOA",5)

"BLD",11435,"KRN",9.8,"NM","B","ORRCOR",6)

"BLD",11435,"KRN",9.8,"NM","B","ORRCQLPT",17)

"BLD",11435,"KRN",9.8,"NM","B","ORRCSIG",7)

"BLD",11435,"KRN",9.8,"NM","B","ORRCTIU",8)

"BLD",11435,"KRN",9.8,"NM","B","ORRCTSK",9)

"BLD",11435,"KRN",9.8,"NM","B","ORRCVIT",10)

"BLD",11435,"KRN",9.8,"NM","B","ORRCXQ",11)

"BLD",11435,"KRN",9.8,"NM","B","ORRCY08",12)

"BLD",11435,"KRN",9.8,"NM","B","ORRCY7",13)

"BLD",11435,"KRN",9.8,"NM","B","ORRCYP01",14)

"BLD",11435,"KRN",19,0)
19
"BLD",11435,"KRN",19.1,0)
19.1
"BLD",11435,"KRN",101,0)
101
"BLD",11435,"KRN",409.61,0)
409.61
"BLD",11435,"KRN",771,0)
771
"BLD",11435,"KRN",779.2,0)
779.2
"BLD",11435,"KRN",870,0)
870
"BLD",11435,"KRN",8989.51,0)
8989.51
"BLD",11435,"KRN",8989.52,0)
8989.52
"BLD",11435,"KRN",8994,0)
8994
"BLD",11435,"KRN","B",.4,.4)

"BLD",11435,"KRN","B",.401,.401)

"BLD",11435,"KRN","B",.402,.402)

"BLD",11435,"KRN","B",.403,.403)

"BLD",11435,"KRN","B",.5,.5)

"BLD",11435,"KRN","B",.84,.84)

"BLD",11435,"KRN","B",1.5,1.5)

"BLD",11435,"KRN","B",1.6,1.6)

"BLD",11435,"KRN","B",1.61,1.61)

"BLD",11435,"KRN","B",1.62,1.62)

"BLD",11435,"KRN","B",3.6,3.6)

"BLD",11435,"KRN","B",3.8,3.8)

"BLD",11435,"KRN","B",9.2,9.2)

"BLD",11435,"KRN","B",9.8,9.8)

"BLD",11435,"KRN","B",19,19)

"BLD",11435,"KRN","B",19.1,19.1)

"BLD",11435,"KRN","B",101,101)

"BLD",11435,"KRN","B",409.61,409.61)

"BLD",11435,"KRN","B",771,771)

"BLD",11435,"KRN","B",779.2,779.2)

"BLD",11435,"KRN","B",870,870)

"BLD",11435,"KRN","B",8989.51,8989.51)

"BLD",11435,"KRN","B",8989.52,8989.52)

"BLD",11435,"KRN","B",8994,8994)

"BLD",11435,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",11435,"QUES",0)
^9.62^^
"BLD",11435,"REQB",0)
^9.611^^
"INIT")
ORRC13P
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"PKG",565,-1)
1^1
"PKG",565,0)
CARE MANAGEMENT^ORRC^Care Mgt Modules
"PKG",565,22,0)
^9.49I^1^1
"PKG",565,22,1,0)
1.0^3040116^3040224^66481
"PKG",565,22,1,"PAH",1,0)
13^3190415
"PKG",565,22,1,"PAH",1,1,0)
^^2^2^3190415
"PKG",565,22,1,"PAH",1,1,1,0)
The purpose of this patch is to remove unused routines in the Care 
"PKG",565,22,1,"PAH",1,1,2,0)
Management (CM) package from VistA. 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
18
"RTN","ORRC13P")
0^^B711449^n/a
"RTN","ORRC13P",1,0)
ORRC13P ;PHL/WAR - POST INSTALL FOR Care Management Decommissioning ; 4/15/19 9:43am
"RTN","ORRC13P",2,0)
 ;;1.0;Care Management;**13**;April 11th, 2019;Build 8
"RTN","ORRC13P",3,0)
 ;
"RTN","ORRC13P",4,0)
 D EN
"RTN","ORRC13P",5,0)
 Q
"RTN","ORRC13P",6,0)
EN ; Remove routines from ^DIC(9.8
"RTN","ORRC13P",7,0)
 N EDPRTN,EDPI,DA,DIK,EDPFLG
"RTN","ORRC13P",8,0)
 S EDPRTN="ORRC",EDPFLG=0
"RTN","ORRC13P",9,0)
 F  S EDPRTN=$O(^DIC(9.8,"B",EDPRTN)) Q:$E(EDPRTN,1,4)'="ORRC"  D
"RTN","ORRC13P",10,0)
 .S EDPI=0 S EDPI=$O(^DIC(9.8,"B",EDPRTN,EDPI)) Q:'EDPI
"RTN","ORRC13P",11,0)
 .I EDPRTN="ORRCACK" S EDPFLG=1
"RTN","ORRC13P",12,0)
 .I EDPRTN="ORRCLNP" S EDPFLG=1
"RTN","ORRC13P",13,0)
 .I EDPRTN="ORRCQLPT" S EDPFLG=1
"RTN","ORRC13P",14,0)
 .I EDPFLG'=1 K DA,DIK S DA=EDPI,DIK="^DIC(9.8," D ^DIK
"RTN","ORRC13P",15,0)
 .S EDPFLG=0
"RTN","ORRC13P",16,0)
 K DA,DIK
"RTN","ORRC13P",17,0)
 Q
"RTN","ORRC13P",18,0)
 ;
"RTN","ORRCACK")
0^15^B69951493^B69951493
"RTN","ORRCACK",1,0)
ORRCACK ;SLC/MKB - Result Acknowledgement file utilities ; 25 Jul 2003  9:31 AM
"RTN","ORRCACK",2,0)
 ;;1.0;CARE MANAGEMENT;;Jul 15, 2003;Build 8
"RTN","ORRCACK",3,0)
 ;
"RTN","ORRCACK",4,0)
 ; ID = "ORR:"_order# everywhere below
"RTN","ORRCACK",5,0)
 ;
"RTN","ORRCACK",6,0)
PARAM(PROV) ; -- Return ORRC ACTIVATION DATE parameter for PROV
"RTN","ORRCACK",7,0)
 N SERV,Y S PROV=+$G(PROV),SERV=+$G(^VA(200,PROV,5))
"RTN","ORRCACK",8,0)
 S Y=$$GET^XPAR("ALL^USR.`"_PROV_"^SRV.`"_SERV,"ORRC ACTIVATION DATE")
"RTN","ORRCACK",9,0)
 Q Y
"RTN","ORRCACK",10,0)
 ;
"RTN","ORRCACK",11,0)
ADD(ORDER,PROV,ACK) ; -- Create new entry in file #102.4 when results are posted
"RTN","ORRCACK",12,0)
 ;  [called from HL7 messages: ORMLR, ORMRA, ORMGMRC]
"RTN","ORRCACK",13,0)
 Q:'$G(ORDER)  N X,Y,DIC,DO,STOP
"RTN","ORRCACK",14,0)
 I '$G(ACK),+$G(PROV) D  Q:$G(STOP)
"RTN","ORRCACK",15,0)
 . I $D(^ORA(102.4,"ACK",PROV,+$G(ORDER))) S STOP=1 Q  ;exists
"RTN","ORRCACK",16,0)
 . N ACTDT S ACTDT=$$PARAM(PROV)
"RTN","ORRCACK",17,0)
 . I (ACTDT<1)!(ACTDT>DT) S STOP=1 Q  ;not [yet] active
"RTN","ORRCACK",18,0)
 S DIC="^ORA(102.4,",DIC(0)="" S:$G(PROV) DIC("DR")="2////"_+PROV
"RTN","ORRCACK",19,0)
 S X=+ORDER D FILE^DICN
"RTN","ORRCACK",20,0)
 Q
"RTN","ORRCACK",21,0)
 ;
"RTN","ORRCACK",22,0)
ACK(ORY,ORUSR,ORDER) ; -- Acknowledge results of ORDERs by ORUSR
"RTN","ORRCACK",23,0)
 ; where ORDER(#) = ID ^ 1 or 0, if acknowledged
"RTN","ORRCACK",24,0)
 ; Returns ORY(#) = ID ^ 1 or 0, if successful
"RTN","ORRCACK",25,0)
 ; RPC = ORRC RESULTS ACKNOWLEDGE
"RTN","ORRCACK",26,0)
 Q:'$G(ORUSR)  N X,Y,DA,DR,DIE,ORI,ORIFN,ORACK,ORXQ
"RTN","ORRCACK",27,0)
 S DIE="^ORA(102.4,",ORUSR=+$G(ORUSR)
"RTN","ORRCACK",28,0)
 S ORI="" F  S ORI=$O(ORDER(ORI)) Q:ORI=""  D
"RTN","ORRCACK",29,0)
 . S X=ORDER(ORI),ORIFN=$P(X,U),ORACK=+$P(X,U,2)
"RTN","ORRCACK",30,0)
 . S ORY(ORI)=ORIFN_"^0",ORIFN=+$P(ORIFN,":",2) Q:ORIFN<1
"RTN","ORRCACK",31,0)
 . I '$D(^ORA(102.4,"ACK",+ORUSR,+ORIFN)) D ADD(ORIFN,ORUSR,1)
"RTN","ORRCACK",32,0)
 . S DA=+$O(^ORA(102.4,"ACK",+ORUSR,+ORIFN,0)) Q:DA<1
"RTN","ORRCACK",33,0)
 . S DR="3///"_$S(ORACK:"NOW",1:"@") D ^DIE
"RTN","ORRCACK",34,0)
 . S $P(ORY(ORI),U,2)=1,ORXQ(+ORIFN)=""
"RTN","ORRCACK",35,0)
 D:$D(ORXQ) RSLT^ORRCXQ(.ORXQ,ORUSR)
"RTN","ORRCACK",36,0)
 Q
"RTN","ORRCACK",37,0)
 ;
"RTN","ORRCACK",38,0)
DEL(DA) ; -- Delete old acknowledgment stub
"RTN","ORRCACK",39,0)
 N DIK S DIK="^ORA(102.4,"
"RTN","ORRCACK",40,0)
 I $G(DA),'$P($G(^ORA(102.4,DA,0)),U,3) D ^DIK
"RTN","ORRCACK",41,0)
 Q
"RTN","ORRCACK",42,0)
 ;
"RTN","ORRCACK",43,0)
PATS(ORY,ORUSR) ; -- Return list of patients for whom ORUSR has unack'd results
"RTN","ORRCACK",44,0)
 ; in @ORY@(PAT) = #orders ^ 1 if any are abnormal
"RTN","ORRCACK",45,0)
 ;    @ORY@(PAT,ID) = * if abnormal, else null
"RTN","ORRCACK",46,0)
 ; [from ORRCDPT]
"RTN","ORRCACK",47,0)
 N ORIFN,PAT,ABN,X,CNT,ACTDT,RDT,ACK
"RTN","ORRCACK",48,0)
 S ORUSR=+$G(ORUSR),ACTDT=$$PARAM(ORUSR)
"RTN","ORRCACK",49,0)
 S ORY=$NA(^TMP($J,"ORRCRSLT")) K @ORY,^TMP($J,"ORSLT")
"RTN","ORRCACK",50,0)
 S ORIFN=0 F  S ORIFN=+$O(^ORA(102.4,"ACK",ORUSR,ORIFN)) Q:ORIFN<1  D
"RTN","ORRCACK",51,0)
 . Q:+$P($G(^OR(100,ORIFN,3)),U,3)=9  ;partial results
"RTN","ORRCACK",52,0)
 . S PAT=+$P($G(^OR(100,ORIFN,0)),U,2),RDT=+$G(^(7)),ABN=$P($G(^(7)),U,2)
"RTN","ORRCACK",53,0)
 . I $D(^TMP($J,"ORRCLST")),'$D(^TMP($J,"ORRCY",PAT)) Q  ;pt not on list
"RTN","ORRCACK",54,0)
 . I 'ACTDT!(RDT<ACTDT) S ACK=+$O(^ORA(102.4,"ACK",ORUSR,ORIFN,0)) D DEL(ACK) Q  ;remove old stub
"RTN","ORRCACK",55,0)
 . S X=$G(ORY(PAT)),CNT=+X
"RTN","ORRCACK",56,0)
 . S CNT=CNT+1,@ORY@(PAT)=CNT_$S(ABN!$P(X,U,2):"^1",1:"")
"RTN","ORRCACK",57,0)
 . S @ORY@(PAT,"ORR:"_ORIFN)=$S(ABN:"*",1:"")
"RTN","ORRCACK",58,0)
 . D ORSLT ;temp xref for PATS^ORRCEVT
"RTN","ORRCACK",59,0)
 Q
"RTN","ORRCACK",60,0)
 ;
"RTN","ORRCACK",61,0)
ORSLT ; -- Add ORIFN to ^TMP($J,"ORSLT",PAT,pkgid) for use by Events
"RTN","ORRCACK",62,0)
 N OR0,OR4,NMSP,X
"RTN","ORRCACK",63,0)
 S OR0=$G(^OR(100,+ORIFN,0)),OR4=$G(^(4)),X=""
"RTN","ORRCACK",64,0)
 S NMSP=$$NMSP^ORCD($P(OR0,U,14)) I NMSP="RA" D  Q
"RTN","ORRCACK",65,0)
 . N IDX S IDX="^RADPT(""AO"",+OR4,PAT)"
"RTN","ORRCACK",66,0)
 . F  S IDX=$Q(@IDX) Q:$P(IDX,",",2)'=+OR4  Q:$P(IDX,",",3)'=PAT  S X=$P(IDX,",",4)_"~"_$P(IDX,",",5),^TMP($J,"ORSLT",PAT,X)=+ORIFN
"RTN","ORRCACK",67,0)
 I NMSP="LR" S X=+ORIFN_"@OR"
"RTN","ORRCACK",68,0)
 I NMSP="GMRC" S X=+OR4
"RTN","ORRCACK",69,0)
 S:$L(X) ^TMP($J,"ORSLT",PAT,X)=+ORIFN
"RTN","ORRCACK",70,0)
 Q
"RTN","ORRCACK",71,0)
 ;
"RTN","ORRCACK",72,0)
IDS(ORY,ORPAT,ORUSR,SDATE,EDATE) ; -- Return new results for ORPAT
"RTN","ORRCACK",73,0)
 ; between ORBEG & OREND that ORUSR has not acknowledged
"RTN","ORRCACK",74,0)
 ; in @ORY@(ORPAT) = #orders ^ 1 if any are abnormal
"RTN","ORRCACK",75,0)
 ;    @ORY@(ORPAT,ID) = * if abnormal, else null
"RTN","ORRCACK",76,0)
 ; [from ORRCDPT1]
"RTN","ORRCACK",77,0)
 N CNT,ORIFN,ORDT,ABN,X
"RTN","ORRCACK",78,0)
 S ORY=$NA(^TMP($J,"ORRCRSLT")) K @ORY
"RTN","ORRCACK",79,0)
 S ORUSR=+$G(ORUSR),ORPAT=+$G(ORPAT)_";DPT(",CNT=0
"RTN","ORRCACK",80,0)
 S SDATE=$G(SDATE),EDATE=$G(EDATE) D DT1 ;defaults ??
"RTN","ORRCACK",81,0)
 S ORDT=SDATE F  S ORDT=$O(^OR(100,"ARS",ORPAT,ORDT)) Q:ORDT<1  Q:ORDT>EDATE  D
"RTN","ORRCACK",82,0)
 . S ORIFN=0 F  S ORIFN=+$O(^OR(100,"ARS",ORPAT,ORDT,ORIFN)) Q:ORIFN<1  D
"RTN","ORRCACK",83,0)
 .. Q:+$P($G(^OR(100,ORIFN,3)),U,3)=9  ;partial results
"RTN","ORRCACK",84,0)
 .. Q:$$ACKD(ORIFN,ORUSR)  S CNT=CNT+1,X=$P($G(^OR(100,ORIFN,7)),U,2)
"RTN","ORRCACK",85,0)
 .. S @ORY@(+ORPAT,"ORR:"_ORIFN)=$S(X:"*",1:"") S:X ABN=1
"RTN","ORRCACK",86,0)
 S:CNT @ORY@(+ORPAT)=CNT_U_$G(ABN)
"RTN","ORRCACK",87,0)
 Q
"RTN","ORRCACK",88,0)
 ;
"RTN","ORRCACK",89,0)
LIST(ORY,ORUSR,ORPAT,ORSLT) ; -- Return orders by ORUSR for ORPAT with new results
"RTN","ORRCACK",90,0)
 ; in @ORY@(#) = Item=ID^Text^ResultDate in HL7 format, and also if ORSLT
"RTN","ORRCACK",91,0)
 ;             = Data=Test^Value^Units^ReferenceRange^CriticalFlag
"RTN","ORRCACK",92,0)
 ;             = Cmnt=result comment
"RTN","ORRCACK",93,0)
 ;            or Text=line of report text
"RTN","ORRCACK",94,0)
 ; RPC = ORRC RESULTS BY PATIENT
"RTN","ORRCACK",95,0)
 N ORN,ORIFN,ORTX,ORDT
"RTN","ORRCACK",96,0)
 S ORY=$NA(^TMP($J,"ORRCRSLT")) K @ORY
"RTN","ORRCACK",97,0)
 S ORUSR=+$G(ORUSR),ORPAT=+$G(ORPAT),ORN=0
"RTN","ORRCACK",98,0)
 S ORIFN=0 F  S ORIFN=+$O(^ORA(102.4,"ACK",ORUSR,ORIFN)) Q:ORIFN<1  I +$P($G(^OR(100,ORIFN,0)),U,2)=ORPAT D
"RTN","ORRCACK",99,0)
 . Q:+$P($G(^OR(100,ORIFN,3)),U,3)=9  ;partial results
"RTN","ORRCACK",100,0)
 . D TEXT^ORQ12(.ORTX,ORIFN) S ORDT=+$G(^OR(100,ORIFN,7))
"RTN","ORRCACK",101,0)
 . S ORN=ORN+1,@ORY@(ORN)="Item=ORR:"_ORIFN_U_ORTX(1)_U_$$FMTHL7^XLFDT(ORDT)
"RTN","ORRCACK",102,0)
 . I $G(ORSLT) D ORD ;add results data to ORY(#)
"RTN","ORRCACK",103,0)
 ;S ORY(0)=CNT
"RTN","ORRCACK",104,0)
 Q
"RTN","ORRCACK",105,0)
 ;
"RTN","ORRCACK",106,0)
LISTD(ORY,ORPAT,ORUSR,ORBEG,OREND,ORSLT) ; -- Return new results for ORPAT
"RTN","ORRCACK",107,0)
 ; between ORBEG & OREND that ORUSR has not acknowledged
"RTN","ORRCACK",108,0)
 ; in @ORY@(#) = Item=ID^Text^ResultDate in HL7 format, and also if ORSLT
"RTN","ORRCACK",109,0)
 ;             = Data=Test^Value^Units^ReferenceRange^CriticalFlag
"RTN","ORRCACK",110,0)
 ;             = Cmnt=result comment
"RTN","ORRCACK",111,0)
 ;            or Text=line of report text
"RTN","ORRCACK",112,0)
 ; RPC = ORRC RESULTS BY DATE
"RTN","ORRCACK",113,0)
 N ORN,ORIFN,ORTX,ORDT,SDATE,EDATE
"RTN","ORRCACK",114,0)
 S ORY=$NA(^TMP($J,"ORRCRSLT")) K @ORY
"RTN","ORRCACK",115,0)
 S ORUSR=+$G(ORUSR),ORPAT=+$G(ORPAT)_";DPT(",ORN=0 D DATES
"RTN","ORRCACK",116,0)
 S ORDT=SDATE F  S ORDT=$O(^OR(100,"ARS",ORPAT,ORDT)) Q:ORDT<1  Q:ORDT>EDATE  D
"RTN","ORRCACK",117,0)
 . S ORIFN=0 F  S ORIFN=+$O(^OR(100,"ARS",ORPAT,ORDT,ORIFN)) Q:ORIFN<1  D
"RTN","ORRCACK",118,0)
 .. Q:+$P($G(^OR(100,ORIFN,3)),U,3)=9  ;partial results
"RTN","ORRCACK",119,0)
 .. Q:$$ACKD(ORIFN,ORUSR)  D TEXT^ORQ12(.ORTX,ORIFN)
"RTN","ORRCACK",120,0)
 .. S ORN=ORN+1,@ORY@(ORN)="Item=ORR:"_ORIFN_U_ORTX(1)_U_$$FMTHL7^XLFDT(ORDT)
"RTN","ORRCACK",121,0)
 .. I $G(ORSLT) D ORD ;add results data to ORY(#)
"RTN","ORRCACK",122,0)
 Q
"RTN","ORRCACK",123,0)
 ;
"RTN","ORRCACK",124,0)
DATES ; -- Return SDATE and EDATE from ORBEG and OREND
"RTN","ORRCACK",125,0)
 ;    [Inverted for rev-chron search]
"RTN","ORRCACK",126,0)
 S SDATE=$$HL7TFM^XLFDT($G(ORBEG)),EDATE=$$HL7TFM^XLFDT($G(OREND))
"RTN","ORRCACK",127,0)
DT1 I EDATE S EDATE=$S($L(EDATE,".")=2:EDATE+.0001,1:EDATE+1)
"RTN","ORRCACK",128,0)
 I SDATE S SDATE=$S($L(SDATE,".")=2:SDATE-.0001,1:SDATE)
"RTN","ORRCACK",129,0)
 S SDATE=9999999-$S(SDATE:SDATE,1:0),EDATE=9999999-$S(EDATE:EDATE,1:9999998)
"RTN","ORRCACK",130,0)
 S X=EDATE,EDATE=SDATE,SDATE=X
"RTN","ORRCACK",131,0)
 Q
"RTN","ORRCACK",132,0)
 ;
"RTN","ORRCACK",133,0)
ACKD(ORDER,USER) ; -- Returns 1 or 0, if USER has acknowledged ORDER
"RTN","ORRCACK",134,0)
 N Y S Y=0
"RTN","ORRCACK",135,0)
 S IFN=0 F  S IFN=$O(^ORA(102.4,"B",+$G(ORDER),IFN)) Q:IFN<1  D  Q:Y
"RTN","ORRCACK",136,0)
 . S X=$G(^ORA(102.4,IFN,0)) I $P(X,U,3),$P(X,U,2)=+$G(USER) S Y=1 Q
"RTN","ORRCACK",137,0)
 Q Y
"RTN","ORRCACK",138,0)
 ;
"RTN","ORRCACK",139,0)
RESULT(ORY,ORDER) ; -- Return results of ORDERs
"RTN","ORRCACK",140,0)
 ; where ORDER(#) = ID
"RTN","ORRCACK",141,0)
 ; in @ORY@(#) = Item=ID^Text^ResultDate in HL7 format, and
"RTN","ORRCACK",142,0)
 ;             = Data=Test^Value^Units^ReferenceRange^CriticalFlag
"RTN","ORRCACK",143,0)
 ;             = Cmnt=result comment
"RTN","ORRCACK",144,0)
 ;            or Text=line of report text
"RTN","ORRCACK",145,0)
 ; RPC = ORRC RESULTS BY ID
"RTN","ORRCACK",146,0)
 N ORN,ORI,ORIFN,ORDT,ORTX
"RTN","ORRCACK",147,0)
 S ORN=0,ORY=$NA(^TMP($J,"ORRCRSLT")) K @ORY
"RTN","ORRCACK",148,0)
 S ORI="" F  S ORI=$O(ORDER(ORI)) Q:ORI=""  S ORIFN=ORDER(ORI) D
"RTN","ORRCACK",149,0)
 . S ORIFN=+$P(ORIFN,":",2),ORDT=+$G(^OR(100,ORIFN,7))
"RTN","ORRCACK",150,0)
 . D TEXT^ORQ12(.ORTX,ORIFN)
"RTN","ORRCACK",151,0)
 . S ORN=ORN+1,@ORY@(ORN)="Item=ORR:"_ORIFN_U_ORTX(1)_U_$$FMTHL7^XLFDT(ORDT)
"RTN","ORRCACK",152,0)
 . D ORD
"RTN","ORRCACK",153,0)
 Q
"RTN","ORRCACK",154,0)
 ;
"RTN","ORRCACK",155,0)
ORD ; -- Add results for ORIFN to @ORY@(ORN)
"RTN","ORRCACK",156,0)
 N PKG Q:'+$G(ORIFN)
"RTN","ORRCACK",157,0)
 S PKG=+$P($G(^OR(100,ORIFN,0)),U,14),PKG=$$NMSP^ORCD(PKG)
"RTN","ORRCACK",158,0)
 I "^LR^RA^GMRC^"'[(U_PKG_U)!'ORIFN S ORY(1)="Text=No results available." Q  ;DT??
"RTN","ORRCACK",159,0)
 D @PKG
"RTN","ORRCACK",160,0)
 Q
"RTN","ORRCACK",161,0)
LR ; -- Lab results
"RTN","ORRCACK",162,0)
 N ORVP,LRID,LRTST,LRSUB,I,X K ^TMP("LRRR",$J)
"RTN","ORRCACK",163,0)
 S ORVP=$P($G(^OR(100,ORIFN,0)),U,2),LRID=$G(^(4))
"RTN","ORRCACK",164,0)
 I '$L(LRID) S ORN=ORN+1,@ORY@(ORN)="Text=No results available." Q
"RTN","ORRCACK",165,0)
 S X=$$VALUE^ORCSAVE2(ORIFN,"ORDERABLE"),LRTST=+$P($G(^ORD(101.43,+X,0)),U,2)
"RTN","ORRCACK",166,0)
 I +LRID  D RR^LR7OR1(+ORVP,LRID,,,,LRTST) I '$D(^TMP("LRRR",$J,+ORVP)) S $P(LRID,";",1,3)=";;" ;Order possibly purged, reset to lookup on file 63
"RTN","ORRCACK",167,0)
 I '+LRID,$P(LRID,";",5)  D RR^LR7OR1(+ORVP,,9999999-$P(LRID,";",5),9999999-$P(LRID,";",5),$P(LRID,";",4),LRTST)
"RTN","ORRCACK",168,0)
 I '$D(^TMP("LRRR",$J,+ORVP)) S ORN=ORN+1,@ORY@(ORN)="Text=No results available." Q
"RTN","ORRCACK",169,0)
 S LRSUB=$O(^TMP("LRRR",$J,+ORVP,"")) Q:LRSUB=""
"RTN","ORRCACK",170,0)
 S LRDT=$O(^TMP("LRRR",$J,+ORVP,LRSUB,0)) I LRDT S LRDT=9999999-LRDT,$P(@ORY@(ORN),U,3)=$$FMTHL7^XLFDT(LRDT) ;return Coll Dt instead of Results Dt
"RTN","ORRCACK",171,0)
 I LRSUB="CH" D  K ^TMP("LRRR",$J) Q
"RTN","ORRCACK",172,0)
 . N TEST,LRDT,LRN,LRI M TEST=^TMP("LRRR",$J,+ORVP,"CH")
"RTN","ORRCACK",173,0)
 . S LRDT=0 F  S LRDT=$O(TEST(LRDT)) Q:LRDT<1  S LRN=0 F  S LRN=$O(TEST(LRDT,LRN)) Q:LRN=""  D
"RTN","ORRCACK",174,0)
 .. I LRN S I=$G(TEST(LRDT,LRN)),X=$P($G(^LAB(60,+I,0)),U)_U_$P(I,U,2)_U_$P(I,U,4,5)_U_$P(I,U,3) S ORN=ORN+1,@ORY@(ORN)="Data="_X
"RTN","ORRCACK",175,0)
 .. I LRN="N" S LRI=0 F  S LRI=$O(TEST(LRDT,LRN,LRI)) Q:LRI<1  S ORN=ORN+1,@ORY@(ORN)="Cmnt="_$G(TEST(LRDT,LRN,LRI))
"RTN","ORRCACK",176,0)
 K ^TMP("LRC",$J) D EN1^LR7OSBR(+ORVP):LRSUB="BB",EN^LR7OSMZ0(+ORVP):LRSUB="MI"
"RTN","ORRCACK",177,0)
 S I=0 F  S I=+$O(^TMP("LRC",$J,I)) Q:I<1  S X=$G(^(I,0)),ORN=ORN+1,@ORY@(ORN)="Text="_X
"RTN","ORRCACK",178,0)
 K ^TMP("LRC",$J),^TMP("LRRR",$J)
"RTN","ORRCACK",179,0)
 Q
"RTN","ORRCACK",180,0)
RA ; -- Radiology results
"RTN","ORRCACK",181,0)
 N ORVP,RAID,CASE,PROC,PSET,FIRST
"RTN","ORRCACK",182,0)
 S ORVP=$P($G(^OR(100,ORIFN,0)),U,2),RAID=+$G(^(4)) D EN30^RAO7PC3(RAID)
"RTN","ORRCACK",183,0)
 S PSET=$D(^TMP($J,"RAE3",+ORVP,"PRINT_SET")),FIRST=1
"RTN","ORRCACK",184,0)
 I 'PSET S CASE=0 F  S CASE=$O(^TMP($J,"RAE3",+ORVP,CASE)) Q:CASE'>0  D
"RTN","ORRCACK",185,0)
 . S PROC="" F  S PROC=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC)) Q:PROC=""  D XRPT
"RTN","ORRCACK",186,0)
 I PSET S CASE=$O(^TMP($J,"RAE3",+ORVP,0)),PROC=$O(^(CASE,"")) D XRPT
"RTN","ORRCACK",187,0)
 K ^TMP($J,"RAE3",+ORVP)
"RTN","ORRCACK",188,0)
 Q
"RTN","ORRCACK",189,0)
XRPT ; -- body of report for CASE, PROC
"RTN","ORRCACK",190,0)
 N ORD,X,I
"RTN","ORRCACK",191,0)
 I 'FIRST S ORN=ORN+1,@ORY@(ORN)="Text="_$$REPEAT^XLFSTR(" * ",24)
"RTN","ORRCACK",192,0)
 S ORD=$S($L($G(^TMP($J,"RAE3",+ORVP,"ORD"))):^("ORD"),$L($G(^("ORD",CASE))):^(CASE),1:"") I $L(ORD),ORD'=PROC S ORN=ORN+1,@ORY@(ORN)="Text=Proc Ord: "_ORD
"RTN","ORRCACK",193,0)
 S I=1 F  S I=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC,I)) Q:I'>0  S X=^(I),ORN=ORN+1,@ORY@(ORN)="Text="_X ;Skip pt ID on line 1
"RTN","ORRCACK",194,0)
 S FIRST=0
"RTN","ORRCACK",195,0)
 Q
"RTN","ORRCACK",196,0)
GMRC ; -- Consult results
"RTN","ORRCACK",197,0)
 N GMRCID,I,X,SUB S GMRCID=+$G(^OR(100,ORIFN,4)),SUB="RT" N ORIFN ;protect
"RTN","ORRCACK",198,0)
 I '$D(^GMR(123,GMRCID,50,"B")),'$D(^GMR(123,GMRCID,51,"B")) S SUB="DT"
"RTN","ORRCACK",199,0)
 D RT^GMRCGUIA(GMRCID,"^TMP(""GMRCR"",$J,""RT"")"):SUB="RT",DT^GMRCSLM2(GMRCID):SUB="DT"
"RTN","ORRCACK",200,0)
 S I=0 F  S I=$O(^TMP("GMRCR",$J,SUB,I)) Q:I'>0  S X=$G(^(I,0)),ORN=ORN+1,@ORY@(ORN)="Text="_X
"RTN","ORRCACK",201,0)
 K ^TMP("GMRCR",$J)
"RTN","ORRCACK",202,0)
 Q
"RTN","ORRCDPT")
1^1^^B27732159
"RTN","ORRCDPT1")
1^2^^B23709488
"RTN","ORRCEVT")
1^3^^B52026948
"RTN","ORRCLNP")
0^16^B585941^B585941
"RTN","ORRCLNP",1,0)
ORRCLNP ; SLC/JER - Person functions for CM ; 9/23/04 14:30
"RTN","ORRCLNP",2,0)
 ;;1.0;CARE MANAGEMENT;**1**;Jul 15, 2003;Build 8
"RTN","ORRCLNP",3,0)
EMAIL(USER) ; e-mail address
"RTN","ORRCLNP",4,0)
 Q $$NETNAME^XMXUTIL(USER)
"RTN","ORRCLNP",5,0)
NAME(USER) ; Person Name
"RTN","ORRCLNP",6,0)
 Q $$NAME^XUSER(USER)
"RTN","ORRCLNP",7,0)
SSNL4(USER) ; SSN Last4
"RTN","ORRCLNP",8,0)
 N ORRCY
"RTN","ORRCLNP",9,0)
 S ORRCY=$$GET1^DIQ(200,USER,9)
"RTN","ORRCLNP",10,0)
 Q $S(+ORRCY:$E(ORRCY,6,10),1:ORRCY)
"RTN","ORRCLNP",11,0)
SEX(USER) ; Person SEX
"RTN","ORRCLNP",12,0)
 Q $$GET1^DIQ(200,USER,4,"I")
"RTN","ORRCLNP",13,0)
PROVIDER(USER) ; Boolean fn: is user a provider
"RTN","ORRCLNP",14,0)
 Q $S(+$D(^XUSEC("PROVIDER",USER)):1,+$$ISA^USRLM(USER,"PROVIDER"):1,1:0)
"RTN","ORRCLNP",15,0)
 ;
"RTN","ORRCLNP",16,0)
SYS(PROD) ;RPC to determine if current system is PROD or TEST
"RTN","ORRCLNP",17,0)
 ; **Requires XU*8.0*284
"RTN","ORRCLNP",18,0)
 ;
"RTN","ORRCLNP",19,0)
 ; Input: NONE
"RTN","ORRCLNP",20,0)
 ; Output: returned in PROD
"RTN","ORRCLNP",21,0)
 ;      1 if production system
"RTN","ORRCLNP",22,0)
 ;      0 if not production system
"RTN","ORRCLNP",23,0)
 ;
"RTN","ORRCLNP",24,0)
 S PROD=+$$PROD^XUPROD
"RTN","ORRCLNP",25,0)
 Q
"RTN","ORRCLPT")
1^4^^B266293
"RTN","ORRCOA")
1^5^^B11062549
"RTN","ORRCOR")
1^6^^B48128294
"RTN","ORRCQLPT")
0^17^B1006284^B1006284
"RTN","ORRCQLPT",1,0)
ORRCQLPT  ; SLC/TH - CPRS Query Tools - Libraries ; 25 Jul 2003  9:31 AM
"RTN","ORRCQLPT",2,0)
 ;;1.0;CARE MANAGEMENT;;Jul 15, 2003;Build 8
"RTN","ORRCQLPT",3,0)
 ;
"RTN","ORRCQLPT",4,0)
PTDFN(VAL,ID) ; Return patient info given an order, consult, or note
"RTN","ORRCQLPT",5,0)
 N DFN,X,X0,X1,X101
"RTN","ORRCQLPT",6,0)
 S VAL="",DFN=0,X=$P(ID,":")
"RTN","ORRCQLPT",7,0)
 I X="ORD"!(X="CST") S DFN=+$P(^OR(100,+$P(ID,":",2),0),U,2)
"RTN","ORRCQLPT",8,0)
 I X="DOC" S DFN=+$P(^TIU(8925,+$P(ID,":",2),0),U,2)
"RTN","ORRCQLPT",9,0)
 I X="PTC" S DFN=+$P(ID,":",2)
"RTN","ORRCQLPT",10,0)
 ;I X="VST" visits too?
"RTN","ORRCQLPT",11,0)
 Q:'DFN
"RTN","ORRCQLPT",12,0)
 S VAL=DFN
"RTN","ORRCQLPT",13,0)
 Q
"RTN","ORRCQLPT",14,0)
 ;
"RTN","ORRCQLPT",15,0)
PTDEMOS(ORY,DFN) ; Return patient info
"RTN","ORRCQLPT",16,0)
 ; ORY="<dfn>^<name>^<ssn>^<dob>^<age>"
"RTN","ORRCQLPT",17,0)
 ; RPC = ORRCQLPT PTDEMOS
"RTN","ORRCQLPT",18,0)
 N VADM,VA,VAERR
"RTN","ORRCQLPT",19,0)
 D DEM^VADPT
"RTN","ORRCQLPT",20,0)
 S ORY=DFN_U_VADM(1)_U_VA("PID")_U_$$FMTHL7^XLFDT(+VADM(3))_U_VADM(4)
"RTN","ORRCQLPT",21,0)
 Q
"RTN","ORRCQLPT",22,0)
 ;
"RTN","ORRCQLPT",23,0)
TESTPTD(DFN)    ; Test PTDEMOS
"RTN","ORRCQLPT",24,0)
 N ORY
"RTN","ORRCQLPT",25,0)
 D PTDEMOS(.ORY,DFN)
"RTN","ORRCQLPT",26,0)
 W !,ORY
"RTN","ORRCQLPT",27,0)
 Q
"RTN","ORRCSIG")
1^7^^B11096954
"RTN","ORRCTIU")
1^8^^B31325045
"RTN","ORRCTSK")
1^9^^B44307761
"RTN","ORRCVIT")
1^10^^B17118495
"RTN","ORRCXQ")
1^11^^B20320443
"RTN","ORRCY08")
1^12^^B2082563
"RTN","ORRCY7")
1^13^^B1627643
"RTN","ORRCYP01")
1^14^^B1869759
"VER")
8.0^22.2
"BLD",11435,6)
^10
**END**
**END**

