Released DI*22*170 SEQ #150
Extracted from mail message
**KIDS**:DI*22.0*170^

**INSTALL NAME**
DI*22.0*170
"BLD",1001,0)
DI*22.0*170^VA FILEMAN^0^3140113^y
"BLD",1001,1,0)
^^1^1^3140107^^^^
"BLD",1001,1,1,0)
See the Patch Module on FORUM for complete information.
"BLD",1001,4,0)
^9.64PA^^
"BLD",1001,6.3)
10
"BLD",1001,"INID")
n
"BLD",1001,"KRN",0)
^9.67PA^779.2^20
"BLD",1001,"KRN",.4,0)
.4
"BLD",1001,"KRN",.401,0)
.401
"BLD",1001,"KRN",.402,0)
.402
"BLD",1001,"KRN",.403,0)
.403
"BLD",1001,"KRN",.5,0)
.5
"BLD",1001,"KRN",.84,0)
.84
"BLD",1001,"KRN",3.6,0)
3.6
"BLD",1001,"KRN",3.8,0)
3.8
"BLD",1001,"KRN",9.2,0)
9.2
"BLD",1001,"KRN",9.8,0)
9.8
"BLD",1001,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",1001,"KRN",9.8,"NM",1,0)
DIC^^0^B24503257
"BLD",1001,"KRN",9.8,"NM",2,0)
DICF1^^0^B22563783
"BLD",1001,"KRN",9.8,"NM",3,0)
DIR^^0^B22624291
"BLD",1001,"KRN",9.8,"NM","B","DIC",1)

"BLD",1001,"KRN",9.8,"NM","B","DICF1",2)

"BLD",1001,"KRN",9.8,"NM","B","DIR",3)

"BLD",1001,"KRN",19,0)
19
"BLD",1001,"KRN",19.1,0)
19.1
"BLD",1001,"KRN",101,0)
101
"BLD",1001,"KRN",409.61,0)
409.61
"BLD",1001,"KRN",771,0)
771
"BLD",1001,"KRN",779.2,0)
779.2
"BLD",1001,"KRN",870,0)
870
"BLD",1001,"KRN",8989.51,0)
8989.51
"BLD",1001,"KRN",8989.52,0)
8989.52
"BLD",1001,"KRN",8994,0)
8994
"BLD",1001,"KRN","B",.4,.4)

"BLD",1001,"KRN","B",.401,.401)

"BLD",1001,"KRN","B",.402,.402)

"BLD",1001,"KRN","B",.403,.403)

"BLD",1001,"KRN","B",.5,.5)

"BLD",1001,"KRN","B",.84,.84)

"BLD",1001,"KRN","B",3.6,3.6)

"BLD",1001,"KRN","B",3.8,3.8)

"BLD",1001,"KRN","B",9.2,9.2)

"BLD",1001,"KRN","B",9.8,9.8)

"BLD",1001,"KRN","B",19,19)

"BLD",1001,"KRN","B",19.1,19.1)

"BLD",1001,"KRN","B",101,101)

"BLD",1001,"KRN","B",409.61,409.61)

"BLD",1001,"KRN","B",771,771)

"BLD",1001,"KRN","B",779.2,779.2)

"BLD",1001,"KRN","B",870,870)

"BLD",1001,"KRN","B",8989.51,8989.51)

"BLD",1001,"KRN","B",8989.52,8989.52)

"BLD",1001,"KRN","B",8994,8994)

"BLD",1001,"PRE")
DI170ENV
"BLD",1001,"QDEF")
^^^^YES^^^^NO^^NO
"BLD",1001,"QUES",0)
^9.62^^
"BLD",1001,"REQB",0)
^9.611^3^3
"BLD",1001,"REQB",1,0)
DI*22.0*164^1
"BLD",1001,"REQB",2,0)
DI*22.0*135^1
"BLD",1001,"REQB",3,0)
DI*22.0*163^1
"BLD",1001,"REQB","B","DI*22.0*135",2)

"BLD",1001,"REQB","B","DI*22.0*163",3)

"BLD",1001,"REQB","B","DI*22.0*164",1)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
VA FILEMAN^DI^FM INIT
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
22.0^2990330^3121119^1163
"PKG",5,22,1,"PAH",1,0)
170^3140113
"PKG",5,22,1,"PAH",1,1,0)
^^1^1^3140113
"PKG",5,22,1,"PAH",1,1,1,0)
See the Patch Module on FORUM for complete information.
"PRE")
DI170ENV
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
YES
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","DI170ENV")
0^^B4935382^n/a
"RTN","DI170ENV",1,0)
DI170ENV ;OIFO-Oakland/RD - ENVIRONMENT CHECK ROUTINE ;
"RTN","DI170ENV",2,0)
 ;;22.0;VA FileMan;**170**;Mar 30, 1999;Build 10
"RTN","DI170ENV",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DI170ENV",4,0)
 ;
"RTN","DI170ENV",5,0)
 ;this routine is used to test patch DI*22*170
"RTN","DI170ENV",6,0)
 Q
"RTN","DI170ENV",7,0)
EN ;Test Remedy ticket 865632
"RTN","DI170ENV",8,0)
 D I1,I2
"RTN","DI170ENV",9,0)
 Q
"RTN","DI170ENV",10,0)
I1 ;issue 1
"RTN","DI170ENV",11,0)
 N DIC,X,Y,$ESTACK,$ETRAP S $ETRAP="D ERR^DI170ENV"
"RTN","DI170ENV",12,0)
 W !!,"This routine will test the fixes in patch DI*22*170."
"RTN","DI170ENV",13,0)
 W !!,"Issue 1: undefined error when user enter '?' after a list and asked to choose."
"RTN","DI170ENV",14,0)
 W !!," Step 1.  Enter '?' at the 'CHOOSE 1-5:' prompt."
"RTN","DI170ENV",15,0)
 W !," Step 2.  Enter 'NO' at the 'Do you want... INSTITUTION List?' prompt."
"RTN","DI170ENV",16,0)
 W !," Step 3.  If you don't get an error, then enter '^' at the next prompt."
"RTN","DI170ENV",17,0)
 W !!,"Begin Test 1:",!
"RTN","DI170ENV",18,0)
 S DIC="^DIC(4,",DIC(0)="QEM",X="500G"
"RTN","DI170ENV",19,0)
 D ^DIC
"RTN","DI170ENV",20,0)
 W !!,"Test Passed, no error occurred",!!
"RTN","DI170ENV",21,0)
 Q
"RTN","DI170ENV",22,0)
I2 ;issue 2
"RTN","DI170ENV",23,0)
 N DIR,DIRUT,DIOUT,X,Y
"RTN","DI170ENV",24,0)
 W !!,"Issue 2: User can't '^' out of the reader(DIR) on a pointer field or type."
"RTN","DI170ENV",25,0)
 W !!," Step 1.  Enter 'VISN' at the 'Select INSTITUTION:' prompt."
"RTN","DI170ENV",26,0)
 W !," Step 2.  Enter '^' at the 'CHOOSE 1-5:' prompt."
"RTN","DI170ENV",27,0)
 W !," Step 3.  Hit ""Enter key"" at next two prompts."
"RTN","DI170ENV",28,0)
 W !!,"Begin Test 2:",!
"RTN","DI170ENV",29,0)
 S DIR(0)="PO^4:EM"
"RTN","DI170ENV",30,0)
 D ^DIR
"RTN","DI170ENV",31,0)
 W !!!,"If you saw a long description about the INSTITUTION file and was prompted"
"RTN","DI170ENV",32,0)
 W !,"to view the entire INSTITUTION List, then the test FAILED."
"RTN","DI170ENV",33,0)
 W !!,"If you only saw the 'Select INSTITUTION:' prompt again, the test Passed.",!!!
"RTN","DI170ENV",34,0)
 Q
"RTN","DI170ENV",35,0)
ERR ;this is where the error is trapped
"RTN","DI170ENV",36,0)
 S X=$$EC^%ZOSV ;Get the error code
"RTN","DI170ENV",37,0)
 W !!,X,!
"RTN","DI170ENV",38,0)
 W "**Test FAILED**",!!
"RTN","DI170ENV",39,0)
 D UNWIND^%ZTER
"RTN","DI170ENV",40,0)
 Q
"RTN","DIC")
0^1^B24503257^B24056590
"RTN","DIC",1,0)
DIC ;SFISC/XAK,TKW,SEA/TOAD-VA FileMan: Lookup, Part 1 ;2:48 PM  11 Jun 2013
"RTN","DIC",2,0)
 ;;22.0;VA FileMan;**4,17,20,78,164,170**;Mar 30, 1999;Build 10
"RTN","DIC",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIC",4,0)
 N %,D,DF,DIFILEI,DIENS,DINDEX,DS,DIASKOK K DO S U="^",DIC(0)=$G(DIC(0))
"RTN","DIC",5,0)
 D GETFILE^DIC0(.DIC,.DIFILEI,.DIENS) I DIFILEI="" S Y=-1 Q
"RTN","DIC",6,0)
 S %=$P("K^",U,DIC(0)["K"),(D,DINDEX,DINDEX("START"))=$$DINDEX^DICL(DIFILEI,%)
"RTN","DIC",7,0)
 K %
"RTN","DIC",8,0)
EN I $G(DIFILEI)=""!('$D(DINDEX)#2) N DIFILEI,DIENS,DINDEX,DIASKOK,%
"RTN","DIC",9,0)
 K DO,DICR,DIROUT,DTOUT,DUOUT S U="^"
"RTN","DIC",10,0)
 D INIT^DIC0 I DIFILEI="" S Y=-1 D Q^DIC2 Q
"RTN","DIC",11,0)
 S DIC(0)=$G(DIC(0)) D
"RTN","DIC",12,0)
 . I DIC(0)["T" K ^TMP($J,"DICSEEN") S ^TMP($J,"DICSEEN",DIFILEI)=""
"RTN","DIC",13,0)
 . I $D(ZTQUEUED),$E($G(IOST),1,2)'="C-" S DIC(0)=$TR(DIC(0),"AEQ")
"RTN","DIC",14,0)
 . I DIC(0)["X",DIC(0)["O" S DIC(0)=$TR(DIC(0),"O")
"RTN","DIC",15,0)
 . S:DINDEX("#")>1 DIC(0)=$TR(DIC(0),"M") Q
"RTN","DIC",16,0)
 N DIPGM S DIPGM=$$PGM^DIC2(.DIC,$G(DF),DIFILEI)
"RTN","DIC",17,0)
 I DIPGM]"" D KILL1^DIC0 K DIC("W") S DIPGM(0)=1 G @DIPGM
"RTN","DIC",18,0)
ASK I $G(DIFILEI)=""!('$D(DINDEX)#2) N DIFILEI,DIENS,DINDEX,DIASKOK,% D INIT^DIC0 I DIFILEI="" S Y=-1 D Q^DIC2 Q
"RTN","DIC",19,0)
 I '$D(DIVAL) N DIVAL,DIALLVAL
"RTN","DIC",20,0)
 K DIVAL,DIALLVAL S DIVAL(0)=0,Y=-1,DIALLVAL=1
"RTN","DIC",21,0)
 I DIC(0)["A" K X W ! D ^DIC1 I $G(DTOUT) D Q^DIC2 Q
"RTN","DIC",22,0)
 I DIC(0)'["A" D CHKVAL^DIC0,CHKVAL2^DIC0(DINDEX("#"),.DIVAL,DIC(0),.DDS)
"RTN","DIC",23,0)
A1 I DIVAL(0) D
"RTN","DIC",24,0)
 . D CHKVAL1^DIC0(DINDEX("#"),.DIVAL,DIC(0),DIC(0),.DIALLVAL) Q:'DIVAL(0)
"RTN","DIC",25,0)
 . I $D(DIADD),X]"",X'["""" S (X,DIVAL(1))=""""_X_"""" S:DINDEX("#")>1 X(1)=X
"RTN","DIC",26,0)
 . N DUOUT K DINDEX S (DINDEX,DINDEX("START"))=D,DINDEX("WAY")=1
"RTN","DIC",27,0)
 . D INDEX^DICUIX(.DIFILEI,"4l",.DINDEX,"",.DIVAL) Q
"RTN","DIC",28,0)
X ;
"RTN","DIC",29,0)
 I $G(DIFILEI)=""!('$D(DINDEX)#2) K DUOUT,DTOUT N DIFILEI,DIENS,DINDEX,DIASKOK,% N:'$D(DIVAL(0)) DIVAL,DIALLVAL D  I DIFILEI="" S Y=-1 D Q^DIC2 Q
"RTN","DIC",30,0)
 . D INIT^DIC0 Q:$D(DIVAL(0))!(DIFILEI="")
"RTN","DIC",31,0)
 . D SETVAL^DIC0 Q
"RTN","DIC",32,0)
 I DIVAL(0),$D(^DD(DIFILEI,.01,7.5)) X ^(7.5) D NODE75^DIC5 I $G(X)="" G:DIC(0)["A" ASK D Q^DIC2 Q
"RTN","DIC",33,0)
 N DIPGM S DIPGM=$S(DIVAL(0)'>1:$$PGM^DIC2(.DIC,$G(DF),DIFILEI),1:"")
"RTN","DIC",34,0)
 I DIPGM]"" D KILL2^DIC0 S DIPGM(0)=2 G @DIPGM
"RTN","DIC",35,0)
RTN I $G(DIFILEI)=""!('$D(DINDEX)#2) N DIFILEI,DIENS,DINDEX,DIASKOK,% N:'$D(DIVAL(0)) DIVAL,DIALLVAL D  I DIFILEI="" S Y=-1 D Q^DIC2 Q
"RTN","DIC",36,0)
 . D INIT^DIC0 Q:$D(DIVAL(0))!(DIFILEI="")
"RTN","DIC",37,0)
 . D SETVAL^DIC0 Q
"RTN","DIC",38,0)
 I X?1."?" D  Q:$G(DTOUT)  G:DIC(0)["A" ASK Q
"RTN","DIC",39,0)
 . D DSPHLP^DICQ(.DIC,.DIFILEI,.DINDEX,X)
"RTN","DIC",40,0)
 . S Y=-1 Q
"RTN","DIC",41,0)
 I DIVAL(0)=0!($G(DUOUT)) S Y=-1 D Q^DIC2 Q
"RTN","DIC",42,0)
 D:'$D(DO) GETFA^DIC1(.DIC,.DO)
"RTN","DIC",43,0)
 I X?1"`".NP S Y=-1 D BYIEN1^DIC5 Q:Y>0  I '$$TRYADD^DIC11(.DIC,DIFILEI) D DING G:DIC(0)["A" ASK D Q^DIC2 Q
"RTN","DIC",44,0)
 I DIVAL(0)=1,+$P(X,"E")=X,X>0 S Y=-1 N DISKIPIX D BYIEN2^DIC5 Q:Y>0
"RTN","DIC",45,0)
 I X=" ",$L(DIC)<29,$D(^DISV(DUZ,DIC))#2 S Y=+^(DIC) D SPACEBAR^DIC5 Q:Y>0  D DING G:DIC(0)["A" ASK D Q^DIC2 Q
"RTN","DIC",46,0)
F ; Start regular lookup
"RTN","DIC",47,0)
 N DD,DS,DIX,DIY,DIYX,DIDONE,DISAVDS,%Y,%H,DISYS
"RTN","DIC",48,0)
 I $G(DIFILEI)=""!('$D(DINDEX)#2) N DIFILEI,DIENS,DINDEX,DIASKOK,% N:'$D(DIVAL(0)) DIVAL,DIALLVAL D
"RTN","DIC",49,0)
 . D INIT^DIC0 Q:$D(DIVAL(0))
"RTN","DIC",50,0)
 . D SETVAL^DIC0 Q
"RTN","DIC",51,0)
F1 S (DD,DS,DS(0),DS("DD"))=0
"RTN","DIC",52,0)
 D SEARCH^DIC3
"RTN","DIC",53,0)
 I $G(DTOUT)!(Y'<0) D Q^DIC2 Q
"RTN","DIC",54,0)
 I $P(DS(0),U,2)="?",(DIC(0)_$G(DICR(1,0)))'["A" D K,INDEX^DICUIX(.DIFILEI,"4l",.DINDEX,"",.DIVAL) G F1 ;**170
"RTN","DIC",55,0)
 I +DS(0)=2 S X=$P(DS(0),U,2) D K D  G A1
"RTN","DIC",56,0)
 . K DIVAL,DIALLVAL S DIVAL(0)=0,Y=-1,DIALLVAL=1
"RTN","DIC",57,0)
 . D CHKVAL^DIC0,CHKVAL2^DIC0(DINDEX("#"),.DIVAL,DIC(0),.DDS)
"RTN","DIC",58,0)
 . Q
"RTN","DIC",59,0)
 D  D K I Y<0,DIC(0)["A" D D^DIC0 W:DIC(0)["E" ! K:$D(DIROUT) DIROUT G ASK
"RTN","DIC",60,0)
 . Q:$G(DIROUT)
"RTN","DIC",61,0)
 . I DS(0),$P(DS(0),U,2)="" S:DIC(0)["Y"&($O(Y(0))) Y=0 D DING Q
"RTN","DIC",62,0)
 . Q:'($D(DS)#2)
"RTN","DIC",63,0)
 . I (DS(0)=0!($P(DS(0),U,2)="U")),DS("DD")=DS,(DO(2)["O"!($G(DIASKOK))!(DIC(0)["T")),DO(2)'["A",DO(2)'["P",DO(2)'["V",DO(2)'["D",DO(2)'["S",DIC(0)["L" D L^DICM
"RTN","DIC",64,0)
 . Q
"RTN","DIC",65,0)
 D Q^DIC2 Q
"RTN","DIC",66,0)
 ;
"RTN","DIC",67,0)
K K DD,DS,DIX,DIY,DIYX,DIDONE,DISAVDS
"RTN","DIC",68,0)
 I '$G(DICR),DIC(0)["T" K ^TMP($J,"DICSEEN") S ^TMP($J,"DICSEEN",DIFILEI)=""
"RTN","DIC",69,0)
 Q
"RTN","DIC",70,0)
 ;
"RTN","DIC",71,0)
DING Q:DIC(0)'["Q"!(DIC(0)'["E")
"RTN","DIC",72,0)
 W:'$D(DUOUT) $C(7)_$S('$D(DDS):" ??",1:"") Q
"RTN","DIC",73,0)
 ;
"RTN","DIC",74,0)
 ;
"RTN","DIC",75,0)
IX N DINDEX,DF
"RTN","DIC",76,0)
 S (DF,DINDEX,DINDEX("START"))=D
"RTN","DIC",77,0)
 G EN
"RTN","DIC",78,0)
 ;
"RTN","DIC",79,0)
A K DIY,DIYX,DS I DIC(0)["A" D D^DIC0 Q
"RTN","DIC",80,0)
NO S Y=-1 D Q^DIC2 Q
"RTN","DIC",81,0)
 ;
"RTN","DIC",82,0)
 ; DBS Entry points
"RTN","DIC",83,0)
LIST(DIFILE,DIFIEN,DIFIELDS,DIFLAGS,DINUMBER,DIFROM,DIPART,DINDEX,DISCREEN,DIWRITE,DILIST,DIMSGA) ;
"RTN","DIC",84,0)
 ;ENTRY POINT--return a list of entries from a file  (SEA/TOAD)
"RTN","DIC",85,0)
 G IN^DICL
"RTN","DIC",86,0)
 ;
"RTN","DIC",87,0)
FIND1(DIFILE,DIFIEN,DIFLAGS,DIVALUE,DIFORCE,DISCREEN,DIMSGA) ;SEA/TOAD
"RTN","DIC",88,0)
 ;ENTRY POINT--find a single entry in the file
"RTN","DIC",89,0)
 I '$D(DIQUIET) N DIQUIET S DIQUIET=1
"RTN","DIC",90,0)
 I '$D(DIFM) N DIFM S DIFM=1 D INIZE^DIEFU
"RTN","DIC",91,0)
 N DICLERR S DICLERR=$G(DIERR) K DIERR
"RTN","DIC",92,0)
 N DIERN,DIFIND,DIPE,DITARGET
"RTN","DIC",93,0)
 N DIVALS M DIVALS=DIVALUE I $G(DIVALS)="" S DIVALS=$G(DIVALUE(1))
"RTN","DIC",94,0)
 D FIND^DICF($G(DIFILE),$G(DIFIEN),"",$G(DIFLAGS)_"f",.DIVALUE,1,$G(DIFORCE),.DISCREEN,"","DITARGET")
"RTN","DIC",95,0)
 I $D(DIERR) S DIFIND=""
"RTN","DIC",96,0)
 E  I $P($G(DITARGET(0)),U,3) K DITARGET S DIFIND="" D
"RTN","DIC",97,0)
 . I $O(DIVALS(1)) N I F I=1:0 S I=$O(DIVALS(I)) Q:'I  D:DIVALS(I)]""  Q:'I
"RTN","DIC",98,0)
 . . I ($L(DIVALS)+$L(DIVALS(I)))>100 S DIVALS=DIVALS_"...",I="" Q
"RTN","DIC",99,0)
 . . S DIVALS=DIVALS_$P(", ^",U,DIVALS]"")_DIVALS(I) Q
"RTN","DIC",100,0)
 . D ERR^DICF4(299,$G(DIFILE),$G(DIFIEN),"",DIVALS)
"RTN","DIC",101,0)
 . Q
"RTN","DIC",102,0)
 E  S DIFIND=+$G(DITARGET(1))
"RTN","DIC",103,0)
 I DICLERR'=""!$G(DIERR) D
"RTN","DIC",104,0)
 . S DIERR=$G(DIERR)+DICLERR_U_($P($G(DIERR),U,2)+$P(DICLERR,U,2))
"RTN","DIC",105,0)
 I $G(DIMSGA)'="" D CALLOUT^DIEFU(DIMSGA)
"RTN","DIC",106,0)
 Q DIFIND
"RTN","DIC",107,0)
 ;
"RTN","DIC",108,0)
FIND(DIFILE,DIFIEN,DIFIELDS,DIFLAGS,DIVALUE,DINUMBER,DIFORCE,DISCREEN,DIWRITE,DILIST,DIMSGA) ;SEA/TOAD
"RTN","DIC",109,0)
 ;ENTRY POINT--in a file find entries that match a value
"RTN","DIC",110,0)
 G FINDX^DICF
"RTN","DIC",111,0)
 ;
"RTN","DIC",112,0)
 ; Error messages:
"RTN","DIC",113,0)
 ; 299  More than one entry matches the value(s) '|1|'
"RTN","DIC",114,0)
 ; 120  The previous error occurred when performing
"RTN","DIC",115,0)
 ; 8090 Pre-lookup transform (7.5 node)
"RTN","DIC",116,0)
 ;
"RTN","DICF1")
0^2^B22563783^B22351550
"RTN","DICF1",1,0)
DICF1 ;SEA/TOAD,SF/TKW-VA FileMan: Finder, Part 2 (Transform) ;1:48 PM  17 Jun 2013
"RTN","DICF1",2,0)
 ;;22.0;VA FileMan;**15,51,70,135,170**;Mar 30, 1999;Build 10
"RTN","DICF1",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DICF1",4,0)
 ;
"RTN","DICF1",5,0)
XFORM(DIFLAGS,DIVALUE,DISCREEN,DINDEX) ;
"RTN","DICF1",6,0)
 ; FIND--produce array of values and screens by transforming input
"RTN","DICF1",7,0)
 ; subroutine, DIVALUE, DINDEX, & DISCREEN passed by reference
"RTN","DICF1",8,0)
 N DISUB F DISUB=1:1:DINDEX("#") D VALUES
"RTN","DICF1",9,0)
 Q
"RTN","DICF1",10,0)
VALUES ; Set original lookup value into array.
"RTN","DICF1",11,0)
 I $D(DIVALUE(DISUB,0,1)) S DIVALUE(DISUB)=DIVALUE(DISUB,0,1)
"RTN","DICF1",12,0)
 N I F I="PART","FROM","TO" I $D(DIVALUE(DISUB,0,1,I)) D
"RTN","DICF1",13,0)
 . S DINDEX(DISUB,I)=DIVALUE(DISUB,0,1,I) Q
"RTN","DICF1",14,0)
 D
"RTN","DICF1",15,0)
 . S I=-1 F  S I=$O(DIVALUE(DISUB,I)) Q:I=""  K DIVALUE(DISUB,I)
"RTN","DICF1",16,0)
 . S I=-1 F  S I=$O(DISCREEN(DISUB,I)) Q:I=""  K DISCREEN(DISUB,I)
"RTN","DICF1",17,0)
 . Q
"RTN","DICF1",18,0)
 S DIVALUE(DISUB,1)=DIVALUE(DISUB)
"RTN","DICF1",19,0)
 Q:DIVALUE(DISUB)=""
"RTN","DICF1",20,0)
 I DIFLAGS["Q" D LONG Q
"RTN","DICF1",21,0)
LOWER ;
"RTN","DICF1",22,0)
 I DIVALUE(DISUB)?.E1L.E,DIFLAGS'["X" D
"RTN","DICF1",23,0)
 . S DIVALUE(DISUB,2)=$$OUT^DIALOGU(DIVALUE(DISUB),"UC")
"RTN","DICF1",24,0)
 . Q
"RTN","DICF1",25,0)
 ;
"RTN","DICF1",26,0)
CHK ; Quit if data type not free-text, pointer or vp, or if lookup value is numeric or a date.
"RTN","DICF1",27,0)
 Q:"PVF"'[$G(DINDEX(DISUB,"TYPE"))
"RTN","DICF1",28,0)
 I DIVALUE(DISUB)?.NP D LONG Q  ;**170
"RTN","DICF1",29,0)
 N Y D  Q:Y>0
"RTN","DICF1",30,0)
 . N X S X=DIVALUE(DISUB) N %DT,DIFLAGS,DIVALUE,DISCREEN,DINDEX,DISUB
"RTN","DICF1",31,0)
 . S %DT="T" D ^%DT Q
"RTN","DICF1",32,0)
COMMA I DIVALUE(DISUB)[",",DIFLAGS'["X" D
"RTN","DICF1",33,0)
 . N DISTEMP,DIPIECE1 S DISTEMP="",DIPIECE1=$P(DIVALUE(DISUB),",")
"RTN","DICF1",34,0)
 . Q:$L(DIPIECE1)>DINDEX(DISUB,"LENGTH")
"RTN","DICF1",35,0)
 . Q:'$L(DIPIECE1)  ;SO
"RTN","DICF1",36,0)
21 . I DIFLAGS["C" D
"RTN","DICF1",37,0)
 . . N DIPART1 S DIPART1=" I %?.E1P1"""
"RTN","DICF1",38,0)
 . . N DIPART2 S DIPART2=""".E!(D'=""B""&(%?1"""
"RTN","DICF1",39,0)
 . . N DIPART3 S DIPART3=""".E))"
"RTN","DICF1",40,0)
 . . N DIOUT S DIOUT=0
"RTN","DICF1",41,0)
 . . N DIPIECE,DIVPIECE F DIPIECE=2:1 D  I DIOUT Q
"RTN","DICF1",42,0)
 . . . S DIVPIECE=$P(DIVALUE(DISUB),",",DIPIECE)
"RTN","DICF1",43,0)
 . . . I DIVPIECE["""" Q
"RTN","DICF1",44,0)
 . . . I $E(DIVPIECE)=" " S DIVPIECE=$E(DIVPIECE,2,$L(DIVPIECE))
"RTN","DICF1",45,0)
 . . . I DIVPIECE="" S DIOUT=1 Q
"RTN","DICF1",46,0)
 . . . I $L(DIVPIECE)*2+$L(DISTEMP)+33+14+34>255 S DIOUT=1 Q
"RTN","DICF1",47,0)
 . . . S DISTEMP=DISTEMP_DIPART1_DIVPIECE_DIPART2_DIVPIECE_DIPART3
"RTN","DICF1",48,0)
 . . . Q:DISTEMP=""
"RTN","DICF1",49,0)
 . . . S DISTEMP="S %=DIVAL "_DISTEMP Q  ;22*135
"RTN","DICF1",50,0)
 . . I DISTEMP="" Q
"RTN","DICF1",51,0)
22 . I DIFLAGS'["C" N DIPIECE2,DIPC2 D
"RTN","DICF1",52,0)
 . . S (DIPC2,DIPIECE2)=$P(DIVALUE(DISUB),",",2)
"RTN","DICF1",53,0)
 . . I DIPIECE2["""" S DIPC2=$$CONVQQ^DILIBF(DIPIECE2)
"RTN","DICF1",54,0)
 . . S DISTEMP="S %=$P(DIVAL,"","",2) I $E(%,1,"_$L(DIPIECE2)_")="""_DIPC2_""""
"RTN","DICF1",55,0)
 . . Q
"RTN","DICF1",56,0)
23 . S DIVALUE(DISUB,3)=DIPIECE1
"RTN","DICF1",57,0)
 . S DISCREEN(DISUB,3)=DISTEMP
"RTN","DICF1",58,0)
 . I DIFLAGS'["C" S DIVALUE(DISUB,3,"c")=DIPIECE2
"RTN","DICF1",59,0)
24 . I DIVALUE(DISUB)'?.E1L.E Q
"RTN","DICF1",60,0)
 . S DIVALUE(DISUB,4)=$$OUT^DIALOGU(DIPIECE1,"UC")
"RTN","DICF1",61,0)
 . S DISCREEN(DISUB,4)=$$OUT^DIALOGU(DISTEMP,"UC")
"RTN","DICF1",62,0)
 . I DIFLAGS'["C" S DIVALUE(DISUB,4,"c")=$$OUT^DIALOGU(DIPIECE2,"UC")
"RTN","DICF1",63,0)
 ;
"RTN","DICF1",64,0)
LONG I $L(DIVALUE(DISUB))'>DINDEX(DISUB,"LENGTH") Q
"RTN","DICF1",65,0)
 N J,X,DISLONG,DISPART,DISXACT,DIREF
"RTN","DICF1",66,0)
 F I=0:0 S I=$O(DIVALUE(DISUB,I)) Q:'I  D
"RTN","DICF1",67,0)
 . N L,M S L=DINDEX(DISUB,"LENGTH")
"RTN","DICF1",68,0)
 . Q:$L(DIVALUE(DISUB,I))'>L
"RTN","DICF1",69,0)
 . S X=DIVALUE(DISUB,I) K DIVALUE(DISUB,I) S DIVALUE(DISUB,0,I)=X
"RTN","DICF1",70,0)
 . I $G(DISCREEN(DISUB,I))]"" S X=DISCREEN(DISUB,I) K DISCREEN(DISUB,I) S DISCREEN(DISUB,0,I)=X
"RTN","DICF1",71,0)
 . S DIVALUE(DISUB,I)=$E(DIVALUE(DISUB,0,I),1,L)
"RTN","DICF1",72,0)
 . I I=1 D
"RTN","DICF1",73,0)
 . . S (DIVALUE(DISUB),DINDEX(DISUB))=DIVALUE(DISUB,I)
"RTN","DICF1",74,0)
 . . F J="PART","FROM","TO" S M=$L($G(DINDEX(DISUB,J))) D:M>L
"RTN","DICF1",75,0)
 . . . S DIVALUE(DISUB,0,I,J)=DINDEX(DISUB,J)
"RTN","DICF1",76,0)
 . . . S DINDEX(DISUB,J)=$E(DINDEX(DISUB,J),1,L) Q
"RTN","DICF1",77,0)
 . . Q
"RTN","DICF1",78,0)
 . S DISLONG=""
"RTN","DICF1",79,0)
 . I $D(DISCREEN(DISUB,0,I)) S DISLONG=" X DISCREEN("_DISUB_",0,"_I_")"
"RTN","DICF1",80,0)
 . S DIREF="DINDEX("_DISUB_",0,"_I_")"
"RTN","DICF1",81,0)
 . S DISPART="I $P(DIVAL,$G("_DIREF_"))="""""_DISLONG ;DI*22*70
"RTN","DICF1",82,0)
 . S DISXACT="I $P(DIVAL,U)="_DIREF_DISLONG
"RTN","DICF1",83,0)
L10 . I DIFLAGS["X" S DISCREEN(DISUB,I)=DISXACT Q
"RTN","DICF1",84,0)
 . I DIFLAGS'["O" S DISCREEN(DISUB,I)=DISPART Q
"RTN","DICF1",85,0)
 . S DISCREEN(DISUB,I)=DISXACT
"RTN","DICF1",86,0)
 . S DISCREEN(DISUB,I,2)=DISPART
"RTN","DICF1",87,0)
 . Q
"RTN","DICF1",88,0)
 Q
"RTN","DICF1",89,0)
 ;
"RTN","DICF1",90,0)
SPECIAL(DIFILE,DIEN,DIFIEN,DIFLAGS,DIVALUE,DINDEX,DISCREEN,DIDENT,DIOUT,DILIST) ;
"RTN","DICF1",91,0)
 ; Process space-bar return, 'IEN or DIVALUE equal to an IEN.
"RTN","DICF1",92,0)
 S DIOUT=0
"RTN","DICF1",93,0)
11 I DIVALUE=" " D  S DIOUT=1 Q
"RTN","DICF1",94,0)
 . N DIROOT S DIROOT=$$ROOT^DIQGU(DIFILE,DIFIEN,"Q")
"RTN","DICF1",95,0)
 . N DINODE S DINODE=$G(^DISV(DUZ,$E(DIROOT,1,28)))
"RTN","DICF1",96,0)
 . N DINODEL S DINODEL=$L(DINODE,",")
"RTN","DICF1",97,0)
 . I $P(DINODE,",",1,DINODEL-1)'=$E(DIROOT,29,9999) Q
"RTN","DICF1",98,0)
 . S DIEN=$P(DINODE,",",DINODEL)
"RTN","DICF1",99,0)
 . I 'DIEN S DIEN="" Q
"RTN","DICF1",100,0)
 . D ENTRY Q
"RTN","DICF1",101,0)
12 I DIVALUE?1"`".NP D  Q:DIOUT=1
"RTN","DICF1",102,0)
 . S DIEN=$E(DIVALUE,2,$L(DIVALUE)) Q:+DIEN'=DIEN
"RTN","DICF1",103,0)
 . D ENTRY S DIOUT=1 Q
"RTN","DICF1",104,0)
13 I $S(DIVALUE?1.N:1,DIVALUE'?.NP:0,1:+DIVALUE=DIVALUE) D
"RTN","DICF1",105,0)
 . N DI001 S DI001=$D(^DD(DIFILE,.001))
"RTN","DICF1",106,0)
 . N DI01FLAG S DI01FLAG=$P($G(^DD(DIFILE,.01,0)),U,2)
"RTN","DICF1",107,0)
 . I $D(@DIFILE(DIFILE)@(DIVALUE)) D
"RTN","DICF1",108,0)
 . . I DIFLAGS'["A",'DI001,DI01FLAG["N"!($O(@DIFILE(DIFILE)@("A["))'="") Q
"RTN","DICF1",109,0)
 . . S DIEN=DIVALUE
"RTN","DICF1",110,0)
 . . D ENTRY
"RTN","DICF1",111,0)
 . . I $G(DINDEX("DONE"))!($G(DIERR)) S DIEN="",DIOUT=1
"RTN","DICF1",112,0)
 Q
"RTN","DICF1",113,0)
 ;
"RTN","DICF1",114,0)
ENTRY ; Execute screens, and if entry passes, do ACCEPT to add it to output.
"RTN","DICF1",115,0)
 N DI0NODE S DI0NODE=$G(@DIFILE(DIFILE)@(DIEN,0))
"RTN","DICF1",116,0)
 Q:$$SCREEN^DICL2(.DIFILE,.DIEN,DIFLAGS,DIFIEN,.DISCREEN,.DINDEX,DI0NODE)
"RTN","DICF1",117,0)
 D ACCEPT^DICL2(.DIFILE,.DIEN,.DIFLAGS,DIFIEN,.DINDEX,.DIDENT,.DILIST,DI0NODE)
"RTN","DICF1",118,0)
 Q
"RTN","DIR")
0^3^B22624291^B22459740
"RTN","DIR",1,0)
DIR ;SFISC/XAK-READER, HELP ;6:35 PM  12 Jul 2013
"RTN","DIR",2,0)
 ;;22.0;VA FileMan;**30,163,170**;Mar 30, 1999;Build 10
"RTN","DIR",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DIR",4,0)
 N %,%A,%B,%B1,%B2,%B3,%BA,%C,%E,%G,%H,%I,%J,%N,%P,%S,%T,%W,%X,%Y,A0,C,D,DD,DDH,DDQ,DDSV,DG,DH,DIC,DIFLD,DIRO,DO,DP,DQ,DU,DZ,X1,XQH,DIX,DIY,DISYS,%BU,%J1,%A0,%W0,%D1,%D2,%DT,%K,%M
"RTN","DIR",5,0)
 S:$D(DDH)[0 DDH=0 Q:'$D(DIR(0))  D ^DIR2 G Q:%T=""
"RTN","DIR",6,0)
 I $D(DIR("V"))#2 D ^DIR1 S DDER=%E G Q
"RTN","DIR",7,0)
A I $D(DDM) K:DDM DDQ S:'DDM DDQ=IOSL-7
"RTN","DIR",8,0)
 I $G(DDH) D LIST^DDSU
"RTN","DIR",9,0)
 D W:%A'["V" I $D(DDS),$D(DIR0) S DDACT=Y I DDO=.5 S DDM=1 G Q
"RTN","DIR",10,0)
 I %A'["V",%E D QUES S A0="" D MSG D:$G(DDH) LIST^DDSU G A
"RTN","DIR",11,0)
 I $D(DTOUT) K Y S DIRUT=1,Y="" G Q
"RTN","DIR",12,0)
 I %T'="E",X?1."^".E K Y S (DUOUT,DIRUT)=1,Y=X S:X="^^" DIROUT=1 S:%T="Y" %=-1 G Q
"RTN","DIR",13,0)
 I %T'="E","@"[X,%A["O" S Y="",DIRUT=1 S:%T="P" Y=-1 G Q
"RTN","DIR",14,0)
 I %A'["O","@"[X,%T'="E" S A0=$C(7)_%A0 D MSG G A
"RTN","DIR",15,0)
 I $D(DDS),$D(DIR0),DIR0N G Q
"RTN","DIR",16,0)
 I $D(%G),$D(DIR("B")),X=DIR("B") S Y=%G G Q
"RTN","DIR",17,0)
 I X'?1."?" K DDQ D ^DIR1 I '%E,$P(DIR(0),U,3)]"" S %X=X D  S:'$D(X) %E=1 S X=%X
"RTN","DIR",18,0)
 . N %A,%B,%B1,%B2,%B3,%E,%N,%P,%T,%X,%W,%W0
"RTN","DIR",19,0)
 . X $P(DIR(0),U,3,99)
"RTN","DIR",20,0)
 I %A["V" K:%E Y G Q
"RTN","DIR",21,0)
 I X?1."?"!%E D QUES:%E'<0&'$G(DUOUT)&'$G(DTOUT) S A0="" D MSG D:$G(DDH) LIST^DDSU G A ;**170
"RTN","DIR",22,0)
 G Q
"RTN","DIR",23,0)
 ;
"RTN","DIR",24,0)
W ; write the prompt and read the user's response
"RTN","DIR",25,0)
 S %W=%W0,%N=$E(%W)=U
"RTN","DIR",26,0)
SCREEN K DTOUT,DUOUT,DIRUT,DIROUT S %E=0 I $D(DDS),$D(DIR0) D ^DIR0 Q  ;READ in DIR01 via DIR0
"RTN","DIR",27,0)
 I %T="S",%A'["A",%A'["B" D S
"RTN","DIR",28,0)
 I $D(DIR("A"))=11 F %=0:0 S %=$O(DIR("A",%)) Q:%'>0  W !,DIR("A",%)
"RTN","DIR",29,0)
 W ! W:$L(%P) %P
"RTN","DIR",30,0)
 I $L($G(DIR("B")))>19,%A'["r",%T'="D",%T'="S",(%B'["D"&%T)!'%T,%B'["P"!'$P(%A,",",2) W DIR("B") S Y=DIR("B") D RW^DIR2 S:X="" X=DIR("B") Q
"RTN","DIR",31,0)
 W:$D(DIR("B")) DIR("B")_"// "
"RTN","DIR",32,0)
 R X:$S($D(DIR("T")):DIR("T"),'$D(DTIME):300,1:DTIME) I '$T S DTOUT=1
"RTN","DIR",33,0)
 I $D(DIR("PRE")) X DIR("PRE") I '$D(X) S %E=1,X="" Q
"RTN","DIR",34,0)
 I X="",$D(DIR("B")) S X=DIR("B") I %T'="D",%B'["D"&%T W X
"RTN","DIR",35,0)
 I X'?.ANP S X="?"
"RTN","DIR",36,0)
 Q
"RTN","DIR",37,0)
 ;
"RTN","DIR",38,0)
QU I %E!(X="?")!($O(^DD(%B1,%B2,21,0))'>0) K %Y S A0="" D MSG F %C=3,12 I $D(^DD(%B1,%B2,%C)) S X1=^(%C),%J=75,%Y=1 D W1
"RTN","DIR",39,0)
 I $D(^DD(%B1,%B2,4)) S A0=^(4),A0(0)=1 D MSG
"RTN","DIR",40,0)
 I X?1"??".E D
"RTN","DIR",41,0)
 . I $D(DDS) N DDC,DDSQ S DDC=7
"RTN","DIR",42,0)
 . S A0="" D MSG S %C=0
"RTN","DIR",43,0)
 . F  S %C=$O(^DD(%B1,%B2,21,%C)) Q:'%C!$D(DDSQ)  S A0=^(%C,0) D
"RTN","DIR",44,0)
 .. I $D(DDS),$G(DDH),'(DDH#DDC) D LIST^DDSU Q:$D(DDSQ)
"RTN","DIR",45,0)
 .. D MSG
"RTN","DIR",46,0)
 I %B["P" K DO S DIC=U_$P(%B3,U,3),DIC(0)="M"_$E("L",%B'["'") D AST:%B["*",DQ
"RTN","DIR",47,0)
 I %B["D" S %DT=$P($P($P(%B3,U,5,99),"%DT=""",2),"""",1) D HELP^%DTC
"RTN","DIR",48,0)
 I %B["S" X:$D(^DD(%B1,%B2,12.1)) ^(12.1) S A0=$$EZBLD^DIALOG(8068)_" " D MSG F %C=1:1 S Y=$P($P(%B3,U,3),";",%C) Q:Y=""  S %I=$P(Y,":",2),Y=$P(Y,":") I 1 X:$D(DIC("S")) DIC("S") I  S A0=Y_$E("         ",$L(Y)+1,999)_%I D MSG
"RTN","DIR",49,0)
 I %B["V" S A0="" D MSG S X1=X,DU=%B1,D=%B2,DZ=X D V^DIEQ S X=X1
"RTN","DIR",50,0)
 Q
"RTN","DIR",51,0)
DQ N %W S:$D(D)[0 D="B" S (X1,DZ)=X D DQ^DICQ S DDSV=DIC K DD,% S:$D(X1) X=X1
"RTN","DIR",52,0)
 Q
"RTN","DIR",53,0)
AST F %=" D ^DIC"," D IX^DIC"," D MIX^DIC1" S Y=$F(%B3,%),%=$L(%)+1 Q:Y
"RTN","DIR",54,0)
 Q:'Y
"RTN","DIR",55,0)
 I $D(DDS) S A0=" " D MSG
"RTN","DIR",56,0)
 X $P($E(%B3,1,Y-%),U,5,99)
"RTN","DIR",57,0)
 Q
"RTN","DIR",58,0)
QUES ;
"RTN","DIR",59,0)
 I %T D QU
"RTN","DIR",60,0)
 I X="??",$D(DIR("??")) D:$P(DIR("??"),U)]"" HF S:$P(DIR("??"),U,2)]"" A0(0)=1,A0=$P(DIR("??"),U,2,99) D:$P(DIR("??"),U,2)]"" MSG Q
"RTN","DIR",61,0)
 I X="??",%T="D" D  Q
"RTN","DIR",62,0)
 . N DIHELP,DIJUNK,DILINE,DIROOT
"RTN","DIR",63,0)
 . D DT^DILF(%DT,"?",.DIJUNK,"","DIROOT")
"RTN","DIR",64,0)
 . S A0="" D MSG
"RTN","DIR",65,0)
 . F DILINE=1:1:DIHELP S A0=DIROOT("DIHELP",DILINE) D MSG
"RTN","DIR",66,0)
 I %T="P" S DIC=%B1,DIC(0)=%B2 S:$D(DIR("S"))#2 DIC("S")=DIR("S") D DQ K DIC("S")
"RTN","DIR",67,0)
 I '%N S A0="" D MSG
"RTN","DIR",68,0)
 I X'["?" W $C(7)
"RTN","DIR",69,0)
 I %N S A0(0)=1,A0=$E(%W,2,999) D MSG
"RTN","DIR",70,0)
 D:'%N WRAP:%W]"" I %T["S",(%A["A"!(%A["B")) D S
"RTN","DIR",71,0)
 Q
"RTN","DIR",72,0)
WRAP I $D(DIR("?"))=11 F %I=1:1 Q:'$D(DIR("?",%I))  S A0=DIR("?",%I) D MSG
"RTN","DIR",73,0)
 K %Y S %J=$S($G(IOM,80)>6:$G(IOM,80)-6,IOM>1:IOM,1:2),%Y=1 S X1=$S(($D(DIR("?"))&'%N):DIR("?"),1:%W)
"RTN","DIR",74,0)
 I '%N,$D(DIR("?"))'=11,$E(X1,$L(X1))'="." S X1=X1_"."
"RTN","DIR",75,0)
W1 I $L(X1)<%J S %Y(%Y)=X1
"RTN","DIR",76,0)
 E  D  G W1
"RTN","DIR",77,0)
 . I $E(X1,1,%J-1)'?.E1P.E S %I=%J-1
"RTN","DIR",78,0)
 . E  F %I=%J-1:-1:1 Q:$E(X1,%I)?1P
"RTN","DIR",79,0)
 . S %Y(%Y)=$E(X1,1,%I),X1=$E(X1,%I+1,999),%Y=%Y+1
"RTN","DIR",80,0)
 F %I=1:1:%Y S A0=%Y(%I) D MSG
"RTN","DIR",81,0)
 I $D(DDS),%T="S" D
"RTN","DIR",82,0)
 . S A0="Choose from:" D MSG
"RTN","DIR",83,0)
 . F %I=1:1 Q:$P(%B,";",%I,999)=""  D
"RTN","DIR",84,0)
 .. S %Y=$P(%B,";",%I),Y=$P(%Y,":") Q:Y=""
"RTN","DIR",85,0)
 .. I $D(DIR("S"))#2 X DIR("S") E  Q
"RTN","DIR",86,0)
 .. S A0=Y_$J("",9-$L(Y))_$P(%Y,":",2) D MSG
"RTN","DIR",87,0)
 K %Y,%,X1
"RTN","DIR",88,0)
 Q
"RTN","DIR",89,0)
HF S XQH=$P(DIR("??"),U) N %A,%B,%E,DIR D EN1^XQH
"RTN","DIR",90,0)
 Q
"RTN","DIR",91,0)
MSG ;
"RTN","DIR",92,0)
 I $D(DDS),A0]"" D
"RTN","DIR",93,0)
 . S DDH=$G(DDH)+1
"RTN","DIR",94,0)
 . I $D(A0)>9 S DDH(DDH,"T")="",DDH=DDH+1,DDH(DDH,"X")=A0
"RTN","DIR",95,0)
 . E  S DDH(DDH,"T")=A0
"RTN","DIR",96,0)
 I '$D(DDS),$D(A0)>9 W:$X ! X A0
"RTN","DIR",97,0)
 I '$D(DDS),$D(A0)=1 W !,A0
"RTN","DIR",98,0)
 K A0
"RTN","DIR",99,0)
 Q
"RTN","DIR",100,0)
S W:$G(X)'?1."?"!(%A["A") !
"RTN","DIR",101,0)
 I $D(DIR("L"))#2 D
"RTN","DIR",102,0)
 . I $D(DIR("L"))=11 F %=0:0 S %=$O(DIR("L",%)) Q:%'>0  W !,DIR("L",%)
"RTN","DIR",103,0)
 . W !,DIR("L")
"RTN","DIR",104,0)
 E  I %B'[":",$O(DIR("C",""))]"" D
"RTN","DIR",105,0)
 . W !?5,"Select one of the following:",!
"RTN","DIR",106,0)
 . S %I="" F  S %I=$O(DIR("C",%I)) Q:%I=""  D
"RTN","DIR",107,0)
 .. S Y=$P(DIR("C",%I),":")
"RTN","DIR",108,0)
 .. I $D(DIR("S"))#2 X DIR("S") E  Q
"RTN","DIR",109,0)
 .. W !?10,Y,?20,$P(DIR("C",%I),":",2)
"RTN","DIR",110,0)
 E  D
"RTN","DIR",111,0)
 . W !?5,"Select one of the following:",!
"RTN","DIR",112,0)
 . F %I=1:1 Q:$P(%B,";",%I,999)=""  D
"RTN","DIR",113,0)
 .. S Y=$P($P(%B,";",%I),":") Q:'$L($P(%B,";",%I,99))
"RTN","DIR",114,0)
 .. I $D(DIR("S"))#2 X DIR("S") E  Q
"RTN","DIR",115,0)
 .. W !?10,Y,?20,$P($P(%B,";",%I),":",2)
"RTN","DIR",116,0)
 W:%A'["A" !
"RTN","DIR",117,0)
 Q
"RTN","DIR",118,0)
Q G ^DIRQ
"RTN","DIR",119,0)
 ;
"RTN","DIR",120,0)
 ;#8068  Choose from
"VER")
8^22.0
"BLD",1001,6)
^150
**END**
**END**

