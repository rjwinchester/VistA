Released OR*3*494 SEQ #417
Extracted from mail message
**KIDS**:OR*3.0*494^

**INSTALL NAME**
OR*3.0*494
"BLD",11215,0)
OR*3.0*494^ORDER ENTRY/RESULTS REPORTING^0^3181025^y
"BLD",11215,1,0)
^^35^35^3181002^
"BLD",11215,1,1,0)
INC2101638: Missing Text on "Return to Clinic" Orders
"BLD",11215,1,2,0)
 
"BLD",11215,1,3,0)
Problem:
"BLD",11215,1,4,0)
-------
"BLD",11215,1,5,0)
 
"BLD",11215,1,6,0)
When a "Return to Clinic" order is copied, the text "on or around" is 
"BLD",11215,1,7,0)
missing before the date.  Example: The order should state "Return to 
"BLD",11215,1,8,0)
Clinic ABC on or around (Sep 24, 2018) for a total of 1 appointment(s)."  
"BLD",11215,1,9,0)
Instead, a copied order will state "Return to Clinic ABC Sep 24, 2018 for 
"BLD",11215,1,10,0)
a total of 1 appointment(s)."
"BLD",11215,1,11,0)
 
"BLD",11215,1,12,0)
Resolution: 
"BLD",11215,1,13,0)
----------
"BLD",11215,1,14,0)
 
"BLD",11215,1,15,0)
Modify routine ORWDXM1 to force the user to edit the order which will 
"BLD",11215,1,16,0)
include entering a new date. (The same date may be entered for the copied 
"BLD",11215,1,17,0)
order if that complies with procedures to have two "Return to Clinic" 
"BLD",11215,1,18,0)
orders for the same clinic and same date.)
"BLD",11215,1,19,0)
 
"BLD",11215,1,20,0)
INC2105632: RTC orders canceled when INTERVAL is zero (0)
"BLD",11215,1,21,0)
 
"BLD",11215,1,22,0)
Problem:
"BLD",11215,1,23,0)
--------
"BLD",11215,1,24,0)
 
"BLD",11215,1,25,0)
When a using the VISTA CPRS CLINICIAN MENU option OR OE/RR MENU CLINICIAN 
"BLD",11215,1,26,0)
to place a RTC order and the Number of Appointments is greater than one 
"BLD",11215,1,27,0)
(1), the Interval should not be allowed to be zero (0).
"BLD",11215,1,28,0)
 
"BLD",11215,1,29,0)
Resolution:
"BLD",11215,1,30,0)
-----------
"BLD",11215,1,31,0)
 
"BLD",11215,1,32,0)
The patch modifies the INTERVAL item (OR GTX SCH INTERVAL) for the ORDER 
"BLD",11215,1,33,0)
DIALOG SD RTC in the ORDER DIALOG file (#101.41).  The modification makes 
"BLD",11215,1,34,0)
the INTERVAL a required field when the value of the Number of 
"BLD",11215,1,35,0)
Appointments field is greater than one (1).
"BLD",11215,4,0)
^9.64PA^^0
"BLD",11215,6.3)
4
"BLD",11215,"INID")
^n
"BLD",11215,"INIT")
OR494PIR
"BLD",11215,"KRN",0)
^9.67PA^779.2^20
"BLD",11215,"KRN",.4,0)
.4
"BLD",11215,"KRN",.401,0)
.401
"BLD",11215,"KRN",.402,0)
.402
"BLD",11215,"KRN",.403,0)
.403
"BLD",11215,"KRN",.5,0)
.5
"BLD",11215,"KRN",.84,0)
.84
"BLD",11215,"KRN",3.6,0)
3.6
"BLD",11215,"KRN",3.8,0)
3.8
"BLD",11215,"KRN",9.2,0)
9.2
"BLD",11215,"KRN",9.8,0)
9.8
"BLD",11215,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",11215,"KRN",9.8,"NM",1,0)
ORWDXM1^^0^B114227639
"BLD",11215,"KRN",9.8,"NM","B","ORWDXM1",1)

"BLD",11215,"KRN",19,0)
19
"BLD",11215,"KRN",19.1,0)
19.1
"BLD",11215,"KRN",101,0)
101
"BLD",11215,"KRN",409.61,0)
409.61
"BLD",11215,"KRN",771,0)
771
"BLD",11215,"KRN",779.2,0)
779.2
"BLD",11215,"KRN",870,0)
870
"BLD",11215,"KRN",8989.51,0)
8989.51
"BLD",11215,"KRN",8989.52,0)
8989.52
"BLD",11215,"KRN",8994,0)
8994
"BLD",11215,"KRN","B",.4,.4)

"BLD",11215,"KRN","B",.401,.401)

"BLD",11215,"KRN","B",.402,.402)

"BLD",11215,"KRN","B",.403,.403)

"BLD",11215,"KRN","B",.5,.5)

"BLD",11215,"KRN","B",.84,.84)

"BLD",11215,"KRN","B",3.6,3.6)

"BLD",11215,"KRN","B",3.8,3.8)

"BLD",11215,"KRN","B",9.2,9.2)

"BLD",11215,"KRN","B",9.8,9.8)

"BLD",11215,"KRN","B",19,19)

"BLD",11215,"KRN","B",19.1,19.1)

"BLD",11215,"KRN","B",101,101)

"BLD",11215,"KRN","B",409.61,409.61)

"BLD",11215,"KRN","B",771,771)

"BLD",11215,"KRN","B",779.2,779.2)

"BLD",11215,"KRN","B",870,870)

"BLD",11215,"KRN","B",8989.51,8989.51)

"BLD",11215,"KRN","B",8989.52,8989.52)

"BLD",11215,"KRN","B",8994,8994)

"BLD",11215,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",11215,"QUES",0)
^9.62^^
"BLD",11215,"REQB",0)
^9.611^1^1
"BLD",11215,"REQB",1,0)
OR*3.0*434^2
"BLD",11215,"REQB","B","OR*3.0*434",1)

"INIT")
OR494PIR
"MBREQ")
0
"PKG",174,-1)
1^1
"PKG",174,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",174,22,0)
^9.49I^1^1
"PKG",174,22,1,0)
3.0^2971217^2990325^66481
"PKG",174,22,1,"PAH",1,0)
494^3181025
"PKG",174,22,1,"PAH",1,1,0)
^^35^35^3181025
"PKG",174,22,1,"PAH",1,1,1,0)
INC2101638: Missing Text on "Return to Clinic" Orders
"PKG",174,22,1,"PAH",1,1,2,0)
 
"PKG",174,22,1,"PAH",1,1,3,0)
Problem:
"PKG",174,22,1,"PAH",1,1,4,0)
-------
"PKG",174,22,1,"PAH",1,1,5,0)
 
"PKG",174,22,1,"PAH",1,1,6,0)
When a "Return to Clinic" order is copied, the text "on or around" is 
"PKG",174,22,1,"PAH",1,1,7,0)
missing before the date.  Example: The order should state "Return to 
"PKG",174,22,1,"PAH",1,1,8,0)
Clinic ABC on or around (Sep 24, 2018) for a total of 1 appointment(s)."  
"PKG",174,22,1,"PAH",1,1,9,0)
Instead, a copied order will state "Return to Clinic ABC Sep 24, 2018 for 
"PKG",174,22,1,"PAH",1,1,10,0)
a total of 1 appointment(s)."
"PKG",174,22,1,"PAH",1,1,11,0)
 
"PKG",174,22,1,"PAH",1,1,12,0)
Resolution: 
"PKG",174,22,1,"PAH",1,1,13,0)
----------
"PKG",174,22,1,"PAH",1,1,14,0)
 
"PKG",174,22,1,"PAH",1,1,15,0)
Modify routine ORWDXM1 to force the user to edit the order which will 
"PKG",174,22,1,"PAH",1,1,16,0)
include entering a new date. (The same date may be entered for the copied 
"PKG",174,22,1,"PAH",1,1,17,0)
order if that complies with procedures to have two "Return to Clinic" 
"PKG",174,22,1,"PAH",1,1,18,0)
orders for the same clinic and same date.)
"PKG",174,22,1,"PAH",1,1,19,0)
 
"PKG",174,22,1,"PAH",1,1,20,0)
INC2105632: RTC orders canceled when INTERVAL is zero (0)
"PKG",174,22,1,"PAH",1,1,21,0)
 
"PKG",174,22,1,"PAH",1,1,22,0)
Problem:
"PKG",174,22,1,"PAH",1,1,23,0)
--------
"PKG",174,22,1,"PAH",1,1,24,0)
 
"PKG",174,22,1,"PAH",1,1,25,0)
When a using the VISTA CPRS CLINICIAN MENU option OR OE/RR MENU CLINICIAN 
"PKG",174,22,1,"PAH",1,1,26,0)
to place a RTC order and the Number of Appointments is greater than one 
"PKG",174,22,1,"PAH",1,1,27,0)
(1), the Interval should not be allowed to be zero (0).
"PKG",174,22,1,"PAH",1,1,28,0)
 
"PKG",174,22,1,"PAH",1,1,29,0)
Resolution:
"PKG",174,22,1,"PAH",1,1,30,0)
-----------
"PKG",174,22,1,"PAH",1,1,31,0)
 
"PKG",174,22,1,"PAH",1,1,32,0)
The patch modifies the INTERVAL item (OR GTX SCH INTERVAL) for the ORDER 
"PKG",174,22,1,"PAH",1,1,33,0)
DIALOG SD RTC in the ORDER DIALOG file (#101.41).  The modification makes 
"PKG",174,22,1,"PAH",1,1,34,0)
the INTERVAL a required field when the value of the Number of 
"PKG",174,22,1,"PAH",1,1,35,0)
Appointments field is greater than one (1).
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","OR494PIR")
0^^B6952974^n/a
"RTN","OR494PIR",1,0)
OR494PIR ;HPS-CS/JSG - OR*3.0*494 POST INSTALL ROUTINE;SEP 27, 2018@13:00
"RTN","OR494PIR",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**494**;Sep 27, 2018;Build 4
"RTN","OR494PIR",3,0)
 ;Examines the INTERVAL ITEM in the ORDER DIALOG file #101.41 to make the
"RTN","OR494PIR",4,0)
 ;INTERVAL ITEM a required response when the NUMBER OF APPOINTMENTS ITEM 
"RTN","OR494PIR",5,0)
 ;is greater than one (1).
"RTN","OR494PIR",6,0)
 ;
"RTN","OR494PIR",7,0)
 D MES^XPDUTL("Checking the ORDER DIALOG file for suitability to apply changes")
"RTN","OR494PIR",8,0)
 D MES^XPDUTL("to ORDER DIALOG SD RTC to modify the ITEM INTERVAL.")
"RTN","OR494PIR",9,0)
 S ORPIRIEN=$O(^ORD(101.41,"AB","SD RTC",0)) I 'ORPIRIEN D  Q
"RTN","OR494PIR",10,0)
 .D MES^XPDUTL("ORDER DIALOG SD RTC missing from instance - no update.")
"RTN","OR494PIR",11,0)
 S ORPIRSEQ=$O(^ORD(101.41,ORPIRIEN,10,"B",20.5,0)) I 'ORPIRSEQ D  Q
"RTN","OR494PIR",12,0)
 .D MES^XPDUTL("ITEM INTERVAL is not on the ORDER DIALOG SD RTC - no update.")
"RTN","OR494PIR",13,0)
 S ORPIRINT=$G(^ORD(101.41,ORPIRIEN,10,ORPIRSEQ,3)) I ORPIRINT'="I +$$VAL^ORCD(""NUMBER OF APPOINTMENTS"")>1" D  Q
"RTN","OR494PIR",14,0)
 .D MES^XPDUTL("ITEM INTERVAL value is not as expected - no update.")
"RTN","OR494PIR",15,0)
 I $D(^ORD(101.41,ORPIRIEN,10,ORPIRSEQ,.1)) D  Q
"RTN","OR494PIR",16,0)
 .D MES^XPDUTL("INPUT TRANSFORM already esists - no update.")
"RTN","OR494PIR",17,0)
SET ;
"RTN","OR494PIR",18,0)
 S ^ORD(101.41,ORPIRIEN,10,ORPIRSEQ,3)=ORPIRINT_" S REQD=1"
"RTN","OR494PIR",19,0)
 S ^ORD(101.41,ORPIRIEN,10,ORPIRSEQ,.1)="I +$$VAL^ORCD(""NUMBER OF APPOINTMENTS"")>1,X<1 K X"
"RTN","OR494PIR",20,0)
 D MES^XPDUTL("ITEM INTERVAL value updated.")
"RTN","OR494PIR",21,0)
END ;
"RTN","OR494PIR",22,0)
 K ORPIRIEN,ORPIRSEQ,ORPIRINT
"RTN","OR494PIR",23,0)
 Q
"RTN","OR494PIR",24,0)
ROLL ;Reset INTERVAL ITEM to original value should the patch need to rolled back.
"RTN","OR494PIR",25,0)
 W !,"Checking the ORDER DIALOG file for suitability to roll back"
"RTN","OR494PIR",26,0)
 W !,"the patch change to the ITEM INTERVAL."
"RTN","OR494PIR",27,0)
 S ORPIRIEN=$O(^ORD(101.41,"AB","SD RTC",0)) I 'ORPIRIEN D  Q
"RTN","OR494PIR",28,0)
 .W !,"ORDER DIALOG SD RTC missing from instance - no roll back."
"RTN","OR494PIR",29,0)
 S ORPIRSEQ=$O(^ORD(101.41,ORPIRIEN,10,"B",20.5,0)) I 'ORPIRSEQ D  Q
"RTN","OR494PIR",30,0)
 .W !,"ITEM INTERVAL is not on the ORDER DIALOG SD RTC - no roll back."
"RTN","OR494PIR",31,0)
 S ORPIRINT=$G(^ORD(101.41,ORPIRIEN,10,ORPIRSEQ,3)) I ORPIRINT'[" S REQD=1" D  Q
"RTN","OR494PIR",32,0)
 .W !,"ITEM INTERVAL value is not as expected - no roll bacck."
"RTN","OR494PIR",33,0)
BACK ;
"RTN","OR494PIR",34,0)
 S ^ORD(101.41,ORPIRIEN,10,ORPIRSEQ,3)="I +$$VAL^ORCD(""NUMBER OF APPOINTMENTS"")>1"
"RTN","OR494PIR",35,0)
 I $D(^ORD(101.41,ORPIRIEN,10,ORPIRSEQ,.1)) K ^(.1)
"RTN","OR494PIR",36,0)
 W !!,"ITEM INTERVAL for SD RTC restored to pre-patch value:"
"RTN","OR494PIR",37,0)
 W !,"I +$$VAL^ORCD(""NUMBER OF APPOINTMENTS"")>1"
"RTN","OR494PIR",38,0)
 K ORPIRIEN,ORPIRSEQ,ORPIRINT
"RTN","OR494PIR",39,0)
 Q
"RTN","ORWDXM1")
0^1^B114227639^B111273921
"RTN","ORWDXM1",1,0)
ORWDXM1 ;SLC/KCM - Order Dialogs, Menus ;05/22/17  11:15
"RTN","ORWDXM1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,131,132,141,178,185,187,215,243,280,331,388,350,423,434,494**;Dec 17, 1997;Build 4
"RTN","ORWDXM1",3,0)
 ;
"RTN","ORWDXM1",4,0)
 ;
"RTN","ORWDXM1",5,0)
BLDQRSP(LST,ORIT,FLDS,ISIMO,ENCLOC) ; Build responses for an order
"RTN","ORWDXM1",6,0)
 ; LST=QuickLevel^ResponseID(ORIT;$H)^Dialog^Type^FormID^DGrp
"RTN","ORWDXM1",7,0)
 ; LST(n)=verify or reject text
"RTN","ORWDXM1",8,0)
 ; ORIT= ptr to 101.41 for quick order, 100 for copy
"RTN","ORWDXM1",9,0)
 ; 1 2 3 4 5 6 7 8 11-20
"RTN","ORWDXM1",10,0)
 ; FLDS=DFN^LOC^ORNP^INPT^SEX^AGE^EVENT^SC%^^^Key Variables...
"RTN","ORWDXM1",11,0)
 ; ORIT=+ORIT: ptr to 101.41, $E(ORIT)=C: copy $E(ORIT)=X: change
"RTN","ORWDXM1",12,0)
 ; !! SHOULD CHECK for PRE-CPRS ORDERS (treat as text?)
"RTN","ORWDXM1",13,0)
 K ^TMP($J,"ORWDX LOADRSP","QO SAVE")
"RTN","ORWDXM1",14,0)
 K ^TMP("ORWDXMQ",$J)
"RTN","ORWDXM1",15,0)
 N ORWMODE ; 0:Dlg,Quick 1:copy 2:change
"RTN","ORWDXM1",16,0)
 N TEMPCAT ; pt cat from DPT
"RTN","ORWDXM1",17,0)
 N ISXFER ; Trnsfr order?
"RTN","ORWDXM1",18,0)
 N ORIMO ;If IMO(inpt med on opt)
"RTN","ORWDXM1",19,0)
 N TEMPORIT
"RTN","ORWDXM1",20,0)
 N ADMLOC,PATLOC,ORDLOC,LEVEL,DELAY,SCHLOC,SCHTYP
"RTN","ORWDXM1",21,0)
 S PATLOC=$P(FLDS,U,2)
"RTN","ORWDXM1",22,0)
 S ORDLOC=$S(ORIT["C":+$P($G(^OR(100,+$P(ORIT,"C",2),0)),U,10),1:0)
"RTN","ORWDXM1",23,0)
 S ORIMO=$G(ISIMO)
"RTN","ORWDXM1",24,0)
 S ORWMODE=0,ISXFER=""
"RTN","ORWDXM1",25,0)
 S:$E(ORIT)="C" ORWMODE=1 S:$E(ORIT)="T" ORWMODE=1,ISXFER=";T" ;treat xfer as copy
"RTN","ORWDXM1",26,0)
 S:$E(ORIT)="X" ORWMODE=2
"RTN","ORWDXM1",27,0)
 S TEMPORIT=ORIT
"RTN","ORWDXM1",28,0)
 I ORWMODE S ORIT=$E(ORIT,2,999)
"RTN","ORWDXM1",29,0)
 S LST(0)=""
"RTN","ORWDXM1",30,0)
 ;disable
"RTN","ORWDXM1",31,0)
 D CHKDSBL^ORWDXM3(.LST,ORIT,ORWMODE) Q:+LST(0)=8
"RTN","ORWDXM1",32,0)
 ;action
"RTN","ORWDXM1",33,0)
 D CHKVACT^ORWDXM3(.LST,ORIT,ORWMODE,$P(FLDS,U,3)) Q:+LST(0)=8
"RTN","ORWDXM1",34,0)
 ;no copy
"RTN","ORWDXM1",35,0)
 I ORWMODE=1 D CHKCOPY^ORWDXM3(.LST,ORIT,FLDS) Q:+LST(0)=8
"RTN","ORWDXM1",36,0)
 ;change
"RTN","ORWDXM1",37,0)
 I ORWMODE=2 D BLD4CHG^ORWDXM3(.LST,ORIT,FLDS) Q
"RTN","ORWDXM1",38,0)
 I 'ORWMODE,($P(^ORD(101.41,+ORIT,0),U,4)="D"),$P(^ORD(101.41,+ORIT,0),"^",7)=$O(^DIC(9.4,"C","SD",0)) S LST(0)="0^0^"_$$DLGINFO^ORWDXM3(ORIT,ORWMODE_ISXFER) Q
"RTN","ORWDXM1",39,0)
 I 'ORWMODE,($P(^ORD(101.41,+ORIT,0),U,4)="D"),'($O(^DIC(9.4,"C","OR",0))[$P(^ORD(101.41,+ORIT,0),U,7)) S LST(0)="0^0^"_$$DLGINFO^ORWDXM3(ORIT,ORWMODE_ISXFER) Q
"RTN","ORWDXM1",40,0)
 N ORIMTYPE,ORCOMP,ORTAS,LRFZX,LRFSAMP,LRFSPEC,LRFDATE,LRFURG,LRFSCH
"RTN","ORWDXM1",41,0)
 N ORTIME,ORCOLLCT,ORMAX,ORTEST,ORIMTIME,ORSMAX,ORSTMS,ORSCH
"RTN","ORWDXM1",42,0)
 N PSJNOPC,ORMORE,ORINPT,ORXNP,ORSCHED,ORQTY,ORNOUNS,ORXNP,OREFILLS
"RTN","ORWDXM1",43,0)
 N ORCOMPLX,ORQTY,ORCOPAY,ORDRUG,ORWPSPIK,ORWPSWRG,ORSD,ORDSUP,ORWP94
"RTN","ORWDXM1",44,0)
 N ORPARAM,ORNPO,ORTIME,ORMEAL,ORTRAY,ORDATE,GMRCNOPD,GMRCNOAT,GMRCREAF
"RTN","ORWDXM1",45,0)
 N ORTYPE,ORVP,ORL,ORNP,ORSEX,ORAGE,ORWARD,OREVENT,ORDIV,ORSC,KEYVAR
"RTN","ORWDXM1",46,0)
 N ORDG,ORDIALOG,ORCAT,FIRST,ORQUIT,X,ORTRAIL,ORLEAD,RSPREF,AUTOACK
"RTN","ORWDXM1",47,0)
 N OREVNTYP
"RTN","ORWDXM1",48,0)
 S ORWP94=$O(^ORD(101.41,"AB","PS MEDS",0))>0
"RTN","ORWDXM1",49,0)
 S ORVP=$P(FLDS,U,1)_";DPT(",ORNP=+$P(FLDS,U,3),ORSC=$P(FLDS,U,8)
"RTN","ORWDXM1",50,0)
 S ORL=$P(FLDS,U,2)_";SC(",ORL(2)=ORL
"RTN","ORWDXM1",51,0)
 S ORSEX=$P(FLDS,U,5),ORAGE=$P(FLDS,U,6),ORTYPE="Q",FIRST=1
"RTN","ORWDXM1",52,0)
 I $P(FLDS,U,4),$G(^SC(+ORL,42)) S ORWARD=+^SC(+ORL,42)
"RTN","ORWDXM1",53,0)
 I $L($P(FLDS,U,7)) D
"RTN","ORWDXM1",54,0)
 . S OREVENT=$P(FLDS,U,7)
"RTN","ORWDXM1",55,0)
 . S OREVNTYP=$P(OREVENT,";",2)
"RTN","ORWDXM1",56,0)
 . S OREVENT("TS")=$P(OREVENT,";",3)
"RTN","ORWDXM1",57,0)
 . S OREVENT("EFFECTIVE")=$P(OREVENT,";",4)
"RTN","ORWDXM1",58,0)
 . S OREVENT=+$P(OREVENT,";",1)
"RTN","ORWDXM1",59,0)
 I 'ORWMODE D
"RTN","ORWDXM1",60,0)
 . D SETKEYV^ORWDXM3($P(FLDS,U,11,20)) ; from menu path
"RTN","ORWDXM1",61,0)
 . S KEYVAR=$$KEYVAR^ORWDXM3(ORIT) ; from entry action
"RTN","ORWDXM1",62,0)
 . D SETKEYV^ORWDXM3(KEYVAR)
"RTN","ORWDXM1",63,0)
 K ^TMP("ORWORD",$J)
"RTN","ORWDXM1",64,0)
 ; init return record based on auto-accept
"RTN","ORWDXM1",65,0)
 I ORWMODE S LST(0)="2^"_ORIT ;verify on copy
"RTN","ORWDXM1",66,0)
 E  S LST(0)=+$P($G(^ORD(101.41,ORIT,5)),U,8)_U_ORIT
"RTN","ORWDXM1",67,0)
 S TEMPCAT=$S($L($P($G(^DPT(+ORVP,.1)),U)):"I",1:"O")
"RTN","ORWDXM1",68,0)
 I TEMPCAT="I",+$P(FLDS,U,4)=1,$E(TEMPORIT)="C",$P($G(^ORD(100.98,$P($G(^OR(100,+ORIT,0)),U,11),0)),U)="OUTPATIENT MEDICATIONS" S TEMPCAT="O"
"RTN","ORWDXM1",69,0)
 I $L($G(OREVNTYP)) D
"RTN","ORWDXM1",70,0)
 . S ORCAT=$S(OREVNTYP="A":"I",OREVNTYP="T":"I",OREVNTYP="O":TEMPCAT,OREVNTYP="M":TEMPCAT,OREVNTYP="C":TEMPCAT,1:"O") I $G(OREVENT) D
"RTN","ORWDXM1",71,0)
 .. N X S X=$$EVT^OREVNTX(OREVENT),X=$P($G(^ORD(100.5,+X,0)),U,7)
"RTN","ORWDXM1",72,0)
 .. I OREVNTYP="T",X,X<4 S ORCAT="O" ;To pass=outpt
"RTN","ORWDXM1",73,0)
 .. I OREVNTYP="D",X=41 S ORCAT="I" ;From ASIH=inpt
"RTN","ORWDXM1",74,0)
 E  S ORCAT=TEMPCAT
"RTN","ORWDXM1",75,0)
 D SETUP^ORWDXM4 Q:+LST(0)=8
"RTN","ORWDXM1",76,0)
 S X="OR GTX START DATE"_$S($G(ORWP94):"/TIME",1:"")
"RTN","ORWDXM1",77,0)
 I ORWMODE,(ORDG=+$O(^ORD(100.98,"B","O RX",0))) D  ;remove old values
"RTN","ORWDXM1",78,0)
 . K ORDIALOG($$PTR^ORCD(X),1)
"RTN","ORWDXM1",79,0)
 . I ORWMODE=2,$$DRAFT^ORWDX2(ORIT) Q  ;keep comments
"RTN","ORWDXM1",80,0)
 . K:ISXFER'["T" ORDIALOG($$PTR^ORCD("OR GTX WORD PROCESSING 1"),1)
"RTN","ORWDXM1",81,0)
 D SETUPS^ORWDXM4 ;moved to save space, expects X
"RTN","ORWDXM1",82,0)
 Q:+LST(0)=8
"RTN","ORWDXM1",83,0)
 I $G(ORQUIT) S LST(0)="0^0^"_$$DLGINFO^ORWDXM3(ORIT,ORWMODE_ISXFER)_"^"_$G(KEYVAR) Q
"RTN","ORWDXM1",84,0)
 N SEQ,DA,XCODE,MUSTASK,PROMPT,INST,KEY,IVFID,CLIVFID
"RTN","ORWDXM1",85,0)
 S IVFID=$O(^ORD(101.41,"B","PSJI OR PAT FLUID OE",0))
"RTN","ORWDXM1",86,0)
 S CLIVFID=$O(^ORD(101.41,"B","CLINIC OR PAT FLUID OE",0))
"RTN","ORWDXM1",87,0)
 S AUTOACK=$S($D(ORWPSWRG):0,1:1)
"RTN","ORWDXM1",88,0)
 ; If copying, clear bad dates. Later, SETITEM will fill dates with default values. ;DJE-VM *331
"RTN","ORWDXM1",89,0)
 I ORWMODE=1 D  ;
"RTN","ORWDXM1",90,0)
 . I $L($$VAL^ORCD("START DATE")) D  ;
"RTN","ORWDXM1",91,0)
 . . S X=$$VAL^ORCD("START DATE"),%DT="TX" D ^%DT
"RTN","ORWDXM1",92,0)
 . . I Y'<$$DT^XLFDT,(($L($$VAL^ORCD("STOP DATE"))=0)!('$$FTDCOMP^ORCD("START DATE","STOP DATE",">"))) Q  ;quit if valid dates: start not in the past or stop after start
"RTN","ORWDXM1",93,0)
 . . K ORDIALOG($$PTR("START DATE"),1),ORDIALOG($$PTR("START DATE/TIME"),1) ;erase bad start and stop dates.
"RTN","ORWDXM1",94,0)
 . . K ORDIALOG($$PTR("STOP DATE"),1),ORDIALOG($$PTR("STOP DATE/TIME"),1)
"RTN","ORWDXM1",95,0)
 . ; check start and stop dates found in diet orders
"RTN","ORWDXM1",96,0)
 . I $L($$VAL^ORCD("EFFECTIVE DATE/TIME")) D  ;
"RTN","ORWDXM1",97,0)
 . . S X=$$VAL^ORCD("EFFECTIVE DATE/TIME"),%DT="TX" D ^%DT
"RTN","ORWDXM1",98,0)
 . . I Y'<$$DT^XLFDT,(($L($$VAL^ORCD("EXPIRATION DATE/TIME"))=0)!('$$FTDCOMP^ORCD("EFFECTIVE DATE/TIME","EXPIRATION DATE/TIME",">"))) Q  ;quit if valid dates: start not in the past or stop after start
"RTN","ORWDXM1",99,0)
 . . K ORDIALOG($P(ORDIALOG("B","EFFECTIVE DATE/TIME"),U,2),1) ;erase bad start and stop dates.
"RTN","ORWDXM1",100,0)
 . . K ORDIALOG($P(ORDIALOG("B","EXPIRATION DATE/TIME"),U,2),1)
"RTN","ORWDXM1",101,0)
 . ; check date desired field found in imaging orders
"RTN","ORWDXM1",102,0)
 . I $L($$VAL^ORCD("DATE DESIRED")) D  ;
"RTN","ORWDXM1",103,0)
 . . S X=$$VAL^ORCD("DATE DESIRED"),%DT="TX" D ^%DT
"RTN","ORWDXM1",104,0)
 . . I Y'<$$DT^XLFDT Q  ;quit if not a past date
"RTN","ORWDXM1",105,0)
 . . K ORDIALOG($P(ORDIALOG("B","DATE DESIRED"),U,2),1) ;erase bad date
"RTN","ORWDXM1",106,0)
 . ; check collection date field found in lab orders
"RTN","ORWDXM1",107,0)
 . I $L($$VAL^ORCD("COLLECTION DATE/TIME")) D  ;
"RTN","ORWDXM1",108,0)
 . . S X=$$VAL^ORCD("COLLECTION DATE/TIME")
"RTN","ORWDXM1",109,0)
 . . I X="NEXT" Q  ;No need to check this.
"RTN","ORWDXM1",110,0)
 . . S %DT="TX" D ^%DT
"RTN","ORWDXM1",111,0)
 . . I $P(Y,".",2),Y'<$E($$NOW^XLFDT,1,12) Q  ;quit if not a past date and time (lab is more precise than other dates)
"RTN","ORWDXM1",112,0)
 . . I $P(Y,".",2)="",Y'<$$DT^XLFDT Q  ;
"RTN","ORWDXM1",113,0)
 . . K ORDIALOG($P(ORDIALOG("B","COLLECTION DATE/TIME"),U,2),1) ;erase bad date
"RTN","ORWDXM1",114,0)
 . ;if copying a "Return to Clinic" order, force user to enter a date
"RTN","ORWDXM1",115,0)
 . I $L($$VAL^ORCD("RETURN TO CLINIC DATE")) D
"RTN","ORWDXM1",116,0)
 . . K ORDIALOG($P(ORDIALOG("B","RETURN TO CLINIC DATE"),U,2),1)
"RTN","ORWDXM1",117,0)
 S SEQ=0 F  S SEQ=$O(^ORD(101.41,+ORDIALOG,10,"B",SEQ)) Q:'SEQ  D
"RTN","ORWDXM1",118,0)
 . S DA=0 F  S DA=$O(^ORD(101.41,+ORDIALOG,10,"B",SEQ,DA)) Q:'DA  D
"RTN","ORWDXM1",119,0)
 . . ; skip if child prmpt
"RTN","ORWDXM1",120,0)
 . . I $P(^ORD(101.41,+ORDIALOG,10,DA,0),U,11) Q
"RTN","ORWDXM1",121,0)
 . . ; set dflt for prmpt, chk if interactive
"RTN","ORWDXM1",122,0)
 . . S PROMPT=$P(^ORD(101.41,+ORDIALOG,10,DA,0),U,2)
"RTN","ORWDXM1",123,0)
 . . D SETITEM(DA,PROMPT,1,.MUSTASK)
"RTN","ORWDXM1",124,0)
 . . I MUSTASK S AUTOACK=0 Q
"RTN","ORWDXM1",125,0)
 . . ; iterate through child items if parent & edit only
"RTN","ORWDXM1",126,0)
 . . Q:'$D(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT))
"RTN","ORWDXM1",127,0)
 . . N CSEQ,CDA,CPROMPT,INST,ORQUIT
"RTN","ORWDXM1",128,0)
 . . S CSEQ=0 F  S CSEQ=$O(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT,CSEQ)) Q:'CSEQ  D  Q:$G(ORQUIT)
"RTN","ORWDXM1",129,0)
 . . . S CDA=$O(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT,CSEQ,0))
"RTN","ORWDXM1",130,0)
 . . . S CPROMPT=$P(^ORD(101.41,+ORDIALOG,10,CDA,0),U,2)
"RTN","ORWDXM1",131,0)
 . . . ; if req & no instances then need interaction
"RTN","ORWDXM1",132,0)
 . . . I $P(^ORD(101.41,+ORDIALOG,10,CDA,0),U,6) D
"RTN","ORWDXM1",133,0)
 . . . . I ORDIALOG=IVFID!(ORDIALOG=CLIVFID) Q
"RTN","ORWDXM1",134,0)
 . . . . I '$O(ORDIALOG(CPROMPT,0)) S AUTOACK=0
"RTN","ORWDXM1",135,0)
 . . . S INST=0 F  S INST=$O(ORDIALOG(CPROMPT,INST)) Q:'INST  D
"RTN","ORWDXM1",136,0)
 . . . . N ORASK D VBASK^ORWDXM4(INST) ; set ORASK for VBECS
"RTN","ORWDXM1",137,0)
 . . . . ; set dflt for each child prmpt
"RTN","ORWDXM1",138,0)
 . . . . D SETITEM(CDA,CPROMPT,INST,.MUSTASK)
"RTN","ORWDXM1",139,0)
 . . . . ; if no val & child prmpt req'd then need interaction
"RTN","ORWDXM1",140,0)
 . . . . I MUSTASK,$P(^ORD(101.41,+ORDIALOG,10,CDA,0),U,6) S AUTOACK=0
"RTN","ORWDXM1",141,0)
 N IVDLG,CLINFDLG,SPLYDLG
"RTN","ORWDXM1",142,0)
 S IVDLG=$O(^ORD(101.41,"AB","PSJI OR PAT FLUID OE",0))
"RTN","ORWDXM1",143,0)
 S CLINFDLG=$O(^ORD(101.41,"AB","CLINIC OR PAT FLUID OE",0))
"RTN","ORWDXM1",144,0)
 S SPLYDLG=$O(^ORD(101.41,"AB","PSO SUPPLY",0))
"RTN","ORWDXM1",145,0)
 I $$ISMED(ORIT),(ORDIALOG'=IVDLG),(ORDIALOG'=CLINFDLG),(ORDIALOG'=SPLYDLG),(ORCAT="I") D
"RTN","ORWDXM1",146,0)
 . N P
"RTN","ORWDXM1",147,0)
 . F P="PATIENT INSTRUCTIONS","DAYS SUPPLY","QUANTITY","REFILLS","ROUTING","SERVICE CONNECTED" K ORDIALOG($$PTR(P),1)
"RTN","ORWDXM1",148,0)
 . I '$$ISQO(ORIT) K ORDIALOG($$PTR("START DATE/TIME"),1) ; kill if not a non-VA med quick order. p388
"RTN","ORWDXM1",149,0)
 S KEY=$S(ORWMODE:"C",1:"")_ORIT_"-"_$P($H,",",2),SEQ=0
"RTN","ORWDXM1",150,0)
 I $$ISINPMED(ORIT) D
"RTN","ORWDXM1",151,0)
 .S LEVEL=$P(LST(0),U),DELAY=$S($P($G(OREVENT),";")>0:1,1:0)
"RTN","ORWDXM1",152,0)
 .I LEVEL=2!(ISIMO) D ADMTIME^ORWDXM2(ORDLOC,PATLOC,ENCLOC,DELAY,ISIMO)
"RTN","ORWDXM1",153,0)
 I ($$ISMED(ORIT)),'($$VALQO^ORWDXM3(ORIT)) S AUTOACK=0
"RTN","ORWDXM1",154,0)
 I 'ORWMODE,$P(^ORD(101.41,+ORIT,0),U,7)=$O(^DIC(9.4,"C","SD",0)),'($$SDRTCVER^ORWDXM3(.ORDIALOG)) S AUTOACK=0
"RTN","ORWDXM1",155,0)
 S PROMPT=0 F  S PROMPT=$O(ORDIALOG(PROMPT)) Q:'PROMPT  D
"RTN","ORWDXM1",156,0)
 . I '$D(^ORD(101.41,ORDIALOG,10,"D",PROMPT)) K ORDIALOG(PROMPT) Q
"RTN","ORWDXM1",157,0)
 . S INST=0 F  S INST=$O(ORDIALOG(PROMPT,INST)) Q:'INST  D
"RTN","ORWDXM1",158,0)
 . . S SEQ=SEQ+1,^TMP("ORWDXMQ",$J,KEY,SEQ,0)=U_PROMPT_U_INST
"RTN","ORWDXM1",159,0)
 . . ; save word proc val
"RTN","ORWDXM1",160,0)
 . . I $E(ORDIALOG(PROMPT,0))="W",$L(ORDIALOG(PROMPT,INST)) D
"RTN","ORWDXM1",161,0)
 . . . M ^TMP("ORWDXMQ",$J,KEY,SEQ,2)=@ORDIALOG(PROMPT,INST)
"RTN","ORWDXM1",162,0)
 . . ; save other val types
"RTN","ORWDXM1",163,0)
 . . E  S ^TMP("ORWDXMQ",$J,KEY,SEQ,1)=ORDIALOG(PROMPT,INST)
"RTN","ORWDXM1",164,0)
 I AUTOACK D
"RTN","ORWDXM1",165,0)
 . I ORWMODE S AUTOACK=2
"RTN","ORWDXM1",166,0)
 . I 'ORWMODE,($P(^ORD(101.41,ORIT,0),U,8)!'LST(0)) S AUTOACK=2
"RTN","ORWDXM1",167,0)
 ;I ($$ISMED(ORIT)),'($$VALQO^ORWDXM3(ORIT)) S AUTOACK=0
"RTN","ORWDXM1",168,0)
 I ORIMO,ORWMODE S AUTOACK=2
"RTN","ORWDXM1",169,0)
 ; accept Herbal/OTC/NonVA Med quick orders
"RTN","ORWDXM1",170,0)
 I $L($G(^ORD(101.41,+ORIT,0))),($P(^ORD(100.98,$P(^ORD(101.41,+ORIT,0),U,5),0),U,3)="NV RX"),($P($G(^ORD(101.41,+ORIT,5)),U,8)) S AUTOACK=1
"RTN","ORWDXM1",171,0)
 ;I AUTOACK=2,$$ISMED(ORIT),(ORDIALOG=IVDLG),$$VERORD^ORWDXM3=0 S AUTOACK=0
"RTN","ORWDXM1",172,0)
 I AUTOACK=2,$$ISMED(ORIT),$$VERORD^ORWDXM3(ORIT)=0 S AUTOACK=0
"RTN","ORWDXM1",173,0)
 I AUTOACK=2 D VERTXT^ORWDXM2
"RTN","ORWDXM1",174,0)
 S LST(0)=AUTOACK_U_KEY_U_$$DLGINFO^ORWDXM3(ORIT,ORWMODE_ISXFER)_"^"_$G(KEYVAR)
"RTN","ORWDXM1",175,0)
 I $P(LST(0),U,4)="D" S $P(LST(0),U,4)="Q"
"RTN","ORWDXM1",176,0)
 I ORWMODE=1 S $P(LST(0),U,4)="C"
"RTN","ORWDXM1",177,0)
 K ^TMP("ORWORD",$J)
"RTN","ORWDXM1",178,0)
 K ^TMP("PSJINS",$J),^TMP("PSJMR",$J),^TMP("PSJNOUN",$J)
"RTN","ORWDXM1",179,0)
 Q
"RTN","ORWDXM1",180,0)
SETITEM(DA,PROMPT,INST,MUSTASK) ; set dflt val & return if must prompt
"RTN","ORWDXM1",181,0)
 N EDITONLY,Y,VALIV,XCODE
"RTN","ORWDXM1",182,0)
 S MUSTASK=0,EDITONLY=0,VALIV=0
"RTN","ORWDXM1",183,0)
 I $D(^TMP("ORWDHTM",$J,ORDIALOG,PROMPT)) D
"RTN","ORWDXM1",184,0)
 . I $E(ORDIALOG(PROMPT,0))="W" D
"RTN","ORWDXM1",185,0)
 . . S ^TMP("ORWORD",$J,PROMPT,INST,1,0)=^TMP("ORWDHTM",$J,ORDIALOG,PROMPT)
"RTN","ORWDXM1",186,0)
 . . S ORDIALOG(PROMPT,INST)="^TMP(""ORWORD"","_$J_","_PROMPT_","_INST_")"
"RTN","ORWDXM1",187,0)
 . E  S ORDIALOG(PROMPT,INST)=^TMP("ORWDHTM",$J,ORDIALOG,PROMPT)
"RTN","ORWDXM1",188,0)
 I $D(^TMP("ORWDHTM",$J,ORIT,PROMPT)) D
"RTN","ORWDXM1",189,0)
 . S ORDIALOG(PROMPT,INST)=^TMP("ORWDHTM",$J,ORIT,PROMPT)
"RTN","ORWDXM1",190,0)
 . ; NEED TO CLEAN UP ^TMP("ORWDHTM") after process order set!!!
"RTN","ORWDXM1",191,0)
 ;
"RTN","ORWDXM1",192,0)
 ; skip if a value already exists for this prompt and not WP
"RTN","ORWDXM1",193,0)
 Q:$D(ORDIALOG(PROMPT,INST))&($E(ORDIALOG(PROMPT,0))'="W")
"RTN","ORWDXM1",194,0)
 ; execute default action if no value in QO, checking EDITONLY afterwards
"RTN","ORWDXM1",195,0)
 I '$D(ORDIALOG(PROMPT,INST)) D
"RTN","ORWDXM1",196,0)
 . ;
"RTN","ORWDXM1",197,0)
 . ;Intermittent IV orders do not require a solution or an infusion rate
"RTN","ORWDXM1",198,0)
 . I PROMPT=$$PTR("INFUSION RATE"),$$GETIVTYP^ORWDXM3="I" S VALIV=1 Q
"RTN","ORWDXM1",199,0)
 . I PROMPT=$$PTR("ORDERABLE ITEM"),$$GETIVTYP^ORWDXM3="I" S VALIV=1 Q
"RTN","ORWDXM1",200,0)
 . I $E(ORDIALOG(PROMPT,0))="W",$D(^ORD(101.41,+ORDIALOG,10,DA,8))>9 D
"RTN","ORWDXM1",201,0)
 . . M ^TMP("ORWORD",$J,PROMPT,INST)=^ORD(101.41,+ORDIALOG,10,DA,8)
"RTN","ORWDXM1",202,0)
 . . S ORDIALOG(PROMPT,INST)="^TMP(""ORWORD"","_$J_","_PROMPT_","_INST_")"
"RTN","ORWDXM1",203,0)
 . E  D
"RTN","ORWDXM1",204,0)
 . . S XCODE=$$SUBCODE($G(^ORD(101.41,+ORDIALOG,10,DA,7)))
"RTN","ORWDXM1",205,0)
 . . I $L(XCODE) X XCODE S:$D(Y) ORDIALOG(PROMPT,INST)=Y
"RTN","ORWDXM1",206,0)
 Q:VALIV=1
"RTN","ORWDXM1",207,0)
 Q:$G(EDITONLY)
"RTN","ORWDXM1",208,0)
 I 'ORWMODE,$P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,8) Q
"RTN","ORWDXM1",209,0)
 I ORWMODE,($P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,9)'["W"),'$P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,6)!$D(ORDIALOG(PROMPT,INST)) Q
"RTN","ORWDXM1",210,0)
 I 'ORWMODE,LST(0),$D(ORDIALOG(PROMPT,INST)),($E(ORDIALOG(PROMPT,0))="W") Q
"RTN","ORWDXM1",211,0)
 I 'ORWMODE,LST(0),'$P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,6) Q
"RTN","ORWDXM1",212,0)
 S XCODE=$$SUBCODE($G(^ORD(101.41,+ORDIALOG,10,DA,3)))
"RTN","ORWDXM1",213,0)
 I $L(XCODE) X XCODE Q:'$T
"RTN","ORWDXM1",214,0)
 S MUSTASK=1
"RTN","ORWDXM1",215,0)
 Q
"RTN","ORWDXM1",216,0)
SUBCODE(X) ; substitute code
"RTN","ORWDXM1",217,0)
 I X["$$REQDCOMM^ORCDLR" Q "I $$LRRQCM^ORWDXM2"
"RTN","ORWDXM1",218,0)
 I X["$$ASKSAMP^ORCDLR" Q "I $$LRASMP^ORWDXM2"
"RTN","ORWDXM1",219,0)
 I X["$$SCHEDULD^ORCDRA1" Q "I $$SCHEDULD^ORWDXM2"
"RTN","ORWDXM1",220,0)
 I X["(^PSX(550,""C"")" Q "S Y=$E($$DEFPICK^ORWDPS32) K:'$L(Y) Y"
"RTN","ORWDXM1",221,0)
 I X["I $$ASKURG^ORCDVBEC" Q "I 1"
"RTN","ORWDXM1",222,0)
 I X["K:$G(ORASK)" Q "I $G(ORASK)"
"RTN","ORWDXM1",223,0)
 Q X
"RTN","ORWDXM1",224,0)
PTR(NAME) ; -- Returns pointer to OR GTX NAME
"RTN","ORWDXM1",225,0)
 Q +$O(^ORD(101.41,"AB",$E("OR GTX "_NAME,1,63),0))
"RTN","ORWDXM1",226,0)
 ;
"RTN","ORWDXM1",227,0)
ISINPMED(IFN) ;
"RTN","ORWDXM1",228,0)
 N PKG,RESULT,Y
"RTN","ORWDXM1",229,0)
 I 'ORWMODE S PKG=$P($G(^ORD(101.41,IFN,0)),U,7)
"RTN","ORWDXM1",230,0)
 E  S PKG=$P($G(^OR(100,+IFN,0)),U,14)
"RTN","ORWDXM1",231,0)
 S Y=$$GET1^DIQ(9.4,+PKG_",",1)
"RTN","ORWDXM1",232,0)
 S RESULT=$S($E(Y,1,3)="PSJ":1,1:0)
"RTN","ORWDXM1",233,0)
 Q RESULT
"RTN","ORWDXM1",234,0)
 ;
"RTN","ORWDXM1",235,0)
ISMED(IFN) ; return 1 if pharmacy order dlg used
"RTN","ORWDXM1",236,0)
 N PKG
"RTN","ORWDXM1",237,0)
 I 'ORWMODE S PKG=$P($G(^ORD(101.41,IFN,0)),U,7)
"RTN","ORWDXM1",238,0)
 E  S PKG=$P($G(^OR(100,+IFN,0)),U,14)
"RTN","ORWDXM1",239,0)
 Q $$NMSP^ORCD(PKG)="PS"
"RTN","ORWDXM1",240,0)
SITEVAL() ;return 1 if site does want the reason for study to carry through from past orders of this ordering session
"RTN","ORWDXM1",241,0)
 I $$GET^XPAR("ALL^SRV.`"_+^VA(200,DUZ,5),"OR RA RFS CARRY ON")=0 Q 0
"RTN","ORWDXM1",242,0)
 Q 1
"RTN","ORWDXM1",243,0)
SVRPC(RET,X) ;RPC FOR SITEVAL
"RTN","ORWDXM1",244,0)
 S RET=$$SITEVAL
"RTN","ORWDXM1",245,0)
 Q
"RTN","ORWDXM1",246,0)
ISQO(IFN) ;return 1 if a non-VA medication quick order type of order dialog. p388
"RTN","ORWDXM1",247,0)
 I $P($G(^ORD(101.41,IFN,0)),U,5)'=$O(^ORD(100.98,"B","NV RX",0)) Q 0
"RTN","ORWDXM1",248,0)
 I $P($G(^ORD(101.41,IFN,0)),U,4)="Q" Q 1
"RTN","ORWDXM1",249,0)
 Q 0
"VER")
8.0^22.2
"BLD",11215,6)
^417
**END**
**END**

