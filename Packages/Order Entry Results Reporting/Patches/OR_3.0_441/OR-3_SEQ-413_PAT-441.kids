Released OR*3*441 SEQ #413
Extracted from mail message
**KIDS**:OR*3.0*441^

**INSTALL NAME**
OR*3.0*441
"BLD",10032,0)
OR*3.0*441^ORDER ENTRY/RESULTS REPORTING^0^3181010^y
"BLD",10032,1,0)
^^1^1^3170127^^
"BLD",10032,1,1,0)
Please see forum for a complete description of patch OR*3.0*441
"BLD",10032,4,0)
^9.64PA^100.953^2
"BLD",10032,4,100.95,0)
100.95
"BLD",10032,4,100.95,222)
y^y^f^^^^n
"BLD",10032,4,100.953,0)
100.953
"BLD",10032,4,100.953,222)
y^y^f^^^^n
"BLD",10032,4,"B",100.95,100.95)

"BLD",10032,4,"B",100.953,100.953)

"BLD",10032,6.3)
52
"BLD",10032,"ABPKG")
n
"BLD",10032,"INID")
^y
"BLD",10032,"INIT")
ORQO441P
"BLD",10032,"KRN",0)
^9.67PA^779.2^20
"BLD",10032,"KRN",.4,0)
.4
"BLD",10032,"KRN",.4,"NM",0)
^9.68A^1^1
"BLD",10032,"KRN",.4,"NM",1,0)
OR QUICK ORDER AUDIT REPORT    FILE #100.95^100.95^0
"BLD",10032,"KRN",.4,"NM","B","OR QUICK ORDER AUDIT REPORT    FILE #100.95",1)

"BLD",10032,"KRN",.401,0)
.401
"BLD",10032,"KRN",.401,"NM",0)
^9.68A^1^1
"BLD",10032,"KRN",.401,"NM",1,0)
OR QUICK ORDER AUDIT REPORT    FILE #100.95^100.95^0
"BLD",10032,"KRN",.401,"NM","B","OR QUICK ORDER AUDIT REPORT    FILE #100.95",1)

"BLD",10032,"KRN",.402,0)
.402
"BLD",10032,"KRN",.402,"NM",0)
^9.68A^^0
"BLD",10032,"KRN",.403,0)
.403
"BLD",10032,"KRN",.5,0)
.5
"BLD",10032,"KRN",.84,0)
.84
"BLD",10032,"KRN",.84,"NM",0)
^9.68A^^
"BLD",10032,"KRN",3.6,0)
3.6
"BLD",10032,"KRN",3.8,0)
3.8
"BLD",10032,"KRN",9.2,0)
9.2
"BLD",10032,"KRN",9.8,0)
9.8
"BLD",10032,"KRN",9.8,"NM",0)
^9.68A^11^6
"BLD",10032,"KRN",9.8,"NM",3,0)
ORQOAUIC^^0^B15051497
"BLD",10032,"KRN",9.8,"NM",7,0)
ORWDXM3^^0^B120942767
"BLD",10032,"KRN",9.8,"NM",8,0)
ORQOAUIA^^0^B6757048
"BLD",10032,"KRN",9.8,"NM",9,0)
ORQOAUIB^^0^B45897882
"BLD",10032,"KRN",9.8,"NM",10,0)
ORQ12^^0^B41144852
"BLD",10032,"KRN",9.8,"NM",11,0)
ORWPT^^0^B77269918
"BLD",10032,"KRN",9.8,"NM","B","ORQ12",10)

"BLD",10032,"KRN",9.8,"NM","B","ORQOAUIA",8)

"BLD",10032,"KRN",9.8,"NM","B","ORQOAUIB",9)

"BLD",10032,"KRN",9.8,"NM","B","ORQOAUIC",3)

"BLD",10032,"KRN",9.8,"NM","B","ORWDXM3",7)

"BLD",10032,"KRN",9.8,"NM","B","ORWPT",11)

"BLD",10032,"KRN",19,0)
19
"BLD",10032,"KRN",19,"NM",0)
^9.68A^6^6
"BLD",10032,"KRN",19,"NM",1,0)
OR QUICK ORDER AUDIT INQUIRY^^0
"BLD",10032,"KRN",19,"NM",2,0)
OR QUICK ORDER AUDIT MENU^^0
"BLD",10032,"KRN",19,"NM",3,0)
OR QUICK ORDER AUDIT PRINT^^0
"BLD",10032,"KRN",19,"NM",4,0)
OR QUICK ORDER NIGHTLY BG^^0
"BLD",10032,"KRN",19,"NM",5,0)
OR QUICK ORDER AUDIT MONTHLY^^0
"BLD",10032,"KRN",19,"NM",6,0)
OR QUICK ORDER DIVISION GROUPS^^0
"BLD",10032,"KRN",19,"NM","B","OR QUICK ORDER AUDIT INQUIRY",1)

"BLD",10032,"KRN",19,"NM","B","OR QUICK ORDER AUDIT MENU",2)

"BLD",10032,"KRN",19,"NM","B","OR QUICK ORDER AUDIT MONTHLY",5)

"BLD",10032,"KRN",19,"NM","B","OR QUICK ORDER AUDIT PRINT",3)

"BLD",10032,"KRN",19,"NM","B","OR QUICK ORDER DIVISION GROUPS",6)

"BLD",10032,"KRN",19,"NM","B","OR QUICK ORDER NIGHTLY BG",4)

"BLD",10032,"KRN",19.1,0)
19.1
"BLD",10032,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",10032,"KRN",101,0)
101
"BLD",10032,"KRN",409.61,0)
409.61
"BLD",10032,"KRN",771,0)
771
"BLD",10032,"KRN",779.2,0)
779.2
"BLD",10032,"KRN",870,0)
870
"BLD",10032,"KRN",8989.51,0)
8989.51
"BLD",10032,"KRN",8989.51,"NM",0)
^9.68A^1^1
"BLD",10032,"KRN",8989.51,"NM",1,0)
OR FLAGGED & WARD COMMENTS^^0
"BLD",10032,"KRN",8989.51,"NM","B","OR FLAGGED & WARD COMMENTS",1)

"BLD",10032,"KRN",8989.52,0)
8989.52
"BLD",10032,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",10032,"KRN",8994,0)
8994
"BLD",10032,"KRN",8994,"NM",0)
^9.68A^^
"BLD",10032,"KRN","B",.4,.4)

"BLD",10032,"KRN","B",.401,.401)

"BLD",10032,"KRN","B",.402,.402)

"BLD",10032,"KRN","B",.403,.403)

"BLD",10032,"KRN","B",.5,.5)

"BLD",10032,"KRN","B",.84,.84)

"BLD",10032,"KRN","B",3.6,3.6)

"BLD",10032,"KRN","B",3.8,3.8)

"BLD",10032,"KRN","B",9.2,9.2)

"BLD",10032,"KRN","B",9.8,9.8)

"BLD",10032,"KRN","B",19,19)

"BLD",10032,"KRN","B",19.1,19.1)

"BLD",10032,"KRN","B",101,101)

"BLD",10032,"KRN","B",409.61,409.61)

"BLD",10032,"KRN","B",771,771)

"BLD",10032,"KRN","B",779.2,779.2)

"BLD",10032,"KRN","B",870,870)

"BLD",10032,"KRN","B",8989.51,8989.51)

"BLD",10032,"KRN","B",8989.52,8989.52)

"BLD",10032,"KRN","B",8994,8994)

"BLD",10032,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",10032,"QUES",0)
^9.62^^
"BLD",10032,"REQB",0)
^9.611^3^3
"BLD",10032,"REQB",1,0)
OR*3.0*311^1
"BLD",10032,"REQB",2,0)
OR*3.0*356^1
"BLD",10032,"REQB",3,0)
OR*3.0*434^1
"BLD",10032,"REQB","B","OR*3.0*311",1)

"BLD",10032,"REQB","B","OR*3.0*356",2)

"BLD",10032,"REQB","B","OR*3.0*434",3)

"FIA",100.95)
QUICK ORDER AUDIT
"FIA",100.95,0)
^OR(100.95,
"FIA",100.95,0,0)
100.95D
"FIA",100.95,0,1)
y^y^f^^^^n
"FIA",100.95,0,10)

"FIA",100.95,0,11)

"FIA",100.95,0,"RLRO")

"FIA",100.95,0,"VR")
3.0^OR
"FIA",100.95,100.95)
0
"FIA",100.953)
QUICK ORDER DIVISION GROUPS
"FIA",100.953,0)
^OR(100.953,
"FIA",100.953,0,0)
100.953
"FIA",100.953,0,1)
y^y^f^^^^n
"FIA",100.953,0,10)

"FIA",100.953,0,11)

"FIA",100.953,0,"RLRO")

"FIA",100.953,0,"VR")
3.0^OR
"FIA",100.953,100.953)
0
"FIA",100.953,100.9531)
0
"INIT")
ORQO441P
"KRN",.4,5727,-1)
0^1
"KRN",.4,5727,0)
OR QUICK ORDER AUDIT REPORT^3180912.1321^@^100.95^^@^3180926^
"KRN",.4,5727,"DXS")
3
"KRN",.4,5727,"DXS",1,9.2)
S DIP(2)=$S($D(^OR(100.95,D0,0)):^(0),1:"") S X="PID: ",DIP(1)=$G(X) S X=$P($G(^DPT(+$P(DIP(2),U,3),0)),U),DIP(3)=$G(X) S X=",",DIP(4)=$G(X) S X=1
"KRN",.4,5727,"DXS",2,9)
S DIP(2)=$C(59)_$P($G(^DD(100.95,5,0)),U,3),DIP(1)=$S($D(^OR(100.95,D0,0)):^(0),1:"") S X="ORDER TYPE: "_$P($P(DIP(2),$C(59)_$P(DIP(1),U,6)_":",2),$C(59))
"KRN",.4,5727,"F",1)

"KRN",.4,5727,"F",2)
S DIP(1)=$S($D(^OR(100.95,D0,0)):^(0),1:"") S X="QUICK ORDER: "_$P($G(^ORD(101.41,+$P(DIP(1),U,4),0)),U) W X K DIP;C1;S;Z;""QUICK ORDER: "_QUICK ORDER"~
"KRN",.4,5727,"F",3)
X DXS(1,9.2) S X=$P(DIP(3),DIP(4),X) S Y=X,X=DIP(1),X=X_Y_"("_$P(DIP(2),U,9)_")" W X K DIP;C1;Z;""PID: "_$P(PATIENT,",",1)_"("_LAST4_")""~
"KRN",.4,5727,"F",4)
S DIP(1)=$S($D(^OR(100.95,D0,0)):^(0),1:"") S X="ORDER #: "_$P($G(^OR(100,+$P(DIP(1),U,8),0)),U) W X K DIP;C1;Z;""ORDER #: "_ORDER"~
"KRN",.4,5727,"F",5)
S DIP(1)=$S($D(^OR(100.95,D0,0)):^(0),1:"") S X="USER: "_$P($G(^VA(200,+$P(DIP(1),U,2),0)),U) W X K DIP;C30;Z;""USER: "_USER"~.01;C55~
"KRN",.4,5727,"F",6)
S X="CONFIRMATION #: "_$S('$D(D0):"",D0<0:"",1:D0) W X K DIP;C1;Z;""CONFIRMATION #: "_NUMBER"~
"KRN",.4,5727,"F",7)
S DIP(1)=$S($D(^OR(100.95,D0,0)):^(0),1:"") S X="PROVIDER: "_$P($G(^VA(200,+$P(DIP(1),U,5),0)),U) W X K DIP;C30;Z;""PROVIDER: "_PROVIDER"~
"KRN",.4,5727,"F",8)
X DXS(2,9) W X K DIP;C1;Z;""ORDER TYPE: "_TYPE"~X "N I,Y "_$P(^DD(100.95,99,0),U,5,99) S DIP(1)=X S X="DRUG: "_DIP(1) W X K DIP;C30;Z;""DRUG: "_DRUG"~
"KRN",.4,5727,"F",9)
S DIP(1)=$S($D(^OR(100.95,D0,0)):^(0),1:"") S X="LOCATION: "_$P($G(^SC(+$P(DIP(1),U,7),0)),U) W X K DIP;C1;Z;""LOCATION: "_LOCATION"~
"KRN",.4,5727,"F",10)
W:$P(^OR(100.95,D0,0),U,7)="" "MISSING LOCATION";"";Z;"W:$P(^OR(100.95,D0,0),U,7)="" "MISSING LOCATION""~
"KRN",.4,5727,"H")
QUICK ORDER AUDIT PRINT: An order # appears if the order is processed.
"KRN",.4,5727,"HLANG")
1
"KRN",.401,450038,-1)
0^1
"KRN",.401,450038,0)
OR QUICK ORDER AUDIT REPORT^3171220.1817^@^100.95^^@^3180926
"KRN",.401,450038,2,0)
^.4014^1^1
"KRN",.401,450038,2,1,0)
100.95^.01^DATE TIME^^^^^^^1
"KRN",.401,450038,2,1,"ASK")
1
"KRN",.401,450038,2,1,"F")
3171109.999999^NOV 10,2017^NOV 10,2017
"KRN",.401,450038,2,1,"GET")
S DISX(1)=$P($G(^OR(100.95,D0,0)),U)
"KRN",.401,450038,2,1,"IX")
^OR(100.95,"B",^OR(100.95,^2
"KRN",.401,450038,2,1,"LANG")
DATE TIME
"KRN",.401,450038,2,1,"QCON")
I (DISX(1)]]3171109.999999)&(DISX(1)']]3180906.24)
"KRN",.401,450038,2,1,"T")
3180906.24^SEP 6,2018@2400^SEP 6,2018@24:00
"KRN",.401,450038,2,1,"TXT")
DATE TIME from NOV 10,2017 to SEP 6,2018@24:00
"KRN",.401,450038,2,"B",100.95,1)

"KRN",.401,450038,"%D",0)
^.4012^3^3^3180116^^
"KRN",.401,450038,"%D",1,0)
 
"KRN",.401,450038,"%D",2,0)
This is the sort template that gives the prompts to select the date time 
"KRN",.401,450038,"%D",3,0)
period to use for the Quick Order Audit Report
"KRN",19,2921895,-1)
0^1
"KRN",19,2921895,0)
OR QUICK ORDER AUDIT INQUIRY^OR Quick Order Audit Inquiry ^^I^^^^^^^y^ORDER ENTRY/RESULTS REPORTING
"KRN",19,2921895,1,0)
^19.06^3^3^3180109^^
"KRN",19,2921895,1,1,0)
Display records in file 100.95, Quick Order Audit.  This file is
"KRN",19,2921895,1,2,0)
populated by data object OR QUICK ORDER AUDIT and OR QUICK ORDER AUDIT 
"KRN",19,2921895,1,3,0)
(ALT).
"KRN",19,2921895,10.1)
QO Inquiry
"KRN",19,2921895,30)
OR(100.95,
"KRN",19,2921895,31)
AEMQ
"KRN",19,2921895,32)
Enter Pharmacy Confirmation Number:
"KRN",19,2921895,80)
OR(100.95,
"KRN",19,2921895,82)
C
"KRN",19,2921895,"U")
OR QUICK ORDER AUDIT INQUIRY 
"KRN",19,2921896,-1)
0^3
"KRN",19,2921896,0)
OR QUICK ORDER AUDIT PRINT^OR Quick Order Audit Print^^R^^^^^^^y^ORDER ENTRY/RESULTS REPORTING
"KRN",19,2921896,1,0)
^19.06^2^2^3180102^^^^
"KRN",19,2921896,1,1,0)
Print all records in file 100.95, QUICK ORDER AUDIT, to a file
"KRN",19,2921896,1,2,0)
which can be then be imported into Excel.
"KRN",19,2921896,10.1)
Quick Order Audit Print
"KRN",19,2921896,25)
QOAP^ORQOAUIB
"KRN",19,2921896,60)
OR(100.95,
"KRN",19,2921896,62)
0
"KRN",19,2921896,63)

"KRN",19,2921896,"U")
OR QUICK ORDER AUDIT PRINT
"KRN",19,2921897,-1)
0^2
"KRN",19,2921897,0)
OR QUICK ORDER AUDIT MENU^OR Quick Order Audit Menu^^M^^^^^^^y^ORDER ENTRY/RESULTS REPORTING^y
"KRN",19,2921897,1,0)
^19.06^1^1^3180102^^^^
"KRN",19,2921897,1,1,0)
Anti-Microbial decision tree related options.
"KRN",19,2921897,10,0)
^19.01IP^4^4
"KRN",19,2921897,10,1,0)
2921895^1
"KRN",19,2921897,10,1,"^")
OR QUICK ORDER AUDIT INQUIRY
"KRN",19,2921897,10,2,0)
2921896^2
"KRN",19,2921897,10,2,"^")
OR QUICK ORDER AUDIT PRINT
"KRN",19,2921897,10,3,0)
2921901^3^
"KRN",19,2921897,10,3,"^")
OR QUICK ORDER AUDIT MONTHLY
"KRN",19,2921897,10,4,0)
2922043^4^
"KRN",19,2921897,10,4,"^")
OR QUICK ORDER DIVISION GROUPS
"KRN",19,2921897,10.1)
QO Menu
"KRN",19,2921897,99)
64769,36294
"KRN",19,2921897,99.1)
64359,1977
"KRN",19,2921897,"U")
OR QUICK ORDER AUDIT MENU
"KRN",19,2921898,-1)
0^4
"KRN",19,2921898,0)
OR QUICK ORDER NIGHTLY BG^OR Quick Order Nightly Background Task^^R^^^^1^^^n^ORDER ENTRY/RESULTS REPORTING^n
"KRN",19,2921898,1,0)
^19.06^7^7^3171213^^^^
"KRN",19,2921898,1,1,0)
This option loops through recent additions to the Quick Order Audit file
"KRN",19,2921898,1,2,0)
and searches the Order file for the corresponding order.  If found, the
"KRN",19,2921898,1,3,0)
ORDER field is populated.
"KRN",19,2921898,1,4,0)
  
"KRN",19,2921898,1,5,0)
 This option should be run at least once every 24 hours and is intended to
"KRN",19,2921898,1,6,0)
set up as a recurring nightly task.  However, it can also be run
"KRN",19,2921898,1,7,0)
interactively when more immediate turnaround is desired.
"KRN",19,2921898,10.1)
QUICK ORDER NIGHTLY
"KRN",19,2921898,25)
START^ORQOAUIA
"KRN",19,2921898,200.9)
y^y
"KRN",19,2921898,"U")
OR QUICK ORDER NIGHTLY BACKGRO
"KRN",19,2921901,-1)
0^5
"KRN",19,2921901,0)
OR QUICK ORDER AUDIT MONTHLY^OR Quick Order Audit Monthly^^R^^^^1^^^y^ORDER ENTRY/RESULTS REPORTING
"KRN",19,2921901,1,0)
^19.06^6^6^3171213^^^
"KRN",19,2921901,1,1,0)
Can only go back 30 days. It lists orders for a given timeframe for
"KRN",19,2921901,1,2,0)
Orderable Items marked as anti-microbial in the Orderable Items file.  
"KRN",19,2921901,1,3,0)
This list breaks these down by those ordered through Antimicrobial order
"KRN",19,2921901,1,4,0)
dialogs and those that were not.  This helps us monitor compliance on the
"KRN",19,2921901,1,5,0)
use of Antimicrobial order dialogs. For multiple division sites reports
"KRN",19,2921901,1,6,0)
can be made for each division.
"KRN",19,2921901,10.1)
antimicrobial order list
"KRN",19,2921901,25)
ORQOAUIB
"KRN",19,2921901,"U")
OR QUICK ORDER AUDIT MONTHLY
"KRN",19,2922043,-1)
0^6
"KRN",19,2922043,0)
OR QUICK ORDER DIVISION GROUPS^OR Quick Order Division Groups Edit^^R^^^^^^^y^ORDER ENTRY/RESULTS REPORTING
"KRN",19,2922043,1,0)
^19.06^4^4^3180102^^^
"KRN",19,2922043,1,1,0)
The purpose of this option is to allow the pharmacy to edit the QUICK 
"KRN",19,2922043,1,2,0)
ORDER AUDIT GROUPS file OR(100.953. This file is used to limit the 
"KRN",19,2922043,1,3,0)
content of the QUICK ORDER AUDIT MONTHLY report by MEDICAL CENTER 
"KRN",19,2922043,1,4,0)
DIVISION. 
"KRN",19,2922043,10.1)
Quick Order Audit Groups edit
"KRN",19,2922043,25)
GROUPS^ORQOAUIC
"KRN",19,2922043,"U")
OR QUICK ORDER DIVISION GROUPS
"KRN",8989.51,872,-1)
0^1
"KRN",8989.51,872,0)
OR FLAGGED & WARD COMMENTS^OR FLAGGED & WARD COMMENTS ON OFF^0^^FLAGGED AND WARD COMMENTS ON / OFF
"KRN",8989.51,872,1)
S^0:OFF;1:ON^Enter a 1 to turn on CPRS Flagged & Ward Comments, or 0 to turn it off
"KRN",8989.51,872,20,0)
^8989.512^3^3^3170122^^^
"KRN",8989.51,872,20,1,0)
This parameter is used to turn on or off the display of two comments 
"KRN",8989.51,872,20,2,0)
fields for CPRS orders. The display of Flagged Order Comments, and the 
"KRN",8989.51,872,20,3,0)
Display of Ward Comments. 
"KRN",8989.51,872,30,0)
^8989.513I^1^1
"KRN",8989.51,872,30,1,0)
1^4.2
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",6,.401)
.401;6;;;EDEOUT^DIFROMSO(.401,DA,"",XPDA);FPRE^DIFROMSI(.401,"",XPDA);EPRE^DIFROMSI(.401,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.401,DA,"",XPDA);DEL^DIFROMSK(.401,"",%)
"ORD",6,.401,0)
SORT TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PKG",188,-1)
1^1
"PKG",188,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",188,20,0)
^9.402P^^
"PKG",188,22,0)
^9.49I^1^1
"PKG",188,22,1,0)
3.0^2971217^2981113^1
"PKG",188,22,1,"PAH",1,0)
441^3181010
"PKG",188,22,1,"PAH",1,1,0)
^^1^1^3181010
"PKG",188,22,1,"PAH",1,1,1,0)
Please see forum for a complete description of patch OR*3.0*441
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","ORQ12")
0^10^B41144852^B37558185
"RTN","ORQ12",1,0)
ORQ12 ; slc/dcm - Get patient orders in context ; 11/1/11 11:39am
"RTN","ORQ12",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**12,27,78,92,116,190,220,215,243,356,441**;Dec 17, 1997;Build 52
"RTN","ORQ12",3,0)
GET(IFN,NEWD,DETAIL,ACTOR) ; -- Setup TMP array
"RTN","ORQ12",4,0)
 ; IFN=ifn of order
"RTN","ORQ12",5,0)
 ; NEWD=3rd subscript in ^TMP("ORR",$J, node (ORLIST)
"RTN","ORQ12",6,0)
 ; DETAIL=see description in ^ORQ1
"RTN","ORQ12",7,0)
 ;
"RTN","ORQ12",8,0)
 N X0,X3,X4,X6,TXT,STAT,START,DG,STOP,ENTERD
"RTN","ORQ12",9,0)
 S ORLST=ORLST+1,^TMP("ORGOTIT",$J,IFN,+$G(ACTOR))=""
"RTN","ORQ12",10,0)
 I '$G(DETAIL) S ^TMP("ORR",$J,NEWD,ORLST)=IFN_$S($G(ACTOR):";"_ACTOR,1:"") Q
"RTN","ORQ12",11,0)
 S X0=^OR(100,IFN,0),X3=$G(^(3)),X4=$G(^(4)),X6=$G(^(6))
"RTN","ORQ12",12,0)
 S DG=$P(X0,U,11),DG=$P($G(^ORD(100.98,+DG,0)),U,3)
"RTN","ORQ12",13,0)
 S STAT=$S($P(X3,U,3):$P(^ORD(100.01,$P(X3,U,3),0),U,1,2),1:"") ;.01^abbr
"RTN","ORQ12",14,0)
 S ENTERD=$P(X0,U,7),START=$P(X0,U,8),STOP=$P(X0,U,9)
"RTN","ORQ12",15,0)
 ; S FLAGREA=$P(X6,U,7)
"RTN","ORQ12",16,0)
 S ^TMP("ORR",$J,NEWD,ORLST)=IFN_$S($G(ACTOR):";"_ACTOR,1:"")_U_DG_U_ENTERD_U_START_U_STOP_U_STAT
"RTN","ORQ12",17,0)
 D TEXT(.TXT,IFN) M ^TMP("ORR",$J,NEWD,ORLST,"TX")=TXT
"RTN","ORQ12",18,0)
 Q
"RTN","ORQ12",19,0)
 ;
"RTN","ORQ12",20,0)
TEXT(ORTX,ORIFN,WIDTH) ; -- Returns text of order ORIFN in ORTX(#)
"RTN","ORQ12",21,0)
 N OR0,OR3,OR6,X,Y,FIRST,ORI,ORJ,DLG,ORX,ORACT,ORTA
"RTN","ORQ12",22,0)
 K ORTX S:'$G(WIDTH) WIDTH=244
"RTN","ORQ12",23,0)
 S ORACT=+$P(ORIFN,";",2),ORIFN=+ORIFN
"RTN","ORQ12",24,0)
 I ORACT<1 S ORACT=+$P($G(^OR(100,ORIFN,3)),U,7) S:'ORACT ORACT=1
"RTN","ORQ12",25,0)
 ;D:$O(^OR(100,ORIFN,1,0)) CNV^ORY92(ORIFN) ;convert text otf
"RTN","ORQ12",26,0)
 S OR0=$G(^OR(100,ORIFN,0)),OR3=$G(^(3)),OR6=$G(^(6)),ORX=$G(^(8,ORACT,0))
"RTN","ORQ12",27,0)
 S ORTX=1,ORTX(1)=""
"RTN","ORQ12",28,0)
 I $P($G(OR0),U,11)'="",($P(^ORD(100.98,$P(OR0,U,11),0),U)="NON-VA MEDICATIONS") S X="Non-VA" D ADD
"RTN","ORQ12",29,0)
 G:$G(ORIGVIEW)>1 T1
"RTN","ORQ12",30,0)
 S:$P(OR0,U,14)=$O(^DIC(9.4,"C","OR",0)) ORTX(1)=">>" ;generic
"RTN","ORQ12",31,0)
 S X=$$ACTION($P(ORX,U,2)) D:$L(X) ADD
"RTN","ORQ12",32,0)
 I $P(ORX,U,2)="NW",$P(OR3,U,11),'$G(ORIGVIEW) D  ; Changed or Renewed
"RTN","ORQ12",33,0)
 . I $P(OR3,U,11)=2 S X="Renew" D ADD Q
"RTN","ORQ12",34,0)
 . N ORIG,ORIGTA S ORIG=+$P(OR3,U,5) Q:'ORIG  Q:$P(OR3,U,11)'=1
"RTN","ORQ12",35,0)
 . S X="Change" D ADD S ORI=0
"RTN","ORQ12",36,0)
 . I $G(IOST)'="P-OTHER" D
"RTN","ORQ12",37,0)
 . .S ORIGTA=$$LASTXT(ORIG) ;D:$O(^OR(100,ORIG,1,0)) CNV^ORY92(ORIG)
"RTN","ORQ12",38,0)
 . .F  S ORI=$O(^OR(100,ORIG,8,ORIGTA,.1,ORI)) Q:ORI'>0  S X=$G(^(ORI,0)) S:$E(X,1,3)=">> " X=$E(X,4,999) D ADD
"RTN","ORQ12",39,0)
 . .S X=" to" D ADD
"RTN","ORQ12",40,0)
T1 S ORTA=+$P(ORX,U,14),FIRST=+$O(^OR(100,ORIFN,8,ORTA,.1,0))
"RTN","ORQ12",41,0)
 S ORI=0 F  S ORI=$O(^OR(100,ORIFN,8,ORTA,.1,ORI)) Q:ORI'>0  S X=$G(^(ORI,0)) S:(FIRST=ORI)&($E(X,1,3)=">> ") X=$E(X,4,999) D:$L(X) ADD
"RTN","ORQ12",42,0)
 Q:$G(ORIGVIEW)>1  ;contents of global only
"RTN","ORQ12",43,0)
 S DLG=$P(OR0,U,5) K Y I DLG,$P(DLG,";",2)["101.41",$D(^ORD(101.41,+DLG,9)) X ^(9) I $L($G(Y)) S X=Y D ADD ; additional text
"RTN","ORQ12",44,0)
 ; I $P(OR3,U,11)=2 S X="(Renewal)" D ADD
"RTN","ORQ12",45,0)
 I $P(ORX,U,4)=2 S X="*UNSIGNED*" D ADD
"RTN","ORQ12",46,0)
 I $$GET^XPAR("ALL","OR FLAGGED & WARD COMMENTS") S ORXZ=$D(^OR(100,ORIFN,8,ORACT,5,0)) I ORXZ S X=$G(^OR(100,ORIFN,8,ORACT,5,1,0)) D:$L(X) ADD K ORXZ
"RTN","ORQ12",47,0)
 I $P(ORX,U,2)="DC"!("^1^13^"[(U_$P(OR3,U,3)_U)),$L(OR6) S X=" <"_$S($L($P(OR6,U,5)):$P(OR6,U,5),$P(OR6,U,4):$P($G(^ORD(100.03,+$P(OR6,U,4),0)),U),1:"")_">" D:$L(X)>3 ADD ; DC Reason
"RTN","ORQ12",48,0)
 I $$GET^XPAR("ALL","OR FLAGGED & WARD COMMENTS"),+$G(^OR(100,ORIFN,8,ORACT,3)),$L($P(^OR(100,ORIFN,8,ORACT,3),U,5)) S X="*Flagged - "_$P(^OR(100,ORIFN,8,ORACT,3),U,5)_" - " D ADD
"RTN","ORQ12",49,0)
 I $D(XQAID),$G(ORFLG)=12 S ORX=$G(^OR(100,ORIFN,8,ORACT,3)) I $P(ORX,U) S X=" Flagged "_$$DATETIME($P(ORX,U,3))_$S($P(ORX,U,4):" by "_$$NAME($P(ORX,U,4)),1:"")_": "_$P(ORX,U,5) D ADD ; Flagged - show in FUP
"RTN","ORQ12",50,0)
 Q
"RTN","ORQ12",51,0)
 ;
"RTN","ORQ12",52,0)
 S ORPAR=$O(^XTV(8989.51,"B","OR FLAGGED & WARD COMMENTS",ORPAR))
"RTN","ORQ12",53,0)
LASTXT(IFN)     ; -- Returns action with latest text for order IFN
"RTN","ORQ12",54,0)
 N I,Y S Y=1
"RTN","ORQ12",55,0)
 S I=0 F  S I=$O(^OR(100,IFN,8,I)) Q:I'>0  S:$O(^(I,.1,0)) Y=I
"RTN","ORQ12",56,0)
 Q Y
"RTN","ORQ12",57,0)
 ;
"RTN","ORQ12",58,0)
LAST(CODE) ; -- Return DA of last occurence of CODE action
"RTN","ORQ12",59,0)
 N DA
"RTN","ORQ12",60,0)
 I '$L($G(CODE)) S DA=$O(^OR(100,ORIFN,8,"A"),-1) ; last entry
"RTN","ORQ12",61,0)
 E  S DA=$O(^OR(100,ORIFN,8,"C",CODE,"?"),-1) ; last CODE entry
"RTN","ORQ12",62,0)
 Q DA
"RTN","ORQ12",63,0)
 ;
"RTN","ORQ12",64,0)
ACTION(X) ; -- Returns text of action X
"RTN","ORQ12",65,0)
 N Y
"RTN","ORQ12",66,0)
 S Y=$S(X="DC":"Discontinue",X="HD":"Hold",X="RL"&'$G(ORIGVIEW):"Release Hold of",X="FL":"Flag",X="UF":"Unflag",X="RN"&'$G(ORIGVIEW):"Renew",1:"")
"RTN","ORQ12",67,0)
 Q Y
"RTN","ORQ12",68,0)
 ;
"RTN","ORQ12",69,0)
DATETIME(X) ; -- Returns date/time in format 00/00/00@00:00am
"RTN","ORQ12",70,0)
 N Y,D,T,T1,Z
"RTN","ORQ12",71,0)
 S D=$P(X,"."),T=$E($P(X,".",2)_"0000",1,4),T1=$E(T,1,2),Z="AM"
"RTN","ORQ12",72,0)
 S:T1>12 T1=T1-12,Z="PM"
"RTN","ORQ12",73,0)
 S Y=$E(D,4,5)_"/"_$E(D,6,7)_"/"_(1700+$E(D,1,3))_"@"_T1_":"_$E(T,3,4)_Z
"RTN","ORQ12",74,0)
 Q Y
"RTN","ORQ12",75,0)
 ;
"RTN","ORQ12",76,0)
NAME(X) ; -- Returns name as Lname,F
"RTN","ORQ12",77,0)
 N Y,Z S Z=$P($G(^VA(200,+X,0)),U) Q:Z="" ""
"RTN","ORQ12",78,0)
 S Y=$P(Z,",")_"," F I=$F(Z,","):1:$L(Z) I $E(Z,I)'=" " S Y=Y_$E(Z,I) Q
"RTN","ORQ12",79,0)
 S Y=$$LOWER^VALM1(Y) ; mixed case
"RTN","ORQ12",80,0)
 Q Y
"RTN","ORQ12",81,0)
 ;
"RTN","ORQ12",82,0)
ADD ; -- Add text X to ORTX()
"RTN","ORQ12",83,0)
 N I,Y S Y=$L(ORTX(ORTX)) S:Y Y=Y+1 ;allow for space
"RTN","ORQ12",84,0)
 I $E(X)=" ",Y S ORTX=ORTX+1,ORTX(ORTX)="",Y=0,X=$E(X,2,999) ;new line
"RTN","ORQ12",85,0)
 I Y+$L(X)'>WIDTH S ORTX(ORTX)=ORTX(ORTX)_$S(Y:" ",1:"")_X Q
"RTN","ORQ12",86,0)
 F I=1:1:$L(X," ") S Z=$P(X," ",I) D:(Y+$L(Z))>WIDTH  S ORTX(ORTX)=$G(ORTX(ORTX))_$S(Y:" ",1:"")_Z,Y=$L(ORTX(ORTX)) S:Y Y=Y+1
"RTN","ORQ12",87,0)
 . I $L(Z)>WIDTH F  S ORTX(ORTX)=$G(ORTX(ORTX))_$S(Y:" ",1:"")_$E(Z,1,WIDTH-Y),Z=$E(Z,WIDTH-Y+1,999) Q:$L(Z)'>WIDTH  S ORTX=ORTX+1,Y=0
"RTN","ORQ12",88,0)
 . S ORTX=ORTX+1,Y=0
"RTN","ORQ12",89,0)
 Q
"RTN","ORQ12",90,0)
 ;
"RTN","ORQ12",91,0)
EXPD ; -- loop through ^XTMP("ORAE" to get expired orders
"RTN","ORQ12",92,0)
 K ^TMP("ORGOTIT",$J),^TMP("ORSORT",$J)
"RTN","ORQ12",93,0)
 N TM,TO,IFN,X0,X3,X7,X8,USTS,NOW,ACTOR,X,ORREP
"RTN","ORQ12",94,0)
 S NOW=+$E($$NOW^XLFDT,1,12),TO=0,SDATE=9999999-SDATE,EDATE=9999999-EDATE
"RTN","ORQ12",95,0)
 F  S TO=$O(^XTMP("ORAE",PAT,TO)) Q:'TO  I $D(ORGRP(TO)) S TM=EDATE F  S TM=$O(^XTMP("ORAE",PAT,TO,TM)) Q:'TM!(TM>SDATE)!(+TM<EDATE)  D
"RTN","ORQ12",96,0)
 . S IFN=0 F  S IFN=$O(^XTMP("ORAE",PAT,TO,TM,IFN)) Q:'IFN  I ('$D(^TMP("ORGOTIT",$J,IFN))!MULT) D
"RTN","ORQ12",97,0)
 .. ;*356 Protect if x-ref dangles.
"RTN","ORQ12",98,0)
 .. I '$D(^OR(100,IFN)) K ^XTMP("ORAE",PAT,TO,TM,IFN) Q
"RTN","ORQ12",99,0)
 .. S USTS=$P(^OR(100,IFN,3),U,3)
"RTN","ORQ12",100,0)
 .. Q:+$G(USTS)'=7  ;quit if order no longer expired
"RTN","ORQ12",101,0)
 .. S ORREP=$P(^OR(100,IFN,3),U,6)
"RTN","ORQ12",102,0)
 .. Q:+$G(ORREP)>0  ;quit if order has been replaced
"RTN","ORQ12",103,0)
 .. S ^TMP("ORSORT",$J,9999999-TM,TO,IFN)=""
"RTN","ORQ12",104,0)
 S TM=0 F  S TM=$O(^TMP("ORSORT",$J,TM)) Q:'TM  S TO=0 F  S TO=$O(^TMP("ORSORT",$J,TM,TO)) Q:'TO  D
"RTN","ORQ12",105,0)
 .S IFN=0 F  S IFN=$O(^TMP("ORSORT",$J,TM,TO,IFN)) Q:'IFN  I $D(^OR(100,IFN,0)),$D(^(3)) S X0=^(0),X3=^(3) D
"RTN","ORQ12",106,0)
 ..S ACTOR=+$P(X3,U,7) D LP1^ORQ11
"RTN","ORQ12",107,0)
 ..;S ACTOR=0 F  S ACTOR=$O(^OR(100,"ACT",PAT,9999999-$P(X0,U,7),TO,IFN,ACTOR)) Q:ACTOR<1  I '$D(^TMP("ORGOTIT",$J,IFN,ACTOR)),$D(^OR(100,IFN,8,ACTOR,0)),$P(^(0),U,15)'=13 S X8=^(0),X7=$G(^(7)) D LP1^ORQ11
"RTN","ORQ12",108,0)
 S ^TMP("ORR",$J,ORLIST,"TOT")=$G(ORLST)
"RTN","ORQ12",109,0)
 K ^TMP("ORSORT",$J),^TMP("ORGOTIT",$J)
"RTN","ORQ12",110,0)
 Q
"RTN","ORQ12",111,0)
GETEIE(IFN,NEWD,DETAIL,ACTOR) ; -- Setup TMP array
"RTN","ORQ12",112,0)
 ; IFN=ifn of order
"RTN","ORQ12",113,0)
 ; NEWD=3rd subscript in ^TMP("ORR",$J, node (ORLIST)
"RTN","ORQ12",114,0)
 ; DETAIL=see description in ^ORQ1
"RTN","ORQ12",115,0)
 ;
"RTN","ORQ12",116,0)
 N X0,X3,X4,X6,TXT,STAT,START,DG,STOP,ENTERD,DCREAS
"RTN","ORQ12",117,0)
 S X0=^OR(100,IFN,0),X3=$G(^(3)),X4=$G(^(4)),X6=$G(^(6))
"RTN","ORQ12",118,0)
 S DG=$P(X0,U,11),DG=$P($G(^ORD(100.98,+DG,0)),U,3)
"RTN","ORQ12",119,0)
 S STAT=$S($P(X3,U,3):$P(^ORD(100.01,$P(X3,U,3),0),U,1,2),1:"")
"RTN","ORQ12",120,0)
 S ENTERD=$P(X0,U,7),START=$P(X0,U,8),STOP=$P(X0,U,9)
"RTN","ORQ12",121,0)
 S DCREAS=$P($G(X6),U,4) Q:DCREAS'>0
"RTN","ORQ12",122,0)
 I DCREAS'=$O(^ORD(100.03,"B","Entered in error","")) Q
"RTN","ORQ12",123,0)
 S ORLST=ORLST+1,^TMP("ORGOTIT",$J,IFN,+$G(ACTOR))=""
"RTN","ORQ12",124,0)
 I '$G(DETAIL) S ^TMP("ORR",$J,NEWD,ORLST)=IFN_$S($G(ACTOR):";"_ACTOR,1:"") Q
"RTN","ORQ12",125,0)
 S ^TMP("ORR",$J,NEWD,ORLST)=IFN_$S($G(ACTOR):";"_ACTOR,1:"")_U_DG_U_ENTERD_U_START_U_STOP_U_STAT
"RTN","ORQ12",126,0)
 D TEXT(.TXT,IFN) M ^TMP("ORR",$J,NEWD,ORLST,"TX")=TXT
"RTN","ORQ12",127,0)
 Q
"RTN","ORQO441P")
0^^B21266113^n/a
"RTN","ORQO441P",1,0)
ORQO441P ;EPIP/RTW - QUICK ORDER POST INSTALL ; 12/29/17 10:03am
"RTN","ORQO441P",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**441**;Dec 17, 1997;Build 52
"RTN","ORQO441P",3,0)
 ;ICR#   Type  Description
"RTN","ORQO441P",4,0)
 ;-----  ----  -------------------------------------
"RTN","ORQO441P",5,0)
 ;1472   Sup   RESCH^XUTMOPT [allows creation of new record in 19.2]
"RTN","ORQO441P",6,0)
 ;1157   Sup   $$LKOPT^XPDMENU
"RTN","ORQO441P",7,0)
 ;2053   Sup   FILE^DIE
"RTN","ORQO441P",8,0)
 ;10103  Sup   $$FMTE^XLFDT
"RTN","ORQO441P",9,0)
 ;10141  Sup   MES^XPDUTL
"RTN","ORQO441P",10,0)
 ;5033   CS    Lookup name in file 8925.1 [OR not a subscriber]
"RTN","ORQO441P",11,0)
 ;10013  Sup   ^DIk Multiple entry points to support entry deletion and file reindexing.  
"RTN","ORQO441P",12,0)
 ;
"RTN","ORQO441P",13,0)
 I $D(^TIU(8925.1,"B","OR QUICK ORDER AUDIT")) D OBJECT1
"RTN","ORQO441P",14,0)
 I $D(^TIU(8925.1,"B","OR QUICK ORDER AUDIT(ALT)")) D OBJECT2
"RTN","ORQO441P",15,0)
 D TASK,OBJECT3,ORFUMPS
"RTN","ORQO441P",16,0)
 Q
"RTN","ORQO441P",17,0)
TASK ;
"RTN","ORQO441P",18,0)
 N ORQAOPTB,ORQAOPTN,DA,DIE,DR,X,ORQWHEN
"RTN","ORQO441P",19,0)
 S ORQWHEN=DT_"@2301" ;ORQWHEN IS THE QUICK ORDER NIGHTLY TASK Date Time
"RTN","ORQO441P",20,0)
 W !,"The 'QUICK ORDER NIGHTLY BG' option is scheduled to run at: "
"RTN","ORQO441P",21,0)
 D RESCH^XUTMOPT("OR QUICK ORDER NIGHTLY BG",ORQWHEN,"","1D","L",".ORQA_ERROR")
"RTN","ORQO441P",22,0)
 S ORQAOPTN=$$FIND1^DIC(19,"","X","OR QUICK ORDER NIGHTLY BG","B")
"RTN","ORQO441P",23,0)
 S ORQAOPTB=0,ORQAOPTB=+$P($Q(^DIC(19.2,"B",ORQAOPTN,ORQAOPTB)),",",4) W ORQAOPTB
"RTN","ORQO441P",24,0)
 S DIE="^DIC(19.2,",DR="11///.5",DA=ORQAOPTB D ^DIE
"RTN","ORQO441P",25,0)
 Q
"RTN","ORQO441P",26,0)
 ;
"RTN","ORQO441P",27,0)
OBJECT1 ;
"RTN","ORQO441P",28,0)
 N ORBIEN,DIK,DA
"RTN","ORQO441P",29,0)
 I $D(^TIU(8925.1,"B","OR QUICK ORDER AUDIT")) S ORBIEN=0,ORBIEN=$O(^TIU(8925.1,"B","OR QUICK ORDER AUDIT",ORBIEN)) D
"RTN","ORQO441P",30,0)
 . S DIK="^TIU(8925.1,"
"RTN","ORQO441P",31,0)
 . S DA=ORBIEN
"RTN","ORQO441P",32,0)
 . D ^DIK
"RTN","ORQO441P",33,0)
 Q
"RTN","ORQO441P",34,0)
OBJECT2 ;
"RTN","ORQO441P",35,0)
 N ORBIEN,DIK,DA
"RTN","ORQO441P",36,0)
 I $D(^TIU(8925.1,"B","OR QUICK ORDER AUDIT(ALT)")) S ORBIEN=0,ORBIEN=$O(^TIU(8925.1,"B","OR QUICK ORDER AUDIT(ALT)",ORBIEN)) D
"RTN","ORQO441P",37,0)
 . S DIK="^TIU(8925.1,"
"RTN","ORQO441P",38,0)
 . S DA=ORBIEN
"RTN","ORQO441P",39,0)
 . D ^DIK
"RTN","ORQO441P",40,0)
 Q 
"RTN","ORQO441P",41,0)
OBJECT3 ;
"RTN","ORQO441P",42,0)
 N OROBJECT,ORTYPE,ORMETHOD,ORPEROWN,ORCLOWN,ORSTATUS,OBOBFDA,ORUSRCL
"RTN","ORQO441P",43,0)
 S ORUSRCL=0,ORUSRCL=$O(^USR(8930,"B","CLINICAL COORDINATOR",ORUSRCL))
"RTN","ORQO441P",44,0)
 S OROBJECT="" F OROBJECT="OR QUICK ORDER AUDIT","OR QUICK ORDER AUDIT(ALT)" Q:OROBJECT=""  D
"RTN","ORQO441P",45,0)
 .Q:$D(^TIU(8925.1,"B",OROBJECT))
"RTN","ORQO441P",46,0)
 .S ORTYPE="OBJECT",ORPEROWN="POSTMASTER",ORCLOWN="CLINICAL COORDINATOR"
"RTN","ORQO441P",47,0)
 .S:OROBJECT'["ALT" ORMETHOD="S X=$$AUD^ORQOAUIC(DFN,""P"",$P($G(X0),U,1))"
"RTN","ORQO441P",48,0)
 .S:OROBJECT["ALT" ORMETHOD="S X=$$AUD^ORQOAUIC(DFN,""A"",$P($G(X0),U,1))"
"RTN","ORQO441P",49,0)
 .S FDA(8925.1,"+1,",.01)=OROBJECT
"RTN","ORQO441P",50,0)
 .S FDA(8925.1,"+1,",.03)=OROBJECT
"RTN","ORQO441P",51,0)
 .S FDA(8925.1,"+1,",.04)="O"
"RTN","ORQO441P",52,0)
 .S FDA(8925.1,"+1,",.05)=.5
"RTN","ORQO441P",53,0)
 .S FDA(8925.1,"+1,",.06)=ORUSRCL
"RTN","ORQO441P",54,0)
 .S FDA(8925.1,"+1,",.07)="11"
"RTN","ORQO441P",55,0)
 .S FDA(8925.1,"+1,",9)=ORMETHOD
"RTN","ORQO441P",56,0)
 .S FDA(8925.1,"+1,",99)=$H
"RTN","ORQO441P",57,0)
 .;
"RTN","ORQO441P",58,0)
 .D UPDATE^DIE("","FDA","FDAIEN","MSG")
"RTN","ORQO441P",59,0)
 .K FDA,FDAIEN
"RTN","ORQO441P",60,0)
 I $D(MSG) D  Q
"RTN","ORQO441P",61,0)
 . S ORX="TIU Object creation failed.  The following error message was returned:"
"RTN","ORQO441P",62,0)
 . W !
"RTN","ORQO441P",63,0)
 . D MES^XPDUTL(ORX)
"RTN","ORQO441P",64,0)
 S ORX="TIU Object created successfully."
"RTN","ORQO441P",65,0)
 D MES^XPDUTL(ORX)
"RTN","ORQO441P",66,0)
 Q
"RTN","ORQO441P",67,0)
ORFUMPS ;
"RTN","ORQO441P",68,0)
 N ORDATA,ORDNAME,ORDNUM,ORLINE,ORNEW
"RTN","ORQO441P",69,0)
 S ORDNAME="" F  S ORDNAME=$O(^ORD(101.41,"B",ORDNAME)) Q:ORDNAME=""  D
"RTN","ORQO441P",70,0)
 . S ORDNUM=0 F  S ORDNUM=$O(^ORD(101.41,"B",ORDNAME,ORDNUM)) Q:'ORDNUM  D
"RTN","ORQO441P",71,0)
 . . Q:'$D(^ORD(101.41,ORDNUM,6,3,2,1))
"RTN","ORQO441P",72,0)
 . . S ORLINE=0 F  S ORLINE=$O(^ORD(101.41,ORDNUM,6,3,2,ORLINE)) Q:'ORLINE  D
"RTN","ORQO441P",73,0)
 . . . S ORDATA=$G(^ORD(101.41,ORDNUM,6,3,2,ORLINE,0)) Q:ORDATA=""
"RTN","ORQO441P",74,0)
 . . . I ORDATA["|ZZ QUICK ORDER AUDIT|" D  Q
"RTN","ORQO441P",75,0)
 . . . . S ORNEW=$$STUFF(ORDATA,"ZZ QUICK ORDER AUDIT","OR QUICK ORDER AUDIT")
"RTN","ORQO441P",76,0)
 . . . . S ^ORD(101.41,ORDNUM,6,3,2,ORLINE,0)=ORNEW
"RTN","ORQO441P",77,0)
 . . . I ORDATA["|ZZ QUICK ORDER AUDIT (ALT)|" D  Q
"RTN","ORQO441P",78,0)
 . . . . S ORNEW=$$STUFF(ORDATA,"ZZ QUICK ORDER AUDIT (ALT)","OR QUICK ORDER AUDIT(ALT)")
"RTN","ORQO441P",79,0)
 . . . . S ^ORD(101.41,ORDNUM,6,3,2,ORLINE,0)=ORNEW
"RTN","ORQO441P",80,0)
 . . . I ORDATA["|ZZ QUICK ORDER AUDIT (CI)|" D  Q
"RTN","ORQO441P",81,0)
 . . . . S ORNEW=$$STUFF(ORDATA,"ZZ QUICK ORDER AUDIT (CI)","OR QUICK ORDER AUDIT")
"RTN","ORQO441P",82,0)
 . . . . S ^ORD(101.41,ORDNUM,6,3,2,ORLINE,0)=ORNEW
"RTN","ORQO441P",83,0)
 . . . I ORDATA["|ZZ QUICK ORDER AUDIT (CI-ALT)|" D  Q
"RTN","ORQO441P",84,0)
 . . . . S ORNEW=$$STUFF(ORDATA,"ZZ QUICK ORDER AUDIT (CI-ALT)","OR QUICK ORDER AUDIT(ALT)")
"RTN","ORQO441P",85,0)
 . . . . S ^ORD(101.41,ORDNUM,6,3,2,ORLINE,0)=ORNEW
"RTN","ORQO441P",86,0)
 . . . I ORDATA["|ZZ QUICK ORDER AUDIT (NE)|" D  Q
"RTN","ORQO441P",87,0)
 . . . . S ORNEW=$$STUFF(ORDATA,"ZZ QUICK ORDER AUDIT (NE)","OR QUICK ORDER AUDIT")
"RTN","ORQO441P",88,0)
 . . . . S ^ORD(101.41,ORDNUM,6,3,2,ORLINE,0)=ORNEW
"RTN","ORQO441P",89,0)
 . . . I ORDATA["|ZZ QUICK ORDER AUDIT (NE-ALT)|" D  Q
"RTN","ORQO441P",90,0)
 . . . . S ORNEW=$$STUFF(ORDATA,"ZZ QUICK ORDER AUDIT (NE-ALT)","OR QUICK ORDER AUDIT(ALT)")
"RTN","ORQO441P",91,0)
 . . . . S ^ORD(101.41,ORDNUM,6,3,2,ORLINE,0)=ORNEW
"RTN","ORQO441P",92,0)
 ;
"RTN","ORQO441P",93,0)
 Q
"RTN","ORQO441P",94,0)
 ;
"RTN","ORQO441P",95,0)
STUFF(ORSTR,ORFROM,ORTO) ;
"RTN","ORQO441P",96,0)
 ;
"RTN","ORQO441P",97,0)
 N ORA,ORB,ORC
"RTN","ORQO441P",98,0)
 ;
"RTN","ORQO441P",99,0)
 S ORA=$P(ORSTR,"|"),ORB=$P(ORSTR,"|",2),ORC=$P(ORSTR,"|",3)
"RTN","ORQO441P",100,0)
 ;
"RTN","ORQO441P",101,0)
 I ORA=ORFROM Q ORTO_"|"_ORB_"|"_ORC
"RTN","ORQO441P",102,0)
 I ORB=ORFROM Q ORA_"|"_ORTO_"|"_ORC
"RTN","ORQO441P",103,0)
 I ORC=ORFROM Q ORA_"|"_ORB_"|"_ORTO
"RTN","ORQO441P",104,0)
 ;
"RTN","ORQO441P",105,0)
 Q ORSTR
"RTN","ORQOAUIA")
0^8^B6757048^n/a
"RTN","ORQOAUIA",1,0)
ORQOAUIA ;EPIP/RTW - DAILY TASK RETRIEVE ASSOCIATED ORDER FOR A QUICK ORDER ; 12/29/17 10:03am
"RTN","ORQOAUIA",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**441**;Dec 17, 1997;Build 52
"RTN","ORQOAUIA",3,0)
 ;ICR#   Type  Description
"RTN","ORQOAUIA",4,0)
 ;-----  ----  -------------------------------------
"RTN","ORQOAUIA",5,0)
 ;2053   Sup   FILE^DIE
"RTN","ORQOAUIA",6,0)
 ;10103  Sup   $$FMTE^XLFDT
"RTN","ORQOAUIA",7,0)
 Q  ;No direct entry
"RTN","ORQOAUIA",8,0)
START ; ENTRY POINT
"RTN","ORQOAUIA",9,0)
 N ORDAT,ORDAT2,ORDATORD,ORDTQUIC,ORDFN,ORDFNPLS,ORFND,ORI,ORJ,ORJJ,ORJO,ORK,ORKK,ORKK0,ORDITEM,ORQOIFN,ORREPLCD,ORSTOP,ORX,ORX0,ORD1
"RTN","ORQOAUIA",10,0)
 S ORDAT=$$FMADD^XLFDT(DT,-30) ; PROCESS RECORDS UP TO 30 DAYS OLD
"RTN","ORQOAUIA",11,0)
 I '$D(ZTQUEUED) W !,"Audit#",?10,"Order",?20,"Comment"
"RTN","ORQOAUIA",12,0)
 F  S ORDAT=$O(^OR(100.95,"B",ORDAT)) Q:+ORDAT'>0  S ORI=0 F  S ORI=$O(^OR(100.95,"B",ORDAT,ORI)) Q:+ORI'>0  D
"RTN","ORQOAUIA",13,0)
 . S ORX0=^OR(100.95,ORI,0),ORQOIFN=$P(ORX0,U,4)
"RTN","ORQOAUIA",14,0)
 . Q:$P(ORX0,U,8)>0  ;Quit if entry already has a ORDER NUMBER.
"RTN","ORQOAUIA",15,0)
 . Q:ORQOIFN=""  ;NO QUICK ORDER RECORDED
"RTN","ORQOAUIA",16,0)
 . ;S ORD1=$O(^ORD(101.41,ORQOIFN,6,"D",4,0))
"RTN","ORQOAUIA",17,0)
 . S ORDFN=$P(ORX0,U,3),ORDFNPLS=ORDFN_";DPT("
"RTN","ORQOAUIA",18,0)
 . S (ORDAT2,ORSTOP)=0 F  S ORDAT2=$O(^OR(100,"ACT",ORDFNPLS,ORDAT2)) Q:+ORDAT2'>0!(ORSTOP)  S ORJJ=0 F  S ORJJ=$O(^OR(100,"ACT",ORDFNPLS,ORDAT2,ORJJ)) Q:+ORJJ'>0  D
"RTN","ORQOAUIA",19,0)
 .. S ORJ=0 F  S ORJ=$O(^OR(100,"ACT",ORDFNPLS,ORDAT2,ORJJ,ORJ)) Q:+ORJ'>0!(ORSTOP)  D
"RTN","ORQOAUIA",20,0)
 ... S ORDATORD=$P(^OR(100,ORJ,0),"^",7)+.000099 ;DATE/TIME ORDER ENTERED
"RTN","ORQOAUIA",21,0)
 ... S ORDTQUIC=$P(^OR(100.95,ORI,0),"^",1) ;DATE/TIM OFAUDIT RECORD
"RTN","ORQOAUIA",22,0)
 ... S ORREPLCD=$P($G(^OR(100,ORJ,3)),U,5) ;REPLACED ORDER number if any.
"RTN","ORQOAUIA",23,0)
 ... S ORJO=ORJ D SCAN I 'ORFND,ORREPLCD>0 S ORJO=ORREPLCD D SCAN
"RTN","ORQOAUIA",24,0)
 Q
"RTN","ORQOAUIA",25,0)
SCAN ;
"RTN","ORQOAUIA",26,0)
 ;LOOK FOR AUDIT IFN IN COMMENTS, STORE IFN OF ORDER IN AUDIT FILE
"RTN","ORQOAUIA",27,0)
 N DA,DIC,DIE,DLAYGO,DR
"RTN","ORQOAUIA",28,0)
 S ORFND=0
"RTN","ORQOAUIA",29,0)
 ;
"RTN","ORQOAUIA",30,0)
 I $D(^OR(100,ORJO,8,0)) S ORK=0 F  S ORK=$O(^OR(100,ORJO,8,ORK)) Q:+ORK'>0  D
"RTN","ORQOAUIA",31,0)
 . I $D(^OR(100,ORJO,8,ORK,.1,0)) S ORKK=0 F  S ORKK=$O(^OR(100,ORJO,8,ORK,.1,ORKK)) Q:ORKK'>0  D
"RTN","ORQOAUIA",32,0)
 . . S ORKK0=^OR(100,ORJO,8,ORK,.1,ORKK,0) I ORKK0["** Pharmacy Confirmation",ORKK0[ORI S ORSTOP=1,DA=ORI,DR="7///"_ORJO,DIE="^OR(100.95,",DLAYGO=100.95,DIC(0)="L" D ^DIE
"RTN","ORQOAUIA",33,0)
 Q
"RTN","ORQOAUIB")
0^9^B45897882^n/a
"RTN","ORQOAUIB",1,0)
ORQOAUIB ;EPIP/RTW - LIST ANTI-MICROBIAL ORDER, ANTIMICROBIAL QUICK ORDER & NON-QUICK ORDER ; 12/28/17 2:20pm
"RTN","ORQOAUIB",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**441**;Dec 17, 1997;Build 52
"RTN","ORQOAUIB",3,0)
 ;QUICK ORDER AUDIT MONTHLY REPORT AND QUICK ORDER AUDIT PRINT
"RTN","ORQOAUIB",4,0)
 ;ICR#   Type  Description
"RTN","ORQOAUIB",5,0)
 ;-----  ----  -------------------------------------
"RTN","ORQOAUIB",6,0)
 ;10086  Sup   ^%ZIS
"RTN","ORQOAUIB",7,0)
 ;10089  Sup   ^%ZISC
"RTN","ORQOAUIB",8,0)
 ;10063  Sup   ^%ZTLOAD
"RTN","ORQOAUIB",9,0)
 ;1456   Sup   ^DIC
"RTN","ORQOAUIB",10,0)
 ;10103  Sup   $$FMDIFF^XLFDT
"RTN","ORQOAUIB",11,0)
 ;10103  Sup   $$FMTE^XLFDT
"RTN","ORQOAUIB",12,0)
 N ORSDATE,OREDATE,ORI,ORJ,ORCDSS,ORDIV,ORMISLOC,ORI1,OR2,Y,X2,ORWHO,%DT,%IS,DIC,ZTIO,ZTRTN,ZTSAVE,ZTSK
"RTN","ORQOAUIB",13,0)
 K ^TMP($J)
"RTN","ORQOAUIB",14,0)
 I '$O(^OR(100.953,0)) W !,"No Groups Created in the QUICK ORDER DIVISION GROUPS File" Q
"RTN","ORQOAUIB",15,0)
START W ! W !,"Past date ranges can be entered covering 31 days at a time.",!
"RTN","ORQOAUIB",16,0)
 S %DT="AE",%DT("A")="Enter Starting Date: " D ^%DT Q:+Y'>0  S ORSDATE=+Y
"RTN","ORQOAUIB",17,0)
 S %DT="AE",%DT("A")="Enter Ending Date: " D ^%DT Q:+Y'>0  S OREDATE=+Y
"RTN","ORQOAUIB",18,0)
 I OREDATE<ORSDATE W !,"** ERROR ** - Ending Date needs to follow Starting Date",! G START
"RTN","ORQOAUIB",19,0)
 S ORDIV="" I $O(^OR(100.953,0))>0 S DIC(0)="AEQM",DIC="^OR(100.953,",DIC("A")="Select MEDICAL CENTER DIVISION GROUP: " D ^DIC Q:+Y'>0 
"RTN","ORQOAUIB",20,0)
 S ORDIV=+Y
"RTN","ORQOAUIB",21,0)
 I $$FMDIFF^XLFDT(OREDATE,ORSDATE,1)>31 W !,"** ERROR ** - Only 31 days at a time is permitted",! G START
"RTN","ORQOAUIB",22,0)
 K DIR S DIR("A")="Do you want a delimited report to a printer or home device",DIR(0)="Y",DIR("B")="NO" D ^DIR S ORDELIMT=Y
"RTN","ORQOAUIB",23,0)
 K DIR S DIR("A")="Do you want to print orders with MISSING LOCATIONS",DIR(0)="Y",DIR("B")="NO" D ^DIR S ORMISLOC=Y
"RTN","ORQOAUIB",24,0)
 I 'ORDELIMT S %IS="MQ" D ^%ZIS
"RTN","ORQOAUIB",25,0)
 I ORDELIMT S %IS="MQ",%ZIS("A")=("DELIMITED REPORT DEVICE: ") D ^%ZIS
"RTN","ORQOAUIB",26,0)
 I $D(IO("Q")) S ZTRTN="DQ^ORQOAUIB",ZTSAVE("ORSDATE")="",ZTSAVE("ORDELIMT")="",ZTSAVE("OREDATE")="",ZTIO=ION,ZTSAVE("IO*")="",ZTSAVE("ORDIV")="" D ^%ZTLOAD W !,"Task Queued: ",ZTSK Q
"RTN","ORQOAUIB",27,0)
 U IO
"RTN","ORQOAUIB",28,0)
DQ ; QUEUED ENTRY POINT
"RTN","ORQOAUIB",29,0)
 S ORI=ORSDATE F  S ORI=$O(^OR(100,"AF",ORI)) Q:+ORI'>0!(+ORI>OREDATE)  S ORJ=0 F  S ORJ=$O(^OR(100,"AF",ORI,ORJ)) Q:+ORJ'>0  D
"RTN","ORQOAUIB",30,0)
 . Q:'$$DIVMATCH(ORJ)  ; QUIT IF NOT FOR ONE OF REQUESTED DIVISIONS
"RTN","ORQOAUIB",31,0)
 . Q:'$$ANTIMIC(ORJ)  ; QUIT IF NOT ANTI-MICROBIAL ORDER
"RTN","ORQOAUIB",32,0)
 . S ORQUICK=$$ORQOAM(ORJ) ; DETERMINE WHETHER QUICK ORDER OR NON-QUICK ORDER
"RTN","ORQOAUIB",33,0)
 . I ORQUICK S ^TMP($J,"QUICK",ORJ)=ORQUICK
"RTN","ORQOAUIB",34,0)
 . E  S ^TMP($J,"NON-QUICK",ORJ)=""
"RTN","ORQOAUIB",35,0)
 D PRINT("QUICK") ; PRINT ANTIMICROBIAL QUICK ORDERS
"RTN","ORQOAUIB",36,0)
 D PRINT("NON-QUICK") ; PRINT NON-QUICK ORDERS
"RTN","ORQOAUIB",37,0)
 K ^TMP($J),ORDRUGFN,ORPHDN,ORAM
"RTN","ORQOAUIB",38,0)
 D ^%ZISC ; CLOSE OUTPUT DEVICE
"RTN","ORQOAUIB",39,0)
 Q
"RTN","ORQOAUIB",40,0)
DIVMATCH(ORRD) ; DETERMINE IF ORDER IS FOR REQUESTED DIVISION
"RTN","ORQOAUIB",41,0)
 N ORLLOC,ORRQDIV
"RTN","ORQOAUIB",42,0)
 I ORDIV="" Q 1 ; NO DIVISIONS REQUESTED
"RTN","ORQOAUIB",43,0)
 S ORLLOC=$P(^OR(100,ORRD,0),U,10) I +ORLLOC>0,ORLLOC["SC" S ORRQDIV=$P(^SC(+ORLLOC,0),U,15)
"RTN","ORQOAUIB",44,0)
 I ORMISLOC,+ORLLOC=0 Q 1  ;RTW ADD MISSING LOCATION TO MONTHLY
"RTN","ORQOAUIB",45,0)
 I $G(ORRQDIV)>0,$D(^OR(100.953,ORDIV,1,"B",ORRQDIV)) Q 1
"RTN","ORQOAUIB",46,0)
 E  Q 0
"RTN","ORQOAUIB",47,0)
ANTIMIC(ORRD) ; DETERMINE IF ORDER HAS ANY ANTIMICROBIAL ITEMS
"RTN","ORQOAUIB",48,0)
 N ORI,ORJ
"RTN","ORQOAUIB",49,0)
 S (ORI,ORAM)=0 F  S ORI=$O(^OR(100,ORRD,.1,"B",ORI)) Q:+ORI'>0  D
"RTN","ORQOAUIB",50,0)
 . S ORPHDN=$P($P(^ORD(101.43,ORI,0),"^",2),";",1)
"RTN","ORQOAUIB",51,0)
 . Q:$P($P(^ORD(101.43,ORI,0),"^",2),";",2)'["PS"
"RTN","ORQOAUIB",52,0)
 . S ORDRUGFN=0,ORDRUGFN=$O(^PS(50.7,"A50",ORPHDN,ORDRUGFN))
"RTN","ORQOAUIB",53,0)
 . Q:'$G(ORDRUGFN)
"RTN","ORQOAUIB",54,0)
 . S:$P(^PSDRUG(ORDRUGFN,0),"^",2)["AM" ORAM=1
"RTN","ORQOAUIB",55,0)
 Q ORAM
"RTN","ORQOAUIB",56,0)
ORQOAM(ORKK0) ; DETERMINE IF ORDER IS QUICK ORDER OR NOT
"RTN","ORQOAUIB",57,0)
 ;LOOK FOR AUDIT IFN IN COMMENTS, STORE IFN OF ORDER IN AUDIT FILE
"RTN","ORQOAUIB",58,0)
 N ORK,ORKK,ORQUICK
"RTN","ORQOAUIB",59,0)
 S ORQUICK=0 ; INITIALIZE TO NON-QUICK ORDER
"RTN","ORQOAUIB",60,0)
 I ORKK0]"",ORKK0["** Pharmacy Confirmation #: " S ORQUICK=1_"^"_ORKK0 ;IDENTIFIED AS QUICK ORDER
"RTN","ORQOAUIB",61,0)
 I $D(^OR(100,ORJ,8,0)) S ORK=0 F  S ORK=$O(^OR(100,ORJ,8,ORK)) Q:+ORK'>0  I $D(^OR(100,ORJ,8,ORK,.1,0)) S ORKK=0 F  S ORKK=$O(^OR(100,ORJ,8,ORK,.1,ORKK)) Q:ORKK'>0  D
"RTN","ORQOAUIB",62,0)
 .S ORKK0=^OR(100,ORJ,8,ORK,.1,ORKK,0) I ORKK0["** Pharmacy Confirmation" S ORQUICK=1_"^"_ORKK0 ; IDENTIFIED AS QUICK ORDER
"RTN","ORQOAUIB",63,0)
 Q ORQUICK
"RTN","ORQOAUIB",64,0)
PRINT(ORZ) ; PRINT RESULTS
"RTN","ORQOAUIB",65,0)
 ; ORWHO = 'WHO ENTERED' field
"RTN","ORQOAUIB",66,0)
 ; ORCNUM = Pharmacy Confirmation No (Record # in file 100.95)
"RTN","ORQOAUIB",67,0)
 ; OR2EDAT = 'WHEN ENTERED' field
"RTN","ORQOAUIB",68,0)
 ; OR2PAT  = Patient Name and last 4 of SSN
"RTN","ORQOAUIB",69,0)
 ; OR2PRB  = 'CURRENT AGENT/PROVIDER' field
"RTN","ORQOAUIB",70,0)
 ; OR2LOC  = 'PATIENT LOCATION' field
"RTN","ORQOAUIB",71,0)
 N ORX0,X8,ORI,ORK,OR2DOTS,OR2PROV,ORCNUM,OR2EDAT,OR2HFS,OR2PAT,DFN,OR2SSN,OR2LOC,OR2OITEM
"RTN","ORQOAUIB",72,0)
 S OR2HFS=$$HFS() ; DETERMINE WHETHER PRINTER OR HFS DEVICE
"RTN","ORQOAUIB",73,0)
 I OR2HFS,ORZ="QUICK" W "Type"_U_"Order #"_U_"Patient"_U_"Who Entered"_U_"Confirm #"_U_"When Entered"_U_"Provider"_U_"Location"_U_"Orderable Item"
"RTN","ORQOAUIB",74,0)
 I ORDELIMT,ORZ="QUICK" W "Type"_U_"Order #"_U_"Patient"_U_"Who Entered"_U_"Confirm #"_U_"When Entered"_U_"Provider"_U_"Location"_U_"Orderable Item"
"RTN","ORQOAUIB",75,0)
 I 'ORDELIMT,'OR2HFS,ORZ="QUICK" W !!,"Anti-Microbial Orders",?65 D ^%D W:ORDIV]"" !,"Division Group: ",$P(^OR(100.953,ORDIV,0),"^",1) W !,ORZ," Orders" S $P(OR2DOTS,"-",81)="" D
"RTN","ORQOAUIB",76,0)
 .W !!,"Order #",?12,"Patient" W:ORZ="QUICK" ?30,"Confirm #" W ?42,"Who Entered",?68,"When Entered",!?12,"Location",?42,"Provider",!?42,"Orderable Item",!,OR2DOTS
"RTN","ORQOAUIB",77,0)
 .W !
"RTN","ORQOAUIB",78,0)
 I OR2HFS,ORZ="NON-QUICK" W !,"Type"_U_"Order #"_U_"Patient"_U_"Who Entered"_U_"Confirm #"_U_"When Entered"_U_"Provider"_U_"Location"_U_"Orderable Item"
"RTN","ORQOAUIB",79,0)
 I ORDELIMT,ORZ="NON-QUICK" W !,"Type"_U_"Order #"_U_"Patient"_U_"Who Entered"_U_"Confirm #"_U_"When Entered"_U_"Provider"_U_"Location"_U_"Orderable Item"
"RTN","ORQOAUIB",80,0)
 I 'ORDELIMT,'OR2HFS,ORZ="NON-QUICK" W !!,"Anti-Microbial Orders",?65 D ^%D W:ORDIV]"" !,"Division Group: ",$P(^OR(100.953,ORDIV,0),"^",1) W !,ORZ," Orders" S $P(OR2DOTS,"-",81)="" D
"RTN","ORQOAUIB",81,0)
 .W !!,"Order #",?12,"Patient" W:ORZ="NON-QUICK" ?30,"Confirm #" W ?42,"Who Entered",?68,"When Entered",!?12,"Location",?42,"Provider",!?42,"Orderable Item",!,OR2DOTS
"RTN","ORQOAUIB",82,0)
 .W !
"RTN","ORQOAUIB",83,0)
 S ORI=0 F  S ORI=$O(^TMP($J,ORZ,ORI)) Q:+ORI'>0  D
"RTN","ORQOAUIB",84,0)
 .S ORX0=$G(^OR(100,ORI,0))
"RTN","ORQOAUIB",85,0)
 .S ORWHO=$P(ORX0,"^",6),ORWHO=$E($P(^VA(200,ORWHO,0),U,1),1,20)
"RTN","ORQOAUIB",86,0)
 .S ORCNUM=^TMP($J,ORZ,ORI) I ORCNUM]"" S ORCNUM=$P($P(ORCNUM,"Confirmation #: ",2)," ",1)
"RTN","ORQOAUIB",87,0)
 .S OR2EDAT=$P(ORX0,U,7) I OR2EDAT<ORSDATE!(OR2EDAT>OREDATE) Q  ; ORDER NOT ENTERED WITHIN DATE RANGE
"RTN","ORQOAUIB",88,0)
 .S OR2PAT=$P(ORX0,U,2),DFN=+OR2PAT
"RTN","ORQOAUIB",89,0)
 .I +DFN>0 S OR2PAT=$P(^DPT(DFN,0),U,1),OR2SSN=$E($P(^DPT(DFN,0),U,9),6,9),OR2PAT=$P(OR2PAT,",",1),OR2PAT=OR2PAT_" ("_OR2SSN_")"
"RTN","ORQOAUIB",90,0)
 .E  S OR2PAT="No Patient"
"RTN","ORQOAUIB",91,0)
 .S OR2EDAT=$$FMTE^XLFDT(OR2EDAT,"2D")
"RTN","ORQOAUIB",92,0)
 .S OR2PROV=$P(ORX0,U,4) S:+OR2PROV>0 OR2PROV=$P(^VA(200,OR2PROV,0),U,1)
"RTN","ORQOAUIB",93,0)
 .S OR2LOC=$P(ORX0,U,10) I +OR2LOC>0 S X2=$P(OR2LOC,";",2) S OR2LOC=$P(@("^"_X2_+OR2LOC_",0)"),U,1)
"RTN","ORQOAUIB",94,0)
 .D ITEM
"RTN","ORQOAUIB",95,0)
 .I ORMISLOC,$P(OR2LOC,";",1)=0 S OR2LOC="MISSING LOCATION"  ;RTW
"RTN","ORQOAUIB",96,0)
 .I ORDELIMT!OR2HFS W !,ORZ_U_ORI_U_OR2PAT_U_ORWHO_U_ORCNUM_U_OR2EDAT_U_OR2PROV_U_OR2LOC_U_OR2OITEM
"RTN","ORQOAUIB",97,0)
 .E  W !,ORI,?12,OR2PAT,?32,ORCNUM,?42,ORWHO,?71,OR2EDAT,!?12,OR2LOC,?42,OR2PROV,!?42,OR2OITEM,!!
"RTN","ORQOAUIB",98,0)
 Q
"RTN","ORQOAUIB",99,0)
HFS() ; RETURN '1' IF OUTPUTTING TO A FILE, '0' FOR DEVICE
"RTN","ORQOAUIB",100,0)
 I $P(^%ZIS(1,IOS,"TYPE"),U,1)="HFS" Q 1
"RTN","ORQOAUIB",101,0)
 Q 0
"RTN","ORQOAUIB",102,0)
ITEM   ;Define the antimicrobial drug name.
"RTN","ORQOAUIB",103,0)
 I $G(ORDRUGFN) D
"RTN","ORQOAUIB",104,0)
 . S OR2OITEM="",ORQQ=0
"RTN","ORQOAUIB",105,0)
 . I $D(^OR(100,ORI,.1)) S ORI1=0 F  S ORI1=$O(^OR(100,ORI,.1,"B",ORI1)) Q:ORI1'>0  Q:ORQQ  D
"RTN","ORQOAUIB",106,0)
 . . S ORPHDN=$P($P(^ORD(101.43,ORI1,0),"^",2),";",1)
"RTN","ORQOAUIB",107,0)
 . . S ORDRUGFN=0,ORDRUGFN=$O(^PS(50.7,"A50",ORPHDN,ORDRUGFN))
"RTN","ORQOAUIB",108,0)
 . . Q:'$G(ORDRUGFN)
"RTN","ORQOAUIB",109,0)
 . . S:$P(^PSDRUG(ORDRUGFN,0),"^",2)["AM" OR2OITEM=$P(^PSDRUG(ORDRUGFN,0),U,1),ORQQ=1
"RTN","ORQOAUIB",110,0)
 K ORQQ Q
"RTN","ORQOAUIB",111,0)
QOAP ;This is the Quick Order Audit Print Option Entry point, The report is designed to show whether the entry in file 100.95 was a poke or an order
"RTN","ORQOAUIB",112,0)
 N L,BY,FLDS
"RTN","ORQOAUIB",113,0)
 S DIC="100.95",L=0,BY="[OR QUICK ORDER AUDIT REPORT]",FLDS="[OR QUICK ORDER AUDIT REPORT]" D EN1^DIP
"RTN","ORQOAUIB",114,0)
 Q
"RTN","ORQOAUIC")
0^3^B15051497^n/a
"RTN","ORQOAUIC",1,0)
ORQOAUIC ;EPIP/RTW - QUICK ORDER DATA RETRIEVAL ; 12/28/17 2:21pm
"RTN","ORQOAUIC",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**441**;Dec 17, 1997;Build 52
"RTN","ORQOAUIC",3,0)
 ;;ICR#   Type  Description
"RTN","ORQOAUIC",4,0)
 ;-----  ----  -------------------------------------
"RTN","ORQOAUIC",5,0)
 ;2053   Sup   FILE^DIE
"RTN","ORQOAUIC",6,0)
 ;10103  Sup   $$NOW^XLFDT
"RTN","ORQOAUIC",7,0)
 ;2051   Sup   FIND^DIC
"RTN","ORQOAUIC",8,0)
 Q
"RTN","ORQOAUIC",9,0)
 ;AUD(DFN,TYPE) ; ENTRY POINT FOR THE TIU OBJECTS
"RTN","ORQOAUIC",10,0)
AUD(DFN,TYPE,ORQONAME) ; ENTRY POINT FOR THE TIU OBJECTS
"RTN","ORQOAUIC",11,0)
 K DIC
"RTN","ORQOAUIC",12,0)
 N ORDIEN,ORD0,ORD1,ORD2,ORDATA,ORPROVDZ,DA,DIC,DIE,DLAYGO,DR,X,X0,Y
"RTN","ORQOAUIC",13,0)
 S ORLOC=$P(TIU("LOC"),U,1)
"RTN","ORQOAUIC",14,0)
 S ORPID=$E(TIU("PID"),3,6)
"RTN","ORQOAUIC",15,0)
 Q:+DFN'>0 ""
"RTN","ORQOAUIC",16,0)
 S ORORN=$G(^TMP("OR QUICK ORDER AUDIT",$J,"DLGID")) ; DEFINE QUICK ORDER IEN
"RTN","ORQOAUIC",17,0)
 I '$G(ORORN),$D(ORQONAME) D FIND^DIC(101.41,,,"X",ORQONAME,,"B",,,"ORDIEN") I $D(ORDIEN("DILIST","2",1)) S ORORN=$P(ORDIEN("DILIST","2",1),U,1)
"RTN","ORQOAUIC",18,0)
 I $G(ORORN) D VERIFY^ORQOAUIC(.ORORN1,ORORN)
"RTN","ORQOAUIC",19,0)
 Q:'$G(ORORN1) ""
"RTN","ORQOAUIC",20,0)
 S ORPROV=^TMP("OR QUICK ORDER AUDIT",$J,"REC") S ORPROV=$P(ORPROV,U,4) ; DEFINE PROVIDER
"RTN","ORQOAUIC",21,0)
 S ORPROVDZ=$$PROVDUZ(ORPROV) ; GET PROVIDER'S DUZ
"RTN","ORQOAUIC",22,0)
 S X=$$NOW^XLFDT S DIC="^OR(100.95,",DLAYGO=100.95,DIC(0)="L" D FILE^DICN
"RTN","ORQOAUIC",23,0)
 S DA=+Y,DR="1///"_DUZ_";2///"_DFN_";2.1///"_ORPID_";3///"_ORORN_";4///"_ORPROVDZ_";5///"_TYPE_";6///"_ORLOC,DIE=DIC
"RTN","ORQOAUIC",24,0)
 D ^DIE
"RTN","ORQOAUIC",25,0)
 K ORPID,ORPROV,ORLINE,ORLOC,ORORN,ORORN1 ;
"RTN","ORQOAUIC",26,0)
 Q "** Pharmacy Confirmation #: "_DA
"RTN","ORQOAUIC",27,0)
 ; QUICK ORDER NUMBER
"RTN","ORQOAUIC",28,0)
DRUG(ORDA) ; FOR 'DRUG' COMPUTED FIELD IN THE QUICK ORDER AUDIT FILE
"RTN","ORQOAUIC",29,0)
 N ORD0,ORD1,ORD2,ORD0AD,ORDRUGFN,ORPHOI
"RTN","ORQOAUIC",30,0)
 S ORD0=$P(^OR(100.95,ORDA,0),U,4)
"RTN","ORQOAUIC",31,0)
 Q:ORD0="" "<NONE>"
"RTN","ORQOAUIC",32,0)
 S ORD1=$O(^ORD(101.41,ORD0,6,"D",4,0))
"RTN","ORQOAUIC",33,0)
 I $D(^ORD(101.41,ORD0,6,"D",131)) D
"RTN","ORQOAUIC",34,0)
 .S ORD0AD=0 F  S ORD0AD=$O(^ORD(101.41,ORD0,6,"D",131,ORD0AD)) Q:'ORD0AD  D
"RTN","ORQOAUIC",35,0)
 . . S ORD2=+^ORD(101.41,ORD0,6,ORD0AD,1)
"RTN","ORQOAUIC",36,0)
 . . S ORPHOI=$P($P(^ORD(101.43,ORD2,0),U,2),";",1)
"RTN","ORQOAUIC",37,0)
 . . S ORDRUGFN=0,ORDRUGFN=$O(^PS(50.7,"A50",ORPHOI,ORDRUGFN))
"RTN","ORQOAUIC",38,0)
 . . Q:$P(^PSDRUG(ORDRUGFN,0),"^",2)["AM"
"RTN","ORQOAUIC",39,0)
 S:'$D(^ORD(101.41,ORD0,6,"D",131)) ORD2=+^ORD(101.41,ORD0,6,ORD1,1)
"RTN","ORQOAUIC",40,0)
 Q $$OUTPUT^ORQOAUIC(ORD2)
"RTN","ORQOAUIC",41,0)
OUTPUT(ORY) ; -- Output Xform for Value field of Response multiple of Order Dialog file, 101.41
"RTN","ORQOAUIC",42,0)
 N ORDIALOG,ORP,ORZ S ORZ=ORY
"RTN","ORQOAUIC",43,0)
 S ORP=$P($G(^ORD(101.41,ORD0,6,ORD1,0)),U,2)
"RTN","ORQOAUIC",44,0)
 I ORP S ORDIALOG(ORP,0)=$P($G(^ORD(101.41,ORP,1)),U,1,2),ORDIALOG(ORP,1)=ORY,ORZ=$$EXT^ORCD(ORP,1)
"RTN","ORQOAUIC",45,0)
 Q ORZ
"RTN","ORQOAUIC",46,0)
PROVDUZ(ORUN) ; RETURN DUZ FOR USER ORUN WHERE ORUN IS USER'S NAME
"RTN","ORQOAUIC",47,0)
 ; If more than one user with this ORNAMe, pick one with access code
"RTN","ORQOAUIC",48,0)
 ; If more than one with access code, just pick first one
"RTN","ORQOAUIC",49,0)
 ; ORCNT = # of users with this ORNAME
"RTN","ORQOAUIC",50,0)
 ; ORACCNT = # of user with this ORNAME that have an access code
"RTN","ORQOAUIC",51,0)
 N ORNAME,ORCNT,ORI,USER,ORACCNT
"RTN","ORQOAUIC",52,0)
 S ORNAME=$E(ORUN,1,35),(ORCNT,ORI,ORACCNT)=0 F  S ORI=$O(^VA(200,"B",ORNAME,ORI)) Q:+ORI'>0  S ORCNT=ORCNT+1 I $P($G(^VA(200,ORI,0)),U,3) S ORACCNT=ORACCNT+1 S ORACCNT(ORI)="" ; COUNT USERS WITH THIS ORNAME
"RTN","ORQOAUIC",53,0)
 I ORACCNT>0 Q $O(ORACCNT(0)) ; At least one with access code, return first one with DUZ
"RTN","ORQOAUIC",54,0)
 Q $O(^VA(200,"B",ORNAME,0)) ; No one with access code.  Just return first user with this ORNAMe.
"RTN","ORQOAUIC",55,0)
GROUPS ;
"RTN","ORQOAUIC",56,0)
 N DIE,DIC,DA
"RTN","ORQOAUIC",57,0)
 W !!,"Create or edit a Group of Medical Center Divisions you want to print together on the monthly quick order audit report",! S DIC("A")="Select a Group: ",(DIC,DIE)="^OR(100.953,",DIC(0)="QEALM",DLAYGO=100.953
"RTN","ORQOAUIC",58,0)
 D ^DIC
"RTN","ORQOAUIC",59,0)
 S DIE="100.953",DA=+Y,DR="1"
"RTN","ORQOAUIC",60,0)
 L +^OR(100.953,DA):0 I $T D ^DIE L -^OR(100.953,DA) Q
"RTN","ORQOAUIC",61,0)
 W !?5,"Another user is editing this entry." Q
"RTN","ORQOAUIC",62,0)
VERIFY(ORORN1,DLGID) ;
"RTN","ORQOAUIC",63,0)
 N ORORN
"RTN","ORQOAUIC",64,0)
 S ORORN1=0
"RTN","ORQOAUIC",65,0)
 S ORORN=DLGID S ORLINE=0 F  S ORLINE=$O(^ORD(101.41,ORORN,6,3,2,ORLINE)) Q:'ORLINE  D
"RTN","ORQOAUIC",66,0)
 . S ORDATA=$G(^ORD(101.41,ORORN,6,3,2,ORLINE,0)) Q:ORDATA=""
"RTN","ORQOAUIC",67,0)
 . I ORDATA["|OR QUICK ORDER AUDIT|" S ORORN1=1
"RTN","ORQOAUIC",68,0)
 . I ORDATA["|OR QUICK ORDER AUDIT(ALT)|" S ORORN1=1
"RTN","ORQOAUIC",69,0)
 Q
"RTN","ORWDXM3")
0^7^B120942767^B118361960
"RTN","ORWDXM3",1,0)
ORWDXM3 ; SLC/KCM/JLI - Quick Orders ;06/22/17
"RTN","ORWDXM3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,131,132,141,185,187,190,195,215,243,303,296,280,350,434,441**;Dec 17, 1997;Build 52
"RTN","ORWDXM3",3,0)
 ;
"RTN","ORWDXM3",4,0)
 ;
"RTN","ORWDXM3",5,0)
 ;
"RTN","ORWDXM3",6,0)
VALCOUNT(NAME,ORDIALOG) ;
"RTN","ORWDXM3",7,0)
 N COUNT,IEN,NUM
"RTN","ORWDXM3",8,0)
 S NUM=0,COUNT=0
"RTN","ORWDXM3",9,0)
 S IEN=$P($G(ORDIALOG("B",NAME)),U,2) Q:IEN'>0
"RTN","ORWDXM3",10,0)
 F  S NUM=$O(ORDIALOG(IEN,NUM)) Q:+NUM'>0  S COUNT=COUNT+1
"RTN","ORWDXM3",11,0)
 Q COUNT
"RTN","ORWDXM3",12,0)
 ;
"RTN","ORWDXM3",13,0)
ISMISSFL(ORDIALOG,IVTYPE) ;
"RTN","ORWDXM3",14,0)
 N ADDCNT,RESULT,SOLCNT,STRCNT
"RTN","ORWDXM3",15,0)
 S RESULT=0
"RTN","ORWDXM3",16,0)
 S ADDCNT=$$VALCOUNT("ADDITIVE",.ORDIALOG)
"RTN","ORWDXM3",17,0)
 S STRCNT=$$VALCOUNT("STRENGTH",.ORDIALOG)
"RTN","ORWDXM3",18,0)
 S SOLCNT=$$VALCOUNT("SOLUTION",.ORDIALOG)
"RTN","ORWDXM3",19,0)
 I IVTYPE'="I",ADDCNT'=STRCNT S RESULT=1
"RTN","ORWDXM3",20,0)
 I IVTYPE="I" D
"RTN","ORWDXM3",21,0)
 .I ADDCNT=0,SOLCNT>0 Q
"RTN","ORWDXM3",22,0)
 .I ADDCNT=0 S RESULT=1 Q
"RTN","ORWDXM3",23,0)
 .I ADDCNT'=STRCNT S RESULT=1 Q
"RTN","ORWDXM3",24,0)
 Q RESULT
"RTN","ORWDXM3",25,0)
 ;
"RTN","ORWDXM3",26,0)
IVADFCHK(ORDIALOG) ;
"RTN","ORWDXM3",27,0)
 ; This line tag checks to see if there are the same number of values
"RTN","ORWDXM3",28,0)
 ;for ADDITIVE and Additive Frequency. This also checks to see if
"RTN","ORWDXM3",29,0)
 ;the value assigned to ADDFREQ is one of the three possible values
"RTN","ORWDXM3",30,0)
 ;All Bags, 1 bag/day, See Comments. If See Comments it also checks
"RTN","ORWDXM3",31,0)
 ;for text in the comment section.
"RTN","ORWDXM3",32,0)
 N ADDCNT,ADDFCNT,ADDFREQ,COMMENT,FREQ,INST,RESULT
"RTN","ORWDXM3",33,0)
 S ADDCNT=$$VALCOUNT("ADDITIVE",.ORDIALOG)
"RTN","ORWDXM3",34,0)
 S ADDFCNT=$$VALCOUNT("ADDITIVE FREQUENCY",.ORDIALOG)
"RTN","ORWDXM3",35,0)
 I ADDCNT'=ADDFCNT Q 0
"RTN","ORWDXM3",36,0)
 S ADDFREQ=$O(^ORD(101.41,"AB","OR GTX ADDITIVE FREQUENCY",""))
"RTN","ORWDXM3",37,0)
 S COMMENT=$O(^ORD(101.41,"AB","OR GTX WORD PROCESSING 1",""))
"RTN","ORWDXM3",38,0)
 I +$G(ADDFREQ)'>0 Q 0
"RTN","ORWDXM3",39,0)
 S INST=0,RESULT=1
"RTN","ORWDXM3",40,0)
 F  S INST=$O(ORDIALOG(ADDFREQ,INST)) Q:INST'>0!(RESULT=0)  D
"RTN","ORWDXM3",41,0)
 .S FREQ=$$ADDFRQCV^ORMBLDP1($G(ORDIALOG(ADDFREQ,INST)),"O")
"RTN","ORWDXM3",42,0)
 .I FREQ="A"!(FREQ=1) Q
"RTN","ORWDXM3",43,0)
 .I FREQ="" S RESULT=0 Q
"RTN","ORWDXM3",44,0)
 .I FREQ="S",'$L($G(ORDIALOG(COMMENT,1))) S RESULT=0 Q
"RTN","ORWDXM3",45,0)
 Q RESULT
"RTN","ORWDXM3",46,0)
 ;
"RTN","ORWDXM3",47,0)
KEYVAR(DLG)  ; Parse entry action for key variables & return in string
"RTN","ORWDXM3",48,0)
 ; RV=CollTp^Samp^Spec^CollDt^Urg^Sched^NoComm^NoDiag^NoProv^NoRsn
"RTN","ORWDXM3",49,0)
 N XCODE,RV,POS,Z
"RTN","ORWDXM3",50,0)
 S XCODE=$G(^ORD(101.41,DLG,3)),RV=""
"RTN","ORWDXM3",51,0)
 I '$L(XCODE) Q ""
"RTN","ORWDXM3",52,0)
 S POS=$F(XCODE,"LRFZX=")    I POS S $P(RV,U,1)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",53,0)
 S POS=$F(XCODE,"LRFSAMP=")  I POS S $P(RV,U,2)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",54,0)
 S POS=$F(XCODE,"LRFSPEC=")  I POS S $P(RV,U,3)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",55,0)
 S POS=$F(XCODE,"LRFDATE=")  I POS S $P(RV,U,4)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",56,0)
 S POS=$F(XCODE,"LRFURG=")   I POS S $P(RV,U,5)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",57,0)
 S POS=$F(XCODE,"LRFSCH=")   I POS S $P(RV,U,6)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",58,0)
 S POS=$F(XCODE,"PSJNOPC=")  I POS S $P(RV,U,7)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",59,0)
 S POS=$F(XCODE,"GMRCNOPD=") I POS S $P(RV,U,8)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",60,0)
 S POS=$F(XCODE,"GMRCNOAT=") I POS S $P(RV,U,9)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",61,0)
 S POS=$F(XCODE,"GMRCREAF=") I POS S $P(RV,U,10)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",62,0)
 S POS=$F(XCODE,"ORFORGET=") I POS D
"RTN","ORWDXM3",63,0)
 . ; need to change this so that it is executed in SETKEYV so
"RTN","ORWDXM3",64,0)
 . ; that it is executed each time menu is revisited
"RTN","ORWDXM3",65,0)
 . N ORFORGET S ORFORGET=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",66,0)
 . I ORFORGET K ^TMP("ORECALL",$J,+ORFORGET)
"RTN","ORWDXM3",67,0)
 . E  K ^TMP("ORECALL",$J)
"RTN","ORWDXM3",68,0)
 Q RV
"RTN","ORWDXM3",69,0)
VALUE(STR,BEG) ; Return value of "var=" (copied from ORCONVRT)
"RTN","ORWDXM3",70,0)
 N X,Y,I S X=$E(STR,BEG,999),Y=""
"RTN","ORWDXM3",71,0)
 S:$E(X)="""" X=$E(X,2,999) ; strip leading "
"RTN","ORWDXM3",72,0)
 F I=1:1:$L(X) S Z=$E(X,I) Q:(Z=",")!(Z=" ")!(Z="""")  S Y=Y_Z
"RTN","ORWDXM3",73,0)
 Q $TR(Y,U,"")
"RTN","ORWDXM3",74,0)
 ;
"RTN","ORWDXM3",75,0)
SETKEYV(X)      ; Set the key variables based on contents of X
"RTN","ORWDXM3",76,0)
 I $L($P(X,U,1))  S LRFZX=$P(X,U,1)
"RTN","ORWDXM3",77,0)
 I $L($P(X,U,2))  S LRFSAMP=$P(X,U,2)
"RTN","ORWDXM3",78,0)
 I $L($P(X,U,3))  S LRFSPEC=$P(X,U,3)
"RTN","ORWDXM3",79,0)
 I $L($P(X,U,4))  S LRFDATE=$P(X,U,4)
"RTN","ORWDXM3",80,0)
 I $L($P(X,U,5))  S LRFURG=$P(X,U,5)
"RTN","ORWDXM3",81,0)
 I $L($P(X,U,6))  S LRFSCH=$P(X,U,6)
"RTN","ORWDXM3",82,0)
 I $L($P(X,U,7))  S PSJNOPC=$P(X,U,7)
"RTN","ORWDXM3",83,0)
 I $L($P(X,U,8))  S GMRCNOPD=$P(X,U,8)
"RTN","ORWDXM3",84,0)
 I $L($P(X,U,9))  S GMRCNOAT=$P(X,U,9)
"RTN","ORWDXM3",85,0)
 I $L($P(X,U,10)) S GMRCREAF=$P(X,U,10)
"RTN","ORWDXM3",86,0)
 Q
"RTN","ORWDXM3",87,0)
DLGINFO(IEN,MODE)    ; return information about a dialog
"RTN","ORWDXM3",88,0)
 ; IEN=DlgIEN or ORIFN, MODE=0:Dlg,1:Copy,2:Change
"RTN","ORWDXM3",89,0)
 ; RESULT=DlgIEN^DlgType^FormID^DGrp
"RTN","ORWDXM3",90,0)
 ; If MODE="1;T",don't check "PS MEDS" for transfer order
"RTN","ORWDXM3",91,0)
 ; PSMDGP=1: Unit/Dose  Group
"RTN","ORWDXM3",92,0)
 ; PSMDGP=2: OutPatient Group
"RTN","ORWDXM3",93,0)
 N X0,DLGIEN,TYP,FID,DGRP,PSMDGP,ISXF
"RTN","ORWDXM3",94,0)
 S PSMDGP=0,ISXF=""
"RTN","ORWDXM3",95,0)
 S ISXF=$P(MODE,";",2)
"RTN","ORWDXM3",96,0)
 S MODE=+MODE
"RTN","ORWDXM3",97,0)
 S DLGIEN=IEN I MODE,(ISXF'="T") D
"RTN","ORWDXM3",98,0)
 . S DLGIEN=+$P($G(^OR(100,+IEN,0)),U,5)
"RTN","ORWDXM3",99,0)
 . I $P(^ORD(101.41,DLGIEN,0),U)="PS MEDS" D
"RTN","ORWDXM3",100,0)
 . . N PTCAT S PTCAT=$P($G(^OR(100,+IEN,0)),U,12)
"RTN","ORWDXM3",101,0)
 . . I PTCAT="I" S DLGIEN=$O(^ORD(101.41,"B","PSJ OR PAT OE",0)),PSMDGP=1
"RTN","ORWDXM3",102,0)
 . . I PTCAT="O" S DLGIEN=$O(^ORD(101.41,"B","PSO OERR",0)),PSMDGP=2
"RTN","ORWDXM3",103,0)
 I MODE,(ISXF="T") S DLGIEN=+$P($G(^OR(100,+IEN,0)),U,5)
"RTN","ORWDXM3",104,0)
 S X0=$G(^ORD(101.41,DLGIEN,0)),TYP=$P(X0,U,4),DGRP=$P(X0,U,5)
"RTN","ORWDXM3",105,0)
 I MODE S DGRP=+$P($G(^OR(100,+IEN,0)),U,11)
"RTN","ORWDXM3",106,0)
 ;JD NEW START 11/13/02
"RTN","ORWDXM3",107,0)
 I DLGIEN=$O(^ORD(101.41,"B","PSJ OR PAT OE",0)) S PSMDGP=1
"RTN","ORWDXM3",108,0)
 I DLGIEN=$O(^ORD(101.41,"B","PSO OERR",0)) S PSMDGP=2
"RTN","ORWDXM3",109,0)
 ;JD NEW END 11/13/02
"RTN","ORWDXM3",110,0)
 ; for copy or change, if the base dialog has changed, use it's info
"RTN","ORWDXM3",111,0)
 I MODE,$G(ORDIALOG),(+DLGIEN'=+ORDIALOG),(PSMDGP=0) D
"RTN","ORWDXM3",112,0)
 . S DLGIEN=+ORDIALOG,DGRP=$P(^ORD(101.41,+ORDIALOG,0),U,5)
"RTN","ORWDXM3",113,0)
 D FORMID^ORWDXM(.FID,DLGIEN)
"RTN","ORWDXM3",114,0)
 Q DLGIEN_U_TYP_U_FID_U_DGRP
"RTN","ORWDXM3",115,0)
 ;
"RTN","ORWDXM3",116,0)
CHKDSBL(LST,ID,MODE)  ; return message if dialog disabled
"RTN","ORWDXM3",117,0)
 ; ID=DlgIEN or ORIFN, MODE=0:Dialog,1:Copy,2:Change
"RTN","ORWDXM3",118,0)
 ; LST=QL_REJECT + disabled message or unchanged
"RTN","ORWDXM3",119,0)
 N PKG
"RTN","ORWDXM3",120,0)
 S DLGIEN=+ID I MODE S DLGIEN=+$P($G(^OR(100,+ID,0)),U,5)
"RTN","ORWDXM3",121,0)
 S X0=$G(^ORD(101.41,DLGIEN,0)),X=$P(X0,U,3)
"RTN","ORWDXM3",122,0)
 I '$L(X),($P(X0,U,4)="Q") D  ; check default dialog
"RTN","ORWDXM3",123,0)
 . S DLGIEN=+$$DEFDLG^ORWDXQ($P(X0,U,5))
"RTN","ORWDXM3",124,0)
 . S X=$P($G(^ORD(101.41,DLGIEN,0)),U,3)
"RTN","ORWDXM3",125,0)
 I $L(X) D
"RTN","ORWDXM3",126,0)
 . I MODE D GETTXT^ORWORR(.LST,ID) S LST(.6)="",LST(.7)="Cannot "_$S(MODE=1:"Copy",1:"Change")_" -"
"RTN","ORWDXM3",127,0)
 . S LST(0)="8^0",LST(.5)="Dialog Disabled:  "_X
"RTN","ORWDXM3",128,0)
 S PKG=$P(X0,"^",7) I PKG]"",$P($G(^DIC(9.4,PKG,0)),"^",2)="SD",'$$PATCH^XPDUTL("SD*5.3*671") S LST(0)="8^0",LST(.5)="Dialog Disabled: VSE patch SD*5.3*671 not installed"
"RTN","ORWDXM3",129,0)
 Q
"RTN","ORWDXM3",130,0)
CHKVACT(LST,ID,MODE,ORNP)  ; return message if action not valid
"RTN","ORWDXM3",131,0)
 ; ID=DlgIEN or ORIFN, MODE=0:Dialog,1:Copy,2:Change
"RTN","ORWDXM3",132,0)
 ; LST=QL_REJECT + invalid action message or unchanged
"RTN","ORWDXM3",133,0)
 Q:'MODE  ; not an action on an order
"RTN","ORWDXM3",134,0)
 N X,ACT S ACT=$S(MODE=1:"RW",MODE=2:"XX",1:"")
"RTN","ORWDXM3",135,0)
 D VALID^ORWDXA(.X,ID,ACT,ORNP)
"RTN","ORWDXM3",136,0)
 I $L(X) D GETTXT^ORWORR(.LST,ID) D
"RTN","ORWDXM3",137,0)
 . S LST(0)="8^0",LST(.5)=X,LST(.6)="",LST(.7)="Cannot "_$S(MODE=1:"Copy",1:"Change")_" -"
"RTN","ORWDXM3",138,0)
 Q
"RTN","ORWDXM3",139,0)
CHKCOPY(LST,ID,FLDS)  ; return message if can't copy this order
"RTN","ORWDXM3",140,0)
 ; ID=ORIFN;ACT FLDS=EventType in 7th piece
"RTN","ORWDXM3",141,0)
 ; LST=QL_REJECT + cannot copy message or unchanged
"RTN","ORWDXM3",142,0)
 I "^A^D^T^"'[(U_$E($P(FLDS,U,7))_U) Q             ; not event delayed
"RTN","ORWDXM3",143,0)
 N PKG S PKG=$P($G(^OR(100,+ID,0)),U,14)
"RTN","ORWDXM3",144,0)
 S PKG=$$NMSP^ORCD(PKG) I PKG="OR"!(PKG="PS") Q    ; xfer meds, generics
"RTN","ORWDXM3",145,0)
 N ORWCAT S ORWCAT=$P($G(^OR(100,+ID,0)),U,12)
"RTN","ORWDXM3",146,0)
 I ORWCAT="I",("^A^T^"[(U_$E($P(FLDS,U,7))_U)) Q   ; admit, xfer inpt
"RTN","ORWDXM3",147,0)
 I ORWCAT="O",$E($P(FLDS,U,7))="D" Q               ; discharge outpt
"RTN","ORWDXM3",148,0)
 D GETTXT^ORWORR(.LST,ID)
"RTN","ORWDXM3",149,0)
 I ORWCAT="I" S LST(.5)="inpatient order to outpatient -"
"RTN","ORWDXM3",150,0)
 I ORWCAT="O" S LST(.5)="outpatient order to inpatient -"
"RTN","ORWDXM3",151,0)
 S:$D(LST(.5)) LST(.5)="Cannot copy the following "_LST(.5)
"RTN","ORWDXM3",152,0)
 S LST(0)="8^0",LST(.7)=""
"RTN","ORWDXM3",153,0)
 Q
"RTN","ORWDXM3",154,0)
BLD4CHG(LST,ID,FLDS)  ; build responses for an edit
"RTN","ORWDXM3",155,0)
 ; ID=ORIFN;ACT FLDS=unused right now
"RTN","ORWDXM3",156,0)
 ; LST(0)=Qlvl^RespID(XOrderID)^DlgIEN^DlgType^FormID^DGrp
"RTN","ORWDXM3",157,0)
 N OIDX,OI,CNT
"RTN","ORWDXM3",158,0)
 S (OI,OIDX,CNT)=0
"RTN","ORWDXM3",159,0)
 S:$D(^OR(100,+ID,4.5,"ID","ORDERABLE")) OIDX=$O(^OR(100,+ID,4.5,"ID","ORDERABLE",0))
"RTN","ORWDXM3",160,0)
 I $D(^OR(100,+ID,4.5,OIDX)) D
"RTN","ORWDXM3",161,0)
 . F  S CNT=$O(^OR(100,+ID,4.5,OIDX,CNT)) Q:'CNT  D
"RTN","ORWDXM3",162,0)
 . . S OI=^(CNT) D VALDOI
"RTN","ORWDXM3",163,0)
 I +LST(0)=8 S LST(.5)="You can not change this order." Q
"RTN","ORWDXM3",164,0)
 S LST(0)="0^X"_ID_U_$$DLGINFO(+ID,2)
"RTN","ORWDXM3",165,0)
 S $P(LST(0),U,4)="X"
"RTN","ORWDXM3",166,0)
 Q
"RTN","ORWDXM3",167,0)
GETIVTYP() ;
"RTN","ORWDXM3",168,0)
 N RESULT,TYPEIEN
"RTN","ORWDXM3",169,0)
 S RESULT=""
"RTN","ORWDXM3",170,0)
 S TYPEIEN=$O(^ORD(101.41,"B","OR GTX IV TYPE","")) I TYPEIEN'>0 Q RESULT
"RTN","ORWDXM3",171,0)
 S RESULT=$G(ORDIALOG(TYPEIEN,1))
"RTN","ORWDXM3",172,0)
 Q RESULT
"RTN","ORWDXM3",173,0)
 ;
"RTN","ORWDXM3",174,0)
VALDOI ; Validate the Orderable Items
"RTN","ORWDXM3",175,0)
 N ORQUIT,ORPS
"RTN","ORWDXM3",176,0)
 I $G(^ORD(101.43,OI,.1)),^(.1)'>$$NOW^XLFDT D
"RTN","ORWDXM3",177,0)
 . S ORQUIT=1
"RTN","ORWDXM3",178,0)
 . S LST(0)="8^0"
"RTN","ORWDXM3",179,0)
 I $D(ORQUIT) Q:ORQUIT
"RTN","ORWDXM3",180,0)
 S ORPS=$G(^ORD(101.43,+OI,"PS"))
"RTN","ORWDXM3",181,0)
 I $P(ORPS,U,1,4)="0^0^0^0",($P(ORPS,U,7)=0) S LST(0)="8^0"
"RTN","ORWDXM3",182,0)
 Q
"RTN","ORWDXM3",183,0)
VERDUR(ORDIALOG) ;
"RTN","ORWDXM3",184,0)
 ;check for duration value if a THEN conjunation is used
"RTN","ORWDXM3",185,0)
 N CONJ,CONVALUE,DUR,I,SUCC
"RTN","ORWDXM3",186,0)
 S SUCC=1
"RTN","ORWDXM3",187,0)
 S CONJ=$$PTR^ORCDPS1("AND/THEN")
"RTN","ORWDXM3",188,0)
 S DUR=$$PTR^ORCDPS1("DURATION")
"RTN","ORWDXM3",189,0)
 S I=0 F  S I=$O(ORDIALOG(CONJ,I)) Q:I'>0!(SUCC=0)  D
"RTN","ORWDXM3",190,0)
 . I $$UP^XLFSTR($E($G(ORDIALOG(CONJ,I)),1))="T" D
"RTN","ORWDXM3",191,0)
 . . I '$L($G(ORDIALOG(DUR,I))) S SUCC=0
"RTN","ORWDXM3",192,0)
 Q SUCC
"RTN","ORWDXM3",193,0)
 ;
"RTN","ORWDXM3",194,0)
VERORD(OIEN) ;
"RTN","ORWDXM3",195,0)
 N IFN,INFUSE,INFUID,ODG,ODP,ASSIV,SUCC,TYPE
"RTN","ORWDXM3",196,0)
 S SUCC=0,IFN=ORDIALOG
"RTN","ORWDXM3",197,0)
 S ODP=+$P($G(^ORD(101.41,+IFN,0)),U,7),ODG=+$P($G(^(0)),U,5)
"RTN","ORWDXM3",198,0)
 S ODP=$$GET1^DIQ(9.4,+ODP_",",1),ODG=$P($G(^ORD(100.98,ODG,0)),U,3)
"RTN","ORWDXM3",199,0)
 I ODP'["PS" Q 1
"RTN","ORWDXM3",200,0)
 I ODP="PSH" Q 1
"RTN","ORWDXM3",201,0)
 ;check infusion rate for IV QO
"RTN","ORWDXM3",202,0)
 I ODG="IV RX"!(ODG="TPN") D  Q SUCC
"RTN","ORWDXM3",203,0)
 .S TYPE=$$GETIVTYP
"RTN","ORWDXM3",204,0)
 .I TYPE=""
"RTN","ORWDXM3",205,0)
 .S PASSIV=$$IVRTECHK
"RTN","ORWDXM3",206,0)
 .I PASSIV=0
"RTN","ORWDXM3",207,0)
 .S INFUID=$O(^ORD(101.41,"B","OR GTX INFUSION RATE",0))
"RTN","ORWDXM3",208,0)
 .S INFUSE=$G(ORDIALOG(INFUID,1))
"RTN","ORWDXM3",209,0)
 .S SUCC=$$VALINF(TYPE,INFUSE)
"RTN","ORWDXM3",210,0)
 .I SUCC=0 Q
"RTN","ORWDXM3",211,0)
 .I TYPE="C" S SUCC=$$IVADFCHK(.ORDIALOG)
"RTN","ORWDXM3",212,0)
 I (ODP="PSJ")!(ODP="PSO"),ODG'="IV RX",ODG'="TPN" S SUCC=$$VERDUR(.ORDIALOG)
"RTN","ORWDXM3",213,0)
 Q SUCC
"RTN","ORWDXM3",214,0)
 ;
"RTN","ORWDXM3",215,0)
VALINF(TYPE,INFUSE) ;
"RTN","ORWDXM3",216,0)
 N SUCC
"RTN","ORWDXM3",217,0)
 S SUCC=0
"RTN","ORWDXM3",218,0)
 I TYPE="I" D  Q SUCC
"RTN","ORWDXM3",219,0)
 .I INFUSE="" S SUCC=1 Q
"RTN","ORWDXM3",220,0)
 .I $TR(INFUSE,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")["INFUSE OVER" S SUCC=1 Q
"RTN","ORWDXM3",221,0)
 .I $L(INFUSE)>4 Q
"RTN","ORWDXM3",222,0)
 Q 1
"RTN","ORWDXM3",223,0)
 ;
"RTN","ORWDXM3",224,0)
VALQO(IFN) ;Check to see if it's a good QO med
"RTN","ORWDXM3",225,0)
 ;If it's an IV QO: check if infusion rate entered
"RTN","ORWDXM3",226,0)
 ;If it's an UD QO: check if dosage entered
"RTN","ORWDXM3",227,0)
 ;regular order treated as good QO
"RTN","ORWDXM3",228,0)
 ;
"RTN","ORWDXM3",229,0)
 I IFN[";",($$UPCTCHK^ORWDXA(+IFN)) Q 0
"RTN","ORWDXM3",230,0)
 I $P($G(^ORD(101.41,IFN,0)),U,4)'="Q" Q 1
"RTN","ORWDXM3",231,0)
 N ODP,ODG,INFUID,INFUSE,DSAGEID,SUCC,PASSIV,TYPE,PRIORID,DONEID,OK
"RTN","ORWDXM3",232,0)
 S SUCC=0
"RTN","ORWDXM3",233,0)
 S ODP=+$P($G(^ORD(101.41,IFN,0)),U,7),ODG=+$P($G(^(0)),U,5)
"RTN","ORWDXM3",234,0)
 S ODP=$$GET1^DIQ(9.4,+ODP_",",1),ODG=$P($G(^ORD(100.98,ODG,0)),U,3)
"RTN","ORWDXM3",235,0)
 I ODP'["PS" Q 1
"RTN","ORWDXM3",236,0)
 I ODP="PSH" Q 1
"RTN","ORWDXM3",237,0)
 ;check for DONE urgency/priority on Outpatient QO
"RTN","ORWDXM3",238,0)
 I ODG="O RX" D  Q:'OK 0
"RTN","ORWDXM3",239,0)
 . S OK=1,PRIORID=$O(^ORD(101.41,"B","OR GTX URGENCY",0)) Q:'PRIORID
"RTN","ORWDXM3",240,0)
 . S DONEID=$O(^ORD(101.42,"B","DONE",0)) Q:'DONEID
"RTN","ORWDXM3",241,0)
 . I $G(ORDIALOG(PRIORID,1))=DONEID S OK=0
"RTN","ORWDXM3",242,0)
 ;check infusion rate for IV QO
"RTN","ORWDXM3",243,0)
 I ODG="IV RX"!(ODG="TPN") D
"RTN","ORWDXM3",244,0)
 . S INFUID=$O(^ORD(101.41,"B","OR GTX INFUSION RATE",0))
"RTN","ORWDXM3",245,0)
 . S TYPE=$$GETIVTYP
"RTN","ORWDXM3",246,0)
 . I TYPE="" Q
"RTN","ORWDXM3",247,0)
 . I $D(ORDIALOG(INFUID,1)) D
"RTN","ORWDXM3",248,0)
 . . I TYPE="I" D  Q
"RTN","ORWDXM3",249,0)
 . . . S INFUSE=$G(ORDIALOG(INFUID,1))
"RTN","ORWDXM3",250,0)
 . . . I INFUSE="" Q
"RTN","ORWDXM3",251,0)
 . . . I INFUSE["INFUSE OVER" S SUCC=1 Q
"RTN","ORWDXM3",252,0)
 . . . I $L(INFUSE)>4 Q
"RTN","ORWDXM3",253,0)
 . . . I +INFUSE>0 S INFUSE="INFUSE OVER "_INFUSE_" Minutes"
"RTN","ORWDXM3",254,0)
 . . . S ORDIALOG(INFUID,1)=INFUSE,SUCC=1
"RTN","ORWDXM3",255,0)
 . . S SUCC=1
"RTN","ORWDXM3",256,0)
 . ; additive frequency check/infusion rate checks for continuous orders
"RTN","ORWDXM3",257,0)
 . I TYPE="C" D  I SUCC=0 Q
"RTN","ORWDXM3",258,0)
 . . I $D(ORDIALOG(INFUID,1)) S SUCC=1 I SUCC=0 Q
"RTN","ORWDXM3",259,0)
 . . S SUCC=$$IVADFCHK(.ORDIALOG)
"RTN","ORWDXM3",260,0)
 . I SUCC=0 Q
"RTN","ORWDXM3",261,0)
 . I '$D(ORDIALOG(INFUID,1)),TYPE="I" S SUCC=1
"RTN","ORWDXM3",262,0)
 . S PASSIV=$$IVRTECHK
"RTN","ORWDXM3",263,0)
 . I SUCC=0 Q
"RTN","ORWDXM3",264,0)
 . I PASSIV=0 S SUCC=0
"RTN","ORWDXM3",265,0)
 . I SUCC=1,$$ISMISSFL(.ORDIALOG,TYPE)=1 S SUCC=0
"RTN","ORWDXM3",266,0)
 ;check dosage for UD QO
"RTN","ORWDXM3",267,0)
 I (ODP="PSJ")!(ODP="PSO"),ODG'="IV RX",ODG'="TPN" D
"RTN","ORWDXM3",268,0)
 . S DSAGEID=$O(^ORD(101.41,"B","OR GTX INSTRUCTIONS",0))
"RTN","ORWDXM3",269,0)
 . I $D(ORDIALOG(DSAGEID,1)) S SUCC=1
"RTN","ORWDXM3",270,0)
 . I SUCC=0 Q
"RTN","ORWDXM3",271,0)
 . ;
"RTN","ORWDXM3",272,0)
 . S SUCC=$$VERDUR(.ORDIALOG)
"RTN","ORWDXM3",273,0)
 ;
"RTN","ORWDXM3",274,0)
 I SUCC=1,$P($G(^ORD(101.41,IFN,5)),U,8) D
"RTN","ORWDXM3",275,0)
 .N COMMID,WPCNT
"RTN","ORWDXM3",276,0)
 .S COMMID=$O(^ORD(101.41,"B","OR GTX WORD PROCESSING 1",0))
"RTN","ORWDXM3",277,0)
 .S COMMID=$O(^ORD(101.41,IFN,6,"D",COMMID,0))
"RTN","ORWDXM3",278,0)
 .I COMMID S WPCNT=0 F  S WPCNT=$O(^ORD(101.41,IFN,6,COMMID,2,WPCNT)) Q:'WPCNT!('SUCC)  D
"RTN","ORWDXM3",279,0)
 ..I ^ORD(101.41,IFN,6,COMMID,2,WPCNT,0)["^" S SUCC=0
"RTN","ORWDXM3",280,0)
 Q SUCC
"RTN","ORWDXM3",281,0)
 ;
"RTN","ORWDXM3",282,0)
IVRTECHK() ;
"RTN","ORWDXM3",283,0)
 N RTIEN,RTVALUE,RESULT
"RTN","ORWDXM3",284,0)
 N CNT,NUM,ORDERIDS,OIIEN,OTYPE,ROUTE
"RTN","ORWDXM3",285,0)
 S CNT=0,RESULT=0
"RTN","ORWDXM3",286,0)
 S RTIEN=+$P($G(ORDIALOG("B","ROUTE")),U,2) I RTIEN'>0 Q RESULT
"RTN","ORWDXM3",287,0)
 S RTVALUE=+$G(ORDIALOG(RTIEN,1)) I RTVALUE'>0 Q RESULT
"RTN","ORWDXM3",288,0)
 F OTYPE="SOLUTION","ADDITIVE" D
"RTN","ORWDXM3",289,0)
 .S OIIEN=+$P($G(ORDIALOG("B",OTYPE)),U,2) I OIIEN>0 D
"RTN","ORWDXM3",290,0)
 ..S NUM=0 F  S NUM=$O(ORDIALOG(OIIEN,NUM)) Q:NUM'>0  I +$G(ORDIALOG(OIIEN,NUM))>0 D
"RTN","ORWDXM3",291,0)
 ...S CNT=CNT+1,ORDERIDS(CNT)=ORDIALOG(OIIEN,NUM)
"RTN","ORWDXM3",292,0)
 I $D(ORDERIDS)=0 Q
"RTN","ORWDXM3",293,0)
 S ROUTE=$$IVQOVAL^ORWDPS33(.ORDERIDS,RTVALUE)
"RTN","ORWDXM3",294,0)
 I ROUTE="" S ORDIALOG(RTIEN,1)=ROUTE
"RTN","ORWDXM3",295,0)
 I ROUTE'="" S RESULT=1
"RTN","ORWDXM3",296,0)
 ;K ^TMP($J,"ORWDXM3 IVRTECHK")
"RTN","ORWDXM3",297,0)
 ;D ALL^PSS51P2(RTVALUE,,,,"ORWDXM3 IVRTECHK")
"RTN","ORWDXM3",298,0)
 ;I +^TMP($J,"ORWDXM3 IVRTECHK",RTVALUE,6)'=1 S ORDIALOG(RTIEN,1)="",RESULT=0
"RTN","ORWDXM3",299,0)
 ;K ^TMP($J,"ORWDXM3 IVRTECHK")
"RTN","ORWDXM3",300,0)
 Q RESULT
"RTN","ORWDXM3",301,0)
 ;
"RTN","ORWDXM3",302,0)
ISUDQO(ORY,DLGID) ;True: is unit dose quick order
"RTN","ORWDXM3",303,0)
 S ORY=0
"RTN","ORWDXM3",304,0)
 Q:'$D(^ORD(101.41,DLGID,0))
"RTN","ORWDXM3",305,0)
 N CLODGRP,CLIVDGRP,UDGRP1,UDGRP2,DLGTYP,DLGGRP
"RTN","ORWDXM3",306,0)
 S UDGRP1=$O(^ORD(100.98,"B","UD RX",0))
"RTN","ORWDXM3",307,0)
 S UDGRP2=$O(^ORD(100.98,"B","I RX",0))
"RTN","ORWDXM3",308,0)
 S CLODGRP=$O(^ORD(100.98,"B","CLINIC MEDICATIONS",""))
"RTN","ORWDXM3",309,0)
 S CLIVDGRP=$O(^ORD(100.98,"B","CLINIC INFUSIONS",""))
"RTN","ORWDXM3",310,0)
 S DLGTYP=$P($G(^ORD(101.41,DLGID,0)),U,4)
"RTN","ORWDXM3",311,0)
 I DLGTYP="Q" D VERIFY^ORQOAUIC(.ORORN1,DLGID) I $G(ORORN1) D
"RTN","ORWDXM3",312,0)
 . S ^TMP("OR QUICK ORDER AUDIT",$J,"DLGID")=DLGID ;RTW
"RTN","ORWDXM3",313,0)
 S DLGGRP=$P($G(^ORD(101.41,DLGID,0)),U,5)
"RTN","ORWDXM3",314,0)
 I (DLGTYP="Q"),((DLGGRP=UDGRP1)!(DLGGRP=UDGRP2)!(DLGGRP=CLODGRP)!(DLGGRP=CLIVDGRP)) S ORY=1
"RTN","ORWDXM3",315,0)
 Q
"RTN","ORWDXM3",316,0)
 ;
"RTN","ORWDXM3",317,0)
SDRTCVER(ORDIALOG) ;
"RTN","ORWDXM3",318,0)
 ;Return to Clinic QO verifier
"RTN","ORWDXM3",319,0)
 I +$$VAL^ORCD("NUMBER OF APPOINTMENTS")>1,+$$VAL^ORCD("INTERVAL")<1 Q 0
"RTN","ORWDXM3",320,0)
 I +$$VAL^ORCD("NUMBER OF APPOINTMENTS")=1,+$$VAL^ORCD("INTERVAL")>0 Q 0
"RTN","ORWDXM3",321,0)
 Q 1
"RTN","ORWDXM3",322,0)
 ;
"RTN","ORWPT")
0^11^B77269918^B64148022
"RTN","ORWPT",1,0)
ORWPT ; SLC/KCM/REV - Patient Lookup Functions ; 12/28/17 1:28pm
"RTN","ORWPT",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,132,149,206,187,190,215,243,280,306,311,441**;Dec 17, 1997;Build 52
"RTN","ORWPT",3,0)
 ;
"RTN","ORWPT",4,0)
 ; Ref. to ^UTILITY via IA 10061
"RTN","ORWPT",5,0)
 ; DBIA 10096  ^%ZOSF()
"RTN","ORWPT",6,0)
 ; DBIA  2966  ^DG(391
"RTN","ORWPT",7,0)
 ; DBIA  2965  ^DG(405.1
"RTN","ORWPT",8,0)
 ; DBIA  1865  ^DGPM
"RTN","ORWPT",9,0)
 ; DBIA  2248  ^DGACT
"RTN","ORWPT",10,0)
 ; DBIA 10006  ^DIC
"RTN","ORWPT",11,0)
 ; DBIA  2967  ^DIC(31
"RTN","ORWPT",12,0)
 ; DBIA   723  ^DIC(42
"RTN","ORWPT",13,0)
 ; DBIA   510  ^DISV(
"RTN","ORWPT",14,0)
 ; DBIA   964  ^DPT(
"RTN","ORWPT",15,0)
 ; DBIA   964  ^SC(
"RTN","ORWPT",16,0)
 ; DBIA  3266  DOB^DPTLK1
"RTN","ORWPT",17,0)
 ; DBIA  3267  SSN^DPTLK1
"RTN","ORWPT",18,0)
 ; DBIA  2701  ^MPIF001
"RTN","ORWPT",19,0)
 ; DBIA  2960  ^TIULX
"RTN","ORWPT",20,0)
 ; DBIA 10061  ^VADPT
"RTN","ORWPT",21,0)
 ; DBIA 10061  ^UTILITY(
"RTN","ORWPT",22,0)
 ; DBIA  3132  ^A7RDPAGU
"RTN","ORWPT",23,0)
 ; DBIA  2701  ^MPIF001
"RTN","ORWPT",24,0)
 ; DBIA 10103  ^XLFDT
"RTN","ORWPT",25,0)
 ; DBIA  2263  ^XPAR
"RTN","ORWPT",26,0)
 ; DBIA 10006  ^VA(200
"RTN","ORWPT",27,0)
 ; DBIA 10035  ^DPT(
"RTN","ORWPT",28,0)
 ; DBIA  2762  ^DPT(
"RTN","ORWPT",29,0)
 ;
"RTN","ORWPT",30,0)
IDINFO(REC,DFN) ; Return identifying information for a patient
"RTN","ORWPT",31,0)
 ; PID^DOB^SEX^VET^SC%^WARD^RM-BED^NAME
"RTN","ORWPT",32,0)
 N X0,X1,X101,X3,XV  ; name/dob/sex/ssn, ward, room-bed, sc%, vet
"RTN","ORWPT",33,0)
 S X0=$G(^DPT(DFN,0)),X1=$G(^(.1)),X101=$G(^(.101)),X3=$G(^(.3)),XV=$G(^("VET"))
"RTN","ORWPT",34,0)
 S REC=$$SSN^DPTLK1(DFN)_U_$$DOB^DPTLK1(DFN,2)_U_$P(X0,U,2)_U_$P(XV,U)_U_$P(X3,U,2)_U_$P(X1,U)_U_$P(X101,U)_U_$P(X0,U) ;DG249
"RTN","ORWPT",35,0)
 Q
"RTN","ORWPT",36,0)
PTINQ(REF,DFN) ; Return formatted pt inquiry report
"RTN","ORWPT",37,0)
 K ^TMP("ORDATA",$J,1)
"RTN","ORWPT",38,0)
 D DGINQ^ORCXPND1(DFN)
"RTN","ORWPT",39,0)
 S REF=$NA(^TMP("ORDATA",$J,1))
"RTN","ORWPT",40,0)
 Q
"RTN","ORWPT",41,0)
SCDIS(LST,DFN) ; Return service connected % and rated disabilities
"RTN","ORWPT",42,0)
 N VAEL,VAERR,I,ILST,DIS,SC,X
"RTN","ORWPT",43,0)
 D ELIG^VADPT
"RTN","ORWPT",44,0)
 S LST(1)="Service Connected: "_$S(+VAEL(3):$P(VAEL(3),U,2)_"%",1:"NO")
"RTN","ORWPT",45,0)
 I 'VAEL(4),'$P($G(^DG(391,+VAEL(6),0)),U,2) S LST(2)="NOT A VETERAN." Q
"RTN","ORWPT",46,0)
 S I=0,ILST=1 F  S I=$O(^DPT(DFN,.372,I)) Q:'I  S X=^(I,0) D
"RTN","ORWPT",47,0)
 . S DIS=$P($G(^DIC(31,+X,0)),U) Q:DIS=""
"RTN","ORWPT",48,0)
 . S SC=$S($P(X,U,3):"SC",$P(X,U,3)']"":"not specified",1:"NSC")
"RTN","ORWPT",49,0)
 . S ILST=ILST+1,LST(ILST)=DIS_" ("_$P(X,U,2)_"% "_SC_")"
"RTN","ORWPT",50,0)
 I ILST=1 S LST(2)="Rated Disabilities: NONE STATED"
"RTN","ORWPT",51,0)
 Q
"RTN","ORWPT",52,0)
SHOW ; temporary - show patient inquiry screen
"RTN","ORWPT",53,0)
 N I,Y,DIC S DIC=2,DIC(0)="AEMQ" D ^DIC Q:'Y
"RTN","ORWPT",54,0)
 K ^TMP("ORDATA",$J,1)
"RTN","ORWPT",55,0)
 D DGINQ^ORCXPND1(+Y)
"RTN","ORWPT",56,0)
 S I=0 F  S I=$O(^TMP("ORDATA",$J,1,I)) Q:'I  W !,^(I)
"RTN","ORWPT",57,0)
 K ^TMP("ORDATA",$J,1)
"RTN","ORWPT",58,0)
 Q
"RTN","ORWPT",59,0)
SELCHK(REC,DFN) ; Check for sensitive pt
"RTN","ORWPT",60,0)
 ; SENSITIVE
"RTN","ORWPT",61,0)
 S REC=$$EN1^ORQPT2(DFN)
"RTN","ORWPT",62,0)
 Q
"RTN","ORWPT",63,0)
DIEDON(VAL,DFN) ; Check for a date of death
"RTN","ORWPT",64,0)
 S VAL=+$G(^DPT(DFN,.35))
"RTN","ORWPT",65,0)
 Q
"RTN","ORWPT",66,0)
SELECT(REC,DFN) ; Selects patient & returns key information
"RTN","ORWPT",67,0)
 ;  1    2   3   4    5      6    7    8       9       10      11  12
"RTN","ORWPT",68,0)
 ; NAME^SEX^DOB^SSN^LOCIEN^LOCNM^RMBD^CWAD^SENSITIVE^ADMITTED^CONV^SC^
"RTN","ORWPT",69,0)
 ; 13  14  15  16  17
"RTN","ORWPT",70,0)
 ; SC%^ICN^AGE^TS^TSSVC
"RTN","ORWPT",71,0)
 ;
"RTN","ORWPT",72,0)
 ; for CCOW (RV - 2/27/03)  name="-1", location=error message
"RTN","ORWPT",73,0)
 I '$D(^DPT(+DFN,0)) S REC="-1^^^^^Patient is unknown to CPRS." Q
"RTN","ORWPT",74,0)
 ;
"RTN","ORWPT",75,0)
 N X
"RTN","ORWPT",76,0)
 I $G(XWB("2","RPC"))="ORWPT SELECT" K ^TMP($J,"OC-OPOS") ; delete once per order session order checks
"RTN","ORWPT",77,0)
 K ^TMP("ORWPCE",$J) ; delete PCE 'cache' when switching patients
"RTN","ORWPT",78,0)
 S X=^DPT(DFN,0),REC=$P(X,U,1,3)_U_$P(X,U,9)_U_U_$G(^(.1))_U_$G(^(.101))
"RTN","ORWPT",79,0)
 S X=$P(REC,U,6) I $L(X) S $P(REC,U,5)=+$G(^DIC(42,+$O(^DIC(42,"B",X,0)),44))
"RTN","ORWPT",80,0)
 S $P(REC,U,8)=$$CWAD^ORQPT2(DFN)_U_$$EN1^ORQPT2(DFN)
"RTN","ORWPT",81,0)
 ; I $P(REC,U,9) D EN2^ORQPT2(DFN)  ;update DG security log ; DG249
"RTN","ORWPT",82,0)
 S X=$G(^DPT(DFN,.105)) I X S $P(REC,U,10)=$P($G(^DGPM(X,0)),U)
"RTN","ORWPT",83,0)
 S:'$D(IOST) IOST="P-OTHER"
"RTN","ORWPT",84,0)
 S $P(REC,U,11)=0
"RTN","ORWPT",85,0)
 D ELIG^VADPT S $P(REC,U,12)=$G(VAEL(3)) ;two pieces: SC^SC%
"RTN","ORWPT",86,0)
 I $L($T(GETICN^MPIF001)) S X=+$$GETICN^MPIF001(DFN) S:X>0 $P(REC,U,14)=X
"RTN","ORWPT",87,0)
 S $P(REC,U,15)=$$AGE(DFN,$P(REC,U,3))
"RTN","ORWPT",88,0)
 S $P(REC,U,16)=+$G(^DPT(DFN,.103)) ; treating specialty
"RTN","ORWPT",89,0)
 I +$P(REC,U,16)>0 D
"RTN","ORWPT",90,0)
 . N X,Y,Z
"RTN","ORWPT",91,0)
 . S (X,Y)=""
"RTN","ORWPT",92,0)
 . S X=$$TSDATA^DGACT(45.7,+$P(REC,U,16),.Y,"")
"RTN","ORWPT",93,0)
 . I +X,+$P($G(Y(2)),U,1)>0 S (X,Z)="" S X=$$TSDATA^DGACT(42.4,+$P($G(Y(2)),U,1),.Z,"")
"RTN","ORWPT",94,0)
 . I +X S $P(REC,U,17)=$P($G(Z(3)),U,1) ; treating  specialty service
"RTN","ORWPT",95,0)
 K VAEL,VAERR ;VADPT call to kill?
"RTN","ORWPT",96,0)
 S ^DISV(DUZ,"^DPT(")=DFN
"RTN","ORWPT",97,0)
 Q
"RTN","ORWPT",98,0)
SHARE(VAL,IP,HWND,DFN) ; Set global to share DFN with other applications
"RTN","ORWPT",99,0)
 K ^TMP("ORWCHART",$J),^TMP("ORECALL",$J),^TMP("ORWORD",$J)
"RTN","ORWPT",100,0)
 K ^TMP("ORWDXMQ",$J)
"RTN","ORWPT",101,0)
 S ^TMP("ORWCHART",$J,IP,HWND)=DFN
"RTN","ORWPT",102,0)
 Q
"RTN","ORWPT",103,0)
BYWARD(LST,WARD) ; Return a list of patients in a ward
"RTN","ORWPT",104,0)
 N ILST,DFN
"RTN","ORWPT",105,0)
 I +$G(WARD)<1 S LST(1)="^No ward identified" Q
"RTN","ORWPT",106,0)
 S (ILST,DFN)=0
"RTN","ORWPT",107,0)
 S WARD=$P(^DIC(42,WARD,0),"^")   ;DBIA #36
"RTN","ORWPT",108,0)
 F  S DFN=$O(^DPT("CN",WARD,DFN)) Q:DFN'>0  D
"RTN","ORWPT",109,0)
 . S ILST=ILST+1,LST(ILST)=+DFN_U_$P(^DPT(+DFN,0),U)_U_$G(^DPT(+DFN,.101))
"RTN","ORWPT",110,0)
 I ILST<1 S LST(1)="^No patients found."
"RTN","ORWPT",111,0)
 Q
"RTN","ORWPT",112,0)
LAST5(LST,ID) ; Return a list of patients matching A9999 identifiers
"RTN","ORWPT",113,0)
 N I,IEN,XREF
"RTN","ORWPT",114,0)
 S (I,IEN)=0,XREF=$S($L(ID)=5:"BS5",1:"BS")
"RTN","ORWPT",115,0)
 F  S IEN=$O(^DPT(XREF,ID,IEN)) Q:'IEN  D
"RTN","ORWPT",116,0)
 . S I=I+1,LST(I)=IEN_U_$P(^DPT(IEN,0),U)_U_$$DOB^DPTLK1(IEN,2)_U_$$SSN^DPTLK1(IEN)  ; DG249
"RTN","ORWPT",117,0)
 Q
"RTN","ORWPT",118,0)
 ;
"RTN","ORWPT",119,0)
LAST5RPL(LST,ID) ; ; Return list matching A9999 id's, but from RPL only.
"RTN","ORWPT",120,0)
 N ORRPL,ORCNT,ORPT,ORPIEN
"RTN","ORWPT",121,0)
 ; IA ____ allows read access to NEW PERSON file node 101:
"RTN","ORWPT",122,0)
 S ORRPL=$G(^VA(200,DUZ,101))
"RTN","ORWPT",123,0)
 S ORRPL=$P(ORRPL,U,2)
"RTN","ORWPT",124,0)
 I (('ORRPL)!(ORRPL="")) S LST(0)="" Q
"RTN","ORWPT",125,0)
 ;
"RTN","ORWPT",126,0)
 S (ORCNT,ORPT)=0
"RTN","ORWPT",127,0)
 F  S ORPT=$O(^OR(100.21,ORRPL,10,ORPT)) Q:'ORPT  D
"RTN","ORWPT",128,0)
 .S ORPIEN=+$G(^OR(100.21,ORRPL,10,ORPT,0))
"RTN","ORWPT",129,0)
 .I ((ORPIEN<0)!(ORPIEN="")) Q
"RTN","ORWPT",130,0)
 .S ORCNT=ORCNT+1
"RTN","ORWPT",131,0)
 .S LST(ORCNT)=ORPIEN_U_$P(^DPT(ORPIEN,0),U)_U_$$DOB^DPTLK1(ORPIEN,2)_U_$$SSN^DPTLK1(ORPIEN) ; DG249.
"RTN","ORWPT",132,0)
 ;
"RTN","ORWPT",133,0)
 Q
"RTN","ORWPT",134,0)
 ;
"RTN","ORWPT",135,0)
FULLSSN(LST,ID) ; Return a list of patients matching full SSN entered
"RTN","ORWPT",136,0)
 N I,IEN
"RTN","ORWPT",137,0)
 S (I,IEN)=0
"RTN","ORWPT",138,0)
 F  S IEN=$O(^DPT("SSN",ID,IEN)) Q:'IEN  D
"RTN","ORWPT",139,0)
 . S I=I+1,LST(I)=IEN_U_$P(^DPT(IEN,0),U)_U_$$DOB^DPTLK1(IEN,2)_U_$$SSN^DPTLK1(IEN)  ; DG249
"RTN","ORWPT",140,0)
 Q
"RTN","ORWPT",141,0)
 ;
"RTN","ORWPT",142,0)
FSSNRPL(LST,ID) ; Return list matching Full SSN, but from RPL only.
"RTN","ORWPT",143,0)
 N ORRPL,ORCNT,ORPT,ORLPT,ORPIEN
"RTN","ORWPT",144,0)
 ; IA ____ allows read access to NEW PERSON file node 101:
"RTN","ORWPT",145,0)
 S ORRPL=$G(^VA(200,DUZ,101))
"RTN","ORWPT",146,0)
 S ORRPL=$P(ORRPL,U,2)
"RTN","ORWPT",147,0)
 I (('ORRPL)!(ORRPL="")) S LST(0)="" Q
"RTN","ORWPT",148,0)
 ;
"RTN","ORWPT",149,0)
 S (ORCNT,ORPT)=0
"RTN","ORWPT",150,0)
 F  S ORPT=$O(^DPT("SSN",ID,ORPT)) Q:'ORPT  D
"RTN","ORWPT",151,0)
 .S ORLPT=0
"RTN","ORWPT",152,0)
 .F  S ORLPT=$O(^OR(100.21,ORRPL,10,ORLPT)) Q:'ORLPT  D
"RTN","ORWPT",153,0)
 ..S ORPIEN=+$G(^OR(100.21,ORRPL,10,ORLPT,0))
"RTN","ORWPT",154,0)
 ..I ((ORPIEN<0)!(ORPIEN="")) Q
"RTN","ORWPT",155,0)
 ..I (ORPIEN'=ORPT) Q
"RTN","ORWPT",156,0)
 ..S ORCNT=ORCNT+1
"RTN","ORWPT",157,0)
 ..S LST(ORCNT)=ORPIEN_U_$P(^DPT(ORPIEN,0),U)_U_$$DOB^DPTLK1(ORPIEN,2)_U_$$SSN^DPTLK1(ORPIEN) ; DG249.
"RTN","ORWPT",158,0)
 ;
"RTN","ORWPT",159,0)
 Q
"RTN","ORWPT",160,0)
 ;
"RTN","ORWPT",161,0)
TOP(LST) ; Return top for all patients list (last selected for now)
"RTN","ORWPT",162,0)
 N IEN
"RTN","ORWPT",163,0)
 S IEN=$G(^DISV(DUZ,"^DPT("))
"RTN","ORWPT",164,0)
 I IEN S LST(1)=IEN_U_$P($G(^DPT(IEN,0)),U)
"RTN","ORWPT",165,0)
 Q
"RTN","ORWPT",166,0)
ENCTITL(REC,DFN,LOC,PROV) ; Return external values for encounter
"RTN","ORWPT",167,0)
 ; LOCNAME^LOCABBR^ROOMBED^PROVNAME
"RTN","ORWPT",168,0)
 K ^TMP("OR QUICK ORDER AUDIT",$J,"REC") ;RTW
"RTN","ORWPT",169,0)
 S $P(REC,U,1)=$P($G(^SC(+LOC,0)),U,1,2)
"RTN","ORWPT",170,0)
 S $P(REC,U,3)=$P($G(^DPT(DFN,.101)),U)
"RTN","ORWPT",171,0)
 S $P(REC,U,4)=$P($G(^VA(200,+PROV,0)),U)
"RTN","ORWPT",172,0)
 S ^TMP("OR QUICK ORDER AUDIT",$J,"REC")=REC
"RTN","ORWPT",173,0)
 Q
"RTN","ORWPT",174,0)
LISTALL(Y,FROM,DIR) ; Return a bolus of patient names.  From is either Name or IEN^Name.
"RTN","ORWPT",175,0)
 N I,IEN,CNT,FROMIEN,ORIDNAME S CNT=44,I=0,FROMIEN=0
"RTN","ORWPT",176,0)
 I $P(FROM,U,2)'="" S FROMIEN=$P(FROM,U,1),FROM=$O(^DPT("B",$P(FROM,U,2)),-DIR)
"RTN","ORWPT",177,0)
 F  S FROM=$O(^DPT("B",FROM),DIR) Q:FROM=""  D  Q:I=CNT
"RTN","ORWPT",178,0)
 . S IEN=FROMIEN,FROMIEN=0 F  S IEN=$O(^DPT("B",FROM,IEN)) Q:'IEN  D  Q:I=CNT
"RTN","ORWPT",179,0)
 . . Q:$D(^DPT(IEN,-9))  ; skip if patient is a merged stub
"RTN","ORWPT",180,0)
 . . S ORIDNAME=""
"RTN","ORWPT",181,0)
 . . S ORIDNAME=$G(^DPT(IEN,0)) ; Get zero node name.
"RTN","ORWPT",182,0)
 . . ; S X1=$G(^DPT(IEN,.1))_" "_$G(^DPT(IEN,.101))
"RTN","ORWPT",183,0)
 . . S I=I+1 S Y(I)=IEN_U_FROM_U_U_U_U_$P(ORIDNAME,U) ;_"^"_X ; _"^"_X1  ;"   ("_X_")"
"RTN","ORWPT",184,0)
 Q
"RTN","ORWPT",185,0)
APPTLST(LST,DFN) ; return a list of appointments
"RTN","ORWPT",186,0)
 ; APPTTIME^LOCIEN^LOCNAME^EXTSTATUS
"RTN","ORWPT",187,0)
 N ERR,ERRMSG,VASD,VAERR K ^UTILITY("VASD",$J)  ;IA 10061
"RTN","ORWPT",188,0)
 S VASD("F")=$$HTFM^XLFDT($H-30,1)
"RTN","ORWPT",189,0)
 S VASD("T")=$$HTFM^XLFDT($H+1,1)_".2359"
"RTN","ORWPT",190,0)
 S VASD("W")="123456789"
"RTN","ORWPT",191,0)
 D SDA^ORQRY01(.ERR,.ERRMSG)
"RTN","ORWPT",192,0)
 I ERR K ^UTILITY("VASD",$J) K LST S LST(1)=ERRMSG Q
"RTN","ORWPT",193,0)
 S I=0 F  S I=$O(^UTILITY("VASD",$J,I)) Q:'I  D
"RTN","ORWPT",194,0)
 . S LST(I)=$P(^UTILITY("VASD",$J,I,"I"),U,1,2)_U_$P(^("E"),U,2,3)
"RTN","ORWPT",195,0)
 K ^UTILITY("VASD",$J)
"RTN","ORWPT",196,0)
 Q
"RTN","ORWPT",197,0)
ADMITLST(LST,DFN) ; return a list of admissions
"RTN","ORWPT",198,0)
 ; MOVETIME^LOCIEN^LOCNAME^TYPE
"RTN","ORWPT",199,0)
 N TIM,MOV,X0,Y,MTIM,XTYP,XLOC,HLOC,ILST S ILST=0
"RTN","ORWPT",200,0)
 S TIM="" F  S TIM=$O(^DGPM("ATID1",DFN,TIM)) Q:TIM'>0  D
"RTN","ORWPT",201,0)
 . S MOV=0  F  S MOV=$O(^DGPM("ATID1",DFN,TIM,MOV)) Q:MOV'>0  D
"RTN","ORWPT",202,0)
 . . N VSTR,TIUDA
"RTN","ORWPT",203,0)
 . . S X0=$G(^DGPM(MOV,0)) I X0']"" Q
"RTN","ORWPT",204,0)
 . . S MTIM=$P(X0,U)
"RTN","ORWPT",205,0)
 . . S XTYP=$P($G(^DG(405.1,+$P(X0,U,4),0)),U,1)
"RTN","ORWPT",206,0)
 . . S XLOC=$P($G(^DIC(42,+$P(X0,U,6),0)),U,1),HLOC=+$G(^(44))
"RTN","ORWPT",207,0)
 . . S VSTR=HLOC_";"_MTIM_";H",TIUDA=$$HASDS^TIULX(DFN,VSTR)
"RTN","ORWPT",208,0)
 . . S ILST=ILST+1,LST(ILST)=MTIM_U_HLOC_U_XLOC_U_XTYP_U_MOV_U_TIUDA
"RTN","ORWPT",209,0)
 Q
"RTN","ORWPT",210,0)
CLINRNG(LST) ; return date ranges for clinic appointments
"RTN","ORWPT",211,0)
 S LST(1)="T;T^Today"
"RTN","ORWPT",212,0)
 S LST(2)="T+1;T+1^Tomorrow"
"RTN","ORWPT",213,0)
 S LST(3)="T-1;T-1^Yesterday"
"RTN","ORWPT",214,0)
 S LST(4)="T-7;T^Past Week"
"RTN","ORWPT",215,0)
 S LST(5)="T-31;T^Past Month"
"RTN","ORWPT",216,0)
 S LST(6)="S^Specify Date Range..."
"RTN","ORWPT",217,0)
 Q
"RTN","ORWPT",218,0)
 ;
"RTN","ORWPT",219,0)
 N %,%H,X,SUNDAY,START
"RTN","ORWPT",220,0)
 S LST(1)=DT_";"_DT_"^Today",X=$$HTFM^XLFDT($H+1,1)
"RTN","ORWPT",221,0)
 S LST(2)=X_";"_X_"^Tomorrow"
"RTN","ORWPT",222,0)
 S X=+$H F  Q:X#7=3  S X=X-1                        ; $H#7=3 is Sunday
"RTN","ORWPT",223,0)
 S LST(3)=$$HTFM^XLFDT(X)_";"_$$HTFM^XLFDT(X+6)_"^This Week"
"RTN","ORWPT",224,0)
 S LST(4)=$$HTFM^XLFDT(X+7)_";"_$$HTFM^XLFDT(X+13)_"^Next Week"
"RTN","ORWPT",225,0)
 S LST(5)=$E(DT,1,5)_"01;"_$E(DT,1,5)_"31^This Month"
"RTN","ORWPT",226,0)
 S X=$E(DT,4,5)+1 S:X=13 X=1 S X=$E(DT,1,3)_$TR($J(X,2)," ",0)
"RTN","ORWPT",227,0)
 S LST(6)=X_"01;"_X_"31^Next Month"
"RTN","ORWPT",228,0)
 S LST(7)="^Specify Dates"
"RTN","ORWPT",229,0)
 Q
"RTN","ORWPT",230,0)
DFLTSRC(VAL) ; return default patient list source (T, W, C, P, S)
"RTN","ORWPT",231,0)
 N SRV S SRV=+$G(^VA(200,DUZ,5))
"RTN","ORWPT",232,0)
 S VAL=$$GET^XPAR("ALL^SRV.`"_SRV,"ORLP DEFAULT LIST SOURCE")
"RTN","ORWPT",233,0)
 Q
"RTN","ORWPT",234,0)
SAVDFLT(OK,X) ; save new default patient list settings (X=type^ien^sdt;edt)
"RTN","ORWPT",235,0)
 G SAVDFLT^ORWPT1
"RTN","ORWPT",236,0)
 ;
"RTN","ORWPT",237,0)
DISCHRG(Y,DFN,ADMITDT) ; Get discharge movement information
"RTN","ORWPT",238,0)
 N VAIP
"RTN","ORWPT",239,0)
 I +$G(ADMITDT)=0 S Y=DT Q
"RTN","ORWPT",240,0)
 S VAIP("D")=ADMITDT D 52^VADPT
"RTN","ORWPT",241,0)
 I +VAIP(17)=0 S Y=DT Q
"RTN","ORWPT",242,0)
 S Y=+VAIP(17,1)
"RTN","ORWPT",243,0)
 Q
"RTN","ORWPT",244,0)
CWAD(Y,DFN) ;  returns CWAD flags for a patient
"RTN","ORWPT",245,0)
 S Y=$$CWAD^ORQPT2(DFN)
"RTN","ORWPT",246,0)
 Q
"RTN","ORWPT",247,0)
LEGACY(ORLST,DFN) ; return message if data on the legacy system
"RTN","ORWPT",248,0)
 ; ORLST(0)=1 if data,  ORLST(n)=display message if data
"RTN","ORWPT",249,0)
 S ORLST(0)=0
"RTN","ORWPT",250,0)
 I $L($T(HXDATA^A7RDPAGU)) D
"RTN","ORWPT",251,0)
 . D HXDATA^A7RDPAGU(.ORLST,DFN)
"RTN","ORWPT",252,0)
 . I $O(ORLST(0)) S ORLST(0)=1
"RTN","ORWPT",253,0)
 Q
"RTN","ORWPT",254,0)
INPLOC(REC,DFN) ; Return a patient's current location
"RTN","ORWPT",255,0)
 N X
"RTN","ORWPT",256,0)
 S X=$G(^DPT(DFN,.102)),REC=0
"RTN","ORWPT",257,0)
 I X S X=$P($G(^DGPM(X,0)),U,6)
"RTN","ORWPT",258,0)
 I X S REC=+$G(^DIC(42,X,44))
"RTN","ORWPT",259,0)
 I X S $P(REC,U,2)=$P($G(^DIC(42,X,0)),U,1)
"RTN","ORWPT",260,0)
 I X S X=$P($G(^DIC(42,X,0)),U,3)
"RTN","ORWPT",261,0)
 S $P(REC,U,3)=X
"RTN","ORWPT",262,0)
 Q
"RTN","ORWPT",263,0)
AGE(DFN,BEG) ; returns age based on date of birth and date of death (or DT)
"RTN","ORWPT",264,0)
 N END,X
"RTN","ORWPT",265,0)
 S END=+$G(^DPT(DFN,.35)),END=$S(END:END,1:DT)
"RTN","ORWPT",266,0)
 S X=$E(END,1,3)-$E(BEG,1,3)-($E(END,4,7)<$E(BEG,4,7))
"RTN","ORWPT",267,0)
 Q X
"RTN","ORWPT",268,0)
ROK(X) ; Routine OK (in UCI) (NDBI)
"RTN","ORWPT",269,0)
 S X=$G(X) Q:'$L(X) 0  Q:$L(X)>8 0  X ^%ZOSF("TEST") Q:$T 1  Q 0
"SEC","^DD",100.953,100.953,.01,8)
"@"
"SEC","^DD",100.953,100.953,.01,8.5)
"@"
"SEC","^DD",100.953,100.953,.01,9)
"@"
"SEC","^DIC",100.95,100.95,0,"AUDIT")

"SEC","^DIC",100.95,100.95,0,"DD")

"SEC","^DIC",100.95,100.95,0,"DEL")

"SEC","^DIC",100.95,100.95,0,"LAYGO")

"SEC","^DIC",100.95,100.95,0,"RD")

"SEC","^DIC",100.95,100.95,0,"WR")

"SEC","^DIC",100.953,100.953,0,"AUDIT")
@
"SEC","^DIC",100.953,100.953,0,"DD")
@
"SEC","^DIC",100.953,100.953,0,"DEL")
@
"SEC","^DIC",100.953,100.953,0,"LAYGO")
@
"SEC","^DIC",100.953,100.953,0,"RD")
@
"SEC","^DIC",100.953,100.953,0,"WR")
@
"VER")
8.0^22.2
"^DD",100.95,100.95,0)
FIELD^^.001^12
"^DD",100.95,100.95,0,"DT")
3180726
"^DD",100.95,100.95,0,"IX","B",100.95,.01)

"^DD",100.95,100.95,0,"NM","QUICK ORDER AUDIT")

"^DD",100.95,100.95,.001,0)
NUMBER^NJ11,0^^ ^K:+X'=X!(X>99999999999)!(X<0)!(X?.E1"."1N.N) X
"^DD",100.95,100.95,.001,3)
Type a number between 0 and 99999999999, 0 decimal digits.
"^DD",100.95,100.95,.001,21,0)
^^1^1^3170127^
"^DD",100.95,100.95,.001,21,1,0)
This is the Quick Order reference number.
"^DD",100.95,100.95,.001,"DT")
3161216
"^DD",100.95,100.95,.01,0)
DATE TIME^RDa^^0;1^S %DT="ETR" D ^%DT S X=Y K:Y<1 X
"^DD",100.95,100.95,.01,.1)
DATE TIME
"^DD",100.95,100.95,.01,1,0)
^.1
"^DD",100.95,100.95,.01,1,1,0)
100.95^B
"^DD",100.95,100.95,.01,1,1,1)
S ^OR(100.95,"B",$E(X,1,30),DA)=""
"^DD",100.95,100.95,.01,1,1,2)
K ^OR(100.95,"B",$E(X,1,30),DA)
"^DD",100.95,100.95,.01,3)
Enter the Date and Time the quick order was selected
"^DD",100.95,100.95,.01,21,0)
^.001^1^1^3171220^^^
"^DD",100.95,100.95,.01,21,1,0)
This is the Date/Time the Quick Order was selected.
"^DD",100.95,100.95,.01,"AUDIT")
y
"^DD",100.95,100.95,.01,"DT")
3171220
"^DD",100.95,100.95,1,0)
USER^RP200'^VA(200,^0;2^Q
"^DD",100.95,100.95,1,3)
Enter the person who selected the Quick Order.
"^DD",100.95,100.95,1,21,0)
^.001^1^1^3170131^^
"^DD",100.95,100.95,1,21,1,0)
This is the person who selected the Quick Order.
"^DD",100.95,100.95,1,23,0)
^^1^1^3170131^
"^DD",100.95,100.95,1,23,1,0)
The internal value is the DUZ of the person who selected the Quick Order.
"^DD",100.95,100.95,1,"DT")
3170131
"^DD",100.95,100.95,2,0)
PATIENT^RP2'^DPT(^0;3^Q
"^DD",100.95,100.95,2,3)
Enter the patient for whom the Quick Order was made.
"^DD",100.95,100.95,2,21,0)
^.001^1^1^3170131^^^^
"^DD",100.95,100.95,2,21,1,0)
This is the patient for whom the order was made.
"^DD",100.95,100.95,2,"DT")
3170131
"^DD",100.95,100.95,2.1,0)
LAST4^FJ4^^0;9^K:$L(X)>4!($L(X)<4) X
"^DD",100.95,100.95,2.1,.1)
LAST FOUR
"^DD",100.95,100.95,2.1,3)
Answer must be 4 characters in length.
"^DD",100.95,100.95,2.1,21,0)
^^2^2^3171228^
"^DD",100.95,100.95,2.1,21,1,0)
This the last four of the patients ssn and is used to help identify the
"^DD",100.95,100.95,2.1,21,2,0)
individual patient.
"^DD",100.95,100.95,2.1,"DT")
3171225
"^DD",100.95,100.95,3,0)
QUICK ORDER^P101.41a^ORD(101.41,^0;4^Q
"^DD",100.95,100.95,3,.1)
QUICK ORDER DIALOG ENTRY
"^DD",100.95,100.95,3,3)
Select a Quick Order
"^DD",100.95,100.95,3,21,0)
^.001^1^1^3170201^^^^
"^DD",100.95,100.95,3,21,1,0)
This is the QUICK ORDER name.
"^DD",100.95,100.95,3,23,0)
^.001^2^2^3170201^^^^
"^DD",100.95,100.95,3,23,1,0)
This is the QUICK ORDER Dialog entry from the ORDER DIALOG FILE 
"^DD",100.95,100.95,3,23,2,0)
#101.41.
"^DD",100.95,100.95,3,"AUDIT")
y
"^DD",100.95,100.95,3,"DT")
3170201
"^DD",100.95,100.95,4,0)
PROVIDER^RP200'a^VA(200,^0;5^Q
"^DD",100.95,100.95,4,.1)
REQUESTING PROVIDER
"^DD",100.95,100.95,4,3)
Enter the Provider who requested the order be placed.
"^DD",100.95,100.95,4,21,0)
^.001^1^1^3170131^^^^
"^DD",100.95,100.95,4,21,1,0)
This is the Provider who requested the order be placed.
"^DD",100.95,100.95,4,"AUDIT")
y
"^DD",100.95,100.95,4,"DT")
3170131
"^DD",100.95,100.95,5,0)
TYPE^Sa^P:PRIMARY DRUG;A:ALTERNATIVE DRUG;^0;6^Q
"^DD",100.95,100.95,5,.1)
PRIMARY OR ALTERNATIVE DRUG
"^DD",100.95,100.95,5,3)
Designate the order as containing the primary or alternate drug.
"^DD",100.95,100.95,5,21,0)
^^3^3^3170127^
"^DD",100.95,100.95,5,21,1,0)
There are two selections available for Quick Orders, Primary or 
"^DD",100.95,100.95,5,21,2,0)
Alternate.  The primary is the clinically preferred drug. The Alternate is
"^DD",100.95,100.95,5,21,3,0)
any drug that is considered to be an alternate to the primary drug. 
"^DD",100.95,100.95,5,"AUDIT")
y
"^DD",100.95,100.95,5,"DT")
3170126
"^DD",100.95,100.95,6,0)
LOCATION^P44a^SC(^0;7^Q
"^DD",100.95,100.95,6,.1)
THE ORDERING LOCATION
"^DD",100.95,100.95,6,3)
Enter This is the Hospital location where the order was created.
"^DD",100.95,100.95,6,21,0)
^.001^1^1^3171215^^^^
"^DD",100.95,100.95,6,21,1,0)
This is the Hospital location where the order was created.
"^DD",100.95,100.95,6,"AUDIT")
y
"^DD",100.95,100.95,6,"DT")
3171215
"^DD",100.95,100.95,7,0)
ORDER^P100'a^OR(100,^0;8^Q
"^DD",100.95,100.95,7,.1)
ORDER ENTRY FILE NUMBER
"^DD",100.95,100.95,7,3)
Enter the order number associated with the Quick Order.
"^DD",100.95,100.95,7,21,0)
^.001^1^1^3170131^^
"^DD",100.95,100.95,7,21,1,0)
This is the order number associated with the Quick Order.
"^DD",100.95,100.95,7,23,0)
^.001^2^2^3170131^^^
"^DD",100.95,100.95,7,23,1,0)
This number is set from Routine ORQOAUIB , and is the order number from 
"^DD",100.95,100.95,7,23,2,0)
file #100 associated with the Quick Order.
"^DD",100.95,100.95,7,"AUDIT")
y
"^DD",100.95,100.95,7,"DT")
3170131
"^DD",100.95,100.95,99,0)
DRUG^CJ9999^^ ; ^S X=$$DRUG^ORQOAUIC(D0)
"^DD",100.95,100.95,99,9)
^
"^DD",100.95,100.95,99,9.01)

"^DD",100.95,100.95,99,9.1)
S X=$$DRUG^ORQOAUIC(D0)
"^DD",100.95,100.95,99,21,0)
^.001^1^1^3171226^^
"^DD",100.95,100.95,99,21,1,0)
This is the DRUG associated with the QUICK ORDER.
"^DD",100.95,100.95,99,"DT")
3171226
"^DD",100.95,100.95,100,0)
PATIENT DFN^CJ999999999^^ ; ^S Y(100.95,100,1)=$S($D(^OR(100.95,D0,0)):^(0),1:"") S X=$P(Y(100.95,100,1),U,3),X=X
"^DD",100.95,100.95,100,.1)
PATIENT IEN FROM FILE 2
"^DD",100.95,100.95,100,9)
^
"^DD",100.95,100.95,100,9.01)
100.95^2
"^DD",100.95,100.95,100,9.1)
INTERNAL(PATIENT)
"^DD",100.95,100.95,100,21,0)
^.001^1^1^3161217^^^
"^DD",100.95,100.95,100,21,1,0)
This is the patient ien from file the patient file
"^DD",100.95,100.95,100,"DT")
3161217
"^DD",100.953,100.953,0)
FIELD^^1^2
"^DD",100.953,100.953,0,"DT")
3171218
"^DD",100.953,100.953,0,"IX","B",100.953,.01)

"^DD",100.953,100.953,0,"NM","QUICK ORDER DIVISION GROUPS")

"^DD",100.953,100.953,.01,0)
GROUP NAME^RFJ30^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",100.953,100.953,.01,.1)
QUICK ORDER GROUP NAME
"^DD",100.953,100.953,.01,1,0)
^.1
"^DD",100.953,100.953,.01,1,1,0)
100.953^B
"^DD",100.953,100.953,.01,1,1,1)
S ^OR(100.953,"B",$E(X,1,30),DA)=""
"^DD",100.953,100.953,.01,1,1,2)
K ^OR(100.953,"B",$E(X,1,30),DA)
"^DD",100.953,100.953,.01,3)
Answer must be 3-30 characters in length.
"^DD",100.953,100.953,.01,21,0)
^.001^3^3^3170207^^^
"^DD",100.953,100.953,.01,21,1,0)
The names of groups in this file are locally defined for the purpose of 
"^DD",100.953,100.953,.01,21,2,0)
organizing divisions whose antimicrobial ordering results need to be 
"^DD",100.953,100.953,.01,21,3,0)
on the same monthly report.
"^DD",100.953,100.953,.01,"DT")
3161121
"^DD",100.953,100.953,1,0)
MEDICAL CENTER DIVISION^100.9531P^^1;0
"^DD",100.953,100.953,1,21,0)
^.001^3^3^3180102^^
"^DD",100.953,100.953,1,21,1,0)
This field holds the names of the medical center divisions desired to be
"^DD",100.953,100.953,1,21,2,0)
grouped together under a designated group name. It is used when printing
"^DD",100.953,100.953,1,21,3,0)
the antimicrobial decision tree quick order audit monthly report.
"^DD",100.953,100.953,1,"DT")
3171218
"^DD",100.953,100.9531,0)
MEDICAL CENTER DIVISION SUB-FIELD^^.01^1
"^DD",100.953,100.9531,0,"DT")
3171218
"^DD",100.953,100.9531,0,"IX","B",100.9531,.01)

"^DD",100.953,100.9531,0,"NM","MEDICAL CENTER DIVISION")

"^DD",100.953,100.9531,0,"UP")
100.953
"^DD",100.953,100.9531,.01,0)
MEDICAL CENTER DIVISION^MRP40.8'^DG(40.8,^0;1^Q
"^DD",100.953,100.9531,.01,1,0)
^.1
"^DD",100.953,100.9531,.01,1,1,0)
100.9531^B
"^DD",100.953,100.9531,.01,1,1,1)
S ^OR(100.953,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",100.953,100.9531,.01,1,1,2)
K ^OR(100.953,DA(1),1,"B",$E(X,1,30),DA)
"^DD",100.953,100.9531,.01,3)
Enter the Medical Center Divisions Associated with a Quick Order Group
"^DD",100.953,100.9531,.01,21,0)
^.001^2^2^3171219^^^^
"^DD",100.953,100.9531,.01,21,1,0)
This subfield holds the Medical Center Divisions selected for a Group.
"^DD",100.953,100.9531,.01,21,2,0)
MEDICAL CENTER DIVISIONS.
"^DD",100.953,100.9531,.01,"DT")
3171218
"^DIC",100.95,100.95,0)
QUICK ORDER AUDIT^100.95
"^DIC",100.95,100.95,0,"GL")
^OR(100.95,
"^DIC",100.95,100.95,"%",0)
^1.005^^
"^DIC",100.95,100.95,"%D",0)
^1.001^1^1^3170215^^
"^DIC",100.95,100.95,"%D",1,0)
This file is used to capture the pharmacy Antimicrobial usage orders.
"^DIC",100.95,"B","QUICK ORDER AUDIT",100.95)

"^DIC",100.953,100.953,0)
QUICK ORDER DIVISION GROUPS^100.953
"^DIC",100.953,100.953,0,"GL")
^OR(100.953,
"^DIC",100.953,100.953,"%",0)
^1.005^^
"^DIC",100.953,100.953,"%D",0)
^1.001^5^5^3170215^^^
"^DIC",100.953,100.953,"%D",1,0)
The purpose of the Quick Order Division Groups file is to
"^DIC",100.953,100.953,"%D",2,0)
provide a place to organize those divisions and groups whose results are 
"^DIC",100.953,100.953,"%D",3,0)
printed on the Antimicrobial Monthly tracking reports.  A site with 
"^DIC",100.953,100.953,"%D",4,0)
multiple divisions can separate monthly results of Antimicrobial ordering
"^DIC",100.953,100.953,"%D",5,0)
into those divisions belonging to a specific group.
"^DIC",100.953,"B","QUICK ORDER DIVISION GROUPS",100.953)

"BLD",10032,6)
^413
**END**
**END**

