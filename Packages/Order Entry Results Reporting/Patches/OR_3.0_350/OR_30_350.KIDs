KIDS Distribution saved on Nov 10, 2015@14:39:23
OR*3*350
**KIDS**:OR*3.0*350^

**INSTALL NAME**
OR*3.0*350
"BLD",8207,0)
OR*3.0*350^ORDER ENTRY/RESULTS REPORTING^0^3151110^y
"BLD",8207,4,0)
^9.64PA^101.41^3
"BLD",8207,4,100.9,0)
100.9
"BLD",8207,4,100.9,222)
y^y^f^^n^^y^r^n
"BLD",8207,4,100.9,224)
I $$INCNOTIF^ORY350E(Y)
"BLD",8207,4,101.24,0)
101.24
"BLD",8207,4,101.24,222)
y^n^f^^y^^y^r^n
"BLD",8207,4,101.24,224)
I (Y>999)!(Y=31)
"BLD",8207,4,101.41,0)
101.41
"BLD",8207,4,101.41,222)
n^n^f^^y^^y^r^n
"BLD",8207,4,101.41,224)
I $$SENDDLG^ORY350($P(^(0),U))
"BLD",8207,4,"B",100.9,100.9)

"BLD",8207,4,"B",101.24,101.24)

"BLD",8207,4,"B",101.41,101.41)

"BLD",8207,6.3)
77
"BLD",8207,"ABPKG")
n
"BLD",8207,"INI")
PRE^ORY350
"BLD",8207,"INID")
y^n^n
"BLD",8207,"INIT")
POST^ORY350
"BLD",8207,"KRN",0)
^9.67PA^779.2^20
"BLD",8207,"KRN",.4,0)
.4
"BLD",8207,"KRN",.401,0)
.401
"BLD",8207,"KRN",.402,0)
.402
"BLD",8207,"KRN",.403,0)
.403
"BLD",8207,"KRN",.5,0)
.5
"BLD",8207,"KRN",.84,0)
.84
"BLD",8207,"KRN",3.6,0)
3.6
"BLD",8207,"KRN",3.8,0)
3.8
"BLD",8207,"KRN",9.2,0)
9.2
"BLD",8207,"KRN",9.8,0)
9.8
"BLD",8207,"KRN",9.8,"NM",0)
^9.68A^86^68
"BLD",8207,"KRN",9.8,"NM",5,0)
ORCDLG1^^0^B84017168
"BLD",8207,"KRN",9.8,"NM",6,0)
ORCDPS^^0^B41761091
"BLD",8207,"KRN",9.8,"NM",8,0)
ORMPS^^0^B86715269
"BLD",8207,"KRN",9.8,"NM",9,0)
ORQ11^^0^B65899286
"BLD",8207,"KRN",9.8,"NM",10,0)
ORTSKLPS^^0^B8724691
"BLD",8207,"KRN",9.8,"NM",13,0)
ORB3FUP1^^0^B77909013
"BLD",8207,"KRN",9.8,"NM",14,0)
ORAREN^^0^B51653568
"BLD",8207,"KRN",9.8,"NM",15,0)
ORY350A^^0^B20572876
"BLD",8207,"KRN",9.8,"NM",16,0)
ORWDX^^0^B70259913
"BLD",8207,"KRN",9.8,"NM",17,0)
ORCXPND1^^0^B97571749
"BLD",8207,"KRN",9.8,"NM",18,0)
ORDV02^^0^B73541446
"BLD",8207,"KRN",9.8,"NM",19,0)
ORDV02B^^0^B40982123
"BLD",8207,"KRN",9.8,"NM",20,0)
ORDV02C^^0^B22064710
"BLD",8207,"KRN",9.8,"NM",21,0)
ORWOR2^^0^B39008801
"BLD",8207,"KRN",9.8,"NM",22,0)
ORWRP1A^^0^B8386925
"BLD",8207,"KRN",9.8,"NM",23,0)
ORWRP3^^0^B12651269
"BLD",8207,"KRN",9.8,"NM",24,0)
ORDEBUG^^0^B15661026
"BLD",8207,"KRN",9.8,"NM",29,0)
ORY350B^^0^B73339519
"BLD",8207,"KRN",9.8,"NM",30,0)
ORY350E^^0^B23254860
"BLD",8207,"KRN",9.8,"NM",33,0)
ORB3^^0^B140213780
"BLD",8207,"KRN",9.8,"NM",35,0)
ORWDPS1^^0^B58422591
"BLD",8207,"KRN",9.8,"NM",36,0)
ORWCIRN^^0^B10494851
"BLD",8207,"KRN",9.8,"NM",37,0)
ORQQCN2^^0^B36811080
"BLD",8207,"KRN",9.8,"NM",39,0)
ORQ21^^0^B35534512
"BLD",8207,"KRN",9.8,"NM",40,0)
ORDEBUG2^^0^B5203678
"BLD",8207,"KRN",9.8,"NM",41,0)
ORCDPS1^^0^B86245200
"BLD",8207,"KRN",9.8,"NM",42,0)
ORCDPS2^^0^B68376826
"BLD",8207,"KRN",9.8,"NM",43,0)
ORMBLD^^0^B44600527
"BLD",8207,"KRN",9.8,"NM",44,0)
ORQOR2^^0^B14557366
"BLD",8207,"KRN",9.8,"NM",45,0)
ORB3TIM2^^0^B43382102
"BLD",8207,"KRN",9.8,"NM",46,0)
ORCACT0^^0^B64590852
"BLD",8207,"KRN",9.8,"NM",47,0)
ORUTL^^0^B85894949
"BLD",8207,"KRN",9.8,"NM",48,0)
ORDEA01A^^0^B131930344
"BLD",8207,"KRN",9.8,"NM",49,0)
ORDEA01B^^0^B129635261
"BLD",8207,"KRN",9.8,"NM",50,0)
ORQOREP^^0^B92933905
"BLD",8207,"KRN",9.8,"NM",51,0)
ORDEA01^^0^B46652455
"BLD",8207,"KRN",9.8,"NM",52,0)
ORCDPS3^^0^B45751820
"BLD",8207,"KRN",9.8,"NM",53,0)
ORWU^^0^B62530173
"BLD",8207,"KRN",9.8,"NM",54,0)
ORIMO^^0^B2334294
"BLD",8207,"KRN",9.8,"NM",55,0)
ORQQPL1^^0^B93414156
"BLD",8207,"KRN",9.8,"NM",56,0)
ORWDPS3^^0^B24262284
"BLD",8207,"KRN",9.8,"NM",57,0)
ORWDPS32^^0^B77153006
"BLD",8207,"KRN",9.8,"NM",58,0)
ORMPS2^^0^B48612384
"BLD",8207,"KRN",9.8,"NM",59,0)
ORBCMA5^^0^B8075398
"BLD",8207,"KRN",9.8,"NM",61,0)
ORWPS^^0^B65076275
"BLD",8207,"KRN",9.8,"NM",62,0)
ORDD100A^^0^B8843443
"BLD",8207,"KRN",9.8,"NM",63,0)
ORY350F^^1^
"BLD",8207,"KRN",9.8,"NM",64,0)
ORWDX1^^0^B53489734
"BLD",8207,"KRN",9.8,"NM",65,0)
ORWDXM1^^0^B106096775
"BLD",8207,"KRN",9.8,"NM",66,0)
ORWDPS33^^0^B41340191
"BLD",8207,"KRN",9.8,"NM",67,0)
ORWDXM3^^0^B111449239
"BLD",8207,"KRN",9.8,"NM",68,0)
ORWDXR01^^0^B29178545
"BLD",8207,"KRN",9.8,"NM",69,0)
ORWDXM4^^0^B43181122
"BLD",8207,"KRN",9.8,"NM",70,0)
ORQQPL^^0^B33314965
"BLD",8207,"KRN",9.8,"NM",71,0)
ORMPS1^^0^B71509240
"BLD",8207,"KRN",9.8,"NM",72,0)
ORCACT01^^0^B77384512
"BLD",8207,"KRN",9.8,"NM",73,0)
ORMBLDGM^^0^B6024774
"BLD",8207,"KRN",9.8,"NM",74,0)
ORMGMRC^^0^B45026486
"BLD",8207,"KRN",9.8,"NM",75,0)
ORWDCN32^^0^B19344504
"BLD",8207,"KRN",9.8,"NM",76,0)
ORQQPL4^^0^B15703032
"BLD",8207,"KRN",9.8,"NM",77,0)
ORWPCE4^^0^B22821566
"BLD",8207,"KRN",9.8,"NM",79,0)
ORMFN^^0^B42446020
"BLD",8207,"KRN",9.8,"NM",80,0)
ORUTL4^^0^B10368867
"BLD",8207,"KRN",9.8,"NM",81,0)
ORWGAPID^^0^B58657928
"BLD",8207,"KRN",9.8,"NM",82,0)
ORCDFHTF^^0^B19437978
"BLD",8207,"KRN",9.8,"NM",84,0)
ORPRS04^^0^B42879835
"BLD",8207,"KRN",9.8,"NM",85,0)
ORDV06B^^0^B43803935
"BLD",8207,"KRN",9.8,"NM",86,0)
ORDEBUG1^^0^B10131141
"BLD",8207,"KRN",9.8,"NM","B","ORAREN",14)

"BLD",8207,"KRN",9.8,"NM","B","ORB3",33)

"BLD",8207,"KRN",9.8,"NM","B","ORB3FUP1",13)

"BLD",8207,"KRN",9.8,"NM","B","ORB3TIM2",45)

"BLD",8207,"KRN",9.8,"NM","B","ORBCMA5",59)

"BLD",8207,"KRN",9.8,"NM","B","ORCACT0",46)

"BLD",8207,"KRN",9.8,"NM","B","ORCACT01",72)

"BLD",8207,"KRN",9.8,"NM","B","ORCDFHTF",82)

"BLD",8207,"KRN",9.8,"NM","B","ORCDLG1",5)

"BLD",8207,"KRN",9.8,"NM","B","ORCDPS",6)

"BLD",8207,"KRN",9.8,"NM","B","ORCDPS1",41)

"BLD",8207,"KRN",9.8,"NM","B","ORCDPS2",42)

"BLD",8207,"KRN",9.8,"NM","B","ORCDPS3",52)

"BLD",8207,"KRN",9.8,"NM","B","ORCXPND1",17)

"BLD",8207,"KRN",9.8,"NM","B","ORDD100A",62)

"BLD",8207,"KRN",9.8,"NM","B","ORDEA01",51)

"BLD",8207,"KRN",9.8,"NM","B","ORDEA01A",48)

"BLD",8207,"KRN",9.8,"NM","B","ORDEA01B",49)

"BLD",8207,"KRN",9.8,"NM","B","ORDEBUG",24)

"BLD",8207,"KRN",9.8,"NM","B","ORDEBUG1",86)

"BLD",8207,"KRN",9.8,"NM","B","ORDEBUG2",40)

"BLD",8207,"KRN",9.8,"NM","B","ORDV02",18)

"BLD",8207,"KRN",9.8,"NM","B","ORDV02B",19)

"BLD",8207,"KRN",9.8,"NM","B","ORDV02C",20)

"BLD",8207,"KRN",9.8,"NM","B","ORDV06B",85)

"BLD",8207,"KRN",9.8,"NM","B","ORIMO",54)

"BLD",8207,"KRN",9.8,"NM","B","ORMBLD",43)

"BLD",8207,"KRN",9.8,"NM","B","ORMBLDGM",73)

"BLD",8207,"KRN",9.8,"NM","B","ORMFN",79)

"BLD",8207,"KRN",9.8,"NM","B","ORMGMRC",74)

"BLD",8207,"KRN",9.8,"NM","B","ORMPS",8)

"BLD",8207,"KRN",9.8,"NM","B","ORMPS1",71)

"BLD",8207,"KRN",9.8,"NM","B","ORMPS2",58)

"BLD",8207,"KRN",9.8,"NM","B","ORPRS04",84)

"BLD",8207,"KRN",9.8,"NM","B","ORQ11",9)

"BLD",8207,"KRN",9.8,"NM","B","ORQ21",39)

"BLD",8207,"KRN",9.8,"NM","B","ORQOR2",44)

"BLD",8207,"KRN",9.8,"NM","B","ORQOREP",50)

"BLD",8207,"KRN",9.8,"NM","B","ORQQCN2",37)

"BLD",8207,"KRN",9.8,"NM","B","ORQQPL",70)

"BLD",8207,"KRN",9.8,"NM","B","ORQQPL1",55)

"BLD",8207,"KRN",9.8,"NM","B","ORQQPL4",76)

"BLD",8207,"KRN",9.8,"NM","B","ORTSKLPS",10)

"BLD",8207,"KRN",9.8,"NM","B","ORUTL",47)

"BLD",8207,"KRN",9.8,"NM","B","ORUTL4",80)

"BLD",8207,"KRN",9.8,"NM","B","ORWCIRN",36)

"BLD",8207,"KRN",9.8,"NM","B","ORWDCN32",75)

"BLD",8207,"KRN",9.8,"NM","B","ORWDPS1",35)

"BLD",8207,"KRN",9.8,"NM","B","ORWDPS3",56)

"BLD",8207,"KRN",9.8,"NM","B","ORWDPS32",57)

"BLD",8207,"KRN",9.8,"NM","B","ORWDPS33",66)

"BLD",8207,"KRN",9.8,"NM","B","ORWDX",16)

"BLD",8207,"KRN",9.8,"NM","B","ORWDX1",64)

"BLD",8207,"KRN",9.8,"NM","B","ORWDXM1",65)

"BLD",8207,"KRN",9.8,"NM","B","ORWDXM3",67)

"BLD",8207,"KRN",9.8,"NM","B","ORWDXM4",69)

"BLD",8207,"KRN",9.8,"NM","B","ORWDXR01",68)

"BLD",8207,"KRN",9.8,"NM","B","ORWGAPID",81)

"BLD",8207,"KRN",9.8,"NM","B","ORWOR2",21)

"BLD",8207,"KRN",9.8,"NM","B","ORWPCE4",77)

"BLD",8207,"KRN",9.8,"NM","B","ORWPS",61)

"BLD",8207,"KRN",9.8,"NM","B","ORWRP1A",22)

"BLD",8207,"KRN",9.8,"NM","B","ORWRP3",23)

"BLD",8207,"KRN",9.8,"NM","B","ORWU",53)

"BLD",8207,"KRN",9.8,"NM","B","ORY350A",15)

"BLD",8207,"KRN",9.8,"NM","B","ORY350B",29)

"BLD",8207,"KRN",9.8,"NM","B","ORY350E",30)

"BLD",8207,"KRN",9.8,"NM","B","ORY350F",63)

"BLD",8207,"KRN",19,0)
19
"BLD",8207,"KRN",19,"NM",0)
^9.68A^6^6
"BLD",8207,"KRN",19,"NM",1,0)
OR CPRS GUI CHART^^0
"BLD",8207,"KRN",19,"NM",2,0)
OR BCMA ORDER COM^^0
"BLD",8207,"KRN",19,"NM",3,0)
OR PARAM IRM MENU^^2
"BLD",8207,"KRN",19,"NM",4,0)
OR DEBUG REPORT^^0
"BLD",8207,"KRN",19,"NM",5,0)
ORW CLIN IND DATE DFLT^^0
"BLD",8207,"KRN",19,"NM",6,0)
OR PARAM COORDINATOR MENU^^2
"BLD",8207,"KRN",19,"NM","B","OR BCMA ORDER COM",2)

"BLD",8207,"KRN",19,"NM","B","OR CPRS GUI CHART",1)

"BLD",8207,"KRN",19,"NM","B","OR DEBUG REPORT",4)

"BLD",8207,"KRN",19,"NM","B","OR PARAM COORDINATOR MENU",6)

"BLD",8207,"KRN",19,"NM","B","OR PARAM IRM MENU",3)

"BLD",8207,"KRN",19,"NM","B","ORW CLIN IND DATE DFLT",5)

"BLD",8207,"KRN",19.1,0)
19.1
"BLD",8207,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",8207,"KRN",19.1,"NM",1,0)
ORSUPPLY^^0
"BLD",8207,"KRN",19.1,"NM","B","ORSUPPLY",1)

"BLD",8207,"KRN",101,0)
101
"BLD",8207,"KRN",409.61,0)
409.61
"BLD",8207,"KRN",771,0)
771
"BLD",8207,"KRN",779.2,0)
779.2
"BLD",8207,"KRN",870,0)
870
"BLD",8207,"KRN",8989.51,0)
8989.51
"BLD",8207,"KRN",8989.51,"NM",0)
^9.68A^7^5
"BLD",8207,"KRN",8989.51,"NM",1,0)
OR LAB TAB DEFAULT REPORT^^0
"BLD",8207,"KRN",8989.51,"NM",2,0)
OR REPORT DATE SELECT TYPE^^0
"BLD",8207,"KRN",8989.51,"NM",4,0)
ORPARAM OVER DATELINE^^0
"BLD",8207,"KRN",8989.51,"NM",6,0)
ORCDGMRC CLIN IND DATE DEFAULT^^0
"BLD",8207,"KRN",8989.51,"NM",7,0)
OR MOB DLL VERSION^^0
"BLD",8207,"KRN",8989.51,"NM","B","OR LAB TAB DEFAULT REPORT",1)

"BLD",8207,"KRN",8989.51,"NM","B","OR MOB DLL VERSION",7)

"BLD",8207,"KRN",8989.51,"NM","B","OR REPORT DATE SELECT TYPE",2)

"BLD",8207,"KRN",8989.51,"NM","B","ORCDGMRC CLIN IND DATE DEFAULT",6)

"BLD",8207,"KRN",8989.51,"NM","B","ORPARAM OVER DATELINE",4)

"BLD",8207,"KRN",8989.52,0)
8989.52
"BLD",8207,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",8207,"KRN",8994,0)
8994
"BLD",8207,"KRN",8994,"NM",0)
^9.68A^29^14
"BLD",8207,"KRN",8994,"NM",1,0)
ORWDXM1 BLDQRSP^^0
"BLD",8207,"KRN",8994,"NM",9,0)
ORWRP1A RADIO^^0
"BLD",8207,"KRN",8994,"NM",10,0)
ORDEBUG SAVEDESC^^0
"BLD",8207,"KRN",8994,"NM",11,0)
ORDEBUG SAVERPCS^^0
"BLD",8207,"KRN",8994,"NM",19,0)
ORQQCN GET USER AUTH^^0
"BLD",8207,"KRN",8994,"NM",20,0)
ORUTL ISCLORD^^0
"BLD",8207,"KRN",8994,"NM",21,0)
ORWU OVERDL^^0
"BLD",8207,"KRN",8994,"NM",22,0)
ORBCMA5 LOCK^^0
"BLD",8207,"KRN",8994,"NM",23,0)
ORBCMA5 UNLOCK^^0
"BLD",8207,"KRN",8994,"NM",24,0)
ORBCMA5 JOB^^0
"BLD",8207,"KRN",8994,"NM",25,0)
ORQQPL EDIT LOAD^^0
"BLD",8207,"KRN",8994,"NM",26,0)
ORWPS COVER^^0
"BLD",8207,"KRN",8994,"NM",28,0)
ORWU MOBAPP^^0
"BLD",8207,"KRN",8994,"NM",29,0)
ORUTL4 DLL^^0
"BLD",8207,"KRN",8994,"NM","B","ORBCMA5 JOB",24)

"BLD",8207,"KRN",8994,"NM","B","ORBCMA5 LOCK",22)

"BLD",8207,"KRN",8994,"NM","B","ORBCMA5 UNLOCK",23)

"BLD",8207,"KRN",8994,"NM","B","ORDEBUG SAVEDESC",10)

"BLD",8207,"KRN",8994,"NM","B","ORDEBUG SAVERPCS",11)

"BLD",8207,"KRN",8994,"NM","B","ORQQCN GET USER AUTH",19)

"BLD",8207,"KRN",8994,"NM","B","ORQQPL EDIT LOAD",25)

"BLD",8207,"KRN",8994,"NM","B","ORUTL ISCLORD",20)

"BLD",8207,"KRN",8994,"NM","B","ORUTL4 DLL",29)

"BLD",8207,"KRN",8994,"NM","B","ORWDXM1 BLDQRSP",1)

"BLD",8207,"KRN",8994,"NM","B","ORWPS COVER",26)

"BLD",8207,"KRN",8994,"NM","B","ORWRP1A RADIO",9)

"BLD",8207,"KRN",8994,"NM","B","ORWU MOBAPP",28)

"BLD",8207,"KRN",8994,"NM","B","ORWU OVERDL",21)

"BLD",8207,"KRN","B",.4,.4)

"BLD",8207,"KRN","B",.401,.401)

"BLD",8207,"KRN","B",.402,.402)

"BLD",8207,"KRN","B",.403,.403)

"BLD",8207,"KRN","B",.5,.5)

"BLD",8207,"KRN","B",.84,.84)

"BLD",8207,"KRN","B",3.6,3.6)

"BLD",8207,"KRN","B",3.8,3.8)

"BLD",8207,"KRN","B",9.2,9.2)

"BLD",8207,"KRN","B",9.8,9.8)

"BLD",8207,"KRN","B",19,19)

"BLD",8207,"KRN","B",19.1,19.1)

"BLD",8207,"KRN","B",101,101)

"BLD",8207,"KRN","B",409.61,409.61)

"BLD",8207,"KRN","B",771,771)

"BLD",8207,"KRN","B",779.2,779.2)

"BLD",8207,"KRN","B",870,870)

"BLD",8207,"KRN","B",8989.51,8989.51)

"BLD",8207,"KRN","B",8989.52,8989.52)

"BLD",8207,"KRN","B",8994,8994)

"BLD",8207,"PRE")
ORY350E
"BLD",8207,"QUES",0)
^9.62^1^1
"BLD",8207,"QUES",1,0)
POS1
"BLD",8207,"QUES",1,1)
FU^3:50
"BLD",8207,"QUES",1,"A")
Select the report recipient:
"BLD",8207,"QUES",1,"M")
D RECIP^ORY350E K DIR,DIRUT
"BLD",8207,"QUES","B","POS1",1)

"BLD",8207,"REQB",0)
^9.611^41^23
"BLD",8207,"REQB",5,0)
OR*3.0*322^2
"BLD",8207,"REQB",11,0)
OR*3.0*348^2
"BLD",8207,"REQB",13,0)
OR*3.0*318^2
"BLD",8207,"REQB",15,0)
OR*3.0*312^2
"BLD",8207,"REQB",16,0)
OR*3.0*349^2
"BLD",8207,"REQB",17,0)
TIU*1.0*268^2
"BLD",8207,"REQB",19,0)
PSJ*5.0*307^2
"BLD",8207,"REQB",20,0)
OR*3.0*311^2
"BLD",8207,"REQB",22,0)
PSJ*5.0*267^2
"BLD",8207,"REQB",23,0)
OR*3.0*374^2
"BLD",8207,"REQB",25,0)
OR*3.0*366^2
"BLD",8207,"REQB",26,0)
GMPL*2.0*45^2
"BLD",8207,"REQB",28,0)
OR*3.0*363^2
"BLD",8207,"REQB",30,0)
OR*3.0*356^2
"BLD",8207,"REQB",31,0)
OR*3.0*317^2
"BLD",8207,"REQB",32,0)
LEX*2.0*86^2
"BLD",8207,"REQB",34,0)
OR*3.0*341^2
"BLD",8207,"REQB",36,0)
OR*3.0*388^2
"BLD",8207,"REQB",37,0)
OR*3.0*394^2
"BLD",8207,"REQB",38,0)
OR*3.0*392^2
"BLD",8207,"REQB",39,0)
OR*3.0*389^2
"BLD",8207,"REQB",40,0)
OR*3.0*157^2
"BLD",8207,"REQB",41,0)
OR*3.0*418^2
"BLD",8207,"REQB","B","GMPL*2.0*45",26)

"BLD",8207,"REQB","B","LEX*2.0*86",32)

"BLD",8207,"REQB","B","OR*3.0*157",40)

"BLD",8207,"REQB","B","OR*3.0*311",20)

"BLD",8207,"REQB","B","OR*3.0*312",15)

"BLD",8207,"REQB","B","OR*3.0*317",31)

"BLD",8207,"REQB","B","OR*3.0*318",13)

"BLD",8207,"REQB","B","OR*3.0*322",5)

"BLD",8207,"REQB","B","OR*3.0*341",34)

"BLD",8207,"REQB","B","OR*3.0*348",11)

"BLD",8207,"REQB","B","OR*3.0*349",16)

"BLD",8207,"REQB","B","OR*3.0*356",30)

"BLD",8207,"REQB","B","OR*3.0*363",28)

"BLD",8207,"REQB","B","OR*3.0*366",25)

"BLD",8207,"REQB","B","OR*3.0*374",23)

"BLD",8207,"REQB","B","OR*3.0*388",36)

"BLD",8207,"REQB","B","OR*3.0*389",39)

"BLD",8207,"REQB","B","OR*3.0*392",38)

"BLD",8207,"REQB","B","OR*3.0*394",37)

"BLD",8207,"REQB","B","OR*3.0*418",41)

"BLD",8207,"REQB","B","PSJ*5.0*267",22)

"BLD",8207,"REQB","B","PSJ*5.0*307",19)

"BLD",8207,"REQB","B","TIU*1.0*268",17)

"DATA",100.9,73,0)
OP NON-RENEWABLE RX RENEWAL^OR^Non-Renewable Rx Renewal Request^PKG^R^INDORDER^ORB3FUP1
"DATA",100.9,73,1)
^OR
"DATA",100.9,73,4)
This notification is triggered when an automated process (for example, AudioCARE) submits a request to renew an outpatient prescription for a non-renewable drug. The follow-up action displays the order that is non-renewable.
"DATA",100.9,73,5,0)
^100.92S^1^1
"DATA",100.9,73,5,1,0)
ONPP
"DATA",100.9,78,0)
LAPSED UNSIGNED ORDER^OR^Lapsed Unsigned Order(s)^PKG^R^INDORDER^ORB3FUP1
"DATA",100.9,78,1)
^OR
"DATA",100.9,78,4)
This notification is triggered when one or more unsigned orders are lapsed for a patient. The follow-up action displays the orders that were lapsed to the user.
"DATA",100.9,78,5,0)
^100.92S^2^2
"DATA",100.9,78,5,1,0)
ONPP
"DATA",100.9,78,5,2,0)
CD
"DATA",101.24,31,0)
ORCV ACTIVE MEDICATIONS^40^^^ORWPS^COVER^^C^1^1^^S^423^^^35^2,4^39
"DATA",101.24,31,2)
1^^Active Medications^^MEDS
"DATA",101.24,1004,0)
ORRPW DISCHARGE SUMMARY^OR_DS^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^TIUDCS^ORDV04^57
"DATA",101.24,1004,2)
^^Discharge Summary^Discharge Summary^^HSTYPEB^ORWRPP1^TDCS^ORDV04
"DATA",101.24,1004,3,0)
^101.243^11^9
"DATA",101.24,1004,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1004,3,2,0)
Admitted Date/Time^^3^^^18^1^Admitted^2
"DATA",101.24,1004,3,3,0)
Discharged Date/Time^^4^^^18^1^Discharged^2
"DATA",101.24,1004,3,4,0)
Author / Dictated By^^5^^^10^1
"DATA",101.24,1004,3,5,0)
Approved By        ^^6^^^12^1^Approved By
"DATA",101.24,1004,3,6,0)
Current Status^^7^^^10^1^Status
"DATA",101.24,1004,3,9,0)
ID^1^2
"DATA",101.24,1004,3,10,0)
Summary^1^8^1^1^^1
"DATA",101.24,1004,3,11,0)
[+]^0^9
"DATA",101.24,1004,4)
3:5^^^^^^^1
"DATA",101.24,1006,0)
ORRPW RADIOLOGY IMAGING^OR_R18^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^RIM^ORDV08
"DATA",101.24,1006,2)
^^Imaging^Imaging^^^^IGET^ORDV08
"DATA",101.24,1006,3,0)
^101.243^11^10
"DATA",101.24,1006,3,1,0)
Facility^^1
"DATA",101.24,1006,3,3,0)
Procedure Date/Time     ^^3^^^^^^2
"DATA",101.24,1006,3,4,0)
Procedure Name^^4
"DATA",101.24,1006,3,5,0)
Case #^^6^^^^^^1
"DATA",101.24,1006,3,6,0)
ID^1^2
"DATA",101.24,1006,3,7,0)
Report Status^^5
"DATA",101.24,1006,3,8,0)
[+]^^8
"DATA",101.24,1006,3,9,0)
Detailed Report^1^7^1^1^^1
"DATA",101.24,1006,3,10,0)
Images available?^1^9
"DATA",101.24,1006,3,11,0)
Identifier^1^10^0^0^^0^^0
"DATA",101.24,1006,4)
3:4
"DATA",101.24,1007,0)
ORRPW PROCEDURES^OR_MEDP^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^MPRO^ORDV08
"DATA",101.24,1007,2)
^^Procedures^Procedures^^^^MGET^ORDV08
"DATA",101.24,1007,3,0)
^101.243^7^7
"DATA",101.24,1007,3,1,0)
Facility^^1
"DATA",101.24,1007,3,2,0)
Procedure Date/Time^^3^^1^20^1^^2
"DATA",101.24,1007,3,3,0)
Medicine Procedure Name     ^^4^^1^20^1^Procedure Name
"DATA",101.24,1007,3,4,0)
ID^1^2
"DATA",101.24,1007,3,5,0)
Summary^^5^^1^^1
"DATA",101.24,1007,3,6,0)
[+]^^7
"DATA",101.24,1007,3,7,0)
Detailed Report^1^6^1^1^^1
"DATA",101.24,1018,0)
ORRPW ADT DEMO^OR_DEM^1^^^^^R^^^^M^^^^^^^^^6
"DATA",101.24,1018,2)
^^Patient Information^Patient Information^^HSTYPEB^ORWRPP1
"DATA",101.24,1018,10,0)
^101.241P^3^3
"DATA",101.24,1018,10,1,0)
1033
"DATA",101.24,1018,10,2,0)
1034
"DATA",101.24,1018,10,3,0)
1035
"DATA",101.24,1020,0)
ORRPW DIET^OR_DIET^1^^^^^R^^^^M
"DATA",101.24,1020,2)
^^Dietetics^Dietetics^^HSTYPEB^ORWRPP1
"DATA",101.24,1020,10,0)
^101.241P^7^7
"DATA",101.24,1020,10,1,0)
1046
"DATA",101.24,1020,10,2,0)
1047
"DATA",101.24,1020,10,3,0)
1048
"DATA",101.24,1020,10,4,0)
1049
"DATA",101.24,1020,10,5,0)
1050
"DATA",101.24,1020,10,6,0)
4
"DATA",101.24,1020,10,7,0)
8
"DATA",101.24,1021,0)
ORRPW LAB^OR_LAB^1^^^^^R^^^^M
"DATA",101.24,1021,2)
^^Laboratory^Laboratory
"DATA",101.24,1021,10,0)
^101.241P^8^8
"DATA",101.24,1021,10,1,0)
1051
"DATA",101.24,1021,10,2,0)
1052
"DATA",101.24,1021,10,3,0)
2
"DATA",101.24,1021,10,4,0)
3
"DATA",101.24,1021,10,5,0)
1114
"DATA",101.24,1021,10,6,0)
1113
"DATA",101.24,1021,10,7,0)
1055
"DATA",101.24,1021,10,8,0)
1054
"DATA",101.24,1022,0)
ORRPW MEDICINE/CP^OR_MED^1^^^^^R^^^^M
"DATA",101.24,1022,2)
^^Medicine/CP^Medicine/CP^^HSTYPEB^ORWRPP1
"DATA",101.24,1022,10,0)
^101.241P^6^6
"DATA",101.24,1022,10,1,0)
1061
"DATA",101.24,1022,10,2,0)
1062
"DATA",101.24,1022,10,3,0)
1063
"DATA",101.24,1022,10,4,0)
1064
"DATA",101.24,1022,10,5,0)
9
"DATA",101.24,1022,10,6,0)
1007
"DATA",101.24,1023,0)
ORRPW ORDERS MENU^OR_MENU^^^^^^R^^^^M
"DATA",101.24,1023,2)
^^Orders^Orders
"DATA",101.24,1023,10,0)
^101.241P^4^4
"DATA",101.24,1023,10,1,0)
1100
"DATA",101.24,1023,10,2,0)
10
"DATA",101.24,1023,10,3,0)
11
"DATA",101.24,1023,10,4,0)
12
"DATA",101.24,1024,0)
ORRPW PCE^OR_PCE^1^^^^^R^^^^M
"DATA",101.24,1024,2)
^^Outpatient Encounters / GAF Scores ^Outpatient Encounters / GAF Scores ^^HSTYPEB^ORWRPP1
"DATA",101.24,1024,10,0)
^101.241P^11^10
"DATA",101.24,1024,10,1,0)
1066
"DATA",101.24,1024,10,2,0)
1067
"DATA",101.24,1024,10,3,0)
1076
"DATA",101.24,1024,10,4,0)
1068
"DATA",101.24,1024,10,5,0)
1069
"DATA",101.24,1024,10,6,0)
1070
"DATA",101.24,1024,10,8,0)
1072
"DATA",101.24,1024,10,9,0)
1073
"DATA",101.24,1024,10,10,0)
1074
"DATA",101.24,1024,10,11,0)
1077
"DATA",101.24,1025,0)
ORRPW PHARMACY^OR_PH^1^^^^^R^^^^M
"DATA",101.24,1025,2)
^^Pharmacy^Pharmacy
"DATA",101.24,1025,10,0)
^101.241P^10^10
"DATA",101.24,1025,10,1,0)
1558
"DATA",101.24,1025,10,2,0)
1078
"DATA",101.24,1025,10,3,0)
1079
"DATA",101.24,1025,10,4,0)
13
"DATA",101.24,1025,10,5,0)
1080
"DATA",101.24,1025,10,6,0)
1081
"DATA",101.24,1025,10,7,0)
1082
"DATA",101.24,1025,10,8,0)
44
"DATA",101.24,1025,10,9,0)
43
"DATA",101.24,1025,10,10,0)
1555
"DATA",101.24,1026,0)
ORRPW PROBLEM LIST^OR_PL^1^^^^^R^^^^M
"DATA",101.24,1026,2)
^^Problem List^Problem List^^HSTYPEB^ORWRPP1
"DATA",101.24,1026,10,0)
^101.241P^3^3
"DATA",101.24,1026,10,1,0)
1083
"DATA",101.24,1026,10,2,0)
1084
"DATA",101.24,1026,10,3,0)
1085
"DATA",101.24,1027,0)
ORRPW RADIOLOGY^OR_RAD^1^^^^^R^^^^M
"DATA",101.24,1027,2)
^^Radiology^Radiology
"DATA",101.24,1027,10,0)
^101.241P^4^4
"DATA",101.24,1027,10,1,0)
1091
"DATA",101.24,1027,10,2,0)
1092
"DATA",101.24,1027,10,3,0)
6
"DATA",101.24,1027,10,4,0)
1006
"DATA",101.24,1028,0)
ORRPW SURGERY^OR_SR^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^SR^ORDV04^23
"DATA",101.24,1028,2)
^^Surgery Reports^Surgery Reports
"DATA",101.24,1028,3,0)
^101.243^14^14
"DATA",101.24,1028,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1028,3,2,0)
Date of Operation^^3^^1^18^1^^2
"DATA",101.24,1028,3,3,0)
Surgical Specialty^^5^^^12^1
"DATA",101.24,1028,3,4,0)
Surgeon^^6^^0^12^1
"DATA",101.24,1028,3,5,0)
Status^^7^^0^8^1
"DATA",101.24,1028,3,6,0)
Pre-op Diag(s)^^8^^1^12^1
"DATA",101.24,1028,3,7,0)
Post-op Diag(s)^^9^^1^12^1
"DATA",101.24,1028,3,8,0)
Operative Procedure(s)^^4^^1^18^1
"DATA",101.24,1028,3,9,0)
Lab Work^^10^^^8^1
"DATA",101.24,1028,3,10,0)
Dictation Time^^11^^^18^1
"DATA",101.24,1028,3,11,0)
Transcription Time^^12^^^18^1
"DATA",101.24,1028,3,12,0)
Surgeon's Dictation^^13^1^1^^1
"DATA",101.24,1028,3,13,0)
ID^1^2
"DATA",101.24,1028,3,14,0)
[+]^^14
"DATA",101.24,1028,4)
3:4
"DATA",101.24,1029,0)
ORRPW VITALS^OR_VS^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^VS^ORDV04^47
"DATA",101.24,1029,2)
^^Vital Signs^Vital Signs^^^^EN1^GMVHS
"DATA",101.24,1029,3,0)
^101.243^18^18
"DATA",101.24,1029,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1029,3,2,0)
Measurement Date/Time^^3^^^18^1^^2
"DATA",101.24,1029,3,3,0)
TEMP^^4^^^5^1^^1
"DATA",101.24,1029,3,4,0)
PULSE^^5^^^5^1^^1
"DATA",101.24,1029,3,5,0)
RESP^^6^^^5^1^^1
"DATA",101.24,1029,3,6,0)
Blood Pressure^^7^^^12^1^Pressure
"DATA",101.24,1029,3,7,0)
Height^^8^^^6^1^^1
"DATA",101.24,1029,3,8,0)
Weight^^9^^^6^1^^1
"DATA",101.24,1029,3,9,0)
ID^1^2
"DATA",101.24,1029,3,10,0)
Pain^^10^^^6
"DATA",101.24,1029,3,11,0)
POx^^11^^^6
"DATA",101.24,1029,3,12,0)
CVP^^12^^^6
"DATA",101.24,1029,3,13,0)
C/G^^13^^^6
"DATA",101.24,1029,3,14,0)
Flow Rate (l/min)^1^14^^1^6^1^Rate l/min
"DATA",101.24,1029,3,15,0)
O2 Concentration (%)^1^15^^1^6^1^O2 %
"DATA",101.24,1029,3,16,0)
Qualifiers^1^16^^1^20^1^Qualif
"DATA",101.24,1029,3,17,0)
BMI^1^17^^1^6^1^BMI
"DATA",101.24,1029,3,18,0)
Units^1^18^^1^20^1^Units
"DATA",101.24,1029,4)
3:0^^^^^^^1
"DATA",101.24,1030,0)
ORRPW PN^OR_PNMN^1^^^^^R^^^^M
"DATA",101.24,1030,2)
^^Progress Notes^Progress Notes
"DATA",101.24,1030,10,0)
^101.241P^4^4
"DATA",101.24,1030,10,1,0)
1086
"DATA",101.24,1030,10,2,0)
1087
"DATA",101.24,1030,10,3,0)
1088
"DATA",101.24,1030,10,4,0)
1089
"DATA",101.24,1031,0)
ORRPW REPORT CATEGORIES^OR_RPT^^^^^^R^^^^M
"DATA",101.24,1031,2)
^^Clinical Reports^Clinical Reports
"DATA",101.24,1031,10,0)
^101.241P^18^17
"DATA",101.24,1031,10,1,0)
1032
"DATA",101.24,1031,10,2,0)
1018
"DATA",101.24,1031,10,3,0)
1101
"DATA",101.24,1031,10,4,0)
1045
"DATA",101.24,1031,10,6,0)
1020
"DATA",101.24,1031,10,7,0)
1004
"DATA",101.24,1031,10,8,0)
1021
"DATA",101.24,1031,10,9,0)
1022
"DATA",101.24,1031,10,10,0)
1023
"DATA",101.24,1031,10,11,0)
1024
"DATA",101.24,1031,10,12,0)
1025
"DATA",101.24,1031,10,13,0)
1026
"DATA",101.24,1031,10,14,0)
1030
"DATA",101.24,1031,10,15,0)
1027
"DATA",101.24,1031,10,16,0)
1028
"DATA",101.24,1031,10,17,0)
1029
"DATA",101.24,1031,10,18,0)
1604
"DATA",101.24,1032,0)
ORRPW ALLERGIES ADV^OR_BADR^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^ADR^ORDV01^73
"DATA",101.24,1032,2)
^^Allergies^Allergies^^^^^GMRADPT
"DATA",101.24,1032,3,0)
^101.243^8^8
"DATA",101.24,1032,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1032,3,2,0)
Allergy Type^^4^^0^10^1
"DATA",101.24,1032,3,3,0)
Allergy Reactant^^3^^0^20^1^Reactant
"DATA",101.24,1032,3,4,0)
Verification Date/Time^^5^^0^18^1^^2
"DATA",101.24,1032,3,5,0)
Observed/Historical^^6^^^13^1^Observed/Hist
"DATA",101.24,1032,3,6,0)
ID^1^2
"DATA",101.24,1032,3,7,0)
Comments^1^7^1^1^^1
"DATA",101.24,1032,3,8,0)
Allergy IEN^1^8^0^0^^0^^0
"DATA",101.24,1032,4)
5:3^^^^^^^1
"DATA",101.24,1033,0)
ORRPW ADT DEMOG^OR_DEMG^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^DEM^ORDV07^6
"DATA",101.24,1033,2)
^^Demographics^Demographics^^HSTYPEB^ORWRPP1
"DATA",101.24,1033,3,0)
^101.243^26^16
"DATA",101.24,1033,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1033,3,2,0)
Patient Name     ^^3^^^20^1^Name
"DATA",101.24,1033,3,3,0)
Social Security #^^4^^^11^1^SSN
"DATA",101.24,1033,3,4,0)
Gender^^5^^^4^1^SEX
"DATA",101.24,1033,3,5,0)
Date of Birth^^6^^^12^1^DOB
"DATA",101.24,1033,3,6,0)
Religion^^7
"DATA",101.24,1033,3,9,0)
Marital status^^8
"DATA",101.24,1033,3,10,0)
Home phone^^9
"DATA",101.24,1033,3,11,0)
Home Address^^10^1^1^^1
"DATA",101.24,1033,3,12,0)
Race^^11^1^1
"DATA",101.24,1033,3,13,0)
Ethnicity^^12^1^1
"DATA",101.24,1033,3,17,0)
Next of kin^^13
"DATA",101.24,1033,3,18,0)
Relationship^^14
"DATA",101.24,1033,3,19,0)
NOK Address^^15^1^1
"DATA",101.24,1033,3,25,0)
Sensitive^^16
"DATA",101.24,1033,3,26,0)
ID^1^2
"DATA",101.24,1034,0)
ORRPW ADT INS^OR_INS^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^INS^ORDV07
"DATA",101.24,1034,2)
^^Insurance^Insurance^^HSTYPEB^ORWRPP1
"DATA",101.24,1034,3,0)
^101.243^8^8
"DATA",101.24,1034,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1034,3,2,0)
Insurance Company^^3^^^^1
"DATA",101.24,1034,3,3,0)
Policy Type^^4^^^^1
"DATA",101.24,1034,3,4,0)
Group #^^5^^^10^1
"DATA",101.24,1034,3,5,0)
Holder^^6^^^10^1
"DATA",101.24,1034,3,6,0)
ID^1^2
"DATA",101.24,1034,3,7,0)
Effective Date^^7^^^18^1^^2
"DATA",101.24,1034,3,8,0)
Expiration Date^^8^^^18^1^^2
"DATA",101.24,1034,4)
7:3
"DATA",101.24,1035,0)
ORRPW ADT DISAB^OR_ADS^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^24
"DATA",101.24,1035,2)
^^Disabilities^Disabilities^^HSTYPEB^ORWRPP1
"DATA",101.24,1036,0)
ORRPW ADT ADM DC^OR_ADC^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^10
"DATA",101.24,1036,2)
^^Adm./Discharge^Adm./Discharge^^HSTYPEB^ORWRPP1
"DATA",101.24,1037,0)
ORRPW ADT EXP^OR_EADT^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^64
"DATA",101.24,1037,2)
^^Expanded ADT^Expanded ADT^^HSTYPEB^ORWRPP1
"DATA",101.24,1037,4)
^^ADT^^^^^1
"DATA",101.24,1038,0)
ORRPW ADT DC DIAG^OR_DD^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^11
"DATA",101.24,1038,2)
^^Discharge Diagnosis^Discharge Diagnosis^^HSTYPEB^ORWRPP1
"DATA",101.24,1039,0)
ORRPW ADT DISC^OR_DC^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^8
"DATA",101.24,1039,2)
^^Discharges^Discharges^^HSTYPEB^ORWRPP1
"DATA",101.24,1040,0)
ORRPW ADT FUTURE CLINIC^OR_CVF^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^9
"DATA",101.24,1040,2)
^^Future Clinic Visits^Future Clinic Visits^^HSTYPEB^ORWRPP1
"DATA",101.24,1041,0)
ORRPW ADT ICD PROC^OR_PRC^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^PRC^ORDV07^50
"DATA",101.24,1041,2)
^^ICD Procedures^ICD Procedures^^HSTYPEB^ORWRPP1
"DATA",101.24,1041,3,0)
^101.243^5^5
"DATA",101.24,1041,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1041,3,2,0)
Procedure Date^^3^^^18^1^^2
"DATA",101.24,1041,3,3,0)
ICD Procedure^^4^^^15^1
"DATA",101.24,1041,3,4,0)
Code^^5^^^10^1
"DATA",101.24,1041,3,5,0)
ID^1^2
"DATA",101.24,1041,4)
3:4
"DATA",101.24,1042,0)
ORRPW ADT ICD SURG^OR_OPC^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^ICDSUR^ORDV07^12
"DATA",101.24,1042,2)
^^ICD Surgeries^ICD Surgeries^^HSTYPEB^ORWRPP1
"DATA",101.24,1042,3,0)
^101.243^5^5
"DATA",101.24,1042,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1042,3,2,0)
Surgery Date^^3^^^18^1^^2
"DATA",101.24,1042,3,3,0)
ICD Surgery^^4^^^15^1
"DATA",101.24,1042,3,4,0)
ICD Code^^5^^^10^1
"DATA",101.24,1042,3,5,0)
ID^1^2
"DATA",101.24,1042,4)
3:4
"DATA",101.24,1043,0)
ORRPW ADT TRANSFERS^OR_TR^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^16
"DATA",101.24,1043,2)
^^Transfers^Transfers^^HSTYPEB^ORWRPP1
"DATA",101.24,1044,0)
ORRPW ADT TREATING SPEC^OR_TS^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^17
"DATA",101.24,1044,2)
^^Treating Specialty^Treating Specialty^^HSTYPEB^ORWRPP1
"DATA",101.24,1045,0)
ORRPW COMP^OR_CP^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^65
"DATA",101.24,1045,2)
^^Comp & Pen Exams^Comp & Pen Exams^^HSTYPEB^ORWRPP1
"DATA",101.24,1046,0)
ORRPW DIET GEN^OR_DI1^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^7
"DATA",101.24,1046,2)
^^Generic^Diet Generic^^HSTYPEB^ORWRPP1
"DATA",101.24,1047,0)
ORRPW DIET DIET^OR_DI^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^DIETA^ORDV07^7
"DATA",101.24,1047,2)
^^Diet^Diet^^HSTYPEB^ORWRPP1
"DATA",101.24,1047,3,0)
^101.243^7^7
"DATA",101.24,1047,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1047,3,2,0)
Beginning Date/Time^^3^^0^18^1^^2
"DATA",101.24,1047,3,3,0)
Ending Date/Time^^4^^^18^1^^2
"DATA",101.24,1047,3,4,0)
Diet               ^^5^^0^12^1^Diet
"DATA",101.24,1047,3,5,0)
Comment                       ^0^6^^0^^1^Comment
"DATA",101.24,1047,3,6,0)
Tray^^7^^^5^1
"DATA",101.24,1047,3,7,0)
ID^1^2
"DATA",101.24,1047,4)
3:5
"DATA",101.24,1048,0)
ORRPW DIET NUTR^OR_DI2^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^DIETN^ORDV07
"DATA",101.24,1048,2)
^^Nutritional Status^Diet Nutritional Status^^HSTYPEB^ORWRPP1
"DATA",101.24,1048,3,0)
^101.243^4^4
"DATA",101.24,1048,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1048,3,2,0)
Status Date/time^^3^^^18^1^^2
"DATA",101.24,1048,3,3,0)
Status^^4^^^10^1
"DATA",101.24,1048,3,4,0)
ID^1^2
"DATA",101.24,1048,4)
3:0
"DATA",101.24,1049,0)
ORRPW DIET SUPP^OR_DI3^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^DIETS^ORDV07
"DATA",101.24,1049,2)
^^Supp. Feedings^Diet Supp. Feedings^^HSTYPEB^ORWRPP1
"DATA",101.24,1049,3,0)
^101.243^7^7
"DATA",101.24,1049,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1049,3,2,0)
Date/time Ordered^^3^^^^1^^2
"DATA",101.24,1049,3,3,0)
Date/time Cancelled^^5^^^^1^^2
"DATA",101.24,1049,3,4,0)
10 am Feeding^^4^^^15^1
"DATA",101.24,1049,3,5,0)
2 pm Feeding^^6^^^^1
"DATA",101.24,1049,3,6,0)
8 pm Feeding^^8^^^^1
"DATA",101.24,1049,3,7,0)
ID^1^2
"DATA",101.24,1049,4)
3:0
"DATA",101.24,1050,0)
ORRPW DIET TUBE^OR_DI4^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^DIETT^ORDV07
"DATA",101.24,1050,2)
^^Tube Feeding^Diet Tube Feeding^^HSTYPEB^ORWRPP1
"DATA",101.24,1050,3,0)
^101.243^10^10
"DATA",101.24,1050,3,1,0)
Facility^^1^^^^1
"DATA",101.24,1050,3,2,0)
Date/Time Ordered^^3^^0^18^1^Ordered^2
"DATA",101.24,1050,3,3,0)
Date/Time Cancelled^^4^^0^18^1^Cancelled^2
"DATA",101.24,1050,3,4,0)
Product            ^^5^^0^^1^Product
"DATA",101.24,1050,3,5,0)
Strength^^6^^0^^1
"DATA",101.24,1050,3,6,0)
Quantity^^7^^0^^1
"DATA",101.24,1050,3,7,0)
Daily CC's^^8^^0^12^1
"DATA",101.24,1050,3,8,0)
Daily KCal's^^9^^0^12^1
"DATA",101.24,1050,3,9,0)
Comment^^10^^0^^1
"DATA",101.24,1050,3,10,0)
ID^1^2
"DATA",101.24,1050,4)
3:5
"DATA",101.24,1051,0)
ORRPW LAB BLOOD AV^OR_BA^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^45
"DATA",101.24,1051,2)
^^Blood Availability^Blood Availability^^HSTYPEB^ORWRPP1
"DATA",101.24,1052,0)
ORRPW LAB BLOOD TR^OR_BT^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^36
"DATA",101.24,1052,2)
^^Blood Transfusion^Blood Transfusion^^HSTYPEB^ORWRPP1
"DATA",101.24,1052,3,0)
^101.243^5^5
"DATA",101.24,1052,3,1,0)
Facility^^1
"DATA",101.24,1052,3,2,0)
Date of Transfusion^^3^^^^^^2
"DATA",101.24,1052,3,3,0)
No of Unit(s)^^4
"DATA",101.24,1052,3,4,0)
Blood Product^^5^^^20^1
"DATA",101.24,1052,3,5,0)
ID^1^2
"DATA",101.24,1052,4)
3:5
"DATA",101.24,1054,0)
ORRPW LAB MICRO^OR_MIC^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^MI^ORDV05^38
"DATA",101.24,1054,2)
^^Microbiology^Microbiology^^^^GET^ORDV05E
"DATA",101.24,1054,3,0)
^101.243^10^9
"DATA",101.24,1054,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1054,3,2,0)
ID^1^2
"DATA",101.24,1054,3,3,0)
Collection Date/Time^^3^^0^18^1^^2
"DATA",101.24,1054,3,4,0)
Specimen^^6^^^10^1
"DATA",101.24,1054,3,5,0)
Microbiology Test Name     ^^4^^0^15^1^Test
"DATA",101.24,1054,3,7,0)
Accession #   ^^7^^^16^1^Accession #
"DATA",101.24,1054,3,8,0)
Collection Sample^^5^^0^12^1^Sample
"DATA",101.24,1054,3,9,0)
Report^1^8^1^1^^1
"DATA",101.24,1054,3,10,0)
[+]^^9
"DATA",101.24,1054,4)
3:4^^^^^^^1
"DATA",101.24,1055,0)
ORRPW LAB CHEM^OR_CH^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^CH^ORDV02^3
"DATA",101.24,1055,2)
^^Chem & Hematology^Chem & Hematology^^^^^GMTSLRCE
"DATA",101.24,1055,3,0)
^101.243^13^12
"DATA",101.24,1055,3,1,0)
Facility^^1
"DATA",101.24,1055,3,2,0)
Collection Date/Time^^3^^1^17^1^^2
"DATA",101.24,1055,3,3,0)
Specimen^^5^^1^8^1
"DATA",101.24,1055,3,5,0)
Result     ^^6^^1^7^1^Result^1
"DATA",101.24,1055,3,6,0)
Flag^^7^^^4^1
"DATA",101.24,1055,3,7,0)
Units^^8^^^7^1
"DATA",101.24,1055,3,8,0)
Ref Low^^9^^^7^1^Low^1
"DATA",101.24,1055,3,9,0)
Ref High^^10^^^7^1^High^1
"DATA",101.24,1055,3,10,0)
ID^1^2
"DATA",101.24,1055,3,11,0)
Comments^0^11^1^1^^1
"DATA",101.24,1055,3,12,0)
Test Name              ^^4^^1^7^1^Test
"DATA",101.24,1055,3,13,0)
[+]^^12
"DATA",101.24,1055,4)
3:4^^^^^^^1
"DATA",101.24,1056,0)
ORRPW LAB EM^OR_EM^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^EM^ORDV02A
"DATA",101.24,1056,2)
^^Electron Microscopy^Electron Microscopy^^^^XEM^ORDVX1
"DATA",101.24,1056,3,0)
^101.243^7^7
"DATA",101.24,1056,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1056,3,2,0)
ID^1^2
"DATA",101.24,1056,3,3,0)
Collection Date^^3^^0^18^0^^2
"DATA",101.24,1056,3,4,0)
Specimen^^4^1^0^10^0^Specimen
"DATA",101.24,1056,3,5,0)
Accession #^^5^^^16^1^Accession #
"DATA",101.24,1056,3,6,0)
Report^1^6^1^1^^1^    
"DATA",101.24,1056,3,7,0)
[+]^^7
"DATA",101.24,1057,0)
ORRPW LAB ORDERS^OR_LO^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^LO^ORDV02^32
"DATA",101.24,1057,2)
^^Lab Orders^Lab Orders^^^^^GMTSLROE
"DATA",101.24,1057,3,0)
^101.243^14^14
"DATA",101.24,1057,3,1,0)
Collection Date/Time^^3^^^18^1^^2
"DATA",101.24,1057,3,2,0)
Test Name               ^^4^^^12^1^Test
"DATA",101.24,1057,3,3,0)
Test ien^1^5
"DATA",101.24,1057,3,4,0)
Specimen^^6^^^3^1^Spec
"DATA",101.24,1057,3,5,0)
Specimen ien^1^7
"DATA",101.24,1057,3,6,0)
Urgency^^8^^^4^1^Urg
"DATA",101.24,1057,3,7,0)
Provider^^9^^^10^1
"DATA",101.24,1057,3,8,0)
Provider ien^1^10
"DATA",101.24,1057,3,9,0)
Ordered Date/Time^^11^^^18^1^^2
"DATA",101.24,1057,3,10,0)
Accession #^^12^^^16^1^Accession
"DATA",101.24,1057,3,11,0)
Available Date/Time^^13^^^18^1^^2
"DATA",101.24,1057,3,12,0)
Facility^^1^^^10^1
"DATA",101.24,1057,3,13,0)
ID^1^2
"DATA",101.24,1057,3,14,0)
Status^^14^^^6^1
"DATA",101.24,1057,4)
3:4^^^^^^^1
"DATA",101.24,1058,0)
ORRPW LAB SP^OR_SP^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^SP^ORDV02A
"DATA",101.24,1058,2)
^^Surgical Pathology^Surgical Pathology^^^^XSP^ORDVX1
"DATA",101.24,1058,3,0)
^101.243^7^7
"DATA",101.24,1058,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1058,3,2,0)
ID^1^2
"DATA",101.24,1058,3,3,0)
Collection Date^^3^^0^18^0^^2
"DATA",101.24,1058,3,4,0)
Specimen^^4^1^0^10^0^Specimen
"DATA",101.24,1058,3,5,0)
Accession #^^5^^^16^1^Accession #
"DATA",101.24,1058,3,6,0)
Report^1^6^1^1^^1^    
"DATA",101.24,1058,3,7,0)
[+]^^7
"DATA",101.24,1058,4)
3:4
"DATA",101.24,1059,0)
ORRPW LAB CY^OR_CY^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^CY^ORDV02A
"DATA",101.24,1059,2)
^^Cytology^Cytology^^^^XCY^ORDVX1
"DATA",101.24,1059,3,0)
^101.243^7^7
"DATA",101.24,1059,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1059,3,2,0)
ID^1^2
"DATA",101.24,1059,3,3,0)
Collection Date^^3^^0^18^0^^2
"DATA",101.24,1059,3,4,0)
Specimen^^4^1^0^10^0^Specimen
"DATA",101.24,1059,3,5,0)
Accession #^^5^^^16^1^Accession #
"DATA",101.24,1059,3,6,0)
Report^1^6^1^1^^1^    
"DATA",101.24,1059,3,7,0)
[+]^^7
"DATA",101.24,1059,4)
3:4
"DATA",101.24,1060,0)
ORRPW ADT HISTORY^OR_ADT^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^55
"DATA",101.24,1060,2)
^^ADT History^ADT History^^HSTYPEB^ORWRPP1
"DATA",101.24,1061,0)
ORRPW MED AB^OR_MEDA^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^66
"DATA",101.24,1061,2)
^^Abnormal^Medicine abnormal brief^^HSTYPEB^ORWRPP1
"DATA",101.24,1062,0)
ORRPW MED BRIEF^OR_MEDB^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^67
"DATA",101.24,1062,2)
^^Brief Report^Medicine brief report^^HSTYPEB^ORWRPP1
"DATA",101.24,1063,0)
ORRPW MED FULL^OR_MEDC^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^68
"DATA",101.24,1063,2)
^^Full Captioned^Medicine full captioned^^HSTYPEB^ORWRPP1
"DATA",101.24,1064,0)
ORRPW MED FUL REP^OR_MEDF^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^69
"DATA",101.24,1064,2)
^^Full Report^Medicine full report^^HSTYPEB^ORWRPP1
"DATA",101.24,1064,3,0)
^101.243^6^6
"DATA",101.24,1064,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1064,3,2,0)
Date^^3^^^18^1^^2
"DATA",101.24,1064,3,3,0)
Procedure^^4^^^15^1
"DATA",101.24,1064,3,4,0)
Location^^5^^^10^1
"DATA",101.24,1064,3,5,0)
Summary^^7^^^15^1
"DATA",101.24,1064,3,6,0)
ID^1^2
"DATA",101.24,1064,4)
3:4
"DATA",101.24,1065,0)
ORRPW ADT PAST CLINIC^OR_CVP^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^14
"DATA",101.24,1065,2)
^^Past Clinic Visits^Past Clinic Visits^^HSTYPEB^ORWRPP1
"DATA",101.24,1066,0)
ORRPW PCE EDUCATION^OR_ED^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^212
"DATA",101.24,1066,2)
^^Education^PCE Education^^HSTYPEB^ORWRPP1
"DATA",101.24,1067,0)
ORRPW PCE EDUCATION LAT^OR_EDL^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^213
"DATA",101.24,1067,2)
^^Education Latest^PCE Education Latest^^HSTYPEB^ORWRPP1
"DATA",101.24,1068,0)
ORRPW PCE GAF SCORES^OR_PCEG^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^238
"DATA",101.24,1068,2)
^^GAF Scores^PCE GAF Scores^^HSTYPEB^ORWRPP1
"DATA",101.24,1069,0)
ORRPW PCE HEALTH FACT^OR_HF^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^204
"DATA",101.24,1069,2)
^^Health Factors^PCE Health factors all^^HSTYPEB^ORWRPP1
"DATA",101.24,1070,0)
ORRPW PCE IMMUNIZATION^OR_IM^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^207
"DATA",101.24,1070,2)
^^Immunizations^PCE Immunizations^^HSTYPEB^ORWRPP1
"DATA",101.24,1071,0)
ORRPW PCE LOCATION HOME^OR_LH^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^201
"DATA",101.24,1071,2)
^^Location of Home^PCE Location of Home^^HSTYPEB^ORWRPP1
"DATA",101.24,1072,0)
ORRPW PCE OUPT DX^OR_OD^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^220
"DATA",101.24,1072,2)
^^Outpatient Diagnosis^PCE Outpatient Diagnosis^^HSTYPEB^ORWRPP1
"DATA",101.24,1072,4)
^^SADR
"DATA",101.24,1073,0)
ORRPW PCE OUTPT ENCOUNTER^OR_OE^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^205
"DATA",101.24,1073,2)
^^Outpatient Encounter^PCE Outpatient Encounter^^HSTYPEB^ORWRPP1
"DATA",101.24,1073,4)
^^SADR^^^^^1
"DATA",101.24,1074,0)
ORRPW PCE SKIN TEST^OR_ST^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^208
"DATA",101.24,1074,2)
^^Skin Tests^PCE Skin Tests^^HSTYPEB^ORWRPP1
"DATA",101.24,1076,0)
ORRPW PCE EXAM LATEST^OR_EXAM^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^230
"DATA",101.24,1076,2)
^^Exam Latest^PCE Exam Latest^^HSTYPEB^ORWRPP1
"DATA",101.24,1077,0)
ORRPW PCE TREATMENTS PROVIDED^OR_TP^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^231
"DATA",101.24,1077,2)
^^Treatments Provided^PCE Treatments Provided^^HSTYPEB^ORWRPP1
"DATA",101.24,1078,0)
ORRPW PHARMACY ACT OUT^OR_RXA^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^RXA^ORDV06
"DATA",101.24,1078,2)
^^Active Outpatient^Rx Active Outpatient^^^^ACS^PSOHCSUM
"DATA",101.24,1078,3,0)
^101.243^17^17
"DATA",101.24,1078,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1078,3,2,0)
Drug Name                  ^^3^^1^19^1^Drug
"DATA",101.24,1078,3,3,0)
Drug ien^1^4
"DATA",101.24,1078,3,4,0)
RX #     ^^5^^0^10^1^RX #^1
"DATA",101.24,1078,3,5,0)
Status^^6^^^10^0
"DATA",101.24,1078,3,6,0)
Qty^^7^^^5^1^^1
"DATA",101.24,1078,3,7,0)
Exp/Canc Date^^8^^^18^0^^2
"DATA",101.24,1078,3,8,0)
Issue Date    ^^9^^1^18^0^Issue Date^2
"DATA",101.24,1078,3,9,0)
Last Fill Date^^10^^^18^0^^2
"DATA",101.24,1078,3,10,0)
Rem^^11^^^5^1^^1
"DATA",101.24,1078,3,11,0)
Provider^^12^^^12^0
"DATA",101.24,1078,3,12,0)
Cost/Fill^^13^^^10^0^^1
"DATA",101.24,1078,3,13,0)
SIG^^15^^1^10^1
"DATA",101.24,1078,3,14,0)
ID^1^2
"DATA",101.24,1078,3,15,0)
[+]^^14
"DATA",101.24,1078,3,16,0)
Pharmacy ID^1^16^0^0^^0^^0
"DATA",101.24,1078,3,17,0)
Order Number^1^17^0^0^^0^^0
"DATA",101.24,1078,4)
9:3
"DATA",101.24,1079,0)
ORRPW PHARMACY ALL OUT^OR_RXOP^1^6^ORDV01^HSQUERY^1^R^^^^V^224^^^^^^RXOP^ORDV06^28
"DATA",101.24,1079,2)
^^Outpatient Medications^Rx Outpatient Medications^^^^ACS^PSOHCSUM
"DATA",101.24,1079,3,0)
^101.243^17^17
"DATA",101.24,1079,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1079,3,2,0)
Drug Name               ^^3^^1^19^1^Drug
"DATA",101.24,1079,3,3,0)
Drug ien^1^4
"DATA",101.24,1079,3,4,0)
RX #     ^^5^^0^10^1^RX #^1
"DATA",101.24,1079,3,5,0)
Status^^6^^^8^0
"DATA",101.24,1079,3,6,0)
Qty^^7^^^5^1^^1
"DATA",101.24,1079,3,7,0)
Exp/Canc Date^^8^^^18^0^^2
"DATA",101.24,1079,3,8,0)
Issue Date    ^^9^^1^18^0^Issue Date^2
"DATA",101.24,1079,3,9,0)
Last Fill Date^^10^^^18^0^^2
"DATA",101.24,1079,3,10,0)
Rem^^11^^^5^1^^1
"DATA",101.24,1079,3,11,0)
Provider^^12^^^12^0
"DATA",101.24,1079,3,12,0)
Cost/Fill^^13^^^10^0^^1
"DATA",101.24,1079,3,13,0)
SIG^^15^^1^12^1
"DATA",101.24,1079,3,14,0)
ID^1^2
"DATA",101.24,1079,3,15,0)
[+]^^14
"DATA",101.24,1079,3,16,0)
Pharmacy ID^1^16^0^0^^0
"DATA",101.24,1079,3,17,0)
Order Number^1^17^0^0
"DATA",101.24,1079,4)
9:3^^^^^^^1
"DATA",101.24,1080,0)
ORRPW PHARMACY ACTIVE IV^OR_IVA^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^RXAV^ORDV06
"DATA",101.24,1080,2)
^^Active IV^Rx Active IV^^HSTYPEB^ORWRPP1^ENHS^PSJEEU0
"DATA",101.24,1080,3,0)
^101.243^13^9
"DATA",101.24,1080,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1080,3,2,0)
Additives         ^^3^1^1^^1^Additives
"DATA",101.24,1080,3,3,0)
Solutions         ^0^4^1^1^^1^Solutions
"DATA",101.24,1080,3,7,0)
Rate        ^^5^^^10^1^Rate^1
"DATA",101.24,1080,3,9,0)
Start Date/Time^^7^^1^18^1^^2
"DATA",101.24,1080,3,10,0)
Stop Date/Time^^8^^0^18^1^^2
"DATA",101.24,1080,3,11,0)
ID^1^2
"DATA",101.24,1080,3,12,0)
[+]^^9
"DATA",101.24,1080,3,13,0)
Schedule^0^6^1^1^10^1^Schedule^0
"DATA",101.24,1080,4)
3:6
"DATA",101.24,1081,0)
ORRPW PHARMACY IV^OR_RXIV^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^RXIV^ORDV06^30
"DATA",101.24,1081,2)
^^All IV^Rx All IV^^HSTYPEB^ORWRPP1^ENHS^PSJEEU0
"DATA",101.24,1081,3,0)
^101.243^13^9
"DATA",101.24,1081,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1081,3,2,0)
Solutions^^4^1^1^12^1^Solutions
"DATA",101.24,1081,3,3,0)
Additives         ^0^3^1^1^^1^Additives
"DATA",101.24,1081,3,7,0)
Rate        ^^5^^^7^1^Rate^1
"DATA",101.24,1081,3,9,0)
Start Date/Time^^7^^1^18^1^^2
"DATA",101.24,1081,3,10,0)
Stop Date/Time^^8^^0^18^1^^2
"DATA",101.24,1081,3,11,0)
ID^1^2
"DATA",101.24,1081,3,12,0)
[+]^^9
"DATA",101.24,1081,3,13,0)
Schedule^0^6^1^1^10^1^Schedule^0
"DATA",101.24,1081,4)
3:6
"DATA",101.24,1082,0)
ORRPW PHARMACY UNIT DOSE^OR_RXUD^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^RXUD^ORDV06^29
"DATA",101.24,1082,2)
^^Unit Dose^Rx Unit Dose^^HSTYPEB^ORWRPP1^ENHS^PSJEEU0
"DATA",101.24,1082,3,0)
^101.243^10^10
"DATA",101.24,1082,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1082,3,2,0)
Drug Name                        ^^4^^1^19^1^Drug
"DATA",101.24,1082,3,3,0)
Drug ien^1^3
"DATA",101.24,1082,3,4,0)
Status      ^^6^^^8^1^Status
"DATA",101.24,1082,3,5,0)
Start Date/Time  ^^7^^1^18^1^Start Date/Time^2
"DATA",101.24,1082,3,6,0)
Stop Date/Time  ^^8^^^18^1^Stop Date/Time^2
"DATA",101.24,1082,3,7,0)
Route^^9^^^7^1
"DATA",101.24,1082,3,8,0)
SIG^^10^0^1^12^1
"DATA",101.24,1082,3,9,0)
ID^1^2
"DATA",101.24,1082,3,10,0)
Dose        ^^5^^1^8^1^Dose^1
"DATA",101.24,1082,4)
7:4
"DATA",101.24,1083,0)
ORRPW PROBLEM ACTIVE^OR_PLA^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^PLAILA^ORDV04^59
"DATA",101.24,1083,2)
^^Active Problems^Active Problems^^^^PLA^ORDV04
"DATA",101.24,1083,3,0)
^101.243^10^10
"DATA",101.24,1083,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1083,3,2,0)
Status^^3^^^4^1^Stat
"DATA",101.24,1083,3,3,0)
Provider Narrative                  ^^4^^1^20^1^Provider Narrative
"DATA",101.24,1083,3,4,0)
Date of Onset^^5^^1^12^1^Date Onset^2
"DATA",101.24,1083,3,5,0)
Date Modified^^6^^^12^1^^2
"DATA",101.24,1083,3,6,0)
Provider Name    ^^7^^0^12^1^Provider
"DATA",101.24,1083,3,7,0)
Note Narrative^1^8^^1^12^1
"DATA",101.24,1083,3,8,0)
ID^1^2
"DATA",101.24,1083,3,9,0)
[+]^^10
"DATA",101.24,1083,3,10,0)
Exposures^0^9^^1^18^0^Exposures
"DATA",101.24,1083,4)
5:4
"DATA",101.24,1084,0)
ORRPW PROBLEM ALL^OR_PLL^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^PLAILALL^ORDV04^61
"DATA",101.24,1084,2)
^^All Problems^All Problems^^^^PLALL^ORDV04
"DATA",101.24,1084,3,0)
^101.243^10^10
"DATA",101.24,1084,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1084,3,2,0)
Status^^3^^^8^1
"DATA",101.24,1084,3,3,0)
Provider Narrative                  ^^4^^1^15^1^Provider Narrative
"DATA",101.24,1084,3,4,0)
Date of Onset^^5^^1^18^1^^2
"DATA",101.24,1084,3,5,0)
Date Modified^^6^^1^18^1^^2
"DATA",101.24,1084,3,6,0)
Provider Name    ^^7^^0^12^1^Provider
"DATA",101.24,1084,3,7,0)
Note Narrative^1^8^^1^15^1
"DATA",101.24,1084,3,8,0)
ID^1^2
"DATA",101.24,1084,3,9,0)
[+]^^10
"DATA",101.24,1084,3,10,0)
Exposures^0^9^^1^18^0^Exposures
"DATA",101.24,1084,4)
5:4
"DATA",101.24,1085,0)
ORRPW PROBLEM INACTIVE^OR_PLI^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^PLAILI^ORDV04^60
"DATA",101.24,1085,2)
^^Inactive Problems^Inactive Problems^^^^PLI^ORDV04
"DATA",101.24,1085,3,0)
^101.243^10^10
"DATA",101.24,1085,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1085,3,2,0)
Status^^3^^^8^1
"DATA",101.24,1085,3,3,0)
Provider Narrative                  ^^4^^1^15^1^Provider Narrative
"DATA",101.24,1085,3,4,0)
Date of Onset^^5^^1^18^1^^2
"DATA",101.24,1085,3,5,0)
Date Modified^^6^^^18^1^^2
"DATA",101.24,1085,3,6,0)
Provider Name    ^^7^^0^12^1^Provider
"DATA",101.24,1085,3,7,0)
Note Narrative^1^8^^1^15^1
"DATA",101.24,1085,3,8,0)
ID^1^2
"DATA",101.24,1085,3,9,0)
[+]^^10
"DATA",101.24,1085,3,10,0)
Exposures^0^9^^1^18^0^Exposures
"DATA",101.24,1085,4)
5:4
"DATA",101.24,1086,0)
ORRPW PN PROGRESS NOTES^OR_PN^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^TIUPRG^ORDV04^15
"DATA",101.24,1086,2)
^^Progress Notes^Progress Notes^^^^TPRG^ORDV04
"DATA",101.24,1086,3,0)
^101.243^10^9
"DATA",101.24,1086,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1086,3,3,0)
Date/Time of Note^^4^^0^18^1^Date/Time^2
"DATA",101.24,1086,3,4,0)
Type of Note          ^^5^^0^12^1^Type of Note
"DATA",101.24,1086,3,5,0)
Author of Note       ^^6^^0^12^1^Author
"DATA",101.24,1086,3,6,0)
ID^1^2
"DATA",101.24,1086,3,7,0)
IEN^1^3
"DATA",101.24,1086,3,8,0)
Note Text^1^7^1^1^^1
"DATA",101.24,1086,3,9,0)
[+]^^8
"DATA",101.24,1086,3,10,0)
Identifier^1^9^0^0^^0^^0
"DATA",101.24,1086,4)
4:5^^^^^^^1
"DATA",101.24,1087,0)
ORRPW PN ADV DIRECTIVE^OR_CD^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^25
"DATA",101.24,1087,2)
^^Advance Directive^Advance Directive^^HSTYPEB^ORWRPP1
"DATA",101.24,1088,0)
ORRPW PN CLINICAL WARN^OR_CW^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^4
"DATA",101.24,1088,2)
^^Clinical Warnings^Clinical Warnings^^HSTYPEB^ORWRPP1
"DATA",101.24,1089,0)
ORRPW PN CRISIS NOTES^OR_CN^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^5
"DATA",101.24,1089,2)
^^Crisis Notes^Crisis Notes^^HSTYPEB^ORWRPP1
"DATA",101.24,1090,0)
ORRPW RADIOLOGY IMPRESSION^OR_RI^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^RI^ORDV03^52
"DATA",101.24,1090,2)
^^Impression^Radiology Impression^^^^RAD1^ORDV03
"DATA",101.24,1090,3,0)
^101.243^8^8
"DATA",101.24,1090,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1090,3,2,0)
Exam Date/Time   ^^3^^1^18^1^^2
"DATA",101.24,1090,3,3,0)
Procedure Name              ^^4^^1^15^1^Procedure
"DATA",101.24,1090,3,4,0)
Report Status^^5^^^8^1^Status
"DATA",101.24,1090,3,5,0)
CPT Code^^6^^^7^1
"DATA",101.24,1090,3,6,0)
Impression^1^7^1^1^10^1
"DATA",101.24,1090,3,7,0)
ID^1^2
"DATA",101.24,1090,3,8,0)
[+]^^8
"DATA",101.24,1090,4)
3:4
"DATA",101.24,1091,0)
ORRPW RADIOLOGY REPORT^OR_RP^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^RR^ORDV03^35
"DATA",101.24,1091,2)
^^Report^Radiology Report^^^^RAD2^ORDV03
"DATA",101.24,1091,3,0)
^101.243^11^11
"DATA",101.24,1091,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1091,3,2,0)
Exam Date/Time   ^^3^^1^18^1^^2
"DATA",101.24,1091,3,3,0)
Procedure Name                                 ^^4^^1^15^1^Procedure
"DATA",101.24,1091,3,4,0)
Report Status^^5^^^8^1^Status
"DATA",101.24,1091,3,5,0)
CPT Code^^6^^^7^1
"DATA",101.24,1091,3,6,0)
Report^1^10^1^1^12^1
"DATA",101.24,1091,3,7,0)
ID^1^2
"DATA",101.24,1091,3,8,0)
Clinical History^1^8^1^1^12^1
"DATA",101.24,1091,3,9,0)
Impression^1^9^1^1^12^1
"DATA",101.24,1091,3,10,0)
[+]^^11
"DATA",101.24,1091,3,11,0)
Reason for Study^1^7^1^1^12^1
"DATA",101.24,1091,4)
3:4^^^^^^^1
"DATA",101.24,1092,0)
ORRPW RADIOLOGY STATUS^OR_RS^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^RS^ORDV03^34
"DATA",101.24,1092,2)
^^Status^Radiology Status^^HSTYPEB^ORWRPP1^GET^GMTSRAD
"DATA",101.24,1092,3,0)
^101.243^7^7
"DATA",101.24,1092,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1092,3,2,0)
Request Date/Time^^3^^0^18^1^^2
"DATA",101.24,1092,3,3,0)
Status^^4^^^8^1
"DATA",101.24,1092,3,4,0)
Procedure Name                                  ^^5^^0^15^1^Procedure
"DATA",101.24,1092,3,5,0)
Scheduled Date^^6^^^18^1^^2
"DATA",101.24,1092,3,6,0)
Provider Name     ^^7^^^12^1^Provider
"DATA",101.24,1092,3,7,0)
ID^1^2
"DATA",101.24,1092,4)
3:5
"DATA",101.24,1093,0)
ORRP ANATOMIC PATHOLOGY^20^1^^ORWRP1^AP^2^R^^^^R^224
"DATA",101.24,1093,2)
^^Anatomic Pathology - All Reports^Anatomic Pathology - All Reports
"DATA",101.24,1094,0)
ORRP AP EM^24^1^^ORWRP1A^EM^0^R^^^^R^224
"DATA",101.24,1094,2)
^^Electron Microscopy^Electron Microscopy
"DATA",101.24,1095,0)
ORRP AP CY^26^1^^ORWRP1A^CY^0^R^^^^R^224
"DATA",101.24,1095,2)
^^Cytopathology^Cytopathology
"DATA",101.24,1096,0)
ORRP AP SP^25^1^^ORWRP1A^SP^0^R^^^^R^224
"DATA",101.24,1096,2)
^^Surgical Pathology^Surgical Pathology
"DATA",101.24,1097,0)
ORRP AP AU^27^1^^ORWRP1A^AU^0^L^^^^R^224
"DATA",101.24,1097,2)
^^Autopsy^Autopsy
"DATA",101.24,1098,0)
ORRP PROBLEM LIST^21^^^ORWRP1^PROB^0^R^^^^R^224
"DATA",101.24,1098,2)
^^Problem List^Problem List^^PROBB^ORWRPP1
"DATA",101.24,1100,0)
ORRPW ORDERS CURRENT^OR_ORC^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^ORC^ORDV04^54
"DATA",101.24,1100,2)
^^Orders Current^Orders Current^^^^ORCVA^ORDV04
"DATA",101.24,1100,3,0)
^101.243^8^8
"DATA",101.24,1100,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1100,3,2,0)
Item Ordered                                           ^^3^1^1^^1^Item Ordered
"DATA",101.24,1100,3,3,0)
Current Status^^4^^0^10^1^Status
"DATA",101.24,1100,3,4,0)
Start Date/Time    ^^5^^1^18^1^Start Date/Time^2
"DATA",101.24,1100,3,5,0)
Stop Date/Time     ^^6^^^18^1^Stop Date/Time^2
"DATA",101.24,1100,3,6,0)
ID^1^2
"DATA",101.24,1100,3,7,0)
[+]^^7
"DATA",101.24,1100,3,8,0)
Order Number^1^8^0^0^^0^N^0
"DATA",101.24,1100,4)
5:3
"DATA",101.24,1101,0)
ORRPW ADT VISITS^OR_VISITS^1^^^^^R^^^^M^^^^^^^^^6
"DATA",101.24,1101,2)
^^Visits / Admissions^Visits / Admissions^^HSTYPEB^ORWRPP1
"DATA",101.24,1101,10,0)
^101.241P^14^10
"DATA",101.24,1101,10,4,0)
1036
"DATA",101.24,1101,10,6,0)
1037
"DATA",101.24,1101,10,7,0)
1038
"DATA",101.24,1101,10,8,0)
1039
"DATA",101.24,1101,10,9,0)
1040
"DATA",101.24,1101,10,10,0)
1065
"DATA",101.24,1101,10,11,0)
1041
"DATA",101.24,1101,10,12,0)
1042
"DATA",101.24,1101,10,13,0)
1043
"DATA",101.24,1101,10,14,0)
1044
"DATA",101.24,1102,0)
ORRPW DOD^OR_DOD^^^^^^R^^^^M
"DATA",101.24,1102,2)
^^Dept. of Defense Reports^Dept. of Defense Reports
"DATA",101.24,1102,10,0)
^101.241P^13^13
"DATA",101.24,1102,10,1,0)
1137
"DATA",101.24,1102,10,2,0)
1131
"DATA",101.24,1102,10,3,0)
1139
"DATA",101.24,1102,10,4,0)
1130
"DATA",101.24,1102,10,5,0)
1143
"DATA",101.24,1102,10,6,0)
1104
"DATA",101.24,1102,10,7,0)
1140
"DATA",101.24,1102,10,8,0)
1105
"DATA",101.24,1102,10,9,0)
1554
"DATA",101.24,1102,10,10,0)
1557
"DATA",101.24,1102,10,11,0)
1147
"DATA",101.24,1102,10,12,0)
1106
"DATA",101.24,1102,10,13,0)
1141
"DATA",101.24,1104,0)
ORRPW DOD LAB^OR_DODLAB^^^^^^R^^^^M
"DATA",101.24,1104,2)
^^Laboratory^Laboratory
"DATA",101.24,1104,4)
^^^^^^^^1
"DATA",101.24,1104,10,0)
^101.241P^5^5
"DATA",101.24,1104,10,1,0)
1134
"DATA",101.24,1104,10,2,0)
1132
"DATA",101.24,1104,10,3,0)
1135
"DATA",101.24,1104,10,4,0)
1136
"DATA",101.24,1104,10,5,0)
1133
"DATA",101.24,1105,0)
ORRPW DOD PHARM ALL OUT^OR_DODRXOP^1^6^ORDV01^HSQUERY^1^R^^^^V^224^^^^^^RXOP^ORDV06^28
"DATA",101.24,1105,2)
^^Outpatient Medications^DOD Outpatient Medications^^^^^PSOHCSUM
"DATA",101.24,1105,3,0)
^101.243^17^17
"DATA",101.24,1105,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1105,3,2,0)
Drug Name               ^^3^^1^19^1^Drug
"DATA",101.24,1105,3,3,0)
Drug ien^1^4
"DATA",101.24,1105,3,4,0)
RX #     ^^5^^0^10^1^RX #^1
"DATA",101.24,1105,3,5,0)
Status^^6^^^8^1
"DATA",101.24,1105,3,6,0)
Qty^^7^^^5^1^^1
"DATA",101.24,1105,3,7,0)
Exp/Canc Date^^8^^^18^1^^2
"DATA",101.24,1105,3,8,0)
Issue Date    ^^9^^1^18^1^Issue Date^2
"DATA",101.24,1105,3,9,0)
Last Fill Date^^10^^^18^1^^2
"DATA",101.24,1105,3,10,0)
Rem^^11^^^5^1^^1
"DATA",101.24,1105,3,11,0)
Provider^^12^^^12^1
"DATA",101.24,1105,3,12,0)
Cost/Fill^^13^^^10^1^^1
"DATA",101.24,1105,3,13,0)
SIG^^15^^1^12^1
"DATA",101.24,1105,3,14,0)
ID^1^2
"DATA",101.24,1105,3,15,0)
[+]^^14
"DATA",101.24,1105,3,16,0)
Pharmacy ID^1^16^0^0^^0^^0
"DATA",101.24,1105,3,17,0)
Order Number^1^17^0^0^^0^^0
"DATA",101.24,1105,4)
9:3^^^^^^^1^1
"DATA",101.24,1106,0)
ORRPW DOD RAD REPORT^OR_DODRP^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^RRDOD^ORDV03^35
"DATA",101.24,1106,2)
^^Radiology Report^DOD Radiology Report^^^^RAD2^ORDV03
"DATA",101.24,1106,3,0)
^101.243^10^10
"DATA",101.24,1106,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1106,3,2,0)
Exam Date/Time   ^^3^^1^18^1^^2
"DATA",101.24,1106,3,3,0)
Procedure Name                                 ^^4^^1^15^1^Procedure
"DATA",101.24,1106,3,4,0)
Report Status^^5^^^8^1^Status
"DATA",101.24,1106,3,5,0)
CPT Code^^6^^^7^1
"DATA",101.24,1106,3,6,0)
Report^1^9^1^1^12^1
"DATA",101.24,1106,3,7,0)
ID^1^2
"DATA",101.24,1106,3,8,0)
Clinical History^1^7^1^1^12^1
"DATA",101.24,1106,3,9,0)
Impression^1^8^1^1^12^1
"DATA",101.24,1106,3,10,0)
[+]^^10
"DATA",101.24,1106,4)
3:4^^^^^^^1^1
"DATA",101.24,1107,0)
ORRP ECS PCE SUMMARY^OR_ECS1^^2^^^1^R^1^^^R
"DATA",101.24,1107,2)
^^Patient PCE Summary^Report from Event Capture
"DATA",101.24,1108,0)
ORRP ECS PT SUMMARY^OR_ECS2^^2^^^1^R^1^^^R
"DATA",101.24,1108,2)
^^Patient Data Summary^Report from Event Capture
"DATA",101.24,1109,0)
ORRP ECS^OR_ECS^^^^^^R^1^^^M
"DATA",101.24,1109,2)
^^Event Capture^Event Capture Report
"DATA",101.24,1109,10,0)
^101.241P^2^2
"DATA",101.24,1109,10,1,0)
1107^^1
"DATA",101.24,1109,10,2,0)
1108^^2
"DATA",101.24,1110,0)
ORRPL LAB ORDERS ALL^OR_LO_ALL^1^6^ORDV01^HSQUERY^6^L^^^^V^224^^^^^^LO^ORDV02B^32
"DATA",101.24,1110,2)
^^Lab Orders (All)^Lab Orders (All)^^^^^GMTSLROE
"DATA",101.24,1110,3,0)
^101.243^19^19
"DATA",101.24,1110,3,1,0)
Collection Date/Time^^3^^^18^1^^2
"DATA",101.24,1110,3,2,0)
Test Name               ^^4^^^12^1^Test
"DATA",101.24,1110,3,3,0)
Test ien^1^16
"DATA",101.24,1110,3,4,0)
Specimen^^6^^^3^1^Spec
"DATA",101.24,1110,3,5,0)
Specimen ien^1^17^^^^^^^-2
"DATA",101.24,1110,3,6,0)
Urgency^0^10^^^4^0
"DATA",101.24,1110,3,7,0)
Provider^0^7^^^10^1
"DATA",101.24,1110,3,8,0)
Provider ien^1^18^^^^^^^-2
"DATA",101.24,1110,3,9,0)
Ordered Date/Time^0^8^^^18^1^^2
"DATA",101.24,1110,3,10,0)
Accession #^0^11^^^16^1
"DATA",101.24,1110,3,11,0)
Available Date/Time^0^12^^0^^0^^2
"DATA",101.24,1110,3,12,0)
Facility^^1^^^10^1
"DATA",101.24,1110,3,13,0)
ID^1^2
"DATA",101.24,1110,3,14,0)
Status^^9^^^6^1
"DATA",101.24,1110,3,15,0)
OE/RR Order #^1^19^^0
"DATA",101.24,1110,3,16,0)
Order Details^1^15^1^1
"DATA",101.24,1110,3,17,0)
[+]^0^13^^0^^0
"DATA",101.24,1110,3,18,0)
Results^1^14^1^1
"DATA",101.24,1110,3,19,0)
Critical^0^5^^0^^1^Critical
"DATA",101.24,1111,0)
ORRPL LAB ORDERS PEND^OR_LO_PEND^1^6^ORDV01^HSQUERY^6^L^^^^V^224^^^^^^LPEND^ORDV02B^32
"DATA",101.24,1111,2)
^^Pending Lab Orders^Pending Lab Orders^^^^^GMTSLROE
"DATA",101.24,1111,3,0)
^101.243^17^17
"DATA",101.24,1111,3,1,0)
Collection Date/Time^^3^^^18^1^^2
"DATA",101.24,1111,3,2,0)
Test Name               ^^4^^^12^1^Test
"DATA",101.24,1111,3,3,0)
Test ien^1^14
"DATA",101.24,1111,3,4,0)
Specimen^^5^^^3^1^Spec
"DATA",101.24,1111,3,5,0)
Specimen ien^1^15^^^^^^^-2
"DATA",101.24,1111,3,6,0)
Urgency^0^9^^^4^0
"DATA",101.24,1111,3,7,0)
Provider^0^6^^^10^1
"DATA",101.24,1111,3,8,0)
Provider ien^1^16^^^^^^^-2
"DATA",101.24,1111,3,9,0)
Ordered Date/Time^0^7^^^18^1^^2
"DATA",101.24,1111,3,10,0)
Accession #^0^10^^^16^1
"DATA",101.24,1111,3,11,0)
Available Date/Time^0^11^^0^^0^^2
"DATA",101.24,1111,3,12,0)
Facility^^1^^^10^1
"DATA",101.24,1111,3,13,0)
ID^1^2
"DATA",101.24,1111,3,14,0)
Status^^8^^^6^1
"DATA",101.24,1111,3,15,0)
OE/RR Order #^1^18^^0
"DATA",101.24,1111,3,16,0)
Order Details^1^13^1^1
"DATA",101.24,1111,3,17,0)
[+]^0^12^^0^^0
"DATA",101.24,1112,0)
ORRPL LAB OVERVIEW^OR_OV^1^6^ORDV01^HSQUERY^6^L^^^^V^224^^^^^^OV^ORDV02C^32
"DATA",101.24,1112,2)
^^Lab Overview (Collected Specimens)^Lab Overview (Collected Specimens)^^^^^GMTSLROE
"DATA",101.24,1112,3,0)
^101.243^18^18
"DATA",101.24,1112,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1112,3,2,0)
ID^1^2
"DATA",101.24,1112,3,3,0)
Collection Date/Time^^3^^^^1^^2
"DATA",101.24,1112,3,4,0)
Test Name         ^^4^^^12^1^Test
"DATA",101.24,1112,3,5,0)
Test ien^1^5
"DATA",101.24,1112,3,6,0)
Critical^^6^^0^^1^Critical
"DATA",101.24,1112,3,7,0)
Specimen^^7^^^3^1^Spec
"DATA",101.24,1112,3,8,0)
Specimen ien^1^8^^^^^^^-2
"DATA",101.24,1112,3,9,0)
Provider^0^9^^^10^1
"DATA",101.24,1112,3,10,0)
Provider ien^1^10
"DATA",101.24,1112,3,11,0)
Status^^11^^^6^1
"DATA",101.24,1112,3,12,0)
Available Date/Time^1^12^^0^^0^^2
"DATA",101.24,1112,3,13,0)
OE/RR Order #^1^13^^0
"DATA",101.24,1112,3,14,0)
Urgency^1^14^^0^^0
"DATA",101.24,1112,3,15,0)
Accession #^1^15^^0^16^0
"DATA",101.24,1112,3,16,0)
Results^1^16^1^1^^1^Results
"DATA",101.24,1112,3,17,0)
Order Details^1^17^1^1^^1^Details
"DATA",101.24,1112,3,18,0)
[+]^0^18^^0^^0
"DATA",101.24,1113,0)
ORRPW LAB ORDERS ALL^OR_LOR_ALL^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^LO^ORDV02B^32
"DATA",101.24,1113,2)
^^Lab Orders (All)^Lab Orders (All) Reports Tab^^^^^GMTSLROE
"DATA",101.24,1113,3,0)
^101.243^19^19
"DATA",101.24,1113,3,1,0)
Collection Date/Time^^3^^^18^1^^2
"DATA",101.24,1113,3,2,0)
Test Name               ^^4^^^12^1^Test
"DATA",101.24,1113,3,3,0)
Test ien^1^16
"DATA",101.24,1113,3,4,0)
Specimen^^6^^^3^1^Spec
"DATA",101.24,1113,3,5,0)
Specimen ien^1^17^^^^^^^-2
"DATA",101.24,1113,3,6,0)
Urgency^0^10^^^4^0
"DATA",101.24,1113,3,7,0)
Provider^0^7^^^10^1
"DATA",101.24,1113,3,8,0)
Provider ien^1^18^^^^^^^-2
"DATA",101.24,1113,3,9,0)
Ordered Date/Time^0^8^^^18^1^^2
"DATA",101.24,1113,3,10,0)
Accession #^0^11^^^16^1
"DATA",101.24,1113,3,11,0)
Available Date/Time^0^12^^0^^0^^2
"DATA",101.24,1113,3,12,0)
Facility^^1^^^10^1
"DATA",101.24,1113,3,13,0)
ID^1^2
"DATA",101.24,1113,3,14,0)
Status^^9^^^6^1
"DATA",101.24,1113,3,15,0)
OE/RR Order #^1^19^^0
"DATA",101.24,1113,3,16,0)
Order Details^1^15^1^1
"DATA",101.24,1113,3,17,0)
[+]^0^13^^0^^0
"DATA",101.24,1113,3,18,0)
Results^1^14^1^1
"DATA",101.24,1113,3,19,0)
Critical^0^5^^0^^1^Critical
"DATA",101.24,1114,0)
ORRPW LAB OVERVIEW^OR_OV_R^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^OV^ORDV02C^32
"DATA",101.24,1114,2)
^^Lab Overview (Collected Specimens)^Lab Overview (Collected Specimens)^^^^^GMTSLROE
"DATA",101.24,1114,3,0)
^101.243^18^18
"DATA",101.24,1114,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1114,3,2,0)
ID^1^2
"DATA",101.24,1114,3,3,0)
Collection Date/Time^^3^^^^1^^2
"DATA",101.24,1114,3,4,0)
Test Name         ^^4^^^12^1^Test
"DATA",101.24,1114,3,5,0)
Test ien^1^5
"DATA",101.24,1114,3,6,0)
Critical^^6^^0^^1^Critical
"DATA",101.24,1114,3,7,0)
Specimen^^7^^^3^1^Spec
"DATA",101.24,1114,3,8,0)
Specimen ien^1^8^^^^^^^-2
"DATA",101.24,1114,3,9,0)
Provider     ^0^9^^^10^1
"DATA",101.24,1114,3,10,0)
Provider ien^1^10^^^^^^^-2
"DATA",101.24,1114,3,11,0)
Status     ^^11^^^6^1
"DATA",101.24,1114,3,12,0)
Available Date/Time^1^12^^0^^0^^2
"DATA",101.24,1114,3,13,0)
OE/RR Order #^1^13^^0
"DATA",101.24,1114,3,14,0)
Urgency^1^14^^0^^0
"DATA",101.24,1114,3,15,0)
Accession #^1^15^^0^16^0
"DATA",101.24,1114,3,16,0)
Results^1^16^1^1^^1^Results
"DATA",101.24,1114,3,17,0)
Order Details^1^17^1^1^^1^Details
"DATA",101.24,1114,3,18,0)
[+]^0^18^^0^^0
"DATA",101.24,1130,0)
ORRPW DOD DISCHARGE SUMMARY^OR_DODDS^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^TIUDCS^ORDV04^57
"DATA",101.24,1130,2)
^^Discharge Summary^DOD Discharge Summary^^HSTYPEB^ORWRPP1^TDCS^ORDV04
"DATA",101.24,1130,3,0)
^101.243^11^9
"DATA",101.24,1130,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1130,3,2,0)
Admitted Date/Time^^3^^^18^1^Admitted^2
"DATA",101.24,1130,3,3,0)
Discharged Date/Time^^4^^^18^1^Discharged^2
"DATA",101.24,1130,3,4,0)
Author / Dictated By^^5^^^10^1
"DATA",101.24,1130,3,5,0)
Approved By        ^^6^^^12^1^Approved By
"DATA",101.24,1130,3,6,0)
Current Status^^7^^^10^1^Status
"DATA",101.24,1130,3,9,0)
ID^1^2
"DATA",101.24,1130,3,10,0)
Summary^1^8^1^1^^1
"DATA",101.24,1130,3,11,0)
[+]^0^9
"DATA",101.24,1130,4)
3:5^^^^^^^1^1
"DATA",101.24,1131,0)
ORRPW DOD ADT EXP^OR_DODEADT^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^64
"DATA",101.24,1131,2)
^^Expanded ADT^DOD Expanded ADT^^HSTYPEB^ORWRPP1
"DATA",101.24,1131,4)
^^ADT^^^^^1^1
"DATA",101.24,1132,0)
ORRPW DOD LAB CHEM^OR_DODCH^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^CH^ORDV02^3
"DATA",101.24,1132,2)
^^Chem & Hematology^DOD Chem & Hematology^^^^^GMTSLRCE
"DATA",101.24,1132,3,0)
^101.243^13^12
"DATA",101.24,1132,3,1,0)
Facility^^1
"DATA",101.24,1132,3,2,0)
Collection Date/Time^^3^^1^17^1^^2
"DATA",101.24,1132,3,3,0)
Specimen^^5^^1^8^1
"DATA",101.24,1132,3,5,0)
Result     ^^6^^1^7^1^Result^1
"DATA",101.24,1132,3,6,0)
Flag^^7^^^4^1
"DATA",101.24,1132,3,7,0)
Units^^8^^^7^1
"DATA",101.24,1132,3,8,0)
Ref Low^^9^^^7^1^Low^1
"DATA",101.24,1132,3,9,0)
Ref High^^10^^^7^1^High^1
"DATA",101.24,1132,3,10,0)
ID^1^2
"DATA",101.24,1132,3,11,0)
Comments^0^11^1^1^^1
"DATA",101.24,1132,3,12,0)
Test Name              ^^4^^1^7^1^Test
"DATA",101.24,1132,3,13,0)
[+]^^12
"DATA",101.24,1132,4)
3:4^^^^^^^1^1
"DATA",101.24,1133,0)
ORRPW DOD LAB MICRO^OR_DODMIC^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^MI^ORDV05^38
"DATA",101.24,1133,2)
^^Microbiology^DOD Microbiology^^^^GET^ORDV05E
"DATA",101.24,1133,3,0)
^101.243^10^9
"DATA",101.24,1133,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1133,3,2,0)
ID^1^2
"DATA",101.24,1133,3,3,0)
Collection Date/Time^^3^^0^18^1^^2
"DATA",101.24,1133,3,4,0)
Specimen^^6^^^10^1
"DATA",101.24,1133,3,5,0)
Microbiology Test Name     ^^4^^0^15^1^Test
"DATA",101.24,1133,3,7,0)
Accession #   ^^7^^^16^1^Accession #
"DATA",101.24,1133,3,8,0)
Collection Sample^^5^^0^12^1^Sample
"DATA",101.24,1133,3,9,0)
Report^1^8^1^1^^1
"DATA",101.24,1133,3,10,0)
[+]^^9
"DATA",101.24,1133,4)
3:4^^^^^^^1^1
"DATA",101.24,1134,0)
ORRPW DOD LAB ORDERS^OR_DODLO^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^LO^ORDV02^32
"DATA",101.24,1134,2)
^^Lab Orders^DOD Lab Orders^^^^^GMTSLROE
"DATA",101.24,1134,3,0)
^101.243^14^14
"DATA",101.24,1134,3,1,0)
Collection Date/Time^^3^^^18^1^^2
"DATA",101.24,1134,3,2,0)
Test Name               ^^4^^^12^1^Test
"DATA",101.24,1134,3,3,0)
Test ien^1^5
"DATA",101.24,1134,3,4,0)
Specimen^^6^^^3^1^Spec
"DATA",101.24,1134,3,5,0)
Specimen ien^1^7
"DATA",101.24,1134,3,6,0)
Urgency^^8^^^4^1^Urg
"DATA",101.24,1134,3,7,0)
Provider^^9^^^10^1
"DATA",101.24,1134,3,8,0)
Provider ien^1^10
"DATA",101.24,1134,3,9,0)
Ordered Date/Time^^11^^^18^1^^2
"DATA",101.24,1134,3,10,0)
Accession #^^12^^^16^1^Accession
"DATA",101.24,1134,3,11,0)
Available Date/Time^^13^^^18^1^^2
"DATA",101.24,1134,3,12,0)
Facility^^1^^^10^1
"DATA",101.24,1134,3,13,0)
ID^1^2
"DATA",101.24,1134,3,14,0)
Status^^14^^^6^1
"DATA",101.24,1134,4)
3:4^^^^^^^1^1
"DATA",101.24,1135,0)
ORRPW DOD LAB SP^OR_DODSP^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^SP^ORDV02^46
"DATA",101.24,1135,2)
^^Surgical Pathology (DOD Remote data only)^DOD Surgical Pathology^^^^^GMTSLRAE
"DATA",101.24,1135,3,0)
^101.243^12^12
"DATA",101.24,1135,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1135,3,2,0)
Collection Date^^3^^1^18^1^^2
"DATA",101.24,1135,3,3,0)
Accession #   ^^5^^^16^1^Accession #
"DATA",101.24,1135,3,4,0)
Specimen                   ^0^4^1^1^10^1^Specimen
"DATA",101.24,1135,3,5,0)
Brief Clin. Hx.^1^6^1^1^^1
"DATA",101.24,1135,3,6,0)
Gross Desc.^1^7^1^1^^1
"DATA",101.24,1135,3,7,0)
Microscopic Exam^1^8^1^1^^1
"DATA",101.24,1135,3,8,0)
Supplementary Rpt^1^9^1^1^^1
"DATA",101.24,1135,3,9,0)
Frozen Section^1^10^1^1^^1
"DATA",101.24,1135,3,10,0)
Surgical Path Dx^1^11^1^1^^1
"DATA",101.24,1135,3,11,0)
ID^1^2
"DATA",101.24,1135,3,12,0)
[+]^^12
"DATA",101.24,1135,4)
3:4^^^^^^^1^1
"DATA",101.24,1136,0)
ORRPW DOD LAB CY^OR_DODCY^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^CY^ORDV02^48
"DATA",101.24,1136,2)
^^Cytology (DOD Remote data only)^DOD Cytology^^^^^GMTSLRPE
"DATA",101.24,1136,3,0)
^101.243^12^12
"DATA",101.24,1136,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1136,3,2,0)
Collection Date^^3^^1^18^1^^2
"DATA",101.24,1136,3,3,0)
Accession #   ^^6^^^16^1^Accession #
"DATA",101.24,1136,3,4,0)
Report Release Date^^5^^^18^1^^2
"DATA",101.24,1136,3,5,0)
Specimen                    ^^4^1^1^10^1^Specimen
"DATA",101.24,1136,3,6,0)
Brief Clin. Hx^1^7^1^1^^1
"DATA",101.24,1136,3,7,0)
Gross Desc.^1^8^1^1^^1
"DATA",101.24,1136,3,8,0)
Microscopic Exam^1^9^1^1^^1
"DATA",101.24,1136,3,9,0)
Cytopathology Dx^1^10^1^1^12^1^Cytopath DX
"DATA",101.24,1136,3,10,0)
Supplementary Rpt^1^11^1^1^^1
"DATA",101.24,1136,3,11,0)
ID^1^2
"DATA",101.24,1136,3,12,0)
[+]^^12
"DATA",101.24,1136,4)
3:4^^^^^^^1^1
"DATA",101.24,1137,0)
ORRPW DOD ALLERGIES ADV^OR_DODBADR^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^ADR^ORDV01^73
"DATA",101.24,1137,2)
^^Allergies^DOD Allergies^^^^^GMRADPT
"DATA",101.24,1137,3,0)
^101.243^8^8
"DATA",101.24,1137,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1137,3,2,0)
Allergy Type^^4^^0^10^1
"DATA",101.24,1137,3,3,0)
Allergy Reactant^^3^^0^20^1^Reactant
"DATA",101.24,1137,3,4,0)
Verification Date/Time^^5^^0^18^1^^2
"DATA",101.24,1137,3,5,0)
Observed/Historical^^6^^^13^1^Observed/Hist
"DATA",101.24,1137,3,6,0)
ID^1^2
"DATA",101.24,1137,3,7,0)
Comments^1^7^1^1^^1
"DATA",101.24,1137,3,8,0)
Allergy IEN^1^8^0^0^^0^^0
"DATA",101.24,1137,4)
5:3^^^^^^^1^1
"DATA",101.24,1138,0)
ORCV IMMUNIZATIONS^90^^^ORQQPX^IMMLIST^^C^1^^Purple^S^171^T^3^15,35^2,4,3^41
"DATA",101.24,1138,2)
^^Recent Immunizations^Recent Immunizations^IMM
"DATA",101.24,1139,0)
ORRPW DOD CONSULTS^OR CN^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^CONSLT^ORDV09
"DATA",101.24,1139,2)
^^Consults (DOD Remote data only)^DOD Consults^^^^CONX^ORDV09
"DATA",101.24,1139,3,0)
^101.243^14^9
"DATA",101.24,1139,3,1,0)
Facility^^1^^^^1
"DATA",101.24,1139,3,2,0)
Request Date/Time^^3^^^18^1^Requested^2
"DATA",101.24,1139,3,3,0)
Completion Date/Time^^4^^^18^1^Completed^2
"DATA",101.24,1139,3,4,0)
Status^^6^^^9^1
"DATA",101.24,1139,3,6,0)
Consult Service^^5^^^12^1
"DATA",101.24,1139,3,7,0)
Procedure Type^^7^^^15^1
"DATA",101.24,1139,3,11,0)
Report Text^1^8^1^1^^1
"DATA",101.24,1139,3,13,0)
[+]^^9
"DATA",101.24,1139,3,14,0)
ID^1^2
"DATA",101.24,1139,4)
^^^^^^^1^1
"DATA",101.24,1140,0)
ORRPW DOD PCE OUTPT ENCOUNTER^OR_DODOE^1^5^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^^^205
"DATA",101.24,1140,2)
^^Outpatient Encounter^DOD PCE Outpatient Encounter^^HSTYPEB^ORWRPP1
"DATA",101.24,1140,4)
^^SADR^^^^^1^1
"DATA",101.24,1141,0)
ORRPW DOD VITALS^OR_DODVS^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^VS^ORDV04^47
"DATA",101.24,1141,2)
^^Vital Signs^DOD Vital Signs^^^^EN1^GMVHS
"DATA",101.24,1141,3,0)
^101.243^18^18
"DATA",101.24,1141,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1141,3,2,0)
Measurement Date/Time^^3^^^18^1^^2
"DATA",101.24,1141,3,3,0)
TEMP^^4^^^5^1^^1
"DATA",101.24,1141,3,4,0)
PULSE^^5^^^5^1^^1
"DATA",101.24,1141,3,5,0)
RESP^^6^^^5^1^^1
"DATA",101.24,1141,3,6,0)
Blood Pressure^^7^^^12^1^Pressure
"DATA",101.24,1141,3,7,0)
Height^^8^^^6^1^^1
"DATA",101.24,1141,3,8,0)
Weight^^9^^^6^1^^1
"DATA",101.24,1141,3,9,0)
ID^1^2
"DATA",101.24,1141,3,10,0)
Pain^^10^^^6
"DATA",101.24,1141,3,11,0)
POx^^11^^^6
"DATA",101.24,1141,3,12,0)
CVP^^12^^^6
"DATA",101.24,1141,3,13,0)
C/G^^13^^^6
"DATA",101.24,1141,3,14,0)
Flow Rate (l/min)^1^14^^1^6^1^Rate l/min
"DATA",101.24,1141,3,15,0)
O2 Concentration (%)^1^15^^1^6^1^O2 %
"DATA",101.24,1141,3,16,0)
Qualifiers^1^16^^1^20^1^Qualif
"DATA",101.24,1141,3,17,0)
BMI^1^17^^1^6^1^BMI
"DATA",101.24,1141,3,18,0)
Units^1^18^^1^20^1^Units
"DATA",101.24,1141,4)
3:0^^^^^^^1^1
"DATA",101.24,1143,0)
ORRPW DOD HISTORIES^ORDOD HX^^^^^^R^^^^M
"DATA",101.24,1143,2)
^^Histories (DOD Remote data only)^DOD Histories
"DATA",101.24,1143,10,0)
^101.241P^3^3
"DATA",101.24,1143,10,1,0)
1144^^1
"DATA",101.24,1143,10,2,0)
1145
"DATA",101.24,1143,10,3,0)
1146
"DATA",101.24,1144,0)
ORRPW DOD FAMILY HISTORY^ORDOD FHX^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^FAMHX^ORDV09
"DATA",101.24,1144,2)
^^Family History^DOD Family History^^^^FAMHXX^ORDV09
"DATA",101.24,1144,3,0)
^101.243^13^13
"DATA",101.24,1144,3,1,0)
Facility^^1^^^^1
"DATA",101.24,1144,3,2,0)
ID^1^2
"DATA",101.24,1144,3,3,0)
Date Reported    ^^3^^1^18^1^Reported^2
"DATA",101.24,1144,3,4,0)
Problem                      ^^4^1^1^20^1
"DATA",101.24,1144,3,5,0)
Comment             ^^5^1^1^^1
"DATA",101.24,1144,3,6,0)
Relationship^^6^^1^15^1
"DATA",101.24,1144,3,7,0)
Status^^7^^^9^1
"DATA",101.24,1144,3,8,0)
Date/Time of Onset^^8^^1^18^1^Onset^2
"DATA",101.24,1144,3,9,0)
Source^^9^^1^^1
"DATA",101.24,1144,3,10,0)
MEDCIN Problem ID^1^10^^1^^1
"DATA",101.24,1144,3,11,0)
MEDCIN Relationship ID^1^11^^1^^1
"DATA",101.24,1144,3,12,0)
Reported By^1^12^^1^^1
"DATA",101.24,1144,3,13,0)
Unverified (Reported by Patient)^1^13^^1^^1^Unverified
"DATA",101.24,1144,4)
^^^^^^^1^1
"DATA",101.24,1145,0)
ORRPW DOD SOCIAL HISTORY^ORDOD SHX^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^SOCHX^ORDV09
"DATA",101.24,1145,2)
^^Social History^DOD Social History^^^^SOCHXX^ORDV09
"DATA",101.24,1145,3,0)
^101.243^12^11
"DATA",101.24,1145,3,1,0)
Facility^^1^^^^1
"DATA",101.24,1145,3,2,0)
ID^1^2
"DATA",101.24,1145,3,3,0)
Date Reported   ^^3^^1^18^1^Reported^2
"DATA",101.24,1145,3,4,0)
Finding                      ^^4^1^1^20^1
"DATA",101.24,1145,3,5,0)
Comment             ^^5^1^1^^1
"DATA",101.24,1145,3,7,0)
Status^^6^^^9^1
"DATA",101.24,1145,3,8,0)
Date/Time of Onset^^7^^1^18^1^Onset^2
"DATA",101.24,1145,3,9,0)
Source^^8^^1^^1
"DATA",101.24,1145,3,10,0)
MEDCIN Finding ID^1^9^^1^^1
"DATA",101.24,1145,3,11,0)
Reported By^1^10^^1^^1
"DATA",101.24,1145,3,12,0)
Unverified (Reported By Patient)^1^11^^1^^1
"DATA",101.24,1145,4)
^^^^^^^1^1
"DATA",101.24,1146,0)
ORRPW DOD OTHER PAST MED HX^ORDOD MHX^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^MEDHX^ORDV09
"DATA",101.24,1146,2)
^^Other Past Medical History^DOD Other Past Medical History^^^^MEDHXX^ORDV09
"DATA",101.24,1146,3,0)
^101.243^13^12
"DATA",101.24,1146,3,1,0)
Facility^^1^^^^1
"DATA",101.24,1146,3,2,0)
ID^1^2
"DATA",101.24,1146,3,3,0)
Date Reported    ^^3^^1^18^1^Reported^2
"DATA",101.24,1146,3,4,0)
Finding                      ^^4^1^1^20^1
"DATA",101.24,1146,3,5,0)
Comment             ^^5^1^1^^1
"DATA",101.24,1146,3,7,0)
Status^^7^^^9^1
"DATA",101.24,1146,3,8,0)
Date/Time of Onset^^8^^1^18^1^Onset^2
"DATA",101.24,1146,3,9,0)
Source^^9^^1^^1
"DATA",101.24,1146,3,10,0)
MEDCIN Finding ID^1^10^^1^^1
"DATA",101.24,1146,3,11,0)
Reported By^1^11^^1^^1
"DATA",101.24,1146,3,12,0)
Unverified (Reported By Patient)^1^12^^1^^1
"DATA",101.24,1146,3,13,0)
Encounter (Not Used)^1^6^^0^^0
"DATA",101.24,1146,4)
^^^^^^^1^1
"DATA",101.24,1147,0)
ORRPW DOD QUESTIONNAIRES^ORDOD QST^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^QUEST^ORDV09
"DATA",101.24,1147,2)
^^Questionnaires (DOD Remote data only)^DOD Questionnaires^^^^QUESTX^ORDV09
"DATA",101.24,1147,3,0)
^101.243^6^6
"DATA",101.24,1147,3,1,0)
Facility^^1^^^^1
"DATA",101.24,1147,3,2,0)
ID^1^2
"DATA",101.24,1147,3,3,0)
Date Reported    ^^3^^1^18^1^^2
"DATA",101.24,1147,3,4,0)
Questionnaire Title          ^0^4^^1^^1^Title
"DATA",101.24,1147,3,5,0)
Entered By^0^5^^1^^1
"DATA",101.24,1147,3,6,0)
Questionnaire Report^1^6^1^1^^1^Questionnaire
"DATA",101.24,1147,4)
^^^^^^^1^1
"DATA",101.24,1150,0)
ORWG GRAPHING^OR_GRAPHS^^2^^^1^R^^^^G^^T
"DATA",101.24,1150,2)
^^Graphing (local only)^Graphing
"DATA",101.24,1550,0)
ORRPW HDR^OR_HDR_IMS^^^^^^R^^^^M
"DATA",101.24,1550,2)
^^HDR Reports^HDR Reports
"DATA",101.24,1550,10,0)
^101.241P^4^4
"DATA",101.24,1550,10,1,0)
1551^^1
"DATA",101.24,1550,10,2,0)
1556^^2
"DATA",101.24,1550,10,3,0)
1553^^3
"DATA",101.24,1550,10,4,0)
1552^^4
"DATA",101.24,1551,0)
ORRPW HDR ALLERGIES^OR_VWAL^2^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^ADR^ORDV01^73
"DATA",101.24,1551,2)
^^Allergies^Allergies HDR^^^^^GMRADPT
"DATA",101.24,1551,3,0)
^101.243^8^8
"DATA",101.24,1551,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1551,3,2,0)
Allergy Type^^4^^0^10^1
"DATA",101.24,1551,3,3,0)
Allergy Reactant^^3^^0^20^1^Reactant
"DATA",101.24,1551,3,4,0)
Verification Date/Time^^5^^0^18^1^^2
"DATA",101.24,1551,3,5,0)
Observed/Historical^^6^^^13^1^Observed/Hist
"DATA",101.24,1551,3,6,0)
ID^1^2
"DATA",101.24,1551,3,7,0)
Comments^1^7^1^1^^1
"DATA",101.24,1551,3,8,0)
Allergy IEN^1^8^0^0^^0^^0
"DATA",101.24,1551,4)
5:3^^^^1^ORWRP4A^ADR
"DATA",101.24,1552,0)
ORRPW HDR VITALS^OR_VWVS^2^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^VS^ORDV04^47
"DATA",101.24,1552,2)
^^Vital Signs^Vital Signs HDR^^^^EN1^GMVHS
"DATA",101.24,1552,3,0)
^101.243^18^18
"DATA",101.24,1552,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1552,3,2,0)
Measurement Date/Time^^3^^^18^1^^2
"DATA",101.24,1552,3,3,0)
TEMP^^4^^^5^1^^1
"DATA",101.24,1552,3,4,0)
PULSE^^5^^^5^1^^1
"DATA",101.24,1552,3,5,0)
RESP^^6^^^5^1^^1
"DATA",101.24,1552,3,6,0)
Blood Pressure^^7^^^12^1^Pressure
"DATA",101.24,1552,3,7,0)
Height^^8^^^6^1^^1
"DATA",101.24,1552,3,8,0)
Weight^^9^^^6^1^^1
"DATA",101.24,1552,3,9,0)
ID^1^2
"DATA",101.24,1552,3,10,0)
Pain^^10^^^6
"DATA",101.24,1552,3,11,0)
POx^^11^^^6
"DATA",101.24,1552,3,12,0)
CVP^^12^^^6
"DATA",101.24,1552,3,13,0)
C/G^^13^^^6
"DATA",101.24,1552,3,14,0)
Flow Rate (l/min)^1^14^^1^6^1^Rate l/min
"DATA",101.24,1552,3,15,0)
O2 Concentration (%)^1^15^^1^6^1^O2 %
"DATA",101.24,1552,3,16,0)
Qualifiers^1^16^^1^20^1^Qualif
"DATA",101.24,1552,3,17,0)
Methods^1^17^^1^20^1^Methods
"DATA",101.24,1552,3,18,0)
Units^1^18^^1^20^1^Units
"DATA",101.24,1552,4)
3:0^^^^1^ORWRP4V^VS
"DATA",101.24,1553,0)
ORRPW HDR PHARMACY OUT^OR_VWRX^2^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^RXOP^ORDV06^28
"DATA",101.24,1553,2)
^^Pharmacy All Outpatient^Pharmacy All Outpatient HDR^^^^^PSOHCSUM
"DATA",101.24,1553,3,0)
^101.243^17^17
"DATA",101.24,1553,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1553,3,2,0)
Drug Name               ^^3^^1^19^1^Drug
"DATA",101.24,1553,3,3,0)
Drug ien^1^4
"DATA",101.24,1553,3,4,0)
RX #     ^^5^^0^10^1^RX #^1
"DATA",101.24,1553,3,5,0)
Status^^6^^^8^1
"DATA",101.24,1553,3,6,0)
Qty^^7^^^5^1^^1
"DATA",101.24,1553,3,7,0)
Exp/Canc Date^^8^^^18^1^^2
"DATA",101.24,1553,3,8,0)
Issue Date    ^^9^^1^18^1^Issue Date^2
"DATA",101.24,1553,3,9,0)
Last Fill Date^^10^^^18^1^^2
"DATA",101.24,1553,3,10,0)
Rem^^11^^^5^1^^1
"DATA",101.24,1553,3,11,0)
Provider^^12^^^12^1
"DATA",101.24,1553,3,12,0)
Cost/Fill^^13^^^10^1^^1
"DATA",101.24,1553,3,13,0)
SIG^^15^^1^12^1
"DATA",101.24,1553,3,14,0)
ID^1^2
"DATA",101.24,1553,3,15,0)
[+]^^14
"DATA",101.24,1553,3,16,0)
Pharmacy ID^1^16^0^0^^0^^0
"DATA",101.24,1553,3,17,0)
Order Number^1^17^0^0^^0^^0
"DATA",101.24,1553,4)
9:3^^^^1^ORWRP4P^PSO
"DATA",101.24,1554,0)
ORRPW DOD PN PROGRESS NOTES^OR_DODPN^1^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^TIUPRG^ORDV04^15
"DATA",101.24,1554,2)
^^Progress Notes^DOD Progress Notes^^^^TPRG^ORDV04
"DATA",101.24,1554,3,0)
^101.243^10^9
"DATA",101.24,1554,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1554,3,3,0)
Date/Time of Note^^4^^0^18^1^Date/Time^2
"DATA",101.24,1554,3,4,0)
Type of Note          ^^5^^0^12^1^Type of Note
"DATA",101.24,1554,3,5,0)
Author of Note       ^^6^^0^12^1^Author
"DATA",101.24,1554,3,6,0)
ID^1^2
"DATA",101.24,1554,3,7,0)
IEN^1^3
"DATA",101.24,1554,3,8,0)
Note Text^1^7^1^1^^1
"DATA",101.24,1554,3,9,0)
[+]^^8
"DATA",101.24,1554,3,10,0)
Identifier^1^9^0^0^^0^^0
"DATA",101.24,1554,4)
4:5^^PN^^^^^1^1
"DATA",101.24,1555,0)
ORRPW PHARMACY NON-VA MEDS^OR_RXN^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^NVA^ORDV06A
"DATA",101.24,1555,2)
^^Herbal/OTC/Non-VA Meds^Herbal/OTC/Non-VA Meds^^^^ACS^PSOHCSUM
"DATA",101.24,1555,3,0)
^101.243^11^11
"DATA",101.24,1555,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1555,3,2,0)
Herbal/OTC/Non VA Med^^3^^1^20^1^Item
"DATA",101.24,1555,3,3,0)
Status^^4^^^^1^Status
"DATA",101.24,1555,3,4,0)
Start Date^^5^^^^1^Start Date^2
"DATA",101.24,1555,3,5,0)
Date Documented^^6^^^^1^DC'd^2
"DATA",101.24,1555,3,6,0)
Documented By^^7^^^^1^Doc By
"DATA",101.24,1555,3,7,0)
Date DC'd^^8^^^^1^Date DC'd^2
"DATA",101.24,1555,3,8,0)
Comments^^11^1^1^^1^Comments
"DATA",101.24,1555,3,9,0)
ID^1^2
"DATA",101.24,1555,3,10,0)
[+]^^10
"DATA",101.24,1555,3,11,0)
SIG^^9^^1^^1^SIG
"DATA",101.24,1556,0)
ORRPW HDR LAB CHEM^OR_LRC^2^6^ORDV01^HSQUERY^6^R^^^^V^224^^^^^^CH^ORDV02^3
"DATA",101.24,1556,2)
^^Chem & Hematology^Chem & Hematology HDR^^^^^GMTSLRCE
"DATA",101.24,1556,3,0)
^101.243^15^13
"DATA",101.24,1556,3,1,0)
Facility^^1
"DATA",101.24,1556,3,2,0)
Collection Date/Time^^3^^1^17^1^^2
"DATA",101.24,1556,3,3,0)
Specimen^^5^^1^8^1
"DATA",101.24,1556,3,5,0)
Result     ^^6^^1^7^1^Result^1
"DATA",101.24,1556,3,6,0)
Flag^^7^^^4^1
"DATA",101.24,1556,3,7,0)
Units^^8^^^7^1
"DATA",101.24,1556,3,8,0)
Ref Range^^9^^^12^1^RefRange^0
"DATA",101.24,1556,3,10,0)
ID^1^2
"DATA",101.24,1556,3,11,0)
Comments^0^11^1^1^^1
"DATA",101.24,1556,3,12,0)
Test Name              ^^4^^1^7^1^Test
"DATA",101.24,1556,3,13,0)
[+]^^12
"DATA",101.24,1556,3,14,0)
Order Comments^1^13^^1^20^1^Ord Com
"DATA",101.24,1556,3,15,0)
Result Interpretation^1^14^^1^20^1^Interp
"DATA",101.24,1556,4)
3:4^^^^1^ORWRP4L^CH
"DATA",101.24,1557,0)
ORRPW DOD PROBLEM LIST ALL^OR_DODPLL^1^6^ORDV01^HSQUERY^0^R^^^^V^224^^^^^^PLAILALL^ORDV04^61
"DATA",101.24,1557,2)
^^All Problem List^All Problem List^^^^PLALL^ORDV04
"DATA",101.24,1557,3,0)
^101.243^10^10
"DATA",101.24,1557,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1557,3,2,0)
Status^^3^^^8^1
"DATA",101.24,1557,3,3,0)
Provider Narrative                  ^^4^^1^15^1^Provider Narrative
"DATA",101.24,1557,3,4,0)
Date of Onset^^5^^1^18^1^^2
"DATA",101.24,1557,3,5,0)
Date Modified^^6^^1^18^1^^2
"DATA",101.24,1557,3,6,0)
Provider Name    ^^7^^0^12^1^Provider
"DATA",101.24,1557,3,7,0)
Note Narrative^1^8^^1^15^1
"DATA",101.24,1557,3,8,0)
ID^1^2
"DATA",101.24,1557,3,9,0)
[+]^^10
"DATA",101.24,1557,3,10,0)
Exposures^0^9^^1^18^0^Exposures
"DATA",101.24,1557,4)
5:4^^PLL^^^^^1^1
"DATA",101.24,1558,0)
ORRPW MEDICATIONS^OR_MEDS^1^6^ORDV01^HSQUERY^1^R^^^^V^224^^^^^^RXALL^ORDV06B
"DATA",101.24,1558,2)
^^All Medications^All Medications^^^^IN^ORDV06B
"DATA",101.24,1558,3,0)
^101.243^13^13
"DATA",101.24,1558,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1558,3,2,0)
Medication^^3^^^20^1^^^266
"DATA",101.24,1558,3,3,0)
Status^^4^^^^1^^^80
"DATA",101.24,1558,3,4,0)
In/Out^^5^^^^1
"DATA",101.24,1558,3,5,0)
Type     ^^6^^^^1
"DATA",101.24,1558,3,6,0)
Start Date/Time    ^^7^^^^1^^2
"DATA",101.24,1558,3,7,0)
Stop Date/Time    ^^8^^^^1^^2
"DATA",101.24,1558,3,8,0)
[+]^^13^^^^0
"DATA",101.24,1558,3,9,0)
Instructions^^11^1^1^^^^^120
"DATA",101.24,1558,3,10,0)
Details^1^12^1^1^^1
"DATA",101.24,1558,3,11,0)
ID^1^2
"DATA",101.24,1558,3,12,0)
Last Fill Date^^9^^^9^1^Last Fill^2
"DATA",101.24,1558,3,13,0)
Provider^^10^^^20^1
"DATA",101.24,1600,0)
ORRPL LAB CY^OR_CYL^1^6^ORDV01^HSQUERY^0^L^^^^V^224^^^^^^CY^ORDV02A
"DATA",101.24,1600,2)
^^Cytology^Cytology^^^^XCY^ORDVX1
"DATA",101.24,1600,3,0)
^101.243^7^7
"DATA",101.24,1600,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1600,3,2,0)
ID^1^2
"DATA",101.24,1600,3,3,0)
Collection Date^^3^^0^18^0^^2
"DATA",101.24,1600,3,4,0)
Specimen               ^^4^1^0^10^0^Specimen
"DATA",101.24,1600,3,5,0)
Accession #^^5^^^16^1^Accession #
"DATA",101.24,1600,3,6,0)
Report^1^6^1^1^^1^    
"DATA",101.24,1600,3,7,0)
[+]^^7
"DATA",101.24,1600,4)
3:4
"DATA",101.24,1601,0)
ORRPL LAB EM^OR_EML^1^6^ORDV01^HSQUERY^0^L^^^^V^224^^^^^^EM^ORDV02A
"DATA",101.24,1601,2)
^^Electron Microscopy^Electron Microscopy^^HSTYPEB^ORWRPP1^XEM^ORDVX1
"DATA",101.24,1601,3,0)
^101.243^7^7
"DATA",101.24,1601,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1601,3,2,0)
ID^1^2
"DATA",101.24,1601,3,3,0)
Collection Date^^3^^0^18^0^^2
"DATA",101.24,1601,3,4,0)
Specimen^^4^1^0^10^0^Specimen
"DATA",101.24,1601,3,5,0)
Accession #^^5^^^16^1^Accession #
"DATA",101.24,1601,3,6,0)
Report^1^6^1^1^^1^    
"DATA",101.24,1601,3,7,0)
[+]^^7
"DATA",101.24,1602,0)
ORRPL LAB SP^OR_SPL^1^6^ORDV01^HSQUERY^0^L^^^^V^224^^^^^^SP^ORDV02A
"DATA",101.24,1602,2)
^^Surgical Pathology^Surgical Pathology^^^^XSP^ORDVX1
"DATA",101.24,1602,3,0)
^101.243^7^7
"DATA",101.24,1602,3,1,0)
Facility^^1^^^10^1
"DATA",101.24,1602,3,2,0)
ID^1^2
"DATA",101.24,1602,3,3,0)
Collection Date^^3^^0^18^0^^2
"DATA",101.24,1602,3,4,0)
Specimen^^4^1^0^10^0^Specimen
"DATA",101.24,1602,3,5,0)
Accession #^^5^^^16^1^Accession #
"DATA",101.24,1602,3,6,0)
Report^1^6^1^1^^1^    
"DATA",101.24,1602,3,7,0)
[+]^^7
"DATA",101.24,1602,4)
3:4
"DATA",101.24,1603,0)
ORRPW LAB AU^OR_AU^1^^ORWRP1A^AU^0^R^^^^R^224
"DATA",101.24,1603,2)
^^Autopsy^Autopsy
"DATA",101.24,1604,0)
ORAM ANTICOAG REPORT^1604^1^2^ORAM2^RPTSTART^1^R^^^^R^224^^^^^^^ORAM2
"DATA",101.24,1604,2)
^^Anticoagulation Flowsheet^Anticoagulation Flowsheet^^RPT^ORAM2
"DATA",101.41,51,0)
GMRCOR CONSULT^Consult^^D^11^2^294^1^1
"DATA",101.41,51,3)
D GETSERV^ORCDGMRC
"DATA",101.41,51,3.1)
D GETSERV^ORCDGMRC
"DATA",101.41,51,4)
K ORSERV,ORPDX,GMRCNOPD,GMRCNOAT,GMRCREAF,^TMP("GMRCS",$J),^TMP("GMRCSLIST",$J)
"DATA",101.41,51,5)
^^^Consult^110
"DATA",101.41,51,10,0)
^101.412IA^10^10
"DATA",101.41,51,10,1,0)
1^4^^Consult to Service/Specialty: ^^1^^^^S.CSLT
"DATA",101.41,51,10,1,1)
Select the service/specialty consultation you wish to request for this patient.
"DATA",101.41,51,10,1,2)
2^^^^Cons
"DATA",101.41,51,10,1,3)
I $G(ORTYPE)'="Q",'$D(OREDIT),'$G(OREWRITE)
"DATA",101.41,51,10,1,4)
I $$ACTIVE^ORDD43(Y),$D(^TMP("GMRCS",$J,+$P(^(0),U,2)))
"DATA",101.41,51,10,1,5)
I $G(ORESET)'=+Y D CKSERV^ORCDGMRC K GMRCREAF
"DATA",101.41,51,10,1,6)
D LISTSERV^ORCDGMRC(1)
"DATA",101.41,51,10,1,10)
N OI S OI=+$G(ORDIALOG(PROMPT,INST)),ORSERV=+$P($G(^ORD(101.43,OI,0)),U,2) D:ORSERV SERVMSG^ORCDGMRC
"DATA",101.41,51,10,1,"W")
cboService
"DATA",101.41,51,10,2,0)
2^15^^Reason for Request: ^^1
"DATA",101.41,51,10,2,1)
Enter a brief description of why this consult is being requested.
"DATA",101.41,51,10,2,3)
I $G(ORTYPE)="Z"!'$G(GMRCREAF)!($G(GMRCREAF)=1&'FIRST)
"DATA",101.41,51,10,2,7)
D REASON^ORCDGMRC
"DATA",101.41,51,10,2,9)
S:'$D(GMRCREAF) GMRCREAF=$$REAF^GMRCDRFR(+$G(ORSERV))
"DATA",101.41,51,10,2,"W")
memReason
"DATA",101.41,51,10,3,0)
3^10^^^^1
"DATA",101.41,51,10,3,1)
Enter if the service rendered will be on an inpatient or outpatient basis.
"DATA",101.41,51,10,3,5)
I $G(ORESET)'="",ORESET'=$P(Y,U) D CHANGED^ORCDGMRC("CAT")
"DATA",101.41,51,10,3,6)
D SETLIST^ORCD
"DATA",101.41,51,10,3,7)
S:$G(ORTYPE)'="Z" Y=$S($$INPT^ORCD:"I",1:"O")
"DATA",101.41,51,10,3,9)
S ORDIALOG(PROMPT,0)=$P(ORDIALOG(PROMPT,0),";",1,2) ;I or O only
"DATA",101.41,51,10,3,"W")
refCategory
"DATA",101.41,51,10,4,0)
4^7^^^^1^^^^S.GMRCT
"DATA",101.41,51,10,4,1)
Select the urgency indicating how quickly results from this consult are needed.
"DATA",101.41,51,10,4,2)
4^^ROUTINE
"DATA",101.41,51,10,4,7)
S Y=9
"DATA",101.41,51,10,4,9)
D URGENCY^ORCDGMRC("C")
"DATA",101.41,51,10,4,"W")
cboUrgency
"DATA",101.41,51,10,5,0)
5^140^^^^1
"DATA",101.41,51,10,5,1)
Select the preferred place to see the patient for this consult.
"DATA",101.41,51,10,5,2)
3
"DATA",101.41,51,10,5,6)
D LIST^ORCD
"DATA",101.41,51,10,5,7)
S:$G(ORTYPE)'="Z" Y=$S($$VAL^ORCD("CATEGORY")="I":"B",1:"C")
"DATA",101.41,51,10,5,9)
D PLACE^ORCDGMRC
"DATA",101.41,51,10,5,"W")
cboPlace
"DATA",101.41,51,10,6,0)
6^17^^Attention: 
"DATA",101.41,51,10,6,1)
Enter the service/specialty user who is to be notified of this request.
"DATA",101.41,51,10,6,3)
I '$G(GMRCNOAT)
"DATA",101.41,51,10,6,4)
N ORT S ORT=$P(^(0),U,11) I 'ORT!(ORT>DT)
"DATA",101.41,51,10,6,"W")
txtAttn
"DATA",101.41,51,10,7,0)
7^20^^Provisional Diagnosis: 
"DATA",101.41,51,10,7,1)
Enter a preliminary diagnosis relating to this request, up to 240 characters.
"DATA",101.41,51,10,7,3)
I '$G(GMRCNOPD)
"DATA",101.41,51,10,7,5)
D LEX^ORCDGMRC
"DATA",101.41,51,10,7,9)
D ENPDX^ORCDGMRC
"DATA",101.41,51,10,7,"W")
txtProvDiag
"DATA",101.41,51,10,8,0)
1.1^178^^Consult Type: 
"DATA",101.41,51,10,8,1)
Enter the type of consult you wish to have done at this service
"DATA",101.41,51,10,8,2)
1
"DATA",101.41,51,10,8,3)
I $G(ORTYPE)="Z"!$D(ORDIALOG(PROMPT,INST)) ;populated by QO only
"DATA",101.41,51,10,9,0)
7.1^173^^^^^^^^^20
"DATA",101.41,51,10,9,3)
I 0 ;stuffed in via Prov Dx
"DATA",101.41,51,10,10,0)
4.5^15820^^Clinically Indicated Date:^^^^^W
"DATA",101.41,51,10,10,1)
Enter the clinically indicated date for this consult to be performed.
"DATA",101.41,51,10,10,3)
Q:'$G(ORSERV)  I $G(^GMR(123.5,ORSERV,"INT"))'=1
"DATA",101.41,51,10,10,5)
Q:$G(ORTYPE)'="Z"  I $G(ORDIALOG(PROMPT,INST))'["T" K DONE W $C(7),!,"Response must be relative date (e.g. TODAY, T+7D, T+3M)"
"DATA",101.41,51,10,10,7)
S Y=$$GET^XPAR("DIV^SYS^PKG","ORCDGMRC CLIN IND DATE DEFAULT",1,"Q")
"DATA",101.41,51,10,10,10)
N X,Y,%DT S X=$G(ORDIALOG(PROMPT,INST)),%DT="X" I $L(X) D ^%DT S:Y>0 ORDIALOG(PROMPT,INST)=$P(Y,".")
"DATA",101.41,51,10,10,"W")
calClinicallyIndicated
"DATA",101.41,51,10,10,"W7")
S Y=$$GET^XPAR("DIV^SYS^PKG","ORCDGMRC CLIN IND DATE DEFAULT",1,"Q")
"DATA",101.41,51,99)
63861,21761
"DATA",101.41,52,0)
GMRCOR REQUEST^Procedure^^D^43^2^294^1^2
"DATA",101.41,52,4)
K ORSERV,ORPDX,GMRCNOAT,GMRCNOPD,GMRCREAF,ORPROC
"DATA",101.41,52,5)
^^^Procedure^112
"DATA",101.41,52,10,0)
^101.412IA^10^10
"DATA",101.41,52,10,1,0)
1^4^^Procedure: ^^1^^^^S.PROC
"DATA",101.41,52,10,1,1)
Select the procedure you wish to request for this patient.
"DATA",101.41,52,10,1,2)
1
"DATA",101.41,52,10,1,4)
I $$ACTIVE^ORDD43(Y)
"DATA",101.41,52,10,1,5)
I $G(ORESET)'=$P(Y,U) D CKPROCSV^ORCDGMRC Q:'$G(DONE)  D:$G(ORESET) CHANGED^ORCDGMRC("OI")
"DATA",101.41,52,10,1,6)
N IDX,SCR S IDX=$G(ORDIALOG(PROMPT,"D")),SCR=$G(ORDIALOG(PROMPT,"S")) D XHELP^ORDD43(IDX,SCR)
"DATA",101.41,52,10,1,10)
N OI S OI=+$G(ORDIALOG(PROMPT,INST)) I $P($G(^ORD(101.43,OI,0)),"^",2)["99PRC" S ORPROC=$P(^ORD(101.43,OI,0),"^",2) D SERVMSG^ORCDGMRC
"DATA",101.41,52,10,2,0)
2^15^^Reason for Request: ^^1
"DATA",101.41,52,10,2,1)
Enter a brief description of why this procedure is being requested.
"DATA",101.41,52,10,2,3)
I $G(ORTYPE)="Z"!'$G(GMRCREAF)!($G(GMRCREAF)=1&'FIRST)
"DATA",101.41,52,10,2,7)
D REASON^ORCDGMRC
"DATA",101.41,52,10,2,9)
S:'$D(GMRCREAF)&('$G(ORPROC)) GMRCREAF=$$REAF^GMRCDRFR($G(ORPROC))
"DATA",101.41,52,10,3,0)
3^10^^^^1
"DATA",101.41,52,10,3,1)
Enter if the service rendered will be on an inpatient or outpatient basis.
"DATA",101.41,52,10,3,5)
I $G(ORESET)'="",ORESET'=$P(Y,U) D CHANGED^ORCDGMRC("CAT")
"DATA",101.41,52,10,3,6)
D SETLIST^ORCD
"DATA",101.41,52,10,3,7)
S:$G(ORTYPE)'="Z" Y=$S($$INPT^ORCD:"I",1:"O")
"DATA",101.41,52,10,3,9)
S ORDIALOG(PROMPT,0)=$P(ORDIALOG(PROMPT,0),";",1,2) ;I or O only
"DATA",101.41,52,10,4,0)
4^7^^^^1^^^^S.GMRCR
"DATA",101.41,52,10,4,1)
Select the urgency indicating how quickly results from this procedure are needed.
"DATA",101.41,52,10,4,2)
4^^ROUTINE
"DATA",101.41,52,10,4,7)
S Y=9
"DATA",101.41,52,10,4,9)
D URGENCY^ORCDGMRC("R")
"DATA",101.41,52,10,5,0)
5^140^^^^1
"DATA",101.41,52,10,5,1)
Select the preferred place to see the patient for this consult.
"DATA",101.41,52,10,5,2)
3
"DATA",101.41,52,10,5,6)
D LIST^ORCD
"DATA",101.41,52,10,5,7)
S:$G(ORTYPE)'="Z" Y=$S($$VAL^ORCD("CATEGORY")="I":"B",1:"C")
"DATA",101.41,52,10,5,9)
D PLACE^ORCDGMRC
"DATA",101.41,52,10,6,0)
6^17^^Attention: 
"DATA",101.41,52,10,6,1)
Enter the service/specialty user who is to be notified of this request.
"DATA",101.41,52,10,6,3)
I '$G(GMRCNOAT)
"DATA",101.41,52,10,6,4)
N ORT S ORT=$P(^(0),U,11) I 'ORT!(ORT>DT)
"DATA",101.41,52,10,7,0)
7^20^^Provisional Diagnosis: 
"DATA",101.41,52,10,7,1)
Enter a preliminary diagnosis relating to this request, up to 240 characters.
"DATA",101.41,52,10,7,3)
I '$G(GMRCNOPD)
"DATA",101.41,52,10,7,5)
D LEX^ORCDGMRC
"DATA",101.41,52,10,7,9)
D ENPDX^ORCDGMRC
"DATA",101.41,52,10,8,0)
1.1^166^^^^1
"DATA",101.41,52,10,8,1)
Enter the service that will be requested to perform this procedure
"DATA",101.41,52,10,8,2)
2^^^^Proc
"DATA",101.41,52,10,8,3)
I $G(ORDIALOG(PROMPT,"LIST"))>0
"DATA",101.41,52,10,8,6)
D LIST^ORCD
"DATA",101.41,52,10,8,7)
S:+$G(ORDIALOG(PROMPT,"LIST"))=1 Y=+$G(ORDIALOG(PROMPT,"LIST",1))
"DATA",101.41,52,10,8,9)
D PROCSVC^ORCDGMRC
"DATA",101.41,52,10,9,0)
7.1^173^^^^^^^^^20
"DATA",101.41,52,10,9,3)
I 0 ;stuffed in via Prov Dx
"DATA",101.41,52,10,10,0)
4.5^15820^^Clinically Indicated Date:^^^^^W
"DATA",101.41,52,10,10,1)
Enter the clinically indicated date for this procedure to be performed.
"DATA",101.41,52,10,10,5)
Q:$G(ORTYPE)'="Z"  I $G(ORDIALOG(PROMPT,INST))'["T" K DONE W $C(7),!,"Response must be relative date (e.g. TODAY, T+7D, T+3M)"
"DATA",101.41,52,10,10,7)
S Y=$$GET^XPAR("DIV^SYS^PKG","ORCDGMRC CLIN IND DATE DEFAULT",1,"Q")
"DATA",101.41,52,10,10,10)
N X,Y,%DT S X=$G(ORDIALOG(PROMPT,INST)),%DT="X" I $L(X) D ^%DT S:Y>0 ORDATE=$P(Y,".")
"DATA",101.41,52,10,10,"W")
calClinicallyIndicated
"DATA",101.41,52,10,10,"W7")
S Y=$$GET^XPAR("DIV^SYS^PKG","ORCDGMRC CLIN IND DATE DEFAULT",1,"Q")
"DATA",101.41,52,99)
63861,21812
"DATA",101.41,147,0)
PSO OERR^Outpatient Medications^^D^4^2^141^1^2
"DATA",101.41,147,3)
D PROVIDER^ORCDPSIV Q:$G(ORQUIT)  D EN^ORCDPS1("O")
"DATA",101.41,147,3.1)
D EN1^ORCDPS1
"DATA",101.41,147,4)
D EXIT^ORCDPS1
"DATA",101.41,147,5)
^^^Meds, Outpatient^140
"DATA",101.41,147,7)
D SC^ORCDPS3
"DATA",101.41,147,10,0)
^101.412IA^21^21
"DATA",101.41,147,10,1,0)
1^4^^Medication: ^^1^^^^S.O RX
"DATA",101.41,147,10,1,1)
Enter the medication you wish to order for this patient.
"DATA",101.41,147,10,1,2)
1^@1350
"DATA",101.41,147,10,1,4)
I '$G(^(.1))!($G(^(.1))>$$NOW^XLFDT)
"DATA",101.41,147,10,1,5)
D DEA^ORCDPS1 Q:'$G(DONE)  I $G(ORESET)'=+Y D CHANGED^ORCDPS1("OI")
"DATA",101.41,147,10,1,6)
N IDX,SCR S IDX=$G(ORDIALOG(PROMPT,"D")),SCR=$G(ORDIALOG(PROMPT,"S")) D XHELP^ORDD43(IDX,SCR)
"DATA",101.41,147,10,1,9)
D ENOI^ORCDPS1
"DATA",101.41,147,10,1,10)
S OROI=+$G(ORDIALOG(PROMPT,INST)) D ORDITM^ORCDPS1(OROI),NFI^ORCDPS1(OROI)
"DATA",101.41,147,10,2,0)
2^136^^Dose: ^^1^1^^C^^^^Instructions: 
"DATA",101.41,147,10,2,1)
Enter the dosage instructions for this order, as an amount and units.
"DATA",101.41,147,10,2,5)
D CHDOSE^ORCDPS2 Q:'$G(DONE)  D DEFCONJ^ORCDPS1
"DATA",101.41,147,10,2,6)
D LIST^ORCD:$G(ORDIALOG(PROMPT,"LIST")),F^ORCDLGH:'$G(ORDIALOG(PROMPT,"LIST"))
"DATA",101.41,147,10,2,9)
D DOSES^ORCDPS2 I $G(ORDIALOG(PROMPT,"LIST")),'$O(ORDIALOG(PROMPT,0)),'$G(ORENEW) D LIST^ORCD
"DATA",101.41,147,10,2,10)
D EXDOSE^ORCDPS2
"DATA",101.41,147,10,3,0)
2.1^137^^^^1^^^C^^136
"DATA",101.41,147,10,3,1)
Enter the route of administration for this drug.
"DATA",101.41,147,10,3,2)
^1~3
"DATA",101.41,147,10,3,4)
I $P(^(0),U,4)
"DATA",101.41,147,10,3,6)
D LIST^ORCD:$G(ORDIALOG(PROMPT,"LIST"))&(X="?"),P^ORCDLGH:'$G(ORDIALOG(PROMPT,"LIST"))!(X'="?")
"DATA",101.41,147,10,3,7)
D DEFRTE^ORCDPS1
"DATA",101.41,147,10,3,9)
D ROUTES^ORCDPS1
"DATA",101.41,147,10,3,10)
S OROUTE=+$G(ORDIALOG(PROMPT,INST))
"DATA",101.41,147,10,4,0)
2.2^170^^^^1^^^C^^136
"DATA",101.41,147,10,4,1)
Enter a standard schedule for administering this medication.
"DATA",101.41,147,10,4,5)
D CKSCH^ORCDPS1
"DATA",101.41,147,10,4,6)
N DIC,D,DZ S DIC="^PS(51.1,",DIC(0)="EQS",D="APPSJ",DZ="??" D MIX^PSSDI(51.1,"PSJ",.DIC,D,.X)
"DATA",101.41,147,10,4,7)
S:$L($G(^TMP("PSJSCH",$J))) Y=^($J)
"DATA",101.41,147,10,4,9)
I $G(ORTYPE)'="Z" S:ORCAT="I" REQD=$$SCHREQ^PSJORPOE(OROUTE,OROI,$G(ORDRUG))
"DATA",101.41,147,10,4,10)
S ORSCH=$G(ORDIALOG(PROMPT,INST))
"DATA",101.41,147,10,5,0)
8^7^^Priority: ^^1^^^C^S.PSO
"DATA",101.41,147,10,5,.1)
D PRI^ORCDPS3
"DATA",101.41,147,10,5,1)
Enter the urgency of this order.
"DATA",101.41,147,10,5,2)
6^^ROUTINE
"DATA",101.41,147,10,5,7)
S Y=+$$RECALL^ORCD(PROMPT) S:Y EDITONLY=1 S:'Y Y=9
"DATA",101.41,147,10,5,9)
S ORDIALOG(PROMPT,"D")=$S(ORCAT="I":"S.PSJ",1:"S.PSO")
"DATA",101.41,147,10,6,0)
10^15^^Comments: ^^^^^C
"DATA",101.41,147,10,6,1)
Enter any additional instructions for this order.
"DATA",101.41,147,10,6,2)
7
"DATA",101.41,147,10,6,3)
I '$G(PSJNOPC)!($G(ORTYPE)="Z")
"DATA",101.41,147,10,7,0)
1.1^384^^^^^^^^^4
"DATA",101.41,147,10,7,2)
^@1350
"DATA",101.41,147,10,7,3)
I 0 ;stuffed in via Instructions
"DATA",101.41,147,10,8,0)
5.5^149^^^^^^^C
"DATA",101.41,147,10,8,1)
Enter the amount (number of tablets, e.g.) to be dispensed.
"DATA",101.41,147,10,8,2)
8^^^Quantity:^^1
"DATA",101.41,147,10,8,3)
I ORCAT="O"
"DATA",101.41,147,10,8,7)
I $G(ORCAT)="O",$G(ORTYPE)'="Z" S Y=$$QTY^ORCDPS1 K:Y'>0 Y
"DATA",101.41,147,10,8,9)
I ORCAT="O" W:$L($G(ORQTY)) !,ORQTY S ORDIALOG(PROMPT,"A")="Quantity"_$S($L($G(ORQTYUNT)):" ("_ORQTYUNT_"): ",1:": ")
"DATA",101.41,147,10,9,0)
7^148^^Pick Up: ^^1^^^RC
"DATA",101.41,147,10,9,1)
Enter if the patient is to receive this medication by mail, at the window, or in the clinic.
"DATA",101.41,147,10,9,3)
I ORCAT="O"
"DATA",101.41,147,10,9,6)
D SETLIST^ORCD
"DATA",101.41,147,10,9,7)
I ORCAT="O",$G(ORTYPE)'="Z" S Y=$S($G(OREVENT):"W",$D(^PSX(550,"C")):"M",1:"W") I $D(^TMP("ORECALL",$J,ORDIALOG,PROMPT,INST)) S Y=^(INST),EDITONLY=1
"DATA",101.41,147,10,10,0)
6^150^^Refills: ^^1^^^RC
"DATA",101.41,147,10,10,1)
Enter the number of refills to allow for this order.
"DATA",101.41,147,10,10,2)
9^^^Refills:
"DATA",101.41,147,10,10,3)
I ORCAT="O",$G(OREFILLS)>0
"DATA",101.41,147,10,10,9)
I ORCAT="O",'$G(OREFILLS) D MAXREFS^ORCDPS1
"DATA",101.41,147,10,11,0)
9^151^^Is this medication for a SC condition? ^^^^^CW^^^^SC: 
"DATA",101.41,147,10,11,1)
If this medication is for treatment of a service-connected condition, enter YES.
"DATA",101.41,147,10,11,3)
I ORCAT="O",$G(ORCOPAY),$G(ORSC)
"DATA",101.41,147,10,11,6)
N DFN S DFN=+ORVP D DIS^DGRPDB
"DATA",101.41,147,10,11,7)
I $G(ORTYPE)'="Z",ORCAT="O",$G(ORCOPAY),$G(ORSC) S Y=$S($P(ORSC,U,2)>50:1,1:0)
"DATA",101.41,147,10,11,9)
I ORCAT="O" S ORCOPAY=$$ASKSC^ORCDPS1 I ORCOPAY,$G(ORSC),'$D(ORDIALOG(PROMPT,INST)) N DFN S DFN=+ORVP D:$P(ORSC,U,2)'>50 DIS^DGRPDB S:$P(ORSC,U,2)>50 $P(ORDIALOG(PROMPT,0),U)="YA",EDITONLY=1 ; Req'd
"DATA",101.41,147,10,12,0)
2.3^153^^How long: ^^^^^C^^136
"DATA",101.41,147,10,12,1)
Enter the length of time over which this dose is to be administered as '4 HOURS', '7 DAYS', '2 WEEKS', or '1 MONTH'.
"DATA",101.41,147,10,12,2)
^^^FOR
"DATA",101.41,147,10,12,3)
I $$ASKDUR^ORCDPS3
"DATA",101.41,147,10,12,5)
D DUR^ORCDPS3
"DATA",101.41,147,10,12,7)
Q  I $G(ORTYPE)'="Z",$G(ORCAT)="I",$G(ORCOMPLX),$P($G(ORSD),U,3) S Y=+$P(ORSD,U,3)_" DAYS"
"DATA",101.41,147,10,13,0)
4^6^^Start: ^^^^1^C
"DATA",101.41,147,10,13,1)
Enter the date this order should begin.
"DATA",101.41,147,10,13,3)
I $G(ORCAT)="O",$G(OREVENT) ;discharge orders only
"DATA",101.41,147,10,13,7)
Q  I $G(ORTYPE)'="Z",ORCAT'="O" S Y=$P($G(ORSD),U) K:'$L(Y) Y
"DATA",101.41,147,10,13,9)
D START^ORCDPS3 ;I 'FIRST,$G(ORDIALOG(PROMPT,"LIST")),'$O(ORDIALOG(PROMPT,0)) D LIST^ORCD ;editonly
"DATA",101.41,147,10,14,0)
3^385
"DATA",101.41,147,10,14,2)
2^^^^^1^0
"DATA",101.41,147,10,14,3)
I 0 ;created by Instructions, if Outpt order
"DATA",101.41,147,10,15,0)
2.5^386^^^^^^^*^^136
"DATA",101.41,147,10,15,2)
^@
"DATA",101.41,147,10,15,3)
I 0 ;created by Instructions
"DATA",101.41,147,10,15,7)
S Y=$$ID^ORCDPS K:'$L(Y) Y
"DATA",101.41,147,10,16,0)
2.6^138^^^^^^^*
"DATA",101.41,147,10,16,3)
I 0 ;created by Instructions
"DATA",101.41,147,10,17,0)
5^387^^^^1^^^C
"DATA",101.41,147,10,17,1)
Enter the number of days for which the patient needs this medication.
"DATA",101.41,147,10,17,3)
I $G(ORCAT)="O"
"DATA",101.41,147,10,17,5)
I $G(ORESET),+ORESET'=+Y D CHANGED^ORCDPS1("DS")
"DATA",101.41,147,10,17,9)
I $G(ORCAT)="O" D DSUP^ORCDPS1
"DATA",101.41,147,10,17,10)
S:$G(ORCAT)="O" ORDSUP=+$G(ORDIALOG(PROMPT,INST))
"DATA",101.41,147,10,18,0)
1.5^1350
"DATA",101.41,147,10,18,2)
1.5
"DATA",101.41,147,10,18,3)
I 0 ;stuffed in via Instructions
"DATA",101.41,147,10,19,0)
2.4^388^^^^^^^C^^136
"DATA",101.41,147,10,19,.1)
D INPCONJ^ORCDPS1
"DATA",101.41,147,10,19,1)
Enter AND if the next dose is to be administered concurrently with this one, or THEN if it is to follow after.
"DATA",101.41,147,10,19,3)
I $G(ORCOMPLX)
"DATA",101.41,147,10,19,5)
I $G(ORESET)'=$P(Y,U) D CHANGED^ORCDPS1("QUANTITY")
"DATA",101.41,147,10,19,9)
D ENCONJ^ORCDPS1
"DATA",101.41,147,10,19,10)
I $G(ORCOMPLX),'$L($G(ORDIALOG(PROMPT,INST))),FIRST,'$G(ORJUMP) S MAX=1 ;stop prompting dose multiple
"DATA",101.41,147,10,20,0)
3.5^1358^^^^^^^C
"DATA",101.41,147,10,20,2)
3
"DATA",101.41,147,10,20,3)
I 0 ;text stuffed via Entry Action
"DATA",101.41,147,10,20,9)
D PI^ORCDPS2
"DATA",101.41,147,10,21,0)
4.5^1359
"DATA",101.41,147,10,21,2)
10^^^First Dose^^1
"DATA",101.41,147,10,21,3)
I 0 ;set via Entry Action
"DATA",101.41,147,10,21,9)
D NOW^ORCDPS3
"DATA",101.41,147,99)
63628,38688
"FIA",100.9)
OE/RR NOTIFICATIONS
"FIA",100.9,0)
^ORD(100.9,
"FIA",100.9,0,0)
100.9
"FIA",100.9,0,1)
y^y^f^^n^^y^r^n
"FIA",100.9,0,10)

"FIA",100.9,0,11)
I $$INCNOTIF^ORY350E(Y)
"FIA",100.9,0,"RLRO")

"FIA",100.9,0,"VR")
3.0^OR
"FIA",100.9,100.9)
0
"FIA",100.9,100.92)
0
"FIA",101.24)
OE/RR REPORT
"FIA",101.24,0)
^ORD(101.24,
"FIA",101.24,0,0)
101.24I
"FIA",101.24,0,1)
y^n^f^^y^^y^r^n
"FIA",101.24,0,10)

"FIA",101.24,0,11)
I (Y>999)!(Y=31)
"FIA",101.24,0,"RLRO")

"FIA",101.24,0,"VR")
3.0^OR
"FIA",101.24,101.24)
0
"FIA",101.24,101.241)
0
"FIA",101.24,101.243)
0
"FIA",101.41)
ORDER DIALOG
"FIA",101.41,0)
^ORD(101.41,
"FIA",101.41,0,0)
101.41I
"FIA",101.41,0,1)
n^n^f^^y^^y^r^n
"FIA",101.41,0,10)

"FIA",101.41,0,11)
I $$SENDDLG^ORY350($P(^(0),U))
"FIA",101.41,0,"RLRO")

"FIA",101.41,0,"VR")
3.0^OR
"FIA",101.41,101.41)
0
"FIA",101.41,101.411)
0
"FIA",101.41,101.412)
0
"FIA",101.41,101.41218)
0
"FIA",101.41,101.415)
0
"FIA",101.41,101.416)
0
"FIA",101.41,101.4162)
0
"FRV1",101.24,"1004,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1004,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1004,0",21)
DISCHARGE SUMMARY
"FRV1",101.24,"1004,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1006,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1006,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1007,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1007,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1018,0",21)
MAS DEMOGRAPHICS
"FRV1",101.24,"1018,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1028,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1028,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1028,0",21)
SURGERY REPORTS
"FRV1",101.24,"1028,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1029,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1029,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1029,0",21)
VITAL SIGNS
"FRV1",101.24,"1029,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1032,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1032,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1032,0",21)
ADVERSE REACTIONS/ALLERG BRIEF
"FRV1",101.24,"1032,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1033,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1033,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1033,0",21)
MAS DEMOGRAPHICS
"FRV1",101.24,"1033,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1034,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1034,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1035,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1035,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1035,0",21)
MAS DISABILITIES
"FRV1",101.24,"1035,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1036,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1036,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1036,0",21)
MAS ADMISSIONS/DISCHARGES
"FRV1",101.24,"1036,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1037,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1037,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1037,0",21)
MAS ADT HISTORY EXPANDED
"FRV1",101.24,"1037,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1038,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1038,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1038,0",21)
MAS DISCHARGE DIAGNOSIS
"FRV1",101.24,"1038,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1039,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1039,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1039,0",21)
MAS DISCHARGES
"FRV1",101.24,"1039,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1040,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1040,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1040,0",21)
MAS CLINIC VISITS FUTURE
"FRV1",101.24,"1040,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1041,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1041,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1041,0",21)
MAS PROCEDURES ICD CODES
"FRV1",101.24,"1041,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1042,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1042,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1042,0",21)
MAS SURGERIES ICD CODES
"FRV1",101.24,"1042,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1043,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1043,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1043,0",21)
MAS TRANSFERS
"FRV1",101.24,"1043,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1044,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1044,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1044,0",21)
MAS TREATING SPECIALTY
"FRV1",101.24,"1044,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1045,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1045,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1045,0",21)
COMPENSATION AND PENSION EXAMS
"FRV1",101.24,"1045,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1046,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1046,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1046,0",21)
DIETETICS
"FRV1",101.24,"1046,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1047,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1047,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1047,0",21)
DIETETICS
"FRV1",101.24,"1047,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1048,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1048,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1049,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1049,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1050,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1050,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1051,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1051,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1051,0",21)
LAB BLOOD AVAILABILITY
"FRV1",101.24,"1051,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1052,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1052,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1052,0",21)
LAB BLOOD TRANSFUSIONS
"FRV1",101.24,"1052,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1054,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1054,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1054,0",21)
LAB MICROBIOLOGY
"FRV1",101.24,"1054,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1055,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1055,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1055,0",21)
LAB CHEMISTRY & HEMATOLOGY
"FRV1",101.24,"1055,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1056,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1056,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1057,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1057,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1057,0",21)
LAB ORDERS
"FRV1",101.24,"1057,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1058,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1058,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1059,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1059,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1060,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1060,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1060,0",21)
MAS ADT HISTORY
"FRV1",101.24,"1060,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1061,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1061,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1061,0",21)
MEDICINE ABNORMAL BRIEF
"FRV1",101.24,"1061,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1062,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1062,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1062,0",21)
MEDICINE BRIEF REPORT
"FRV1",101.24,"1062,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1063,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1063,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1063,0",21)
MEDICINE FULL CAPTIONED
"FRV1",101.24,"1063,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1064,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1064,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1064,0",21)
MEDICINE FULL REPORT
"FRV1",101.24,"1064,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1065,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1065,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1065,0",21)
MAS CLINIC VISITS PAST
"FRV1",101.24,"1065,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1066,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1066,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1066,0",21)
PCE EDUCATION
"FRV1",101.24,"1066,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1067,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1067,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1067,0",21)
PCE EDUCATION LATEST
"FRV1",101.24,"1067,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1068,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1068,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1068,0",21)
GLOBAL ASSESSMENT FUNCTIONING
"FRV1",101.24,"1068,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1069,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1069,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1069,0",21)
PCE HEALTH FACTORS ALL
"FRV1",101.24,"1069,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1070,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1070,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1070,0",21)
PCE IMMUNIZATIONS
"FRV1",101.24,"1070,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1071,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1071,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1071,0",21)
PCE LOCATION OF HOME
"FRV1",101.24,"1071,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1072,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1072,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1072,0",21)
PCE OUTPATIENT DIAGNOSIS
"FRV1",101.24,"1072,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1073,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1073,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1073,0",21)
PCE OUTPATIENT ENCOUNTERS
"FRV1",101.24,"1073,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1074,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1074,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1074,0",21)
PCE SKIN TESTS
"FRV1",101.24,"1074,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1076,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1076,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1076,0",21)
PCE EXAMS LATEST
"FRV1",101.24,"1076,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1077,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1077,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1077,0",21)
PCE TREATMENTS PROVIDED
"FRV1",101.24,"1077,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1078,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1078,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1079,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1079,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1079,0",21)
PHARMACY OUTPATIENT
"FRV1",101.24,"1079,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1080,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1080,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1081,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1081,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1081,0",21)
PHARMACY INTRAVENOUS
"FRV1",101.24,"1081,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1082,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1082,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1082,0",21)
PHARMACY UNIT DOSE
"FRV1",101.24,"1082,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1083,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1083,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1083,0",21)
PROBLEM LIST ACTIVE
"FRV1",101.24,"1083,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1084,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1084,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1084,0",21)
PROBLEM LIST ALL
"FRV1",101.24,"1084,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1085,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1085,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1085,0",21)
PROBLEM LIST INACTIVE
"FRV1",101.24,"1085,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1086,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1086,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1086,0",21)
PROGRESS NOTES
"FRV1",101.24,"1086,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1087,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1087,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1087,0",21)
ADVANCE DIRECTIVE
"FRV1",101.24,"1087,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1088,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1088,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1088,0",21)
CLINICAL WARNINGS
"FRV1",101.24,"1088,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1089,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1089,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1089,0",21)
CRISIS NOTES
"FRV1",101.24,"1089,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1090,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1090,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1090,0",21)
IMAGING IMPRESSION
"FRV1",101.24,"1090,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1091,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1091,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1091,0",21)
IMAGING PROFILE
"FRV1",101.24,"1091,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1092,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1092,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1092,0",21)
IMAGING STATUS
"FRV1",101.24,"1092,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1093,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1093,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1094,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1094,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1095,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1095,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1096,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1096,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1097,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1097,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1098,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1098,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1100,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1100,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1100,0",21)
ORDERS CURRENT
"FRV1",101.24,"1100,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1101,0",21)
MAS DEMOGRAPHICS
"FRV1",101.24,"1101,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1105,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1105,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1105,0",21)
PHARMACY OUTPATIENT
"FRV1",101.24,"1105,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1106,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1106,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1106,0",21)
IMAGING PROFILE
"FRV1",101.24,"1106,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1110,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1110,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1110,0",21)
LAB ORDERS
"FRV1",101.24,"1110,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1111,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1111,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1111,0",21)
LAB ORDERS
"FRV1",101.24,"1111,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1112,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1112,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1112,0",21)
LAB ORDERS
"FRV1",101.24,"1112,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1113,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1113,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1113,0",21)
LAB ORDERS
"FRV1",101.24,"1113,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1114,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1114,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1114,0",21)
LAB ORDERS
"FRV1",101.24,"1114,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1130,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1130,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1130,0",21)
DISCHARGE SUMMARY
"FRV1",101.24,"1130,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1131,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1131,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1131,0",21)
MAS ADT HISTORY EXPANDED
"FRV1",101.24,"1131,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1132,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1132,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1132,0",21)
LAB CHEMISTRY & HEMATOLOGY
"FRV1",101.24,"1132,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1133,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1133,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1133,0",21)
LAB MICROBIOLOGY
"FRV1",101.24,"1133,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1134,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1134,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1134,0",21)
LAB ORDERS
"FRV1",101.24,"1134,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1135,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1135,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1135,0",21)
LAB SURGICAL PATHOLOGY
"FRV1",101.24,"1135,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1136,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1136,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1136,0",21)
LAB CYTOPATHOLOGY
"FRV1",101.24,"1136,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1137,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1137,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1137,0",21)
ADVERSE REACTIONS/ALLERG BRIEF
"FRV1",101.24,"1137,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1138,0",13)
ORQQPX IMMUN LIST
"FRV1",101.24,"1138,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1138,0",18)
ORCV VISIT DETAILS
"FRV1",101.24,"1138,0",18,"F")
;ORD(101.24,
"FRV1",101.24,"1139,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1139,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1140,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1140,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1140,0",21)
PCE OUTPATIENT ENCOUNTERS
"FRV1",101.24,"1140,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1141,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1141,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1141,0",21)
VITAL SIGNS
"FRV1",101.24,"1141,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1144,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1144,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1145,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1145,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1146,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1146,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1147,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1147,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1551,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1551,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1551,0",21)
ADVERSE REACTIONS/ALLERG BRIEF
"FRV1",101.24,"1551,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1552,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1552,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1552,0",21)
VITAL SIGNS
"FRV1",101.24,"1552,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1553,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1553,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1553,0",21)
PHARMACY OUTPATIENT
"FRV1",101.24,"1553,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1554,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1554,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1554,0",21)
PROGRESS NOTES
"FRV1",101.24,"1554,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1555,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1555,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1556,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1556,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1556,0",21)
LAB CHEMISTRY & HEMATOLOGY
"FRV1",101.24,"1556,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1557,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1557,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1557,0",21)
PROBLEM LIST ALL
"FRV1",101.24,"1557,0",21,"F")
;GMT(142.1,
"FRV1",101.24,"1558,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1558,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1600,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1600,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1601,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1601,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1602,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1602,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1603,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1603,0",13,"F")
;XWB(8994,
"FRV1",101.24,"1604,0",13)
ORWRP REPORT TEXT
"FRV1",101.24,"1604,0",13,"F")
;XWB(8994,
"FRV1",101.24,"31,0",13)
ORWPS COVER
"FRV1",101.24,"31,0",13,"F")
;XWB(8994,
"FRV1",101.24,"31,0",18)
ORCV ACTIVE MED DETAILS
"FRV1",101.24,"31,0",18,"F")
;ORD(101.24,
"FRV1",101.41,"147,0",5)
OUTPATIENT MEDICATIONS
"FRV1",101.41,"147,0",5,"F")
;ORD(100.98,
"FRV1",101.41,"147,0",7)
OUTPATIENT PHARMACY
"FRV1",101.41,"147,0",7,"F")
;DIC(9.4,
"FRV1",101.41,"147,10,1,0",2)
OR GTX ORDERABLE ITEM
"FRV1",101.41,"147,10,1,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,10,0",2)
OR GTX REFILLS
"FRV1",101.41,"147,10,10,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,11,0",2)
OR GTX SERVICE CONNECTED
"FRV1",101.41,"147,10,11,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,12,0",2)
OR GTX DURATION
"FRV1",101.41,"147,10,12,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,12,0",11)
OR GTX INSTRUCTIONS
"FRV1",101.41,"147,10,12,0",11,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,13,0",2)
OR GTX START DATE/TIME
"FRV1",101.41,"147,10,13,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,14,0",2)
OR GTX SIG
"FRV1",101.41,"147,10,14,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,15,0",2)
OR GTX DOSE
"FRV1",101.41,"147,10,15,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,15,0",11)
OR GTX INSTRUCTIONS
"FRV1",101.41,"147,10,15,0",11,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,16,0",2)
OR GTX DISPENSE DRUG
"FRV1",101.41,"147,10,16,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,17,0",2)
OR GTX DAYS SUPPLY
"FRV1",101.41,"147,10,17,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,18,0",2)
OR GTX DRUG NAME
"FRV1",101.41,"147,10,18,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,19,0",2)
OR GTX AND/THEN
"FRV1",101.41,"147,10,19,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,19,0",11)
OR GTX INSTRUCTIONS
"FRV1",101.41,"147,10,19,0",11,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,2,0",2)
OR GTX INSTRUCTIONS
"FRV1",101.41,"147,10,2,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,20,0",2)
OR GTX PATIENT INSTRUCTIONS
"FRV1",101.41,"147,10,20,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,21,0",2)
OR GTX NOW
"FRV1",101.41,"147,10,21,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,3,0",2)
OR GTX ROUTE
"FRV1",101.41,"147,10,3,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,3,0",11)
OR GTX INSTRUCTIONS
"FRV1",101.41,"147,10,3,0",11,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,4,0",2)
OR GTX SCHEDULE
"FRV1",101.41,"147,10,4,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,4,0",11)
OR GTX INSTRUCTIONS
"FRV1",101.41,"147,10,4,0",11,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,5,0",2)
OR GTX URGENCY
"FRV1",101.41,"147,10,5,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,6,0",2)
OR GTX WORD PROCESSING 1
"FRV1",101.41,"147,10,6,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,7,0",2)
OR GTX STRENGTH
"FRV1",101.41,"147,10,7,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,7,0",11)
OR GTX ORDERABLE ITEM
"FRV1",101.41,"147,10,7,0",11,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,8,0",2)
OR GTX QUANTITY
"FRV1",101.41,"147,10,8,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"147,10,9,0",2)
OR GTX ROUTING
"FRV1",101.41,"147,10,9,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,0",5)
CONSULTS
"FRV1",101.41,"51,0",5,"F")
;ORD(100.98,
"FRV1",101.41,"51,0",7)
CONSULT/REQUEST TRACKING
"FRV1",101.41,"51,0",7,"F")
;DIC(9.4,
"FRV1",101.41,"51,10,1,0",2)
OR GTX ORDERABLE ITEM
"FRV1",101.41,"51,10,1,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,10,0",2)
OR GTX CLINICALLY INDICATED DATE
"FRV1",101.41,"51,10,10,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,2,0",2)
OR GTX WORD PROCESSING 1
"FRV1",101.41,"51,10,2,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,3,0",2)
OR GTX CATEGORY
"FRV1",101.41,"51,10,3,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,4,0",2)
OR GTX URGENCY
"FRV1",101.41,"51,10,4,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,5,0",2)
OR GTX PLACE OF CONSULTATION
"FRV1",101.41,"51,10,5,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,6,0",2)
OR GTX PROVIDER
"FRV1",101.41,"51,10,6,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,7,0",2)
OR GTX FREE TEXT
"FRV1",101.41,"51,10,7,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,8,0",2)
OR GTX FREE TEXT OI
"FRV1",101.41,"51,10,8,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,9,0",2)
OR GTX CODE
"FRV1",101.41,"51,10,9,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"51,10,9,0",11)
OR GTX FREE TEXT
"FRV1",101.41,"51,10,9,0",11,"F")
;ORD(101.41,
"FRV1",101.41,"52,0",5)
PROCEDURES
"FRV1",101.41,"52,0",5,"F")
;ORD(100.98,
"FRV1",101.41,"52,0",7)
CONSULT/REQUEST TRACKING
"FRV1",101.41,"52,0",7,"F")
;DIC(9.4,
"FRV1",101.41,"52,10,1,0",2)
OR GTX ORDERABLE ITEM
"FRV1",101.41,"52,10,1,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,10,0",2)
OR GTX CLINICALLY INDICATED DATE
"FRV1",101.41,"52,10,10,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,2,0",2)
OR GTX WORD PROCESSING 1
"FRV1",101.41,"52,10,2,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,3,0",2)
OR GTX CATEGORY
"FRV1",101.41,"52,10,3,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,4,0",2)
OR GTX URGENCY
"FRV1",101.41,"52,10,4,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,5,0",2)
OR GTX PLACE OF CONSULTATION
"FRV1",101.41,"52,10,5,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,6,0",2)
OR GTX PROVIDER
"FRV1",101.41,"52,10,6,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,7,0",2)
OR GTX FREE TEXT
"FRV1",101.41,"52,10,7,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,8,0",2)
OR GTX REQUEST SERVICE
"FRV1",101.41,"52,10,8,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,9,0",2)
OR GTX CODE
"FRV1",101.41,"52,10,9,0",2,"F")
;ORD(101.41,
"FRV1",101.41,"52,10,9,0",11)
OR GTX FREE TEXT
"FRV1",101.41,"52,10,9,0",11,"F")
;ORD(101.41,
"INI")
PRE^ORY350
"INIT")
POST^ORY350
"IX",101.41,101.41,"B",0)
101.41^B^Regular B index using full field length^R^^F^IR^I^101.41^^^^^LS
"IX",101.41,101.41,"B",1)
S ^ORD(101.41,"B",$E(X,1,63),DA)=""
"IX",101.41,101.41,"B",2)
K ^ORD(101.41,"B",$E(X,1,63),DA)
"IX",101.41,101.41,"B",2.5)
K ^ORD(101.41,"B")
"IX",101.41,101.41,"B",11.1,0)
^.114IA^1^1
"IX",101.41,101.41,"B",11.1,1,0)
1^F^101.41^.01^63^1^F
"KRN",19,10989,-1)
0^1
"KRN",19,10989,0)
OR CPRS GUI CHART^CPRSChart version 1.0.30.72^^B^^^^^^^^
"KRN",19,10989,1,0)
^19.06^2^2^3151015^^^^
"KRN",19,10989,1,1,0)
This option is required by the Kernel Broker to give access to the
"KRN",19,10989,1,2,0)
RPCs used by the CPRS GUI (CPRSChart.EXE).
"KRN",19,10989,99)
60921,44613
"KRN",19,10989,99.1)
63749,48054
"KRN",19,10989,"RPC",0)
^19.05P^2156^2145
"KRN",19,10989,"RPC",1,0)
GMRC LIST CONSULT REQUESTS
"KRN",19,10989,"RPC",218,0)
XWB GET VARIABLE VALUE
"KRN",19,10989,"RPC",219,0)
TIU AUTHORIZATION
"KRN",19,10989,"RPC",220,0)
TIU CAN CHANGE COSIGNER?
"KRN",19,10989,"RPC",221,0)
TIU CREATE ADDENDUM RECORD
"KRN",19,10989,"RPC",222,0)
TIU CREATE RECORD
"KRN",19,10989,"RPC",223,0)
TIU DELETE RECORD
"KRN",19,10989,"RPC",224,0)
TIU DETAILED DISPLAY
"KRN",19,10989,"RPC",225,0)
TIU DOCUMENTS BY CONTEXT
"KRN",19,10989,"RPC",226,0)
TIU GET ADDITIONAL SIGNERS
"KRN",19,10989,"RPC",227,0)
TIU GET ALERT INFO
"KRN",19,10989,"RPC",228,0)
TIU GET DOCUMENT PARAMETERS
"KRN",19,10989,"RPC",229,0)
TIU GET DS TITLES
"KRN",19,10989,"RPC",230,0)
TIU GET DS URGENCIES
"KRN",19,10989,"RPC",231,0)
TIU GET PERSONAL PREFERENCES
"KRN",19,10989,"RPC",232,0)
TIU GET PN TITLES
"KRN",19,10989,"RPC",233,0)
TIU GET RECORD TEXT
"KRN",19,10989,"RPC",234,0)
TIU IDENTIFY CONSULTS CLASS
"KRN",19,10989,"RPC",235,0)
TIU IS THIS A CONSULT?
"KRN",19,10989,"RPC",236,0)
TIU JUSTIFY DELETE?
"KRN",19,10989,"RPC",237,0)
TIU LOAD BOILERPLATE TEXT
"KRN",19,10989,"RPC",238,0)
TIU LOAD RECORD FOR EDIT
"KRN",19,10989,"RPC",239,0)
TIU LOCK RECORD
"KRN",19,10989,"RPC",240,0)
TIU LONG LIST CONSULT TITLES
"KRN",19,10989,"RPC",241,0)
TIU LONG LIST OF TITLES
"KRN",19,10989,"RPC",242,0)
TIU NOTES
"KRN",19,10989,"RPC",243,0)
TIU NOTES 16 BIT
"KRN",19,10989,"RPC",244,0)
TIU NOTES BY VISIT
"KRN",19,10989,"RPC",245,0)
TIU PERSONAL TITLE LIST
"KRN",19,10989,"RPC",246,0)
TIU PRINT RECORD
"KRN",19,10989,"RPC",247,0)
TIU REQUIRES COSIGNATURE
"KRN",19,10989,"RPC",248,0)
TIU SIGN RECORD
"KRN",19,10989,"RPC",249,0)
TIU SUMMARIES
"KRN",19,10989,"RPC",250,0)
TIU SUMMARIES BY VISIT
"KRN",19,10989,"RPC",251,0)
TIU UNLOCK RECORD
"KRN",19,10989,"RPC",252,0)
TIU UPDATE ADDITIONAL SIGNERS
"KRN",19,10989,"RPC",253,0)
TIU UPDATE RECORD
"KRN",19,10989,"RPC",254,0)
TIU WHICH SIGNATURE ACTION
"KRN",19,10989,"RPC",1032,0)
ORB DELETE ALERT
"KRN",19,10989,"RPC",1033,0)
ORB FOLLOW-UP ARRAY
"KRN",19,10989,"RPC",1034,0)
ORB FOLLOW-UP STRING
"KRN",19,10989,"RPC",1035,0)
ORB FOLLOW-UP TYPE
"KRN",19,10989,"RPC",1036,0)
ORB SORT METHOD
"KRN",19,10989,"RPC",1037,0)
ORK TRIGGER
"KRN",19,10989,"RPC",1038,0)
ORQ NULL LIST
"KRN",19,10989,"RPC",1039,0)
ORQOR DETAIL
"KRN",19,10989,"RPC",1040,0)
TIU TEMPLATE CHECK BOILERPLATE
"KRN",19,10989,"RPC",1041,0)
TIU TEMPLATE CREATE/MODIFY
"KRN",19,10989,"RPC",1042,0)
TIU TEMPLATE DELETE
"KRN",19,10989,"RPC",1045,0)
TIU TEMPLATE GETPROOT
"KRN",19,10989,"RPC",1049,0)
TIU TEMPLATE LISTOWNR
"KRN",19,10989,"RPC",1050,0)
TIU TEMPLATE SET ITEMS
"KRN",19,10989,"RPC",1051,0)
TIU GET LIST OF OBJECTS
"KRN",19,10989,"RPC",1052,0)
ORQOR LIST
"KRN",19,10989,"RPC",1053,0)
ORQORB SORT
"KRN",19,10989,"RPC",1054,0)
ORQPT ATTENDING/PRIMARY
"KRN",19,10989,"RPC",1055,0)
ORQPT CLINIC PATIENTS
"KRN",19,10989,"RPC",1056,0)
ORQPT CLINICS
"KRN",19,10989,"RPC",1057,0)
ORQPT DEFAULT LIST SOURCE
"KRN",19,10989,"RPC",1058,0)
ORQPT DEFAULT PATIENT LIST
"KRN",19,10989,"RPC",1059,0)
ORQPT PATIENT TEAM PROVIDERS
"KRN",19,10989,"RPC",1060,0)
ORQPT PROVIDER PATIENTS
"KRN",19,10989,"RPC",1061,0)
ORQPT PROVIDERS
"KRN",19,10989,"RPC",1062,0)
ORQPT SPECIALTIES
"KRN",19,10989,"RPC",1063,0)
ORQPT SPECIALTY PATIENTS
"KRN",19,10989,"RPC",1064,0)
ORQPT TEAM PATIENTS
"KRN",19,10989,"RPC",1065,0)
ORQPT TEAMS
"KRN",19,10989,"RPC",1066,0)
ORQPT WARD PATIENTS
"KRN",19,10989,"RPC",1067,0)
ORQPT WARDRMBED
"KRN",19,10989,"RPC",1068,0)
ORQPT WARDS
"KRN",19,10989,"RPC",1069,0)
ORQQAL DETAIL
"KRN",19,10989,"RPC",1070,0)
ORQQAL LIST
"KRN",19,10989,"RPC",1071,0)
ORQQAL LIST REPORT
"KRN",19,10989,"RPC",1072,0)
ORQQCN ADDCMT
"KRN",19,10989,"RPC",1073,0)
ORQQCN ADMIN COMPLETE
"KRN",19,10989,"RPC",1074,0)
ORQQCN DETAIL
"KRN",19,10989,"RPC",1075,0)
ORQQCN DISCONTINUE
"KRN",19,10989,"RPC",1076,0)
ORQQCN FIND CONSULT
"KRN",19,10989,"RPC",1077,0)
ORQQCN FORWARD
"KRN",19,10989,"RPC",1078,0)
ORQQCN GET CONSULT
"KRN",19,10989,"RPC",1079,0)
ORQQCN GET ORDER NUMBER
"KRN",19,10989,"RPC",1080,0)
ORQQCN GET PROC SVCS
"KRN",19,10989,"RPC",1081,0)
ORQQCN LIST
"KRN",19,10989,"RPC",1082,0)
ORQQCN LOAD FOR EDIT
"KRN",19,10989,"RPC",1083,0)
ORQQCN MED RESULTS
"KRN",19,10989,"RPC",1084,0)
ORQQCN PRINT SF513
"KRN",19,10989,"RPC",1085,0)
ORQQCN RECEIVE
"KRN",19,10989,"RPC",1086,0)
ORQQCN RESUBMIT
"KRN",19,10989,"RPC",1087,0)
ORQQCN SET ACT MENUS
"KRN",19,10989,"RPC",1088,0)
ORQQCN SHOW SF513
"KRN",19,10989,"RPC",1089,0)
ORQQCN SIGFIND
"KRN",19,10989,"RPC",1090,0)
ORQQCN STATUS
"KRN",19,10989,"RPC",1091,0)
ORQQCN SVCLIST
"KRN",19,10989,"RPC",1092,0)
ORQQCN SVCTREE
"KRN",19,10989,"RPC",1093,0)
ORQQCN URGENCIES
"KRN",19,10989,"RPC",1094,0)
ORQQCN2 GET CONTEXT
"KRN",19,10989,"RPC",1095,0)
ORQQCN2 SAVE CONTEXT
"KRN",19,10989,"RPC",1096,0)
ORQQLR DETAIL
"KRN",19,10989,"RPC",1097,0)
ORQQLR SEARCH RANGE INPT
"KRN",19,10989,"RPC",1098,0)
ORQQLR SEARCH RANGE OUTPT
"KRN",19,10989,"RPC",1099,0)
ORQQPL ADD SAVE
"KRN",19,10989,"RPC",1100,0)
ORQQPL AUDIT HIST
"KRN",19,10989,"RPC",1101,0)
ORQQPL CHECK DUP
"KRN",19,10989,"RPC",1102,0)
ORQQPL CLIN FILTER LIST
"KRN",19,10989,"RPC",1103,0)
ORQQPL CLIN SRCH
"KRN",19,10989,"RPC",1104,0)
ORQQPL DELETE
"KRN",19,10989,"RPC",1105,0)
ORQQPL DETAIL
"KRN",19,10989,"RPC",1106,0)
ORQQPL EDIT LOAD
"KRN",19,10989,"RPC",1107,0)
ORQQPL EDIT SAVE
"KRN",19,10989,"RPC",1108,0)
ORQQPL INACTIVATE
"KRN",19,10989,"RPC",1109,0)
ORQQPL INIT PT
"KRN",19,10989,"RPC",1110,0)
ORQQPL INIT USER
"KRN",19,10989,"RPC",1111,0)
ORQQPL LIST
"KRN",19,10989,"RPC",1112,0)
ORQQPL PROB COMMENTS
"KRN",19,10989,"RPC",1113,0)
ORQQPL PROBLEM LEX SEARCH
"KRN",19,10989,"RPC",1114,0)
ORQQPL PROBLEM LIST
"KRN",19,10989,"RPC",1115,0)
ORQQPL PROV FILTER LIST
"KRN",19,10989,"RPC",1116,0)
ORQQPL PROVIDER LIST
"KRN",19,10989,"RPC",1117,0)
ORQQPL REPLACE
"KRN",19,10989,"RPC",1118,0)
ORQQPL SAVEVIEW
"KRN",19,10989,"RPC",1119,0)
ORQQPL SERV FILTER LIST
"KRN",19,10989,"RPC",1120,0)
ORQQPL SRVC SRCH
"KRN",19,10989,"RPC",1121,0)
ORQQPL UPDATE
"KRN",19,10989,"RPC",1122,0)
ORQQPL USER PROB CATS
"KRN",19,10989,"RPC",1123,0)
ORQQPL USER PROB LIST
"KRN",19,10989,"RPC",1124,0)
ORQQPL VERIFY
"KRN",19,10989,"RPC",1125,0)
ORQQPP LIST
"KRN",19,10989,"RPC",1126,0)
ORQQPS DETAIL
"KRN",19,10989,"RPC",1127,0)
ORQQPS LIST
"KRN",19,10989,"RPC",1133,0)
ORQQPX REMINDER DETAIL
"KRN",19,10989,"RPC",1135,0)
ORQQPX REMINDERS LIST
"KRN",19,10989,"RPC",1136,0)
ORQQVI NOTEVIT
"KRN",19,10989,"RPC",1137,0)
ORQQVI VITALS
"KRN",19,10989,"RPC",1138,0)
ORQQVI VITALS FOR DATE RANGE
"KRN",19,10989,"RPC",1139,0)
ORQQVI1 DETAIL
"KRN",19,10989,"RPC",1140,0)
ORQQVI1 GRID
"KRN",19,10989,"RPC",1141,0)
ORQQVI2 VITALS HELP
"KRN",19,10989,"RPC",1142,0)
ORQQVI2 VITALS RATE CHECK
"KRN",19,10989,"RPC",1144,0)
ORQQVI2 VITALS VAL & STORE
"KRN",19,10989,"RPC",1145,0)
ORQQVI2 VITALS VALIDATE
"KRN",19,10989,"RPC",1146,0)
ORQQVI2 VITALS VALIDATE TYPE
"KRN",19,10989,"RPC",1147,0)
ORQQVS DETAIL NOTES
"KRN",19,10989,"RPC",1148,0)
ORQQVS DETAIL SUMMARY
"KRN",19,10989,"RPC",1149,0)
ORQQVS VISITS/APPTS
"KRN",19,10989,"RPC",1150,0)
ORQQXMB MAIL GROUPS
"KRN",19,10989,"RPC",1151,0)
ORQQXQA PATIENT
"KRN",19,10989,"RPC",1152,0)
ORQQXQA USER
"KRN",19,10989,"RPC",1153,0)
ORWCH LOADALL
"KRN",19,10989,"RPC",1154,0)
ORWCH LOADSIZ
"KRN",19,10989,"RPC",1155,0)
ORWCH SAVEALL
"KRN",19,10989,"RPC",1156,0)
ORWCH SAVESIZ
"KRN",19,10989,"RPC",1157,0)
ORWCS LIST OF CONSULT REPORTS
"KRN",19,10989,"RPC",1158,0)
ORWCS PRINT REPORT
"KRN",19,10989,"RPC",1159,0)
ORWCS REPORT TEXT
"KRN",19,10989,"RPC",1160,0)
ORWCV DTLVST
"KRN",19,10989,"RPC",1161,0)
ORWCV LAB
"KRN",19,10989,"RPC",1162,0)
ORWCV POLL
"KRN",19,10989,"RPC",1163,0)
ORWCV START
"KRN",19,10989,"RPC",1164,0)
ORWCV STOP
"KRN",19,10989,"RPC",1165,0)
ORWCV VST
"KRN",19,10989,"RPC",1166,0)
ORWD DEF
"KRN",19,10989,"RPC",1167,0)
ORWD DT
"KRN",19,10989,"RPC",1168,0)
ORWD FORMID
"KRN",19,10989,"RPC",1169,0)
ORWD GET4EDIT
"KRN",19,10989,"RPC",1170,0)
ORWD KEY
"KRN",19,10989,"RPC",1171,0)
ORWD OI
"KRN",19,10989,"RPC",1172,0)
ORWD PROVKEY
"KRN",19,10989,"RPC",1173,0)
ORWD SAVE
"KRN",19,10989,"RPC",1174,0)
ORWD SAVEACT
"KRN",19,10989,"RPC",1175,0)
ORWD SIGN
"KRN",19,10989,"RPC",1176,0)
ORWD VALIDACT
"KRN",19,10989,"RPC",1177,0)
ORWD1 PARAM
"KRN",19,10989,"RPC",1178,0)
ORWD1 PRINTGUI
"KRN",19,10989,"RPC",1179,0)
ORWD1 RVPRINT
"KRN",19,10989,"RPC",1180,0)
ORWD2 DEVINFO
"KRN",19,10989,"RPC",1181,0)
ORWD2 MANUAL
"KRN",19,10989,"RPC",1182,0)
ORWDAL32 ALLERGY MATCH
"KRN",19,10989,"RPC",1183,0)
ORWDAL32 DEF
"KRN",19,10989,"RPC",1184,0)
ORWDAL32 SYMPTOMS
"KRN",19,10989,"RPC",1185,0)
ORWDCN32 DEF
"KRN",19,10989,"RPC",1186,0)
ORWDCN32 ORDRMSG
"KRN",19,10989,"RPC",1187,0)
ORWDCN32 PROCEDURES
"KRN",19,10989,"RPC",1188,0)
ORWDCSLT DEF
"KRN",19,10989,"RPC",1189,0)
ORWDCSLT LOOK200
"KRN",19,10989,"RPC",1190,0)
ORWDFH ADDLATE
"KRN",19,10989,"RPC",1191,0)
ORWDFH ATTR
"KRN",19,10989,"RPC",1192,0)
ORWDFH CURISO
"KRN",19,10989,"RPC",1193,0)
ORWDFH DIETS
"KRN",19,10989,"RPC",1194,0)
ORWDFH FINDTYP
"KRN",19,10989,"RPC",1195,0)
ORWDFH ISOIEN
"KRN",19,10989,"RPC",1196,0)
ORWDFH ISOLIST
"KRN",19,10989,"RPC",1197,0)
ORWDFH PARAM
"KRN",19,10989,"RPC",1198,0)
ORWDFH QTY2CC
"KRN",19,10989,"RPC",1199,0)
ORWDFH TFPROD
"KRN",19,10989,"RPC",1200,0)
ORWDFH TXT
"KRN",19,10989,"RPC",1201,0)
ORWDGX LOAD
"KRN",19,10989,"RPC",1202,0)
ORWDGX VMDEF
"KRN",19,10989,"RPC",1203,0)
ORWDLR ABBSPEC
"KRN",19,10989,"RPC",1204,0)
ORWDLR ALLSAMP
"KRN",19,10989,"RPC",1205,0)
ORWDLR DEF
"KRN",19,10989,"RPC",1206,0)
ORWDLR LOAD
"KRN",19,10989,"RPC",1207,0)
ORWDLR OIPARAM
"KRN",19,10989,"RPC",1208,0)
ORWDLR STOP
"KRN",19,10989,"RPC",1209,0)
ORWDLR32 ABBSPEC
"KRN",19,10989,"RPC",1210,0)
ORWDLR32 ALLSAMP
"KRN",19,10989,"RPC",1211,0)
ORWDLR32 ALLSPEC
"KRN",19,10989,"RPC",1212,0)
ORWDLR32 DEF
"KRN",19,10989,"RPC",1213,0)
ORWDLR32 IC DEFAULT
"KRN",19,10989,"RPC",1214,0)
ORWDLR32 IC VALID
"KRN",19,10989,"RPC",1215,0)
ORWDLR32 IMMED COLLECT
"KRN",19,10989,"RPC",1216,0)
ORWDLR32 LAB COLL TIME
"KRN",19,10989,"RPC",1217,0)
ORWDLR32 LOAD
"KRN",19,10989,"RPC",1218,0)
ORWDLR32 MAXDAYS
"KRN",19,10989,"RPC",1219,0)
ORWDLR32 ONE SAMPLE
"KRN",19,10989,"RPC",1220,0)
ORWDLR32 ONE SPECIMEN
"KRN",19,10989,"RPC",1221,0)
ORWDLR32 STOP
"KRN",19,10989,"RPC",1222,0)
ORWDOR VMSLCT
"KRN",19,10989,"RPC",1227,0)
ORWDPS32 ALLROUTE
"KRN",19,10989,"RPC",1228,0)
ORWDPS32 AUTH
"KRN",19,10989,"RPC",1229,0)
ORWDPS32 DLGSLCT
"KRN",19,10989,"RPC",1230,0)
ORWDPS32 DOSES
"KRN",19,10989,"RPC",1231,0)
ORWDPS32 DRUGMSG
"KRN",19,10989,"RPC",1232,0)
ORWDPS32 FORMALT
"KRN",19,10989,"RPC",1233,0)
ORWDPS32 ISSPLY
"KRN",19,10989,"RPC",1234,0)
ORWDPS32 IVAMT
"KRN",19,10989,"RPC",1235,0)
ORWDPS32 MEDISIV
"KRN",19,10989,"RPC",1236,0)
ORWDPS32 OISLCT
"KRN",19,10989,"RPC",1237,0)
ORWDPS32 SCSTS
"KRN",19,10989,"RPC",1238,0)
ORWDPS32 VALQTY
"KRN",19,10989,"RPC",1239,0)
ORWDPS32 VALRATE
"KRN",19,10989,"RPC",1240,0)
ORWDPS32 VALSCH
"KRN",19,10989,"RPC",1241,0)
ORWDRA DEF
"KRN",19,10989,"RPC",1242,0)
ORWDRA32 APPROVAL
"KRN",19,10989,"RPC",1243,0)
ORWDRA32 DEF
"KRN",19,10989,"RPC",1244,0)
ORWDRA32 IMTYPSEL
"KRN",19,10989,"RPC",1245,0)
ORWDRA32 ISOLATN
"KRN",19,10989,"RPC",1246,0)
ORWDRA32 LOCTYPE
"KRN",19,10989,"RPC",1247,0)
ORWDRA32 PROCMSG
"KRN",19,10989,"RPC",1248,0)
ORWDRA32 RADSRC
"KRN",19,10989,"RPC",1249,0)
ORWDRA32 RAORDITM
"KRN",19,10989,"RPC",1250,0)
ORWDX AGAIN
"KRN",19,10989,"RPC",1251,0)
ORWDX DGRP
"KRN",19,10989,"RPC",1252,0)
ORWDX DISMSG
"KRN",19,10989,"RPC",1253,0)
ORWDX DLGDEF
"KRN",19,10989,"RPC",1254,0)
ORWDX DLGID
"KRN",19,10989,"RPC",1255,0)
ORWDX DLGQUIK
"KRN",19,10989,"RPC",1256,0)
ORWDX FORMID
"KRN",19,10989,"RPC",1257,0)
ORWDX LOADRSP
"KRN",19,10989,"RPC",1258,0)
ORWDX LOCK
"KRN",19,10989,"RPC",1259,0)
ORWDX MSG
"KRN",19,10989,"RPC",1260,0)
ORWDX ORDITM
"KRN",19,10989,"RPC",1261,0)
ORWDX SAVE
"KRN",19,10989,"RPC",1262,0)
ORWDX SEND
"KRN",19,10989,"RPC",1263,0)
ORWDX SENDP
"KRN",19,10989,"RPC",1264,0)
ORWDX UNLOCK
"KRN",19,10989,"RPC",1265,0)
ORWDX WRLST
"KRN",19,10989,"RPC",1266,0)
ORWDXA ALERT
"KRN",19,10989,"RPC",1267,0)
ORWDXA COMPLETE
"KRN",19,10989,"RPC",1268,0)
ORWDXA DC
"KRN",19,10989,"RPC",1269,0)
ORWDX2 DCREASON
"KRN",19,10989,"RPC",1270,0)
ORWDXA DCREQIEN
"KRN",19,10989,"RPC",1271,0)
ORWDXA FLAG
"KRN",19,10989,"RPC",1272,0)
ORWDXA FLAGTXT
"KRN",19,10989,"RPC",1273,0)
ORWDXA HOLD
"KRN",19,10989,"RPC",1274,0)
ORWDXA UNFLAG
"KRN",19,10989,"RPC",1275,0)
ORWDXA UNHOLD
"KRN",19,10989,"RPC",1276,0)
ORWDXA VALID
"KRN",19,10989,"RPC",1277,0)
ORWDXA VERIFY
"KRN",19,10989,"RPC",1278,0)
ORWDXA WCGET
"KRN",19,10989,"RPC",1279,0)
ORWDXA WCPUT
"KRN",19,10989,"RPC",1280,0)
ORWDXC ACCEPT
"KRN",19,10989,"RPC",1281,0)
ORWDXC DELAY
"KRN",19,10989,"RPC",1282,0)
ORWDXC DELORD
"KRN",19,10989,"RPC",1283,0)
ORWDXC DISPLAY
"KRN",19,10989,"RPC",1284,0)
ORWDXC FILLID
"KRN",19,10989,"RPC",1285,0)
ORWDXC ON
"KRN",19,10989,"RPC",1286,0)
ORWDXC SAVECHK
"KRN",19,10989,"RPC",1287,0)
ORWDXC SESSION
"KRN",19,10989,"RPC",1288,0)
ORWDXM AUTOACK
"KRN",19,10989,"RPC",1289,0)
ORWDXM DLGNAME
"KRN",19,10989,"RPC",1290,0)
ORWDXM FORMID
"KRN",19,10989,"RPC",1291,0)
ORWDXM LOADSET
"KRN",19,10989,"RPC",1292,0)
ORWDXM MENU
"KRN",19,10989,"RPC",1293,0)
ORWDXM MSTYLE
"KRN",19,10989,"RPC",1294,0)
ORWDXM PROMPTS
"KRN",19,10989,"RPC",1295,0)
ORWDXM1 BLDQRSP
"KRN",19,10989,"RPC",1296,0)
ORWDXM2 CLRRCL
"KRN",19,10989,"RPC",1297,0)
ORWDXQ DLGNAME
"KRN",19,10989,"RPC",1298,0)
ORWDXQ DLGSAVE
"KRN",19,10989,"RPC",1299,0)
ORWDXQ GETQLST
"KRN",19,10989,"RPC",1300,0)
ORWDXQ GETQNAM
"KRN",19,10989,"RPC",1301,0)
ORWDXQ PUTQLST
"KRN",19,10989,"RPC",1302,0)
ORWDXQ PUTQNAM
"KRN",19,10989,"RPC",1303,0)
ORWDXR ISREL
"KRN",19,10989,"RPC",1304,0)
ORWDXR RENEW
"KRN",19,10989,"RPC",1305,0)
ORWDXR RNWFLDS
"KRN",19,10989,"RPC",1306,0)
ORWGEPT CLINRNG
"KRN",19,10989,"RPC",1307,0)
ORWLR CUMULATIVE REPORT
"KRN",19,10989,"RPC",1308,0)
ORWLR CUMULATIVE SECTION
"KRN",19,10989,"RPC",1309,0)
ORWLR REPORT LISTS
"KRN",19,10989,"RPC",1310,0)
ORWLRR ALLTESTS
"KRN",19,10989,"RPC",1311,0)
ORWLRR ATESTS
"KRN",19,10989,"RPC",1312,0)
ORWLRR ATG
"KRN",19,10989,"RPC",1313,0)
ORWLRR ATOMICS
"KRN",19,10989,"RPC",1314,0)
ORWLRR CHART
"KRN",19,10989,"RPC",1315,0)
ORWLRR CHEMTEST
"KRN",19,10989,"RPC",1316,0)
ORWLRR GRID
"KRN",19,10989,"RPC",1317,0)
ORWLRR INTERIM
"KRN",19,10989,"RPC",1318,0)
ORWLRR INTERIMG
"KRN",19,10989,"RPC",1319,0)
ORWLRR INTERIMS
"KRN",19,10989,"RPC",1320,0)
ORWLRR MICRO
"KRN",19,10989,"RPC",1321,0)
ORWLRR NEWOLD
"KRN",19,10989,"RPC",1322,0)
ORWLRR PARAM
"KRN",19,10989,"RPC",1323,0)
ORWLRR SPEC
"KRN",19,10989,"RPC",1324,0)
ORWLRR TG
"KRN",19,10989,"RPC",1325,0)
ORWLRR USERS
"KRN",19,10989,"RPC",1326,0)
ORWLRR UTGA
"KRN",19,10989,"RPC",1327,0)
ORWLRR UTGD
"KRN",19,10989,"RPC",1328,0)
ORWLRR UTGR
"KRN",19,10989,"RPC",1329,0)
ORWMC PATIENT PROCEDURES
"KRN",19,10989,"RPC",1330,0)
ORWOR RESULT
"KRN",19,10989,"RPC",1331,0)
ORWOR SHEETS
"KRN",19,10989,"RPC",1332,0)
ORWOR TSALL
"KRN",19,10989,"RPC",1333,0)
ORWORB AUTOUNFLAG ORDERS
"KRN",19,10989,"RPC",1334,0)
ORWORB FASTUSER
"KRN",19,10989,"RPC",1335,0)
ORWORB GET TIU ALERT INFO
"KRN",19,10989,"RPC",1336,0)
ORWORB GETDATA
"KRN",19,10989,"RPC",1337,0)
ORWORB KILL UNSIG ORDERS ALERT
"KRN",19,10989,"RPC",1339,0)
ORWORDG ALLTREE
"KRN",19,10989,"RPC",1340,0)
ORWORDG GRPSEQB
"KRN",19,10989,"RPC",1341,0)
ORWORDG IEN
"KRN",19,10989,"RPC",1342,0)
ORWORDG MAPSEQ
"KRN",19,10989,"RPC",1343,0)
ORWORDG REVSTS
"KRN",19,10989,"RPC",1344,0)
ORWORR AGET
"KRN",19,10989,"RPC",1345,0)
ORWORR GET
"KRN",19,10989,"RPC",1346,0)
ORWORR GET4LST
"KRN",19,10989,"RPC",1347,0)
ORWORR GETBYIFN
"KRN",19,10989,"RPC",1348,0)
ORWORR GETTXT
"KRN",19,10989,"RPC",1349,0)
ORWPCE ACTIVE PROV
"KRN",19,10989,"RPC",1350,0)
ORWPCE ACTPROB
"KRN",19,10989,"RPC",1351,0)
ORWPCE CPTREQD
"KRN",19,10989,"RPC",1352,0)
ORWPCE DELETE
"KRN",19,10989,"RPC",1353,0)
ORWPCE DIAG
"KRN",19,10989,"RPC",1354,0)
ORWPCE GET EDUCATION TOPICS
"KRN",19,10989,"RPC",1355,0)
ORWPCE GET EXAM TYPE
"KRN",19,10989,"RPC",1356,0)
ORWPCE GET HEALTH FACTORS TY
"KRN",19,10989,"RPC",1357,0)
ORWPCE GET IMMUNIZATION TYPE
"KRN",19,10989,"RPC",1358,0)
ORWPCE GET SET OF CODES
"KRN",19,10989,"RPC",1359,0)
ORWPCE GET SKIN TEST TYPE
"KRN",19,10989,"RPC",1360,0)
ORWPCE GET TREATMENT TYPE
"KRN",19,10989,"RPC",1361,0)
ORWPCE HF
"KRN",19,10989,"RPC",1362,0)
ORWPCE IMM
"KRN",19,10989,"RPC",1363,0)
ORWPCE LEX
"KRN",19,10989,"RPC",1364,0)
ORWPCE LEXCODE
"KRN",19,10989,"RPC",1366,0)
ORWPCE NOTEVSTR
"KRN",19,10989,"RPC",1367,0)
ORWPCE PCE4NOTE
"KRN",19,10989,"RPC",1368,0)
ORWPCE PED
"KRN",19,10989,"RPC",1369,0)
ORWPCE PROC
"KRN",19,10989,"RPC",1370,0)
ORWPCE SAVE
"KRN",19,10989,"RPC",1371,0)
ORWPCE SCDIS
"KRN",19,10989,"RPC",1372,0)
ORWPCE SCSEL
"KRN",19,10989,"RPC",1373,0)
ORWPCE SK
"KRN",19,10989,"RPC",1374,0)
ORWPCE TRT
"KRN",19,10989,"RPC",1375,0)
ORWPCE VISIT
"KRN",19,10989,"RPC",1376,0)
ORWPCE XAM
"KRN",19,10989,"RPC",1377,0)
ORWPS ACTIVE
"KRN",19,10989,"RPC",1378,0)
ORWPS COVER
"KRN",19,10989,"RPC",1379,0)
ORWPS DETAIL
"KRN",19,10989,"RPC",1380,0)
ORWPS1 NEWDLG
"KRN",19,10989,"RPC",1381,0)
ORWPS1 PICKUP
"KRN",19,10989,"RPC",1382,0)
ORWPS1 REFILL
"KRN",19,10989,"RPC",1383,0)
ORWPT ADMITLST
"KRN",19,10989,"RPC",1384,0)
ORWPT APPTLST
"KRN",19,10989,"RPC",1385,0)
ORWPT CLINRNG
"KRN",19,10989,"RPC",1386,0)
ORWPT CWAD
"KRN",19,10989,"RPC",1387,0)
ORWPT DFLTSRC
"KRN",19,10989,"RPC",1388,0)
ORWPT DIEDON
"KRN",19,10989,"RPC",1389,0)
ORWPT DISCHARGE
"KRN",19,10989,"RPC",1390,0)
ORWPT ENCTITL
"KRN",19,10989,"RPC",1391,0)
ORWPT FULLSSN
"KRN",19,10989,"RPC",1392,0)
ORWPT ID INFO
"KRN",19,10989,"RPC",1393,0)
ORWPT LAST5
"KRN",19,10989,"RPC",1394,0)
ORWPT LIST ALL
"KRN",19,10989,"RPC",1395,0)
ORWPT PTINQ
"KRN",19,10989,"RPC",1396,0)
ORWPT SAVDFLT
"KRN",19,10989,"RPC",1397,0)
ORWPT SELCHK
"KRN",19,10989,"RPC",1398,0)
ORWPT SELECT
"KRN",19,10989,"RPC",1399,0)
ORWPT SHARE
"KRN",19,10989,"RPC",1400,0)
ORWPT TOP
"KRN",19,10989,"RPC",1401,0)
ORWPT1 PCDETAIL
"KRN",19,10989,"RPC",1402,0)
ORWPT1 PRCARE
"KRN",19,10989,"RPC",1403,0)
ORWPT16 ADMITLST
"KRN",19,10989,"RPC",1404,0)
ORWPT16 APPTLST
"KRN",19,10989,"RPC",1405,0)
ORWPT16 DEMOG
"KRN",19,10989,"RPC",1406,0)
ORWPT16 GETVSIT
"KRN",19,10989,"RPC",1407,0)
ORWPT16 ID INFO
"KRN",19,10989,"RPC",1408,0)
ORWPT16 LIST ALL
"KRN",19,10989,"RPC",1409,0)
ORWPT16 LOOKUP
"KRN",19,10989,"RPC",1410,0)
ORWPT16 PSCNVT
"KRN",19,10989,"RPC",1411,0)
ORWRA DEFAULT EXAM SETTINGS
"KRN",19,10989,"RPC",1412,0)
ORWRA IMAGING EXAMS
"KRN",19,10989,"RPC",1413,0)
ORWRA PRINT REPORT
"KRN",19,10989,"RPC",1414,0)
ORWRA REPORT TEXT
"KRN",19,10989,"RPC",1415,0)
ORWRP PRINT LAB REPORTS
"KRN",19,10989,"RPC",1416,0)
ORWRP PRINT REPORT
"KRN",19,10989,"RPC",1417,0)
ORWRP REPORT LISTS
"KRN",19,10989,"RPC",1418,0)
ORWRP REPORT TEXT
"KRN",19,10989,"RPC",1419,0)
ORWRP1 LISTNUTR
"KRN",19,10989,"RPC",1420,0)
ORWRP16 REPORT LISTS
"KRN",19,10989,"RPC",1421,0)
ORWRP16 REPORT TEXT
"KRN",19,10989,"RPC",1422,0)
ORWTIU GET DCSUMM CONTEXT
"KRN",19,10989,"RPC",1423,0)
ORWTIU GET TIU CONTEXT
"KRN",19,10989,"RPC",1424,0)
ORWTIU SAVE DCSUMM CONTEXT
"KRN",19,10989,"RPC",1425,0)
ORWTIU SAVE TIU CONTEXT
"KRN",19,10989,"RPC",1426,0)
ORWU CLINLOC
"KRN",19,10989,"RPC",1427,0)
ORWU DEVICE
"KRN",19,10989,"RPC",1428,0)
ORWU DT
"KRN",19,10989,"RPC",1429,0)
ORWU EXTNAME
"KRN",19,10989,"RPC",1430,0)
ORWU GBLREF
"KRN",19,10989,"RPC",1431,0)
ORWU GENERIC
"KRN",19,10989,"RPC",1432,0)
ORWU HASKEY
"KRN",19,10989,"RPC",1433,0)
ORWU HOSPLOC
"KRN",19,10989,"RPC",1434,0)
ORWU INPLOC
"KRN",19,10989,"RPC",1435,0)
ORWU NEWPERS
"KRN",19,10989,"RPC",1436,0)
ORWU NPHASKEY
"KRN",19,10989,"RPC",1437,0)
ORWU PATCH
"KRN",19,10989,"RPC",1438,0)
ORWU TOOLMENU
"KRN",19,10989,"RPC",1439,0)
ORWU USERINFO
"KRN",19,10989,"RPC",1440,0)
ORWU VALDT
"KRN",19,10989,"RPC",1441,0)
ORWU VALIDSIG
"KRN",19,10989,"RPC",1442,0)
ORWU VERSRV
"KRN",19,10989,"RPC",1443,0)
ORWU16 DEVICE
"KRN",19,10989,"RPC",1444,0)
ORWU16 HOSPLOC
"KRN",19,10989,"RPC",1445,0)
ORWU16 NEWPERS
"KRN",19,10989,"RPC",1446,0)
ORWU16 USERINFO
"KRN",19,10989,"RPC",1447,0)
ORWU16 VALDT
"KRN",19,10989,"RPC",1448,0)
ORWU16 VALIDSIG
"KRN",19,10989,"RPC",1449,0)
ORWUH POPUP
"KRN",19,10989,"RPC",1450,0)
ORWUX SYMTAB
"KRN",19,10989,"RPC",1451,0)
ORWUXT LST
"KRN",19,10989,"RPC",1452,0)
ORWUXT REF
"KRN",19,10989,"RPC",1453,0)
ORWUXT VAL
"KRN",19,10989,"RPC",1454,0)
ORQQCN DEFAULT REQUEST REASON
"KRN",19,10989,"RPC",1455,0)
ORWDX LOCK ORDER
"KRN",19,10989,"RPC",1456,0)
ORWDX UNLOCK ORDER
"KRN",19,10989,"RPC",1457,0)
ORWDCN32 NEWDLG
"KRN",19,10989,"RPC",1458,0)
ORQQCN GET SERVICE IEN
"KRN",19,10989,"RPC",1459,0)
ORQQCN PROVDX
"KRN",19,10989,"RPC",1460,0)
TIU TEMPLATE ACCESS LEVEL
"KRN",19,10989,"RPC",1461,0)
TIU GET DOCUMENT TITLE
"KRN",19,10989,"RPC",1462,0)
ORWPT BYWARD
"KRN",19,10989,"RPC",1463,0)
ORQQPX GET HIST LOCATIONS
"KRN",19,10989,"RPC",1464,0)
ORQQPX NEW REMINDERS ACTIVE
"KRN",19,10989,"RPC",1465,0)
ORWPCE GET VISIT
"KRN",19,10989,"RPC",1480,0)
TIU GET REQUEST
"KRN",19,10989,"RPC",1481,0)
ORWORB KILL EXPIR MED ALERT
"KRN",19,10989,"RPC",1482,0)
DG CHK BS5 XREF ARRAY
"KRN",19,10989,"RPC",1483,0)
DG CHK BS5 XREF Y/N
"KRN",19,10989,"RPC",1484,0)
DG CHK PAT/DIV MEANS TEST
"KRN",19,10989,"RPC",1485,0)
DG SENSITIVE RECORD ACCESS
"KRN",19,10989,"RPC",1486,0)
DG SENSITIVE RECORD BULLETIN
"KRN",19,10989,"RPC",1487,0)
ORQQCN CANEDIT
"KRN",19,10989,"RPC",1488,0)
ORQQCN EDIT DEFAULT REASON
"KRN",19,10989,"RPC",1489,0)
ORQQCN SF513 WINDOWS PRINT
"KRN",19,10989,"RPC",1490,0)
ORWCIRN FACLIST
"KRN",19,10989,"RPC",1491,0)
ORWDLR32 GET LAB TIMES
"KRN",19,10989,"RPC",1492,0)
ORWPT LEGACY
"KRN",19,10989,"RPC",1493,0)
ORWRP GET DEFAULT PRINTER
"KRN",19,10989,"RPC",1494,0)
ORWRP PRINT WINDOWS REPORT
"KRN",19,10989,"RPC",1495,0)
ORWRP SAVE DEFAULT PRINTER
"KRN",19,10989,"RPC",1496,0)
ORWRP WINPRINT DEFAULT
"KRN",19,10989,"RPC",1497,0)
ORWRP WINPRINT LAB REPORTS
"KRN",19,10989,"RPC",1498,0)
ORWTIU WINPRINT NOTE
"KRN",19,10989,"RPC",1500,0)
ORWPCE GAFOK
"KRN",19,10989,"RPC",1501,0)
ORWPCE MHCLINIC
"KRN",19,10989,"RPC",1502,0)
ORWPCE LOADGAF
"KRN",19,10989,"RPC",1503,0)
ORWPCE SAVEGAF
"KRN",19,10989,"RPC",1504,0)
ORWPCE FORCE
"KRN",19,10989,"RPC",1505,0)
TIU GET DEFAULT PROVIDER
"KRN",19,10989,"RPC",1506,0)
TIU GET SITE PARAMETERS
"KRN",19,10989,"RPC",1507,0)
TIU IS USER A PROVIDER?
"KRN",19,10989,"RPC",1508,0)
ORWOR VWGET
"KRN",19,10989,"RPC",1509,0)
ORWOR VWSET
"KRN",19,10989,"RPC",1510,0)
ORWU PARAM
"KRN",19,10989,"RPC",1511,0)
ORWDOR LKSCRN
"KRN",19,10989,"RPC",1512,0)
ORWDOR VALNUM
"KRN",19,10989,"RPC",1513,0)
ORWDPS32 VALROUTE
"KRN",19,10989,"RPC",1515,0)
ORWORB UNSIG ORDERS FOLLOWUP
"KRN",19,10989,"RPC",1516,0)
ORWTIU GET LISTBOX ITEM
"KRN",19,10989,"RPC",1517,0)
ORWRP2 HS COMP FILES
"KRN",19,10989,"RPC",1518,0)
ORWRP2 HS COMPONENTS
"KRN",19,10989,"RPC",1519,0)
ORWRP2 HS FILE LOOKUP
"KRN",19,10989,"RPC",1520,0)
ORWRP2 HS REPORT TEXT
"KRN",19,10989,"RPC",1521,0)
ORWRP2 HS SUBITEMS
"KRN",19,10989,"RPC",1522,0)
ORWPCE HASCPT
"KRN",19,10989,"RPC",1523,0)
ORWPCE ASKPCE
"KRN",19,10989,"RPC",1524,0)
ORWPCE MHTESTOK
"KRN",19,10989,"RPC",1525,0)
ORWPCE GAFURL
"KRN",19,10989,"RPC",1526,0)
ORQQPXRM DIALOG PROMPTS
"KRN",19,10989,"RPC",1527,0)
ORQQPXRM EDUCATION SUBTOPICS
"KRN",19,10989,"RPC",1528,0)
ORQQPXRM EDUCATION SUMMARY
"KRN",19,10989,"RPC",1529,0)
ORQQPXRM EDUCATION TOPIC
"KRN",19,10989,"RPC",1530,0)
ORQQPXRM MENTAL HEALTH
"KRN",19,10989,"RPC",1531,0)
ORQQPXRM MENTAL HEALTH RESULTS
"KRN",19,10989,"RPC",1532,0)
ORQQPXRM MENTAL HEALTH SAVE
"KRN",19,10989,"RPC",1533,0)
ORQQPXRM PROGRESS NOTE HEADER
"KRN",19,10989,"RPC",1534,0)
ORQQPXRM REMINDER CATEGORIES
"KRN",19,10989,"RPC",1535,0)
ORQQPXRM REMINDER DETAIL
"KRN",19,10989,"RPC",1536,0)
ORQQPXRM REMINDER DIALOG
"KRN",19,10989,"RPC",1537,0)
ORQQPXRM REMINDER EVALUATION
"KRN",19,10989,"RPC",1538,0)
ORQQPXRM REMINDER INQUIRY
"KRN",19,10989,"RPC",1539,0)
ORQQPXRM REMINDER WEB
"KRN",19,10989,"RPC",1540,0)
ORQQPXRM REMINDERS APPLICABLE
"KRN",19,10989,"RPC",1541,0)
ORQQPXRM REMINDERS UNEVALUATED
"KRN",19,10989,"RPC",1542,0)
ORWLRR INFO
"KRN",19,10989,"RPC",1543,0)
TIU GET PRINT NAME
"KRN",19,10989,"RPC",1544,0)
TIU WAS THIS SAVED?
"KRN",19,10989,"RPC",1545,0)
ORWD1 COMLOC
"KRN",19,10989,"RPC",1546,0)
ORWD1 SIG4ANY
"KRN",19,10989,"RPC",1547,0)
ORWD1 SIG4ONE
"KRN",19,10989,"RPC",1548,0)
ORWOR UNSIGN
"KRN",19,10989,"RPC",1549,0)
ORWPT INPLOC
"KRN",19,10989,"RPC",1553,0)
ORQQCN2 GET PREREQUISITE
"KRN",19,10989,"RPC",1554,0)
ORQQCN2 SCHEDULE CONSULT
"KRN",19,10989,"RPC",1555,0)
YS GAF API
"KRN",19,10989,"RPC",1556,0)
TIU LONG LIST BOILERPLATED
"KRN",19,10989,"RPC",1557,0)
ORWDLR33 FUTURE LAB COLLECTS
"KRN",19,10989,"RPC",1558,0)
ORWRP PRINT REMOTE REPORT
"KRN",19,10989,"RPC",1559,0)
ORWRP PRINT WINDOWS REMOTE
"KRN",19,10989,"RPC",1560,0)
ORWRP PRINT LAB REMOTE
"KRN",19,10989,"RPC",1561,0)
ORWRP PRINT WINDOWS LAB REMOTE
"KRN",19,10989,"RPC",1562,0)
ORQQPXRM DIALOG ACTIVE
"KRN",19,10989,"RPC",1563,0)
ORWPCE MH TEST AUTHORIZED
"KRN",19,10989,"RPC",1564,0)
TIU GET BOILERPLATE
"KRN",19,10989,"RPC",1565,0)
ORWRP2 HS COMPONENT SUBS
"KRN",19,10989,"RPC",1566,0)
ORWCH SAVFONT
"KRN",19,10989,"RPC",1567,0)
ORWDLR33 LASTTIME
"KRN",19,10989,"RPC",1568,0)
ORWD1 SVONLY
"KRN",19,10989,"RPC",1569,0)
ORWPCE HASVISIT
"KRN",19,10989,"RPC",1570,0)
ORWPCE GETMOD
"KRN",19,10989,"RPC",1571,0)
ORWPCE CPTMODS
"KRN",19,10989,"RPC",1572,0)
XWB REMOTE CLEAR
"KRN",19,10989,"RPC",1573,0)
XWB REMOTE GETDATA
"KRN",19,10989,"RPC",1574,0)
XWB REMOTE RPC
"KRN",19,10989,"RPC",1575,0)
XWB REMOTE STATUS CHECK
"KRN",19,10989,"RPC",1576,0)
ORQQCN ASSIGNABLE MED RESULTS
"KRN",19,10989,"RPC",1577,0)
ORQQCN ATTACH MED RESULTS
"KRN",19,10989,"RPC",1578,0)
ORQQCN GET MED RESULT DETAILS
"KRN",19,10989,"RPC",1579,0)
ORQQCN REMOVABLE MED RESULTS
"KRN",19,10989,"RPC",1580,0)
ORQQCN REMOVE MED RESULTS
"KRN",19,10989,"RPC",1581,0)
ORQQCN SVC W/SYNONYMS
"KRN",19,10989,"RPC",1582,0)
ORWCV1 COVERSHEET LIST
"KRN",19,10989,"RPC",1583,0)
ORWORB KILL EXPIR OI ALERT
"KRN",19,10989,"RPC",1584,0)
ORWPCE GETSVC
"KRN",19,10989,"RPC",1585,0)
ORWRP LAB REPORT LISTS
"KRN",19,10989,"RPC",1587,0)
ORWTPN GETCLASS
"KRN",19,10989,"RPC",1588,0)
ORWTPN GETTC
"KRN",19,10989,"RPC",1589,0)
ORWTPO CSARNGD
"KRN",19,10989,"RPC",1590,0)
ORWTPO CSLABD
"KRN",19,10989,"RPC",1591,0)
ORWTPO GETTABS
"KRN",19,10989,"RPC",1592,0)
ORWTPP ADDLIST
"KRN",19,10989,"RPC",1593,0)
ORWTPP CHKSURR
"KRN",19,10989,"RPC",1594,0)
ORWTPP CLDAYS
"KRN",19,10989,"RPC",1595,0)
ORWTPP CLEARNOT
"KRN",19,10989,"RPC",1596,0)
ORWTPP CLRANGE
"KRN",19,10989,"RPC",1597,0)
ORWTPP CSARNG
"KRN",19,10989,"RPC",1598,0)
ORWTPP CSLAB
"KRN",19,10989,"RPC",1599,0)
ORWTPP DELLIST
"KRN",19,10989,"RPC",1600,0)
ORWTPP GETCOMBO
"KRN",19,10989,"RPC",1601,0)
ORWTPP GETCOS
"KRN",19,10989,"RPC",1602,0)
ORWTPP GETDCOS
"KRN",19,10989,"RPC",1603,0)
ORWTPP GETNOT
"KRN",19,10989,"RPC",1604,0)
ORWTPP GETNOTO
"KRN",19,10989,"RPC",1605,0)
ORWTPP GETOC
"KRN",19,10989,"RPC",1606,0)
ORWTPP GETOTHER
"KRN",19,10989,"RPC",1607,0)
ORWTPP GETREM
"KRN",19,10989,"RPC",1608,0)
ORWTPP GETSUB
"KRN",19,10989,"RPC",1609,0)
ORWTPP GETSURR
"KRN",19,10989,"RPC",1610,0)
ORWTPP GETTD
"KRN",19,10989,"RPC",1611,0)
ORWTPP GETTU
"KRN",19,10989,"RPC",1612,0)
ORWTPP LSDEF
"KRN",19,10989,"RPC",1613,0)
ORWTPP NEWLIST
"KRN",19,10989,"RPC",1614,0)
ORWTPP PLISTS
"KRN",19,10989,"RPC",1615,0)
ORWTPP PLTEAMS
"KRN",19,10989,"RPC",1616,0)
ORWTPP REMLIST
"KRN",19,10989,"RPC",1617,0)
ORWTPP SAVECD
"KRN",19,10989,"RPC",1618,0)
ORWTPP SAVECS
"KRN",19,10989,"RPC",1619,0)
ORWTPP SAVELIST
"KRN",19,10989,"RPC",1620,0)
ORWTPP SAVENOT
"KRN",19,10989,"RPC",1621,0)
ORWTPP SAVENOTO
"KRN",19,10989,"RPC",1622,0)
ORWTPP SAVEOC
"KRN",19,10989,"RPC",1623,0)
ORWTPP SAVEPLD
"KRN",19,10989,"RPC",1624,0)
ORWTPP SAVESURR
"KRN",19,10989,"RPC",1625,0)
ORWTPP SAVET
"KRN",19,10989,"RPC",1626,0)
ORWTPP SETCOMBO
"KRN",19,10989,"RPC",1627,0)
ORWTPP SETDCOS
"KRN",19,10989,"RPC",1628,0)
ORWTPP SETOTHER
"KRN",19,10989,"RPC",1629,0)
ORWTPP SETREM
"KRN",19,10989,"RPC",1630,0)
ORWTPP SETSUB
"KRN",19,10989,"RPC",1631,0)
ORWTPP SORTDEF
"KRN",19,10989,"RPC",1632,0)
ORWTPP TEAMS
"KRN",19,10989,"RPC",1633,0)
ORWTPT ATEAMS
"KRN",19,10989,"RPC",1634,0)
ORWTPT GETTEAM
"KRN",19,10989,"RPC",1635,0)
TIU TEMPLATE GET DEFAULTS
"KRN",19,10989,"RPC",1636,0)
TIU TEMPLATE GET DESCRIPTION
"KRN",19,10989,"RPC",1637,0)
TIU TEMPLATE SET DEFAULTS
"KRN",19,10989,"RPC",1638,0)
ORWTIU IDNOTES INSTALLED
"KRN",19,10989,"RPC",1639,0)
ORQQPX GET FOLDERS
"KRN",19,10989,"RPC",1640,0)
ORQQPX SET FOLDERS
"KRN",19,10989,"RPC",1641,0)
TIU FIELD CAN EDIT
"KRN",19,10989,"RPC",1642,0)
TIU FIELD DELETE
"KRN",19,10989,"RPC",1643,0)
TIU FIELD EXPORT
"KRN",19,10989,"RPC",1644,0)
TIU FIELD IMPORT
"KRN",19,10989,"RPC",1645,0)
TIU FIELD LIST
"KRN",19,10989,"RPC",1646,0)
TIU FIELD LOAD
"KRN",19,10989,"RPC",1647,0)
TIU FIELD LOAD BY IEN
"KRN",19,10989,"RPC",1648,0)
TIU FIELD LOCK
"KRN",19,10989,"RPC",1649,0)
TIU FIELD NAME IS UNIQUE
"KRN",19,10989,"RPC",1650,0)
TIU FIELD SAVE
"KRN",19,10989,"RPC",1651,0)
TIU FIELD UNLOCK
"KRN",19,10989,"RPC",1652,0)
ORWDPS1 CHK94
"KRN",19,10989,"RPC",1653,0)
ORWDPS1 ODSLCT
"KRN",19,10989,"RPC",1654,0)
ORWDPS1 SCHALL
"KRN",19,10989,"RPC",1655,0)
ORWDPS2 ADMIN
"KRN",19,10989,"RPC",1656,0)
ORWDPS2 DAY2QTY
"KRN",19,10989,"RPC",1657,0)
ORWDPS2 OISLCT
"KRN",19,10989,"RPC",1658,0)
ORWDPS2 REQST
"KRN",19,10989,"RPC",1659,0)
ORWDX DGNM
"KRN",19,10989,"RPC",1660,0)
ORWUL FV4DG
"KRN",19,10989,"RPC",1661,0)
ORWUL FVIDX
"KRN",19,10989,"RPC",1662,0)
ORWUL FVSUB
"KRN",19,10989,"RPC",1663,0)
ORWUL QV4DG
"KRN",19,10989,"RPC",1664,0)
ORWUL QVIDX
"KRN",19,10989,"RPC",1665,0)
ORWUL QVSUB
"KRN",19,10989,"RPC",1666,0)
ORWDPS1 DFLTSPLY
"KRN",19,10989,"RPC",1668,0)
PXRM REMINDER DIALOG (TIU)
"KRN",19,10989,"RPC",1669,0)
ORWPCE ANYTIME
"KRN",19,10989,"RPC",1670,0)
ORQQPX GET DEF LOCATIONS
"KRN",19,10989,"RPC",1671,0)
ORWTPP GETIMG
"KRN",19,10989,"RPC",1672,0)
ORWTPP SETIMG
"KRN",19,10989,"RPC",1673,0)
ORWTPO GETIMGD
"KRN",19,10989,"RPC",1674,0)
ORQQPX REM INSERT AT CURSOR
"KRN",19,10989,"RPC",1675,0)
TIU REMINDER DIALOGS
"KRN",19,10989,"RPC",1676,0)
TIU REM DLG OK AS TEMPLATE
"KRN",19,10989,"RPC",1677,0)
ORWDPS2 MAXREF
"KRN",19,10989,"RPC",1678,0)
ORWDPS2 SCHREQ
"KRN",19,10989,"RPC",1679,0)
ORWRP COLUMN HEADERS
"KRN",19,10989,"RPC",1680,0)
TIU FIELD DOLMTEXT
"KRN",19,10989,"RPC",1681,0)
TIU TEMPLATE PERSONAL OBJECTS
"KRN",19,10989,"RPC",1682,0)
ORWPCE AUTO VISIT TYPE SELECT
"KRN",19,10989,"RPC",1683,0)
ORWDPS2 QTY2DAY
"KRN",19,10989,"RPC",1684,0)
ORWU HAS OPTION ACCESS
"KRN",19,10989,"RPC",1685,0)
TIU TEMPLATE LOCK
"KRN",19,10989,"RPC",1686,0)
ORQQPX LVREMLST
"KRN",19,10989,"RPC",1687,0)
ORQQPX NEW COVER SHEET ACTIVE
"KRN",19,10989,"RPC",1688,0)
ORQQPX NEW COVER SHEET REMS
"KRN",19,10989,"RPC",1689,0)
ORQQPX SAVELVL
"KRN",19,10989,"RPC",1690,0)
PXRM REMINDER CATEGORY
"KRN",19,10989,"RPC",1691,0)
PXRM REMINDERS AND CATEGORIES
"KRN",19,10989,"RPC",1692,0)
TIU DIV AND CLASS INFO
"KRN",19,10989,"RPC",1693,0)
TIU TEMPLATE GETBOIL
"KRN",19,10989,"RPC",1694,0)
TIU TEMPLATE GETITEMS
"KRN",19,10989,"RPC",1695,0)
TIU TEMPLATE GETROOTS
"KRN",19,10989,"RPC",1696,0)
TIU TEMPLATE GETTEXT
"KRN",19,10989,"RPC",1697,0)
TIU TEMPLATE ISEDITOR
"KRN",19,10989,"RPC",1698,0)
TIU TEMPLATE UNLOCK
"KRN",19,10989,"RPC",1699,0)
TIU USER CLASS LONG LIST
"KRN",19,10989,"RPC",1700,0)
ORWPCE ALWAYS CHECKOUT
"KRN",19,10989,"RPC",1701,0)
ORWPCE GET EXCLUDED
"KRN",19,10989,"RPC",1702,0)
ORWDPS1 FORMALT
"KRN",19,10989,"RPC",1703,0)
ORQPT DEFAULT LIST SORT
"KRN",19,10989,"RPC",1704,0)
ORWDPS1 DOSEALT
"KRN",19,10989,"RPC",1705,0)
ORWTPR OCDESC
"KRN",19,10989,"RPC",1706,0)
ORWTPR NOTDESC
"KRN",19,10989,"RPC",1707,0)
ORWDPS1 FAILDEA
"KRN",19,10989,"RPC",1708,0)
ORQPT DEFAULT CLINIC DATE RANG
"KRN",19,10989,"RPC",1709,0)
ORWTIU CANLINK
"KRN",19,10989,"RPC",1710,0)
TIU ID ATTACH ENTRY
"KRN",19,10989,"RPC",1711,0)
TIU ID CAN ATTACH
"KRN",19,10989,"RPC",1712,0)
TIU ID CAN RECEIVE
"KRN",19,10989,"RPC",1713,0)
TIU ID DETACH ENTRY
"KRN",19,10989,"RPC",1714,0)
ORWCOM GETOBJS
"KRN",19,10989,"RPC",1715,0)
ORWCOM DETAILS
"KRN",19,10989,"RPC",1716,0)
ORWCOM PTOBJ
"KRN",19,10989,"RPC",1718,0)
TIU TEMPLATE GETLINK
"KRN",19,10989,"RPC",1719,0)
TIU TEMPLATE ALL TITLES
"KRN",19,10989,"RPC",1720,0)
ORWSR LIST
"KRN",19,10989,"RPC",1721,0)
ORWSR SHOW SURG TAB
"KRN",19,10989,"RPC",1722,0)
ORWSR GET SURG CONTEXT
"KRN",19,10989,"RPC",1723,0)
ORWSR SAVE SURG CONTEXT
"KRN",19,10989,"RPC",1724,0)
ORWSR ONECASE
"KRN",19,10989,"RPC",1727,0)
ORWSR SHOW OPTOP WHEN SIGNING
"KRN",19,10989,"RPC",1728,0)
ORWSR IS NON-OR PROCEDURE
"KRN",19,10989,"RPC",1729,0)
ORWSR CASELIST
"KRN",19,10989,"RPC",1730,0)
ORQQCN GET PROC IEN
"KRN",19,10989,"RPC",1731,0)
ORWRP PRINT V REPORT
"KRN",19,10989,"RPC",1732,0)
ORWRP3 EXPAND COLUMNS
"KRN",19,10989,"RPC",1733,0)
ORWTPD ACTDF
"KRN",19,10989,"RPC",1734,0)
ORWTPD DELDFLT
"KRN",19,10989,"RPC",1735,0)
ORWTPD GETDFLT
"KRN",19,10989,"RPC",1736,0)
ORWTPD RSDFLT
"KRN",19,10989,"RPC",1737,0)
ORWTPD SUDF
"KRN",19,10989,"RPC",1738,0)
ORWTPD SUINDV
"KRN",19,10989,"RPC",1739,0)
ORWTPD GETSETS
"KRN",19,10989,"RPC",1740,0)
ORWCOM ORDEROBJ
"KRN",19,10989,"RPC",1741,0)
ORWRP2 COMPABV
"KRN",19,10989,"RPC",1742,0)
ORWRP2 GETLKUP
"KRN",19,10989,"RPC",1743,0)
ORWRP2 SAVLKUP
"KRN",19,10989,"RPC",1744,0)
ORWRP2 COMPDISP
"KRN",19,10989,"RPC",1745,0)
ORWPCE ISCLINIC
"KRN",19,10989,"RPC",1746,0)
ORWCH SAVECOL
"KRN",19,10989,"RPC",1747,0)
ORWSR RPTLIST
"KRN",19,10989,"RPC",1748,0)
ORQQPXRM MST UPDATE
"KRN",19,10989,"RPC",1749,0)
ORWMC PATIENT PROCEDURES1
"KRN",19,10989,"RPC",1750,0)
ORWRA IMAGING EXAMS1
"KRN",19,10989,"RPC",1751,0)
ORWRA REPORT TEXT1
"KRN",19,10989,"RPC",1752,0)
ORWDPS4 CPINFO
"KRN",19,10989,"RPC",1753,0)
ORWDPS4 CPLST
"KRN",19,10989,"RPC",1754,0)
ORWORB KILL UNVER MEDS ALERT
"KRN",19,10989,"RPC",1755,0)
ORWORB KILL UNVER ORDERS ALERT
"KRN",19,10989,"RPC",1756,0)
ORWPCE HNCOK
"KRN",19,10989,"RPC",1757,0)
ORWPS MEDHIST
"KRN",19,10989,"RPC",1758,0)
TIU FIELD CHECK
"KRN",19,10989,"RPC",1759,0)
TIU FIELD LIST ADD
"KRN",19,10989,"RPC",1760,0)
TIU FIELD LIST IMPORT
"KRN",19,10989,"RPC",1761,0)
TIU SET DOCUMENT TEXT
"KRN",19,10989,"RPC",1762,0)
ORWDPS2 CHKPI
"KRN",19,10989,"RPC",1763,0)
ORWDXR GTORITM
"KRN",19,10989,"RPC",1764,0)
ORWDPS2 CHKGRP
"KRN",19,10989,"RPC",1765,0)
ORWDPS2 QOGRP
"KRN",19,10989,"RPC",1766,0)
ORWDXR GETPKG
"KRN",19,10989,"RPC",1767,0)
ORQPT MAKE RPL
"KRN",19,10989,"RPC",1768,0)
ORQPT READ RPL
"KRN",19,10989,"RPC",1769,0)
ORQPT KILL RPL
"KRN",19,10989,"RPC",1770,0)
ORWTIU GET SAVED CP FIELDS
"KRN",19,10989,"RPC",1771,0)
ORWDPS1 LOCPICK
"KRN",19,10989,"RPC",1772,0)
ORWPT LAST5 RPL
"KRN",19,10989,"RPC",1773,0)
ORWPT FULLSSN RPL
"KRN",19,10989,"RPC",1774,0)
ORWOR PKIUSE
"KRN",19,10989,"RPC",1775,0)
ORWOR1 SIG
"KRN",19,10989,"RPC",1776,0)
ORWOR1 CHKDIG
"KRN",19,10989,"RPC",1777,0)
ORWOR1 GETDTEXT
"KRN",19,10989,"RPC",1778,0)
ORWOR1 GETDSIG
"KRN",19,10989,"RPC",1779,0)
ORWTPD GETIMG
"KRN",19,10989,"RPC",1780,0)
OREVNTX1 PRMPTID
"KRN",19,10989,"RPC",1781,0)
ORECS01 CHKESSO
"KRN",19,10989,"RPC",1782,0)
ORECS01 VSITID
"KRN",19,10989,"RPC",1784,0)
OREVNTX LIST
"KRN",19,10989,"RPC",1785,0)
OREVNTX PAT
"KRN",19,10989,"RPC",1786,0)
OREVNTX1 GTEVT
"KRN",19,10989,"RPC",1787,0)
OREVNTX1 CPACT
"KRN",19,10989,"RPC",1788,0)
OREVNTX1 CURSPE
"KRN",19,10989,"RPC",1789,0)
OREVNTX1 CHGEVT
"KRN",19,10989,"RPC",1790,0)
OREVNTX1 DELPTEVT
"KRN",19,10989,"RPC",1791,0)
OREVNTX1 DFLTEVT
"KRN",19,10989,"RPC",1792,0)
OREVNTX ACTIVE
"KRN",19,10989,"RPC",1793,0)
OREVNTX1 PUTEVNT
"KRN",19,10989,"RPC",1794,0)
OREVNTX1 WRLSTED
"KRN",19,10989,"RPC",1795,0)
OREVNTX1 EVT
"KRN",19,10989,"RPC",1796,0)
OREVNTX1 NAME
"KRN",19,10989,"RPC",1797,0)
OREVNTX1 MATCH
"KRN",19,10989,"RPC",1798,0)
OREVNTX1 EMPTY
"KRN",19,10989,"RPC",1799,0)
OREVNTX1 EXISTS
"KRN",19,10989,"RPC",1800,0)
OREVNTX1 GTEVT1
"KRN",19,10989,"RPC",1801,0)
OREVNTX1 DIV
"KRN",19,10989,"RPC",1802,0)
OREVNTX1 DIV1
"KRN",19,10989,"RPC",1803,0)
OREVNTX1 LOC
"KRN",19,10989,"RPC",1804,0)
OREVNTX1 LOC1
"KRN",19,10989,"RPC",1805,0)
ORWDX SENDED
"KRN",19,10989,"RPC",1806,0)
OREVNTX1 GETDLG
"KRN",19,10989,"RPC",1807,0)
ORECS01 ECPRINT
"KRN",19,10989,"RPC",1811,0)
ORECS01 ECRPT
"KRN",19,10989,"RPC",1812,0)
OREVNTX1 ISDCOD
"KRN",19,10989,"RPC",1813,0)
OREVNTX1 SETDFLT
"KRN",19,10989,"RPC",1815,0)
TIU IS THIS A CLINPROC?
"KRN",19,10989,"RPC",1816,0)
TIU IDENTIFY CLINPROC CLASS
"KRN",19,10989,"RPC",1817,0)
TIU LONG LIST CLINPROC TITLES
"KRN",19,10989,"RPC",1819,0)
ORWDPS1 HASOIPI
"KRN",19,10989,"RPC",1821,0)
OREVNTX1 DEFLTS
"KRN",19,10989,"RPC",1822,0)
OREVNTX1 MULTS
"KRN",19,10989,"RPC",1823,0)
OREVNTX1 DONE
"KRN",19,10989,"RPC",1824,0)
OREVNTX1 PROMPT IDS
"KRN",19,10989,"RPC",1825,0)
ORWCIRN CHECKLINK
"KRN",19,10989,"RPC",1826,0)
XWB DIRECT RPC
"KRN",19,10989,"RPC",1827,0)
ORWDPS1 HASROUTE
"KRN",19,10989,"RPC",1828,0)
ORQQCN UNRESOLVED
"KRN",19,10989,"RPC",1829,0)
OREVNTX1 DELDFLT
"KRN",19,10989,"RPC",1830,0)
ORWCH LDFONT
"KRN",19,10989,"RPC",1831,0)
ORWU1 NAMECVT
"KRN",19,10989,"RPC",1832,0)
OREVNTX1 DFLTDLG
"KRN",19,10989,"RPC",1833,0)
ORWDPS5 LESAPI
"KRN",19,10989,"RPC",1834,0)
ORWDPS5 LESGRP
"KRN",19,10989,"RPC",1839,0)
OREVNTX1 TYPEXT
"KRN",19,10989,"RPC",1840,0)
ORWORR RGET
"KRN",19,10989,"RPC",1841,0)
OREVNTX1 AUTHMREL
"KRN",19,10989,"RPC",1842,0)
OREVNTX1 HAVEPRT
"KRN",19,10989,"RPC",1843,0)
OREVNTX1 CMEVTS
"KRN",19,10989,"RPC",1844,0)
OREVNTX1 ODPTEVID
"KRN",19,10989,"RPC",1845,0)
ORWOR PKISITE
"KRN",19,10989,"RPC",1846,0)
OREVNTX1 COMP
"KRN",19,10989,"RPC",1847,0)
OREVNTX1 ISHDORD
"KRN",19,10989,"RPC",1848,0)
ORWDXR ORCPLX
"KRN",19,10989,"RPC",1849,0)
OREVNTX1 ISPASS
"KRN",19,10989,"RPC",1850,0)
OREVNTX1 ISPASS1
"KRN",19,10989,"RPC",1851,0)
OREVNTX1 DLGIEN
"KRN",19,10989,"RPC",1852,0)
ORWDXR CANRN
"KRN",19,10989,"RPC",1853,0)
ORWDXR ISCPLX
"KRN",19,10989,"RPC",1854,0)
ORWDXA OFCPLX
"KRN",19,10989,"RPC",1855,0)
ORQQPX GET NOT PURPOSE
"KRN",19,10989,"RPC",1856,0)
ORWDPS1 IVDEA
"KRN",19,10989,"RPC",1857,0)
ORWDXR ISNOW
"KRN",19,10989,"RPC",1858,0)
ORRHCQ QRYITR
"KRN",19,10989,"RPC",1859,0)
OREVNTX1 GETSTS
"KRN",19,10989,"RPC",1860,0)
ORWU DEFAULT DIVISION
"KRN",19,10989,"RPC",1861,0)
ORWDXA ISACTOI
"KRN",19,10989,"RPC",1862,0)
ORECS01 SAVPATH
"KRN",19,10989,"RPC",1863,0)
ORWOR RESULT HISTORY
"KRN",19,10989,"RPC",1864,0)
XUS GET TOKEN
"KRN",19,10989,"RPC",1865,0)
ORQQPX IMMUN LIST
"KRN",19,10989,"RPC",1866,0)
XWB DEFERRED CLEARALL
"KRN",19,10989,"RPC",1867,0)
ORWOR1 SETDTEXT
"KRN",19,10989,"RPC",1868,0)
ORWOR1 GETDEA
"KRN",19,10989,"RPC",1869,0)
ORWOR1 GETDSCH
"KRN",19,10989,"RPC",1870,0)
ORWORB TEXT FOLLOWUP
"KRN",19,10989,"RPC",1871,0)
ORWU1 NEWLOC
"KRN",19,10989,"RPC",1872,0)
ORWPCE ACTIVE CODE
"KRN",19,10989,"RPC",1873,0)
ORQQPXRM GET WH LETTER TEXT
"KRN",19,10989,"RPC",1874,0)
ORQQPXRM GET WH LETTER TYPE
"KRN",19,10989,"RPC",1875,0)
ORQQPXRM GET WH PROC RESULT
"KRN",19,10989,"RPC",1876,0)
ORQQPXRM WOMEN HEALTH SAVE
"KRN",19,10989,"RPC",1877,0)
ORB FORWARD ALERT
"KRN",19,10989,"RPC",1878,0)
ORB RENEW ALERT
"KRN",19,10989,"RPC",1879,0)
ORPRF CLEAR
"KRN",19,10989,"RPC",1880,0)
ORPRF GETFLG
"KRN",19,10989,"RPC",1881,0)
ORPRF HASFLG
"KRN",19,10989,"RPC",1882,0)
ORWTPD GETOCM
"KRN",19,10989,"RPC",1883,0)
TIU ONE VISIT NOTE?
"KRN",19,10989,"RPC",1884,0)
VAFCTFU CONVERT ICN TO DFN
"KRN",19,10989,"RPC",1885,0)
ORIMO IMOLOC
"KRN",19,10989,"RPC",1886,0)
ORIMO IMOOD
"KRN",19,10989,"RPC",1887,0)
ORWDPS4 IPOD4OP
"KRN",19,10989,"RPC",1888,0)
ORWDPS4 UPDTDG
"KRN",19,10989,"RPC",1889,0)
TIU USER INACTIVE?
"KRN",19,10989,"RPC",1890,0)
ORWTPD PUTOCM
"KRN",19,10989,"RPC",1891,0)
ORWOR ACTION TEXT
"KRN",19,10989,"RPC",1892,0)
ORQQPXRM GEC DIALOG
"KRN",19,10989,"RPC",1893,0)
ORQQPXRM GET WH REPORT TEXT
"KRN",19,10989,"RPC",1894,0)
ORWDXR01 CANCHG
"KRN",19,10989,"RPC",1895,0)
ORWDXR01 SAVCHG
"KRN",19,10989,"RPC",1896,0)
TIU HAS AUTHOR SIGNED?
"KRN",19,10989,"RPC",1897,0)
ORQQPXRM CHECK REM VERSION
"KRN",19,10989,"RPC",1898,0)
ORQQPXRM GEC STATUS PROMPT
"KRN",19,10989,"RPC",1899,0)
ORQQPXRM GEC STATUS PROMPT
"KRN",19,10989,"RPC",1900,0)
ORWDAL32 SEND BULLETIN
"KRN",19,10989,"RPC",1901,0)
ORWDBA1 ORPKGTYP
"KRN",19,10989,"RPC",1902,0)
ORWDXR01 ISSPLY
"KRN",19,10989,"RPC",1903,0)
ORWDBA1 RCVORCI
"KRN",19,10989,"RPC",1904,0)
ORWPS REASON
"KRN",19,10989,"RPC",1905,0)
ORQQPXRM GEC FINISHED?
"KRN",19,10989,"RPC",1906,0)
ORWDXM3 ISUDQO
"KRN",19,10989,"RPC",1908,0)
ORWDBA1 SCLST
"KRN",19,10989,"RPC",1909,0)
ORWDXR01 OXDATA
"KRN",19,10989,"RPC",1914,0)
ORWDBA1 BASTATUS
"KRN",19,10989,"RPC",1920,0)
ORWORB SETSORT
"KRN",19,10989,"RPC",1921,0)
ORWORB GETSORT
"KRN",19,10989,"RPC",1922,0)
ORWOR EXPIRED
"KRN",19,10989,"RPC",1928,0)
ORECS01 GETDIV
"KRN",19,10989,"RPC",1933,0)
ORWTPD1 GETEFDAT
"KRN",19,10989,"RPC",1934,0)
ORWTPD1 GETEDATS
"KRN",19,10989,"RPC",1935,0)
ORWTPD1 PUTEDATS
"KRN",19,10989,"RPC",1936,0)
ORWTPD1 GETCSDEF
"KRN",19,10989,"RPC",1937,0)
ORWTPD1 GETCSRNG
"KRN",19,10989,"RPC",1938,0)
ORWTPD1 PUTCSRNG
"KRN",19,10989,"RPC",1939,0)
ORWTPD1 GETEAFL
"KRN",19,10989,"RPC",1940,0)
ORWDBA1 GETORDX
"KRN",19,10989,"RPC",1941,0)
ORWDBA3 HINTS
"KRN",19,10989,"RPC",1942,0)
ORWDAL32 LOAD FOR EDIT
"KRN",19,10989,"RPC",1943,0)
ORWDAL32 SAVE ALLERGY
"KRN",19,10989,"RPC",1944,0)
ORWDAL32 SITE PARAMS
"KRN",19,10989,"RPC",1945,0)
ORWPCE CXNOSHOW
"KRN",19,10989,"RPC",1946,0)
ORWDBA2 ADDPDL
"KRN",19,10989,"RPC",1947,0)
ORWDBA2 DELPDL
"KRN",19,10989,"RPC",1948,0)
ORWDBA2 GETDUDC
"KRN",19,10989,"RPC",1949,0)
ORWDBA2 GETPDL
"KRN",19,10989,"RPC",1950,0)
ORWDBA4 GETBAUSR
"KRN",19,10989,"RPC",1951,0)
ORWDBA4 GETTFCI
"KRN",19,10989,"RPC",1952,0)
ORWNSS NSSMSG
"KRN",19,10989,"RPC",1953,0)
ORWNSS QOSCH
"KRN",19,10989,"RPC",1954,0)
ORWNSS VALSCH
"KRN",19,10989,"RPC",1955,0)
ORWNSS CHKSCH
"KRN",19,10989,"RPC",1956,0)
ORWDPS4 ISUDIV
"KRN",19,10989,"RPC",1957,0)
ORWDPS32 AUTHNVA
"KRN",19,10989,"RPC",1962,0)
ORWTIU CHKTXT
"KRN",19,10989,"RPC",1964,0)
ORWDPS5 ISVTP
"KRN",19,10989,"RPC",1965,0)
TIU IS THIS A SURGERY?
"KRN",19,10989,"RPC",1966,0)
TIU IDENTIFY SURGERY CLASS
"KRN",19,10989,"RPC",1967,0)
TIU LONG LIST SURGERY TITLES
"KRN",19,10989,"RPC",1968,0)
TIU GET DOCUMENTS FOR REQUEST
"KRN",19,10989,"RPC",1969,0)
TIU SET ADMINISTRATIVE CLOSURE
"KRN",19,10989,"RPC",1970,0)
ORBCMA5 GETUDID
"KRN",19,10989,"RPC",1973,0)
ORIMO ISCLOC
"KRN",19,10989,"RPC",1974,0)
ORIMO ISIVQO
"KRN",19,10989,"RPC",1975,0)
ORWDBA7 GETIEN9
"KRN",19,10989,"RPC",1976,0)
ORWGN GNLOC
"KRN",19,10989,"RPC",1977,0)
ORWGN AUTHUSR
"KRN",19,10989,"RPC",1978,0)
ORVAA VAA
"KRN",19,10989,"RPC",1981,0)
ORWDAL32 CLINUSER
"KRN",19,10989,"RPC",1982,0)
ORWDBA7 ISWITCH
"KRN",19,10989,"RPC",1983,0)
ORWDFH CURRENT MEALS
"KRN",19,10989,"RPC",1984,0)
ORWDFH NFSLOC READY
"KRN",19,10989,"RPC",1985,0)
ORWDFH OPDIETS
"KRN",19,10989,"RPC",1986,0)
ORWMHV MHV
"KRN",19,10989,"RPC",1987,0)
ORWPCE1 NONCOUNT
"KRN",19,10989,"RPC",1988,0)
ORWPFSS IS PFSS ACTIVE?
"KRN",19,10989,"RPC",1989,0)
GMV EXTRACT REC
"KRN",19,10989,"RPC",1990,0)
GMV MARK ERROR
"KRN",19,10989,"RPC",1991,0)
ORWDXVB COMPORD
"KRN",19,10989,"RPC",1992,0)
ORWDXVB GETALL
"KRN",19,10989,"RPC",1993,0)
ORWDXVB RAW
"KRN",19,10989,"RPC",1994,0)
ORWDXVB RESULTS
"KRN",19,10989,"RPC",1995,0)
ORWDXVB STATALOW
"KRN",19,10989,"RPC",1996,0)
ORWGRPC ALLITEMS
"KRN",19,10989,"RPC",1997,0)
ORWGRPC CLASS
"KRN",19,10989,"RPC",1998,0)
ORWGRPC DATEITEM
"KRN",19,10989,"RPC",1999,0)
ORWGRPC DELVIEWS
"KRN",19,10989,"RPC",2000,0)
ORWGRPC DETAILS
"KRN",19,10989,"RPC",2001,0)
ORWGRPC GETDATES
"KRN",19,10989,"RPC",2002,0)
ORWGRPC GETPREF
"KRN",19,10989,"RPC",2003,0)
ORWGRPC GETVIEWS
"KRN",19,10989,"RPC",2004,0)
ORWGRPC ITEMDATA
"KRN",19,10989,"RPC",2005,0)
ORWGRPC ITEMS
"KRN",19,10989,"RPC",2006,0)
ORWGRPC LOOKUP
"KRN",19,10989,"RPC",2007,0)
ORWGRPC PUBLIC
"KRN",19,10989,"RPC",2008,0)
ORWGRPC RPTPARAM
"KRN",19,10989,"RPC",2009,0)
ORWGRPC SETPREF
"KRN",19,10989,"RPC",2010,0)
ORWGRPC SETVIEWS
"KRN",19,10989,"RPC",2011,0)
ORWGRPC TESTSPEC
"KRN",19,10989,"RPC",2012,0)
ORWGRPC TYPES
"KRN",19,10989,"RPC",2013,0)
TIU GET DOCUMENT STATUS
"KRN",19,10989,"RPC",2014,0)
TIU GET PRF ACTIONS
"KRN",19,10989,"RPC",2015,0)
TIU ISPRF
"KRN",19,10989,"RPC",2016,0)
TIU LINK TO FLAG
"KRN",19,10989,"RPC",2017,0)
ORWGRPC DETAIL
"KRN",19,10989,"RPC",2018,0)
ORWU VERSION
"KRN",19,10989,"RPC",2019,0)
GMV ALLERGY
"KRN",19,10989,"RPC",2020,0)
ORWCIRN WEBADDR
"KRN",19,10989,"RPC",2023,0)
ORWGRPC TAX
"KRN",19,10989,"RPC",2024,0)
GMV DLL VERSION
"KRN",19,10989,"RPC",2025,0)
ORWDX CHANGE
"KRN",19,10989,"RPC",2026,0)
GMV ADD VM
"KRN",19,10989,"RPC",2027,0)
GMV CONVERT DATE
"KRN",19,10989,"RPC",2028,0)
GMV GET CATEGORY IEN
"KRN",19,10989,"RPC",2029,0)
GMV GET CURRENT TIME
"KRN",19,10989,"RPC",2030,0)
GMV GET VITAL TYPE IEN
"KRN",19,10989,"RPC",2031,0)
GMV LATEST VM
"KRN",19,10989,"RPC",2032,0)
GMV MANAGER
"KRN",19,10989,"RPC",2033,0)
GMV PARAMETER
"KRN",19,10989,"RPC",2034,0)
GMV USER
"KRN",19,10989,"RPC",2035,0)
GMV VITALS/CAT/QUAL
"KRN",19,10989,"RPC",2036,0)
GMV V/M ALLDATA
"KRN",19,10989,"RPC",2037,0)
TIU GET LINKED PRF NOTES
"KRN",19,10989,"RPC",2038,0)
TIU GET PRF TITLE
"KRN",19,10989,"RPC",2039,0)
ORWDX1 PATWARD
"KRN",19,10989,"RPC",2040,0)
ORWRP4 HDR MODIFY
"KRN",19,10989,"RPC",2041,0)
ORWDX1 STCHANGE
"KRN",19,10989,"RPC",2042,0)
ORWDX1 DCREN
"KRN",19,10989,"RPC",2043,0)
ORQQPXRM MHV
"KRN",19,10989,"RPC",2044,0)
ORWGRPC GETSIZE
"KRN",19,10989,"RPC",2045,0)
ORWGRPC SETSIZE
"KRN",19,10989,"RPC",2046,0)
GMV LOCATION SELECT
"KRN",19,10989,"RPC",2047,0)
ORWCIRN AUTORDV
"KRN",19,10989,"RPC",2048,0)
ORPRF TRIGGER POPUP
"KRN",19,10989,"RPC",2049,0)
ORWCIRN HDRON
"KRN",19,10989,"RPC",2051,0)
ORCDLR2 CHECK ALL LC TO WC
"KRN",19,10989,"RPC",2052,0)
ORCDLR2 CHECK ONE LC TO WC
"KRN",19,10989,"RPC",2053,0)
ORALWORD ALLWORD
"KRN",19,10989,"RPC",2054,0)
ORWDX1 ORDMATCH
"KRN",19,10989,"RPC",2055,0)
ORWDX1 DCORIG
"KRN",19,10989,"RPC",2056,0)
ORWDX1 UNDCORIG
"KRN",19,10989,"RPC",2057,0)
ORWDXVB SUBCHK
"KRN",19,10989,"RPC",2058,0)
ORDDPAPI ADMTIME
"KRN",19,10989,"RPC",2059,0)
ORWU PARAMS
"KRN",19,10989,"RPC",2060,0)
ORWDPS1 DOWSCH
"KRN",19,10989,"RPC",2061,0)
ORWDPS33 COMPLOC
"KRN",19,10989,"RPC",2062,0)
ORWGRPC FASTDATA
"KRN",19,10989,"RPC",2063,0)
ORWGRPC FASTITEM
"KRN",19,10989,"RPC",2064,0)
ORWGRPC FASTTASK
"KRN",19,10989,"RPC",2065,0)
ORWGRPC FASTLABS
"KRN",19,10989,"RPC",2066,0)
ORWDPS1 QOMEDALT
"KRN",19,10989,"RPC",2067,0)
ORWGRPC ALLVIEWS
"KRN",19,10989,"RPC",2068,0)
ORDDPAPI CLOZMSG
"KRN",19,10989,"RPC",2069,0)
ORWGRPC TESTING
"KRN",19,10989,"RPC",2070,0)
ORQQPXRM MHDLL
"KRN",19,10989,"RPC",2071,0)
ORWDLR33 LC TO WC
"KRN",19,10989,"RPC",2072,0)
ORWU2 COSIGNER
"KRN",19,10989,"RPC",2073,0)
ORWDXVB NURSADMN
"KRN",19,10989,"RPC",2075,0)
TIU IS USER A USR PROVIDER
"KRN",19,10989,"RPC",2076,0)
ORWDPS33 IVDOSFRM
"KRN",19,10989,"RPC",2077,0)
ORWDPS32 ALLIVRTE
"KRN",19,10989,"RPC",2078,0)
ORWDXM1 SVRPC
"KRN",19,10989,"RPC",2079,0)
ORWDXVB VBTNS
"KRN",19,10989,"RPC",2080,0)
MAG4 REMOTE IMPORT
"KRN",19,10989,"RPC",2081,0)
ORWDX UNLKOTH
"KRN",19,10989,"RPC",2082,0)
OR GET COMBAT VET
"KRN",19,10989,"RPC",2083,0)
GMV CLOSEST READING
"KRN",19,10989,"RPC",2084,0)
ORQQCN ISPROSVC
"KRN",19,10989,"RPC",2085,0)
ORQQPL PROBLEM NTRT BULLETIN
"KRN",19,10989,"RPC",2086,0)
ORWPCE GET DX TEXT
"KRN",19,10989,"RPC",2087,0)
ORCHECK ISMONO
"KRN",19,10989,"RPC",2088,0)
ORCHECK GETMONO
"KRN",19,10989,"RPC",2089,0)
ORCHECK GETMONOL
"KRN",19,10989,"RPC",2090,0)
ORCHECK DELMONO
"KRN",19,10989,"RPC",2091,0)
ORCHECK GETXTRA
"KRN",19,10989,"RPC",2092,0)
ORWDPS33 GETADDFR
"KRN",19,10989,"RPC",2093,0)
ORCNOTE GET TOTAL
"KRN",19,10989,"RPC",2094,0)
ORVW FACLIST
"KRN",19,10989,"RPC",2095,0)
ORWDXVB3 DIAGORD
"KRN",19,10989,"RPC",2096,0)
ORWDXVB3 COLLTIM
"KRN",19,10989,"RPC",2097,0)
ORWDXVB3 SWPANEL
"KRN",19,10989,"RPC",2099,0)
XUS PKI GET UPN
"KRN",19,10989,"RPC",2100,0)
ORDEA HASHINFO
"KRN",19,10989,"RPC",2101,0)
ORDEA ORDHINFO
"KRN",19,10989,"RPC",2102,0)
ORDEA DEATEXT
"KRN",19,10989,"RPC",2103,0)
ORDEA CSVALUE
"KRN",19,10989,"RPC",2104,0)
ORDEA SIGINFO
"KRN",19,10989,"RPC",2106,0)
ORWPCE ICDVER
"KRN",19,10989,"RPC",2107,0)
ORDEA PINLKCHK
"KRN",19,10989,"RPC",2108,0)
ORDEA PINLKSET
"KRN",19,10989,"RPC",2109,0)
ORQQPL4 LEX
"KRN",19,10989,"RPC",2110,0)
ORDEA PNDHLD
"KRN",19,10989,"RPC",2111,0)
XUS PKI SET UPN
"KRN",19,10989,"RPC",2112,0)
ORDEA LNKMSG
"KRN",19,10989,"RPC",2113,0)
ORWPCE4 LEX
"KRN",19,10989,"RPC",2114,0)
ORWLEX GETI10DX
"KRN",19,10989,"RPC",2115,0)
ORWPCE I10IMPDT
"KRN",19,10989,"RPC",2131,0)
ORWLEX GETFREQ
"KRN",19,10989,"RPC",2132,0)
ORDEBUG SAVERPCS
"KRN",19,10989,"RPC",2133,0)
ORDEBUG SAVEDESC
"KRN",19,10989,"RPC",2144,0)
XWB ARE RPCS AVAILABLE
"KRN",19,10989,"RPC",2145,0)
ORWRP1A RADIO
"KRN",19,10989,"RPC",2146,0)
ORQQCN GET USER AUTH
"KRN",19,10989,"RPC",2147,0)
ORUTL ISCLORD
"KRN",19,10989,"RPC",2148,0)
ORWU OVERDL
"KRN",19,10989,"RPC",2149,0)
ORBCMA5 JOB
"KRN",19,10989,"RPC",2150,0)
ORBCMA5 LOCK
"KRN",19,10989,"RPC",2151,0)
ORBCMA5 UNLOCK
"KRN",19,10989,"RPC",2152,0)
TIU CAN PRINT WORK/CHART COPY
"KRN",19,10989,"RPC",2154,0)
ORWGN IDTVALID
"KRN",19,10989,"RPC",2155,0)
ORWGN MAXFRQ
"KRN",19,10989,"RPC",2156,0)
ORUTL4 DLL
"KRN",19,10989,"U")
CPRSCHART VERSION 1.0.30.72
"KRN",19,11056,-1)
2^3
"KRN",19,11056,0)
OR PARAM IRM MENU^CPRS Configuration (IRM)^^M^11712^XUPROG^^^^^^
"KRN",19,11056,10,0)
^19.01IP^9^9
"KRN",19,11056,10,9,0)
14299^DBG
"KRN",19,11056,10,9,"^")
OR DEBUG REPORT
"KRN",19,11056,"U")
CPRS CONFIGURATION (IRM)
"KRN",19,11057,-1)
2^6
"KRN",19,11057,0)
OR PARAM COORDINATOR MENU^CPRS Configuration (Clin Coord)^^M^11712^^^^^^^^^
"KRN",19,11057,10,0)
^19.01IP^26^26
"KRN",19,11057,10,26,0)
14320^CI
"KRN",19,11057,10,26,"^")
ORW CLIN IND DATE DFLT
"KRN",19,11057,"U")
CPRS CONFIGURATION (CLIN COORD
"KRN",19,12132,-1)
0^2
"KRN",19,12132,0)
OR BCMA ORDER COM^OR BCMA ORDER COM VERSION 1.0^^B^^^^^^^^
"KRN",19,12132,99.1)
63592,52298
"KRN",19,12132,"RPC",0)
^19.05P^151^151
"KRN",19,12132,"RPC",1,0)
ORBCMA32 DLGSLCT
"KRN",19,12132,"RPC",2,0)
ORBCMA5 GETIVID
"KRN",19,12132,"RPC",3,0)
ORBCMA5 GETUD
"KRN",19,12132,"RPC",4,0)
ORBCMA5 GETUDID
"KRN",19,12132,"RPC",5,0)
ORBCMA5 ODITMBC
"KRN",19,12132,"RPC",6,0)
ORWUBCMA USERINFO
"KRN",19,12132,"RPC",7,0)
ORWDXA DC
"KRN",19,12132,"RPC",8,0)
ORWDXA VALID
"KRN",19,12132,"RPC",16,0)
ORWCH SAVESIZ
"KRN",19,12132,"RPC",17,0)
ORWU DT
"KRN",19,12132,"RPC",18,0)
ORWU VALDT
"KRN",19,12132,"RPC",19,0)
ORWU EXTNAME
"KRN",19,12132,"RPC",20,0)
ORWU NPHASKEY
"KRN",19,12132,"RPC",21,0)
ORWU GBLREF
"KRN",19,12132,"RPC",22,0)
ORWU PARAM
"KRN",19,12132,"RPC",23,0)
ORWU HASKEY
"KRN",19,12132,"RPC",24,0)
ORWU HAS OPTION ACCESS
"KRN",19,12132,"RPC",25,0)
ORWU VALIDSIG
"KRN",19,12132,"RPC",26,0)
ORWUL FV4DG
"KRN",19,12132,"RPC",27,0)
ORWUL FVSUB
"KRN",19,12132,"RPC",28,0)
ORWUL FVIDX
"KRN",19,12132,"RPC",29,0)
ORWUL QV4DG
"KRN",19,12132,"RPC",30,0)
ORWUL QVSUB
"KRN",19,12132,"RPC",31,0)
ORWUL QVIDX
"KRN",19,12132,"RPC",32,0)
ORWORB KILL UNSIG ORDERS ALERT
"KRN",19,12132,"RPC",33,0)
ORWORB UNSIG ORDERS FOLLOWUP
"KRN",19,12132,"RPC",34,0)
ORWORB KILL EXPIR MED ALERT
"KRN",19,12132,"RPC",35,0)
ORWORB KILL EXPIR OI ALERT
"KRN",19,12132,"RPC",36,0)
ORWORB KILL UNVER MEDS ALERT
"KRN",19,12132,"RPC",37,0)
ORWORB KILL UNVER ORDERS ALERT
"KRN",19,12132,"RPC",38,0)
ORWORB AUTOUNFLAG ORDERS
"KRN",19,12132,"RPC",39,0)
ORWORB GETDATA
"KRN",19,12132,"RPC",40,0)
ORB DELETE ALERT
"KRN",19,12132,"RPC",41,0)
ORWPT DIEDON
"KRN",19,12132,"RPC",42,0)
ORWPT SELECT
"KRN",19,12132,"RPC",43,0)
ORWPT INPLOC
"KRN",19,12132,"RPC",44,0)
ORWPT ENCTITL
"KRN",19,12132,"RPC",45,0)
ORWPT1 PRCARE
"KRN",19,12132,"RPC",46,0)
ORWRP GET DEFAULT PRINTER
"KRN",19,12132,"RPC",48,0)
ORWDX DGNM
"KRN",19,12132,"RPC",49,0)
ORWDX DLGDEF
"KRN",19,12132,"RPC",50,0)
ORWDX LOADRSP
"KRN",19,12132,"RPC",51,0)
ORWDX SAVE
"KRN",19,12132,"RPC",52,0)
ORWDX MSG
"KRN",19,12132,"RPC",53,0)
ORWDX ORDITM
"KRN",19,12132,"RPC",54,0)
ORWDX WRLST
"KRN",19,12132,"RPC",55,0)
ORWDX DISMSG
"KRN",19,12132,"RPC",56,0)
ORWDX SEND
"KRN",19,12132,"RPC",57,0)
ORWDX SENDP
"KRN",19,12132,"RPC",58,0)
ORWDX DLGID
"KRN",19,12132,"RPC",59,0)
ORWDX FORMID
"KRN",19,12132,"RPC",60,0)
ORWDX LOCK
"KRN",19,12132,"RPC",61,0)
ORWDX UNLOCK
"KRN",19,12132,"RPC",62,0)
ORWDX LOCK ORDER
"KRN",19,12132,"RPC",63,0)
ORWDX UNLOCK ORDER
"KRN",19,12132,"RPC",64,0)
ORWDPS2 SCHREQ
"KRN",19,12132,"RPC",65,0)
ORWDPS2 OISLCT
"KRN",19,12132,"RPC",76,0)
ORWDXC ON
"KRN",19,12132,"RPC",77,0)
ORWDXC DISPLAY
"KRN",19,12132,"RPC",78,0)
ORWDXC ACCEPT
"KRN",19,12132,"RPC",79,0)
ORWDXC SESSION
"KRN",19,12132,"RPC",80,0)
ORWDXC SAVECHK
"KRN",19,12132,"RPC",81,0)
ORWDXC DELORD
"KRN",19,12132,"RPC",82,0)
ORWD1 SIG4ANY
"KRN",19,12132,"RPC",83,0)
ORWORR GET
"KRN",19,12132,"RPC",84,0)
ORWORR GETTXT
"KRN",19,12132,"RPC",85,0)
ORWDXM DLGNAME
"KRN",19,12132,"RPC",86,0)
ORWDXM PROMPTS
"KRN",19,12132,"RPC",87,0)
ORWDXM AUTOACK
"KRN",19,12132,"RPC",88,0)
ORWDXM MSTYLE
"KRN",19,12132,"RPC",89,0)
ORWDXM FORMID
"KRN",19,12132,"RPC",90,0)
ORWDXM1 BLDQRSP
"KRN",19,12132,"RPC",91,0)
ORWDXM2 CLRRCL
"KRN",19,12132,"RPC",92,0)
ORWORDG MAPSEQ
"KRN",19,12132,"RPC",93,0)
ORWORDG IEN
"KRN",19,12132,"RPC",94,0)
ORWOR UNSIGN
"KRN",19,12132,"RPC",95,0)
ORBCMA1 ODSLCT
"KRN",19,12132,"RPC",96,0)
ORBCMA1 CHK94
"KRN",19,12132,"RPC",97,0)
ORBCMA1 DOSEALT
"KRN",19,12132,"RPC",98,0)
ORBCMA1 FORMALT
"KRN",19,12132,"RPC",99,0)
ORBCMA1 FAILDEA
"KRN",19,12132,"RPC",100,0)
ORBCMA1 SCHALL
"KRN",19,12132,"RPC",101,0)
ORBCMA32 AUTH
"KRN",19,12132,"RPC",102,0)
ORBCMA32 DRUGMSG
"KRN",19,12132,"RPC",103,0)
ORBCMA32 FORMALT
"KRN",19,12132,"RPC",104,0)
ORBCMA32 ISSPLY
"KRN",19,12132,"RPC",105,0)
ORBCMA32 IVAMT
"KRN",19,12132,"RPC",106,0)
ORBCMA32 VALRATE
"KRN",19,12132,"RPC",107,0)
ORBCMA32 VALROUTE
"KRN",19,12132,"RPC",108,0)
ORBCMA32 VALSCH
"KRN",19,12132,"RPC",109,0)
ORWU USERINFO
"KRN",19,12132,"RPC",110,0)
PSB PARAMETER
"KRN",19,12132,"RPC",111,0)
PSB FMDATE
"KRN",19,12132,"RPC",112,0)
PSB MOB DRUG LIST
"KRN",19,12132,"RPC",113,0)
PSB CPRS ORDER
"KRN",19,12132,"RPC",114,0)
ORWDPS2 QOGRP
"KRN",19,12132,"RPC",115,0)
PSB GETPROVIDER
"KRN",19,12132,"RPC",116,0)
ORDDPAPI ADMTIME
"KRN",19,12132,"RPC",117,0)
ORWDXR01 ISSPLY
"KRN",19,12132,"RPC",118,0)
ORALWORD ALLWORD
"KRN",19,12132,"RPC",119,0)
ORWDXA ISACTOI
"KRN",19,12132,"RPC",120,0)
ORWOR PKISITE
"KRN",19,12132,"RPC",121,0)
ORWDPS2 ADMIN
"KRN",19,12132,"RPC",122,0)
ORWPFSS IS PFSS ACTIVE?
"KRN",19,12132,"RPC",123,0)
ORCHECK ISMONO
"KRN",19,12132,"RPC",124,0)
ORWCH LOADSIZ
"KRN",19,12132,"RPC",125,0)
ORCHECK DELMONO
"KRN",19,12132,"RPC",126,0)
ORWDPS33 IVDOSFRM
"KRN",19,12132,"RPC",127,0)
ORWDRA32 LOCTYPE
"KRN",19,12132,"RPC",128,0)
ORWDXM3 ISUDQO
"KRN",19,12132,"RPC",129,0)
OREVNTX1 DLGIEN
"KRN",19,12132,"RPC",130,0)
ORIMO IMOLOC
"KRN",19,12132,"RPC",131,0)
ORIMO ISIVQO
"KRN",19,12132,"RPC",132,0)
ORWDX AGAIN
"KRN",19,12132,"RPC",133,0)
ORWDPS1 IVDEA
"KRN",19,12132,"RPC",134,0)
ORWDPS32 ALLIVRTE
"KRN",19,12132,"RPC",135,0)
ORWTPD1 GETEAFL
"KRN",19,12132,"RPC",136,0)
ORWU NEWPERS
"KRN",19,12132,"RPC",137,0)
ORWTPD1 GETEDATS
"KRN",19,12132,"RPC",138,0)
ORWCV VST
"KRN",19,12132,"RPC",139,0)
ORWU1 NEWLOC
"KRN",19,12132,"RPC",140,0)
ORWPCE GETSVC
"KRN",19,12132,"RPC",141,0)
ORCHECK GETXTRA
"KRN",19,12132,"RPC",142,0)
ORWPT ADMITLST
"KRN",19,12132,"RPC",143,0)
ORWDPS33 GETADDFR
"KRN",19,12132,"RPC",144,0)
ORWDPS1 ODSLCT
"KRN",19,12132,"RPC",145,0)
ORCHECK GETMONO
"KRN",19,12132,"RPC",146,0)
ORWDPS1 DFLTSPLY
"KRN",19,12132,"RPC",147,0)
ORCHECK GETMONOL
"KRN",19,12132,"RPC",148,0)
ORBCMA5 JOB
"KRN",19,12132,"RPC",149,0)
ORBCMA5 LOCK
"KRN",19,12132,"RPC",150,0)
ORBCMA5 UNLOCK
"KRN",19,12132,"RPC",151,0)
ORWU MOBAPP
"KRN",19,12132,"U")
OR BCMA ORDER COM VERSION 1.0
"KRN",19,14299,-1)
0^4
"KRN",19,14299,0)
OR DEBUG REPORT^RPC DEBUG REPORT^^A^^^^^^^^^^1
"KRN",19,14299,1,0)
^19.06^2^2^3140305^^
"KRN",19,14299,1,1,0)
This is a report that shows a list of reports generated by CPRS to 
"KRN",19,14299,1,2,0)
capture the sequence of RPCs that were called
"KRN",19,14299,20)
D DL^ORDEBUG2
"KRN",19,14299,99)
63251,33087
"KRN",19,14299,"U")
RPC DEBUG REPORT
"KRN",19,14320,-1)
0^5
"KRN",19,14320,0)
ORW CLIN IND DATE DFLT^Consults Clinically Indicated Date Default^^A^^^^^^^^ORDER ENTRY/RESULTS REPORTING^^1
"KRN",19,14320,1,0)
^^4^4^3150217^
"KRN",19,14320,1,1,0)
This option allows you to set the default value for the ORCDGMRC 
"KRN",19,14320,1,2,0)
CLIN IND DATE DEFAULT parameter at the DIVISION or SYSTEM level.  This 
"KRN",19,14320,1,3,0)
parameter is used to control the default value for the Clinically 
"KRN",19,14320,1,4,0)
Indicated Date used in consult orders.
"KRN",19,14320,20)
D EDITPAR^XPAREDIT("ORCDGMRC CLIN IND DATE DEFAULT")
"KRN",19,14320,"U")
CONSULTS CLINICALLY INDICATED 
"KRN",19.1,682,-1)
0^1
"KRN",19.1,682,0)
ORSUPPLY^WHO CAN ORDER SUPPLIES^l^n
"KRN",19.1,682,1,0)
^^2^2^3150128^
"KRN",19.1,682,1,1,0)
The purpose of this key is identify those non-provider users who are 
"KRN",19.1,682,1,2,0)
allowed to order supplies using the PSO SUPPLY order dialog.
"KRN",8989.5,20794,0)
170;DIC(9.4,^ORPARAM OVER DATELINE^1
"KRN",8989.5,20794,1)
0
"KRN",8989.5,21374,0)
170;DIC(9.4,^OR LAB TAB DEFAULT REPORT^1
"KRN",8989.5,21374,1)
ORL MOST RECENT
"KRN",8989.5,21389,0)
170;DIC(9.4,^OR MOB DLL VERSION^1
"KRN",8989.5,21389,1)
2.0.16.0
"KRN",8989.51,732,-1)
0^2
"KRN",8989.51,732,0)
OR REPORT DATE SELECT TYPE^Reports/Lab Tab Date Select Type^^^Yes/No
"KRN",8989.51,732,1)
Y^Y:yes;N:no^Enter 'yes' to select Date Ranges by buttons
"KRN",8989.51,732,20,0)
^8989.512^3^3^3110531^^^^
"KRN",8989.51,732,20,1,0)
'Yes' will change the way Date Ranges are selected on the Reports
"KRN",8989.51,732,20,2,0)
and Labs Tabs in CPRS, using Radio Buttons to make selections rather
"KRN",8989.51,732,20,3,0)
than from a list.
"KRN",8989.51,732,30,0)
^8989.513I^4^3
"KRN",8989.51,732,30,2,0)
2^4
"KRN",8989.51,732,30,3,0)
3^4.2
"KRN",8989.51,732,30,4,0)
1^9.4
"KRN",8989.51,733,-1)
0^1
"KRN",8989.51,733,0)
OR LAB TAB DEFAULT REPORT^Lab Tab Default Report^^^Lab Tab Default Report
"KRN",8989.51,733,1)
P^101.24^Enter the Lab Report to be shown when selecting the Labs Tab
"KRN",8989.51,733,3)
I $P($G(^ORD(101.24,+Y,0)),"^",8)="L"
"KRN",8989.51,733,20,0)
^8989.512^2^2^3111122^^^^
"KRN",8989.51,733,20,1,0)
This defines the preferred report to be shown when selecting the Labs Tab.
"KRN",8989.51,733,20,2,0)
This report also will be the first one listed in the list of reports.
"KRN",8989.51,733,30,0)
^8989.513I^6^6
"KRN",8989.51,733,30,1,0)
1^200
"KRN",8989.51,733,30,2,0)
4^44
"KRN",8989.51,733,30,3,0)
7^4.2
"KRN",8989.51,733,30,4,0)
9^9.4
"KRN",8989.51,733,30,5,0)
6^4
"KRN",8989.51,733,30,6,0)
5^49
"KRN",8989.51,808,-1)
0^4
"KRN",8989.51,808,0)
ORPARAM OVER DATELINE^OVER DATELINE^0
"KRN",8989.51,808,1)
Y^^Enter Yes if the site is over the international date line such as Hawaii is.
"KRN",8989.51,808,20,0)
^8989.512^2^2^3141015^^
"KRN",8989.51,808,20,1,0)
This is a switch that the CPRS GUI will use to enable specific logic for 
"KRN",8989.51,808,20,2,0)
sites that are over the international date line
"KRN",8989.51,808,30,0)
^8989.513I^4^4
"KRN",8989.51,808,30,1,0)
5^4.2
"KRN",8989.51,808,30,2,0)
10^9.4
"KRN",8989.51,808,30,3,0)
4^4
"KRN",8989.51,808,30,4,0)
3^44
"KRN",8989.51,814,-1)
0^6
"KRN",8989.51,814,0)
ORCDGMRC CLIN IND DATE DEFAULT^Clinically Indicated Date Default^0
"KRN",8989.51,814,1)
F^^Enter default relative date (e.g. T+30D, T+2W, T+1M), no time or past dates.
"KRN",8989.51,814,2)
S X=$$UP^XLFSTR(X) Q:X="TODAY"!(X="T")  K:X'["T"&($L(X)'>1) X I $D(X) K:X'?1"T+"1.2N.(1"D",1"W",1"M") X
"KRN",8989.51,814,4,0)
^8989.514^1^1
"KRN",8989.51,814,4,1,0)
CLINICALLY
"KRN",8989.51,814,4,"B","CLINICALLY",1)

"KRN",8989.51,814,20,0)
^^13^13^3141211^
"KRN",8989.51,814,20,1,0)
This defines the default date value for the CLINICALLY INDICATED DATE 
"KRN",8989.51,814,20,2,0)
(CID) field in consult and procedure orders.  This date value can be 
"KRN",8989.51,814,20,3,0)
TODAY or greater and must be a relative date (e.g. "TODAY", T+7D, "T+2W").
"KRN",8989.51,814,20,4,0)
Past dates and precise dates are not permitted.  The date value may also 
"KRN",8989.51,814,20,5,0)
be a null/empty date, which is set by deleting (via XPAR MENU TOOLS) the
"KRN",8989.51,814,20,6,0)
current value for the parameter (if one is set).
"KRN",8989.51,814,20,7,0)
  
"KRN",8989.51,814,20,8,0)
Any new orders in CPRS GUI and new quick orders will default to the 
"KRN",8989.51,814,20,9,0)
parameter value.  Any quick orders that currently have a default value 
"KRN",8989.51,814,20,10,0)
for the CID will retain that value.  If that quick order should reflect 
"KRN",8989.51,814,20,11,0)
the parameter value, simply remove the current default value for the 
"KRN",8989.51,814,20,12,0)
quick order and save the change.  The quick order would then default
"KRN",8989.51,814,20,13,0)
to the parameter value.
"KRN",8989.51,814,30,0)
^8989.513I^3^3
"KRN",8989.51,814,30,1,0)
1^4
"KRN",8989.51,814,30,2,0)
2^4.2
"KRN",8989.51,814,30,3,0)
3^9.4
"KRN",8989.51,818,-1)
0^7
"KRN",8989.51,818,0)
OR MOB DLL VERSION^CPRS Med Order Button DLL version check^0^CPRS MOB DLL name^^0
"KRN",8989.51,818,1)
F^^Required version # for the CPRS MOB DLL.
"KRN",8989.51,818,6)
F^Free text^Name of the CPRS MOB DLL.
"KRN",8989.51,818,20,0)
^8989.512^3^3^3150327^^^
"KRN",8989.51,818,20,1,0)
This parameter is used to store the current server version of the CPRS
"KRN",8989.51,818,20,2,0)
Med Order Button (MOB) DLL. This value is used to check against a user's 
"KRN",8989.51,818,20,3,0)
client version.
"KRN",8989.51,818,30,0)
^8989.513I^2^2
"KRN",8989.51,818,30,1,0)
1^4.2
"KRN",8989.51,818,30,2,0)
2^9.4
"KRN",8994,222,-1)
0^25
"KRN",8994,222,0)
ORQQPL EDIT LOAD^EDLOAD^ORQQPL1^2
"KRN",8994,222,1,0)
^^1^1^2961008^^
"KRN",8994,222,1,1,0)
Return array of default fields and original fields - GMPFLD() and GMPORIG()
"KRN",8994,222,2,0)
^8994.02A^1^1
"KRN",8994,222,2,1,0)
IFN^1
"KRN",8994,222,2,1,1,0)
^8994.021^1^1^3141203^^
"KRN",8994,222,2,1,1,1,0)
IFN for problem
"KRN",8994,222,2,"B","IFN",1)

"KRN",8994,423,-1)
0^26
"KRN",8994,423,0)
ORWPS COVER^COVER^ORWPS^2
"KRN",8994,423,1,0)
^^2^2^3000105^
"KRN",8994,423,1,1,0)
Returns a list of medications to display on the CPRS GUI cover sheet for a
"KRN",8994,423,1,2,0)
patient.
"KRN",8994,423,2,0)
^8994.02A^2^2
"KRN",8994,423,2,1,0)
DFN^1^^1^1
"KRN",8994,423,2,1,1,0)
^^1^1^3141204^
"KRN",8994,423,2,1,1,1,0)
The patient's internal entry number (IEN) in the PATIENT file (#2).
"KRN",8994,423,2,2,0)
FILTER^1^^0^2
"KRN",8994,423,2,2,1,0)
^8994.021^3^3^3141204^^
"KRN",8994,423,2,2,1,1,0)
Determines whether to filter non-VA medications for inpatients. A value 
"KRN",8994,423,2,2,1,2,0)
of 1 will filter out non-VA medications and a value of 0 will include 
"KRN",8994,423,2,2,1,3,0)
non-VA medications. The default value is 0.
"KRN",8994,423,2,"B","DFN",1)

"KRN",8994,423,2,"B","FILTER",2)

"KRN",8994,423,2,"PARAMSEQ",1,1)

"KRN",8994,423,2,"PARAMSEQ",2,2)

"KRN",8994,534,-1)
0^1
"KRN",8994,534,0)
ORWDXM1 BLDQRSP^BLDQRSP^ORWDXM1^2^^^^^^^1
"KRN",8994,534,1,0)
^8994.01^10^10^3140929^^^^
"KRN",8994,534,1,1,0)
Build responses for an order
"KRN",8994,534,1,2,0)
 
"KRN",8994,534,1,3,0)
Input:
"KRN",8994,534,1,4,0)
      1   2    3    4   5   6    7    8        11-20
"KRN",8994,534,1,5,0)
FLDS=DFN^LOC^ORNP^INPT^SEX^AGE^EVENT^SC%^^^Key Variables...
"KRN",8994,534,1,6,0)
ORIT=+ORIT: ptr to 101.41, $E(ORIT)=C: copy $E(ORIT)=X: change
"KRN",8994,534,1,7,0)
 
"KRN",8994,534,1,8,0)
Output:
"KRN",8994,534,1,9,0)
LST=QuickLevel^ResponseID(ORIT;$H)^Dialog^Type^FormID^DGrp
"KRN",8994,534,1,10,0)
LST(n)=verify text or rejection text
"KRN",8994,534,2,0)
^8994.02A^2^2
"KRN",8994,534,2,1,0)
ISIMO^1^^1^3
"KRN",8994,534,2,1,1,0)
^^1^1^3140929^
"KRN",8994,534,2,1,1,1,0)
This determine if the order is a Clinic order.
"KRN",8994,534,2,2,0)
ENCLOC^1^^1^4
"KRN",8994,534,2,2,1,0)
^8994.021^2^2^3140929^^^
"KRN",8994,534,2,2,1,1,0)
This passes the encounter location to the API. This is used for Admin 
"KRN",8994,534,2,2,1,2,0)
Times.
"KRN",8994,534,2,"B","ENCLOC",2)

"KRN",8994,534,2,"B","ISIMO",1)

"KRN",8994,534,2,"PARAMSEQ",3,1)

"KRN",8994,534,2,"PARAMSEQ",4,2)

"KRN",8994,3029,-1)
0^9
"KRN",8994,3029,0)
ORWRP1A RADIO^RADIO^ORWRP1A^1^^^^^1
"KRN",8994,3029,1,0)
^8994.01^2^2^3110614^^^
"KRN",8994,3029,1,1,0)
Check to determine the method of selecting Date Ranges on the Reports
"KRN",8994,3029,1,2,0)
and Labs Tabs in CPRS.
"KRN",8994,3050,-1)
0^11
"KRN",8994,3050,0)
ORDEBUG SAVERPCS^SAVERPCS^ORDEBUG^1
"KRN",8994,3050,1,0)
^^1^1^3130419^
"KRN",8994,3050,1,1,0)
Saves RPC log from CPRS to be used for other purposes/debugging problems
"KRN",8994,3050,2,0)
^8994.02A^2^2
"KRN",8994,3050,2,1,0)
ORKEY^1^^1^1
"KRN",8994,3050,2,1,1,0)
^^2^2^3130419^
"KRN",8994,3050,2,1,1,1,0)
ORKEY - should be a unique string using user id and date/time to 
"KRN",8994,3050,2,1,1,2,0)
differentiate different rpc log data
"KRN",8994,3050,2,2,0)
ORDATA^2^^1^2
"KRN",8994,3050,2,2,1,0)
^^1^1^3130419^
"KRN",8994,3050,2,2,1,1,0)
ORDATA - Array containing the RPC data to be stored for debugging
"KRN",8994,3050,2,"B","ORDATA",2)

"KRN",8994,3050,2,"B","ORKEY",1)

"KRN",8994,3050,2,"PARAMSEQ",1,1)

"KRN",8994,3050,2,"PARAMSEQ",2,2)

"KRN",8994,3050,3,0)
^^1^1^3130419^
"KRN",8994,3050,3,1,0)
Will always be 1
"KRN",8994,3051,-1)
0^10
"KRN",8994,3051,0)
ORDEBUG SAVEDESC^SAVEDESC^ORDEBUG^1
"KRN",8994,3051,1,0)
^^2^2^3130419^
"KRN",8994,3051,1,1,0)
Saves a user supplied description of why they are saving the RPC log from 
"KRN",8994,3051,1,2,0)
CRPS
"KRN",8994,3051,2,0)
^8994.02A^2^2
"KRN",8994,3051,2,1,0)
ORKEY^1^^1^1
"KRN",8994,3051,2,1,1,0)
^^2^2^3130419^
"KRN",8994,3051,2,1,1,1,0)
ORKEY - should be a unique string using user id and date/time to 
"KRN",8994,3051,2,1,1,2,0)
differentiate different rpc log data
"KRN",8994,3051,2,2,0)
ORDATA^2^^1^2
"KRN",8994,3051,2,2,1,0)
^^1^1^3130419^
"KRN",8994,3051,2,2,1,1,0)
ORDATA - The user supplied description
"KRN",8994,3051,2,"B","ORDATA",2)

"KRN",8994,3051,2,"B","ORKEY",1)

"KRN",8994,3051,2,"PARAMSEQ",1,1)

"KRN",8994,3051,2,"PARAMSEQ",2,2)

"KRN",8994,3051,3,0)
^^1^1^3130419^
"KRN",8994,3051,3,1,0)
Will always be 1
"KRN",8994,3088,-1)
0^19
"KRN",8994,3088,0)
ORQQCN GET USER AUTH^VALID^ORQQCN2^1
"KRN",8994,3088,1,0)
^8994.01^1^1^3131121^^^
"KRN",8994,3088,1,1,0)
This RPC returns the update authority of a user for a specific Consult.
"KRN",8994,3088,2,0)
^8994.02A^3^3
"KRN",8994,3088,2,1,0)
GMRCIEN^1^^1^1
"KRN",8994,3088,2,1,1,0)
^8994.021^1^1^3131121^^
"KRN",8994,3088,2,1,1,1,0)
This is the Consult Service IEN in file 123.5.
"KRN",8994,3088,2,2,0)
ORDUZ^1^^^2
"KRN",8994,3088,2,2,1,0)
^8994.021^1^1^3131121^^
"KRN",8994,3088,2,2,1,1,0)
This is the user dfn in file 200.
"KRN",8994,3088,2,3,0)
ORIFC^1^1^^3
"KRN",8994,3088,2,3,1,0)
^8994.021^2^2^3131121^^^
"KRN",8994,3088,2,3,1,1,0)
This is a binary (0 or 1) value indicating if IFC Coordinator is to be
"KRN",8994,3088,2,3,1,2,0)
included as a potential result.
"KRN",8994,3088,2,"B","GMRCIEN",1)

"KRN",8994,3088,2,"B","ORDUZ",2)

"KRN",8994,3088,2,"B","ORIFC",3)

"KRN",8994,3088,2,"PARAMSEQ",1,1)

"KRN",8994,3088,2,"PARAMSEQ",2,2)

"KRN",8994,3088,2,"PARAMSEQ",3,3)

"KRN",8994,3088,3,0)
^8994.03^8^8^3131121^^^
"KRN",8994,3088,3,1,0)
 The value returned is the equivalent of this set of codes: 
"KRN",8994,3088,3,2,0)
      0 = not an update user 
"KRN",8994,3088,3,3,0)
      1 = unrestricted access user
"KRN",8994,3088,3,4,0)
      2 = update user 
"KRN",8994,3088,3,5,0)
      3 = administrative update user 
"KRN",8994,3088,3,6,0)
      4 = admin AND update user
"KRN",8994,3088,3,7,0)
      5 = IFC coordinator
"KRN",8994,3088,3,8,0)
     -1 = Error occurred (-1^Error Msg)
"KRN",8994,3117,-1)
0^20
"KRN",8994,3117,0)
ORUTL ISCLORD^ISCLORD^ORUTL^1
"KRN",8994,3117,1,0)
^^1^1^3140630^
"KRN",8994,3117,1,1,0)
returns 1 if the ORIFN passed in is a clinic order, 0 otherwise
"KRN",8994,3117,2,0)
^8994.02A^1^1
"KRN",8994,3117,2,1,0)
orifn^1^^1
"KRN",8994,3117,2,"B","orifn",1)

"KRN",8994,3118,-1)
0^22
"KRN",8994,3118,0)
ORBCMA5 LOCK^LOCK^ORBCMA5^1
"KRN",8994,3118,1,0)
^8994.01^7^7^3140723^^
"KRN",8994,3118,1,1,0)
Due to issues with LOCKing between the CPRS GUI chart and the 
"KRN",8994,3118,1,2,0)
BCMAOrderCom dll, some changes are necessary to how locks are handled 
"KRN",8994,3118,1,3,0)
when locking the patient chart.
"KRN",8994,3118,1,4,0)
 
"KRN",8994,3118,1,5,0)
Using the $J value for the CPRS GUI session, the CPRS GUI will call the 
"KRN",8994,3118,1,6,0)
BCMAOrderCom dll and pass in the $J value and this value is used for 
"KRN",8994,3118,1,7,0)
locking the patient's chart.
"KRN",8994,3118,2,0)
^8994.02A^3^3
"KRN",8994,3118,2,1,0)
DFN^1^30^1^1
"KRN",8994,3118,2,1,1,0)
^^1^1^3140722^
"KRN",8994,3118,2,1,1,1,0)
The internal entry number (IEN) of the patient from the PATIENT file (#2).
"KRN",8994,3118,2,2,0)
ORJOB^1^20^1^2
"KRN",8994,3118,2,2,1,0)
^8994.021^1^1^3140723^^
"KRN",8994,3118,2,2,1,1,0)
The job number ($J) from the CPRS session on the M server.
"KRN",8994,3118,2,3,0)
ORY^1^4^1^1
"KRN",8994,3118,2,"B","DFN",1)

"KRN",8994,3118,2,"B","ORJOB",2)

"KRN",8994,3118,2,"B","ORY",3)

"KRN",8994,3118,2,"PARAMSEQ",1,1)

"KRN",8994,3118,2,"PARAMSEQ",1,3)

"KRN",8994,3118,2,"PARAMSEQ",2,2)

"KRN",8994,3118,3,0)
^8994.03^4^4^3140723^^
"KRN",8994,3118,3,1,0)
If the lock is successful, a return value of 1 is sent.
"KRN",8994,3118,3,2,0)
 
"KRN",8994,3118,3,3,0)
If the lock fails, the return value is a 0^ followed by text indicating 
"KRN",8994,3118,3,4,0)
why the lock failed.
"KRN",8994,3119,-1)
0^23
"KRN",8994,3119,0)
ORBCMA5 UNLOCK^UNLOCK^ORBCMA5^1
"KRN",8994,3120,-1)
0^24
"KRN",8994,3120,0)
ORBCMA5 JOB^JOB^ORBCMA5^1
"KRN",8994,3120,1,0)
^8994.01^8^8^3140723^^
"KRN",8994,3120,1,1,0)
Due to issues with LOCKing between the CPRS GUI chart and the 
"KRN",8994,3120,1,2,0)
BCMAOrderCom dll, some changes are necessary to how locks are handled 
"KRN",8994,3120,1,3,0)
when locking the patient chart.
"KRN",8994,3120,1,4,0)
 
"KRN",8994,3120,1,5,0)
In order to facility those changes, the CPRS GUI chart needs to know the 
"KRN",8994,3120,1,6,0)
$J value for the running process for the open connection on the M server.
"KRN",8994,3120,1,7,0)
 
"KRN",8994,3120,1,8,0)
The purpose of this RPC is to return that $J value.
"KRN",8994,3120,2,0)
^8994.02A
"KRN",8994,3120,3,0)
^8994.03^1^1^3140723^^^
"KRN",8994,3120,3,1,0)
Returns the $J value.
"KRN",8994,3121,-1)
0^21
"KRN",8994,3121,0)
ORWU OVERDL^OVERDL^ORWU^1
"KRN",8994,3126,-1)
0^29
"KRN",8994,3126,0)
ORUTL4 DLL^DLL^ORUTL4^1^R^0
"KRN",8994,3126,1,0)
^^2^2^3150408^
"KRN",8994,3126,1,1,0)
This RPC will check the version of the user's DLL against the current 
"KRN",8994,3126,1,2,0)
version defined on the server for compatibility.
"KRN",8994,3126,2,0)
^8994.02A^2^2
"KRN",8994,3126,2,1,0)
DLLNAME^1^^1
"KRN",8994,3126,2,1,1,0)
^^1^1^3150408^
"KRN",8994,3126,2,1,1,1,0)
This is the name of the DLL file to perform a compatability check on.
"KRN",8994,3126,2,2,0)
DLLVERSION^1^^1
"KRN",8994,3126,2,2,1,0)
^^1^1^3150408^
"KRN",8994,3126,2,2,1,1,0)
This is the version of the DLL on the user's machine.
"KRN",8994,3126,2,"B","DLLNAME",1)

"KRN",8994,3126,2,"B","DLLVERSION",2)

"KRN",8994,3126,3,0)
^^4^4^3150408^
"KRN",8994,3126,3,1,0)
If the version of the DLL on the user's machine is compatible with the 
"KRN",8994,3126,3,2,0)
version defined on the server, this RPC will return a 1. Otherwise the 
"KRN",8994,3126,3,3,0)
following string format is returned depending on the DLL: 
"KRN",8994,3126,3,4,0)
-1^<message string> or -1^<required server version>^<message string>.
"KRN",8994,3131,-1)
0^28
"KRN",8994,3131,0)
ORWU MOBAPP^MOBAPP^ORWU^1
"MBREQ")
0
"ORD",0,9.8)
9.8;;1;RTNF^XPDTA;RTNE^XPDTA
"ORD",0,9.8,0)
ROUTINE
"ORD",3,19.1)
19.1;3;;;KEY^XPDTA1;KEYF1^XPDIA1;KEYE1^XPDIA1;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PGL",101.24,0,13,.13)
RPC^P8994'^XWB(8994,^0;13^Q
"PGL",101.24,0,18,.18)
DETAIL REPORT^*P101.24'^ORD(101.24,^0;18^S DIC("S")="I $P(^(0),""^"",8)=""CD""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"PGL",101.24,0,21,.192)
REPORT COMPONENT^P142.1'^GMT(142.1,^0;21^Q
"PGL",101.41,0,5,5)
DISPLAY GROUP^P100.98'^ORD(100.98,^0;5^Q
"PGL",101.41,0,7,7)
PACKAGE^P9.4'^DIC(9.4,^0;7^Q
"PGL",101.412,0,2,2)
ITEM^P101.41'X^ORD(101.41,^0;2^D TREE^ORDD41
"PGL",101.412,0,11,1)
PARENT^P101.41'^ORD(101.41,^0;11^Q
"PGL",101.415,0,2,2)
ITEM^P101.41'^ORD(101.41,^0;2^Q
"PGL",101.416,0,2,.02)
DIALOG^P101.41'^ORD(101.41,^0;2^Q
"PKG",170,-1)
1^1
"PKG",170,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",170,20,0)
^9.402P^^
"PKG",170,22,0)
^9.49I^1^1
"PKG",170,22,1,0)
3.0^2971217^2980917^11712
"PKG",170,22,1,"PAH",1,0)
350^3151110^10000000186
"PKG",170,22,1,"PAH",1,1,0)
^^4^4^3141211
"PKG",170,22,1,"PAH",1,1,1,0)
This build contains the OE/RR items affected by the rename of EARLIEST 
"PKG",170,22,1,"PAH",1,1,2,0)
DATE (123;17) to CLINICALLY INDICATED DATE.
"PKG",170,22,1,"PAH",1,1,3,0)
This build should restore the M routines, order dialogs, and ORCDGMRC
"PKG",170,22,1,"PAH",1,1,4,0)
EARLIEST DATE DEFAULT parameter to a pre-OR*3.0*350 state.
"PRE")
ORY350E
"QUES","POS1",0)
FU^3:50
"QUES","POS1","A")
Select the report recipient:
"QUES","POS1","M")
D RECIP^ORY350E K DIR,DIRUT
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
69
"RTN","ORAREN")
0^14^B51653568
"RTN","ORAREN",1,0)
ORAREN ;SLC/JLC - PROCESS RENEWAL REQUEST ;10/27/2014  07:14
"RTN","ORAREN",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**336,349,350**;Dec 17, 1997;Build 77
"RTN","ORAREN",3,0)
 ;
"RTN","ORAREN",4,0)
 ;The purpose of this API is to process a request to renew an
"RTN","ORAREN",5,0)
 ;Outpatient Prescription
"RTN","ORAREN",6,0)
 ;
"RTN","ORAREN",7,0)
 ;  DBIA 2790 - ACTVSURO^XQALSURO
"RTN","ORAREN",8,0)
 ;  DBIA 2343 - ACTIVE^XUSER
"RTN","ORAREN",9,0)
 ;  DBIA 2848 - GETALL^SCAPMCA
"RTN","ORAREN",10,0)
 ;  DBIA 2263 - GET^XPAR
"RTN","ORAREN",11,0)
 ;
"RTN","ORAREN",12,0)
 Q
"RTN","ORAREN",13,0)
RENEW(ORRESULT,DFN,RX,PROVP,RENEWF) ;
"RTN","ORAREN",14,0)
 ;Input - DFN of the patient
"RTN","ORAREN",15,0)
 ;        RX to be renewed
"RTN","ORAREN",16,0)
 ;
"RTN","ORAREN",17,0)
 ; One assumption is made for now and that is that the TMP globals and the message counters are
"RTN","ORAREN",18,0)
 ; initialized by the calling routine. Not a perfect scenario, but in order to batch the mail
"RTN","ORAREN",19,0)
 ; messages that is what was done.
"RTN","ORAREN",20,0)
 ;*349 Added passing to build the message for variable safety. And mail reformat.
"RTN","ORAREN",21,0)
 N X,OK,ORY,ORPKG,ORITM,ORIFN,PSOSTAT,A,PDET,ORFLDS,DRUG,DISPLAY,FAIL,LIST,OCHKS,OCO,OCLIST,ORCPLX,ORINFO,ORPVSTS
"RTN","ORAREN",22,0)
 N ORL,ORPROV,PCP,PCPN,RNWFLDS,Y,ORUSR,NEWIFN,PNM,RXE,EMSG,INMSG,ORPROVNM ;*349
"RTN","ORAREN",23,0)
 K ^TMP("SC",$J) S RENEWF=$G(RENEWF)
"RTN","ORAREN",24,0)
 I $G(PROVP)="" S PROVP="A"
"RTN","ORAREN",25,0)
 S PNM=$P($G(^DPT(DFN,0)),U),ORUSR=$$GET^XPAR("SYS","OR AUTORENEWAL USER") I ORUSR="" D AE(.EMSG,RX,DFN,"No auto-renewal user defined") S ORRESULT=0 G END
"RTN","ORAREN",26,0)
 D EN^PSOORDER(DFN,RX)
"RTN","ORAREN",27,0)
 S DRUG=$P($G(^TMP("PSOR",$J,RX,"DRUG",0)),U,2)
"RTN","ORAREN",28,0)
 S:DRUG="" DRUG=$P($P($G(^TMP("PSOR",$J,RX,"DRUG",0)),U),";",2)
"RTN","ORAREN",29,0)
 S PSOSTAT=$P($P($G(^TMP("PSOR",$J,RX,0)),U,4),";") I PSOSTAT'="A",PSOSTAT'="E" D AE(.EMSG,RX,DFN,"RX Status Not Active or Expired") S ORRESULT=0 G END
"RTN","ORAREN",30,0)
 D LOCK^ORWDX(.OK,DFN) I 'OK D AE(.EMSG,RX,DFN,"Chart Lock Failed") S ORRESULT=0 G END
"RTN","ORAREN",31,0)
 S ORIFN=$P($G(^TMP("PSOR",$J,RX,1)),U,8) I ORIFN="" D AE(.EMSG,RX,DFN,"No CPRS Order Number") S ORRESULT=0 G UNLOCK
"RTN","ORAREN",32,0)
 I RENEWF="N" D  G UNLOCK
"RTN","ORAREN",33,0)
 .D AE(.EMSG,RX,DFN,"Drug not renewable")
"RTN","ORAREN",34,0)
 .D EN^ORB3(73,DFN,ORIFN,"","Non-Renewable RX Request for "_DRUG,"NEW;"_ORIFN)
"RTN","ORAREN",35,0)
 .S ORRESULT=0
"RTN","ORAREN",36,0)
 D LOCKORD^ORWDX(.OK,ORIFN) I 'OK D AE(.EMSG,RX,DFN,"Order Lock Failed") S ORRESULT=0 G UNLOCK
"RTN","ORAREN",37,0)
 S A=$G(^OR(100,ORIFN,0)) I A="" D AE(.EMSG,RX,DFN,"Order missing from ORDERS file") S ORRESULT=0 G UNO
"RTN","ORAREN",38,0)
 S ORPROV=+$P(A,U,4),ORL=+$P(A,U,10)
"RTN","ORAREN",39,0)
 ;*349 Add Provider name, check valid surogate
"RTN","ORAREN",40,0)
 S ORPROVNM=$$GET1^DIQ(200,ORPROV,.01,"E"),ORPVSTS=$$ACTIVE^XUSER(ORPROV)
"RTN","ORAREN",41,0)
 I ORPROVNM]"" S ORPROVNM="("_ORPROVNM_")"
"RTN","ORAREN",42,0)
 I '$G(ORPVSTS)&($$ACTVSURO^XQALSURO(ORPROV)<1) D AE(.EMSG,RX,DFN,"Provider "_ORPROVNM_$S(ORPVSTS="":" NOT FOUND",1:" flagged as "_$P(ORPVSTS,U,2))) S ORRESULT=0 G UNO
"RTN","ORAREN",43,0)
 S PCPN=$$GETALL^SCAPMCA(DFN),PCP=+$G(^TMP("SC",$J,DFN,"PCPR",1))
"RTN","ORAREN",44,0)
 I PROVP="P",ORPROV'=PCP D AE(.EMSG,RX,DFN,"Ordering Provider "_ORPROVNM_" not Primary Care") S ORRESULT=3 G UNO
"RTN","ORAREN",45,0)
 D ALLWORD^ORALWORD(.ORY,DFN,ORIFN,"E",ORPROV) I $G(ORY)>0 D AE(.EMSG,RX,DFN,"Clozapine Failed - details below",.ORY) S ORRESULT=0 G UNO
"RTN","ORAREN",46,0)
 D VALID^ORWDXA(.ORY,ORIFN,"RN",ORPROV)
"RTN","ORAREN",47,0)
 I $G(ORY)]"" D  G UNO
"RTN","ORAREN",48,0)
 .D AE(.EMSG,RX,DFN,"Invalid Action - details below",.ORY)
"RTN","ORAREN",49,0)
 .D:$$UP^XLFSTR(ORY)["NON-RENEWABLE" EN^ORB3(73,DFN,ORIFN,"","Non-Renewable RX Request for "_DRUG,"NEW;"_ORIFN)
"RTN","ORAREN",50,0)
 .S ORRESULT=0
"RTN","ORAREN",51,0)
 D GETPKG^ORWDXR(.ORPKG,ORIFN) I '$D(ORPKG) D AE(.EMSG,RX,DFN,"Invalid Order Number") S ORRESULT=0 G UNO
"RTN","ORAREN",52,0)
 I ORPKG'="PSO" D AE(.EMSG,RX,DFN,"Problem with package in ORDERS file") S ORRESULT=0 G UNO
"RTN","ORAREN",53,0)
 D GTORITM^ORWDXR(.ORITM,ORIFN)
"RTN","ORAREN",54,0)
 D FAILDEA^ORWDPS1(.FAIL,ORITM,ORPROV,"O") I FAIL D AE(.EMSG,RX,DFN,"Failed DEA Check") S ORRESULT=0 G UNO
"RTN","ORAREN",55,0)
 ;*349 Maintain AUDIO RENEWAL USER on pharmacy side.
"RTN","ORAREN",56,0)
 D RNWFLDS^ORWDXR(.RNWFLDS,ORIFN) S ORFLDS(1)=RNWFLDS(0),ORFLDS("ORDUZ")=ORUSR
"RTN","ORAREN",57,0)
 D CHKGRP^ORWDPS2(.DISPLAY,ORIFN) I DISPLAY'=2 D AE(.EMSG,RX,DFN,"Package Problem on Order") S ORRESULT=0 G UNO
"RTN","ORAREN",58,0)
 D ON^ORWDXC(.OCO)
"RTN","ORAREN",59,0)
 D DISPLAY^ORWDXC(.OCLIST,DFN,ORPKG) I $D(OCLIST) D INFO(.INMSG,RX,DFN,.OCLIST)
"RTN","ORAREN",60,0)
 D OXDATA^ORWDXR01(.ORINFO,ORIFN)
"RTN","ORAREN",61,0)
 S ORINFO(1)=ORINFO
"RTN","ORAREN",62,0)
 D ACCEPT^ORWDXC(.OCHKS,DFN,"PSO","",ORL,.ORINFO,ORIFN,1)
"RTN","ORAREN",63,0)
 I $D(OCHKS) D INFO(.INMSG,RX,DFN,.OCHKS)
"RTN","ORAREN",64,0)
 D ISCPLX^ORWDXR(.ORCPLX,ORIFN) S ORCPLX=+$G(ORCPLX)
"RTN","ORAREN",65,0)
 S (CNT,S1)=0 F  S S1=$O(OCHKS(S1)) Q:'S1  S CNT=CNT+1,ORFLDS("ORCHECK",$P(OCHKS(S1),U),$P(OCHKS(S1),U,3),CNT)=$P(OCHKS(S1),U,2,99)
"RTN","ORAREN",66,0)
 I CNT>0 S ORFLDS("ORCHECK")=CNT
"RTN","ORAREN",67,0)
 D RENEW^ORWDXR(.LIST,ORIFN,DFN,ORPROV,ORL,.ORFLDS,ORCPLX,0) S ORRESULT=1
"RTN","ORAREN",68,0)
 S NEWIFN=$P(^OR(100,ORIFN,3),U,6)
"RTN","ORAREN",69,0)
 S $P(^OR(100,NEWIFN,8,1,0),U,13)=ORUSR
"RTN","ORAREN",70,0)
 D UNSIGNED(NEWIFN)
"RTN","ORAREN",71,0)
 D KILUNSNO^ORWORB(.Y,DFN)
"RTN","ORAREN",72,0)
 D KILEXMED^ORWORB(.Y,DFN)
"RTN","ORAREN",73,0)
UNO D UNLKORD^ORWDX(.OK,ORIFN)
"RTN","ORAREN",74,0)
UNLOCK D UNLOCK^ORWDX(.OK,DFN)
"RTN","ORAREN",75,0)
 ;
"RTN","ORAREN",76,0)
END ;*249 Modify END.
"RTN","ORAREN",77,0)
 ;Merge Message Arrays into ^TMP( for VEXRX, add header if needed.
"RTN","ORAREN",78,0)
 N I,J,RXELN,DRGLN,DSPNMLN,SPACE
"RTN","ORAREN",79,0)
 S SPACE=$J(" ",40)
"RTN","ORAREN",80,0)
 S RXELN=$$GET1^DID(52,.01,"","FIELD LENGTH"),DRGLN=$$GET1^DID(52,6,"","FIELD LENGTH"),DSPNMLN=$$GET1^DID(2,.01,"","FIELD LENGTH")
"RTN","ORAREN",81,0)
 I $D(EMSG) D
"RTN","ORAREN",82,0)
 . S J=$O(^TMP($J,"ORAREN E",""),-1)+1
"RTN","ORAREN",83,0)
 . I J<2 D
"RTN","ORAREN",84,0)
 . . S ^TMP($J,"ORAREN E",J,0)="Renewal Requests Not Sent to Provider",J=J+1
"RTN","ORAREN",85,0)
 . . S ^TMP($J,"ORAREN E",J,0)=" ",J=J+1
"RTN","ORAREN",86,0)
 . . S ^TMP($J,"ORAREN E",J,0)=$E("PATIENT"_SPACE,0,DSPNMLN)_" "_$E("RX#"_SPACE,0,RXELN)_" "_$E("DRUG"_SPACE,0,DRGLN),J=J+1
"RTN","ORAREN",87,0)
 . . S ^TMP($J,"ORAREN E",J,0)="    PROBLEM",J=J+1
"RTN","ORAREN",88,0)
 . . S ^TMP($J,"ORAREN E",J,0)="==============================================================================",J=J+1
"RTN","ORAREN",89,0)
 . . S ^TMP($J,"ORAREN E",J,0)=" ",J=J+1
"RTN","ORAREN",90,0)
 . F I=0:0 S I=$O(EMSG(I)) Q:'I  S ^TMP($J,"ORAREN E",J,0)=EMSG(I),J=J+1
"RTN","ORAREN",91,0)
 I $D(INMSG) D
"RTN","ORAREN",92,0)
 . S J=$O(^TMP($J,"ORAREN OC",""),-1)+1
"RTN","ORAREN",93,0)
 . I J<2 D
"RTN","ORAREN",94,0)
 . . S ^TMP($J,"ORAREN OC",J,0)="Renewal Requests with Order Checks",J=J+1
"RTN","ORAREN",95,0)
 . . S ^TMP($J,"ORAREN OC",J,0)=" ",J=J+1
"RTN","ORAREN",96,0)
 . . S ^TMP($J,"ORAREN OC",J,0)=$E("PATIENT"_SPACE,0,DSPNMLN)_" "_$E("RX#"_SPACE,0,RXELN)_" "_$E("DRUG"_SPACE,0,DRGLN),J=J+1
"RTN","ORAREN",97,0)
 . . S ^TMP($J,"ORAREN OC",J,0)="==============================================================================",J=J+1
"RTN","ORAREN",98,0)
 . . S ^TMP($J,"ORAREN OC",J,0)=" ",J=J+1
"RTN","ORAREN",99,0)
 . F I=0:0 S I=$O(INMSG(I)) Q:'I  S ^TMP($J,"ORAREN OC",J,0)=INMSG(I),J=J+1
"RTN","ORAREN",100,0)
 Q
"RTN","ORAREN",101,0)
 ;
"RTN","ORAREN",102,0)
AE(MSARY,RX,DFN,TEXT,PDET) ;*349
"RTN","ORAREN",103,0)
 ;Input:  MSARY - Output aray
"RTN","ORAREN",104,0)
 ;        RX    - Internal RX#
"RTN","ORAREN",105,0)
 ;        DFN   - Internal Patient DFN
"RTN","ORAREN",106,0)
 ;Output: MSARY will be appended with a line pertaining to the input.
"RTN","ORAREN",107,0)
 ;
"RTN","ORAREN",108,0)
 N I,S1,SPACE,CNT,RXE,DRG,PNM,SSN,SSID,SPACE S SPACE=$J(" ",40),CNT=1
"RTN","ORAREN",109,0)
 N RXELN,DRGLN,DSPNMLN
"RTN","ORAREN",110,0)
 S RXE=$$GET1^DIQ(52,RX,.01,"E"),DRG=$$GET1^DIQ(52,RX,6,"E"),PNM=$$GET1^DIQ(2,DFN,.01,"E"),SSN=+$$GET1^DIQ(2,DFN,.09,"E")
"RTN","ORAREN",111,0)
 S RXELN=$$GET1^DID(52,.01,"","FIELD LENGTH"),DRGLN=$$GET1^DID(52,6,"","FIELD LENGTH"),DSPNMLN=$$GET1^DID(2,.01,"","FIELD LENGTH")
"RTN","ORAREN",112,0)
 S SSID="("_$E(PNM,1)_$E(SSN,$L(SSN)-3,$L(SSN))_")"
"RTN","ORAREN",113,0)
 S DSPNM=$E(PNM,1,DSPNMLN-$L(" "_SSID))_" "_SSID  ;Have to truncate Patient name if it is too long.
"RTN","ORAREN",114,0)
 F I="DSPNM","RXE","DRG" S MSARY(CNT)=$G(MSARY(CNT))_$E(@I_SPACE,1,@(I_"LN"))_" "
"RTN","ORAREN",115,0)
 S CNT=CNT+1
"RTN","ORAREN",116,0)
 S MSARY(CNT)=$E(SPACE,0,4)_TEXT,CNT=CNT+1
"RTN","ORAREN",117,0)
 I $D(PDET),$O(PDET(0))="" S MSARY(CNT)=$E(SPACE,0,4)_PDET,CNT=CNT+1 Q
"RTN","ORAREN",118,0)
 I $D(PDET) S S1=0 F  S S1=$O(PDET(S1)) Q:'S1  S MSARY(CNT)=$E(SPACE,0,4)_PDET(S1),CNT=CNT+1
"RTN","ORAREN",119,0)
 Q
"RTN","ORAREN",120,0)
 ;
"RTN","ORAREN",121,0)
INFO(INARY,RX,DFN,MSG)     ;file informational items in mail message ;*349
"RTN","ORAREN",122,0)
 ;Input:  INARY - Output aray
"RTN","ORAREN",123,0)
 ;        RX    - Internal RX#
"RTN","ORAREN",124,0)
 ;        DFN   - Internal Patient DFN
"RTN","ORAREN",125,0)
 ;        MSG   - Message Array
"RTN","ORAREN",126,0)
 ;Output: INARY will be appended with a line pertaining to the input.
"RTN","ORAREN",127,0)
 ;
"RTN","ORAREN",128,0)
 N I,SPACE,CNT,RXE,DRG,PNM,SSN,SSID,DSPNM,SPACE,S1 S SPACE=$J(" ",40),CNT=1
"RTN","ORAREN",129,0)
 N RXELN,DRGLN,DSPNMLN
"RTN","ORAREN",130,0)
 I $D(INARY) S CNT=$O(INARY(""),-1)
"RTN","ORAREN",131,0)
 I '$D(INARY) D
"RTN","ORAREN",132,0)
 . S RXE=$$GET1^DIQ(52,RX,.01,"E"),DRG=$$GET1^DIQ(52,RX,6,"E"),PNM=$$GET1^DIQ(2,DFN,.01,"E"),SSN=+$$GET1^DIQ(2,DFN,.09,"E")
"RTN","ORAREN",133,0)
 . S RXELN=$$GET1^DID(52,.01,"","FIELD LENGTH"),DRGLN=$$GET1^DID(52,6,"","FIELD LENGTH"),DSPNMLN=$$GET1^DID(2,.01,"","FIELD LENGTH")
"RTN","ORAREN",134,0)
 . S SSID="("_$E(PNM,1)_$E(SSN,$L(SSN)-3,$L(SSN))_")"
"RTN","ORAREN",135,0)
 . S DSPNM=$E(PNM,1,DSPNMLN-$L(" "_SSID))_" "_SSID  ;Have to truncate Patient name if it is too long.
"RTN","ORAREN",136,0)
 . F I="DSPNM","RXE","DRG" S INARY(CNT)=$G(INARY(CNT))_$E(@I_SPACE,0,@(I_"LN"))_" "
"RTN","ORAREN",137,0)
 S CNT=CNT+1,INARY(CNT)=" ",CNT=CNT+1,S1=0
"RTN","ORAREN",138,0)
 F  S S1=$O(MSG(S1)) Q:'S1  D  S INARY(CNT)=" ",CNT=CNT+1
"RTN","ORAREN",139,0)
 . I $L(MSG(S1),U)>2 S INARY(CNT)=$P(MSG(S1),U,4,99),CNT=CNT+1 Q
"RTN","ORAREN",140,0)
 . S INARY(CNT)=$E(SPACE,0,5)_MSG(S1),CNT=CNT+1
"RTN","ORAREN",141,0)
 Q
"RTN","ORAREN",142,0)
UNSIGNED(UIFN) ;queue unsigned order alert
"RTN","ORAREN",143,0)
 N ORVP,ORIFN,ORNP,A
"RTN","ORAREN",144,0)
 Q:$G(UIFN)=""  S A=$G(^OR(100,UIFN,0)),ORVP=$P(A,U,2),ORNP=$P(A,U,4),ORIFN=UIFN_";1"
"RTN","ORAREN",145,0)
 D NOTIF^ORCSIGN
"RTN","ORAREN",146,0)
 Q
"RTN","ORB3")
0^33^B140213780
"RTN","ORB3",1,0)
ORB3 ;SLC/CLA,WAT,TC - MAIN ROUTINE FOR OE/RR 3 NOTIFICATIONS ;04/28/2015  08:16
"RTN","ORB3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**31,74,91,105,139,190,220,253,265,296,348,350**;Dec 17, 1997;Build 77
"RTN","ORB3",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","ORB3",4,0)
 ;
"RTN","ORB3",5,0)
 ;This routine invokes to following ICR(s):
"RTN","ORB3",6,0)
 ;ICR 4156     ;REGISTRATION, COMBAT VETERAN STATUS
"RTN","ORB3",7,0)
 ;ICR 5697     ;SCHEDULING, PCMM MHTC API's
"RTN","ORB3",8,0)
 ;
"RTN","ORB3",9,0)
EN(ORN,ORBDFN,ORNUM,ORBADUZ,ORBPMSG,ORBPDATA) ;
"RTN","ORB3",10,0)
 ;
"RTN","ORB3",11,0)
 N ORBENT
"RTN","ORB3",12,0)
 S ORBENT=$$ENTITY^ORB31(ORNUM)
"RTN","ORB3",13,0)
 ;
"RTN","ORB3",14,0)
 Q:$$GET^XPAR(ORBENT,"ORB SYSTEM ENABLE/DISABLE",1,"I")="D"
"RTN","ORB3",15,0)
 Q:'$L($G(^ORD(100.9,ORN,0)))
"RTN","ORB3",16,0)
 Q:+$$ONOFF^ORB3FN(ORN)=0
"RTN","ORB3",17,0)
 ;
"RTN","ORB3",18,0)
 S ORBPMSG=$E($G(ORBPMSG),1,51)
"RTN","ORB3",19,0)
 ;
"RTN","ORB3",20,0)
 ;if msg from notif file or oc notif (#54), quit if dup w/in past 1 min:
"RTN","ORB3",21,0)
 N ORBDUP,ORBN
"RTN","ORB3",22,0)
 S ORBN=^ORD(100.9,ORN,0)
"RTN","ORB3",23,0)
 I ($P(ORBN,"^",4)="NOT")!(ORN=54) D
"RTN","ORB3",24,0)
 .S ORBDUP=$$DUP^ORB31(ORN,ORBDFN,ORBPMSG,ORNUM)
"RTN","ORB3",25,0)
 Q:+$G(ORBDUP)=1
"RTN","ORB3",26,0)
 ;
"RTN","ORB3",27,0)
 N ORBDESC
"RTN","ORB3",28,0)
 S ORBDESC=" Send Alert Notification ("_(+ORN)_") "_$P($G(^ORD(100.9,+ORN,0)),U,1)_"  "
"RTN","ORB3",29,0)
 ;
"RTN","ORB3",30,0)
 D QUEUE^ORB31(ORN,ORBDFN,$G(ORNUM),.ORBADUZ,$G(ORBPMSG),$G(ORBPDATA),$H,ORBDESC,$G(DGPMA))
"RTN","ORB3",31,0)
 Q
"RTN","ORB3",32,0)
ZTSK ;
"RTN","ORB3",33,0)
 D START
"RTN","ORB3",34,0)
 S ZTREQ="@"
"RTN","ORB3",35,0)
 Q
"RTN","ORB3",36,0)
UTL(ORBU,ORN,ORBDFN,ORNUM,ORBADUZ,ORBPMSG,ORBPDATA) ;
"RTN","ORB3",37,0)
 Q:$G(ORBU)'=1
"RTN","ORB3",38,0)
START Q:$G(ORN)=""!($G(ORBDFN)="")
"RTN","ORB3",39,0)
 Q:'$L($G(^ORD(100.9,ORN,0)))
"RTN","ORB3",40,0)
 N ORBNOW,ORBID,ORBLOCK,ORBDESC
"RTN","ORB3",41,0)
 S ORBNOW=$$NOW^XLFDT
"RTN","ORB3",42,0)
 S ORBLOCK=0
"RTN","ORB3",43,0)
 ;
"RTN","ORB3",44,0)
 ;lock to prevent concurrent processing by other resource slots:
"RTN","ORB3",45,0)
 I '$D(ORBU) D
"RTN","ORB3",46,0)
 .S ^XTMP("ORBLOCK",0)=$$FMADD^XLFDT(ORBNOW,1,"","","")_"^"_ORBNOW
"RTN","ORB3",47,0)
 .S ORBID=$P($P($G(ORBPDATA),"|",2),"@")  ;get unique data id
"RTN","ORB3",48,0)
 .I $L(ORBID) D
"RTN","ORB3",49,0)
 ..LOCK +^XTMP("ORBLOCK",ORBDFN,ORN,ORBID):60 E  D  Q
"RTN","ORB3",50,0)
 ...S ORBDESC=" Requeue Alert Notification ("_(+ORN)_") "_$P($G(^ORD(100.9,+ORN,0)),U,1)_"  "
"RTN","ORB3",51,0)
 ...D QUEUE^ORB31(ORN,ORBDFN,$G(ORNUM),.ORBADUZ,$G(ORBPMSG),$G(ORBPDATA),$$HADD^XLFDT($H,"","",5,""),ORBDESC,$G(DGPMA)) ;requeue in 5 min.
"RTN","ORB3",52,0)
 ...S ORBLOCK=1
"RTN","ORB3",53,0)
 .;
"RTN","ORB3",54,0)
 .I '$L(ORBID) D
"RTN","ORB3",55,0)
 ..LOCK +^XTMP("ORBLOCK",ORBDFN,ORN):60 E  D  Q
"RTN","ORB3",56,0)
 ...S ORBDESC=" Requeue Alert Notification ("_(+ORN)_") "_$P($G(^ORD(100.9,+ORN,0)),U,1)_"  "
"RTN","ORB3",57,0)
 ...D QUEUE^ORB31(ORN,ORBDFN,$G(ORNUM),.ORBADUZ,$G(ORBPMSG),$G(ORBPDATA),$$HADD^XLFDT($H,"","",5,""),ORBDESC,$G(DGPMA)) ;requeue in 5 min.
"RTN","ORB3",58,0)
 ...S ORBLOCK=1
"RTN","ORB3",59,0)
 .;
"RTN","ORB3",60,0)
 I ORBLOCK=1 D QUIT Q
"RTN","ORB3",61,0)
 ;
"RTN","ORB3",62,0)
DOALERT ; Entry point for alert logic outside of TaskMan
"RTN","ORB3",63,0)
 N ORBDUZ,ORBN,ORBXQAID,ORPTNAM,ORBPRIM,ORBATTD,ORBDEV,ORBENT
"RTN","ORB3",64,0)
 N ORBUI,ORBASPEC,ORBSMSG,ORBADT,ORBSDEV,ORBDEL,ORBDI,ORBTDEV,ORY
"RTN","ORB3",65,0)
 N ORBIDX,ORBFLAGS
"RTN","ORB3",66,0)
 S ORBUI=1,ORBADT=0
"RTN","ORB3",67,0)
 S:'$L($G(ORBPMSG)) ORBPMSG=""
"RTN","ORB3",68,0)
 I '$L(ORBPDATA),(+$G(ORNUM)>0) S ORBPDATA=+$G(ORNUM)_"@"
"RTN","ORB3",69,0)
 S ORBN=^ORD(100.9,ORN,0)
"RTN","ORB3",70,0)
 S ORBIDX=0 F  S ORBIDX=$O(^ORD(100.9,ORN,5,ORBIDX)) Q:'ORBIDX  D
"RTN","ORB3",71,0)
 .S ORBFLAGS=$P($G(^ORD(100.9,ORN,5,ORBIDX,0)),U)
"RTN","ORB3",72,0)
 .S:ORBFLAGS'="" ORBFLAGS(ORBFLAGS)="",ORBFLAGS=""
"RTN","ORB3",73,0)
 ;
"RTN","ORB3",74,0)
 S ORBENT=$$ENTITY^ORB31(ORNUM)
"RTN","ORB3",75,0)
 ;
"RTN","ORB3",76,0)
 N DFN S DFN=ORBDFN,VA200="" D OERR^VADPT
"RTN","ORB3",77,0)
 I ('$L($G(VA("BID"))))!('$L($G(VADM(1)))) D QUIT Q
"RTN","ORB3",78,0)
 I (ORN=18)!(ORN=20)!(ORN=35) S ORBADT=1 ;A/D/T notif
"RTN","ORB3",79,0)
 ;if not an A/D/T notif, get primary & attending from OERR^VADPT:
"RTN","ORB3",80,0)
 I ORBADT=0 S ORBPRIM=+$P(VAIN(2),U),ORBATTD=+$P(VAIN(11),U)
"RTN","ORB3",81,0)
 I ORBADT=1 D ADT^ORB31(ORN,ORBDFN,.ORBPRIM,.ORBATTD,$G(ORDGPMA)) ;A/D/T notif
"RTN","ORB3",82,0)
 I $D(ORBU) D  ;create debug msg
"RTN","ORB3",83,0)
 .S ORBU(ORBUI)="Processing notification: "_$P(ORBN,U),ORBUI=ORBUI+1
"RTN","ORB3",84,0)
 .S ORBU(ORBUI)="            for patient: "_VADM(1),ORBUI=ORBUI+1
"RTN","ORB3",85,0)
 .I $G(ORNUM)>0 S ORBU(ORBUI)="              for order: "_ORNUM,ORBUI=ORBUI+1
"RTN","ORB3",86,0)
 D REGULAR^ORB3REG(ORN,.XQA,.ORBU,.ORBUI,.ORBDEV,ORBDFN)
"RTN","ORB3",87,0)
 D SPECIAL^ORB3SPEC(ORN,.ORBASPEC,.ORBU,.ORBUI,$G(ORNUM),ORBDFN,$G(ORBPDATA),.ORBSMSG,$G(ORBPMSG),.ORBSDEV,$G(ORBPRIM),$G(ORBATTD))
"RTN","ORB3",88,0)
 I $L($G(ORBSMSG)) S ORBPMSG=$E(ORBSMSG,1,51)
"RTN","ORB3",89,0)
 I $D(ORBASPEC)>1 D SPECDUZS ;special recips
"RTN","ORB3",90,0)
 I $D(ORBADUZ)>1 D PKGDUZS ;pkg-supplied recips
"RTN","ORB3",91,0)
 D TITLE ;provider recips
"RTN","ORB3",92,0)
 S ORBXQAID=$P(ORBN,"^",2)_","_ORBDFN_","_ORN
"RTN","ORB3",93,0)
 ;
"RTN","ORB3",94,0)
 I ($D(XQA)>1)!($D(ORBDEV)>1)!($D(ORBSDEV)>1) D  ;recips found
"RTN","ORB3",95,0)
 .S XQAFLG=$P(ORBN,"^",5)
"RTN","ORB3",96,0)
 .S XQADFN=ORBDFN
"RTN","ORB3",97,0)
 .I XQAFLG="R" S XQAROU=$P(ORBN,"^",6)_"^"_$P(ORBN,"^",7)
"RTN","ORB3",98,0)
 .I $G(ORBPDATA)'="" S XQADATA=ORBPDATA
"RTN","ORB3",99,0)
 .S ORPTNAM=$E(VADM(1)_"         ",1,9)
"RTN","ORB3",100,0)
 .I $G(ORN)=27 N CVMRKR,RSLT S RSLT=$$CVEDT^DGCV(DFN) I $P($G(RSLT),U)&($P($G(RSLT),U,3)) S CVMRKR=" CV "_$$FMTE^XLFDT($P($G(RSLT),U,2),"5DZ") ;WAT
"RTN","ORB3",101,0)
 .S XQAMSG=ORPTNAM_" "_"("_$E(ORPTNAM)_$E(VA("BID"),1,4)_")"_$G(CVMRKR)_": " ;WAT
"RTN","ORB3",102,0)
 .S XQAMSG=XQAMSG_$S(ORBPMSG'="":ORBPMSG,1:$P(ORBN,"^",3))
"RTN","ORB3",103,0)
 .S XQAARCH=$$GET^XPAR(ORBENT,"ORB ARCHIVE PERIOD",ORN,"I")
"RTN","ORB3",104,0)
 .S XQASUPV=$$GET^XPAR(ORBENT,"ORB FORWARD SUPERVISOR",ORN,"I")
"RTN","ORB3",105,0)
 .S XQASURO=$$GET^XPAR(ORBENT,"ORB FORWARD SURROGATES",ORN,"I")
"RTN","ORB3",106,0)
 .S XQAREVUE=$$GET^XPAR(ORBENT,"ORB FORWARD BACKUP REVIEWER",ORN,"I")
"RTN","ORB3",107,0)
 .S XQACNDEL=$$GET^XPAR(ORBENT,"ORB REMOVE",ORN,"I")
"RTN","ORB3",108,0)
 .S XQACNDEL=$S(XQACNDEL=1:1,1:"")
"RTN","ORB3",109,0)
 .I $D(ORBDEV)>1 D REGDEV^ORB31(.ORBDEV)
"RTN","ORB3",110,0)
 .I $D(ORBSDEV)>1 D REGDEV^ORB31(.ORBSDEV)
"RTN","ORB3",111,0)
 .I $D(ORBTDEV)>1 D REGDEV^ORB31(.ORBTDEV)
"RTN","ORB3",112,0)
 .S XQAID=ORBXQAID
"RTN","ORB3",113,0)
 .I $D(ORBFLAGS("ONPP")) D COMDUP
"RTN","ORB3",114,0)
 .I $D(XQA) D SETUP^XQALERT  ;if no [new] recips don't send alert
"RTN","ORB3",115,0)
QUIT ;
"RTN","ORB3",116,0)
 K VA,VA200,VADM,VAERR,VAIN,XQA,XQADATA,XQAID,XQAFLG,XQAMSG,XQAROU,XQAARCH,XQASUPV,XQASURO,XQADFN,XQACNDEL,XQAREVUE
"RTN","ORB3",117,0)
 K ^XTMP("ORBUSER",$J)
"RTN","ORB3",118,0)
 I '$D(ORBU),$D(ORBLOCK) D
"RTN","ORB3",119,0)
 .I $G(ORBID)]"" LOCK -^XTMP("ORBLOCK",ORBDFN,ORN,ORBID)
"RTN","ORB3",120,0)
 .E  LOCK -^XTMP("ORBLOCK",ORBDFN,ORN)
"RTN","ORB3",121,0)
 Q
"RTN","ORB3",122,0)
PKGDUZS ;get DUZs from pkg-passed ORBADUZ() array
"RTN","ORB3",123,0)
 N ORBPDUZ
"RTN","ORB3",124,0)
 I $D(ORBU) D
"RTN","ORB3",125,0)
 .S ORBU(ORBUI)=" ",ORBUI=ORBUI+1
"RTN","ORB3",126,0)
 .I ORN=68 S ORBU(ORBUI)="Recipients with Lab Threshold Exceeded:",ORBUI=ORBUI+1
"RTN","ORB3",127,0)
 .E  S ORBU(ORBUI)="Recipients defined when notif was triggered:",ORBUI=ORBUI+1
"RTN","ORB3",128,0)
 S ORBPDUZ=""
"RTN","ORB3",129,0)
 F  S ORBPDUZ=$O(ORBADUZ(ORBPDUZ)) Q:ORBPDUZ=""  S ORBDUZ=ORBPDUZ D USER
"RTN","ORB3",130,0)
 Q
"RTN","ORB3",131,0)
SPECDUZS ;get DUZs rtn by SPECIAL^ORB3SPEC
"RTN","ORB3",132,0)
 N ORBSDUZ
"RTN","ORB3",133,0)
 I $D(ORBU) D
"RTN","ORB3",134,0)
 .S ORBU(ORBUI)=" ",ORBUI=ORBUI+1
"RTN","ORB3",135,0)
 .S ORBU(ORBUI)="Special recipients associated with the notification:",ORBUI=ORBUI+1
"RTN","ORB3",136,0)
 S ORBSDUZ=""
"RTN","ORB3",137,0)
 F  S ORBSDUZ=$O(ORBASPEC(ORBSDUZ)) Q:ORBSDUZ=""  S ORBDUZ=ORBSDUZ D USER
"RTN","ORB3",138,0)
 Q
"RTN","ORB3",139,0)
TITLE ;get provider recips
"RTN","ORB3",140,0)
 N TITLES
"RTN","ORB3",141,0)
 I $D(ORBU) D
"RTN","ORB3",142,0)
 .S ORBU(ORBUI)=" ",ORBUI=ORBUI+1
"RTN","ORB3",143,0)
 .S ORBU(ORBUI)="Recipients determined by Provider Recipient parameter:",ORBUI=ORBUI+1
"RTN","ORB3",144,0)
 ;
"RTN","ORB3",145,0)
 S TITLES=$$GET^XPAR(ORBENT,"ORB PROVIDER RECIPIENTS",ORN,"I")
"RTN","ORB3",146,0)
 I TITLES["P" D PRIMARY
"RTN","ORB3",147,0)
 I TITLES["A" D ATTEND
"RTN","ORB3",148,0)
 I TITLES["T" D TEAMS
"RTN","ORB3",149,0)
 I TITLES["O" D ORDERER
"RTN","ORB3",150,0)
 I TITLES["E" D ENTERBY
"RTN","ORB3",151,0)
 I TITLES["R" D PCMMPRIM
"RTN","ORB3",152,0)
 I TITLES["S" D PCMMASSC
"RTN","ORB3",153,0)
 I TITLES["M" D PCMMTEAM
"RTN","ORB3",154,0)
 I TITLES["C" D PCMMMHTC
"RTN","ORB3",155,0)
 Q
"RTN","ORB3",156,0)
PRIMARY ;
"RTN","ORB3",157,0)
 I $D(ORBU),ORBADT=0 S ORBU(ORBUI)=" Inpt primary provider:",ORBUI=ORBUI+1
"RTN","ORB3",158,0)
 I $D(ORBU),ORBADT=1 S ORBU(ORBUI)=" Inpt primary provider: option cannot determine without A/D/T event data.",ORBUI=ORBUI+1
"RTN","ORB3",159,0)
 I +$G(ORBPRIM)>0 S ORBDUZ=ORBPRIM D USER
"RTN","ORB3",160,0)
 Q
"RTN","ORB3",161,0)
ATTEND ;
"RTN","ORB3",162,0)
 I $D(ORBU),ORBADT=0 S ORBU(ORBUI)=" Attending physician:",ORBUI=ORBUI+1
"RTN","ORB3",163,0)
 I $D(ORBU),ORBADT=1 S ORBU(ORBUI)=" Attending physician: option cannot determine without A/D/T event data.",ORBUI=ORBUI+1
"RTN","ORB3",164,0)
 I +$G(ORBATTD)>0 S ORBDUZ=ORBATTD D USER
"RTN","ORB3",165,0)
 Q
"RTN","ORB3",166,0)
TEAMS ;
"RTN","ORB3",167,0)
 I $D(ORBU) S ORBU(ORBUI)=" Teams/Personal Lists related to patient:",ORBUI=ORBUI+1
"RTN","ORB3",168,0)
 N ORBLST,ORBI,ORBJ,ORBTM,ORBTNAME,ORBTTYPE,ORBTD
"RTN","ORB3",169,0)
 D TMSPT^ORQPTQ1(.ORBLST,ORBDFN)
"RTN","ORB3",170,0)
 Q:+$G(ORBLST(1))<1
"RTN","ORB3",171,0)
 S ORBI="" F  S ORBI=$O(ORBLST(ORBI)) Q:ORBI=""  D
"RTN","ORB3",172,0)
 .S ORBTM=$P(ORBLST(ORBI),U),ORBTNAME=$P(ORBLST(ORBI),U,2)
"RTN","ORB3",173,0)
 .S ORBTTYPE=$P(ORBLST(ORBI),U,3)
"RTN","ORB3",174,0)
 .I $D(ORBU) D
"RTN","ORB3",175,0)
 ..S ORBU(ORBUI)="  Patient list "_ORBTNAME_" ["_ORBTTYPE_"]:",ORBUI=ORBUI+1
"RTN","ORB3",176,0)
 .N ORBLST2 D TEAMPROV^ORQPTQ1(.ORBLST2,ORBTM)
"RTN","ORB3",177,0)
 .Q:+$G(ORBLST2(1))<1
"RTN","ORB3",178,0)
 .S ORBJ="" F  S ORBJ=$O(ORBLST2(ORBJ)) Q:ORBJ=""  D
"RTN","ORB3",179,0)
 ..S ORBDUZ=$P(ORBLST2(ORBJ),U)_U_ORBTM I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",180,0)
 .;
"RTN","ORB3",181,0)
 .S ORBTD=$P($$TMDEV^ORB31(ORBTM),U,2)  ;Team's device
"RTN","ORB3",182,0)
 .I $L(ORBTD) D
"RTN","ORB3",183,0)
 ..S ORBTDEV(ORBTD)=""
"RTN","ORB3",184,0)
 ..I $D(ORBU) D
"RTN","ORB3",185,0)
 ...S ORBU(ORBUI)="   Team's Device "_ORBTD_" is a recipient",ORBUI=ORBUI+1
"RTN","ORB3",186,0)
 Q
"RTN","ORB3",187,0)
ORDERER ;
"RTN","ORB3",188,0)
 Q:+$G(ORNUM)<1
"RTN","ORB3",189,0)
 I $D(ORBU) S ORBU(ORBUI)=" Ordering provider:",ORBUI=ORBUI+1
"RTN","ORB3",190,0)
 N ORBLST,ORBI,ORBTM,ORBJ,ORBTNAME,ORBPLST,ORBPI,ORBPTM,ORBTTYPE
"RTN","ORB3",191,0)
 S ORBDUZ=$S(ORN=12:+$$UNSIGNOR^ORQOR2(ORNUM),1:$$ORDERER^ORQOR2(ORNUM))
"RTN","ORB3",192,0)
 I +$G(ORBDUZ)>0 D
"RTN","ORB3",193,0)
 .D USER
"RTN","ORB3",194,0)
 .;if notif = Order Req E/S (#12) or Order Req Co-sign (#37) and
"RTN","ORB3",195,0)
 .;user doesn't have ES authority, send to fellow team members w/ES:
"RTN","ORB3",196,0)
 .I ((ORN=12)!(ORN=37)),('$D(^XUSEC("ORES",ORBDUZ))) D
"RTN","ORB3",197,0)
 ..I $D(ORBU) S ORBU(ORBUI)=" Orderer can't elec sign, getting teams orderer belongs to:",ORBUI=ORBUI+1
"RTN","ORB3",198,0)
 ..D TEAMPR^ORQPTQ1(.ORBLST,ORBDUZ)  ;get orderer's tms
"RTN","ORB3",199,0)
 ..Q:+$G(ORBLST(1))<1
"RTN","ORB3",200,0)
 ..D TMSPT^ORQPTQ1(.ORBPLST,ORBDFN)  ;get pt's tms
"RTN","ORB3",201,0)
 ..Q:+$G(ORBPLST(1))<1
"RTN","ORB3",202,0)
 ..S ORBI="" F  S ORBI=$O(ORBLST(ORBI)) Q:ORBI=""  D
"RTN","ORB3",203,0)
 ...S ORBPI="" F  S ORBPI=$O(ORBPLST(ORBPI)) Q:ORBPI=""  D
"RTN","ORB3",204,0)
 ....S ORBTM=$P(ORBLST(ORBI),U),ORBPTM=$P(ORBPLST(ORBPI),U)
"RTN","ORB3",205,0)
 ....I ORBTM=ORBPTM D  ;if pt is on provider's team
"RTN","ORB3",206,0)
 .....I +$G(ORBPTM)>0 D
"RTN","ORB3",207,0)
 ......S ORBTNAME=$P(ORBPLST(ORBPI),U,2)
"RTN","ORB3",208,0)
 ......S ORBTTYPE=$P(ORBPLST(ORBPI),U,3)
"RTN","ORB3",209,0)
 ......I $D(ORBU) S ORBU(ORBUI)="  Orderer's pt list "_ORBTNAME_" ["_ORBTTYPE_"] recipients: ",ORBUI=ORBUI+1
"RTN","ORB3",210,0)
 ......N ORBLST2 D TEAMPROV^ORQPTQ1(.ORBLST2,ORBPTM)
"RTN","ORB3",211,0)
 ......Q:+$G(ORBLST2(1))<1
"RTN","ORB3",212,0)
 ......S ORBJ="" F  S ORBJ=$O(ORBLST2(ORBJ)) Q:ORBJ=""  D
"RTN","ORB3",213,0)
 .......S ORBDUZ=$P(ORBLST2(ORBJ),U)_U_ORBPTM I +$G(ORBDUZ)>0,($D(^XUSEC("ORES",+ORBDUZ))) D USER
"RTN","ORB3",214,0)
 Q
"RTN","ORB3",215,0)
ENTERBY ;
"RTN","ORB3",216,0)
 I $D(ORBU) S ORBU(ORBUI)=" User entering order's most recent activity:",ORBUI=ORBUI+1
"RTN","ORB3",217,0)
 Q:+$G(ORNUM)<1
"RTN","ORB3",218,0)
 I $D(^OR(100,ORNUM,8,0)) D
"RTN","ORB3",219,0)
 .S ORBDUZ=$P(^OR(100,ORNUM,8,$P(^OR(100,ORNUM,8,0),U,3),0),U,13)
"RTN","ORB3",220,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",221,0)
 Q
"RTN","ORB3",222,0)
PCMMPRIM ;
"RTN","ORB3",223,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Primary Care Practitioner:",ORBUI=ORBUI+1
"RTN","ORB3",224,0)
 S ORBDUZ=+$$OUTPTPR^SDUTL3(ORBDFN,$$NOW^XLFDT,1)  ;DBIA #1252
"RTN","ORB3",225,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",226,0)
 Q
"RTN","ORB3",227,0)
PCMMASSC ;
"RTN","ORB3",228,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Associate Provider:",ORBUI=ORBUI+1
"RTN","ORB3",229,0)
 S ORBDUZ=+$$OUTPTAP^SDUTL3(ORBDFN,$$NOW^XLFDT)  ;DBIA #1252
"RTN","ORB3",230,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",231,0)
 Q
"RTN","ORB3",232,0)
PCMMTEAM ;
"RTN","ORB3",233,0)
 N ORPCMM,ORPCMMDZ
"RTN","ORB3",234,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Team Position Assignments:",ORBUI=ORBUI+1
"RTN","ORB3",235,0)
 S ORPCMM=$$PRPT^SCAPMC(ORBDFN,,,,,,"^TMP(""ORPCMM"",$J)",)  ;DBIA #1916
"RTN","ORB3",236,0)
 S ORPCMMDZ=0
"RTN","ORB3",237,0)
 F  S ORPCMMDZ=$O(^TMP("ORPCMM",$J,"SCPR",ORPCMMDZ)) Q:'ORPCMMDZ  D
"RTN","ORB3",238,0)
 .S ORBDUZ=ORPCMMDZ D USER
"RTN","ORB3",239,0)
 K ^TMP("ORPCMM",$J)
"RTN","ORB3",240,0)
 Q
"RTN","ORB3",241,0)
PCMMMHTC ;
"RTN","ORB3",242,0)
 I $D(ORBU) S ORBU(ORBUI)=" PCMM Mental Health Treatment Coordinator:",ORBUI=ORBUI+1
"RTN","ORB3",243,0)
 S ORBDUZ=+$$START^SCMCMHTC(ORBDFN)  ;DBIA #5697
"RTN","ORB3",244,0)
 I +$G(ORBDUZ)>0 D USER
"RTN","ORB3",245,0)
 Q
"RTN","ORB3",246,0)
USER ;should USER (ORBDUZ) be a recip
"RTN","ORB3",247,0)
 D USER^ORB3USER(.XQA,ORBDUZ,ORN,.ORBU,.ORBUI,ORBDFN,+$G(ORNUM))
"RTN","ORB3",248,0)
 Q
"RTN","ORB3",249,0)
COMDUP ; Combine XQADATA from existing alert(s) with new alert, delete existing alert
"RTN","ORB3",250,0)
 ;and then generate the new alert for the current individual user
"RTN","ORB3",251,0)
 N ORVAR,ORDUZ,ORAID,ORODATA
"RTN","ORB3",252,0)
 F ORVAR="XQA","XQADATA","XQAID","XQAFLG","XQAMSG","XQAROU","XQAARCH","XQASUPV","XQASURO","XQADFN","XQACNDEL","XQAREVUE","XQAOPT","XQAEXIT","XQAUSER","DUZ"  D
"RTN","ORB3",253,0)
 .Q:'$D(@ORVAR)
"RTN","ORB3",254,0)
 .I $D(@ORVAR)<10 S ORVAR(ORVAR)=$G(@ORVAR)
"RTN","ORB3",255,0)
 .I $D(@ORVAR)>9 M ORVAR(ORVAR)=@ORVAR
"RTN","ORB3",256,0)
 .S ORVAR(0,ORVAR)=""
"RTN","ORB3",257,0)
 S ORDUZ=0 F  S ORDUZ=$O(XQA(ORDUZ)) Q:'+ORDUZ  D
"RTN","ORB3",258,0)
 .N ORDATA,ORGEN
"RTN","ORB3",259,0)
 .K ^TMP($J,"ORB3DATA")
"RTN","ORB3",260,0)
 .D USER^XQALERT($NA(^TMP($J,"ORB3DATA")),ORDUZ)
"RTN","ORB3",261,0)
 .S ORAID=0 F  S ORAID=$O(^TMP($J,"ORB3DATA",ORAID)) Q:'+ORAID  D
"RTN","ORB3",262,0)
 ..Q:$P($P(^TMP($J,"ORB3DATA",ORAID),U,2),";")'=($P(ORBN,"^",2)_","_ORBDFN_","_ORN)
"RTN","ORB3",263,0)
 ..I $P(ORBN,U,4)="PKG",$P(^TMP($J,"ORB3DATA",ORAID),U)'[ORVAR("XQAMSG") Q
"RTN","ORB3",264,0)
 ..N XQAID,XQADATA,XQAOPT,XQAROU,XQAUSER,DUZ,XQAKILL
"RTN","ORB3",265,0)
 ..N XQADFN,XQAMSG,XQAFLG,XQADFN,XQAARCH,XQASUPV,XQASURO,XQAREVUE,XQACNDEL
"RTN","ORB3",266,0)
 ..S DUZ=ORDUZ
"RTN","ORB3",267,0)
 ..D GETACT^XQALERT($P(^TMP($J,"ORB3DATA",ORAID),U,2))
"RTN","ORB3",268,0)
 ..I XQADATA'="" D
"RTN","ORB3",269,0)
 ...I $D(ORBFLAGS("CD")) D
"RTN","ORB3",270,0)
 ....N OROLD,ORNEW,ORSPEC,ORIDX
"RTN","ORB3",271,0)
 ....S OROLD=U_$S(XQADATA[";":$P(XQADATA,";",2),1:XQADATA)_U,ORNEW=U_$S(ORVAR("XQADATA")[";":$P(ORVAR("XQADATA"),";",2),1:ORVAR("XQADATA"))_U
"RTN","ORB3",272,0)
 ....S ORSPEC(U)=""
"RTN","ORB3",273,0)
 ....F ORIDX=2:1:$L(ORNEW,U) I OROLD[(U_$P(ORNEW,U,ORIDX)_U) S $P(ORNEW,U,ORIDX)=""
"RTN","ORB3",274,0)
 ....S ORNEW=$$REPLACE^XLFSTR(ORNEW,.ORSPEC)
"RTN","ORB3",275,0)
 ....I ORNEW="" K ORVAR("XQA",ORDUZ) Q
"RTN","ORB3",276,0)
 ....S ORDATA=$S(XQADATA[";":$P(XQADATA,";",2),1:XQADATA)_$S($G(ORDATA)'="":U_ORDATA,1:"")
"RTN","ORB3",277,0)
 ....S ORGEN=1
"RTN","ORB3",278,0)
 ...I '$D(ORBFLAGS("CD")),XQADATA=ORVAR("XQADATA") S ORGEN=2
"RTN","ORB3",279,0)
 ..Q:'$G(ORGEN)
"RTN","ORB3",280,0)
 ..S XQAUSER=ORDUZ,XQAID=$P(^TMP($J,"ORB3DATA",ORAID),U,2),XQAKILL=1
"RTN","ORB3",281,0)
 ..D DELETE^XQALERT
"RTN","ORB3",282,0)
 .Q:$G(ORGEN)'=1
"RTN","ORB3",283,0)
 .I $G(XQADATA)'=""!($G(ORDATA)'="") S ORODATA=$G(XQADATA)_$S($G(ORDATA)'="":U_ORDATA,1:"")
"RTN","ORB3",284,0)
 .K ORVAR("XQA",ORDUZ)
"RTN","ORB3",285,0)
 .D XQRESTOR
"RTN","ORB3",286,0)
 .N XQA,XQADATA
"RTN","ORB3",287,0)
 .S XQA(ORDUZ)="",XQADATA=ORODATA D SETUP^XQALERT
"RTN","ORB3",288,0)
 K ^TMP($J,"ORB3DATA")
"RTN","ORB3",289,0)
 D XQRESTOR
"RTN","ORB3",290,0)
 Q
"RTN","ORB3",291,0)
XQRESTOR ; Restore XQA* variables saved off in COMDUP
"RTN","ORB3",292,0)
 S ORVAR="" F  S ORVAR=$O(ORVAR(0,ORVAR)) Q:$G(ORVAR)=""  K @ORVAR
"RTN","ORB3",293,0)
 S ORVAR="?" F  S ORVAR=$O(ORVAR(ORVAR)) Q:$G(ORVAR)=""  D
"RTN","ORB3",294,0)
 .I $D(ORVAR(ORVAR))<10 S @ORVAR=ORVAR(ORVAR)
"RTN","ORB3",295,0)
 .I $D(ORVAR(ORVAR))>9 M @ORVAR=ORVAR(ORVAR)
"RTN","ORB3",296,0)
 Q
"RTN","ORB3FUP1")
0^13^B77909013
"RTN","ORB3FUP1",1,0)
ORB3FUP1 ;SLC/CLA - ROUTINE TO SUPPORT NOTIFICATION FOLLOW UP ACTIONS ;07/15/2013  14:42
"RTN","ORB3FUP1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**9,64,74,105,139,243,350**;Dec 17, 1997;Build 77
"RTN","ORB3FUP1",3,0)
 Q
"RTN","ORB3FUP1",4,0)
TYPE(ORBY,ORXQAID) ; return notif follow-up action type
"RTN","ORB3FUP1",5,0)
 N NIEN
"RTN","ORB3FUP1",6,0)
 S NIEN=$P($P(ORXQAID,";"),",",3)
"RTN","ORB3FUP1",7,0)
 S ORBY=$G(^ORD(100.9,NIEN,3))
"RTN","ORB3FUP1",8,0)
 I ORBY="" S ORBY="INFO^"
"RTN","ORB3FUP1",9,0)
 E  S ORBY=$P(ORBY,U,2)
"RTN","ORB3FUP1",10,0)
 Q
"RTN","ORB3FUP1",11,0)
GUI(ORBY,ORXQAID) ; Notification follow-up for GUI called via API: ORB FOLLOW-UP
"RTN","ORB3FUP1",12,0)
 ; called by ORB FOLLOW-UP api:
"RTN","ORB3FUP1",13,0)
 S ORENVIR="GUI"
"RTN","ORB3FUP1",14,0)
 D PROCESS
"RTN","ORB3FUP1",15,0)
 Q
"RTN","ORB3FUP1",16,0)
PROCESS ; main process for notification follow-up
"RTN","ORB3FUP1",17,0)
 ;ORXQAID = OR,dfn,nien;
"RTN","ORB3FUP1",18,0)
 ;XQADATA = placer num^placer id;filler num^filler id
"RTN","ORB3FUP1",19,0)
 ;XQAKILL = value of parameter ORB DELETE MECHANISM for notif in 100.9
"RTN","ORB3FUP1",20,0)
 N ORPDIEN,ORN,ORDFN,ORSITE,ORFID,ORFIEN,ORKILL
"RTN","ORB3FUP1",21,0)
 N XQAID,XQADATA,XQAOPT,XQAROU
"RTN","ORB3FUP1",22,0)
 D GETACT^XQALERT(ORXQAID)  ;return follow-up action info
"RTN","ORB3FUP1",23,0)
 ;Q:'($D(XQADATA))  Q:'($D(XQAID))
"RTN","ORB3FUP1",24,0)
 ;Q:($P(XQAID,",")'="OR")
"RTN","ORB3FUP1",25,0)
 ;call function rpc stored in xqarou with params from xqadata
"RTN","ORB3FUP1",26,0)
 D @XQAROU
"RTN","ORB3FUP1",27,0)
 K ORENVIR
"RTN","ORB3FUP1",28,0)
 Q
"RTN","ORB3FUP1",29,0)
MSG ; display msg re: alert being processed for non-GUI follow-up actions
"RTN","ORB3FUP1",30,0)
 I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",31,0)
 .I $L($G(XQX)) W !!,"Processing alert: ",$P(XQX,U,3) H 1.5
"RTN","ORB3FUP1",32,0)
 Q
"RTN","ORB3FUP1",33,0)
DEL(ORBY,XQAID,ORKILL) ; delete an alert
"RTN","ORB3FUP1",34,0)
 N ORN
"RTN","ORB3FUP1",35,0)
 S ORN=$P($P(XQAID,";"),",",3)
"RTN","ORB3FUP1",36,0)
 I $G(ORKILL)=1!($G(ORKILL)=0) S XQAKILL=ORKILL
"RTN","ORB3FUP1",37,0)
 I $G(XQAKILL)="" S XQAKILL=$$XQAKILL^ORB3F1(ORN)
"RTN","ORB3FUP1",38,0)
 I $G(XQAKILL)="" S XQAKILL=1
"RTN","ORB3FUP1",39,0)
 S ORBY="FALSE"
"RTN","ORB3FUP1",40,0)
 I $L($G(XQAID)) D DELETE^XQALERT S ORBY="TRUE"
"RTN","ORB3FUP1",41,0)
 K XQAKILL
"RTN","ORB3FUP1",42,0)
 Q
"RTN","ORB3FUP1",43,0)
CSORD ;co-sign order(s) follow-up
"RTN","ORB3FUP1",44,0)
 K XQAKILL
"RTN","ORB3FUP1",45,0)
 N ORPT,ORDG,ORBXQAID,ORY S ORBXQAID=XQAID
"RTN","ORB3FUP1",46,0)
 S ORPT=$P($P(XQAID,";"),",",2)  ;get pt dfn from xqaid
"RTN","ORB3FUP1",47,0)
 ;the FLG code for orders requiring CO-SIGNATURE in ORQ1 is 'to be determined when ASU is available'
"RTN","ORB3FUP1",48,0)
 D DEL(.ORY,XQAID)  ;until ASU is implemented, delete the alert and quit
"RTN","ORB3FUP1",49,0)
 Q  ;quit until ASU is implemented
"RTN","ORB3FUP1",50,0)
 ;I $G(ORENVIR)="GUI" D LIST^ORQOR1(.ORBY,ORPT,"ALL",???,"","")
"RTN","ORB3FUP1",51,0)
 ;I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",52,0)
 ;.D MSG
"RTN","ORB3FUP1",53,0)
 ;.S ORDG=$$DG^ORQOR1("ALL")  ;get Display Group ien
"RTN","ORB3FUP1",54,0)
 ;.D EN^ORCB(ORPT,???,ORDG,???)
"RTN","ORB3FUP1",55,0)
 ;.K ^TMP("ORR",$J)
"RTN","ORB3FUP1",56,0)
 ;.D EN^ORQ1(ORPT_";DPT(",ORDG,???,"","","",0,0)
"RTN","ORB3FUP1",57,0)
 ;.S X="",X=$O(^TMP("ORR",$J,X)) Q:X=""  I +$G(^TMP("ORR",$J,X,"TOT"))<1 D
"RTN","ORB3FUP1",58,0)
 ;..D DEL(.ORY,ORBXQAID)  ;if no more orders req. co-sign, delete the alert
"RTN","ORB3FUP1",59,0)
 ;.K ^TMP("ORR",$J)
"RTN","ORB3FUP1",60,0)
 Q
"RTN","ORB3FUP1",61,0)
EXDNR ;expiring dnr follow-up
"RTN","ORB3FUP1",62,0)
 K XQAKILL
"RTN","ORB3FUP1",63,0)
 N ORPT,ORBXQAID,ORY S ORBXQAID=XQAID
"RTN","ORB3FUP1",64,0)
 S ORPT=$P($P(XQAID,";"),",",2)  ;get pt dfn from xqaid
"RTN","ORB3FUP1",65,0)
 N DNRORD,DNRY S DNRORD=$P(XQADATA,"@")
"RTN","ORB3FUP1",66,0)
 I $G(ORENVIR)="GUI" D
"RTN","ORB3FUP1",67,0)
 .S ORBY(1)=DNRY
"RTN","ORB3FUP1",68,0)
 I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",69,0)
 .D MSG
"RTN","ORB3FUP1",70,0)
 .D EN1^ORCB(DNRORD,"RENEW")  ;display order, allow renewing, then delete
"RTN","ORB3FUP1",71,0)
 .D DEL(.ORY,ORBXQAID)
"RTN","ORB3FUP1",72,0)
 Q
"RTN","ORB3FUP1",73,0)
UNLINKED ;unlinked provider follow-up
"RTN","ORB3FUP1",74,0)
 K XQAKILL
"RTN","ORB3FUP1",75,0)
 N ORPT,ORBXQAID,ORY S ORBXQAID=XQAID
"RTN","ORB3FUP1",76,0)
 S ORPT=$P($P(XQAID,";"),",",2)  ;get pt dfn from xqaid
"RTN","ORB3FUP1",77,0)
 N ORNUM,ORUNY S ORNUM=$P(XQADATA,"@")
"RTN","ORB3FUP1",78,0)
 I $G(ORENVIR)="GUI" D
"RTN","ORB3FUP1",79,0)
 .S ORBY(1)=ORUNY
"RTN","ORB3FUP1",80,0)
 I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",81,0)
 .D MSG
"RTN","ORB3FUP1",82,0)
 .D EN1^ORCB(ORNUM,"REPLACE")  ;display order, allow replace, then delete
"RTN","ORB3FUP1",83,0)
 .D DEL(.ORY,ORBXQAID)
"RTN","ORB3FUP1",84,0)
 Q
"RTN","ORB3FUP1",85,0)
FLORD ;flagged order(s) follow-up
"RTN","ORB3FUP1",86,0)
 K XQAKILL
"RTN","ORB3FUP1",87,0)
 N ORPT,ORDG,X,ORBXQAID,ORY,ORBLMDEL
"RTN","ORB3FUP1",88,0)
 S ORBXQAID=XQAID
"RTN","ORB3FUP1",89,0)
 S ORPT=$P($P(XQAID,";"),",",2)  ;get pt dfn from xqaid
"RTN","ORB3FUP1",90,0)
 ;the FLG code for "FLAGGED" in ORQ1 is '12'
"RTN","ORB3FUP1",91,0)
 I $G(ORENVIR)="GUI" D LIST^ORQOR1(.ORBY,ORPT,"ALL",12,"","")
"RTN","ORB3FUP1",92,0)
 I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",93,0)
 .D MSG
"RTN","ORB3FUP1",94,0)
 .S ORDG=$$DG^ORQOR1("ALL")  ;get Display Group ien
"RTN","ORB3FUP1",95,0)
 .D EN^ORCB(ORPT,12,ORDG,.ORBLMDEL)
"RTN","ORB3FUP1",96,0)
 .K ^TMP("ORR",$J)
"RTN","ORB3FUP1",97,0)
 .Q:$G(ORBLMDEL)=1  ;if EN^ORCB rtns ORBLMDEL=1, alert was removed in LM
"RTN","ORB3FUP1",98,0)
 .D EN^ORQ1(ORPT_";DPT(",ORDG,12,"","","",0,0)
"RTN","ORB3FUP1",99,0)
 .S X="",X=$O(^TMP("ORR",$J,X)) Q:X=""  I +$G(^TMP("ORR",$J,X,"TOT"))<1 D
"RTN","ORB3FUP1",100,0)
 ..D DEL(.ORY,ORBXQAID)  ;if no more flagged orders found, delete alert
"RTN","ORB3FUP1",101,0)
 .K ^TMP("ORR",$J)
"RTN","ORB3FUP1",102,0)
 Q
"RTN","ORB3FUP1",103,0)
NEWORD ;new order(s) follow-up
"RTN","ORB3FUP1",104,0)
 K XQAKILL
"RTN","ORB3FUP1",105,0)
 N ORPT,ORDG,ORSDT,OREDT,ENT,X,ORBXQAID,ORY,ORBLMDEL
"RTN","ORB3FUP1",106,0)
 S ORSDT="",OREDT="",ENT="USR",ORBXQAID=XQAID
"RTN","ORB3FUP1",107,0)
 S ORPT=$P($P(XQAID,";"),",",2)  ;get pt dfn from xqaid
"RTN","ORB3FUP1",108,0)
 ;the FLG code for NEW orders since last reviewed orders in ORQ1 is '6'
"RTN","ORB3FUP1",109,0)
 I $G(ORENVIR)="GUI" D LIST^ORQOR1(.ORBY,ORPT,"ALL",6,"","")
"RTN","ORB3FUP1",110,0)
 I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",111,0)
 .D MSG
"RTN","ORB3FUP1",112,0)
 .S ORDG=$$DG^ORQOR1("ALL")  ;get Display Group ien
"RTN","ORB3FUP1",113,0)
 .D EN^ORCB(ORPT,6,ORDG,.ORBLMDEL)
"RTN","ORB3FUP1",114,0)
 .Q:$G(ORBLMDEL)=1  ;if EN^ORCB rtns ORBLMDEL=1, alert was removed in LM
"RTN","ORB3FUP1",115,0)
 .D DEL(.ORY,ORBXQAID) ;delete the alert
"RTN","ORB3FUP1",116,0)
 Q
"RTN","ORB3FUP1",117,0)
DCORD ;DC order(s) follow-up
"RTN","ORB3FUP1",118,0)
 K XQAKILL
"RTN","ORB3FUP1",119,0)
 N ORPT,ORDG,ORSDT,OREDT,ENT,X,ORBXQAID,ORY,ORBLMDEL
"RTN","ORB3FUP1",120,0)
 S ORSDT="",OREDT="",ENT="USR",ORBXQAID=XQAID
"RTN","ORB3FUP1",121,0)
 S ORPT=$P($P(XQAID,";"),",",2)  ;get pt dfn from xqaid
"RTN","ORB3FUP1",122,0)
 ;the FLG code for DC orders is '3'
"RTN","ORB3FUP1",123,0)
 I $G(ORENVIR)="GUI" D LIST^ORQOR1(.ORBY,ORPT,"ALL",6,"","")
"RTN","ORB3FUP1",124,0)
 I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",125,0)
 .D MSG
"RTN","ORB3FUP1",126,0)
 .S ORDG=$$DG^ORQOR1("ALL")  ;get Display Group ien
"RTN","ORB3FUP1",127,0)
 .D EN^ORCB(ORPT,6,ORDG,.ORBLMDEL)
"RTN","ORB3FUP1",128,0)
 .Q:$G(ORBLMDEL)=1  ;if EN^ORCB rtns ORBLMDEL=1, alert was removed in LM
"RTN","ORB3FUP1",129,0)
 .D DEL(.ORY,ORBXQAID) ;delete the alert
"RTN","ORB3FUP1",130,0)
 Q
"RTN","ORB3FUP1",131,0)
NUMORD ;detailed order display follow-up - return order number
"RTN","ORB3FUP1",132,0)
 K XQAKILL
"RTN","ORB3FUP1",133,0)
 N ORBXQAID,ORY S ORBXQAID=XQAID
"RTN","ORB3FUP1",134,0)
 S ORNUM=$P(XQADATA,"@")
"RTN","ORB3FUP1",135,0)
 I $G(ORENVIR)="GUI" D
"RTN","ORB3FUP1",136,0)
 .Q
"RTN","ORB3FUP1",137,0)
 I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",138,0)
 .D MSG
"RTN","ORB3FUP1",139,0)
 .D EN1^ORCB(+ORNUM,"NEW")  ;display order, allow new order then delete
"RTN","ORB3FUP1",140,0)
 .D DEL(.ORY,ORBXQAID)
"RTN","ORB3FUP1",141,0)
 Q
"RTN","ORB3FUP1",142,0)
ESORD ;order(s) requiring electronic signature follow-up
"RTN","ORB3FUP1",143,0)
 K XQAKILL
"RTN","ORB3FUP1",144,0)
 N ORPT,ORDG,ORBXQAID,ORY,ORX,ORZ,ORDERS,ORDNUM,ORQUIT,ORBLMDEL
"RTN","ORB3FUP1",145,0)
 S ORBXQAID=XQAID,ORDERS=0,ORQUIT=0
"RTN","ORB3FUP1",146,0)
 S ORPT=$P($P(XQAID,";"),",",2)  ;get pt dfn from xqaid
"RTN","ORB3FUP1",147,0)
 ;the FLG code for UNSIGNED orders in ORQ1 is '11'
"RTN","ORB3FUP1",148,0)
 I $G(ORENVIR)="GUI" D LIST^ORQOR1(.ORBY,ORPT,"ALL",11,"","")
"RTN","ORB3FUP1",149,0)
 I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",150,0)
 .D MSG
"RTN","ORB3FUP1",151,0)
 .S ORDG=$$DG^ORQOR1("ALL")  ;get Display Group ien
"RTN","ORB3FUP1",152,0)
 .D EN^ORCB(ORPT,11,ORDG,.ORBLMDEL)
"RTN","ORB3FUP1",153,0)
 .K ^TMP("ORR",$J)  ;clean up array
"RTN","ORB3FUP1",154,0)
 .Q:$G(ORBLMDEL)=1  ;if EN^ORCB rtns ORBLMDEL=1, alert was removed in LM
"RTN","ORB3FUP1",155,0)
 .I $L($G(XQAID)) D  ;EN^ORCB may kill XQAID in its follow-up
"RTN","ORB3FUP1",156,0)
 ..;
"RTN","ORB3FUP1",157,0)
 ..;get unsigned orders - if none exist, delete alert then quit:
"RTN","ORB3FUP1",158,0)
 ..D EN^ORQ1(ORPT_";DPT(",ORDG,11,"","","",0,0)
"RTN","ORB3FUP1",159,0)
 ..S ORX="",ORX=$O(^TMP("ORR",$J,ORX)) Q:ORX=""  I +$G(^TMP("ORR",$J,ORX,"TOT"))<1 D DEL(.ORY,ORBXQAID) K ^TMP("ORR",$J) Q
"RTN","ORB3FUP1",160,0)
 ..;
"RTN","ORB3FUP1",161,0)
 ..;user does not have ORES key, delete user's alert:
"RTN","ORB3FUP1",162,0)
 ..I '$D(^XUSEC("ORES",DUZ)) S XQAKILL=1 D DEL(.ORY,ORBXQAID) K ^TMP("ORR",$J) Q
"RTN","ORB3FUP1",163,0)
 ..;
"RTN","ORB3FUP1",164,0)
 ..;if prov is NOT linked to pt via attending, primary, teams or PCMM:
"RTN","ORB3FUP1",165,0)
 ..I $$PPLINK^ORQPTQ1(DUZ,ORPT)=0 D
"RTN","ORB3FUP1",166,0)
 ...S ORX="" F  S ORX=$O(^TMP("ORR",$J,ORX)) Q:ORX=""!(ORDERS=1)  D
"RTN","ORB3FUP1",167,0)
 ....S ORZ="" F  S ORZ=$O(^TMP("ORR",$J,ORX,ORZ)) Q:ORZ=""!(ORDERS=1)  D
"RTN","ORB3FUP1",168,0)
 .....S ORDNUM=^TMP("ORR",$J,ORX,ORZ)
"RTN","ORB3FUP1",169,0)
 .....;quit if this unsigned order's last action was made by the user
"RTN","ORB3FUP1",170,0)
 .....I DUZ=+$$UNSIGNOR^ORQOR2(ORDNUM) S ORDERS=1
"RTN","ORB3FUP1",171,0)
 ...I ORDERS'=1 D  ;provider has no outstanding unsiged orders for pt
"RTN","ORB3FUP1",172,0)
 ....S XQAKILL=1 D DEL(.ORY,ORBXQAID) ;delete alert for this user
"RTN","ORB3FUP1",173,0)
 ..K ^TMP("ORR",$J)
"RTN","ORB3FUP1",174,0)
 Q
"RTN","ORB3FUP1",175,0)
UNFLAG(ORPT) ;order unflagged - delete alert if no more flagged orders
"RTN","ORB3FUP1",176,0)
 N ORDG,ORDOIT,ORQUIT,X,XQAID,XQAKILL,XQAUSER
"RTN","ORB3FUP1",177,0)
 S ORDOIT=1,ORQUIT=0
"RTN","ORB3FUP1",178,0)
 S ORDG=$$DG^ORQOR1("ALL")  ;get Display Group ien
"RTN","ORB3FUP1",179,0)
 K ^TMP("ORR",$J)
"RTN","ORB3FUP1",180,0)
 D EN^ORQ1(ORPT_";DPT(",ORDG,12,"","","",0,0)
"RTN","ORB3FUP1",181,0)
 ;========DELETE ALERT (FOR ALL USERS) IF NO FLAGGED ORDERS AT ALL=====
"RTN","ORB3FUP1",182,0)
 S X="",X=$O(^TMP("ORR",$J,X)) Q:X=""  I +$G(^TMP("ORR",$J,X,"TOT"))<1 D
"RTN","ORB3FUP1",183,0)
 .;if no more flagged orders found, delete alert:
"RTN","ORB3FUP1",184,0)
 .S XQAKILL=$$XQAKILL^ORB3F1(6)
"RTN","ORB3FUP1",185,0)
 .I $G(XQAKILL)="" S XQAKILL=1
"RTN","ORB3FUP1",186,0)
 .S XQAID="OR,"_ORPT_",6" D DELETEA^XQALERT K XQAID,XQAKILL S ORQUIT=1
"RTN","ORB3FUP1",187,0)
 Q:ORQUIT
"RTN","ORB3FUP1",188,0)
 ;========DELETE ALERT IF NO FLAGGED ORDERS LEFT RELATED TO THE USER THAT IS UNFLAGGING=====
"RTN","ORB3FUP1",189,0)
 S X="",X=$O(^TMP("ORR",$J,X)) Q:X=""  D
"RTN","ORB3FUP1",190,0)
 .N Y S Y="" F  S Y=$O(^TMP("ORR",$J,X,Y)) Q:'Y  D
"RTN","ORB3FUP1",191,0)
 ..N ORDER S ORDER=$G(^TMP("ORR",$J,X,Y))
"RTN","ORB3FUP1",192,0)
 ..I $$FLAGRULE^ORWORR1(+ORDER)=0 S ORDOIT=0 ; FOUND A FLAGGED ORDER THAT THE USER SHOULD GET
"RTN","ORB3FUP1",193,0)
 I ORDOIT D
"RTN","ORB3FUP1",194,0)
 .;if no more flagged orders found for this user, delete alert only for this user:
"RTN","ORB3FUP1",195,0)
 .S XQAKILL=1
"RTN","ORB3FUP1",196,0)
 .S XQAID="OR,"_ORPT_",6" D DELETEA^XQALERT K XQAID,XQAKILL
"RTN","ORB3FUP1",197,0)
 ;========DELETE ALERT IF NO FLAGGED ORDERS LEFT RELATED TO THE USER THAT WAS THE ALERTED PROVIDER OF THE CURRENT ORDER=====
"RTN","ORB3FUP1",198,0)
 S ORDOIT=1
"RTN","ORB3FUP1",199,0)
 ;get the alerted provider
"RTN","ORB3FUP1",200,0)
 I $G(ORIFN) D
"RTN","ORB3FUP1",201,0)
 .N ORD,ORACT S ORD=+$G(ORIFN),ORACT=$P($G(ORIFN),";",2)
"RTN","ORB3FUP1",202,0)
 .N ORUSR S ORUSR=$P($G(^OR(100,ORD,8,ORACT,3)),U,9)
"RTN","ORB3FUP1",203,0)
 .I ORUSR D
"RTN","ORB3FUP1",204,0)
 ..S X="",X=$O(^TMP("ORR",$J,X)) Q:X=""  D
"RTN","ORB3FUP1",205,0)
 ...N Y S Y="" F  S Y=$O(^TMP("ORR",$J,X,Y)) Q:'Y  D
"RTN","ORB3FUP1",206,0)
 ....N ORDER S ORDER=$G(^TMP("ORR",$J,X,Y))
"RTN","ORB3FUP1",207,0)
 ....I $$FLAGRULE^ORWORR1(+ORDER,ORUSR)=0 S ORDOIT=0 ; FOUND A FLAGGED ORDER THAT THE USER SHOULD GET
"RTN","ORB3FUP1",208,0)
 ..I ORDOIT D
"RTN","ORB3FUP1",209,0)
 ...;if no more flagged orders found for this user, delete alert only for this user:
"RTN","ORB3FUP1",210,0)
 ...S XQAKILL=1,XQAUSER=ORUSR
"RTN","ORB3FUP1",211,0)
 ...S XQAID="OR,"_ORPT_",6" D DELETEA^XQALERT K XQAID,XQAKILL,XQAUSER
"RTN","ORB3FUP1",212,0)
 K ^TMP("ORR",$J)
"RTN","ORB3FUP1",213,0)
 Q
"RTN","ORB3FUP1",214,0)
INDORDER ;process specific orders
"RTN","ORB3FUP1",215,0)
 ;XQADATA=LIST MANAGER ACTION;CARET-DELIMITED LIST OF ORDER NUMBERS
"RTN","ORB3FUP1",216,0)
 K XQAKILL
"RTN","ORB3FUP1",217,0)
 N ORBXQAID,ORY
"RTN","ORB3FUP1",218,0)
 S ORBXQAID=XQAID
"RTN","ORB3FUP1",219,0)
 I $G(ORENVIR)="GUI",($L($P(XQADATA,";",2))>0) D
"RTN","ORB3FUP1",220,0)
 .N INDEX,IFN,ORLIST,ORLST,TOT,I,ORWTS,PTEVTID,EVTNAME,TXTVW,MULT,REF,FILTER
"RTN","ORB3FUP1",221,0)
 .S XQADATA=$P(XQADATA,";",2),ORLIST="INDORDER",ORLST=0,EVTNAME=""
"RTN","ORB3FUP1",222,0)
 .F INDEX=1:1:$L(XQADATA,U) D GET^ORQ12(+$P(XQADATA,U,INDEX),ORLIST,0,$P($G(^OR(100,+$P(XQADATA,U,INDEX),3)),U,7))
"RTN","ORB3FUP1",223,0)
 .S ^TMP("ORR",$J,ORLIST,"TOT")=ORLST
"RTN","ORB3FUP1",224,0)
 .S ORWTS="",MULT=1,IFN="",FILTER=0
"RTN","ORB3FUP1",225,0)
 .D GET1^ORWORR1
"RTN","ORB3FUP1",226,0)
 .M ORBY=@REF
"RTN","ORB3FUP1",227,0)
 .K @REF
"RTN","ORB3FUP1",228,0)
 I $G(ORENVIR)'="GUI" D
"RTN","ORB3FUP1",229,0)
 .N IDX,ORACT,ORDEL
"RTN","ORB3FUP1",230,0)
 .S ORACT=$P(XQADATA,";",1),XQADATA=$P(XQADATA,";",2),ORDEL=0
"RTN","ORB3FUP1",231,0)
 .D MSG
"RTN","ORB3FUP1",232,0)
 .F IDX=1:1:$L(XQADATA,U) D EN1^ORCB($P(XQADATA,U,IDX),ORACT) ;DISPLAY EACH ORDER, ALLOWING USER TO EXECUTE SPECIFIED ACTION
"RTN","ORB3FUP1",233,0)
 .D DEL(.ORY,ORBXQAID) ;DELETE ENTIRE ALERT
"RTN","ORB3FUP1",234,0)
 Q
"RTN","ORB3TIM2")
0^45^B43382102
"RTN","ORB3TIM2",1,0)
ORB3TIM2 ;SLC/CLA - Routine to trigger time-related notifications ;04/28/2015  08:17
"RTN","ORB3TIM2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**102,215,251,265,356,350**;Dec 17, 1997;Build 77
"RTN","ORB3TIM2",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","ORB3TIM2",4,0)
 ;
"RTN","ORB3TIM2",5,0)
EXPIR ;trigger expiring order notifs
"RTN","ORB3TIM2",6,0)
 N EDT,EXDT,EXORN,ORBDNR,ORPT,ORBRSLT,RXORD,ORLASTDT,X,Y,%DT
"RTN","ORB3TIM2",7,0)
 N OIFILE,ORBY,ORBZ,ORBI,ORSCH,ORSCHFIL,ONETIME,ORST,ORNG,ORDT,ORDW,ORHOL
"RTN","ORB3TIM2",8,0)
 N EXOI,ORBLST,ORBERR,OITXT,PTLOC,ORSDT,ORNOW,ORLDT
"RTN","ORB3TIM2",9,0)
 ;
"RTN","ORB3TIM2",10,0)
 S ORNOW=$$NOW^XLFDT
"RTN","ORB3TIM2",11,0)
 ;
"RTN","ORB3TIM2",12,0)
 I '$D(^XTMP("ORB LAST EXPIRE")) D  ;holds last dt EXPIR processed
"RTN","ORB3TIM2",13,0)
 .S ^XTMP("ORB LAST EXPIRE",0)=$$FMADD^XLFDT(ORNOW,7,"","","")_U
"RTN","ORB3TIM2",14,0)
 ;
"RTN","ORB3TIM2",15,0)
 ;determine number of days to return orders using day of week & holidays
"RTN","ORB3TIM2",16,0)
 F ORNG=1:1 D  I ORHOL=0,ORDW=0 Q
"RTN","ORB3TIM2",17,0)
 .S ORDW=$S($H-4+ORNG#7>4:1,1:0)          ;if Sat or Sun, ORDW=0
"RTN","ORB3TIM2",18,0)
 .S ORDT=$$FMADD^XLFDT(DT,ORNG)
"RTN","ORB3TIM2",19,0)
 .K DIC S DIC="^HOLIDAY(",X=ORDT D ^DIC
"RTN","ORB3TIM2",20,0)
 .S ORHOL=$S(+$G(Y)>0:1,1:0)              ;if ORDT is a holiday, ORHOL=0
"RTN","ORB3TIM2",21,0)
 S %DT="",X="T+"_ORNG D ^%DT
"RTN","ORB3TIM2",22,0)
 S EDT=Y_".2400"
"RTN","ORB3TIM2",23,0)
 K DIC
"RTN","ORB3TIM2",24,0)
 ;
"RTN","ORB3TIM2",25,0)
 ;get DNR OIs:
"RTN","ORB3TIM2",26,0)
 S OIFILE=$$TERMLKUP^ORB31(.ORBY,"DNR")
"RTN","ORB3TIM2",27,0)
 ;
"RTN","ORB3TIM2",28,0)
 ;get local admin schedules for ONE TIME MED:
"RTN","ORB3TIM2",29,0)
 S ORSCHFIL=$$TERMLKUP^ORB31(.ORBZ,"ONE TIME MED")
"RTN","ORB3TIM2",30,0)
 ;
"RTN","ORB3TIM2",31,0)
 ;examine expiring orders:
"RTN","ORB3TIM2",32,0)
 S ORLASTDT=$P(^XTMP("ORB LAST EXPIRE",0),U,2)
"RTN","ORB3TIM2",33,0)
 S EXDT=$S($L(ORLASTDT):ORLASTDT,1:ORNOW)
"RTN","ORB3TIM2",34,0)
 F  S EXDT=$O(^OR(100,"AE",EXDT)) Q:(EXDT="")  D  Q:ORBRSLT<0
"RTN","ORB3TIM2",35,0)
 .S ORBRSLT=$$FMDIFF^XLFDT(EDT,$P(EXDT,".")_".2400",2)  ;diff in seconds
"RTN","ORB3TIM2",36,0)
 .Q:ORBRSLT<0
"RTN","ORB3TIM2",37,0)
 .S EXORN="" F  S EXORN=$O(^OR(100,"AE",EXDT,EXORN)) Q:EXORN=""  D
"RTN","ORB3TIM2",38,0)
 ..;
"RTN","ORB3TIM2",39,0)
 ..;*356 Protect, if x-ref dangles.
"RTN","ORB3TIM2",40,0)
 ..I '$D(^OR(100,EXORN)) K ^OR(100,"AE",EXDT,EXORN) Q
"RTN","ORB3TIM2",41,0)
 ..;
"RTN","ORB3TIM2",42,0)
 ..;Quit if isn't at least next day after order's Date of Last Activity:
"RTN","ORB3TIM2",43,0)
 ..S ORLDT=$P(^OR(100,EXORN,3),U)
"RTN","ORB3TIM2",44,0)
 ..Q:$$FMDIFF^XLFDT(ORNOW,ORLDT)<1
"RTN","ORB3TIM2",45,0)
 ..;
"RTN","ORB3TIM2",46,0)
 ..Q:$D(^XTMP("ORB LAST EXPIRE",EXORN))  ;quit if order already processed
"RTN","ORB3TIM2",47,0)
 ..S ^XTMP("ORB LAST EXPIRE",EXORN)=EXDT
"RTN","ORB3TIM2",48,0)
 ..;
"RTN","ORB3TIM2",49,0)
 ..S ORPT=$$PT^ORQOR2(EXORN)   ; get pt assoc w/order
"RTN","ORB3TIM2",50,0)
 ..Q:+$G(ORPT)<1
"RTN","ORB3TIM2",51,0)
 ..;
"RTN","ORB3TIM2",52,0)
 ..Q:+$G(^DPT(ORPT,.35))>0  ; quit if pt deceased - DBIA #10035
"RTN","ORB3TIM2",53,0)
 ..;
"RTN","ORB3TIM2",54,0)
 ..S PTLOC=$G(^DPT(+$G(ORPT),.1)),PTLOC=$S($L(PTLOC):PTLOC,1:"OUTPT")
"RTN","ORB3TIM2",55,0)
 ..;
"RTN","ORB3TIM2",56,0)
 ..; is expiring order a DNR order:
"RTN","ORB3TIM2",57,0)
 ..I $D(ORBY),(+$G(OIFILE)=101.43) D
"RTN","ORB3TIM2",58,0)
 ...F ORBI=1:1:ORBY D
"RTN","ORB3TIM2",59,0)
 ....S ORBDNR=$P(ORBY(ORBI),U) I ORBDNR=$$OI^ORQOR2(EXORN) D
"RTN","ORB3TIM2",60,0)
 .....S ORST=$P($$STATUS^ORQOR2(EXORN),U,2)
"RTN","ORB3TIM2",61,0)
 .....I ORST'="DISCONTINUED",ORST'="COMPLETE",ORST'="EXPIRED",ORST'="CANCELLED",ORST'="DISCONTINUED/EDIT" D
"RTN","ORB3TIM2",62,0)
 ......D EN^ORB3(45,ORPT,EXORN,"","",EXORN_"@") ;trigger DNR notif
"RTN","ORB3TIM2",63,0)
 ..;
"RTN","ORB3TIM2",64,0)
 ..; is expiring order a flagged oi:
"RTN","ORB3TIM2",65,0)
 ..S EXOI=$$OI^ORQOR2(EXORN) I +$G(EXOI)>0 D
"RTN","ORB3TIM2",66,0)
 ...I $L(PTLOC),PTLOC'="OUTPT" D
"RTN","ORB3TIM2",67,0)
 ....D ENVAL^XPAR(.ORBLST,"ORB OI EXPIRING - INPT","`"_EXOI,.ORBERR)
"RTN","ORB3TIM2",68,0)
 ....I 'ORBERR,'$G(ORBLST) D ENVAL^XPAR(.ORBLST,"ORB OI EXPIRING - INPT PR","`"_EXOI,.ORBERR)
"RTN","ORB3TIM2",69,0)
 ....I 'ORBERR,$G(ORBLST)>0 D
"RTN","ORB3TIM2",70,0)
 .....S OITXT=$P(^ORD(101.43,EXOI,0),U)
"RTN","ORB3TIM2",71,0)
 .....S ORSDT=$P(^OR(100,EXORN,0),U,8),ORSDT=$$FMTE^XLFDT(ORSDT,"2P")
"RTN","ORB3TIM2",72,0)
 .....D EN^ORB3(64,ORPT,EXORN,"","["_PTLOC_"] Order expiring: "_OITXT_" "_ORSDT,EXORN_"@") ;trigger Expiring Flagged OI - INPT notification
"RTN","ORB3TIM2",73,0)
 ...;
"RTN","ORB3TIM2",74,0)
 ...I $L(PTLOC),PTLOC="OUTPT" D
"RTN","ORB3TIM2",75,0)
 ....D ENVAL^XPAR(.ORBLST,"ORB OI EXPIRING - OUTPT","`"_EXOI,.ORBERR)
"RTN","ORB3TIM2",76,0)
 ....;*356 Add OUTPT PR
"RTN","ORB3TIM2",77,0)
 ....I 'ORBERR,'$G(ORBLST) D ENVAL^XPAR(.ORBLST,"ORB OI EXPIRING - OUTPT PR","`"_EXOI,.ORBERR)
"RTN","ORB3TIM2",78,0)
 ....I 'ORBERR,$G(ORBLST)>0 D
"RTN","ORB3TIM2",79,0)
 .....S OITXT=$P(^ORD(101.43,EXOI,0),U)
"RTN","ORB3TIM2",80,0)
 .....S ORSDT=$P(^OR(100,EXORN,0),U,8),ORSDT=$$FMTE^XLFDT(ORSDT,"2P")
"RTN","ORB3TIM2",81,0)
 .....D EN^ORB3(65,ORPT,EXORN,"","["_PTLOC_"] Order expiring: "_OITXT_" "_ORSDT,EXORN_"@") ;trigger Expiring Flagged OI - OUTPT notification
"RTN","ORB3TIM2",82,0)
 ..;
"RTN","ORB3TIM2",83,0)
 ..;is expiring order a med order:
"RTN","ORB3TIM2",84,0)
 ..S RXORD=$$DGRX^ORQOR2(EXORN)
"RTN","ORB3TIM2",85,0)
 ..I $L(RXORD) D  ;if expiring order is a med order
"RTN","ORB3TIM2",86,0)
 ...;
"RTN","ORB3TIM2",87,0)
 ...N DFN S DFN=ORPT
"RTN","ORB3TIM2",88,0)
 ...D ADM^VADPT2
"RTN","ORB3TIM2",89,0)
 ...;
"RTN","ORB3TIM2",90,0)
 ...I (RXORD="OUTPATIENT MEDICATIONS")!(+$G(VADMVT)<1&(RXORD'?1"CLINIC ".E)) D
"RTN","ORB3TIM2",91,0)
 ....D EN^ORB3(72,ORPT,EXORN,"","",EXORN_"@")  ;trigger outpt notif
"RTN","ORB3TIM2",92,0)
 ...;
"RTN","ORB3TIM2",93,0)
 ...Q:RXORD="OUTPATIENT MEDICATIONS"  ;quit if an outpt med
"RTN","ORB3TIM2",94,0)
 ...Q:+$G(VADMVT)<1&(RXORD'?1"CLINIC ".E)  ;quit if an outpt
"RTN","ORB3TIM2",95,0)
 ...;
"RTN","ORB3TIM2",96,0)
 ...K VADMVT
"RTN","ORB3TIM2",97,0)
 ...;
"RTN","ORB3TIM2",98,0)
 ...;is schedule for the order a ONE TIME MED:
"RTN","ORB3TIM2",99,0)
 ...S ONETIME=0
"RTN","ORB3TIM2",100,0)
 ...I $D(ORBZ),(+$G(ORSCHFIL)=51.1) F ORBI=1:1:ORBZ D
"RTN","ORB3TIM2",101,0)
 ....S ORSCH=$P(ORBZ(ORBI),U,2)
"RTN","ORB3TIM2",102,0)
 ....I ORSCH=$$VALUE^ORCSAVE2(EXORN,"SCHEDULE") S ONETIME=1 Q
"RTN","ORB3TIM2",103,0)
 ...Q:+$G(ONETIME)=1  ;quit if one time med
"RTN","ORB3TIM2",104,0)
 ...;
"RTN","ORB3TIM2",105,0)
 ...;check if this is an IMO order and what it is,send an M.E.-OUTPT alert
"RTN","ORB3TIM2",106,0)
 ...I RXORD?1"CLINIC ".E D  Q
"RTN","ORB3TIM2",107,0)
 ....N ORDLG,ORDG,ORDLGNM,FLAG,ORX
"RTN","ORB3TIM2",108,0)
 ....S FLAG=0
"RTN","ORB3TIM2",109,0)
 ....S ORDLG=$P($G(^OR(100,EXORN,0)),U,5) Q:$P(ORDLG,";",2)'="ORD(101.41,"
"RTN","ORB3TIM2",110,0)
 ....S ORDLGNM=$P($G(^ORD(101.41,+ORDLG,0)),U)
"RTN","ORB3TIM2",111,0)
 ....S ORDG=$P($G(^ORD(101.41,+ORDLG,0)),U,2)
"RTN","ORB3TIM2",112,0)
 ....I ORDLGNM="PSJ OR PAT OE"!(ORDLGNM="PSJI OR PAT FLUID OE") S FLAG=1
"RTN","ORB3TIM2",113,0)
 ....I 'FLAG F ORX="INPATIENT MEDICATIONS","IV MEDICATIONS","UNIT DOSE MEDICATIONS","CLINIC ORDERS","CLINIC INFUSIONS","CLINIC MEDICATIONS" I $$UPPER^ORU(ORDG)=ORX D
"RTN","ORB3TIM2",114,0)
 .....S FLAG=1
"RTN","ORB3TIM2",115,0)
 .....I ORX="IV MEDICATIONS",(+$$IVRENEW(EXORN)=0) S FLAG=0
"RTN","ORB3TIM2",116,0)
 .....I ORX="UNIT DOSE MEDICATIONS",(+$$UDRENEW(EXORN,EXDT)=0) S FLAG=0
"RTN","ORB3TIM2",117,0)
 ....I FLAG D EN^ORB3(72,ORPT,EXORN,"","",EXORN_"@")  ;trigger outpt notif
"RTN","ORB3TIM2",118,0)
 ...;
"RTN","ORB3TIM2",119,0)
 ...;quit if inpt/unit dose med and med is not renewable:
"RTN","ORB3TIM2",120,0)
 ...I RXORD="UNIT DOSE MEDICATIONS",(+$$UDRENEW(EXORN,EXDT)=0) Q
"RTN","ORB3TIM2",121,0)
 ...;
"RTN","ORB3TIM2",122,0)
 ...;quit if IV med and med is not renewable:
"RTN","ORB3TIM2",123,0)
 ...I RXORD="IV MEDICATIONS",(+$$IVRENEW(EXORN)=0) Q
"RTN","ORB3TIM2",124,0)
 ...;
"RTN","ORB3TIM2",125,0)
 ...D EN^ORB3(47,ORPT,EXORN,"","",EXORN_"@")  ;trigger notif
"RTN","ORB3TIM2",126,0)
 S ^XTMP("ORB LAST EXPIRE",0)=$$FMADD^XLFDT(ORNOW,7,"","","")_U_$$NOW^XLFDT
"RTN","ORB3TIM2",127,0)
 D EXCLN(ORNOW)
"RTN","ORB3TIM2",128,0)
 Q
"RTN","ORB3TIM2",129,0)
UDRENEW(EXORN,EXDT) ;extr function returns 1 if med is renewable, 0 if not
"RTN","ORB3TIM2",130,0)
 N ORNOW,ORSLT,ORSTATUS
"RTN","ORB3TIM2",131,0)
 S ORSLT=0
"RTN","ORB3TIM2",132,0)
 S ORSTATUS=$P($$STATUS^ORQOR2(EXORN),U,2)
"RTN","ORB3TIM2",133,0)
 I ORSTATUS="ACTIVE" Q 1  ;renewable if "active"
"RTN","ORB3TIM2",134,0)
 I ORSTATUS="HOLD" Q 1   ;renewable if "on hold"
"RTN","ORB3TIM2",135,0)
 I ORSTATUS="EXPIRED" D
"RTN","ORB3TIM2",136,0)
 .S ORNOW=$$NOW^XLFDT
"RTN","ORB3TIM2",137,0)
 .;renewable if expired w/in past 4 days:
"RTN","ORB3TIM2",138,0)
 .I $$FMDIFF^XLFDT(ORNOW,EXDT,1)<4 S ORSLT=1
"RTN","ORB3TIM2",139,0)
 Q ORSLT
"RTN","ORB3TIM2",140,0)
 ;
"RTN","ORB3TIM2",141,0)
IVRENEW(EXORN) ;extr function returns 1 if med is renewable, 0 if not
"RTN","ORB3TIM2",142,0)
 N ORSLT,ORSTATUS
"RTN","ORB3TIM2",143,0)
 S ORSLT=0
"RTN","ORB3TIM2",144,0)
 S ORSTATUS=$P($$STATUS^ORQOR2(EXORN),U,2)
"RTN","ORB3TIM2",145,0)
 I ORSTATUS="ACTIVE" Q 1   ;renewable if "active"
"RTN","ORB3TIM2",146,0)
 I ORSTATUS="HOLD" Q 1   ;renewable if "on hold"
"RTN","ORB3TIM2",147,0)
 I ORSTATUS="EXPIRED" Q 1  ;renewable if "expired"
"RTN","ORB3TIM2",148,0)
 Q ORSLT
"RTN","ORB3TIM2",149,0)
 ;
"RTN","ORB3TIM2",150,0)
EXCLN(ORNOW) ;clean up old entires in ^XTMP("ORB LAST EXPIRE")
"RTN","ORB3TIM2",151,0)
 N ORN,ORDT
"RTN","ORB3TIM2",152,0)
 S ORN=1
"RTN","ORB3TIM2",153,0)
 F  S ORN=$O(^XTMP("ORB LAST EXPIRE",ORN)) Q:ORN=""  D
"RTN","ORB3TIM2",154,0)
 .S ORDT=$G(^XTMP("ORB LAST EXPIRE",ORN))
"RTN","ORB3TIM2",155,0)
 .I $L(ORDT),(ORDT<ORNOW) D
"RTN","ORB3TIM2",156,0)
 ..K ^XTMP("ORB LAST EXPIRE",ORN)
"RTN","ORB3TIM2",157,0)
 Q
"RTN","ORBCMA5")
0^59^B8075398
"RTN","ORBCMA5",1,0)
ORBCMA5 ; SLC/JDL - BCMA Order utility ;07/25/14  14:23
"RTN","ORBCMA5",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**133,350**;Dec 17, 1997;Build 77
"RTN","ORBCMA5",3,0)
 ;;BCMA ORDER UTITLITY;**133**;12/12/2001
"RTN","ORBCMA5",4,0)
 ;
"RTN","ORBCMA5",5,0)
 ;
"RTN","ORBCMA5",6,0)
 ;
"RTN","ORBCMA5",7,0)
GETUDID(Y,INFO) ; Get Unit/Dose Order Form ID
"RTN","ORBCMA5",8,0)
 S Y=$O(^ORD(101.41,"B","PSJ OR PAT OE",0))
"RTN","ORBCMA5",9,0)
 S:$L(Y)<1 Y=0
"RTN","ORBCMA5",10,0)
 Q
"RTN","ORBCMA5",11,0)
GETIVID(Y,INFO) ; Get IV Order Form ID
"RTN","ORBCMA5",12,0)
 S Y=$O(^ORD(101.41,"B","PSJI OR PAT FLUID OE",0))
"RTN","ORBCMA5",13,0)
 S:$L(Y)<1 Y=0
"RTN","ORBCMA5",14,0)
 Q
"RTN","ORBCMA5",15,0)
GETUD(Y,ODITM) ; get unit dose orderable item
"RTN","ORBCMA5",16,0)
 ; ODITM: Orderable item ien
"RTN","ORBCMA5",17,0)
 N DGIDX,OIIEN,UDIEN
"RTN","ORBCMA5",18,0)
 S DGIDX=0
"RTN","ORBCMA5",19,0)
 S UDIEN=$O(^ORD(101.44,"B","ORWDSET UD RX",0))
"RTN","ORBCMA5",20,0)
 F  S DGIDX=$O(^ORD(101.44,UDIEN,20,DGIDX)) Q:'DGIDX  D
"RTN","ORBCMA5",21,0)
 . S OIIEN=$P(^ORD(101.44,UDIEN,20,DGIDX,0),U,1)
"RTN","ORBCMA5",22,0)
 . I OIIEN=ODITM S Y=^ORD(101.44,UDIEN,20,DGIDX,0)
"RTN","ORBCMA5",23,0)
 K DGIDX,OIIEN,UDIEN
"RTN","ORBCMA5",24,0)
 Q
"RTN","ORBCMA5",25,0)
ODITMBC(Y,XREF,ODLST) ; --Return orderable items info based on ItemIen
"RTN","ORBCMA5",26,0)
 N CNT,NUM,XRF
"RTN","ORBCMA5",27,0)
 S CNT=0,NUM=0,XRF=""
"RTN","ORBCMA5",28,0)
 S:$L(XREF) XRF=XREF
"RTN","ORBCMA5",29,0)
 F  S CNT=$O(ODLST(CNT)) Q:'CNT  D FNDINFO(.Y,ODLST(CNT))
"RTN","ORBCMA5",30,0)
 Q
"RTN","ORBCMA5",31,0)
FNDINFO(Y,ODIEN) ;
"RTN","ORBCMA5",32,0)
 N ODI,CRTM,FRM,XX,FINDIT
"RTN","ORBCMA5",33,0)
 S XX="",FINDIT=0
"RTN","ORBCMA5",34,0)
 S FRM="",CRTM=$$NOW^XLFDT
"RTN","ORBCMA5",35,0)
 F  S FRM=$O(^ORD(101.43,XRF,FRM)) Q:FRM=""  D
"RTN","ORBCMA5",36,0)
 . S ODI=0 F  S ODI=$O(^ORD(101.43,XRF,FRM,ODI)) Q:'ODI  D
"RTN","ORBCMA5",37,0)
 .. S XX=^ORD(101.43,XRF,FRM,ODI)
"RTN","ORBCMA5",38,0)
 .. I +$P(XX,U,3),$P(XX,U,3)<CRTM Q
"RTN","ORBCMA5",39,0)
 .. I ODI=+ODIEN D
"RTN","ORBCMA5",40,0)
 ... S NUM=NUM+1,FINDIT=1
"RTN","ORBCMA5",41,0)
 ... I 'XX S Y(NUM)=ODIEN_U_$P(XX,U,2)_U_$P(XX,U,2)
"RTN","ORBCMA5",42,0)
 ... E  S Y(NUM)=ODIEN_U_$P(XX,U,2)_$C(9)_"<"_$P(XX,U,4)_">"_U_$P(XX,U,4)
"RTN","ORBCMA5",43,0)
 I FINDIT=0 D
"RTN","ORBCMA5",44,0)
 . S:$D(^ORD(101.43,+ODIEN,0)) XX=^ORD(101.43,+ODIEN,0)
"RTN","ORBCMA5",45,0)
 . S NUM=NUM+1
"RTN","ORBCMA5",46,0)
 . S:$L(XX) Y(NUM)=ODIEN_U_$P(XX,U)_U_$P(XX,U)_U_"NF"
"RTN","ORBCMA5",47,0)
 Q
"RTN","ORBCMA5",48,0)
LOCK(ORY,DFN,ORJOB) ; -- Lock patient chart (silent)
"RTN","ORBCMA5",49,0)
 ; Returns 1 if successful, or 0^Message if could not get lock
"RTN","ORBCMA5",50,0)
 ;
"RTN","ORBCMA5",51,0)
 I '$G(DFN) S ORY="0^Invalid patient" Q
"RTN","ORBCMA5",52,0)
 I $G(ORJOB)="" S ORY="0^Invalid Job" Q
"RTN","ORBCMA5",53,0)
 N Y,ORLK,NOW,NOW1
"RTN","ORBCMA5",54,0)
 S ORLK=$G(^XTMP("ORPTLK-"_DFN,1)) I ORLK=(DUZ_U_ORJOB) S ORY=1 Q  ;locked
"RTN","ORBCMA5",55,0)
 L +^XTMP("ORPTLK-"_DFN):$S($G(DILOCKTM)>0:DILOCKTM,1:5) I '$T S Y="0^"_$S(+ORLK:$P($G(^VA(200,+ORLK,0)),U),1:"Another person")_" is editing orders for this patient." Q Y
"RTN","ORBCMA5",56,0)
 S NOW=$$NOW^XLFDT,NOW1=$$FMADD^XLFDT(NOW,1)
"RTN","ORBCMA5",57,0)
 S ^XTMP("ORPTLK-"_DFN,0)=NOW1_U_NOW_"^CPRS Chart Lock",^(1)=DUZ_U_ORJOB
"RTN","ORBCMA5",58,0)
 S ORY=1 Q
"RTN","ORBCMA5",59,0)
 ;
"RTN","ORBCMA5",60,0)
UNLOCK(ORY,DFN,ORJOB) ; -- Unlock patient chart (silent)
"RTN","ORBCMA5",61,0)
 I '$G(DFN) S ORY=0 Q
"RTN","ORBCMA5",62,0)
 I $G(ORJOB)="" W ORY=0 Q
"RTN","ORBCMA5",63,0)
 L -^XTMP("ORPTLK-"_DFN)
"RTN","ORBCMA5",64,0)
 I $G(^XTMP("ORPTLK-"_DFN,1))=(DUZ_U_ORJOB) K ^XTMP("ORPTLK-"_DFN)
"RTN","ORBCMA5",65,0)
 S ORY=1 Q
"RTN","ORBCMA5",66,0)
 ;
"RTN","ORBCMA5",67,0)
JOB(ORY) ;return $J
"RTN","ORBCMA5",68,0)
 S ORY=$J Q
"RTN","ORCACT0")
0^46^B64590852
"RTN","ORCACT0",1,0)
ORCACT0 ;SLC/MKB-Validate order action ;03/19/15  19:46
"RTN","ORCACT0",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**7,27,48,72,86,92,94,141,165,177,173,190,215,243,289,204,306,350**;Dec 17, 1997;Build 77
"RTN","ORCACT0",3,0)
 ;
"RTN","ORCACT0",4,0)
 ;Reference to REFILL^PSOREF supported by IA #2399
"RTN","ORCACT0",5,0)
 ;
"RTN","ORCACT0",6,0)
VALID(IFN,ACTION,ERROR,NATR) ; -- Determines if action is valid for order IFN
"RTN","ORCACT0",7,0)
 N OR0,OR3,ORA0,AIFN,PKG,DG,ORDSTS,ACTSTS,VER,X,Y,MEDPARM,CSORD,ORDLG,ORENVIR K ERROR
"RTN","ORCACT0",8,0)
 S OR0=$G(^OR(100,+IFN,0)),OR3=$G(^(3)),PKG=$$NMSP^ORCD($P(OR0,U,14))
"RTN","ORCACT0",9,0)
 S ORENVIR=$S('$D(XQY0):"",$P(XQY0,U)="OR CPRS GUI CHART":"GUI",1:"")
"RTN","ORCACT0",10,0)
 I $G(ORENVIR)'="GUI"&(ACTION="ES") D  G VQ
"RTN","ORCACT0",11,0)
 . S CSORD="" D CSVALUE^ORDEA(.CSORD,+IFN)
"RTN","ORCACT0",12,0)
 . S ORDLG=$S($P(OR0,U,5)["101.41":$P($G(^ORD(101.41,+$P(OR0,U,5),0)),U),1:"")
"RTN","ORCACT0",13,0)
 . I CSORD&(ORDLG="PSO OERR") D
"RTN","ORCACT0",14,0)
 . . S ERROR="Outpatient controlled substance order(s) cannot be signed in VistA due to"_$C(13,10)
"RTN","ORCACT0",15,0)
 . . S ERROR=ERROR_"     DEA rules! Please sign your order(s) from the CPRS GUI."
"RTN","ORCACT0",16,0)
 . . Q
"RTN","ORCACT0",17,0)
 S DG=$P($G(^ORD(100.98,+$P(OR0,U,11),0)),U,3)
"RTN","ORCACT0",18,0)
 S MEDPARM=$S($G(NATR)="A":2,PKG'="PS":2,'$D(^XUSEC("OREMAS",DUZ)):2,DG="NV RX":$$GET^XPAR("ALL","OR OREMAS NON-VA MED ORDERS"),1:$$GET^XPAR("ALL","OR OREMAS MED ORDERS"))
"RTN","ORCACT0",19,0)
 S AIFN=$P(IFN,";",2) S:'AIFN AIFN=+$P(OR3,U,7)
"RTN","ORCACT0",20,0)
 S ORA0=$G(^OR(100,+IFN,8,AIFN,0)),ACTSTS=$P(ORA0,U,15)
"RTN","ORCACT0",21,0)
 S ORDSTS=$P(OR3,U,3),VER=$S($P(OR0,U,5)["101.41":3,1:2)
"RTN","ORCACT0",22,0)
CM I ACTION="CM" S ERROR="This action is no longer available!" G VQ ; ward comments - no restrictions
"RTN","ORCACT0",23,0)
FL I ACTION="FL" D  G VQ ; flag
"RTN","ORCACT0",24,0)
 . I +$G(^OR(100,+IFN,8,AIFN,3)) S ERROR="This order is already flagged!" Q
"RTN","ORCACT0",25,0)
UF I ACTION="UF" D  G VQ ; unflag
"RTN","ORCACT0",26,0)
 . I '+$G(^OR(100,+IFN,8,AIFN,3)) S ERROR="This order is not flagged!" Q
"RTN","ORCACT0",27,0)
DC1 I ACTION="DC",ACTSTS D  G VQ ; discontinue/cancel unrel or canc order
"RTN","ORCACT0",28,0)
 . I (ACTSTS=11)!(ACTSTS=10) D  Q  ; unreleased
"RTN","ORCACT0",29,0)
 .. I 'MEDPARM S ERROR="You are not authorized to cancel med orders!" Q
"RTN","ORCACT0",30,0)
 .. I $G(NATR)="A" S X=$O(^ORE(100.2,"AO",+IFN,0)) I X,'$G(^ORE(100.2,X,1)) S ERROR="Future event orders may not be auto-discontinued!" Q
"RTN","ORCACT0",31,0)
 . I ACTSTS=12 S ERROR="This order has been dc'd due to edit!" Q
"RTN","ORCACT0",32,0)
 . I ACTSTS=13 S ERROR="This order has been cancelled!" Q
"RTN","ORCACT0",33,0)
ES I (ACTION="ES")!(ACTION="OC")!(ACTION="RS")!(ACTION="DS") D ES^ORCACT01 G VQ ; sign
"RTN","ORCACT0",34,0)
VR I ACTION="VR" D  G VQ ; verify
"RTN","ORCACT0",35,0)
 . I $G(ORVER)="N",$P(ORA0,U,9) S ERROR="This order has been verified!" Q
"RTN","ORCACT0",36,0)
 . I $G(ORVER)="C",$P(ORA0,U,11) S ERROR="This order has been verified!" Q
"RTN","ORCACT0",37,0)
 . I $G(ORVER)="R",$P(ORA0,U,19) S ERROR="This order has been reviewed!" Q
"RTN","ORCACT0",38,0)
 . I (ACTSTS=11)!(ACTSTS=10) S ERROR="This order has not been released to the service." Q
"RTN","ORCACT0",39,0)
 . I AIFN=1,ORDSTS=5,PKG="PS" S X=$$DISABLED I X S ERROR=$P(X,U,2) Q
"RTN","ORCACT0",40,0)
DIS S X=$$DISABLED I X S ERROR=$P(X,U,2) G VQ
"RTN","ORCACT0",41,0)
MN I ACTION="MN" D  G VQ ; manually release (delayed)
"RTN","ORCACT0",42,0)
 . I ACTSTS'=10,ACTSTS'=11 S ERROR="This order has already been released!" Q
"RTN","ORCACT0",43,0)
 . I $P(OR0,U,12)="I",'$G(^DPT(+ORVP,.105)) S ERROR="This patient is not currently admitted!"
"RTN","ORCACT0",44,0)
GMRA I PKG="GMRA" S ERROR="This action is not allowed on an allergy/adverse reaction!" G VQ ; no actions allowed on Allergies
"RTN","ORCACT0",45,0)
MEDS I PKG="PS",'MEDPARM S ERROR="You are not authorized to enter med orders!" G VQ
"RTN","ORCACT0",46,0)
RW I ACTION="RW" D RW^ORCACT01 G VQ ; rewrite/copy
"RTN","ORCACT0",47,0)
XFR I ACTION="XFR" D  G VQ
"RTN","ORCACT0",48,0)
 . N A
"RTN","ORCACT0",49,0)
 . S A=""
"RTN","ORCACT0",50,0)
 . F  S A=$O(^OR(100,+IFN,4.5,"ID","CONJ",A)) Q:'A  I ^OR(100,+IFN,4.5,A,1)="X" S ERROR="Orders with a conjunction of 'EXCEPT' may not be transferred." Q
"RTN","ORCACT0",51,0)
 . F  S A=$O(^OR(100,+IFN,4.5,"ID","CONJ",A)) Q:'A  I ^OR(100,+IFN,4.5,A,1)="T" S ERROR="Orders with a conjunction of 'THEN' may not be transferred." Q
"RTN","ORCACT0",52,0)
 . I $G(ERROR)]"" Q
"RTN","ORCACT0",53,0)
 . D XFR^ORCACT01 ; transfer to in/outpt
"RTN","ORCACT0",54,0)
RN I ACTION="RN" D RN^ORCACT01 G VQ ; renew
"RTN","ORCACT0",55,0)
TRM I $$DONE G VQ ; ORDSTS=1,2,7,12,13
"RTN","ORCACT0",56,0)
EV I ACTION="EV" D  G VQ ; change delay event
"RTN","ORCACT0",57,0)
 . I ORDSTS'=10,ORDSTS'=11 S ERROR="This order has been released!" Q
"RTN","ORCACT0",58,0)
 . I DG="NV RX" S ERROR="Non-VA Med orders do not support this action!" Q
"RTN","ORCACT0",59,0)
 . I $$EVTORDER^OREVNTX(IFN) S ERROR="The release event for this order may not be changed!" Q
"RTN","ORCACT0",60,0)
 . S X=$P(ORA0,U,4) I X'=2,X'=3 S ERROR="Signed orders may not be delayed to another event!" Q
"RTN","ORCACT0",61,0)
DC2 I ACTION="DC",ACTSTS="" D  G VQ ; DC released order
"RTN","ORCACT0",62,0)
 . I $G(NATR)="A" D  Q:$D(ERROR)
"RTN","ORCACT0",63,0)
 .. S X=$O(^ORE(100.2,"AO",+IFN,0)) I X S:'$G(^ORE(100.2,X,1)) ERROR="Future event orders may not be auto-discontinued!" Q
"RTN","ORCACT0",64,0)
 .. I $$GET1^DIQ(9.4,+$P(OR0,U,14)_",",1)="PSO",$G(DGPMT)=1 Q  ;177 If admission auto-dc and order is outpt med then no further checking needed
"RTN","ORCACT0",65,0)
 .. I $G(DGPMT)=1,$P($G(^SC(+$P(OR0,U,10),0)),U,3)'="C" S ERROR="Only outpatient orders may be auto-discontinued!" Q
"RTN","ORCACT0",66,0)
 .. I $G(DGPMT)'=1,$P($G(^SC(+$P(OR0,U,10),0)),U,3)="C",PKG'="PS" S ERROR="Only inpatient orders may be auto-discontinued!" Q
"RTN","ORCACT0",67,0)
 . I PKG="RA",ORDSTS=6 S ERROR="Active Radiology orders cannot be discontinued!" Q
"RTN","ORCACT0",68,0)
 . I PKG="VBEC",ORDSTS=6 S ERROR="Active Blood Product orders cannot be discontinued!" Q
"RTN","ORCACT0",69,0)
 . I PKG="LR" D  Q
"RTN","ORCACT0",70,0)
 .. I $$COLLECTD S ERROR="Lab orders that have been collected may not be discontinued!" Q
"RTN","ORCACT0",71,0)
 .. I $G(NATR)="A","^12^38^"'[(U_$P($G(DGPMA),U,18)_U),$$VALUE^ORX8(+IFN,"COLLECT")="SP",$P(OR0,U,8)'<DT S ERROR="Future Send Patient orders may not be auto-discontinued!" Q
"RTN","ORCACT0",72,0)
 . I PKG="GMRC",ORDSTS=9 S ERROR="Consults orders with partial results cannot be discontinued!" Q
"RTN","ORCACT0",73,0)
 . I DG="DO",$G(DGPMT)'=3,ORDSTS=6,'$$NPO(+IFN) S ERROR="Active Diets cannot be discontinued; please order a new diet!" Q
"RTN","ORCACT0",74,0)
RL I ACTION="RL" D  G VQ  ; release hold
"RTN","ORCACT0",75,0)
 . I ORDSTS'=3 D  Q
"RTN","ORCACT0",76,0)
 ..I $P(ORA0,U,4)=2 S ERROR="Providers has not yet signed the hold order and therefor it cannot yet be released" Q
"RTN","ORCACT0",77,0)
 ..S ERROR="Orders not on hold cannot be released!" Q
"RTN","ORCACT0",78,0)
 . I ACTSTS S ERROR=$$ACTION($P(ORA0,U,2))_" orders cannot be released from hold!" Q
"RTN","ORCACT0",79,0)
 . N NATR,ACT S ACT=$S($P(ORA0,U,2)="HD":AIFN,1:+$P(OR3,U,7))
"RTN","ORCACT0",80,0)
 . S NATR=+$P($G(^OR(100,+IFN,8,ACT,0)),U,12),ACT=$P($G(^(0)),U,2)
"RTN","ORCACT0",81,0)
 . I PKG="RA"!(ACT'="HD")!($P($G(^ORD(100.02,NATR,0)),U,2)="S") S ERROR="Orders held by a service must be released from hold through the service!" Q
"RTN","ORCACT0",82,0)
AIFN S X=$P(ORA0,U,2) I AIFN>1,ACTSTS S ERROR="This action is not allowed on a "_$$ACTION(X)_" order!" G VQ
"RTN","ORCACT0",83,0)
RF I ACTION="RF" D  G VQ
"RTN","ORCACT0",84,0)
 . I DG'="O RX",DG'="SPLY" S ERROR="Only Outpatient Med and Supply orders may be refilled!" Q
"RTN","ORCACT0",85,0)
 . I ORDSTS=5 S ERROR="Pending orders may not be refilled!" Q
"RTN","ORCACT0",86,0)
 . I ORDSTS=7 S ERROR="Expired orders may not be refilled!" Q
"RTN","ORCACT0",87,0)
 . N X,PSIFN S PSIFN=$G(^OR(100,+IFN,4))
"RTN","ORCACT0",88,0)
 . S X=$$REFILL^PSOREF(PSIFN) I X'>0 S ERROR=$P(X,U,2) Q
"RTN","ORCACT0",89,0)
CP I ACTION="CP" D  G VQ ; complete
"RTN","ORCACT0",90,0)
 . I PKG'="OR" S ERROR="Only generic text orders may be completed through this option!" Q
"RTN","ORCACT0",91,0)
 . I ORDSTS=11!(ORDSTS=10) S ERROR="This order has not been released!" Q
"RTN","ORCACT0",92,0)
AL I ACTION="AL" D  G VQ
"RTN","ORCACT0",93,0)
 . I PKG'="LR",PKG'="RA",PKG'="GMRC" S ERROR="This order does not generate results!" Q
"RTN","ORCACT0",94,0)
 . I $P(OR3,U,10) S ERROR="This order is already flagged to alert the provider when resulted!" Q
"RTN","ORCACT0",95,0)
XX I ACTION="XX" D  G VQ ; edit/change
"RTN","ORCACT0",96,0)
 . I ORDSTS=7 S ERROR="Expired orders may not be changed!" Q
"RTN","ORCACT0",97,0)
 . D XX^ORCACT01
"RTN","ORCACT0",98,0)
HD I ACTION="HD" D  G VQ ; hold
"RTN","ORCACT0",99,0)
 . I PKG="FH" S ERROR="Diet orders cannot be held!" Q
"RTN","ORCACT0",100,0)
 . I PKG="LR" S ERROR="Lab orders cannot be held!" Q
"RTN","ORCACT0",101,0)
 . I PKG="RA" S ERROR="Radiology orders cannot be held!" Q
"RTN","ORCACT0",102,0)
 . I PKG="GMRC" S ERROR="Consult orders cannot be held!" Q
"RTN","ORCACT0",103,0)
 . I DG="NV RX" S ERROR="Non-VA Med orders cannot be held!" Q
"RTN","ORCACT0",104,0)
 . I ORDSTS=3 S ERROR="This order is already on hold!" Q
"RTN","ORCACT0",105,0)
 . I ORDSTS'=6,PKG="PS" S ERROR="Only active Pharmacy orders may be held!" Q
"RTN","ORCACT0",106,0)
 . I (ORDSTS=11)!(ORDSTS=10) S ERROR="This order has not been released to the service." Q
"RTN","ORCACT0",107,0)
VQ S Y=$S($D(ERROR):0,1:1)
"RTN","ORCACT0",108,0)
 Q Y
"RTN","ORCACT0",109,0)
 ;
"RTN","ORCACT0",110,0)
ACTION(X) ; -- Return text of action X
"RTN","ORCACT0",111,0)
 N Y S Y=$S(X="NW":"New",X="DC":"Discontinue",X="HD":"Hold",X="RL":"Release Hold",X="RN":"Renew",1:X)
"RTN","ORCACT0",112,0)
 Q Y
"RTN","ORCACT0",113,0)
 ;
"RTN","ORCACT0",114,0)
NPO(ORIFN) ; -- Returns 1 or 0, if order ORIFN is for NPO
"RTN","ORCACT0",115,0)
 N X,Y S X=$$VALUE^ORX8(+ORIFN,"ORDERABLE",1,"E")
"RTN","ORCACT0",116,0)
 S Y=$S($E(X,1,3)="NPO":1,1:0)
"RTN","ORCACT0",117,0)
 Q Y
"RTN","ORCACT0",118,0)
 ;
"RTN","ORCACT0",119,0)
COLLECTD() ; -- Lab order collected/active (incl all children)?
"RTN","ORCACT0",120,0)
 I (ORDSTS=11)!(ORDSTS=10) Q 0 ; unreleased
"RTN","ORCACT0",121,0)
 I '$O(^OR(100,+IFN,2,0)) Q (ORDSTS'=5)
"RTN","ORCACT0",122,0)
 ;I ORDSTS'=6 Q 1 ; Parent -> active instead of pending
"RTN","ORCACT0",123,0)
 N Y,Z S Y=1,Z=0
"RTN","ORCACT0",124,0)
 F  S Z=$O(^OR(100,+IFN,2,Z)) Q:Z'>0  I $P($G(^OR(100,Z,3)),U,3)=5 S Y=0 Q
"RTN","ORCACT0",125,0)
 Q Y
"RTN","ORCACT0",126,0)
 ;
"RTN","ORCACT0",127,0)
DONE() ; -- sets ERROR if terminal status
"RTN","ORCACT0",128,0)
 I ORDSTS=1 S ERROR="This order has been discontinued!" Q 1
"RTN","ORCACT0",129,0)
 I ORDSTS=2 S ERROR="This order has been completed!" Q 1
"RTN","ORCACT0",130,0)
 I ORDSTS=7,DG'="O RX" S ERROR="This order has expired!" Q 1
"RTN","ORCACT0",131,0)
 I ORDSTS=12 S ERROR="This order has been changed!" Q 1
"RTN","ORCACT0",132,0)
 I ORDSTS=13 S ERROR="This order has been cancelled!" Q 1
"RTN","ORCACT0",133,0)
 I ORDSTS=14 S ERROR="This order has lapsed!" Q 1
"RTN","ORCACT0",134,0)
 I ORDSTS=15 S ERROR="This order has been renewed!" Q 1
"RTN","ORCACT0",135,0)
 Q 0
"RTN","ORCACT0",136,0)
 ;
"RTN","ORCACT0",137,0)
DISABLED() ; -- Order dialog [or protocol] disabled?
"RTN","ORCACT0",138,0)
 N X,DLG S DLG=$P(OR0,U,5),X=0 I +DLG'>0 Q X
"RTN","ORCACT0",139,0)
 I VER'<3,DLG?1.N1";ORD(101.41," S X=$$MSG^ORXD(+DLG) Q X
"RTN","ORCACT0",140,0)
 S DLG=$S(PKG="RA":"RA OERR EXAM",PKG="GMRC":"GMRCOR CONSULT",1:"")
"RTN","ORCACT0",141,0)
 I $L(DLG) S DLG=+$O(^ORD(101.41,"AB",DLG,0)),X=$$MSG^ORXD(DLG)
"RTN","ORCACT0",142,0)
 Q X
"RTN","ORCACT01")
0^72^B77384512
"RTN","ORCACT01",1,0)
ORCACT01 ;SLC/MKB-Validate order actions cont ;05/21/15  11:14
"RTN","ORCACT01",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**94,116,134,141,163,187,190,213,243,306,374,350**;Dec 17, 1997;Build 77
"RTN","ORCACT01",3,0)
 ;
"RTN","ORCACT01",4,0)
 ;
"RTN","ORCACT01",5,0)
ES ; -- sign [on chart]
"RTN","ORCACT01",6,0)
 I ORDSTS=11,VER<3,PKG'="OR" S ERROR="This order cannot be released and must be discontinued!" Q
"RTN","ORCACT01",7,0)
 N X I ACTSTS=11!(ACTSTS=10) D  Q:$L($G(ERROR))
"RTN","ORCACT01",8,0)
 . I $P(ORA0,U,2)="DC",$$DONE^ORCACT0 D CANCEL^ORCSEND(+IFN),UNOTIF^ORCSIGN S OREBUILD=1 Q
"RTN","ORCACT01",9,0)
 . S X=$$DISABLED^ORCACT0 I X S ERROR=$P(X,U,2) Q
"RTN","ORCACT01",10,0)
 I ACTION="OC",$G(DG)="NV RX" S:MEDPARM<2 ERROR="You are not authorized to release non-VA med orders!" Q
"RTN","ORCACT01",11,0)
 S X=$P(ORA0,U,4) I X=3 S:ACTSTS'=11&(ACTSTS'=10) ERROR="This order does not require a signature!" Q
"RTN","ORCACT01",12,0)
 I X'=2 S ERROR="This order has been signed!" Q
"RTN","ORCACT01",13,0)
 N ORCS D CSVALUE^ORDEA(.ORCS,+IFN)
"RTN","ORCACT01",14,0)
 I DG="O RX",ACTION="RS",$G(NATR)="I",ORCS=1 S ERROR="Controlled Substance outpatient meds may not be released without a clinician's signature!" Q
"RTN","ORCACT01",15,0)
 I DG="O RX",ACTION'="ES",ACTION'="DS",$G(NATR)'="I" S ERROR="Outpatient meds may not be released without a clinician's signature!" Q
"RTN","ORCACT01",16,0)
 I (ACTION="ES"!(ACTION="DS")),$D(^XUSEC("ORELSE",DUZ)),$P(OR0,U,16)'<2 S ERROR="You are not privileged to sign this order!" Q
"RTN","ORCACT01",17,0)
 I ACTION="OC" S:MEDPARM<2 ERROR="You are not authorized to release med orders!" Q
"RTN","ORCACT01",18,0)
 I ACTION="RS" D  Q:$D(ERROR)  Q:$G(NATR)'="I"
"RTN","ORCACT01",19,0)
 . Q:ACTSTS=11  Q:ACTSTS=10  ;unreleased - ok
"RTN","ORCACT01",20,0)
 . S ERROR="This order has already been released!"
"RTN","ORCACT01",21,0)
ES1 I PKG="PS" D  ;authorized to write meds?
"RTN","ORCACT01",22,0)
 . N TYPE,OI,PSOI,DEAFLG,PKI,IVERROR,ORDGNM
"RTN","ORCACT01",23,0)
 . S X=$G(^VA(200,DUZ,"PS"))
"RTN","ORCACT01",24,0)
 . I DG'="SPLY",'$P(X,U) S ERROR="You are not authorized to sign med orders!" Q
"RTN","ORCACT01",25,0)
 . I DG'="SPLY",$P(X,U,4),$$NOW^XLFDT>$P(X,U,4) S ERROR="You are no longer authorized to sign med orders!" Q
"RTN","ORCACT01",26,0)
 . ;Q:DG="IV RX"  Q:$P(ORA0,U,2)="DC"  ;don't need to ck DEA#
"RTN","ORCACT01",27,0)
 . Q:$P(ORA0,U,2)="DC"
"RTN","ORCACT01",28,0)
 . S ORDGNM=$$GET1^DIQ(100,+IFN_",",2)
"RTN","ORCACT01",29,0)
 . I ORDGNM["FLUID OE" D  Q
"RTN","ORCACT01",30,0)
 . .S FAIL=$$IVDEACHK(+IFN) I FAIL'=0 S ERROR=FAIL
"RTN","ORCACT01",31,0)
 . S OI=+$$VALUE^ORX8(+IFN,"ORDERABLE")
"RTN","ORCACT01",32,0)
 . S PSOI=+$P($G(^ORD(101.43,OI,0)),U,2) Q:PSOI'>0
"RTN","ORCACT01",33,0)
 . S TYPE=$S($P(DG," ")="O":"O",1:"I"),DEAFLG=$P($$OIDEA^PSSOPKI(PSOI,TYPE),";",2)
"RTN","ORCACT01",34,0)
 . S DETFLAG=$$OIDETOX^PSSOPKI(PSOI,TYPE)
"RTN","ORCACT01",35,0)
 . S DETPRO=$$DETOX^XUSER(+$G(DUZ))
"RTN","ORCACT01",36,0)
 . I DETFLAG,DETPRO="" S ERROR=3 Q
"RTN","ORCACT01",37,0)
 . I DETFLAG,DETPRO>0 S Y=DETPRO X ^DD("DD") S ERROR="5^"_Y Q
"RTN","ORCACT01",38,0)
 . I (DEAFLG>0!($$ISCLOZ^ORALWORD(OI))) D  I $G(ERROR)]"" Q
"RTN","ORCACT01",39,0)
 .. N RET
"RTN","ORCACT01",40,0)
 .. I $$ISCLOZ^ORALWORD(OI) D  Q
"RTN","ORCACT01",41,0)
 ... S RET=$$DEA^XUSER(,DUZ) I RET="" S ERROR=1
"RTN","ORCACT01",42,0)
 .. S RET=$$SDEA^XUSER(,DUZ,DEAFLG)
"RTN","ORCACT01",43,0)
 .. I RET=1 S ERROR=1 Q
"RTN","ORCACT01",44,0)
 .. I RET=2 S ERROR="2^"_$$UP^XLFSTR(DEAFLG) Q
"RTN","ORCACT01",45,0)
 .. I RET?1"4".E S ERROR=RET Q
"RTN","ORCACT01",46,0)
 .. I RET?1N.E S ERROR=RET
"RTN","ORCACT01",47,0)
 . D PKISITE^ORWOR(.PKI)
"RTN","ORCACT01",48,0)
 . I $G(PKI),ACTION="RS",DEAFLG=1 S ERROR="This order cannot be released without a Digital Signature" Q
"RTN","ORCACT01",49,0)
 Q
"RTN","ORCACT01",50,0)
 ;
"RTN","ORCACT01",51,0)
IVDEACHK(IFN) ; -- Returns value of prompt by ID
"RTN","ORCACT01",52,0)
 I '$G(IFN)!('$D(^OR(100,+$G(IFN),0))) Q ""
"RTN","ORCACT01",53,0)
 N I,DIAL,DIALTYP,FAIL,PATCLASS,RESULT,Y
"RTN","ORCACT01",54,0)
 S PATCLASS=$P(^OR(100,+IFN,0),U,12)
"RTN","ORCACT01",55,0)
 S RESULT=0
"RTN","ORCACT01",56,0)
 ;if ORNP is not set then assume this is called from VistA not CPRS
"RTN","ORCACT01",57,0)
 I $G(ORNP)="" S ORNP=DUZ
"RTN","ORCACT01",58,0)
 S I=0,Y="" S:'$G(INST) INST=1
"RTN","ORCACT01",59,0)
 F  S I=$O(^OR(100,+IFN,4.5,"ID","ORDERABLE",I)) Q:I'>0!(RESULT=1)  D
"RTN","ORCACT01",60,0)
 .S Y=$G(^OR(100,+IFN,4.5,I,1)) Q:Y'>0
"RTN","ORCACT01",61,0)
 .;S PSOI=+$P($G(^ORD(101.43,Y,0)),U,2) Q:PSOI'>0
"RTN","ORCACT01",62,0)
 .I PATCLASS="I" D  Q
"RTN","ORCACT01",63,0)
 ..D FAILDEA^ORWDPS1(.FAIL,Y,ORNP,"I") I FAIL'=0 S RESULT=FAIL
"RTN","ORCACT01",64,0)
 .S DIAL=+$P(^OR(100,+IFN,4.5,I,0),U,2)
"RTN","ORCACT01",65,0)
 .S DIALTYP=$S($P(^ORD(101.41,DIAL,0),U)["ADDITIVE":"A",1:"S")
"RTN","ORCACT01",66,0)
 .D FDEA1^ORWDPS1(.FAIL,Y,DIALTYP,ORNP)
"RTN","ORCACT01",67,0)
 .I FAIL'=0 S RESULT=FAIL
"RTN","ORCACT01",68,0)
 .;I $$OIDEA^PSSUTLA1(PSOI,"I")>0 S RESULT=1 Q
"RTN","ORCACT01",69,0)
 Q RESULT
"RTN","ORCACT01",70,0)
 ;
"RTN","ORCACT01",71,0)
XFR ; -- transfer to inpt/outpt [IFN=order to be transferred]
"RTN","ORCACT01",72,0)
 N OI,PS I DG="TPN" S ERROR="TPN orders may not be copied!" Q
"RTN","ORCACT01",73,0)
 I $$INACTIVE^ORCACT03 S ERROR="Orders for inactive orderables may not be transferred; please enter a new order!" Q
"RTN","ORCACT01",74,0)
 S OI=+$O(^OR(100,+IFN,.1,"B",0)),ORPS=$G(^ORD(101.43,OI,"PS"))
"RTN","ORCACT01",75,0)
 I DG="UD RX",'$P(ORPS,U,2) S ERROR="This drug may not be ordered for an outpatient!" Q
"RTN","ORCACT01",76,0)
 I DG="O RX" D  Q:$L($G(ERROR))
"RTN","ORCACT01",77,0)
 . I '$P(ORPS,U) S ERROR="This drug may not be ordered for an inpatient!" Q
"RTN","ORCACT01",78,0)
 . D:$O(^OR(100,+IFN,4.5,"ID","MISC",0)) DOSES^ORCACT02(+IFN)
"RTN","ORCACT01",79,0)
 Q
"RTN","ORCACT01",80,0)
 ;
"RTN","ORCACT01",81,0)
RW ; -- rewrite/copy
"RTN","ORCACT01",82,0)
 N ORISCL D ISCLORD^ORUTL(.ORISCL,+IFN)
"RTN","ORCACT01",83,0)
 I ORISCL S ERROR="Cannot copy Clinic Medication or Clinic Infusion orders!"
"RTN","ORCACT01",84,0)
 I ACTSTS=12 S ERROR="Orders that have been dc'd due to editing may not be copied!" Q
"RTN","ORCACT01",85,0)
 I DG="NV RX" S ERROR="Non-VA Med orders cannot be copied!" Q
"RTN","ORCACT01",86,0)
 I DG="TPN" S ERROR="TPN orders may not be rewritten!" Q
"RTN","ORCACT01",87,0)
 I DG="UD RX",$$NTBG^ORCACT03(+IFN) S ERROR="This order has been marked 'Not to be Given' and may not be rewritten!" Q
"RTN","ORCACT01",88,0)
 I $$INACTIVE^ORCACT03 S ERROR="Orders for inactive orderables may not be copied; please enter a new order!" Q
"RTN","ORCACT01",89,0)
 I PKG="PS",'$$MEDOK^ORCACT03 S ERROR="This drug may not be ordered!" Q
"RTN","ORCACT01",90,0)
 I DG="O RX",$O(^OR(100,+IFN,4.5,"ID","MISC",0)) D DOSES^ORCACT02(+IFN) ;old form
"RTN","ORCACT01",91,0)
 Q
"RTN","ORCACT01",92,0)
 ;
"RTN","ORCACT01",93,0)
RN ; -- renew
"RTN","ORCACT01",94,0)
 I PKG'="PS",PKG'="OR" S ERROR="This order may not be renewed!" Q
"RTN","ORCACT01",95,0)
 I (ORDSTS=11)!(ORDSTS=10) S ERROR="This order has not been released to the service." Q
"RTN","ORCACT01",96,0)
 I ACTSTS=12 S ERROR="Orders that have been dc'd due to editing may not be renewed!" Q
"RTN","ORCACT01",97,0)
 I $P(OR3,U,6) S ERROR="This order has already been "_$S($P($G(^OR(100,+$P(OR3,U,6),3)),U,11)=1:"changed!",1:"renewed!") Q
"RTN","ORCACT01",98,0)
 I PKG="OR" D  Q  ;Generic orders
"RTN","ORCACT01",99,0)
 . I $$INACTIVE^ORCACT03 S ERROR="Orders for inactive orderables may not be renewed!" Q
"RTN","ORCACT01",100,0)
 . I DG="ADT" S ERROR="M.A.S. orders may not be renewed!" Q
"RTN","ORCACT01",101,0)
 . I "^1^2^6^7^"[(U_ORDSTS_U) Q  ;ok
"RTN","ORCACT01",102,0)
 . S ERROR="This order may not be renewed!"
"RTN","ORCACT01",103,0)
 I (PKG="PS"),$$INACTIVE^ORCACT03 S ERROR="Orders for inactive orderables may not be renewed!" Q
"RTN","ORCACT01",104,0)
 I '$$MEDOK^ORCACT03 S ERROR="This drug may not be ordered!" Q
"RTN","ORCACT01",105,0)
RN1 N PSIFN S PSIFN=$G(^OR(100,+IFN,4))
"RTN","ORCACT01",106,0)
 I PSIFN<1,'$O(^OR(100,+IFN,2,0)) S ERROR="Missing or invalid order number!" Q
"RTN","ORCACT01",107,0)
 I DG="O RX" D  Q  ;Outpt Meds
"RTN","ORCACT01",108,0)
 . N ORZ,ORD S ORZ=$L($T(RENEW^PSORENW),",")
"RTN","ORCACT01",109,0)
 . I ORZ>1 S ORD=+$$VALUE^ORX8(+IFN,"DRUG"),X=$$RENEW^PSORENW(PSIFN,ORD)
"RTN","ORCACT01",110,0)
 . S:ORZ'>1 X=$$RENEW^PSORENW(PSIFN) I X<1 S ERROR=$P(X,U,2) Q
"RTN","ORCACT01",111,0)
 . S X=+$P(X,U,2) D:X RESET^ORCACT03(+IFN,X)
"RTN","ORCACT01",112,0)
 . I $O(^OR(100,+IFN,4.5,"ID","MISC",0)) D DOSES^ORCACT02(+IFN) ;old format
"RTN","ORCACT01",113,0)
 I DG="UD RX",$$NTBG^ORCACT03(+IFN) S ERROR="This order has been marked 'Not to be Given' and may not be renewed!" Q
"RTN","ORCACT01",114,0)
 I ORDSTS=7,'$$IV^ORCACT03,$P(OR0,U,9)<$$FMADD^XLFDT(DT,-4)  S ERROR="Inpatient med orders may not be renewed more than 4 days after expiration!" Q
"RTN","ORCACT01",115,0)
 I ORDSTS'=6,ORDSTS'=7 S ERROR="This order may not be renewed!" Q
"RTN","ORCACT01",116,0)
RN2 I $O(^OR(100,+IFN,2,0))!$P(OR3,U,9) D  Q:$D(ERROR)!'PSIFN
"RTN","ORCACT01",117,0)
 . I $P(OR3,U,9),$$VALUE^ORX8(+IFN,"SCHEDULE",1,"E")="NOW" S ERROR="One-time NOW orders may not be renewed!" Q
"RTN","ORCACT01",118,0)
 . N DAD,ORD3,I,Y S DAD=$S($P(OR3,U,9):+$P(OR3,U,9),1:+IFN),Y=0
"RTN","ORCACT01",119,0)
 . S ORD3=$G(^OR(100,DAD,3)) I $P(ORD3,U,6) S ERROR="This complex order has already been renewed!" Q
"RTN","ORCACT01",120,0)
 . I $P(ORD3,U,3)'=6 S ERROR="This complex order is not active and may not be renewed!" Q
"RTN","ORCACT01",121,0)
 . I '$$AND^ORX8(DAD) S ERROR="Complex orders with sequential doses may not be renewed!" Q
"RTN","ORCACT01",122,0)
 . S I=0 F  S I=+$O(^OR(100,DAD,2,I)) Q:I<1  D  Q:Y
"RTN","ORCACT01",123,0)
 .. I I=+$O(^OR(100,DAD,2,0)),$$VALUE^ORX8(I,"SCHEDULE",1,"E")="NOW",$$VALUE^ORX8(DAD,"NOW") Q  ;ignore NOW orders
"RTN","ORCACT01",124,0)
 .. I $P($G(^OR(100,I,3)),U,3)'=6 S Y=1,ERROR="Complex orders with terminated doses may not be renewed!" Q
"RTN","ORCACT01",125,0)
 .. I PSIFN<1 S X=$$ACTIVE^PSJORREN(+ORVP,$G(^OR(100,I,4))) I +X'=1 S ERROR="This order may not be renewed: "_$S(+X>1:"Inactive orderable item",1:$P(X,U,2)) Q
"RTN","ORCACT01",126,0)
 ;I DG="TPN" S ERROR="TPN orders may not be renewed!" Q
"RTN","ORCACT01",127,0)
 S X=$$ACTIVE^PSJORREN(+ORVP,PSIFN) Q:+X=1  ;Ok
"RTN","ORCACT01",128,0)
 I +X>1,$P(X,U,2) D RESET^ORCACT03(+IFN,+$P(X,U,2)) Q  ;replace OI
"RTN","ORCACT01",129,0)
 S ERROR="This order may not be renewed: "_$P(X,U,2)
"RTN","ORCACT01",130,0)
 Q
"RTN","ORCACT01",131,0)
 ;
"RTN","ORCACT01",132,0)
XX ; -- edit/change--
"RTN","ORCACT01",133,0)
 I PKG="RA",ORDSTS'=11,ORDSTS'=10 S ERROR="Orders released to Radiology cannot be changed!" Q
"RTN","ORCACT01",134,0)
 I PKG="LR",ORDSTS'=11,ORDSTS'=10 S ERROR="Orders released to Lab cannot be changed!" Q
"RTN","ORCACT01",135,0)
 I PKG="FH",ORDSTS'=11,ORDSTS'=10 S ERROR="Orders released to Dietetics cannot be changed!" Q
"RTN","ORCACT01",136,0)
 I PKG="GMRC",ORDSTS'=11,ORDSTS'=10 S ERROR="Orders released to Consults cannot be changed!" Q
"RTN","ORCACT01",137,0)
 I DG="TPN" S ERROR="TPN orders may not be changed!" Q
"RTN","ORCACT01",138,0)
 I ORDSTS=3 S ERROR="Orders on hold may not be changed!" Q
"RTN","ORCACT01",139,0)
 I DG="UD RX",$$NTBG^ORCACT03(+IFN) S ERROR="This order has been marked 'Not to be Given' and may not be changed!" Q
"RTN","ORCACT01",140,0)
 I $O(^OR(100,+IFN,2,0)) S ERROR="Complex orders may not be changed!" Q
"RTN","ORCACT01",141,0)
 I $P(OR3,U,9) D  Q:$D(ERROR)
"RTN","ORCACT01",142,0)
 . Q:$$VALUE^ORX8(+IFN,"SCHEDULE",1,"E")="NOW"  ;NOW ok
"RTN","ORCACT01",143,0)
 . Q:'$O(^OR(100,+$P(OR3,U,9),4.5,"ID","CONJ",0))  ;no conj=1dose/ok
"RTN","ORCACT01",144,0)
 . S ERROR="Complex orders may not be changed!" Q
"RTN","ORCACT01",145,0)
 I $P(OR3,U,6) S ERROR="This order may not be changed - a "_$S($P($G(^OR(100,+$P(OR3,U,6),3)),U,11)=1:"change",1:"renewal")_" order already exists!" Q
"RTN","ORCACT01",146,0)
 I $P(OR3,U,11)=2 D  Q:$D(ERROR)
"RTN","ORCACT01",147,0)
 . I (ORDSTS=10!(ORDSTS=11)),DG'="O RX" S ERROR="Unreleased renewals may not be changed!" Q
"RTN","ORCACT01",148,0)
 . I PKG="PS",ORDSTS=5 S ERROR="Pending renewals may not be changed!" Q
"RTN","ORCACT01",149,0)
 I $$INACTIVE^ORCACT03 S ERROR="Orders for inactive orderables may not be changed; please enter a new order!" Q
"RTN","ORCACT01",150,0)
 I PKG="PS",'$$MEDOK^ORCACT03 S ERROR="This drug may not be ordered!" Q
"RTN","ORCACT01",151,0)
 I DG="O RX",$O(^OR(100,+IFN,4.5,"ID","MISC",0)) D DOSES^ORCACT02(+IFN) ;old form
"RTN","ORCACT01",152,0)
 Q
"RTN","ORCACT01",153,0)
 ;
"RTN","ORCDFHTF")
0^82^B19437978
"RTN","ORCDFHTF",1,0)
ORCDFHTF ; SLC/MKB - Utility functions for FH Tubefeeding dialog ;04/24/15  18:18
"RTN","ORCDFHTF",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**7,141,215,350**;Dec 17, 1997;Build 77
"RTN","ORCDFHTF",3,0)
 ;
"RTN","ORCDFHTF",4,0)
 ;
"RTN","ORCDFHTF",5,0)
 ;
"RTN","ORCDFHTF",6,0)
EN ; -- entry action
"RTN","ORCDFHTF",7,0)
 S ORCAT=$S($$INPT^ORCD:"I",1:"O")
"RTN","ORCDFHTF",8,0)
 ;I '$$INPT^ORCD W $C(7),!!,"This patient is not an inpatient!" S ORQUIT=1 H 2 Q
"RTN","ORCDFHTF",9,0)
 ;D:'$G(OREVENT) EN^FHWOR8(+ORVP,.ORPARAM) I $G(OREVENT) D
"RTN","ORCDFHTF",10,0)
 ;. N X S X=$$LOC^OREVNTX(OREVENT)  Q:X<1
"RTN","ORCDFHTF",11,0)
 ;. S X=+$G(^SC(+X,42)) I X,$T(EN1^FHWOR8) D EN1^FHWOR8(X,.ORPARAM)
"RTN","ORCDFHTF",12,0)
 ;S:'$L($G(ORPARAM(3))) ORPARAM(3)="T" ; for now
"RTN","ORCDFHTF",13,0)
 ; -- show current TF order
"RTN","ORCDFHTF",14,0)
 N ORTF,ORTX,I S ORTF=$$CURRENT^ORCDFH("TF") Q:ORTF'>0
"RTN","ORCDFHTF",15,0)
 W !!,"An ACTIVE TUBEFEEDING ORDER exists for this patient:",!
"RTN","ORCDFHTF",16,0)
 D TEXT^ORQ12(.ORTX,ORTF,80) F I=1:1:ORTX W !,ORTX(I)
"RTN","ORCDFHTF",17,0)
 W !,"Total Quantity: "_$$TOTALQTY(ORTF)_" ml",!
"RTN","ORCDFHTF",18,0)
 Q
"RTN","ORCDFHTF",19,0)
 ;
"RTN","ORCDFHTF",20,0)
EX ; -- exit action
"RTN","ORCDFHTF",21,0)
 K ORPARAM,ORTIME,ORCAT
"RTN","ORCDFHTF",22,0)
 Q
"RTN","ORCDFHTF",23,0)
 ;
"RTN","ORCDFHTF",24,0)
QUANTITY ; -- Validation code for TF quantity
"RTN","ORCDFHTF",25,0)
 N X,ORQTY,I,TOT S X=ORDIALOG(PROMPT,ORI)
"RTN","ORCDFHTF",26,0)
 S ORQTY=$$VALIDQTY(X) I '$L(ORQTY) K DONE,ORDIALOG(PROMPT,ORI) Q
"RTN","ORCDFHTF",27,0)
 S ORDIALOG(PROMPT,ORI)=ORQTY
"RTN","ORCDFHTF",28,0)
 W "   (Amount: "_$$CC(ORI)_"ml)"
"RTN","ORCDFHTF",29,0)
 S (I,TOT)=0 F  S I=$O(ORDIALOG(PROMPT,I)) Q:I'>0  S TOT=TOT+$$CC(I)
"RTN","ORCDFHTF",30,0)
 I TOT>5000 W $C(7),!!,"WARNING: Total quantity ordered is "_TOT_"ml which exceeds the limit of 5000ml!",!
"RTN","ORCDFHTF",31,0)
 Q
"RTN","ORCDFHTF",32,0)
 ;
"RTN","ORCDFHTF",33,0)
VALIDQTY(X) ; -- Validates quantity X=amt units/freq X times
"RTN","ORCDFHTF",34,0)
 N X1,X2,AMT,N,UNITS,F,D,FREQ,DUR
"RTN","ORCDFHTF",35,0)
 S X=$$UP^XLFSTR(X),X=$$STRIP^XLFSTR(X," ") ; uppercase, no spaces
"RTN","ORCDFHTF",36,0)
 S AMT=+X,X1=$P(X,"/"),X2=$P(X,"/",2) Q:'AMT ""
"RTN","ORCDFHTF",37,0)
 S N=$P(X1,AMT,2),UNITS="" F X="^KCAL^K^","^ML^M^CC^C^","^OZ^O^","^UNITS^BOTTLES^CANS^PKG^U^","^TBSP^","^GM^GMS^GRAMS^G^" I X[(U_N_U) S UNITS=$P(X,U,2) Q
"RTN","ORCDFHTF",38,0)
 Q:'$L(UNITS) "" S F=$P(X2,"X"),D=$P(X2,"X",2) S:'$L(F) F="DAY"
"RTN","ORCDFHTF",39,0)
 S FREQ="" F X="^DAY^DAY","^QD^DAY^","^QH^HOUR^HR^","^BID^","^TID^","^QID^","^Q2H^","^Q3H^","^Q4H^","^Q6H^" I X[(U_F_U) S FREQ=$P(X,U,2) Q
"RTN","ORCDFHTF",40,0)
 Q:'$L(FREQ) "" S DUR="" S:D DUR=+D_$S(D'["F":"HR",1:"")
"RTN","ORCDFHTF",41,0)
 Q AMT_" "_UNITS_"/"_FREQ_$S(DUR:" X "_DUR,1:"")
"RTN","ORCDFHTF",42,0)
 ;
"RTN","ORCDFHTF",43,0)
CC(INST) ; -- Returns #cc ordered for INSTance
"RTN","ORCDFHTF",44,0)
 N X,X1,X2,DUR
"RTN","ORCDFHTF",45,0)
 S X=ORDIALOG($$PTR^ORCD("OR GTX INSTRUCTIONS"),INST)
"RTN","ORCDFHTF",46,0)
 S X1=ORDIALOG($$PTR^ORCD("OR GTX ORDERABLE ITEM"),INST)
"RTN","ORCDFHTF",47,0)
 S X1=+$P($G(^ORD(101.43,+X1,0)),U,2)_"-"_ORDIALOG($$PTR^ORCD("OR GTX STRENGTH FH"),INST),X2=+X_"&"_$E($P(X," ",2))_U_$P($P(X,"/",2)," "),DUR=$P(X," X ",2)
"RTN","ORCDFHTF",48,0)
 I $L(DUR) S DUR=$S(DUR["H":"H",1:"X")_+DUR,X2=X2_U_DUR
"RTN","ORCDFHTF",49,0)
 S X=$$QUAN^FHWOR5R(X1,X2)
"RTN","ORCDFHTF",50,0)
 Q X
"RTN","ORCDFHTF",51,0)
 ;
"RTN","ORCDFHTF",52,0)
QUANHELP ; -- ??-help for Quantity
"RTN","ORCDFHTF",53,0)
 W !!,"Units may be K for Kcals, M for ml, C for cc's, O For oz. or U for units (e.g. cans)."
"RTN","ORCDFHTF",54,0)
 W !,"Frequency may be DAY, HOUR, QD, QH, BID, TID, QID, Q2H, Q3H, Q4H, or Q6H."
"RTN","ORCDFHTF",55,0)
 W !,"May also input 100ML/HR X 16 for 16 hours.  Valid quantity for powder form"
"RTN","ORCDFHTF",56,0)
 W !,"product can be ""# GRAMS"" as 20 G, GRAMS, or GMS, or as 1 PKG or 1 U, and the"
"RTN","ORCDFHTF",57,0)
 W !,"frequency (e.g. 20 GRAMS/DAY or 1 PKG/TID)."
"RTN","ORCDFHTF",58,0)
 Q
"RTN","ORCDFHTF",59,0)
 ;
"RTN","ORCDFHTF",60,0)
TOTALQTY(ORDER) ; -- Returns total cc's for ORDER
"RTN","ORCDFHTF",61,0)
 N ORDIALOG,ORIT,ORTOTAL,ORI
"RTN","ORCDFHTF",62,0)
 S ORDIALOG=+$P($G(^OR(100,+ORDER,0)),U,5) D GETDLG1^ORCD(ORDIALOG)
"RTN","ORCDFHTF",63,0)
 S ORIT=$$PTR^ORCD("OR GTX ORDERABLE ITEM")
"RTN","ORCDFHTF",64,0)
 D GETORDER^ORCD(+ORDER) S (ORTOTAL,ORI)=0
"RTN","ORCDFHTF",65,0)
 F  S ORI=$O(ORDIALOG(ORIT,ORI)) Q:ORI'>0  S ORTOTAL=ORTOTAL+$$CC(ORI)
"RTN","ORCDFHTF",66,0)
 Q ORTOTAL
"RTN","ORCDFHTF",67,0)
 ;
"RTN","ORCDFHTF",68,0)
CANCEL ; -- Cancel active TF with new diet? [Called from FHW1 Exit Action]
"RTN","ORCDFHTF",69,0)
 N ORTF,ORTX,DIR,X,Y,ORDA,OREASON,ORNATR,I
"RTN","ORCDFHTF",70,0)
 S ORTF=$$CURRENT^ORCDFH("TF") Q:'ORTF  ;no active tubefeeding order
"RTN","ORCDFHTF",71,0)
 Q:$$FUTURE^ORCDFH("EFFECTIVE DATE/TIME")  ;future diet order
"RTN","ORCDFHTF",72,0)
 W !!,"An active tubefeeding order exists for this patient:"
"RTN","ORCDFHTF",73,0)
 D TEXT^ORQ12(.ORTX,+ORTF,80) F I=1:1:ORTX W !,ORTX(I)
"RTN","ORCDFHTF",74,0)
 S DIR(0)="YA",DIR("A")="Do you wish to cancel this order? "
"RTN","ORCDFHTF",75,0)
 S DIR("?")="Enter YES to place a DC order for this tubefeeding"
"RTN","ORCDFHTF",76,0)
 W ! D ^DIR Q:Y'=1  ;quit if not YES
"RTN","ORCDFHTF",77,0)
 S ORDA=$$ACTION^ORCSAVE("DC",ORTF,ORNP),^TMP("ORNEW",$J,ORTF,ORDA)=""
"RTN","ORCDFHTF",78,0)
 S OREASON=+$O(^ORD(100.03,"C","ORREQ",0)),ORNATR=$S(ORNP=DUZ:"E",1:"W")
"RTN","ORCDFHTF",79,0)
 D SET^ORCACT2(+ORTF,ORNATR,OREASON) ;set ^(6) node
"RTN","ORCDFHTF",80,0)
 Q
"RTN","ORCDFHTF",81,0)
 ;
"RTN","ORCDFHTF",82,0)
DATES ; -- get existing outpatient meal dates
"RTN","ORCDFHTF",83,0)
 Q:$G(ORDIALOG(PROMPT,"LIST"))  D EN2^FHWOR8(+$G(ORVP),"",.ORDT)
"RTN","ORCDFHTF",84,0)
 N I,CNT,X,Y S (I,CNT)=0 F  S I=$O(ORDT(I)) Q:I<1  D
"RTN","ORCDFHTF",85,0)
 . S X=+ORDT(I),Y=$$FMTE^XLFDT(X)
"RTN","ORCDFHTF",86,0)
 . Q:$G(ORDIALOG(PROMPT,"LIST","B",Y))  S CNT=CNT+1
"RTN","ORCDFHTF",87,0)
 . S ORDIALOG(PROMPT,"LIST",CNT)=X_U_Y,ORDIALOG(PROMPT,"LIST","B",Y)=X
"RTN","ORCDFHTF",88,0)
 S:CNT ORDIALOG(PROMPT,"LIST")=CNT_"^1"
"RTN","ORCDFHTF",89,0)
 Q
"RTN","ORCDLG1")
0^5^B84017168
"RTN","ORCDLG1",1,0)
ORCDLG1 ;SLC/MKB - ORDER DIALOGS CONT ;04/28/2015  08:19
"RTN","ORCDLG1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**60,71,95,110,243,350**;Dec 17, 1997;Build 77
"RTN","ORCDLG1",3,0)
 ;Per VA Directive 6402, this routine should not be modified.
"RTN","ORCDLG1",4,0)
EN(ITM,INST) ; -- ask each ITM prompt where
"RTN","ORCDLG1",5,0)
 ;    ORDIALOG(PROMPT,#) = internal form of each response
"RTN","ORCDLG1",6,0)
 ;
"RTN","ORCDLG1",7,0)
 N ITEM,COND,MULT,REQD,EDITONLY,DATATYPE,DOMAIN,DIR,Y,ACTION,PROMPT,ORX,VALIDEF
"RTN","ORCDLG1",8,0)
 S ITEM=$G(^ORD(101.41,+ORDIALOG,10,ITM,0)),COND=$G(^(3))
"RTN","ORCDLG1",9,0)
 S PROMPT=$P(ITEM,U,2) Q:'PROMPT  S:'$G(INST) INST=1
"RTN","ORCDLG1",10,0)
 S MULT=$P(ITEM,U,7),ACTION=$P(ITEM,U,9)
"RTN","ORCDLG1",11,0)
 S REQD=$P(ITEM,U,6),EDITONLY=$P(ITEM,U,8) S:$G(ORTYPE)="Z" (REQD,EDITONLY)=0
"RTN","ORCDLG1",12,0)
 I $D(^ORD(101.41,+ORDIALOG,10,ITM,9)) X ^(9) G:$G(ORQUIT) ENQ ;Entry
"RTN","ORCDLG1",13,0)
 I $G(ORTYPE)="Q",$D(ORDIALOG(PROMPT,INST)),$E(ORDIALOG(PROMPT,0))'="W" S EDITONLY=1
"RTN","ORCDLG1",14,0)
 I '$D(ORDIALOG(PROMPT,INST)) D  ; get default value
"RTN","ORCDLG1",15,0)
 . I $E(ORDIALOG(PROMPT,0))="W",$D(^ORD(101.41,+ORDIALOG,10,ITM,8))>9 M ^TMP("ORWORD",$J,PROMPT,INST)=^(8) S ORDIALOG(PROMPT,INST)="^TMP(""ORWORD"","_$J_","_PROMPT_","_INST_")" Q
"RTN","ORCDLG1",16,0)
 . K Y X:$D(^ORD(101.41,+ORDIALOG,10,ITM,7)) ^(7)
"RTN","ORCDLG1",17,0)
 . I $D(Y) S VALIDEF=$$VALID S:VALIDEF ORDIALOG(PROMPT,INST)=Y ;**95
"RTN","ORCDLG1",18,0)
 . I $G(VALIDEF)=0 W !,"The DEFAULT value for the ",$G(ORDIALOG(PROMPT,"A"))," prompt is invalid." S EDITONLY=0 ;**95
"RTN","ORCDLG1",19,0)
 . K VALIDEF ;**95
"RTN","ORCDLG1",20,0)
 I $G(AUTO),'REQD!($E(ORDIALOG(PROMPT,0))="W"&$D(ORDIALOG(PROMPT,INST))) S EDITONLY=1 ;Auto-accept
"RTN","ORCDLG1",21,0)
EN0 I FIRST&EDITONLY D:$D(ORDIALOG(PROMPT,INST))  G ENQ  ;ck child prompts
"RTN","ORCDLG1",22,0)
 . Q:'$D(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT))  N SEQ,DA,ITEM,PRMT,X,Y,VALIDEF ;**95
"RTN","ORCDLG1",23,0)
 . S SEQ=0 F  S SEQ=$O(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT,SEQ)) Q:SEQ'>0  S DA=$O(^(SEQ,0)) D  Q:$G(ORQUIT)
"RTN","ORCDLG1",24,0)
 . . K VALIDEF ;110
"RTN","ORCDLG1",25,0)
 . . S ITEM=$G(^ORD(101.41,+ORDIALOG,10,DA,0)),PRMT=$P(ITEM,U,2)
"RTN","ORCDLG1",26,0)
 . . Q:$D(ORDIALOG(PRMT,INST))  ; already has a value
"RTN","ORCDLG1",27,0)
 . . K Y X:$D(^ORD(101.41,+ORDIALOG,10,DA,7)) ^(7)
"RTN","ORCDLG1",28,0)
 . . I $D(Y) S VALIDEF=$$VALID ;**95
"RTN","ORCDLG1",29,0)
 . . I $G(VALIDEF)!('$P(ITEM,U,6)) S:$G(VALIDEF) ORDIALOG(PRMT,INST)=Y Q  ;**95
"RTN","ORCDLG1",30,0)
 . . D EN(DA,INST) ; ask
"RTN","ORCDLG1",31,0)
 I ($G(OREDIT)&(ACTION'["C"))!($G(ORENEW)&(ACTION'["R")) G ENQ ;ask?
"RTN","ORCDLG1",32,0)
 I $G(OREWRITE),ACTION'["W",FIRST,'REQD!$D(ORDIALOG(PROMPT,INST)) G ENQ
"RTN","ORCDLG1",33,0)
 I $L(COND) X COND G:'$T ENQ ; failed condition
"RTN","ORCDLG1",34,0)
 M DIR=ORDIALOG(PROMPT) S DATATYPE=$E(DIR(0)),DOMAIN=$P(DIR(0),U,2)
"RTN","ORCDLG1",35,0)
 I 'MULT D WP^ORCDLG2:DATATYPE="W",ONE(INST,REQD):DATATYPE'="W" G ENQ
"RTN","ORCDLG1",36,0)
EN1 ; -- loop for multiples
"RTN","ORCDLG1",37,0)
 I '$O(ORDIALOG(PROMPT,0)) D  G:$G(ORQUIT)!('$O(ORDIALOG(PROMPT,0)))!FIRST ENQ
"RTN","ORCDLG1",38,0)
M1 . D ADDMULT Q:$G(ORQUIT)
"RTN","ORCDLG1",39,0)
 . Q:'REQD!$O(ORDIALOG(PROMPT,0))  I FIRST,$G(SEQ)=1 S ORQUIT=1 Q
"RTN","ORCDLG1",40,0)
 . W $C(7),!!,$$REQUIRED,! G M1
"RTN","ORCDLG1",41,0)
 F  S ORX=$$SELECT Q:ORX=""  S:ORX="^" ORQUIT=1 Q:$G(ORQUIT)  D  Q:$G(DIROUT)
"RTN","ORCDLG1",42,0)
 . S DIR("A")=ORDIALOG(PROMPT,"A"),X=$S('REQD:0,$$ONLY(ORX):1,1:0)
"RTN","ORCDLG1",43,0)
 . D ADDMULT:ORX="A",ONE(ORX,X):ORX Q:$G(DIROUT)  K ORQUIT,DIR("B")
"RTN","ORCDLG1",44,0)
 . I REQD,'$O(ORDIALOG(PROMPT,0)) W $C(7),!!,$$REQUIRED,!
"RTN","ORCDLG1",45,0)
ENQ X:$D(^ORD(101.41,+ORDIALOG,10,ITM,10)) ^(10) ; exit action
"RTN","ORCDLG1",46,0)
 Q
"RTN","ORCDLG1",47,0)
 ;
"RTN","ORCDLG1",48,0)
REQUIRED() ; -- Required response message
"RTN","ORCDLG1",49,0)
 Q "A response is required!  Enter '^' to quit."
"RTN","ORCDLG1",50,0)
 ;
"RTN","ORCDLG1",51,0)
SELECT() ; -- select instance of multiple to edit
"RTN","ORCDLG1",52,0)
 N DIR,X,Y,CNT,I,MAX,TOTAL,DONE
"RTN","ORCDLG1",53,0)
 S MAX=+$G(ORDIALOG(PROMPT,"MAX")),TOTAL=+$G(ORDIALOG(PROMPT,"TOT"))
"RTN","ORCDLG1",54,0)
 S DIR("A",1)=$S($L($G(ORDIALOG(PROMPT,"TTL"))):ORDIALOG(PROMPT,"TTL"),1:ORDIALOG(PROMPT,"A"))
"RTN","ORCDLG1",55,0)
 S (I,CNT)=0 F  S I=$O(ORDIALOG(PROMPT,I)) Q:I'>0  S CNT=CNT+1,CNT(CNT)=I,DIR("A",CNT+1)=$J(CNT,3)_": "_$$ITEM^ORCDLG(PROMPT,I) ; parent+children
"RTN","ORCDLG1",56,0)
 I 'MAX!(MAX&(MAX>TOTAL)) S CNT=CNT+1,CNT(CNT)="A",DIR("A",CNT+1)=$J(CNT,3)_": <enter more>"
"RTN","ORCDLG1",57,0)
 S DIR("A")="Select "_$S(CNT>1:"(1-"_CNT_")",1:1)_" or <return> to continue: "
"RTN","ORCDLG1",58,0)
 S DIR(0)="NAO^1:"_CNT,DIR("?")="Select the instance you wish to change"
"RTN","ORCDLG1",59,0)
S1 D ^DIR I $D(DTOUT)!(Y="^") Q "^"
"RTN","ORCDLG1",60,0)
 I Y?1"^".E D UJUMP Q:$G(ORQUIT)!($G(DONE)) "" G S1
"RTN","ORCDLG1",61,0)
 I Y="" Q Y
"RTN","ORCDLG1",62,0)
 Q CNT(Y)
"RTN","ORCDLG1",63,0)
 ;
"RTN","ORCDLG1",64,0)
ONLY(I) ; -- I the only instance?
"RTN","ORCDLG1",65,0)
 N J,Z S J=0,Z=1
"RTN","ORCDLG1",66,0)
 F  S J=$O(ORDIALOG(PROMPT,J)) Q:J'>0  I J'=I S Z=0 Q
"RTN","ORCDLG1",67,0)
 Q Z
"RTN","ORCDLG1",68,0)
 ;
"RTN","ORCDLG1",69,0)
ADDMULT ; -- add new instances of multiple
"RTN","ORCDLG1",70,0)
 N DONE,LAST,MAX,ANOTHER,ORADDMUL
"RTN","ORCDLG1",71,0)
 S ORADDMUL=1
"RTN","ORCDLG1",72,0)
 S MAX=+$G(ORDIALOG(PROMPT,"MAX")) I MAX,MAX'>$G(ORDIALOG(PROMPT,"TOT")) W $C(7),!,"Only "_MAX_" items may be selected!",! Q
"RTN","ORCDLG1",73,0)
 S ANOTHER=$G(ORDIALOG(PROMPT,"MORE")) S:'$L(ANOTHER) ANOTHER="Another "
"RTN","ORCDLG1",74,0)
 S DIR("A")=$S($O(ORDIALOG(PROMPT,0)):ANOTHER,1:"")_ORDIALOG(PROMPT,"A")
"RTN","ORCDLG1",75,0)
 F  D  Q:$G(ORQUIT)!($G(DONE))  I MAX Q:MAX'>$G(ORDIALOG(PROMPT,"TOT"))
"RTN","ORCDLG1",76,0)
 . S ORDIALOG("CURINST")=1+$G(ORDIALOG("CURINST"))
"RTN","ORCDLG1",77,0)
 . D ONE(ORDIALOG("CURINST"),0) I '$D(ORDIALOG(PROMPT,ORDIALOG("CURINST"))) S DONE=1 Q
"RTN","ORCDLG1",78,0)
 . S ORDIALOG(PROMPT,"TOT")=+$G(ORDIALOG(PROMPT,"TOT"))+1,DIR("A")=ANOTHER_ORDIALOG(PROMPT,"A")
"RTN","ORCDLG1",79,0)
 Q
"RTN","ORCDLG1",80,0)
 ;
"RTN","ORCDLG1",81,0)
ONE(ORI,REQD) ; -- ask single-valued prompt
"RTN","ORCDLG1",82,0)
 N DONE,ORESET,QUERY
"RTN","ORCDLG1",83,0)
 S:$D(ORDIALOG(PROMPT,ORI)) DIR("B")=$$EXT^ORCD(PROMPT,ORI),ORESET=ORDIALOG(PROMPT,ORI)
"RTN","ORCDLG1",84,0)
 S QUERY=0 I $G(ORTYPE)="Z",PROMPT=$$PTR^ORCD("OR GTX INSTRUCTIONS") D  ;DJE/VM *350 Quick Order creation should query for schedule after dose.
"RTN","ORCDLG1",85,0)
 . N SCHEDITEM S SCHEDITEM=$O(^ORD(101.41,+ORDIALOG,10,"D",$$PTR^ORCD("OR GTX SCHEDULE"),"")) Q:'SCHEDITEM
"RTN","ORCDLG1",86,0)
 . I $P(^ORD(101.41,+ORDIALOG,10,SCHEDITEM,0),U,11)=PROMPT S QUERY=1  ;see if schedule is a child of dose
"RTN","ORCDLG1",87,0)
 F  D  Q:$G(DONE)  I $G(ORQUIT) Q:FIRST  Q:'REQD!$D(ORDIALOG(PROMPT,ORI))  S FIRST=$$DONE^ORCDLG2 Q:FIRST  K ORQUIT
"RTN","ORCDLG1",88,0)
 . D DIR^ORCDLG2 I $D(DTOUT)!$D(DIROUT)!(X=U) S ORQUIT=1 Q
"RTN","ORCDLG1",89,0)
 . I 'QUERY,X="" S DONE=1 Q
"RTN","ORCDLG1",90,0)
 . I X?1"^".E D UJUMP Q
"RTN","ORCDLG1",91,0)
 . I X="@" D DELETE Q:'QUERY
"RTN","ORCDLG1",92,0)
 . I $E(DIR(0))="N",Y<1,$E(Y,1,2)'="0." S Y=0_Y
"RTN","ORCDLG1",93,0)
 . S ORDIALOG(PROMPT,ORI)=$P(Y,U),DONE=1
"RTN","ORCDLG1",94,0)
 . X:$L($G(^ORD(101.41,+ORDIALOG,10,ITM,5))) ^(5) I '$G(DONE) D RESET Q  ; validate - if failed, K DONE to reask
"RTN","ORCDLG1",95,0)
 . D:$D(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT)) CHILDREN(PROMPT,ORI) I '$G(DONE),'FIRST D DELCHILD(PROMPT,ORI),RESET Q
"RTN","ORCDLG1",96,0)
 . I QUERY,ORDIALOG(PROMPT,ORI)="" D  ;DJE/VM *350 disable empty parent node if children have no data
"RTN","ORCDLG1",97,0)
 . . N SEQ,DA,PTR,VALUE
"RTN","ORCDLG1",98,0)
 . . S SEQ=0 F  S SEQ=$O(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT,SEQ)) Q:SEQ'>0  S DA=$O(^(SEQ,0)),PTR=+$P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,2) S:PTR&$D(ORDIALOG(PTR,ORI)) VALUE=1
"RTN","ORCDLG1",99,0)
 . . I '$G(VALUE) K ORDIALOG(PROMPT,ORI)
"RTN","ORCDLG1",100,0)
 Q
"RTN","ORCDLG1",101,0)
 ;
"RTN","ORCDLG1",102,0)
CHILDREN(PARENT,INST) ; -- ask child prompts
"RTN","ORCDLG1",103,0)
 N SEQ,DA,ORQUIT S SEQ=0
"RTN","ORCDLG1",104,0)
 F  S SEQ=$O(^ORD(101.41,+ORDIALOG,10,"DAD",PARENT,SEQ)) Q:SEQ'>0  S DA=$O(^(SEQ,0)) D EN(DA,INST) K:$G(ORJUMP) ORJUMP Q:$G(ORQUIT)
"RTN","ORCDLG1",105,0)
 K:$G(ORQUIT) DONE ; reask parent
"RTN","ORCDLG1",106,0)
 Q
"RTN","ORCDLG1",107,0)
 ;
"RTN","ORCDLG1",108,0)
RESET ; -- Reset original prompt value
"RTN","ORCDLG1",109,0)
 K ORDIALOG(PROMPT,ORI)
"RTN","ORCDLG1",110,0)
 S:$D(ORESET) ORDIALOG(PROMPT,ORI)=ORESET
"RTN","ORCDLG1",111,0)
 Q
"RTN","ORCDLG1",112,0)
 ;
"RTN","ORCDLG1",113,0)
UJUMP ; -- ^-jump
"RTN","ORCDLG1",114,0)
 N XP,P,CNT,MATCH,I,DIR,NEWSEQ ; XP=$$UP(X),P=PROMPT
"RTN","ORCDLG1",115,0)
 I $G(NOJUMP) W $C(7),"  ^-jumping not allowed!" Q
"RTN","ORCDLG1",116,0)
 S XP=$$UP^XLFSTR($P(X,U,2)) I "^"[XP S ORQUIT=1 Q
"RTN","ORCDLG1",117,0)
 I $G(ORDIALOG("B",XP)) S NEWSEQ=+ORDIALOG("B",XP) G UJQ
"RTN","ORCDLG1",118,0)
 S CNT=0,P=XP F  S P=$O(ORDIALOG("B",P)) Q:P=""  Q:$E(P,1,$L(XP))'=XP  Q:FIRST&(+ORDIALOG("B",P)'<SEQ)  S CNT=CNT+1,MATCH(CNT)=+ORDIALOG("B",P)_U_P ; =SEQ^TEXT
"RTN","ORCDLG1",119,0)
 I 'CNT W $C(7),"  ??" Q
"RTN","ORCDLG1",120,0)
 I CNT=1 S P=$P(MATCH(1),U,2) W $E(P,$L(XP)+1,$L(P)) S NEWSEQ=+MATCH(1) G UJQ
"RTN","ORCDLG1",121,0)
 F I=1:1:CNT S DIR("A",I)=I_"  "_$P(MATCH(I),U,2)
"RTN","ORCDLG1",122,0)
 S DIR("A")="Select 1-"_CNT_": ",DIR(0)="NAO^1:"_CNT
"RTN","ORCDLG1",123,0)
 S DIR("?")="Select the field you wish to jump to, by number"
"RTN","ORCDLG1",124,0)
 D ^DIR I $D(DTOUT)!($D(DUOUT))!(Y="") Q
"RTN","ORCDLG1",125,0)
 S NEWSEQ=+MATCH(Y)
"RTN","ORCDLG1",126,0)
UJQ I FIRST,NEWSEQ'<SEQ W $C(7),"  ^-jumping ahead not allowed now!" Q
"RTN","ORCDLG1",127,0)
 S SEQ=NEWSEQ-.01,DONE=1
"RTN","ORCDLG1",128,0)
 I $G(ORADDMUL) S ORJUMP=1
"RTN","ORCDLG1",129,0)
 Q
"RTN","ORCDLG1",130,0)
 ;
"RTN","ORCDLG1",131,0)
DELETE ; -- delete response
"RTN","ORCDLG1",132,0)
 I '$D(DIR("B")) W $C(7),"  ??" Q
"RTN","ORCDLG1",133,0)
 Q:'$$SURE  S DONE=1
"RTN","ORCDLG1",134,0)
 K ORDIALOG(PROMPT,ORI),DIR("B")
"RTN","ORCDLG1",135,0)
 S:$G(ORDIALOG(PROMPT,"TOT")) ORDIALOG(PROMPT,"TOT")=ORDIALOG(PROMPT,"TOT")-1
"RTN","ORCDLG1",136,0)
 I 'QUERY,$D(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT)) D DELCHILD(PROMPT,ORI)
"RTN","ORCDLG1",137,0)
 Q
"RTN","ORCDLG1",138,0)
 ;
"RTN","ORCDLG1",139,0)
DELCHILD(PARENT,INST) ; -- delete child prompts
"RTN","ORCDLG1",140,0)
 N SEQ,DA,PTR S:'$G(INST) INST=1
"RTN","ORCDLG1",141,0)
 S SEQ=0 F  S SEQ=$O(^ORD(101.41,+ORDIALOG,10,"DAD",PARENT,SEQ)) Q:SEQ'>0  S DA=$O(^(SEQ,0)),PTR=+$P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,2) K:PTR ORDIALOG(PTR,INST)
"RTN","ORCDLG1",142,0)
 Q
"RTN","ORCDLG1",143,0)
 ;
"RTN","ORCDLG1",144,0)
SURE() ; -- sure you want to delete?
"RTN","ORCDLG1",145,0)
 N X,Y,DIR
"RTN","ORCDLG1",146,0)
 S DIR(0)="YA",DIR("A")="  Are you sure you want to delete this value? "
"RTN","ORCDLG1",147,0)
 S DIR("B")="NO" W $C(7) D ^DIR
"RTN","ORCDLG1",148,0)
 S:$D(DTOUT) Y="^"
"RTN","ORCDLG1",149,0)
 Q Y
"RTN","ORCDLG1",150,0)
 ;
"RTN","ORCDLG1",151,0)
VALID() ;Check to see if default value is valid.  Returns 0 or 1
"RTN","ORCDLG1",152,0)
 ;Entire section added in patch 95
"RTN","ORCDLG1",153,0)
 N TYPE,RANGE,MIN,MAX,DIR,X,ORDIC,DDS,RTYPE,ORIG
"RTN","ORCDLG1",154,0)
 I Y="" Q 1 ;If default is null allow to pass ;110
"RTN","ORCDLG1",155,0)
 S DIR(0)=$G(ORDIALOG(PROMPT,0)),(ORIG,X)=Y,DIR("V")="" ;Set reader type, default input, silent call
"RTN","ORCDLG1",156,0)
 S TYPE=$E($P(DIR(0),"^")) ;Get type of look-up being done
"RTN","ORCDLG1",157,0)
 I TYPE="W" Q 1 ;If word processing assume value is valid, may be referencing a global location
"RTN","ORCDLG1",158,0)
 I TYPE="R" S $P(DIR(0),"^")="D"_$E($P(DIR(0),"^"),2,999),TYPE="D",RTYPE=1 ;If type is R then change to date look up
"RTN","ORCDLG1",159,0)
 I TYPE="D" I X="AM"!(X="NEXT")!(X="NEXTA")!(X="CLOSEST") Q 1 ;If date/time prompt default is AM, NEXT, NEXTA, or CLOSEST then accept without checking
"RTN","ORCDLG1",160,0)
 S:TYPE="P"&(X=+X) X="`"_X ;If pointer type add ` to IEN for DIR call
"RTN","ORCDLG1",161,0)
 I TYPE="P" S ORDIC=$P(DIR(0),"^",2) S $P(ORDIC,":",2)=$TR($P(ORDIC,":",2),"QE","") S $P(DIR(0),"^",2)=ORDIC ;If pointer type remove Q&E from DIC(0) so no echo and no ?? on erroneous input
"RTN","ORCDLG1",162,0)
 I TYPE="D" S ORDIC=$P(DIR(0),"^",2) S $P(ORDIC,":",3)=$TR($P(ORDIC,":",3),"E",""),$P(ORDIC,":")=$TR($P(ORDIC,":"),"DTNOW",""),$P(DIR(0),"^",2)=ORDIC ;Remove "E" so no echo, remove DT and NOW so DIR call works correctly
"RTN","ORCDLG1",163,0)
 I TYPE="Y" S:"^Y^YE^YES^"[("^"_$TR(X,"yes","YES")_"^")!(X=1) X="YES" S:"^N^NO^"[("^"_$TR(X,"no","NO")_"^")!(X=0) X="NO" ;If yes/no type convert input to uppercase full entry to avoid echo
"RTN","ORCDLG1",164,0)
 I TYPE="S" S DDS=1 ;Stops DIR call from echoing rest of entry for set of codes
"RTN","ORCDLG1",165,0)
 D ^DIR
"RTN","ORCDLG1",166,0)
 I TYPE="D"&('$D(Y(0))) Q 0 ;Date not valid
"RTN","ORCDLG1",167,0)
 I TYPE="L"&($G(Y)="") Q 0 ;List/Range not valid
"RTN","ORCDLG1",168,0)
 I TYPE="N"&('$D(Y)) Q 0 ;Numeric not valid
"RTN","ORCDLG1",169,0)
 I TYPE="P"&($G(Y)=-1) Q 0 ;Pointer not valid
"RTN","ORCDLG1",170,0)
 I TYPE="S"&($G(Y(0))="") Q 0 ;Set of codes not valid
"RTN","ORCDLG1",171,0)
 I TYPE="Y"&($G(Y(0))="") Q 0 ;Yes/No not valid
"RTN","ORCDLG1",172,0)
 I TYPE="F" S RANGE=$P(DIR(0),"^",2),MIN=$S($P(RANGE,":"):$P(RANGE,":"),1:1),MAX=$S($P(RANGE,":",2):$P(RANGE,":",2),1:240) I $L(Y)<MIN!($L(Y)>MAX) Q 0 ;Free text and not within valid limit
"RTN","ORCDLG1",173,0)
 I $G(RTYPE) S Y=ORIG ;Set y back to relative date
"RTN","ORCDLG1",174,0)
 I TYPE="P" S Y=$P(Y,"^") ;only store IEN ;110
"RTN","ORCDLG1",175,0)
 Q 1 ;Must be valid
"RTN","ORCDPS")
0^6^B41761091
"RTN","ORCDPS",1,0)
ORCDPS ;SLC/MKB-Pharmacy dialog utilities ;5/1/2012 14:30
"RTN","ORCDPS",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**4,38,62,86,94,129,350**;Dec 17, 1997;Build 77
"RTN","ORCDPS",3,0)
 ;
"RTN","ORCDPS",4,0)
 ; ** Keep for backwards compatibility, just in case:
"RTN","ORCDPS",5,0)
 ;
"RTN","ORCDPS",6,0)
CHANGED(TYPE) ; -- Kill dependent values when OI changes
"RTN","ORCDPS",7,0)
 N PROMPTS,NAME,PTR,P,I
"RTN","ORCDPS",8,0)
 Q:'$L($G(TYPE))  S PROMPTS=""
"RTN","ORCDPS",9,0)
 I TYPE="U" S PROMPTS="DISPENSE DRUG^INSTRUCTIONS^ROUTE" K ORSCHED,ORQTY
"RTN","ORCDPS",10,0)
 I TYPE="O" S PROMPTS="DISPENSE DRUG^INSTRUCTIONS^FREE TEXT^ROUTE^SCHEDULE^DURATION" K ORSCHED,ORQTY
"RTN","ORCDPS",11,0)
 S:TYPE="IVB" PROMPTS="VOLUME"
"RTN","ORCDPS",12,0)
 S:TYPE="IVA" PROMPTS="STRENGTH PSIV^UNITS"
"RTN","ORCDPS",13,0)
 I TYPE="ALL" S PROMPTS="ORDERABLE ITEM^DISPENSE DRUG^INSTRUCTIONS^FREE TEXT^ROUTE^SCHEDULE^DURATION^URGENCY^QUANTITY^REFILLS^ROUTING^SERVICE CONNECTED^VOLUME^STRENGTH PSIV^UNITS^ADDITIVE^INFUSION RATE^WORD PROCESSING 1" K ORSCHED,ORQTY
"RTN","ORCDPS",14,0)
 S:TYPE="XFR" PROMPTS="DISPENSE DRUG^INSTRUCTIONS^FREE TEXT^DURATION^QUANTITY^REFILLS^ROUTING^START DATE^SERVICE CONNECTED"
"RTN","ORCDPS",15,0)
 F P=1:1:$L(PROMPTS,U) S NAME=$P(PROMPTS,U,P) D
"RTN","ORCDPS",16,0)
 . S PTR=$O(^ORD(101.41,"AB","OR GTX "_NAME,0)) Q:'PTR
"RTN","ORCDPS",17,0)
 . S I=0 F  S I=$O(ORDIALOG(PTR,I)) Q:I'>0  K ORDIALOG(PTR,I)
"RTN","ORCDPS",18,0)
 . K ORDIALOG(PTR,"LIST")
"RTN","ORCDPS",19,0)
 Q
"RTN","ORCDPS",20,0)
 ;
"RTN","ORCDPS",21,0)
ASKSC() ; -- Return 1 or 0, if SC prompt should be asked
"RTN","ORCDPS",22,0)
 I $L($T(SC^PSOCP)),$$SC^PSOCP(+ORVP,+$G(ORDRUG)) Q 0 ;exempt from copay
"RTN","ORCDPS",23,0)
 I $$RXST^IBARXEU(+ORVP)>0 Q 0 ;exempt from copay
"RTN","ORCDPS",24,0)
 Q 1
"RTN","ORCDPS",25,0)
 ;
"RTN","ORCDPS",26,0)
INSTR(OI) ; -- Get allowable instructions and routes
"RTN","ORCDPS",27,0)
 N PSOI,INSTR,NOUN,I,X,CNT
"RTN","ORCDPS",28,0)
 K ^TMP("PSJINS",$J),^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),ORLEAD,ORNOUNS,ORSCHED
"RTN","ORCDPS",29,0)
 S PSOI=+$P($G(^ORD(101.43,+OI,0)),U,2) D START^PSSJORDF(PSOI)
"RTN","ORCDPS",30,0)
 S:$L($G(^TMP("PSJSCH",$J))) ORSCHED=^($J) ;default schedule
"RTN","ORCDPS",31,0)
 Q:$P($G(^ORD(100.98,+ORDG,0)),U,3)'="O RX"  ; Don't need nouns for Inpt
"RTN","ORCDPS",32,0)
 S NOUN=$$PTR^ORCD("OR GTX FREE TEXT"),ORNOUNS="",(I,CNT)=0
"RTN","ORCDPS",33,0)
 F  S I=$O(^TMP("PSJNOUN",$J,I)) Q:I'>0  S X=$P(^(I),U) I $L(X) S CNT=CNT+1,ORDIALOG(NOUN,"LIST",CNT)=X_U_X,ORDIALOG(NOUN,"LIST","B",X)=X,ORNOUNS=ORNOUNS_$S($L(ORNOUNS):" or ",1:"")_X
"RTN","ORCDPS",34,0)
 S ORDIALOG(NOUN,"LIST")=CNT_"^1",INSTR=$$PTR^ORCD("OR GTX INSTRUCTIONS")
"RTN","ORCDPS",35,0)
 S I=$O(^TMP("PSJINS",$J,0)),X=$P($G(^TMP("PSJINS",$J,+I)),U)
"RTN","ORCDPS",36,0)
 S:$L(X) ORLEAD=$$LOWER^VALM1(X),ORDIALOG(INSTR,"TTL")=ORLEAD_": "
"RTN","ORCDPS",37,0)
 S ORDIALOG(INSTR,"A")=$S($L($G(ORLEAD)):ORLEAD,1:"Amount")_$S($L(ORNOUNS):" (in "_ORNOUNS_")",1:"")_": "
"RTN","ORCDPS",38,0)
 Q
"RTN","ORCDPS",39,0)
 ;
"RTN","ORCDPS",40,0)
CHOICES(TYPE) ; -- Get list of allowable dispense drugs
"RTN","ORCDPS",41,0)
 Q:$D(ORDIALOG(PROMPT,"LIST"))  N OI,PSJOI,I,X,Y,ORX,ORY
"RTN","ORCDPS",42,0)
 S OI=$$VAL^ORCD("MEDICATION"),PSJOI="^^^"_+$P($G(^ORD(101.43,+OI,0)),U,2)
"RTN","ORCDPS",43,0)
 S ORX=$T(ENDD^PSJORUTL),ORX=$L($P(ORX,";"),",")
"RTN","ORCDPS",44,0)
 I ORX>3 D ENDD^PSJORUTL(PSJOI,TYPE,.ORY,+ORVP) Q:ORY'>0
"RTN","ORCDPS",45,0)
 I ORX'>3 D ENDD^PSJORUTL(PSJOI,TYPE,.ORY) Q:ORY'>0
"RTN","ORCDPS",46,0)
 F I=1:1:ORY S X=$P(ORY(I),U,2),ORY("B",X)=ORY(I) K ORY(I) ; sort
"RTN","ORCDPS",47,0)
 S I=0,ORX="" W !
"RTN","ORCDPS",48,0)
 F  S ORX=$O(ORY("B",ORX)) Q:ORX=""  S X=ORY("B",ORX),I=I+1 D
"RTN","ORCDPS",49,0)
 . S Y=$P(X,U,1,2) I $L($P(X,U,5)),Y'[$P(X,U,5) S Y=Y_" "_$P(X,U,5)
"RTN","ORCDPS",50,0)
 . S:$P(X,U,4) Y=Y_" (non-formulary)"
"RTN","ORCDPS",51,0)
 . S:$P(X,U,3) Y=Y_"  $"_$P(X,U,3)_$S($L($P(X,U,5)):" per "_$P(X,U,5),1:"")
"RTN","ORCDPS",52,0)
 . S ORDIALOG(PROMPT,"LIST",I)=Y,ORDIALOG(PROMPT,"LIST","B",$P(X,U,2))=+X,ORDIALOG(PROMPT,"LIST","D",+X)=I_U_$P(X,U,4)_U_$P(X,U,6)
"RTN","ORCDPS",53,0)
 S ORDIALOG(PROMPT,"LIST")=ORY_"^1" ; total^list only
"RTN","ORCDPS",54,0)
 Q
"RTN","ORCDPS",55,0)
 ;
"RTN","ORCDPS",56,0)
 ; ** End of old code
"RTN","ORCDPS",57,0)
 ;
"RTN","ORCDPS",58,0)
NF(DRUG) ; -- Get alternatives for non-formulary drugs
"RTN","ORCDPS",59,0)
 ;    [Called from P-S Action for Dose]
"RTN","ORCDPS",60,0)
 N TYPE,ORY,I,DD,PSOI,ORPSOI,X,Y,DUOUT,DTOUT
"RTN","ORCDPS",61,0)
 Q:'$G(DRUG)  Q:$G(ORENEW)
"RTN","ORCDPS",62,0)
 S TYPE=$S($G(ORCAT)="I":"U",1:"O")
"RTN","ORCDPS",63,0)
 D ENRFA^PSJORUTL(DRUG,TYPE,.ORY)
"RTN","ORCDPS",64,0)
 S ORPSOI=+$P($G(^ORD(101.43,+$G(OROI),0)),U,2)
"RTN","ORCDPS",65,0)
 S (I,DD)=0 I ORY F  S DD=$O(ORY(DD)) Q:DD'>0  D  ;build list of choices
"RTN","ORCDPS",66,0)
 . S PSOI=$P(ORY(DD),U,4,5) Q:PSOI=ORPSOI  Q:$G(ORY("PS",+PSOI))
"RTN","ORCDPS",67,0)
 . S I=I+1,ORY("B",I)=PSOI,ORY("PS",+PSOI)=I
"RTN","ORCDPS",68,0)
 I '$P($G(^ORD(101.43,+$G(OROI),"PS")),U,6) D  ;skip if OI is NF
"RTN","ORCDPS",69,0)
 . W !!,"*** The dispense drug for this dose is not in the formulary! ***"
"RTN","ORCDPS",70,0)
 . W:'ORY!('I) !,"    There are no formulary alternatives entered for this item."
"RTN","ORCDPS",71,0)
 . W !,"    Please consult with your pharmacy before ordering this dose."
"RTN","ORCDPS",72,0)
NF1 Q:'ORY!('I)  D  Q:$G(ORQUIT)  ;Q if no different choices
"RTN","ORCDPS",73,0)
 . N DIR S DIR(0)="NAO^1:"_ORY
"RTN","ORCDPS",74,0)
 . S DIR("A")="Select alternative (or <return> to continue): "
"RTN","ORCDPS",75,0)
 . S I=0 F  S I=$O(ORY("B",I)) Q:I'>0  S DIR("A",I)=$J(I,3)_" "_$P(ORY("B",I),U,2)
"RTN","ORCDPS",76,0)
 . S DIR("?")="The dispense drug for the selected dose is not in the formulary; you may select an alternative orderable item, or press <return> to continue processing this order."
"RTN","ORCDPS",77,0)
 . W !,"    Formulary alternative orderable items:"
"RTN","ORCDPS",78,0)
 . D ^DIR S:$D(DTOUT)!($D(DUOUT)) ORQUIT=1
"RTN","ORCDPS",79,0)
 I Y D  ; reset OI, doses
"RTN","ORCDPS",80,0)
 . S PSOI=+ORY("B",Y),X=+$O(^ORD(101.43,"ID",PSOI_";99PSP",0))
"RTN","ORCDPS",81,0)
 . Q:'X  Q:X=OROI  ;error or same OI
"RTN","ORCDPS",82,0)
 . S ORDIALOG($$PTR^ORCD("OR GTX ORDERABLE ITEM"),1)=X
"RTN","ORCDPS",83,0)
 . D CHANGED^ORCDPS1("OI"),OI2^ORCDPS1,D1^ORCDPS2 ;get new doses
"RTN","ORCDPS",84,0)
 . D:$G(ORDIALOG(PROMPT,"LIST")) LIST^ORCD K DONE,ORESET
"RTN","ORCDPS",85,0)
 . S DIR("A")=ORDIALOG(PROMPT,"A"),(ORI,INST)=1 ;reset if complex
"RTN","ORCDPS",86,0)
 Q
"RTN","ORCDPS",87,0)
 ;
"RTN","ORCDPS",88,0)
DISPDRUG() ; -- Get Dispense Drug from dose selection(s) [from EXDOSE^ORCDPS2]
"RTN","ORCDPS",89,0)
 ;       Expects PROMPT, ORDIALOG(), ORDOSE()
"RTN","ORCDPS",90,0)
 ;
"RTN","ORCDPS",91,0)
 N DD,FORM,I,DOSE,X,ORID,OK,STR,ORX,HALFOK
"RTN","ORCDPS",92,0)
 ;S DD=$G(ORDIALOG($$PTR("DISPENSE DRUG"),1)) I DD Q DD ;already have - DJE/VM *350 can have wrong value, best to recalc
"RTN","ORCDPS",93,0)
 S DD="",FORM="1.N.""."".N."" ""1"""_$P($G(ORDOSE(1)),U,2)_""""
"RTN","ORCDPS",94,0)
 S I=0 F  S I=$O(ORDIALOG(PROMPT,I)) Q:I'>0  D  Q:DD="^"
"RTN","ORCDPS",95,0)
 . S DOSE=$G(ORDIALOG(PROMPT,I)),X=""
"RTN","ORCDPS",96,0)
 . S:$L(DOSE) X=$G(ORDIALOG(PROMPT,"LIST","D",DOSE))
"RTN","ORCDPS",97,0)
 . I X="" S DD=$S($G(ORCAT)="I":"^",'$G(ORDOSE(1)):"^",DOSE'?@FORM:"^",1:0) Q
"RTN","ORCDPS",98,0)
 . S:DD="" DD=X I X'=DD S DD=$S($G(ORCAT)="I":"^",1:0) Q
"RTN","ORCDPS",99,0)
 Q:DD DD Q:DD="^" "" ;all same, or not possible
"RTN","ORCDPS",100,0)
 S ORID=$$PTR("DOSE"),DD=0 F  S DD=$O(ORDOSE("DD",DD)) Q:DD'>0  D
"RTN","ORCDPS",101,0)
 . S OK=1,STR=+$P($G(ORDOSE("DD",DD)),U,5),HALFOK=+$P($G(ORDOSE("DD",DD)),U,11)
"RTN","ORCDPS",102,0)
 . S I=0 F  S I=$O(ORDIALOG(PROMPT,I)) Q:I'>0  D  Q:'OK
"RTN","ORCDPS",103,0)
 .. S DOSE=$G(ORDIALOG(PROMPT,I))
"RTN","ORCDPS",104,0)
 .. I '$G(ORDOSE(1)) D  Q  ;local doses
"RTN","ORCDPS",105,0)
 ... S X=$G(ORDOSE("DD",DD,DOSE)) I X="" S OK=0 K ORX(DD) Q
"RTN","ORCDPS",106,0)
 ... S ORX(DD,I)=DOSE,ORX(DD)=""
"RTN","ORCDPS",107,0)
 .. S X=+$G(ORDIALOG(ORID,I)) S:X'>0 X=+DOSE S X=X/STR
"RTN","ORCDPS",108,0)
 .. I (X?1.N)!(HALFOK&(X?.N.1".5")) S ORX(DD,I)=X S:X>$G(ORX(DD)) ORX(DD)=X Q
"RTN","ORCDPS",109,0)
 .. K ORX(DD) S OK=0
"RTN","ORCDPS",110,0)
 I '$G(ORDOSE(1)) S DD=$O(ORX(0)) Q DD ;first one
"RTN","ORCDPS",111,0)
 S DD="",X=99999,I=0 F  S I=$O(ORX(I)) Q:I'>0  I ORX(I)<X S X=ORX(I),DD=I
"RTN","ORCDPS",112,0)
 Q DD
"RTN","ORCDPS",113,0)
 ;
"RTN","ORCDPS",114,0)
ID() ; -- Return ID string for dose instance INST
"RTN","ORCDPS",115,0)
 N INSTR,DD,DOSE,ID
"RTN","ORCDPS",116,0)
 S INSTR=$$PTR("INSTRUCTIONS"),DOSE=$G(ORDIALOG(INSTR,INST)),(DD,ID)=""
"RTN","ORCDPS",117,0)
 S:$L(DOSE) DD=+$G(ORDIALOG(INSTR,"LIST","D",DOSE))
"RTN","ORCDPS",118,0)
 S:DD ID=$TR($G(ORDOSE("DD",DD,DOSE)),"^","&")
"RTN","ORCDPS",119,0)
 Q ID
"RTN","ORCDPS",120,0)
 ;
"RTN","ORCDPS",121,0)
RESETID ; -- Reset ORDIALOG(DOSE) nodes for new ORDRUG
"RTN","ORCDPS",122,0)
 ;    From EXDOSE^ORCDPS2: Expects PROMPT, DRUG
"RTN","ORCDPS",123,0)
 ;
"RTN","ORCDPS",124,0)
 Q:$G(ORCAT)'="O"  N I,ORID,STR,UNT,DOSE,X,FORM
"RTN","ORCDPS",125,0)
 S ORID=$$PTR("DOSE"),STR=+$P(DRUG,U,5),UNT=$P(DRUG,U,6)
"RTN","ORCDPS",126,0)
 S FORM="1.N.""."".N."" ""1"""_UNT_""""
"RTN","ORCDPS",127,0)
 S I=0 F  S I=$O(ORDIALOG(PROMPT,I)) Q:I'>0  D
"RTN","ORCDPS",128,0)
 . S DOSE=$G(ORDIALOG(PROMPT,I)),X=$G(ORDOSE("DD",+ORDRUG,DOSE))
"RTN","ORCDPS",129,0)
 . I '$L(X),STR,DOSE?@FORM D
"RTN","ORCDPS",130,0)
 .. N UD,NOUN S UD=+DOSE/STR,NOUN=$P($G(ORDOSE(1)),U,4)
"RTN","ORCDPS",131,0)
 .. I UD>1,$E(NOUN,$L(NOUN))'="S" S NOUN=NOUN_"S"
"RTN","ORCDPS",132,0)
 .. S X=+DOSE_"&"_UNT_"&"_UD_"&"_NOUN_"&"_DOSE_"&"_+ORDRUG_"&"_STR_"&"_UNT
"RTN","ORCDPS",133,0)
 . S:$L(X) ORDIALOG(ORID,I)=$TR(X,"^","&") Q
"RTN","ORCDPS",134,0)
 Q
"RTN","ORCDPS",135,0)
PTR(X) ; -- Return ptr to prompt OR GTX X
"RTN","ORCDPS",136,0)
 Q +$O(^ORD(101.41,"AB","OR GTX "_X,0))
"RTN","ORCDPS1")
0^41^B86245200
"RTN","ORCDPS1",1,0)
ORCDPS1 ;SLC/MKB-Pharmacy dialog utilities ;11/12/14  15:03
"RTN","ORCDPS1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**94,117,141,149,195,215,243,280,337,311,350**;Dec 17, 1997;Build 77
"RTN","ORCDPS1",3,0)
 ;
"RTN","ORCDPS1",4,0)
 ; DBIA 2418   START^PSSJORDF   ^TMP("PSJMR",$J)
"RTN","ORCDPS1",5,0)
 ; DBIA 3166   EN^PSSDIN        ^TMP("PSSDIN",$J)
"RTN","ORCDPS1",6,0)
 ; DBIA 2534   SC^PSOCP
"RTN","ORCDPS1",7,0)
 ; DBIA 3237   ^PSOSIG
"RTN","ORCDPS1",8,0)
 ; DBIA 3278   ^PSOSIGDS
"RTN","ORCDPS1",9,0)
 ; DBIA 3423   ^PSSGS0
"RTN","ORCDPS1",10,0)
 ; DBIA 3233   ^PSSORUTL
"RTN","ORCDPS1",11,0)
 ; DBIA 3239   ^PSSUTIL1
"RTN","ORCDPS1",12,0)
 ; DBIA 3373   ^PSSUTLA1
"RTN","ORCDPS1",13,0)
 ;
"RTN","ORCDPS1",14,0)
EN(TYPE) ; -- entry action for Meds dialogs
"RTN","ORCDPS1",15,0)
 S ORINPT=$$INPT^ORCD,ORCAT=$G(TYPE)
"RTN","ORCDPS1",16,0)
 I 'ORINPT,ORCAT="I" D IMOLOC^ORIMO(.ORINPT,+ORL,+ORVP) S:ORINPT<0 ORINPT=0 ;allow inpt meds at this location?
"RTN","ORCDPS1",17,0)
 I ORCAT="" D
"RTN","ORCDPS1",18,0)
 . I $G(ORENEW)!$G(OREWRITE)!$D(OREDIT),$L($P($G(OR0),U,12)) S ORCAT=$P(OR0,U,12) Q  ;use value from order, via ORCACT4
"RTN","ORCDPS1",19,0)
 . S ORCAT=$S(ORINPT:"I",1:"O")
"RTN","ORCDPS1",20,0)
 S ORDG=+$O(^ORD(100.98,"B",$S(ORCAT="I":"UD RX",1:"O RX"),0))
"RTN","ORCDPS1",21,0)
 K ^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),^TMP("PSJSCH",$J)
"RTN","ORCDPS1",22,0)
 I $G(ORENEW)!$G(OREWRITE)!$G(OREDIT)!$G(ORXFER) D  Q:$G(ORQUIT)
"RTN","ORCDPS1",23,0)
 . I 'ORINPT,ORCAT="I" D  Q:$G(ORQUIT)
"RTN","ORCDPS1",24,0)
 .. N OI S OI=+$O(^OR(100,+$G(ORIFN),.1,"B",0)) Q:OI<1
"RTN","ORCDPS1",25,0)
 .. I '$O(^ORD(101.43,OI,9,"B","IVM RX",0)) S ORQUIT=1 W $C(7),!!,"This order may not be placed at this location!" Q
"RTN","ORCDPS1",26,0)
 . K ORDIALOG($$PTR("START DATE/TIME"),1)
"RTN","ORCDPS1",27,0)
 . K ORDIALOG($$PTR("NOW"),1) Q:ORCAT'="O"
"RTN","ORCDPS1",28,0)
 . N WP S WP=$$PTR("WORD PROCESSING 1")
"RTN","ORCDPS1",29,0)
 . I '$G(ORXFER),'$$DRAFT^ORWDX2($G(ORIFN)) K ORDIALOG(WP,1),^TMP("ORWORD",$J,WP)
"RTN","ORCDPS1",30,0)
 . I $G(OREDIT),'$O(ORDIALOG($$PTR^ORCD("OR GTX INSTRUCTIONS"),0)) K ^TMP("ORWORD",$J)
"RTN","ORCDPS1",31,0)
 I ORINPT,ORCAT="O" W $C(7),!!,"NOTE: This will create an outpatient prescription for an inpatient!",!
"RTN","ORCDPS1",32,0)
 Q
"RTN","ORCDPS1",33,0)
 ;
"RTN","ORCDPS1",34,0)
EN1 ; -- setup Meds dialog for quick order editor using ORDG
"RTN","ORCDPS1",35,0)
 N DG S DG=$P($G(^ORD(100.98,+$G(ORDG),0)),U,3)
"RTN","ORCDPS1",36,0)
 I $P(DG," ")="O"!(DG="SPLY") S ORINPT=0,ORCAT="O"
"RTN","ORCDPS1",37,0)
 E  S ORINPT=1,ORCAT="I"
"RTN","ORCDPS1",38,0)
 K ^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),^TMP("PSJSCH",$J)
"RTN","ORCDPS1",39,0)
 Q
"RTN","ORCDPS1",40,0)
 ;
"RTN","ORCDPS1",41,0)
ENOI ; -- setup OI prompt
"RTN","ORCDPS1",42,0)
 N D S D=$G(ORDIALOG(PROMPT,"D"))
"RTN","ORCDPS1",43,0)
 S:D="S.RX" ORDIALOG(PROMPT,"D")=$S(ORCAT="I":"S.UD RX",1:"S.O RX")
"RTN","ORCDPS1",44,0)
 I ORCAT="I",'ORINPT,D="S.UD RX" D  ;limit to IV meds for outpt's
"RTN","ORCDPS1",45,0)
 . S ORDIALOG(PROMPT,"D")="S.IVM RX" ;ORDG=+$O(^ORD(100.98,"B","O RX",0))
"RTN","ORCDPS1",46,0)
 . S ORDIALOG(PROMPT,"?")="Enter the IV medication you wish to order for this patient."
"RTN","ORCDPS1",47,0)
 Q
"RTN","ORCDPS1",48,0)
 ;
"RTN","ORCDPS1",49,0)
DEA ; -- ck DEA# of ordering provider if SchedII drug
"RTN","ORCDPS1",50,0)
 Q:$G(ORTYPE)="Z"  N DEAFLG,PSOI
"RTN","ORCDPS1",51,0)
 S PSOI=+$P($G(^ORD(101.43,+$G(Y),0)),U,2) Q:PSOI'>0
"RTN","ORCDPS1",52,0)
 S DEAFLG=$$OIDEA^PSSUTLA1(PSOI,ORCAT) Q:DEAFLG'>0  ;ok
"RTN","ORCDPS1",53,0)
 I $G(ORNP),'$L($P($G(^VA(200,+ORNP,"PS")),U,2)),'$L($P($G(^("PS")),U,3)) W $C(7),!,$P($G(^(0)),U)_" must have a DEA# or VA# to order this drug!" K DONE Q
"RTN","ORCDPS1",54,0)
 I DEAFLG=1 W $C(7),!,"This order will require a wet signature!"
"RTN","ORCDPS1",55,0)
 Q
"RTN","ORCDPS1",56,0)
 ;
"RTN","ORCDPS1",57,0)
CHANGED(X) ; -- Kill dependent values when prompt X changes
"RTN","ORCDPS1",58,0)
 N PROMPTS,NAME,PTR,P,I
"RTN","ORCDPS1",59,0)
 S PROMPTS=X I X="OI" D
"RTN","ORCDPS1",60,0)
 . S PROMPTS="INSTRUCTIONS^ROUTE^SCHEDULE^START DATE/TIME^DURATION^AND/THEN^DOSE^DISPENSE DRUG^SIG^PATIENT INSTRUCTIONS^DAYS SUPPLY^QUANTITY^REFILLS^SERVICE CONNECTED"
"RTN","ORCDPS1",61,0)
 . K ORDRUG,ORDOSE,OROUTE,ORSCH,ORSD,ORDSUP,ORQTY,ORQTYUNT,OREFILLS,ORCOPAY
"RTN","ORCDPS1",62,0)
 . K ^TMP("PSJINS",$J),^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),^TMP("PSJSCH",$J)
"RTN","ORCDPS1",63,0)
 I X="DS" S PROMPTS="QUANTITY^REFILLS" K OREFILLS
"RTN","ORCDPS1",64,0)
 F P=1:1:$L(PROMPTS,U) S NAME=$P(PROMPTS,U,P) D
"RTN","ORCDPS1",65,0)
 . S PTR=$$PTR(NAME) Q:'PTR
"RTN","ORCDPS1",66,0)
 . S I=0 F  S I=$O(ORDIALOG(PTR,I)) Q:I'>0  K ORDIALOG(PTR,I)
"RTN","ORCDPS1",67,0)
 . K ORDIALOG(PTR,"LIST"),^TMP("ORWORD",$J,PTR)
"RTN","ORCDPS1",68,0)
 Q
"RTN","ORCDPS1",69,0)
 ;
"RTN","ORCDPS1",70,0)
ORDITM(OI) ; -- Check OI, get dependent info
"RTN","ORCDPS1",71,0)
 Q:OI'>0  ;quit - no value
"RTN","ORCDPS1",72,0)
 N ORPS,ORPSOI S ORPS=$G(^ORD(101.43,+OI,"PS")),ORPSOI=+$P($G(^(0)),U,2)
"RTN","ORCDPS1",73,0)
 S ORIV=$S($P(ORPS,U)=2:1,1:0)
"RTN","ORCDPS1",74,0)
 I $G(ORCAT)="O",'$P(ORPS,U,2) W $C(7),!,"This drug may not be used in an outpatient order." S ORQUIT=1 D WAIT Q
"RTN","ORCDPS1",75,0)
 I $G(ORCAT)="I" D  Q:$G(ORQUIT)
"RTN","ORCDPS1",76,0)
 . I $G(ORINPT),'$P(ORPS,U) W $C(7),!,"This drug may not be used in an inpatient order." S ORQUIT=1 D WAIT Q
"RTN","ORCDPS1",77,0)
 . I '$G(ORINPT),'ORIV W $C(7),!,"This drug may not be ordered for an outpatient." S ORQUIT=1 D WAIT Q
"RTN","ORCDPS1",78,0)
 I $G(ORTYPE)="Q" D  I $G(ORQUIT) D WAIT Q
"RTN","ORCDPS1",79,0)
 . N DEAFLG S DEAFLG=$$OIDEA^PSSUTLA1(ORPSOI,ORCAT) Q:DEAFLG'>0  ;ok
"RTN","ORCDPS1",80,0)
 . I $G(ORNP),'$L($P($G(^VA(200,+ORNP,"PS")),U,2)),'$L($P($G(^("PS")),U,3)) W $C(7),!,$P($G(^(0)),U)_" must have a DEA# or VA# to order this drug!" S ORQUIT=1 Q
"RTN","ORCDPS1",81,0)
 . I DEAFLG=1 W $C(7),!,"This order will require a wet signature!"
"RTN","ORCDPS1",82,0)
OI1 ; -ck NF status
"RTN","ORCDPS1",83,0)
 I $P(ORPS,U,6),'$G(ORENEW) D  ;alternative
"RTN","ORCDPS1",84,0)
 . W !!,"*** This medication is not in the formulary! ***"
"RTN","ORCDPS1",85,0)
 . N PSX,CNT,ORX,DIR,X,Y,DTOUT,DUOUT
"RTN","ORCDPS1",86,0)
 . D EN1^PSSUTIL1(.ORPSOI,ORCAT) I '$O(ORPSOI(0)) D  Q
"RTN","ORCDPS1",87,0)
 .. W !,"    There are no formulary alternatives entered for this item."
"RTN","ORCDPS1",88,0)
 .. W !,"    Please consult with your pharmacy before ordering it."
"RTN","ORCDPS1",89,0)
 . S PSX=0,CNT=0 F  S PSX=$O(ORPSOI(PSX)) Q:PSX'>0  D
"RTN","ORCDPS1",90,0)
 .. S ORX=+$O(^ORD(101.43,"ID",PSX_";99PSP",0)) Q:ORX'>0
"RTN","ORCDPS1",91,0)
 .. S CNT=CNT+1,ORPSOI("OI",CNT)=ORX_U_PSX
"RTN","ORCDPS1",92,0)
 .. S DIR("A",CNT)=$J(CNT,3)_" "_$P($G(^ORD(101.43,ORX,0)),U)
"RTN","ORCDPS1",93,0)
 . S DIR(0)="NAO^1:"_CNT,DIR("A")="Select alternative (or <return> to continue): "
"RTN","ORCDPS1",94,0)
 . S DIR("?")="The medication selected is not in the formulary; you may select one of the above listed alternatives instead, or press <return> to continue processing this order."
"RTN","ORCDPS1",95,0)
 . Q:CNT'>0  W !,"    Formulary alternatives:" D ^DIR
"RTN","ORCDPS1",96,0)
 . I Y'>0 S:$D(DTOUT)!$D(DUOUT) ORQUIT=1 Q
"RTN","ORCDPS1",97,0)
 . D:OI'=+ORPSOI("OI",+Y) CHANGED("OI") ;reset parameters if different
"RTN","ORCDPS1",98,0)
 . S OI=+ORPSOI("OI",+Y),ORDIALOG(PROMPT,INST)=OI,OROI=OI
"RTN","ORCDPS1",99,0)
 . S ORPSOI=+$P(ORPSOI("OI",+Y),U,2)
"RTN","ORCDPS1",100,0)
OI2 ; -get routes, doses [also called from NF^ORCDPS]
"RTN","ORCDPS1",101,0)
 D:'$D(^TMP("PSJMR",$J)) START^PSSJORDF(ORPSOI,$G(ORCAT))  ;DBIA 2418
"RTN","ORCDPS1",102,0)
 I '$D(ORDOSE) D
"RTN","ORCDPS1",103,0)
 . D DOSE^PSSORUTL(.ORDOSE,ORPSOI,$S($G(ORCAT)="I":"U",1:"O"),+ORVP)
"RTN","ORCDPS1",104,0)
 . K:$G(ORDOSE(1))=-1 ORDOSE Q:'$D(ORDOSE)
"RTN","ORCDPS1",105,0)
 . S ORDOSE("LOCAL")=0
"RTN","ORCDPS1",106,0)
 . N DOSAGE
"RTN","ORCDPS1",107,0)
 . S DOSAGE=0 F  S DOSAGE=$O(ORDOSE(DOSAGE)) Q:+$G(DOSAGE)=0  D
"RTN","ORCDPS1",108,0)
 . . S:+$P(ORDOSE(DOSAGE),U,1)=0 ORDOSE("LOCAL")=1
"RTN","ORCDPS1",109,0)
 Q
"RTN","ORCDPS1",110,0)
 ;
"RTN","ORCDPS1",111,0)
NFI(OI) ; -- Show NFI restrictions, if exist
"RTN","ORCDPS1",112,0)
 N PSOI,I,J,LCNT,MAX,X,STOP
"RTN","ORCDPS1",113,0)
 S PSOI=+$P($G(^ORD(101.43,+$G(OI),0)),U,2)
"RTN","ORCDPS1",114,0)
 D EN^PSSDIN(PSOI,"") Q:'$D(^TMP("PSSDIN",$J,"OI",PSOI))  ;DBIA 3166
"RTN","ORCDPS1",115,0)
 S I=0,LCNT=0,MAX=$S($G(IOBM)&$G(IOTM):IOBM-IOTM+1,1:24) W !
"RTN","ORCDPS1",116,0)
 F  S I=$O(^TMP("PSSDIN",$J,"OI",PSOI,I)) Q:I'>0  D
"RTN","ORCDPS1",117,0)
 . S J=0 F  S J=$O(^TMP("PSSDIN",$J,"OI",PSOI,I,J)) Q:J'>0  S X=$G(^(J)) D  Q:$G(STOP)
"RTN","ORCDPS1",118,0)
 .. S LCNT=LCNT+1 I LCNT'<MAX S:'$$CONT STOP=1 Q:$G(STOP)  S LCNT=1
"RTN","ORCDPS1",119,0)
 .. W !,X
"RTN","ORCDPS1",120,0)
 W ! K ^TMP("PSSDIN",$J,"OI",PSOI)
"RTN","ORCDPS1",121,0)
 Q
"RTN","ORCDPS1",122,0)
 ;
"RTN","ORCDPS1",123,0)
CONT() ; -- Cont or stop?
"RTN","ORCDPS1",124,0)
 N X,Y,DIR,DUOUT,DTOUT,DIRUT,DIROUT S DIR(0)="EA"
"RTN","ORCDPS1",125,0)
 S DIR("A")="Press <return> to continue or ^ to stop ..."
"RTN","ORCDPS1",126,0)
 D ^DIR S:$D(DUOUT)!$D(DTOUT) Y=""
"RTN","ORCDPS1",127,0)
 Q +Y
"RTN","ORCDPS1",128,0)
 ;
"RTN","ORCDPS1",129,0)
WAIT ; -- Wait for user
"RTN","ORCDPS1",130,0)
 N X W !,"Press <return> to continue ..." R X:DTIME
"RTN","ORCDPS1",131,0)
 Q
"RTN","ORCDPS1",132,0)
 ;
"RTN","ORCDPS1",133,0)
ROUTES ; -- Get med routes
"RTN","ORCDPS1",134,0)
 Q:$G(ORDIALOG(PROMPT,"LIST"))  N I,X,CNT S (I,CNT)=0
"RTN","ORCDPS1",135,0)
 F  S I=$O(^TMP("PSJMR",$J,I)) Q:I'>0  S X=^(I),CNT=CNT+1,ORDIALOG(PROMPT,"LIST",CNT)=$P(X,U,3)_U_$P(X,U,1,2),ORDIALOG(PROMPT,"LIST","B",$P(X,U))=$P(X,U,3)
"RTN","ORCDPS1",136,0)
 S:$G(CNT) ORDIALOG(PROMPT,"LIST")=CNT
"RTN","ORCDPS1",137,0)
 S:$G(ORTYPE)'="Z" REQD=$S(ORCAT="I":1,$P($G(^ORD(101.43,+$G(OROI),"PS")),U,5):0,1:1)
"RTN","ORCDPS1",138,0)
 Q
"RTN","ORCDPS1",139,0)
 ;
"RTN","ORCDPS1",140,0)
DEFRTE ; -- Get default route
"RTN","ORCDPS1",141,0)
 N INST1 S INST1=$O(ORDIALOG(PROMPT,0)) S:INST1'>0 INST1=INST
"RTN","ORCDPS1",142,0)
 I INST1=INST S Y=+$P($G(^TMP("PSJMR",$J,1)),U,3) K:Y'>0 Y Q
"RTN","ORCDPS1",143,0)
 S Y=+$G(ORDIALOG(PROMPT,INST1)) K:Y'>0 Y S:$G(Y) EDITONLY=1
"RTN","ORCDPS1",144,0)
 Q
"RTN","ORCDPS1",145,0)
 ;
"RTN","ORCDPS1",146,0)
CKSCH ; -- validate schedule [Called from P-S Action]
"RTN","ORCDPS1",147,0)
 N ORX S ORX=ORDIALOG(PROMPT,ORI) Q:ORX=$G(ORESET)  K ORSD
"RTN","ORCDPS1",148,0)
 D EN^PSSGS0(.ORX,$G(ORCAT))
"RTN","ORCDPS1",149,0)
 I $D(ORX) S ORDIALOG(PROMPT,ORI)=ORX D CHANGED("QUANTITY") Q  ;ok
"RTN","ORCDPS1",150,0)
 W $C(7),!,"Enter a standard schedule for administering this medication"
"RTN","ORCDPS1",151,0)
 K DONE I $G(ORCAT)="I" W ".",! Q
"RTN","ORCDPS1",152,0)
 W " or one of your own,",!,"up to 20 characters.",!
"RTN","ORCDPS1",153,0)
 Q
"RTN","ORCDPS1",154,0)
 ;
"RTN","ORCDPS1",155,0)
DEFCONJ ; -- Set default conjuction for previous instance [P-S Action]
"RTN","ORCDPS1",156,0)
 N LAST,DUR,CONJ
"RTN","ORCDPS1",157,0)
 S LAST=$O(ORDIALOG(PROMPT,ORI),-1) Q:LAST'>0  ;first instance
"RTN","ORCDPS1",158,0)
 S CONJ=$$PTR("AND/THEN") Q:$L($G(ORDIALOG(CONJ,LAST)))
"RTN","ORCDPS1",159,0)
 S DUR=$G(ORDIALOG($$PTR("DURATION"),LAST))
"RTN","ORCDPS1",160,0)
 S ORDIALOG(CONJ,LAST)=$S(+DUR'>0:"A",1:"T")
"RTN","ORCDPS1",161,0)
 Q
"RTN","ORCDPS1",162,0)
 ;
"RTN","ORCDPS1",163,0)
ENCONJ ; -- Get allowable values, if req'd for INST
"RTN","ORCDPS1",164,0)
 N P S P=$$PTR("INSTRUCTIONS")
"RTN","ORCDPS1",165,0)
 S:$G(ORTYPE)'="Z" REQD=$S($O(ORDIALOG(P,INST)):1,1:0) ;DJE/VM *350 quick orders should not require this field
"RTN","ORCDPS1",166,0)
 S ORDIALOG(PROMPT,"A")="And/then"_$S(ORCAT="O":"/except: ",1:": ")
"RTN","ORCDPS1",167,0)
 S $P(ORDIALOG(PROMPT,0),U,2)="A:AND;T:THEN;"_$S(ORCAT="O":"X:EXCEPT;",1:"")
"RTN","ORCDPS1",168,0)
 Q
"RTN","ORCDPS1",169,0)
 ;
"RTN","ORCDPS1",170,0)
INPCONJ ;
"RTN","ORCDPS1",171,0)
 N LETTER,DUR
"RTN","ORCDPS1",172,0)
 I $G(X)="" Q
"RTN","ORCDPS1",173,0)
 S LETTER=$$UP^XLFSTR($E(X,1))
"RTN","ORCDPS1",174,0)
 I LETTER'="T" Q
"RTN","ORCDPS1",175,0)
 S DUR=$$PTR("DURATION") I '$L($G(ORDIALOG(DUR,INST))) D
"RTN","ORCDPS1",176,0)
 .W !,"A duration is required when using a 'Then' conjunction."
"RTN","ORCDPS1",177,0)
 .K X
"RTN","ORCDPS1",178,0)
 Q
"RTN","ORCDPS1",179,0)
 ;
"RTN","ORCDPS1",180,0)
DSUP ; -- Get max/default days supply
"RTN","ORCDPS1",181,0)
 N ORX,Y
"RTN","ORCDPS1",182,0)
 S ORX("PATIENT")=+$G(ORVP),ORX("DRUG")=+$G(ORDRUG)
"RTN","ORCDPS1",183,0)
 D DSUP^PSOSIGDS(.ORX) S Y=+$G(ORX("DAYS SUPPLY")) S:Y'>0 Y=90
"RTN","ORCDPS1",184,0)
 ;S $P(ORDIALOG(PROMPT,0),U,2)="1:"_Y ;max allowed
"RTN","ORCDPS1",185,0)
 I '$G(ORDIALOG(PROMPT,1)),$G(ORTYPE)'="Z" S ORDIALOG(PROMPT,1)=Y
"RTN","ORCDPS1",186,0)
 Q
"RTN","ORCDPS1",187,0)
 ;
"RTN","ORCDPS1",188,0)
QTY() ; -- Return default quantity [Expects ORDSUP]
"RTN","ORCDPS1",189,0)
 N INSTR,DOSE,DUR,SCH,I,ORX,X,Y
"RTN","ORCDPS1",190,0)
 S Y="" I $G(ORDSUP)'>0!'$G(ORDRUG) G QTYQ ;need days supply, disp drug
"RTN","ORCDPS1",191,0)
 S INSTR=$$PTR("INSTRUCTIONS")
"RTN","ORCDPS1",192,0)
 S DOSE=$$PTR("DOSE"),CONJ=$$PTR("AND/THEN")
"RTN","ORCDPS1",193,0)
 S DUR=$$PTR("DURATION"),SCH=$$PTR("SCHEDULE")
"RTN","ORCDPS1",194,0)
 S I=0 F  S I=$O(ORDIALOG(INSTR,I)) Q:I'>0  D  Q:'$D(ORX)
"RTN","ORCDPS1",195,0)
 . S X=$P($G(ORDIALOG(DOSE,I)),"&",3) I X'>0 K ORX Q
"RTN","ORCDPS1",196,0)
 . S ORX("DOSE ORDERED",I)=X,ORX("SCHEDULE",I)=$G(ORDIALOG(SCH,I))
"RTN","ORCDPS1",197,0)
 . S X=$G(ORDIALOG(DUR,I)),ORX("DURATION",I)=$$HL7DUR^ORMBLDPS
"RTN","ORCDPS1",198,0)
 . S ORX("CONJUNCTION",I)=$G(ORDIALOG(CONJ,I))
"RTN","ORCDPS1",199,0)
 G:'$D(ORX) QTYQ ;no doses
"RTN","ORCDPS1",200,0)
 S ORX("PATIENT")=+$G(ORVP),ORX("DRUG")=+$G(ORDRUG)
"RTN","ORCDPS1",201,0)
 S ORX("DAYS SUPPLY")=+$G(ORDSUP)
"RTN","ORCDPS1",202,0)
 D QTYX^PSOSIG(.ORX) S Y=$G(ORX("QTY"))
"RTN","ORCDPS1",203,0)
QTYQ Q Y
"RTN","ORCDPS1",204,0)
 ;
"RTN","ORCDPS1",205,0)
MAXREFS ; -- Get max refills allowed [Entry Action]
"RTN","ORCDPS1",206,0)
 Q:$G(ORCAT)'="O"  N ORX,X
"RTN","ORCDPS1",207,0)
 S ORX("ITEM")=+$P($G(^ORD(101.43,+$G(OROI),0)),U,2)
"RTN","ORCDPS1",208,0)
 S ORX("DRUG")=+$G(ORDRUG),ORX("PATIENT")=+$G(ORVP)
"RTN","ORCDPS1",209,0)
 I $G(OREVENT),$$TYPE^OREVNTX(OREVENT)="D" S ORX("DISCHARGE")=1
"RTN","ORCDPS1",210,0)
 S ORX("DAYS SUPPLY")=$G(ORDSUP) D MAX^PSOSIGDS(.ORX)
"RTN","ORCDPS1",211,0)
 S OREFILLS=$G(ORX("MAX")),X=$G(ORDIALOG(PROMPT,INST))
"RTN","ORCDPS1",212,0)
 I OREFILLS'>0 S ORDIALOG(PROMPT,INST)=0 W !,"No refills allowed." Q
"RTN","ORCDPS1",213,0)
 S $P(ORDIALOG(PROMPT,0),U,2)="0:"_OREFILLS
"RTN","ORCDPS1",214,0)
 S ORDIALOG(PROMPT,"A")="Refills (0-"_OREFILLS_"): "
"RTN","ORCDPS1",215,0)
 I X,X>OREFILLS S ORDIALOG(PROMPT,INST)=OREFILLS
"RTN","ORCDPS1",216,0)
 Q
"RTN","ORCDPS1",217,0)
 ;
"RTN","ORCDPS1",218,0)
ASKSC() ; -- Return 1 or 0, if SC prompt should be asked
"RTN","ORCDPS1",219,0)
 I $$SC^PSOCP(+ORVP,+$G(ORDRUG)) Q 0
"RTN","ORCDPS1",220,0)
 ;I $$RXST^IBARXEU(+ORVP)>0 Q 0 ;exempt from copay
"RTN","ORCDPS1",221,0)
 Q 1
"RTN","ORCDPS1",222,0)
 ;
"RTN","ORCDPS1",223,0)
PTR(X) ; -- Return ptr to prompt OR GTX X
"RTN","ORCDPS1",224,0)
 Q +$O(^ORD(101.41,"AB","OR GTX "_X,0))
"RTN","ORCDPS1",225,0)
 ;
"RTN","ORCDPS1",226,0)
EXIT ; -- exit action for Meds
"RTN","ORCDPS1",227,0)
 S:$G(ORXNP) ORNP=ORXNP
"RTN","ORCDPS1",228,0)
 K ORXNP,ORINPT,ORCAT,ORPKG,OROI,ORIV,ORDRUG,ORDOSE,OROUTE,ORSCH,ORSD,ORDSUP,OREFILLS,ORQTY,ORQTYUNT,ORCOPAY,PSJNOPC,ORCOMPLX
"RTN","ORCDPS1",229,0)
 K ^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),^TMP("PSJSCH",$J)
"RTN","ORCDPS1",230,0)
 Q
"RTN","ORCDPS2")
0^42^B68376826
"RTN","ORCDPS2",1,0)
ORCDPS2 ;SLC/MKB-Pharmacy dialog utilities ;03/22/2013  06:51
"RTN","ORCDPS2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**94,116,125,131,243,311,350**;Dec 17, 1997;Build 77
"RTN","ORCDPS2",3,0)
 ;
"RTN","ORCDPS2",4,0)
COMPLEX() ; -- Single or complex?
"RTN","ORCDPS2",5,0)
 N X,Y,DIR,DUOUT,DTOUT,COMPLX
"RTN","ORCDPS2",6,0)
 S COMPLX=$S($O(ORDIALOG(PROMPT,"?"),-1)>1:1,$L($G(ORDIALOG($$PTR("DURATION"),1))):1,1:0)
"RTN","ORCDPS2",7,0)
 I $G(ORTYPE)="Z",ORDG=$O(^ORD(100.98,"B","NON-VA MEDICATIONS",0)),FIRST Q COMPLX
"RTN","ORCDPS2",8,0)
 I $G(ORTYPE)="Q",$O(ORDIALOG(PROMPT,0)),FIRST Q COMPLX
"RTN","ORCDPS2",9,0)
 I $D(ORENEW)!$D(OREWRITE)!$D(ORXFER)!COMPLX Q COMPLX
"RTN","ORCDPS2",10,0)
 I $D(OREDIT) Q:$D(ORCOMPLX)!COMPLX COMPLX G CP1 ;Q if complex or 'first, else ask
"RTN","ORCDPS2",11,0)
 I 'FIRST S Y=$S($D(ORCOMPLX):ORCOMPLX,1:COMPLX) Q Y
"RTN","ORCDPS2",12,0)
CP1 S DIR(0)="YA",DIR("A")="Complex dose? ",DIR("B")="NO"
"RTN","ORCDPS2",13,0)
 S DIR("?")="Enter YES if you wish to enter multiple sets of dosage instructions, a tapering dose, or to limit the duration of a single dose."
"RTN","ORCDPS2",14,0)
 D ^DIR S:$D(DTOUT) Y="^"
"RTN","ORCDPS2",15,0)
 Q Y
"RTN","ORCDPS2",16,0)
 ;
"RTN","ORCDPS2",17,0)
DOSES ; -- Available common doses
"RTN","ORCDPS2",18,0)
 ;S $P(ORDIALOG(PROMPT,0),U,2)=$S(ORCAT="I":"1:20",1:"1:80")
"RTN","ORCDPS2",19,0)
 S ORDIALOG(PROMPT,"A")="Dose"_$S(ORCAT="I"&$G(ORIV):" or Rate: ",1:": ")
"RTN","ORCDPS2",20,0)
 S $P(ORDIALOG(PROMPT,"?"),",",2)=$S($G(ORIV):" as either a dose amount or infusion rate.",1:" as a dose or amount.")
"RTN","ORCDPS2",21,0)
 I FIRST,'$O(ORDIALOG(PROMPT,0)),$G(ORXFER) D SHOWSIG^ORCMED
"RTN","ORCDPS2",22,0)
 S ORCOMPLX=$$COMPLEX,MULT=+ORCOMPLX I ORCOMPLX="^" S ORQUIT=1 Q
"RTN","ORCDPS2",23,0)
 Q:$G(ORDIALOG(PROMPT,"LIST"))  Q:'$D(ORDOSE)
"RTN","ORCDPS2",24,0)
D1 ; -- Entry from ORCMED,NF^ORCDPS to build list
"RTN","ORCDPS2",25,0)
 N I,J,X,DD,DRUG,DOSE,CONJ,CNT,UD,COST,TEXT
"RTN","ORCDPS2",26,0)
 S (I,CNT)=0,CONJ=$P($G(ORDOSE("MISC")),U,3) S:$L(CONJ) CONJ=" "_CONJ
"RTN","ORCDPS2",27,0)
 F  S I=$O(ORDOSE(I)) Q:I'>0  D
"RTN","ORCDPS2",28,0)
 . S X=ORDOSE(I),DD=+$P(X,U,6),DRUG=ORDOSE("DD",DD)
"RTN","ORCDPS2",29,0)
 . ;  =TotalDose^Units^U/D^Noun^LocalDose^DispDrugIEN^Cost
"RTN","ORCDPS2",30,0)
 . ;DD=Name^Cost^NF^DispUnit^Strength^Units^DoseForm^MaxRefills?
"RTN","ORCDPS2",31,0)
 . S DOSE=$P(X,U,5),UD=$P(X,U,3),COST=$P(X,U,7) Q:'$L(DOSE)
"RTN","ORCDPS2",32,0)
 . I '$P(X,U) S DOSE=DOSE_CONJ_" "_$S($L($P(DRUG,U,5)):$P(DRUG,U,5)_$P(DRUG,U,6),1:$P(DRUG,U))
"RTN","ORCDPS2",33,0)
 . ;I UD S COST="$"_$J(UD*$P(DRUG,U,2),1,3) ;_" per "_UD_" "_$P(X,U,4)
"RTN","ORCDPS2",34,0)
 . S TEXT=DOSE_$S($L(COST):"     $"_COST,1:"")_$S($P(DRUG,U,3):"   (non-formulary)",1:"")
"RTN","ORCDPS2",35,0)
 . S CNT=CNT+1,ORDIALOG(PROMPT,"LIST",CNT)=DOSE_U_TEXT
"RTN","ORCDPS2",36,0)
 . S ORDIALOG(PROMPT,"LIST","B",TEXT)=DOSE
"RTN","ORCDPS2",37,0)
 . S ORDIALOG(PROMPT,"LIST","D",DOSE)=DD ;default DispDrug
"RTN","ORCDPS2",38,0)
 . S ORDOSE("DD",DD,DOSE)=$P(ORDOSE(I),U,1,6)_U_$P(DRUG,U,5,6)
"RTN","ORCDPS2",39,0)
 . S J=0 F  S J=$O(ORDOSE(I,J)) Q:J'>0  D  ;xref alt forms of dose
"RTN","ORCDPS2",40,0)
 .. S DD=+$P(ORDOSE(I,J),U,6),DRUG=$G(ORDOSE("DD",DD))
"RTN","ORCDPS2",41,0)
 .. S ORDOSE("DD",DD,DOSE)=$P(ORDOSE(I,J),U,1,6)_U_$P(DRUG,U,5,6)
"RTN","ORCDPS2",42,0)
 S:CNT ORDIALOG(PROMPT,"LIST")=CNT
"RTN","ORCDPS2",43,0)
 Q
"RTN","ORCDPS2",44,0)
 ;
"RTN","ORCDPS2",45,0)
CHDOSE ; -- Kill dependent values if inst ORI of dose changes
"RTN","ORCDPS2",46,0)
 N X,PROMPTS,P,NAME,DOSE,DD S X=$G(ORDIALOG(PROMPT,ORI))
"RTN","ORCDPS2",47,0)
 ;S X=$$UP^XLFSTR(X),ORDIALOG(PROMPT,ORI)=X ;force uppercase
"RTN","ORCDPS2",48,0)
 I X,X'?1.N.E1.A.E K DONE W $C(7),!,"Enter the amount of this drug that the patient is to receive as a dose,",!,"NOT as the number of units per dose." Q
"RTN","ORCDPS2",49,0)
 I $L(X)>60,'$D(ORDIALOG(PROMPT,"LIST","B",X)) K DONE W $C(7),!,"Instructions may not be longer than 60 characters." Q
"RTN","ORCDPS2",50,0)
 I $G(ORESET)'=X D  ;kill dependent values if new/changed dose
"RTN","ORCDPS2",51,0)
 . S PROMPTS="STRENGTH^DRUG NAME^DOSE^DISPENSE DRUG^DAYS SUPPLY^QUANTITY^REFILLS"
"RTN","ORCDPS2",52,0)
 . F P=1:1:$L(PROMPTS,U) S NAME=$P(PROMPTS,U,P) K ORDIALOG($$PTR(NAME),ORI)
"RTN","ORCDPS2",53,0)
 . K ORQTY,ORQTYUNT,ORDRUG,ORDIALOG($$PTR("DISPENSE DRUG"),1)
"RTN","ORCDPS2",54,0)
 . K ^TMP("ORWORD",$J,$$PTR("SIG"))
"RTN","ORCDPS2",55,0)
 S DOSE=$$PTR("DOSE") I $L(X),'$L($G(ORDIALOG(DOSE,ORI))) D  ;set ID
"RTN","ORCDPS2",56,0)
 . S DD=+$G(ORDIALOG(PROMPT,"LIST","D",X))
"RTN","ORCDPS2",57,0)
 . S:DD ORDIALOG(DOSE,ORI)=$TR($G(ORDOSE("DD",DD,X)),"^","&")
"RTN","ORCDPS2",58,0)
 S DD=+$P($G(ORDIALOG(DOSE,ORI)),"&",6)
"RTN","ORCDPS2",59,0)
 I DD,$P($G(ORDOSE("DD",DD)),U,3) D NF^ORCDPS(DD) ;look for FormAlt
"RTN","ORCDPS2",60,0)
 I 'DD,(+$G(ORDOSE("LOCAL"))) W $C(7),!,"WARNING: Dosage check may not occur."
"RTN","ORCDPS2",61,0)
 Q
"RTN","ORCDPS2",62,0)
 ;
"RTN","ORCDPS2",63,0)
EXDOSE ; -- Exit Action
"RTN","ORCDPS2",64,0)
 Q:'$O(ORDIALOG(PROMPT,0))  N DRUG,MISC,QUIT,LAST
"RTN","ORCDPS2",65,0)
 S ORDRUG=$$DISPDRUG^ORCDPS,DRUG=$G(ORDOSE("DD",+ORDRUG))
"RTN","ORCDPS2",66,0)
 I ORDRUG D  I $G(QUIT) S ORQUIT=1 Q
"RTN","ORCDPS2",67,0)
 . ;I $P(DRUG,U,10),'$L($P($G(^VA(200,+$G(ORNP),"PS")),U,2)),'$L($P($G(^("PS")),U,3)) W $C(7),!,$P($G(^(0)),U)_" must have a DEA# or VA# to order this drug!" S QUIT=1 Q
"RTN","ORCDPS2",68,0)
 . ;I $P(DRUG,U,10)=1 W $C(7),!,"This order will require a wet signature!"
"RTN","ORCDPS2",69,0)
 . S ORDIALOG($$PTR("DISPENSE DRUG"),1)=ORDRUG
"RTN","ORCDPS2",70,0)
 . D:$G(ORCAT)="O" RESETID^ORCDPS
"RTN","ORCDPS2",71,0)
 . N STR,MED S STR=$P(DRUG,U,5)_$P(DRUG,U,6)
"RTN","ORCDPS2",72,0)
 . I STR'>0 S:'$G(ORDOSE(1)) ORDIALOG($$PTR("DRUG NAME"),1)=$P(DRUG,U) Q
"RTN","ORCDPS2",73,0)
 . S MED=$P($G(^ORD(101.43,+$G(OROI),0)),U)
"RTN","ORCDPS2",74,0)
 . I MED'[STR,ORCAT="O"!'$G(ORDOSE(1)) S ORDIALOG($$PTR("STRENGTH"),1)=STR
"RTN","ORCDPS2",75,0)
 I +ORDRUG'>0,ORCAT="O" W $C(7),!,"Cannot determine dispense drug - some defaults and order checks may not occur!"
"RTN","ORCDPS2",76,0)
EXD1 ; -- Kill dangling conjunction, [re]build Sig, get Qty info
"RTN","ORCDPS2",77,0)
 S LAST=$O(ORDIALOG(PROMPT,"?"),-1) K ORDIALOG($$PTR("AND/THEN"),LAST)
"RTN","ORCDPS2",78,0)
 D ADMIN^ORCDPS3 D:$G(ORTYPE)'="Z" SIG ;[re]build Sig/Text
"RTN","ORCDPS2",79,0)
 I ORDRUG,ORCAT="O" D  ;set Qty info
"RTN","ORCDPS2",80,0)
 . S:$L($P(DRUG,U,4)) ORQTYUNT=$P(DRUG,U,4)
"RTN","ORCDPS2",81,0)
 . S MISC=$$ENDCM^PSJORUTL(+ORDRUG),ORQTY=$P(MISC,U,4)
"RTN","ORCDPS2",82,0)
 . W:$L($P(MISC,U,2)) !!,$P(MISC,U,2),!
"RTN","ORCDPS2",83,0)
 Q
"RTN","ORCDPS2",84,0)
 ;
"RTN","ORCDPS2",85,0)
SIG ; -- Create ORDIALOG(SIG) from Instructions PROMPT,ORDOSE,ORDRUG,ORCAT
"RTN","ORCDPS2",86,0)
 ;    Return text in ^TMP("ORWORD",$J,SIG,INST)
"RTN","ORCDPS2",87,0)
 ;   [also called from PSJ^ORCSEND1 to build child orders]
"RTN","ORCDPS2",88,0)
 ;
"RTN","ORCDPS2",89,0)
 N ORT,ORSCH,ORDUR,ORID,ORDD,ORCNJ,ORMISC,ORPREP,ORX,ORI,CNT,ORSIG,ORS,DOSE
"RTN","ORCDPS2",90,0)
 S ORT=$$PTR("ROUTE"),ORSCH=$$PTR("SCHEDULE"),ORDUR=$$PTR("DURATION")
"RTN","ORCDPS2",91,0)
 S ORID=$$PTR("DOSE"),ORCNJ=$$PTR("AND/THEN"),ORS=$$PTR("SIG")
"RTN","ORCDPS2",92,0)
 S ORMISC=$G(ORDOSE("MISC")),ORPREP=$P(ORMISC,U,2)
"RTN","ORCDPS2",93,0)
 S ORX=$S(ORCAT="I":"",ORCAT="O"&(+$G(ISIMO)=1):"",$L($P(ORMISC,U)):$P(ORMISC,U)_" ",1:"") ;"TAKE "
"RTN","ORCDPS2",94,0)
 S (CNT,ORI)=0 F  S ORI=$O(ORDIALOG(PROMPT,ORI)) Q:ORI'>0  D
"RTN","ORCDPS2",95,0)
 . S DOSE=$G(ORDIALOG(PROMPT,ORI)) Q:'$L(DOSE)
"RTN","ORCDPS2",96,0)
 . S ORX=ORX_$$DOSE_$$RTE_$$SCH_$$DUR_$$CONJ
"RTN","ORCDPS2",97,0)
 . S CNT=CNT+1,ORSIG(CNT,0)=ORX,ORX=""
"RTN","ORCDPS2",98,0)
 Q:CNT'>0  S ORSIG(0)="^^"_CNT_U_CNT_U_DT_U
"RTN","ORCDPS2",99,0)
 K ^TMP("ORWORD",$J,ORS,1) M ^(1)=ORSIG S ORDIALOG(PROMPT,"FORMAT")="@"
"RTN","ORCDPS2",100,0)
 S ORDIALOG(ORS,1)=$NA(^TMP("ORWORD",$J,ORS,1))
"RTN","ORCDPS2",101,0)
 Q
"RTN","ORCDPS2",102,0)
 ;
"RTN","ORCDPS2",103,0)
PTR(X) ; -- Ptr to prompt OR GTX X
"RTN","ORCDPS2",104,0)
 Q +$O(^ORD(101.41,"AB","OR GTX "_X,0))
"RTN","ORCDPS2",105,0)
 ;
"RTN","ORCDPS2",106,0)
DOSE() ; -- Dosage
"RTN","ORCDPS2",107,0)
 N X0,Y S X0=$G(ORDIALOG(ORID,ORI)) ;ID string
"RTN","ORCDPS2",108,0)
 S Y=DOSE I ORDRUG,$L(X0) D  ;use local dose if common DispDrug
"RTN","ORCDPS2",109,0)
 . S:$L($P(X0,"&",5)) Y=$P(X0,"&",5) ;unless Outpt w/total dose
"RTN","ORCDPS2",110,0)
 . I ORCAT="O",X0 S Y=$$WORD($P(X0,"&",3))_" "_$P(X0,"&",4) ;u/d
"RTN","ORCDPS2",111,0)
 Q Y
"RTN","ORCDPS2",112,0)
 ;
"RTN","ORCDPS2",113,0)
WORD(X) ; -- Words for number X
"RTN","ORCDPS2",114,0)
 N X1,X2,Y S X1=$P(+X,"."),X2=$P(+X,".",2)
"RTN","ORCDPS2",115,0)
 S Y="" I X1 S Y=$S(X1=1:"ONE",X1=2:"TWO",X1=3:"THREE",X1=4:"FOUR",X1=5:"FIVE",X1=6:"SIX",X1=7:"SEVEN",X1=8:"EIGHT",X1=9:"NINE",X1=10:"TEN",1:X1)
"RTN","ORCDPS2",116,0)
 I X2 S Y=Y_$S($L(Y):" AND ",1:"")_$S(X2=5:"ONE-HALF",X2=33!(X2=34):"ONE-THIRD",X2=25:"ONE-FOURTH",X2=66!(X2=67):"TWO-THIRDS",X2=75:"THREE-FOURTHS",1:"."_X2)
"RTN","ORCDPS2",117,0)
 Q Y
"RTN","ORCDPS2",118,0)
 ;
"RTN","ORCDPS2",119,0)
RTE() ; -- Expansion of route
"RTN","ORCDPS2",120,0)
 N X,X0,Y S X=+$G(ORDIALOG(ORT,ORI)) Q:X'>0 ""
"RTN","ORCDPS2",121,0)
 K ^TMP($J,"ORCDPS2 RTE")
"RTN","ORCDPS2",122,0)
 D ALL^PSS51P2(+X,,,,"ORCDPS2 RTE")
"RTN","ORCDPS2",123,0)
 ;S X0=$G(^PS(51.2,+X,0)),Y=""
"RTN","ORCDPS2",124,0)
 I ORCAT="I"!(+$G(ISIMO)=1) S Y=" "_$S($L(^TMP($J,"ORCDPS2 RTE",+X,1)):^TMP($J,"ORCDPS2 RTE",+X,1),1:^TMP($J,"ORCDPS2 RTE",+X,.01))
"RTN","ORCDPS2",125,0)
 ;I ORCAT="I" S Y=" "_$S($L($P(X0,U,3)):$P(X0,U,3),1:$P(X0,U))
"RTN","ORCDPS2",126,0)
 I ORCAT="O",'+$G(ISIMO) S Y=" "_$S($L(ORPREP):ORPREP_" ",1:"")_$S($L(^TMP($J,"ORCDPS2 RTE",+X,4)):^TMP($J,"ORCDPS2 RTE",+X,4),1:^TMP($J,"ORCDPS2 RTE",+X,.01))
"RTN","ORCDPS2",127,0)
 Q Y
"RTN","ORCDPS2",128,0)
 ;
"RTN","ORCDPS2",129,0)
SCH() ; -- [outpatient] expansion of schedule
"RTN","ORCDPS2",130,0)
 N X,Y S X=$G(ORDIALOG(ORSCH,ORI))
"RTN","ORCDPS2",131,0)
 I $L(X),ORCAT="O",'+$G(ISIMO) D SCH^PSSUTIL1(.X)
"RTN","ORCDPS2",132,0)
 S Y=$S($L(X):" "_X,1:"")
"RTN","ORCDPS2",133,0)
 Q Y
"RTN","ORCDPS2",134,0)
 ;
"RTN","ORCDPS2",135,0)
DUR() ; -- Duration
"RTN","ORCDPS2",136,0)
 N X,Y S X=$G(ORDIALOG(ORDUR,ORI)),Y=""
"RTN","ORCDPS2",137,0)
 I X S Y=" FOR "_$$UP^XLFSTR(X)_$S(+X=X:" DAYS",1:"")
"RTN","ORCDPS2",138,0)
 Q Y
"RTN","ORCDPS2",139,0)
 ;
"RTN","ORCDPS2",140,0)
CONJ() ; -- Conjunction
"RTN","ORCDPS2",141,0)
 N X,Y S X=$G(ORDIALOG(ORCNJ,ORI))
"RTN","ORCDPS2",142,0)
 S:$L(X)>1 X=$E(X) S:X="E" S="X"
"RTN","ORCDPS2",143,0)
 S Y=$S(X="T":", THEN",X="X":" EXCEPT",X="A":" AND",1:"")
"RTN","ORCDPS2",144,0)
 Q Y
"RTN","ORCDPS2",145,0)
 ;
"RTN","ORCDPS2",146,0)
DOSETEXT        ; -- Reset dose text in ORDIALOG(INSTR) for backdoor orders
"RTN","ORCDPS2",147,0)
 ;    [Called from ORMPS1 - uses ORCAT,PSOI,ORVP,DRUG,INSTR,DOSE]
"RTN","ORCDPS2",148,0)
 ;
"RTN","ORCDPS2",149,0)
 N ORTYPE,ORDOSE,CONJ,ORDRUG,DRUG0,STRG,ORI,LDOSE,X,PROMPT
"RTN","ORCDPS2",150,0)
 S ORTYPE=$S($G(ORCAT)="I":"U",1:"O")
"RTN","ORCDPS2",151,0)
 D DOSE^PSSORUTL(.ORDOSE,+PSOI,ORTYPE,+ORVP)
"RTN","ORCDPS2",152,0)
 S CONJ=$P($G(ORDOSE("MISC")),U,3) S:$L(CONJ) CONJ=" "_CONJ
"RTN","ORCDPS2",153,0)
 S ORDRUG=+$G(ORDIALOG(DRUG,1)),DRUG0=$G(ORDOSE("DD",ORDRUG))
"RTN","ORCDPS2",154,0)
 S STRG=$P(DRUG0,U,5)_$P(DRUG0,U,6)
"RTN","ORCDPS2",155,0)
 I '$G(ORDOSE(1)) S ORI=0 F  S ORI=$O(ORDIALOG(INSTR,ORI)) Q:ORI'>0  D
"RTN","ORCDPS2",156,0)
 . S LDOSE=$G(ORDIALOG(INSTR,ORI)),X=$G(ORDIALOG(DOSE,ORI)) Q:'$L(X)
"RTN","ORCDPS2",157,0)
 . S:'X ORDIALOG(INSTR,ORI)=LDOSE_CONJ_" "_$S(STRG:STRG,1:$P(DRUG0,U))
"RTN","ORCDPS2",158,0)
 ; -build Sig/Text if not defined
"RTN","ORCDPS2",159,0)
 I '$D(ORDIALOG(+$$PTR("SIG"),1)) S PROMPT=INSTR D SIG
"RTN","ORCDPS2",160,0)
 Q
"RTN","ORCDPS2",161,0)
 ;
"RTN","ORCDPS2",162,0)
PI ; -- Include Pt Instructions w/Sig in Outpt order?
"RTN","ORCDPS2",163,0)
 N X,Y,DIR,DUOUT,DTOUT,DIRUT,ORTX,ORMAX,I,CNT
"RTN","ORCDPS2",164,0)
 I $G(ORCAT)'="O" D CLEARWP Q  ;!'$O(ORDOSE("PI",0))
"RTN","ORCDPS2",165,0)
 Q:$G(ORENEW)  S I=0,ORMAX=57
"RTN","ORCDPS2",166,0)
 I $G(OREDIT)!$G(OREWRITE),$O(^TMP("ORWORD",$J,PROMPT,INST,0)) K ORDOSE("PI") S I=0 F  S I=$O(^TMP("ORWORD",$J,PROMPT,INST,I)) Q:I<1  S ORDOSE("PI",I)=$G(^(I,0))
"RTN","ORCDPS2",167,0)
 I '$O(ORDOSE("PI",0)) D CLEARWP Q
"RTN","ORCDPS2",168,0)
 F  S I=$O(ORDOSE("PI",I)) Q:I'>0  S X=ORDOSE("PI",I) D TXT^ORCHTAB
"RTN","ORCDPS2",169,0)
 S DIR(0)="YA",DIR("A")="Include Patient Instructions in Sig? "
"RTN","ORCDPS2",170,0)
 S DIR("?")="Enter NO if you do not want these instructions included in the sig for this order",DIR("B")=$S($D(^TMP("ORWORD",$J,PROMPT)):"YES",1:"NO")
"RTN","ORCDPS2",171,0)
 W ! S I=0 F  S I=$O(ORTX(I)) Q:I'>0  W !,$S(I=1:"Patient Instructions: ",1:"                      ")_ORTX(I)
"RTN","ORCDPS2",172,0)
 D ^DIR I $D(DUOUT)!$D(DTOUT) S ORQUIT=1 Q
"RTN","ORCDPS2",173,0)
 I Y D  Q  ;save text
"RTN","ORCDPS2",174,0)
 . K ^TMP("ORWORD",$J,PROMPT,INST) S CNT=0
"RTN","ORCDPS2",175,0)
 . S I=0 F  S I=$O(ORDOSE("PI",I)) Q:I'>0  S ^TMP("ORWORD",$J,PROMPT,INST,I,0)=ORDOSE("PI",I),CNT=CNT+1
"RTN","ORCDPS2",176,0)
 . S ^TMP("ORWORD",$J,PROMPT,INST,0)="^^"_CNT_U_CNT_U_DT_U
"RTN","ORCDPS2",177,0)
 . S ORDIALOG(PROMPT,INST)="^TMP(""ORWORD"","_$J_","_PROMPT_","_INST_")"
"RTN","ORCDPS2",178,0)
 I Y'>0 K ORDIALOG(PROMPT,INST),^TMP("ORWORD",$J,PROMPT,INST)
"RTN","ORCDPS2",179,0)
 Q
"RTN","ORCDPS2",180,0)
 ;
"RTN","ORCDPS2",181,0)
CLEARWP ; -- Clear INST of wp field PROMPT
"RTN","ORCDPS2",182,0)
 K ORDIALOG(PROMPT,INST),^TMP("ORWORD",$J,PROMPT,INST)
"RTN","ORCDPS2",183,0)
 Q
"RTN","ORCDPS3")
0^52^B45751820
"RTN","ORCDPS3",1,0)
ORCDPS3 ;SLC/MKB-Pharmacy dialog utilities ;10/30/14  07:49
"RTN","ORCDPS3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**94,116,134,158,149,190,277,243,289,317,350**;Dec 17, 1997;Build 77
"RTN","ORCDPS3",3,0)
 ;
"RTN","ORCDPS3",4,0)
 ;Reference to SCNEW^PSOCP supported by IA #2534
"RTN","ORCDPS3",5,0)
 ;Reference to DIS^DGRPDB supported by IA #700
"RTN","ORCDPS3",6,0)
 ;Reference to ^PSJORPOE supported by IA #3167
"RTN","ORCDPS3",7,0)
 ;
"RTN","ORCDPS3",8,0)
START ; -- Start Date entry action
"RTN","ORCDPS3",9,0)
 S $P(ORDIALOG(PROMPT,0),":",3)=$S($G(ORCAT)="I":"ETRX",1:"EX")
"RTN","ORCDPS3",10,0)
 I $G(ORCAT)'="I" K ORSD K:$G(ORENEW)!$G(OREWRITE)!$D(OREDIT) ORDIALOG(PROMPT,INST) ;Inpt only
"RTN","ORCDPS3",11,0)
 Q
"RTN","ORCDPS3",12,0)
 ;
"RTN","ORCDPS3",13,0)
ADMIN ; -- Return default admin time for order in ORSD
"RTN","ORCDPS3",14,0)
 ;    Called from EXDOSE^ORCDPS2
"RTN","ORCDPS3",15,0)
 Q:$D(ORSD)  Q:$G(ORCAT)'="I"  ;inpt only
"RTN","ORCDPS3",16,0)
 N PSOI,PSIFN,SCH,CNJ,ORI,ORX
"RTN","ORCDPS3",17,0)
 S PSOI=+$P($G(^ORD(101.43,+$G(OROI),0)),U,2)
"RTN","ORCDPS3",18,0)
 S PSIFN=$S($G(ORENEW):$G(^OR(100,+$G(ORIFN),4)),1:"")
"RTN","ORCDPS3",19,0)
 S SCH=$$PTR^ORCD("OR GTX SCHEDULE"),CNJ=$$PTR^ORCD("OR GTX AND/THEN"),ORX=""
"RTN","ORCDPS3",20,0)
 S ORI=0 F  S ORI=$O(ORDIALOG(PROMPT,ORI)) Q:ORI<1  S ORX=ORX_$S($L(ORX):U,1:"")_$G(ORDIALOG(CNJ,ORI))_";"_$G(ORDIALOG(SCH,ORI))
"RTN","ORCDPS3",21,0)
 S ORSD=$$FIRST(+ORVP,+$G(ORWARD),PSOI,ORX,PSIFN,"")
"RTN","ORCDPS3",22,0)
 S:$P(ORSD,U)="NEXT" ORSD="NEXTA^"_$P(ORSD,U,2,99)
"RTN","ORCDPS3",23,0)
 Q
"RTN","ORCDPS3",24,0)
 ;
"RTN","ORCDPS3",25,0)
FIRST(DFN,WARD,OI,DATA,ORDER,ADMIN)   ; -- Return expected first admin time of order
"RTN","ORCDPS3",26,0)
 N CNT,ORCNT,ORI,J,ORZ,Y,SCH,ORX,TNUM
"RTN","ORCDPS3",27,0)
 I '$G(DFN)!'$G(OI) Q ""
"RTN","ORCDPS3",28,0)
 S ORCNT=0 F ORI=1:1:$L(DATA,"^") S ORZ=$P(DATA,U,ORI) D  Q:$E(ORZ)="T"
"RTN","ORCDPS3",29,0)
 .S TNUM=$$NUMCHAR(ORZ,";") Q:TNUM=0
"RTN","ORCDPS3",30,0)
 .F CNT=1:1:TNUM D
"RTN","ORCDPS3",31,0)
 .. S SCH=$P(ORZ,";",CNT+1) Q:'$L(SCH)  S ORCNT=ORCNT+1
"RTN","ORCDPS3",32,0)
 .. I ORCNT>1 S ADMIN=""
"RTN","ORCDPS3",33,0)
 .. S ORX(ORCNT)=$$STARTSTP^PSJORPOE(DFN,SCH,OI,WARD,$G(ORDER),$G(ADMIN))
"RTN","ORCDPS3",34,0)
 S Y=9999999,J=0
"RTN","ORCDPS3",35,0)
 F ORI=1:1:ORCNT S ORZ=$P(ORX(ORI),U,4) I ORZ<Y S Y=ORZ,J=ORI ;earliest
"RTN","ORCDPS3",36,0)
 S Y=$S(J:ORX(J),1:"")
"RTN","ORCDPS3",37,0)
 Q Y
"RTN","ORCDPS3",38,0)
 ;
"RTN","ORCDPS3",39,0)
NUMCHAR(STRING,SUB) ;
"RTN","ORCDPS3",40,0)
 N CNT,RESULT
"RTN","ORCDPS3",41,0)
 S RESULT=0
"RTN","ORCDPS3",42,0)
 F CNT=1:1:$L(STRING) I $E(STRING,CNT)=SUB S RESULT=RESULT+1
"RTN","ORCDPS3",43,0)
 Q RESULT
"RTN","ORCDPS3",44,0)
 ;
"RTN","ORCDPS3",45,0)
NOW ; -- First dose now?
"RTN","ORCDPS3",46,0)
 N X,Y,DIR,SCH
"RTN","ORCDPS3",47,0)
 K ^TMP($J,"ORCDPS3 NOW")
"RTN","ORCDPS3",48,0)
 ;DJE/VM *317 added check on ORIVTYPE. Don't require dosage for intermittent IVs
"RTN","ORCDPS3",49,0)
 I $G(ORCAT)="O"!(('$D(ORSD))&($G(ORIVTYPE)'="I"))!$L($G(OREVENT))!$G(ORENEW) K ORDIALOG(PROMPT,INST),^TMP($J,"ORCDPS3 NOW") Q
"RTN","ORCDPS3",50,0)
 D AP^PSS51P1("PSJ",,,,"ORCDPS3 NOW")
"RTN","ORCDPS3",51,0)
 ; ask on Copy? Change?
"RTN","ORCDPS3",52,0)
 S X=$$PTR^ORCD("OR GTX SCHEDULE"),Y=+$O(ORDIALOG(X,0))
"RTN","ORCDPS3",53,0)
 S SCH=$G(ORDIALOG(X,Y)),Y=+$O(^TMP($J,"ORCDPS3 NOW","APPSJ",SCH,0)) ;1st one
"RTN","ORCDPS3",54,0)
 ;S SCH=$G(ORDIALOG(X,Y)),Y=+$O(^PS(51.1,"APPSJ",SCH,0)) ;1st one
"RTN","ORCDPS3",55,0)
 I $P($G(^TMP($J,"ORCDPS3 NOW",Y,5)),"^")="O"!(Y<1) K ORDIALOG(PROMPT,INST),^TMP($J,"ORCDPS3 NOW") Q
"RTN","ORCDPS3",56,0)
 ;I $P($G(^PS(51.1,Y,0)),U,5)="O"!(Y<1) K ORDIALOG(PROMPT,INST),^TMP($J,"ORCDPS3 NOW") Q
"RTN","ORCDPS3",57,0)
 ; other conditions?
"RTN","ORCDPS3",58,0)
 S DIR(0)="YA",DIR("A")="Give additional dose NOW? "
"RTN","ORCDPS3",59,0)
 S DIR("B")=$S($G(ORDIALOG(PROMPT,INST)):"YES",1:"NO")
"RTN","ORCDPS3",60,0)
 I $G(ORINPT),$P(ORSD,U,4) S DIR("A",1)="Next scheduled administration time: "_$$FMTE^XLFDT($P(ORSD,U,4))
"RTN","ORCDPS3",61,0)
 S DIR("?")="Enter YES if you want a dose given now in addition to the regular administration times for this schedule and ward."
"RTN","ORCDPS3",62,0)
 D ^DIR S:$D(DTOUT)!$D(DUOUT) ORQUIT=1
"RTN","ORCDPS3",63,0)
 I $G(ORQUIT)!(Y'>0) K ORDIALOG(PROMPT,INST),^TMP($J,"ORCDPS3 NOW") Q
"RTN","ORCDPS3",64,0)
 S ORDIALOG(PROMPT,INST)=1 I $G(ORCOMPLX) D
"RTN","ORCDPS3",65,0)
 . W $C(7),!,"  >> First Dose NOW is in addition to those already entered.    <<"
"RTN","ORCDPS3",66,0)
 . W !,"  >> Please adjust the duration of the first one, if necessary. <<"
"RTN","ORCDPS3",67,0)
 K ^TMP($J,"ORCDPS3 NOW")
"RTN","ORCDPS3",68,0)
 Q
"RTN","ORCDPS3",69,0)
 ;
"RTN","ORCDPS3",70,0)
DEFSTRT ; -- Returns default start date/time in Y
"RTN","ORCDPS3",71,0)
 ;    Expects PROMPT,INST,ORDIALOG,ORSD to be defined
"RTN","ORCDPS3",72,0)
 ;
"RTN","ORCDPS3",73,0)
 Q:$G(ORCAT)="O"  Q:$G(ORTYPE)="Z"  ;skip if outpt or editor
"RTN","ORCDPS3",74,0)
 N LAST,STRT,DUR,D1,D2,OFF,F1,F2,UNT,Y1,Y2,I,J K Y
"RTN","ORCDPS3",75,0)
 S LAST=+$O(ORDIALOG(+$$PTR^ORCD("OR GTX INSTRUCTIONS"),INST),-1)
"RTN","ORCDPS3",76,0)
 S STRT=$G(ORDIALOG(PROMPT,LAST))
"RTN","ORCDPS3",77,0)
 I LAST'>0!'$L(STRT) S:$L($P($G(ORSD),U)) Y=$P(ORSD,U) Q  ;first inst
"RTN","ORCDPS3",78,0)
 S DUR=$G(ORDIALOG(+$$PTR^ORCD("OR GTX DURATION"),LAST))
"RTN","ORCDPS3",79,0)
 I +DUR'>0 S Y=STRT Q  ;no duration = same start
"RTN","ORCDPS3",80,0)
 S DUR=$$FMDUR(DUR) I STRT D  Q  ;FM date/time, so just add
"RTN","ORCDPS3",81,0)
 . N X,%DT S %DT="TX",X=STRT_"+"_DUR D ^%DT
"RTN","ORCDPS3",82,0)
 . I Y'>0 S Y=STRT ;error
"RTN","ORCDPS3",83,0)
 S D1=+DUR,D2=$P(DUR,D1,2) S:(STRT="NEXTA")!(STRT="CLOSEST") STRT="NOW"
"RTN","ORCDPS3",84,0)
 S OFF=$P(STRT,"+",2) I '$L(OFF) S Y=STRT_"+"_DUR Q  ;no prev offset
"RTN","ORCDPS3",85,0)
 S F1=+OFF,F2=$P(OFF,F1,2),UNT=F2,Y=STRT
"RTN","ORCDPS3",86,0)
 I D2=F2 S Y=$P(STRT,"+")_"+"_(D1+F1)_UNT Q  ;same units
"RTN","ORCDPS3",87,0)
 F I="S","'","H","D","W","M" I (F2=I)!(D2=I) S UNT=I D  Q
"RTN","ORCDPS3",88,0)
 . S:D2=UNT Y1=D1,X1=F1,X2=F2 ; Y1=# in UNT
"RTN","ORCDPS3",89,0)
 . S:F2=UNT Y1=F1,X1=D1,X2=D2 ; X1=# in other units X2
"RTN","ORCDPS3",90,0)
 . F J=1:1 S Z=$T(CONV+J) Q:Z["ZZZZ"  I $P(Z,";",3,4)=(X2_";"_UNT) S Y2=+$P(Z,";",5) Q
"RTN","ORCDPS3",91,0)
 . S Y=$P(STRT,"+")_"+"_(Y1+$S(Y2:Y2*X1,1:0))_UNT
"RTN","ORCDPS3",92,0)
 Q
"RTN","ORCDPS3",93,0)
 ;
"RTN","ORCDPS3",94,0)
FMDUR(X)        ; -- convert '# DAYS' to #D
"RTN","ORCDPS3",95,0)
 N X1,X2,Y I +X'>0 Q ""
"RTN","ORCDPS3",96,0)
 S X1=+X,X2=$P(X," ",2) S:'$L(X2) X2="DAYS"
"RTN","ORCDPS3",97,0)
 S Y=X1_$S("MINUTES"[X2:"'",1:$E(X2))
"RTN","ORCDPS3",98,0)
 Q Y
"RTN","ORCDPS3",99,0)
 ;
"RTN","ORCDPS3",100,0)
CONV ;;unit;unit;factor
"RTN","ORCDPS3",101,0)
 ;;';S;60
"RTN","ORCDPS3",102,0)
 ;;H;';60
"RTN","ORCDPS3",103,0)
 ;;H;S;3600
"RTN","ORCDPS3",104,0)
 ;;D;H;24
"RTN","ORCDPS3",105,0)
 ;;D;';1440
"RTN","ORCDPS3",106,0)
 ;;D;S;86400
"RTN","ORCDPS3",107,0)
 ;;W;D;7
"RTN","ORCDPS3",108,0)
 ;;W;H;168
"RTN","ORCDPS3",109,0)
 ;;W;';10080
"RTN","ORCDPS3",110,0)
 ;;W;S;604800
"RTN","ORCDPS3",111,0)
 ;;M;W;4
"RTN","ORCDPS3",112,0)
 ;;M;D;30
"RTN","ORCDPS3",113,0)
 ;;M;H;720
"RTN","ORCDPS3",114,0)
 ;;M;';43200
"RTN","ORCDPS3",115,0)
 ;;M;S;2592000
"RTN","ORCDPS3",116,0)
 ;;ZZZZ
"RTN","ORCDPS3",117,0)
 ;
"RTN","ORCDPS3",118,0)
ASKDUR()        ; -- Returns 1 or 0, if Duration prompt should be asked
"RTN","ORCDPS3",119,0)
 K ^TMP($J,"ORCDPS3 ASKDUR")
"RTN","ORCDPS3",120,0)
 N X,Y I '$G(ORCOMPLX) K ORDIALOG(PROMPT,INST) Q 0
"RTN","ORCDPS3",121,0)
 S Y=1 G:'$L($G(ORSCH)) ADQ ;no schedule
"RTN","ORCDPS3",122,0)
 D AP^PSS51P1("PSJ",,,,"ORCDPS3 ASKDUR")
"RTN","ORCDPS3",123,0)
 S X=+$O(^TMP($J,"ORCDPS3 ASKDUR","APPSJ",ORSCH,"")) G:X'>0 ADQ
"RTN","ORCDPS3",124,0)
 ;S X=+$O(^PS(51.1,"APPSJ",ORSCH,0)) G:X'>0 ADQ
"RTN","ORCDPS3",125,0)
 S:^TMP($J,"ORCDPS3 ASKDUR",X,5)="O" Y=0
"RTN","ORCDPS3",126,0)
 ;S:$P($G(^PS(51.1,X,0)),U,5)="O" Y=0
"RTN","ORCDPS3",127,0)
ADQ ;
"RTN","ORCDPS3",128,0)
 K ^TMP($J,"ORCDPS3 ASKDUR")
"RTN","ORCDPS3",129,0)
 Q Y
"RTN","ORCDPS3",130,0)
 ;
"RTN","ORCDPS3",131,0)
CKDUR(X) ; -- Returns validated form of duration X, or null if invalid
"RTN","ORCDPS3",132,0)
 N X1,X2,Y,Z S Y=""
"RTN","ORCDPS3",133,0)
 S X1=+$G(X),X2=$P($G(X),X1,2) I X1'>0 Q ""
"RTN","ORCDPS3",134,0)
 S X2=$$UP^XLFSTR(X2),X2=$$STRIP^XLFSTR(X2," ") S:'$L(X2) X2="DAYS"
"RTN","ORCDPS3",135,0)
 F Z="MONTHS^&MONTHS&MONS","WEEKS^&WEEKS&WKS","DAYS^&DAYS&DYS","HOURS^&HOURS&HRS","MINUTES^&MINUTES&MINS'","SECONDS^&SECONDS&SECS" I $P(Z,U,2)[("&"_X2) S Y=$P(Z,U) Q
"RTN","ORCDPS3",136,0)
 S:$L(Y) Y=X1_" "_$S(X1=1:$E(Y,1,$L(Y)-1),1:Y) ;strip trailing 's'
"RTN","ORCDPS3",137,0)
 Q Y
"RTN","ORCDPS3",138,0)
 ;
"RTN","ORCDPS3",139,0)
DUR ; -- Process duration [from P-S Action]
"RTN","ORCDPS3",140,0)
 N X S X=$G(ORDIALOG(PROMPT,ORI)),X=$$CKDUR(X)
"RTN","ORCDPS3",141,0)
 I '$L(X) K DONE W $C(7),!,ORDIALOG(PROMPT,"?"),! Q
"RTN","ORCDPS3",142,0)
 S ORDIALOG(PROMPT,ORI)=X D:$G(ORESET)'=X CHANGED^ORCDPS1("QUANTITY")
"RTN","ORCDPS3",143,0)
 Q
"RTN","ORCDPS3",144,0)
 ;
"RTN","ORCDPS3",145,0)
TEST(START,DURTN)       ; -- test DEFSTRT
"RTN","ORCDPS3",146,0)
 N INST,ORSD,ORDIALOG,PROMPT
"RTN","ORCDPS3",147,0)
 S ORDIALOG(136,1)="",INST=2,ORSD="NOW",PROMPT=6
"RTN","ORCDPS3",148,0)
 S:$L($G(START)) ORDIALOG(6,1)=START S:$G(DURTN) ORDIALOG(153,1)=DURTN
"RTN","ORCDPS3",149,0)
 D DEFSTRT W !,Y
"RTN","ORCDPS3",150,0)
 Q
"RTN","ORCDPS3",151,0)
 ;
"RTN","ORCDPS3",152,0)
SC ; -- Dialog validation, to ask SC questions
"RTN","ORCDPS3",153,0)
 ;    Expects ORIFN, ORDA, and ORDER
"RTN","ORCDPS3",154,0)
 ;
"RTN","ORCDPS3",155,0)
 Q:'$L($T(SCNEW^PSOCP))  Q:'$G(ORIFN)  Q:'$G(ORDA)
"RTN","ORCDPS3",156,0)
 Q:$P($G(^OR(100,ORIFN,0)),U,12)'="O"  Q:$P($G(^(8,ORDA,0)),U,2)'="NW"  Q:$P($G(^(0)),U,15)=""
"RTN","ORCDPS3",157,0)
 ;
"RTN","ORCDPS3",158,0)
 N OR3,ORDRUG,PSIFN,ORX,I,J,DIE,DR,DA,X,Y,DTOUT,ORIGVIEW,DFN
"RTN","ORCDPS3",159,0)
 S OR3=$G(^OR(100,ORIFN,3)),X=$P(OR3,U,11) I X>2 Q  ;new, edit, or renew
"RTN","ORCDPS3",160,0)
 I X S Y=$P(OR3,U,5),PSIFN=$G(^OR(100,Y,4)) ;get PS# if edit/renewal
"RTN","ORCDPS3",161,0)
 S ORDRUG=$$VALUE^ORCSAVE2(ORIFN,"DRUG")
"RTN","ORCDPS3",162,0)
 D SCNEW^PSOCP(.ORX,+ORVP,ORDRUG,$G(PSIFN)) Q:'$D(ORX)
"RTN","ORCDPS3",163,0)
 S DIE="^OR(100,",DA=ORIFN,DR="",J=0
"RTN","ORCDPS3",164,0)
 F I="SC","MST","AO","IR","EC","HNC","CV" S J=J+1 I $D(ORX(I)) S X=ORX(I) S:I="CV"&(X="") X=1 S DR=DR_";5"_J_"R"_$S($L(X):"//"_$S(X:"YES",1:"NO"),1:"")
"RTN","ORCDPS3",165,0)
 S:$E(DR)=";" DR=$E(DR,2,999) Q:'$L(DR)  S ORIGVIEW=1
"RTN","ORCDPS3",166,0)
 I $D(ORX("SC")) S DFN=+ORVP D DIS^DGRPDB ;show current SC data
"RTN","ORCDPS3",167,0)
 W !!,"Is "_$$ORDITEM^ORCACT(ORDER)_" for treatment related to:"
"RTN","ORCDPS3",168,0)
 D ^DIE S:$D(DTOUT)!$D(Y) ORQUIT=1
"RTN","ORCDPS3",169,0)
 Q
"RTN","ORCDPS3",170,0)
PRI ; Validate Priority for Outpatient orders
"RTN","ORCDPS3",171,0)
 I X?1"D".E!(X?1"d".E) K X
"RTN","ORCDPS3",172,0)
 Q
"RTN","ORCXPND1")
0^17^B97571749
"RTN","ORCXPND1",1,0)
ORCXPND1 ; SLC/MKB - Expanded Display cont ;09/21/12  05:58
"RTN","ORCXPND1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**26,67,75,89,92,94,148,159,188,172,215,243,280,340,306,350**;Dec 17, 1997;Build 77
"RTN","ORCXPND1",3,0)
 ;
"RTN","ORCXPND1",4,0)
 ; External References
"RTN","ORCXPND1",5,0)
 ;   DBIA  2387  ^LAB(60
"RTN","ORCXPND1",6,0)
 ;   DBIA  3420  ^DPT(  file #2
"RTN","ORCXPND1",7,0)
 ;   DBIA 10035  ^DPT(  file #2
"RTN","ORCXPND1",8,0)
 ;   DBIA 10037  EN^DGRPD
"RTN","ORCXPND1",9,0)
 ;   DBIA   700  DIS^DGRPDB
"RTN","ORCXPND1",10,0)
 ;   DBIA  2926  RT^GMRCGUIA
"RTN","ORCXPND1",11,0)
 ;   DBIA  2925  DT^GMRCSLM2                     ^TMP("GMRCR"
"RTN","ORCXPND1",12,0)
 ;   DBIA  2503  RR^LR7OR1                       ^TMP("LRRR"
"RTN","ORCXPND1",13,0)
 ;   DBIA  2951  EN1^LR7OSBR                     ^TMP("LRC"
"RTN","ORCXPND1",14,0)
 ;   DBIA  2952  EN^LR7OSMZ0
"RTN","ORCXPND1",15,0)
 ;   DBIA  2400  OEL^PSOORRL                     ^TMP("PS"
"RTN","ORCXPND1",16,0)
 ;   DBIA  2877  EN3^RAO7PC3
"RTN","ORCXPND1",17,0)
 ;   DBIA  2877  EN30^RAO7PC3
"RTN","ORCXPND1",18,0)
 ;   DBIA  1252  $$OUTPTPR^SDUTL3
"RTN","ORCXPND1",19,0)
 ;   DBIA  1252  $$OUTPTTM^SDUTL3
"RTN","ORCXPND1",20,0)
 ;   DBIA  2832  RPC^TIUSRV
"RTN","ORCXPND1",21,0)
 ;   DBIA 10061  DEM^VADPT
"RTN","ORCXPND1",22,0)
 ;   DBIA 10061  KVAR^VADPT
"RTN","ORCXPND1",23,0)
 ;   DBIA 10061  OAD^VADPT
"RTN","ORCXPND1",24,0)
 ;   DBIA 10103  $$FMTE^XLFDT
"RTN","ORCXPND1",25,0)
 ;   DBIA  4408  DISP^DGIBDSP
"RTN","ORCXPND1",26,0)
 ;   DBIA  5697  START^SCMCMHTC
"RTN","ORCXPND1",27,0)
 ;
"RTN","ORCXPND1",28,0)
COVER ; -- Cover Sheet
"RTN","ORCXPND1",29,0)
 N PKG S PKG=$P($G(^TMP("OR",$J,ORTAB,"IDX",NUM)),U,4)
"RTN","ORCXPND1",30,0)
 D ALLERGY^ORCXPND2:PKG="GMRA",NOTES:PKG="TIU"
"RTN","ORCXPND1",31,0)
 Q
"RTN","ORCXPND1",32,0)
NOTES ; -- Progress Notes
"RTN","ORCXPND1",33,0)
 N I,ORY,DATE,AUTHOR,PTLOC,SUBJ K ^TMP("TIUAUDIT",$J)
"RTN","ORCXPND1",34,0)
 D RPC^TIUSRV(.ORY,ID)
"RTN","ORCXPND1",35,0)
 S I=0 F  S I=$O(@ORY@(I)) Q:I'>0  S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$G(@ORY@(I,0))
"RTN","ORCXPND1",36,0)
 K @ORY
"RTN","ORCXPND1",37,0)
 Q
"RTN","ORCXPND1",38,0)
PROBLEMS ; -- Problem List
"RTN","ORCXPND1",39,0)
 D PL^ORCXPND4
"RTN","ORCXPND1",40,0)
 Q
"RTN","ORCXPND1",41,0)
MEDS ; -- Pharmacy
"RTN","ORCXPND1",42,0)
 ;N NODE,ORIFN
"RTN","ORCXPND1",43,0)
 K ^TMP("PS",$J)
"RTN","ORCXPND1",44,0)
 D OEL^PSOORRL(+ORVP,ID) ;S NODE=$G(^TMP("PS",$J,0)),ORIFN=+$P(NODE,U,11)
"RTN","ORCXPND1",45,0)
 S ID=+$P($G(^TMP("PS",$J,0)),U,11) D ORDERS  ;DBIA 2400
"RTN","ORCXPND1",46,0)
 ;D @($S($P($G(^OR(100,ORIFN,0)),U,11)=$O(^ORD(100.98,"B","IV RX",0)):"IV",1:"DRUG")_"^ORCXPND2")
"RTN","ORCXPND1",47,0)
 K ^TMP("PS",$J)
"RTN","ORCXPND1",48,0)
 Q
"RTN","ORCXPND1",49,0)
LABS ; -- Laboratory [RESULTS ONLY for ID=OE order #]
"RTN","ORCXPND1",50,0)
 N ORIFN,X,SUB,TEST,NAME,SS,IDE,IVDT,TST,CCNT,ORCY,IG,TCNT
"RTN","ORCXPND1",51,0)
 K ^TMP("LRRR",$J)  ;DBIA 2503
"RTN","ORCXPND1",52,0)
 I (ID?2.5E1" "2N1" "1.N1"-"7N1"."1.4N)!(ID?2.5E1" "2N1" "1.N1"-"7N) D AP^ORCXPND3 Q  ;ID=Accession #-Date/time specimen taken
"RTN","ORCXPND1",53,0)
 S ORIFN=+ID,IDE=$G(^OR(100,+ID,4)) Q:'$L(IDE)  ; OE# -> Lab#
"RTN","ORCXPND1",54,0)
 I $P(IDE,";",5) D RR^LR7OR1(+ORVP,,9999999-$P(IDE,";",5),9999999-$P(IDE,";",5),$P(IDE,";",4)) ;lookup on file 63 first
"RTN","ORCXPND1",55,0)
 I '$P(IDE,";",5),+IDE D RR^LR7OR1(+ORVP,IDE) I '$D(^TMP("LRRR",$J,+ORVP)) S $P(IDE,";",1,3)=";;"
"RTN","ORCXPND1",56,0)
 K ORCY D TEXT^ORQ12(.ORCY,ORIFN,80)
"RTN","ORCXPND1",57,0)
 S IG=0 F  S IG=$O(ORCY(IG)) Q:IG<1  S X=ORCY(IG) D ITEM^ORCXPND(X)
"RTN","ORCXPND1",58,0)
 D BLANK^ORCXPND I '$D(^TMP("LRRR",$J,+ORVP)) S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="No data available." Q
"RTN","ORCXPND1",59,0)
 M TEST=^TMP("LRRR",$J,+ORVP) S CCNT=0,SS=""
"RTN","ORCXPND1",60,0)
 F  S SS=$O(TEST(SS)) Q:SS=""  S IVDT=0 F  S IVDT=$O(TEST(SS,IVDT)) Q:'IVDT  D
"RTN","ORCXPND1",61,0)
 . I SS="BB" D
"RTN","ORCXPND1",62,0)
 .. I $$GET^XPAR("DIV^SYS^PKG","OR VBECS ON",1,"Q"),$L($T(EN^ORWLR1)),$L($T(CPRS^VBECA3B)) D  Q  ;Transition to VBEC's interface
"RTN","ORCXPND1",63,0)
 ... K ^TMP("ORLRC",$J)
"RTN","ORCXPND1",64,0)
 ... D EN^ORWLR1(DFN)
"RTN","ORCXPND1",65,0)
 ... I '$O(^TMP("ORLRC",$J,0)) S ^TMP("ORLRC",$J,1,0)="",^TMP("ORLRC",$J,2,0)="No Blood Bank report available..."
"RTN","ORCXPND1",66,0)
 ... N I S I=0 F  S I=$O(^TMP("ORLRC",$J,I)) Q:I<1  S X=^(I,0),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",67,0)
 ... K ^TMP("ORLRC",$J)
"RTN","ORCXPND1",68,0)
 .. K ^TMP("LRC",$J) D EN1^LR7OSBR(+ORVP) Q:'$D(^TMP("LRC",$J))  D  Q  ;DBIA 2951
"RTN","ORCXPND1",69,0)
 ... N I S I=0 F  S I=$O(^TMP("LRC",$J,I)) Q:I<1  S X=^(I,0),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",70,0)
 ... K ^TMP("LRC",$J)
"RTN","ORCXPND1",71,0)
 . I SS="MI" K ^TMP("LRC",$J) D EN^LR7OSMZ0(+ORVP) Q:'$D(^TMP("LRC",$J))  D  Q
"RTN","ORCXPND1",72,0)
 .. N I S I=0 F  S I=$O(^TMP("LRC",$J,I)) Q:I<1  S X=^(I,0),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",73,0)
 .. K ^TMP("LRC",$J)
"RTN","ORCXPND1",74,0)
 . I SS="CH" D  Q
"RTN","ORCXPND1",75,0)
 .. S (TCNT,TST)=0 F  S TST=$O(TEST(SS,IVDT,TST)) Q:TST=""  S CCNT=0,TCNT=TCNT+1 D
"RTN","ORCXPND1",76,0)
 ... I TCNT=1 D
"RTN","ORCXPND1",77,0)
 .... S LINE="Collection time: "_$$FMTE^XLFDT(9999999-IVDT,"M")
"RTN","ORCXPND1",78,0)
 .... D SETLINE(LINE,.LCNT)
"RTN","ORCXPND1",79,0)
 .... S LINE=$$S(1,CCNT," ")_$$S(3,CCNT,"Test Name")_$$S(29,CCNT,"Result")_$$S(39,CCNT,"Units")_$$S(55,CCNT,"Range")_$$S(63,CCNT,"Site Code")
"RTN","ORCXPND1",80,0)
 .... D SETLINE(LINE,.LCNT)
"RTN","ORCXPND1",81,0)
 .... D:$D(IOUON) SETVIDEO^ORCXPND(LCNT,1,70,IOUON,IOUOFF)
"RTN","ORCXPND1",82,0)
 ... I TST S XT=TEST(SS,IVDT,TST),CCNT=0 I +XT D
"RTN","ORCXPND1",83,0)
 .... S LINE=$$S(1,CCNT,$P(^LAB(60,+XT,0),U))_$$S(26,CCNT,$J($P(XT,U,2),7))_$$S(34,CCNT,$S($L($P(XT,U,3)):$P(XT,U,3),1:""))_$$S(39,CCNT,$P(XT,U,4))_$$S(45,CCNT,$J($P(XT,U,5),15))_$$S(61,CCNT,$J($S($L($P(XT,U,20)):"["_$P(XT,U,20)_"]",1:""),10))
"RTN","ORCXPND1",84,0)
 .... D SETLINE(LINE,.LCNT)
"RTN","ORCXPND1",85,0)
 .... I $P(XT,U,20) S ^TMP("ORPLS",$J,$P(XT,U,20))=""
"RTN","ORCXPND1",86,0)
 .... I $L($P(XT,U,3)),$D(IOINHI) D SETVIDEO^ORCXPND(LCNT,26,8,IOINHI,IOINORM)
"RTN","ORCXPND1",87,0)
 .... I $P(XT,U,3)["*",$D(IOBON),$D(IOINHI) D SETVIDEO^ORCXPND(LCNT,26,8,IOBON_IOINHI,IOBOFF_IOINORM)
"RTN","ORCXPND1",88,0)
 ... I TST="N" S LINE=" Comments: " D
"RTN","ORCXPND1",89,0)
 .... D SETLINE(LINE,.LCNT)
"RTN","ORCXPND1",90,0)
 .... N CMT S CMT=0 F  S CMT=$O(TEST(SS,IVDT,"N",CMT)) Q:'CMT  S LINE=" "_TEST(SS,IVDT,"N",CMT) D SETLINE(LINE,.LCNT)
"RTN","ORCXPND1",91,0)
 I $L($O(^TMP("ORPLS",$J,""))) D SETLINE(" ",.LCNT),SETLINE(" ",.LCNT),SETLINE("===============================================================================",.LCNT),PLS
"RTN","ORCXPND1",92,0)
 D SETLINE(" ",.LCNT)
"RTN","ORCXPND1",93,0)
 K ^TMP("LRRR",$J)
"RTN","ORCXPND1",94,0)
 Q
"RTN","ORCXPND1",95,0)
 ;
"RTN","ORCXPND1",96,0)
PLS ; List performing laboratories
"RTN","ORCXPND1",97,0)
 N LINE,ORPLS,X
"RTN","ORCXPND1",98,0)
 D SETLINE("Performing Lab Sites",.LCNT)
"RTN","ORCXPND1",99,0)
 S ORPLS=0
"RTN","ORCXPND1",100,0)
 F  S ORPLS=$O(^TMP("ORPLS",$J,ORPLS)) Q:ORPLS<1  D
"RTN","ORCXPND1",101,0)
 . S LINE=$$LJ^XLFSTR("["_ORPLS_"] ",8)_$$NAME^XUAF4(ORPLS)
"RTN","ORCXPND1",102,0)
 . D SETLINE(LINE,.LCNT)
"RTN","ORCXPND1",103,0)
 . S X=$$PADD^XUAF4(ORPLS)
"RTN","ORCXPND1",104,0)
 . S LINE=$$REPEAT^XLFSTR(" ",8)_$P(X,U)_" "_$P(X,U,2)_", "_$P(X,U,3)_" "_$P(X,U,4)
"RTN","ORCXPND1",105,0)
 . D SETLINE(LINE,.LCNT)
"RTN","ORCXPND1",106,0)
 D SETLINE("===============================================================================",.LCNT)
"RTN","ORCXPND1",107,0)
 K ^TMP("ORPLS",$J)
"RTN","ORCXPND1",108,0)
 Q
"RTN","ORCXPND1",109,0)
 ;
"RTN","ORCXPND1",110,0)
SETLINE(LINE,CNT) ;
"RTN","ORCXPND1",111,0)
 S CNT=CNT+1,^TMP("ORXPND",$J,CNT,0)=LINE
"RTN","ORCXPND1",112,0)
 Q
"RTN","ORCXPND1",113,0)
 ;
"RTN","ORCXPND1",114,0)
DELAY ; -- Delayed Orders
"RTN","ORCXPND1",115,0)
NEW ; -- New Orders
"RTN","ORCXPND1",116,0)
ORDERS ; -- Orders
"RTN","ORCXPND1",117,0)
 I '$G(ORESULTS) D ORDERS^ORCXPND2 Q
"RTN","ORCXPND1",118,0)
 ; -- Results Display (Add more packages as available)
"RTN","ORCXPND1",119,0)
 N PKG,TAB,ORIFN
"RTN","ORCXPND1",120,0)
 S PKG=+$P($G(^OR(100,+ID,0)),"^",14),PKG=$$NMSP^ORCD(PKG)
"RTN","ORCXPND1",121,0)
 S TAB=$S(PKG="LR":"LABS",PKG="GMRC":"CONSULTS",PKG="RA":"XRAYS",1:"")
"RTN","ORCXPND1",122,0)
 I '$L(TAB)!(ID'>0) D  Q  ; no display available
"RTN","ORCXPND1",123,0)
 . N ORY,I D TEXT^ORQ12(.ORY,+ID,80)
"RTN","ORCXPND1",124,0)
 . S I=0 F  S I=$O(ORY(I)) Q:I'>0  D ITEM^ORCXPND(ORY(I))
"RTN","ORCXPND1",125,0)
 . D BLANK^ORCXPND
"RTN","ORCXPND1",126,0)
 . S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="There are no results to report."
"RTN","ORCXPND1",127,0)
 I $O(^OR(100,+ID,2,0)) S ORIFN=+ID,ID=0 F  S ID=$O(^OR(100,ORIFN,2,ID)) Q:ID<1  I $D(^OR(100,ID,0)) D @TAB
"RTN","ORCXPND1",128,0)
 I '$O(^OR(100,+ID,2,0)) D @TAB
"RTN","ORCXPND1",129,0)
 Q
"RTN","ORCXPND1",130,0)
REPORTS ; -- Patient Profiles
"RTN","ORCXPND1",131,0)
 D EN^ORCXPNDR ; Reports
"RTN","ORCXPND1",132,0)
 Q
"RTN","ORCXPND1",133,0)
CONSULTS ; -- Consults
"RTN","ORCXPND1",134,0)
 N I,X,SUB,ORTX ;,VALMAR
"RTN","ORCXPND1",135,0)
 I $G(ORTAB)="CONSULTS" S X=$P($G(^TMP("OR",$J,ORTAB,"IDX",NUM)),U,4)
"RTN","ORCXPND1",136,0)
 E  D TEXT^ORQ12(.ORTX,+ID) S X=ORTX(1),ID=+$G(^OR(100,+ID,4)) ; OE->GMRC order#
"RTN","ORCXPND1",137,0)
 D ITEM^ORCXPND(X),BLANK^ORCXPND
"RTN","ORCXPND1",138,0)
 I ID'>0 S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="No data available." Q
"RTN","ORCXPND1",139,0)
 I '$G(ORESULTS) D  ;DT action
"RTN","ORCXPND1",140,0)
 . S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="Consult No.:           "_ID
"RTN","ORCXPND1",141,0)
 . N GMRCOER S GMRCOER=2 D DT^GMRCSLM2(ID) S SUB="DT"  ;DBIA 2925
"RTN","ORCXPND1",142,0)
 I $G(ORESULTS) D RT^GMRCGUIA(ID,"^TMP(""GMRCR"",$J,""RT"")") S SUB="RT"
"RTN","ORCXPND1",143,0)
 S I=0 F  S I=$O(^TMP("GMRCR",$J,SUB,I)) Q:I'>0  S X=$G(^(I,0)),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X  ;DBIA 2925
"RTN","ORCXPND1",144,0)
 K ^TMP("GMRCR",$J)
"RTN","ORCXPND1",145,0)
 Q
"RTN","ORCXPND1",146,0)
XRAYS ; -- Radiology
"RTN","ORCXPND1",147,0)
 I '$G(ORESULTS) S ID=+ORVP_U_$TR(ID,"-","^") D EN3^RAO7PC3(ID)
"RTN","ORCXPND1",148,0)
 I $G(ORESULTS) S ID=+$G(^OR(100,+ID,4)) D EN30^RAO7PC3(ID)
"RTN","ORCXPND1",149,0)
 N CASE,PROC,PSET S PSET=$D(^TMP($J,"RAE3",+ORVP,"PRINT_SET"))
"RTN","ORCXPND1",150,0)
 S CASE=0 F  S CASE=$O(^TMP($J,"RAE3",+ORVP,CASE)) Q:CASE'>0  D
"RTN","ORCXPND1",151,0)
 . I PSET S PROC=$O(^TMP($J,"RAE3",+ORVP,CASE,"")) D ITEM^ORCXPND(PROC) Q
"RTN","ORCXPND1",152,0)
 . S PROC="" F  S PROC=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC)) Q:PROC=""  D ITEM^ORCXPND(PROC),BLANK^ORCXPND,XRPT,BLANK^ORCXPND
"RTN","ORCXPND1",153,0)
 I PSET S CASE=$O(^TMP($J,"RAE3",+ORVP,0)),PROC=$O(^(CASE,"")) D BLANK^ORCXPND,XRPT,BLANK^ORCXPND ;printset=list all procs, then one report
"RTN","ORCXPND1",154,0)
 K ^TMP($J,"RAE3",+ORVP),^UTILITY($J,"W")
"RTN","ORCXPND1",155,0)
 S VALM("RM")=81
"RTN","ORCXPND1",156,0)
 Q
"RTN","ORCXPND1",157,0)
 ;
"RTN","ORCXPND1",158,0)
XRPT ; -- Body of Report for CASE, PROC
"RTN","ORCXPND1",159,0)
 N ORD,X,I
"RTN","ORCXPND1",160,0)
 S ORD=$S($L($G(^TMP($J,"RAE3",+ORVP,"ORD"))):^("ORD"),$L($G(^("ORD",CASE))):^(CASE),1:"") I $L(ORD),ORD'=PROC S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="Proc Ord: "_ORD
"RTN","ORCXPND1",161,0)
 S I=1 F  S I=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC,I)) Q:I'>0  S X=^(I),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X ;Skip pt ID on line 1
"RTN","ORCXPND1",162,0)
 Q
"RTN","ORCXPND1",163,0)
 ;
"RTN","ORCXPND1",164,0)
SUMMRIES ; -- Discharge Summaries
"RTN","ORCXPND1",165,0)
 N I,ORY,DATE,AUTHOR,PTLOC,SUBJ K ^TMP("TIUAUDIT",$J)
"RTN","ORCXPND1",166,0)
 D RPC^TIUSRV(.ORY,ID)
"RTN","ORCXPND1",167,0)
 S I=0 F  S I=$O(@ORY@(I)) Q:I'>0  S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=$G(@ORY@(I,0))
"RTN","ORCXPND1",168,0)
 K @ORY
"RTN","ORCXPND1",169,0)
 Q
"RTN","ORCXPND1",170,0)
PTINQ ; Print Patient Inquiry in List Manager
"RTN","ORCXPND1",171,0)
 N DFN,ORI,X
"RTN","ORCXPND1",172,0)
 S DFN=+ORVP
"RTN","ORCXPND1",173,0)
 D DGINQ(DFN)
"RTN","ORCXPND1",174,0)
 S ORI=4,LCNT=0
"RTN","ORCXPND1",175,0)
 F  S ORI=$O(^TMP("ORDATA",$J,1,ORI)) Q:'ORI  S X=^(ORI) D
"RTN","ORCXPND1",176,0)
 . S LCNT=LCNT+1
"RTN","ORCXPND1",177,0)
 . S ^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORCXPND1",178,0)
 K ^TMP("ORDATA",$J,1)
"RTN","ORCXPND1",179,0)
 Q
"RTN","ORCXPND1",180,0)
 ;
"RTN","ORCXPND1",181,0)
DGINQ(DFN) ; Patient Inquiry
"RTN","ORCXPND1",182,0)
 D START^ORWRP(80,"DGINQB^ORCXPND1(DFN)")
"RTN","ORCXPND1",183,0)
 Q
"RTN","ORCXPND1",184,0)
DGINQB(DFN) ; Build Patient Inquiry
"RTN","ORCXPND1",185,0)
 N CONTACT,ORDOC,ORTEAM,ORMHP,ORVP,XQORNOD,ORSSTRT,ORSSTOPT,VAOA,CPRSGUI,ORINP,ORATP,ORASS
"RTN","ORCXPND1",186,0)
 S ORVP=DFN_";DPT(",XQORNOD=1,CPRSGUI=1
"RTN","ORCXPND1",187,0)
 D EN^DGRPD ; MAS Patient Inquiry
"RTN","ORCXPND1",188,0)
 K CPRSGUI
"RTN","ORCXPND1",189,0)
 ;
"RTN","ORCXPND1",190,0)
 S ORDOC=$$OUTPTPR^SDUTL3(DFN)
"RTN","ORCXPND1",191,0)
 S ORTEAM=$$OUTPTTM^SDUTL3(DFN)
"RTN","ORCXPND1",192,0)
 S ORMHP=$$START^SCMCMHTC(DFN) ;Retrieve Mental Health Provider
"RTN","ORCXPND1",193,0)
 S ORINP=$G(^DPT(DFN,.104))
"RTN","ORCXPND1",194,0)
 S ORATP=$G(^DPT(DFN,.1041))
"RTN","ORCXPND1",195,0)
 S ORASS=$P($$OUTPTAP^SDUTL3(DFN,DT),U,2)
"RTN","ORCXPND1",196,0)
 I ORDOC!ORTEAM!ORMHP!ORINP!ORATP  D
"RTN","ORCXPND1",197,0)
 . W !!,"Primary Care Information:"
"RTN","ORCXPND1",198,0)
 . I ORDOC W !,"Primary Practitioner: ",$P(ORDOC,"^",2)
"RTN","ORCXPND1",199,0)
 . I ORTEAM W !,"Primary Care Team:    ",$P(ORTEAM,"^",2)
"RTN","ORCXPND1",200,0)
 . I $$INPT^ORWPT1(DFN) D
"RTN","ORCXPND1",201,0)
 . . I ORATP W !,"Attending Physician:  ",$P($G(^VA(200,+ORATP,0)),U)
"RTN","ORCXPND1",202,0)
 . . I ORINP W !,"Inpatient Provider:   ",$P($G(^VA(200,+ORINP,0)),U)
"RTN","ORCXPND1",203,0)
 . I $L(ORASS) W !,"Associate Provider:   ",ORASS
"RTN","ORCXPND1",204,0)
 . I ORMHP D
"RTN","ORCXPND1",205,0)
 .. W !!,"MH Treatment Information:"
"RTN","ORCXPND1",206,0)
 .. W !,"MH Treatment Coord:   ",$E($P(ORMHP,"^",2),1,28) D
"RTN","ORCXPND1",207,0)
 ... W ?52,"Position: ",$E($P(ORMHP,"^",3),1,18)
"RTN","ORCXPND1",208,0)
 .. W !,"MH Treatment Team:    ",$E($P(ORMHP,"^",5),1,56)
"RTN","ORCXPND1",209,0)
 W !!,"Health Insurance Information:"
"RTN","ORCXPND1",210,0)
 D DISP^DGIBDSP  ;DBIA #4408
"RTN","ORCXPND1",211,0)
 W !!,"Service Connection/Rated Disabilities:"
"RTN","ORCXPND1",212,0)
 D DIS^DGRPDB
"RTN","ORCXPND1",213,0)
 F CONTACT="N","S" D
"RTN","ORCXPND1",214,0)
 .S VAOA("A")=$S(CONTACT="N":"",1:3)
"RTN","ORCXPND1",215,0)
 .D OAD^VADPT ;   Get NOK Information
"RTN","ORCXPND1",216,0)
 .I VAOA(9)]"" D
"RTN","ORCXPND1",217,0)
 .. W !!,$S(CONTACT="N":"Next of Kin Information:",1:"Secondary Next of Kin Information:")
"RTN","ORCXPND1",218,0)
 .. W !,"Name:  ",VAOA(9)                          ;     NOK Name
"RTN","ORCXPND1",219,0)
 .. I VAOA(10)]"" W " (",VAOA(10),")"              ;     Relationship
"RTN","ORCXPND1",220,0)
 .. I VAOA(1)]"" W !?7,VAOA(1)                     ;     Address Line 1
"RTN","ORCXPND1",221,0)
 .. I VAOA(2)]"" W !?7,VAOA(2)                     ;     Line 2
"RTN","ORCXPND1",222,0)
 .. I VAOA(3)]"" W !?7,VAOA(3)                     ;     Line 3
"RTN","ORCXPND1",223,0)
 .. I VAOA(4)]"" D
"RTN","ORCXPND1",224,0)
 .. . W !?7,VAOA(4)                                ;     City
"RTN","ORCXPND1",225,0)
 .. . I VAOA(5)]"" W ", "_$P(VAOA(5),"^",2)        ;     State
"RTN","ORCXPND1",226,0)
 .. . W "  ",$P(VAOA(11),"^",2)                    ;     Zip+4
"RTN","ORCXPND1",227,0)
 .. I VAOA(8)]"" W !!?7,"Phone number:  ",VAOA(8)  ;     Phone
"RTN","ORCXPND1",228,0)
 .. I CONTACT="N",$P($G(^DPT(DFN,.21)),U,11)]"" W !?7,"Work phone number:  ",$P(^DPT(DFN,.21),U,11)
"RTN","ORCXPND1",229,0)
 .. I CONTACT="S",$P($G(^DPT(DFN,.211)),U,11)]"" W !?7,"Work phone number:  ",$P(^DPT(DFN,.211),U,11)
"RTN","ORCXPND1",230,0)
 D KVAR^VADPT
"RTN","ORCXPND1",231,0)
 Q
"RTN","ORCXPND1",232,0)
TRIM(X) ;   Trim Spaces
"RTN","ORCXPND1",233,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","ORCXPND1",234,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","ORCXPND1",235,0)
 Q X
"RTN","ORCXPND1",236,0)
S(X,Y,Z) ; Pad Over
"RTN","ORCXPND1",237,0)
 ;   X=Column #
"RTN","ORCXPND1",238,0)
 ;   Y=Current Length
"RTN","ORCXPND1",239,0)
 ;   Z=Text
"RTN","ORCXPND1",240,0)
 ;   SP=Text Sent
"RTN","ORCXPND1",241,0)
 ;   CCNT=Line Position After Input Text
"RTN","ORCXPND1",242,0)
 I '$D(Z) Q ""
"RTN","ORCXPND1",243,0)
 N SP S SP=Z I X,Y,X>Y S SP=$E("                                                                             ",1,X-Y)_Z
"RTN","ORCXPND1",244,0)
 S CCNT=$$INC(CCNT,SP)
"RTN","ORCXPND1",245,0)
 Q SP
"RTN","ORCXPND1",246,0)
INC(X,Y) ; Character Position Count
"RTN","ORCXPND1",247,0)
 ;   X=Current Count
"RTN","ORCXPND1",248,0)
 ;   Y=Text
"RTN","ORCXPND1",249,0)
 N INC S INC=X+$L(Y)
"RTN","ORCXPND1",250,0)
 Q INC
"RTN","ORDD100A")
0^62^B8843443
"RTN","ORDD100A",1,0)
ORDD100A ;SLC/DCM - DD ENTRIES FOR FILE 100 ;11/03/2014  13:28
"RTN","ORDD100A",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**24,138,157,350**;Dec 17, 1997;Build 77
"RTN","ORDD100A",3,0)
ACT1(ORIFN,ORDA,ORADT,ORVP,ORDG) ; -- set "ACT" x-ref
"RTN","ORDD100A",4,0)
 Q:'$G(ORIFN)  Q:'$G(ORDA)  N OR0
"RTN","ORDD100A",5,0)
 S OR0=$G(^OR(100,ORIFN,0)) S:'$G(ORADT) ORADT=$P($G(^(8,ORDA,0)),U)
"RTN","ORDD100A",6,0)
 S:'$G(ORVP) ORVP=$P(OR0,U,2) S:'$G(ORDG) ORDG=$P(OR0,U,11)
"RTN","ORDD100A",7,0)
 I ORVP,ORADT,ORDG S ^OR(100,"ACT",ORVP,9999999-ORADT,ORDG,ORIFN,ORDA)=""
"RTN","ORDD100A",8,0)
 Q
"RTN","ORDD100A",9,0)
 ;
"RTN","ORDD100A",10,0)
ACT2(ORIFN,ORDA,ORADT,ORVP,ORDG) ; -- kill "ACT" x-ref
"RTN","ORDD100A",11,0)
 Q:'$G(ORIFN)  Q:'$G(ORDA)  N OR0
"RTN","ORDD100A",12,0)
 S OR0=$G(^OR(100,ORIFN,0)) S:'$G(ORADT) ORADT=$P($G(^(8,ORDA,0)),U)
"RTN","ORDD100A",13,0)
 S:'$G(ORVP) ORVP=$P(OR0,U,2) S:'$G(ORDG) ORDG=$P(OR0,U,11)
"RTN","ORDD100A",14,0)
 I ORVP,ORADT,ORDG K ^OR(100,"ACT",ORVP,9999999-ORADT,ORDG,ORIFN,ORDA)
"RTN","ORDD100A",15,0)
 Q
"RTN","ORDD100A",16,0)
 ;
"RTN","ORDD100A",17,0)
ES ; -- set "AE" x-ref
"RTN","ORDD100A",18,0)
 N DAES,OI,ORO,ORSTOP,X,X1
"RTN","ORDD100A",19,0)
 S ORO=$G(^OR(100,DA,0))
"RTN","ORDD100A",20,0)
 S ORSTOP=+$P(ORO,U,9) ;138
"RTN","ORDD100A",21,0)
 I ORSTOP,ORSTOP'<DT S ^OR(100,"AE",ORSTOP,DA)="" ;138
"RTN","ORDD100A",22,0)
 ;If there is no start date try to get the release date.
"RTN","ORDD100A",23,0)
 S X(3)=$P(ORO,U,8)
"RTN","ORDD100A",24,0)
 I X(3)="" S X(3)=$$RDATE^ORPXRM(DA)
"RTN","ORDD100A",25,0)
 I X(3)="" Q
"RTN","ORDD100A",26,0)
 S DAES(1)=DA,X(1)=$P(ORO,U,2),X(4)=ORSTOP
"RTN","ORDD100A",27,0)
 S X1(1)=X(1),X1(3)=X(3),X1(4)=""
"RTN","ORDD100A",28,0)
 S OI=0 F  S OI=$O(^OR(100,DA,.1,OI)) Q:OI'>0  D
"RTN","ORDD100A",29,0)
 . S (X(2),X1(2))=+$G(^(OI,0)),DAES=OI
"RTN","ORDD100A",30,0)
 .;If there is an entry without a stop date kill it before creating
"RTN","ORDD100A",31,0)
 .;the new one.
"RTN","ORDD100A",32,0)
 . D KOR^ORPXRM(.X1,.DAES)
"RTN","ORDD100A",33,0)
 . D SOR^ORPXRM(.X,.DAES)
"RTN","ORDD100A",34,0)
 Q
"RTN","ORDD100A",35,0)
EK ; -- kill "AE" x-ref
"RTN","ORDD100A",36,0)
 N ORX
"RTN","ORDD100A",37,0)
 S ORX=$G(X)
"RTN","ORDD100A",38,0)
 N DAEK,OI,ORSTOP,X
"RTN","ORDD100A",39,0)
 S ORO=$G(^OR(100,DA,0))
"RTN","ORDD100A",40,0)
 S ORSTOP=$P(ORO,U,9)
"RTN","ORDD100A",41,0)
 I ORSTOP K ^OR(100,"AE",ORSTOP,DA)
"RTN","ORDD100A",42,0)
 I ORX K ^OR(100,"AE",ORX,DA)
"RTN","ORDD100A",43,0)
 ;If there is no start date try to get the release date.
"RTN","ORDD100A",44,0)
 S X(3)=$P(ORO,U,8)
"RTN","ORDD100A",45,0)
 I X(3)="" S X(3)=$$RDATE^ORPXRM(DA)
"RTN","ORDD100A",46,0)
 I X(3)="" Q
"RTN","ORDD100A",47,0)
 S DAEK(1)=DA,X(1)=$P(ORO,U,2),X(4)=ORSTOP
"RTN","ORDD100A",48,0)
 S OI=0 F  S OI=$O(^OR(100,DA,.1,OI)) Q:OI'>0  D
"RTN","ORDD100A",49,0)
 . S X(2)=+$G(^(OI,0)),DAEK=OI
"RTN","ORDD100A",50,0)
 . D KOR^ORPXRM(.X,.DAEK)
"RTN","ORDD100A",51,0)
 Q
"RTN","ORDD100A",52,0)
 ;
"RTN","ORDD100A",53,0)
OI1(ORIFN) ; -- set "AOI" x-ref
"RTN","ORDD100A",54,0)
 N DA,OI,OR0,ORVP,ORSTRT,ORSTOP,ORIT,X,X1
"RTN","ORDD100A",55,0)
 Q:'$D(^OR(100,ORIFN,.1))  S OR0=$G(^(0))
"RTN","ORDD100A",56,0)
 S ORVP=$P(OR0,U,2) Q:'ORVP
"RTN","ORDD100A",57,0)
 S ORSTRT=$P(OR0,U,8) Q:'ORSTRT
"RTN","ORDD100A",58,0)
 S ORSTOP=$P(OR0,U,9)
"RTN","ORDD100A",59,0)
 S DA(1)=ORIFN
"RTN","ORDD100A",60,0)
 S (X(1),X1(1))=ORVP
"RTN","ORDD100A",61,0)
 S X(3)=ORSTRT,X1(3)=$$RDATE^ORPXRM(ORIFN)
"RTN","ORDD100A",62,0)
 S (X(4),X1(4))=ORSTOP
"RTN","ORDD100A",63,0)
 S OI=0 F  S OI=$O(^OR(100,ORIFN,.1,OI)) Q:OI'>0  D
"RTN","ORDD100A",64,0)
 . S ORIT=+$G(^(OI,0)) S:ORIT ^OR(100,"AOI",ORIT,ORVP,9999999-ORSTRT,ORIFN)=""
"RTN","ORDD100A",65,0)
 . S (X(2),X1(2))=ORIT,DA=OI
"RTN","ORDD100A",66,0)
 . D KOR^ORPXRM(.X1,.DA)
"RTN","ORDD100A",67,0)
 . D SOR^ORPXRM(.X,.DA)
"RTN","ORDD100A",68,0)
 Q
"RTN","ORDD100A",69,0)
 ;
"RTN","ORDD100A",70,0)
OI2(ORIFN) ; -- kill "AOI" x-ref
"RTN","ORDD100A",71,0)
 N DA,OI,OR0,ORVP,ORSTRT,ORSTOP,ORIT,X
"RTN","ORDD100A",72,0)
 Q:'$D(^OR(100,ORIFN,.1))  S OR0=$G(^(0))
"RTN","ORDD100A",73,0)
 S ORVP=$P(OR0,U,2) Q:'ORVP
"RTN","ORDD100A",74,0)
 S ORSTRT=$P(OR0,U,8) Q:'ORSTRT
"RTN","ORDD100A",75,0)
 S ORSTOP=$P(OR0,U,9)
"RTN","ORDD100A",76,0)
 S DA(1)=ORIFN,X(1)=ORVP,X(3)=ORSTRT,X(4)=ORSTOP
"RTN","ORDD100A",77,0)
 S OI=0 F  S OI=$O(^OR(100,ORIFN,.1,OI)) Q:OI'>0  D
"RTN","ORDD100A",78,0)
 . S ORIT=+$G(^(OI,0)) K:ORIT ^OR(100,"AOI",ORIT,ORVP,9999999-ORSTRT,ORIFN)
"RTN","ORDD100A",79,0)
 . S X(2)=ORIT,DA=OI
"RTN","ORDD100A",80,0)
 . D KOR^ORPXRM(.X,.DA)
"RTN","ORDD100A",81,0)
 Q
"RTN","ORDEA01")
0^51^B46652455
"RTN","ORDEA01",1,0)
ORDEA01 ;ISP/RFR - DEA TOOLS;10/15/2014  08:09
"RTN","ORDEA01",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**218,374,350**;Dec 17, 1997;Build 77
"RTN","ORDEA01",3,0)
 Q
"RTN","ORDEA01",4,0)
SITE ;Edit the site-level parameter
"RTN","ORDEA01",5,0)
 N DA,SITE
"RTN","ORDEA01",6,0)
 S DA=$O(^ORD(100.7,0))
"RTN","ORDEA01",7,0)
 I +$G(DA)=0 D
"RTN","ORDEA01",8,0)
 .N FDA,ERROR,IEN
"RTN","ORDEA01",9,0)
 .S SITE=$P($$SITE^VASITE(),U,2)
"RTN","ORDEA01",10,0)
 .S FDA(100.7,"+1,",.01)=SITE,FDA(100.7,"+1,",.02)="YES"
"RTN","ORDEA01",11,0)
 .D UPDATE^DIE("E","FDA","IEN","ERROR")
"RTN","ORDEA01",12,0)
 .I $D(ERROR) D  Q
"RTN","ORDEA01",13,0)
 ..N IDX
"RTN","ORDEA01",14,0)
 ..S IDX=0 F  S IDX=$O(ERROR("DIERR",IDX)) Q:'IDX  D
"RTN","ORDEA01",15,0)
 ...W "FILEMAN ERROR #"_ERROR("DIERR",IDX)_":",!
"RTN","ORDEA01",16,0)
 ...W ERROR("DIERR",IDX,"TEXT",1)
"RTN","ORDEA01",17,0)
 .S DA=IEN(1)
"RTN","ORDEA01",18,0)
 I +$G(DA)>0,($G(SITE)="") S SITE=$$GET1^DIQ(100.7,DA_",",.01)
"RTN","ORDEA01",19,0)
 Q:+$G(DA)=0
"RTN","ORDEA01",20,0)
 W !!,"This option is used to enable or disable electronic prescribing of outpatient",!
"RTN","ORDEA01",21,0)
 W "controlled substances for your entire site. Yes enables it and No disables it.",!
"RTN","ORDEA01",22,0)
 W !,"CONFIGURING SITE "_SITE,!
"RTN","ORDEA01",23,0)
 N DIE,DR
"RTN","ORDEA01",24,0)
 S DIE="^ORD(100.7,",DR=.02
"RTN","ORDEA01",25,0)
 D ^DIE
"RTN","ORDEA01",26,0)
 Q
"RTN","ORDEA01",27,0)
USER ;Edit user-level parameter
"RTN","ORDEA01",28,0)
 N DA
"RTN","ORDEA01",29,0)
 S DA=$O(^ORD(100.7,0))
"RTN","ORDEA01",30,0)
 I +$G(DA)=0 D  Q
"RTN","ORDEA01",31,0)
 .W !!,"NO SITE CONFIGURED.",!!
"RTN","ORDEA01",32,0)
 .W "You must first run the ePCS Site Enable/Disable [OR EPCS SITE PARAMETER] option",!
"RTN","ORDEA01",33,0)
 .W "before running this option.",!
"RTN","ORDEA01",34,0)
 .H 4
"RTN","ORDEA01",35,0)
 W !!,"This option is used to enable or disable electronic prescribing of outpatient",!
"RTN","ORDEA01",36,0)
 W "controlled substances for individual users.",!
"RTN","ORDEA01",37,0)
 W !,"CONFIGURING SITE "_$$GET1^DIQ(100.7,DA_",",.01),!
"RTN","ORDEA01",38,0)
 N EXIT
"RTN","ORDEA01",39,0)
 F  D  Q:+$G(EXIT)
"RTN","ORDEA01",40,0)
 .N DIC,X,Y,DTOUT,DUOUT,IEN,ACTION,DIR,DIRUT,DIROUT
"RTN","ORDEA01",41,0)
 .S DIC="^VA(200,",DIC(0)="AEQ",DIC("A")="Select the USER NAME: "
"RTN","ORDEA01",42,0)
 .D ^DIC
"RTN","ORDEA01",43,0)
 .S:+Y<1 EXIT=1
"RTN","ORDEA01",44,0)
 .Q:+Y<1
"RTN","ORDEA01",45,0)
 .S IEN=Y,ACTION=$S($D(^ORD(100.7,"C",+IEN)):"enabled^disable",1:"disabled^enable")
"RTN","ORDEA01",46,0)
 .W !!,$P(IEN,U,2)_" is currently "_$P(ACTION,U,1)_"."
"RTN","ORDEA01",47,0)
 .K X,Y
"RTN","ORDEA01",48,0)
 .S DIR(0)="Y^A",DIR("A")="Do you want to "_$P(ACTION,U,2)_" "_$P(IEN,U,2)
"RTN","ORDEA01",49,0)
 .S DIR("B")="NO"
"RTN","ORDEA01",50,0)
 .D ^DIR
"RTN","ORDEA01",51,0)
 .Q:$D(DIRUT)
"RTN","ORDEA01",52,0)
 .I Y=1 D
"RTN","ORDEA01",53,0)
 ..N FDA,ERROR,SCHEDULES,SEX
"RTN","ORDEA01",54,0)
 ..I $P(ACTION,U,1)="disabled" D
"RTN","ORDEA01",55,0)
 ...N RETURN,PROBLEM,OUTPUT,TEXT,DELIMIT,COUNT
"RTN","ORDEA01",56,0)
 ...S RETURN=$$VDEA^XUSER(.RETURN,+IEN),SEX=$$GET1^DIQ(200,+IEN_",",4),SEX=$S(SEX="MALE":"he",SEX="FEMALE":"she",1:"it")
"RTN","ORDEA01",57,0)
 ... I 'RETURN D
"RTN","ORDEA01",58,0)
 .... S PROBLEM="" F  S PROBLEM=$O(RETURN(PROBLEM)) Q:PROBLEM=""  D
"RTN","ORDEA01",59,0)
 ..... I PROBLEM["DEA number with no expiration date" K RETURN(PROBLEM)
"RTN","ORDEA01",60,0)
 ..... I PROBLEM["expired DEA number" K RETURN(PROBLEM)
"RTN","ORDEA01",61,0)
 .... S PROBLEM=$O(RETURN("")) I PROBLEM["permitted to prescribe all schedules",$O(RETURN(PROBLEM))="" S RETURN=1
"RTN","ORDEA01",62,0)
 ...I RETURN D
"RTN","ORDEA01",63,0)
 ....S FDA(100.71,"+1,"_DA_",",.01)=+IEN
"RTN","ORDEA01",64,0)
 ....D UPDATE^DIE("S","FDA",,"ERROR")
"RTN","ORDEA01",65,0)
 ...S PROBLEM="" F  S PROBLEM=$O(RETURN(PROBLEM)) Q:$G(PROBLEM)=""  D
"RTN","ORDEA01",66,0)
 ....I PROBLEM'["Is permitted to prescribe" D
"RTN","ORDEA01",67,0)
 .....S COUNT=+$G(COUNT)+1,PROBLEM(COUNT)=$$LOW^XLFSTR($E(PROBLEM,1))_$P($E(PROBLEM,2,*),".",1)
"RTN","ORDEA01",68,0)
 .....S:PROBLEM(COUNT)["user account status:" PROBLEM(COUNT)=$P(PROBLEM(COUNT),":",1)_" is"_$P(PROBLEM(COUNT),":",2)
"RTN","ORDEA01",69,0)
 ....S:PROBLEM["Is permitted to prescribe" SCHEDULES=$$LOW^XLFSTR($E(PROBLEM,1))_$E(PROBLEM,2,*)
"RTN","ORDEA01",70,0)
 ...S PROBLEM=+$G(COUNT)
"RTN","ORDEA01",71,0)
 ...I 'RETURN D
"RTN","ORDEA01",72,0)
 ....W !!
"RTN","ORDEA01",73,0)
 ....S DELIMIT=", "
"RTN","ORDEA01",74,0)
 ....F COUNT=1:1:PROBLEM  D
"RTN","ORDEA01",75,0)
 .....S:COUNT=PROBLEM DELIMIT=" and "
"RTN","ORDEA01",76,0)
 .....S TEXT=$S($G(TEXT)'="":TEXT_DELIMIT,1:"")_PROBLEM(COUNT)
"RTN","ORDEA01",77,0)
 ....S TEXT="Cannot enable "_$P(IEN,U,2)_" to sign controlled substance orders because "_$S($E(TEXT,1,4)'="user":SEX_" ",1:"")_TEXT_"."
"RTN","ORDEA01",78,0)
 ....D WRAP^ORUTL(TEXT,"OUTPUT")
"RTN","ORDEA01",79,0)
 ....F COUNT=1:1:OUTPUT W OUTPUT(COUNT),!
"RTN","ORDEA01",80,0)
 ..I $P(ACTION,U,1)="enabled" D
"RTN","ORDEA01",81,0)
 ...S FDA(100.71,$O(^ORD(100.7,"C",+IEN,DA,0))_","_DA_",",.01)="@"
"RTN","ORDEA01",82,0)
 ...D FILE^DIE("S","FDA","ERROR")
"RTN","ORDEA01",83,0)
 ..I $D(ERROR) D
"RTN","ORDEA01",84,0)
 ...N IDX
"RTN","ORDEA01",85,0)
 ...S IDX=0 F  S IDX=$O(ERROR("DIERR",IDX)) Q:'IDX  D
"RTN","ORDEA01",86,0)
 ....W !!,"FILEMAN ERROR #"_ERROR("DIERR",IDX)_":",!
"RTN","ORDEA01",87,0)
 ....W ERROR("DIERR",IDX,"TEXT",1),!
"RTN","ORDEA01",88,0)
 ..I '$D(ERROR),($D(FDA)) D
"RTN","ORDEA01",89,0)
 ...N OUTPUT,COUNT,TEXT
"RTN","ORDEA01",90,0)
 ...S TEXT="Successfully "_$P(ACTION,U,2)_"d "_$P(IEN,U,2)
"RTN","ORDEA01",91,0)
 ...S TEXT=TEXT_$S($G(SCHEDULES)'="":" and "_SEX_" "_SCHEDULES,1:".")
"RTN","ORDEA01",92,0)
 ...D WRAP^ORUTL(TEXT,"OUTPUT")
"RTN","ORDEA01",93,0)
 ...W !!
"RTN","ORDEA01",94,0)
 ...F COUNT=1:1:OUTPUT W OUTPUT(COUNT),!
"RTN","ORDEA01",95,0)
 Q
"RTN","ORDEA01",96,0)
PRVCHK ;CHECK SINGLE PROVIDER IS PROPERLY SETUP
"RTN","ORDEA01",97,0)
 N DIC,Y,X,DTOUT,DUOUT
"RTN","ORDEA01",98,0)
 S DIC="^VA(200,",DIC(0)="AEOQ"
"RTN","ORDEA01",99,0)
 S DIC("A")="Select the provider: "
"RTN","ORDEA01",100,0)
 D ^DIC
"RTN","ORDEA01",101,0)
 Q:+Y<1
"RTN","ORDEA01",102,0)
 W !!
"RTN","ORDEA01",103,0)
 N STATUS,RETURN,TEXT,OUTPUT,LINE,LAST
"RTN","ORDEA01",104,0)
 S STATUS=$$VDEA^XUSER(.RETURN,+Y)
"RTN","ORDEA01",105,0)
 S STATUS=$$CHKSWIT(.RETURN,+Y,STATUS)
"RTN","ORDEA01",106,0)
 S TEXT="This provider is"_$S(STATUS=0:" not",1:"")_" able to write controlled substance orders"
"RTN","ORDEA01",107,0)
 I STATUS=0 S OUTPUT=2,OUTPUT(1)=TEXT_" for the",OUTPUT(2)="following reasons:"
"RTN","ORDEA01",108,0)
 I STATUS=1 S TEXT=TEXT_" and "
"RTN","ORDEA01",109,0)
 S RETURN="" F  S RETURN=$O(RETURN(RETURN)) Q:$G(RETURN)=""  D
"RTN","ORDEA01",110,0)
 .I STATUS=1 D
"RTN","ORDEA01",111,0)
 ..I RETURN["Is permitted to prescribe" D
"RTN","ORDEA01",112,0)
 ...D WRAP^ORUTL(TEXT_"is"_$P(RETURN,"Is",2),"OUTPUT")
"RTN","ORDEA01",113,0)
 ...S TEXT=""
"RTN","ORDEA01",114,0)
 ..I RETURN'["Is permitted to prescribe" D WRAP^ORUTL(RETURN,"LAST")
"RTN","ORDEA01",115,0)
 .I STATUS=0 D
"RTN","ORDEA01",116,0)
 ..I RETURN["Is permitted to prescribe" D WRAP^ORUTL("Once all of the issues above are resolved, the provider is"_$P(RETURN,"Is",2),"LAST")
"RTN","ORDEA01",117,0)
 ..I RETURN'["Is permitted to prescribe" S OUTPUT=OUTPUT+1,OUTPUT(OUTPUT)=RETURN
"RTN","ORDEA01",118,0)
 I '$D(OUTPUT) D WRAP^ORUTL(TEXT_"is permitted to prescribe any schedule.","OUTPUT")
"RTN","ORDEA01",119,0)
 F LINE=1:1:OUTPUT W OUTPUT(LINE),!
"RTN","ORDEA01",120,0)
 I $D(LAST)>9 D
"RTN","ORDEA01",121,0)
 .I STATUS=1 W !,"However, the following item"_$S(LAST=1:" was",1:"s were")_" noted:",!
"RTN","ORDEA01",122,0)
 .F LINE=1:1:+$G(LAST) W LAST(LINE),!
"RTN","ORDEA01",123,0)
 G PRVCHK
"RTN","ORDEA01",124,0)
 Q
"RTN","ORDEA01",125,0)
CHKSWIT(RETURN,IEN,RETVAL) ;CHECK THE LITTLE SWITCH
"RTN","ORDEA01",126,0)
 I '$D(^ORD(100.7,"C",IEN)) D
"RTN","ORDEA01",127,0)
 .S RETURN("Is not an ENABLED USER in the OE/RR EPCS PARAMETERS file.")="",RETVAL=0
"RTN","ORDEA01",128,0)
 Q RETVAL
"RTN","ORDEA01",129,0)
REPORTS ;PROMPT THE USER FOR THE REPORT TO RUN
"RTN","ORDEA01",130,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,REP
"RTN","ORDEA01",131,0)
 S REP("CFG")="Provider Incomplete Configuration;INCOMPL^ORDEA01A;INCOMPLQ^ORDEA01A"
"RTN","ORDEA01",132,0)
 S REP("DUP")="Duplicate VA Numbers;DUPVA^ORDEA01A;DUPVAQ^ORDEA01A"
"RTN","ORDEA01",133,0)
 S REP("DET")="DETOX/MAINTENANCE ID List;DETOX^ORDEA01A;DETOXQ^ORDEA01A"
"RTN","ORDEA01",134,0)
 S REP("LAS")="Provider Last Names Containing Punctuation;LAST^ORDEA01B;LASTQ^ORDEA01B"
"RTN","ORDEA01",135,0)
 S REP("FEE")="Fee Basis/C & A Providers Without a DEA Number;FEEDEA^ORDEA01B;FEEDEAQ^ORDEA01B"
"RTN","ORDEA01",136,0)
 S REP("AUD")="Logical Access Control Audit;AUDIT^ORDEA01B;AUDITQ^ORDEA01B"
"RTN","ORDEA01",137,0)
 S DIR(0)="SO"
"RTN","ORDEA01",138,0)
 S REP="" F  S REP=$O(REP(REP)) Q:$G(REP)=""  S $P(DIR(0),U,2)=$P(DIR(0),U,2)_REP_":"_$P(REP(REP),";")_";"
"RTN","ORDEA01",139,0)
 S DIR("A")="Select the data validation report to run"
"RTN","ORDEA01",140,0)
 D ^DIR
"RTN","ORDEA01",141,0)
 Q:$D(DIRUT)
"RTN","ORDEA01",142,0)
 Q:'$D(REP(Y))
"RTN","ORDEA01",143,0)
 S REP=Y
"RTN","ORDEA01",144,0)
 D @$P(REP(Y),";",2)
"RTN","ORDEA01",145,0)
 Q
"RTN","ORDEA01",146,0)
DISPRMPT() ;PROMPT THE USER TO INCLUDE DISUSERED AND TERMINATED USERS
"RTN","ORDEA01",147,0)
 ;RETURNS: ^ IF USER QUIT OR TIMED OUT
"RTN","ORDEA01",148,0)
 ;         OTHERWISE, THE VALUE OF VARIABLE Y
"RTN","ORDEA01",149,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","ORDEA01",150,0)
 S DIR(0)="Y"_U,DIR("A",1)="Do you want to include DISUSERed and TERMINATED users"
"RTN","ORDEA01",151,0)
 S DIR("A")="in the output",DIR("B")="NO"
"RTN","ORDEA01",152,0)
 D ^DIR
"RTN","ORDEA01",153,0)
 Q:$D(DIRUT) U
"RTN","ORDEA01",154,0)
 Q Y
"RTN","ORDEA01A")
0^48^B131930344
"RTN","ORDEA01A",1,0)
ORDEA01A ;ISP/RFR - DEA REPORTS 01;10/15/2014  08:03
"RTN","ORDEA01A",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**218,350**;Dec 17, 1997;Build 77
"RTN","ORDEA01A",3,0)
 Q
"RTN","ORDEA01A",4,0)
DUPVA ;DUPLICATE VA#'S REPORT
"RTN","ORDEA01A",5,0)
 ;REP IS HANDLED BY REPORTS^ORDEA01
"RTN","ORDEA01A",6,0)
 N DISINC,DIV,SAVE
"RTN","ORDEA01A",7,0)
 W !!,"This report identifies all users with similar VA numbers. To identify",!
"RTN","ORDEA01A",8,0)
 W "similar numbers, the software builds a temporary index. First, it removes all",!
"RTN","ORDEA01A",9,0)
 W "non-alphanumeric characters (such as punctuation and spaces) from the user's",!
"RTN","ORDEA01A",10,0)
 W "VA number, then changes all letters to uppercase, and finally adds the VA",!
"RTN","ORDEA01A",11,0)
 W "number to the temporary index. It then uses that index to build a list of",!
"RTN","ORDEA01A",12,0)
 W "similar or duplicate numbers. For example, kc123, KC 123, and KC-123 are",!
"RTN","ORDEA01A",13,0)
 W "considered similar.",!
"RTN","ORDEA01A",14,0)
 S DISINC=$$DISPRMPT^ORDEA01()
"RTN","ORDEA01A",15,0)
 Q:DISINC=U
"RTN","ORDEA01A",16,0)
 S SAVE("DISINC")=""
"RTN","ORDEA01A",17,0)
 D DEVICE^ORUTL($P(REP(REP),";",3),"OR "_$$UP^XLFSTR($P(REP(REP),";")),"Q",.SAVE)
"RTN","ORDEA01A",18,0)
 Q
"RTN","ORDEA01A",19,0)
DUPVAQ ;TASKMAN ENTRY POINT
"RTN","ORDEA01A",20,0)
 ;CBUFFER IS HANDLED BY DEVICE^ORUTL OR TASKMAN
"RTN","ORDEA01A",21,0)
 N DOCS,ERROR,KEY,INDEX,NUMBER,DUPL,PGNUM,COL,STOP,OUTPUT
"RTN","ORDEA01A",22,0)
 ;RETRIEVE ALL USERS WITH A VA #
"RTN","ORDEA01A",23,0)
 S DOCS=$NA(^TMP($J,"ORDUPVA")),DUPL=$NA(^TMP($J,"ORDUPVA","DUPL"))
"RTN","ORDEA01A",24,0)
 K @DOCS
"RTN","ORDEA01A",25,0)
 D LIST^DIC(200,,"@;.01;53.3","PQ",,,,"PS2",,,DOCS,"ERROR")
"RTN","ORDEA01A",26,0)
 I $D(ERROR) D  Q
"RTN","ORDEA01A",27,0)
 .D FMERROR^ORUTL(.ERROR)
"RTN","ORDEA01A",28,0)
 .S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01A",29,0)
 ;ORDER THE RETURNED LIST BY VA #
"RTN","ORDEA01A",30,0)
 S INDEX=0 F  S INDEX=$O(@DOCS@("DILIST",INDEX)) Q:+$G(INDEX)=0  D
"RTN","ORDEA01A",31,0)
 .S NUMBER=$P(@DOCS@("DILIST",INDEX,0),U,3),KEY=$$UP^XLFSTR(NUMBER)
"RTN","ORDEA01A",32,0)
 .S KEY=$$STRIP(KEY)
"RTN","ORDEA01A",33,0)
 .Q:$G(KEY)=""
"RTN","ORDEA01A",34,0)
 .N ACCOUNT S ACCOUNT=$$ACTIVE^XUSER($P(@DOCS@("DILIST",INDEX,0),U))
"RTN","ORDEA01A",35,0)
 .I 'DISINC,(+ACCOUNT<1),($P(ACCOUNT,U,2)'="") Q
"RTN","ORDEA01A",36,0)
 .S ACCOUNT("TEXT")=$S($P(ACCOUNT,U,2)'="":$P(ACCOUNT,U,2),ACCOUNT=0:"CANNOT SIGN ON",1:"UNKNOWN")
"RTN","ORDEA01A",37,0)
 .S @DUPL@(KEY)=+$G(@DUPL@(KEY))+1
"RTN","ORDEA01A",38,0)
 .S @DUPL@(KEY,@DUPL@(KEY),NUMBER)=$$LJ^XLFSTR($P(@DOCS@("DILIST",INDEX,0),U,2),37," ")_ACCOUNT("TEXT")
"RTN","ORDEA01A",39,0)
 ;OUTPUT THE DUPLICATES
"RTN","ORDEA01A",40,0)
 S COL(1)=$$LJ^XLFSTR("VA#",12," ")_$$LJ^XLFSTR("NAME",37," ")_"ACCOUNT STATUS"
"RTN","ORDEA01A",41,0)
 S KEY="" F  S KEY=$O(@DUPL@(KEY)) Q:$G(KEY)=""!($G(STOP))  D
"RTN","ORDEA01A",42,0)
 .I @DUPL@(KEY)>1 D
"RTN","ORDEA01A",43,0)
 ..S OUTPUT=1
"RTN","ORDEA01A",44,0)
 ..I (@DUPL@(KEY)+$Y+CBUFFER)>IOSL!($Y=0) S STOP=$$HEADER^ORUTL("NON-UNIQUE VA NUMBERS REPORT",.PGNUM,.COL)
"RTN","ORDEA01A",45,0)
 ..Q:$G(STOP)
"RTN","ORDEA01A",46,0)
 ..S INDEX=0 F  S INDEX=$O(@DUPL@(KEY,INDEX)) Q:+$G(INDEX)=0  D
"RTN","ORDEA01A",47,0)
 ...S NUMBER=$O(@DUPL@(KEY,INDEX,""))
"RTN","ORDEA01A",48,0)
 ...W $$LJ^XLFSTR(NUMBER,12," ")_@DUPL@(KEY,INDEX,NUMBER)
"RTN","ORDEA01A",49,0)
 ...I ($Y+1)<IOSL W !
"RTN","ORDEA01A",50,0)
 ..W $$REPEAT^XLFSTR("=",60)
"RTN","ORDEA01A",51,0)
 ..I ($Y+1)<IOSL W !
"RTN","ORDEA01A",52,0)
 I '$G(STOP) D
"RTN","ORDEA01A",53,0)
 .I '$G(OUTPUT) D  Q:$G(STOP)
"RTN","ORDEA01A",54,0)
 ..S STOP=$$HEADER^ORUTL("NON-UNIQUE VA NUMBERS REPORT",.PGNUM,.COL)
"RTN","ORDEA01A",55,0)
 ..Q:STOP
"RTN","ORDEA01A",56,0)
 ..W !,$$CJ^XLFSTR("All VA Numbers are unique.",$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01A",57,0)
 .I ($Y+2)>IOSL S STOP=$$HEADER^ORUTL("NON-UNIQUE VA NUMBERS REPORT",.PGNUM,.COL)
"RTN","ORDEA01A",58,0)
 .Q:$G(STOP)
"RTN","ORDEA01A",59,0)
 .W !,$$CJ^XLFSTR("[END OF REPORT]",$S(+$G(IOM)>0:(IOM-1),1:79)," ")
"RTN","ORDEA01A",60,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01A",61,0)
 Q
"RTN","ORDEA01A",62,0)
STRIP(TEXT) ;REMOVE PUNCTUATION CHARACTERS AND SPACES
"RTN","ORDEA01A",63,0)
 N %
"RTN","ORDEA01A",64,0)
 F %=1:1:$L(TEXT) N CHR S CHR=$A($E(TEXT,%)) I CHR<48!(CHR>57&(CHR<65))!(CHR>90&(CHR<97))!(CHR>122) S TEXT=$TR(TEXT,$E(TEXT,%))
"RTN","ORDEA01A",65,0)
 Q TEXT
"RTN","ORDEA01A",66,0)
INCOMPL ;INCOMPLETE PROVIDER SETUP REPORT
"RTN","ORDEA01A",67,0)
 ;REP IS HANDLED BY REPORTS^ORDEA01
"RTN","ORDEA01A",68,0)
 W !!,"This report identifies all active providers who are unable to sign controlled",!
"RTN","ORDEA01A",69,0)
 W "substance orders. For the purposes of this report, a provider is a user who",!
"RTN","ORDEA01A",70,0)
 W "holds the ORES security key.",!
"RTN","ORDEA01A",71,0)
 W !,"By default, the report lists the prescribable schedules for each provider",!
"RTN","ORDEA01A",72,0)
 W "(including those providers that are properly configured).",!
"RTN","ORDEA01A",73,0)
 N INCLUDE,DISINC,DIV,DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,SAVE,ORCSV
"RTN","ORDEA01A",74,0)
 S DIR(0)="Y"_U,DIR("A")="Do you want to include prescribable schedules in the output"
"RTN","ORDEA01A",75,0)
 S DIR("B")="NO"
"RTN","ORDEA01A",76,0)
 S DIR("?",1)="By answering YES, the report will list the schedules each provider is able to"
"RTN","ORDEA01A",77,0)
 S DIR("?",2)="prescribe and will include those providers who are able to sign controlled"
"RTN","ORDEA01A",78,0)
 S DIR("?",3)="substance orders."
"RTN","ORDEA01A",79,0)
 S DIR("?",4)="By answering NO, the report will not list the prescribable schedules and will"
"RTN","ORDEA01A",80,0)
 S DIR("?",5)="only include those providers who are unable to sign controlled substance"
"RTN","ORDEA01A",81,0)
 S DIR("?")="orders."
"RTN","ORDEA01A",82,0)
 D ^DIR
"RTN","ORDEA01A",83,0)
 Q:$D(DIRUT)
"RTN","ORDEA01A",84,0)
 S INCLUDE=Y
"RTN","ORDEA01A",85,0)
 K X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","ORDEA01A",86,0)
 W !
"RTN","ORDEA01A",87,0)
 S DISINC=$$DISPRMPT^ORDEA01()
"RTN","ORDEA01A",88,0)
 Q:DISINC=U
"RTN","ORDEA01A",89,0)
 W !
"RTN","ORDEA01A",90,0)
 S X=$$DIVPRMPT^ORUTL(.DIV)
"RTN","ORDEA01A",91,0)
 Q:X<1
"RTN","ORDEA01A",92,0)
 K X,Y,DIR,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","ORDEA01A",93,0)
 S DIR(0)="Y"_U,DIR("A",1)="Do you want to generate the report in a delimited format suitable for import"
"RTN","ORDEA01A",94,0)
 S DIR("A")="into third-party applications"
"RTN","ORDEA01A",95,0)
 S DIR("?",1)="By answering YES, the report is generated in a comma-separated values (CSV)"
"RTN","ORDEA01A",96,0)
 S DIR("?",2)="format."
"RTN","ORDEA01A",97,0)
 S DIR("?")="By answering NO, the report is generated in a non-delimited format."
"RTN","ORDEA01A",98,0)
 W !
"RTN","ORDEA01A",99,0)
 D ^DIR
"RTN","ORDEA01A",100,0)
 Q:$D(DIRUT)
"RTN","ORDEA01A",101,0)
 S ORCSV=Y
"RTN","ORDEA01A",102,0)
 I ORCSV D
"RTN","ORDEA01A",103,0)
 .W !!,"To create a file on your computer for use in third-party applications, perform"
"RTN","ORDEA01A",104,0)
 .W !,"the following:",!
"RTN","ORDEA01A",105,0)
 .W !," 1. To queue the report, at the DEVICE: prompt, enter the letter Q."
"RTN","ORDEA01A",106,0)
 .W !," 2. At the DEVICE: prompt, select the appropriate spooler device."
"RTN","ORDEA01A",107,0)
 .W !," 3. Once the spooled document is ready, use option Download a Spool file entry"
"RTN","ORDEA01A",108,0)
 .W !,"    [XT-KERMIT SPOOL DL] to download the report to your computer."
"RTN","ORDEA01A",109,0)
 .W !,"    Note: Refer to your terminal emulator's documentation for instructions on"
"RTN","ORDEA01A",110,0)
 .W !,"          receiving files via the KERMIT protocol.",!
"RTN","ORDEA01A",111,0)
 S SAVE("INCLUDE")="",SAVE("DISINC")="",SAVE("DIV(")="",SAVE("ORCSV")=""
"RTN","ORDEA01A",112,0)
 D DEVICE^ORUTL($P(REP(REP),";",3),"OR "_$$UP^XLFSTR($P(REP(REP),";")),"Q",.SAVE)
"RTN","ORDEA01A",113,0)
 Q
"RTN","ORDEA01A",114,0)
INCOMPLQ ;TASKMAN ENTRY POINT
"RTN","ORDEA01A",115,0)
 ;CBUFFER IS HANDLED BY DEVICE^ORUTL OR TASKMAN
"RTN","ORDEA01A",116,0)
 N DATA,Y,INDENT,STOP,COUNT
"RTN","ORDEA01A",117,0)
 S DATA=$NA(^TMP($J,"ORDATA"))
"RTN","ORDEA01A",118,0)
 K @DATA
"RTN","ORDEA01A",119,0)
 S INDENT(0)=$$REPEAT^XLFSTR(" ",37),INDENT(1)=$$REPEAT^XLFSTR("-",34)
"RTN","ORDEA01A",120,0)
 ;IA #10076
"RTN","ORDEA01A",121,0)
 S Y=0 F  S Y=$O(^XUSEC("ORES",Y)) Q:+$G(Y)=0!($G(STOP))  D
"RTN","ORDEA01A",122,0)
 .N DIVISION S DIVISION=$$HASDIV^ORUTL(Y,.DIV)
"RTN","ORDEA01A",123,0)
 .Q:$G(DIVISION)=""
"RTN","ORDEA01A",124,0)
 .N ACCOUNT S ACCOUNT=$$ACTIVE^XUSER(Y)
"RTN","ORDEA01A",125,0)
 .I 'DISINC,(+ACCOUNT<1),($P(ACCOUNT,U,2)'="") Q
"RTN","ORDEA01A",126,0)
 .;INCLUDE USERS WHO CANNOT SIGN-ON IN ACTIVE LISTING
"RTN","ORDEA01A",127,0)
 .S ACCOUNT=$S(ACCOUNT=0:1,ACCOUNT="":-1,1:ACCOUNT)
"RTN","ORDEA01A",128,0)
 .N RETURN,STATUS
"RTN","ORDEA01A",129,0)
 .S STATUS=$$VDEA^XUSER(.RETURN,Y),COUNT=1+$G(COUNT)
"RTN","ORDEA01A",130,0)
 .S STATUS=$$CHKSWIT^ORDEA01(.RETURN,Y,STATUS)
"RTN","ORDEA01A",131,0)
 .I $D(RETURN)>9 D
"RTN","ORDEA01A",132,0)
 ..N REASON,NAME,INDEX
"RTN","ORDEA01A",133,0)
 ..S NAME=$$GET1^DIQ(200,Y_",",.01)
"RTN","ORDEA01A",134,0)
 ..I NAME="",ACCOUNT=-1 S NAME="ACCOUNT #"_Y
"RTN","ORDEA01A",135,0)
 ..S @DATA@(DIVISION,STATUS,+ACCOUNT,NAME)=$$GET1^DIQ(200,Y_",",8)
"RTN","ORDEA01A",136,0)
 ..S REASON="" F  S REASON=$O(RETURN(REASON)) Q:$G(REASON)=""  D
"RTN","ORDEA01A",137,0)
 ...N TEXT
"RTN","ORDEA01A",138,0)
 ...I '$G(INCLUDE),(REASON["Is permitted") Q
"RTN","ORDEA01A",139,0)
 ...I STATUS=1,(REASON'["Is permitted") D
"RTN","ORDEA01A",140,0)
 ....S TEXT=$$LOW^XLFSTR($E(REASON,1,1))_$E(REASON,2,$L(REASON))
"RTN","ORDEA01A",141,0)
 ....S TEXT="Can sign controlled substance orders, however, the provider "_TEXT
"RTN","ORDEA01A",142,0)
 ...S INDEX=1+$G(INDEX),@DATA@(DIVISION,STATUS,+ACCOUNT,NAME,INDEX)=$S($G(TEXT)'="":$G(TEXT),1:REASON)
"RTN","ORDEA01A",143,0)
 .I 'COUNT#100 S STOP=$$STOPTASK^ORUTL()
"RTN","ORDEA01A",144,0)
 I 'ORCSV D IREPORT
"RTN","ORDEA01A",145,0)
 I ORCSV D IEXPORT
"RTN","ORDEA01A",146,0)
 K @DATA
"RTN","ORDEA01A",147,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01A",148,0)
 Q
"RTN","ORDEA01A",149,0)
IREPORT ;CREATE NON-CSV FORMAT
"RTN","ORDEA01A",150,0)
 N DIVISION,NAME,LINE,STATUS,TEXT,OUTPUT,ACCOUNT,COL,PGNUM
"RTN","ORDEA01A",151,0)
 S DIVISION="" F  S DIVISION=$O(@DATA@(DIVISION)) Q:$G(DIVISION)=""!($G(STOP))  D
"RTN","ORDEA01A",152,0)
 .S COL(1)="DIVISION: "_DIVISION
"RTN","ORDEA01A",153,0)
 .F STATUS=0:1:1 D  Q:$G(STOP)
"RTN","ORDEA01A",154,0)
 ..I STATUS=1,('$G(INCLUDE)) Q
"RTN","ORDEA01A",155,0)
 ..Q:$D(@DATA@(DIVISION,STATUS))<10
"RTN","ORDEA01A",156,0)
 ..S TEXT=$S(STATUS=0:"un",1:"")_"able"
"RTN","ORDEA01A",157,0)
 ..S COL(2)=$$LJ^XLFSTR("PROVIDER NAME",37," ")
"RTN","ORDEA01A",158,0)
 ..S COL(3)=$$LJ^XLFSTR(" TITLE",37," ")_$S(TEXT="unable":"DEFICIENCY",1:"")
"RTN","ORDEA01A",159,0)
 ..S COL(3)=COL(3)_$S(TEXT="unable"&INCLUDE=1:"/",1:"")_$S(INCLUDE=1:"PRESCRIBABLE SCHEDULES",1:"")
"RTN","ORDEA01A",160,0)
 ..S STOP=$$HEADER^ORUTL("PROVIDER INCOMPLETE CONFIGURATION REPORT",.PGNUM,.COL)
"RTN","ORDEA01A",161,0)
 ..Q:$G(STOP)
"RTN","ORDEA01A",162,0)
 ..F ACCOUNT=1:-1:-1 D  Q:$G(STOP)
"RTN","ORDEA01A",163,0)
 ...Q:$D(@DATA@(DIVISION,STATUS,ACCOUNT))<10
"RTN","ORDEA01A",164,0)
 ...N BUFFER S BUFFER=@DATA@(DIVISION,STATUS,ACCOUNT,$O(@DATA@(DIVISION,STATUS,ACCOUNT,"")))
"RTN","ORDEA01A",165,0)
 ...S BUFFER=BUFFER+$S(ACCOUNT=0&($Y>4):3,ACCOUNT=0:2,1:0)
"RTN","ORDEA01A",166,0)
 ...I (BUFFER+$Y+CBUFFER)>IOSL!($Y=0) D  Q:$G(STOP)
"RTN","ORDEA01A",167,0)
 ....S STOP=$$HEADER^ORUTL("PROVIDER INCOMPLETE CONFIGURATION REPORT",.PGNUM,.COL)
"RTN","ORDEA01A",168,0)
 ...I ACCOUNT=0 D
"RTN","ORDEA01A",169,0)
 ....W:$Y>4 !
"RTN","ORDEA01A",170,0)
 ....W $$CJ^XLFSTR("*** DISUSERED/TERMINATED USERS ***",$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01A",171,0)
 ....W $$CJ^XLFSTR(INDENT(1),$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01A",172,0)
 ...S NAME="" F  S NAME=$O(@DATA@(DIVISION,STATUS,ACCOUNT,NAME)) Q:$G(NAME)=""!($G(STOP))  D
"RTN","ORDEA01A",173,0)
 ....N BODY
"RTN","ORDEA01A",174,0)
 ....S INDEX=0 F  S INDEX=$O(@DATA@(DIVISION,STATUS,ACCOUNT,NAME,INDEX)) Q:'INDEX  D
"RTN","ORDEA01A",175,0)
 .....D WRAP^ORUTL(INDENT(0)_@DATA@(DIVISION,STATUS,ACCOUNT,NAME,INDEX),"BODY")
"RTN","ORDEA01A",176,0)
 ....S BODY(1)=$$LJ^XLFSTR(NAME,37," ")_$E($G(BODY(1)),38,$S(+$G(IOM)>0:IOM,1:80))
"RTN","ORDEA01A",177,0)
 ....S BODY(2)=$$LJ^XLFSTR(" "_@DATA@(DIVISION,STATUS,ACCOUNT,NAME),37," ")_$E($G(BODY(2)),38,$S(+$G(IOM)>0:IOM,1:80))
"RTN","ORDEA01A",178,0)
 ....S:BODY<2 BODY=2
"RTN","ORDEA01A",179,0)
 ....I (BODY+$Y+CBUFFER)>IOSL D  Q:$G(STOP)
"RTN","ORDEA01A",180,0)
 .....S STOP=$$HEADER^ORUTL("PROVIDER INCOMPLETE CONFIGURATION REPORT",.PGNUM,.COL)
"RTN","ORDEA01A",181,0)
 ....F LINE=1:1:BODY  D
"RTN","ORDEA01A",182,0)
 .....W BODY(LINE)
"RTN","ORDEA01A",183,0)
 .....I ($Y+1)<IOSL W !
"RTN","ORDEA01A",184,0)
 .....S OUTPUT=1
"RTN","ORDEA01A",185,0)
 ....I LINE>0,(($Y+1)<IOSL) W !
"RTN","ORDEA01A",186,0)
 I '$G(STOP) D
"RTN","ORDEA01A",187,0)
 .I '$G(OUTPUT) D  Q:$G(STOP)
"RTN","ORDEA01A",188,0)
 ..S STOP=$$HEADER^ORUTL("PROVIDER INCOMPLETE CONFIGURATION REPORT",.PGNUM,.COL)
"RTN","ORDEA01A",189,0)
 ..Q:STOP
"RTN","ORDEA01A",190,0)
 ..N TEXT,BODY
"RTN","ORDEA01A",191,0)
 ..S TEXT="All providers are able to sign controlled substance orders"
"RTN","ORDEA01A",192,0)
 ..I $D(DIV) D
"RTN","ORDEA01A",193,0)
 ...N IDX,STATIONS
"RTN","ORDEA01A",194,0)
 ...S IDX="" F  S IDX=$O(DIV(IDX)) Q:$G(IDX)=""  D
"RTN","ORDEA01A",195,0)
 ....N DELIMIT
"RTN","ORDEA01A",196,0)
 ....S DELIMIT=$S($O(DIV(IDX))'="":", ",1:" and ")
"RTN","ORDEA01A",197,0)
 ....S STATIONS=$S($G(STATIONS)'="":STATIONS_DELIMIT,1:"")_DIV(IDX)
"RTN","ORDEA01A",198,0)
 ...S TEXT=TEXT_" in "_STATIONS
"RTN","ORDEA01A",199,0)
 ..D WRAP^ORUTL(TEXT_".","BODY")
"RTN","ORDEA01A",200,0)
 ..S BODY=0 F  S BODY=$O(BODY(BODY)) Q:'BODY  W BODY(BODY),!
"RTN","ORDEA01A",201,0)
 .I ($Y+2)>IOSL S STOP=$$HEADER^ORUTL("PROVIDER INCOMPLETE CONFIGURATION REPORT",.PGNUM,.COL)
"RTN","ORDEA01A",202,0)
 .Q:$G(STOP)
"RTN","ORDEA01A",203,0)
 .W !,$$CJ^XLFSTR("[END OF REPORT]",$S(+$G(IOM)>0:(IOM-1),1:79)," ")
"RTN","ORDEA01A",204,0)
 Q
"RTN","ORDEA01A",205,0)
IEXPORT ;CREATE CSV FORMAT
"RTN","ORDEA01A",206,0)
 N DIVISION,STATUS,ACCOUNT,NAME,Q,QCQ,LINE,XTKDIC,XTKMODE,XTKFILE
"RTN","ORDEA01A",207,0)
 S Q=$C(34),QCQ=Q_","_Q
"RTN","ORDEA01A",208,0)
 W Q_"DIVISION"_QCQ_"PROVIDER NAME"_QCQ_"TITLE"_QCQ_"DEFICIENCY"
"RTN","ORDEA01A",209,0)
 W $S(INCLUDE=1:"/PRESCRIBABLE SCHEDULES",1:"")_Q,!
"RTN","ORDEA01A",210,0)
 S DIVISION="" F  S DIVISION=$O(@DATA@(DIVISION)) Q:$G(DIVISION)=""  D
"RTN","ORDEA01A",211,0)
 .F STATUS=0:1:1 D
"RTN","ORDEA01A",212,0)
 ..I STATUS=1,('$G(INCLUDE)) Q
"RTN","ORDEA01A",213,0)
 ..F ACCOUNT=1:-1:0 D
"RTN","ORDEA01A",214,0)
 ...S NAME="" F  S NAME=$O(@DATA@(DIVISION,STATUS,ACCOUNT,NAME)) Q:$G(NAME)=""  D
"RTN","ORDEA01A",215,0)
 ....S INDEX=0 F  S INDEX=$O(@DATA@(DIVISION,STATUS,ACCOUNT,NAME,INDEX)) Q:$G(INDEX)=""  D
"RTN","ORDEA01A",216,0)
 .....W Q_DIVISION_QCQ_NAME_QCQ_@DATA@(DIVISION,STATUS,ACCOUNT,NAME)_QCQ
"RTN","ORDEA01A",217,0)
 .....W @DATA@(DIVISION,STATUS,ACCOUNT,NAME,INDEX)_Q,!
"RTN","ORDEA01A",218,0)
 Q
"RTN","ORDEA01A",219,0)
DETOX ;DETOX/MAINTENANCE ID Report
"RTN","ORDEA01A",220,0)
 ;REP IS HANDLED BY REPORTS^ORDEA01
"RTN","ORDEA01A",221,0)
 N DISINC
"RTN","ORDEA01A",222,0)
 W !!,"This report identifies all users who have a DETOX/MAINTENANCE ID number",!
"RTN","ORDEA01A",223,0)
 W "in the NEW PERSON FILE (#200).",!
"RTN","ORDEA01A",224,0)
 S DISINC=$$DISPRMPT^ORDEA01()
"RTN","ORDEA01A",225,0)
 Q:DISINC=U
"RTN","ORDEA01A",226,0)
 S SAVE("DISINC")=""
"RTN","ORDEA01A",227,0)
 D DEVICE^ORUTL($P(REP(REP),";",3),"OR "_$$UP^XLFSTR($P(REP(REP),";")),"Q",.SAVE)
"RTN","ORDEA01A",228,0)
 Q
"RTN","ORDEA01A",229,0)
DETOXQ ;TASKMAN ENTRY POINT
"RTN","ORDEA01A",230,0)
 ;CBUFFER IS HANDLED BY DEVICE^ORUTL OR TASKMAN
"RTN","ORDEA01A",231,0)
 N DOCS,DATA,ERROR,INDEX,PGNUM,COL,STOP,ACCOUNT,OUTPUT
"RTN","ORDEA01A",232,0)
 ;RETRIEVE ALL USERS WITH A DETOX/MAINTENANCE ID NUMBER
"RTN","ORDEA01A",233,0)
 S DOCS=$NA(^TMP($J,"ORDETOX")),DATA=$NA(^TMP($J,"ORDETOXDATA"))
"RTN","ORDEA01A",234,0)
 K @DOCS,@DATA
"RTN","ORDEA01A",235,0)
 S COL(1)="                                     DETOX/MAINTENANCE"
"RTN","ORDEA01A",236,0)
 S COL(2)="NAME                                 ID NUMBER          ACCOUNT STATUS"
"RTN","ORDEA01A",237,0)
 D LIST^DIC(200,,"@;.01;53.11","PQ",,,,,"I $P($G(^VA(200,Y,""PS"")),U,11)'=""""",,DOCS,"ERROR")
"RTN","ORDEA01A",238,0)
 I $D(ERROR) D  Q
"RTN","ORDEA01A",239,0)
 .D FMERROR^ORUTL(.ERROR)
"RTN","ORDEA01A",240,0)
 .S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01A",241,0)
 .K @DOCS
"RTN","ORDEA01A",242,0)
 S INDEX=0 F  S INDEX=$O(@DOCS@("DILIST",INDEX)) Q:+$G(INDEX)=0  D
"RTN","ORDEA01A",243,0)
 .N ACCOUNT S ACCOUNT=$$ACTIVE^XUSER($P(@DOCS@("DILIST",INDEX,0),U))
"RTN","ORDEA01A",244,0)
 .I 'DISINC,(+ACCOUNT<1),($P(ACCOUNT,U,2)'="") Q
"RTN","ORDEA01A",245,0)
 .S ACCOUNT("TEXT")=$S($P(ACCOUNT,U,2)'="":$P(ACCOUNT,U,2),ACCOUNT=0:"CANNOT SIGN ON",1:"UNKNOWN")
"RTN","ORDEA01A",246,0)
 .;INCLUDE USERS WHO CANNOT SIGN-ON IN ACTIVE LISTING
"RTN","ORDEA01A",247,0)
 .I ACCOUNT=0 S ACCOUNT=1
"RTN","ORDEA01A",248,0)
 .S @DATA@(+ACCOUNT,$P(@DOCS@("DILIST",INDEX,0),U,2))=$$LJ^XLFSTR($P(@DOCS@("DILIST",INDEX,0),U,3),19,"  ")_ACCOUNT("TEXT")
"RTN","ORDEA01A",249,0)
 F ACCOUNT=1:-1:0  D  Q:$G(STOP)
"RTN","ORDEA01A",250,0)
 .Q:'$D(@DATA@(ACCOUNT))
"RTN","ORDEA01A",251,0)
 .I ACCOUNT=0 D
"RTN","ORDEA01A",252,0)
 ..I ($Y+CBUFFER+4)>IOSL!($Y=0) D  Q:$G(STOP)
"RTN","ORDEA01A",253,0)
 ...S STOP=$$HEADER^ORUTL("PROVIDERS WITH A DETOX/MAINTENANCE ID",.PGNUM,.COL)
"RTN","ORDEA01A",254,0)
 ..W !,$$CJ^XLFSTR("*** DISUSERED/TERMINATED USERS ***",$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01A",255,0)
 ..W $$CJ^XLFSTR($$REPEAT^XLFSTR("-",34),$S(+$G(IOM)>0:IOM,1:80)," "),!
"RTN","ORDEA01A",256,0)
 .S NAME="" F  S NAME=$O(@DATA@(ACCOUNT,NAME)) Q:NAME=""!($G(STOP))  D
"RTN","ORDEA01A",257,0)
 ..I ($Y+CBUFFER)>IOSL!($Y=0) D  Q:$G(STOP)
"RTN","ORDEA01A",258,0)
 ...S STOP=$$HEADER^ORUTL("PROVIDERS WITH A DETOX/MAINTENANCE ID",.PGNUM,.COL)
"RTN","ORDEA01A",259,0)
 ..W $$LJ^XLFSTR(NAME,37," ")_@DATA@(ACCOUNT,NAME)
"RTN","ORDEA01A",260,0)
 ..I ($Y+1)<IOSL W !
"RTN","ORDEA01A",261,0)
 ..S OUTPUT=1
"RTN","ORDEA01A",262,0)
 I '$G(STOP) D
"RTN","ORDEA01A",263,0)
 .I '$G(OUTPUT) D  Q:$G(STOP)
"RTN","ORDEA01A",264,0)
 ..S STOP=$$HEADER^ORUTL("PROVIDERS WITH A DETOX/MAINTENANCE ID",.PGNUM,.COL)
"RTN","ORDEA01A",265,0)
 ..Q:STOP
"RTN","ORDEA01A",266,0)
 ..W !,$$CJ^XLFSTR("0 PROVIDERS FOUND",$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01A",267,0)
 .I ($Y+2)>IOSL S STOP=$$HEADER^ORUTL("PROVIDERS WITH A DETOX/MAINTENANCE ID",.PGNUM,.COL)
"RTN","ORDEA01A",268,0)
 .Q:$G(STOP)
"RTN","ORDEA01A",269,0)
 .W !,$$CJ^XLFSTR("[END OF REPORT]",$S(+$G(IOM)>0:(IOM-1),1:79)," ")
"RTN","ORDEA01A",270,0)
 K @DOCS,@DATA
"RTN","ORDEA01A",271,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01A",272,0)
 Q
"RTN","ORDEA01B")
0^49^B129635261
"RTN","ORDEA01B",1,0)
ORDEA01B ;ISP/RFR - DEA REPORTS 02;10/15/2014  08:02
"RTN","ORDEA01B",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**218,350**;Dec 17, 1997;Build 77
"RTN","ORDEA01B",3,0)
 Q
"RTN","ORDEA01B",4,0)
FEEDEA ;List those Fee Basis and C & A providers without a DEA number
"RTN","ORDEA01B",5,0)
 ;REP IS HANDLED BY REPORTS^ORDEA01
"RTN","ORDEA01B",6,0)
 W !!,"This report identifies Fee Basis and C & A providers who do not have a DEA#",!
"RTN","ORDEA01B",7,0)
 W "value in the NEW PERSON file (#200). These providers will need values entered",!
"RTN","ORDEA01B",8,0)
 W "into the DEA# (#53.2) and DEA EXPIRATION DATE (#747.44) fields in the",!
"RTN","ORDEA01B",9,0)
 W "NEW PERSON file (#200) before they can order controlled substances.",!
"RTN","ORDEA01B",10,0)
 N DISINC,DIV,SAVE,X
"RTN","ORDEA01B",11,0)
 S DISINC=$$DISPRMPT^ORDEA01()
"RTN","ORDEA01B",12,0)
 Q:DISINC=U
"RTN","ORDEA01B",13,0)
 S X=$$DIVPRMPT^ORUTL(.DIV)
"RTN","ORDEA01B",14,0)
 Q:X<1
"RTN","ORDEA01B",15,0)
 S SAVE("DISINC")="",SAVE("DIV(")=""
"RTN","ORDEA01B",16,0)
 D DEVICE^ORUTL($P(REP(REP),";",3),"OR "_$$UP^XLFSTR($P(REP(REP),";")),"Q",.SAVE)
"RTN","ORDEA01B",17,0)
 Q
"RTN","ORDEA01B",18,0)
FEEDEAQ ;TASKMAN ENTRY POINT
"RTN","ORDEA01B",19,0)
 ;CBUFFER IS HANDLED BY DEVICE^ORUTL OR TASKMAN
"RTN","ORDEA01B",20,0)
 N PROVIDERS,ERROR,IN,IDX,STATUS,DATA,PGNUM,COL,STOP,OUTPUT
"RTN","ORDEA01B",21,0)
 S IN=$NA(^TMP("DILIST",$J)) K @IN
"RTN","ORDEA01B",22,0)
 S DATA=$NA(^TMP($J,"ORFEEDATA")) K @DATA
"RTN","ORDEA01B",23,0)
 D LIST^DIC(200,,"@;.01;53.6;9.2I","P",,,,,"I ""^3^4^""[(U_$P($G(^VA(200,Y,""PS"")),U,6)_U)&($P($G(^VA(200,Y,""PS"")),U,2)="""")",,,"ERROR")
"RTN","ORDEA01B",24,0)
 I $D(ERROR) D  Q
"RTN","ORDEA01B",25,0)
 .D FMERROR^ORUTL(.ERROR)
"RTN","ORDEA01B",26,0)
 .S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01B",27,0)
 S COL(2)=$$REPEAT^XLFSTR(" ",37)_"PROVIDER   TERMINATION  ACCOUNT"
"RTN","ORDEA01B",28,0)
 S COL(3)=$$LJ^XLFSTR("PROVIDER NAME",35," ")_"    TYPE        DATE      STATUS"
"RTN","ORDEA01B",29,0)
 I '$D(@IN) D  Q
"RTN","ORDEA01B",30,0)
 .S STOP=$$HEADER^ORUTL("FEE BASIS/C & A PROVIDER MISSING DEA# REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",31,0)
 .Q:STOP
"RTN","ORDEA01B",32,0)
 .W !,$$CJ^XLFSTR("0 PROVIDERS FOUND",$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01B",33,0)
 .S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01B",34,0)
 S IDX=0 F  S IDX=$O(@IN@(IDX)) Q:+$G(IDX)=0  D
"RTN","ORDEA01B",35,0)
 .N DIVISION S DIVISION=$$HASDIV^ORUTL($P(@IN@(IDX,0),U),.DIV)
"RTN","ORDEA01B",36,0)
 .Q:DIVISION=""
"RTN","ORDEA01B",37,0)
 .N STATUS S STATUS=$$ACTIVE^XUSER($P(@IN@(IDX,0),U,1))
"RTN","ORDEA01B",38,0)
 .I 'DISINC,(+STATUS<1),($P(STATUS,U,2)'="") Q
"RTN","ORDEA01B",39,0)
 .;INCLUDE USERS WHO CANNOT SIGN-ON IN ACTIVE LISTING
"RTN","ORDEA01B",40,0)
 .S STATUS("TEXT")=$S($P(STATUS,U,2)'="":$P(STATUS,U,2),STATUS=0:"CANNOT SIGN ON",1:"UNKNOWN")
"RTN","ORDEA01B",41,0)
 .I STATUS=0 S STATUS=1
"RTN","ORDEA01B",42,0)
 .N DATE,IDATE S DATE=+$P(@IN@(IDX,0),U,4),IDATE=9999999-DATE S DATE=$$LJ^XLFSTR($S(DATE>0:$$FMTE^XLFDT(DATE,"5D"),1:""),11," ")
"RTN","ORDEA01B",43,0)
 .S @DATA@(DIVISION,+STATUS,IDATE,$P(@IN@(IDX,0),U,2))=$$LJ^XLFSTR($P(@IN@(IDX,0),U,2),35," ")_"  "_$$LJ^XLFSTR($P(@IN@(IDX,0),U,3),9)_"  "_DATE_"  "_STATUS("TEXT")
"RTN","ORDEA01B",44,0)
 N DIVISION S DIVISION="" F  S DIVISION=$O(@DATA@(DIVISION)) Q:$G(DIVISION)=""!($G(STOP))  D
"RTN","ORDEA01B",45,0)
 .S COL(1)="DIVISION: "_DIVISION
"RTN","ORDEA01B",46,0)
 .S STOP=$$HEADER^ORUTL("FEE BASIS/C & A PROVIDER MISSING DEA# REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",47,0)
 .Q:STOP
"RTN","ORDEA01B",48,0)
 .N STATUS F STATUS=1:-1:0  D  Q:STOP
"RTN","ORDEA01B",49,0)
 ..Q:'$D(@DATA@(DIVISION,STATUS))
"RTN","ORDEA01B",50,0)
 ..I STATUS=0 D  Q:STOP
"RTN","ORDEA01B",51,0)
 ...I ($Y+4+CBUFFER)>IOSL S STOP=$$HEADER^ORUTL("FEE BASIS/C & A PROVIDER MISSING DEA# REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",52,0)
 ...Q:STOP
"RTN","ORDEA01B",53,0)
 ...W:$Y>5 !
"RTN","ORDEA01B",54,0)
 ...W $$CJ^XLFSTR("*** DISUSERED/TERMINATED USERS ***",$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01B",55,0)
 ...W $$CJ^XLFSTR($$REPEAT^XLFSTR("-",34),$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01B",56,0)
 ..S IDATE=0 F  S IDATE=$O(@DATA@(DIVISION,STATUS,IDATE)) Q:+$G(IDATE)=0!(STOP)  D
"RTN","ORDEA01B",57,0)
 ...N NAME S NAME="" F  S NAME=$O(@DATA@(DIVISION,STATUS,IDATE,NAME)) Q:$G(NAME)=""!(STOP)  D
"RTN","ORDEA01B",58,0)
 ....I ($Y+CBUFFER)>IOSL D  Q:STOP
"RTN","ORDEA01B",59,0)
 .....S STOP=$$HEADER^ORUTL("FEE BASIS/C & A PROVIDER MISSING DEA# REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",60,0)
 ....W @DATA@(DIVISION,STATUS,IDATE,NAME)
"RTN","ORDEA01B",61,0)
 ....I ($Y+1)<IOSL W !
"RTN","ORDEA01B",62,0)
 ....S OUTPUT=1
"RTN","ORDEA01B",63,0)
 I '$G(STOP) D
"RTN","ORDEA01B",64,0)
 .I '$G(OUTPUT) D  Q:$G(STOP)
"RTN","ORDEA01B",65,0)
 ..S STOP=$$HEADER^ORUTL("FEE BASIS/C & A PROVIDER MISSING DEA# REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",66,0)
 ..Q:STOP
"RTN","ORDEA01B",67,0)
 ..W !,$$CJ^XLFSTR("0 PROVIDERS FOUND",$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01B",68,0)
 .I ($Y+2)>IOSL S STOP=$$HEADER^ORUTL("FEE BASIS/C & A PROVIDER MISSING DEA# REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",69,0)
 .Q:$G(STOP)
"RTN","ORDEA01B",70,0)
 .W !,$$CJ^XLFSTR("[END OF REPORT]",$S(+$G(IOM)>0:(IOM-1),1:79)," ")
"RTN","ORDEA01B",71,0)
 K @IN,@DATA
"RTN","ORDEA01B",72,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01B",73,0)
 Q
"RTN","ORDEA01B",74,0)
AUDIT ;Display the audit data for OE/RR EPCS PARAMTERS file (#100.7)
"RTN","ORDEA01B",75,0)
 ;REP IS HANDLED BY REPORTS^ORDEA01
"RTN","ORDEA01B",76,0)
 W !!,"This report displays the audit data for the logical access control feature.",!
"RTN","ORDEA01B",77,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,ORCDATE,ORDDATE,DIV
"RTN","ORDEA01B",78,0)
 S DIR(0)="DO"_U_":"_DT_":EP"
"RTN","ORDEA01B",79,0)
 S DIR("A")="START DATE"
"RTN","ORDEA01B",80,0)
 S DIR("?",1)="The report will not display audit data created before this date."
"RTN","ORDEA01B",81,0)
 S DIR("?")="To display all audit data, leave this field blank."
"RTN","ORDEA01B",82,0)
 D ^DIR
"RTN","ORDEA01B",83,0)
 Q:$D(DTOUT)!($D(DUOUT))
"RTN","ORDEA01B",84,0)
 S ORCDATE=+$G(Y)
"RTN","ORDEA01B",85,0)
 K X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","ORDEA01B",86,0)
 S DIR("A")="END DATE"
"RTN","ORDEA01B",87,0)
 S DIR("?",1)="The report will not display audit data created after this date."
"RTN","ORDEA01B",88,0)
 I ORCDATE>0 S DIR("?")="To display all audit data created through the date the report runs, leave this field blank."
"RTN","ORDEA01B",89,0)
 D ^DIR
"RTN","ORDEA01B",90,0)
 Q:$D(DTOUT)!($D(DUOUT))
"RTN","ORDEA01B",91,0)
 S ORDDATE=+$G(Y)
"RTN","ORDEA01B",92,0)
 S X=$$DIVPRMPT^ORUTL(.DIV)
"RTN","ORDEA01B",93,0)
 Q:X<1
"RTN","ORDEA01B",94,0)
 S SAVE("ORCDATE")="",SAVE("ORDDATE")="",SAVE("DIV(")=""
"RTN","ORDEA01B",95,0)
 D DEVICE^ORUTL($P(REP(REP),";",3),"OR "_$$UP^XLFSTR($P(REP(REP),";")),"Q",.SAVE)
"RTN","ORDEA01B",96,0)
 Q
"RTN","ORDEA01B",97,0)
AUDITQ ;TASKMAN ENTRY POINT
"RTN","ORDEA01B",98,0)
 ;CBUFFER IS HANDLED BY DEVICE^ORUTL OR TASKMAN
"RTN","ORDEA01B",99,0)
 N ORDATE,ORDATA,ORSITE,PGNUM,ORDUZ,ORDIVISION
"RTN","ORDEA01B",100,0)
 S ORDATA=$NA(^TMP($J,"ORAUDITDATA")) K @ORDATA
"RTN","ORDEA01B",101,0)
 I 'ORDDATE S ORDDATE=DT+0.235959
"RTN","ORDEA01B",102,0)
 E  S ORDDATE=ORDDATE+0.235959
"RTN","ORDEA01B",103,0)
 S ORDATE=ORCDATE F  S ORDATE=$O(^DIA(100.7,"C",ORDATE)) Q:ORDATE=""!(ORDATE>ORDDATE)  D
"RTN","ORDEA01B",104,0)
 .N ORIEN
"RTN","ORDEA01B",105,0)
 .S ORIEN=0 F  S ORIEN=$O(^DIA(100.7,"C",ORDATE,ORIEN)) Q:ORIEN=""  D
"RTN","ORDEA01B",106,0)
 ..N ORNAME,ORACTION,ORTEXT,ORFIELD,OROUTPUT,ORCOUNT,ORITM
"RTN","ORDEA01B",107,0)
 ..S ORFIELD=$P($G(^DIA(100.7,ORIEN,0)),U,3)
"RTN","ORDEA01B",108,0)
 ..S ORNAME=$P($G(^DIA(100.7,ORIEN,3.1)),U)
"RTN","ORDEA01B",109,0)
 ..S:$G(ORNAME)="" ORNAME=$P($G(^DIA(100.7,ORIEN,2.1)),U)
"RTN","ORDEA01B",110,0)
 ..I ORFIELD="1,.01" D  Q:ORDIVISION=""
"RTN","ORDEA01B",111,0)
 ...S ORDIVISION=$$HASDIV^ORUTL(ORNAME,.DIV)
"RTN","ORDEA01B",112,0)
 ..I $D(^DIA(100.7,ORIEN,2.1))=1,'$D(^DIA(100.7,ORIEN,3.1)) S ORACTION="Disabled",ORNAME(1)=$G(^DIA(100.7,ORIEN,2))
"RTN","ORDEA01B",113,0)
 ..I '$D(^DIA(100.7,ORIEN,2.1)),$D(^DIA(100.7,ORIEN,3.1))=1 S ORACTION="Enabled",ORNAME(1)=$G(^DIA(100.7,ORIEN,3))
"RTN","ORDEA01B",114,0)
 ..I $D(^DIA(100.7,ORIEN,2.1))=1,$D(^DIA(100.7,ORIEN,3.1))=1 D
"RTN","ORDEA01B",115,0)
 ...I ORFIELD=.02 S ORACTION=$S($G(^DIA(100.7,ORIEN,2))="YES":"Disabled",1:"Enabled")
"RTN","ORDEA01B",116,0)
 ...E  S ORACTION="Modified"
"RTN","ORDEA01B",117,0)
 ...S ORNAME(1)=$G(^DIA(100.7,ORIEN,3))
"RTN","ORDEA01B",118,0)
 ..I ORFIELD=.01 D  Q
"RTN","ORDEA01B",119,0)
 ...S $P(@ORDATA@("TOP",$P($G(^DIA(100.7,ORIEN,0)),U)),U,3)=ORNAME(1)
"RTN","ORDEA01B",120,0)
 ..S ORNAME("USER")=$$GET1^DIQ(200,$P($G(^DIA(100.7,ORIEN,0)),U,4)_",",.01)
"RTN","ORDEA01B",121,0)
 ..S:ORNAME("USER")="" ORNAME("USER")="User #"_$P($G(^DIA(100.7,ORIEN,0)),U,4)
"RTN","ORDEA01B",122,0)
 ..S ORTEXT=ORACTION_" on "_$$FMTE^XLFDT(ORDATE)_" by "_ORNAME("USER")
"RTN","ORDEA01B",123,0)
 ..I $P($G(^DIA(100.7,ORIEN,4.1)),U)'="" S ORTEXT=ORTEXT_" with option "_$$GET1^DIQ(19,$P($G(^DIA(100.7,ORIEN,4.1)),U)_",",.01)
"RTN","ORDEA01B",124,0)
 ..I ORFIELD=.02,ORACTION="Modified" S ORTEXT=ORTEXT_" from "_$G(^DIA(100.7,ORIEN,2))_" to "_ORNAME(1)
"RTN","ORDEA01B",125,0)
 ..S ORTEXT=ORTEXT_"."
"RTN","ORDEA01B",126,0)
 ..I ORFIELD="1,.01" S OROUTPUT=$NA(@ORDATA@(ORDIVISION,ORNAME,ORIEN))
"RTN","ORDEA01B",127,0)
 ..E  S OROUTPUT=$NA(@ORDATA@("TOP",$P($G(^DIA(100.7,ORIEN,0)),U),ORIEN))
"RTN","ORDEA01B",128,0)
 ..S ORITM=1+$P($G(@($P(OROUTPUT,","_ORIEN_")")_")")),U,2),ORTEXT=$$PAD^ORUTL(ORITM,3)_ORITM_": "_ORTEXT
"RTN","ORDEA01B",129,0)
 ..D WRAP^ORUTL(ORTEXT,OROUTPUT)
"RTN","ORDEA01B",130,0)
 ..S ORCOUNT=@OROUTPUT
"RTN","ORDEA01B",131,0)
 ..S OROUTPUT=$P(OROUTPUT,","_ORIEN_")")_")",$P(@OROUTPUT,U)=ORCOUNT+$G(@OROUTPUT),$P(@OROUTPUT,U,2)=1+$P($G(@OROUTPUT),U,2)
"RTN","ORDEA01B",132,0)
 ..I ORFIELD'=.02 S $P(@OROUTPUT,U,3)=ORNAME(1)
"RTN","ORDEA01B",133,0)
 S STOP=$$HEADER^ORUTL("LOGICAL ACCESS CONTROL AUDIT REPORT",.PGNUM)
"RTN","ORDEA01B",134,0)
 Q:STOP
"RTN","ORDEA01B",135,0)
 S ORSITE(1)=$O(^ORD(100.7,0)),ORSITE=$$GET1^DIQ(100.7,ORSITE(1)_",",.01)
"RTN","ORDEA01B",136,0)
 I ORSITE="" S ORSITE=$P(@ORDATA@("TOP",ORSITE(1)),U,3)
"RTN","ORDEA01B",137,0)
 W "SITE: "_ORSITE
"RTN","ORDEA01B",138,0)
 S ORDIEN=0 F  S ORDIEN=$O(@ORDATA@("TOP",ORSITE(1),ORDIEN)) Q:ORDIEN=""!(STOP)  D
"RTN","ORDEA01B",139,0)
 .N ORLINE
"RTN","ORDEA01B",140,0)
 .S ORLINE=0 F  S ORLINE=$O(@ORDATA@("TOP",ORSITE(1),ORDIEN,ORLINE)) Q:ORLINE=""!(STOP)  D
"RTN","ORDEA01B",141,0)
 ..I ($Y+CBUFFER+1)>IOSL D  Q:STOP
"RTN","ORDEA01B",142,0)
 ...S STOP=$$HEADER^ORUTL("LOGICAL ACCESS CONTROL AUDIT REPORT",.PGNUM)
"RTN","ORDEA01B",143,0)
 ..W !,@ORDATA@("TOP",ORSITE(1),ORDIEN,ORLINE)
"RTN","ORDEA01B",144,0)
 Q:STOP
"RTN","ORDEA01B",145,0)
 S ORDIVISION="" F  S ORDIVISION=$O(@ORDATA@(ORDIVISION)) Q:ORDIVISION=""!(STOP)  D
"RTN","ORDEA01B",146,0)
 .Q:ORDIVISION="TOP"
"RTN","ORDEA01B",147,0)
 .I ($Y+CBUFFER+2)>IOSL D  Q:STOP
"RTN","ORDEA01B",148,0)
 ..S STOP=$$HEADER^ORUTL("LOGICAL ACCESS CONTROL AUDIT REPORT",.PGNUM)
"RTN","ORDEA01B",149,0)
 .W !!,"DIVISION: "_ORDIVISION
"RTN","ORDEA01B",150,0)
 .S ORDUZ=0 F  S ORDUZ=$O(@ORDATA@(ORDIVISION,ORDUZ)) Q:ORDUZ=""!(STOP)  D
"RTN","ORDEA01B",151,0)
 ..I ($Y+CBUFFER+@ORDATA@(ORDIVISION,ORDUZ))>IOSL D  Q:STOP
"RTN","ORDEA01B",152,0)
 ...S STOP=$$HEADER^ORUTL("LOGICAL ACCESS CONTROL AUDIT REPORT",.PGNUM)
"RTN","ORDEA01B",153,0)
 ..N ORDIEN,ORUSER
"RTN","ORDEA01B",154,0)
 ..S ORUSER=$$GET1^DIQ(200,ORDUZ_",",.01)
"RTN","ORDEA01B",155,0)
 ..S:ORUSER="" ORUSER=$P(@ORDATA@(ORDIVISION,ORDUZ),U,3)
"RTN","ORDEA01B",156,0)
 ..W !,"USER: "_ORUSER
"RTN","ORDEA01B",157,0)
 ..S ORDIEN=0 F  S ORDIEN=$O(@ORDATA@(ORDIVISION,ORDUZ,ORDIEN)) Q:ORDIEN=""  D
"RTN","ORDEA01B",158,0)
 ...N ORLINE
"RTN","ORDEA01B",159,0)
 ...S ORLINE=0 F  S ORLINE=$O(@ORDATA@(ORDIVISION,ORDUZ,ORDIEN,ORLINE)) Q:ORLINE=""  D
"RTN","ORDEA01B",160,0)
 ....W !,@ORDATA@(ORDIVISION,ORDUZ,ORDIEN,ORLINE)
"RTN","ORDEA01B",161,0)
 K @ORDATA
"RTN","ORDEA01B",162,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01B",163,0)
 Q
"RTN","ORDEA01B",164,0)
LAST ;List those providers that contain a space and/or punctuation in the last name
"RTN","ORDEA01B",165,0)
 ;REP IS HANDLED BY REPORTS^ORDEA01
"RTN","ORDEA01B",166,0)
 W !!,"This report identifies providers with one or more space or punctuation",!
"RTN","ORDEA01B",167,0)
 W "characters in their family (last) name. These providers may not be able to",!
"RTN","ORDEA01B",168,0)
 W "link their PIV card using CPRS GUI. For these providers, someone may have",!
"RTN","ORDEA01B",169,0)
 W "to use the Data Entry for e-Prescribing Controlled Substances GUI and",!
"RTN","ORDEA01B",170,0)
 W "manually enter the subject alternative name stored on the provider's PIV",!
"RTN","ORDEA01B",171,0)
 W "card.",!!
"RTN","ORDEA01B",172,0)
 W "Additionally, it is recommended that for those providers who's NAME COMPONENTS",!
"RTN","ORDEA01B",173,0)
 W "file (#20) entry does not exactly match the value in the NAME field (#.01) in",!
"RTN","ORDEA01B",174,0)
 W "the NEW PERSON file (#200), either the NAME COMPONENTS file entry or the value",!
"RTN","ORDEA01B",175,0)
 W "in the NAME field in the NEW PERSON file are modified so that both are the same.",!
"RTN","ORDEA01B",176,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,DISINC,DIV,SCREEN2,SAVE
"RTN","ORDEA01B",177,0)
 S DISINC=$$DISPRMPT^ORDEA01()
"RTN","ORDEA01B",178,0)
 Q:DISINC=U
"RTN","ORDEA01B",179,0)
 W !
"RTN","ORDEA01B",180,0)
 S DIR(0)="Y"_U
"RTN","ORDEA01B",181,0)
 S DIR("A",1)="Do you want to include providers who have already linked their PIV card"
"RTN","ORDEA01B",182,0)
 S DIR("A")="with their VistA account"
"RTN","ORDEA01B",183,0)
 S DIR("B")="NO"
"RTN","ORDEA01B",184,0)
 D ^DIR
"RTN","ORDEA01B",185,0)
 Q:$D(DIRUT)
"RTN","ORDEA01B",186,0)
 I 'Y S SCREEN2="I $$GET1^DIQ(200,Y_"","",501.2)="""""
"RTN","ORDEA01B",187,0)
 S X=$$DIVPRMPT^ORUTL(.DIV)
"RTN","ORDEA01B",188,0)
 Q:X<1
"RTN","ORDEA01B",189,0)
 S SAVE("DISINC")="",SAVE("DIV(")=""
"RTN","ORDEA01B",190,0)
 S:$D(SCREEN2) SAVE("SCREEN2")=""
"RTN","ORDEA01B",191,0)
 D DEVICE^ORUTL($P(REP(REP),";",3),"OR "_$$UP^XLFSTR($P(REP(REP),";")),"Q",.SAVE)
"RTN","ORDEA01B",192,0)
 Q
"RTN","ORDEA01B",193,0)
LASTQ ;TASKMAN ENTRY POINT
"RTN","ORDEA01B",194,0)
 ;CBUFFER IS HANDLED BY DEVICE^ORUTL OR TASKMAN
"RTN","ORDEA01B",195,0)
 N Y,OUT,DATA,REASON,PGNUM,COL,STOP,OUTPUT,DHEADER
"RTN","ORDEA01B",196,0)
 S DATA=$NA(^TMP($J,"ORLASTMP")) K @DATA
"RTN","ORDEA01B",197,0)
 S COL(2)=$$LJ^XLFSTR("PROVIDER NAME",37," ")_"ACCOUNT STATUS"
"RTN","ORDEA01B",198,0)
 S REASON="THE NAME COMPONENTS FILE (#20) ENTRY DOES NOT MATCH THE NAME FIELD (#.01) IN THE "
"RTN","ORDEA01B",199,0)
 S REASON=REASON_"NEW PERSON FILE (#200)."
"RTN","ORDEA01B",200,0)
 ;IA #10076
"RTN","ORDEA01B",201,0)
 S Y=0 F  S Y=$O(^XUSEC("ORES",Y)) Q:+$G(Y)=0  D
"RTN","ORDEA01B",202,0)
 .N STATUS S STATUS=$$ACTIVE^XUSER(Y)
"RTN","ORDEA01B",203,0)
 .I 'DISINC,(+STATUS<1),($P(STATUS,U,2)'="") Q
"RTN","ORDEA01B",204,0)
 .;INCLUDE USERS WHO CANNOT SIGN-ON IN ACTIVE LISTING
"RTN","ORDEA01B",205,0)
 .S STATUS("TEXT")=$S($P(STATUS,U,2)'="":$P(STATUS,U,2),STATUS=0:"CANNOT SIGN ON",1:"UNKNOWN")
"RTN","ORDEA01B",206,0)
 .I STATUS=0 S STATUS=1
"RTN","ORDEA01B",207,0)
 .N DIVISION S DIVISION=$$HASDIV^ORUTL(Y,.DIV)
"RTN","ORDEA01B",208,0)
 .Q:DIVISION=""
"RTN","ORDEA01B",209,0)
 .I $D(SCREEN2) X SCREEN2 I '$T Q
"RTN","ORDEA01B",210,0)
 .N ONAME,CNAME,ITEM
"RTN","ORDEA01B",211,0)
 .S ONAME=$$GET1^DIQ(200,Y_",",.01)
"RTN","ORDEA01B",212,0)
 .D NAMECOMP^XLFNAME(.ONAME)
"RTN","ORDEA01B",213,0)
 .S ONAME("STRIPPED")=$$STRIP^ORDEA01A(ONAME("FAMILY"))
"RTN","ORDEA01B",214,0)
 .S CNAME("FILE")=200,CNAME("FIELD")=.01,CNAME("IENS")=Y_","
"RTN","ORDEA01B",215,0)
 .S CNAME=$$NAMEFMT^XLFNAME(.CNAME,"F","C")
"RTN","ORDEA01B",216,0)
 .D NAMECOMP^XLFNAME(.CNAME)
"RTN","ORDEA01B",217,0)
 .S CNAME("STRIPPED")=$$STRIP^ORDEA01A(CNAME("FAMILY"))
"RTN","ORDEA01B",218,0)
 .I ONAME("FAMILY")'=ONAME("STRIPPED") S @DATA@(DIVISION,+STATUS,ONAME)=STATUS("TEXT")
"RTN","ORDEA01B",219,0)
 .I ONAME("FAMILY")=ONAME("STRIPPED")&(CNAME("FAMILY")'=CNAME("STRIPPED")) D
"RTN","ORDEA01B",220,0)
 ..S @DATA@(DIVISION,+STATUS,ONAME)=STATUS("TEXT")
"RTN","ORDEA01B",221,0)
 ..S @DATA@(DIVISION,+STATUS,ONAME,CNAME)=""
"RTN","ORDEA01B",222,0)
 .F ITEM="FAMILY","GIVEN","MIDDLE","SUFFIX" D
"RTN","ORDEA01B",223,0)
 ..I ONAME(ITEM)'=CNAME(ITEM) D
"RTN","ORDEA01B",224,0)
 ...S @DATA@(DIVISION,+STATUS,ONAME)=STATUS("TEXT")
"RTN","ORDEA01B",225,0)
 ...S @DATA@(DIVISION,+STATUS,ONAME,CNAME)=REASON
"RTN","ORDEA01B",226,0)
 N DIVISION S DIVISION="" F  S DIVISION=$O(@DATA@(DIVISION)) Q:$G(DIVISION)=""!($G(STOP))  D
"RTN","ORDEA01B",227,0)
 .S COL(1)="DIVISION: "_DIVISION
"RTN","ORDEA01B",228,0)
 .S STOP=$$HEADER^ORUTL("PROVIDER LAST NAME REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",229,0)
 .Q:STOP
"RTN","ORDEA01B",230,0)
 .S DHEADER=0
"RTN","ORDEA01B",231,0)
 .N STATUS F STATUS=1:-1:0  D  Q:STOP
"RTN","ORDEA01B",232,0)
 ..N NAME S NAME="" F  S NAME=$O(@DATA@(DIVISION,STATUS,NAME)) Q:$G(NAME)=""!(STOP)  D
"RTN","ORDEA01B",233,0)
 ...N NAMEC,OUT S NAMEC="" F  S NAMEC=$O(@DATA@(DIVISION,STATUS,NAME,NAMEC)) Q:$G(NAMEC)=""!(STOP)  D
"RTN","ORDEA01B",234,0)
 ....D WRAP^ORUTL("    NAME COMPONENTS: "_NAMEC,"OUT") S OUT=OUT+1
"RTN","ORDEA01B",235,0)
 ....I $G(@DATA@(DIVISION,STATUS,NAME,NAMEC))'="" D WRAP^ORUTL("    "_@DATA@(DIVISION,STATUS,NAME,NAMEC),"OUT")
"RTN","ORDEA01B",236,0)
 ...I ($Y+$G(OUT)+CBUFFER+$S(STATUS=0&('DHEADER):3,1:0))>IOSL D  Q:STOP
"RTN","ORDEA01B",237,0)
 ....S STOP=$$HEADER^ORUTL("PROVIDER LAST NAME REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",238,0)
 ...I STATUS=0,('DHEADER) D
"RTN","ORDEA01B",239,0)
 ....W:$Y>4 !
"RTN","ORDEA01B",240,0)
 ....W $$CJ^XLFSTR("*** DISUSERED/TERMINATED USERS ***",$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01B",241,0)
 ....W $$CJ^XLFSTR($$REPEAT^XLFSTR("-",34),$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01B",242,0)
 ....S DHEADER=1
"RTN","ORDEA01B",243,0)
 ...W $$LJ^XLFSTR(NAME,37," ")_@DATA@(DIVISION,STATUS,NAME),!
"RTN","ORDEA01B",244,0)
 ...S OUT=0 F  S OUT=$O(OUT(OUT)) Q:'OUT  W OUT(OUT) I ($Y+1)<IOSL W !
"RTN","ORDEA01B",245,0)
 ...S OUTPUT=1
"RTN","ORDEA01B",246,0)
 I '$G(STOP) D
"RTN","ORDEA01B",247,0)
 .I '$G(OUTPUT) D  Q:$G(STOP)
"RTN","ORDEA01B",248,0)
 ..S STOP=$$HEADER^ORUTL("PROVIDER LAST NAME REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",249,0)
 ..Q:STOP
"RTN","ORDEA01B",250,0)
 ..W !,$$CJ^XLFSTR("No family (last) name issues found.",$S(+$G(IOM)>0:(IOM-1),1:79)," "),!
"RTN","ORDEA01B",251,0)
 .I ($Y+2)>IOSL S STOP=$$HEADER^ORUTL("PROVIDER LAST NAME REPORT",.PGNUM,.COL)
"RTN","ORDEA01B",252,0)
 .Q:$G(STOP)
"RTN","ORDEA01B",253,0)
 .W !,$$CJ^XLFSTR("[END OF REPORT]",$S(+$G(IOM)>0:(IOM-1),1:79)," ")
"RTN","ORDEA01B",254,0)
 K @DATA
"RTN","ORDEA01B",255,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORDEA01B",256,0)
 Q
"RTN","ORDEBUG")
0^24^B15661026
"RTN","ORDEBUG",1,0)
ORDEBUG ;SLC/JMH,AJB - CPRS Debug Support Routine ;12/22/14  10:02
"RTN","ORDEBUG",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORDEBUG",3,0)
 ;
"RTN","ORDEBUG",4,0)
SAVERPCS(ORY,ORKEY,ORDATA) ;
"RTN","ORDEBUG",5,0)
 ;
"RTN","ORDEBUG",6,0)
 N ORI S ORI=""
"RTN","ORDEBUG",7,0)
 S ORI=$O(^XTMP("CPRS DEBUG LOG",ORKEY,"RPCS",ORI),-1)
"RTN","ORDEBUG",8,0)
 I 'ORI S ORI=0
"RTN","ORDEBUG",9,0)
 S ORI=ORI+1
"RTN","ORDEBUG",10,0)
 M ^XTMP("CPRS DEBUG LOG",ORKEY,"RPCS",ORI)=ORDATA
"RTN","ORDEBUG",11,0)
 Q
"RTN","ORDEBUG",12,0)
 ;
"RTN","ORDEBUG",13,0)
SAVEDESC(ORY,ORKEY,ORDATA) ;
"RTN","ORDEBUG",14,0)
 ;
"RTN","ORDEBUG",15,0)
 S ^XTMP("CPRS DEBUG LOG",0)=$$FMADD^XLFDT($$NOW^XLFDT,60)_U_$$NOW^XLFDT
"RTN","ORDEBUG",16,0)
 M ^XTMP("CPRS DEBUG LOG",ORKEY,"DESCRIPTION")=ORDATA
"RTN","ORDEBUG",17,0)
 N XMSUB,XMY,XMTEXT,XMDUZ,ORTEXT
"RTN","ORDEBUG",18,0)
 S ORTEXT(1)="Run option OR DEBUG REPORT to view information about this Debug Report."
"RTN","ORDEBUG",19,0)
 S XMDUZ=DUZ
"RTN","ORDEBUG",20,0)
 S XMSUB="NEW DEBUG REPORT SUBMITTED BY "_$P($G(^VA(200,+ORKEY,0)),U)_" AT "_$P(ORKEY,U,2)
"RTN","ORDEBUG",21,0)
 S XMY("G.OR CACS")=""
"RTN","ORDEBUG",22,0)
 S XMTEXT="ORTEXT("
"RTN","ORDEBUG",23,0)
 D ^XMD
"RTN","ORDEBUG",24,0)
 Q
"RTN","ORDEBUG",25,0)
EN ;
"RTN","ORDEBUG",26,0)
 W @IOF
"RTN","ORDEBUG",27,0)
 N DESC,POP,RTN,SAVE
"RTN","ORDEBUG",28,0)
 S DESC="CPRS Debug Log Viewer",RTN="LOG^ORDEBUG" ; ,SAVE("*")=""
"RTN","ORDEBUG",29,0)
 W ! D EN^XUTMDEVQ(RTN,DESC,.SAVE)
"RTN","ORDEBUG",30,0)
 Q
"RTN","ORDEBUG",31,0)
LOG ;
"RTN","ORDEBUG",32,0)
 ;
"RTN","ORDEBUG",33,0)
 N DATA,DLM S DATA=$NA(^XTMP("CPRS DEBUG LOG")),DLM=","
"RTN","ORDEBUG",34,0)
 N INFO S INFO=$NA(^XTMP("DEBUG LOG VIEW",$J))
"RTN","ORDEBUG",35,0)
 K @INFO
"RTN","ORDEBUG",36,0)
 ;
"RTN","ORDEBUG",37,0)
 ; ^XTMP format
"RTN","ORDEBUG",38,0)
 ; P1="<usr IEN>^DD/MM/YYYY HH:MM:SS"
"RTN","ORDEBUG",39,0)
 ; P2=type of data [description, rpc, etc.]
"RTN","ORDEBUG",40,0)
 ; P3=counter for type
"RTN","ORDEBUG",41,0)
 ; P4=counter for # of lines in type
"RTN","ORDEBUG",42,0)
 ;
"RTN","ORDEBUG",43,0)
 W """USER"",""DATE"",""TIME"",""RPC #"",""DESCRIPTION/RPC"",""PARAMETERS"",""RESULTS"""
"RTN","ORDEBUG",44,0)
 ;
"RTN","ORDEBUG",45,0)
 ; get XTMP data and sort for various output
"RTN","ORDEBUG",46,0)
 N P1,P2,P3,P4
"RTN","ORDEBUG",47,0)
 S P1=0 F  S P1=$O(@DATA@(P1)) Q:'+P1  S P2=""  F  S P2=$O(@DATA@(P1,P2)) Q:P2=""  S P3="" F  S P3=$O(@DATA@(P1,P2,P3)) Q:P3=""  D
"RTN","ORDEBUG",48,0)
 . N DEV,DATE,TIME
"RTN","ORDEBUG",49,0)
 . S DEV=$$GET1^DIQ(200,$P(P1,U),.01)
"RTN","ORDEBUG",50,0)
 . S DATE=$P($P(P1,U,2)," ")
"RTN","ORDEBUG",51,0)
 . S TIME=$P($P(P1,U,2)," ",2)
"RTN","ORDEBUG",52,0)
 . I P2="DESCRIPTION" D
"RTN","ORDEBUG",53,0)
 . . S:P3=0 @INFO@(DEV,DATE,TIME,0,0,P2,0)=@DATA@(P1,P2,P3)
"RTN","ORDEBUG",54,0)
 . . S:P3'=0 @INFO@(DEV,DATE,TIME,0,0,P2,P3)=@DATA@(P1,P2,P3)
"RTN","ORDEBUG",55,0)
 . N RSLTS S RSLTS=0 S P4="" F  S P4=$O(@DATA@(P1,P2,P3,P4)) Q:P4=""  D
"RTN","ORDEBUG",56,0)
 . . ;I P3'=4 Q  ; ***** control number of results for testing
"RTN","ORDEBUG",57,0)
 . . I P4=0 S @INFO@(DEV,DATE,TIME,P3,0,"RPC",P4)=@DATA@(P1,P2,P3,P4) S P4=3 Q  ; set 0 node=RPC name set P=3 to skip 1 & 2
"RTN","ORDEBUG",58,0)
 . . I P4=4,@DATA@(P1,P2,P3,P4)=" " S @INFO@(DEV,DATE,TIME,P3,1,"PARAM",P4)="",RSLTS=1 Q  ; no parameters for RPC
"RTN","ORDEBUG",59,0)
 . . I @DATA@(P1,P2,P3,P4)["Results -----" S RSLTS=1 Q
"RTN","ORDEBUG",60,0)
 . . I '+RSLTS,@DATA@(P1,P2,P3,P4)'=" " S @INFO@(DEV,DATE,TIME,P3,1,"PARAM",P4)=@DATA@(P1,P2,P3,P4)
"RTN","ORDEBUG",61,0)
 . . I +RSLTS,@DATA@(P1,P2,P3,P4)'=" " S @INFO@(DEV,DATE,TIME,P3,2,"RESULT",P4)=@DATA@(P1,P2,P3,P4)
"RTN","ORDEBUG",62,0)
 ;
"RTN","ORDEBUG",63,0)
 ; ^XTMP format [RPC,Parameters,Results]
"RTN","ORDEBUG",64,0)
 ; P1=user name
"RTN","ORDEBUG",65,0)
 ; P2=date of log
"RTN","ORDEBUG",66,0)
 ; P3=time of log
"RTN","ORDEBUG",67,0)
 ; P4=RPC number
"RTN","ORDEBUG",68,0)
 ; P5=type of data numeric [0=RPC name,1=Parameter,2=Result]
"RTN","ORDEBUG",69,0)
 ; P6=type of data
"RTN","ORDEBUG",70,0)
 ; P7=line number
"RTN","ORDEBUG",71,0)
 ;
"RTN","ORDEBUG",72,0)
 N P5,P6,P7
"RTN","ORDEBUG",73,0)
 S P1="" F  S P1=$O(@INFO@(P1)) Q:P1=""  S P2="" F  S P2=$O(@INFO@(P1,P2)) Q:P2=""  S P3="" F  S P3=$O(@INFO@(P1,P2,P3)) Q:P3=""  S P4="" F  S P4=$O(@INFO@(P1,P2,P3,P4)) Q:P4=""  D
"RTN","ORDEBUG",74,0)
 . W !,$C(34),P1,$C(34),DLM,$C(34),P2,$C(34),DLM,$C(34),P3,$C(34),DLM,$C(34),P4,$C(34),DLM
"RTN","ORDEBUG",75,0)
 . S P5="" F  S P5=$O(@INFO@(P1,P2,P3,P4,P5)) Q:P5=""  D
"RTN","ORDEBUG",76,0)
 . . S P6="" F  S P6=$O(@INFO@(P1,P2,P3,P4,P5,P6)) Q:P6=""  S P7="" F  S P7=$O(@INFO@(P1,P2,P3,P4,P5,P6,P7)) Q:P7=""  D
"RTN","ORDEBUG",77,0)
 . . . I $O(@INFO@(P1,P2,P3,P4,P5,P6,P7),-1)="" W $C(34)
"RTN","ORDEBUG",78,0)
 . . . W $TR(@INFO@(P1,P2,P3,P4,P5,P6,P7),"""","'") ; ***** convert any double quotes into single quotes to avoid confusing Excel during import
"RTN","ORDEBUG",79,0)
 . . . I $O(@INFO@(P1,P2,P3,P4,P5,P6,P7))'="" W !
"RTN","ORDEBUG",80,0)
 . . . I $O(@INFO@(P1,P2,P3,P4,P5,P6,P7))="" W $C(34) I P4'=0 I P5=0!(P5=1) W DLM
"RTN","ORDEBUG",81,0)
 ;
"RTN","ORDEBUG",82,0)
 K @INFO
"RTN","ORDEBUG",83,0)
 Q
"RTN","ORDEBUG1")
0^86^B10131141
"RTN","ORDEBUG1",1,0)
ORDEBUG1 ;SLC/AJB - CPRS Debug Support Routine ;10/13/15  10:13
"RTN","ORDEBUG1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORDEBUG1",3,0)
 ;
"RTN","ORDEBUG1",4,0)
 Q
"RTN","ORDEBUG1",5,0)
 ;
"RTN","ORDEBUG1",6,0)
EN ;
"RTN","ORDEBUG1",7,0)
 W @IOF
"RTN","ORDEBUG1",8,0)
 N DESC,POP,RTN,SAVE
"RTN","ORDEBUG1",9,0)
 S DESC="CPRS Debug Log Viewer",RTN="SHOWME^ORDEBUG1" ; ,SAVE("*")=""
"RTN","ORDEBUG1",10,0)
 W ! D EN^XUTMDEVQ(RTN,DESC,.SAVE)
"RTN","ORDEBUG1",11,0)
 Q
"RTN","ORDEBUG1",12,0)
SHOWME ;
"RTN","ORDEBUG1",13,0)
 ;
"RTN","ORDEBUG1",14,0)
 N DATA,DLM S DATA=$NA(^XTMP("CPRS DEBUG LOG")),DLM=","
"RTN","ORDEBUG1",15,0)
 N INFO S INFO="TEMP" ; $NA(^XTMP("DEBUG LOG VIEW",$J))
"RTN","ORDEBUG1",16,0)
 K @INFO
"RTN","ORDEBUG1",17,0)
 ;
"RTN","ORDEBUG1",18,0)
 ; ^XTMP format
"RTN","ORDEBUG1",19,0)
 ; P1="<usr IEN>^DD/MM/YYYY HH:MM:SS"
"RTN","ORDEBUG1",20,0)
 ; P2=type of data [description, rpc, etc.]
"RTN","ORDEBUG1",21,0)
 ; P3=counter for type
"RTN","ORDEBUG1",22,0)
 ; P4=counter for # of lines in type
"RTN","ORDEBUG1",23,0)
 ;
"RTN","ORDEBUG1",24,0)
 W """USER"",""DATE"",""TIME"",""RPC #"",""DESCRIPTION/RPC"",""PARAMETERS"",""RESULTS"""
"RTN","ORDEBUG1",25,0)
 ;
"RTN","ORDEBUG1",26,0)
 ; get XTMP data and sort for various output
"RTN","ORDEBUG1",27,0)
 N P1,P2,P3,P4
"RTN","ORDEBUG1",28,0)
 S P1=0 F  S P1=$O(@DATA@(P1)) Q:'+P1  S P2=""  F  S P2=$O(@DATA@(P1,P2)) Q:P2=""  S P3="" F  S P3=$O(@DATA@(P1,P2,P3)) Q:P3=""  D
"RTN","ORDEBUG1",29,0)
 . N DEV,DATE,TIME
"RTN","ORDEBUG1",30,0)
 . S DEV=$$GET1^DIQ(200,$P(P1,U),.01)
"RTN","ORDEBUG1",31,0)
 . S DATE=$P($P(P1,U,2)," ")
"RTN","ORDEBUG1",32,0)
 . S TIME=$P($P(P1,U,2)," ",2)
"RTN","ORDEBUG1",33,0)
 . I P2="DESCRIPTION" D
"RTN","ORDEBUG1",34,0)
 . . S:P3=0 @INFO@(DEV,DATE,TIME,0,0,P2,0)=@DATA@(P1,P2,P3)
"RTN","ORDEBUG1",35,0)
 . . S:P3'=0 @INFO@(DEV,DATE,TIME,0,0,P2,P3)=@DATA@(P1,P2,P3)
"RTN","ORDEBUG1",36,0)
 . N RSLTS S RSLTS=0 S P4="" F  S P4=$O(@DATA@(P1,P2,P3,P4)) Q:P4=""  D
"RTN","ORDEBUG1",37,0)
 . . ; I P3'=76 Q  ; ***** control number of results
"RTN","ORDEBUG1",38,0)
 . . I P4=1!(P4=2) Q  ; skip first " " entry and "Parameters ---..." entry
"RTN","ORDEBUG1",39,0)
 . . I P4=0 S @INFO@(DEV,DATE,TIME,P3,0,"RPC",P4)=@DATA@(P1,P2,P3,P4) Q  ; set 0 node=RPC name
"RTN","ORDEBUG1",40,0)
 . . I P4=3,@DATA@(P1,P2,P3,P4)=" " S @INFO@(DEV,DATE,TIME,P3,1,"PARAM",P4)="",RSLTS=1 Q  ; no parameters for RPC
"RTN","ORDEBUG1",41,0)
 . . I @DATA@(P1,P2,P3,P4)["Results -----" S RSLTS=1 Q
"RTN","ORDEBUG1",42,0)
 . . I '+RSLTS,@DATA@(P1,P2,P3,P4)'=" " S @INFO@(DEV,DATE,TIME,P3,1,"PARAM",P4)=@DATA@(P1,P2,P3,P4)
"RTN","ORDEBUG1",43,0)
 . . I +RSLTS,@DATA@(P1,P2,P3,P4)'=" " S @INFO@(DEV,DATE,TIME,P3,2,"RESULT",P4)=@DATA@(P1,P2,P3,P4)
"RTN","ORDEBUG1",44,0)
 ;
"RTN","ORDEBUG1",45,0)
 ; ^XTMP format [RPC,Parameters,Results]
"RTN","ORDEBUG1",46,0)
 ; P1=user name
"RTN","ORDEBUG1",47,0)
 ; P2=date of log
"RTN","ORDEBUG1",48,0)
 ; P3=time of log
"RTN","ORDEBUG1",49,0)
 ; P4=RPC number
"RTN","ORDEBUG1",50,0)
 ; P5=type of data numeric [0=RPC name,1=Parameter,2=Result]
"RTN","ORDEBUG1",51,0)
 ; P6=type of data
"RTN","ORDEBUG1",52,0)
 ; P7=line number
"RTN","ORDEBUG1",53,0)
 ;
"RTN","ORDEBUG1",54,0)
 N P5,P6,P7
"RTN","ORDEBUG1",55,0)
 S P1="" F  S P1=$O(@INFO@(P1)) Q:P1=""  S P2="" F  S P2=$O(@INFO@(P1,P2)) Q:P2=""  S P3="" F  S P3=$O(@INFO@(P1,P2,P3)) Q:P3=""  S P4="" F  S P4=$O(@INFO@(P1,P2,P3,P4)) Q:P4=""  D
"RTN","ORDEBUG1",56,0)
 . W !,$C(34),P1,$C(34),DLM,$C(34),P2,$C(34),DLM,$C(34),P3,$C(34),DLM,$C(34),P4,$C(34),DLM
"RTN","ORDEBUG1",57,0)
 . S P5="" F  S P5=$O(@INFO@(P1,P2,P3,P4,P5)) Q:P5=""  D
"RTN","ORDEBUG1",58,0)
 . . S P6="" F  S P6=$O(@INFO@(P1,P2,P3,P4,P5,P6)) Q:P6=""  S P7="" F  S P7=$O(@INFO@(P1,P2,P3,P4,P5,P6,P7)) Q:P7=""  D
"RTN","ORDEBUG1",59,0)
 . . . I $O(@INFO@(P1,P2,P3,P4,P5,P6,P7),-1)="" W $C(34)
"RTN","ORDEBUG1",60,0)
 . . . W @INFO@(P1,P2,P3,P4,P5,P6,P7)
"RTN","ORDEBUG1",61,0)
 . . . I $O(@INFO@(P1,P2,P3,P4,P5,P6,P7))'="" W !
"RTN","ORDEBUG1",62,0)
 . . . I $O(@INFO@(P1,P2,P3,P4,P5,P6,P7))="" W $C(34) I P4'=0 I P5=0!(P5=1) W DLM
"RTN","ORDEBUG1",63,0)
 ;
"RTN","ORDEBUG1",64,0)
 ;
"RTN","ORDEBUG1",65,0)
 Q
"RTN","ORDEBUG2")
0^40^B5203678
"RTN","ORDEBUG2",1,0)
ORDEBUG2 ;SLC/JMH - DEBUG REPORT ;10/15/14  07:13
"RTN","ORDEBUG2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORDEBUG2",3,0)
DL ;
"RTN","ORDEBUG2",4,0)
 N ORLST,ORI,ORCNT,ORREP
"RTN","ORDEBUG2",5,0)
 W !!,"#",?5,"USER",?35,"DATE/TIME"
"RTN","ORDEBUG2",6,0)
 W !,"============================================================================"
"RTN","ORDEBUG2",7,0)
 S ORI=0,ORCNT=0 F  S ORI=$O(^XTMP("CPRS DEBUG LOG",ORI)) Q:'$L(ORI)  D
"RTN","ORDEBUG2",8,0)
 .S ORCNT=ORCNT+1
"RTN","ORDEBUG2",9,0)
 .S ORLST(ORCNT)=ORI
"RTN","ORDEBUG2",10,0)
 .W !,ORCNT,") ",?5,$P(^VA(200,+ORI,0),U),?35,$P(ORI,U,2)
"RTN","ORDEBUG2",11,0)
 S ORREP=$$TDIR("Debug Report #")
"RTN","ORDEBUG2",12,0)
 I ORREP=0 Q
"RTN","ORDEBUG2",13,0)
 I '$D(ORLST(ORREP)) W !,"Not a valid selection" Q
"RTN","ORDEBUG2",14,0)
 D REP(ORLST(ORREP))
"RTN","ORDEBUG2",15,0)
 D DL
"RTN","ORDEBUG2",16,0)
 Q
"RTN","ORDEBUG2",17,0)
REP(ORINST) ;
"RTN","ORDEBUG2",18,0)
 ;ZW ^XTMP("CPRS DEBUG LOG",ORINST)
"RTN","ORDEBUG2",19,0)
 W !!,"Viewing report generated by "_$P(^VA(200,+ORINST,0),U)_" on "_$P(ORINST,U,2)
"RTN","ORDEBUG2",20,0)
 W !!,"DESCRIPTION",!,"==========="
"RTN","ORDEBUG2",21,0)
 N ORJ S ORJ="" F  S ORJ=$O(^XTMP("CPRS DEBUG LOG",ORINST,"DESCRIPTION",ORJ)) Q:'$L(ORJ)  D
"RTN","ORDEBUG2",22,0)
 .W !,^XTMP("CPRS DEBUG LOG",ORINST,"DESCRIPTION",ORJ)
"RTN","ORDEBUG2",23,0)
 N ORLST,ORI,ORCNT
"RTN","ORDEBUG2",24,0)
 W !!,"#",?5,"RPC"
"RTN","ORDEBUG2",25,0)
 W !,"============================================================================"
"RTN","ORDEBUG2",26,0)
 S ORI=0,ORCNT=0 F  S ORI=$O(^XTMP("CPRS DEBUG LOG",ORINST,"RPCS",ORI)) Q:'$L(ORI)  D
"RTN","ORDEBUG2",27,0)
 .S ORCNT=ORCNT+1
"RTN","ORDEBUG2",28,0)
 .S ORLST(ORCNT)=ORI
"RTN","ORDEBUG2",29,0)
 .W !,ORCNT,") ",?5,$G(^XTMP("CPRS DEBUG LOG",ORINST,"RPCS",ORI,0))
"RTN","ORDEBUG2",30,0)
 N ORRPC
"RTN","ORDEBUG2",31,0)
 F  S ORRPC=$$TDIR("RPC #") Q:ORRPC=0  D
"RTN","ORDEBUG2",32,0)
 .I '$D(ORLST(ORRPC)) W !,"Not a valid selection" Q
"RTN","ORDEBUG2",33,0)
 .W !!,"============","BEGINNING OF RPC INFO","============"
"RTN","ORDEBUG2",34,0)
 .N ORK S ORK="" F  S ORK=$O(^XTMP("CPRS DEBUG LOG",ORINST,"RPCS",ORLST(ORRPC),ORK)) Q:'$L(ORK)  D
"RTN","ORDEBUG2",35,0)
 ..W !,">>",^XTMP("CPRS DEBUG LOG",ORINST,"RPCS",ORLST(ORRPC),ORK)
"RTN","ORDEBUG2",36,0)
 .W !!,"============","END OF RPC INFO","============"
"RTN","ORDEBUG2",37,0)
 Q
"RTN","ORDEBUG2",38,0)
TDIR(ORTXT) ;
"RTN","ORDEBUG2",39,0)
 N X,Y,DIR
"RTN","ORDEBUG2",40,0)
 S DIR(0)="NO"
"RTN","ORDEBUG2",41,0)
 S DIR("A")=ORTXT,DIR("B")="^"
"RTN","ORDEBUG2",42,0)
 S DIR("?")=""
"RTN","ORDEBUG2",43,0)
 W !,"Choose a number to view"
"RTN","ORDEBUG2",44,0)
 D ^DIR S:$D(DUOUT)!$D(DTOUT) Y="0"
"RTN","ORDEBUG2",45,0)
 Q Y
"RTN","ORDV02")
0^18^B73541446
"RTN","ORDV02",1,0)
ORDV02 ;SLC/DCM - OE/RR REPORT EXTRACTS ;03/17/2015  10:24
"RTN","ORDV02",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**109,118,146,141,208,318,350**;Dec 17, 1997;Build 77
"RTN","ORDV02",3,0)
 ;LAB Components
"RTN","ORDV02",4,0)
LO(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT)      ; Lab Order Component
"RTN","ORDV02",5,0)
 ;External calls to ^GMTSLROE
"RTN","ORDV02",6,0)
 ;
"RTN","ORDV02",7,0)
 I $L($T(GCPR^OMGCOAS1)) D  ; Call if FHIE station 200
"RTN","ORDV02",8,0)
 . N BEG,END,MAX
"RTN","ORDV02",9,0)
 . Q:'$G(ORALPHA)  Q:'$G(OROMEGA)
"RTN","ORDV02",10,0)
 . S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999)
"RTN","ORDV02",11,0)
 . S BEG=9999999-OROMEGA,END=9999999-ORALPHA
"RTN","ORDV02",12,0)
 . D GCPR^OMGCOAS1(DFN,"LRO",BEG,END,MAX)
"RTN","ORDV02",13,0)
 ;
"RTN","ORDV02",14,0)
 N D,SN,ORX0,MAX,GMTS1,GMTS2,GMTSBEG,GMTSEND,ORSITE,SITE,GO
"RTN","ORDV02",15,0)
 Q:'$L(OREXT)
"RTN","ORDV02",16,0)
 S GO=$P(OREXT,";")_"^"_$P(OREXT,";",2)
"RTN","ORDV02",17,0)
 Q:'$L($T(@GO))
"RTN","ORDV02",18,0)
 S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999),GMTS1=OROMEGA,GMTS2=ORALPHA,GMTSBEG=ORDBEG,GMTSEND=ORDEND
"RTN","ORDV02",19,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV02",20,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV02",21,0)
 I '$L($T(GCPR^OMGCOAS1)) D
"RTN","ORDV02",22,0)
 . K ^TMP("LRO",$J),^TMP("ORTXT",$J)
"RTN","ORDV02",23,0)
 . D @GO
"RTN","ORDV02",24,0)
 S (CTR,D)=0
"RTN","ORDV02",25,0)
 F  S D=$O(^TMP("LRO",$J,D)) Q:'D  D
"RTN","ORDV02",26,0)
 . S SN=0
"RTN","ORDV02",27,0)
 . F  S SN=$O(^TMP("LRO",$J,D,SN)) Q:'SN  S ORX0=^(SN) I $L(ORX0) D
"RTN","ORDV02",28,0)
 .. S SITE=$S($L($G(^TMP("LRO",$J,D,SN,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV02",29,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",1)="1^"_SITE ;Station ID
"RTN","ORDV02",30,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",2)="2^"_$P(ORX0,U) ;collection date
"RTN","ORDV02",31,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",3)="3^"_$P($P(ORX0,U,2),";",2) ;test name
"RTN","ORDV02",32,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",4)="4^"_$P($P(ORX0,U,2),";") ;test ien
"RTN","ORDV02",33,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",5)="5^"_$P($P(ORX0,U,3),";",2) ;specimen name
"RTN","ORDV02",34,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",6)="6^"_$P($P(ORX0,U,3),";") ;specimen ien
"RTN","ORDV02",35,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",7)="7^"_$P(ORX0,U,4) ;urgency
"RTN","ORDV02",36,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",8)="8^"_$P($P(ORX0,U,6),";",2) ;provider name
"RTN","ORDV02",37,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",9)="9^"_$P($P(ORX0,U,6),";") ;provider ien
"RTN","ORDV02",38,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",10)="10^"_$P(ORX0,U,7) ;order date/time
"RTN","ORDV02",39,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",11)="11^"_$P(ORX0,U,8) ;accession number
"RTN","ORDV02",40,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",12)="12^"_$P(ORX0,U,9) ;available date/time
"RTN","ORDV02",41,0)
 .. S ^TMP("ORDATA",$J,D,SN,"WP",13)="13^"_$P(ORX0,U,5) ;status
"RTN","ORDV02",42,0)
 K ^TMP("LRO",$J),^TMP("ORTXT",$J),^TMP("ORSORT",$J),^TMP("ORXPND",$J)
"RTN","ORDV02",43,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV02",44,0)
 Q
"RTN","ORDV02",45,0)
CH(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT)     ;Chemistry/Hematology
"RTN","ORDV02",46,0)
 ;External references to ^DPT(DFN,"LR"),^LR(LRDFN, ^GMTSLRCE
"RTN","ORDV02",47,0)
 ;
"RTN","ORDV02",48,0)
 I $L($T(GCPR^OMGCOAS1)) D  ; Call if FHIE station 200
"RTN","ORDV02",49,0)
 . N BEG,END,MAX
"RTN","ORDV02",50,0)
 . Q:'$G(ORALPHA)  Q:'$G(OROMEGA)
"RTN","ORDV02",51,0)
 . S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999)
"RTN","ORDV02",52,0)
 . S BEG=9999999-OROMEGA,END=9999999-ORALPHA
"RTN","ORDV02",53,0)
 . D GCPR^OMGCOAS1(DFN,"LRC",BEG,END,MAX)
"RTN","ORDV02",54,0)
 ;
"RTN","ORDV02",55,0)
 N CTR,ORI,TST,PC,ORX0,GMCFLAG,GMCMNT,GMW,IX0,IX,LRDFN,CNT,PTR,MAX,GMTS1,GMTS2,GMTSAGE,ORSITE,SEX,SITE,GO,VA,VAIN,VAERR,VAIN,VADM
"RTN","ORDV02",56,0)
 Q:'$L(OREXT)
"RTN","ORDV02",57,0)
 S GO=$P(OREXT,";")_"^"_$P(OREXT,";",2)
"RTN","ORDV02",58,0)
 Q:'$L($T(@GO))
"RTN","ORDV02",59,0)
 S LRDFN=+$G(^DPT(DFN,"LR"))
"RTN","ORDV02",60,0)
 I GO["GMTSLRCE" Q:'LRDFN
"RTN","ORDV02",61,0)
 D OERR^VADPT
"RTN","ORDV02",62,0)
 S GMTSAGE=$S(+VADM(4)>0:+VADM(4),1:99),SEX=$P(VADM(5),"^")
"RTN","ORDV02",63,0)
 S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999),GMTS1=OROMEGA,GMTS2=ORALPHA
"RTN","ORDV02",64,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV02",65,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV02",66,0)
 I '$L($T(GCPR^OMGCOAS1)) D
"RTN","ORDV02",67,0)
 . K ^TMP("LRC",$J)
"RTN","ORDV02",68,0)
 . D @GO
"RTN","ORDV02",69,0)
 S CTR=0,ORI=GMTS1
"RTN","ORDV02",70,0)
 F  S ORI=$O(^TMP("LRC",$J,ORI)) Q:'ORI!(ORI>GMTS2)  D
"RTN","ORDV02",71,0)
 . S TST=""
"RTN","ORDV02",72,0)
 . F  S TST=$O(^TMP("LRC",$J,ORI,TST)) Q:TST=""  D
"RTN","ORDV02",73,0)
 .. I TST S ORX0=$G(^TMP("LRC",$J,ORI,TST)) Q:ORX0=""  D
"RTN","ORDV02",74,0)
 ... S SITE=$S($L($G(^TMP("LRC",$J,ORI,TST,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV02",75,0)
 ... S ^TMP("ORDATA",$J,ORI,TST,"WP",1)="1^"_SITE ;Station ID
"RTN","ORDV02",76,0)
 ... S ^TMP("ORDATA",$J,ORI,TST,"WP",2)="2^"_$P(ORX0,U) ;collection date
"RTN","ORDV02",77,0)
 ... S ^TMP("ORDATA",$J,ORI,TST,"WP",3)="3^"_$P(ORX0,U,3) ;test name
"RTN","ORDV02",78,0)
 ... S ^TMP("ORDATA",$J,ORI,TST,"WP",4)="4^"_$P(ORX0,U,2) ;specimen
"RTN","ORDV02",79,0)
 ... S ^TMP("ORDATA",$J,ORI,TST,"WP",5)="5^"_$P(ORX0,U,4) ;result
"RTN","ORDV02",80,0)
 ... S ^TMP("ORDATA",$J,ORI,TST,"WP",6)="6^"_$P(ORX0,U,5) ;indicator
"RTN","ORDV02",81,0)
 ... S ^TMP("ORDATA",$J,ORI,TST,"WP",7)="7^"_$P(ORX0,U,6) ;units
"RTN","ORDV02",82,0)
 ... S ^TMP("ORDATA",$J,ORI,TST,"WP",8)="8^"_$P(ORX0,U,7) ;ref low
"RTN","ORDV02",83,0)
 ... S ^TMP("ORDATA",$J,ORI,TST,"WP",9)="9^"_$P(ORX0,U,8) ;ref high
"RTN","ORDV02",84,0)
 ... D SPMRG^ORDVU("^TMP(""LRC"","_$J_","_ORI_",""C"")","^TMP(""ORDATA"","_$J_","_ORI_","_TST_",""WP"",10)",10) ;comments
"RTN","ORDV02",85,0)
 ... I $O(^TMP("LRC",$J,ORI,"C",0)) S ^TMP("ORDATA",$J,ORI,TST,"WP",11)="11^[+]" ;flag for details
"RTN","ORDV02",86,0)
 .. S CTR=CTR+1
"RTN","ORDV02",87,0)
 K ^TMP("LRC",$J)
"RTN","ORDV02",88,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV02",89,0)
 Q
"RTN","ORDV02",90,0)
SP(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT)      ;Surgical Pathology
"RTN","ORDV02",91,0)
 ;External references to ^DPT(DFN,"LR"), ^GMTSLRAE,
"RTN","ORDV02",92,0)
 ;
"RTN","ORDV02",93,0)
 I $L($T(GCPR^OMGCOAS1)) D  ; Call if FHIE station 200
"RTN","ORDV02",94,0)
 . N BEG,END,MAX
"RTN","ORDV02",95,0)
 . Q:'$G(ORALPHA)  Q:'$G(OROMEGA)
"RTN","ORDV02",96,0)
 . S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999)
"RTN","ORDV02",97,0)
 . S BEG=9999999-OROMEGA,END=9999999-ORALPHA
"RTN","ORDV02",98,0)
 . D GCPR^OMGCOAS1(DFN,"SP",BEG,END,MAX)
"RTN","ORDV02",99,0)
 ;
"RTN","ORDV02",100,0)
 N ORDT,ORX0,ORCNT,GMI,MAX,LRDFN,IX,X,IX0,GMTS1,GMTS2,ORSITE,SITE,GO
"RTN","ORDV02",101,0)
 Q:'$L(OREXT)
"RTN","ORDV02",102,0)
 S GO=$P(OREXT,";")_"^"_$P(OREXT,";",2)
"RTN","ORDV02",103,0)
 Q:'$L($T(@GO))
"RTN","ORDV02",104,0)
 S LRDFN=+$G(^DPT(DFN,"LR"))
"RTN","ORDV02",105,0)
 I GO["GMTSLRAE" Q:'LRDFN
"RTN","ORDV02",106,0)
 S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999),GMTS1=OROMEGA,GMTS2=ORALPHA
"RTN","ORDV02",107,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV02",108,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV02",109,0)
 I '$L($T(GCPR^OMGCOAS1)) D
"RTN","ORDV02",110,0)
 . K ^TMP("LRA",$J)
"RTN","ORDV02",111,0)
 . D @GO
"RTN","ORDV02",112,0)
 S ORDT=GMTS1,ORCNT=0
"RTN","ORDV02",113,0)
 F  S ORDT=$O(^TMP("LRA",$J,ORDT)) Q:(ORDT'>0)!(ORDT>GMTS2)  S ORX0=^(ORDT,0) D
"RTN","ORDV02",114,0)
 . S SITE=$S($L($G(^TMP("LRA",$J,ORDT,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV02",115,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",1)="1^"_SITE ;Station ID
"RTN","ORDV02",116,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",2)="2^"_$P(ORX0,U) ;collection date
"RTN","ORDV02",117,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",4)="4^"_$P(ORX0,U,2) ;accession number
"RTN","ORDV02",118,0)
 . D SPMRG^ORDVU("^TMP(""LRA"","_$J_","_ORDT_",.1)","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",3)",3) ;specimen
"RTN","ORDV02",119,0)
 . D SPMRG^ORDVU("^TMP(""LRA"","_$J_","_ORDT_",.2)","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",5)",5) ;brief Clinical Hx
"RTN","ORDV02",120,0)
 . D SPMRG^ORDVU("^TMP(""LRA"","_$J_","_ORDT_",1)","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",6)",6) ;gross Description
"RTN","ORDV02",121,0)
 . D SPMRG^ORDVU("^TMP(""LRA"","_$J_","_ORDT_",1.1)","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",7)",7) ;microscopic Exam
"RTN","ORDV02",122,0)
 . I $D(^TMP("LRA",$J,ORDT,1.2,1,0)) S X=^(0) D
"RTN","ORDV02",123,0)
 .. S ^TMP("LRA",$J,ORDT,1.2,1,0)=$$DATE^ORDVU(X)
"RTN","ORDV02",124,0)
 .. D SPMRG^ORDVU("^TMP(""LRA"","_$J_","_ORDT_",1.2)","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",8)",8) ;supplemetary Report
"RTN","ORDV02",125,0)
 . D SPMRG^ORDVU("^TMP(""LRA"","_$J_","_ORDT_",1.3)","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",9)",9) ;frozen Section
"RTN","ORDV02",126,0)
 . D SPMRG^ORDVU("^TMP(""LRA"","_$J_","_ORDT_",1.4)","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",10)",10) ;surgical path Dx
"RTN","ORDV02",127,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",11)="11^[+]" ;flag for detail
"RTN","ORDV02",128,0)
 K ^TMP("LRA",$J)
"RTN","ORDV02",129,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV02",130,0)
 Q
"RTN","ORDV02",131,0)
CY(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT)      ;Cytopathology
"RTN","ORDV02",132,0)
 ;External references to ^DPT(DFN,"LR"), ^GMTSLRPE
"RTN","ORDV02",133,0)
 ;
"RTN","ORDV02",134,0)
 I $L($T(GCPR^OMGCOAS1)) D  ; Call if FHIE station 200
"RTN","ORDV02",135,0)
 . N BEG,END,MAX
"RTN","ORDV02",136,0)
 . Q:'$G(ORALPHA)  Q:'$G(OROMEGA)
"RTN","ORDV02",137,0)
 . S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999)
"RTN","ORDV02",138,0)
 . S BEG=9999999-OROMEGA,END=9999999-ORALPHA
"RTN","ORDV02",139,0)
 . D GCPR^OMGCOAS1(DFN,"CY",BEG,END,MAX)
"RTN","ORDV02",140,0)
 ;
"RTN","ORDV02",141,0)
 N ORDT,ORX0,GMI,IX0,MAX,LRDFN,IX,GMTS1,GMTS2,ORSITE,SITE,GO,ORMORE
"RTN","ORDV02",142,0)
 Q:'$L(OREXT)
"RTN","ORDV02",143,0)
 S GO=$P(OREXT,";")_"^"_$P(OREXT,";",2)
"RTN","ORDV02",144,0)
 Q:'$L($T(@GO))
"RTN","ORDV02",145,0)
 S LRDFN=+$G(^DPT(DFN,"LR"))
"RTN","ORDV02",146,0)
 I GO["GMTSLRPE" Q:'LRDFN
"RTN","ORDV02",147,0)
 S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999),GMTS1=OROMEGA,GMTS2=ORALPHA
"RTN","ORDV02",148,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV02",149,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV02",150,0)
 I '$L($T(GCPR^OMGCOAS1)) D
"RTN","ORDV02",151,0)
 . K ^TMP("LRCY",$J)
"RTN","ORDV02",152,0)
 . D @GO
"RTN","ORDV02",153,0)
 S ORDT=GMTS1,ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV02",154,0)
 F  S ORDT=$O(^TMP("LRCY",$J,ORDT)) Q:(ORDT'>0)!(ORDT>GMTS2)  S ORX0=$G(^(ORDT,0)) D
"RTN","ORDV02",155,0)
 . S ORMORE=0,SITE=$S($L($G(^TMP("LRCY",$J,ORDT,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV02",156,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",1)="1^"_SITE ;Station ID
"RTN","ORDV02",157,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",2)="2^"_$P(ORX0,U)       ;collection date
"RTN","ORDV02",158,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",5)="5^"_$P(ORX0,U,2)     ;accession number
"RTN","ORDV02",159,0)
 . S ^TMP("ORDATA",$J,ORDT,"WP",4)="4^"_$$DATE^ORDVU($P($G(^TMP("LRCY",$J,ORDT,1)),U,2)) ;report release date
"RTN","ORDV02",160,0)
 . I $O(^TMP("LRCY",$J,ORDT,1,0)) S ORMORE=1 D SPMRG^ORDVU("^TMP(""LRCY"","_$J_","_ORDT_",1)","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",3)",3) ;specimen
"RTN","ORDV02",161,0)
 . I $O(^TMP("LRCY",$J,ORDT,"AH",0)) S ORMORE=1 D SPMRG^ORDVU("^TMP(""LRCY"","_$J_","_ORDT_",""AH"")","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",6)",6) ;brief Clinical Hx
"RTN","ORDV02",162,0)
 . I $O(^TMP("LRCY",$J,ORDT,"G",0)) S ORMORE=1 D SPMRG^ORDVU("^TMP(""LRCY"","_$J_","_ORDT_",""G"")","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",7)",7) ;gross Description
"RTN","ORDV02",163,0)
 . I $O(^TMP("LRCY",$J,ORDT,"MI",0)) S ORMORE=1 D SPMRG^ORDVU("^TMP(""LRCY"","_$J_","_ORDT_",""MI"")","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",8)",8) ;microscopic Exam
"RTN","ORDV02",164,0)
 . I $O(^TMP("LRCY",$J,ORDT,"NDX",0)) S ORMORE=1 D SPMRG^ORDVU("^TMP(""LRCY"","_$J_","_ORDT_",""NDX"")","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",9)",9) ;cythopathology DX
"RTN","ORDV02",165,0)
 . I $O(^TMP("LRCY",$J,ORDT,"SR",0)) S ORMORE=1 D SPMRG^ORDVU("^TMP(""LRCY"","_$J_","_ORDT_",""SR"")","^TMP(""ORDATA"","_$J_","_ORDT_",""WP"",10)",10) ;supplemetary Report
"RTN","ORDV02",166,0)
 . I ORMORE S ^TMP("ORDATA",$J,ORDT,"WP",11)="11^[+]" ;flag for detail
"RTN","ORDV02",167,0)
 K ^TMP("LRCY",$J)
"RTN","ORDV02",168,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV02",169,0)
 Q
"RTN","ORDV02B")
0^19^B40982123
"RTN","ORDV02B",1,0)
ORDV02B ;SLC/DCM - OE/RR REPORT EXTRACTS ;03/17/2015  10:24
"RTN","ORDV02B",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORDV02B",3,0)
 ;
"RTN","ORDV02B",4,0)
LO(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ; Lab Orders All
"RTN","ORDV02B",5,0)
 ;External calls to ^GMTSLROE - modified for this report
"RTN","ORDV02B",6,0)
 ;
"RTN","ORDV02B",7,0)
 S (ORDEND,OROMEGA)=9999999 ; Get all future orders
"RTN","ORDV02B",8,0)
 I $L($T(GCPR^OMGCOAS1)) D  ; Call if FHIE station 200
"RTN","ORDV02B",9,0)
 . N BEG,END,MAX
"RTN","ORDV02B",10,0)
 . Q:'$G(ORALPHA)  Q:'$G(OROMEGA)
"RTN","ORDV02B",11,0)
 . S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999)
"RTN","ORDV02B",12,0)
 . S BEG=9999999,END=9999999-ORALPHA
"RTN","ORDV02B",13,0)
 . D GCPR^OMGCOAS1(DFN,"LRO",BEG,END,MAX)
"RTN","ORDV02B",14,0)
 ;
"RTN","ORDV02B",15,0)
 N D,SN,ORX0,MAX,GMTS1,GMTS2,GMTSBEG,GMTSEND,ORSITE,SITE,GO,SORT,STATUS,S,LST,RSLT,Y
"RTN","ORDV02B",16,0)
 Q:'$L(OREXT)
"RTN","ORDV02B",17,0)
 S GO=$P(OREXT,";")_"^"_$P(OREXT,";",2)
"RTN","ORDV02B",18,0)
 Q:'$L($T(@GO))
"RTN","ORDV02B",19,0)
 S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999),GMTS1=OROMEGA,GMTS2=ORALPHA,GMTSBEG=ORDBEG,GMTSEND=ORDEND
"RTN","ORDV02B",20,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV02B",21,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV02B",22,0)
 I '$L($T(GCPR^OMGCOAS1)) D
"RTN","ORDV02B",23,0)
 . K ^TMP("LRO",$J),^TMP("ORTXT",$J),^TMP("ORSORT",$J),^TMP("ORXPND",$J)
"RTN","ORDV02B",24,0)
 . D @GO
"RTN","ORDV02B",25,0)
 ;S (CTR,D)=0,SORT="ORDERED:1^COLLECTED:2^PROCESSING:3^CANCELED:4^COMPLETED:5"
"RTN","ORDV02B",26,0)
 S (CTR,D)=0,SORT="ORDERED:1^On Collection List:2^COLLECTED:3^PROCESSING:4^CANCELED:5^COMPLETED:6" ;Fix for Robyn
"RTN","ORDV02B",27,0)
 ;Intial sort by STATUS(ORDERED, On Collection List, COLLECTED, PROCESSING, CANCELED, COMPLETED), then Collection Date/time
"RTN","ORDV02B",28,0)
 ;Sequence in file 101.24 is 1 more than in global location: i)="i^"_
"RTN","ORDV02B",29,0)
 F  S D=$O(^TMP("LRO",$J,D)) Q:'D  D  ;sequence *Lab Orders (All)
"RTN","ORDV02B",30,0)
 . S SN=0
"RTN","ORDV02B",31,0)
 . F  S SN=$O(^TMP("LRO",$J,D,SN)) Q:'SN  S ORX0=^(SN) I $L(ORX0) D
"RTN","ORDV02B",32,0)
 .. S STATUS=$P(ORX0,"^",5),S=$E(SORT,$F(SORT,STATUS)+1),^TMP("ORSORT",$J,S,D,SN)=ORX0
"RTN","ORDV02B",33,0)
 S S=0
"RTN","ORDV02B",34,0)
 F  S S=$O(^TMP("ORSORT",$J,S)) Q:'S  D
"RTN","ORDV02B",35,0)
 . S D=0 F  S D=$O(^TMP("ORSORT",$J,S,D)) Q:'D  S SN=0 F  S SN=$O(^TMP("ORSORT",$J,S,D,SN)) Q:'SN  S ORX0=^(SN) D
"RTN","ORDV02B",36,0)
 .. S SITE=$S($L($G(^TMP("LRO",$J,D,SN,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV02B",37,0)
 .. ;
"RTN","ORDV02B",38,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",1)="1^"_SITE ;Station ID
"RTN","ORDV02B",39,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",2)="2^"_$P(ORX0,U) ;collection date
"RTN","ORDV02B",40,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",3)="3^"_$P($P(ORX0,U,2),";",2) ;test name
"RTN","ORDV02B",41,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",15)="15^"_$P($P(ORX0,U,2),";") ;test ien
"RTN","ORDV02B",42,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",4)="4^"_"" ;critical value field (calculated)
"RTN","ORDV02B",43,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",5)="5^"_$P($P(ORX0,U,3),";",2) ;specimen name
"RTN","ORDV02B",44,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",16)="16^"_$P($P(ORX0,U,3),";") ;specimen ien
"RTN","ORDV02B",45,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",7)="7^"_$P(ORX0,U,7) ;order date/time
"RTN","ORDV02B",46,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",8)="8^"_$P(ORX0,U,5) ;status
"RTN","ORDV02B",47,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",6)="6^"_$P($P(ORX0,U,6),";",2) ;provider name
"RTN","ORDV02B",48,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",17)="17^"_$P($P(ORX0,U,6),";") ;provider ien
"RTN","ORDV02B",49,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",11)="11^"_$P(ORX0,U,9) ;available date/time
"RTN","ORDV02B",50,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",18)="18^"_$P(ORX0,U,12) ;OE/RR order #
"RTN","ORDV02B",51,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",9)="9^"_$P(ORX0,U,4) ;urgency
"RTN","ORDV02B",52,0)
 .. S ^TMP("ORDATA",$J,S,D,SN,"WP",10)="10^"_$P(ORX0,U,8) ;accession number
"RTN","ORDV02B",53,0)
 .. K ^TMP("ORXPND",$J) S RSLT="^TMP(""ORXPND"",$J)" D RESULT^ORWOR(.RSLT,DFN,$P(ORX0,U,12),$P(ORX0,U,12))
"RTN","ORDV02B",54,0)
 .. D SPMRG^ORDVU("^TMP(""ORXPND"","_$J_")","^TMP(""ORDATA"","_$J_","_S_","_D_","_SN_",""WP"",13)",13) ;Test Results
"RTN","ORDV02B",55,0)
 .. K ^TMP("ORTXT",$J) S LST="^TMP(""ORTXT"",$J)" D DETAIL^ORWOR(.LST,$P(ORX0,U,12),DFN)
"RTN","ORDV02B",56,0)
 .. D SPMRG^ORDVU("^TMP(""ORTXT"","_$J_")","^TMP(""ORDATA"","_$J_","_S_","_D_","_SN_",""WP"",14)",14) ;order details
"RTN","ORDV02B",57,0)
 .. I $O(@LST@(0))!($O(@RSLT@(0))) S ^TMP("ORDATA",$J,S,D,SN,"WP",12)="12^[+]" ;flag for details
"RTN","ORDV02B",58,0)
 .. S I=0,Y="" F  S I=$O(^TMP("ORXPND",$J,I)) Q:'I  S X=^(I,0) I X["H*"!(X["L*") D  Q:Y="H* L*"
"RTN","ORDV02B",59,0)
 ... N Z
"RTN","ORDV02B",60,0)
 ... I $L(Y) S Z=$S(Y["H*"&(Y["L*"):"H* L*",Y="H*"&(X["H*"):"H*",Y="H*"&(X["L*"):"H* L*",Y="L*"&(X["L*"):"L*",Y="L*"&(X["H*"):"H* L*",1:"*")
"RTN","ORDV02B",61,0)
 ... I '$L(Y) S Z=$S(X["H*":"H*",X["L*":"L*",1:"*")
"RTN","ORDV02B",62,0)
 ... S Y=Z,^TMP("ORDATA",$J,S,D,SN,"WP",4)="4^"_Z
"RTN","ORDV02B",63,0)
 K ^TMP("LRO",$J),^TMP("ORTXT",$J),^TMP("ORSORT",$J),^TMP("ORXPND",$J)
"RTN","ORDV02B",64,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV02B",65,0)
 Q
"RTN","ORDV02B",66,0)
LPEND(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ; Lab Orders Pending
"RTN","ORDV02B",67,0)
 ;External calls to ^GMTSLROE - modified for this report
"RTN","ORDV02B",68,0)
 ;
"RTN","ORDV02B",69,0)
 S (ORDEND,OROMEGA)=9999999 ; Get all future orders
"RTN","ORDV02B",70,0)
 I $L($T(GCPR^OMGCOAS1)) D  ; Call if FHIE station 200
"RTN","ORDV02B",71,0)
 . N BEG,END,MAX
"RTN","ORDV02B",72,0)
 . Q:'$G(ORALPHA)  Q:'$G(OROMEGA)
"RTN","ORDV02B",73,0)
 . S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999)
"RTN","ORDV02B",74,0)
 . S BEG=9999999,END=9999999-ORALPHA
"RTN","ORDV02B",75,0)
 . D GCPR^OMGCOAS1(DFN,"LRO",BEG,END,MAX)
"RTN","ORDV02B",76,0)
 ;
"RTN","ORDV02B",77,0)
 N D,SN,ORX0,MAX,GMTS1,GMTS2,GMTSBEG,GMTSEND,ORSITE,SITE,GO,SORT,STATUS,S
"RTN","ORDV02B",78,0)
 Q:'$L(OREXT)
"RTN","ORDV02B",79,0)
 S GO=$P(OREXT,";")_"^"_$P(OREXT,";",2)
"RTN","ORDV02B",80,0)
 Q:'$L($T(@GO))
"RTN","ORDV02B",81,0)
 S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999),GMTS1=OROMEGA,GMTS2=ORALPHA,GMTSBEG=ORDBEG,GMTSEND=ORDEND
"RTN","ORDV02B",82,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV02B",83,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV02B",84,0)
 I '$L($T(GCPR^OMGCOAS1)) D
"RTN","ORDV02B",85,0)
 . K ^TMP("LRO",$J),^TMP("ORTXT",$J),^TMP("ORSORT",$J)
"RTN","ORDV02B",86,0)
 . D @GO
"RTN","ORDV02B",87,0)
 ;S (CTR,D)=0,SORT="ORDERED:1^COLLECTED:2^PROCESSING:3^CANCELED:4"
"RTN","ORDV02B",88,0)
 S (CTR,D)=0,SORT="ORDERED:1^On Collection List:2^COLLECTED:3^PROCESSING:4^CANCELED:5" ;Fix for Robyn
"RTN","ORDV02B",89,0)
 ;Intial sort by Forward Collection Date, then (ORDERED, COLLECTED, PROCESSING, CANCELED)
"RTN","ORDV02B",90,0)
 ;Sequence in file 101.24 is 1 more than in global location: i)="i^"_
"RTN","ORDV02B",91,0)
 F  S D=$O(^TMP("LRO",$J,D)) Q:'D  D  ;sequence *Pending Lab Orders
"RTN","ORDV02B",92,0)
 . S SN=0
"RTN","ORDV02B",93,0)
 . F  S SN=$O(^TMP("LRO",$J,D,SN)) Q:'SN  S ORX0=^(SN) I $L(ORX0) D
"RTN","ORDV02B",94,0)
 .. S STATUS=$P(ORX0,"^",5),S=$E(SORT,$F(SORT,STATUS)+1),^TMP("ORSORT",$J,9999999-D,S,SN)=ORX0
"RTN","ORDV02B",95,0)
 S D=0
"RTN","ORDV02B",96,0)
 F  S D=$O(^TMP("ORSORT",$J,D)) Q:'D  D
"RTN","ORDV02B",97,0)
 . S S=0 F  S S=$O(^TMP("ORSORT",$J,D,S)) Q:'S  S SN=0 F  S SN=$O(^TMP("ORSORT",$J,D,S,SN)) Q:'SN  S ORX0=^(SN) D
"RTN","ORDV02B",98,0)
 .. S SITE=$S($L($G(^TMP("LRO",$J,D,SN,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV02B",99,0)
 .. ;
"RTN","ORDV02B",100,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",1)="1^"_SITE ;Station ID
"RTN","ORDV02B",101,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",2)="2^"_$P(ORX0,U) ;collection date
"RTN","ORDV02B",102,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",3)="3^"_$P($P(ORX0,U,2),";",2) ;test name
"RTN","ORDV02B",103,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",13)="13^"_$P($P(ORX0,U,2),";") ;test ien
"RTN","ORDV02B",104,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",4)="4^"_$P($P(ORX0,U,3),";",2) ;specimen name
"RTN","ORDV02B",105,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",14)="14^"_$P($P(ORX0,U,3),";") ;specimen ien
"RTN","ORDV02B",106,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",6)="6^"_$P(ORX0,U,7) ;order date/time
"RTN","ORDV02B",107,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",7)="7^"_$P(ORX0,U,5) ;status
"RTN","ORDV02B",108,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",5)="5^"_$P($P(ORX0,U,6),";",2) ;provider name
"RTN","ORDV02B",109,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",15)="15^"_$P($P(ORX0,U,6),";") ;provider ien
"RTN","ORDV02B",110,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",10)="10^"_$P(ORX0,U,9) ;available date/time
"RTN","ORDV02B",111,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",16)="16^"_$P(ORX0,U,12) ;OE/RR order #
"RTN","ORDV02B",112,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",8)="8^"_$P(ORX0,U,4) ;urgency
"RTN","ORDV02B",113,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",9)="9^"_$P(ORX0,U,8) ;accession number
"RTN","ORDV02B",114,0)
 .. K ^TMP("ORTXT",$J) S LST="^TMP(""ORTXT"",$J)" D DETAIL^ORWOR(.LST,$P(ORX0,U,12),DFN)
"RTN","ORDV02B",115,0)
 .. D SPMRG^ORDVU("^TMP(""ORTXT"","_$J_")","^TMP(""ORDATA"","_$J_","_D_","_S_","_SN_",""WP"",12)",12) ;order details
"RTN","ORDV02B",116,0)
 .. I $O(@LST@(0)) S ^TMP("ORDATA",$J,D,S,SN,"WP",11)="11^[+]" ;flag for details
"RTN","ORDV02B",117,0)
 K ^TMP("LRO",$J),^TMP("ORTXT",$J),^TMP("ORSORT",$J)
"RTN","ORDV02B",118,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV02B",119,0)
 Q
"RTN","ORDV02C")
0^20^B22064710
"RTN","ORDV02C",1,0)
ORDV02C ;SLC/DCM - OE/RR REPORT EXTRACTS ;03/17/2015  10:24
"RTN","ORDV02C",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORDV02C",3,0)
 ;
"RTN","ORDV02C",4,0)
OV(ROOT,ORALAPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ;Lab Overview
"RTN","ORDV02C",5,0)
 ;External calls to ^GMTSLROE - modified for this report
"RTN","ORDV02C",6,0)
 ;
"RTN","ORDV02C",7,0)
 I $L($T(GCPR^OMGCOAS1)) D  ; Call if FHIE station 200
"RTN","ORDV02C",8,0)
 . N BEG,END,MAX
"RTN","ORDV02C",9,0)
 . Q:'$G(ORALPHA)  Q:'$G(OROMEGA)
"RTN","ORDV02C",10,0)
 . S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999)
"RTN","ORDV02C",11,0)
 . S BEG=9999999-OROMEGA,END=9999999-ORALPHA
"RTN","ORDV02C",12,0)
 . D GCPR^OMGCOAS1(DFN,"LRO",BEG,END,MAX)
"RTN","ORDV02C",13,0)
 ;
"RTN","ORDV02C",14,0)
 N D,SN,ORX0,MAX,GMTS1,GMTS2,GMTSBEG,GMTSEND,ORSITE,SITE,GO,SORT,STATUS,S,LST,RSLT,Y
"RTN","ORDV02C",15,0)
 Q:'$L(OREXT)
"RTN","ORDV02C",16,0)
 S GO=$P(OREXT,";")_"^"_$P(OREXT,";",2)
"RTN","ORDV02C",17,0)
 Q:'$L($T(@GO))
"RTN","ORDV02C",18,0)
 S MAX=$S(+$G(ORMAX)>0:ORMAX,1:999),GMTS1=OROMEGA,GMTS2=ORALPHA,GMTSBEG=ORDBEG,GMTSEND=ORDEND
"RTN","ORDV02C",19,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV02C",20,0)
 K ^TMP("ORDATA",$J)
"RTN","ORDV02C",21,0)
 I '$L($T(GCPR^OMGCOAS1)) D
"RTN","ORDV02C",22,0)
 . K ^TMP("LRO",$J),^TMP("ORTXT",$J),^TMP("ORSORT",$J),^TMP("ORXPND",$J)
"RTN","ORDV02C",23,0)
 . D @GO
"RTN","ORDV02C",24,0)
 ;S (CTR,D)=0,SORT="ORDERED:1^COLLECTED:2^PROCESSING:3^CANCELED:4^COMPLETED:5"
"RTN","ORDV02C",25,0)
 S (CTR,D)=0,SORT="ORDERED:1^On Collection List:2^COLLECTED:3^PROCESSING:4^CANCELED:5^COMPLETED:6" ;Fix for Robyn
"RTN","ORDV02C",26,0)
 ;Intial sort by Collection Date, then (ORDERED, On Collection List, COLLECTED, PROCESSING, CANCELED, COMPLETED)
"RTN","ORDV02C",27,0)
 ;ORDERED and CANCELED excluded
"RTN","ORDV02C",28,0)
 ;Sequence in file 101.24 is 1 more than in global location: i)="i^"_
"RTN","ORDV02C",29,0)
 F  S D=$O(^TMP("LRO",$J,D)) Q:'D  D  ;sequence *Lab Orders (All)*Overview (Overview may have to be seperate extract)
"RTN","ORDV02C",30,0)
 . S SN=0
"RTN","ORDV02C",31,0)
 . F  S SN=$O(^TMP("LRO",$J,D,SN)) Q:'SN  S ORX0=^(SN) I $L(ORX0) S STATUS=$P(ORX0,"^",5) I $L($P(ORX0,"^")),STATUS'="ORDERED",STATUS'="CANCELED" D
"RTN","ORDV02C",32,0)
 .. S S=$E(SORT,$F(SORT,STATUS)+1),^TMP("ORSORT",$J,D,S,SN)=ORX0
"RTN","ORDV02C",33,0)
 S D=0
"RTN","ORDV02C",34,0)
 F  S D=$O(^TMP("ORSORT",$J,D)) Q:'D  D
"RTN","ORDV02C",35,0)
 . S S=0 F  S S=$O(^TMP("ORSORT",$J,D,S)) Q:'S  S SN=0 F  S SN=$O(^TMP("ORSORT",$J,D,S,SN)) Q:'SN  S ORX0=^(SN) D
"RTN","ORDV02C",36,0)
 .. S SITE=$S($L($G(^TMP("LRO",$J,D,SN,"facility"))):^("facility"),1:ORSITE)
"RTN","ORDV02C",37,0)
 .. ;
"RTN","ORDV02C",38,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",1)="1^"_SITE ;Station ID*1*1
"RTN","ORDV02C",39,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",2)="2^"_$P(ORX0,U) ;collection date*2*2
"RTN","ORDV02C",40,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",3)="3^"_$P($P(ORX0,U,2),";",2) ;test name*3*3
"RTN","ORDV02C",41,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",4)="4^"_$P($P(ORX0,U,2),";") ;test ien*3*4
"RTN","ORDV02C",42,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",5)="5^"_"" ;critical value field (calculated)
"RTN","ORDV02C",43,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",6)="6^"_$P($P(ORX0,U,3),";",2) ;specimen name*6*6
"RTN","ORDV02C",44,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",7)="7^"_$P($P(ORX0,U,3),";") ;specimen ien*7*7
"RTN","ORDV02C",45,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",8)="8^"_$P($P(ORX0,U,6),";",2) ;provider name*9*8
"RTN","ORDV02C",46,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",9)="9^"_$P($P(ORX0,U,6),";") ;provider ien*10*9
"RTN","ORDV02C",47,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",10)="10^"_$P(ORX0,U,5) ;status*8*10
"RTN","ORDV02C",48,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",11)="11^"_$P(ORX0,U,9) ;available date/time*11*YES
"RTN","ORDV02C",49,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",12)="12^"_$P(ORX0,U,12) ;OE/RR order #*12*
"RTN","ORDV02C",50,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",13)="13^"_$P(ORX0,U,4) ;urgency*13* (not needed in any reports/can be deleted)
"RTN","ORDV02C",51,0)
 .. S ^TMP("ORDATA",$J,D,S,SN,"WP",14)="14^"_$P(ORX0,U,8) ;accession number*14* ((not needed in any reports/can be deleted)
"RTN","ORDV02C",52,0)
 .. K ^TMP("ORXPND",$J)
"RTN","ORDV02C",53,0)
 .. S RSLT="^TMP(""ORXPND"",$J)" D RESULT^ORWOR(.RSLT,DFN,$P(ORX0,U,12),$P(ORX0,U,12))
"RTN","ORDV02C",54,0)
 .. D SPMRG^ORDVU("^TMP(""ORXPND"","_$J_")","^TMP(""ORDATA"","_$J_","_D_","_S_","_SN_",""WP"",15)",15) ;Test Results*15*
"RTN","ORDV02C",55,0)
 .. K ^TMP("ORTXT",$J) S LST="^TMP(""ORTXT"",$J)" D DETAIL^ORWOR(.LST,$P(ORX0,U,12),DFN)
"RTN","ORDV02C",56,0)
 .. D SPMRG^ORDVU("^TMP(""ORTXT"","_$J_")","^TMP(""ORDATA"","_$J_","_D_","_S_","_SN_",""WP"",16)",16) ;order details*16*
"RTN","ORDV02C",57,0)
 .. I $O(@LST@(0))!($O(@RSLT@(0))) S ^TMP("ORDATA",$J,D,S,SN,"WP",17)="17^[+]" ;flag for details*17*YES
"RTN","ORDV02C",58,0)
 .. S I=0,Y="" F  S I=$O(^TMP("ORXPND",$J,I)) Q:'I  S X=^(I,0) I X["H*"!(X["L*") D  Q:Y="H* L*"
"RTN","ORDV02C",59,0)
 ... N Z
"RTN","ORDV02C",60,0)
 ... I $L(Y) S Z=$S(Y["H*"&(Y["L*"):"H* L*",Y="H*"&(X["H*"):"H*",Y="H*"&(X["L*"):"H* L*",Y="L*"&(X["L*"):"L*",Y="L*"&(X["H*"):"H* L*",1:"*")
"RTN","ORDV02C",61,0)
 ... I '$L(Y) S Z=$S(X["H*":"H*",X["L*":"L*",1:"*")
"RTN","ORDV02C",62,0)
 ... S Y=Z,^TMP("ORDATA",$J,D,S,SN,"WP",5)="5^"_Z
"RTN","ORDV02C",63,0)
 .. ;The following set of comments is for the Overview report
"RTN","ORDV02C",64,0)
 .. ;Critical Value Flag **5   
"RTN","ORDV02C",65,0)
 .. ;Flags for Partial Results **11
"RTN","ORDV02C",66,0)
 .. ;Details is test results **YES in same format as "All Tests By Date" with Relase Date/Time, Reporting site, Site Code (facility) added
"RTN","ORDV02C",67,0)
 K ^TMP("LRO",$J),^TMP("ORTXT",$J),^TMP("ORSORT",$J),^TMP("ORXPND",$J)
"RTN","ORDV02C",68,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV02C",69,0)
 Q
"RTN","ORDV06B")
0^85^B43803935
"RTN","ORDV06B",1,0)
ORDV06B ; slc/dcm - OE/RR Report Extracts ;7/14/14  16:34
"RTN","ORDV06B",2,0)
 ;;3.0;ORDER ENTRY RESULTS REPORTING;**312,350**;Dec 17, 1997;Build 77
"RTN","ORDV06B",3,0)
 ;Pharmacy Extracts for VistaWeb and ALL Medication Report
"RTN","ORDV06B",4,0)
RXALL(ROOT,ORALPHA,OROMEGA,ORMAX,ORDBEG,ORDEND,OREXT) ;All Patient Meds
"RTN","ORDV06B",5,0)
 ;Call to PSOORRL
"RTN","ORDV06B",6,0)
 I $L($T(GCPR^OMGCOAS1)) D  ; Call if FHIE station 200
"RTN","ORDV06B",7,0)
 . D GCPR^OMGCOAS1(DFN,"RXOP",ORDBEG,ORDEND,9999)
"RTN","ORDV06B",8,0)
 ;
"RTN","ORDV06B",9,0)
 N ORRXSTAT,GO
"RTN","ORDV06B",10,0)
 Q:'$L(OREXT)
"RTN","ORDV06B",11,0)
 S GO=$P(OREXT,";")_"^"_$P(OREXT,";",2)
"RTN","ORDV06B",12,0)
 Q:'$L($T(@GO))
"RTN","ORDV06B",13,0)
 S ORRXSTAT=""
"RTN","ORDV06B",14,0)
 D GETMED
"RTN","ORDV06B",15,0)
 Q
"RTN","ORDV06B",16,0)
IN ;Setup and call to Pharmacy API
"RTN","ORDV06B",17,0)
 ;LST(i)=
"RTN","ORDV06B",18,0)
 ;LST(i) flags: "~" Start of new record, "/" Continuation line (concatination with Line feed CRLF)
"RTN","ORDV06B",19,0)
 ;
"RTN","ORDV06B",20,0)
 ;{          1     2      3     4       5     6       7       8        9      10     11           16
"RTN","ORDV06B",21,0)
 ;{ Pieces: Typ^PharmID^Drug^InfRate^StopDt^RefRem^TotDose^UnitDose^OrderID^Status^LastFill^...^StartDt^  }
"RTN","ORDV06B",22,0)
 ;If $P($P(X,"^",2),";",2)= "I" or "C" then Inpatient=TRUE
"RTN","ORDV06B",23,0)
 ;If $P(X,"^",1)="~NV" then NonVAMed=TRUE and Instruct="Non-VA "_Instruct
"RTN","ORDV06B",24,0)
 ;If $E($P(X,"^",1),1,2)="t\" then this is a comment, strip off the 1st character (t) and concatenate to other text
"RTN","ORDV06B",25,0)
 ;Location  := $P($P(X,U,1),":",2);
"RTN","ORDV06B",26,0)
 K ^TMP("PS",$J),^TMP("ORACT",$J),^TMP("ORPS",$J)
"RTN","ORDV06B",27,0)
 N ORBEG,OREND,ERROR,ORCTX,ORVIEW
"RTN","ORDV06B",28,0)
 S (ORBEG,OREND,ORCTX)=""
"RTN","ORDV06B",29,0)
 S ORVIEW=1
"RTN","ORDV06B",30,0)
 S ORBEG=$S($G(ORDBEG):ORDBEG,1:$$DT^ORWPS("T-50000")),OREND=$S(ORDEND<DT:ORDEND,1:$$DT^ORWPS("T+3000"))
"RTN","ORDV06B",31,0)
 D OCL^PSOORRL(DFN,$$DT^ORWPS("T-50000"),$$DT^ORWPS("T+3000"),ORVIEW)
"RTN","ORDV06B",32,0)
 N ITMP,FIELDS,INSTRUCT,COMMENTS,REASON,NVSDT,TYPE,ILST,J,SORTDT,STOPDT
"RTN","ORDV06B",33,0)
 S ILST=0,ITMP=""
"RTN","ORDV06B",34,0)
 F  S ITMP=$O(^TMP("PS",$J,ITMP)) Q:'ITMP  D
"RTN","ORDV06B",35,0)
 . K INSTRUCT,COMMENTS,REASON,ORIFN
"RTN","ORDV06B",36,0)
 . K ^TMP("ORACT",$J,"COMMENTS")
"RTN","ORDV06B",37,0)
 . S COMMENTS="^TMP(""ORACT"",$J,""COMMENTS"")"
"RTN","ORDV06B",38,0)
 . S (INSTRUCT,@COMMENTS,STOPDT)="",FIELDS=^TMP("PS",$J,ITMP,0)
"RTN","ORDV06B",39,0)
 . S $P(FIELDS,"^",17)=$P($G(^TMP("PS",$J,ITMP,"P",0)),"^",2) ;Provider
"RTN","ORDV06B",40,0)
 . S SORTDT=$S($L($P(FIELDS,"^",10)):$P(FIELDS,"^",10),1:$P(FIELDS,"^",15)) ;Date Priority: 1)Last Fill Date, 2)Issue/Start Date, 3)Order Date
"RTN","ORDV06B",41,0)
 . I 'SORTDT D  ;If pharmacy API doesn't screen out data within selected date range, check CPRS OrderDate and screen out as appropriate
"RTN","ORDV06B",42,0)
 .. K ^TMP("ORXPS",$J) M ^TMP("ORXPS",$J)=^TMP("PS",$J)
"RTN","ORDV06B",43,0)
 .. D OEL^PSOORRL(DFN,$P(FIELDS,"^")) ;This API uses same ^TMP("PS" global
"RTN","ORDV06B",44,0)
 .. S ORIFN=+$P(^TMP("PS",$J,0),"^",11),SORTDT=$P(^OR(100,ORIFN,0),"^",7),STOPDT=$P(^(0),"^",9)
"RTN","ORDV06B",45,0)
 .. M ^TMP("PS",$J)=^TMP("ORXPS",$J) K ^TMP("ORXPS",$J)
"RTN","ORDV06B",46,0)
 . S TYPE=$S($P($P(FIELDS,U),";",2)="O":"OP",1:"UD")
"RTN","ORDV06B",47,0)
 . I $D(^TMP("PS",$J,ITMP,"CLINIC",0)) S TYPE="CP"
"RTN","ORDV06B",48,0)
 . N LOC,LOCEX S (LOC,LOCEX)=""
"RTN","ORDV06B",49,0)
 . I TYPE="CP" S LOC=$G(^TMP("PS",$J,ITMP,"CLINIC",0))
"RTN","ORDV06B",50,0)
 . S:LOC LOCEX=$P($G(^SC(+LOC,0)),U)_":"_+LOC ;IMO
"RTN","ORDV06B",51,0)
 . I TYPE="OP",$P(FIELDS,";")["N" S TYPE="NV" ;non-VA med
"RTN","ORDV06B",52,0)
 . ;Next line excludes any data where (ExpirationDate, LastFill Date, StartDate or OrderDate) is outside of selected date range for everything except non-VAmeds.
"RTN","ORDV06B",53,0)
 . I TYPE'="NV",SORTDT<ORBEG!(SORTDT>OREND),($P(FIELDS,"^",4)<ORBEG!($P(FIELDS,"^",4)>OREND)),($P(FIELDS,"^",10)<ORBEG!($P(FIELDS,"^",10)>OREND)),($P(FIELDS,"^",15)<ORBEG!($P(FIELDS,"^",15)>OREND)) Q
"RTN","ORDV06B",54,0)
 . I $P(FIELDS,"^",9)["DISCONTINUED",(TYPE="OP"!(TYPE="NV")) D
"RTN","ORDV06B",55,0)
 .. K ^TMP("ORXPS",$J) M ^TMP("ORXPS",$J)=^TMP("PS",$J)
"RTN","ORDV06B",56,0)
 .. D OEL^PSOORRL(DFN,$P(FIELDS,"^")) ;This API uses same ^TMP("PS" global
"RTN","ORDV06B",57,0)
 .. S ORIFN=+$P(^TMP("PS",$J,0),"^",11),STOPDT=$P(^OR(100,ORIFN,0),"^",9)
"RTN","ORDV06B",58,0)
 .. M ^TMP("PS",$J)=^TMP("ORXPS",$J) K ^TMP("ORXPS",$J)
"RTN","ORDV06B",59,0)
 .. I TYPE="NV",'$L($P(FIELDS,"^",4)) S $P(FIELDS,"^",4)=STOPDT
"RTN","ORDV06B",60,0)
 .. I TYPE="OP" S $P(FIELDS,"^",4)=STOPDT
"RTN","ORDV06B",61,0)
 . I $O(^TMP("PS",$J,ITMP,"A",0))>0 S TYPE="IV"
"RTN","ORDV06B",62,0)
 . I $O(^TMP("PS",$J,ITMP,"B",0))>0 S TYPE="IV"
"RTN","ORDV06B",63,0)
 . I (TYPE="UD")!(TYPE="CP") D UDINST^ORWPS(.INSTRUCT,ITMP)
"RTN","ORDV06B",64,0)
 . I TYPE="OP" D OPINST^ORWPS(.INSTRUCT,ITMP)
"RTN","ORDV06B",65,0)
 . I TYPE="IV" D IVINST^ORWPS(.INSTRUCT,ITMP)
"RTN","ORDV06B",66,0)
 . I TYPE="NV" D NVINST^ORWPS(.INSTRUCT,ITMP),NVREASON^ORWPS(.REASON,.NVSDT,ITMP)
"RTN","ORDV06B",67,0)
 . I (TYPE="UD")!(TYPE="IV")!(TYPE="NV")!(TYPE="CP") D SETMULT^ORWPS(COMMENTS,ITMP,"SIO")
"RTN","ORDV06B",68,0)
 . M COMMENTS=@COMMENTS
"RTN","ORDV06B",69,0)
 . I $D(COMMENTS(1)) S COMMENTS(1)="\"_COMMENTS(1)
"RTN","ORDV06B",70,0)
 . I '$L($P(FIELDS,U,15)) S:TYPE="NV" $P(FIELDS,U,15)=$P($G(NVSDT),".") ;Set Start Date for non-VA Med (from file 100, which currently doesn't get set)
"RTN","ORDV06B",71,0)
 . I LOC S ^TMP("ORPS",$J,$$NXT)="~CP:"_LOCEX_U_FIELDS
"RTN","ORDV06B",72,0)
 . E  S ^TMP("ORPS",$J,$$NXT)="~"_TYPE_U_FIELDS
"RTN","ORDV06B",73,0)
 . S J=0 F  S J=$O(INSTRUCT(J)) Q:'J  S ^TMP("ORPS",$J,$$NXT)=INSTRUCT(J)
"RTN","ORDV06B",74,0)
 . S J=0 F  S J=$O(COMMENTS(J)) Q:'J  S ^TMP("ORPS",$J,$$NXT)="t"_COMMENTS(J)
"RTN","ORDV06B",75,0)
 . S J=0 F  S J=$O(REASON(J)) Q:'J  S ^TMP("ORPS",$J,$$NXT)="t"_REASON(J)
"RTN","ORDV06B",76,0)
 K ^TMP("PS",$J),^TMP("ORACT",$J)
"RTN","ORDV06B",77,0)
 Q
"RTN","ORDV06B",78,0)
NXT() ; increment ILST
"RTN","ORDV06B",79,0)
 S ILST=ILST+1
"RTN","ORDV06B",80,0)
 Q ILST
"RTN","ORDV06B",81,0)
 ;
"RTN","ORDV06B",82,0)
GETMED ;
"RTN","ORDV06B",83,0)
 N J,ORIPS,ORIPSS,ORDRGIEN,ORDRG,ORRXNO,ORSTAT,ORQTY,OREXP,ORISSUE,ORLAST,ORREF,ORPRVD,ORCOST,ORSIG,ORT,ORX0
"RTN","ORDV06B",84,0)
 N ECD,GMR,GMW,IX,PSOBEGIN,GMTSNDM,GMTS1,GMTS2,ORSITE,SITE,X,NONVA,INST,OLDORI,RT,X,X2,X3,ORII,ORKK
"RTN","ORDV06B",85,0)
 S ORSITE=$$SITE^VASITE,ORSITE=$P(ORSITE,"^",2)_";"_$P(ORSITE,"^",3)
"RTN","ORDV06B",86,0)
 ;Sorted by STATUS then by DRUG NAME
"RTN","ORDV06B",87,0)
 K ^TMP("ORDATA",$J),^TMP("ORXPND",$J),^TMP("ORT",$J)
"RTN","ORDV06B",88,0)
 I '$L($T(GCPR^OMGCOAS1)) D
"RTN","ORDV06B",89,0)
 . K ^TMP("ORPS",$J)
"RTN","ORDV06B",90,0)
 . D @GO
"RTN","ORDV06B",91,0)
 S (OLDORI,ORIPS,ORT)=0
"RTN","ORDV06B",92,0)
 F  S ORIPS=$O(^TMP("ORPS",$J,ORIPS)) Q:(ORIPS'>0)  S X=$G(^(ORIPS)) I X'="" D
"RTN","ORDV06B",93,0)
 . I $E(X)="~" D  Q
"RTN","ORDV06B",94,0)
 .. S OLDORI=ORIPS,ORT=0,X3=$S($L($P(X,"^",10)):$P(X,"^",10),1:"ZUNKNOWN"),X2=$S($L($P(X,"^",3)):$P(X,"^",3),1:"ZUNKNOWN")
"RTN","ORDV06B",95,0)
 .. S ^TMP("ORT",$J,X3,X2,ORIPS)=X
"RTN","ORDV06B",96,0)
 . I $L(X2),$L(X3),$E(X)="\" S ORT=ORT+1,^TMP("ORT",$J,X3,X2,OLDORI,ORT)=$E(X,2,9999)
"RTN","ORDV06B",97,0)
 S ORII=""
"RTN","ORDV06B",98,0)
 F  S ORII=$O(^TMP("ORT",$J,ORII)) Q:ORII=""  S ORKK="" F  S ORKK=$O(^TMP("ORT",$J,ORII,ORKK)) Q:ORKK=""  D
"RTN","ORDV06B",99,0)
 . S ORIPS=0 F  S ORIPS=$O(^TMP("ORT",$J,ORII,ORKK,ORIPS)) Q:(ORIPS'>0)  S ORX0=^(ORIPS) D
"RTN","ORDV06B",100,0)
 .. I $E(ORX0)="~" D  Q
"RTN","ORDV06B",101,0)
 ... S ORIPSS=$S($L($P(ORX0,U,10)):$E($P(ORX0,U,10),1,10),1:"UNK")_"_"_$S($L($P(ORX0,U,3)):$P(ORX0,U,3),1:"UNK")_"_"_ORIPS
"RTN","ORDV06B",102,0)
 ... S ^TMP("ORDATA",$J,ORIPSS,"WP",1)="1^"_ORSITE ;Station ID
"RTN","ORDV06B",103,0)
 ... S ^TMP("ORDATA",$J,ORIPSS,"WP",2)="2^"_$P(ORX0,U,3) ;Medication Name
"RTN","ORDV06B",104,0)
 ... S ^TMP("ORDATA",$J,ORIPSS,"WP",3)="3^"_$P(ORX0,U,10) ;Status
"RTN","ORDV06B",105,0)
 ... S X=$P($P(ORX0,"^",2),";",2),^TMP("ORDATA",$J,ORIPSS,"WP",4)="4^"_$S(X="I":"IN",X="C":"IN",1:"OUT") ;In/OutPatient
"RTN","ORDV06B",106,0)
 ... S X=$P(ORX0,"^"),^TMP("ORDATA",$J,ORIPSS,"WP",5)="5^"_$S(X="~NV":"NonVAMed",1:"RX") ;Type: RX or NonVA Med
"RTN","ORDV06B",107,0)
 ... S ^TMP("ORDATA",$J,ORIPSS,"WP",6)="6^"_$$DATE^ORDVU($P(ORX0,U,16)) ;Start Date
"RTN","ORDV06B",108,0)
 ... S ^TMP("ORDATA",$J,ORIPSS,"WP",7)="7^"_$$DATE^ORDVU($P(ORX0,U,5)) ;Stop Date
"RTN","ORDV06B",109,0)
 ... S ^TMP("ORDATA",$J,ORIPSS,"WP",8)="8^"_$$DATE^ORDVU($P(ORX0,U,11)) ;Last Fill Date
"RTN","ORDV06B",110,0)
 ... S ^TMP("ORDATA",$J,ORIPSS,"WP",9)="9^"_$P(ORX0,U,18) ;Provider
"RTN","ORDV06B",111,0)
 ... S ^TMP("ORDATA",$J,ORIPSS,"WP",12)="12^[+]" ;flag for detail
"RTN","ORDV06B",112,0)
 ... S X=$P(ORX0,"^",2) D DETAIL^ORWPS(.RT,DFN,X)
"RTN","ORDV06B",113,0)
 ... S J=0 F  S J=$O(^TMP("ORXPND",$J,J)) Q:'J  S X=^(J,0),^TMP("ORDATA",$J,ORIPSS,"WP",11,J)="11^"_X ;Details from Order
"RTN","ORDV06B",114,0)
 ... K ^TMP("ORXPND",$J)
"RTN","ORDV06B",115,0)
 ... S ORT=0 F  S ORT=$O(^TMP("ORT",$J,ORII,ORKK,ORIPS,ORT)) Q:'ORT  S X=^(ORT),^TMP("ORDATA",$J,ORIPSS,"WP",10,ORT)="10^"_X ;Instructions
"RTN","ORDV06B",116,0)
 K ^TMP("ORPS",$J),^TMP("ORXPND",$J),^TMP("ORT",$J)
"RTN","ORDV06B",117,0)
 S ROOT=$NA(^TMP("ORDATA",$J))
"RTN","ORDV06B",118,0)
 Q
"RTN","ORIMO")
0^54^B2334294
"RTN","ORIMO",1,0)
ORIMO ;SLC/JDL - Inpatient medication on outpatient. ;08/25/14  09:59
"RTN","ORIMO",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**187,190,195,215,243,350**;Dec 17, 1997;Build 77
"RTN","ORIMO",3,0)
IMOLOC(ORY,ORLOC,ORDFN) ;ORY>=0: LOC is an IMO authorized location
"RTN","ORIMO",4,0)
 S ORY=-1
"RTN","ORIMO",5,0)
 N PACH
"RTN","ORIMO",6,0)
 S PACH=$$PATCH^XPDUTL("PSJ*5.0*111")
"RTN","ORIMO",7,0)
 Q:'PACH
"RTN","ORIMO",8,0)
 I $L($TEXT(SDIMO^SDAMA203)) D
"RTN","ORIMO",9,0)
 . ;#DBIA 4133
"RTN","ORIMO",10,0)
 . S ORY=$$SDIMO^SDAMA203(ORLOC,ORDFN)
"RTN","ORIMO",11,0)
 . ;if RSA returns an error then check against Clinic Loc.
"RTN","ORIMO",12,0)
 . I ORY=-3 D
"RTN","ORIMO",13,0)
 . .I $P($G(^SC(ORLOC,0)),U,3)'="C" Q
"RTN","ORIMO",14,0)
 . .I $D(^SC("AE",1,ORLOC))=1 S ORY=1
"RTN","ORIMO",15,0)
 . K SDIMO(1)
"RTN","ORIMO",16,0)
 Q
"RTN","ORIMO",17,0)
 ;
"RTN","ORIMO",18,0)
IMOOD(ORY,ORDERID) ;Is it an IMO order?
"RTN","ORIMO",19,0)
 Q:'$D(^OR(100,+ORDERID,0))
"RTN","ORIMO",20,0)
 N PIMO,DGRP,CMGRP,CIGRP
"RTN","ORIMO",21,0)
 S (DGRP,CMGRP,CIGRP,ORY)=0
"RTN","ORIMO",22,0)
 S DGRP=$P($G(^OR(100,+ORDERID,0)),U,11)
"RTN","ORIMO",23,0)
 S CMGRP=$O(^ORD(100.98,"B","CLINIC MEDICATIONS",""))
"RTN","ORIMO",24,0)
 S CIGRP=$O(^ORD(100.98,"B","CLINIC INFUSIONS",""))
"RTN","ORIMO",25,0)
 I DGRP=CMGRP S ORY=1
"RTN","ORIMO",26,0)
 I DGRP=CIGRP S ORY=1
"RTN","ORIMO",27,0)
 Q
"RTN","ORIMO",28,0)
 ;
"RTN","ORIMO",29,0)
ISCLOC(ORY,ALOC) ;Is it a clinical location
"RTN","ORIMO",30,0)
 S ORY=0
"RTN","ORIMO",31,0)
 Q:'$D(^SC(+ALOC,0))
"RTN","ORIMO",32,0)
 I $P(^SC(+ALOC,0),U,3)="C" S ORY=1
"RTN","ORIMO",33,0)
 Q
"RTN","ORIMO",34,0)
ISIVQO(ORY,DLGID) ;Is it an IV quick order
"RTN","ORIMO",35,0)
 S ORY=0
"RTN","ORIMO",36,0)
 Q:'$D(^ORD(101.41,DLGID,0))
"RTN","ORIMO",37,0)
 N IVGRP,DLGTYP,DLGGRP
"RTN","ORIMO",38,0)
 S IVGRP=$O(^ORD(100.98,"B","IV RX",0))
"RTN","ORIMO",39,0)
 S DLGTYP=$P($G(^ORD(101.41,DLGID,0)),U,4)
"RTN","ORIMO",40,0)
 S DLGGRP=$P($G(^ORD(101.41,DLGID,0)),U,5)
"RTN","ORIMO",41,0)
 I (DLGTYP="Q"),(DLGGRP=IVGRP) S ORY=1
"RTN","ORIMO",42,0)
 Q
"RTN","ORMBLD")
0^43^B44600527
"RTN","ORMBLD",1,0)
ORMBLD ; SLC/MKB/JDL - Build outgoing ORM msgs ;04/16/14  12:58
"RTN","ORMBLD",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**3,33,26,45,79,97,133,168,187,190,195,215,350**;Dec 17, 1997;Build 77
"RTN","ORMBLD",3,0)
 ;
"RTN","ORMBLD",4,0)
NEW(IFN,CODE) ; -- Send NW order message to pkg
"RTN","ORMBLD",5,0)
 ;I $P($G(^ORD(101.42,+$$VALUE^ORCSAVE2(IFN,"URGENCY"),0)),U)="DONE" D STATUS^ORCSAVE2(IFN,2) Q  ; complete -> don't send to pkg
"RTN","ORMBLD",6,0)
 N ORPKG,ORMSG,DGQUIET K ^TMP("ORWORD",$J)
"RTN","ORMBLD",7,0)
 S DGQUIET=1 D  Q:'$O(ORMSG(0))  ;build msg, ORDIALOG gone when posted
"RTN","ORMBLD",8,0)
 . N OR0,OR3,OR8,ORVP,ORDG,ORDIALOG,ORPARENT S:'$D(CODE) CODE="NW"
"RTN","ORMBLD",9,0)
 . S OR0=$G(^OR(100,IFN,0)) Q:'$L(OR0)  S OR3=$G(^(3)),OR8=$G(^(8,1,0))
"RTN","ORMBLD",10,0)
 . S ORVP=$P(OR0,U,2),ORDG=$P(OR0,U,11),ORPKG=$$NMSP^ORCD($P(OR0,U,14))
"RTN","ORMBLD",11,0)
 . Q:"^GMRA^GMRC^FH^LR^PS^RA^OR^"'[(U_ORPKG_U)
"RTN","ORMBLD",12,0)
 . S ORDIALOG=+$P(OR0,U,5) Q:'ORDIALOG
"RTN","ORMBLD",13,0)
 . D GETDLG1^ORCD(ORDIALOG),GETORDER^ORCD(IFN)
"RTN","ORMBLD",14,0)
 . S ORMSG(1)=$$MSH("ORM",ORPKG),ORMSG(2)=$$PID(ORVP)
"RTN","ORMBLD",15,0)
 . S ORMSG(3)=$$PV1(ORVP,$P(OR0,U,12),+$P(OR0,U,10),"",$P(OR0,U,18))
"RTN","ORMBLD",16,0)
 . S ORPARENT=$P(OR3,U,9) I ORPARENT,$G(ORDIALOG($$PTR^ORCD("OR GTX SCHEDULE"),1))="NOW"!'$O(^OR(100,+ORPARENT,4.5,"ID","CONJ",0)) S ORPARENT="" ;no parent if NOW or only child
"RTN","ORMBLD",17,0)
 . S ORMSG(4)="ORC|"_CODE_"|"_+OR0_";1^OR||||||"_ORPARENT_"|"_$$HL7DATE($P(OR0,U,7))_"|"_+$P(OR0,U,6)_"||"_+$P(OR0,U,4)_"|||"_$$HL7DATE($$NOW^XLFDT)_"|"_$$NATURE($P(OR8,U,12))_"^^^"
"RTN","ORMBLD",18,0)
 . D @ORPKG K ^TMP("ORWORD",$J)
"RTN","ORMBLD",19,0)
 I $G(ORZTEST) M ORZTEST=ORMSG Q  ;testing only
"RTN","ORMBLD",20,0)
 D MSG^XQOR("OR EVSEND "_ORPKG,.ORMSG)
"RTN","ORMBLD",21,0)
 Q
"RTN","ORMBLD",22,0)
 ;
"RTN","ORMBLD",23,0)
MSG(IFN,CODE,REASON) ; -- Send all other order msgs
"RTN","ORMBLD",24,0)
 N ORPKG,ORMSG,DGQUIET K ^TMP("ORWORD",$J)
"RTN","ORMBLD",25,0)
 S DGQUIET=1 D  Q:'$O(ORMSG(0))  ; build message
"RTN","ORMBLD",26,0)
 . N OR0,OR8,DG,PKGID,I,TYPE,DA,PROV,NATR,STS,OI
"RTN","ORMBLD",27,0)
 . S OR0=$G(^OR(100,+IFN,0)),PKGID=$G(^(4)),STS=$P($G(^(3)),U,3)
"RTN","ORMBLD",28,0)
 . S ORPKG=$$NMSP^ORCD($P(OR0,U,14))
"RTN","ORMBLD",29,0)
 . I ORPKG="VBEC" D:$L($T(CA^ORMBLDVB)) CA^ORMBLDVB(IFN,$G(REASON)) Q
"RTN","ORMBLD",30,0)
 . Q:"^GMRA^GMRC^FH^LR^PS^RA^OR^"'[(U_ORPKG_U)
"RTN","ORMBLD",31,0)
 . I ORPKG="LR" S ORPKG="LRCH" S:CODE="DC" CODE="CA" ;DC if VBEC child
"RTN","ORMBLD",32,0)
 . S DA=+$P(IFN,";",2),OR8=$G(^OR(100,+IFN,8,DA,0))
"RTN","ORMBLD",33,0)
 . S PROV=$P(OR8,U,3),NATR=$P(OR8,U,12) S:'PROV PROV=$G(ORNP)
"RTN","ORMBLD",34,0)
 . S TYPE=$S(CODE="NA"!(CODE="DE"):"ORR",1:"ORM")
"RTN","ORMBLD",35,0)
 . S ORMSG(1)=$$MSH(TYPE,ORPKG),ORMSG(2)=$$PID($P(OR0,U,2)),I=2
"RTN","ORMBLD",36,0)
 . I ORPKG="PS"!(ORPKG="FH"&($P(OR0,U,12)="O")) S I=I+1,ORMSG(I)=$$PV1($P(OR0,U,2),$P(OR0,U,12),+$P(OR0,U,10))
"RTN","ORMBLD",37,0)
 . S I=I+1,ORMSG(I)="ORC|"_CODE_"|"_IFN_"^OR|"_PKGID_U_ORPKG_"||||||"_$S($G(DGPMA):$$HL7DATE($P(DGPMA,U)),1:"")_"|"_DUZ_"||"_PROV_"|||"_$$HL7DATE($$NOW^XLFDT)_"|"_$$REASON(+$G(REASON),NATR)
"RTN","ORMBLD",38,0)
 . I ORPKG="FH",CODE="SS" S $P(ORMSG(I),"|",6)=$S(STS=8:"SC",STS=6:"IP",1:"")
"RTN","ORMBLD",39,0)
 . I $E(ORPKG,1,2)="LR" S OI=+$O(^OR(100,+IFN,.1,0)),OI=+$G(^(OI,0)) S:OI I=I+1,ORMSG(I)="OBR||||"_$$USID(OI)
"RTN","ORMBLD",40,0)
 . I $P(^ORD(100.98,$P(OR0,U,11),0),U)="NON-VA MEDICATIONS" D
"RTN","ORMBLD",41,0)
 . . I (CODE="CA")!(CODE="DC") S I=I+1,ORMSG(I)="ZRN|N"
"RTN","ORMBLD",42,0)
 . K ^TMP("ORWORD",$J)
"RTN","ORMBLD",43,0)
 D MSG^XQOR("OR EVSEND "_ORPKG,.ORMSG)
"RTN","ORMBLD",44,0)
 Q
"RTN","ORMBLD",45,0)
 ;
"RTN","ORMBLD",46,0)
BHS(PAT) ; -- Send batch header segment/message to Lab
"RTN","ORMBLD",47,0)
 N ORMSG S ORMSG(1)="BHS|^~\&|ORDER ENTRY|"_$G(DUZ(2))_"|LABORATORY|"_$G(DUZ(2))_"|"_$$HL7DATE($$NOW^XLFDT)
"RTN","ORMBLD",48,0)
 S ORMSG(2)=$$PID($G(PAT))
"RTN","ORMBLD",49,0)
 D MSG^XQOR("OR EVSEND LRCH",.ORMSG)
"RTN","ORMBLD",50,0)
 Q
"RTN","ORMBLD",51,0)
 ;
"RTN","ORMBLD",52,0)
BTS(PAT) ; -- Send batch trailer segment/message to Lab
"RTN","ORMBLD",53,0)
 N ORMSG S ORMSG(1)="BTS",ORMSG(2)=$$PID($G(PAT))
"RTN","ORMBLD",54,0)
 D MSG^XQOR("OR EVSEND LRCH",.ORMSG)
"RTN","ORMBLD",55,0)
 Q
"RTN","ORMBLD",56,0)
 ;
"RTN","ORMBLD",57,0)
MSH(TYPE,TO) ; -- MSH segment
"RTN","ORMBLD",58,0)
 N MSH
"RTN","ORMBLD",59,0)
 S MSH="MSH|^~\&|ORDER ENTRY|"_$G(DUZ(2))_"|"_$$NAME(TO)_"|"_$G(DUZ(2))_"|"_$$HL7DATE($$NOW^XLFDT)_"||"_TYPE
"RTN","ORMBLD",60,0)
 Q MSH
"RTN","ORMBLD",61,0)
 ;
"RTN","ORMBLD",62,0)
NAME(NMSP) ; -- Returns name of pkg NMSP
"RTN","ORMBLD",63,0)
 I NMSP="GMRA" Q "ALLERGIES"
"RTN","ORMBLD",64,0)
 I NMSP="GMRC" Q "CONSULTS"
"RTN","ORMBLD",65,0)
 I NMSP="FH" Q "DIETETICS"
"RTN","ORMBLD",66,0)
 I NMSP?1"LR".E Q "LABORATORY"
"RTN","ORMBLD",67,0)
 I NMSP="PS" Q "PHARMACY"
"RTN","ORMBLD",68,0)
 I NMSP="RA" Q "RADIOLOGY"
"RTN","ORMBLD",69,0)
 I NMSP="OR" Q "ORDER ENTRY"
"RTN","ORMBLD",70,0)
 Q ""
"RTN","ORMBLD",71,0)
 ;
"RTN","ORMBLD",72,0)
PID(DFN) ; -- PID segment
"RTN","ORMBLD",73,0)
 N PID,PTR,ROOT
"RTN","ORMBLD",74,0)
 S PTR=+$P(DFN,";"),ROOT=$P(DFN,";",2),PID="PID|||"
"RTN","ORMBLD",75,0)
 I ROOT="DPT(" S PID=PID_PTR_"||"_$P($G(^DPT(PTR,0)),U)
"RTN","ORMBLD",76,0)
 E  S PID=PID_"|"_DFN_"|"_$S($L(ROOT):$P($G(@(U_ROOT_PTR_",0)")),U),1:"")
"RTN","ORMBLD",77,0)
 Q PID
"RTN","ORMBLD",78,0)
 ;
"RTN","ORMBLD",79,0)
PV1(OBJ,TYPE,LOC,VISIT,APPTDT) ; -- PV1 segment
"RTN","ORMBLD",80,0)
 N PV1,RB,PACH S RB=""
"RTN","ORMBLD",81,0)
 S:$G(APPTDT) APPTDT=$$FMTHL7^XLFDT(APPTDT)
"RTN","ORMBLD",82,0)
 I TYPE="I",+OBJ,$P(OBJ,";",2)="DPT(" S RB=$P($G(^DPT(+OBJ,.101)),U)
"RTN","ORMBLD",83,0)
 S PACH=$$PATCH^XPDUTL("PSJ*5.0*111")
"RTN","ORMBLD",84,0)
 S:PACH PV1="PV1||"_TYPE_"|"_LOC_$S($L(RB):U_RB,1:"")_"||||||||||||||||"_$G(VISIT)_"|||||||||||||||||||||||||"_$G(APPTDT)
"RTN","ORMBLD",85,0)
 S:'PACH PV1="PV1||"_TYPE_"|"_LOC_$S($L(RB):U_RB,1:"")_"||||||||||||||||"_$G(VISIT)
"RTN","ORMBLD",86,0)
 Q PV1
"RTN","ORMBLD",87,0)
 ;
"RTN","ORMBLD",88,0)
HL7DATE(DATE) ; -- FM -> HL7 format
"RTN","ORMBLD",89,0)
 Q $$FMTHL7^XLFDT(DATE)  ;**97
"RTN","ORMBLD",90,0)
 ;
"RTN","ORMBLD",91,0)
USID(OI) ; -- Returns Univ Serv ID for Orderable Item
"RTN","ORMBLD",92,0)
 N OITEM,NATL,LOCAL S OITEM=$G(^ORD(101.43,+OI,0))
"RTN","ORMBLD",93,0)
 S NATL=$P(OITEM,U,3)_U_U_$P(OITEM,U,4)
"RTN","ORMBLD",94,0)
 S LOCAL=$P($P(OITEM,U,2),";")_U_$P(OITEM,U)_U_$P($P(OITEM,U,2),";",2)
"RTN","ORMBLD",95,0)
 Q NATL_U_LOCAL
"RTN","ORMBLD",96,0)
 ;
"RTN","ORMBLD",97,0)
NATURE(X) ; -- Returns 3 ^-piece identifier for nature X
"RTN","ORMBLD",98,0)
 N ORN,Y S ORN=$G(^ORD(100.02,+$G(X),0))
"RTN","ORMBLD",99,0)
 S Y=$P(ORN,U,2)_U_$P(ORN,U)_"^99ORN"
"RTN","ORMBLD",100,0)
 Q Y
"RTN","ORMBLD",101,0)
 ;
"RTN","ORMBLD",102,0)
REASON(X,N) ; -- Returns 6 ^-piece format of reason X
"RTN","ORMBLD",103,0)
 ;    N ^ NATURE ^ 99ORN ^ # ^ Reason ^ 99ORR
"RTN","ORMBLD",104,0)
 N Y,ORR S ORR=$G(^ORD(100.03,+$G(X),0))
"RTN","ORMBLD",105,0)
 S:'$G(N) N=+$P(ORR,U,7) S Y=$$NATURE(N)
"RTN","ORMBLD",106,0)
 S:$G(X) Y=Y_U_$S(ORPKG'="RA":+X,1:"")_U_$P(ORR,U)_"^99ORR"
"RTN","ORMBLD",107,0)
 Q Y
"RTN","ORMBLD",108,0)
 ;
"RTN","ORMBLD",109,0)
IP() ; -- Returns ORIFN^Type if pt has active isolation order (or 0 if not)
"RTN","ORMBLD",110,0)
 N TYPE,START,ORIFN,Y
"RTN","ORMBLD",111,0)
 S TYPE=$O(^ORD(100.98,"B","PREC",0)),START=$$NOW^XLFDT,Y=0
"RTN","ORMBLD",112,0)
 F  S START=$O(^OR(100,"AW",ORVP,TYPE,START),-1) Q:START'>0  S ORIFN=$O(^(START,0)) I $P($G(^OR(100,ORIFN,3)),U,3)=6 S Y=ORIFN Q
"RTN","ORMBLD",113,0)
 I Y S TYPE=$$VALUE^ORCSAVE2(ORIFN,"ISOLATION"),Y=Y_U_$$GET1^DIQ(119.4,+TYPE_",",.01)
"RTN","ORMBLD",114,0)
 Q Y
"RTN","ORMBLD",115,0)
 ;
"RTN","ORMBLD",116,0)
OR ; -- new Generic order
"RTN","ORMBLD",117,0)
 I ORDG=$O(^ORD(100.98,"B","M.A.S.",0)) D ADT^ORMBLDOR Q
"RTN","ORMBLD",118,0)
 D EN^ORMBLDOR
"RTN","ORMBLD",119,0)
 Q
"RTN","ORMBLD",120,0)
 ;
"RTN","ORMBLD",121,0)
GMRA ; -- new Allergy order
"RTN","ORMBLD",122,0)
 Q:$$PATCH^XPDUTL("OR*3.0*216")  ;195 quit if patch 216 is in
"RTN","ORMBLD",123,0)
 D:$L($T(ALG^ORMBLDAL)) ALG^ORMBLDAL
"RTN","ORMBLD",124,0)
 Q
"RTN","ORMBLD",125,0)
 ;
"RTN","ORMBLD",126,0)
GMRC ; -- new Consult order
"RTN","ORMBLD",127,0)
 D CSLT^ORMBLDGM
"RTN","ORMBLD",128,0)
 Q
"RTN","ORMBLD",129,0)
 ;
"RTN","ORMBLD",130,0)
FH ; -- new Diet order
"RTN","ORMBLD",131,0)
 N ORPARAM D EN^FHWOR8(+ORVP,.ORPARAM) ; set parameters
"RTN","ORMBLD",132,0)
 S:'$L($G(ORPARAM(3))) ORPARAM(3)="T"
"RTN","ORMBLD",133,0)
 I ORDG=$O(^ORD(100.98,"B","PRECAUTIONS",0)) D IP^ORMBLDFH Q
"RTN","ORMBLD",134,0)
 I ORDG=$O(^ORD(100.98,"B","EARLY/LATE TRAYS",0)) D TRAY^ORMBLDFH Q
"RTN","ORMBLD",135,0)
 I ORDG=$O(^ORD(100.98,"B","TUBEFEEDINGS",0)) D TF^ORMBLDFH Q
"RTN","ORMBLD",136,0)
 I ORDG=$O(^ORD(100.98,"B","DIET ADDITIONAL ORDERS",0)) D ADDN^ORMBLDFH Q
"RTN","ORMBLD",137,0)
 D DIET^ORMBLDFH
"RTN","ORMBLD",138,0)
 Q
"RTN","ORMBLD",139,0)
 ;
"RTN","ORMBLD",140,0)
LR ; -- new Lab order
"RTN","ORMBLD",141,0)
 I CODE="XO" D XO^ORMBLDLR Q  ; change
"RTN","ORMBLD",142,0)
 D CH^ORMBLDLR S ORPKG="LRCH" Q  ;no difference by subscript at this time
"RTN","ORMBLD",143,0)
 N SUB S SUB=$P($G(^ORD(100.98,ORDG,0)),U,3)
"RTN","ORMBLD",144,0)
 S:(SUB="SP")!(SUB="EM")!(SUB="AU")!(SUB="CY") SUB="AP"
"RTN","ORMBLD",145,0)
 S:(SUB="LAB")!(SUB="MI")!(SUB="HEMA") SUB="CH"
"RTN","ORMBLD",146,0)
 D @(SUB_"^ORMBLDLR") S ORPKG=ORPKG_SUB
"RTN","ORMBLD",147,0)
 Q
"RTN","ORMBLD",148,0)
 ;
"RTN","ORMBLD",149,0)
PS ; -- new Pharmacy order
"RTN","ORMBLD",150,0)
 ;I ORDG=$O(^ORD(100.98,"B","OUTPATIENT MEDICATIONS",0)) D OUT^ORMBLDPS Q
"RTN","ORMBLD",151,0)
 ;D UD^ORMBLDPS
"RTN","ORMBLD",152,0)
 N IVDLG S IVDLG=+$P(OR0,U,5) ;JD
"RTN","ORMBLD",153,0)
 N PKG S PKG=$P(OR0,U,14),PKG=$$GET1^DIQ(9.4,+PKG_",",1)
"RTN","ORMBLD",154,0)
 I +$$VALUE^ORCSAVE2(IFN,"URGENCY")=99,$P(OR3,U,11)'="B" D  Q  ;only send DONE orders from BCMA
"RTN","ORMBLD",155,0)
 . D STATUS^ORCSAVE2(IFN,2) K ORMSG
"RTN","ORMBLD",156,0)
 . I $P(OR3,U,11)=1,$P($G(^OR(100,+$P(OR3,U,5),3)),U,3)=5 D MSG(+$P(OR3,U,5),"CA") ;cancel original instead
"RTN","ORMBLD",157,0)
 I ORDG=$O(^ORD(100.98,"B","IV RX",0))!(ORDG=$O(^ORD(100.98,"B","TPN",0)))!(IVDLG=$O(^ORD(101.41,"B","PSJI OR PAT FLUID OE",0)))!(IVDLG=$O(^ORD(101.41,"B","CLINIC OR PAT FLUID OE",0))) D IV^ORMBLDPS Q
"RTN","ORMBLD",158,0)
 D @($S(PKG="PSIV":"IV",PKG="PSO":"OUT",PKG="PSH":"NVA",1:"UD")_"^ORMBLDPS")
"RTN","ORMBLD",159,0)
 Q
"RTN","ORMBLD",160,0)
 ;
"RTN","ORMBLD",161,0)
RA ; -- new Radiology order
"RTN","ORMBLD",162,0)
 D EN^ORMBLDRA
"RTN","ORMBLD",163,0)
 Q
"RTN","ORMBLD",164,0)
 ;
"RTN","ORMBLD",165,0)
TEST(ORIFN) ; -- Build/display HL7 msgs w/o sending
"RTN","ORMBLD",166,0)
 K ORZTEST S ORZTEST=1 D NEW(ORIFN) ; leaves msg in ORZTEST() on exit
"RTN","ORMBLD",167,0)
 Q
"RTN","ORMBLDGM")
0^73^B6024774
"RTN","ORMBLDGM",1,0)
ORMBLDGM ;SLC/MKB-Build outgoing GMR* ORM msgs ;02/23/15  06:26
"RTN","ORMBLDGM",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**26,68,97,190,195,280,361,350**;Dec 17, 1997;Build 77
"RTN","ORMBLDGM",3,0)
 ;;ICR
"RTN","ORMBLDGM",4,0)
 ;;XLFDT-10103
"RTN","ORMBLDGM",5,0)
 ;;CODECS^ICDEX-5747
"RTN","ORMBLDGM",6,0)
HL7DATE(DATE) ; -- FM -> HL7 format
"RTN","ORMBLDGM",7,0)
 Q $$FMTHL7^XLFDT(DATE)  ;**97
"RTN","ORMBLDGM",8,0)
 ;
"RTN","ORMBLDGM",9,0)
PTR(NAME) ; -- Returns ptr value of prompt in Dialog file
"RTN","ORMBLDGM",10,0)
 Q $O(^ORD(101.41,"AB",$E("OR GTX "_NAME,1,63),0))
"RTN","ORMBLDGM",11,0)
 ;
"RTN","ORMBLDGM",12,0)
CSLT ; -- Segments for new Consult order
"RTN","ORMBLDGM",13,0)
 N OI,WP,URG,CATG,PLACE,ATTN,DIAG,CODE,QT,I,J,USID,CTYPE,RSERV,Z
"RTN","ORMBLDGM",14,0)
 N CLIND,X,Y,ORCODE
"RTN","ORMBLDGM",15,0)
 S OI=$G(ORDIALOG($$PTR("ORDERABLE ITEM"),1))
"RTN","ORMBLDGM",16,0)
 S CTYPE=$G(ORDIALOG($$PTR("FREE TEXT OI"),1))
"RTN","ORMBLDGM",17,0)
 S RSERV=$G(ORDIALOG($$PTR("REQUEST SERVICE"),1))
"RTN","ORMBLDGM",18,0)
 S WP=$$PTR("WORD PROCESSING 1"),URG=+$G(ORDIALOG($$PTR("URGENCY"),1))
"RTN","ORMBLDGM",19,0)
 S CATG=$G(ORDIALOG($$PTR("CATEGORY"),1))
"RTN","ORMBLDGM",20,0)
 S PLACE=$G(ORDIALOG($$PTR("PLACE OF CONSULTATION"),1))
"RTN","ORMBLDGM",21,0)
 S ATTN=$G(ORDIALOG($$PTR("PROVIDER"),1))
"RTN","ORMBLDGM",22,0)
 S DIAG=$G(ORDIALOG($$PTR("FREE TEXT"),1))
"RTN","ORMBLDGM",23,0)
 S CODE=$G(ORDIALOG($$PTR("CODE"),1))
"RTN","ORMBLDGM",24,0)
 S X=$G(ORDIALOG($$PTR("CLINICALLY INDICATED DATE"),1)),%DT="TX" D ^%DT S:Y>0 CLIND=$$HL7DATE(Y) ;WAT/280/350
"RTN","ORMBLDGM",25,0)
CS1 S QT="^^^"_$G(CLIND)_"^^"_$P($G(^ORD(101.42,+URG,0)),U,2),$P(ORMSG(4),"|",8)=QT ;WAT/280
"RTN","ORMBLDGM",26,0)
 S $P(ORMSG(3),"|",3)=CATG S:PLACE="C" PLACE="OC"
"RTN","ORMBLDGM",27,0)
 S USID=$$USID^ORMBLD(OI) ;S:$L(CTYPE) $P(USID,U,5)=CTYPE
"RTN","ORMBLDGM",28,0)
 S ORMSG(5)="OBR||||"_USID_"||||||||||||||"_PLACE_"|"_ATTN,Z=5
"RTN","ORMBLDGM",29,0)
 ; Create DG1 & ZCL segment(s) for Billing Awareness (BA) project
"RTN","ORMBLDGM",30,0)
 D DG1^ORWDBA3($G(IFN),"Z",5)
"RTN","ORMBLDGM",31,0)
 I RSERV'>0,$P(USID,U,6)="99CON" S RSERV=+$P(USID,U,4)
"RTN","ORMBLDGM",32,0)
 S:RSERV Z=Z+1,ORMSG(Z)="ZSV|^^^"_+RSERV_U_$$GET1^DIQ(123.5,+RSERV_",",.01)_"^99CON|"_CTYPE
"RTN","ORMBLDGM",33,0)
 S I=0,J=+$O(^TMP("ORWORD",$J,WP,1,0)),Z=Z+1 ; get first line
"RTN","ORMBLDGM",34,0)
 S ORMSG(Z)="OBX|1|TX|2000.02^REASON FOR REQUEST^AS4||"_$G(^TMP("ORWORD",$J,WP,1,J,0))
"RTN","ORMBLDGM",35,0)
 F  S J=$O(^TMP("ORWORD",$J,WP,1,J)) Q:J'>0  S I=I+1,ORMSG(Z,I)=^(+J,0)
"RTN","ORMBLDGM",36,0)
 I $L(DIAG) D
"RTN","ORMBLDGM",37,0)
 . N TYPE,VALUE S TYPE="TX",VALUE=DIAG
"RTN","ORMBLDGM",38,0)
 . I $L(CODE) D
"RTN","ORMBLDGM",39,0)
 .. S TYPE="CE",ORCODE=$$CODECS^ICDEX(CODE,"80")
"RTN","ORMBLDGM",40,0)
 .. S ORCODE=$S($P(ORCODE,U)=1:"I9C",1:"I10")
"RTN","ORMBLDGM",41,0)
 .. S VALUE=CODE_U_DIAG_U_ORCODE
"RTN","ORMBLDGM",42,0)
 . S Z=Z+1,ORMSG(Z)="OBX|2|"_TYPE_"|^PROVISIONAL DIAGNOSIS^||"_VALUE
"RTN","ORMBLDGM",43,0)
 Q
"RTN","ORMFN")
0^79^B42446020
"RTN","ORMFN",1,0)
ORMFN ; SLC/MKB - MFN msg router ;11/10/15  12:21
"RTN","ORMFN",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**26,97,94,176,215,243,280,350**;Dec 17, 1997;Build 77
"RTN","ORMFN",3,0)
 ;
"RTN","ORMFN",4,0)
 ;
"RTN","ORMFN",5,0)
 ;
"RTN","ORMFN",6,0)
EN(MSG) ; -- main entry point for OR ITEM RECEIVE
"RTN","ORMFN",7,0)
 N ORMSG,ORNMSP,ORDG,LEN,MSH,MFI,MFE,ZPKG,ZSY,NTE,ORMFE,ORDITEM,ORACTION,ORDIFN,ORFIEN,ORFLD,ORFDA,NUM,VALUE,X,Y,DA,DIC,DIK,SYS,ZLC,LAST,NAME,ID,INACTIVE,I,ORY,NEXT,DD,DO
"RTN","ORMFN",8,0)
 ;AGP Create a before and after temp global for compares by other protocols
"RTN","ORMFN",9,0)
 K ^TMP($J,"OR OI BEFORE"),^TMP($J,"OR OI AFTER"),^TMP($J,"OR OI NEW")
"RTN","ORMFN",10,0)
 S ORMSG=$G(MSG,"MSG") Q:'$O(@ORMSG@(0))  ; msg array root
"RTN","ORMFN",11,0)
 N ORNOW S ORNOW=$$NOW^XLFDT ;M ^XTMP("OR ITEM RECEIVE",ORNOW)=@ORMSG
"RTN","ORMFN",12,0)
MSH S MSH=0 F  S MSH=$O(@ORMSG@(MSH)) Q:MSH'>0  Q:$E(@ORMSG@(MSH),1,3)="MSH"
"RTN","ORMFN",13,0)
 Q:'MSH  S MSH=MSH_U_@ORMSG@(MSH)
"RTN","ORMFN",14,0)
 S X=$P(MSH,"|",3) S:X="RADIOLOGY" X="IMAGING"
"RTN","ORMFN",15,0)
 S ORDG=$O(^ORD(100.98,"B",X,0)),ORNMSP=$$NMSP(X) Q:'$L(ORNMSP)
"RTN","ORMFN",16,0)
 S MFI=$O(@ORMSG@(+MSH)) Q:$E(@ORMSG@(MFI),1,3)'="MFI"  ; error
"RTN","ORMFN",17,0)
MFE S MFE=+MFI ; ** loop through each MFE segment
"RTN","ORMFN",18,0)
 F  S MFE=$O(@ORMSG@(+MFE)) Q:MFE'>0  I $E(@ORMSG@(MFE),1,3)="MFE" D
"RTN","ORMFN",19,0)
 . K ORFLD,ORFDA
"RTN","ORMFN",20,0)
 . S MFE=MFE_U_@ORMSG@(MFE),ORMFE=$P(MFE,"|",2),INACTIVE=$P(MFE,"|",4)
"RTN","ORMFN",21,0)
 . S ORDITEM=$P(MFE,"|",5),NAME=$TR($P(ORDITEM,U,5),"~"," ")
"RTN","ORMFN",22,0)
 . ;AGP remove automatic stripping of trailing spaces
"RTN","ORMFN",23,0)
 . ;S LEN=$L(NAME) I $E(NAME,LEN)=" " S NAME=$E(NAME,1,(LEN-1))
"RTN","ORMFN",24,0)
 . S ID=$P(ORDITEM,U,4)_";"_$P(ORDITEM,U,6)
"RTN","ORMFN",25,0)
 . S ORDIFN=+$O(^ORD(101.43,"ID",ID,0)),ORFIEN=ORDIFN_","
"RTN","ORMFN",26,0)
 . S ORACTION=$S(ORMFE="MAD":1,(ORMFE="MAC")&('ORDIFN):1,(ORMFE="MUP")&('ORDIFN):1,'ORDIFN:0,ORMFE="MAC":2,ORMFE="MUP":2,ORMFE="MDC":3,ORMFE="MDL":3,1:0) ; 1=add, 2=change, 3=delete (inactivate)
"RTN","ORMFN",27,0)
 . Q:'ORACTION  ; 0=error
"RTN","ORMFN",28,0)
 . I ORACTION=3 S ORFDA(101.43,ORFIEN,.1)=$S(INACTIVE:$$HL7TFM^XLFDT(INACTIVE),1:$$NOW^XLFDT) D FILE^DIE("K","ORFDA") Q
"RTN","ORMFN",29,0)
ADD . I ORACTION=1,'ORDIFN D  Q:'ORDIFN  ;create item if it doesn't exist
"RTN","ORMFN",30,0)
 . . S ORDIFN=$$CREATE(NAME),ORFIEN=ORDIFN_","
"RTN","ORMFN",31,0)
 . . S ORFDA(101.43,ORFIEN,5)=+ORDG
"RTN","ORMFN",32,0)
 . . I ORDIFN>0 S ^TMP($J,"OR OI NEW",ORDIFN)=""
"RTN","ORMFN",33,0)
 . I '$D(^TMP($J,"OR OI NEW",ORDIFN)) M ^TMP($J,"OR OI BEFORE",ORDIFN)=^ORD(101.43,ORDIFN)
"RTN","ORMFN",34,0)
 . S ORFLD(.01)=NAME,ORFLD(1.1)=NAME,ORFLD(2)=ID,ORFLD(3)=$P(ORDITEM,U)
"RTN","ORMFN",35,0)
 . S SYS=$P(ORDITEM,U,3),ORFLD(4)=$S(+SYS=99:$E(SYS,3,99),1:SYS)
"RTN","ORMFN",36,0)
 . S ORFLD(.1)=$S(ORMFE="MAC":"@",(ORMFE="MUP")&('INACTIVE):"@",INACTIVE:$$HL7TFM^XLFDT(INACTIVE),1:"")
"RTN","ORMFN",37,0)
 . F NUM=.01,.1,1.1,2,3,4 S VALUE=$S(ORFLD(NUM)="":"@",1:ORFLD(NUM)) D VAL^DIE(101.43,ORFIEN,NUM,"F",VALUE,.ORY,"ORFDA")
"RTN","ORMFN",38,0)
ZPKG . S LAST=+MFE,ZPKG=$O(@ORMSG@(+MFE))
"RTN","ORMFN",39,0)
 . I ZPKG,$E(@ORMSG@(ZPKG),1,3)=("Z"_ORNMSP) S ZPKG=ZPKG_U_@ORMSG@(ZPKG),LAST=+ZPKG D @ORNMSP ; ZXX segment
"RTN","ORMFN",40,0)
 . D FILE^DIE("K","ORFDA") ; file data
"RTN","ORMFN",41,0)
ZLC . S NEXT=$O(@ORMSG@(LAST)) I NEXT,$E(@ORMSG@(NEXT),1,3)="ZLC" D
"RTN","ORMFN",42,0)
 . . N COMP,CID,CODE,CSYS
"RTN","ORMFN",43,0)
 . . K DA,^ORD(101.43,ORDIFN,10) ;S DIC("P")=$P(^DD(101.43,10,0),U,2)
"RTN","ORMFN",44,0)
 . . S DA(1)=ORDIFN,DIC="^ORD(101.43,"_DA(1)_",10,",DIC(0)="L",ZLC=LAST
"RTN","ORMFN",45,0)
 . . F  S ZLC=$O(@ORMSG@(ZLC)) Q:ZLC'>0  Q:$E(@ORMSG@(ZLC),1,3)'="ZLC"  D
"RTN","ORMFN",46,0)
 . . . S COMP=$P(@ORMSG@(ZLC),"|",5),X=$P(COMP,U,5) I X="" S LAST=ZLC Q
"RTN","ORMFN",47,0)
 . . . S CID=$P(COMP,U,4)_";"_$P(COMP,U,6) K DIC("DR"),DO,DD
"RTN","ORMFN",48,0)
 . . . S CODE=$P(COMP,U),CSYS=$P(COMP,U,3) S:+CSYS=99 CSYS=$E(CSYS,3,99)
"RTN","ORMFN",49,0)
 . . . S DIC("DR")="2///^S X=CID;3///^S X=CODE;4///^S X=CSYS"
"RTN","ORMFN",50,0)
 . . . D FILE^DICN S LAST=ZLC
"RTN","ORMFN",51,0)
ZSY . I $D(^ORD(101.43,ORDIFN,2)) D  ; kill old ones first
"RTN","ORMFN",52,0)
 . . S DA(1)=ORDIFN,DIK="^ORD(101.43,"_DA(1)_",2,"
"RTN","ORMFN",53,0)
 . . S DA=0 F  S DA=$O(^ORD(101.43,DA(1),2,DA)) Q:DA'>0  D ^DIK
"RTN","ORMFN",54,0)
 . . K ^ORD(101.43,ORDIFN,2),DIK,DA
"RTN","ORMFN",55,0)
 . S NEXT=$O(@ORMSG@(LAST)) I NEXT,$E(@ORMSG@(NEXT),1,3)="ZSY" D
"RTN","ORMFN",56,0)
 . . K DA,DIC S DA(1)=ORDIFN,DIC="^ORD(101.43,"_DA(1)_",2,"
"RTN","ORMFN",57,0)
 . . S DIC(0)="L",ZSY=LAST ;,DIC("P")=$P(^DD(101.43,1,0),U,2)
"RTN","ORMFN",58,0)
 . . F  S ZSY=$O(@ORMSG@(+ZSY)) Q:ZSY'>0  Q:$E(@ORMSG@(ZSY),1,3)'="ZSY"  D
"RTN","ORMFN",59,0)
 . . . S X=$P(@ORMSG@(ZSY),"|",3),LAST=ZSY
"RTN","ORMFN",60,0)
 . . . K DD,DO D:$L(X) FILE^DICN
"RTN","ORMFN",61,0)
NTE . K ^ORD(101.43,ORDIFN,8) ; replace text
"RTN","ORMFN",62,0)
 . S NEXT=$O(@ORMSG@(LAST)) I NEXT,$E(@ORMSG@(NEXT),1,3)="NTE" D
"RTN","ORMFN",63,0)
 . . S NTE=LAST,DA=0
"RTN","ORMFN",64,0)
 . . F  S NTE=$O(@ORMSG@(NTE)) Q:NTE'>0  Q:$E(@ORMSG@(NTE),1,3)'="NTE"  S DA=DA+1,^ORD(101.43,ORDIFN,8,DA,0)=$P(@ORMSG@(NTE),"|",4) I $O(@ORMSG@(NTE,0)) D
"RTN","ORMFN",65,0)
 . . . S I=0 F  S I=$O(@ORMSG@(NTE,I)) Q:I'>0  S DA=DA+1,^ORD(101.43,ORDIFN,8,DA,0)=@ORMSG@(NTE,I)
"RTN","ORMFN",66,0)
 . . S ^ORD(101.43,ORDIFN,8,0)="^^"_DA_U_DA_U_DT_U
"RTN","ORMFN",67,0)
 . I '$D(^TMP($J,"OR OI NEW",ORDIFN)) M ^TMP($J,"OR OI AFTER",ORDIFN)=^ORD(101.43,ORDIFN)
"RTN","ORMFN",68,0)
 Q
"RTN","ORMFN",69,0)
 ;
"RTN","ORMFN",70,0)
NMSP(NAME) ; -- returns namespace for package
"RTN","ORMFN",71,0)
 I NAME="RADIOLOGY" Q "RA"
"RTN","ORMFN",72,0)
 I NAME="IMAGING" Q "RA"
"RTN","ORMFN",73,0)
 I NAME="LABORATORY" Q "LR"
"RTN","ORMFN",74,0)
 I NAME="DIETETICS" Q "FH"
"RTN","ORMFN",75,0)
 I NAME="PHARMACY" Q "PS"
"RTN","ORMFN",76,0)
 I NAME="CONSULTS" Q "CS"
"RTN","ORMFN",77,0)
 I NAME="PROCEDURES" Q "CS"
"RTN","ORMFN",78,0)
 Q ""
"RTN","ORMFN",79,0)
 ;
"RTN","ORMFN",80,0)
CREATE(X) ; -- Create new item in #101.43
"RTN","ORMFN",81,0)
 Q:'$L($G(X)) 0 N HDR,LAST,TOTAL,I
"RTN","ORMFN",82,0)
 L +^ORD(101.43,0):1 Q:'$T 0
"RTN","ORMFN",83,0)
 S HDR=$G(^ORD(101.43,0)) Q:HDR="" 0
"RTN","ORMFN",84,0)
 S LAST=$P(HDR,U,3),TOTAL=$P(HDR,U,4)
"RTN","ORMFN",85,0)
 F I=(LAST+1):1 Q:'$D(^ORD(101.43,I,0))
"RTN","ORMFN",86,0)
 S ^ORD(101.43,I,0)=X,X=$E(X,1,30),^ORD(101.43,"B",$$UP^XLFSTR(X),I)=""
"RTN","ORMFN",87,0)
 S $P(^ORD(101.43,0),U,3,4)=I_U_(TOTAL+1)
"RTN","ORMFN",88,0)
 L -^ORD(101.43,0)
"RTN","ORMFN",89,0)
 Q I
"RTN","ORMFN",90,0)
 ;
"RTN","ORMFN",91,0)
FH ; -- Dietetics
"RTN","ORMFN",92,0)
 S X=$P(ZPKG,"|",2),ORFLD(111.1)=$S(X="":"@",1:X)
"RTN","ORMFN",93,0)
 S X=$P(ZPKG,"|",3),ORFLD(111.2)=$S(X="":"@",1:X)
"RTN","ORMFN",94,0)
 S X=$P(ZPKG,"|",5),ORFLD(111.3)=$S(X="":"@",1:X)
"RTN","ORMFN",95,0)
 F NUM=111.1,111.2,111.3 D VAL^DIE(101.43,ORFIEN,NUM,"F",ORFLD(NUM),.ORY,"ORFDA")
"RTN","ORMFN",96,0)
 K ^ORD(101.43,ORDIFN,8) S X=$P(ZPKG,"|",4)
"RTN","ORMFN",97,0)
 I $L(X) S ^ORD(101.43,ORDIFN,8,0)="^^1^1^"_DT_U,^(1,0)=X
"RTN","ORMFN",98,0)
 Q
"RTN","ORMFN",99,0)
 ;
"RTN","ORMFN",100,0)
LR ; -- Laboratory
"RTN","ORMFN",101,0)
 S X=$P(ZPKG,"|",2),ORFLD(60.1)=$S(X="":"@",1:X)
"RTN","ORMFN",102,0)
 S X=$P(ZPKG,"|",3),ORFLD(60.2)=$S(X="":"@",1:X)
"RTN","ORMFN",103,0)
 ;S X=$P(ZPKG,"|",4),ORFLD(60.3)=$S(X="":"@",1:X)
"RTN","ORMFN",104,0)
 S X=$P(ZPKG,"|",5),ORFLD(60.6)=$S(X="":"@",1:X)
"RTN","ORMFN",105,0)
 S X=$P(ZPKG,"|",6),ORFLD(60.4)=$S(X="":"@",1:X)
"RTN","ORMFN",106,0)
 S X=$P(ZPKG,"|",7),ORFLD(60.5)=$S(X="":"@",1:X)
"RTN","ORMFN",107,0)
 S X=$P(ZPKG,"|",8),ORFLD(6)=$S(X="":"@",1:X)
"RTN","ORMFN",108,0)
 S X=$P(ZPKG,"|",9),ORFLD(60.7)=$S(X="":"@",1:X)
"RTN","ORMFN",109,0)
 F NUM=6,60.1,60.2,60.4,60.5,60.6,60.7 D VAL^DIE(101.43,ORFIEN,NUM,"F",ORFLD(NUM),.ORY,"ORFDA")
"RTN","ORMFN",110,0)
 Q
"RTN","ORMFN",111,0)
 ;
"RTN","ORMFN",112,0)
PS ; -- Pharmacy
"RTN","ORMFN",113,0)
 N ROUTE,PSO,S3,ORPSVAC,ORPSOI
"RTN","ORMFN",114,0)
 K ^TMP("$J","ORMFN")
"RTN","ORMFN",115,0)
 S X=$P(ZPKG,"|",2)
"RTN","ORMFN",116,0)
 ;S ORFDA(101.43,ORFIEN,50.1)=$S(X'["I":0,$L($P($P(ORDITEM,U,5),"~",3)):2,1:1)
"RTN","ORMFN",117,0)
 S ORFDA(101.43,ORFIEN,50.1)=$S(X["V":2,X["I":1,1:0) ;inpt or iv med
"RTN","ORMFN",118,0)
 S ORFDA(101.43,ORFIEN,50.2)=(X["O") ;outpt med
"RTN","ORMFN",119,0)
 S ORFDA(101.43,ORFIEN,50.3)=(X["B") ;fluid base/soln
"RTN","ORMFN",120,0)
 S ORFDA(101.43,ORFIEN,50.4)=(X["A") ;fluid additive
"RTN","ORMFN",121,0)
 S ORFDA(101.43,ORFIEN,50.7)=(X["N") ;non-VA med
"RTN","ORMFN",122,0)
 ;Supply Items
"RTN","ORMFN",123,0)
 D
"RTN","ORMFN",124,0)
 . S ORPSOI=+$P($P(MFE,"|",5),"^",4) D DRGIEN^PSS50P7(ORPSOI,"","ORMFN")
"RTN","ORMFN",125,0)
 . I ^TMP($J,"ORMFN",0)'>0 Q
"RTN","ORMFN",126,0)
 . S S3=0,ORFDA(101.43,ORFIEN,50.5)=0
"RTN","ORMFN",127,0)
 . F  S S3=$O(^TMP($J,"ORMFN",S3)) Q:'S3  D
"RTN","ORMFN",128,0)
 .. D ZERO^PSS50(S3,,,,,"ORMFN")
"RTN","ORMFN",129,0)
 .. I ^TMP($J,"ORMFN",0)'>0 Q
"RTN","ORMFN",130,0)
 .. S ORPSVAC=$G(^TMP($J,"ORMFN",S3,2))
"RTN","ORMFN",131,0)
 .. I ORPSVAC?1"XA".E!(ORPSVAC?1"XX".E)!(ORPSVAC="DX900"&($G(^TMP($J,"ORMFN",S3,3))["S")) S ORFDA(101.43,ORFIEN,50.5)=1
"RTN","ORMFN",132,0)
 S X=$P(ZPKG,"|",3),ORFDA(101.43,ORFIEN,50.6)=$S(X:1,1:0)
"RTN","ORMFN",133,0)
 ;Check for default med route
"RTN","ORMFN",134,0)
 ;S ROUTE=$$MEDROUTE
"RTN","ORMFN",135,0)
 ;I ROUTE>0 S ORFDA(101.43,ORFIEN,50.8)=ROUTE
"RTN","ORMFN",136,0)
 Q
"RTN","ORMFN",137,0)
 ;
"RTN","ORMFN",138,0)
MEDROUTE() ;
"RTN","ORMFN",139,0)
 N CNT,ROUTE
"RTN","ORMFN",140,0)
 S CNT=0,ROUTE=0
"RTN","ORMFN",141,0)
 F  S CNT=$O(@ORMSG@(CNT)) Q:CNT'>0  D
"RTN","ORMFN",142,0)
 .I $P($G(@ORMSG@(CNT)),"|")'="ZPB" Q
"RTN","ORMFN",143,0)
 .S ROUTE=+$P($G(@ORMSG@(CNT)),"|",4)
"RTN","ORMFN",144,0)
 Q ROUTE
"RTN","ORMFN",145,0)
 ;
"RTN","ORMFN",146,0)
RA ; -- Radiology/Nuc Medicine
"RTN","ORMFN",147,0)
 S X=$P(ZPKG,"|",4),ORFLD(6)=$S(X="":"@",1:X)
"RTN","ORMFN",148,0)
 S X=$P(ZPKG,"|",5),ORFLD(71.1)=$S(X="":"@",1:X)
"RTN","ORMFN",149,0)
 S X=$P(ZPKG,"|",7),ORFLD(71.2)=$S(X="":"@",1:X)
"RTN","ORMFN",150,0)
 S X=$P(ZPKG,"|",2),ORFLD(71.3)=$S(X="":"@",1:X)
"RTN","ORMFN",151,0)
 S ORFLD(71.4)=$S($P(ZPKG,"|",6)="Y":1,1:0)
"RTN","ORMFN",152,0)
 S ORFLD(7)=$S($P(ZPKG,"|",3)="Y":2,1:1)
"RTN","ORMFN",153,0)
 F NUM=6,7,71.1,71.2,71.3,71.4 D VAL^DIE(101.43,ORFIEN,NUM,"F",ORFLD(NUM),.ORY,"ORFDA")
"RTN","ORMFN",154,0)
 Q
"RTN","ORMFN",155,0)
 ;
"RTN","ORMFN",156,0)
CS ; -- Consults/Requests
"RTN","ORMFN",157,0)
 S X=$P(ZPKG,"|",2),ORFLD(123.1)=$S(X="":"@",1:X)
"RTN","ORMFN",158,0)
 D VAL^DIE(101.43,ORFIEN,123.1,"F",ORFLD(123.1),.ORY,"ORFDA")
"RTN","ORMFN",159,0)
 Q
"RTN","ORMGMRC")
0^74^B45026486
"RTN","ORMGMRC",1,0)
ORMGMRC ; SLC/MKB - Process Consult ORM msgs ;02/23/15  06:26
"RTN","ORMGMRC",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**3,26,68,92,153,174,195,255,243,280,350**;Dec 17, 1997;Build 77
"RTN","ORMGMRC",3,0)
EN ; -- entry point for GMRC messges
"RTN","ORMGMRC",4,0)
 I '$L($T(@ORDCNTRL)) Q  ;S ORERR="Invalid order control code" Q
"RTN","ORMGMRC",5,0)
 I ORDCNTRL'="SN",ORDCNTRL'="ZP",'ORIFN!('$D(^OR(100,+ORIFN,0))) S ORERR="Invalid OE/RR order number" Q
"RTN","ORMGMRC",6,0)
 S:ORDCNTRL="OC"&(ORTYPE="ORR") ORDCNTRL="UA" ;new code
"RTN","ORMGMRC",7,0)
 N ORSTS,OREASON1,NTE S ORSTS=$$STATUS(ORDSTS)
"RTN","ORMGMRC",8,0)
 S:'ORLOG ORLOG=$$NOW^XLFDT S:'ORDUZ ORDUZ=DUZ S:$G(DGPMT) ORDUZ=""
"RTN","ORMGMRC",9,0)
 S OREASON=$P(OREASON,U,5),NTE=$O(@ORMSG@(+ORC)),OREASON1=""
"RTN","ORMGMRC",10,0)
 I NTE,$E(@ORMSG@(NTE),1,3)="NTE" S OREASON1=$P(@ORMSG@(NTE),"|",4)
"RTN","ORMGMRC",11,0)
 D @ORDCNTRL
"RTN","ORMGMRC",12,0)
 Q
"RTN","ORMGMRC",13,0)
 ;
"RTN","ORMGMRC",14,0)
ZP ; -- Purged
"RTN","ORMGMRC",15,0)
 Q:'ORIFN  Q:'$D(^OR(100,+ORIFN,0))
"RTN","ORMGMRC",16,0)
 K ^OR(100,+ORIFN,4) I "^3^5^6^8^"[(U_$P($G(^(3)),U,3)_U) D STATUS^ORCSAVE2(+ORIFN,14) ; Remove pkg reference, sts=lapsed if still active
"RTN","ORMGMRC",17,0)
 Q
"RTN","ORMGMRC",18,0)
 ;
"RTN","ORMGMRC",19,0)
ZR ; -- Purged as requested [ack]
"RTN","ORMGMRC",20,0)
 D DELETE^ORCSAVE2(+ORIFN)
"RTN","ORMGMRC",21,0)
 Q
"RTN","ORMGMRC",22,0)
 ;
"RTN","ORMGMRC",23,0)
ZU ; -- Unable to purge [ack]
"RTN","ORMGMRC",24,0)
 S $P(^OR(100,+ORIFN,3),U)=$$NOW^XLFDT ; update Last Activity
"RTN","ORMGMRC",25,0)
 Q
"RTN","ORMGMRC",26,0)
 ;
"RTN","ORMGMRC",27,0)
OK ; -- Order accepted, GMRC order # assigned [ack]
"RTN","ORMGMRC",28,0)
 S ^OR(100,+ORIFN,4)=PKGIFN S:'$G(ORSTS) ORSTS=5
"RTN","ORMGMRC",29,0)
 D STATUS^ORCSAVE2(+ORIFN,ORSTS) ; 5=pending
"RTN","ORMGMRC",30,0)
 D DATES^ORCSAVE2(+ORIFN,+$E($$NOW^XLFDT,1,12))
"RTN","ORMGMRC",31,0)
 Q
"RTN","ORMGMRC",32,0)
 ;
"RTN","ORMGMRC",33,0)
XX ; -- Change order
"RTN","ORMGMRC",34,0)
 N ORDIALOG,ORDG,ORDA,ORX,ORP,ORSIG S:'$L(ORNATR) ORNATR="S"
"RTN","ORMGMRC",35,0)
 D DLG Q:$D(ORERR)  Q:'$D(ORDIALOG)  S ORIFN=+ORIFN
"RTN","ORMGMRC",36,0)
 S ORDA=$$ACTION^ORCSAVE("XX",ORIFN,ORNP,OREASON1,ORLOG,ORDUZ)
"RTN","ORMGMRC",37,0)
 I ORDA'>0 S ORERR="Cannot create new order action" Q
"RTN","ORMGMRC",38,0)
 ; -Update sts of order to active, last action to dc/edit:
"RTN","ORMGMRC",39,0)
 S ORX=+$P($G(^OR(100,ORIFN,3)),U,7) S:ORX'>0 ORX=+$O(^(8,ORDA),-1)
"RTN","ORMGMRC",40,0)
 I $D(^OR(100,ORIFN,8,ORX,0)),$P(^(0),U,15)="" S $P(^(0),U,15)=12
"RTN","ORMGMRC",41,0)
 S $P(^OR(100,ORIFN,3),U,7)=ORDA D:$G(ORSTS) STATUS^ORCSAVE2(ORIFN,ORSTS)
"RTN","ORMGMRC",42,0)
 D PXRMKILL^ORDD100(ORIFN,ORVP,ORLOG) ; JEH 255
"RTN","ORMGMRC",43,0)
 D RELEASE^ORCSAVE2(ORIFN,ORDA,ORLOG,ORDUZ,ORNATR)
"RTN","ORMGMRC",44,0)
 ; -If unsigned edit, leave XX unsigned & mark ORX as Sig Not Req'd
"RTN","ORMGMRC",45,0)
 S ORSIG=$S($P($G(^OR(100,ORIFN,8,ORX,0)),U,4)'=2:1,1:0)
"RTN","ORMGMRC",46,0)
 D SIGSTS^ORCSAVE2(ORIFN,ORDA):ORSIG,SIGN^ORCSAVE2(ORIFN,,,5,ORX):'ORSIG
"RTN","ORMGMRC",47,0)
 ; -Update responses, get/save new order text:
"RTN","ORMGMRC",48,0)
 K ^OR(100,ORIFN,4.5) D RESPONSE^ORCSAVE,ORDTEXT^ORCSAVE1(ORIFN_";"_ORDA)
"RTN","ORMGMRC",49,0)
 S $P(^OR(100,ORIFN,8,ORDA,0),U,14)=ORDA
"RTN","ORMGMRC",50,0)
 K:OREASON="RESUBMIT" ^OR(100,ORIFN,6) ;clear previous DC data
"RTN","ORMGMRC",51,0)
 D PXRMADD^ORDD100(ORIFN,ORVP,ORLOG) ; JEH 255
"RTN","ORMGMRC",52,0)
 I $G(ORL) S ORP(1)=+ORIFN_";"_ORDA_"^1" D PRINTS^ORWD1(.ORP,+ORL)
"RTN","ORMGMRC",53,0)
 Q
"RTN","ORMGMRC",54,0)
 ;
"RTN","ORMGMRC",55,0)
SN ; -- New backdoor order: return NA msg w/ORIFN, or DE msg
"RTN","ORMGMRC",56,0)
 N ORDIALOG,ORDG,ORP K ^TMP("ORWORD",$J) S:'$L(ORNATR) ORNATR="W"
"RTN","ORMGMRC",57,0)
 I '$D(^VA(200,ORNP,0)) S ORERR="Missing or invalid ordering provider" Q
"RTN","ORMGMRC",58,0)
 I ORDUZ,'$D(^VA(200,ORDUZ,0)) S ORERR="Invalid entering person" Q
"RTN","ORMGMRC",59,0)
 I '$G(ORL) S ORERR="Missing or invalid patient location" Q
"RTN","ORMGMRC",60,0)
 D DLG Q:$D(ORERR)  Q:'$D(ORDIALOG)
"RTN","ORMGMRC",61,0)
SN1 D EN^ORCSAVE K ^TMP("ORWORD",$J) ; setting status, xrefs
"RTN","ORMGMRC",62,0)
 I '$G(ORIFN) S ORERR="Cannot create new order" Q
"RTN","ORMGMRC",63,0)
 ;Save DG1 and ZCL segments of HL7 message from backdoor orders
"RTN","ORMGMRC",64,0)
 D BDOSTR^ORWDBA3
"RTN","ORMGMRC",65,0)
 D RELEASE^ORCSAVE2(ORIFN,1,ORLOG,ORDUZ,ORNATR),SIGSTS^ORCSAVE2(ORIFN,1)
"RTN","ORMGMRC",66,0)
 S:'ORSTRT ORSTRT=$$NOW^XLFDT D DATES^ORCSAVE2(+ORIFN,ORSTRT)
"RTN","ORMGMRC",67,0)
 D:$G(ORSTS) STATUS^ORCSAVE2(ORIFN,ORSTS)
"RTN","ORMGMRC",68,0)
 I $G(ORL) S ORP(1)=ORIFN_";1^1" D PRINTS^ORWD1(.ORP,+ORL) ; chart copy
"RTN","ORMGMRC",69,0)
 S ^OR(100,ORIFN,4)=PKGIFN
"RTN","ORMGMRC",70,0)
 Q
"RTN","ORMGMRC",71,0)
 ;
"RTN","ORMGMRC",72,0)
DLG ; -- Build ORDIALOG(),ORDG from msg
"RTN","ORMGMRC",73,0)
 N OBR,USID,TYPE,OI,ZSV,J,OBX,WP,I
"RTN","ORMGMRC",74,0)
 S OBR=$$OBR I 'OBR!($E($G(@ORMSG@(OBR)),1,3)'="OBR") S ORERR="Missing OBR segment" Q
"RTN","ORMGMRC",75,0)
 S USID=$P(@ORMSG@(OBR),"|",5),TYPE=$S(USID["99CON":"CONSULT",1:"REQUEST")
"RTN","ORMGMRC",76,0)
 S ORDIALOG=$O(^ORD(101.41,"AB","GMRCOR "_TYPE,0))
"RTN","ORMGMRC",77,0)
 D GETDLG1^ORCD(ORDIALOG)
"RTN","ORMGMRC",78,0)
 S ORDIALOG($$PTR("URGENCY"),1)=ORURG
"RTN","ORMGMRC",79,0)
 ;ORSTRT defined in routine ORM before coming here ;WAT/280
"RTN","ORMGMRC",80,0)
 S ORDIALOG($$PTR("CLINICALLY INDICATED DATE"),1)=ORSTRT ;WAT/280/350
"RTN","ORMGMRC",81,0)
 S OI=$$ORDITEM^ORM(USID) I 'OI S ORERR="Invalid consult or procedure" Q
"RTN","ORMGMRC",82,0)
 S ORDIALOG($$PTR("ORDERABLE ITEM"),1)=OI
"RTN","ORMGMRC",83,0)
 S ZSV=$O(@ORMSG@(OBR)) I ZSV,$E(@ORMSG@(ZSV),1,3)="ZSV" D
"RTN","ORMGMRC",84,0)
 . N X1,X2 S X1=$P(@ORMSG@(ZSV),"|",2),X2=$P(@ORMSG@(ZSV),"|",3)
"RTN","ORMGMRC",85,0)
 . I TYPE="REQUEST" S ORDIALOG($$PTR("REQUEST SERVICE"),1)=+$P(X1,U,4)
"RTN","ORMGMRC",86,0)
 . I TYPE="CONSULT",$L(X2) S ORDIALOG($$PTR("FREE TEXT OI"),1)=X2
"RTN","ORMGMRC",87,0)
D1 S ORDIALOG($$PTR("CATEGORY"),1)=$G(ORCAT)
"RTN","ORMGMRC",88,0)
 S J=$P(@ORMSG@(OBR),"|",19),ORDIALOG($$PTR("PLACE OF CONSULTATION"),1)=$S(J="OC":"C",1:J)
"RTN","ORMGMRC",89,0)
 S ORDIALOG($$PTR("PROVIDER"),1)=$P(@ORMSG@(OBR),"|",20)
"RTN","ORMGMRC",90,0)
 S OBX=OBR F  S OBX=$O(@ORMSG@(OBX)) Q:OBX'>0  S J=$E(@ORMSG@(OBX),1,3) Q:J="ORC"  Q:J="MSH"  I J="OBX" D
"RTN","ORMGMRC",91,0)
 . N SEG,NAME,VALUE S SEG=@ORMSG@(OBX)
"RTN","ORMGMRC",92,0)
 . S NAME=$$UP^XLFSTR($P($P(SEG,"|",4),U,2)),VALUE=$P(SEG,"|",6)
"RTN","ORMGMRC",93,0)
 . I NAME="PROVISIONAL DIAGNOSIS" D  Q
"RTN","ORMGMRC",94,0)
 .. S:$P(SEG,"|",3)="CE" ORDIALOG($$PTR("CODE"),1)=$P(VALUE,U),VALUE=$P(VALUE,U,2)
"RTN","ORMGMRC",95,0)
 .. S ORDIALOG($$PTR("FREE TEXT"),1)=VALUE
"RTN","ORMGMRC",96,0)
 . S WP=$$PTR("WORD PROCESSING 1"),I=1,^TMP("ORWORD",$J,WP,1,I,0)=VALUE
"RTN","ORMGMRC",97,0)
 . S J=0 F  S J=$O(@ORMSG@(OBX,J)) Q:J'>0  S I=I+1,^TMP("ORWORD",$J,WP,1,I,0)=@ORMSG@(OBX,J)
"RTN","ORMGMRC",98,0)
 S:$G(I) ^TMP("ORWORD",$J,WP,1,0)="^^"_I_U_I_U_DT_U,ORDIALOG(WP,1)="^TMP(""ORWORD"",$J,"_WP_",1)"
"RTN","ORMGMRC",99,0)
 Q
"RTN","ORMGMRC",100,0)
 ;
"RTN","ORMGMRC",101,0)
OBR() ; -- Return subscript of RXE segment
"RTN","ORMGMRC",102,0)
 N X,I,SEG S X="",I=+ORC
"RTN","ORMGMRC",103,0)
 F  S I=$O(@ORMSG@(I)) Q:I'>0  S SEG=$E(@ORMSG@(I),1,3) Q:SEG="ORC"  I SEG="OBR" S X=I Q
"RTN","ORMGMRC",104,0)
 Q X
"RTN","ORMGMRC",105,0)
 ;
"RTN","ORMGMRC",106,0)
SC ; -- Status changed (i.e. scheduled)
"RTN","ORMGMRC",107,0)
 S:'$G(ORSTS) ORSTS=6 D STATUS^ORCSAVE2(+ORIFN,ORSTS) ; 6=active
"RTN","ORMGMRC",108,0)
 Q
"RTN","ORMGMRC",109,0)
 ;
"RTN","ORMGMRC",110,0)
STATUS(X) ; -- Returns ptr to Order Status file #100.01
"RTN","ORMGMRC",111,0)
 Q $S(X="DC":1,X="CM":2,X="HD":3,X="IP":5,X="SC":6,X="A":9,X="RP":12,X="CA":13,X="ZC":8,1:5)
"RTN","ORMGMRC",112,0)
 ;
"RTN","ORMGMRC",113,0)
RE ; -- Completed, w/results
"RTN","ORMGMRC",114,0)
 N I,SEG,DA,DR,DIE,X,Y
"RTN","ORMGMRC",115,0)
 S:'$G(ORSTS) ORSTS=2 D STATUS^ORCSAVE2(+ORIFN,ORSTS)
"RTN","ORMGMRC",116,0)
 S X="",DA=+ORIFN,DIE="^OR(100,"
"RTN","ORMGMRC",117,0)
 S DR="71////"_+$E($$NOW^XLFDT,1,12) D ^DIE
"RTN","ORMGMRC",118,0)
 S I=+ORC,X="" F  S I=$O(@ORMSG@(I)) Q:I<1  S SEG=$G(@ORMSG@(I)) Q:$E(SEG,1,3)="ORC"  I $E(SEG,1,3)="OBX",$P(SEG,"|",4)["SIG FINDINGS" S X=$P(SEG,"|",6) Q
"RTN","ORMGMRC",119,0)
 S $P(^OR(100,DA,7),U,2)=$S(X="Y":1,1:"")
"RTN","ORMGMRC",120,0)
 S:'$G(ORNP) ORNP=+$P($G(^OR(100,+ORIFN,0)),U,4)
"RTN","ORMGMRC",121,0)
 I $P(ORC,"|",17)["MAINTENANCE" Q  ;group update - no CM ack needed
"RTN","ORMGMRC",122,0)
 I $L($T(ADD^ORRCACK)) D ADD^ORRCACK(+ORIFN,ORNP) ;Ack stub for prov
"RTN","ORMGMRC",123,0)
 Q
"RTN","ORMGMRC",124,0)
 ;
"RTN","ORMGMRC",125,0)
UA ; -- Unable to Accept [ack]
"RTN","ORMGMRC",126,0)
 S ORDUZ="" I '$L(OREASON1),$L(OREASON) S OREASON1=OREASON
"RTN","ORMGMRC",127,0)
 ;Q  ;WAT TESTING 10/22/13
"RTN","ORMGMRC",128,0)
OC ; -- Cancelled/Denied
"RTN","ORMGMRC",129,0)
 S:'$L(ORNATR) ORNATR="X" ;Rejected
"RTN","ORMGMRC",130,0)
 S ^OR(100,+ORIFN,6)=$O(^ORD(100.02,"C",ORNATR,0))_U_ORDUZ_U_ORLOG_U_U_OREASON1
"RTN","ORMGMRC",131,0)
 D STATUS^ORCSAVE2(+ORIFN,13) I ORDCNTRL="OC" D UPDATE("DC") Q
"RTN","ORMGMRC",132,0)
UD ; -- Unable to discontinue [ack]
"RTN","ORMGMRC",133,0)
 N DA S DA=$P(ORIFN,";",2) I DA D
"RTN","ORMGMRC",134,0)
 . S $P(^OR(100,+ORIFN,8,DA,0),U,15)=13 ;request rejected
"RTN","ORMGMRC",135,0)
 . S:$L(OREASON1) ^OR(100,+ORIFN,8,DA,1)=OREASON1
"RTN","ORMGMRC",136,0)
 Q
"RTN","ORMGMRC",137,0)
 ;
"RTN","ORMGMRC",138,0)
OD ; -- Discontinued
"RTN","ORMGMRC",139,0)
 S ^OR(100,+ORIFN,6)=$S($L(ORNATR):$O(^ORD(100.02,"C",ORNATR,0)),1:"")_U_ORDUZ_U_ORLOG_U_U_OREASON1
"RTN","ORMGMRC",140,0)
 D STATUS^ORCSAVE2(+ORIFN,1),UPDATE("DC"):$L(ORNATR)
"RTN","ORMGMRC",141,0)
 Q
"RTN","ORMGMRC",142,0)
 ;
"RTN","ORMGMRC",143,0)
DR ; -- Discontinued [ack]
"RTN","ORMGMRC",144,0)
 D STATUS^ORCSAVE2(+ORIFN,1)
"RTN","ORMGMRC",145,0)
 Q
"RTN","ORMGMRC",146,0)
 ;
"RTN","ORMGMRC",147,0)
UPDATE(ORACT) ; -- continue processing
"RTN","ORMGMRC",148,0)
 N ORX,ORDA,ORP
"RTN","ORMGMRC",149,0)
 S ORX=$$CREATE^ORX1(ORNATR) D:ORX
"RTN","ORMGMRC",150,0)
 . S ORDA=$$ACTION^ORCSAVE(ORACT,+ORIFN,ORNP,OREASON1,ORLOG,ORDUZ)
"RTN","ORMGMRC",151,0)
 . I ORDA'>0 S ORERR="Cannot create new order action" Q
"RTN","ORMGMRC",152,0)
 . D RELEASE^ORCSAVE2(+ORIFN,ORDA,ORLOG,ORDUZ,ORNATR)
"RTN","ORMGMRC",153,0)
 . D SIGSTS^ORCSAVE2(+ORIFN,ORDA)
"RTN","ORMGMRC",154,0)
 . I $G(ORL) S ORP(1)=+ORIFN_";"_ORDA_"^1" D PRINTS^ORWD1(.ORP,+ORL)
"RTN","ORMGMRC",155,0)
 . S $P(^OR(100,+ORIFN,3),U,7)=ORDA
"RTN","ORMGMRC",156,0)
 I 'ORX,ORACT="DC",'$$ACTV^ORX1(ORNATR) S $P(^OR(100,+ORIFN,3),U,7)=0
"RTN","ORMGMRC",157,0)
 D:$G(ORACT)="DC" CANCEL^ORCSEND(+ORIFN)
"RTN","ORMGMRC",158,0)
 Q
"RTN","ORMGMRC",159,0)
 ;
"RTN","ORMGMRC",160,0)
PTR(X) ; -- Returns ptr to prompt in Order Dialog file #101.41
"RTN","ORMGMRC",161,0)
 Q $O(^ORD(101.41,"AB",$E("OR GTX "_X,1,63),0))
"RTN","ORMPS")
0^8^B86715269
"RTN","ORMPS",1,0)
ORMPS ; SLC/MKB/TC - Process Pharmacy ORM msgs ;10/16/14  07:34
"RTN","ORMPS",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**3,54,62,86,92,94,116,138,152,141,165,149,213,195,243,306,350**;Dec 17, 1997;Build 77
"RTN","ORMPS",3,0)
 ;
"RTN","ORMPS",4,0)
EN ; -- entry point
"RTN","ORMPS",5,0)
 I '$L($T(@ORDCNTRL)) Q  ;S ORERR="Invalid order control code" Q
"RTN","ORMPS",6,0)
 I ORDCNTRL'="SN",ORDCNTRL'="ZC",ORDCNTRL'="ZP",'ORIFN!('$D(^OR(100,+ORIFN,0))) S ORERR="Invalid OE/RR order number" Q
"RTN","ORMPS",7,0)
 N ORSTS,RXE,ZRX,ORWHO,ORNOW
"RTN","ORMPS",8,0)
 S ORSTS=$$STATUS(ORDSTS),RXE=$$RXE,ZRX=$$ZRX D QT^ORMPS1 ;QT in RXE
"RTN","ORMPS",9,0)
 S ORNOW=+$E($$NOW^XLFDT,1,12),ORWHO=+$P(ZRX,"|",6) S:'ORWHO ORWHO=DUZ
"RTN","ORMPS",10,0)
 S:ORLOG ORLOG=+$E(ORLOG,1,12) ;no seconds
"RTN","ORMPS",11,0)
 S:'$L(ORNATR) ORNATR=$P(ZRX,"|",3) S:OREASON["^" OREASON=$P(OREASON,U,5)
"RTN","ORMPS",12,0)
 I ORNATR="D",'$L(OREASON) S OREASON="DUPLICATE"
"RTN","ORMPS",13,0)
 D @ORDCNTRL
"RTN","ORMPS",14,0)
 Q
"RTN","ORMPS",15,0)
 ;
"RTN","ORMPS",16,0)
ZV ; -- Verified
"RTN","ORMPS",17,0)
 N ORUSR,ORVER,ORDA,ORES,ORI
"RTN","ORMPS",18,0)
 S ORUSR=+$P(ORC,"|",12),ORVER="N" Q:'ORUSR
"RTN","ORMPS",19,0)
 S ORDA=+$P($G(^OR(100,+ORIFN,3)),U,7),ORES(+ORIFN_";"_ORDA)=""
"RTN","ORMPS",20,0)
 Q:$P($G(^OR(100,+ORIFN,8,ORDA,0)),U,8)  ;already verified
"RTN","ORMPS",21,0)
 D REPLCD^ORCACT1 ;get unverified replaced orders
"RTN","ORMPS",22,0)
 S ORI="" F  S ORI=$O(ORES(ORI)) Q:ORI=""  D
"RTN","ORMPS",23,0)
 . S ORDA=+$P(ORI,";",2)
"RTN","ORMPS",24,0)
 . D VERIFY^ORCSAVE2(+ORI,ORDA,"N",ORUSR,ORLOG)
"RTN","ORMPS",25,0)
 Q
"RTN","ORMPS",26,0)
 ;
"RTN","ORMPS",27,0)
ZP ; -- Purged
"RTN","ORMPS",28,0)
 Q:'ORIFN  Q:'$D(^OR(100,+ORIFN,0))
"RTN","ORMPS",29,0)
 K ^OR(100,+ORIFN,4) I "^3^5^6^15^"[(U_$P($G(^(3)),U,3)_U) D STATUS^ORCSAVE2(+ORIFN,14) ;Remove pkg reference, sts=lapsed if still active
"RTN","ORMPS",30,0)
 Q
"RTN","ORMPS",31,0)
 ;
"RTN","ORMPS",32,0)
ZR ; -- Purged as requested [ack]
"RTN","ORMPS",33,0)
 D DELETE^ORCSAVE2(+ORIFN)
"RTN","ORMPS",34,0)
 Q
"RTN","ORMPS",35,0)
 ;
"RTN","ORMPS",36,0)
ZU ; -- Unable to purge [ack]
"RTN","ORMPS",37,0)
 S $P(^OR(100,+ORIFN,3),U)=$$NOW^XLFDT ;update Last Activity
"RTN","ORMPS",38,0)
 Q
"RTN","ORMPS",39,0)
 ;
"RTN","ORMPS",40,0)
XR ; -- Changed as requested [ack]
"RTN","ORMPS",41,0)
 N ORIG S ORIG=$P(^OR(100,+ORIFN,3),U,5) I ORIG,$P(^OR(100,ORIG,3),U,3)'=12 D STATUS^ORCSAVE2(ORIG,12)
"RTN","ORMPS",42,0)
OK ; -- Order accepted, PS order # assigned [ack]
"RTN","ORMPS",43,0)
 S ^OR(100,+ORIFN,4)=PKGIFN ;PS identifier
"RTN","ORMPS",44,0)
 D:ORSTS STATUS^ORCSAVE2(+ORIFN,ORSTS)
"RTN","ORMPS",45,0)
 Q
"RTN","ORMPS",46,0)
 ;
"RTN","ORMPS",47,0)
ZC ; -- convert orders
"RTN","ORMPS",48,0)
 N RXO,RXC,ORDIALOG,ORDG,ORPKG,ORP,ORSIG,ORIG,TYPE,EVNT
"RTN","ORMPS",49,0)
 I '$D(^VA(200,ORDUZ,0)) S ORERR="Missing or invalid entering person" Q
"RTN","ORMPS",50,0)
 I '$D(^VA(200,ORNP,0)) S ORERR="Missing or invalid ordering provider" Q
"RTN","ORMPS",51,0)
 I 'RXE S ORERR="Missing or invalid RXE segment" Q
"RTN","ORMPS",52,0)
 S RXO=$$RXO,RXC=$$RXC K ^TMP("ORWORD",$J)
"RTN","ORMPS",53,0)
 D @($S(RXC:"IV",$G(ORCAT)="I":"UDOSE",1:"OUT")_"^ORMPS1")
"RTN","ORMPS",54,0)
ZC1 ; continue
"RTN","ORMPS",55,0)
 Q:$D(ORERR)  I 'ORIFN!('$D(^OR(100,+ORIFN,0))) D  Q  ;create
"RTN","ORMPS",56,0)
 . K ORIFN D SN1 Q:'$G(ORIFN)  S ORDCNTRL="SN"
"RTN","ORMPS",57,0)
 . I ORSTOP,ORSTOP<ORNOW S $P(^OR(100,ORIFN,3),U)=ORSTOP
"RTN","ORMPS",58,0)
 S ORIFN=+ORIFN D RESPONSE^ORCSAVE K ^TMP("ORWORD",$J)
"RTN","ORMPS",59,0)
 S ^OR(100,ORIFN,4)=PKGIFN,$P(^(0),U,5)=+ORDIALOG_";ORD(101.41,"
"RTN","ORMPS",60,0)
 D DATES^ORCSAVE2(ORIFN,ORSTRT,ORSTOP),STATUS^ORCSAVE2(ORIFN,ORSTS):ORSTS
"RTN","ORMPS",61,0)
 Q
"RTN","ORMPS",62,0)
 ;
"RTN","ORMPS",63,0)
SN ; -- New backdoor order, return OE# via NA msg
"RTN","ORMPS",64,0)
 I $$FINISHED^ORMPS2 D RO^ORMPS2 Q  ;change action instead
"RTN","ORMPS",65,0)
 N RXO,RXC,ORDIALOG,ORDG,ORPKG,ORP,ORSIG,ORIG,TYPE,EVNT,ZSC
"RTN","ORMPS",66,0)
 I '$D(^VA(200,ORDUZ,0)) S ORERR="Missing or invalid entering person" Q
"RTN","ORMPS",67,0)
 I '$D(^VA(200,ORNP,0)) S ORERR="Missing or invalid ordering provider" Q
"RTN","ORMPS",68,0)
 ; I '$G(ORL) S ORERR="Missing or invalid patient location" Q
"RTN","ORMPS",69,0)
 I 'RXE S ORERR="Missing or invalid RXE segment" Q
"RTN","ORMPS",70,0)
 S RXO=$$RXO,RXC=$$RXC K ^TMP("ORWORD",$J),ORIFN
"RTN","ORMPS",71,0)
 D @($S(RXC:"IV",$G(ORCAT)="I":"UDOSE",1:"OUT")_"^ORMPS1") Q:$D(ORERR)
"RTN","ORMPS",72,0)
SN1 ; save order
"RTN","ORMPS",73,0)
 D EN^ORCSAVE I '$G(ORIFN) S ORERR="Cannot create new order" G SNQ
"RTN","ORMPS",74,0)
 D BDOSTR^ORWDBA3 ;DG1 & ZCL data
"RTN","ORMPS",75,0)
 S ORIG=+$P(ZRX,"|",2),TYPE=$P(ZRX,"|",4) I ORIG D  ;set fwd/bwd ptrs
"RTN","ORMPS",76,0)
 . S TYPE=$S(TYPE="R":2,1:1) Q:'$D(^OR(100,ORIG,0))
"RTN","ORMPS",77,0)
 . S $P(^OR(100,ORIFN,3),U,5)=ORIG,$P(^(3),U,11)=TYPE
"RTN","ORMPS",78,0)
 . S $P(^OR(100,ORIG,3),U,6)=ORIFN,EVNT=$P(^(0),U,17)
"RTN","ORMPS",79,0)
 . I $L(EVNT),TYPE=1 S $P(^OR(100,ORIFN,0),U,17)=EVNT
"RTN","ORMPS",80,0)
 . I TYPE=2,$G(ORCAT)="I" S ORSTRT=ORLOG D PARENT^ORMPS3 ;ck if complex
"RTN","ORMPS",81,0)
 I $G(ORCAT)="O" S ZSC=$$ZSC^ORMPS3 I ZSC,$P(ZSC,"|",2)'?2.3U S ^OR(100,ORIFN,5)=$TR($P(ZSC,"|",2,9),"|","^") ;1 or 0 instead of [N]SC
"RTN","ORMPS",82,0)
SN2 D DATES^ORCSAVE2(ORIFN,ORSTRT,ORSTOP)
"RTN","ORMPS",83,0)
 D:ORSTS STATUS^ORCSAVE2(ORIFN,ORSTS)
"RTN","ORMPS",84,0)
 D RELEASE^ORCSAVE2(ORIFN,1,ORLOG,ORDUZ,ORNATR)
"RTN","ORMPS",85,0)
 ; if unsigned edit, leave ORIFN unsigned & mark ORIG as Sig Not Req'd
"RTN","ORMPS",86,0)
 S ORSIG=1 ;$S('ORIG:1,TYPE'=1:1,$P($G(^OR(100,ORIG,8,1,0)),U,4)'=2:1,1:0)
"RTN","ORMPS",87,0)
 D SIGSTS^ORCSAVE2(ORIFN,1):ORSIG,SIGN^ORCSAVE2(ORIG,,,5,1):'ORSIG
"RTN","ORMPS",88,0)
 I ORDCNTRL="SN" D  ;print
"RTN","ORMPS",89,0)
 . S:ORNATR="" $P(^OR(100,ORIFN,8,1,0),U,12)="" ;CHCS/OP orders
"RTN","ORMPS",90,0)
 . S ORP(1)=ORIFN_";1"_$S(ORNATR="":"^^^^1",$G(ORL):"^1",1:"")
"RTN","ORMPS",91,0)
 . I ORP(1)["^" D PRINTS^ORWD1(.ORP,+$G(ORL))
"RTN","ORMPS",92,0)
 S ^OR(100,ORIFN,4)=PKGIFN
"RTN","ORMPS",93,0)
 D BACKDOOR^ORDEA(ORIFN,ORNP,.ORDIALOG)
"RTN","ORMPS",94,0)
SNQ K ^TMP("ORWORD",$J)
"RTN","ORMPS",95,0)
 Q
"RTN","ORMPS",96,0)
 ;
"RTN","ORMPS",97,0)
XX ; -- Changed (new order not necessary)
"RTN","ORMPS",98,0)
 Q:$P($G(^OR(100,+ORIFN,3)),U,3)=5  ;pending - update when finished
"RTN","ORMPS",99,0)
 I '$$CHANGED^ORMPS2 D SC Q  ;ck sts/dates only
"RTN","ORMPS",100,0)
RO ; -- Replacement order (finished)
"RTN","ORMPS",101,0)
 S:ORNATR="" ORNATR="S" D RO^ORMPS2
"RTN","ORMPS",102,0)
 Q
"RTN","ORMPS",103,0)
 ;
"RTN","ORMPS",104,0)
SC ; -- Status changed (verified, expired, suspended, renewed, reinstate)
"RTN","ORMPS",105,0)
 N OR0,OR3,ZSC,DONE S OR0=$G(^OR(100,+ORIFN,0)),OR3=$G(^(3))
"RTN","ORMPS",106,0)
 I "^1^13^"[(U_$P(OR3,U,3)_U),ORSTS=7 Q  ;retain DC status
"RTN","ORMPS",107,0)
 I $P(OR3,U,3)=5,ORSTS=6 D  Q:$G(DONE)
"RTN","ORMPS",108,0)
 . I $$CHANGED^ORMPS2 S ORNATR="S" D RO^ORMPS2 S DONE=1 Q
"RTN","ORMPS",109,0)
 . I $P(ZRX,"|",7)="TPN",+$P(OR0,U,11)'=$O(^ORD(100.98,"B","TPN",0)) D
"RTN","ORMPS",110,0)
 .. N DA,DR,DIE,ORDG S ORDG=+$O(^ORD(100.98,"B","TPN",0))
"RTN","ORMPS",111,0)
 .. ;four slashes below is OK, basically simlulating a direct write of the global for the TO field which has no Input Transform anyway
"RTN","ORMPS",112,0)
 .. S DA=+ORIFN,DR="23////"_ORDG,DIE="^OR(100," D ^DIE
"RTN","ORMPS",113,0)
 . I $P(OR3,U,11)=2,$P(OR0,U,12)="I" S ORSTRT=+$P($G(^OR(100,+ORIFN,8,1,0)),U,16) ;use Release Date for inpt renewals
"RTN","ORMPS",114,0)
 I $P(OR0,U,12)="I",$P(ZRX,"|",4)="R",+$P(ZRX,"|",2)=+ORIFN S ORSTRT=$P(OR0,U,8) ;keep orig start when renewed
"RTN","ORMPS",115,0)
 I ORSTS=7,ORSTOP S $P(^OR(100,+ORIFN,6),U,6)=ORSTOP ;save exp date
"RTN","ORMPS",116,0)
 I ORSTS=1 D EXPDT
"RTN","ORMPS",117,0)
 I $P(OR3,U,3)=3,ORSTS'=3 D
"RTN","ORMPS",118,0)
 .N ORNATR S ORNATR="I"
"RTN","ORMPS",119,0)
 .D UPDATE(ORSTS,"RL")
"RTN","ORMPS",120,0)
 I ($P(OR3,U,3)=3&ORSTS=3)!($P(OR3,U,3)'=3) D
"RTN","ORMPS",121,0)
 .D DATES^ORCSAVE2(+ORIFN,ORSTRT,ORSTOP)
"RTN","ORMPS",122,0)
 .D:ORSTS STATUS^ORCSAVE2(+ORIFN,ORSTS)
"RTN","ORMPS",123,0)
 I ORSTS=$P(OR3,U,3),ORSTOP'=$P(OR0,U,9) D SETALL^ORDD100(+ORIFN) ;AC xrf
"RTN","ORMPS",124,0)
 S ^OR(100,+ORIFN,4)=PKGIFN
"RTN","ORMPS",125,0)
 I "^1^13^"[(U_$P(OR3,U,3)_U),"^3^5^6^15^"[(U_ORSTS_U) D  ;reinstated
"RTN","ORMPS",126,0)
 . I $P($G(^OR(100,+ORIFN,8,+$P(OR3,U,7),0)),U,2)="DC" S ^(2)=ORNOW_U_ORWHO ; When^Who reinstated order
"RTN","ORMPS",127,0)
 . S I="?" F  S I=$O(^OR(100,+ORIFN,8,I),-1) Q:'+I  I $P(^(I,0),U,15)="" S $P(^OR(100,+ORIFN,3),U,7)=I Q  ;138 Finds current action
"RTN","ORMPS",128,0)
 . K ^OR(100,+ORIFN,6) D SETALL^ORDD100(+ORIFN)
"RTN","ORMPS",129,0)
 D UPD^ORMPS3 ;update some responses
"RTN","ORMPS",130,0)
 Q
"RTN","ORMPS",131,0)
 ;
"RTN","ORMPS",132,0)
STATUS(X) ; -- HL7 order status
"RTN","ORMPS",133,0)
 N Y S Y=$S(X="IP":5,X="CM":6,X="DC":1,X="ZE":7,X="HD":3,X="ZX":11,X="RP":12,X="ZZ":15,X="ZS":6,X="ZU":6,1:"")
"RTN","ORMPS",134,0)
 Q Y
"RTN","ORMPS",135,0)
 ;
"RTN","ORMPS",136,0)
DE ; -- Data Errors
"RTN","ORMPS",137,0)
 Q
"RTN","ORMPS",138,0)
 ;
"RTN","ORMPS",139,0)
UA ; -- Unable to accept [ack]
"RTN","ORMPS",140,0)
UX ; -- Unable to change [ack]
"RTN","ORMPS",141,0)
 S:'$L(ORNATR) ORNATR="X" ;Rejected
"RTN","ORMPS",142,0)
 S ^OR(100,+ORIFN,6)=$O(^ORD(100.02,"C",ORNATR,0))_U_U_ORNOW_U_U_OREASON
"RTN","ORMPS",143,0)
 I $P($G(^OR(100,+ORIFN,3)),U,11)=2 N ORIG S ORIG=$P(^(3),U,5) S:ORIG $P(^OR(100,ORIG,3),U,6)="" ;remove fwd ptr if pending renewal
"RTN","ORMPS",144,0)
 D STATUS^ORCSAVE2(+ORIFN,13)
"RTN","ORMPS",145,0)
UC ; -- Unable to cancel [ack]
"RTN","ORMPS",146,0)
UD ; -- Unable to discontinue [ack]
"RTN","ORMPS",147,0)
UH ; -- Unable to hold [ack]
"RTN","ORMPS",148,0)
UR ; -- Unable to release hold [ack]
"RTN","ORMPS",149,0)
 N ORDA S ORDA=+$P(ORIFN,";",2) I ORDA D
"RTN","ORMPS",150,0)
 . S $P(^OR(100,+ORIFN,8,ORDA,0),U,15)=13 ;request rejected
"RTN","ORMPS",151,0)
 . S:$L(OREASON) ^OR(100,+ORIFN,8,ORDA,1)=OREASON
"RTN","ORMPS",152,0)
 Q
"RTN","ORMPS",153,0)
 ;
"RTN","ORMPS",154,0)
OC ; -- Cancelled (before pharmacist's verification)
"RTN","ORMPS",155,0)
 G:ORTYPE="ORR" UA S:ORNATR="A" ORWHO=""
"RTN","ORMPS",156,0)
 S:'ORSTS ORSTS=13 S:ORSTS=12 ORNATR="S"
"RTN","ORMPS",157,0)
 S $P(^OR(100,+ORIFN,6),U,1,5)=$S($L(ORNATR):$O(^ORD(100.02,"C",ORNATR,0)),1:"")_U_ORWHO_U_ORNOW_U_U_$S((OREASON["16:")!(OREASON["17:"):$P(OREASON,":",2),1:OREASON)
"RTN","ORMPS",158,0)
 I $P($G(^OR(100,+ORIFN,3)),U,11)=2 N ORIG S ORIG=$P(^(3),U,5) S:ORIG $P(^OR(100,ORIG,3),U,6)="" ;remove fwd ptr when pending renewal cancelled
"RTN","ORMPS",159,0)
 S ^OR(100,+ORIFN,4)=PKGIFN S:ORSTOP>ORNOW ORSTOP=ORNOW
"RTN","ORMPS",160,0)
 D EXPDT,UPDATE(ORSTS,"DC")
"RTN","ORMPS",161,0)
 Q
"RTN","ORMPS",162,0)
 ;
"RTN","ORMPS",163,0)
CR ; -- Cancelled [ack]
"RTN","ORMPS",164,0)
 D EXPDT ;save exp date, if past
"RTN","ORMPS",165,0)
 D STATUS^ORCSAVE2(+ORIFN,13) S ^OR(100,+ORIFN,4)=PKGIFN
"RTN","ORMPS",166,0)
 Q
"RTN","ORMPS",167,0)
 ;
"RTN","ORMPS",168,0)
OD ; -- Discontinued (cancelled after pharmacist's verification)
"RTN","ORMPS",169,0)
 S:'ORSTS ORSTS=1 S:ORSTS=12 ORNATR="C"
"RTN","ORMPS",170,0)
 I ORNATR="A" S ORWHO="" I $G(DGPMT)=3,$$MVT^DGPMOBS(DGPMDA) D XTMP^ORMEVNT ;save order#
"RTN","ORMPS",171,0)
 S $P(^OR(100,+ORIFN,6),U,1,5)=$S($L(ORNATR):$O(^ORD(100.02,"C",ORNATR,0)),1:"")_U_ORWHO_U_ORNOW_U_U_$S((OREASON["16:")!(OREASON["17:"):$P(OREASON,":",2),1:OREASON)
"RTN","ORMPS",172,0)
 S ^OR(100,+ORIFN,4)=PKGIFN S:ORSTOP>ORNOW ORSTOP=ORNOW
"RTN","ORMPS",173,0)
 D EXPDT,UPDATE(ORSTS,"DC")
"RTN","ORMPS",174,0)
 Q
"RTN","ORMPS",175,0)
 ;
"RTN","ORMPS",176,0)
DR ; -- Discontinued [ack]
"RTN","ORMPS",177,0)
 D EXPDT ;save exp date, if past
"RTN","ORMPS",178,0)
 D STATUS^ORCSAVE2(+ORIFN,1) S ^OR(100,+ORIFN,4)=PKGIFN
"RTN","ORMPS",179,0)
 Q
"RTN","ORMPS",180,0)
 ;
"RTN","ORMPS",181,0)
EXPDT ; -- save exp date when dc'd
"RTN","ORMPS",182,0)
 N STOP S STOP=$P($G(^OR(100,+ORIFN,0)),U,9)
"RTN","ORMPS",183,0)
 I STOP,STOP<ORNOW,'$P($G(^OR(100,+ORIFN,6)),U,6) S $P(^(6),U,6)=STOP
"RTN","ORMPS",184,0)
 Q
"RTN","ORMPS",185,0)
 ;
"RTN","ORMPS",186,0)
OH ; -- Held
"RTN","ORMPS",187,0)
 S:'ORSTS ORSTS=3 D UPDATE(ORSTS,"HD")
"RTN","ORMPS",188,0)
 Q
"RTN","ORMPS",189,0)
 ;
"RTN","ORMPS",190,0)
HR ; -- Held [ack]
"RTN","ORMPS",191,0)
 D STATUS^ORCSAVE2(+ORIFN,3)
"RTN","ORMPS",192,0)
 Q
"RTN","ORMPS",193,0)
 ;
"RTN","ORMPS",194,0)
RL ; -- Released hold
"RTN","ORMPS",195,0)
OE ; -- Released hold
"RTN","ORMPS",196,0)
 N ORDA S ORDA=+$P(^OR(100,+ORIFN,3),U,7)
"RTN","ORMPS",197,0)
 I $P($G(^OR(100,+ORIFN,8,ORDA,0)),U,2)="HD" S $P(^(2),U,1,2)=ORNOW_U_ORWHO
"RTN","ORMPS",198,0)
 S:'$G(ORSTS) ORSTS=6 D UPDATE(ORSTS,"RL")
"RTN","ORMPS",199,0)
 Q
"RTN","ORMPS",200,0)
 ;
"RTN","ORMPS",201,0)
OR ; -- Released / [ack]
"RTN","ORMPS",202,0)
 S:'ORSTS ORSTS=6 D STATUS^ORCSAVE2(+ORIFN,ORSTS)
"RTN","ORMPS",203,0)
 D:ORSTRT!ORSTOP DATES^ORCSAVE2(+ORIFN,ORSTRT,ORSTOP)
"RTN","ORMPS",204,0)
 Q
"RTN","ORMPS",205,0)
 ;
"RTN","ORMPS",206,0)
UPDATE(ORSTS,ORACT) ; -- continue
"RTN","ORMPS",207,0)
 N ORDA,ORP D:$G(ORSTS) STATUS^ORCSAVE2(+ORIFN,ORSTS)
"RTN","ORMPS",208,0)
 D:ORSTRT!ORSTOP DATES^ORCSAVE2(+ORIFN,ORSTRT,ORSTOP)
"RTN","ORMPS",209,0)
 D:$$CREATE^ORX1(ORNATR)!(ORACT="HD")!(ORACT="RL")
"RTN","ORMPS",210,0)
 . S ORDA=$$ACTION^ORCSAVE(ORACT,+ORIFN,ORNP,OREASON,ORNOW,ORWHO)
"RTN","ORMPS",211,0)
 . I ORDA'>0 S ORERR="Cannot create new order action" Q
"RTN","ORMPS",212,0)
 . D RELEASE^ORCSAVE2(+ORIFN,ORDA,ORNOW,ORWHO,ORNATR)
"RTN","ORMPS",213,0)
 . D SIGSTS^ORCSAVE2(+ORIFN,ORDA)
"RTN","ORMPS",214,0)
 . I $G(ORL) S ORP(1)=+ORIFN_";"_ORDA_"^1" D PRINTS^ORWD1(.ORP,+ORL)
"RTN","ORMPS",215,0)
 . S $P(^OR(100,+ORIFN,3),U,7)=ORDA
"RTN","ORMPS",216,0)
 I ORACT="DC",'$$ACTV^ORX1(ORNATR) S $P(^OR(100,+ORIFN,3),U,7)=0
"RTN","ORMPS",217,0)
 D:$G(ORACT)="DC" CANCEL^ORCSEND(+ORIFN)
"RTN","ORMPS",218,0)
 Q
"RTN","ORMPS",219,0)
 ;
"RTN","ORMPS",220,0)
RXO() ; -- RXO segment
"RTN","ORMPS",221,0)
 N I,X S X="",I=$O(@ORMSG@(+ORC))
"RTN","ORMPS",222,0)
 I I,$E(@ORMSG@(I),1,3)="RXO" S X=I_U_@ORMSG@(I)
"RTN","ORMPS",223,0)
 Q X
"RTN","ORMPS",224,0)
 ;
"RTN","ORMPS",225,0)
RXE() ; -- RXE segment
"RTN","ORMPS",226,0)
 N X,I,SEG S X="",I=+ORC
"RTN","ORMPS",227,0)
 F  S I=$O(@ORMSG@(I)) Q:I'>0  S SEG=$E(@ORMSG@(I),1,3) Q:SEG="ORC"  I SEG="RXE" S X=I_U_@ORMSG@(I) Q
"RTN","ORMPS",228,0)
 Q X
"RTN","ORMPS",229,0)
 ;
"RTN","ORMPS",230,0)
RXR() ; -- RXR segment
"RTN","ORMPS",231,0)
 N X,I,SEG S X="",I=+RXE
"RTN","ORMPS",232,0)
 F  S I=$O(@ORMSG@(I)) Q:I'>0  S SEG=$E(@ORMSG@(I),1,3) Q:SEG="ORC"  I SEG="RXR" S X=I_U_@ORMSG@(I) Q
"RTN","ORMPS",233,0)
 Q X
"RTN","ORMPS",234,0)
 ;
"RTN","ORMPS",235,0)
RXC() ; -- [First] RXC segment
"RTN","ORMPS",236,0)
 N X,I,SEG S X="",I=+RXE
"RTN","ORMPS",237,0)
 F  S I=$O(@ORMSG@(I)) Q:I'>0  S SEG=$E(@ORMSG@(I),1,3) Q:SEG="ORC"  I SEG="RXC" S X=I Q
"RTN","ORMPS",238,0)
 Q X
"RTN","ORMPS",239,0)
 ;
"RTN","ORMPS",240,0)
ZRX() ; -- ZRX segment
"RTN","ORMPS",241,0)
 N X,I,SEG S X="",I=+ORC
"RTN","ORMPS",242,0)
 F  S I=$O(@ORMSG@(I)) Q:I'>0  S SEG=$E(@ORMSG@(I),1,3) Q:SEG="ORC"  I SEG="ZRX" S X=I_U_@ORMSG@(I) Q
"RTN","ORMPS",243,0)
 Q X
"RTN","ORMPS1")
0^71^B71509240
"RTN","ORMPS1",1,0)
ORMPS1 ;SLC/MKB - Process Pharmacy ORM msgs cont ;04/28/2015  08:20
"RTN","ORMPS1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**86,92,94,116,134,152,158,149,190,195,215,265,275,243,280,350**;Dec 17, 1997;Build 77
"RTN","ORMPS1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","ORMPS1",4,0)
 ;
"RTN","ORMPS1",5,0)
 ;
"RTN","ORMPS1",6,0)
UDOSE ; -- new Unit Dose order
"RTN","ORMPS1",7,0)
 N ADMIN,QT,DRUG,INSTR,DOSE,RTE,SCH,OI,URG,WP,DUR,STR,DRGNM,X,PSOI,PSDD,S0,ID,LDOSE,XC,NTE,S0,RXR
"RTN","ORMPS1",8,0)
 S ORDIALOG=+$O(^ORD(101.41,"AB","PSJ OR PAT OE",0))
"RTN","ORMPS1",9,0)
 I $G(ORAPPT)>0 S ORDG=+$O(^ORD(100.98,"B","CLINIC MEDICATIONS",0))
"RTN","ORMPS1",10,0)
 E  S ORDG=+$O(^ORD(100.98,"B","UNIT DOSE MEDICATIONS",0))
"RTN","ORMPS1",11,0)
 S ORPKG=+$$PKG("PSJ")
"RTN","ORMPS1",12,0)
 D GETDLG1^ORCD(ORDIALOG) S QT=$G(ORQT(1))
"RTN","ORMPS1",13,0)
 S DRUG=$$PTR("DISPENSE DRUG"),INSTR=$$PTR("INSTRUCTIONS")
"RTN","ORMPS1",14,0)
 S DOSE=$$PTR("DOSE"),RTE=$$PTR("ROUTE")
"RTN","ORMPS1",15,0)
 S SCH=$$PTR("SCHEDULE"),ADMIN=$$PTR("ADMIN TIMES")
"RTN","ORMPS1",16,0)
 S OI=$$PTR("ORDERABLE ITEM"),URG=$$PTR("URGENCY")
"RTN","ORMPS1",17,0)
 S WP=$$PTR("WORD PROCESSING 1"),DUR=$$PTR("DURATION")
"RTN","ORMPS1",18,0)
 S STR=$$PTR("STRENGTH"),DRGNM=$$PTR("DRUG NAME")
"RTN","ORMPS1",19,0)
UD1 S:RXO X=$P(RXO,"|",2),ORDIALOG(OI,1)=$$ORDITEM^ORM(X),PSOI=$P(X,U,4,5)
"RTN","ORMPS1",20,0)
 I '$G(ORDIALOG(OI,1)) S ORERR="Missing or invalid orderable item" Q
"RTN","ORMPS1",21,0)
 S PSDD=$P($$FIND^ORM(+RXE,3),U,4,5),ORDIALOG(DRUG,1)=+PSDD
"RTN","ORMPS1",22,0)
 S S0=$$FIND^ORM(+RXE,26)_"&"_$P($$FIND^ORM(+RXE,27),U,5)
"RTN","ORMPS1",23,0)
 S ID=$P(QT,U),LDOSE=$P(QT,U,8) I 'ID,S0 D
"RTN","ORMPS1",24,0)
 . N UNT,PTRN S UNT=$P(S0,"&",2),PTRN="1.N1"""_UNT_""""
"RTN","ORMPS1",25,0)
 . I LDOSE?@PTRN S $P(ID,"&",1,2)=+LDOSE_"&"_UNT Q  ;pre-POE orders
"RTN","ORMPS1",26,0)
 . S:$P(PSOI,U,2)'[S0 ORDIALOG(STR,1)=$TR(S0,"&")
"RTN","ORMPS1",27,0)
 I 'ID,'S0 S ORDIALOG(DRGNM,1)=$$UNESC^ORMPS2($P(PSDD,U,2))
"RTN","ORMPS1",28,0)
 S:$L(ID) ORDIALOG(DOSE,1)=$$UNESC^ORMPS2($P(ID,"&",1,4)_"&"_LDOSE_"&"_+PSDD_"&"_S0)
"RTN","ORMPS1",29,0)
 I LDOSE="" D  I LDOSE="" S ORERR="Unable to determine instructions" Q
"RTN","ORMPS1",30,0)
 . I $G(RXC)'>0 D  Q  ;look for units/dose
"RTN","ORMPS1",31,0)
 .. S LDOSE=$P(ID,"&",3),X=$P(ID,"&",4) I 'LDOSE S LDOSE="" Q
"RTN","ORMPS1",32,0)
 .. S:'$L(X) X=$$UNESC^ORMPS2($P($$FIND^ORM(+RXE,7),U,5)) S:$L(X) LDOSE=LDOSE_" "_X
"RTN","ORMPS1",33,0)
 .. S ORDIALOG(DRGNM,1)=$$UNESC^ORMPS2($P(PSDD,U,2)) ;force use of DD
"RTN","ORMPS1",34,0)
 . F  D  Q:LDOSE'=""  S RXC=$O(@ORMSG@(RXC)) Q:'RXC  Q:$E(@ORMSG@(RXC),1,3)'="RXC"
"RTN","ORMPS1",35,0)
 .. S XC=@ORMSG@(RXC) Q:+$P($P(XC,"|",3),U,4)'=+PSOI
"RTN","ORMPS1",36,0)
 .. S LDOSE=$P(XC,"|",4)_$P($P(XC,"|",5),U,5) ;strength_units
"RTN","ORMPS1",37,0)
 S ORDIALOG(INSTR,1)=$$UNESC^ORMPS2(LDOSE)
"RTN","ORMPS1",38,0)
UD2 S NTE=$$NTE^ORMPS3(21) I NTE D
"RTN","ORMPS1",39,0)
 . N CNT,I S CNT=1,^TMP("ORWORD",$J,WP,1,CNT,0)=$$UNESC^ORMPS2($P(@ORMSG@(NTE),"|",4))
"RTN","ORMPS1",40,0)
 . I $O(@ORMSG@(NTE,0)) S I=0 F  S I=$O(@ORMSG@(NTE,I)) Q:I'>0  S CNT=CNT+1,^TMP("ORWORD",$J,WP,1,CNT,0)=$$UNESC^ORMPS2(@ORMSG@(NTE,I))
"RTN","ORMPS1",41,0)
 . S ^TMP("ORWORD",$J,WP,1,0)="^^"_CNT_U_CNT_U_DT_U
"RTN","ORMPS1",42,0)
 . S ORDIALOG(WP,1)="^TMP(""ORWORD"",$J,"_WP_",1)"
"RTN","ORMPS1",43,0)
 S RXR=$$RXR^ORMPS I 'RXR S ORERR="Missing or invalid RXR segment" Q
"RTN","ORMPS1",44,0)
 S ORDIALOG(RTE,1)=$P($P(RXR,"|",2),U,4),ORDIALOG(URG,1)=ORURG
"RTN","ORMPS1",45,0)
 S X=$P(QT,U,2)
"RTN","ORMPS1",46,0)
 S ORDIALOG(SCH,1)=$$UNESC^ORMPS2($P(X,"&"))
"RTN","ORMPS1",47,0)
 S:$L($P(X,"&",2)) ORDIALOG(ADMIN,1)=$P(X,"&",2)
"RTN","ORMPS1",48,0)
 S X=$P(QT,U,3) I $L(X) D  ;set only if previous order had duration
"RTN","ORMPS1",49,0)
 . N IFN S IFN=$S($G(ORIFN):+ORIFN,$P(ZRX,"|",2):+$P(ZRX,"|",2),1:0)
"RTN","ORMPS1",50,0)
 . S:$O(^OR(100,+IFN,4.5,"ID","DAYS",0)) ORDIALOG(DUR,1)=$$DURATION^ORMPS3(X)
"RTN","ORMPS1",51,0)
 D DOSETEXT^ORCDPS2 ;reset Instructions text, SIG
"RTN","ORMPS1",52,0)
 D UNESCARR^ORMPS2("ORDIALOG")
"RTN","ORMPS1",53,0)
 Q
"RTN","ORMPS1",54,0)
OUT ; -- new Outpt order
"RTN","ORMPS1",55,0)
 N OI,SIG,INSTR,DOSE,RTE,SCH,DUR,SC,STR,DRUG,PI,CONJ,PSOI,PSDD,S0,X,I,RXR,J,NTE,ZSC,CNT,PC
"RTN","ORMPS1",56,0)
 S ORDIALOG=+$O(^ORD(101.41,"AB","PSO OERR",0))
"RTN","ORMPS1",57,0)
 S ORDG=+$O(^ORD(100.98,"B","OUTPATIENT MEDICATIONS",0))
"RTN","ORMPS1",58,0)
 S ORPKG=+$$PKG("PSO") D GETDLG1^ORCD(ORDIALOG)
"RTN","ORMPS1",59,0)
 S OI=$$PTR("ORDERABLE ITEM"),SIG=$$PTR("SIG")
"RTN","ORMPS1",60,0)
 S INSTR=$$PTR("INSTRUCTIONS"),DOSE=$$PTR("DOSE")
"RTN","ORMPS1",61,0)
 S SCH=$$PTR("SCHEDULE"),DUR=$$PTR("DURATION")
"RTN","ORMPS1",62,0)
 S RTE=$$PTR("ROUTE"),SC=$$PTR("SERVICE CONNECTED")
"RTN","ORMPS1",63,0)
 S STR=$$PTR("STRENGTH"),DRUG=$$PTR("DISPENSE DRUG")
"RTN","ORMPS1",64,0)
 S PI=$$PTR("PATIENT INSTRUCTIONS"),CONJ=$$PTR("AND/THEN")
"RTN","ORMPS1",65,0)
 S PC=$$PTR("WORD PROCESSING 1")
"RTN","ORMPS1",66,0)
 S:RXO X=$P(RXO,"|",2),ORDIALOG(OI,1)=$$ORDITEM^ORM(X),PSOI=$P(X,U,4,5)
"RTN","ORMPS1",67,0)
 I '$G(ORDIALOG(OI,1)) S ORERR="Missing or invalid orderable item" Q
"RTN","ORMPS1",68,0)
 S PSDD=$P($$FIND^ORM(+RXE,3),U,4,5),ORDIALOG(DRUG,1)=+PSDD
"RTN","ORMPS1",69,0)
 S S0=$$FIND^ORM(+RXE,26)_"&"_$P($$FIND^ORM(+RXE,27),U,5)
"RTN","ORMPS1",70,0)
 I S0,$P(PSOI,U,2)'[S0 S ORDIALOG(STR,1)=$TR(S0,"&")
"RTN","ORMPS1",71,0)
 I 'S0,'$G(ORQT(1)) S ORDIALOG($$PTR("DRUG NAME"),1)=$$UNESC^ORMPS2($P(PSDD,U,2))
"RTN","ORMPS1",72,0)
OUT1 S ORDIALOG($$PTR("QUANTITY"),1)=$$FIND^ORM(+RXE,11)
"RTN","ORMPS1",73,0)
 S ORDIALOG($$PTR("REFILLS"),1)=$$FIND^ORM(+RXE,13)
"RTN","ORMPS1",74,0)
 S X=$$FIND^ORM(+RXE,23) S:$E(X)="D" X=+$E(X,2,99)
"RTN","ORMPS1",75,0)
 S:X ORDIALOG($$PTR("DAYS SUPPLY"),1)=X
"RTN","ORMPS1",76,0)
 I ZRX S X=$P(ZRX,"|",5) S:$L(X) ORDIALOG($$PTR("ROUTING"),1)=X
"RTN","ORMPS1",77,0)
 S:ORURG ORDIALOG($$PTR("URGENCY"),1)=ORURG F I=1:1:ORQT D
"RTN","ORMPS1",78,0)
 . S ORDIALOG(INSTR,I)=$$UNESC^ORMPS2($P(ORQT(I),U,8)),X=$P(ORQT(I),U)
"RTN","ORMPS1",79,0)
 . S:$L(X) ORDIALOG(DOSE,I)=$$UNESC^ORMPS2($P(X,"&",1,4)_"&"_$P(ORQT(I),U,8)_"&"_+PSDD_"&"_S0)
"RTN","ORMPS1",80,0)
 . S X=$P(ORQT(I),U,2) S:$L(X) ORDIALOG(SCH,I)=$$UNESC^ORMPS2(X)
"RTN","ORMPS1",81,0)
 . S X=$P(ORQT(I),U,3) S:$L(X) ORDIALOG(DUR,I)=$$DURATION^ORMPS3(X)
"RTN","ORMPS1",82,0)
 . S X=$P(ORQT(I),U,9) S:$L(X) ORDIALOG(CONJ,I)=$S(X="S":"T",1:X)
"RTN","ORMPS1",83,0)
 S RXR=$$RXR^ORMPS I RXR S ORDIALOG(RTE,1)=$P($P(RXR,"|",2),U,4) D
"RTN","ORMPS1",84,0)
 . S I=1,J=+RXR ;look for multiple RXR's
"RTN","ORMPS1",85,0)
 . F  S J=$O(@ORMSG@(J)) Q:J'>0  S RXR=@ORMSG@(J) Q:$E(RXR,1,3)'="RXR"  S I=I+1,ORDIALOG(RTE,I)=$P($P(RXR,"|",2),U,4)
"RTN","ORMPS1",86,0)
OUT2 S NTE=$$NTE^ORMPS3(6) I NTE D  ;Prov Comm ;D:'NTE PCOMM^ORMPS2
"RTN","ORMPS1",87,0)
 . S CNT=1,^TMP("ORWORD",$J,PC,1,CNT,0)=$$UNESC^ORMPS2($P(@ORMSG@(NTE),"|",4))
"RTN","ORMPS1",88,0)
 . I $O(@ORMSG@(NTE,0)) S I=0 F  S I=$O(@ORMSG@(NTE,I)) Q:I'>0  S CNT=CNT+1,^TMP("ORWORD",$J,PC,1,CNT,0)=$$UNESC^ORMPS2(@ORMSG@(NTE,I))
"RTN","ORMPS1",89,0)
 . S ^TMP("ORWORD",$J,PC,1,0)="^^"_CNT_U_CNT_U_DT_U
"RTN","ORMPS1",90,0)
 . S ORDIALOG(PC,1)="^TMP(""ORWORD"",$J,"_PC_",1)",ORDIALOG(PC,"FORMAT")="@" ;keep, don't show
"RTN","ORMPS1",91,0)
 . N XCNT,XCOMM,XCOMMENT,XORCOMM,XXCNT,XORIFN
"RTN","ORMPS1",92,0)
 . S XORIFN=$G(ORIFN) S:XORIFN="" XORIFN=$P(RXR,"|",2) Q:XORIFN=""
"RTN","ORMPS1",93,0)
 . S XCOMM=$O(^OR(100,+XORIFN,4.5,"ID","COMMENT",0)) Q:XCOMM=""
"RTN","ORMPS1",94,0)
 . S XCNT=0 F  S XCNT=$O(^TMP("ORWORD",$J,PC,1,XCNT)) Q:XCNT=""  S XCOMMENT=^TMP("ORWORD",$J,PC,1,XCNT,0) D
"RTN","ORMPS1",95,0)
 .. S XORCOMM=$G(^OR(100,+XORIFN,4.5,XCOMM,2,XCNT,0)),XXCNT=0
"RTN","ORMPS1",96,0)
 .. I XORCOMM="" F  S XXCNT=$O(^OR(100,+XORIFN,4.5,XCOMM,2,XXCNT)) Q:XXCNT=""  S XORCOMM=$G(^(XXCNT,0)) Q:XORCOMM'=""
"RTN","ORMPS1",97,0)
 .. I $G(XCOMMENT)=$G(XORCOMM) S ORDIALOG(PC,"FORMAT")="@"
"RTN","ORMPS1",98,0)
 S NTE=$$NTE^ORMPS3(7) I NTE D  ;Pat Instr
"RTN","ORMPS1",99,0)
 . S CNT=1,^TMP("ORWORD",$J,PI,1,CNT,0)=$$UNESC^ORMPS2($P(@ORMSG@(NTE),"|",4))
"RTN","ORMPS1",100,0)
 . I $O(@ORMSG@(NTE,0)) S I=0 F  S I=$O(@ORMSG@(NTE,I)) Q:I'>0  S CNT=CNT+1,^TMP("ORWORD",$J,PI,1,CNT,0)=$$UNESC^ORMPS2(@ORMSG@(NTE,I))
"RTN","ORMPS1",101,0)
 . S ^TMP("ORWORD",$J,PI,1,0)="^^"_CNT_U_CNT_U_DT_U
"RTN","ORMPS1",102,0)
 . S ORDIALOG(PI,1)="^TMP(""ORWORD"",$J,"_PI_",1)"
"RTN","ORMPS1",103,0)
 S NTE=$$NTE^ORMPS3(21) I NTE D  ;Sig
"RTN","ORMPS1",104,0)
 . S CNT=1,^TMP("ORWORD",$J,SIG,1,CNT,0)=$$UNESC^ORMPS2($P(@ORMSG@(NTE),"|",4))
"RTN","ORMPS1",105,0)
 . I $O(@ORMSG@(NTE,0)) S I=0 F  S I=$O(@ORMSG@(NTE,I)) Q:I'>0  S CNT=CNT+1,^TMP("ORWORD",$J,SIG,1,CNT,0)=$$UNESC^ORMPS2(@ORMSG@(NTE,I))
"RTN","ORMPS1",106,0)
 . S ^TMP("ORWORD",$J,SIG,1,0)="^^"_CNT_U_CNT_U_DT_U
"RTN","ORMPS1",107,0)
 . S ORDIALOG(SIG,1)="^TMP(""ORWORD"",$J,"_SIG_",1)"
"RTN","ORMPS1",108,0)
 . S ORDIALOG(PI,"FORMAT")="@" ;PI already included in Sig
"RTN","ORMPS1",109,0)
OUT3 I '$G(ORQT(1))!('NTE) D DOSETEXT^ORCDPS2 ;reset Instructions text, Sig
"RTN","ORMPS1",110,0)
 S ZSC=$$ZSC^ORMPS3,X=$P(ZSC,"|",2) I X?2.3U S ORDIALOG(SC,1)=$S(X="SC":1,1:0)
"RTN","ORMPS1",111,0)
 Q
"RTN","ORMPS1",112,0)
IV ; -- new IV order
"RTN","ORMPS1",113,0)
 N IVTYP,IVTYPE S IVTYP=$P(ZRX,"|",7) I IVTYP="",$$NUMADDS^ORMPS3'>1 G UDOSE
"RTN","ORMPS1",114,0)
 N SOLN,VOL,ADDS,STR,UNITS,RATE,URG,X,X1,X2,X3,I,J,TYPE,OI,WP,NTE,SCH
"RTN","ORMPS1",115,0)
 N DAYS,ROUTE,ADMIN,RXR,ADDFREQ
"RTN","ORMPS1",116,0)
 S ORDIALOG=+$O(^ORD(101.41,"AB","PSJI OR PAT FLUID OE",0))
"RTN","ORMPS1",117,0)
 I +$G(ORAPPT)>0 S ORDG=+$O(^ORD(100.98,"B","CLINIC INFUSIONS",0))
"RTN","ORMPS1",118,0)
 E  S ORDG=+$O(^ORD(100.98,"B",$S($P(ZRX,"|",7)="TPN":"TPN",1:"IV RX"),0))
"RTN","ORMPS1",119,0)
 S ORPKG=+$$PKG("PSJ") D GETDLG1^ORCD(ORDIALOG)
"RTN","ORMPS1",120,0)
 S SOLN=$$PTR("ORDERABLE ITEM"),VOL=$$PTR("VOLUME"),SCH=$$PTR("SCHEDULE")
"RTN","ORMPS1",121,0)
 S RATE=$$PTR("INFUSION RATE") S:ORURG ORDIALOG($$PTR("URGENCY"),1)=ORURG
"RTN","ORMPS1",122,0)
 S WP=$$PTR("WORD PROCESSING 1"),ADDS=$$PTR("ADDITIVE")
"RTN","ORMPS1",123,0)
 S ADDFREQ=$$PTR("ADDITIVE FREQUENCY")
"RTN","ORMPS1",124,0)
 S STR=$$PTR("STRENGTH PSIV"),UNITS=$$PTR("UNITS")
"RTN","ORMPS1",125,0)
 S DAYS=$$PTR("DURATION"),IVTYPE=$$PTR("IV TYPE"),ADMIN=$$PTR("ADMIN TIMES")
"RTN","ORMPS1",126,0)
IV1 S NTE=$$NTE^ORMPS3(21) I NTE D
"RTN","ORMPS1",127,0)
 . N CNT,I S CNT=1,^TMP("ORWORD",$J,WP,1,CNT,0)=$$UNESC^ORMPS2($P(@ORMSG@(NTE),"|",4))
"RTN","ORMPS1",128,0)
 . I $O(@ORMSG@(NTE,0)) S I=0 F  S I=$O(@ORMSG@(NTE,I)) Q:I'>0  S CNT=CNT+1,^TMP("ORWORD",$J,WP,1,CNT,0)=$$UNESC^ORMPS2(@ORMSG@(NTE,I))
"RTN","ORMPS1",129,0)
 . S ^TMP("ORWORD",$J,WP,1,0)="^^"_CNT_U_CNT_U_DT_U
"RTN","ORMPS1",130,0)
 . S ORDIALOG(WP,1)="^TMP(""ORWORD"",$J,"_WP_",1)"
"RTN","ORMPS1",131,0)
 N ORDAYS S ORDAYS=""
"RTN","ORMPS1",132,0)
 S:$D(RXO) ORDAYS=$P($P(RXO,"|",2),"^",3)
"RTN","ORMPS1",133,0)
 S:$L(ORDAYS) ORDAYS=$$IVLIM^ORMPS2(ORDAYS)
"RTN","ORMPS1",134,0)
 S:$L(ORDAYS) ORDIALOG(DAYS,1)=ORDAYS
"RTN","ORMPS1",135,0)
 S ORDIALOG(IVTYPE,1)=IVTYP
"RTN","ORMPS1",136,0)
 S X=$P($$FIND^ORM(+RXE,25),U,5)
"RTN","ORMPS1",137,0)
 S ORDIALOG(RATE,1)=$$FIND^ORM(+RXE,24)_$S($L(X):" "_X,1:""),(I,J)=0
"RTN","ORMPS1",138,0)
 F  D  S RXC=$O(@ORMSG@(RXC)) Q:'RXC  Q:$E(@ORMSG@(RXC),1,3)'="RXC"
"RTN","ORMPS1",139,0)
 . S X=@ORMSG@(RXC),TYPE=$P(X,"|",2),OI=$$ORDITEM^ORM($P(X,"|",3)) Q:'OI
"RTN","ORMPS1",140,0)
 . S X1=$P(X,"|",4),X2=$P($P(X,"|",5),U,5),X3=$P(X,"|",6)
"RTN","ORMPS1",141,0)
 . I $E(TYPE)="B" S J=J+1,ORDIALOG(SOLN,J)=OI,ORDIALOG(VOL,J)=X1 Q
"RTN","ORMPS1",142,0)
 . S I=I+1,ORDIALOG(ADDS,I)=OI,ORDIALOG(STR,I)=X1,ORDIALOG(UNITS,I)=X2,ORDIALOG(ADDFREQ,I)=$$ADDFRQCV^ORMBLDP1(X3,"I")
"RTN","ORMPS1",143,0)
IV2 ;
"RTN","ORMPS1",144,0)
 S RXR=$$RXR^ORMPS
"RTN","ORMPS1",145,0)
 S ROUTE=$P(RXR,"|",2)
"RTN","ORMPS1",146,0)
 S ORDIALOG($$PTR("ROUTE"),1)=$P(ROUTE,U,4)
"RTN","ORMPS1",147,0)
 I IVTYP="I" S X=$P($G(ORQT(1)),U,2) D
"RTN","ORMPS1",148,0)
 .S:$L($P(X,"&")) ORDIALOG(SCH,1)=$P(X,"&")
"RTN","ORMPS1",149,0)
 .S:$L($P(X,"&",2)) ORDIALOG(ADMIN,1)=$P(X,"&",2)
"RTN","ORMPS1",150,0)
 D UNESCARR^ORMPS2("ORDIALOG")
"RTN","ORMPS1",151,0)
 Q
"RTN","ORMPS1",152,0)
PKG(NMSP) ; -- Return Package file ptr for NMSP
"RTN","ORMPS1",153,0)
 N I S I=0
"RTN","ORMPS1",154,0)
 F  S I=+$O(^DIC(9.4,"C",NMSP,I)) Q:I<1  Q:'$O(^(I,0))  ;no Addl Prefs
"RTN","ORMPS1",155,0)
 Q I
"RTN","ORMPS1",156,0)
PTR(NAME) ; -- Returns ien of prompt NAME in Order Dialog file #101.41
"RTN","ORMPS1",157,0)
 Q +$O(^ORD(101.41,"AB",$E("OR GTX "_NAME,1,63),0))
"RTN","ORMPS1",158,0)
QT ; -- Unpiece the Q/T field from RXE
"RTN","ORMPS1",159,0)
 I 'RXE S ORQT(1)=ORQT,ORQT=1 Q  ; nothing to reset
"RTN","ORMPS1",160,0)
 N X,Y,I,J,P,SEG,DONE K ORQT
"RTN","ORMPS1",161,0)
 S SEG=$G(@ORMSG@(+RXE)),X=$P(SEG,"|",2),(I,J,P,DONE)=0
"RTN","ORMPS1",162,0)
 F  D  Q:DONE
"RTN","ORMPS1",163,0)
 . S P=P+1,Y=$P(X,"~",P) I Y="" S DONE=1 Q
"RTN","ORMPS1",164,0)
 . I P<$L(X,"~") S I=I+1,ORQT(I)=Y Q
"RTN","ORMPS1",165,0)
 . I $L(SEG,"|")>2 S I=I+1,ORQT(I)=Y,DONE=1 Q
"RTN","ORMPS1",166,0)
 . S J=+$O(@ORMSG@(+RXE,J)) I J'>0 S I=I+1,ORQT(I)=Y,DONE=1 Q
"RTN","ORMPS1",167,0)
 . S SEG=$G(@ORMSG@(+RXE,J)),X=$P(SEG,"|"),P=1,I=I+1,ORQT(I)=Y_$P(X,"~")
"RTN","ORMPS1",168,0)
 S ORQT=I Q:'ORQT  ; else reset ORSTRT, ORSTOP, ORURG
"RTN","ORMPS1",169,0)
 S ORSTRT=$P(ORQT(1),U,4),ORSTOP=$P(ORQT(ORQT),U,5),ORURG=$P(ORQT(1),U,6)
"RTN","ORMPS1",170,0)
 S:ORSTRT ORSTRT=$$FMDATE^ORM(ORSTRT) S:ORSTOP ORSTOP=$$FMDATE^ORM(ORSTOP) S:$L(ORURG) ORURG=$$URGENCY^ORM(ORURG)
"RTN","ORMPS1",171,0)
 Q
"RTN","ORMPS2")
0^58^B48612384
"RTN","ORMPS2",1,0)
ORMPS2 ;SLC/MKB - Process Pharmacy ORM msgs cont ;04/28/2015  08:33
"RTN","ORMPS2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**94,116,129,134,186,190,195,215,265,243,280,363,350**;Dec 17, 1997;Build 77
"RTN","ORMPS2",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","ORMPS2",4,0)
 ;
"RTN","ORMPS2",5,0)
FINISHED() ; -- new order [SN^ORMPS] due to finishing?
"RTN","ORMPS2",6,0)
 N Y,ORIG,TYPE,ORIG4 S Y=0
"RTN","ORMPS2",7,0)
 S ORIG=+$P(ZRX,"|",2),TYPE=$P(ZRX,"|",4),ORIG4=$G(^OR(100,ORIG,4))
"RTN","ORMPS2",8,0)
 I ORIG,TYPE="E",ORIG4?1.N1"P"!(ORIG4?1.N1"S") S ORIFN=+ORIG,Y=1
"RTN","ORMPS2",9,0)
 Q Y
"RTN","ORMPS2",10,0)
 ;
"RTN","ORMPS2",11,0)
WPX() ; -- Compare comments in @ORMSG@(NTE) with order ORIFN
"RTN","ORMPS2",12,0)
 ;     Returns 1 if different, or 0 if same
"RTN","ORMPS2",13,0)
 N NTE,SPINST,Y,X S Y=0
"RTN","ORMPS2",14,0)
 S NTE=+$$NTE^ORMPS3(21),SPINST=$S(NTE:$$NTXT^ORMPS3(NTE),1:"")
"RTN","ORMPS2",15,0)
 S X=$$VALTXT^ORMPS3(+ORIFN,"COMMENT")
"RTN","ORMPS2",16,0)
 I $TR(X," ")'=$TR(SPINST," ") S Y=1 ;comp text w/o spaces
"RTN","ORMPS2",17,0)
WQ Q Y
"RTN","ORMPS2",18,0)
 ;
"RTN","ORMPS2",19,0)
IVX() ; -- Compare ORMSG to Inpt order ORIFN if IV, return 0 if 'diff or 'IV
"RTN","ORMPS2",20,0)
 N Y,ADDFREQ,RXC,DG,OI,PSOI,XC,X,RATE,RXR,ORA,ORB,ORX,I,J,OI0,INST,VOL,STR,UNT
"RTN","ORMPS2",21,0)
 S RXC=$$RXC^ORMPS,Y=0 I RXC'>0 Q Y  ;not IV of any kind
"RTN","ORMPS2",22,0)
 S DG=+$P($G(^OR(100,+ORIFN,0)),U,11),DG=$P($G(^ORD(100.98,DG,0)),U,3)
"RTN","ORMPS2",23,0)
 I DG'="IV RX",DG'="TPN" D  Q Y  ;not fluid
"RTN","ORMPS2",24,0)
 . I $P(ZRX,"|",7)'="" S Y=1 Q
"RTN","ORMPS2",25,0)
 . I $$NUMADDS^ORMPS3>1 S Y=1 Q
"RTN","ORMPS2",26,0)
 . S OI=$$VALUE("ORDERABLE"),PSOI=+$P($G(^ORD(101.43,+OI,0)),U,2)
"RTN","ORMPS2",27,0)
 . S XC=@ORMSG@(RXC) I PSOI'=$P(XC,U,4) S Y=1 Q
"RTN","ORMPS2",28,0)
 . N X1,X2,X3 S X1=$P(XC,"|",4),X2=$P($P(XC,"|",5),U,5)
"RTN","ORMPS2",29,0)
 . S X3=$$VALUE("INSTR") I (X1_X2)'=X3,(X1_" "_X2)'=X3 S Y=1 Q
"RTN","ORMPS2",30,0)
IV1 S RATE=$$FIND^ORM(+RXE,24),UNT=$P($$FIND^ORM(+RXE,25),U,5)
"RTN","ORMPS2",31,0)
 S:$L(UNT) RATE=RATE_" "_UNT S X=$$VALUE("RATE") I RATE'=X D  Q:Y Y
"RTN","ORMPS2",32,0)
 . S:RATE["@" RATE=$P(RATE,"@") S:X["@" X=$P(X,"@") ;rate@labels
"RTN","ORMPS2",33,0)
 . I RATE'=X S Y=1 Q
"RTN","ORMPS2",34,0)
 I $P(ZRX,"|",7)'=$$VALUE("TYPE") S Y=1 Q Y
"RTN","ORMPS2",35,0)
 S RXR=$$RXR^ORMPS
"RTN","ORMPS2",36,0)
 I $P($P(RXR,"|",2),U,4)'=$$VALUE("ROUTE") S Y=1 Q Y
"RTN","ORMPS2",37,0)
 S ORB=+$$PTR("ORDERABLE ITEM"),ORA=+$$PTR("ADDITIVE"),I=+RXC
"RTN","ORMPS2",38,0)
 F  S XC=@ORMSG@(I) Q:$E(XC,1,3)'="RXC"  D  S I=$O(@ORMSG@(I)) Q:I'>0
"RTN","ORMPS2",39,0)
 . S ORX($P(XC,"|",2),+$P(XC,U,4))=$P(XC,"|",4)_U_$P($P(XC,"|",5),U,5)_U_$P(XC,"|",6)
"RTN","ORMPS2",40,0)
 . ;ORX("A",PSOI)=str^units^bag or ORX("B",PSOI)=volume^units^null
"RTN","ORMPS2",41,0)
 F I="STRENGTH","UNITS","VOLUME","ADDFREQ" D  ;ORX(I,inst)=value
"RTN","ORMPS2",42,0)
 . S J=0 F  S J=$O(^OR(100,+ORIFN,4.5,"ID",I,J)) Q:J'>0  D
"RTN","ORMPS2",43,0)
 .. S INST=+$P($G(^OR(100,+ORIFN,4.5,J,0)),U,3)
"RTN","ORMPS2",44,0)
 .. S:INST ORX(I,INST)=$G(^OR(100,+ORIFN,4.5,J,1))
"RTN","ORMPS2",45,0)
 S I=0 F  S I=$O(^OR(100,+ORIFN,4.5,"ID","ORDERABLE",I)) Q:I'>0  D  Q:Y
"RTN","ORMPS2",46,0)
 . S OI0=$G(^OR(100,+ORIFN,4.5,I,0)),OI=+$G(^(1))
"RTN","ORMPS2",47,0)
 . S PSOI=+$P($G(^ORD(101.43,OI,0)),U,2)
"RTN","ORMPS2",48,0)
 . I $P(OI0,U,2)=ORA,$G(ORX("A",PSOI)) D  Q
"RTN","ORMPS2",49,0)
 .. S INST=$P(OI0,U,3),STR=+ORX("A",PSOI),UNT=$P(ORX("A",PSOI),U,2)
"RTN","ORMPS2",50,0)
 .. S ADDFREQ=$P(ORX("A",PSOI),U,3)
"RTN","ORMPS2",51,0)
 .. I STR'=$G(ORX("STRENGTH",INST)) S Y=1 Q
"RTN","ORMPS2",52,0)
 .. I UNT'=$G(ORX("UNITS",INST)) S Y=1 Q
"RTN","ORMPS2",53,0)
 .. I $$ADDFRQCV^ORMBLDP1(ADDFREQ,"I")'=$G(ORX("ADDFREQ",INST)) S Y=1 Q
"RTN","ORMPS2",54,0)
 .. K ORX("A",PSOI) ;same
"RTN","ORMPS2",55,0)
 . I $P(OI0,U,2)=ORB,$G(ORX("B",PSOI)) D  Q
"RTN","ORMPS2",56,0)
 .. S INST=$P(OI0,U,3),VOL=+$G(ORX("B",PSOI))
"RTN","ORMPS2",57,0)
 .. I VOL'=$G(ORX("VOLUME",INST)) S Y=1 Q
"RTN","ORMPS2",58,0)
 .. K ORX("B",PSOI) ;same
"RTN","ORMPS2",59,0)
 . S Y=1
"RTN","ORMPS2",60,0)
 I $O(ORX("A",0))!$O(ORX("B",0)) S Y=1 ;leftover items - changed
"RTN","ORMPS2",61,0)
 Q Y
"RTN","ORMPS2",62,0)
 ;
"RTN","ORMPS2",63,0)
CHANGED() ; -- Compare ORMSG to order ORIFN, return 1 if different
"RTN","ORMPS2",64,0)
 N I,X,Y,X1,NTE,SIG,PI,TRXO S Y=0
"RTN","ORMPS2",65,0)
 I +$P($$FIND^ORM(+RXE,3),U,4)'=+$$VALUE("DRUG") S Y=1 G CHQ ;p.363 dispense drug change check
"RTN","ORMPS2",66,0)
 I $G(ORCAT)="I" D  G CHQ
"RTN","ORMPS2",67,0)
 . I $$WPX S Y=1 Q  ;Special Instructions
"RTN","ORMPS2",68,0)
 . S X=$$VALUE("DAYS") ;duration
"RTN","ORMPS2",69,0)
 . I $G(X)'="" D  I $G(X)'=X1 S Y=1 Q
"RTN","ORMPS2",70,0)
 . .S X=$$HL7IVLMT^ORMBLDP1(X)
"RTN","ORMPS2",71,0)
 . .S TRXO=$$RXO^ORMPS,X1=$P($P($G(TRXO),"|",2),U,3)
"RTN","ORMPS2",72,0)
 . .;S X1=$$DURATION^ORMPS3($P($P(TRXO,"|",2),U,3))
"RTN","ORMPS2",73,0)
 . I $$IVX S Y=1 Q  ;IV fields
"RTN","ORMPS2",74,0)
 ;S X=+$P($P(RXE,"|",3),U,4) I X'=+$$VALUE("DRUG") S Y=1 G CHQ
"RTN","ORMPS2",75,0)
 I +$$FIND^ORM(+RXE,11)'=+$$VALUE("QTY") S Y=1 G CHQ ;p.363 changed to $$FIND^ORM api
"RTN","ORMPS2",76,0)
 I +$$FIND^ORM(+RXE,13)'=+$$VALUE("REFILLS") S Y=1 G CHQ ;p.363 changed to $$FIND^ORM api
"RTN","ORMPS2",77,0)
 ;S X=$P(RXE,"|",23) S:$E(X)="D" X=+$E(X,2,99) I X'=+$$VALUE("SUPPLY") S Y=1 G CHQ
"RTN","ORMPS2",78,0)
 ;I $P(ZRX,"|",5)'=$$VALUE("PICKUP") S Y=1 G CHQ
"RTN","ORMPS2",79,0)
 S NTE=$$NTE^ORMPS3(21),SIG=+$O(^OR(100,+ORIFN,4.5,"ID","SIG",0)) ;verb
"RTN","ORMPS2",80,0)
 I NTE,SIG,$P($P(@ORMSG@(NTE),"|",4)," ")'=$P($G(^OR(100,+ORIFN,4.5,SIG,2,1,0))," ") S Y=1 G CHQ
"RTN","ORMPS2",81,0)
 S NTE=$$NTE^ORMPS3(7),PI=+$O(^OR(100,+ORIFN,4.5,"ID","PI",0))
"RTN","ORMPS2",82,0)
 I (NTE&'PI)!('NTE&PI) Q 1 ;added or deleted
"RTN","ORMPS2",83,0)
 I NTE,PI D  G CHQ ;compare text
"RTN","ORMPS2",84,0)
 . S PI=$$VALTXT^ORMPS3(+ORIFN,PI)_$$VALTXT^ORMPS3(+ORIFN,"COMMENT")
"RTN","ORMPS2",85,0)
 . S NTE=$$NTXT^ORMPS3(NTE)
"RTN","ORMPS2",86,0)
 . I $TR(NTE," ")'=$TR(PI," ") S Y=1 Q  ;comp text w/o spaces
"RTN","ORMPS2",87,0)
CHQ Q Y
"RTN","ORMPS2",88,0)
 ;
"RTN","ORMPS2",89,0)
VALUE(ID) ; -- Return value of ID in ^OR(100,+ORIFN,4.5,"ID")
"RTN","ORMPS2",90,0)
 N I,Y I '$L($G(ID)) Q ""
"RTN","ORMPS2",91,0)
 S I=+$O(^OR(100,+ORIFN,4.5,"ID",ID,0))
"RTN","ORMPS2",92,0)
 S Y=$G(^OR(100,+ORIFN,4.5,I,1))
"RTN","ORMPS2",93,0)
 Q Y
"RTN","ORMPS2",94,0)
 ;
"RTN","ORMPS2",95,0)
PTR(X) ; -- Return ptr to prompt OR GTX X
"RTN","ORMPS2",96,0)
 Q +$O(^ORD(101.41,"AB","OR GTX "_X,0))
"RTN","ORMPS2",97,0)
 ;
"RTN","ORMPS2",98,0)
RO ; -- Replacement order (finished)
"RTN","ORMPS2",99,0)
 N RXO,RXC,ORDIALOG,ORDG,ORPKG,ORDA,ORX,ORSIG,ORP,ZSC,NEWSTS
"RTN","ORMPS2",100,0)
 N ADMIN,IVTYPE
"RTN","ORMPS2",101,0)
 K ^TMP("ORWORD",$J)
"RTN","ORMPS2",102,0)
 I '$D(^VA(200,ORNP,0)) S ORERR="Missing or invalid ordering provider" Q
"RTN","ORMPS2",103,0)
 I 'RXE S ORERR="Missing or invalid RXE segment" Q
"RTN","ORMPS2",104,0)
 S RXO=$$RXO^ORMPS,RXC=$$RXC^ORMPS,ORIFN=+$G(ORIFN)
"RTN","ORMPS2",105,0)
 I ORIFN'>0 S ORERR="Missing or invalid order number" Q
"RTN","ORMPS2",106,0)
 D @($S(RXC:"IV",$G(ORCAT)="I":"UDOSE",1:"OUT")_"^ORMPS1") Q:$D(ORERR)
"RTN","ORMPS2",107,0)
 ;Check keep Admin Time with order if not define in the RXE segment on
"RTN","ORMPS2",108,0)
 ;verify
"RTN","ORMPS2",109,0)
 I RXC,$$VALUE("TYPE")="I" S ORDIALOG($$PTR("ADMIN TIMES"),1)=$$VALUE("ADMIN")
"RTN","ORMPS2",110,0)
 S ORDA=$$ACTION^ORCSAVE("XX",ORIFN,ORNP,"",ORNOW,ORWHO)
"RTN","ORMPS2",111,0)
 I ORDA'>0 S ORERR="Cannot create new order action" Q
"RTN","ORMPS2",112,0)
RO1 ; -Update sts of order to active, last action to dc/edit:
"RTN","ORMPS2",113,0)
 S ORX=ORDA F  S ORX=+$O(^OR(100,ORIFN,8,ORX),-1) Q:ORX'>0  I $D(^(ORX,0)),$P(^(0),U,15)="" Q  ;ORX=last released action
"RTN","ORMPS2",114,0)
 S:ORX $P(^OR(100,ORIFN,8,ORX,0),U,15)=12 ;dc/edit
"RTN","ORMPS2",115,0)
 S $P(^OR(100,ORIFN,3),U,7)=ORDA,NEWSTS=$S('$G(ORSTS):0,ORSTS=$P(^(3),U,3):0,1:1) K ^(6)
"RTN","ORMPS2",116,0)
 D STATUS^ORCSAVE2(ORIFN,ORSTS):NEWSTS,SETALL^ORDD100(ORIFN):'NEWSTS
"RTN","ORMPS2",117,0)
 D DATES^ORCSAVE2(ORIFN,ORSTRT,ORSTOP)
"RTN","ORMPS2",118,0)
 D RELEASE^ORCSAVE2(ORIFN,ORDA,ORNOW,ORWHO,ORNATR)
"RTN","ORMPS2",119,0)
 ; -If unsigned edit, leave XX unsigned & mark ORX as Sig Not Req'd
"RTN","ORMPS2",120,0)
 S ORSIG=$S($P($G(^OR(100,ORIFN,8,ORX,0)),U,4)'=2:1,1:0)
"RTN","ORMPS2",121,0)
 D SIGSTS^ORCSAVE2(ORIFN,ORDA):ORSIG,SIGN^ORCSAVE2(ORIFN,,,5,ORX):'ORSIG
"RTN","ORMPS2",122,0)
RO2 ; -Update responses, get/save new order text:
"RTN","ORMPS2",123,0)
 K ^OR(100,ORIFN,4.5) D RESPONSE^ORCSAVE,ORDTEXT^ORCSAVE1(ORIFN_";"_ORDA)
"RTN","ORMPS2",124,0)
 S $P(^OR(100,ORIFN,0),U,5)=ORDIALOG_";ORD(101.41,",$P(^(0),U,14)=ORPKG
"RTN","ORMPS2",125,0)
 I $P(^OR(100,ORIFN,0),U,11)'=ORDG D
"RTN","ORMPS2",126,0)
 . N DA,DR,DIE
"RTN","ORMPS2",127,0)
 . S DA=ORIFN,DR="23////"_ORDG,DIE="^OR(100," D ^DIE
"RTN","ORMPS2",128,0)
 S ^OR(100,ORIFN,4)=PKGIFN,$P(^(8,ORDA,0),U,14)=ORDA
"RTN","ORMPS2",129,0)
 S ORIFN=ORIFN_";"_ORDA,ORDCNTRL="SN" ;to send NA msg back
"RTN","ORMPS2",130,0)
 I $G(ORL) S ORP(1)=ORIFN_"^1" D PRINTS^ORWD1(.ORP,+ORL)
"RTN","ORMPS2",131,0)
 I $G(ORCAT)="O" S ZSC=$$ZSC^ORMPS3 I ZSC,$P(ZSC,"|",2)'?2.3U S ^OR(100,+ORIFN,5)=$TR($P(ZSC,"|",2,9),"|","^") ;1 or 0 instead of [N]SC in #100
"RTN","ORMPS2",132,0)
 Q
"RTN","ORMPS2",133,0)
IVLIM(IVDUR) ;
"RTN","ORMPS2",134,0)
 I $L(IVDUR) D
"RTN","ORMPS2",135,0)
 . N DURU,DURV S DURU="",DURV=0
"RTN","ORMPS2",136,0)
 . S DURU=$E(IVDUR,1),DURV=$E(IVDUR,2,$L(IVDUR))
"RTN","ORMPS2",137,0)
 . I IVDUR["dose" S DURV=$E(IVDUR,6,$L(IVDUR)),IVDUR="for a total of "_+DURV_$S(+DURV=1:" doses",+DURV>1:" doses",1:" dose") Q
"RTN","ORMPS2",138,0)
 . I (DURU="D")!(DURU="d") S IVDUR="for "_+DURV_$S(+DURV=1:" day",+DURV>1:" days",1:" day")
"RTN","ORMPS2",139,0)
 . I (DURU="H")!(DURU="h") S IVDUR="for "_+DURV_$S(+DURV=1:" hours",+DURV>1:" hours",1:" hour")
"RTN","ORMPS2",140,0)
 . I (DURU="M")!(DURU="m") S IVDUR="with total volume "_+DURV_" ml"
"RTN","ORMPS2",141,0)
 . I (DURU="L")!(DURU="l") S IVDUR="with total volume "_+DURV_" L"
"RTN","ORMPS2",142,0)
 Q IVDUR
"RTN","ORMPS2",143,0)
UNESC(STRING) ;
"RTN","ORMPS2",144,0)
 Q $$UNESC^ORHLESC(STRING)
"RTN","ORMPS2",145,0)
UNESCARR(ARR) ;
"RTN","ORMPS2",146,0)
 N I S I="" F  S I=$O(@ARR@(I)) Q:'$L(I)  D
"RTN","ORMPS2",147,0)
 .N IND S IND=$S(ARR["(":$E(ARR,0,$L(ARR)-1)_","""_I_""")",1:ARR_"("""_I_""")")
"RTN","ORMPS2",148,0)
 .N TYPE S TYPE=$D(@ARR@(I))
"RTN","ORMPS2",149,0)
 .I TYPE=11!(TYPE=10) D UNESCARR(IND)
"RTN","ORMPS2",150,0)
 .I TYPE=1!(TYPE=11) S @ARR@(I)=$$UNESC(@ARR@(I))
"RTN","ORMPS2",151,0)
 Q
"RTN","ORMPS2",152,0)
PCOMM ; -- Get Provider Comments from previous order, when changed
"RTN","ORMPS2",153,0)
 N OLD,I
"RTN","ORMPS2",154,0)
 S OLD=+$G(ORIFN) I OLD<1 S OLD=+$P(ZRX,"|",2) Q:OLD<1
"RTN","ORMPS2",155,0)
 S I=+$O(^OR(100,OLD,4.5,"ID","COMMENT",0)) Q:I<1
"RTN","ORMPS2",156,0)
 Q:'$O(^OR(100,OLD,4.5,I,2,0))  ;none
"RTN","ORMPS2",157,0)
 M ^TMP("ORWORD",$J,PC,1)=^OR(100,OLD,4.5,I,2)
"RTN","ORMPS2",158,0)
 S ORDIALOG(PC,1)="^TMP(""ORWORD"",$J,"_PC_",1)"
"RTN","ORMPS2",159,0)
 S ORDIALOG(PC,"FORMAT")="@" ;text in Sig already
"RTN","ORMPS2",160,0)
 Q
"RTN","ORPRS04")
0^84^B42879835
"RTN","ORPRS04",1,0)
ORPRS04 ;slc/dcm - Print Order summaries (SHRIVELED) ;09/30/15  11:55
"RTN","ORPRS04",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**11,69,92,121,350**;Dec 17, 1997;Build 77
"RTN","ORPRS04",3,0)
EN ;Print orders
"RTN","ORPRS04",4,0)
 I $$S^%ZTLOAD S (ZTSTOP,DIROUT,OREND)=1 W !!,"TASKED Report stopped by WHILE RUNNING." Q
"RTN","ORPRS04",5,0)
 N DIRUT,DUOUT,ORCONT,ORLINE,ORLSTO,ORDAD,ORLST,OREND,YENKO,SHELBY
"RTN","ORPRS04",6,0)
 K ORSPG
"RTN","ORPRS04",7,0)
 S YENKO=$$GET^XPAR("ALL","OR PRINT NO ORDERS ON SUM",1,"I"),SHELBY=$O(^TMP("ORR",$J,ORLIST,0))
"RTN","ORPRS04",8,0)
 ;YENKO=0 or "", if you don't want to print a page when no orders are present
"RTN","ORPRS04",9,0)
 ;      1 to print the page with "NO ORDERS" on it.
"RTN","ORPRS04",10,0)
 I 'YENKO,'SHELBY Q
"RTN","ORPRS04",11,0)
 S $P(ORLINE,"-",IOM+1)="",ORBOT=$S(IOSL<254:IOSL,1:254),Y=+ORVP,ORDAD="",OREND=0
"RTN","ORPRS04",12,0)
 D END^ORUDPA
"RTN","ORPRS04",13,0)
 S ORREQ("O")=""
"RTN","ORPRS04",14,0)
 I $Y+11>IOSL,$E(IOST)="P" W @IOF
"RTN","ORPRS04",15,0)
 I '$G(ORSPG) S ORSPG=1 D
"RTN","ORPRS04",16,0)
 . I $E(IOST)="C" D CTOP^ORPRS05(ORSPG,$G(ORSEND),$G(ORSPG("EOP")),ORTIT,ORSHORT,ORL(0),ORL(1),ORWARD,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD)) Q
"RTN","ORPRS04",17,0)
 . D PTOP^ORPRS05(ORSPG,ORTIT,ORSHORT,ORSSTRT,ORSSTOP)
"RTN","ORPRS04",18,0)
 D PTHDR
"RTN","ORPRS04",19,0)
 I '$O(^TMP("ORR",$J,ORLIST,0)) W !!?3,"No orders.",!,ORLINE D  Q
"RTN","ORPRS04",20,0)
 . S ORSPG("EOP")=1
"RTN","ORPRS04",21,0)
 . I $E(IOST)="C" D  Q
"RTN","ORPRS04",22,0)
 .. K Y F  Q:$G(Y)["^"!($G(Y)=-1)  K DIR S DIR(0)="FO^1;2",DIR("A")="Press RETURN to continue or '^' to exit" D ^DIR S:Y="" Y=-1 K DIR Q:Y<0  D
"RTN","ORPRS04",23,0)
 ... I Y'["^" W $C(7),!!,"Enter '^' to stop listing for current patient"
"RTN","ORPRS04",24,0)
 . D PBOT^ORPRS05(1,ORBOT,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD),ORL(0),ORL(1),$G(ORSHORT))
"RTN","ORPRS04",25,0)
 . I '$G(ORSEND) Q
"RTN","ORPRS04",26,0)
 . W !!!!!?(IOM-44)\2,"*****    E N D    O F    R E P O R T    ****",!
"RTN","ORPRS04",27,0)
 . K ORSEND,ORSPG,ORCONT
"RTN","ORPRS04",28,0)
 S ORCONT=1,ORLSTO=0,ORLST=0
"RTN","ORPRS04",29,0)
 F  S ORLST=$O(^TMP("ORR",$J,ORLIST,ORLST)) Q:'ORLST!$D(DUOUT)  D PRT Q:OREND
"RTN","ORPRS04",30,0)
 Q:OREND!$D(DUOUT)!$D(DTOUT)!$G(ORSPG("LAST"))
"RTN","ORPRS04",31,0)
 S ORLSTO=1
"RTN","ORPRS04",32,0)
 D PGCHK()
"RTN","ORPRS04",33,0)
 Q
"RTN","ORPRS04",34,0)
PRT ;Print order line
"RTN","ORPRS04",35,0)
 N ORXPND,OACTION,ORIFN,ORASTS,ORSTS,ORTX,ORODT,ORSTOP,ORUSER,ORSTRT,ORMD,OREL,ORFLAG,ORNAT
"RTN","ORPRS04",36,0)
 S ORIFN=+^TMP("ORR",$J,ORLIST,ORLST),OACTION=$P(^(ORLST),";",2)
"RTN","ORPRS04",37,0)
 I ORSHORT,$G(ORSPG("EOP")) S ORREQ("O")="" D PTOP^ORPRS05(ORSPG,ORTIT,ORSHORT,ORSSTRT,ORSSTOP),PTHDR S ORSPG("EOP")=0
"RTN","ORPRS04",38,0)
 I 'ORSHORT,$G(ORSPG("EOP")) D:$E(IOST)="C" CTOP^ORPRS05(ORSPG,$G(ORSEND),$G(ORSPG("EOP")),ORTIT,ORSHORT,ORL(0),ORL(1),ORWARD,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD)) S ORSPG("EOP")=ORSPG
"RTN","ORPRS04",39,0)
 I $G(ORSPG(0))'=ORSPG S (ORREQ("O"),ORREQ("TIT",0))="",ORSPG(0)=ORSPG
"RTN","ORPRS04",40,0)
 Q:'$D(^OR(100,ORIFN,0))  S X=^(0),X3=$S($D(^(3)):^(3),1:""),ORDAD=$O(^(2,0))
"RTN","ORPRS04",41,0)
 S ORREQ=$P(X,"^",4),ORODT=$P(X,"^",7),ORSTOP=$P(X,"^",9),ORUSER=$P(X,"^",6),ORSTS=$P(X3,"^",3),ORSTRT=$P(X,"^",8),ORMD=$P(X3,"^",13),OREL=$S(ORSTS=11:1,1:"")
"RTN","ORPRS04",42,0)
 I $D(^OR(100,ORIFN,8,OACTION,0)) S X=^(0),ORODT=+X,ORREQ=$P(X,"^",3),ORMD=$P(X,"^",4),ORNAT=$P(X,"^",12),ORUSER=$P(X,"^",13),ORASTS=$P(X,"^",15),OREL=$S(ORASTS=11:1,1:"")
"RTN","ORPRS04",43,0)
 S ORREQ=$S(ORREQ:$S($D(^VA(200,ORREQ,0)):$P(^(0),"^"),1:"UNKNOWN"),1:"UNKNOWN"),ORREQ("TIT")=" " I ORREQ'="UNKNOWN" S X=$P(^(0),U,9),ORREQ("TIT")=$P($G(^DIC(3.1,+X,0)),U) I ORREQ("TIT")']"" S ORREQ("TIT")=" "
"RTN","ORPRS04",44,0)
 D TEXT^ORQ12(.ORTX,$S($G(OACTION):ORIFN_";"_OACTION,1:ORIFN),40)
"RTN","ORPRS04",45,0)
 S X=$P(ORREQ,",",2),ORREQ=$E($P(ORREQ,","),1,8)_","_$S($E(X)=" ":$E(X,$F(X,"")),1:$E(X))
"RTN","ORPRS04",46,0)
 S:ORREQ'=ORREQ("O") ORREQ("O")=ORREQ,ORREQ("F")=1,ORREQ("TIT",0)=""
"RTN","ORPRS04",47,0)
 S:'ORREQ("F")&(ORREQ=ORREQ("O")) ORREQ="    """
"RTN","ORPRS04",48,0)
 S ORREQ("F")=0
"RTN","ORPRS04",49,0)
 S:ORREQ("TIT")'=$G(ORREQ("TIT",0)) ORREQ("TIT",0)=ORREQ("TIT"),ORREQ("F")=1
"RTN","ORPRS04",50,0)
 S:'ORREQ("F")&(ORREQ("TIT")=ORREQ("TIT",0)) ORREQ("TIT")="    """
"RTN","ORPRS04",51,0)
 S ORREQ("F")=0
"RTN","ORPRS04",52,0)
STS ;
"RTN","ORPRS04",53,0)
 S ORSTS=$S($G(ORASTS)!(ORSTS):" "_$P(^ORD(100.01,$S($G(ORASTS):ORASTS,1:ORSTS),.1),"^"),1:" ")
"RTN","ORPRS04",54,0)
 D:'$D(ORTERM(5)) TERM^ORPRS01(IOST)
"RTN","ORPRS04",55,0)
 S ORFLAG=$$FLAG^ORPRS03(ORIFN,ORTERM(5))
"RTN","ORPRS04",56,0)
 S ORXPND=$O(ORTX(""),-1)
"RTN","ORPRS04",57,0)
 D PGCHK(ORXPND+1)
"RTN","ORPRS04",58,0)
 Q:OREND
"RTN","ORPRS04",59,0)
 W !!
"RTN","ORPRS04",60,0)
 S X=$P(ORTERM(7),"^")
"RTN","ORPRS04",61,0)
 S:OREL X=$$INV^ORU
"RTN","ORPRS04",62,0)
 W:$L(ORODT) $E(ORODT,4,5)_"/"_$E(ORODT,6,7)_"/"_$E(ORODT,2,3)
"RTN","ORPRS04",63,0)
 W ?8,ORSTS,?12,$S(ORDAD:"+",1:" ")
"RTN","ORPRS04",64,0)
 W:$O(ORTX(0)) ORTX($O(ORTX(0)))
"RTN","ORPRS04",65,0)
 W ?54,ORREQ W:$L(ORSTRT) ?65,$E(ORSTRT,4,5)_"/"_$E(ORSTRT,6,7)_"/"_$E(ORSTRT,2,3)
"RTN","ORPRS04",66,0)
 W:$L(ORSTOP) ?75,$E(ORSTOP,4,5)_"/"_$E(ORSTOP,6,7)
"RTN","ORPRS04",67,0)
 W !?3,$$MTIM(ORODT),?13
"RTN","ORPRS04",68,0)
 S X=$O(ORTX(0))
"RTN","ORPRS04",69,0)
 I X W:$O(ORTX(X)) ORTX($O(ORTX(X)))
"RTN","ORPRS04",70,0)
 W ?54,$E(ORREQ("TIT"),1,10),?68,$$MTIM(ORSTRT),?75,$$MTIM(ORSTOP)
"RTN","ORPRS04",71,0)
 S X=0 F I=1:1 S X=$O(ORTX(X)) Q:'X  I I>2 W !?13,ORTX(X) D:($Y>(IOSL-5)) PGCHK(ORXPND-I) Q:OREND
"RTN","ORPRS04",72,0)
 Q:OREND
"RTN","ORPRS04",73,0)
 W !
"RTN","ORPRS04",74,0)
 I $$GET^XPAR("ALL","ORPF INITIALS ON SUMMARY",1,"I"),ORUSER W ?1,$P($G(^VA(200,ORUSER,0)),"^",2)
"RTN","ORPRS04",75,0)
 I $D(^OR(100,ORIFN,8,OACTION,0)) S X=^(0) D
"RTN","ORPRS04",76,0)
 . N NATURE,SIGSTS,NURSE,REVIEW
"RTN","ORPRS04",77,0)
 . S SIGSTS=$P(X,"^",4),NATURE=$P(X,"^",12),NURSE=$P(X,"^",8),REVIEW=$P(X,"^",18)
"RTN","ORPRS04",78,0)
 . I $L(SIGSTS) S SIGSTS=$$SET(100.008,4,SIGSTS)
"RTN","ORPRS04",79,0)
 . I NATURE S NATURE=$P($G(^ORD(100.02,NATURE,0)),"^")
"RTN","ORPRS04",80,0)
 . I NURSE S NURSE=$P($G(^VA(200,NURSE,0)),"^",2)
"RTN","ORPRS04",81,0)
 . I REVIEW S REVIEW=$P($G(^VA(200,REVIEW,0)),"^",2)
"RTN","ORPRS04",82,0)
 . W:$L(NURSE) ?9,"Nrs:"_NURSE
"RTN","ORPRS04",83,0)
 . W:$L(REVIEW) ?19,"Chrt:"_REVIEW
"RTN","ORPRS04",84,0)
 . W:$L(NATURE) ?30,"Typ:"_$E(NATURE,1,18)
"RTN","ORPRS04",85,0)
 . W:$L(SIGSTS) ?54,"Sgn:"_$E(SIGSTS,1,25)
"RTN","ORPRS04",86,0)
 I $D(^OR(100,ORIFN,5,0)) S J=0 F  S J=$O(^OR(100,ORIFN,5,J)) Q:'J  W !?13,^(J,0)
"RTN","ORPRS04",87,0)
 I ORDAD D  Q:OREND
"RTN","ORPRS04",88,0)
 . N I,ORSEQ
"RTN","ORPRS04",89,0)
 . S I=0,ORSEQ=0,ORTIT(0)=ORTIT
"RTN","ORPRS04",90,0)
 . D KIDS(ORIFN)
"RTN","ORPRS04",91,0)
 . S ORTIT=ORTIT(0)
"RTN","ORPRS04",92,0)
 I OREL W !?66,"*UNRELEASED*" S X=$P(ORTERM(7),U,3),X=$$INV^ORU
"RTN","ORPRS04",93,0)
 S ORSPG("LAST")='$O(^TMP("ORR",$J,ORLIST,ORLST)),ORCONT='ORSPG("LAST")
"RTN","ORPRS04",94,0)
 D PGCHK()
"RTN","ORPRS04",95,0)
 Q
"RTN","ORPRS04",96,0)
PGCHK(CNT) ;
"RTN","ORPRS04",97,0)
 N DIR,X,I
"RTN","ORPRS04",98,0)
 S:'$D(CNT) CNT=0
"RTN","ORPRS04",99,0)
 I $G(ORSPG("LAST")) W !!,?32,"* END OF ORDERS *" W:'$G(ORSHORT) !,ORLINE D
"RTN","ORPRS04",100,0)
 . I $E(IOST)="P" D PBOT^ORPRS05(ORSPG,IOSL,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD),ORL(0),ORL(1),$G(ORSHORT)) I '$G(ORSHORT)!($Y+15>IOSL) W @IOF
"RTN","ORPRS04",101,0)
 . I $E(IOST)="C" W ! S DIR(0)="FO^1;2",DIR("A")="Press RETURN to continue, '^' to exit" D ^DIR I $D(DUOUT) S OREND=1 Q
"RTN","ORPRS04",102,0)
 I $G(ORSEND),$G(ORLSTO) D  K ORSEND,ORCONT Q
"RTN","ORPRS04",103,0)
 . W !?(IOM-44)\2,"*****    E N D    O F    R E P O R T    ****",!
"RTN","ORPRS04",104,0)
 . I $E(IOST)="C" W ! S DIR(0)="FO^1;2",DIR("A")="Press RETURN to continue, '^' to exit" D ^DIR I $D(DUOUT) S OREND=1 Q
"RTN","ORPRS04",105,0)
 I $G(ORSPG("LAST")) Q
"RTN","ORPRS04",106,0)
 I $E(IOST)="C" D  Q
"RTN","ORPRS04",107,0)
 . I ((IOSL-$Y)>(4+CNT))!(CNT+4>(IOSL-3)) Q
"RTN","ORPRS04",108,0)
 . S ORSPG=$G(ORSPG)+1
"RTN","ORPRS04",109,0)
 . W !
"RTN","ORPRS04",110,0)
 . S DIR(0)="FO^1;2",DIR("A")="Press RETURN to continue or '^' to exit"
"RTN","ORPRS04",111,0)
 . D ^DIR
"RTN","ORPRS04",112,0)
 . I $D(DUOUT) K ORSEND,ORCONT S OREND=1 Q
"RTN","ORPRS04",113,0)
 . D CTOP^ORPRS05(ORSPG,$G(ORSEND),$G(ORSPG("EOP")),ORTIT,ORSHORT,ORL(0),ORL(1),ORWARD,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD))
"RTN","ORPRS04",114,0)
 . S ORSPG=0
"RTN","ORPRS04",115,0)
 . I $G(ORCONT) D PTHDR
"RTN","ORPRS04",116,0)
 I ((IOSL-$Y)>(6+CNT))!(CNT+6>(IOSL-5)) Q
"RTN","ORPRS04",117,0)
 D PBOT^ORPRS05(ORSPG,IOSL,ORPNM,ORSSN,ORDOB,ORAGE,$G(ORPD),ORL(0),ORL(1),$G(ORSHORT))
"RTN","ORPRS04",118,0)
 S ORSPG=ORSPG+1
"RTN","ORPRS04",119,0)
 W @IOF
"RTN","ORPRS04",120,0)
 D PTOP^ORPRS05(ORSPG,ORTIT,ORSHORT,ORSSTRT,ORSSTOP)
"RTN","ORPRS04",121,0)
 I $G(ORCONT) D PTHDR
"RTN","ORPRS04",122,0)
 Q
"RTN","ORPRS04",123,0)
PTHDR ;
"RTN","ORPRS04",124,0)
 W !,ORPNM_"   "_$G(ORSSN)_" "_$S($G(ORCONT):"(cont.)",1:"")_" "
"RTN","ORPRS04",125,0)
 S X=$P(ORWARD,"^",2)_"  "_ORL(1)
"RTN","ORPRS04",126,0)
 W ?(80-$L(X))\2,X
"RTN","ORPRS04",127,0)
 Q
"RTN","ORPRS04",128,0)
KIDS(ORIFN,LENGTH) ;Print child orders
"RTN","ORPRS04",129,0)
 N ORCHLD,OROIFN
"RTN","ORPRS04",130,0)
 S OROIFN=ORIFN,ORCHLD=0
"RTN","ORPRS04",131,0)
 F I=0:0 S ORCHLD=$O(^OR(100,OROIFN,2,ORCHLD)) Q:ORCHLD<1  D PGCHK() Q:OREND  S ORIFN=ORCHLD D ONE^ORPRS03(ORCHLD,"         ",$G(LENGTH))
"RTN","ORPRS04",132,0)
 Q
"RTN","ORPRS04",133,0)
MTIM(X) ;Format time from Fileman date in X
"RTN","ORPRS04",134,0)
 I '$G(X) Q ""
"RTN","ORPRS04",135,0)
 S X=$P(X,".",2)
"RTN","ORPRS04",136,0)
 Q:'$L(X) ""
"RTN","ORPRS04",137,0)
 S X=$E(X,1,2)_$E("00",0,2-$L($E(X,1,2)))_":"_$E(X,3,4)_$E("00",0,2-$L($E(X,3,4)))
"RTN","ORPRS04",138,0)
 Q X
"RTN","ORPRS04",139,0)
SET(FILE,FIELD,RESULT) ;Interpret set of codes
"RTN","ORPRS04",140,0)
 S X=$P(^DD(FILE,FIELD,0),"^",3),X=$P($P(";"_X,";"_RESULT_":",2),";")
"RTN","ORPRS04",141,0)
 Q X
"RTN","ORQ11")
0^9^B65899286
"RTN","ORQ11",1,0)
ORQ11 ;SLC/DCM - Get patient orders in context ;07/27/12  14:34
"RTN","ORQ11",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**7,27,48,72,78,99,94,148,141,177,186,190,195,215,243,295,322,350**;Dec 17, 1997;Build 77
"RTN","ORQ11",3,0)
LOOP ; -- main loop through "ACT" x-ref
"RTN","ORQ11",4,0)
 I $G(XREF)="AW" D AW Q
"RTN","ORQ11",5,0)
 I $G(FLG)=27 D EXPD^ORQ12 Q
"RTN","ORQ11",6,0)
 K ^TMP("ORGOTIT",$J)
"RTN","ORQ11",7,0)
AWIN ;Jump in here to add active orders to AW context
"RTN","ORQ11",8,0)
 N TM,TO,IFN,X0,X3,X7,X8,USTS,NOW,ACTOR,X ;195
"RTN","ORQ11",9,0)
 S NOW=+$E($$NOW^XLFDT,1,12),TM=SDATE
"RTN","ORQ11",10,0)
 F  S TM=$O(^OR(100,"ACT",PAT,TM)) Q:'TM!(TM>EDATE)  S TO=0 F  S TO=$O(^OR(100,"ACT",PAT,TM,TO)) Q:'TO  I $D(ORGRP(TO)) D
"RTN","ORQ11",11,0)
 . S IFN=0 F  S IFN=$O(^OR(100,"ACT",PAT,TM,TO,IFN)) Q:'IFN  I ('$D(^TMP("ORGOTIT",$J,IFN))!MULT),$D(^OR(100,IFN,0)),$D(^(3)) S X0=^(0),X3=^(3) D
"RTN","ORQ11",12,0)
 .. S ACTOR=0 F  S ACTOR=$O(^OR(100,"ACT",PAT,TM,TO,IFN,ACTOR)) Q:ACTOR<1  I '$D(^TMP("ORGOTIT",$J,IFN,ACTOR)),$D(^OR(100,IFN,8,ACTOR,0)),$P(^(0),U,15)'=13!(FLG=1) S X8=^(0),X7=$G(^(7)) D LP1
"RTN","ORQ11",13,0)
 S ^TMP("ORR",$J,ORLIST,"TOT")=ORLST
"RTN","ORQ11",14,0)
 Q
"RTN","ORQ11",15,0)
AW ; -- loop through "AW" x-ref
"RTN","ORQ11",16,0)
 K ^TMP("ORGOTIT",$J),^TMP("ORSORT",$J)
"RTN","ORQ11",17,0)
 N TM,TO,IFN,X0,X3,X7,X8,USTS,NOW,ACTOR,X ;195
"RTN","ORQ11",18,0)
 S NOW=+$E($$NOW^XLFDT,1,12),TO=0,SDATE=9999999-SDATE,EDATE=9999999-EDATE
"RTN","ORQ11",19,0)
 F  S TO=$O(^OR(100,"AW",PAT,TO)) Q:'TO  I $D(ORGRP(TO)) S TM=EDATE F  S TM=$O(^OR(100,"AW",PAT,TO,TM)) Q:'TM!(TM>SDATE)!(+TM<EDATE)  D
"RTN","ORQ11",20,0)
 . S IFN=0 F  S IFN=$O(^OR(100,"AW",PAT,TO,TM,IFN)) Q:'IFN  I ('$D(^TMP("ORGOTIT",$J,IFN))!MULT) D
"RTN","ORQ11",21,0)
 .. S ^TMP("ORSORT",$J,9999999-TM,TO,IFN)=""
"RTN","ORQ11",22,0)
 S TM=0 F  S TM=$O(^TMP("ORSORT",$J,TM)) Q:'TM  S TO=0 F  S TO=$O(^TMP("ORSORT",$J,TM,TO)) Q:'TO  D
"RTN","ORQ11",23,0)
 . S IFN=0 F  S IFN=$O(^TMP("ORSORT",$J,TM,TO,IFN)) Q:'IFN  I $D(^OR(100,IFN,0)),$D(^(3)) S X0=^(0),X3=^(3) D
"RTN","ORQ11",24,0)
 .. S ACTOR=0 F  S ACTOR=$O(^OR(100,"ACT",PAT,9999999-$P(X0,U,7),TO,IFN,ACTOR)) Q:ACTOR<1  I '$D(^TMP("ORGOTIT",$J,IFN,ACTOR)),$D(^OR(100,IFN,8,ACTOR,0)),$P(^(0),U,15)'=13 S X8=^(0),X7=$G(^(7)) D LP1
"RTN","ORQ11",25,0)
 S ^TMP("ORR",$J,ORLIST,"TOT")=ORLST
"RTN","ORQ11",26,0)
 I +$$GET^XPAR("SYS","OR ORDER SUMMARY CONTEXT",1,"I")=2 S SDATE=9999999-SDATE,EDATE=9999999-EDATE D AWIN
"RTN","ORQ11",27,0)
 K ^TMP("ORSORT",$J),^TMP("ORGOTIT",$J)
"RTN","ORQ11",28,0)
 Q
"RTN","ORQ11",29,0)
LP1 ; -- main secondary loop
"RTN","ORQ11",30,0)
 N STS ;195
"RTN","ORQ11",31,0)
 N TAG
"RTN","ORQ11",32,0)
 Q:$P(X3,U,8)  Q:$P(X3,U,3)=99  S STS=$P(X3,U,3)
"RTN","ORQ11",33,0)
 I '$G(GETKID),$P(X3,U,9),'$P($G(^OR(100,$P(X3,U,9),3)),U,8),FLG'=11 Q
"RTN","ORQ11",34,0)
 I $L($P(X0,U,17)),"^10^11^"[(U_STS_U) S X=$$LAPSED^OREVNTX($P(X0,U,17))
"RTN","ORQ11",35,0)
 S TAG=$S(FLG=2:"CUR1",FLG=4:"COM1",FLG=5:"EXG1",FLG=7:"PEN1",FLG=8:"UVR1",FLG=9:"UVN1",FLG=10:"UVC1",FLG=12:"FLG1",FLG=13:"VP1",FLG=14:"VPU1",FLG=18:"HLD1",FLG=20:"CHT1",FLG=21:"CHTSUM",FLG=22:"LPS1",FLG=23:"AVT1",1:"ALL1")
"RTN","ORQ11",36,0)
 I TAG="ALL1" S TAG=$S(FLG=3:"DC1",FLG=28:"DC1",1:"ALL1")
"RTN","ORQ11",37,0)
 D @TAG
"RTN","ORQ11",38,0)
 Q
"RTN","ORQ11",39,0)
 ; ** FLG context specific loops:
"RTN","ORQ11",40,0)
 ;
"RTN","ORQ11",41,0)
ALL1 ; 1 -- secondary pass for All, Recent Orders, Unsigned
"RTN","ORQ11",42,0)
 D GET^ORQ12(IFN,ORLIST,DETAIL,$G(ACTOR))
"RTN","ORQ11",43,0)
 Q
"RTN","ORQ11",44,0)
 ;
"RTN","ORQ11",45,0)
CUR ; 2 -- Active/Current
"RTN","ORQ11",46,0)
 N X,X0,X1,X2,X3,X8,%H,YD,%,TM,IFN,ACTOR,NORX,OIEN,OACT
"RTN","ORQ11",47,0)
 I $G(GROUP)=$O(^ORD(100.98,"B","ALL SERVICES",0)),$G(ORWARD),$G(DGPMT)'=1 S NORX=U_$O(^ORD(100.98,"B","O RX",0))_U_$O(^ORD(100.98,"B","NON-VA MEDICATIONS",0))_U
"RTN","ORQ11",48,0)
 S X2=+$$GET^XPAR("SYS","ORPF ACTIVE ORDERS CONTEXT HRS",1,"I"),X=$H,X=+X*24+($P(X,",",2)/3600),X1=X-X2,X3=X1#24,X1=X1\24,X2=$J(X3*3600,0,0),%H=X1_","_X2 D YMD^%DTC S YD=+(X_%)
"RTN","ORQ11",49,0)
 S TM=SDATE F  S TM=$O(^OR(100,"AC",PAT,TM)) Q:TM<1!(TM>EDATE)  S IFN=0 F  S IFN=$O(^OR(100,"AC",PAT,TM,IFN)) Q:IFN<1  I $D(^OR(100,IFN,0)),$D(^(3)) S X0=^(0),X3=^(3) D
"RTN","ORQ11",50,0)
 . Q:'$D(ORGRP($P(X0,U,11)))  S ACTOR=0
"RTN","ORQ11",51,0)
 . F  S ACTOR=$O(^OR(100,"AC",PAT,TM,IFN,ACTOR)) Q:ACTOR<1  I $D(^OR(100,IFN,8,ACTOR,0)) S X8=^(0) D
"RTN","ORQ11",52,0)
 .. I "^10^12^"[(U_$P(X8,U,15)_U) K ^OR(100,"AC",PAT,TM,IFN,ACTOR) Q
"RTN","ORQ11",53,0)
 .. I $P(X8,U,15)=13,$P(X8,U)<YD K ^OR(100,"AC",PAT,TM,IFN,ACTOR) Q
"RTN","ORQ11",54,0)
 .. I $P(X8,U,15)="",ACTOR'=$P(X3,U,7) K ^OR(100,"AC",PAT,TM,IFN,ACTOR) Q
"RTN","ORQ11",55,0)
 .. ;AGP waiting for approval change to remove duplicate orders for DC reason
"RTN","ORQ11",56,0)
 .. ;I ACTOR>0,$P($G(^OR(100,IFN,8,ACTOR,0)),U,2)="DC" S OIEN=IFN,OACT=ACTOR
"RTN","ORQ11",57,0)
 .. ;I OIEN=IFN,OACT>ACTOR K ^OR(100,"AC",PAT,TM,IFN,ACTOR) Q
"RTN","ORQ11",58,0)
 .. D LP1
"RTN","ORQ11",59,0)
 S ^TMP("ORR",$J,ORLIST,"TOT")=ORLST
"RTN","ORQ11",60,0)
 Q
"RTN","ORQ11",61,0)
CUR1 ; 2 -- secondary pass for Active/Current
"RTN","ORQ11",62,0)
 N STOP S STOP=$P(X0,U,9)
"RTN","ORQ11",63,0)
 I STS=10 K ^OR(100,"AC",PAT,TM,IFN) Q  ;no delayed orders
"RTN","ORQ11",64,0)
 N EVNT S EVNT=$P(X0,U,17)
"RTN","ORQ11",65,0)
 I STS=13,EVNT,'$D(^ORE(100.2,EVNT,1)) Q  ;DJE/VM *322 no cancelled orders linked to unreleased delay
"RTN","ORQ11",66,0)
 I $P(X8,U,4)=2,$P(X8,U,15)=11 G CURX ;incl all unsig/unrel actions
"RTN","ORQ11",67,0)
 I '$D(YD),"^1^2^7^12^13^14^"[(U_STS_U) K ^OR(100,"AC",PAT,TM,IFN) Q
"RTN","ORQ11",68,0)
 I $D(YD),"^1^2^7^12^13^14^"[(U_STS_U),STOP<YD K ^OR(100,"AC",PAT,TM,IFN) Q
"RTN","ORQ11",69,0)
 I $G(NORX)[(U_$P(X0,U,11)_U) Q  ;skip Rx for inpatients
"RTN","ORQ11",70,0)
CURX D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",71,0)
 Q
"RTN","ORQ11",72,0)
 ;
"RTN","ORQ11",73,0)
DC1 ; 3 -- secondary pass for DC
"RTN","ORQ11",74,0)
 I FLG=28 D GETEIE^ORQ12(IFN,ORLIST,DETAIL,ACTOR) Q
"RTN","ORQ11",75,0)
 I STS=1!(STS=13)!(STS=12) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",76,0)
 Q
"RTN","ORQ11",77,0)
 ;
"RTN","ORQ11",78,0)
COM1 ; 4 -- secondary pass for Completed/Expired
"RTN","ORQ11",79,0)
 N STOP S STOP=$P(X0,U,9)
"RTN","ORQ11",80,0)
 I STS=2!(STS=7)!($L(STOP)&(STOP<NOW)&(STS'=1)&(STS'=13)&(STS'=12)) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",81,0)
 Q
"RTN","ORQ11",82,0)
 ;
"RTN","ORQ11",83,0)
EXG ; 5 -- Expiring
"RTN","ORQ11",84,0)
 N ORNG,ORDT,ORDW,ORHOL,X,Y,%DT,DIC,TMW,NOW ;195
"RTN","ORQ11",85,0)
 F ORNG=1:1 D  I ORHOL=0,ORDW=0 Q
"RTN","ORQ11",86,0)
 . S ORDT=$$FMADD^XLFDT(DT,ORNG),ORDW=$S($H-4+ORNG#7>4:1,1:0)
"RTN","ORQ11",87,0)
 . S DIC="^HOLIDAY(",X=$P(ORDT,".")
"RTN","ORQ11",88,0)
 . D ^DIC S ORHOL=$S(+$G(Y)>0:1,1:0)
"RTN","ORQ11",89,0)
 S %DT="",X="T+"_ORNG D ^%DT
"RTN","ORQ11",90,0)
 S TMW=Y_".9999",NOW=+$E($$NOW^XLFDT,1,12)
"RTN","ORQ11",91,0)
 D CUR ;D LOOP
"RTN","ORQ11",92,0)
 Q
"RTN","ORQ11",93,0)
EXG1 ; 5 -- secondary pass for Expiring
"RTN","ORQ11",94,0)
 N STOP S STOP=$P(X0,U,9)
"RTN","ORQ11",95,0)
 I STS'=1,STS'=2,STS'=7,STS'>9,STOP>NOW,STOP'>TMW D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",96,0)
 Q
"RTN","ORQ11",97,0)
 ;
"RTN","ORQ11",98,0)
ACT ; 6 -- Recent Activity (Order Summary)
"RTN","ORQ11",99,0)
 ;N ORLSIGN S ORLSIGN=$$GET^XPAR("ALL","OR ORDER REVIEW DT","`"_+PAT,"Q")
"RTN","ORQ11",100,0)
 N TM,IFN,X0,X3,ACTOR,X8
"RTN","ORQ11",101,0)
 S TM=SDATE F  S TM=$O(^OR(100,"AR",PAT,TM)) Q:TM<1!(TM>EDATE)  D
"RTN","ORQ11",102,0)
 . S IFN=0 F  S IFN=$O(^OR(100,"AR",PAT,TM,IFN)) Q:IFN<1  S X0=$G(^OR(100,IFN,0)),X3=$G(^(3)) I $D(ORGRP(+$P(X0,U,11))) D
"RTN","ORQ11",103,0)
 .. S ACTOR=0 F  S ACTOR=$O(^OR(100,"AR",PAT,TM,IFN,ACTOR)) Q:ACTOR<1  I $D(^OR(100,IFN,8,ACTOR,0)),$P(^(0),U,15)'=13 S X8=^(0) D LP1
"RTN","ORQ11",104,0)
 S ^TMP("ORR",$J,ORLIST,"TOT")=ORLST
"RTN","ORQ11",105,0)
 Q
"RTN","ORQ11",106,0)
 ;
"RTN","ORQ11",107,0)
PEN1 ; 7 -- secondary pass for Pending
"RTN","ORQ11",108,0)
 I STS=5 D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",109,0)
 Q
"RTN","ORQ11",110,0)
 ;
"RTN","ORQ11",111,0)
UVR1 ; 8 -- secondary pass for Unverified
"RTN","ORQ11",112,0)
 ;      Include if: unverified, released, inpt, not repl/canc/lapsed
"RTN","ORQ11",113,0)
 I '$P(X8,U,9),'$P(X8,U,11),$P(X8,U,15)="",$$INPT,"^12^13^14^"'[(U_STS_U) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",114,0)
 Q
"RTN","ORQ11",115,0)
 ;
"RTN","ORQ11",116,0)
UVN1 ; 9 -- secondary pass for Unverified/Nurse
"RTN","ORQ11",117,0)
 ;      Include if: unverified, released, inpt, not repl/canc/lapsed
"RTN","ORQ11",118,0)
 I '$P(X8,U,9),$P(X8,U,15)="",$$INPT,"^12^13^14^"'[(U_STS_U) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",119,0)
 Q
"RTN","ORQ11",120,0)
 ;
"RTN","ORQ11",121,0)
UVC1 ; 10 -- secondary pass for Unverified/Clerk
"RTN","ORQ11",122,0)
 ;       Include if: unverified, released, inpt, not repl/canc/lapsed
"RTN","ORQ11",123,0)
 I '$P(X8,U,11),$P(X8,U,15)="",$$INPT,"^12^13^14^"'[(U_STS_U) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",124,0)
 Q
"RTN","ORQ11",125,0)
 ;
"RTN","ORQ11",126,0)
INPT() ; -- Returns 1 or 0, if inpt order using X0=^OR(100,IFN,0)
"RTN","ORQ11",127,0)
 I ($P(X0,U,12)="I")!($$TYPE^OREVNTX($P(X0,U,17))="D") Q 1
"RTN","ORQ11",128,0)
 I $P($G(^SC(+$P(X0,U,10),0)),U,3)="W" Q 1 ;UNCOMMENTED IN *295
"RTN","ORQ11",129,0)
 Q 0
"RTN","ORQ11",130,0)
 ;
"RTN","ORQ11",131,0)
SIG ; 11 -- Unsigned
"RTN","ORQ11",132,0)
 N TM,IFN,X0,X3,ACTOR S TM=SDATE
"RTN","ORQ11",133,0)
 F  S TM=$O(^OR(100,"AS",PAT,TM)) Q:TM<1!(TM>EDATE)  S IFN=0 F  S IFN=$O(^OR(100,"AS",PAT,TM,IFN)) Q:IFN<1  D
"RTN","ORQ11",134,0)
 . S X0=$G(^OR(100,IFN,0)),X3=$G(^(3))
"RTN","ORQ11",135,0)
 . I X0="" K ^OR(100,"AS",PAT,TM,IFN) Q  ;deleted
"RTN","ORQ11",136,0)
 . Q:'$D(ORGRP(+$P(X0,U,11)))  ;not a selected DispGrp
"RTN","ORQ11",137,0)
 . S ACTOR=0 F  S ACTOR=$O(^OR(100,"AS",PAT,TM,IFN,ACTOR)) Q:ACTOR<1  D
"RTN","ORQ11",138,0)
 .. I $P($G(^OR(100,IFN,8,ACTOR,0)),U,4)'=2 K ^OR(100,"AS",PAT,TM,IFN,ACTOR) Q  ;signed or deleted
"RTN","ORQ11",139,0)
 .. D LP1
"RTN","ORQ11",140,0)
 S ^TMP("ORR",$J,ORLIST,"TOT")=ORLST
"RTN","ORQ11",141,0)
 Q
"RTN","ORQ11",142,0)
 ;
"RTN","ORQ11",143,0)
FLG1 ; 12 -- secondary pass for Flagged
"RTN","ORQ11",144,0)
 I +$G(^OR(100,IFN,8,ACTOR,3)) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",145,0)
 Q
"RTN","ORQ11",146,0)
 ;
"RTN","ORQ11",147,0)
VP1 ; 13 -- secondary pass for Verbal/Phone
"RTN","ORQ11",148,0)
 N ORNATR S ORNATR=$P(X8,U,12)
"RTN","ORQ11",149,0)
 I ORNATR,"PV"[$P($G(^ORD(100.02,+ORNATR,0)),U,2) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR) ;STS'=12
"RTN","ORQ11",150,0)
 Q
"RTN","ORQ11",151,0)
 ;
"RTN","ORQ11",152,0)
VPU1 ; 14 -- secondary pass for Verbal/Phone Unsigned
"RTN","ORQ11",153,0)
 N ORNATR S ORNATR=$P(X8,U,12)
"RTN","ORQ11",154,0)
 I ORNATR,"PV"[$P($G(^ORD(100.02,+ORNATR,0)),U,2),'$P(X8,U,5),$P(X8,U,4)=2 D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR) ;STS'=12
"RTN","ORQ11",155,0)
 Q
"RTN","ORQ11",156,0)
 ;
"RTN","ORQ11",157,0)
HLD1 ; 18 -- secondary pass for On Hold
"RTN","ORQ11",158,0)
 I STS=3 D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",159,0)
 Q
"RTN","ORQ11",160,0)
 ;
"RTN","ORQ11",161,0)
NEW ; 19 -- New Orders, plus other unsigned orders by current provider
"RTN","ORQ11",162,0)
 N IFN,ACTOR,TM,X0,X3,X8,ORENT,ORPAR
"RTN","ORQ11",163,0)
 S IFN=0 F  S IFN=$O(^TMP("ORNEW",$J,IFN)) Q:IFN'>0  D  ;New orders
"RTN","ORQ11",164,0)
 . S ACTOR=0 F  S ACTOR=$O(^TMP("ORNEW",$J,IFN,ACTOR)) Q:ACTOR'>0  D
"RTN","ORQ11",165,0)
 .. Q:'$D(^OR(100,IFN,0))  Q:'$D(^(8,ACTOR,0))  ;deleted
"RTN","ORQ11",166,0)
 .. D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",167,0)
 G:'$D(^XUSEC("ORES",DUZ)) NW1 ;ck parameter for add'l orders
"RTN","ORQ11",168,0)
 S ORENT="ALL"_$S($G(^VA(200,DUZ,5)):"^SRV.`"_+^(5),1:"")
"RTN","ORQ11",169,0)
 S ORPAR=$$GET^XPAR(ORENT,"OR UNSIGNED ORDERS ON EXIT")
"RTN","ORQ11",170,0)
 I ORPAR S TM=SDATE F  S TM=$O(^OR(100,"AS",PAT,TM)) Q:TM<1!(TM>EDATE)  D
"RTN","ORQ11",171,0)
 . S IFN=0 F  S IFN=$O(^OR(100,"AS",PAT,TM,IFN)) Q:IFN<1  D
"RTN","ORQ11",172,0)
 .. S ACTOR=0 F  S ACTOR=$O(^OR(100,"AS",PAT,TM,IFN,ACTOR)) Q:ACTOR<1  D
"RTN","ORQ11",173,0)
 ... Q:$D(^TMP("ORNEW",$J,IFN,ACTOR))  ;already included
"RTN","ORQ11",174,0)
 ... S X0=$G(^OR(100,IFN,0)),X3=$G(^(3)),X8=$G(^(8,ACTOR,0))
"RTN","ORQ11",175,0)
 ... I $S(ORPAR=1&($P(X8,U,3)=DUZ):1,ORPAR=2:1,1:0) D LP1
"RTN","ORQ11",176,0)
NW1 S ^TMP("ORR",$J,ORLIST,"TOT")=ORLST
"RTN","ORQ11",177,0)
 Q
"RTN","ORQ11",178,0)
 ;
"RTN","ORQ11",179,0)
CHT1 ; 20 -- secondary pass for Chart Review
"RTN","ORQ11",180,0)
 ;       Include if: unverified, released, inpt, not repl/canc/lapsed
"RTN","ORQ11",181,0)
 I '$P(X8,U,19),$P(X8,U,15)="",$$INPT,"^12^13^14^"'[(U_STS_U) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",182,0)
 Q
"RTN","ORQ11",183,0)
 ;
"RTN","ORQ11",184,0)
CHTSUM ; 21 -- secondary pass for Chart copy summary
"RTN","ORQ11",185,0)
 ;       Included based on Nature of Order
"RTN","ORQ11",186,0)
 N XP,NAT
"RTN","ORQ11",187,0)
 S XP=+$$GET^XPAR("SYS","OR PRINT ALL ORDERS CHART SUM",1,"I")
"RTN","ORQ11",188,0)
 I XP=2 D  Q  ;depends on Nature of Order
"RTN","ORQ11",189,0)
 . S NAT=$P($G(^OR(100,IFN,6)),U)
"RTN","ORQ11",190,0)
 . I 'NAT S NAT=$P(X8,U,12)
"RTN","ORQ11",191,0)
 . I NAT,$$CHART^ORX1(NAT) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",192,0)
 I XP=0 D  Q  ;If original printed, print on sum
"RTN","ORQ11",193,0)
 . I X7 D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",194,0)
 D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR) ;XP=1 gets All orders
"RTN","ORQ11",195,0)
 Q
"RTN","ORQ11",196,0)
 ;
"RTN","ORQ11",197,0)
LPS1 ; 22 -- secondary pass for Lapsed
"RTN","ORQ11",198,0)
 I STS=14 D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",199,0)
 Q
"RTN","ORQ11",200,0)
 ;
"RTN","ORQ11",201,0)
AVT1 ; 23 -- secondary pass for Active/Pending sts only
"RTN","ORQ11",202,0)
 I (STS=6)!(STS=5) D GET^ORQ12(IFN,ORLIST,DETAIL,ACTOR)
"RTN","ORQ11",203,0)
 Q
"RTN","ORQ11",204,0)
 ;
"RTN","ORQ11",205,0)
QUIT ; -- stop
"RTN","ORQ11",206,0)
 Q
"RTN","ORQ21")
0^39^B35534512
"RTN","ORQ21",1,0)
ORQ21 ;SLC/MKB,GSS - DETAILED ORDER REPORT CONTINUED ;01/24/2014  11:39
"RTN","ORQ21",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**141,190,195,215,243,361,350**;Dec 17, 1997;Build 77
"RTN","ORQ21",3,0)
 ;
"RTN","ORQ21",4,0)
 ; DBIA 2400   OEL^PSOORRL   ^TMP("PS",$J)
"RTN","ORQ21",5,0)
 ; DBIA 2266   EN30^RAO7PC1  ^TMP($J,"RAE2")
"RTN","ORQ21",6,0)
 ;
"RTN","ORQ21",7,0)
RAD(TCOM) ; -- add RA data for 2.5 orders
"RTN","ORQ21",8,0)
 N RAIFN,CASE,PROC,ORD,ORI,X,ORTTL,ORB
"RTN","ORQ21",9,0)
 S RAIFN=$G(^OR(100,ORIFN,4)) Q:RAIFN'>0
"RTN","ORQ21",10,0)
 D EN30^RAO7PC1(RAIFN) Q:'$D(^TMP($J,"RAE2",+ORVP))  ;DBIA 2266
"RTN","ORQ21",11,0)
 S ORD=$G(^TMP($J,"RAE2",+ORVP,"ORD")),CASE=$O(^(0)) Q:'CASE  S PROC=$O(^(CASE,""))
"RTN","ORQ21",12,0)
 I '$G(TCOM) D  ;else add only Tech Comments
"RTN","ORQ21",13,0)
 . S CNT=CNT+1,@ORY@(CNT)=$$LJ^XLFSTR("Procedure:",30)_$S($L(ORD):ORD,1:PROC)
"RTN","ORQ21",14,0)
 . S ORI=0,ORTTL="Procedure Modifiers:          ",ORB=1
"RTN","ORQ21",15,0)
 . F  S ORI=$O(^TMP($J,"RAE2",+ORVP,CASE,PROC,"M",ORI)) Q:ORI'>0  S CNT=CNT+1,@ORY@(CNT)=ORTTL_^(ORI),ORTTL=$$REPEAT^XLFSTR(" ",30)
"RTN","ORQ21",16,0)
 . S CNT=CNT+1,@ORY@(CNT)="History and Reason for Exam:"
"RTN","ORQ21",17,0)
 . F  S ORI=$O(^TMP($J,"RAE2",+ORVP,CASE,PROC,"H",ORI)) Q:ORI'>0  S CNT=CNT+1,@ORY@(CNT)="  "_^(ORI)
"RTN","ORQ21",18,0)
RAD1 I $L($G(^TMP($J,"RAE2",+ORVP,CASE,PROC,"TCOM",1))) S X=^(1) D
"RTN","ORQ21",19,0)
 . N DIWL,DIWR,DIWF,I K ^UTILITY($J,"W")
"RTN","ORQ21",20,0)
 . S DIWL=1,DIWR=72,DIWF="C72" D ^DIWP
"RTN","ORQ21",21,0)
 . S CNT=CNT+1,@ORY@(CNT)="Technologist's Comment:",ORB=1
"RTN","ORQ21",22,0)
 . S I=0 F  S I=$O(^UTILITY($J,"W",DIWL,I)) Q:I'>0  S CNT=CNT+1,@ORY@(CNT)="  "_^(I,0)
"RTN","ORQ21",23,0)
 I $D(^TMP($J,"RAE2",+ORVP,CASE,PROC,"CM")) D
"RTN","ORQ21",24,0)
 . S ORTTL="Contrast Media used:          ",ORI=0,ORB=1
"RTN","ORQ21",25,0)
 . F  S ORI=$O(^TMP($J,"RAE2",+ORVP,CASE,PROC,"CM",ORI)) Q:ORI<1  S CNT=CNT+1,@ORY@(CNT)=ORTTL_$P(^(ORI),U,2),ORTTL=$$REPEAT^XLFSTR(" ",30)
"RTN","ORQ21",26,0)
 K ^TMP($J,"RAE2",+ORVP),^UTILITY($J,"W")
"RTN","ORQ21",27,0)
 S:$G(ORB) CNT=CNT+1,@ORY@(CNT)="   " ;blank
"RTN","ORQ21",28,0)
 Q
"RTN","ORQ21",29,0)
 ;
"RTN","ORQ21",30,0)
MED ; -- Add Pharmacy order data
"RTN","ORQ21",31,0)
 Q:$G(^OR(100,ORIFN,4))["N"  ;non-VA med -- no refill history
"RTN","ORQ21",32,0)
 N TYPE,NODE,RXN,OR5,STAT S TYPE=$P(OR0,U,12)
"RTN","ORQ21",33,0)
 I '$D(^TMP("PS",$J,0)) D  ;get PS data / DBIA 2400
"RTN","ORQ21",34,0)
 . N PSIFN S PSIFN=$G(^OR(100,ORIFN,4))
"RTN","ORQ21",35,0)
 . S:TYPE="O" PSIFN=$TR(PSIFN,"S","P")_$S(PSIFN?1.N:"R",1:"")
"RTN","ORQ21",36,0)
 . D OEL^PSOORRL(+ORVP,PSIFN_";"_TYPE)  ;DBIA 2400
"RTN","ORQ21",37,0)
 S NODE=$G(^TMP("PS",$J,0)),RXN=$G(^("RXN",0)),STAT=$P(NODE,U,6)
"RTN","ORQ21",38,0)
 I '$L(NODE) K ^TMP("PS",$J) Q  ;error
"RTN","ORQ21",39,0)
 I $O(^TMP("PS",$J,"DD",0)) D  ;Disp Drugs
"RTN","ORQ21",40,0)
 . N I,X,Y S X="Dispense Drugs (units/dose):  ",I=0
"RTN","ORQ21",41,0)
 . F  S I=$O(^TMP("PS",$J,"DD",I)) Q:I'>0  S Y=$G(^(I,0)) S:Y CNT=CNT+1,@ORY@(CNT)=X_$$GET1^DIQ(50,+Y_",",.01)_" ("_$P(Y,U,2)_")"
"RTN","ORQ21",42,0)
 S:$P(NODE,U,9) CNT=CNT+1,@ORY@(CNT)="Total Dose:                   "_$P(NODE,U,9)
"RTN","ORQ21",43,0)
M1 I TYPE="I" D  ;admin data
"RTN","ORQ21",44,0)
 . N I,X,Y I $O(^TMP("PS",$J,"B",0)) D
"RTN","ORQ21",45,0)
 .. S X="IV Print Name:                ",I=0
"RTN","ORQ21",46,0)
 .. F  S I=$O(^TMP("PS",$J,"B",I)) Q:I<1  S Y=$G(^(I,0)) S:$L(Y) CNT=CNT+1,@ORY@(CNT)=X_$P(Y,U),X=$$REPEAT^XLFSTR(" ",30) I $L($P(Y,U,3)) S CNT=CNT+1,@ORY@(CNT)=X_" "_$P(Y,U,3)
"RTN","ORQ21",47,0)
 . S I=+$O(^TMP("PS",$J,"SCH",0)),X=$G(^(I,0))
"RTN","ORQ21",48,0)
 . S X=$S($L(X,U)=1:X,1:$P(X,U,2))
"RTN","ORQ21",49,0)
 . S:$L(X) CNT=CNT+1,@ORY@(CNT)="Schedule Type:                "_X
"RTN","ORQ21",50,0)
 . S X="Administration Times:         ",I=0
"RTN","ORQ21",51,0)
 . F  S I=$O(^TMP("PS",$J,"ADM",I)) Q:I'>0  S Y=$G(^(I,0)) S:$L(Y) CNT=CNT+1,@ORY@(CNT)=X_Y,X=$$REPEAT^XLFSTR(" ",30)
"RTN","ORQ21",52,0)
M2 I TYPE="O" D  ;fill history
"RTN","ORQ21",53,0)
 . N FILLD,RET,X,Y,I
"RTN","ORQ21",54,0)
 . S:$P(NODE,U,12) CNT=CNT+1,@ORY@(CNT)="Last Filled:                  "_$$FMTE^XLFDT($P(NODE,U,12),2)
"RTN","ORQ21",55,0)
 . S CNT=CNT+1,@ORY@(CNT)="Refills Remaining:            "_$P(NODE,U,4)
"RTN","ORQ21",56,0)
 . I $P(RXN,U,6)!$G(^TMP("PS",$J,"REF",0)) S X="Filled:                       " D
"RTN","ORQ21",57,0)
 .. I $P(RXN,U,6) S FILLD=$P(RXN,U,6)_"^^^"_$P(RXN,U,7)_U_$P(RXN,U,3,4) D FILLED("R")
"RTN","ORQ21",58,0)
 .. S RET=$G(^TMP("PS",$J,"RXN","RSTC")) I RET'="" D RETURNS(RET)
"RTN","ORQ21",59,0)
 .. S I=0 F  S I=$O(^TMP("PS",$J,"REF",I)) Q:I'>0  D
"RTN","ORQ21",60,0)
 ... S FILLD=$G(^(I,0)) D FILLED("R")
"RTN","ORQ21",61,0)
 ... S RET=$G(^TMP("PS",$J,"REF",I,"RSTC")) I RET'="" D RETURNS(RET)
"RTN","ORQ21",62,0)
 . I $G(^TMP("PS",$J,"PAR",0)) S I=0,X="Partial Fills:      " F  S I=$O(^TMP("PS",$J,"PAR",I)) Q:I'>0  S FILLD=$G(^(I,0)) D FILLED("P")
"RTN","ORQ21",63,0)
 . S:RXN CNT=CNT+1,@ORY@(CNT)="Prescription#:                "_$P(RXN,U)
"RTN","ORQ21",64,0)
M3 S:$P(RXN,U,5) CNT=CNT+1,@ORY@(CNT)="Pharmacist:                   "_$P($G(^VA(200,+$P(RXN,U,5),0)),U)
"RTN","ORQ21",65,0)
    I $G(STAT)="ACTIVE/SUSP" S CNT=CNT+1,@ORY@(CNT)="Prescription Status:          "_STAT_" - Order is active. Fill or Refill has been requested."
"RTN","ORQ21",66,0)
 S:$P(NODE,U,13) CNT=CNT+1,@ORY@(CNT)="NOT TO BE GIVEN" K ^TMP("PS",$J)
"RTN","ORQ21",67,0)
 S CNT=CNT+1,@ORY@(CNT)="   " ;blank
"RTN","ORQ21",68,0)
 S OR5=$G(^OR(100,ORIFN,5)) I $L(OR5) D  ;SC data
"RTN","ORQ21",69,0)
 . N X,Y,I
"RTN","ORQ21",70,0)
 . S CNT=CNT+1,@ORY@(CNT)="   " ;blank line
"RTN","ORQ21",71,0)
 . S CNT=CNT+1,@ORY@(CNT)="First Party Pay Exemptions"
"RTN","ORQ21",72,0)
 . S X="For conditions related to:    "
"RTN","ORQ21",73,0)
 . F I=1:1:8 S Y=$P(OR5,U,I) I Y S CNT=CNT+1,@ORY@(CNT)=X_$$SC(I),X=$$REPEAT^XLFSTR(" ",30)
"RTN","ORQ21",74,0)
 Q
"RTN","ORQ21",75,0)
 ;
"RTN","ORQ21",76,0)
BA ;Billing Aware data display
"RTN","ORQ21",77,0)
 N DXIEN,DXV,ICD9,ICDR,OCT,ORFMDAT
"RTN","ORQ21",78,0)
 S OCT=0,X=""
"RTN","ORQ21",79,0)
 ; Get the date of the order for CSV/CTD usage
"RTN","ORQ21",80,0)
 S ORFMDAT=$$ORFMDAT^ORWDBA3(ORIFN)
"RTN","ORQ21",81,0)
 ; $O through diagnoses for an order
"RTN","ORQ21",82,0)
 F  S OCT=$O(^OR(100,ORIFN,5.1,OCT)) Q:OCT'?1N.N  D
"RTN","ORQ21",83,0)
 . ; DXIEN=Dx IEN
"RTN","ORQ21",84,0)
 . S DXIEN=+^OR(100,ORIFN,5.1,OCT,0)
"RTN","ORQ21",85,0)
 . ; Get Dx record for date ORFMDAT
"RTN","ORQ21",86,0)
 . S ICDR=$$ICDDATA^ICDXCODE("DIAGNOSIS",DXIEN,ORFMDAT)
"RTN","ORQ21",87,0)
 . ; Get Dx verbiage and ICD code
"RTN","ORQ21",88,0)
 . S DXV=$P(ICDR,U,4),ICD9=$P(ICDR,U,2)
"RTN","ORQ21",89,0)
 . S X="               "
"RTN","ORQ21",90,0)
 . I OCT=1 D
"RTN","ORQ21",91,0)
 .. S CNT=CNT+1,@ORY@(CNT)="   " ;blank line
"RTN","ORQ21",92,0)
 .. S CNT=CNT+1,@ORY@(CNT)="Clinical Indicators"
"RTN","ORQ21",93,0)
 .. S X="Diagnosis of:  "
"RTN","ORQ21",94,0)
 . S X=X_ICD9_" - "_DXV,CNT=CNT+1,@ORY@(CNT)=X
"RTN","ORQ21",95,0)
 I OCT'="" D  ;if there are diagnoses show Treatment Factors
"RTN","ORQ21",96,0)
 . S X="For conditions related to:    "
"RTN","ORQ21",97,0)
 . F I=1:1:8 S Y=$P(^OR(100,ORIFN,5.2),U,I) I Y D
"RTN","ORQ21",98,0)
 .. S CNT=CNT+1,@ORY@(CNT)=X_$$SC(I),X=$$REPEAT^XLFSTR(" ",30)
"RTN","ORQ21",99,0)
 Q
"RTN","ORQ21",100,0)
 ;
"RTN","ORQ21",101,0)
FILLED(TYPE) ; -- add FILLD data
"RTN","ORQ21",102,0)
 N Y S Y=$$FMTE^XLFDT($P(FILLD,U),2)_" ("_$$ROUTING($P(FILLD,U,5))_")"
"RTN","ORQ21",103,0)
 S:TYPE="R"&$P(FILLD,U,4) Y=Y_" released "_$$FMTE^XLFDT($P(FILLD,U,4),2)
"RTN","ORQ21",104,0)
 S:TYPE="P"&$P(FILLD,U,3) Y=Y_" Qty: "_$P(FILLD,U,3)
"RTN","ORQ21",105,0)
 S CNT=CNT+1,@ORY@(CNT)=X_Y,X=$$REPEAT^XLFSTR(" ",30)
"RTN","ORQ21",106,0)
 S:$L($P(FILLD,U,6)) CNT=CNT+1,@ORY@(CNT)=X_$P(FILLD,U,6)
"RTN","ORQ21",107,0)
 Q
"RTN","ORQ21",108,0)
RETURNS(NODE) ; add Return to Stock Data
"RTN","ORQ21",109,0)
 N DATE,NAME,TEXT,X
"RTN","ORQ21",110,0)
 S DATE=$$FMTE^XLFDT($P(NODE,U))
"RTN","ORQ21",111,0)
 S NAME=$P(^VA(200,$P(NODE,U,2),0),U)
"RTN","ORQ21",112,0)
 S X=$$REPEAT^XLFSTR(" ",13)
"RTN","ORQ21",113,0)
 S TEXT="Return to Stock: "_X_DATE_" by "_NAME
"RTN","ORQ21",114,0)
 S CNT=CNT+1,@ORY@(CNT)=TEXT
"RTN","ORQ21",115,0)
 S X=$$REPEAT^XLFSTR(" ",30)
"RTN","ORQ21",116,0)
 S TEXT=X_"Comments: "_$P(NODE,U,3)
"RTN","ORQ21",117,0)
 S CNT=CNT+1,@ORY@(CNT)=TEXT
"RTN","ORQ21",118,0)
 Q
"RTN","ORQ21",119,0)
 ;
"RTN","ORQ21",120,0)
ROUTING(X) ; -- Returns external form
"RTN","ORQ21",121,0)
 N Y S Y=$S($G(X)="M":"Mail",$G(X)="W":"Window",1:$G(X))
"RTN","ORQ21",122,0)
 Q Y
"RTN","ORQ21",123,0)
 ;
"RTN","ORQ21",124,0)
SC(J) ; -- Returns name of SC field by piece number
"RTN","ORQ21",125,0)
 I '$G(J) Q ""
"RTN","ORQ21",126,0)
 I J=1 Q "SERVICE CONNECTED CONDITION"
"RTN","ORQ21",127,0)
 I J=2 Q "MILITARY SEXUAL TRAUMA"
"RTN","ORQ21",128,0)
 I J=3 Q "AGENT ORANGE EXPOSURE"
"RTN","ORQ21",129,0)
 I J=4 Q "IONIZING RADIATION EXPOSURE"
"RTN","ORQ21",130,0)
 I J=5 Q "ENVIRONMENTAL CONTAMINANTS"
"RTN","ORQ21",131,0)
 I J=6 Q "HEAD OR NECK CANCER"
"RTN","ORQ21",132,0)
 I J=7 Q "COMBAT VETERAN"
"RTN","ORQ21",133,0)
 I J=8 Q "SHIPBOARD HAZARD AND DEFENSE"
"RTN","ORQ21",134,0)
 Q ""
"RTN","ORQOR2")
0^44^B14557366
"RTN","ORQOR2",1,0)
ORQOR2 ; slc/CLA - Extrinsic functions which return order information ;04/17/14  18:17
"RTN","ORQOR2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**6,32,92,122,144,190,251,350**;Dec 17, 1997;Build 77
"RTN","ORQOR2",3,0)
STATUS(ORN) ;extrinsic function returns the current status of an order in
"RTN","ORQOR2",4,0)
 ;the format: status ien^external text
"RTN","ORQOR2",5,0)
 ;DBIA #3458 supported api for outpt pharmacy
"RTN","ORQOR2",6,0)
 Q:'$L($G(ORN)) ""
"RTN","ORQOR2",7,0)
 Q:'$L($G(^OR(100,ORN,3))) ""
"RTN","ORQOR2",8,0)
 N ORSTATUS
"RTN","ORQOR2",9,0)
 S ORSTATUS=$P(^OR(100,ORN,3),U,3)
"RTN","ORQOR2",10,0)
 S ORSTATUS=ORSTATUS_U_$G(^ORD(100.01,+ORSTATUS,0))
"RTN","ORQOR2",11,0)
 Q ORSTATUS
"RTN","ORQOR2",12,0)
RECENT(PT,OI,ST) ;extrinsic funct returns pt's most recent order for an orderable item and status in format:
"RTN","ORQOR2",13,0)
 ; order number^order text (truncated to 60 chars)^start d/t^status
"RTN","ORQOR2",14,0)
 N INDT,ORN,CDT,ORSTATUS,ORTEXT,RESULT S RESULT="",ORN="",INDT=""
"RTN","ORQOR2",15,0)
 F  S INDT=$O(^OR(100,"AOI",OI,PT_";DPT(",INDT)) Q:INDT=""!(RESULT'="")  D
"RTN","ORQOR2",16,0)
 .F  S ORN=$O(^OR(100,"AOI",OI,PT_";DPT(",INDT,ORN)) Q:ORN=""  D
"RTN","ORQOR2",17,0)
 ..S ORSTATUS=$P(^OR(100,ORN,3),U,3)
"RTN","ORQOR2",18,0)
 ..I '$L($G(ST))!($G(ORSTATUS)=ST) D
"RTN","ORQOR2",19,0)
 ...S ORSTATUS=$G(^ORD(100.01,ORSTATUS,0)),CDT=9999999-INDT
"RTN","ORQOR2",20,0)
 ...S ORTEXT=$P($$TEXT^ORKOR(ORN,60),U,2)
"RTN","ORQOR2",21,0)
 ...S RESULT=ORN_U_ORTEXT_U_CDT_U_ORSTATUS
"RTN","ORQOR2",22,0)
 Q RESULT
"RTN","ORQOR2",23,0)
DUPRANGE(OI,DG,ODT,ORPT) ;extrinsic funct returns duplicate order range beginning date in the format:
"RTN","ORQOR2",24,0)
 ;fileman d/t^inverse fileman d/t
"RTN","ORQOR2",25,0)
 ;OI   = orderable item ien
"RTN","ORQOR2",26,0)
 ;DG   = display group abbrev. (e.g. 'LR')
"RTN","ORQOR2",27,0)
 ;ODT  = order effective/start date/time in FM format
"RTN","ORQOR2",28,0)
 ;ORPT = patient dfn
"RTN","ORQOR2",29,0)
 N DHRS,BDT,INBDT,ORSRV,ORLOC
"RTN","ORQOR2",30,0)
 S BDT="",INBDT=""
"RTN","ORQOR2",31,0)
 ;
"RTN","ORQOR2",32,0)
 ;get patient's location flag (INPATIENT ONLY - outpt locations cannot be
"RTN","ORQOR2",33,0)
 ;reliably determined, and many simultaneous outpt locations can occur):
"RTN","ORQOR2",34,0)
 I +$G(ORPT)>0 D
"RTN","ORQOR2",35,0)
 .N DFN S DFN=ORPT,VA200="" D OERR^VADPT
"RTN","ORQOR2",36,0)
 .I +$G(VAIN(4))>0 S ORLOC=+$G(^DIC(42,+$G(VAIN(4)),44))
"RTN","ORQOR2",37,0)
 .K VA200,VAIN
"RTN","ORQOR2",38,0)
 ;
"RTN","ORQOR2",39,0)
 S ORSRV=$G(^VA(200,DUZ,5)) I +ORSRV>0 S ORSRV=$P(ORSRV,U)
"RTN","ORQOR2",40,0)
 S DHRS=$$GET^XPAR("LOC.`"_$G(ORLOC)_"^SRV.`"_$G(ORSRV)_"^DIV^SYS","ORK DUP ORDER RANGE OI",OI,"I")
"RTN","ORQOR2",41,0)
 Q:$G(DHRS)=0 "0^0" ;quit if number of hours for this OI is zero
"RTN","ORQOR2",42,0)
 I +$G(DHRS)<1 D
"RTN","ORQOR2",43,0)
 .I DG="LR" S DHRS=$$GET^XPAR("LOC.`"_$G(ORLOC)_"^SRV.`"_$G(ORSRV)_"^DIV^SYS^PKG","ORK DUP ORDER RANGE LAB",1,"I")
"RTN","ORQOR2",44,0)
 .I DG="RA" S DHRS=$$GET^XPAR("LOC.`"_$G(ORLOC)_"^SRV.`"_$G(ORSRV)_"^DIV^SYS^PKG","ORK DUP ORDER RANGE RADIOLOGY",1,"I")
"RTN","ORQOR2",45,0)
 I +$G(DHRS)<1 S DHRS=48  ;non-lab and non-radiology default is 48 hrs
"RTN","ORQOR2",46,0)
 S BDT=$$FMADD^XLFDT(ODT,"","-"_DHRS,"",""),INBDT=9999999-BDT
"RTN","ORQOR2",47,0)
 Q BDT_U_INBDT
"RTN","ORQOR2",48,0)
ORDERER(ORNUM) ;ext. funct. gets ordering provider DUZ from ORDER File (#100)
"RTN","ORQOR2",49,0)
 Q:'$L($G(ORNUM)) ""
"RTN","ORQOR2",50,0)
 S ORNUM=+$G(ORNUM)
"RTN","ORQOR2",51,0)
 N ORQDUZ,ORQI S ORQDUZ=""
"RTN","ORQOR2",52,0)
 I $L($G(^OR(100,ORNUM,8,0))) D
"RTN","ORQOR2",53,0)
 .S ORQI=0,ORQI=$O(^OR(100,ORNUM,8,"C","NW",ORQI))  ;8 node for New order
"RTN","ORQOR2",54,0)
 Q:+$G(ORQI)<1 ""
"RTN","ORQOR2",55,0)
 S ORQDUZ=$P(^OR(100,ORNUM,8,ORQI,0),U,3)
"RTN","ORQOR2",56,0)
 Q ORQDUZ
"RTN","ORQOR2",57,0)
UNSIGNOR(ORNUM) ;ext. funct. gets ordering provider DUZ from ORDER File (#100)
"RTN","ORQOR2",58,0)
 ; based on order action number (8 node)
"RTN","ORQOR2",59,0)
 ; if no action number return orderer for New order
"RTN","ORQOR2",60,0)
 ;ORNUM in format: <order ien>;<action number>
"RTN","ORQOR2",61,0)
 Q:'$L(+$G(ORNUM)) ""
"RTN","ORQOR2",62,0)
 N ORQDUZ,ORQI S ORQDUZ=""
"RTN","ORQOR2",63,0)
 S ORQI=$P(ORNUM,";",2)
"RTN","ORQOR2",64,0)
 S ORNUM=$P(ORNUM,";")
"RTN","ORQOR2",65,0)
 Q:+$G(ORNUM)<1 ""
"RTN","ORQOR2",66,0)
 I +$G(ORQI)<1 S ORQI=$P($G(^OR(100,ORNUM,8,0)),U,3)
"RTN","ORQOR2",67,0)
 I $L(ORQI),$L($G(^OR(100,ORNUM,8,ORQI,0))) D
"RTN","ORQOR2",68,0)
 .S ORQDUZ=$P(^OR(100,ORNUM,8,ORQI,0),U,3)
"RTN","ORQOR2",69,0)
 Q ORQDUZ
"RTN","ORQOR2",70,0)
OI(ORNUM) ;ext. funct. gets Orderable Item ien from ORDER File (#100)
"RTN","ORQOR2",71,0)
 Q:+$G(ORNUM)<1 ""
"RTN","ORQOR2",72,0)
 N OI S OI=""
"RTN","ORQOR2",73,0)
 S OI=+$G(^OR(100,+$G(ORNUM),.1,1,0))
"RTN","ORQOR2",74,0)
 Q OI
"RTN","ORQOR2",75,0)
DG(ORNUM) ;ext. funct. gets Display Group ien from ORDER File (#100)
"RTN","ORQOR2",76,0)
 Q:'$L($G(ORNUM)) ""
"RTN","ORQOR2",77,0)
 N DG S DG=""
"RTN","ORQOR2",78,0)
 S DG=$G(^OR(100,ORNUM,0))
"RTN","ORQOR2",79,0)
 I $L(DG) S DG=$P(DG,U,11)
"RTN","ORQOR2",80,0)
 Q DG
"RTN","ORQOR2",81,0)
DGRX(ORNUM)        ;ext. funct. determines if order is pharmacy order
"RTN","ORQOR2",82,0)
 Q:+$G(ORNUM)<1 ""
"RTN","ORQOR2",83,0)
 N DG,DGNAME,RXDG
"RTN","ORQOR2",84,0)
 S DG=$$DG(ORNUM)
"RTN","ORQOR2",85,0)
 S DGNAME=$P($G(^ORD(100.98,+DG,0)),U) Q:'$L(DGNAME) ""
"RTN","ORQOR2",86,0)
 F RXDG="PHARMACY","INPATIENT MEDICATIONS","OUTPATIENT MEDICATIONS","UNIT DOSE MEDICATIONS","IV MEDICATIONS","NON-VA MEDICATIONS","CLINIC ORDERS","CLINIC INFUSIONS","CLINIC MEDICATIONS","" Q:(DGNAME=RXDG)
"RTN","ORQOR2",87,0)
 Q RXDG
"RTN","ORQOR2",88,0)
PT(ORNUM) ;ext. funct. gets Patient dfn from ORDER File (#100)
"RTN","ORQOR2",89,0)
 Q:'$L($G(ORNUM)) ""
"RTN","ORQOR2",90,0)
 N PT S PT=""
"RTN","ORQOR2",91,0)
 S PT=$G(^OR(100,ORNUM,0))
"RTN","ORQOR2",92,0)
 I $L(PT) S PT=$P(PT,U,2),PT=$P(PT,";DPT")
"RTN","ORQOR2",93,0)
 Q PT
"RTN","ORQOR2",94,0)
RSLTFLG(ORNUM) ;ext. funct. returns duz of user to receive alert if order was
"RTN","ORQOR2",95,0)
 ; flagged to alert when resulted
"RTN","ORQOR2",96,0)
 Q:'$L($G(ORNUM)) ""
"RTN","ORQOR2",97,0)
 N FLG S FLG=""
"RTN","ORQOR2",98,0)
 S FLG=$G(^OR(100,+ORNUM,3))
"RTN","ORQOR2",99,0)
 I $L(FLG) S FLG=$P(FLG,U,10)
"RTN","ORQOR2",100,0)
 Q FLG
"RTN","ORQOREP")
0^50^B92933905
"RTN","ORQOREP",1,0)
ORQOREP ;ISP/JMH,RFR - REPORT FOR QUICK ORDERS ;09/05/2014  14:41
"RTN","ORQOREP",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**366,350**;Dec 17, 1997;Build 77
"RTN","ORQOREP",3,0)
 Q
"RTN","ORQOREP",4,0)
DIFF ;
"RTN","ORQOREP",5,0)
 W !!,"This report identifies Medication Quick orders that have a free text dosage",!
"RTN","ORQOREP",6,0)
 W "that does not match exactly one of the Local Dosages from Pharmacy.",!
"RTN","ORQOREP",7,0)
 N DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,TYPE,SAVE
"RTN","ORQOREP",8,0)
 S DIR(0)="S"_U_"S:System Quick Orders;P:Personal Quick Orders;PS:Personal and System Quick Orders"
"RTN","ORQOREP",9,0)
 S DIR("A")="SELECT THE TYPE OF QUICK ORDER",DIR("B")="PS" D ^DIR
"RTN","ORQOREP",10,0)
 Q:"PS"'[$G(Y)
"RTN","ORQOREP",11,0)
 S TYPE="I $P($G(^ORD(101.41,ORI,0)),U,4)=""Q"""
"RTN","ORQOREP",12,0)
 I Y="P" S TYPE=TYPE_",($E($P($G(^ORD(101.41,ORI,0)),U,1),1,6)=""ORWDQ "")"
"RTN","ORQOREP",13,0)
 I Y="S" S TYPE=TYPE_",($E($P($G(^ORD(101.41,ORI,0)),U,1),1,6)'=""ORWDQ "")"
"RTN","ORQOREP",14,0)
 K DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","ORQOREP",15,0)
 S DIR(0)="S"_U_"L:Local Possible Dosages;P:Possible Dosages;N:No Local Possible and No Possible Dosages"
"RTN","ORQOREP",16,0)
 S DIR("A")="SELECT THE TYPE OF DOSAGE",DIR("B")="L" D ^DIR
"RTN","ORQOREP",17,0)
 Q:"^L^P^N^"'[(U_$G(Y)_U)
"RTN","ORQOREP",18,0)
 S ORY=Y
"RTN","ORQOREP",19,0)
 S SAVE("TYPE")="",SAVE("ORY")=""
"RTN","ORQOREP",20,0)
 D DEVICE^ORUTL("DIFFQ^ORQOREP","OR QUICK ORDER FREE-TEXT","Q",.SAVE)
"RTN","ORQOREP",21,0)
 Q
"RTN","ORQOREP",22,0)
DIFFQ ;TASKMAN ENTRY POINT
"RTN","ORQOREP",23,0)
 ;return list of quick orders in a reminder dialog
"RTN","ORQOREP",24,0)
 K ^TMP($J,"OR REMDLG")
"RTN","ORQOREP",25,0)
 D FQOIRDLG^ORINQIV
"RTN","ORQOREP",26,0)
 N ORI,ORPT,ORCNT,DATA,EXIT,STOP,PGNUM,OUT,DOSAGE
"RTN","ORQOREP",27,0)
 S ORPT=$O(^DPT(0)),ORCNT=0,DATA=$NA(^TMP($J,"ORQOREP")) K @DATA
"RTN","ORQOREP",28,0)
 S OUT(1)="This report identifies medication quick orders that have a free text dosage"
"RTN","ORQOREP",29,0)
 S OUT(2)="that does not exactly match one of the local possible dosages from pharmacy.",OUT=3
"RTN","ORQOREP",30,0)
 I ORY'="N" D
"RTN","ORQOREP",31,0)
 .S DOSAGE="I $L($P(ORDOSE(ORDLI),U))>0,($L($P(ORDOSE(ORDLI),U,3))>0)"
"RTN","ORQOREP",32,0)
 .S OUT(OUT)="When at least one active dispense drug linked to the orderable item has a",OUT=OUT+1
"RTN","ORQOREP",33,0)
 .S OUT(OUT)="possible dosage then only possible dosages will be available in CPRS and",OUT=OUT+1
"RTN","ORQOREP",34,0)
 .S OUT(OUT)="for dose checks for the package (I/O) of the quick order. "
"RTN","ORQOREP",35,0)
 .I ORY="L" D
"RTN","ORQOREP",36,0)
 ..S DOSAGE=$TR(DOSAGE,">","=")
"RTN","ORQOREP",37,0)
 ..S OUT(OUT)=OUT(OUT)_"Thus, no possible",OUT=OUT+1
"RTN","ORQOREP",38,0)
 ..S OUT(OUT)="dosages have been created and only local possible dosages are listed below."
"RTN","ORQOREP",39,0)
 .I ORY="P" D
"RTN","ORQOREP",40,0)
 ..S OUT(OUT)=OUT(OUT)_"Thus, local",OUT=OUT+1
"RTN","ORQOREP",41,0)
 ..S OUT(OUT)="possible dosages for a dispense drug will not be listed below, only possible",OUT=OUT+1
"RTN","ORQOREP",42,0)
 ..S OUT(OUT)="dosages are listed.",OUT=OUT+1
"RTN","ORQOREP",43,0)
 I ORY="N" D
"RTN","ORQOREP",44,0)
 .S OUT(OUT)="It shows when all of the active dispense drugs linked to the orderable",OUT=OUT+1
"RTN","ORQOREP",45,0)
 .S OUT(OUT)="item have NO possible dosages and NO local possible dosages for the",OUT=OUT+1
"RTN","ORQOREP",46,0)
 .S OUT(OUT)="package (I/O) of the quick order."
"RTN","ORQOREP",47,0)
 S ORI=0 F  S ORI=$O(^ORD(101.41,ORI)) Q:'ORI  D
"RTN","ORQOREP",48,0)
 .X TYPE Q:'$T
"RTN","ORQOREP",49,0)
 .N CONT,USER
"RTN","ORQOREP",50,0)
 .S CONT=$S($O(^ORD(101.41,"AD",ORI,0)):1,$D(^TMP($J,"OR REMDLG",ORI)):1,$D(^ORD(101.44,"C",ORI)):1,1:0)
"RTN","ORQOREP",51,0)
 .Q:'CONT
"RTN","ORQOREP",52,0)
 .;FOR PERSONAL QUICK ORDERS, STOP EXAMINING IF ALL ASSOCIATED USERS ARE INACTIVE
"RTN","ORQOREP",53,0)
 .S EXIT=0
"RTN","ORQOREP",54,0)
 .I $E($P($G(^ORD(101.41,ORI,0)),U,1),1,6)="ORWDQ " D
"RTN","ORQOREP",55,0)
 ..N OQVIEN S OQVIEN=0,EXIT=1
"RTN","ORQOREP",56,0)
 ..F  S OQVIEN=$O(^ORD(101.44,"C",ORI,OQVIEN)) Q:+$G(OQVIEN)=0  D
"RTN","ORQOREP",57,0)
 ...S USER=$P($P($G(^ORD(101.44,OQVIEN,0)),U,1)," ",2),USER=$E(USER,4,$L(USER))
"RTN","ORQOREP",58,0)
 ...S USER(USER)=+$$ACTIVE^XUSER(USER)
"RTN","ORQOREP",59,0)
 ...S:EXIT EXIT='USER(USER)
"RTN","ORQOREP",60,0)
 ...I 'USER(USER) K USER(USER)
"RTN","ORQOREP",61,0)
 ...I $D(USER(USER)) S USER(USER)=$$GET1^DIQ(200,USER_",",.01)
"RTN","ORQOREP",62,0)
 .Q:+EXIT
"RTN","ORQOREP",63,0)
 .N ORINSDLG,ORINSIEN,ORDRDLG,ORDRIEN,ORINS,ORDR,OROIDLG,OROIIEN,OROI,ORDREXT,ORFLAG,ORDG,ORPTYPE,ORDOSE,ORPSOI
"RTN","ORQOREP",64,0)
 .S OROIDLG=$O(^ORD(101.41,"B","OR GTX ORDERABLE ITEM",0))
"RTN","ORQOREP",65,0)
 .Q:'OROIDLG
"RTN","ORQOREP",66,0)
 .S OROIIEN=$O(^ORD(101.41,ORI,6,"D",OROIDLG,0))
"RTN","ORQOREP",67,0)
 .Q:'OROIIEN
"RTN","ORQOREP",68,0)
 .S OROI=$G(^ORD(101.41,ORI,6,OROIIEN,1))
"RTN","ORQOREP",69,0)
 .Q:'OROI
"RTN","ORQOREP",70,0)
 .Q:$P($P($G(^ORD(101.43,OROI,0)),U,2),";",2)'="99PSP"
"RTN","ORQOREP",71,0)
 .S ORPSOI=$P($P($G(^ORD(101.43,OROI,0)),U,2),";")
"RTN","ORQOREP",72,0)
 .S ORINSDLG=$O(^ORD(101.41,"B","OR GTX INSTRUCTIONS",0))
"RTN","ORQOREP",73,0)
 .Q:'ORINSDLG
"RTN","ORQOREP",74,0)
 .S ORINSIEN=$O(^ORD(101.41,ORI,6,"D",ORINSDLG,0))
"RTN","ORQOREP",75,0)
 .Q:'ORINSIEN
"RTN","ORQOREP",76,0)
 .S ORINS=$G(^ORD(101.41,ORI,6,ORINSIEN,1))
"RTN","ORQOREP",77,0)
 .Q:$L(ORINS)=0
"RTN","ORQOREP",78,0)
 .;GET DISPLAY GROUP
"RTN","ORQOREP",79,0)
 .S ORDG=$P($G(^ORD(101.41,ORI,0)),U,5)
"RTN","ORQOREP",80,0)
 .S ORDG=$P($G(^ORD(100.98,ORDG,0)),U)
"RTN","ORQOREP",81,0)
 .S ORPTYPE=$S(ORDG="UNIT DOSE MEDICATIONS":"U",ORDG="NON-VA MEDICATIONS":"X",ORDG="IV MEDICATIONS":"I",1:"O")
"RTN","ORQOREP",82,0)
 .N ORDOSE2,ORDISP D ALLDOSES(OROI,ORPTYPE,ORPT,.ORDOSE2,.ORDISP)
"RTN","ORQOREP",83,0)
 .N ORDOSE D DOSE^PSSOPKI1(.ORDOSE,ORPSOI,ORPTYPE)
"RTN","ORQOREP",84,0)
 .I $D(DOSAGE),('$D(ORDOSE(1))) Q
"RTN","ORQOREP",85,0)
 .I '$D(DOSAGE),($D(ORDOSE(1))) Q
"RTN","ORQOREP",86,0)
 .I $D(DOSAGE) D
"RTN","ORQOREP",87,0)
 ..N ORDLI S ORDLI=0,EXIT=1
"RTN","ORQOREP",88,0)
 ..F  S ORDLI=$O(ORDOSE(ORDLI)) Q:'ORDLI!('EXIT)  D
"RTN","ORQOREP",89,0)
 ...X DOSAGE S EXIT='$T
"RTN","ORQOREP",90,0)
 .Q:+$G(EXIT)
"RTN","ORQOREP",91,0)
 .Q:$D(ORDOSE2(ORINS))
"RTN","ORQOREP",92,0)
 .N OREXMPT,OREI
"RTN","ORQOREP",93,0)
 .S OREXMPT=1,OREI=0 F  S OREI=$O(ORDOSE("DD",OREI)) Q:'OREI  I '$$EXMT^PSSDSAPI(OREI) S OREXMPT=0
"RTN","ORQOREP",94,0)
 .S:'$D(DOSAGE) OREXMPT=0
"RTN","ORQOREP",95,0)
 .Q:OREXMPT
"RTN","ORQOREP",96,0)
 .N SUBSCRIPT
"RTN","ORQOREP",97,0)
 .S SUBSCRIPT=$S($E($P($G(^ORD(101.41,ORI,0)),U,1),1,6)="ORWDQ ":"PERSONAL",1:"SYSTEM")
"RTN","ORQOREP",98,0)
 .D ADD(DATA,SUBSCRIPT,$$LJ^XLFSTR("QUICK ORDER (IEN):",24," ")_$P(^ORD(101.41,ORI,0),U)_" ("_ORI_")")
"RTN","ORQOREP",99,0)
 .D ADD(DATA,SUBSCRIPT,$$LJ^XLFSTR("QO DISPLAY NAME:",24," ")_$P(^ORD(101.41,ORI,0),U,2))
"RTN","ORQOREP",100,0)
 .I $D(USER)>9 D
"RTN","ORQOREP",101,0)
 ..N HEADER S HEADER="  OWNER(S): "
"RTN","ORQOREP",102,0)
 ..S USER=0 F  S USER=$O(USER(USER)) Q:+$G(USER)=0  D
"RTN","ORQOREP",103,0)
 ...D ADD(DATA,SUBSCRIPT,$$LJ^XLFSTR(HEADER,24," ")_USER(USER))
"RTN","ORQOREP",104,0)
 ...S:HEADER'=" " HEADER=" "
"RTN","ORQOREP",105,0)
 .D ADD(DATA,SUBSCRIPT,"  "_$$LJ^XLFSTR("DISPLAY GROUP:",22," ")_ORDG)
"RTN","ORQOREP",106,0)
 .D ADD(DATA,SUBSCRIPT,"  "_$$LJ^XLFSTR("ORDERABLE ITEM IEN:",22," ")_OROI)
"RTN","ORQOREP",107,0)
 .D ADD(DATA,SUBSCRIPT,"  "_$$LJ^XLFSTR("ORDERABLE ITEM NAME:",22," ")_$P(^ORD(101.43,OROI,0),U))
"RTN","ORQOREP",108,0)
 .D ADD(DATA,SUBSCRIPT,"  "_$$LJ^XLFSTR("QO INSTRUCTIONS:",22," ")_$E(ORINS,1,50))
"RTN","ORQOREP",109,0)
 .D ADD(DATA,SUBSCRIPT,"  "_$$LJ^XLFSTR("DISPENSE:",22," ")_$P(ORDISP,U,4))
"RTN","ORQOREP",110,0)
 .I $L(ORINS)>50 D ADD(DATA,SUBSCRIPT,"  "_$$REPEAT^XLFSTR(" ",22)_$E(ORINS,50,$L(ORINS)))
"RTN","ORQOREP",111,0)
 .D ADD(DATA,SUBSCRIPT,"  CPRS DOSAGE LIST:")
"RTN","ORQOREP",112,0)
 .N ORDI S ORDI="" F  S ORDI=$O(ORDOSE2(ORDI)) Q:ORDI=""  D ADD(DATA,SUBSCRIPT,"    "_ORDI)
"RTN","ORQOREP",113,0)
 .D ADD(DATA,SUBSCRIPT,"")
"RTN","ORQOREP",114,0)
 .S ORCNT=ORCNT+1
"RTN","ORQOREP",115,0)
 S STOP=$$HEADER^ORUTL("QUICK ORDER FREE-TEXT REPORT",.PGNUM)
"RTN","ORQOREP",116,0)
 Q:STOP
"RTN","ORQOREP",117,0)
 S OUT=0 F  S OUT=$O(OUT(OUT)) Q:'OUT  W OUT(OUT),!
"RTN","ORQOREP",118,0)
 W !
"RTN","ORQOREP",119,0)
 N COUNT,LINE
"RTN","ORQOREP",120,0)
 F SUBSCRIPT="SYSTEM","PERSONAL" Q:STOP  D
"RTN","ORQOREP",121,0)
 .F COUNT=1:1:+$G(@DATA@("COUNT",SUBSCRIPT)) Q:STOP  D
"RTN","ORQOREP",122,0)
 ..I ($Y+CBUFFER+$O(@DATA@(SUBSCRIPT,COUNT,"?"),-1))>IOSL S STOP=$$HEADER^ORUTL("QUICK ORDER FREE-TEXT REPORT",.PGNUM)
"RTN","ORQOREP",123,0)
 ..Q:STOP
"RTN","ORQOREP",124,0)
 ..S LINE=0 F  S LINE=$O(@DATA@(SUBSCRIPT,COUNT,LINE)) Q:+$G(LINE)=0!(STOP)  D
"RTN","ORQOREP",125,0)
 ...W @DATA@(SUBSCRIPT,COUNT,LINE)
"RTN","ORQOREP",126,0)
 ...I ($Y+CBUFFER)<IOSL W !
"RTN","ORQOREP",127,0)
 ...I ($Y+CBUFFER)=IOSL S STOP=$$HEADER^ORUTL("QUICK ORDER FREE-TEXT REPORT",.PGNUM)
"RTN","ORQOREP",128,0)
 I 'STOP D
"RTN","ORQOREP",129,0)
 .I ($Y+CBUFFER+2)>IOSL S STOP=$$HEADER^ORUTL("QUICK ORDER FREE-TEXT REPORT",.PGNUM)
"RTN","ORQOREP",130,0)
 .Q:STOP
"RTN","ORQOREP",131,0)
 .W !,$$CJ^XLFSTR(ORCNT_" Quick Orders Found",$S(+$G(IOM)>0:(IOM-1),1:79)," ")
"RTN","ORQOREP",132,0)
 K ^TMP($J,"OR REMDLG"),@DATA
"RTN","ORQOREP",133,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORQOREP",134,0)
 Q
"RTN","ORQOREP",135,0)
ADD(ARRAY,SUBSCRIPT,VALUE) ;ADD A LINE TO THE OUTPUT ARRAY
"RTN","ORQOREP",136,0)
 ;PARAMETERS: ARRAY => NODE ADDRESS OF ARRAY TO STORE VALUE IN
"RTN","ORQOREP",137,0)
 ;            SUBSCRIPT => THE SUBSCRIPT DESCENDANT FROM ARRAY IN WHICH TO STORE VALUE IN
"RTN","ORQOREP",138,0)
 ;            VALUE => DATA TO STORE IN THE OUTPUT ARRAY
"RTN","ORQOREP",139,0)
 I VALUE["QUICK ORDER (IEN):" S @ARRAY@("COUNT",SUBSCRIPT)=1+$G(@ARRAY@("COUNT",SUBSCRIPT))
"RTN","ORQOREP",140,0)
 N LNUM,HOLDING,COLUMN
"RTN","ORQOREP",141,0)
 S COLUMN=$S(VALUE'[":":4,1:24)
"RTN","ORQOREP",142,0)
 D WRAP^ORUTL(VALUE,"HOLDING",1,1,COLUMN)
"RTN","ORQOREP",143,0)
 S LNUM=1+$O(@ARRAY@(SUBSCRIPT,@ARRAY@("COUNT",SUBSCRIPT),"?"),-1)
"RTN","ORQOREP",144,0)
 S HOLDING=0 F  S HOLDING=$O(HOLDING(HOLDING)) Q:'HOLDING  D
"RTN","ORQOREP",145,0)
 .S @ARRAY@(SUBSCRIPT,@ARRAY@("COUNT",SUBSCRIPT),LNUM)=HOLDING(HOLDING)
"RTN","ORQOREP",146,0)
 .S LNUM=1+LNUM
"RTN","ORQOREP",147,0)
 Q
"RTN","ORQOREP",148,0)
ALLDOSES(OROI,ORTYPE,ORPT,OROUT,ORDISP) ;return all doses for an orderable item
"RTN","ORQOREP",149,0)
 N ORY
"RTN","ORQOREP",150,0)
 S ORDISP="NA"
"RTN","ORQOREP",151,0)
 D OISLCT^ORWDPS2(.ORY,OROI,ORTYPE,ORPT,"Y","Y")
"RTN","ORQOREP",152,0)
 N I S I=0 F  S I=$O(ORY(I)) Q:'I  D
"RTN","ORQOREP",153,0)
 .I ORY(I)="~AllDoses" D
"RTN","ORQOREP",154,0)
 ..F  S I=$O(ORY(I)) Q:'I  Q:$E(ORY(I),1,1)="~"  D
"RTN","ORQOREP",155,0)
 ...S OROUT($E(ORY(I),2,$L($P(ORY(I),U))))=""
"RTN","ORQOREP",156,0)
 .I ORY(I)="~Dispense" D
"RTN","ORQOREP",157,0)
 ..F  S I=$O(ORY(I)) Q:'I  Q:$E(ORY(I),1,1)="~"  D
"RTN","ORQOREP",158,0)
 ...S ORDISP=ORY(I)
"RTN","ORQOREP",159,0)
 Q
"RTN","ORQOREP",160,0)
CASE ;
"RTN","ORQOREP",161,0)
 W !!,"This report identifies quick orders that have potentially had the DRUG name",!
"RTN","ORQOREP",162,0)
 W "edited such that when the quick order is loaded in CPRS the dosage that is",!
"RTN","ORQOREP",163,0)
 W "saved with the quick order does not match any of the dosages available for",!
"RTN","ORQOREP",164,0)
 W "selection in the list. This causes the dosage checks not to be able to be",!
"RTN","ORQOREP",165,0)
 W "performed correctly.  The edit to the drug that this specifically looks for",!
"RTN","ORQOREP",166,0)
 W "is a case change to the DRUG name.  If the name is changed so that it",!
"RTN","ORQOREP",167,0)
 W "contains different characters that are not just case changes, this report",!
"RTN","ORQOREP",168,0)
 W "will not identify them.",!
"RTN","ORQOREP",169,0)
 D DEVICE^ORUTL("CASEQ^ORQOREP","OR QUICK ORDER MIXED-CASE","Q")
"RTN","ORQOREP",170,0)
 Q
"RTN","ORQOREP",171,0)
CASEQ ;TASKMAN ENTRY POINT
"RTN","ORQOREP",172,0)
 N ORI,ORPT,ORCNT,STOP,PGNUM
"RTN","ORQOREP",173,0)
 S ORPT=$O(^DPT(0)),ORCNT=0
"RTN","ORQOREP",174,0)
 S ORI=0 F  S ORI=$O(^ORD(101.41,ORI)) Q:'ORI!($G(STOP))  D
"RTN","ORQOREP",175,0)
 .Q:($P(^ORD(101.41,ORI,0),U,4)'="Q")
"RTN","ORQOREP",176,0)
 .N ORINSDLG,ORINSIEN,ORDRDLG,ORDRIEN,ORINS,ORDR,OROIDLG,OROIIEN,OROI,ORDREXT,ORFLAG,ORDG,ORPTYPE,ORDOSE,ORPSOI
"RTN","ORQOREP",177,0)
 .S OROIDLG=$O(^ORD(101.41,"B","OR GTX ORDERABLE ITEM",0))
"RTN","ORQOREP",178,0)
 .Q:'OROIDLG
"RTN","ORQOREP",179,0)
 .S OROIIEN=$O(^ORD(101.41,ORI,6,"D",OROIDLG,0))
"RTN","ORQOREP",180,0)
 .Q:'OROIIEN
"RTN","ORQOREP",181,0)
 .S OROI=$G(^ORD(101.41,ORI,6,OROIIEN,1))
"RTN","ORQOREP",182,0)
 .Q:'OROI
"RTN","ORQOREP",183,0)
 .Q:$P($P($G(^ORD(101.43,OROI,0)),U,2),";",2)'="99PSP"
"RTN","ORQOREP",184,0)
 .S ORPSOI=$P($P($G(^ORD(101.43,OROI,0)),U,2),";")
"RTN","ORQOREP",185,0)
 .S ORINSDLG=$O(^ORD(101.41,"B","OR GTX INSTRUCTIONS",0))
"RTN","ORQOREP",186,0)
 .Q:'ORINSDLG
"RTN","ORQOREP",187,0)
 .S ORINSIEN=$O(^ORD(101.41,ORI,6,"D",ORINSDLG,0))
"RTN","ORQOREP",188,0)
 .Q:'ORINSIEN
"RTN","ORQOREP",189,0)
 .S ORINS=$G(^ORD(101.41,ORI,6,ORINSIEN,1))
"RTN","ORQOREP",190,0)
 .Q:$L(ORINS)=0
"RTN","ORQOREP",191,0)
 .S ORDRDLG=$O(^ORD(101.41,"B","OR GTX DISPENSE DRUG",0))
"RTN","ORQOREP",192,0)
 .Q:'ORDRDLG
"RTN","ORQOREP",193,0)
 .S ORDRIEN=$O(^ORD(101.41,ORI,6,"D",ORDRDLG,0))
"RTN","ORQOREP",194,0)
 .Q:'ORDRIEN
"RTN","ORQOREP",195,0)
 .S ORDR=$G(^ORD(101.41,ORI,6,ORDRIEN,1))
"RTN","ORQOREP",196,0)
 .Q:'ORDR
"RTN","ORQOREP",197,0)
 .S ORDREXT=$$EXTVAL^ORWDX2(ORDR,ORDRDLG)
"RTN","ORQOREP",198,0)
 .;GET DISPLAY GROUP
"RTN","ORQOREP",199,0)
 .S ORDG=$P($G(^ORD(101.41,ORI,0)),U,5)
"RTN","ORQOREP",200,0)
 .S ORDG=$P($G(^ORD(100.98,ORDG,0)),U)
"RTN","ORQOREP",201,0)
 .S ORPTYPE=$S(ORDG="UNIT DOSE MEDICATIONS":"I",1:"O")
"RTN","ORQOREP",202,0)
 .I '$L($T(DOSE^PSSOPKI1)) D DOSE^PSSORUTL(.ORDOSE,ORPSOI,ORPTYPE,ORPT)
"RTN","ORQOREP",203,0)
 .I $L($T(DOSE^PSSOPKI1)) D DOSE^PSSOPKI1(.ORDOSE,ORPSOI,ORPTYPE,ORPT)
"RTN","ORQOREP",204,0)
 .N ORFOUND,ORDOSEI S ORDOSEI=0,ORFOUND=0
"RTN","ORQOREP",205,0)
 .F  S ORDOSEI=$O(ORDOSE(ORDOSEI)) Q:'ORDOSEI  D
"RTN","ORQOREP",206,0)
 ..I ORINS[$P(ORDOSE(ORDOSEI),U,5) S ORFOUND=1
"RTN","ORQOREP",207,0)
 .I ORINS[$P($G(ORDOSE("DD",ORDR)),U) Q
"RTN","ORQOREP",208,0)
 .S ORFLAG=""
"RTN","ORQOREP",209,0)
 .Q:ORINS[ORDREXT
"RTN","ORQOREP",210,0)
 .Q:$$UPPER^ORU(ORINS)'[$$UPPER^ORU(ORDREXT)
"RTN","ORQOREP",211,0)
 .I ($Y+CBUFFER+8)>IOSL!($Y=0) S STOP=$$HEADER^ORUTL("QUICK ORDER MIXED-CASE REPORT",.PGNUM)
"RTN","ORQOREP",212,0)
 .Q:$G(STOP)
"RTN","ORQOREP",213,0)
 .W "QUICK ORDER (IEN):",?24,$P(^ORD(101.41,ORI,0),U,2)," (",ORI,")"
"RTN","ORQOREP",214,0)
 .W !,?2,"DISPLAY GROUP: ",?24,ORDG
"RTN","ORQOREP",215,0)
 .W !,?2,"ORDERABLE ITEM IEN:",?24,OROI
"RTN","ORQOREP",216,0)
 .W !,?2,"ORDERABLE ITEM NAME:",?24,$P(^ORD(101.43,OROI,0),U)
"RTN","ORQOREP",217,0)
 .W !,?2,"DRUG IEN:",?24,ORDR
"RTN","ORQOREP",218,0)
 .W !,?2,"DRUG TEXT:",?24,ORDREXT
"RTN","ORQOREP",219,0)
 .W !,?2,"QO INSTRUCTIONS:",?24,ORINS
"RTN","ORQOREP",220,0)
 .I $Y<IOSL W !
"RTN","ORQOREP",221,0)
 .S ORCNT=ORCNT+1
"RTN","ORQOREP",222,0)
 I '$G(STOP) D
"RTN","ORQOREP",223,0)
 .I ($Y+CBUFFER+2)>IOSL!($Y=0) S STOP=$$HEADER^ORUTL("QUICK ORDER MIXED-CASE REPORT",.PGNUM)
"RTN","ORQOREP",224,0)
 .Q:STOP
"RTN","ORQOREP",225,0)
 .W !,$$CJ^XLFSTR(ORCNT_" Quick Orders Found",$S(+$G(IOM)>0:(IOM-1),1:79)," ")
"RTN","ORQOREP",226,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","ORQOREP",227,0)
 Q
"RTN","ORQQCN2")
0^37^B36811080
"RTN","ORQQCN2",1,0)
ORQQCN2 ; slc/REV - Functions for GUI consult actions ;10/02/13  06:57
"RTN","ORQQCN2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,125,131,149,215,242,280,350**;Dec 17, 1997;Build 77
"RTN","ORQQCN2",3,0)
 ;
"RTN","ORQQCN2",4,0)
 ; DBIA 2426  SERV1^GMRCASV  ^TMP("GMRCSLIST,$J)
"RTN","ORQQCN2",5,0)
 ; DBIA 4576  $$VALID^GMRCAU
"RTN","ORQQCN2",6,0)
 ;
"RTN","ORQQCN2",7,0)
CMT(ORERR,ORIEN,ORCOM,ORALRT,ORALTO,ORDATE) ;Add comment to existing consult without changing status
"RTN","ORQQCN2",8,0)
 ;ORIEN - IEN of consult from File 123
"RTN","ORQQCN2",9,0)
 ;ORERR - return array for results/errors
"RTN","ORQQCN2",10,0)
 ;ORCOM is the comments array to be added
"RTN","ORQQCN2",11,0)
 ;     passed in as ORCOM(1)="Xxxx Xxxxx...",ORCOM(2)="Xxxx Xx Xxx...", ORCOM(3)="Xxxxx Xxx Xx...", etc.
"RTN","ORQQCN2",12,0)
 ;ORALRT - should alerts be sent to anyone?
"RTN","ORQQCN2",13,0)
 ;ORALTO - array of alert recipient IENs
"RTN","ORQQCN2",14,0)
 N ORAD,ORDUZ,ORNP,X
"RTN","ORQQCN2",15,0)
 S ORERR=0,ORAD=$S($D(ORDATE):ORDATE,1:$$NOW^XLFDT),ORNP=""
"RTN","ORQQCN2",16,0)
 I '$D(ORCOM) S ORERR="1^Comments required - no action taken" Q
"RTN","ORQQCN2",17,0)
 I '$D(^GMR(123,ORIEN)) S ORERR="1^No such consult" Q
"RTN","ORQQCN2",18,0)
 I $G(ORALRT)=1 D
"RTN","ORQQCN2",19,0)
 .F I=1:1  S X=$P(ORALTO,";",I) Q:X=""  S ORDUZ(X)=""
"RTN","ORQQCN2",20,0)
 D CMT^GMRCGUIB(ORIEN,.ORCOM,.ORDUZ,ORAD,DUZ)
"RTN","ORQQCN2",21,0)
 Q
"RTN","ORQQCN2",22,0)
 ;
"RTN","ORQQCN2",23,0)
SCH(ORERR,ORIEN,ORNP,ORDATE,ORALRT,ORALTO,ORCOM) ;Schedule consult and change status
"RTN","ORQQCN2",24,0)
 ;ORERR - return array for results/errors
"RTN","ORQQCN2",25,0)
 ;ORIEN - IEN of consult from File 123
"RTN","ORQQCN2",26,0)
 ;ORNP - Provider who Scheduled consult
"RTN","ORQQCN2",27,0)
 ;ORDATE - Date/Time Consult was scheduled.
"RTN","ORQQCN2",28,0)
 ;ORALRT - should alerts be sent to anyone?
"RTN","ORQQCN2",29,0)
 ;ORALTO - array of alert recipient IENs
"RTN","ORQQCN2",30,0)
 ;ORCOM is the comments array to be added
"RTN","ORQQCN2",31,0)
 ;     passed in as ORCOM(1)="Xxxx Xxxxx...",ORCOM(2)="Xxxx Xx Xxx...", ORCOM(3)="Xxxxx Xxx Xx...", etc.
"RTN","ORQQCN2",32,0)
 N ORAD,ORDUZ,X
"RTN","ORQQCN2",33,0)
 S ORERR=0,ORAD=$S($D(ORDATE):ORDATE,1:$$NOW^XLFDT)
"RTN","ORQQCN2",34,0)
 S:+$G(ORNP)=0 ORNP=DUZ
"RTN","ORQQCN2",35,0)
 I '$D(^GMR(123,ORIEN)) S ORERR="1^No such consult" Q
"RTN","ORQQCN2",36,0)
 I $G(ORALRT)=1 D
"RTN","ORQQCN2",37,0)
 .F I=1:1  S X=$P(ORALTO,";",I) Q:X=""  S ORDUZ(X)=""
"RTN","ORQQCN2",38,0)
 S ORERR=$$SCH^GMRCGUIB(ORIEN,ORNP,ORAD,.ORDUZ,.ORCOM)
"RTN","ORQQCN2",39,0)
 Q
"RTN","ORQQCN2",40,0)
 ;
"RTN","ORQQCN2",41,0)
SVCTREE(Y,PURPOSE) ;Returns list of consult service for current
"RTN","ORQQCN2",42,0)
 ;  context, screening for inactive, groupers, and tracking
"RTN","ORQQCN2",43,0)
 ; PURPOSE: Display=0, Forward=1, Order=1
"RTN","ORQQCN2",44,0)
 N GMRCTO,GMRCDG,GMRCSVC,GMRCOI
"RTN","ORQQCN2",45,0)
  S GMRCTO=PURPOSE,GMRCDG=1
"RTN","ORQQCN2",46,0)
 D SERV1^GMRCASV
"RTN","ORQQCN2",47,0)
 S GMRCSVC=0
"RTN","ORQQCN2",48,0)
 I '$D(^TMP("GMRCSLIST",$J)) S Y(1)="-1^No services found" Q  ;DBIA 2426
"RTN","ORQQCN2",49,0)
 F I=1:1  S GMRCSVC=$O(^TMP("GMRCSLIST",$J,GMRCSVC)) Q:+GMRCSVC=0  D
"RTN","ORQQCN2",50,0)
 . S Y(I)=^TMP("GMRCSLIST",$J,GMRCSVC)
"RTN","ORQQCN2",51,0)
 . S GMRCOI=$O(^ORD(101.43,"ID",$P(Y(I),U,1)_";99CON",0))
"RTN","ORQQCN2",52,0)
 . S Y(I)=Y(I)_U_GMRCOI
"RTN","ORQQCN2",53,0)
 Q
"RTN","ORQQCN2",54,0)
 ;
"RTN","ORQQCN2",55,0)
SVCSYN(ORROOT,ORSTRT,ORWHY,ORSYN,ORIEN) ;;return CSLT services for GUI
"RTN","ORQQCN2",56,0)
 ;Input:
"RTN","ORQQCN2",57,0)
 ; ORROOT - passed in as the array to return results in
"RTN","ORQQCN2",58,0)
 ; ORSTRT- service to begin building from
"RTN","ORQQCN2",59,0)
 ; ORWHY - 0 for display, 1 for forwarding or ordering
"RTN","ORQQCN2",60,0)
 ; ORSYN - Boolean: 1=return synonyms, 0=do not
"RTN","ORQQCN2",61,0)
 ; ORIEN - Consult IEN (file 123) (OPTIONAL)
"RTN","ORQQCN2",62,0)
 ;Output: Array formatted as follows-
"RTN","ORQQCN2",63,0)
 ;      svc ien^svc name or syn^parent^has children^svc usage^orderable item
"RTN","ORQQCN2",64,0)
 N ORSVC,I,X,OI
"RTN","ORQQCN2",65,0)
 S:+$G(ORSTRT)=0 ORSTRT=1
"RTN","ORQQCN2",66,0)
 S:$G(ORWHY)="" ORWHY=1
"RTN","ORQQCN2",67,0)
 S:$G(ORSYN)="" ORSYN=1
"RTN","ORQQCN2",68,0)
 S ORROOT=$NA(^TMP("ORCSLT",$J))
"RTN","ORQQCN2",69,0)
 D GUI^GMRCASV1(ORROOT,ORSTRT,ORWHY,ORSYN,$G(ORIEN))
"RTN","ORQQCN2",70,0)
 S ORSVC=0
"RTN","ORQQCN2",71,0)
 I '$D(@ORROOT) S @ORROOT@(1)="-1^No services found" Q
"RTN","ORQQCN2",72,0)
 F I=1:1  S ORSVC=$O(@ORROOT@(ORSVC)) Q:+ORSVC=0  D
"RTN","ORQQCN2",73,0)
 . S X=@ORROOT@(ORSVC)
"RTN","ORQQCN2",74,0)
 . S OI=$O(^ORD(101.43,"ID",$P(X,U,1)_";99CON",0))
"RTN","ORQQCN2",75,0)
 . I +OI>0 S @ORROOT@(ORSVC)=X_U_OI
"RTN","ORQQCN2",76,0)
 Q
"RTN","ORQQCN2",77,0)
STATUS(Y) ; Returns a list of statuses currently in use
"RTN","ORQQCN2",78,0)
 ;
"RTN","ORQQCN2",79,0)
 N GMRCORST
"RTN","ORQQCN2",80,0)
 S GMRCORST=0,Y(999)="999^OTHER^"
"RTN","ORQQCN2",81,0)
 F  S GMRCORST=$O(^ORD(100.01,GMRCORST)) Q:'+GMRCORST  D
"RTN","ORQQCN2",82,0)
 . I '$D(^GMR(123.1,"AC",GMRCORST)) S Y(999)=Y(999)_GMRCORST_"," Q
"RTN","ORQQCN2",83,0)
 . Q:$$SCREEN^XTID(100.01,,GMRCORST_",")  ;inactive VUID
"RTN","ORQQCN2",84,0)
 . S Y(GMRCORST)=GMRCORST_U_$P(^ORD(100.01,GMRCORST,0),U,1)
"RTN","ORQQCN2",85,0)
 Q
"RTN","ORQQCN2",86,0)
 ;
"RTN","ORQQCN2",87,0)
MEDRSLT(ORY,GMRCO) ;Returns Medicine results plus TIU results
"RTN","ORQQCN2",88,0)
 S ORY=$NA(^TMP("ORRSLT",$J))
"RTN","ORQQCN2",89,0)
 D RT^GMRCGUIA(GMRCO,ORY)
"RTN","ORQQCN2",90,0)
 Q
"RTN","ORQQCN2",91,0)
 ;
"RTN","ORQQCN2",92,0)
SHOW513(ORY,GMRCO)  ;CONSULTS SF513 DISPLAY IN GUI
"RTN","ORQQCN2",93,0)
 D GUI^GMRCP5(.ORY,GMRCO)
"RTN","ORQQCN2",94,0)
 Q
"RTN","ORQQCN2",95,0)
PRT513(Y,GMRCO,GMRCCHT,GMRCDEV) ; Print SF513 to VistA device from GUI
"RTN","ORQQCN2",96,0)
 N ORSTATUS
"RTN","ORQQCN2",97,0)
 D EN^GMRCP5(GMRCO,GMRCCHT,GMRCDEV,.ORSTATUS)
"RTN","ORQQCN2",98,0)
 S Y=ORSTATUS
"RTN","ORQQCN2",99,0)
 Q
"RTN","ORQQCN2",100,0)
WPRT513(ORY,GMRCO,GMRCCHT) ;Print SF513 to Windows device from GUI
"RTN","ORQQCN2",101,0)
 N ZTQUEUED,ORHFS,ORSUB,ORIO,ORSTATUS,ROOT,ORHANDLE
"RTN","ORQQCN2",102,0)
 N IOM,IOSL,IOST,IOF,IOT,IOS
"RTN","ORQQCN2",103,0)
 S (ORSUB,ROOT)="ORDATA",ORIO="OR WINDOWS HFS",ORHANDLE="ORQQCN2"
"RTN","ORQQCN2",104,0)
 S ORY=$NA(^TMP(ORSUB,$J,1))
"RTN","ORQQCN2",105,0)
 S ORHFS=$$HFS^ORWRP()
"RTN","ORQQCN2",106,0)
 D HFSOPEN^ORWRP(ORHANDLE,ORHFS,"W")
"RTN","ORQQCN2",107,0)
 I POP D  Q
"RTN","ORQQCN2",108,0)
 . I $D(ROOT) D SETITEM^ORWRP(.ROOT,"ERROR: Unable to open HFS file for SF513 print")
"RTN","ORQQCN2",109,0)
 D IOVAR^ORWRP(.ORIO,,,"P-WINHFS80")
"RTN","ORQQCN2",110,0)
 N $ETRAP,$ESTACK
"RTN","ORQQCN2",111,0)
 S $ETRAP="D ERR^ORWRP Q"
"RTN","ORQQCN2",112,0)
 U IO
"RTN","ORQQCN2",113,0)
 D PRNT^GMRCP5A(GMRCO,0,0,GMRCCHT,0)
"RTN","ORQQCN2",114,0)
 D HFSCLOSE^ORWRP(ORHANDLE,ORHFS)
"RTN","ORQQCN2",115,0)
 Q
"RTN","ORQQCN2",116,0)
SIGFIND(Y,ORIEN,ORFL,ORCOM,ORALRT,ORALTO,ORDATE) ;Significant findings
"RTN","ORQQCN2",117,0)
 S Y=$$SFILE^GMRCGUIB(ORIEN,4,ORFL,"",DUZ,.ORCOM,ORALRT,ORALTO,ORDATE) ; "4"=SIG FIND ACTION
"RTN","ORQQCN2",118,0)
 Q
"RTN","ORQQCN2",119,0)
ADMCOMPL(Y,ORIEN,ORFL,ORCOM,ORRESP,ORALRT,ORALTO,ORDATE) ; Admin users
"RTN","ORQQCN2",120,0)
 ; Administrative complete action
"RTN","ORQQCN2",121,0)
 S Y=$$SFILE^GMRCGUIB(ORIEN,10,ORFL,ORRESP,DUZ,.ORCOM,ORALRT,ORALTO,ORDATE) ; "10"=Admin Complete
"RTN","ORQQCN2",122,0)
 Q
"RTN","ORQQCN2",123,0)
SVCLIST(ORY,FROM,DIR) ; Return a set of consult services in long list format
"RTN","ORQQCN2",124,0)
 ; .ORY=returned list, FROM=text to $O from, DIR=$O direction,
"RTN","ORQQCN2",125,0)
 N I,IEN,CNT,Y,ORTMP,ORSVC,ORSTR
"RTN","ORQQCN2",126,0)
 S I=0,CNT=44,ORSVC=""
"RTN","ORQQCN2",127,0)
 D SVCTREE^ORQQCN2(.Y,1)
"RTN","ORQQCN2",128,0)
 F I=1:1  S ORSVC=$P($G(Y(I)),U,2) Q:ORSVC=""  D
"RTN","ORQQCN2",129,0)
 . S ORTMP(ORSVC)=Y(I)
"RTN","ORQQCN2",130,0)
 F I=1:1  Q:I=CNT  S FROM=$O(ORTMP(FROM),DIR) Q:FROM=""  D
"RTN","ORQQCN2",131,0)
 . S ORSTR=ORTMP(FROM)
"RTN","ORQQCN2",132,0)
 . S ORY(I)=ORSTR
"RTN","ORQQCN2",133,0)
 Q
"RTN","ORQQCN2",134,0)
GETCTXT(Y,ORUSER) ; Returns current view context for user
"RTN","ORQQCN2",135,0)
 S Y=$$GET^XPAR("ALL","ORCH CONTEXT CONSULTS",1)
"RTN","ORQQCN2",136,0)
 Q
"RTN","ORQQCN2",137,0)
SAVECTXT(Y,ORCTXT) ; Save new view preferences for user
"RTN","ORQQCN2",138,0)
 N TMP
"RTN","ORQQCN2",139,0)
 S TMP=$$GET^XPAR(DUZ_";VA(200,","ORCH CONTEXT CONSULTS",1)
"RTN","ORQQCN2",140,0)
 I TMP'="" D  Q
"RTN","ORQQCN2",141,0)
 . D CHG^XPAR(DUZ_";VA(200,","ORCH CONTEXT CONSULTS",1,ORCTXT)
"RTN","ORQQCN2",142,0)
 D ADD^XPAR(DUZ_";VA(200,","ORCH CONTEXT CONSULTS",1,ORCTXT)
"RTN","ORQQCN2",143,0)
 Q
"RTN","ORQQCN2",144,0)
 ;
"RTN","ORQQCN2",145,0)
DEFRFREQ(ORY,ORSVC,ORDFN,RESOLVE) ;Return default reason for request for service
"RTN","ORQQCN2",146,0)
 ; ORSVC=pointer to file 123.5
"RTN","ORQQCN2",147,0)
 ; ORDFN=patient, if RESOLVE=1
"RTN","ORQQCN2",148,0)
 ; RESOLVE=1 to resolve boilerplate, 0 to not resolve
"RTN","ORQQCN2",149,0)
 Q:+$G(ORSVC)=0
"RTN","ORQQCN2",150,0)
 I +RESOLVE,(+$G(ORDFN)=0) Q
"RTN","ORQQCN2",151,0)
 S ORY=$NA(^TMP("ORREQ",$J))
"RTN","ORQQCN2",152,0)
 S:$G(RESOLVE)="" RESOLVE=0
"RTN","ORQQCN2",153,0)
 D GETDEF^GMRCDRFR(.ORY,ORSVC,ORDFN,RESOLVE)
"RTN","ORQQCN2",154,0)
 K @ORY@(0)
"RTN","ORQQCN2",155,0)
 Q
"RTN","ORQQCN2",156,0)
EDITDRFR(ORY,ORSVC) ; Allow editing of reason for request?
"RTN","ORQQCN2",157,0)
 S ORY=$$REAF^GMRCDRFR(ORSVC)
"RTN","ORQQCN2",158,0)
 Q
"RTN","ORQQCN2",159,0)
SVCIEN(ORY,ORIEN) ;Given orderable item file entry, return IEN in 123.5, OR -1 IF INACTIVE IN 101.43
"RTN","ORQQCN2",160,0)
 N X1
"RTN","ORQQCN2",161,0)
 I '$D(^ORD(101.43,ORIEN)) S ORY=-1 Q
"RTN","ORQQCN2",162,0)
 S X1=$G(^ORD(101.43,ORIEN,.1))
"RTN","ORQQCN2",163,0)
 I +X1,+X1<$$NOW^XLFDT S ORY=-1 Q
"RTN","ORQQCN2",164,0)
 S ORY=$P($$USID^ORWDXC(ORIEN),U,4)
"RTN","ORQQCN2",165,0)
 Q
"RTN","ORQQCN2",166,0)
PROVDX(ORY,ORIEN) ;Return provisional dx prompting info for service
"RTN","ORQQCN2",167,0)
 S ORY=$$PROVDX^GMRCUTL1(ORIEN)
"RTN","ORQQCN2",168,0)
 Q
"RTN","ORQQCN2",169,0)
PREREQ(ORY,ORSVC,ORDFN) ;Returns prequisites for ordering
"RTN","ORQQCN2",170,0)
 Q:(+$G(ORSVC)=0)!(+$G(ORDFN)=0)
"RTN","ORQQCN2",171,0)
 S ORY=$NA(^TMP("ORPREREQ",$J))
"RTN","ORQQCN2",172,0)
 D PREREQ^GMRCUTL1(.ORY,ORSVC,ORDFN,0)  ;0=RESOLVE OBJECTS
"RTN","ORQQCN2",173,0)
 K @ORY@(0)
"RTN","ORQQCN2",174,0)
 Q
"RTN","ORQQCN2",175,0)
UNRSLVD(ORY,ORDFN) ;Returns true if unresolved consults for user/pt
"RTN","ORQQCN2",176,0)
 ;S ORY=0
"RTN","ORQQCN2",177,0)
 ;Q:+$$GET^XPAR("ALL","ORWOR SHOW CONSULTS",1,"I")=0
"RTN","ORQQCN2",178,0)
 ;S ORY=+$$ANYPENDG^GMRCTIU(ORDFN,DUZ)   ;DBIA #3473
"RTN","ORQQCN2",179,0)
 ;Q
"RTN","ORQQCN2",180,0)
 S $P(ORY,U,1)=+$$ANYPENDG^GMRCTIU(ORDFN,DUZ)   ;DBIA #3473
"RTN","ORQQCN2",181,0)
 S $P(ORY,U,2)=+$$GET^XPAR("ALL","ORWOR SHOW CONSULTS",1,"I")
"RTN","ORQQCN2",182,0)
 Q
"RTN","ORQQCN2",183,0)
ISPROSVC(ORY,GMRCIEN) ; IS THIS SERVICE PART OF CONSULTS-PROSTHETICS INTERFACE, wat/OR*3*280
"RTN","ORQQCN2",184,0)
 ;GMRCIEN - IEN of selected service
"RTN","ORQQCN2",185,0)
 I $G(^GMR(123.5,$G(GMRCIEN),"INT"))=1 S ORY=1
"RTN","ORQQCN2",186,0)
 Q
"RTN","ORQQCN2",187,0)
VALID(ORY,GMRCIEN,ORDUZ,ORIFC) ;Return users update authority for a consult
"RTN","ORQQCN2",188,0)
 ;ORIFC - If received, will include check for IFC Coordinator
"RTN","ORQQCN2",189,0)
 I +$G(GMRCIEN)=0 S ORY="-1^Consult Service Required" Q
"RTN","ORQQCN2",190,0)
 I +$G(ORDUZ)=0 S ORDUZ=DUZ
"RTN","ORQQCN2",191,0)
 I $G(ORIFC)="" S ORIFC=0
"RTN","ORQQCN2",192,0)
 S ORY=$$VALID^GMRCAU(GMRCIEN,,ORDUZ,,ORIFC)   ;DBIA #4576
"RTN","ORQQCN2",193,0)
 I ORY="" S ORY=0
"RTN","ORQQCN2",194,0)
 Q
"RTN","ORQQPL")
0^70^B33314965
"RTN","ORQQPL",1,0)
ORQQPL ; ISL/CLA,REV,JER,TC - RPCs to return problem list data ;11/20/14  13:37
"RTN","ORQQPL",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**9,10,85,173,306,361,385,350**;Dec 17, 1997;Build 77
"RTN","ORQQPL",3,0)
 ;
"RTN","ORQQPL",4,0)
 ;  External References:
"RTN","ORQQPL",5,0)
 ;  $$CODECS^ICDEX          ICR #5747
"RTN","ORQQPL",6,0)
 ;  $$STATCHK^ICDXCODE      ICR #5699
"RTN","ORQQPL",7,0)
 ;  $$STATCHK^LEXSRC2       ICR #4083
"RTN","ORQQPL",8,0)
 ;
"RTN","ORQQPL",9,0)
LIST(ORPY,DFN,STATUS)  ;return pt's problem list in format: ien^description^
"RTN","ORQQPL",10,0)
 ; ICD^onset^last modified^SC^SpExp
"RTN","ORQQPL",11,0)
 ; STATUS = status of problems to return: (A)CTIVE, (I)NACTIVE, ("")ALL
"RTN","ORQQPL",12,0)
 Q:'+DFN
"RTN","ORQQPL",13,0)
 N ORGMPL,I,DETAIL,ORIDT,IMPLDT
"RTN","ORQQPL",14,0)
 S IMPLDT=$$IMPDATE^LEXU("10D")
"RTN","ORQQPL",15,0)
 S ORIDT=$S($P(DFN,U,2)]"":$P(DFN,U,2),1:DT)
"RTN","ORQQPL",16,0)
 S:ORIDT'>0 ORIDT=DT
"RTN","ORQQPL",17,0)
 S DFN=+DFN
"RTN","ORQQPL",18,0)
 I $L($T(LIST^GMPLUTL2))>0 D
"RTN","ORQQPL",19,0)
 .D LIST^GMPLUTL2(.ORGMPL,DFN,STATUS)
"RTN","ORQQPL",20,0)
 .Q:'$D(ORGMPL(0))
"RTN","ORQQPL",21,0)
 .S DETAIL=$$DETAIL^ORWCV1(10)
"RTN","ORQQPL",22,0)
 .F I=1:1:ORGMPL(0) D
"RTN","ORQQPL",23,0)
 ..N LEX,X
"RTN","ORQQPL",24,0)
 ..S X=ORGMPL(I)
"RTN","ORQQPL",25,0)
 ..S ORPY(I)=$P(X,U)_U_$P(X,U,3)_U_$P(X,U,2)_U_$P(X,U,4)_U_$P(X,U,5)_U_$P(X,U,6)_U_$P(X,U,7)_U_$P(X,U,8)_U_$P(X,U,10)_U_$P(X,U,9)_U_U_DETAIL_U_U_$P(X,U,11)_U_$P(X,U,12)_U_$P(X,U,13)
"RTN","ORQQPL",26,0)
 ..S ORPY(I)=ORPY(I)_U_$S($P(ORPY(I),U,2)?.U1" "1"-"1" ".E:1,1:"")
"RTN","ORQQPL",27,0)
 ..I (ORIDT<IMPLDT),(+$$STATCHK^ICDXCODE($P(ORPY(I),U,16),$P(ORPY(I),U,4),ORIDT)'=1) D  I 1
"RTN","ORQQPL",28,0)
 ...S $P(ORPY(I),U,13)="#",$P(ORPY(I),U,9)="#"
"RTN","ORQQPL",29,0)
 ..E  I $L($P(ORPY(I),U,14)),(+$$STATCHK^LEXSRC2($P(ORPY(I),U,14),ORIDT,.LEX)'=1) S $P(ORPY(I),U,13)="$",$P(ORPY(I),U,9)="#"
"RTN","ORQQPL",30,0)
 .S:+$G(ORPY(1))<1 ORPY(1)="^No problems found."
"RTN","ORQQPL",31,0)
 I $L($T(LIST^GMPLUTL2))<1 S ORPY(1)="^Problem list not available.^"
"RTN","ORQQPL",32,0)
 K X
"RTN","ORQQPL",33,0)
 Q
"RTN","ORQQPL",34,0)
DETAIL(Y,DFN,PROBIEN,ID)  ; RETURN DETAILED PROBLEM DATA
"RTN","ORQQPL",35,0)
 N ORGMPL,ORIDT,GMPDT,ORICDLBL
"RTN","ORQQPL",36,0)
 S ORIDT=$S($P(DFN,U,2)]"":$P(DFN,U,2),1:DT)
"RTN","ORQQPL",37,0)
 S DFN=+DFN
"RTN","ORQQPL",38,0)
 S:ORIDT'>0 ORIDT=DT
"RTN","ORQQPL",39,0)
 I $L($T(DETAIL^GMPLUTL2))>0 D
"RTN","ORQQPL",40,0)
 .N CR,I,J,T,LEX S CR=$CHAR(13),I=1
"RTN","ORQQPL",41,0)
 .D DETAIL^GMPLUTL2(PROBIEN,.ORGMPL)
"RTN","ORQQPL",42,0)
 .S ORICDLBL=$P($$CODECS^ICDEX(ORGMPL("DIAGNOSIS"),80,ORGMPL("DTINTEREST")),U,2)
"RTN","ORQQPL",43,0)
 .S Y(I)=ORGMPL("NARRATIVE"),I=I+1
"RTN","ORQQPL",44,0)
 .I '+$$STATCHK^ICDXCODE(ORGMPL("CSYS"),ORGMPL("DIAGNOSIS"),ORIDT) D  I 1
"RTN","ORQQPL",45,0)
 ..S Y(I)="*** The "_ORICDLBL_" code "_ORGMPL("DIAGNOSIS")_" is currently inactive. ***",I=I+1
"RTN","ORQQPL",46,0)
 .I +$G(ORGMPL("SCTC")),(+$$STATCHK^LEXSRC2($G(ORGMPL("SCTC")),ORIDT,.LEX)'=1) D
"RTN","ORQQPL",47,0)
 ..S Y(I)="*** The SNOMED-CT code "_ORGMPL("SCTC")_" is currently inactive. ***",I=I+1
"RTN","ORQQPL",48,0)
 .I $L($G(ORGMPL("SCTC")))!$L($G(ORGMPL("SCTD"))) D  I 1
"RTN","ORQQPL",49,0)
 ..I $P(ORGMPL("NARRATIVE")," (SCT")'=ORGMPL("SCTT") S Y(I)="         SNOMED-CT: "_ORGMPL("SCTT"),I=I+1
"RTN","ORQQPL",50,0)
 ..I $L($G(ORGMPL("DIAGNOSIS")))&$L($G(ORGMPL("ICDD"))) S Y(I)=$S(ORGMPL("CSYS")="10D":" Primary ",1:"  Primary ")_ORICDLBL_": "_$G(ORGMPL("DIAGNOSIS"))_$$PAD^ORUTL($G(ORGMPL("DIAGNOSIS")),6)_" ["_$G(ORGMPL("ICDD"))_"]",I=I+1
"RTN","ORQQPL",51,0)
 .E  I $L($G(ORGMPL("ICDD"))) D
"RTN","ORQQPL",52,0)
 ..N ICDD,J S ICDD=$$WRAP^ORU2($G(ORGMPL("ICDD")),65)
"RTN","ORQQPL",53,0)
 ..F J=1:1:$L(ICDD,"|") S Y(I)=$S(J=1:ORICDLBL_" TEXT: ",1:"              ")_$P(ICDD,"|",J),I=I+1
"RTN","ORQQPL",54,0)
 .I ORGMPL("ICD9MLTP")'="" F T=1:1:ORGMPL("ICD9MLTP") D
"RTN","ORQQPL",55,0)
 ..N ORMELBL S ORMELBL=$S($P($G(ORGMPL("ICD9MLTP",T)),U,3)="10D":"ICD-10-CM",1:"ICD-9-CM")
"RTN","ORQQPL",56,0)
 ..S Y(I)=$S(T=1:"Secondary "_ORMELBL_": ",T>1:"                  : ")_$P($G(ORGMPL("ICD9MLTP",T)),U)_$$PAD^ORUTL($P($G(ORGMPL("ICD9MLTP",T)),U),6)_" ["_$P($G(ORGMPL("ICD9MLTP",T)),U,2)_"]",I=I+1
"RTN","ORQQPL",57,0)
 .S Y(I)=" ",I=I+1
"RTN","ORQQPL",58,0)
 .S Y(I)="        Onset: "_ORGMPL("ONSET"),I=I+1
"RTN","ORQQPL",59,0)
 .S Y(I)="       Status: "_ORGMPL("STATUS")
"RTN","ORQQPL",60,0)
 .S Y(I)=Y(I)_$S(ORGMPL("PRIORITY")="ACUTE":"/ACUTE",ORGMPL("PRIORITY")="CHRONIC":"/CHRONIC",1:""),I=I+1
"RTN","ORQQPL",61,0)
 .S Y(I)="      SC Cond: "_ORGMPL("SC"),I=I+1
"RTN","ORQQPL",62,0)
 .S Y(I)="     Exposure: "_$S($G(ORGMPL("EXPOSURE"))>0:ORGMPL("EXPOSURE",1),1:"None"),I=I+1
"RTN","ORQQPL",63,0)
 .I $G(ORGMPL("EXPOSURE"))>1 F J=2:1:ORGMPL("EXPOSURE")  D
"RTN","ORQQPL",64,0)
 ..S Y(I)="               "_ORGMPL("EXPOSURE",J),I=I+1
"RTN","ORQQPL",65,0)
 .S Y(I)=" ",I=I+1
"RTN","ORQQPL",66,0)
 .S Y(I)="     Provider: "_ORGMPL("PROVIDER"),I=I+1
"RTN","ORQQPL",67,0)
 .S Y(I)="       Clinic: "_ORGMPL("CLINIC"),I=I+1
"RTN","ORQQPL",68,0)
 .S Y(I)=" ",I=I+1
"RTN","ORQQPL",69,0)
 .S Y(I)="     Recorded: "_$P(ORGMPL("RECORDED"),U)_", by "_$P(ORGMPL("RECORDED"),U,2),I=I+1
"RTN","ORQQPL",70,0)
 .S Y(I)="      Entered: "_$P(ORGMPL("ENTERED"),U)_", by "_$P(ORGMPL("ENTERED"),U,2),I=I+1
"RTN","ORQQPL",71,0)
 .S Y(I)="      Updated: "_ORGMPL("MODIFIED"),I=I+1
"RTN","ORQQPL",72,0)
 .S Y(I)=" ",I=I+1
"RTN","ORQQPL",73,0)
 .;S Y(I)=" Comment: "_$S($G(ORGMPL("COMMENT"))>0:ORGMPL("COMMENT"),1:"")
"RTN","ORQQPL",74,0)
 .I $G(ORGMPL("COMMENT"))>0 D
"RTN","ORQQPL",75,0)
 ..S Y(I)="----------- Comments -----------",I=I+1
"RTN","ORQQPL",76,0)
 ..;F J=ORGMPL("COMMENT"):-1:1  D
"RTN","ORQQPL",77,0)
 ..;.S Y(I)=ORGMPL("COMMENT",J)
"RTN","ORQQPL",78,0)
 ..;.S Y(I)=$P(Y(I),U)_" by "_$P(Y(I),U,2)_": "_$P(Y(I),U,3),I=I+1
"RTN","ORQQPL",79,0)
 ..F J=1:1:ORGMPL("COMMENT")  D
"RTN","ORQQPL",80,0)
 ...S Y(I)=ORGMPL("COMMENT",J)
"RTN","ORQQPL",81,0)
 ...S Y(I)=$P(Y(I),U)_" by "_$P(Y(I),U,2)_": "_$P(Y(I),U,3),I=I+1
"RTN","ORQQPL",82,0)
 .S Y(I)=" ",I=I+1
"RTN","ORQQPL",83,0)
 .D HIST^ORQQPL2(.GMPDT,PROBIEN)
"RTN","ORQQPL",84,0)
 .I $G(GMPDT(0))>0 D
"RTN","ORQQPL",85,0)
 ..S Y(I)="----------- Audit History -----------",I=I+1
"RTN","ORQQPL",86,0)
 ..F J=1:1:GMPDT(0)  S Y(I)=$P(GMPDT(J),U)_":  "_$P(GMPDT(J),U,2),I=I+1
"RTN","ORQQPL",87,0)
 I $L($T(DETAIL^GMPLUTL2))<1 S Y(1)="Problem list not available."
"RTN","ORQQPL",88,0)
 Q
"RTN","ORQQPL",89,0)
HASPROB(ORDFN,ORPROB) ;extrinsic function returns 1^problem text;ICD9 if
"RTN","ORQQPL",90,0)
 ;pt has an active problem which contains any piece of ORPROB
"RTN","ORQQPL",91,0)
 ;ORDFN   patient DFN
"RTN","ORQQPL",92,0)
 ;ORPROB  problems to check vs. active prob list in format: PROB1TEXT;PROB1ICD^PROB2TEXT;PROB2ICD^PROB3...
"RTN","ORQQPL",93,0)
 ;if ICD includes "." an exact match will be sought
"RTN","ORQQPL",94,0)
 ;if not, a match of general ICD category will be sought
"RTN","ORQQPL",95,0)
 ;Note: All ICD codes passed must be preceded with ";"
"RTN","ORQQPL",96,0)
 Q:+$G(ORDFN)<1 "0^Patient not identified."
"RTN","ORQQPL",97,0)
 Q:'$L($G(ORPROB)) "0^Problem not identified."
"RTN","ORQQPL",98,0)
 N ORQAPL,ORQY,ORI,ORJ,ORCNT,ORQPL,ORQICD,ORQRSLT
"RTN","ORQQPL",99,0)
 D LIST(.ORQY,ORDFN,"A")
"RTN","ORQQPL",100,0)
 Q:$P(ORQY(1),U)="" "0^No active problems found."
"RTN","ORQQPL",101,0)
 S ORQRSLT="0^No matching problems found."
"RTN","ORQQPL",102,0)
 S ORCNT=$L(ORPROB,U)
"RTN","ORQQPL",103,0)
 S ORI=0 F  S ORI=$O(ORQY(ORI)) Q:ORI<1  D
"RTN","ORQQPL",104,0)
 .S ORQAPL=ORQY(ORI)
"RTN","ORQQPL",105,0)
 .F ORJ=1:1:ORCNT D
"RTN","ORQQPL",106,0)
 ..S ORQPL=$P($P(ORPROB,U,ORJ),";"),ORQICD=$P($P(ORPROB,U,ORJ),";",2)
"RTN","ORQQPL",107,0)
 ..;if problem text and pt's problem contains problem text passed:
"RTN","ORQQPL",108,0)
 ..I $L(ORQPL),($P(ORQAPL,U,2)[ORQPL) D
"RTN","ORQQPL",109,0)
 ...S ORQRSLT="1^"_$P(ORQAPL,U,2)_";"_$P(ORQAPL,U,4)
"RTN","ORQQPL",110,0)
 ..;
"RTN","ORQQPL",111,0)
 ..;if specific ICD (contains ".") and pt's ICD equals ICD passed:
"RTN","ORQQPL",112,0)
 ..I $L(ORQICD),(ORQICD["."),($P(ORQAPL,U,4)=ORQICD) D
"RTN","ORQQPL",113,0)
 ...S ORQRSLT="1^"_$P(ORQAPL,U,2)_";"_$P(ORQAPL,U,4)
"RTN","ORQQPL",114,0)
 ..;
"RTN","ORQQPL",115,0)
 ..;if non-specific ICD and pt's ICD category equals ICD category passed:
"RTN","ORQQPL",116,0)
 ..I $L(ORQICD),(ORQICD'["."),($P($P(ORQAPL,U,4),".")=ORQICD) D
"RTN","ORQQPL",117,0)
 ...S ORQRSLT="1^"_$P(ORQAPL,U,2)_";"_$P(ORQAPL,U,4)
"RTN","ORQQPL",118,0)
 Q ORQRSLT
"RTN","ORQQPL1")
0^55^B93414156
"RTN","ORQQPL1",1,0)
ORQQPL1 ; ALB/PDR,REV,ISL/JER/TC - PROBLEM LIST FOR CPRS GUI ;08/26/14  09:02
"RTN","ORQQPL1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,148,173,203,206,249,243,280,306,361,385,350**;Dec 17, 1997;Build 77
"RTN","ORQQPL1",3,0)
 ;
"RTN","ORQQPL1",4,0)
 ;------------------------- GET PROBLEM FROM LEXICON -------------------
"RTN","ORQQPL1",5,0)
 ;
"RTN","ORQQPL1",6,0)
LEXSRCH(LIST,FROM,N,VIEW,ORDATE) ; Get candidate Problems from LEX file
"RTN","ORQQPL1",7,0)
 N LEX,VAL,VAL1,COD,CIEN,SYS,MAX,NAME,ORIMPDT,ICDCSYS,ICDCODE
"RTN","ORQQPL1",8,0)
 S ORIMPDT=$$IMPDATE^LEXU("10D")
"RTN","ORQQPL1",9,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORQQPL1",10,0)
 S:'$G(N) N=100
"RTN","ORQQPL1",11,0)
 S:'$L($G(VIEW)) VIEW="PL1"
"RTN","ORQQPL1",12,0)
 D CONFIG^LEXSET("GMPL",VIEW,ORDATE)
"RTN","ORQQPL1",13,0)
 D LOOK^LEXA(FROM,"GMPL",N,"",ORDATE)
"RTN","ORQQPL1",14,0)
 S S=0
"RTN","ORQQPL1",15,0)
 F  S S=$O(LEX("LIST",S)) Q:S<1  D
"RTN","ORQQPL1",16,0)
 . S VAL1=LEX("LIST",S)
"RTN","ORQQPL1",17,0)
 . S COD="",CIEN="",SYS="",NAME="",ICDCODE=""
"RTN","ORQQPL1",18,0)
 . S ICDCSYS=$S(ORDATE<ORIMPDT:"ICD",1:"10D")
"RTN","ORQQPL1",19,0)
 . I $L(VAL1,"CPT-4 ")>1 D
"RTN","ORQQPL1",20,0)
 .. S SYS=$S(ORDATE<ORIMPDT:"ICD-9-CM ",1:"ICD-10-CM ")
"RTN","ORQQPL1",21,0)
 .. S COD=$S(ORDATE<ORIMPDT:"799.9",1:"R69")
"RTN","ORQQPL1",22,0)
 .. S CIEN=""
"RTN","ORQQPL1",23,0)
 .. S NAME=$P(VAL1," (CPT-4")
"RTN","ORQQPL1",24,0)
 . I $L(VAL1,"DSM-IV ")>1 D
"RTN","ORQQPL1",25,0)
 .. S SYS="DSM-IV "
"RTN","ORQQPL1",26,0)
 .. S COD=$P($P(VAL1,SYS,2),")")
"RTN","ORQQPL1",27,0)
 .. S:COD["/" COD=$P(COD,"/",1)
"RTN","ORQQPL1",28,0)
 .. S ICDCODE=$$ONE^LEXU($P(VAL1,U,1),ORDATE,ICDCSYS)
"RTN","ORQQPL1",29,0)
 .. S ICDCODE=$S(ICDCODE["":COD,1:ICDCODE)
"RTN","ORQQPL1",30,0)
 .. S CIEN=+$$ICDDATA^ICDXCODE(ICDCSYS,$G(ICDCODE),ORDATE,"E")
"RTN","ORQQPL1",31,0)
 .. S NAME=$P(VAL1," (DSM-IV")
"RTN","ORQQPL1",32,0)
 .. ;
"RTN","ORQQPL1",33,0)
 . I $L(VAL1,"(TITLE 38 ")>1 D
"RTN","ORQQPL1",34,0)
 .. S SYS="TITLE 38 "
"RTN","ORQQPL1",35,0)
 .. S COD=$P($P(VAL1,SYS,2),")")
"RTN","ORQQPL1",36,0)
 .. S:COD["/" COD=$P(COD,"/",1)
"RTN","ORQQPL1",37,0)
 .. S ICDCODE=$$ONE^LEXU($P(VAL1,U,1),ORDATE,ICDCSYS)
"RTN","ORQQPL1",38,0)
 .. S ICDCODE=$S(ICDCODE["":COD,1:ICDCODE)
"RTN","ORQQPL1",39,0)
 .. S CIEN=+$$ICDDATA^ICDXCODE(ICDCSYS,$G(ICDCODE),ORDATE,"E")
"RTN","ORQQPL1",40,0)
 .. S NAME=$P(VAL1,"(TITLE 38 ")
"RTN","ORQQPL1",41,0)
 .. ;
"RTN","ORQQPL1",42,0)
 . I $L(VAL1,"ICD-9-CM ")>1 D
"RTN","ORQQPL1",43,0)
 .. S SYS="ICD-9-CM "
"RTN","ORQQPL1",44,0)
 .. S COD=$P($P(VAL1,SYS,2),")")
"RTN","ORQQPL1",45,0)
 .. S:COD["/" COD=$P(COD,"/",1)
"RTN","ORQQPL1",46,0)
 .. S CIEN=+$$ICDDATA^ICDXCODE("DIAG",$G(COD),ORDATE,"E")
"RTN","ORQQPL1",47,0)
 .. S NAME=$P(VAL1," (ICD-9-CM")
"RTN","ORQQPL1",48,0)
 .. ;
"RTN","ORQQPL1",49,0)
 . I $L(VAL1,"ICD-10-CM ")>1 D
"RTN","ORQQPL1",50,0)
 .. S SYS="ICD-10-CM "
"RTN","ORQQPL1",51,0)
 .. S COD=$P($P(VAL1,SYS,2),")")
"RTN","ORQQPL1",52,0)
 .. S:COD["/" COD=$P(COD,"/",1)
"RTN","ORQQPL1",53,0)
 .. S CIEN=+$$ICDDATA^ICDXCODE("DIAG",$G(COD),ORDATE,"E")
"RTN","ORQQPL1",54,0)
 .. S NAME=$P(VAL1," (ICD-10-CM")
"RTN","ORQQPL1",55,0)
 . I $L(NAME)=0 S NAME=$P($P(VAL1," (")," *")
"RTN","ORQQPL1",56,0)
 . ;
"RTN","ORQQPL1",57,0)
 . ; jeh Clean left over codes
"RTN","ORQQPL1",58,0)
 . S NAME=$P(NAME," (CPT-4")
"RTN","ORQQPL1",59,0)
 . S NAME=$P(NAME," (DSM-IV")
"RTN","ORQQPL1",60,0)
 . S NAME=$P(NAME,"(TITLE 38 ")
"RTN","ORQQPL1",61,0)
 . S NAME=$P(NAME," (ICD-9-CM")
"RTN","ORQQPL1",62,0)
 . S NAME=$P(NAME," (ICD-10-CM")
"RTN","ORQQPL1",63,0)
 . ;
"RTN","ORQQPL1",64,0)
 . S VAL=NAME_U_COD_U_CIEN_U_SYS ; ien^.01^icd^icdifn^system
"RTN","ORQQPL1",65,0)
 . S LIST(S)=VAL
"RTN","ORQQPL1",66,0)
 . S MAX=S
"RTN","ORQQPL1",67,0)
 I $G(MAX)'="" S LIST(MAX+1)=$G(LEX("MAT"))
"RTN","ORQQPL1",68,0)
 K ^TMP("LEXSCH",$J)
"RTN","ORQQPL1",69,0)
 Q
"RTN","ORQQPL1",70,0)
 ;
"RTN","ORQQPL1",71,0)
SORT(LEX) ; Sort terms alphabetically
"RTN","ORQQPL1",72,0)
 N ORI S ORI=0
"RTN","ORQQPL1",73,0)
 F  S ORI=$O(LEX("LIST",ORI)) Q:+ORI'>0  S LEX("ALPHA",$E($P(LEX("LIST",ORI),U,2),1,255),ORI)=""
"RTN","ORQQPL1",74,0)
 Q
"RTN","ORQQPL1",75,0)
 ;
"RTN","ORQQPL1",76,0)
ICDREC(COD) ;
"RTN","ORQQPL1",77,0)
 N CODIEN,ICDCSYS
"RTN","ORQQPL1",78,0)
 I COD="" Q ""
"RTN","ORQQPL1",79,0)
 S COD=$P($P(COD,U),"/")
"RTN","ORQQPL1",80,0)
 S ICDCSYS=$$SAB^ICDEX(+$$CODECS^ICDEX($G(COD),80,DT),DT) ;ICR #5747
"RTN","ORQQPL1",81,0)
 S CODIEN=+$$ICDDATA^ICDXCODE(ICDCSYS,$G(COD),DT,"E") ;ICR #5699
"RTN","ORQQPL1",82,0)
 Q CODIEN
"RTN","ORQQPL1",83,0)
 ;
"RTN","ORQQPL1",84,0)
CPTREC(COD) ;
"RTN","ORQQPL1",85,0)
 I COD="" Q ""
"RTN","ORQQPL1",86,0)
 Q $$CODEN^ICPTCOD(COD) ;ICR #1995
"RTN","ORQQPL1",87,0)
 ;
"RTN","ORQQPL1",88,0)
EDLOAD(RETURN,DA) ; LOAD  EDIT ARRAYS
"RTN","ORQQPL1",89,0)
 ; DA=problem IFN
"RTN","ORQQPL1",90,0)
 N I,GMPFLD,GMPORIG,GMPL
"RTN","ORQQPL1",91,0)
 D GETFLDS^GMPLEDT3(DA)
"RTN","ORQQPL1",92,0)
 S I=0
"RTN","ORQQPL1",93,0)
 D LOADFLDS(.RETURN,"GMPFLD","NEW",.I)
"RTN","ORQQPL1",94,0)
 D LOADFLDS(.RETURN,"GMPORIG","ORG",.I)
"RTN","ORQQPL1",95,0)
 K GMPFLD,GMPORIG,GMPL  ; should not have to do this
"RTN","ORQQPL1",96,0)
 Q
"RTN","ORQQPL1",97,0)
 ;
"RTN","ORQQPL1",98,0)
LOADFLDS(RETURN,NAM,TYP,I) ; LOAD FIELDS FOR TYPE OF ARRAY
"RTN","ORQQPL1",99,0)
 N S,V,CVP,PN,PID
"RTN","ORQQPL1",100,0)
 S S="",V=$C(254)
"RTN","ORQQPL1",101,0)
 F  S S=$O(@NAM@(S)) Q:S=10  D
"RTN","ORQQPL1",102,0)
 . S RETURN(I)=TYP_V_S_V_@NAM@(S)
"RTN","ORQQPL1",103,0)
 . S I=I+1
"RTN","ORQQPL1",104,0)
 S S=""
"RTN","ORQQPL1",105,0)
 F  S S=$O(@NAM@(10,S)) Q:S=""  D
"RTN","ORQQPL1",106,0)
 . S CVP=@NAM@(10,S)
"RTN","ORQQPL1",107,0)
 . S PN="" ; provider name
"RTN","ORQQPL1",108,0)
 . S PID=$P(CVP,U,6) ; provider id
"RTN","ORQQPL1",109,0)
 . I PID'=""  S PN=$$GET1^DIQ(200,PID,.01) ; get provider name
"RTN","ORQQPL1",110,0)
 . S RETURN(I)=TYP_V_"10,"_S_V_CVP_U_PN
"RTN","ORQQPL1",111,0)
 . S I=I+1
"RTN","ORQQPL1",112,0)
 S S=80000
"RTN","ORQQPL1",113,0)
 F  S S=$O(@NAM@(S)) Q:S=""  D
"RTN","ORQQPL1",114,0)
 . S RETURN(I)=TYP_V_S_V_@NAM@(S)
"RTN","ORQQPL1",115,0)
 . S I=I+1
"RTN","ORQQPL1",116,0)
 Q
"RTN","ORQQPL1",117,0)
 ;
"RTN","ORQQPL1",118,0)
EDSAVE(RETURN,GMPIFN,GMPROV,GMPVAMC,UT,EDARRAY,GMPSRCH) ; SAVE EDITED RES
"RTN","ORQQPL1",119,0)
 ; RETURN - boolean, 1 success, 0 failure
"RTN","ORQQPL1",120,0)
 ; EDARRAY - array used for indirect sets of GMPORIG() and GMPFLDS()
"RTN","ORQQPL1",121,0)
 ;
"RTN","ORQQPL1",122,0)
 N GMPFLD,GMPORIG,S,GMPLUSER
"RTN","ORQQPL1",123,0)
 S GMPSRCH=$G(GMPSRCH)
"RTN","ORQQPL1",124,0)
 S RETURN=1 ; initialize for success
"RTN","ORQQPL1",125,0)
 I UT S GMPLUSER=1
"RTN","ORQQPL1",126,0)
 ;
"RTN","ORQQPL1",127,0)
 S S=""
"RTN","ORQQPL1",128,0)
 F  S S=$O(EDARRAY(S)) Q:S=""  D
"RTN","ORQQPL1",129,0)
 . S @EDARRAY(S)
"RTN","ORQQPL1",130,0)
 I $D(GMPFLD(10,"NEW"))>9 D  I 'RETURN Q  ; Bail Out if no lock
"RTN","ORQQPL1",131,0)
 . L +^AUPNPROB(GMPIFN,11):10  ; given bogus nature of this lock, should be able to get
"RTN","ORQQPL1",132,0)
 . I '$T S RETURN=0
"RTN","ORQQPL1",133,0)
 ;
"RTN","ORQQPL1",134,0)
 D EN^GMPLSAVE  ; save the data
"RTN","ORQQPL1",135,0)
 K GMPFLD,GMPORIG
"RTN","ORQQPL1",136,0)
 ;
"RTN","ORQQPL1",137,0)
 L -^AUPNPROB(GMPIFN,11)  ; free this instance of lock (in case it was set)
"RTN","ORQQPL1",138,0)
 S RETURN=1
"RTN","ORQQPL1",139,0)
 Q
"RTN","ORQQPL1",140,0)
 ;
"RTN","ORQQPL1",141,0)
UPDATE(ORRETURN,UPDARRAY) ; UPDATE A PROBLEM RECORD
"RTN","ORQQPL1",142,0)
 ; Does essentially same job as EDSAVE above, however does not handle edits to comments
"RTN","ORQQPL1",143,0)
 ; or addition of multiple comments.
"RTN","ORQQPL1",144,0)
 ; Use initially just for status updates.
"RTN","ORQQPL1",145,0)
 ;
"RTN","ORQQPL1",146,0)
 N S,GMPL,GMPORIG,ORARRAY ; last 2 vars created in nested call
"RTN","ORQQPL1",147,0)
 S S=""
"RTN","ORQQPL1",148,0)
 F  S S=$O(UPDARRAY(S)) Q:S=""  D
"RTN","ORQQPL1",149,0)
 . S @UPDARRAY(S)
"RTN","ORQQPL1",150,0)
 D UPDATE^GMPLUTL(.ORARRAY,.ORRETURN)
"RTN","ORQQPL1",151,0)
 ; broker wont pick up root node RETURN
"RTN","ORQQPL1",152,0)
 S ORRETURN(1)=ORRETURN(0) ; error text
"RTN","ORQQPL1",153,0)
 S ORRETURN(0)=ORRETURN ; gmpdfn
"RTN","ORQQPL1",154,0)
 I ORRETURN(0)=""  S ORRETURN=1 ; insurance ? need
"RTN","ORQQPL1",155,0)
 Q
"RTN","ORQQPL1",156,0)
 ;
"RTN","ORQQPL1",157,0)
ADDSAVE(RETURN,GMPDFN,GMPROV,GMPVAMC,ADDARRAY,GMPSRCH) ; SAVE NEW RECORD
"RTN","ORQQPL1",158,0)
 ; RETURN - Problem IFN if success, 0 otherwise
"RTN","ORQQPL1",159,0)
 ; ADDARRAY - array used for indirect sets of  GMPFLDS()
"RTN","ORQQPL1",160,0)
 ;
"RTN","ORQQPL1",161,0)
 N DA,GMPFLD,GMPORIG,S
"RTN","ORQQPL1",162,0)
 S GMPSRCH=$G(GMPSRCH)
"RTN","ORQQPL1",163,0)
 S RETURN=0 ;
"RTN","ORQQPL1",164,0)
 L +^AUPNPROB(0):10
"RTN","ORQQPL1",165,0)
 Q:'$T  ; bail out if no lock
"RTN","ORQQPL1",166,0)
 ;
"RTN","ORQQPL1",167,0)
 S S=""
"RTN","ORQQPL1",168,0)
 F  S S=$O(ADDARRAY(S)) Q:S=""  D
"RTN","ORQQPL1",169,0)
 . S @ADDARRAY(S)
"RTN","ORQQPL1",170,0)
 ;
"RTN","ORQQPL1",171,0)
 D NEW^GMPLSAVE
"RTN","ORQQPL1",172,0)
 ;
"RTN","ORQQPL1",173,0)
 S RETURN=DA
"RTN","ORQQPL1",174,0)
 ;
"RTN","ORQQPL1",175,0)
 L -^AUPNPROB(0)
"RTN","ORQQPL1",176,0)
 S RETURN=1
"RTN","ORQQPL1",177,0)
 Q
"RTN","ORQQPL1",178,0)
 ;
"RTN","ORQQPL1",179,0)
INITUSER(RETURN,ORDUZ) ; INITIALIZE FOR NEW USER
"RTN","ORQQPL1",180,0)
 ; taken from INIT^GMPLMGR
"RTN","ORQQPL1",181,0)
 ; leave GMPLUSER on symbol table - is evaluated in EDITSAVE
"RTN","ORQQPL1",182,0)
 ;
"RTN","ORQQPL1",183,0)
 N X,PV,CTXT,GMPLPROV,ORENT
"RTN","ORQQPL1",184,0)
 S ORDUZ=$G(ORDUZ,DUZ)
"RTN","ORQQPL1",185,0)
 S GMPLUSER=$$CLINUSER(ORDUZ)
"RTN","ORQQPL1",186,0)
 S CTXT=$$GET^XPAR("ALL","ORCH CONTEXT PROBLEMS",1)
"RTN","ORQQPL1",187,0)
 S X=$G(^GMPL(125.99,1,0)) ; IN1+6^GMPLMGR
"RTN","ORQQPL1",188,0)
 S RETURN(0)=GMPLUSER ;  problem list user, or other user
"RTN","ORQQPL1",189,0)
 S RETURN(1)=$$VIEW^GMPLX1(ORDUZ) ; GMPLVIEW("VIEW") - users default view
"RTN","ORQQPL1",190,0)
 S RETURN(2)=+$P(X,U,2) ; verify transcribed problems
"RTN","ORQQPL1",191,0)
 S RETURN(3)=+$P(X,U,3) ; prompt for chart copy
"RTN","ORQQPL1",192,0)
 S RETURN(4)=+$P(X,U,4) ; use lexicon
"RTN","ORQQPL1",193,0)
 S RETURN(5)=$S($P(X,U,5)="R":1,1:0) ; chron or reverse chron listing
"RTN","ORQQPL1",194,0)
 S RETURN(6)=$S($P($G(CTXT),";",3)'="":$P($G(CTXT),";",3),1:"A")
"RTN","ORQQPL1",195,0)
 S GMPLPROV=$P($G(CTXT),";",5)
"RTN","ORQQPL1",196,0)
 I +GMPLPROV>0,$D(^VA(200,GMPLPROV)) D
"RTN","ORQQPL1",197,0)
 . S RETURN(7)=GMPLPROV_U_$P(^VA(200,GMPLPROV,0),U)
"RTN","ORQQPL1",198,0)
 E  S RETURN(7)="0^All"
"RTN","ORQQPL1",199,0)
 S RETURN(8)=$$SERVICE^GMPLX1(ORDUZ) ; user's service/section
"RTN","ORQQPL1",200,0)
 ; Guessing from what I see in the data that $$VIEW^GMPLX1 actually returns a composite
"RTN","ORQQPL1",201,0)
 ; of default view (in/out patient)/(c1/c2... if out patient i.e. GMPLVIEW("CLIN")) or
"RTN","ORQQPL1",202,0)
 ;                                                      /(s1/s2... if in patient i.e. GMPLVIEW("SERV"))
"RTN","ORQQPL1",203,0)
 ; Going with this assumption for now:
"RTN","ORQQPL1",204,0)
 I $L(RETURN(1),"/")>1 D
"RTN","ORQQPL1",205,0)
 . S PV=RETURN(1)
"RTN","ORQQPL1",206,0)
 . S RETURN(1)=$P(PV,"/")
"RTN","ORQQPL1",207,0)
 . I RETURN(1)="C" S GMPLVIEW("CLIN")=$P(PV,"/",2,99)
"RTN","ORQQPL1",208,0)
 . I RETURN(1)="S" S GMPLVIEW("SERV")=$P(PV,"/",2,99)
"RTN","ORQQPL1",209,0)
 S RETURN(9)=$G(GMPLVIEW("SERV")) ; ??? Where from - see tech doc
"RTN","ORQQPL1",210,0)
 S RETURN(10)=$G(GMPLVIEW("CLIN")) ; ??? Where from - see tech doc
"RTN","ORQQPL1",211,0)
 S RETURN(11)=""
"RTN","ORQQPL1",212,0)
 S RETURN(12)=+$P($G(CTXT),";",4)    ; should comments display?
"RTN","ORQQPL1",213,0)
 S ORENT="ALL^SRV.`"_+$$SERVICE^GMPLX1(ORDUZ,1)
"RTN","ORQQPL1",214,0)
 S RETURN(13)=+$$GET^XPAR(ORENT,"ORQQPL SUPPRESS CODES",1) ; suppress codes?
"RTN","ORQQPL1",215,0)
 K GMPLVIEW
"RTN","ORQQPL1",216,0)
 Q
"RTN","ORQQPL1",217,0)
 ;
"RTN","ORQQPL1",218,0)
CLINUSER(ORDUZ) ;is this a clinical user?
"RTN","ORQQPL1",219,0)
 N ORUSER
"RTN","ORQQPL1",220,0)
 S ORUSER=0
"RTN","ORQQPL1",221,0)
 I $D(^XUSEC("ORES",ORDUZ)) S ORUSER=1
"RTN","ORQQPL1",222,0)
 I $D(^XUSEC("ORELSE",ORDUZ)) S ORUSER=1
"RTN","ORQQPL1",223,0)
 I $D(^XUSEC("PROVIDER",ORDUZ)) S ORUSER=1
"RTN","ORQQPL1",224,0)
 Q ORUSER
"RTN","ORQQPL1",225,0)
 ;
"RTN","ORQQPL1",226,0)
INITPT(RETURN,DFN) ; GET PATIENT PARAMETERS
"RTN","ORQQPL1",227,0)
 Q:+$G(DFN)=0
"RTN","ORQQPL1",228,0)
 N GMPSC,GMPAGTOR,GMPION,GMPGULF,GMPHNC,GMPMST,GMPCV,GMPSHD
"RTN","ORQQPL1",229,0)
 ;
"RTN","ORQQPL1",230,0)
 S RETURN(0)=DUZ(2) ; facility #
"RTN","ORQQPL1",231,0)
 D DEM^VADPT ; get death indicator
"RTN","ORQQPL1",232,0)
 S RETURN(1)=$G(VADM(6)) ; death indicator
"RTN","ORQQPL1",233,0)
 D VADPT^GMPLX1(DFN) ; get eligibilities
"RTN","ORQQPL1",234,0)
 S RETURN(2)=$P(GMPSC,U) ; service connected
"RTN","ORQQPL1",235,0)
 S RETURN(3)=$G(GMPAGTOR) ; agent orange exposure
"RTN","ORQQPL1",236,0)
 S RETURN(4)=$G(GMPION) ; ionizing radiation exposure
"RTN","ORQQPL1",237,0)
 S RETURN(5)=$G(GMPGULF) ; gulf war exposure
"RTN","ORQQPL1",238,0)
 S RETURN(6)=VA("BID") ; need this to reconstitute GMPDFN on return
"RTN","ORQQPL1",239,0)
 S RETURN(7)=$G(GMPHNC) ; head/neck cancer
"RTN","ORQQPL1",240,0)
 S RETURN(8)=$G(GMPMST) ; MST
"RTN","ORQQPL1",241,0)
 S RETURN(9)=$G(GMPCV) ; CV
"RTN","ORQQPL1",242,0)
 S RETURN(10)=$G(GMPSHD) ; SHAD
"RTN","ORQQPL1",243,0)
 Q
"RTN","ORQQPL1",244,0)
 ;
"RTN","ORQQPL1",245,0)
PROVSRCH(LST,FLAG,N,FROM,PART) ; Get candidate Rroviders from person file
"RTN","ORQQPL1",246,0)
 N LV,NS,RV,IEN
"RTN","ORQQPL1",247,0)
 S RV=$NAME(LV("DILIST","ID"))
"RTN","ORQQPL1",248,0)
 IF +$G(N)=0 S N=50
"RTN","ORQQPL1",249,0)
 S FLAG=$G(FLAG),N=$G(N),FROM=$G(FROM),PART=$G(PART)
"RTN","ORQQPL1",250,0)
 D LIST^DIC(200,"",".01;1",FLAG,N,FROM,PART,"","","","LV")
"RTN","ORQQPL1",251,0)
 S NS=""
"RTN","ORQQPL1",252,0)
 F  S NS=$O(LV("DILIST",1,NS)) Q:NS=""  D
"RTN","ORQQPL1",253,0)
 . S IEN=""
"RTN","ORQQPL1",254,0)
 . S IEN=$O(^VA(200,"B",@RV@(NS,.01),IEN)) ; compliments of PROV^ORQPTQ
"RTN","ORQQPL1",255,0)
 . S LST(NS)=IEN_U_@RV@(NS,.01)  ; initials_U_@RV@(NS,1)
"RTN","ORQQPL1",256,0)
 Q
"RTN","ORQQPL1",257,0)
 ;
"RTN","ORQQPL1",258,0)
CLINSRCH(Y,X) ; Get LIST OF CLINICS
"RTN","ORQQPL1",259,0)
 ; Note: This comes from CLIN^ORQPTQ2, where it was commented out in place of
"RTN","ORQQPL1",260,0)
 ; a call to ^XPAR. I would have just used CLIN^ORQPTQ2, but it didn't work - at
"RTN","ORQQPL1",261,0)
 ; least on SLC OEX directory.
"RTN","ORQQPL1",262,0)
 ; X has no purpose other than to satisfy apparent rpc and tcallv requirement for args
"RTN","ORQQPL1",263,0)
 N I,NAME,IEN
"RTN","ORQQPL1",264,0)
 S I=1,IEN=0,NAME=""
"RTN","ORQQPL1",265,0)
 ;access to SC global granted under DBIA #518:
"RTN","ORQQPL1",266,0)
 F  S NAME=$O(^SC("B",NAME)) Q:NAME=""  S IEN=$O(^(NAME,0)) D
"RTN","ORQQPL1",267,0)
 . I $P(^SC(IEN,0),"^",3)="C" S Y(I)=IEN_"^"_NAME,I=I+1
"RTN","ORQQPL1",268,0)
 Q
"RTN","ORQQPL1",269,0)
 ;
"RTN","ORQQPL1",270,0)
SRVCSRCH(Y,FROM,DIR,ALL) ; GET LIST OF SERVICES
"RTN","ORQQPL1",271,0)
 N I,IEN,CNT S I=0,CNT=44
"RTN","ORQQPL1",272,0)
 F  Q:I=CNT  S FROM=$O(^DIC(49,"B",FROM),DIR) Q:FROM=""  D
"RTN","ORQQPL1",273,0)
 . S IEN=$O(^DIC(49,"B",FROM,0)) I '$G(ALL),$P(^DIC(49,IEN,0),U,9)'="C" Q
"RTN","ORQQPL1",274,0)
 . S I=I+1,Y(I)=IEN_"^"_FROM
"RTN","ORQQPL1",275,0)
 Q
"RTN","ORQQPL1",276,0)
 ;
"RTN","ORQQPL1",277,0)
DUP(Y,DFN,TERM,TEXT) ;Check for duplicate problem
"RTN","ORQQPL1",278,0)
 S Y=$$DUPL^GMPLX(DFN,TERM,TEXT) Q:+Y=0
"RTN","ORQQPL1",279,0)
 I $P(^AUPNPROB(Y,1),U,2)="H" S Y=0 Q
"RTN","ORQQPL1",280,0)
 S Y=Y_U_$P(^AUPNPROB(Y,0),U,12)
"RTN","ORQQPL1",281,0)
 Q
"RTN","ORQQPL1",282,0)
GETDX(CODE,SYS,ORIDT) ; Get ICD associated with SNOMED CT or VHAT Code
"RTN","ORQQPL1",283,0)
 N LEX,ORI,ORY,ORUH,IMPLDT,ORCSYSPR
"RTN","ORQQPL1",284,0)
 S ORIDT=$G(ORIDT,DT)
"RTN","ORQQPL1",285,0)
 S ORY=0,IMPLDT=$$IMPDATE^LEXU("10D")
"RTN","ORQQPL1",286,0)
 S ORUH=$S(ORIDT<IMPLDT:"799.9",1:"R69.")
"RTN","ORQQPL1",287,0)
 S ORCSYSPR=$S(ORIDT<IMPLDT:1,1:30)
"RTN","ORQQPL1",288,0)
 I SYS["VHAT" D  I 1
"RTN","ORQQPL1",289,0)
 . I ORIDT<IMPLDT S ORY=$$GETASSN^LEXTRAN1(CODE,"VHAT2ICD") I 1
"RTN","ORQQPL1",290,0)
 . E  S ORY=0
"RTN","ORQQPL1",291,0)
 E  D
"RTN","ORQQPL1",292,0)
 . I ORIDT<IMPLDT S ORY=$$GETASSN^LEXTRAN1(CODE,"SCT2ICD") I 1
"RTN","ORQQPL1",293,0)
 . E  S ORY=0
"RTN","ORQQPL1",294,0)
 I $S(+ORY'>0:1,+$P(ORY,U,2)'>0:1,+LEX'>0:1,1:0) S ORY=ORUH G GETDXX
"RTN","ORQQPL1",295,0)
 S ORI=0,ORY=""
"RTN","ORQQPL1",296,0)
 F  S ORI=$O(LEX(ORI)) Q:+ORI'>0  D
"RTN","ORQQPL1",297,0)
 . N ICD
"RTN","ORQQPL1",298,0)
 . S ICD=$O(LEX(ORI,""))
"RTN","ORQQPL1",299,0)
 . S:'+$$STATCHK^ICDXCODE(ORCSYSPR,ICD,ORIDT) ICD=""
"RTN","ORQQPL1",300,0)
 . I ICD]"" S ORY=$S(ORY'="":ORY_"/",1:"")_ICD
"RTN","ORQQPL1",301,0)
 I (ORY]""),(ORY'[".") S ORY=ORY_"."
"RTN","ORQQPL1",302,0)
GETDXX Q ORY
"RTN","ORQQPL1",303,0)
TEST ; test invocation
"RTN","ORQQPL1",304,0)
 N LIST,I S I=""
"RTN","ORQQPL1",305,0)
 D LEXSRCH(.LIST,"diabetes with neuro",10,"GMPL",DT)
"RTN","ORQQPL1",306,0)
 F  S I=$O(LIST(I)) Q:+I'>0  W !,LIST(I)
"RTN","ORQQPL1",307,0)
 Q
"RTN","ORQQPL4")
0^76^B15703032
"RTN","ORQQPL4",1,0)
ORQQPL4 ; ISL/JER/TC - Lexicon Look-up w/Synonyms ;07/30/15  08:25
"RTN","ORQQPL4",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**306,361,350**;Dec 17, 1997;Build 77
"RTN","ORQQPL4",3,0)
 ;
"RTN","ORQQPL4",4,0)
 ; DBIA 2950   LOOK^LEXA          ^TMP("LEXFND",$J)
"RTN","ORQQPL4",5,0)
 ; DBIA 1609   CONFIG^LEXSET      ^TMP("LEXSCH",$J)
"RTN","ORQQPL4",6,0)
 ;  ICR 5699   $$ICDDATA^ICDXCODE
"RTN","ORQQPL4",7,0)
 ;
"RTN","ORQQPL4",8,0)
 Q
"RTN","ORQQPL4",9,0)
LEX(LST,X,VIEW,ORDATE,ORINCSYN) ; return list after lexicon lookup
"RTN","ORQQPL4",10,0)
 ; Call with: X           (Required) The search text entered by the user
"RTN","ORQQPL4",11,0)
 ;            [VIEW]      (Optional) The Lexicon VIEW parameter (Defaults to
"RTN","ORQQPL4",12,0)
 ;                                   Problem List Subset (i.e., "PLS")
"RTN","ORQQPL4",13,0)
 ;            [ORDATE]    (Optional) the date of interest (Defaults to TODAY)
"RTN","ORQQPL4",14,0)
 ;            [ORINCSYN]  (Optional) Boolean flag specifying whether or not to
"RTN","ORQQPL4",15,0)
 ;                                   include synonyms for SNOMED CT Concepts
"RTN","ORQQPL4",16,0)
 ;                                   (Defaults to 0 (FALSE))
"RTN","ORQQPL4",17,0)
 ;
"RTN","ORQQPL4",18,0)
 ;   Returns: LST=gvn of ^TMP("ORLEX",$J), which contains search result set as:
"RTN","ORQQPL4",19,0)
 ;            ^TMP("ORLEX",$J,1..n)=LEXIEN^PREFTEXT^ICDCODE(S)^ICDIEN^CODESYS^CONCEPTID^DESIGID^ICDVER^PARENTSUBSCRIPT
"RTN","ORQQPL4",20,0)
 ;            ^TMP("ORLEX",$J,n+1)="<n> matches found"
"RTN","ORQQPL4",21,0)
 ;
"RTN","ORQQPL4",22,0)
 N LEX,ILST,I,IEN,APP
"RTN","ORQQPL4",23,0)
 S APP="GMPX",LST=$NA(^TMP("ORLEX",$J)) K @LST
"RTN","ORQQPL4",24,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORQQPL4",25,0)
 S:'$L($G(VIEW)) VIEW="PLS"
"RTN","ORQQPL4",26,0)
 S ORINCSYN=+$G(ORINCSYN)
"RTN","ORQQPL4",27,0)
 I $S(X?.1A2.3N.1".".2N:1,X?.1A2.3N1"+":1,1:0) D  Q
"RTN","ORQQPL4",28,0)
 . S @LST@(1)="icd^Searching by code on the Problems Tab supports SNOMED CT, but not ICD."
"RTN","ORQQPL4",29,0)
 . S @LST@(2)="Please try a different search"
"RTN","ORQQPL4",30,0)
 D CONFIG^LEXSET(APP,VIEW,ORDATE)
"RTN","ORQQPL4",31,0)
 ; call LOOK^LEXA to execute the search as defined by the call to CONFIG^LEXSET
"RTN","ORQQPL4",32,0)
 D LOOK^LEXA(X,,1,,ORDATE)
"RTN","ORQQPL4",33,0)
 I '$D(LEX("LIST",1)) D  G LEXX
"RTN","ORQQPL4",34,0)
 . S:X?.N @LST@(1)="Code search failed"
"RTN","ORQQPL4",35,0)
 S ILST=0
"RTN","ORQQPL4",36,0)
 S @LST@(1)=$$LEXXFRM(LEX("LIST",1),ORDATE,APP),ILST=1
"RTN","ORQQPL4",37,0)
 D:ORINCSYN SYNONYMS(.LST,.ILST,"SCT",$P(@LST@(1),U,6),ORDATE)
"RTN","ORQQPL4",38,0)
 S (I,IEN)=""
"RTN","ORQQPL4",39,0)
 F  S I=$O(^TMP("LEXFND",$J,I)) Q:I=""  D  ;DBIA 2950
"RTN","ORQQPL4",40,0)
 .F  S IEN=$O(^TMP("LEXFND",$J,I,IEN)) Q:IEN=""  D
"RTN","ORQQPL4",41,0)
 ..N TXT,ELEMENT S TXT=^TMP("LEXFND",$J,I,IEN)
"RTN","ORQQPL4",42,0)
 ..S ELEMENT=IEN_U_TXT
"RTN","ORQQPL4",43,0)
 ..S ELEMENT=$$LEXXFRM(ELEMENT,ORDATE,APP)
"RTN","ORQQPL4",44,0)
 ..S ILST=ILST+1,@LST@(ILST)=ELEMENT
"RTN","ORQQPL4",45,0)
 ..D:ORINCSYN SYNONYMS(.LST,.ILST,"SCT",$P(ELEMENT,U,6),ORDATE)
"RTN","ORQQPL4",46,0)
 I '$D(@LST@(1)) S @LST@(1)="No matches found"
"RTN","ORQQPL4",47,0)
 E  S @LST@(ILST+1)=ILST_$S(ILST=1:" match",1:" matches")_" found"
"RTN","ORQQPL4",48,0)
LEXX K ^TMP("LEXFND",$J),^TMP("LEXHIT",$J),^TMP("LEXSCH",$J),^TMP("LEXLE",$J)
"RTN","ORQQPL4",49,0)
 Q
"RTN","ORQQPL4",50,0)
LEXXFRM(ORX,ORDATE,ORAPP) ; Transform text for SCT look-up
"RTN","ORQQPL4",51,0)
 N ORLEX,ORY,ORICD,ORSCT,ORTXT,ORCODSYS,ORCCODE,ORDCODE
"RTN","ORQQPL4",52,0)
 S ORLEX=$P(ORX,U),ORTXT=$P(ORX,U,2),(ORCCODE,ORCODSYS)=""
"RTN","ORQQPL4",53,0)
 I ORTXT["*" S ORTXT=$$STRIP^XLFSTR(ORTXT,"*")
"RTN","ORQQPL4",54,0)
 I (ORTXT["("),(ORTXT[")") D
"RTN","ORQQPL4",55,0)
 . S ORCODSYS=$RE($P($P($RE(ORTXT),"("),")",2))
"RTN","ORQQPL4",56,0)
 . S ORCCODE=$$ONE^LEXU(+ORLEX,ORDATE,"SCT"),ORCODSYS=$RE($P($RE(ORCODSYS)," ",2,99))
"RTN","ORQQPL4",57,0)
 . S ORTXT=$$TRIM^XLFSTR($RE($P($RE(ORTXT),"(",2,99)))
"RTN","ORQQPL4",58,0)
 S ORY=$$SETELEM(ORLEX,ORTXT,ORCODSYS,ORCCODE,ORDATE)
"RTN","ORQQPL4",59,0)
 Q ORY
"RTN","ORQQPL4",60,0)
SYNONYMS(LST,ILST,ORCSYS,ORCCODE,ORDT) ; Get synonyms for expression
"RTN","ORQQPL4",61,0)
 N ORSYN,ORI,ORDAD S ORDT=$G(ORDT,DT),ORDAD=ILST
"RTN","ORQQPL4",62,0)
 D GETSYN^LEXTRAN1(ORCSYS,ORCCODE,ORDT,"ORSYN",1,1)
"RTN","ORQQPL4",63,0)
 S ORI=0 F  S ORI=$O(ORSYN("S",ORI)) Q:+ORI'>0  D
"RTN","ORQQPL4",64,0)
 . N ELEMENT,TXT,IEN,ORDCODE
"RTN","ORQQPL4",65,0)
 . S IEN=$P(ORSYN("S",ORI),U,2),TXT=$P(ORSYN("S",ORI),U),ORDCODE=$P(ORSYN("S",ORI),U,3)
"RTN","ORQQPL4",66,0)
 . S ELEMENT=$$SETELEM(IEN,TXT,"SNOMED CT",ORCCODE,ORDT,ORDCODE)_U_ORDAD
"RTN","ORQQPL4",67,0)
 . S ILST=ILST+1,@LST@(ILST)=ELEMENT
"RTN","ORQQPL4",68,0)
 Q
"RTN","ORQQPL4",69,0)
SETELEM(ORLEX,ORTXT,ORCODSYS,ORCCODE,ORDATE,ORDCODE) ; Set List Element
"RTN","ORQQPL4",70,0)
 N ORY,ORIMPDT,ORICD,ORICDID,ORSYN,ORTYP,ORQT,ORNUM
"RTN","ORQQPL4",71,0)
 S ORIMPDT=$$IMPDATE^LEXU("10D"),(ORTYP,ORQT,ORNUM)=""
"RTN","ORQQPL4",72,0)
 I '$D(ORDCODE) D
"RTN","ORQQPL4",73,0)
 . S ORDCODE=$$GETSYN^LEXTRAN1("SCT",ORCCODE,ORDATE,"ORSYN",1,1)
"RTN","ORQQPL4",74,0)
 . I $P(ORDCODE,U)'=1 S ORDCODE="" Q
"RTN","ORQQPL4",75,0)
 . F  S ORTYP=$O(ORSYN(ORTYP)) Q:ORTYP="S"!(ORQT)  D
"RTN","ORQQPL4",76,0)
 . . I $P(ORSYN(ORTYP),U)=ORTXT S ORDCODE=$P(ORSYN(ORTYP),U,3),ORQT=1 Q
"RTN","ORQQPL4",77,0)
 . I ORTYP="S" F  S ORNUM=$O(ORSYN(ORTYP,ORNUM)) Q:ORNUM=""!(ORQT)  D
"RTN","ORQQPL4",78,0)
 . . I $P(ORSYN(ORTYP,ORNUM),U)=ORTXT S ORDCODE=$P(ORSYN(ORTYP,ORNUM),U,3),ORQT=1 Q
"RTN","ORQQPL4",79,0)
 I ORDCODE["^" S ORDCODE=""
"RTN","ORQQPL4",80,0)
 S ORICD=$$GETDX^ORQQPL1(ORCCODE,ORCODSYS,ORDATE)
"RTN","ORQQPL4",81,0)
 S ORICDID=+$$ICDDATA^ICDXCODE("DIAG",$P(ORICD,"/"),ORDATE,"E")
"RTN","ORQQPL4",82,0)
 S ORY=ORLEX_U_ORTXT_U_ORICD_U_ORICDID_U_ORCODSYS_U_ORCCODE_U_ORDCODE
"RTN","ORQQPL4",83,0)
 I (ORCODSYS["SNOMED")!(ORCODSYS["VHAT") D
"RTN","ORQQPL4",84,0)
 .S ORY=ORY_U_$S(ORDATE<ORIMPDT:"ICD-9-CM",1:"ICD-10-CM")
"RTN","ORQQPL4",85,0)
 Q ORY
"RTN","ORTSKLPS")
0^10^B8724691
"RTN","ORTSKLPS",1,0)
ORTSKLPS ;SLC/JMH - NIGHTLY TASK TO LAPSE OLD UNSIGNED ORDERS;03/27/2015  11:45
"RTN","ORTSKLPS",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**243,280,350**;Dec 17, 1997;Build 77
"RTN","ORTSKLPS",3,0)
 ;
"RTN","ORTSKLPS",4,0)
TASK ;
"RTN","ORTSKLPS",5,0)
 ;only run between Midnight and 1:59:59 AM
"RTN","ORTSKLPS",6,0)
 ;I $E($P($$NOW^XLFDT,".",2),1,2)>1 Q
"RTN","ORTSKLPS",7,0)
 ;don't run if run recently (within 4 hours)
"RTN","ORTSKLPS",8,0)
 ;I $$FMDIFF^XLFDT($$NOW^XLFDT,$G(^XTMP("OR LAPSE ORDERS","LAST TIME")),2)<14400 Q
"RTN","ORTSKLPS",9,0)
 ;set timestamp of last run
"RTN","ORTSKLPS",10,0)
 S ^XTMP("OR LAPSE ORDERS",0)=$$FMADD^XLFDT($$NOW^XLFDT,2)_U_$$NOW^XLFDT
"RTN","ORTSKLPS",11,0)
 S ^XTMP("OR LAPSE ORDERS","LAST TIME")=$$NOW^XLFDT
"RTN","ORTSKLPS",12,0)
 ;loop through unsigned orders
"RTN","ORTSKLPS",13,0)
 N ORVP,ORDT,ORN,ORACT,ORINVDT,ORPARAM,ORDIAL,ORDISP
"RTN","ORTSKLPS",14,0)
 S ORVP="" F  S ORVP=$O(^OR(100,"AS",ORVP)) Q:'$L(ORVP)  D
"RTN","ORTSKLPS",15,0)
 .N ORDATA,ORDERERS
"RTN","ORTSKLPS",16,0)
 .S ORINVDT=0 F  S ORINVDT=$O(^OR(100,"AS",ORVP,ORINVDT)) Q:'ORINVDT  D
"RTN","ORTSKLPS",17,0)
 ..S ORDT=9999999-ORINVDT
"RTN","ORTSKLPS",18,0)
 ..S ORN=0 F  S ORN=$O(^OR(100,"AS",ORVP,ORINVDT,ORN)) Q:'ORN  D
"RTN","ORTSKLPS",19,0)
 ...;don't lapse if order does not have a status of unreleased (11)
"RTN","ORTSKLPS",20,0)
 ...Q:$P($G(^OR(100,ORN,3)),U,3)'=11
"RTN","ORTSKLPS",21,0)
 ...;get order action
"RTN","ORTSKLPS",22,0)
 ...S ORACT=$O(^OR(100,"AS",ORVP,ORINVDT,ORN,""))
"RTN","ORTSKLPS",23,0)
 ...;get order dialog
"RTN","ORTSKLPS",24,0)
 ...S ORDIAL=$P($G(^OR(100,ORN,0)),U,5)
"RTN","ORTSKLPS",25,0)
 ...I $P(ORDIAL,";",2)='"ORD(101.41," Q
"RTN","ORTSKLPS",26,0)
 ...;using order dialog get display group
"RTN","ORTSKLPS",27,0)
 ...S ORDISP=$P($G(^ORD(101.41,+ORDIAL,0)),U,5)
"RTN","ORTSKLPS",28,0)
 ...I +ORDISP S ORDISP=$P($G(^ORD(100.98,+ORDISP,0)),U)
"RTN","ORTSKLPS",29,0)
 ...;get lapse parameter for display group
"RTN","ORTSKLPS",30,0)
 ...I $L(ORDISP) S ORPARAM=$$GET^XPAR($$ENT(ORN),"OR LAPSE ORDERS",ORDISP)
"RTN","ORTSKLPS",31,0)
 ...;get default lapse parameter if one for display group not set
"RTN","ORTSKLPS",32,0)
 ...I '$G(ORPARAM) S ORPARAM=$$GET^XPAR($$ENT(ORN),"OR LAPSE ORDERS DFLT")
"RTN","ORTSKLPS",33,0)
 ...;quit if ORPARAM isn't even set
"RTN","ORTSKLPS",34,0)
 ...Q:'$L(ORPARAM)
"RTN","ORTSKLPS",35,0)
 ...;quit if order is not older than T-(days for lapse)
"RTN","ORTSKLPS",36,0)
 ...I $$FMDIFF^XLFDT($$NOW^XLFDT,ORDT,2)<(ORPARAM*24*60*60) Q
"RTN","ORTSKLPS",37,0)
 ...;if old then lapse
"RTN","ORTSKLPS",38,0)
 ...D LAPSE^ORCSAVE2(ORN_";"_ORACT)
"RTN","ORTSKLPS",39,0)
 ...S ORDATA=$S($G(ORDATA)'="":ORDATA_U,1:"")_ORN
"RTN","ORTSKLPS",40,0)
 ...;Since one alert covers many orders (not passing order number to EN^ORB3), collect the orderer
"RTN","ORTSKLPS",41,0)
 ...S ORDERERS($$ORDERER^ORQOR2(ORN))=""
"RTN","ORTSKLPS",42,0)
 .;send notification, one per patient
"RTN","ORTSKLPS",43,0)
 .D:$D(ORDATA) EN^ORB3(78,+ORVP,"",.ORDERERS,"Lapsed Unsigned Order(s)","NEW;"_ORDATA)
"RTN","ORTSKLPS",44,0)
 ;loop through pending events
"RTN","ORTSKLPS",45,0)
 N ORPT,OREVT,ORPTR,Y
"RTN","ORTSKLPS",46,0)
 S ORPT="" F  S ORPT=$O(^ORE(100.2,"AE",ORPT)) Q:'ORPT  D
"RTN","ORTSKLPS",47,0)
 .S OREVT="" F  S OREVT=$O(^ORE(100.2,"AE",ORPT,OREVT)) Q:'OREVT  D
"RTN","ORTSKLPS",48,0)
 ..S ORPTR="" F  S ORPTR=$O(^ORE(100.2,"AE",ORPT,OREVT,ORPTR)) Q:'ORPTR  S Y=$$LAPSED^OREVNTX(ORPTR)
"RTN","ORTSKLPS",49,0)
 Q
"RTN","ORTSKLPS",50,0)
ENT(ORN) ;get the proper entity for an order
"RTN","ORTSKLPS",51,0)
 N ORRET,ORHS,ORDIV
"RTN","ORTSKLPS",52,0)
 S ORRET="ALL"
"RTN","ORTSKLPS",53,0)
 S ORHS=$P(^OR(100,ORN,0),U,10)
"RTN","ORTSKLPS",54,0)
 I $G(ORHS)>0 S ORDIV=$P(^SC(+ORHS,0),U,4)
"RTN","ORTSKLPS",55,0)
 I $G(ORDIV)>0 S ORRET=ORDIV_";DIC(4,^SYS^PKG"
"RTN","ORTSKLPS",56,0)
 Q ORRET
"RTN","ORUTL")
0^47^B85894949
"RTN","ORUTL",1,0)
ORUTL ;SLC/DCM,RWF - ORDER UTILITIES ;09/05/2014  14:36
"RTN","ORUTL",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**95,280,218,350**;Dec 17, 1997;Build 77
"RTN","ORUTL",3,0)
ISCLORD(ORY,ORIFN) ;;RPC to test if an order is a clinic order
"RTN","ORUTL",4,0)
 S ORIFN=+ORIFN
"RTN","ORUTL",5,0)
 S ORY=0
"RTN","ORUTL",6,0)
 I 'ORIFN Q
"RTN","ORUTL",7,0)
 N ORZ0 S ORZ0=$G(^OR(100,ORIFN,0))
"RTN","ORUTL",8,0)
 N ORTO S ORTO=$P(ORZ0,U,11)
"RTN","ORUTL",9,0)
 I ORTO=$$CLINMDDG S ORY=1
"RTN","ORUTL",10,0)
 I ORTO=$$CLINIVDG S ORY=1
"RTN","ORUTL",11,0)
 Q
"RTN","ORUTL",12,0)
CLINMDDG() ;RETURN THE IEN OF THE CLINIC MEDICATIONS DISPLAY GROUP
"RTN","ORUTL",13,0)
 Q $O(^ORD(100.98,"B","CLINIC MEDICATIONS",0))
"RTN","ORUTL",14,0)
CLINIVDG() ;RETURN THE IEN OF THE CLINIC INFUSIONS DISPLAY GROUP
"RTN","ORUTL",15,0)
 Q $O(^ORD(100.98,"B","CLINIC INFUSIONS",0))
"RTN","ORUTL",16,0)
LOC ;;GET PT. LOCATION
"RTN","ORUTL",17,0)
 S C(1)=$S($D(ORL(2))#2:$S(ORL(2)[";":$S($D(@("^"_$P(ORL(2),";",2)_+ORL(2)_",0)")):$P(^(0),"^"),1:""),1:""),1:"")
"RTN","ORUTL",18,0)
 I 'OR4,ORVP[";DPT(",$D(ORL(2)),ORL(2) Q
"RTN","ORUTL",19,0)
 G:$L(C(1)) LOC1 S (CT,C)=0,O=1 I ORVP[";DPT(",$O(^DPT(+ORVP,"DE",0))>0 W !!,"Currently enrolled in the following clinics: ",!
"RTN","ORUTL",20,0)
 I  S I=0 F L=0:0 S I=$O(^DPT(+ORVP,"DE",I)) Q:I'>0  I $D(^(I,0)) S Y=^(0) I $P(Y,"^",2)'="I",'$P(Y,"^",3) I $D(^SC(+Y,0)) S X=^(0) D
"RTN","ORUTL",21,0)
 . I $D(^SC(+Y,"I")) S ORIA=+^("I"),ORRA=$P(^("I"),"^",2) I $S('ORIA:0,ORIA>DT:0,ORRA'>DT&(ORRA):0,1:1) Q
"RTN","ORUTL",22,0)
 . S CT=CT+1 W:(CT#2) !?17 W:'(CT#2) ?47 W $P(X,"^") S C=C+1,C(1)=$P(X,"^") S:C'=1 C=-1
"RTN","ORUTL",23,0)
 W !
"RTN","ORUTL",24,0)
LOC1 S C=1 W !,"Patient Location: " W:C=1&($L(C(1))) C(1),"//" R X:DTIME G QUIT:'$T,QUIT:C'=1&(X=""),LOC:$L(X)>20!(X'?.ANP),QUIT:X[U
"RTN","ORUTL",25,0)
 S DIC("S")="I ""FI""'[$P(^(0),""^"",3),'$P($G(^(""OOS"")),""^"")",DIC=44,DIC(0)=$S(C=1&($L(C(1)))&(X=""):"EMQOZX",1:"EMQZ")
"RTN","ORUTL",26,0)
 S:X="" X=C(1) D ^DIC G LOC:X["?" S:Y>0 ORL=+Y_";SC(",ORL(0)=$S($L($P(Y(0),"^",2)):$P(Y(0),"^",2),1:$E($P(Y(0),"^"),1,4))
"RTN","ORUTL",27,0)
 K ORIA,ORRA I $D(^SC(+Y,"I")) S ORIA=+^("I"),ORRA=$P(^("I"),U,2)
"RTN","ORUTL",28,0)
 I $S('$D(ORIA):0,'ORIA:0,ORIA>DT:0,ORRA'>DT&(ORRA):0,1:1) W $C(7)," This location has been inactivated." K ORL G LOC
"RTN","ORUTL",29,0)
 I Y<0 W "  You must select a standard location." G LOC
"RTN","ORUTL",30,0)
 K DIC,C,ORIA,ORRA Q
"RTN","ORUTL",31,0)
QUIT S OREND=1 K DIC,C Q
"RTN","ORUTL",32,0)
READ ;;Hold screen
"RTN","ORUTL",33,0)
 I $D(IOST) Q:$E(IOST)'="C"
"RTN","ORUTL",34,0)
 W ! I $D(IOSL),$Y<(IOSL-4) G READ
"RTN","ORUTL",35,0)
 W !?5,"Press return to continue  " R X:$S($D(DTIME):DTIME,1:300)
"RTN","ORUTL",36,0)
 Q
"RTN","ORUTL",37,0)
CHKNAM(X,Y) ;Input transform to not allow certain characters
"RTN","ORUTL",38,0)
 ;X is the text to be checked, Y are the characters not allowed as sent in by the input transform of the field
"RTN","ORUTL",39,0)
 N I,J I '$D(Y) S Y="-;,=^" ;if no special characters sent in, set list to all
"RTN","ORUTL",40,0)
 F I=1:1:$L(Y) I X[($E(Y,I)) S J=1
"RTN","ORUTL",41,0)
 Q +$G(J)
"RTN","ORUTL",42,0)
CHKMNE(X) ;Input transform to not allow use of standard Lmgr Mnemonics
"RTN","ORUTL",43,0)
 N Y
"RTN","ORUTL",44,0)
 S Y=$$UP^XLFSTR(X) ;check to make sure mnemonic isn't set to lower case of restricted entries.  List Manager is case insensitive
"RTN","ORUTL",45,0)
 I Y="ADPL"!(Y="DN")!(Y="Q")!(Y="FS")!(Y="GO")!(Y="?")!(Y="??")!(Y="LS")!(Y="+")!(Y="-")!(Y="PL")!(Y="PS")!(Y="RD")!(Y="SL")!(Y="<")!(Y=">")!(Y="UP")!(Y="PI")!(Y="CWAD")!(Y="TD")!(Y="EX") Q 1
"RTN","ORUTL",46,0)
 Q 0
"RTN","ORUTL",47,0)
PAD(ORX,ORL) ; Pads string to specified length
"RTN","ORUTL",48,0)
 N ORY
"RTN","ORUTL",49,0)
 S ORY="",$P(ORY," ",(ORL-$L(ORX))+1)=""
"RTN","ORUTL",50,0)
 Q ORY
"RTN","ORUTL",51,0)
MAIL(XMTEXT,XMSUB,XMY,SUBSCR) ;SEND AN EMAIL
"RTN","ORUTL",52,0)
 ;PARAMETERS: XMTEXT => STRING CONTAINING NAME OF ARRAY CONTAINING MESSAGE TEXT (REQUIRED)
"RTN","ORUTL",53,0)
 ;            XMSUB  => STRING CONTAINING THE SUBJECT OF THE MESSAGE (REQUIRED)
"RTN","ORUTL",54,0)
 ;            XMY    => REFERENCE TO AN ARRAY CONTAINING THE RECIPIENTS (OPTIONAL)
"RTN","ORUTL",55,0)
 ;            SUBSCR => STRING CONTAINING THE SUBSCIPT WITHIN ^XTMP WHERE RECIPIENTS ARE STORED (OPTIONAL)
"RTN","ORUTL",56,0)
 ;RETURN: $$MAIL => STRING CONTAINING XMMG (ERROR STRING)^XMERR (NUMBER OF ERRORS)
"RTN","ORUTL",57,0)
 N XMMG,XMDUZ,XMZ,XMERR,DIFROM,ORMSG
"RTN","ORUTL",58,0)
 Q:'$D(XMTEXT)!($G(XMSUB)="")
"RTN","ORUTL",59,0)
 I $D(XMY)=0 D
"RTN","ORUTL",60,0)
 .I $G(SUBSCR)'="",($Q(^XTMP(SUBSCR,0))[SUBSCR) D  Q
"RTN","ORUTL",61,0)
 ..K ^XTMP(SUBSCR,0)
"RTN","ORUTL",62,0)
 ..M XMY=^XTMP(SUBSCR)
"RTN","ORUTL",63,0)
 ..K ^XTMP(SUBSCR)
"RTN","ORUTL",64,0)
 .I $D(ZTQUEUED)>0 D
"RTN","ORUTL",65,0)
 ..S XMY(DUZ)=""
"RTN","ORUTL",66,0)
 .E  D
"RTN","ORUTL",67,0)
 ..S ORMSG(1)=" "
"RTN","ORUTL",68,0)
 ..S ORMSG(2)="Select the recipient(s) of the report below."
"RTN","ORUTL",69,0)
 ..D MAILOUT(.ORMSG)
"RTN","ORUTL",70,0)
 N DUZ ;FORCE SENDER TO BE POSTMASTER
"RTN","ORUTL",71,0)
 D ^XMD ;ICR #10070
"RTN","ORUTL",72,0)
 K ORMSG
"RTN","ORUTL",73,0)
 I $D(XMMG)>0 D
"RTN","ORUTL",74,0)
 .S ORMSG(1)=" "
"RTN","ORUTL",75,0)
 .S ORMSG(2)="Unable to email the report:"
"RTN","ORUTL",76,0)
 .S ORMSG(3)=XMMG
"RTN","ORUTL",77,0)
 .D MAILOUT(.ORMSG)
"RTN","ORUTL",78,0)
 Q $G(XMMG)_U_$G(XMERR)
"RTN","ORUTL",79,0)
MAILOUT(MESSAGE) ;OUTPUT THE ORMSG ARRAY FROM MAIL LINE TAG
"RTN","ORUTL",80,0)
 ;IF KIDS IS NOT EXECUTING, OUTPUT THE MESSAGE TO THE SCREEN
"RTN","ORUTL",81,0)
 I $G(XPDNM)="" D
"RTN","ORUTL",82,0)
 .N LINE S LINE=0 F  S LINE=$O(MESSAGE(LINE)) Q:+$G(LINE)=0  W MESSAGE(LINE),!
"RTN","ORUTL",83,0)
 E  D MES^XPDUTL(.MESSAGE)
"RTN","ORUTL",84,0)
 Q
"RTN","ORUTL",85,0)
WRAP(ORLINE,OROUTPUT,ORDINDEN,ORTRIM,OROI) ;WRAP THE TEXT SO THAT IT IS NO MORE THAN IOM (80 OR 132) CHARACTERS WIDE
"RTN","ORUTL",86,0)
 ;PARAMETERS: ORLINE  =>SINGLE LINE OF TEXT TO WRAP
"RTN","ORUTL",87,0)
 ;            OROUTPUT=>NAME OF ARRAY THAT WILL STORE THE WRAPPED TEXT IN THE FORMAT:
"RTN","ORUTL",88,0)
 ;                      OROUTPUT=NUMBER OF LINES OF TEXT RETURNED
"RTN","ORUTL",89,0)
 ;                      OROUTPUT(N)=LINE N OF TEXT
"RTN","ORUTL",90,0)
 ;            ORDINDEN=>FOR RETURNED TEXT, DETERMINE WHETHER TO INDENT LINES 2 THROUGH LAST (1) OR NOT (0)
"RTN","ORUTL",91,0)
 ;                      DEFAULT: 1
"RTN","ORUTL",92,0)
 ;            ORTRIM  =>FOR RETURNED TEXT, STRIP TRAILING SPACES ON EACH LINE (1) OR NOT (0)
"RTN","ORUTL",93,0)
 ;                      DEFAULT: 1
"RTN","ORUTL",94,0)
 ;            OROI    =>FOR RETURNED TEXT, THE COLUMN NUMBER TO INDENT LINES 2 THROUGH LAST 2
"RTN","ORUTL",95,0)
 ;                      DEFAULT: CALCULATE COLUMN TO INDENT TO
"RTN","ORUTL",96,0)
 N ORRETURN,ORTEMP,ORINDENT,ORIOM
"RTN","ORUTL",97,0)
 S ORIOM=$G(IOM),ORDINDEN=+$G(ORDINDEN,1),ORTRIM=+$G(ORTRIM,1),OROI=+$G(OROI)
"RTN","ORUTL",98,0)
 S:'+ORIOM ORIOM=80
"RTN","ORUTL",99,0)
 I ORDINDEN,'OROI D
"RTN","ORUTL",100,0)
 .N ORCHR
"RTN","ORUTL",101,0)
 .I ORLINE[":",($L($P(ORLINE,":"))<ORIOM) S ORINDENT=$$REPEAT^XLFSTR(" ",$L($P(ORLINE,":"))+2)
"RTN","ORUTL",102,0)
 .I ORLINE'[":",($E(ORLINE,1)=" ") D
"RTN","ORUTL",103,0)
 ..F ORCHR=1:1:$L(ORLINE) Q:$E(ORLINE,ORCHR)'=" "
"RTN","ORUTL",104,0)
 ..S ORINDENT=$$REPEAT^XLFSTR(" ",ORCHR-1)
"RTN","ORUTL",105,0)
 .I ORLINE'[":",($E(ORLINE,1)'=" ") D
"RTN","ORUTL",106,0)
 ..N START,END
"RTN","ORUTL",107,0)
 ..F ORCHR=1:1:$L(ORLINE) Q:+$G(END)  D
"RTN","ORUTL",108,0)
 ...I '+$G(START),($E(ORLINE,ORCHR)=" "),($E(ORLINE,ORCHR+1)=" ") S START=1
"RTN","ORUTL",109,0)
 ...I +$G(START),($E(ORLINE,ORCHR)'=" ") S END=1
"RTN","ORUTL",110,0)
 ..S:+$G(START)>0 ORINDENT=$$REPEAT^XLFSTR(" ",ORCHR-2)
"RTN","ORUTL",111,0)
 I ORDINDEN,OROI>0 S ORINDENT=$$REPEAT^XLFSTR(" ",OROI)
"RTN","ORUTL",112,0)
 S ORTEMP=1,ORTEMP(ORTEMP)=ORLINE
"RTN","ORUTL",113,0)
 F  Q:$L(ORTEMP(ORTEMP))<(ORIOM+1)  D
"RTN","ORUTL",114,0)
 .N ORTEMP1,ORCHR
"RTN","ORUTL",115,0)
 .F ORCHR=ORIOM:-1:1 Q:$E(ORTEMP(ORTEMP),ORCHR)=" "
"RTN","ORUTL",116,0)
 .S:ORCHR=1 ORCHR=ORIOM
"RTN","ORUTL",117,0)
 .S ORTEMP1=ORTEMP(ORTEMP)
"RTN","ORUTL",118,0)
 .S ORTEMP(ORTEMP)=$E(ORTEMP1,1,ORCHR)
"RTN","ORUTL",119,0)
 .S:ORTRIM ORTEMP(ORTEMP)=$$TRIM^XLFSTR(ORTEMP(ORTEMP),"R")
"RTN","ORUTL",120,0)
 .S ORTEMP=ORTEMP+1
"RTN","ORUTL",121,0)
 .S ORTEMP(ORTEMP)=$G(ORINDENT)_$E(ORTEMP1,ORCHR+1,*)
"RTN","ORUTL",122,0)
 S ORTEMP=0 F  S ORTEMP=$O(ORTEMP(ORTEMP)) Q:+ORTEMP=0  D
"RTN","ORUTL",123,0)
 .S @OROUTPUT=1+$G(@OROUTPUT)
"RTN","ORUTL",124,0)
 .S @OROUTPUT@(@OROUTPUT)=ORTEMP(ORTEMP)
"RTN","ORUTL",125,0)
 Q
"RTN","ORUTL",126,0)
DEVICE(ZTRTN,ZTDESC,%ZIS,ZTSAVE) ;PROMPT THE USER FOR THE OUTPUT DEVICE
"RTN","ORUTL",127,0)
 ;PARAMETERS: ZTRTN  => LINE TAG THAT STARTS PRINTING THE REPORT
"RTN","ORUTL",128,0)
 ;            ZTDESC => TASKMAN TASK DESCRIPTION
"RTN","ORUTL",129,0)
 ;            %ZIS   => FLAGS TO PASS TO ^%ZIS
"RTN","ORUTL",130,0)
 ;            ZTSAVE => VARIABLES TO SAVE FOR TASKMAN
"RTN","ORUTL",131,0)
 N POP,CBUFFER
"RTN","ORUTL",132,0)
 S %ZIS("B")="",CBUFFER=0
"RTN","ORUTL",133,0)
 D ^%ZIS
"RTN","ORUTL",134,0)
 Q:+$G(POP)
"RTN","ORUTL",135,0)
 I $D(IO("Q")) D  Q
"RTN","ORUTL",136,0)
 .N ZTSK,ORTEXT
"RTN","ORUTL",137,0)
 .S ORTEXT=$P(ZTDESC,"OR ",2)
"RTN","ORUTL",138,0)
 .S ZTSAVE("CBUFFER")=""
"RTN","ORUTL",139,0)
 .D ^%ZTLOAD,HOME^%ZIS
"RTN","ORUTL",140,0)
 .K IO("Q")
"RTN","ORUTL",141,0)
 .I +$G(ZTSK)>0 W !,"Successfully queued the "_ORTEXT_" report.",!,"Task Number: "_ZTSK,! H 2
"RTN","ORUTL",142,0)
 I '$D(IO("Q")) D
"RTN","ORUTL",143,0)
 .U IO
"RTN","ORUTL",144,0)
 .I $E(IOST,1,2)="C-" W @IOF S CBUFFER=3
"RTN","ORUTL",145,0)
 .D @ZTRTN,^%ZISC
"RTN","ORUTL",146,0)
 Q
"RTN","ORUTL",147,0)
HEADER(TITLE,PAGE,HEADER,NEWRPT) ;OUTPUT THE REPORT'S HEADER
"RTN","ORUTL",148,0)
 ;PARAMETERS: TITLE  => THE TITLE OF THE REPORT
"RTN","ORUTL",149,0)
 ;            PAGE   => (REFERENCE) PAGE NUMBER
"RTN","ORUTL",150,0)
 ;            HEADER => (REFERENCE) COLUMN NAMES, FORMATTED AS:
"RTN","ORUTL",151,0)
 ;                      COLUMN(LINE_NUMBER)=TEXT
"RTN","ORUTL",152,0)
 ;                      NOTE: LINE_NUMBER STARTS AT ONE
"RTN","ORUTL",153,0)
 ;            NEWRPT => (OPTIONAL) ALLOWS PRINTING OF MULTIPLE REPORTS
"RTN","ORUTL",154,0)
 ;                      ONE AFTER THE OTHER
"RTN","ORUTL",155,0)
 ;                      UNDEFINED: NOT PRINTING MULTIPLE REPORTS
"RTN","ORUTL",156,0)
 ;                      0 (DEFAULT): THIS IS NOT THE START OF A
"RTN","ORUTL",157,0)
 ;                                   NEW REPORT
"RTN","ORUTL",158,0)
 ;                      1: THIS IS THE START OF A NEW REPORT
"RTN","ORUTL",159,0)
 ;RETURNS: 0 => USER WANTS TO CONTINUE PRINTING
"RTN","ORUTL",160,0)
 ;         1 => USER DOES NOT WANT TO CONTINUE PRINTING
"RTN","ORUTL",161,0)
 Q:$$STOPTASK 1
"RTN","ORUTL",162,0)
 N X,END
"RTN","ORUTL",163,0)
 S PAGE=1+$G(PAGE)
"RTN","ORUTL",164,0)
 I PAGE>1!(+$G(NEWRPT)) D  Q:$G(END) 1
"RTN","ORUTL",165,0)
 .I $E(IOST,1,2)="C-" W !,"Press RETURN to continue or '^' to exit: " R X:DTIME S END='$T!(X=U) Q:$G(END)
"RTN","ORUTL",166,0)
 .I $Y>0,$Y<=IOSL W @IOF
"RTN","ORUTL",167,0)
 .I $Y>IOSL S $Y=0
"RTN","ORUTL",168,0)
 I PAGE=1,($E(IOST,1,2)="C-"),('+$G(NEWRPT)) W @IOF
"RTN","ORUTL",169,0)
 N NOW,INDEX
"RTN","ORUTL",170,0)
 S NOW=$$UP^XLFSTR($$HTE^XLFDT($H)),NOW=$P(NOW,"@",1)_"  "_$P($P(NOW,"@",2),":",1,2)
"RTN","ORUTL",171,0)
 W $$LJ^XLFSTR($E(TITLE,1,46),47," ")_NOW_"   PAGE "_PAGE,!
"RTN","ORUTL",172,0)
 S INDEX=0 F  S INDEX=$O(HEADER(INDEX)) Q:'INDEX  W HEADER(INDEX),!
"RTN","ORUTL",173,0)
 W $$REPEAT^XLFSTR("-",(IOM-1)),!
"RTN","ORUTL",174,0)
 Q 0
"RTN","ORUTL",175,0)
STOPTASK() ;DETERMINE IF TASKMAN HAS ASKED PROCESS TO STOP
"RTN","ORUTL",176,0)
 ;RETURNS: 0 => TASKMAN HAS NOT ASKED TASK TO STOP
"RTN","ORUTL",177,0)
 ;         1 => TASKMAN HAS ASKED TASK TO STOP
"RTN","ORUTL",178,0)
 I $D(ZTQUEUED),($$S^%ZTLOAD) D  Q:$G(ZTSTOP)=1 1
"RTN","ORUTL",179,0)
 .S ZTSTOP=$$S^%ZTLOAD("Received stop request"),ZTSTOP=1
"RTN","ORUTL",180,0)
 Q 0
"RTN","ORUTL",181,0)
FMERROR(ERROR) ;OUTPUT FILEMAN ERROR
"RTN","ORUTL",182,0)
 ;PARAMETERS: ERROR => (REFERENCE) ARRAY CONTAINING THE FILEMAN ERROR
"RTN","ORUTL",183,0)
 N OUT
"RTN","ORUTL",184,0)
 W !!,"Unable to generate the report due to the following FileMan error:",!
"RTN","ORUTL",185,0)
 W "FILEMAN ERROR #"_ERROR("DIERR",1)_":",!
"RTN","ORUTL",186,0)
 N IDX S IDX="" F  S IDX=$O(ERROR("DIERR",1,"TEXT",IDX)) Q:'IDX  D WRAP(ERROR("DIERR",1,"TEXT",IDX),"OUT")
"RTN","ORUTL",187,0)
 S IDX=0 F  S IDX=$O(OUT(IDX)) Q:+$G(IDX)=0  W OUT(IDX),!
"RTN","ORUTL",188,0)
 Q
"RTN","ORUTL",189,0)
DIVPRMPT(DIV) ;PROMPT THE USER FOR WHICH ACTIVE DIVISION(S)
"RTN","ORUTL",190,0)
 ;PARAMETERS: DIV => REFERENCE TO ARRAY WHICH WILL CONTAIN THE SELECTED DIVISION(S) WHEN THIS FINISHES
"RTN","ORUTL",191,0)
 ;                   FORMAT: DIV(FILE #4 IEN)=INSTITUTION NAME
"RTN","ORUTL",192,0)
 ;                           IF THE USER SELECTS ALL DIVISIONS, THEN ONLY THE FOLLOWING IS RETURNED:
"RTN","ORUTL",193,0)
 ;                           DIV("ALL")="all divisions"
"RTN","ORUTL",194,0)
 ;RETURNS: -1 USER ENTERED CARET AT PROMPT IF SITE IS MULTIDIVISIONAL
"RTN","ORUTL",195,0)
 ;          0 INSTITUTION FILE POINTER IS MISSING FOR ALL SELECTED DIVISIONS
"RTN","ORUTL",196,0)
 ;          1 SUCCESSFUL SELECTION OF DIVISION(S)
"RTN","ORUTL",197,0)
 N SELDIV,BADDIV,TIUDI,IDX,DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT,COUNT,DELIMIT
"RTN","ORUTL",198,0)
 F  D  Q:+$G(SELDIV)=1!(+$G(SELDIV)=-1)
"RTN","ORUTL",199,0)
 .D SELDIV^TIULA
"RTN","ORUTL",200,0)
 .S IDX=0 F  S IDX=$O(TIUDI(IDX)) Q:+$G(IDX)=0  D
"RTN","ORUTL",201,0)
 ..S DIV(TIUDI(IDX))=$P($$SITE^VASITE(,IDX),U,2),COUNT=1+$G(COUNT)
"RTN","ORUTL",202,0)
 .I SELDIV=1,('$D(DIV)) S DIV("ALL")="all divisions"
"RTN","ORUTL",203,0)
 .I $D(BADDIV) D
"RTN","ORUTL",204,0)
 ..N TEXT,OUTPUT
"RTN","ORUTL",205,0)
 ..S DELIMIT=", "
"RTN","ORUTL",206,0)
 ..F IDX=1:1:$L(BADDIV,",")  D
"RTN","ORUTL",207,0)
 ...S:IDX=$L(BADDIV,",") DELIMIT=" and "
"RTN","ORUTL",208,0)
 ...S TEXT=$S($G(TEXT)'="":TEXT_DELIMIT,1:"")_$P(BADDIV,",",IDX)
"RTN","ORUTL",209,0)
 ..S BADDIV="I'm sorry, but "_TEXT_" "_$S($L(BADDIV,",")=1:"is not a valid division.",$L(BADDIV,",")>1:"are not valid divisions.",1:"you selected an invalid division.")
"RTN","ORUTL",210,0)
 ..D WRAP^ORUTL(BADDIV,"OUTPUT")
"RTN","ORUTL",211,0)
 ..W !!
"RTN","ORUTL",212,0)
 ..F IDX=1:1:OUTPUT W OUTPUT(IDX),!
"RTN","ORUTL",213,0)
 ..I $D(DIV) D
"RTN","ORUTL",214,0)
 ...S DIR(0)="Y"_U,DIR("A")="Do you want to continue with the valid division"_$S(COUNT>1:"s",1:"")_" already selected"
"RTN","ORUTL",215,0)
 ...S DIR("B")="YES"
"RTN","ORUTL",216,0)
 ...D ^DIR
"RTN","ORUTL",217,0)
 ...Q:$D(DIRUT)
"RTN","ORUTL",218,0)
 ...S:Y SELDIV=1
"RTN","ORUTL",219,0)
 Q SELDIV
"RTN","ORUTL",220,0)
HASDIV(Y,DIV,RET) ;DETERMINE IF THE SPECIFIED USER BELONGS TO A SET OF DIVISIONS RETURNED BY DIVPRMPT^ORUTL
"RTN","ORUTL",221,0)
 ;PARAMETERS: Y => IEN IN THE NEW PERSON FILE (#200)
"RTN","ORUTL",222,0)
 ;            DIV => REFERENCE TO ARRAY CONTAINING SELECTED DIVISIONS
"RTN","ORUTL",223,0)
 ;                   FORMAT: DIV(FILE_#4_IEN)=INSTITUTION NAME
"RTN","ORUTL",224,0)
 ;                           DIV("FOUND",FILE_#4_IEN)=INSTITUTION NAME <-- FOR DISCOVERED DIVISIONS
"RTN","ORUTL",225,0)
 ;            RET => 1 TO RETURN DISCOVERED DIVISIONS IN DIV ARRAY, WHEN "ALL DIVISIONS" ARE SELECTED
"RTN","ORUTL",226,0)
 ;                   0 TO NOT RETURN DISCOVERED DIVISIONS (DEFAULT)
"RTN","ORUTL",227,0)
 ;RETURNS: NAME OF Y'S DIVISION
"RTN","ORUTL",228,0)
 ;         EMPTY STRING IF Y'S DIVISION IS NOT A SELECTED DIVISION
"RTN","ORUTL",229,0)
 N DIVISION S DIVISION=""
"RTN","ORUTL",230,0)
 S RET=+$G(RET)
"RTN","ORUTL",231,0)
 I $D(DIV) D
"RTN","ORUTL",232,0)
 .N DIVISIONS,IDX,HASDIV
"RTN","ORUTL",233,0)
 .;IA #2533
"RTN","ORUTL",234,0)
 .S HASDIV=$$DIV4^XUSER(.DIVISIONS,Y)
"RTN","ORUTL",235,0)
 .I HASDIV=0 D
"RTN","ORUTL",236,0)
 ..N IEN
"RTN","ORUTL",237,0)
 ..S IEN=$P($$SITE^VASITE(),U)
"RTN","ORUTL",238,0)
 ..S:+IEN=0 IEN=DUZ(2)
"RTN","ORUTL",239,0)
 ..S DIVISIONS(IEN)=1
"RTN","ORUTL",240,0)
 .I $G(DIV("ALL"))="all divisions" D  Q
"RTN","ORUTL",241,0)
 ..N IEN
"RTN","ORUTL",242,0)
 ..S IEN=0 F  S IEN=$O(DIVISIONS(IEN)) Q:'+IEN  D
"RTN","ORUTL",243,0)
 ...I DIVISIONS(IEN) D
"RTN","ORUTL",244,0)
 ....S DIVISION=$$GET1^DIQ(4,IEN_",",.01)
"RTN","ORUTL",245,0)
 ....S:RET DIV("FOUND",IEN)=DIVISION
"RTN","ORUTL",246,0)
 ..I DIVISION="" D
"RTN","ORUTL",247,0)
 ...S IEN=$O(DIVISIONS(0)),DIVISION=$$GET1^DIQ(4,IEN_",",.01)
"RTN","ORUTL",248,0)
 ...S:RET DIV("FOUND",IEN)=DIVISION
"RTN","ORUTL",249,0)
 .S IDX=0 F  S IDX=$O(DIVISIONS(IDX)) Q:+$G(IDX)=0  D
"RTN","ORUTL",250,0)
 ..I $D(DIV(IDX)) D
"RTN","ORUTL",251,0)
 ...I DIVISION'="",(DIVISIONS(IDX)=1) S DIVISION=DIV(IDX)
"RTN","ORUTL",252,0)
 ...I DIVISION="" S DIVISION=DIV(IDX)
"RTN","ORUTL",253,0)
 Q DIVISION
"RTN","ORUTL",254,0)
LHASDIV(LOC,DIV,RET) ;DETERMINE IF THE SPECIFIED LOCATION BELONGS TO A SET OF DIVISIONS RETURNED BY DIVPRMPT^ORUTL
"RTN","ORUTL",255,0)
 ;PARAMETERS: LOC => VARIABLE POINTER TO HOSPITAL LOCATION FILE (#44)
"RTN","ORUTL",256,0)
 ;            DIV => REFERENCE TO ARRAY CONTAINING SELECTED DIVISIONS
"RTN","ORUTL",257,0)
 ;                   FORMAT: DIV(FILE_#4_IEN)=INSTITUTION NAME
"RTN","ORUTL",258,0)
 ;                           DIV("FOUND",FILE_#4_IEN)=INSTITUTION NAME <-- FOR DISCOVERED DIVISIONS
"RTN","ORUTL",259,0)
 ;            RET => 1 TO RETURN DISCOVERED DIVISIONS IN DIV ARRAY, WHEN "ALL DIVISIONS" ARE SELECTED
"RTN","ORUTL",260,0)
 ;                   0 TO NOT RETURN DISCOVERED DIVISIONS (DEFAULT)
"RTN","ORUTL",261,0)
 ;RETURNS: NAME OF LOC'S DIVISION
"RTN","ORUTL",262,0)
 ;         EMPTY STRING IF LOC'S DIVISION IS NOT A SELECTED DIVISION
"RTN","ORUTL",263,0)
 N DIVISION,LOCDIV
"RTN","ORUTL",264,0)
 S DIVISION="",LOCDIV=0,LOC=$G(LOC),RET=+$G(RET)
"RTN","ORUTL",265,0)
 I $D(DIV) D
"RTN","ORUTL",266,0)
 .I LOC>0 D
"RTN","ORUTL",267,0)
 ..N GLOREF,HLIEN
"RTN","ORUTL",268,0)
 ..S GLOREF=U_$$UP^XLFSTR($P(LOC,";",2))_+LOC_",0)"
"RTN","ORUTL",269,0)
 ..I GLOREF'?1"^SC("1.N1",0)" Q
"RTN","ORUTL",270,0)
 ..;IA #10040
"RTN","ORUTL",271,0)
 ..S LOCDIV=$P($G(@GLOREF),U,15)
"RTN","ORUTL",272,0)
 ..I +LOCDIV D
"RTN","ORUTL",273,0)
 ...N ORFND
"RTN","ORUTL",274,0)
 ...;IA #2817
"RTN","ORUTL",275,0)
 ...S ORFND=0,HLIEN=0 F  S HLIEN=$O(^DG(40.8,"AD",HLIEN)) Q:HLIEN=""  D
"RTN","ORUTL",276,0)
 ....I $D(^DG(40.8,"AD",HLIEN,LOCDIV)) D
"RTN","ORUTL",277,0)
 .....S ORFND=1
"RTN","ORUTL",278,0)
 .....I '$D(DIV("ALL")),$D(DIV(HLIEN)) S DIVISION=DIV(HLIEN)
"RTN","ORUTL",279,0)
 .....I $D(DIV("ALL")) D
"RTN","ORUTL",280,0)
 ......S DIVISION=$$GET1^DIQ(4,HLIEN_",",.01)
"RTN","ORUTL",281,0)
 ......S:RET DIV("FOUND",HLIEN)=DIVISION
"RTN","ORUTL",282,0)
 ...I DIVISION="",'ORFND S LOCDIV=0
"RTN","ORUTL",283,0)
 .I 'LOC!('LOCDIV) D
"RTN","ORUTL",284,0)
 ..N IEN
"RTN","ORUTL",285,0)
 ..S IEN=+$P($$SITE^VASITE(),U)
"RTN","ORUTL",286,0)
 ..S:'IEN IEN=+DUZ(2)
"RTN","ORUTL",287,0)
 ..Q:'IEN
"RTN","ORUTL",288,0)
 ..I $G(DIV("ALL"))="all divisions" D
"RTN","ORUTL",289,0)
 ...S DIVISION=$$GET1^DIQ(4,IEN_",",.01)
"RTN","ORUTL",290,0)
 ...S:RET DIV("FOUND",IEN)=DIVISION
"RTN","ORUTL",291,0)
 ..I '$D(DIV("ALL")),($D(DIV(IEN))) S DIVISION=DIV(IEN)
"RTN","ORUTL",292,0)
 Q DIVISION
"RTN","ORUTL4")
0^80^B10368867
"RTN","ORUTL4",1,0)
ORUTL4 ;SLC/CB/TC - OE/RR Utilities ;08/31/15  09:35
"RTN","ORUTL4",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORUTL4",3,0)
 ;
"RTN","ORUTL4",4,0)
 ;
"RTN","ORUTL4",5,0)
 ;
"RTN","ORUTL4",6,0)
DLL(ORRSLTS,ORDLLNME,ORDLLVRS) ; Will check DLL version against the server to see if it's valid
"RTN","ORUTL4",7,0)
 ; Input parameters
"RTN","ORUTL4",8,0)
 ;  1. ORRSLTS    RPC Return array
"RTN","ORUTL4",9,0)
 ;  2. ORDLLNME   Name of Dll to look up
"RTN","ORUTL4",10,0)
 ;  3. ORDLLVRS   Version of the DLL on the user's machine
"RTN","ORUTL4",11,0)
 ;
"RTN","ORUTL4",12,0)
 S ORDLLNME=$$UP^XLFSTR(ORDLLNME)
"RTN","ORUTL4",13,0)
 I ORDLLNME="GMV_VITALSVIEWENTER.DLL" D VITAL(.ORRSLTS,ORDLLVRS)
"RTN","ORUTL4",14,0)
 I ORDLLNME=$$UP^XLFSTR($$GET^XPAR("SYS","YS MHA_A DLL NAME")) D MENTAL(.ORRSLTS,ORDLLVRS,ORDLLNME)
"RTN","ORUTL4",15,0)
 I ORDLLNME="ORDERCOM.DLL" D CPRSMOB(.ORRSLTS,ORDLLVRS)
"RTN","ORUTL4",16,0)
 I ORRSLTS="" S ORRSLTS="-1"
"RTN","ORUTL4",17,0)
 Q
"RTN","ORUTL4",18,0)
 ;
"RTN","ORUTL4",19,0)
VITAL(ORRSLTS,ORDLLVRS) ;
"RTN","ORUTL4",20,0)
 ; Input parameters
"RTN","ORUTL4",21,0)
 ;  1. ORRSLTS    The return message
"RTN","ORUTL4",22,0)
 ;  2. ORDLLVRS   Version of the DLL on the user's machine
"RTN","ORUTL4",23,0)
 ;
"RTN","ORUTL4",24,0)
 N ORVAL S ORRSLTS=""
"RTN","ORUTL4",25,0)
 S ORVAL=$$GET^XPAR("SYS","GMV DLL VERSION",ORDLLVRS,"E")
"RTN","ORUTL4",26,0)
 I ORVAL="YES" S ORRSLTS=1
"RTN","ORUTL4",27,0)
 E  S ORRSLTS="-1^This version of the Vitals Viewer "_ORDLLVRS_" is not compatible with the server software. Please contact IRM to update the GMV_VitalsViewEnter.dll file."
"RTN","ORUTL4",28,0)
 Q
"RTN","ORUTL4",29,0)
 ;
"RTN","ORUTL4",30,0)
MENTAL(ORRSLTS,ORDLLVRS,ORDLLNME) ;
"RTN","ORUTL4",31,0)
 ; Input parameters
"RTN","ORUTL4",32,0)
 ;  1. ORRSLTS    The return message
"RTN","ORUTL4",33,0)
 ;  2. ORDLLVRS   Version of the DLL on the user's machine
"RTN","ORUTL4",34,0)
 ;  3. ORDLLNME   Name of Dll to look up
"RTN","ORUTL4",35,0)
 ;
"RTN","ORUTL4",36,0)
 N ORYSLST,ORYSVAL,ORREQVER S ORRSLTS=""
"RTN","ORUTL4",37,0)
 D FIND^DIC(19,,1,"X","YS BROKER1",1,,,,"ORYSLST")
"RTN","ORUTL4",38,0)
 I 'ORYSLST("DILIST",0) S ORRSLTS="-1^The YS BROKER1 option is not installed on this server. Please contact IRM to get this installed." Q
"RTN","ORUTL4",39,0)
 S ORYSVAL=$G(ORYSLST("DILIST","ID",1,1))
"RTN","ORUTL4",40,0)
 S ORREQVER=$P($P(ORYSVAL,"version ",2),"~",2)
"RTN","ORUTL4",41,0)
 I ORDLLVRS=ORREQVER S ORRSLTS=1
"RTN","ORUTL4",42,0)
 E  S ORRSLTS="-1^This is version "_ORDLLVRS_" of "_ORDLLNME_". "_ORREQVER_" is now the proper version in service. Please contact your local IRM or CPRS expert to obtain the updated version."
"RTN","ORUTL4",43,0)
 Q
"RTN","ORUTL4",44,0)
 ;
"RTN","ORUTL4",45,0)
CPRSMOB(ORRSLTS,ORDLLVRS) ;
"RTN","ORUTL4",46,0)
 ; Input parameters
"RTN","ORUTL4",47,0)
 ;  1. ORRSLTS    The return message
"RTN","ORUTL4",48,0)
 ;  2. ORDLLVRS   Version of the DLL on the user's machine
"RTN","ORUTL4",49,0)
 ;
"RTN","ORUTL4",50,0)
 N ORREQVER S ORRSLTS=""
"RTN","ORUTL4",51,0)
 S ORREQVER=$$GET^XPAR("SYS^PKG","OR MOB DLL VERSION")
"RTN","ORUTL4",52,0)
 I ORDLLVRS=ORREQVER S ORRSLTS="1^"_ORREQVER
"RTN","ORUTL4",53,0)
 E  S ORRSLTS="-1^"_ORREQVER_"^This version of the CPRS MOB "_ORDLLVRS_" is not compatible with the server software. Please contact IRM to update the OrderCom.dll file."
"RTN","ORUTL4",54,0)
 Q
"RTN","ORUTL4",55,0)
 ;
"RTN","ORWCIRN")
0^36^B10494851
"RTN","ORWCIRN",1,0)
ORWCIRN ;SLC/DCM,REV - FUNCTIONS FOR GUI CIRN ACTIONS ;03/17/2015  10:24
"RTN","ORWCIRN",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,101,109,132,141,160,208,239,215,243,350**;Dec 17, 1997;Build 77
"RTN","ORWCIRN",3,0)
 ;
"RTN","ORWCIRN",4,0)
FACLIST(ORY,ORDFN) ; Return list of remote facilities for patient
"RTN","ORWCIRN",5,0)
 ;Check to see if CIRN PD/MPI installed
"RTN","ORWCIRN",6,0)
 N X,ORSITES,I,IFN,LOCAL,CTR,HDRFLG,GOTNHIN
"RTN","ORWCIRN",7,0)
 S X="MPIF001" X ^%ZOSF("TEST")
"RTN","ORWCIRN",8,0)
 I '$T S ORY(0)="-1^CIRN MPI not installed." Q
"RTN","ORWCIRN",9,0)
 S X="VAFCTFU1" X ^%ZOSF("TEST")
"RTN","ORWCIRN",10,0)
 I '$T S ORY(0)="-1^Remote data view not installed." Q
"RTN","ORWCIRN",11,0)
 S X=$$GET^XPAR("ALL","ORWRP CIRN REMOTE DATA ALLOW",1,"I")
"RTN","ORWCIRN",12,0)
 I 'X S ORY(0)="-1^Remote access not allowed" Q
"RTN","ORWCIRN",13,0)
 D TFL^VAFCTFU1(.ORY,ORDFN)
"RTN","ORWCIRN",14,0)
 S (GOTNHIN,I)=0 F  S I=$O(ORY(I)) Q:'I  I $P(ORY(I),"^",5)="OTHER" D  ;Screen out Type 'OTHER' locations
"RTN","ORWCIRN",15,0)
 . I $P(ORY(I),"^")="200HD" Q  ;HDR
"RTN","ORWCIRN",16,0)
 . I $P(ORY(I),"^")="200NDD" Q  ;DoD Correlated Patients
"RTN","ORWCIRN",17,0)
 . I $E($P(ORY(I),"^"),1,4)="200N",'GOTNHIN S GOTNHIN=1,$P(ORY(I),"^",2)="Non-VA DATA AVAILABLE - use VistAWeb to access" Q  ;NwHIN Master Item
"RTN","ORWCIRN",18,0)
 . K ORY(I)
"RTN","ORWCIRN",19,0)
 S HDRFLG=0
"RTN","ORWCIRN",20,0)
 I $$GET^XPAR("ALL","ORWRP CIRN SITES ALL",1,"I") D
"RTN","ORWCIRN",21,0)
 . S (CTR,I)=0
"RTN","ORWCIRN",22,0)
 . F  S I=$O(ORY(I)) Q:'I  S $P(ORY(I),"^",5)=1,CTR=CTR+1 D
"RTN","ORWCIRN",23,0)
 .. I $P(ORY(I),"^")=200 S $P(ORY(I),"^",2)="DEPT. OF DEFENSE"
"RTN","ORWCIRN",24,0)
 .. I $P(ORY(I),"^")="200HD" D
"RTN","ORWCIRN",25,0)
 ... I +$$GET^XPAR("ALL","ORWRP HDR ON",1,"I")=0 K ORY(I) S CTR=CTR-1 Q
"RTN","ORWCIRN",26,0)
 ... S HDRFLG=I ; Remove commented out code to enable HDR + 1 other site. 
"RTN","ORWCIRN",27,0)
 D GETLST^XPAR(.ORSITES,"ALL","ORWRP CIRN SITES","I")
"RTN","ORWCIRN",28,0)
 S (CTR,I)=0,LOCAL=$P($$SITE^VASITE,"^",3)
"RTN","ORWCIRN",29,0)
 F  S I=$O(ORY(I)) Q:'I  D
"RTN","ORWCIRN",30,0)
 . I +ORY(I)=+LOCAL K ORY(I) Q
"RTN","ORWCIRN",31,0)
 . S IFN=$$IEN^XUAF4(ORY(I)),CTR=CTR+1
"RTN","ORWCIRN",32,0)
 . I IFN,$G(ORSITES(IFN)) S $P(ORY(I),"^",5)=1 D
"RTN","ORWCIRN",33,0)
 .. I $P(ORY(I),"^")=200 S $P(ORY(I),"^",2)="DEPT. OF DEFENSE"
"RTN","ORWCIRN",34,0)
 . I IFN,$G(ORSITES(IFN)),$P(ORY(I),"^")="200HD" D
"RTN","ORWCIRN",35,0)
 .. I +$$GET^XPAR("ALL","ORWRP HDR ON",1,"I")=0 K ORY(I) S CTR=CTR-1 Q
"RTN","ORWCIRN",36,0)
 .. S HDRFLG=I ; Remove commented out code to enable HDR + 1 other site. 
"RTN","ORWCIRN",37,0)
 I '$L($O(ORY(""))) S ORY(0)="-1^Only local data exists for this patient"
"RTN","ORWCIRN",38,0)
 I $G(HDRFLG),CTR'>1 K ORY(HDRFLG) S ORY(0)="-1^Only HDR has data for this patient"
"RTN","ORWCIRN",39,0)
 Q
"RTN","ORWCIRN",40,0)
RESTRICT(ORY,PATID) ;Check for sensitive patient
"RTN","ORWCIRN",41,0)
 N DFN,ICN,SITE
"RTN","ORWCIRN",42,0)
 I '$G(PATID) S ORY(1)="-1",ORY(2)="Invalid Patient ID" Q
"RTN","ORWCIRN",43,0)
 S ICN=$P(PATID,";",2)
"RTN","ORWCIRN",44,0)
 I 'ICN S ORY(1)="-1",ORY(2)="Invalid ICN" Q
"RTN","ORWCIRN",45,0)
 S SITE=$$SITE^VASITE,SITE=$P(SITE,"^",2)_";"_$P(SITE,"^",3)
"RTN","ORWCIRN",46,0)
 S DFN=+$$GETDFN^MPIF001(ICN)
"RTN","ORWCIRN",47,0)
 I DFN<0 S ORY(1)="-1",ORY(2)="Patient not found on remote system ("_SITE_")" Q
"RTN","ORWCIRN",48,0)
 D PTSEC^DGSEC4(.ORY,DFN)
"RTN","ORWCIRN",49,0)
 Q
"RTN","ORWCIRN",50,0)
CHKLNK(ORY) ;Check for active HL7 TCP link on local system
"RTN","ORWCIRN",51,0)
 S ORY=$$STAT^HLCSLM
"RTN","ORWCIRN",52,0)
 Q
"RTN","ORWCIRN",53,0)
WEBADDR(ORY,PATID) ;Get VistaWeb Address
"RTN","ORWCIRN",54,0)
 S ORY=$$GET^XPAR("ALL","ORWRP VISTAWEB ADDRESS",1,"I")
"RTN","ORWCIRN",55,0)
 I ORY="" S ORY="https://vistaweb.domain.ext" Q
"RTN","ORWCIRN",56,0)
 I ORY="https://vistaweb.domain.ext" Q
"RTN","ORWCIRN",57,0)
 S ORY=ORY_"?q9gtw0="_$P($$SITE^VASITE,"^",3)_"&xqi4z="_PATID_"&yiicf="_DUZ
"RTN","ORWCIRN",58,0)
 Q
"RTN","ORWCIRN",59,0)
AUTORDV(ORY) ;Get parameter value for ORWRP CIRN AUTOMATIC
"RTN","ORWCIRN",60,0)
 S ORY=+$$GET^XPAR("ALL","ORWRP CIRN AUTOMATIC",1,"I")
"RTN","ORWCIRN",61,0)
 Q
"RTN","ORWCIRN",62,0)
HDRON(ORY) ;Get parameter value for ORWRP HDR ON
"RTN","ORWCIRN",63,0)
 S ORY=+$$GET^XPAR("ALL","ORWRP HDR ON",1,"I")
"RTN","ORWCIRN",64,0)
 Q
"RTN","ORWDCN32")
0^75^B19344504
"RTN","ORWDCN32",1,0)
ORWDCN32 ; SLC/KCM/REV - Consults calls [ 12/16/97  12:47 PM ] ;02/23/15  06:35
"RTN","ORWDCN32",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,306,350**;Dec 17, 1997;Build 77
"RTN","ORWDCN32",3,0)
 ;
"RTN","ORWDCN32",4,0)
DEF(LST,WHY)         ; load consult info
"RTN","ORWDCN32",5,0)
 N ILST,NAM,IEN,X
"RTN","ORWDCN32",6,0)
 S ILST=0
"RTN","ORWDCN32",7,0)
 S LST($$NXT)="~ShortList" D SHORT
"RTN","ORWDCN32",8,0)
 I WHY="C" D
"RTN","ORWDCN32",9,0)
 . S LST($$NXT)="~Inpt Cslt Urgencies" D INCURG
"RTN","ORWDCN32",10,0)
 I WHY="P" D
"RTN","ORWDCN32",11,0)
 . S LST($$NXT)="~Inpt Proc Urgencies" D INPURG
"RTN","ORWDCN32",12,0)
 S LST($$NXT)="~Outpt Urgencies" D OUTURG
"RTN","ORWDCN32",13,0)
 S LST($$NXT)="~Inpt Place" D INPLACE
"RTN","ORWDCN32",14,0)
 S LST($$NXT)="~Outpt Place" D OUTPLACE
"RTN","ORWDCN32",15,0)
 S LST($$NXT)="~Clin Ind Date" D CID
"RTN","ORWDCN32",16,0)
 Q
"RTN","ORWDCN32",17,0)
CID ; get default value for Clinically Indicated Date
"RTN","ORWDCN32",18,0)
 N DTDFLT,ENTITY
"RTN","ORWDCN32",19,0)
 S ENTITY="DIV^SYS^PKG"
"RTN","ORWDCN32",20,0)
 S DTDFLT=$$GET^XPAR(ENTITY,"ORCDGMRC CLIN IND DATE DEFAULT",1,"Q") ;ICR 2263
"RTN","ORWDCN32",21,0)
 S LST($$NXT)="d^"_DTDFLT
"RTN","ORWDCN32",22,0)
 Q
"RTN","ORWDCN32",23,0)
SHORT ;return list of Consults or Procedures quick orders
"RTN","ORWDCN32",24,0)
 N I,TMP
"RTN","ORWDCN32",25,0)
 Q:"CP"'[WHY
"RTN","ORWDCN32",26,0)
 S I=$O(^ORD(100.98,"B",$S(WHY="C":"CSLT",WHY="P":"PROC"),0))
"RTN","ORWDCN32",27,0)
 D GETQLST^ORWDXQ(.TMP,I,"Q")
"RTN","ORWDCN32",28,0)
 S I=0 F  S I=$O(TMP(I)) Q:'I  D
"RTN","ORWDCN32",29,0)
 . S LST($$NXT)="i"_TMP(I)
"RTN","ORWDCN32",30,0)
 Q
"RTN","ORWDCN32",31,0)
OUTPLACE ; load list of places
"RTN","ORWDCN32",32,0)
 N X
"RTN","ORWDCN32",33,0)
 F X="C^CONSULTANT'S CHOICE^C","E^EMERGENCY ROOM^E" D
"RTN","ORWDCN32",34,0)
 . S LST($$NXT)="i"_X
"RTN","ORWDCN32",35,0)
 S LST($$NXT)="d"_"C^CONSULTANT'S CHOICE^C"
"RTN","ORWDCN32",36,0)
 Q
"RTN","ORWDCN32",37,0)
INPLACE ; load list of places for outpatient
"RTN","ORWDCN32",38,0)
 N X
"RTN","ORWDCN32",39,0)
 F X="B^BEDSIDE^B","C^CONSULTANT'S CHOICE^C" D
"RTN","ORWDCN32",40,0)
 . S LST($$NXT)="i"_X
"RTN","ORWDCN32",41,0)
 S LST($$NXT)="d"_"B^BEDSIDE^B"
"RTN","ORWDCN32",42,0)
 Q
"RTN","ORWDCN32",43,0)
INCURG ; get list of urgencies for inpatient consults
"RTN","ORWDCN32",44,0)
 N IEN,GMRCURG,GMRCPRO,X
"RTN","ORWDCN32",45,0)
 S GMRCURG="",GMRCPRO=""
"RTN","ORWDCN32",46,0)
 F  S GMRCURG=$O(^ORD(101.42,"S.GMRCT",GMRCURG)) Q:GMRCURG=""  D
"RTN","ORWDCN32",47,0)
 . S GMRCPRO=$O(^ORD(101,"B","GMRCURGENCY - "_GMRCURG,0))
"RTN","ORWDCN32",48,0)
 . S LST($$NXT)="i"_$O(^ORD(101.42,"S.GMRCT",GMRCURG,0))_U_GMRCURG_U_GMRCPRO
"RTN","ORWDCN32",49,0)
 S IEN=$O(^ORD(101.42,"B","ROUTINE",0)),GMRCPRO=$O(^ORD(101,"B","GMRCURGENCY - ROUTINE",0))
"RTN","ORWDCN32",50,0)
 S LST($$NXT)="d"_IEN_U_"ROUTINE"_U_GMRCPRO
"RTN","ORWDCN32",51,0)
 Q
"RTN","ORWDCN32",52,0)
INPURG ; get list of urgencies for inpatient procedures
"RTN","ORWDCN32",53,0)
 N IEN,GMRCURG,GMRCPRO,X
"RTN","ORWDCN32",54,0)
 S GMRCURG="",GMRCPRO=""
"RTN","ORWDCN32",55,0)
 F  S GMRCURG=$O(^ORD(101.42,"S.GMRCR",GMRCURG)) Q:GMRCURG=""  D
"RTN","ORWDCN32",56,0)
 . S GMRCPRO=$O(^ORD(101,"B","GMRCURGENCY - "_GMRCURG,0))
"RTN","ORWDCN32",57,0)
 . S LST($$NXT)="i"_$O(^ORD(101.42,"S.GMRCR",GMRCURG,0))_U_GMRCURG_U_GMRCPRO
"RTN","ORWDCN32",58,0)
 S IEN=$O(^ORD(101.42,"B","ROUTINE",0)),GMRCPRO=$O(^ORD(101,"B","GMRCURGENCY - ROUTINE",0))
"RTN","ORWDCN32",59,0)
 S LST($$NXT)="d"_IEN_U_"ROUTINE"_U_GMRCPRO
"RTN","ORWDCN32",60,0)
 Q
"RTN","ORWDCN32",61,0)
OUTURG ; get list of urgencies for outpatient consults/procedures
"RTN","ORWDCN32",62,0)
 N IEN,GMRCURG,GMRCPRO,X
"RTN","ORWDCN32",63,0)
 S GMRCURG="",GMRCPRO=""
"RTN","ORWDCN32",64,0)
 F  S GMRCURG=$O(^ORD(101.42,"S.GMRCO",GMRCURG)) Q:GMRCURG=""  D
"RTN","ORWDCN32",65,0)
 . S GMRCPRO=$O(^ORD(101,"B","GMRCURGENCY - "_GMRCURG,0))
"RTN","ORWDCN32",66,0)
 . S LST($$NXT)="i"_$O(^ORD(101.42,"S.GMRCO",GMRCURG,0))_U_GMRCURG_U_GMRCPRO
"RTN","ORWDCN32",67,0)
 S IEN=$O(^ORD(101.42,"B","ROUTINE",0)),GMRCPRO=$O(^ORD(101,"B","GMRCURGENCY - ROUTINE",0))
"RTN","ORWDCN32",68,0)
 S LST($$NXT)="d"_IEN_U_"ROUTINE"_U_GMRCPRO
"RTN","ORWDCN32",69,0)
 Q
"RTN","ORWDCN32",70,0)
NXT() ; increments ILST
"RTN","ORWDCN32",71,0)
 S ILST=ILST+1
"RTN","ORWDCN32",72,0)
 Q ILST
"RTN","ORWDCN32",73,0)
LOOK200(VAL,X)     ; Lookup a person in 200
"RTN","ORWDCN32",74,0)
 S VAL=$$FIND1^DIC(200,"","",X) ;ICR 2051
"RTN","ORWDCN32",75,0)
 Q
"RTN","ORWDCN32",76,0)
ORDRMSG(Y,ORDITM) ;returns order message for this consult/procedure orderable
"RTN","ORWDCN32",77,0)
 N I
"RTN","ORWDCN32",78,0)
 S I=0 F  S I=$O(^ORD(101.43,ORDITM,8,I)) Q:I'>0  S Y(I)=^(I,0)
"RTN","ORWDCN32",79,0)
 Q
"RTN","ORWDCN32",80,0)
GETPROTO(Y,ORIEN) ;Get Protocol file IEN from OR IEN
"RTN","ORWDCN32",81,0)
 S Y=$P($G(^ORD(101.43,ORIEN,0)),U,2)
"RTN","ORWDCN32",82,0)
 Q
"RTN","ORWDCN32",83,0)
GETOINUM(Y,ORNUM) ;Get Orderable Item IEN from Protocol IEN
"RTN","ORWDCN32",84,0)
 S Y=$O(^ORD(101.43,"ID",ORNUM,0))
"RTN","ORWDCN32",85,0)
 Q
"RTN","ORWDCN32",86,0)
GETPRONM(Y,ORNAME) ;Get Protocol IEN given name
"RTN","ORWDCN32",87,0)
 S Y=$O(^ORD(101,"B",ORNAME,0))_";99PRO"
"RTN","ORWDCN32",88,0)
 Q
"RTN","ORWDCN32",89,0)
PROC(Y,FROM,DIR) ; Return a subset of orderable procedures
"RTN","ORWDCN32",90,0)
 ; .Return Array, Starting Text, Direction
"RTN","ORWDCN32",91,0)
 ; ^ORD(101.43,"S.PROC",UpperCase,DA)=Mne^MixedCase^InactvDt^.01IfMne
"RTN","ORWDCN32",92,0)
 ; Y(n)=IEN^.01 Name^.01 Name  -or-  IEN^Synonym <.01 Name>^.01 Name
"RTN","ORWDCN32",93,0)
 N I,IEN,CNT,X,DTXT,ORID,ORSVCCNT S I=0,CNT=44
"RTN","ORWDCN32",94,0)
 F  Q:I'<CNT  S FROM=$O(^ORD(101.43,"S.PROC",FROM),DIR) Q:FROM=""  D
"RTN","ORWDCN32",95,0)
 . S IEN=0 F  S IEN=$O(^ORD(101.43,"S.PROC",FROM,IEN)) Q:'IEN  D
"RTN","ORWDCN32",96,0)
 . . S X=^ORD(101.43,"S.PROC",FROM,IEN)
"RTN","ORWDCN32",97,0)
 . . I +$P(X,U,3),$P(X,U,3)<$$NOW^XLFDT Q  ;ICR 10103
"RTN","ORWDCN32",98,0)
 . . S ORID=$P($G(^ORD(101.43,IEN,0)),U,2)
"RTN","ORWDCN32",99,0)
 . . ;I $P($G(^ORD(101,ORIEN,0)),U,3)'="" Q   ; Removed for v14
"RTN","ORWDCN32",100,0)
 . . D GETSVC^GMRCPR0(.ORSVCCNT,ORID) Q:+ORSVCCNT=0  ;ICR 2982
"RTN","ORWDCN32",101,0)
 . . S I=I+1
"RTN","ORWDCN32",102,0)
 . . I 'X S Y(I)=IEN_U_$P(X,U,2)_U_$P(X,U,2)_U_ORID
"RTN","ORWDCN32",103,0)
 . . E  S Y(I)=IEN_U_$P(X,U,2)_$C(9)_"<"_$P(X,U,4)_">"_U_$P(X,U,4)_U_ORID
"RTN","ORWDCN32",104,0)
 Q
"RTN","ORWDCN32",105,0)
NEWDLG(Y,ORTYPE,ORLOC) ; Return order dialog info for New Consult OR PROCEDURE
"RTN","ORWDCN32",106,0)
 N DGRP,ID,IEN,TXT,TYP,X,X0,X5,ENT
"RTN","ORWDCN32",107,0)
 S ENT="ALL"
"RTN","ORWDCN32",108,0)
 I $G(ORLOC) S ORLOC=+ORLOC_";SC(",ENT=ENT_"^"_ORLOC
"RTN","ORWDCN32",109,0)
 I ORTYPE="C" S X=$$GET^XPAR(ENT,"ORWDX NEW CONSULT",1,"I") ;ICR 2263
"RTN","ORWDCN32",110,0)
 E  S X=$$GET^XPAR(ENT,"ORWDX NEW PROCEDURE",1,"I")
"RTN","ORWDCN32",111,0)
 S IEN=+X,X0=$G(^ORD(101.41,IEN,0)),X5=$G(^(5))
"RTN","ORWDCN32",112,0)
 S TYP=$P(X0,U,4),DGRP=+$P(X0,U,5),ID=+$P(X5,U,5),TXT=$P(X5,U,4)
"RTN","ORWDCN32",113,0)
 S Y=IEN_";"_ID_";"_DGRP_";"_TYP_U_TXT
"RTN","ORWDCN32",114,0)
 Q
"RTN","ORWDPS1")
0^35^B58422591
"RTN","ORWDPS1",1,0)
ORWDPS1 ; SLC/KCM/JLI/TC - Pharmacy Calls for Windows Dialog ;07/02/15  06:30
"RTN","ORWDPS1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**85,132,141,163,215,255,243,306,350**;Dec 17, 1997;Build 77
"RTN","ORWDPS1",3,0)
 ;
"RTN","ORWDPS1",4,0)
 ;
"RTN","ORWDPS1",5,0)
ODSLCT(LST,PSTYPE,DFN,LOC) ; return default lists for dialog
"RTN","ORWDPS1",6,0)
 ; PSTYPE: pharmacy type (U=unit dose, F=IV fluids, O=outpatient)
"RTN","ORWDPS1",7,0)
 N ILST S ILST=0
"RTN","ORWDPS1",8,0)
 S ILST=ILST+1,LST(ILST)="~Priority" D PRIOR
"RTN","ORWDPS1",9,0)
 S ILST=ILST+1,LST(ILST)="~DispMsg"
"RTN","ORWDPS1",10,0)
 S ILST=ILST+1,LST(ILST)="d"_$$DISPMSG
"RTN","ORWDPS1",11,0)
 ;
"RTN","ORWDPS1",12,0)
 ; I PSTYPE="F" D  Q                           ; IV Fluids
"RTN","ORWDPS1",13,0)
 ; . S ILST=ILST+1,LST(ILST)="~ShortList" D SHORT
"RTN","ORWDPS1",14,0)
 ;
"RTN","ORWDPS1",15,0)
 I PSTYPE="O" D                                ; Outpatient
"RTN","ORWDPS1",16,0)
 . S ILST=ILST+1,LST(ILST)="~Refills"
"RTN","ORWDPS1",17,0)
 . S ILST=ILST+1,LST(ILST)="d0^0"
"RTN","ORWDPS1",18,0)
 . S ILST=ILST+1,LST(ILST)="~Pickup"
"RTN","ORWDPS1",19,0)
 . S ILST=ILST+1,LST(ILST)="d"_$$DEFPICK($G(LOC))
"RTN","ORWDPS1",20,0)
 . ; S ILST=ILST+1,LST(ILST)="~Supply"
"RTN","ORWDPS1",21,0)
 . ; S ILST=ILST+1,LST(ILST)="d^"_$$DEFSPLY(DFN)
"RTN","ORWDPS1",22,0)
 Q
"RTN","ORWDPS1",23,0)
PKI(ORY,OI,PSTYPE,ORVP,PKIACTIV) ; return DEA Schedule for drug
"RTN","ORWDPS1",24,0)
 N ILST,ORDOSE,ORWPSOI,ORWDOSES,X1,X2,X
"RTN","ORWDPS1",25,0)
 K ^TMP("PSJINS",$J),^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),^TMP("PSJSCH",$J),^TMP("PSSDIN",$J)
"RTN","ORWDPS1",26,0)
 S ILST=0
"RTN","ORWDPS1",27,0)
 S ORWPSOI=0
"RTN","ORWDPS1",28,0)
 S:+OI ORWPSOI=+$P($G(^ORD(101.43,+OI,0)),U,2)
"RTN","ORWDPS1",29,0)
 D START^PSSJORDF(ORWPSOI,$S(PSTYPE="U":"I",1:"O")) ; dflt route, schedule, etc.
"RTN","ORWDPS1",30,0)
 I '$L($T(DOSE^PSSOPKI1)) D DOSE^PSSORUTL(.ORDOSE,ORWPSOI,PSTYPE,ORVP)       ; dflt doses
"RTN","ORWDPS1",31,0)
 I $L($T(DOSE^PSSOPKI1)) D DOSE^PSSOPKI1(.ORDOSE,ORWPSOI,PSTYPE,ORVP)       ; dflt doses NEW PKI CODE from pharmacy
"RTN","ORWDPS1",32,0)
 D EN^PSSDIN(ORWPSOI)                               ; nfi text
"RTN","ORWDPS1",33,0)
 S ORY="" ;PKI
"RTN","ORWDPS1",34,0)
 I $D(ORDOSE("DEA")) S X="",X1=$P(ORDOSE("DEA"),";"),X2=$P(ORDOSE("DEA"),";",2) D
"RTN","ORWDPS1",35,0)
 . I '$L(X2) Q
"RTN","ORWDPS1",36,0)
 . I $G(PKIACTIV) S X=X2
"RTN","ORWDPS1",37,0)
 S ORY=X
"RTN","ORWDPS1",38,0)
 K ^TMP("PSJINS",$J),^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),^TMP("PSJSCH",$J),^TMP("PSSDIN",$J)
"RTN","ORWDPS1",39,0)
 Q
"RTN","ORWDPS1",40,0)
PRIOR ; from DLGSLCT, get list of allowed priorities
"RTN","ORWDPS1",41,0)
 N X,XREF
"RTN","ORWDPS1",42,0)
 S XREF=$S(PSTYPE="O":"S.PSO",1:"S.PSJ")
"RTN","ORWDPS1",43,0)
 S X="" F  S X=$O(^ORD(101.42,XREF,X)) Q:'$L(X)  D
"RTN","ORWDPS1",44,0)
 . I XREF["PSO",X="DONE" Q
"RTN","ORWDPS1",45,0)
 . I XREF["PSJ",X'="ASAP",X'="ROUTINE",X'="STAT" Q
"RTN","ORWDPS1",46,0)
 . S ILST=ILST+1,LST(ILST)="i"_$O(^ORD(101.42,XREF,X,0))_U_X
"RTN","ORWDPS1",47,0)
 S ILST=ILST+1,LST(ILST)="d"_$O(^ORD(101.42,"B","ROUTINE",0))_U_"ROUTINE"
"RTN","ORWDPS1",48,0)
 Q
"RTN","ORWDPS1",49,0)
DEFPICK(LOC)       ; return default routing
"RTN","ORWDPS1",50,0)
 N X,DLG,PRMT
"RTN","ORWDPS1",51,0)
 S DLG=$O(^ORD(101.41,"AB","PSO OERR",0)),X=""
"RTN","ORWDPS1",52,0)
 S PRMT=$O(^ORD(101.41,"AB","OR GTX ROUTING",0))
"RTN","ORWDPS1",53,0)
 I $D(^TMP("ORECALL",$J,+DLG,+PRMT,1)) S X=^(1)
"RTN","ORWDPS1",54,0)
 I X'="" S EDITONLY=1 Q X  ; EDITONLY used by default action
"RTN","ORWDPS1",55,0)
 ;
"RTN","ORWDPS1",56,0)
 ;S X=$$GET^XPAR("ALL^"_"LOC.`"_LOC,"ORWDPS ROUTING DEFAULT",1,"I")
"RTN","ORWDPS1",57,0)
 S X=$$GET^XPAR("LOC.`"_LOC_"^SYS","ORWDPS ROUTING DEFAULT",1,"I")
"RTN","ORWDPS1",58,0)
 I X="C" S X="C^in Clinic" G XPICK
"RTN","ORWDPS1",59,0)
 I X="M" S X="M^by Mail"   G XPICK
"RTN","ORWDPS1",60,0)
 I X="W" S X="W^at Window" G XPICK
"RTN","ORWDPS1",61,0)
 I X="N" S X=""            G XPICK
"RTN","ORWDPS1",62,0)
 I X=""  S X=$S($D(^PSX(550,"C")):"M^by Mail",1:"W^at Window")
"RTN","ORWDPS1",63,0)
XPICK Q X
"RTN","ORWDPS1",64,0)
 ;
"RTN","ORWDPS1",65,0)
DEFSPLY(DFN)    ; return default days supply for this patient
"RTN","ORWDPS1",66,0)
 N ORWX
"RTN","ORWDPS1",67,0)
 S ORWX("PATIENT")=DFN
"RTN","ORWDPS1",68,0)
 D DSUP^PSOSIGDS(.ORWX)
"RTN","ORWDPS1",69,0)
 Q $G(ORWX("DAYS SUPPLY"))
"RTN","ORWDPS1",70,0)
 ;
"RTN","ORWDPS1",71,0)
DFLTSPLY(VAL,UPD,SCH,PAT,DRG,OI)        ; return days supply given quantity
"RTN","ORWDPS1",72,0)
 ; VAL: default days supply
"RTN","ORWDPS1",73,0)
 N ORWX,I,PSOI,TPKG
"RTN","ORWDPS1",74,0)
 S ORWX("PATIENT")=PAT
"RTN","ORWDPS1",75,0)
 I DRG S ORWX("DRUG")=DRG
"RTN","ORWDPS1",76,0)
 I $D(OI) D
"RTN","ORWDPS1",77,0)
 . S TPKG=$P($G(^ORD(101.43,+$G(OI),0)),U,2) Q:TPKG'["PS"
"RTN","ORWDPS1",78,0)
 . S PSOI=+TPKG Q:PSOI'>0
"RTN","ORWDPS1",79,0)
 . S ORWX("OI")=PSOI
"RTN","ORWDPS1",80,0)
 F I=1:1:$L(UPD,U)-1 D
"RTN","ORWDPS1",81,0)
 . S ORWX("DOSE ORDERED",I)=$P(UPD,U,I)
"RTN","ORWDPS1",82,0)
 . S ORWX("SCHEDULE",I)=$P(SCH,U,I)
"RTN","ORWDPS1",83,0)
 D DSUP^PSOSIGDS(.ORWX)
"RTN","ORWDPS1",84,0)
 S VAL=$G(ORWX("DAYS SUPPLY"))
"RTN","ORWDPS1",85,0)
 Q
"RTN","ORWDPS1",86,0)
DISPMSG()       ; return 1 to suppress dispense message
"RTN","ORWDPS1",87,0)
 Q +$$GET^XPAR("ALL","ORWDPS SUPPRESS DISPENSE MSG",1,"I")
"RTN","ORWDPS1",88,0)
 ;
"RTN","ORWDPS1",89,0)
DOWSCH(LST,DFN,LOCIEN)     ; return all schedules
"RTN","ORWDPS1",90,0)
 N CNT,FREQ,ILST,ORARRAY,WIEN
"RTN","ORWDPS1",91,0)
 S WIEN=$$WARDIEN^ORWDPS32(+$G(LOCIEN))
"RTN","ORWDPS1",92,0)
 D SCHED^PSS51P1(WIEN,.ORARRAY)
"RTN","ORWDPS1",93,0)
 S ILST=0
"RTN","ORWDPS1",94,0)
 S CNT=0 F  S CNT=$O(ORARRAY(CNT)) Q:CNT'>0  D
"RTN","ORWDPS1",95,0)
 .S NODE=$G(ORARRAY(CNT))
"RTN","ORWDPS1",96,0)
 .I $P(NODE,U,4)="C" D
"RTN","ORWDPS1",97,0)
 ..K ^TMP($J,"ORWDPS1 DOWSCH")
"RTN","ORWDPS1",98,0)
 ..D ZERO^PSS51P1($P(NODE,U),,,,"ORWDPS1 DOWSCH")
"RTN","ORWDPS1",99,0)
 ..S FREQ=$G(^TMP($J,"ORWDPS1 DOWSCH",$P(NODE,U),2))
"RTN","ORWDPS1",100,0)
 ..K ^TMP($J,"ORWDPS1 DOWSCH")
"RTN","ORWDPS1",101,0)
 ..I +FREQ=0 Q
"RTN","ORWDPS1",102,0)
 ..I +FREQ>1440 Q
"RTN","ORWDPS1",103,0)
 ..S ILST=ILST+1,LST(ILST)=$P(ORARRAY(CNT),U,2,5)
"RTN","ORWDPS1",104,0)
 Q
"RTN","ORWDPS1",105,0)
 ;
"RTN","ORWDPS1",106,0)
SCHALL(LST,DFN,LOCIEN)     ; return all schedules
"RTN","ORWDPS1",107,0)
 N CNT,ILST,ORARRAY,WIEN
"RTN","ORWDPS1",108,0)
 S WIEN=$$WARDIEN^ORWDPS32(+$G(LOCIEN))
"RTN","ORWDPS1",109,0)
 D SCHED^PSS51P1(WIEN,.ORARRAY)
"RTN","ORWDPS1",110,0)
 S ILST=0
"RTN","ORWDPS1",111,0)
 S CNT=0 F  S CNT=$O(ORARRAY(CNT)) Q:CNT'>0  D
"RTN","ORWDPS1",112,0)
 .S ILST=ILST+1,LST(ILST)=$P(ORARRAY(CNT),U,2,5)
"RTN","ORWDPS1",113,0)
 Q
"RTN","ORWDPS1",114,0)
 ;
"RTN","ORWDPS1",115,0)
FORMALT(ORLST,ORIEN,PSTYPE) ; return a list of formulary alternatives
"RTN","ORWDPS1",116,0)
 N PSID,I
"RTN","ORWDPS1",117,0)
 S ORIEN=+$P(^ORD(101.43,ORIEN,0),U,2)
"RTN","ORWDPS1",118,0)
 D EN1^PSSUTIL1(.ORIEN,PSTYPE)
"RTN","ORWDPS1",119,0)
 S PSID=0,I=0
"RTN","ORWDPS1",120,0)
 F  S PSID=$O(ORIEN(PSID)) Q:'PSID  D
"RTN","ORWDPS1",121,0)
 . S OI=+$O(^ORD(101.43,"ID",PSID_";99PSP",0))
"RTN","ORWDPS1",122,0)
 . I OI S I=I+1,ORLST(I)=OI,$P(ORLST(I),U,2)=$P(^ORD(101.43,OI,0),U)
"RTN","ORWDPS1",123,0)
 Q
"RTN","ORWDPS1",124,0)
DOSEALT(LST,DDRUG,CUROI,PSTYPE) ; return a list of formulary alternatives for dose
"RTN","ORWDPS1",125,0)
 N I,OI,ORWLST,ILST S ILST=0
"RTN","ORWDPS1",126,0)
 D ENRFA^PSJORUTL(DDRUG,PSTYPE,.ORWLST)
"RTN","ORWDPS1",127,0)
 S I=0 F  S I=$O(ORWLST(I)) Q:'I  D
"RTN","ORWDPS1",128,0)
 . S OI=+$O(^ORD(101.43,"ID",+$P(ORWLST(I),U,4)_";99PSP",0))
"RTN","ORWDPS1",129,0)
 . I OI,OI'=CUROI S ILST=ILST+1,LST(ILST)=OI_U_$P(^ORD(101.43,OI,0),U)
"RTN","ORWDPS1",130,0)
 Q
"RTN","ORWDPS1",131,0)
QOMEDALT(ORY,ODIEN) ;
"RTN","ORWDPS1",132,0)
 N ARRAY,IDIEN,ORDERID,PKG,PSTYPE,VALUE
"RTN","ORWDPS1",133,0)
 S ORY=0,PKG=+$P(^ORD(101.41,ODIEN,0),U,7)
"RTN","ORWDPS1",134,0)
 S PSTYPE=$S($$GET1^DIQ(9.4,PKG_",",1)="PSO":"O",1:"I")
"RTN","ORWDPS1",135,0)
 S ORDERID=$O(^ORD(101.41,"B","OR GTX ORDERABLE ITEM","")) Q:ORDERID'>0
"RTN","ORWDPS1",136,0)
 S IDIEN=$O(^ORD(101.41,ODIEN,6,"D",ORDERID,"")) Q:IDIEN'>0
"RTN","ORWDPS1",137,0)
 S VALUE=$G(^ORD(101.41,ODIEN,6,IDIEN,1)) Q:VALUE'>0
"RTN","ORWDPS1",138,0)
 I $P($G(^ORD(101.43,VALUE,"PS")),U,6)=1 S ORY=VALUE
"RTN","ORWDPS1",139,0)
 ;D FORMALT(.ARRAY,VALUE,PSTYPE) I $D(ARRAY)>0 S ORY=VALUE
"RTN","ORWDPS1",140,0)
 ;I ORY=0,$P($G(^ORD(101.43,VALUE,"PS")),U,6)=1 S ORY=VALUE
"RTN","ORWDPS1",141,0)
 Q
"RTN","ORWDPS1",142,0)
FAILDEA(FAIL,OI,ORNP,PSTYPE)    ; return 1 if DEA check fails for this provider
"RTN","ORWDPS1",143,0)
 N DEAFLG,PSOI,TPKG,RT,DETFLG,DETPRO
"RTN","ORWDPS1",144,0)
 S FAIL=0,TPKG=$P($G(^ORD(101.43,+$G(OI),0)),U,2)
"RTN","ORWDPS1",145,0)
 Q:TPKG'["PS"
"RTN","ORWDPS1",146,0)
 S PSOI=+TPKG Q:PSOI'>0
"RTN","ORWDPS1",147,0)
 S DETFLAG=$$OIDETOX^PSSOPKI(PSOI,PSTYPE)
"RTN","ORWDPS1",148,0)
 S DETPRO=$$DETOX^XUSER(+$G(ORNP))
"RTN","ORWDPS1",149,0)
 I DETFLAG,DETPRO="" S FAIL=3 Q
"RTN","ORWDPS1",150,0)
 I DETFLAG,DETPRO>0 S Y=DETPRO X ^DD("DD") S FAIL="5^"_Y Q
"RTN","ORWDPS1",151,0)
 S DEAFLG=$P($$OIDEA^PSSOPKI(PSOI,PSTYPE),";",2) Q:DEAFLG'>0
"RTN","ORWDPS1",152,0)
 I DEAFLG=1 S FAIL=6 Q
"RTN","ORWDPS1",153,0)
 S RT=$$SDEA^XUSER(,+$G(ORNP),DEAFLG) I RT=1 S FAIL=1
"RTN","ORWDPS1",154,0)
 I RT=2 S FAIL="2^"_$$UP^XLFSTR(DEAFLG)
"RTN","ORWDPS1",155,0)
 I RT?1"4".E S FAIL=RT
"RTN","ORWDPS1",156,0)
 Q
"RTN","ORWDPS1",157,0)
FDEA1(FAIL,OI,OITYPE,ORNP) ; only be called for an outpaitent and IV dialog
"RTN","ORWDPS1",158,0)
 ;OI: IV Orderable Item
"RTN","ORWDPS1",159,0)
 ;OITYPE: A:ADDITIVE  S:SOLUTION
"RTN","ORWDPS1",160,0)
 N DEAFLG,PSOI,TKPG,RT,DETFLG,DETPRO
"RTN","ORWDPS1",161,0)
 S FAIL=0,TPKG=$P($G(^ORD(101.43,+$G(OI),0)),U,2)
"RTN","ORWDPS1",162,0)
 Q:TPKG'["PS"
"RTN","ORWDPS1",163,0)
 S PSOI=+TPKG Q:PSOI'>0
"RTN","ORWDPS1",164,0)
 S DETFLAG=$$OIDETOX^PSSOPKI(PSOI,"I")
"RTN","ORWDPS1",165,0)
 S DETPRO=$$DETOX^XUSER(+$G(ORNP))
"RTN","ORWDPS1",166,0)
 I DETFLAG,DETPRO="" S FAIL=3 Q
"RTN","ORWDPS1",167,0)
 I DETFLAG,DETPRO>0 S Y=DETPRO X ^DD("DD") S FAIL="5^"_Y Q
"RTN","ORWDPS1",168,0)
 S DEAFLG=$P($$IVDEA^PSSUTIL1(PSOI,OITYPE),";",2) Q:DEAFLG'>0
"RTN","ORWDPS1",169,0)
 I DEAFLG=1 S FAIL=6 Q Q
"RTN","ORWDPS1",170,0)
 S RT=$$SDEA^XUSER(,+$G(ORNP),DEAFLG) I RT=1 S FAIL=1
"RTN","ORWDPS1",171,0)
 I RT=2 S FAIL="2^"_$$UP^XLFSTR(DEAFLG)
"RTN","ORWDPS1",172,0)
 I RT?1"4".E S FAIL=RT
"RTN","ORWDPS1",173,0)
 Q
"RTN","ORWDPS1",174,0)
 ;
"RTN","ORWDPS1",175,0)
CHK94(VAL)      ; return 1 if patch 94 has been installed
"RTN","ORWDPS1",176,0)
 S VAL=0
"RTN","ORWDPS1",177,0)
 I $O(^ORD(101.41,"B","PS MEDS",0)) S VAL=1
"RTN","ORWDPS1",178,0)
 Q
"RTN","ORWDPS1",179,0)
LOCPICK(Y,LOC) ; return default Location level routing
"RTN","ORWDPS1",180,0)
 S Y=""
"RTN","ORWDPS1",181,0)
 S Y=$$GET^XPAR("LOC.`"_LOC_"^SYS","ORWDPS ROUTING DEFAULT",1,"I")
"RTN","ORWDPS1",182,0)
 I Y="C" S Y="C^in Clinic"
"RTN","ORWDPS1",183,0)
 I Y="M" S Y="M^by Mail"
"RTN","ORWDPS1",184,0)
 I Y="W" S Y="W^at Window"
"RTN","ORWDPS1",185,0)
 I Y="N" S Y=""
"RTN","ORWDPS1",186,0)
 Q
"RTN","ORWDPS1",187,0)
HASOIPI(Y,QOID) ; Check if QO put orderable item's PI into Sig
"RTN","ORWDPS1",188,0)
 N PIIEN,OIX
"RTN","ORWDPS1",189,0)
 S Y=0
"RTN","ORWDPS1",190,0)
 Q:'$D(^ORD(101.41,QOID,0))
"RTN","ORWDPS1",191,0)
 S PIIEN=$O(^ORD(101.41,"B","OR GTX PATIENT INSTRUCTIONS",0))
"RTN","ORWDPS1",192,0)
 Q:'PIIEN
"RTN","ORWDPS1",193,0)
 S OIX=0
"RTN","ORWDPS1",194,0)
 Q:'$D(^ORD(101.41,QOID,6,"D"))
"RTN","ORWDPS1",195,0)
 F  S OIX=$O(^ORD(101.41,+QOID,6,"D",OIX)) Q:'OIX  D
"RTN","ORWDPS1",196,0)
 . I OIX=PIIEN S Y=1 Q
"RTN","ORWDPS1",197,0)
 Q
"RTN","ORWDPS1",198,0)
HASROUTE(Y,QOID) ;Check if QO has a ROUTE defined
"RTN","ORWDPS1",199,0)
 N ROUTID
"RTN","ORWDPS1",200,0)
 S Y=0,ROUTID=0
"RTN","ORWDPS1",201,0)
 S ROUTID=$O(^ORD(101.41,"B","OR GTX ROUTING",0))
"RTN","ORWDPS1",202,0)
 Q:'ROUTID
"RTN","ORWDPS1",203,0)
 Q:'$D(^ORD(101.41,+QOID))
"RTN","ORWDPS1",204,0)
 I $D(^ORD(101.41,+QOID,6,"D",ROUTID)) S Y=1
"RTN","ORWDPS1",205,0)
 Q
"RTN","ORWDPS1",206,0)
QOCHECK(ORY,DIEN) ;
"RTN","ORWDPS1",207,0)
 N ARY,DG,FORMIEN,NAME,OI,OIIEN,ORDIALOG,ORPKG,TYPE
"RTN","ORWDPS1",208,0)
 S ORPKG=$$NMSP^ORCD($P($G(^ORD(101.41,DIEN,0)),U,7)) Q:ORPKG'["PS"
"RTN","ORWDPS1",209,0)
 S DG=$P(^ORD(101.41,DIEN,0),U,5)
"RTN","ORWDPS1",210,0)
 S NAME=$P(^ORD(100.98,DIEN,0),U)
"RTN","ORWDPS1",211,0)
 S TYPE=$S(NAME="INPATIENT MEDICATIONS":"I",NAME="OUTPATIENT MEDICATIONS":"O",1:"")
"RTN","ORWDPS1",212,0)
 I TYPE="" Q
"RTN","ORWDPS1",213,0)
 S ORDIALOG=$$DEFDLG^ORCD(DIEN) Q:ORDIALOG
"RTN","ORWDPS1",214,0)
 D GETDLG^ORCD(ORDIALOG),GETORDER^ORCD("^ORD(101.41,"_DIEN_",6)")
"RTN","ORWDPS1",215,0)
 I $D(ORDIALOG)'>0 Q
"RTN","ORWDPS1",216,0)
 S OI=$P($G(ORDIALOG("B","ORDERABLE")),U,2) Q:OI'>0
"RTN","ORWDPS1",217,0)
 S OIIEN=$G(ORDIALOG(OI,1)) Q:OIIEN'>0
"RTN","ORWDPS1",218,0)
 D FORMALT(.ARY,OIIEN,TYPE) I $D(ARY)'>0 Q
"RTN","ORWDPS1",219,0)
 S ORY=OIIEN
"RTN","ORWDPS1",220,0)
 Q
"RTN","ORWDPS3")
0^56^B24262284
"RTN","ORWDPS3",1,0)
ORWDPS3 ;SLC/KCM,JLI - ORDER DIALOGS AND MENUS ;10/05/15  14:33
"RTN","ORWDPS3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**85,94,116,132,187,195,215,280,350**;Dec 17, 1997;Build 77
"RTN","ORWDPS3",3,0)
 ;
"RTN","ORWDPS3",4,0)
 ;
"RTN","ORWDPS3",5,0)
 ;
"RTN","ORWDPS3",6,0)
MEDXFER ; -- setup ORDIALOG for a med that is transferred (from SETUP^ORWDXM4)
"RTN","ORWDPS3",7,0)
 N IVDIALOG,OI K ^TMP("PS",$J)
"RTN","ORWDPS3",8,0)
 S IVDIALOG=$O(^ORD(101.41,"AB","PSJI OR PAT FLUID OE",0))
"RTN","ORWDPS3",9,0)
 S ORDIALOG=$O(^ORD(101.41,"AB","PS MEDS",0))
"RTN","ORWDPS3",10,0)
 I +$P($G(^OR(100,+ORIT,0)),U,5)=IVDIALOG S ORDIALOG=IVDIALOG
"RTN","ORWDPS3",11,0)
 S ORDG=+$P(^ORD(101.41,ORDIALOG,0),U,5)
"RTN","ORWDPS3",12,0)
 D GETDLG^ORCD(ORDIALOG)
"RTN","ORWDPS3",13,0)
 D GETORDER^ORCD("^OR(100,"_+ORIT_",4.5)")
"RTN","ORWDPS3",14,0)
 ;I ORDIALOG=IVDIALOG Q
"RTN","ORWDPS3",15,0)
 S OI=$$VAL^ORCD("MEDICATION")
"RTN","ORWDPS3",16,0)
 I ORDIALOG'=IVDIALOG,'$$MEDOK(OI,ORCAT) D SETERR(ORIT,"This may not be ordered as an "_$S(ORCAT="I":"in",1:"out")_"patient drug.") Q
"RTN","ORWDPS3",17,0)
 I +$G(OI)>0,$G(^ORD(101.43,OI,.1)),(^(.1)<$$NOW^XLFDT) D SETERR(ORIT,"This may no longer be ordered.") Q
"RTN","ORWDPS3",18,0)
 I (ORDIALOG'=IVDIALOG),(ORCAT="I") D OUT^ORCMED
"RTN","ORWDPS3",19,0)
 I (ORDIALOG'=IVDIALOG),(ORCAT="O") D IN^ORCMED
"RTN","ORWDPS3",20,0)
 S ORWPSWRG="" ; force interactive dialog for transfers
"RTN","ORWDPS3",21,0)
 Q
"RTN","ORWDPS3",22,0)
MEDOK(OI,CAT)   ; return 1 if med may be ordered for this patient category
"RTN","ORWDPS3",23,0)
 N P S P=$S(CAT="I":1,1:2)
"RTN","ORWDPS3",24,0)
 I ORIMO S P=1
"RTN","ORWDPS3",25,0)
 N THEGRP,INPTGRP
"RTN","ORWDPS3",26,0)
 S THEGRP=0
"RTN","ORWDPS3",27,0)
 I $D(ORIT),+ORIT S THEGRP=$P($G(^OR(100,+ORIT,0)),U,11)
"RTN","ORWDPS3",28,0)
 S INPTGRP=$O(^ORD(100.98,"B","UD RX",0))
"RTN","ORWDPS3",29,0)
 I P=2,(INPTGRP=THEGRP),($P($G(^ORD(101.43,+OI,"PS")),U,1)=2) Q 2
"RTN","ORWDPS3",30,0)
 E  Q $P($G(^ORD(101.43,+OI,"PS")),U,P)
"RTN","ORWDPS3",31,0)
 ;
"RTN","ORWDPS3",32,0)
SETERR(ID,X)       ; sets LST to rejection with error message
"RTN","ORWDPS3",33,0)
 D GETTXT^ORWORR(.LST,ID)
"RTN","ORWDPS3",34,0)
 S LST(0)="8^0",LST(.5)=X,LST(.6)=""
"RTN","ORWDPS3",35,0)
 Q
"RTN","ORWDPS3",36,0)
 ;
"RTN","ORWDPS3",37,0)
PS ; setup environment for medications
"RTN","ORWDPS3",38,0)
 D AUTHMED Q:$G(ORQUIT)  ; checks authorized to write meds
"RTN","ORWDPS3",39,0)
 K ^TMP("PSJINS",$J),^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),^TMP("PSJSCH",$J)
"RTN","ORWDPS3",40,0)
 N PROMPT,OI
"RTN","ORWDPS3",41,0)
 S PROMPT=$O(^ORD(101.41,"AB","OR GTX ORDERABLE ITEM",0))
"RTN","ORWDPS3",42,0)
 S OI=""
"RTN","ORWDPS3",43,0)
 I $D(ORDIALOG(PROMPT,1)) S OI=ORDIALOG(PROMPT,1) D MEDACTV Q:$G(ORQUIT)
"RTN","ORWDPS3",44,0)
 N PSOI
"RTN","ORWDPS3",45,0)
 S PSOI=+$P($G(^ORD(101.43,+OI,0)),U,2) D START^PSSJORDF(PSOI,ORCAT)
"RTN","ORWDPS3",46,0)
 S PROMPT=$O(^ORD(101.41,"AB","OR GTX SCHEDULE",0))
"RTN","ORWDPS3",47,0)
 I $D(ORDIALOG(PROMPT,1)) S ORSCH=ORDIALOG(PROMPT,1)
"RTN","ORWDPS3",48,0)
 I (ORCAT="I"),$L($G(ORSCH)) D
"RTN","ORWDPS3",49,0)
 . S ORSD=""
"RTN","ORWDPS3",50,0)
 . I $L($G(^DPT(+ORVP,.1))) S ORSD=$$STARTSTP^PSJORPOE(+ORVP,ORSCH,PSOI,+$G(ORWARD),"")
"RTN","ORWDPS3",51,0)
 . I $P(ORSD,U)="NEXT" S $P(ORSD,U)="NEXTA"
"RTN","ORWDPS3",52,0)
 S PROMPT=$O(^ORD(101.41,"AB","OR GTX DAYS SUPPLY",0))
"RTN","ORWDPS3",53,0)
 I $D(ORDIALOG(PROMPT,1)) S ORDSUP=ORDIALOG(PROMPT,1)
"RTN","ORWDPS3",54,0)
 S PROMPT=$O(^ORD(101.41,"AB","OR GTX DISPENSE DRUG",0))
"RTN","ORWDPS3",55,0)
 I $D(ORDIALOG(PROMPT,1)) S ORDRUG=ORDIALOG(PROMPT,1)
"RTN","ORWDPS3",56,0)
 S PROMPT=$O(^ORD(101.41,"AB","OR GTX REFILLS",0))
"RTN","ORWDPS3",57,0)
 I $D(ORDIALOG(PROMPT,1)) S OREFILLS=ORDIALOG(PROMPT,1)
"RTN","ORWDPS3",58,0)
 I ORCAT="O" S ORCOPAY=$$ASKSC^ORCDPS1
"RTN","ORWDPS3",59,0)
 I ORCAT="I" S PROMPT=$O(^ORD(101.41,"AB","OR GTX START DATE/TIME",0)) D
"RTN","ORWDPS3",60,0)
 . I $L($P($G(ORSD),U)),'$D(ORDIALOG(PROMPT,1)) S ORDIALOG(PROMPT,1)=$P(ORSD,U)
"RTN","ORWDPS3",61,0)
 ; create a SIG if none exists (i.e., when copying pre-POE orders)
"RTN","ORWDPS3",62,0)
 I '$L($G(ORDIALOG($$PTR^ORCD("OR GTX SIG"),1))) D
"RTN","ORWDPS3",63,0)
 . N ORDOSE,ORDRUG,ORWPSOI,PROMPT,DRUG
"RTN","ORWDPS3",64,0)
 . S PROMPT=$$PTR^ORCD("OR GTX INSTRUCTIONS")
"RTN","ORWDPS3",65,0)
 . S ORDRUG=$G(ORDIALOG($$PTR^ORCD("OR GTX DISPENSE DRUG"),1))
"RTN","ORWDPS3",66,0)
 . S ORWPSOI=+$G(ORDIALOG($$PTR^ORCD("OR GTX ORDERABLE ITEM"),1))
"RTN","ORWDPS3",67,0)
 . I ORWPSOI S ORWPSOI=+$P($G(^ORD(101.43,+ORWPSOI,0)),U,2)
"RTN","ORWDPS3",68,0)
 . D DOSE^PSSORUTL(.ORDOSE,ORWPSOI,$S(ORCAT="I":"U",1:"O"),ORVP)       ; dflt doses
"RTN","ORWDPS3",69,0)
 . D D1^ORCDPS2  ; set up ORDOSE & xrefs in ORDIALOG
"RTN","ORWDPS3",70,0)
 . S DRUG=$G(ORDOSE("DD",+ORDRUG))
"RTN","ORWDPS3",71,0)
 . I DRUG,ORCAT="O" D RESETID^ORCDPS
"RTN","ORWDPS3",72,0)
 . D SIG^ORCDPS2
"RTN","ORWDPS3",73,0)
 Q
"RTN","ORWDPS3",74,0)
AUTHMED ; sets ORQUIT if not authorized to write meds
"RTN","ORWDPS3",75,0)
 N NOAUTH,NAME,ORSDLOG
"RTN","ORWDPS3",76,0)
 S ORDLOG=$G(ORDLOG) I ORDLOG="" S ORDLOG=$G(ORDIALOG)
"RTN","ORWDPS3",77,0)
 S NAME=$P($G(^VA(200,+ORNP,20)),U,2)
"RTN","ORWDPS3",78,0)
 I '$L(NAME) S NAME=$P($G(^VA(200,+ORNP,0)),U,1)
"RTN","ORWDPS3",79,0)
 S ORSDLOG=$O(^ORD(101.41,"B","PSO SUPPLY",""))
"RTN","ORWDPS3",80,0)
 I ORDLOG=ORSDLOG D  Q
"RTN","ORWDPS3",81,0)
 . I $D(^XUSEC("ORES",+ORNP))!($D(^XUSEC("ORSUPPLY",+ORNP))) Q
"RTN","ORWDPS3",82,0)
 . S ORQUIT=1,LST(0)="8^0",LST(.5)=NAME_" is not authorized to order supplies."
"RTN","ORWDPS3",83,0)
 D AUTH^ORWDPS32(.NOAUTH,ORNP)
"RTN","ORWDPS3",84,0)
 I +NOAUTH D
"RTN","ORWDPS3",85,0)
 . S ORQUIT=1
"RTN","ORWDPS3",86,0)
 . S LST(0)="8^0"
"RTN","ORWDPS3",87,0)
 . I $P(NOAUTH,U,2)'="" S LST(.5)=$P(NOAUTH,U,2) Q
"RTN","ORWDPS3",88,0)
 . S LST(.5)=NAME_" is not authorized to write med orders."
"RTN","ORWDPS3",89,0)
 Q
"RTN","ORWDPS3",90,0)
MEDACTV ; sets ORQUIT if the orderable item is not active for a med
"RTN","ORWDPS3",91,0)
 Q:'$G(OI)
"RTN","ORWDPS3",92,0)
 I $G(^ORD(101.43,OI,.1)),^(.1)'>$$NOW^XLFDT D
"RTN","ORWDPS3",93,0)
 . S ORQUIT=1
"RTN","ORWDPS3",94,0)
 . S LST(0)="8^0"
"RTN","ORWDPS3",95,0)
 . S LST(.5)=$P($G(^ORD(101.43,OI,0)),U)_" has been inactivated and may not be ordered anymore."
"RTN","ORWDPS3",96,0)
 I $D(ORQUIT) Q:ORQUIT
"RTN","ORWDPS3",97,0)
 ; copied from ORDITM^ORCDPS1 to make sure quick order if for right dialog
"RTN","ORWDPS3",98,0)
 N ORPS,PSOI,ORIV,ORINPT
"RTN","ORWDPS3",99,0)
 S ORINPT=$$INPT^ORCD
"RTN","ORWDPS3",100,0)
 S ORPS=$G(^ORD(101.43,+OI,"PS")),PSOI=+$P($G(^(0)),U,2)
"RTN","ORWDPS3",101,0)
 S ORIV=$S($P(ORPS,U)=2:1,1:0)
"RTN","ORWDPS3",102,0)
 I $G(ORCAT)="O",'$P(ORPS,U,2),'ORIMO S LST(.5)="This drug may not be used in an outpatient order."
"RTN","ORWDPS3",103,0)
 I $G(ORCAT)="I" D
"RTN","ORWDPS3",104,0)
 . I $G(ORINPT),'$P(ORPS,U),'$P(ORPS,"^",5),'ORIMO S LST(.5)="This drug may not be used in an inpatient order."
"RTN","ORWDPS3",105,0)
 . I '$G(ORINPT),'ORIV,'ORIMO S LST(.5)="This drug may not be ordered for an outpatient."
"RTN","ORWDPS3",106,0)
 I $L($G(LST(.5))) S ORQUIT=1,LST(0)="8^0"
"RTN","ORWDPS3",107,0)
 Q
"RTN","ORWDPS32")
0^57^B77153006
"RTN","ORWDPS32",1,0)
ORWDPS32 ; SLC/KCM - Pharmacy Calls for GUI Dialog ;10/20/15  11:22
"RTN","ORWDPS32",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,94,190,195,237,243,350**;Dec 17, 1997;Build 77
"RTN","ORWDPS32",3,0)
 ;Per VHA Directive 6402, this routine should not be modified.
"RTN","ORWDPS32",4,0)
 ;
"RTN","ORWDPS32",5,0)
 ;
"RTN","ORWDPS32",6,0)
NXT() ; -- ret next available index in data array
"RTN","ORWDPS32",7,0)
 S ILST=ILST+1
"RTN","ORWDPS32",8,0)
 Q ILST
"RTN","ORWDPS32",9,0)
 ;
"RTN","ORWDPS32",10,0)
DLGSLCT(LST,PSTYPE,DFN,LOCIEN) ; return def lists for dialog
"RTN","ORWDPS32",11,0)
 ; PSTYPE: pharmacy type (U=unit dose, F=IV fluids, O=outpt)
"RTN","ORWDPS32",12,0)
 N ILST S ILST=0
"RTN","ORWDPS32",13,0)
 I PSTYPE="F" D  Q                       ; IV Fluids
"RTN","ORWDPS32",14,0)
 . S LST($$NXT)="~ShortList"  D SHORT
"RTN","ORWDPS32",15,0)
 . S LST($$NXT)="~Priorities" D PRIOR
"RTN","ORWDPS32",16,0)
 . ;S LST($$NXT)="~Schedules"  D SCHED(LOCIEN)
"RTN","ORWDPS32",17,0)
 . S LST($$NXT)="~Route" D IVROUTE
"RTN","ORWDPS32",18,0)
 ;
"RTN","ORWDPS32",19,0)
 S LST($$NXT)="~ShortList"  D SHORT      ; Unit Dose & Outpt
"RTN","ORWDPS32",20,0)
 ;S LST($$NXT)="~Schedules"  D SCHED(LOCIEN)
"RTN","ORWDPS32",21,0)
 S LST($$NXT)="~Priorities" D PRIOR
"RTN","ORWDPS32",22,0)
 I PSTYPE="O" D                          ; Outpt
"RTN","ORWDPS32",23,0)
 . S LST($$NXT)="~Pickup"   D PICKUP
"RTN","ORWDPS32",24,0)
 . S LST($$NXT)="~SCStatus" D SCLIST
"RTN","ORWDPS32",25,0)
 Q
"RTN","ORWDPS32",26,0)
SHORT ; from DLGSLCT, get short list of med quick orders
"RTN","ORWDPS32",27,0)
 ; !!! change this so that it uses the ORWDXQ call!!!
"RTN","ORWDPS32",28,0)
 N I,X,TMP
"RTN","ORWDPS32",29,0)
 I PSTYPE="U" S X="UD RX"
"RTN","ORWDPS32",30,0)
 I PSTYPE="F" S X="IV RX"
"RTN","ORWDPS32",31,0)
 I PSTYPE="O" S X="O RX"
"RTN","ORWDPS32",32,0)
 D GETQLST^ORWDXQ(.TMP,X,"iQ")
"RTN","ORWDPS32",33,0)
 S I=0 F  S I=$O(TMP(I)) Q:'I  S LST($$NXT)=TMP(I)
"RTN","ORWDPS32",34,0)
 Q
"RTN","ORWDPS32",35,0)
SCHEDA ; (similar to SCHED, but also rtns admin times)
"RTN","ORWDPS32",36,0)
 N X,IEN,SCH,TIME
"RTN","ORWDPS32",37,0)
 K ^TMP($J,"ORWDPS32 SCHEDA")
"RTN","ORWDPS32",38,0)
 D AP^PSS51P1("PSJ",,,,"ORWDPS32 SCHEDA")
"RTN","ORWDPS32",39,0)
 S SCH="" F  S SCH=$O(^TMP($J,"ORWDPS32 SCHEDA","APPSJ",SCH)) Q:SCH=""  D
"RTN","ORWDPS32",40,0)
 .S IEN="" F  S IEN=$O(^TMP($J,"ORWDPS32 SCHEDA","APPSJ",SCH,IEN)) Q:IEN'>0  D
"RTN","ORWDPS32",41,0)
 ..S TIME=$G(^TMP($J,"ORWDPS32 SCHEDA",IEN,1))
"RTN","ORWDPS32",42,0)
 ..S X=$S($L(TIME):"  ("_TIME_")",1:"")
"RTN","ORWDPS32",43,0)
 ..S LST($$NXT)="i"_IEN_U_SCH_U_X
"RTN","ORWDPS32",44,0)
 K ^TMP($J,"ORWDPS32 SCHEDA")
"RTN","ORWDPS32",45,0)
 Q
"RTN","ORWDPS32",46,0)
 ;
"RTN","ORWDPS32",47,0)
IVROUTE ;
"RTN","ORWDPS32",48,0)
 N ABB,EXP,IEN,RTE
"RTN","ORWDPS32",49,0)
 K ^TMP($J,"ORWDPS32 IVROUTE")
"RTN","ORWDPS32",50,0)
 D ALL^PSS51P2(,"??",,1,"ORWDPS32 IVROUTE")
"RTN","ORWDPS32",51,0)
 S RTE="" F  S RTE=$O(^TMP($J,"ORWDPS32 IVROUTE","B",RTE)) Q:RTE=""  D
"RTN","ORWDPS32",52,0)
 .S IEN=$O(^TMP($J,"ORWDPS32 IVROUTE","IV",RTE,"")) Q:IEN'>0
"RTN","ORWDPS32",53,0)
 .S ABB=$G(^TMP($J,"ORWDPS32 IVROUTE",IEN,1))
"RTN","ORWDPS32",54,0)
 .S EXP=$G(^TMP($J,"ORWDPS32 IVROUTE",IEN,4))
"RTN","ORWDPS32",55,0)
 .S LST($$NXT)="i"_IEN_U_RTE_U_ABB_U_EXP
"RTN","ORWDPS32",56,0)
 K ^TMP($J,"ORWDPS32 IVROUTE")
"RTN","ORWDPS32",57,0)
 Q
"RTN","ORWDPS32",58,0)
 ;
"RTN","ORWDPS32",59,0)
ALLIVRTE(LST) ;
"RTN","ORWDPS32",60,0)
 N ABB,CNT,EXP,IEN,RTE
"RTN","ORWDPS32",61,0)
 K ^TMP($J,"ORWDPS32 ALLIVRTE")
"RTN","ORWDPS32",62,0)
 S CNT=0
"RTN","ORWDPS32",63,0)
 D ALL^PSS51P2(,"??",,1,"ORWDPS32 ALLIVRTE")
"RTN","ORWDPS32",64,0)
 S RTE="" F  S RTE=$O(^TMP($J,"ORWDPS32 ALLIVRTE","B",RTE)) Q:RTE=""  D
"RTN","ORWDPS32",65,0)
 .S IEN=$O(^TMP($J,"ORWDPS32 ALLIVRTE","IV",RTE,"")) Q:IEN'>0
"RTN","ORWDPS32",66,0)
 .S ABB=$G(^TMP($J,"ORWDPS32 ALLIVRTE",IEN,1))
"RTN","ORWDPS32",67,0)
 .S EXP=$G(^TMP($J,"ORWDPS32 ALLIVRTE",IEN,4))
"RTN","ORWDPS32",68,0)
 .S CNT=CNT+1,LST(CNT)=IEN_U_RTE_U_ABB_U_U_U_U
"RTN","ORWDPS32",69,0)
 K ^TMP($J,"ORWDPS32 IVROUTE")
"RTN","ORWDPS32",70,0)
 Q
"RTN","ORWDPS32",71,0)
 ;
"RTN","ORWDPS32",72,0)
ROUTE ; from OISLCT^ORWDPS32, get list of routes for the drug form
"RTN","ORWDPS32",73,0)
 ; ** NEED BOTH ABBREVIATION & NAME IN LIST BOX
"RTN","ORWDPS32",74,0)
 N I,CNT,ABBR,IEN,ROUT,X
"RTN","ORWDPS32",75,0)
 S I="" F  S I=$O(^TMP("PSJMR",$J,I)) Q:I=""  D
"RTN","ORWDPS32",76,0)
 . S ROUT=$P(^TMP("PSJMR",$J,I),U),ABBR=$P(^(I),U,2),IEN=$P(^(I),U,3)
"RTN","ORWDPS32",77,0)
 . S LST($$NXT)="i"_IEN_U_ROUT_U_ABBR
"RTN","ORWDPS32",78,0)
 . I I=1,IEN S LST($$NXT)="d"_IEN_U_ROUT ;_U_ABBR ; assume first always default
"RTN","ORWDPS32",79,0)
 S I="" F  S I=$O(^TMP("PSJMR",$J,I)) Q:I=""  D
"RTN","ORWDPS32",80,0)
 . S ROUT=$P(^TMP("PSJMR",$J,I),U),ABBR=$P(^(I),U,2),IEN=$P(^(I),U,3)
"RTN","ORWDPS32",81,0)
 . I $L(ABBR),(ABBR'=ROUT) S LST($$NXT)="i"_IEN_U_ABBR_" ("_ROUT_")"_U_ABBR
"RTN","ORWDPS32",82,0)
 Q
"RTN","ORWDPS32",83,0)
 ;similar to SCHED^ORWDPS32, also returns Admin Time for Patient ward location
"RTN","ORWDPS32",84,0)
 ;AGP CPRS 27.72 THIS CODE IS NOT NEEDED ANYMORE
"RTN","ORWDPS32",85,0)
SCHED(LOCIEN) ;
"RTN","ORWDPS32",86,0)
 N CNT,ORARRAY,SCH,IEN,EXP,TIME,TYP,X0,WIEN
"RTN","ORWDPS32",87,0)
 ;K ^TMP($J,"ORWDPS32 SCHED1")
"RTN","ORWDPS32",88,0)
 S WIEN=$$WARDIEN(+LOCIEN)
"RTN","ORWDPS32",89,0)
 D SCHED^PSS51P1(WIEN,.ORARRAY)
"RTN","ORWDPS32",90,0)
 S CNT=0 F  S CNT=$O(ORARRAY(CNT)) Q:CNT'>0  D
"RTN","ORWDPS32",91,0)
 .S LST($$NXT)="i"_$P(ORARRAY(CNT),U,2,5)
"RTN","ORWDPS32",92,0)
 Q
"RTN","ORWDPS32",93,0)
 ;
"RTN","ORWDPS32",94,0)
WARDIEN(LOCIEN) ;
"RTN","ORWDPS32",95,0)
 N RESULT
"RTN","ORWDPS32",96,0)
 S RESULT=0
"RTN","ORWDPS32",97,0)
 I LOCIEN=0 Q RESULT
"RTN","ORWDPS32",98,0)
 I $P($G(^SC(LOCIEN,42)),U)="" Q RESULT
"RTN","ORWDPS32",99,0)
 S RESULT=+$P($G(^SC(LOCIEN,42)),U)
"RTN","ORWDPS32",100,0)
 Q RESULT
"RTN","ORWDPS32",101,0)
PRIOR ; from DLGSLCT, get list of allowed priorities
"RTN","ORWDPS32",102,0)
 N X,XREF
"RTN","ORWDPS32",103,0)
 S XREF=$S(PSTYPE="O":"S.PSO",1:"S.PSJ")
"RTN","ORWDPS32",104,0)
 S X="" F  S X=$O(^ORD(101.42,XREF,X)) Q:'$L(X)  D
"RTN","ORWDPS32",105,0)
 . S LST($$NXT)="i"_$O(^ORD(101.42,XREF,X,0))_U_X
"RTN","ORWDPS32",106,0)
 S LST($$NXT)="d"_$O(^ORD(101.42,"B","ROUTINE",0))_U_"ROUTINE"
"RTN","ORWDPS32",107,0)
 Q
"RTN","ORWDPS32",108,0)
PICKUP ; from DLGSLCT, get prescription routing
"RTN","ORWDPS32",109,0)
 N X,EDITONLY
"RTN","ORWDPS32",110,0)
 F X="W^at Window","M^by Mail","C^in Clinic" S LST($$NXT)="i"_X
"RTN","ORWDPS32",111,0)
 S X=$$DEFPICK I $L(X) S LST($$NXT)="d"_X
"RTN","ORWDPS32",112,0)
 Q
"RTN","ORWDPS32",113,0)
DEFPICK()       ; ret def routing
"RTN","ORWDPS32",114,0)
 N X,DLG,PRMT
"RTN","ORWDPS32",115,0)
 S DLG=$O(^ORD(101.41,"AB","PSO OERR",0)),X=""
"RTN","ORWDPS32",116,0)
 S PRMT=$O(^ORD(101.41,"AB","OR GTX ROUTING",0))
"RTN","ORWDPS32",117,0)
 I $D(^TMP("ORECALL",$J,+DLG,+PRMT,1)) S X=^(1)
"RTN","ORWDPS32",118,0)
 I X'="" S EDITONLY=1 Q X  ; EDITONLY used by def action
"RTN","ORWDPS32",119,0)
 ;
"RTN","ORWDPS32",120,0)
 S X=$$GET^XPAR("ALL","ORWDPS ROUTING DEFAULT",1,"I")
"RTN","ORWDPS32",121,0)
 I X="C" S X="C^in Clinic" G XPICK
"RTN","ORWDPS32",122,0)
 I X="M" S X="M^by Mail"   G XPICK
"RTN","ORWDPS32",123,0)
 I X="W" S X="W^at Window" G XPICK
"RTN","ORWDPS32",124,0)
 I X="N" S X=""             G XPICK
"RTN","ORWDPS32",125,0)
 I X=""  S X=$S($D(^PSX(550,"C")):"M^by Mail",1:"W^at Window")
"RTN","ORWDPS32",126,0)
XPICK Q X
"RTN","ORWDPS32",127,0)
 ;
"RTN","ORWDPS32",128,0)
SCLIST ; from DLGSLCT, get options for service connected
"RTN","ORWDPS32",129,0)
 F X="0^No","1^Yes" S LST($$NXT)="i"_X
"RTN","ORWDPS32",130,0)
 Q
"RTN","ORWDPS32",131,0)
 ;
"RTN","ORWDPS32",132,0)
OISLCT(LST,OI,PSTYPE,ORVP) ; rtn for defaults for pharm OI
"RTN","ORWDPS32",133,0)
 N ILST S ILST=0
"RTN","ORWDPS32",134,0)
 K ^TMP("PSJINS",$J),^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),^TMP("PSJSCH",$J)
"RTN","ORWDPS32",135,0)
 S LST($$NXT)="~Dispense" D DISPDRG
"RTN","ORWDPS32",136,0)
 S LST($$NXT)="~Instruct" D INSTRCT
"RTN","ORWDPS32",137,0)
 S LST($$NXT)="~Route"    D ROUTE
"RTN","ORWDPS32",138,0)
 S LST($$NXT)="~Message"  D MESSAGE
"RTN","ORWDPS32",139,0)
 I $L($G(^TMP("PSJSCH",$J))) S LST($$NXT)="~DefSched",LST($$NXT)="d"_^($J)
"RTN","ORWDPS32",140,0)
 K ^TMP("PSJINS",$J),^TMP("PSJMR",$J),^TMP("PSJNOUN",$J),^TMP("PSJSCH",$J)
"RTN","ORWDPS32",141,0)
 Q
"RTN","ORWDPS32",142,0)
 ;
"RTN","ORWDPS32",143,0)
DISPDRUG(LST,OI) ; list dispense drugs for an OI
"RTN","ORWDPS32",144,0)
 N ILST,PSTYPE S ILST=0,PSTYPE="U" D DISPDRG
"RTN","ORWDPS32",145,0)
 Q
"RTN","ORWDPS32",146,0)
 ;
"RTN","ORWDPS32",147,0)
DISPDRG ; from OISLCT, get disp drugs for this pharm OI
"RTN","ORWDPS32",148,0)
 N I,ORTMP,ORX
"RTN","ORWDPS32",149,0)
 S ORX=$T(ENDD^PSJORUTL),ORX=$L($P(ORX,";"),",")
"RTN","ORWDPS32",150,0)
 I ORX>3 D ENDD^PSJORUTL("^^^"_+$P($G(^ORD(101.43,OI,0)),"^",2),PSTYPE,.ORTMP,+ORVP)
"RTN","ORWDPS32",151,0)
 I ORX'>3 D ENDD^PSJORUTL("^^^"_+$P($G(^ORD(101.43,OI,0)),"^",2),PSTYPE,.ORTMP)
"RTN","ORWDPS32",152,0)
 S I="" F  S I=$O(ORTMP(I)) Q:I=""  D
"RTN","ORWDPS32",153,0)
 . I $P(ORTMP(I),U,4)="1" S $P(ORTMP(I),U,4)="NF"
"RTN","ORWDPS32",154,0)
 . S $P(ORTMP(I),U,3)="$"_$P(ORTMP(I),U,3)_" per "_$P(ORTMP(I),U,5)
"RTN","ORWDPS32",155,0)
 . S LST($$NXT)="i"_ORTMP(I)
"RTN","ORWDPS32",156,0)
 Q
"RTN","ORWDPS32",157,0)
INSTRCT ; from OISLCT, get list of potential instructs (based on drug form)
"RTN","ORWDPS32",158,0)
 N INOUN,NOUN,IINS,INS,VERB,INSREC
"RTN","ORWDPS32",159,0)
 D START^PSSJORDF(+$P(^ORD(101.43,OI,0),U,2))
"RTN","ORWDPS32",160,0)
 I PSTYPE="U" Q  ; don't use the instructions list for inpatients
"RTN","ORWDPS32",161,0)
 S IINS=0 F  S IINS=$O(^TMP("PSJINS",$J,IINS)) Q:'IINS  D
"RTN","ORWDPS32",162,0)
 . S INSREC=$G(^TMP("PSJINS",$J,IINS))
"RTN","ORWDPS32",163,0)
 . I '$D(VERB) S VERB=$P(INSREC,U)
"RTN","ORWDPS32",164,0)
 . I $L($P(INSREC,U,2)) S LST($$NXT)="i"_$P(INSREC,U,2)
"RTN","ORWDPS32",165,0)
 S LST($$NXT)="~Nouns"
"RTN","ORWDPS32",166,0)
 S INOUN=0 F  S INOUN=$O(^TMP("PSJNOUN",$J,INOUN)) Q:'INOUN  D
"RTN","ORWDPS32",167,0)
 . S LST($$NXT)="i"_$P(^TMP("PSJNOUN",$J,INOUN),U)
"RTN","ORWDPS32",168,0)
 I $D(VERB) S LST($$NXT)="~Verb",LST($$NXT)="d"_VERB
"RTN","ORWDPS32",169,0)
 ;
"RTN","ORWDPS32",170,0)
 Q
"RTN","ORWDPS32",171,0)
MIXED(X)   ; Return mixed case
"RTN","ORWDPS32",172,0)
 Q X
"RTN","ORWDPS32",173,0)
 ;
"RTN","ORWDPS32",174,0)
MESSAGE ; message
"RTN","ORWDPS32",175,0)
 S I=0 F  S I=$O(^ORD(101.43,OI,8,I)) Q:I'>0  S LST($$NXT)="t"_^(I,0)
"RTN","ORWDPS32",176,0)
 Q
"RTN","ORWDPS32",177,0)
ALLROUTE(LST) ; returns a list of all available med routes
"RTN","ORWDPS32",178,0)
 N I,X,ILST
"RTN","ORWDPS32",179,0)
 S ILST=0
"RTN","ORWDPS32",180,0)
 K ^TMP($J,"ORWDPS32 ALLROUTE")
"RTN","ORWDPS32",181,0)
 D ALL^PSS51P2(,"??",,,"ORWDPS32 ALLROUTE")
"RTN","ORWDPS32",182,0)
 S I=0 F  S I=$O(^TMP($J,"ORWDPS32 ALLROUTE",I)) Q:'I  D
"RTN","ORWDPS32",183,0)
 . I +$P(^TMP($J,"ORWDPS32 ALLROUTE",I,3),U)>0 S LST($$NXT)=I_U_^TMP($J,"ORWDPS32 ALLROUTE",I,.01)_U_^TMP($J,"ORWDPS32 ALLROUTE",I,1)
"RTN","ORWDPS32",184,0)
 K ^TMP($J,"ORWDPS32 ALLROUTE")
"RTN","ORWDPS32",185,0)
 Q
"RTN","ORWDPS32",186,0)
VALROUTE(REC,X)        ; validates route name & returns IEN + abbreviation
"RTN","ORWDPS32",187,0)
 N ABBR,NAME,IEN
"RTN","ORWDPS32",188,0)
 K ^TMP($J,"ORWDPS32 VALROUTE")
"RTN","ORWDPS32",189,0)
 S X=$$UPPER(X)
"RTN","ORWDPS32",190,0)
 D ALL^PSS51P2(,X,,1,"ORWDPS32 VALROUTE")
"RTN","ORWDPS32",191,0)
 I $P(^TMP($J,"ORWDPS32 VALROUTE",0),U)=-1 K ^TMP($J,"ORWDPS32 VALROUTE") S REC=0 Q
"RTN","ORWDPS32",192,0)
 S IEN=$O(^TMP($J,"ORWDPS32 VALROUTE","B",X,""))
"RTN","ORWDPS32",193,0)
 I IEN'>0 S IEN=$O(^TMP($J,"ORWDPS32 VALROUTE","C",X,""))
"RTN","ORWDPS32",194,0)
 I IEN'>0 S REC=0 Q
"RTN","ORWDPS32",195,0)
 S NAME=$G(^TMP($J,"ORWDPS32 VALROUTE",IEN,.01))
"RTN","ORWDPS32",196,0)
 S ABBR=$G(^TMP($J,"ORWDPS32 VALROUTE",IEN,1))
"RTN","ORWDPS32",197,0)
 I '$L(ABBR) S ABBR=NAME
"RTN","ORWDPS32",198,0)
 I ($$UPPER(NAME)'=X),($$UPPER(ABBR)'=X) S REC=0 K ^TMP($J,"ORWDPS32 VALROUTE") Q
"RTN","ORWDPS32",199,0)
 S REC=IEN_U_ABBR
"RTN","ORWDPS32",200,0)
 K ^TMP($J,"ORWDPS32 VALROUTE")
"RTN","ORWDPS32",201,0)
 Q
"RTN","ORWDPS32",202,0)
AUTH(VAL,PRV,ORDLOG) ; For inpatient meds, check restrictions
"RTN","ORWDPS32",203,0)
 N NAME,AUTH,INACT,X,ORSDLOG,ORDL,A,IFN S VAL=0
"RTN","ORWDPS32",204,0)
 S NAME=$P($G(^VA(200,PRV,20)),U,2) S:'$L(NAME) NAME=$P(^(0),U)
"RTN","ORWDPS32",205,0)
 S X=$G(^VA(200,PRV,"PS")),AUTH=$P(X,U),INACT=$P(X,U,4)
"RTN","ORWDPS32",206,0)
 S ORDLOG=$G(ORDLOG),ORDL=""
"RTN","ORWDPS32",207,0)
 I ORDLOG?1"X".E S IFN=$E(ORDLOG,2,99),A=$P($G(^OR(100,+IFN,0)),"^",5) I $P(A,";",2)'=101.41 S ORDLOG=""
"RTN","ORWDPS32",208,0)
 I ORDLOG]"" S A=$P($G(^ORD(101.41,ORDLOG,0)),"^",5) I A]"" S ORDL=$P($G(^ORD(100.98,A,0)),"^",4)
"RTN","ORWDPS32",209,0)
 S ORSDLOG=$O(^ORD(101.41,"B","PSO SUPPLY",""))
"RTN","ORWDPS32",210,0)
 I 'AUTH!(INACT&(DT>INACT)) D  Q
"RTN","ORWDPS32",211,0)
 . I $G(ORDL)=ORSDLOG,$D(^XUSEC("ORSUPPLY",DUZ)) Q
"RTN","ORWDPS32",212,0)
 . S VAL="1^"_NAME_" is not authorized to write medication orders."
"RTN","ORWDPS32",213,0)
 I $D(^XUSEC("OREMAS",DUZ)),'$$GET^XPAR("ALL","OR OREMAS MED ORDERS") D  Q
"RTN","ORWDPS32",214,0)
 . S VAL="1^OREMAS key holders may not enter medication orders."
"RTN","ORWDPS32",215,0)
 Q
"RTN","ORWDPS32",216,0)
 ;
"RTN","ORWDPS32",217,0)
AUTHNVA(VAL,PRV) ; For Non-VA meds, check restrictions
"RTN","ORWDPS32",218,0)
 N NAME,AUTH,INACT,X S VAL=0
"RTN","ORWDPS32",219,0)
 I $D(^XUSEC("OREMAS",DUZ)),$$GET^XPAR("ALL","OR OREMAS NON-VA MED ORDERS")=2 Q
"RTN","ORWDPS32",220,0)
 I $D(^XUSEC("OREMAS",DUZ)),'$$GET^XPAR("ALL","OR OREMAS NON-VA MED ORDERS") D  Q
"RTN","ORWDPS32",221,0)
 . S VAL="1^OREMAS key holders may not enter non-VA medication orders."
"RTN","ORWDPS32",222,0)
 S NAME=$P($G(^VA(200,PRV,20)),U,2) S:'$L(NAME) NAME=$P(^(0),U)
"RTN","ORWDPS32",223,0)
 S X=$G(^VA(200,PRV,"PS")),AUTH=$P(X,U),INACT=$P(X,U,4)
"RTN","ORWDPS32",224,0)
 I 'AUTH!(INACT&(DT>INACT)) D  Q
"RTN","ORWDPS32",225,0)
 . S VAL="1^"_NAME_" is not authorized to write medication orders."
"RTN","ORWDPS32",226,0)
 Q
"RTN","ORWDPS32",227,0)
 ;
"RTN","ORWDPS32",228,0)
UPPER(X)        ; return uppercase
"RTN","ORWDPS32",229,0)
 Q $TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","ORWDPS32",230,0)
 ;
"RTN","ORWDPS32",231,0)
TRIM(X) ; trim leading and trailing spaces
"RTN","ORWDPS32",232,0)
 S X=$RE(X) F  S:$E(X)=" " X=$E(X,2,999) Q:$E(X)'=" "  Q:'$L(X)  ;trail
"RTN","ORWDPS32",233,0)
 S X=$RE(X) F  S:$E(X)=" " X=$E(X,2,999) Q:$E(X)'=" "  Q:'$L(X)  ;lead
"RTN","ORWDPS32",234,0)
 Q X
"RTN","ORWDPS32",235,0)
 ;
"RTN","ORWDPS33")
0^66^B41340191
"RTN","ORWDPS33",1,0)
ORWDPS33 ; SLC/KCM - Pharmacy Calls for GUI Dialog ;08/31/15  10:48
"RTN","ORWDPS33",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**243,280,350**;Dec 17, 1997;Build 77
"RTN","ORWDPS33",3,0)
 ;Per VHA Directive 6402, this routine should not be modified.
"RTN","ORWDPS33",4,0)
 ;This routine move several RPCs from ORWDPS32 because of the routine size
"RTN","ORWDPS33",5,0)
 ;
"RTN","ORWDPS33",6,0)
COMPLOC(ORY,ORID,LOC) ;
"RTN","ORWDPS33",7,0)
 S ORY=0
"RTN","ORWDPS33",8,0)
 I LOC'=+$P($G(^OR(100,+ORID,0)),U,10) S ORY=1
"RTN","ORWDPS33",9,0)
 Q
"RTN","ORWDPS33",10,0)
DOSES(LST,OI) ; return doses for an orderable item  -  TEST ONLY
"RTN","ORWDPS33",11,0)
 N ORTMP,ORI,ORJ,ILST,LTSA,NDF,ORWDRG,VAPN,X,PSTYPE S PSTYPE="O"
"RTN","ORWDPS33",12,0)
 D ENDD^PSJORUTL("^^^"_+$P($G(^ORD(101.43,OI,0)),"^",2),PSTYPE,.ORTMP)
"RTN","ORWDPS33",13,0)
 S ORI=0 F  S ORI=$O(ORTMP(ORI)) Q:'ORI  S ORWDRG=+ORTMP(ORI) D
"RTN","ORWDPS33",14,0)
 . K ^TMP($J,"ORWDPS32 DRUG")
"RTN","ORWDPS33",15,0)
 . D NDF^PSS50(+ORWDRG,,,,,"ORWDPS32 DRUG")
"RTN","ORWDPS33",16,0)
 . S VAPN=$P($G(^TMP($J,"ORWDPS32 DRUG",+ORWDRG,22)),U),NDF=$P($G(^TMP($J,"ORWDPS32 DRUG",+ORWDRG,20)),U)
"RTN","ORWDPS33",17,0)
 . S X=$$DFSU^PSNAPIS(NDF,VAPN)
"RTN","ORWDPS33",18,0)
 . S LSTA($P(X,U,4),$P(X,U,6))=""
"RTN","ORWDPS33",19,0)
 . I +$P(X,U,4)=$P(X,U,4) S LSTA($P(X,U,4)*2,$P(X,U,6))=""
"RTN","ORWDPS33",20,0)
 K ^TMP($J,"ORWDPS32 DRUG")
"RTN","ORWDPS33",21,0)
 S ORI="",ILST=0 F  S ORI=$O(LSTA(ORI)) Q:ORI=""  D
"RTN","ORWDPS33",22,0)
 . S ORJ="" F  S ORJ=$O(LSTA(ORI,ORJ)) Q:ORJ=""  D
"RTN","ORWDPS33",23,0)
 . . S ILST=ILST+1,LST(ILST)=ORI_" "_ORJ
"RTN","ORWDPS33",24,0)
 Q
"RTN","ORWDPS33",25,0)
 ;
"RTN","ORWDPS33",26,0)
DRUGMSG(VAL,IEN)        ; return any message associated with a dispense drug
"RTN","ORWDPS33",27,0)
 N X S X=$$ENDCM^PSJORUTL(IEN)
"RTN","ORWDPS33",28,0)
 S VAL=$P(X,U,2)_U_$P(X,U,4)
"RTN","ORWDPS33",29,0)
 Q
"RTN","ORWDPS33",30,0)
 ;
"RTN","ORWDPS33",31,0)
FORMALT(ORLST,IEN,PSTYPE) ; return a list of formulary alternatives
"RTN","ORWDPS33",32,0)
 D ENRFA^PSJORUTL(IEN,PSTYPE,.ORLST)
"RTN","ORWDPS33",33,0)
 S I=0 F  S I=$O(ORLST(I)) Q:'I  D
"RTN","ORWDPS33",34,0)
 . S OI=+$O(^ORD(101.43,"ID",+$P(ORLST(I),U,4)_";99PSP",0))
"RTN","ORWDPS33",35,0)
 . S $P(ORLST(I),U,4)=OI I OI S $P(ORLST(I),U,5)=$P(^ORD(101.43,OI,0),U)
"RTN","ORWDPS33",36,0)
 Q
"RTN","ORWDPS33",37,0)
 ;
"RTN","ORWDPS33",38,0)
GETADDFR(ORY,OIIEN) ;
"RTN","ORWDPS33",39,0)
 N PSOI,TEMP
"RTN","ORWDPS33",40,0)
 S ORY=""
"RTN","ORWDPS33",41,0)
 S PSOI=+$P($G(^ORD(101.43,OIIEN,0)),U,2)
"RTN","ORWDPS33",42,0)
 S TEMP=$$IV^PSSDSAPA(PSOI)
"RTN","ORWDPS33",43,0)
 S ORY=$$ADDFRQCV^ORMBLDP1(TEMP,"I")
"RTN","ORWDPS33",44,0)
 Q
"RTN","ORWDPS33",45,0)
 ;
"RTN","ORWDPS33",46,0)
ISVALIV(RESULT,ORID,ACTION) ;
"RTN","ORWDPS33",47,0)
 N ARRAY,CNT,ID,IVD,CLIVD,NUM,ORDERID,OUTPUT,ROUTE,ROUTEID,TYPE
"RTN","ORWDPS33",48,0)
 S TYPE=$S(ACTION="XFR":"transfered",ACTION="RN":"renewed",1:"copied")
"RTN","ORWDPS33",49,0)
 S IVD=$O(^ORD(101.41,"B","PSJI OR PAT FLUID OE",""))
"RTN","ORWDPS33",50,0)
 S CLIVD=$O(^ORD(101.41,"B","CLINIC OR PAT FLUID OE",""))
"RTN","ORWDPS33",51,0)
 I IVD=0,CLIVD=0 Q
"RTN","ORWDPS33",52,0)
 I +$P($G(^OR(100,+ORID,0)),U,5)'=IVD,+$P($G(^OR(100,+ORID,0)),U,5)'=CLIVD Q
"RTN","ORWDPS33",53,0)
 S ORDERID="",ROUTEID="",CNT=0
"RTN","ORWDPS33",54,0)
 F  S ORDERID=$O(^OR(100,+ORID,4.5,"ID","ORDERABLE",ORDERID)) Q:ORDERID'>0  D
"RTN","ORWDPS33",55,0)
 .I +$G(^OR(100,+ORID,4.5,ORDERID,1))'>0 Q
"RTN","ORWDPS33",56,0)
 .S CNT=CNT+1,ARRAY(CNT)=^OR(100,+ORID,4.5,ORDERID,1)
"RTN","ORWDPS33",57,0)
 S ROUTEID=+$O(^OR(100,+ORID,4.5,"ID","ROUTE","")) I ROUTEID'>0 D  Q
"RTN","ORWDPS33",58,0)
 .S RESULT="This order contains an invalid route. It cannot be "_TYPE_"."
"RTN","ORWDPS33",59,0)
 S ROUTE=+$G(^OR(100,+ORID,4.5,ROUTEID,1)) I ROUTE'>0 D  Q
"RTN","ORWDPS33",60,0)
 .S RESULT="This order contains an invalid route. It cannot be "_TYPE_"."
"RTN","ORWDPS33",61,0)
 S OUTPUT=$$IVQOVAL(.ARRAY,ROUTE) I OUTPUT="" D
"RTN","ORWDPS33",62,0)
 .;S TYPE=$S(ACTION="XFR":"transfered",ACTION="RN":"renewed",1:"copied")
"RTN","ORWDPS33",63,0)
 .S RESULT="This order contains an invalid route. It cannot be "_TYPE_"."
"RTN","ORWDPS33",64,0)
 I RESULT'="" Q
"RTN","ORWDPS33",65,0)
 N IVTYPE,IVTYPEID,INFUSEID,INFUSE
"RTN","ORWDPS33",66,0)
 S IVTYPEID=+$O(^OR(100,+ORID,4.5,"ID","TYPE","")) I IVTYPEID'>0 D  Q
"RTN","ORWDPS33",67,0)
 .S RESULT="This order contains an  invalid IV Type. It cannot be "_TYPE_"."
"RTN","ORWDPS33",68,0)
 S IVTYPE=$G(^OR(100,+ORID,4.5,IVTYPEID,1)) I IVTYPE="" D  Q
"RTN","ORWDPS33",69,0)
 .S RESULT="This order contains an invalid IV Type. It cannot be "_TYPE_"."
"RTN","ORWDPS33",70,0)
 S INFUSEID=+$O(^OR(100,+ORID,4.5,"ID","RATE","")) Q:INFUSEID'>0
"RTN","ORWDPS33",71,0)
 S INFUSE=$G(^OR(100,+ORID,4.5,INFUSEID,1)) Q:INFUSE=""
"RTN","ORWDPS33",72,0)
 I $$VALINF^ORWDXM3(IVTYPE,INFUSE)=0 D
"RTN","ORWDPS33",73,0)
 .;S TYPE=$S(ACTION="XFR":"transfered",ACTION="RN":"renewed",1:"copied")
"RTN","ORWDPS33",74,0)
 .S RESULT="This order contains an invalid infusion rate. It cannot be "_TYPE_"."
"RTN","ORWDPS33",75,0)
 ;//AGP IV ADDITIVE FREQUENCY
"RTN","ORWDPS33",76,0)
 I IVTYPE="C",ACTION="RN" D
"RTN","ORWDPS33",77,0)
 .N ADDCNT,ADDIEN,ADDFCNT,SUB
"RTN","ORWDPS33",78,0)
 .S ADDIEN=$$PTR^ORCD("OR GTX ADDITIVE")
"RTN","ORWDPS33",79,0)
 .S ADDCNT=0,ADDFCNT=0,SUB=0
"RTN","ORWDPS33",80,0)
 .F  S SUB=$O(^OR(100,+ORID,4.5,"ID","ORDERABLE",SUB)) Q:SUB'>0  D
"RTN","ORWDPS33",81,0)
 ..I $P($G(^OR(100,+ORID,4.5,SUB,0)),U,2)'=ADDIEN Q
"RTN","ORWDPS33",82,0)
 ..S ADDCNT=ADDCNT+1
"RTN","ORWDPS33",83,0)
 .S SUB=0
"RTN","ORWDPS33",84,0)
 .F  S SUB=$O(^OR(100,+ORID,4.5,"ID","ADDFREQ",SUB)) Q:SUB'>0  S ADDFCNT=ADDFCNT+1
"RTN","ORWDPS33",85,0)
 .I ADDCNT'=ADDFCNT S RESULT="This order does not contain the same number of values for the Additives and the IV Additive Frequency prompts. It cannot be renewed."
"RTN","ORWDPS33",86,0)
 Q
"RTN","ORWDPS33",87,0)
 ;
"RTN","ORWDPS33",88,0)
IVQOVAL(ARRAY,ROUTE) ;
"RTN","ORWDPS33",89,0)
 N CNT,RARR,RESULT
"RTN","ORWDPS33",90,0)
 S RESULT=""
"RTN","ORWDPS33",91,0)
 D IVDOSFRM(.RARR,.ARRAY,1)
"RTN","ORWDPS33",92,0)
 S CNT="" F  S CNT=$O(RARR(CNT)) Q:CNT'>0!(RESULT'="")  D
"RTN","ORWDPS33",93,0)
 .I $P(RARR(CNT),U)=ROUTE S RESULT=RARR(CNT) Q
"RTN","ORWDPS33",94,0)
 Q RESULT
"RTN","ORWDPS33",95,0)
 ;
"RTN","ORWDPS33",96,0)
IVDOSFRM(LST,ORDERIDS,ALLIV) ;
"RTN","ORWDPS33",97,0)
 N ORARRAY,CNT,CNT1,OI,POI
"RTN","ORWDPS33",98,0)
 S OI="",CNT=0,CNT1=0
"RTN","ORWDPS33",99,0)
 F  S OI=$O(ORDERIDS(OI)) Q:OI'>0  D
"RTN","ORWDPS33",100,0)
 .S POI=+$P($G(^ORD(101.43,$G(ORDERIDS(OI)),0)),U,2) Q:POI'>0
"RTN","ORWDPS33",101,0)
 .S CNT=CNT+1
"RTN","ORWDPS33",102,0)
 .S ORARRAY(CNT)=POI
"RTN","ORWDPS33",103,0)
 I CNT=0 Q
"RTN","ORWDPS33",104,0)
 S ORARRAY(0)=CNT
"RTN","ORWDPS33",105,0)
 D START1^PSSJORDF(.ORARRAY,ALLIV)
"RTN","ORWDPS33",106,0)
 S CNT="" F  S CNT=$O(ORARRAY(CNT)) Q:CNT'>0  D
"RTN","ORWDPS33",107,0)
 .S CNT1=CNT1+1,LST(CNT1)=$G(ORARRAY(CNT))
"RTN","ORWDPS33",108,0)
 ;this temp should be killed by Pharmacy. This will be removed once
"RTN","ORWDPS33",109,0)
 ;Pharmacy send an update
"RTN","ORWDPS33",110,0)
 K ^TMP("PSJMR",$J)
"RTN","ORWDPS33",111,0)
 Q
"RTN","ORWDPS33",112,0)
 ;
"RTN","ORWDPS33",113,0)
ISSPLY(VAL,IEN) ; return true if orderable item is a supply
"RTN","ORWDPS33",114,0)
 S VAL=0
"RTN","ORWDPS33",115,0)
 I $P($G(^ORD(101.43,IEN,"PS")),U,5)=1 S VAL=1
"RTN","ORWDPS33",116,0)
 Q
"RTN","ORWDPS33",117,0)
IVAMT(VAL,OI,ORWTYP)     ; return UNITS^AMOUNT |^AMOUNT^AMOUNT...| for IV soln
"RTN","ORWDPS33",118,0)
 N I,PSOI,ORWY,AMT
"RTN","ORWDPS33",119,0)
 S PSOI=+$P($G(^ORD(101.43,OI,0)),U,2)_ORWTYP,VAL=""
"RTN","ORWDPS33",120,0)
 D ENVOL^PSJORUT2(PSOI,.ORWY)
"RTN","ORWDPS33",121,0)
 I ORWTYP="B" D
"RTN","ORWDPS33",122,0)
 . S I=0 F  S I=$O(ORWY(I)) Q:I'>0  S AMT(+ORWY(I))="" D
"RTN","ORWDPS33",123,0)
 . . I ORWY(I)<1 D  ;SBR
"RTN","ORWDPS33",124,0)
 . . . K AMT(+ORWY(I))
"RTN","ORWDPS33",125,0)
 . . . S AMT(0_+ORWY(I))=""
"RTN","ORWDPS33",126,0)
 . S AMT=0,VAL="ML" F  S AMT=$O(AMT(AMT)) Q:AMT'>0  S VAL=VAL_U_AMT
"RTN","ORWDPS33",127,0)
 I ORWTYP="A" D
"RTN","ORWDPS33",128,0)
 . S I=+$O(ORWY(0)) S VAL=$P($G(ORWY(I)),U,2)
"RTN","ORWDPS33",129,0)
 . I '$L(VAL) S VAL="ML^LITER^MCG^MG^GM^UNITS^IU^MEQ^MM^MU^THOUU^MG-PE^NANOGRAM^MMOL"
"RTN","ORWDPS33",130,0)
 Q
"RTN","ORWDPS33",131,0)
 ;
"RTN","ORWDPS33",132,0)
MEDISIV(VAL,IEN)        ; return true if orderable item is IV medication
"RTN","ORWDPS33",133,0)
 S VAL=0
"RTN","ORWDPS33",134,0)
 I $P($G(^ORD(101.43,IEN,"PS")),U)=2 S VAL=1
"RTN","ORWDPS33",135,0)
 Q
"RTN","ORWDPS33",136,0)
 ;
"RTN","ORWDPS33",137,0)
SCSTS(VAL,ORVP,ORDRUG)  ; return service connected eligibility for patient
"RTN","ORWDPS33",138,0)
 N ORWP94 S ORWP94=$O(^ORD(101.41,"AB","PS MEDS",0))>0
"RTN","ORWDPS33",139,0)
 I $L($T(SC^PSOCP)),$$SC^PSOCP(+ORVP,+$G(ORDRUG)) S VAL=0 G XSCSTS
"RTN","ORWDPS33",140,0)
 I 'ORWP94,(+$$RXST^IBARXEU(+ORVP)>0) S VAL=0 G XSCSTS
"RTN","ORWDPS33",141,0)
 S VAL=1
"RTN","ORWDPS33",142,0)
XSCSTS Q
"RTN","ORWDPS33",143,0)
 ;
"RTN","ORWDPS33",144,0)
VALQTY(OK,X)    ; validate a quantity, return 1 if valid, 0 if not
"RTN","ORWDPS33",145,0)
 ; to be compatible with LM, make sure X is integer from 1 to 240
"RTN","ORWDPS33",146,0)
 ; this is based on the input transform from 52,7
"RTN","ORWDPS33",147,0)
 K:(+X'>0)!(+X>99999999)!(X'?.8N.1".".2N)!($L(X)>12) X
"RTN","ORWDPS33",148,0)
 S OK=$S($D(X):1,1:0)
"RTN","ORWDPS33",149,0)
 Q
"RTN","ORWDPS33",150,0)
 ;
"RTN","ORWDPS33",151,0)
VALRATE(VAL,X)   ; return "1" (true) if IV rate text is valid
"RTN","ORWDPS33",152,0)
 I $E($RE($$UPPER^ORWDPS32(X)),1,5)="RH/LM"  S X=$E(X,1,$L(X)-5)
"RTN","ORWDPS33",153,0)
 S X=$$TRIM^ORWDPS32(X)
"RTN","ORWDPS33",154,0)
 D ORINF^PSIVSP S VAL=$G(X) ;S OK=$S($D(X):1,1:0)
"RTN","ORWDPS33",155,0)
 Q
"RTN","ORWDPS33",156,0)
VALSCH(OK,X,PSTYPE)    ; validate a schedule, return 1 if valid, 0 if not
"RTN","ORWDPS33",157,0)
 I '$L($T(EN^PSSGSGUI)) S OK=-1 Q
"RTN","ORWDPS33",158,0)
 I $E($T(EN^PSSGSGUI),1,4)="EN(X" D
"RTN","ORWDPS33",159,0)
 . N ORX S ORX=$G(X) D EN^PSSGSGUI(.ORX,$G(PSTYPE,"I"))
"RTN","ORWDPS33",160,0)
 . K X S:$D(ORX) X=ORX
"RTN","ORWDPS33",161,0)
 E  D
"RTN","ORWDPS33",162,0)
 . D EN^PSSGSGUI
"RTN","ORWDPS33",163,0)
 S OK=$S($D(X):1,1:0)
"RTN","ORWDPS33",164,0)
 Q
"RTN","ORWDPS33",165,0)
 ;
"RTN","ORWDX")
0^16^B70259913
"RTN","ORWDX",1,0)
ORWDX ; SLC/KCM/REV/JLI - Order dialog utilities ;08/31/15  10:52
"RTN","ORWDX",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,125,131,132,141,164,178,187,190,195,215,246,243,283,296,280,306,350**;Dec 17, 1997;Build 77
"RTN","ORWDX",3,0)
 ;Per VHA Directive 6402, this routine should not be modified.
"RTN","ORWDX",4,0)
 ;Reference to DIC(9.4 supported by IA #2058
"RTN","ORWDX",5,0)
 ;
"RTN","ORWDX",6,0)
ORDITM(Y,FROM,DIR,XREF,QOCALL) ; Subset of orderable items
"RTN","ORWDX",7,0)
 ; Y(n)=IEN^.01 Name^.01 Name  -or-  IEN^Synonym <.01 Name>^.01 Name
"RTN","ORWDX",8,0)
 N I,IEN,CNT,X,DTXT,CURTM,DEFROUTE
"RTN","ORWDX",9,0)
 S DEFROUTE=""
"RTN","ORWDX",10,0)
 S QOCALL=+$G(QOCALL)
"RTN","ORWDX",11,0)
 S I=0,CNT=44,CURTM=$$NOW^XLFDT
"RTN","ORWDX",12,0)
 F  Q:I'<CNT  S FROM=$O(^ORD(101.43,XREF,FROM),DIR) Q:FROM=""  D
"RTN","ORWDX",13,0)
 . S IEN="" F  S IEN=$O(^ORD(101.43,XREF,FROM,IEN),DIR) Q:'IEN  D
"RTN","ORWDX",14,0)
 . . S X=^ORD(101.43,XREF,FROM,IEN)
"RTN","ORWDX",15,0)
 . . I +$P(X,U,3),$P(X,U,3)<CURTM Q
"RTN","ORWDX",16,0)
 . . I 'QOCALL,$P(X,U,5) Q
"RTN","ORWDX",17,0)
 . . S I=I+1
"RTN","ORWDX",18,0)
 . . I 'X S Y(I)=IEN_U_$P(X,U,2)_U_$P(X,U,2)
"RTN","ORWDX",19,0)
 . . E  S Y(I)=IEN_U_$P(X,U,2)_$C(9)_"<"_$P(X,U,4)_">"_U_$P(X,U,4)
"RTN","ORWDX",20,0)
 Q
"RTN","ORWDX",21,0)
ODITMBC(Y,XREF,ODLST) ;
"RTN","ORWDX",22,0)
 N CNT,NM,XRF
"RTN","ORWDX",23,0)
 S CNT=0,NM=0,XRF=XREF
"RTN","ORWDX",24,0)
 F  S CNT=$O(ODLST(CNT)) Q:'CNT  D FNDINFO(.Y,ODLST(CNT))
"RTN","ORWDX",25,0)
 Q
"RTN","ORWDX",26,0)
FNDINFO(Y,ODIEN) ;
"RTN","ORWDX",27,0)
 D FNDINFO^ORWDX1(.Y,.ODIEN)
"RTN","ORWDX",28,0)
 Q
"RTN","ORWDX",29,0)
DLGDEF(LST,DLG) ; Format mapping for a dlg
"RTN","ORWDX",30,0)
 D DLGDEF^ORWDX1(.LST,.DLG)
"RTN","ORWDX",31,0)
 Q
"RTN","ORWDX",32,0)
DLGQUIK(LST,QO) ;(NOT USED)
"RTN","ORWDX",33,0)
 D LOADRSP(.LST,QO)
"RTN","ORWDX",34,0)
 Q
"RTN","ORWDX",35,0)
LOADRSP(LST,RSPID,TRANS)      ; Load responses from 101.41 or 100
"RTN","ORWDX",36,0)
 ; RSPID:  C123456;1-3243 = cached copy,   134-3234 = cached quick
"RTN","ORWDX",37,0)
 ;         X123456;1      = change order,  134      = quick dialog
"RTN","ORWDX",38,0)
 N I,J,DLG,INST,ID,VAL,ILST,ROOT,ORLOC S ROOT=""
"RTN","ORWDX",39,0)
 I RSPID["-" S ROOT="^TMP(""ORWDXMQ"",$J,"""_RSPID_""")" G XROOT^ORWDX2
"RTN","ORWDX",40,0)
 I $E(RSPID)="X" S ROOT="^OR(100,"_+$P(RSPID,"X",2)_",4.5)"  G XROOT^ORWDX2
"RTN","ORWDX",41,0)
 I +RSPID=RSPID  S ROOT="^ORD(101.41,"_+RSPID_",6)" G XROOT^ORWDX2
"RTN","ORWDX",42,0)
 Q:ROOT=""
"RTN","ORWDX",43,0)
 G XROOT^ORWDX2
"RTN","ORWDX",44,0)
SAVE(REC,ORVP,ORNP,ORL,DLG,ORDG,ORIT,ORIFN,ORDIALOG,ORDEA,ORAPPT,ORSRC,OREVTDF) ;
"RTN","ORWDX",45,0)
 ; ORVP=DFN, ORNP=Provider, ORL=Location, DLG=Order Dialog,
"RTN","ORWDX",46,0)
 ; ORDG=Display Group, ORIT=Quick Order Dialog, ORAPPT=Appointment
"RTN","ORWDX",47,0)
 N ORDUZ,ORSTS,OREVENT,ORCAT,ORDA,ORTS,ORNEW,ORCHECK,ORLOG,ORLEAD,ORTRAIL,ORPKG,ORWP94,ORCATFN,OREVTYPE,ONPASS
"RTN","ORWDX",48,0)
 N XCNT,XCOMM,XDONE,XX  ;SBR
"RTN","ORWDX",49,0)
 S (XCOMM,XCNT)=""  ;SBR
"RTN","ORWDX",50,0)
 I $G(ORIFN)'="" D  ;SBR problem only occurs on change or renew orders
"RTN","ORWDX",51,0)
 . S XCNT=$O(^OR(100,+ORIFN,4.5,"ID","COMMENT",XCNT))  ;SBR
"RTN","ORWDX",52,0)
 . I XCNT'="" S XCOMM=$P($G(^OR(100,+ORIFN,4.5,XCNT,0)),"^",2)  ;SBR
"RTN","ORWDX",53,0)
 . I XCOMM'="" S XDONE=0,XX="" F  S XX=$O(ORDIALOG("WP",XCOMM,1,XX)) Q:XX=""  D  ;SBR
"RTN","ORWDX",54,0)
 . . I ORDIALOG("WP",XCOMM,1,XX,0)'="" S XDONE=1 Q  ;SBR
"RTN","ORWDX",55,0)
 . I XCOMM'="",'$G(XDONE),$D(ORDIALOG("WP",XCOMM)) K ORDIALOG("WP",XCOMM)  ;SBR
"RTN","ORWDX",56,0)
 S ORCATFN="" I $L($P(DLG,U,2)) S ORCATFN=$P(DLG,U,2),DLG=$P(DLG,U,1)
"RTN","ORWDX",57,0)
 ;Remove treating facility if inpatient and IMO order 26.42
"RTN","ORWDX",58,0)
 I $G(^DPT(ORVP,.1))'="",$P($G(^ORD(100.98,ORDG,0)),U)="CLINIC MEDICATIONS" K ORDIALOG("ORTS")
"RTN","ORWDX",59,0)
 I $G(^DPT(ORVP,.1))'="",$P($G(^ORD(100.98,ORDG,0)),U)="CLINIC INFUSIONS" K ORDIALOG("ORTS")
"RTN","ORWDX",60,0)
 I $G(ORDIALOG("ORTS")) S ORTS=ORDIALOG("ORTS") K ORDIALOG("ORTS")
"RTN","ORWDX",61,0)
 I $G(ORDIALOG("ORSLOG")) S ORLOG=ORDIALOG("ORSLOG") K ORDIALOG("ORSLOG")
"RTN","ORWDX",62,0)
 I $D(ORDIALOG("OREVENT")) S OREVENT=ORDIALOG("OREVENT") K ORDIALOG("OREVENT")
"RTN","ORWDX",63,0)
 ;=====================================================
"RTN","ORWDX",64,0)
 ; Changed for v26.27 (RV)
"RTN","ORWDX",65,0)
 S ORCAT=$$INPT^ORCD,ORCAT=$S(ORCAT=1:"I",1:"O")
"RTN","ORWDX",66,0)
 ;I $L($G(OREVENT)) D
"RTN","ORWDX",67,0)
 ;. S ONPASS=0
"RTN","ORWDX",68,0)
 ;. S OREVTYPE=$$TYPE^OREVNTX(OREVENT)
"RTN","ORWDX",69,0)
 ;. I OREVTYPE="T" D ISPASS^OREVNTX1(.ONPASS,+OREVENT,"T")
"RTN","ORWDX",70,0)
 ;. S ORCAT=$S(OREVTYPE="A":"I",OREVTYPE="T":"I",ONPASS=1:"O",1:"O")
"RTN","ORWDX",71,0)
 ;E  S ORCAT=$S($L($P($G(^DPT(+ORVP,.1)),U)):"I",1:"O")
"RTN","ORWDX",72,0)
 ;=====================================================
"RTN","ORWDX",73,0)
 I DLG="PS MEDS" S ORWP94=1 D
"RTN","ORWDX",74,0)
 . I ORIT=$O(^ORD(101.41,"AB","PSO SUPPLY",0)) S DLG="PSO SUPPLY"
"RTN","ORWDX",75,0)
 . I ORIT=$O(^ORD(101.41,"AB","PSO OERR",0)) S DLG="PSO OERR"
"RTN","ORWDX",76,0)
 . I ORIT=$O(^ORD(101.41,"AB","PSJ OR PAT OE",0)) S DLG="PSJ OR PAT OE"
"RTN","ORWDX",77,0)
 I DLG="PSO OERR"!(DLG="PSO SUPPLY") S ORCAT="O" I $G(OREVENT("EFFECTIVE")) D
"RTN","ORWDX",78,0)
 . S ORDIALOG($O(^ORD(101.41,"B","OR GTX START DATE"_$S($G(ORWP94):"/TIME",1:""),0)),1)=OREVENT("EFFECTIVE")
"RTN","ORWDX",79,0)
 I DLG="PSJ OR PAT OE" S ORCAT="I"
"RTN","ORWDX",80,0)
 I DLG="PSJ OR CLINIC OE" S ORCAT="I"
"RTN","ORWDX",81,0)
 I DLG="CLINIC OR PAT FLUID OE" S ORCAT="I"
"RTN","ORWDX",82,0)
 S:DLG="FHW1" ORCAT="I" S:DLG?1"FHW "2.7U1" MEAL" ORCAT="O"
"RTN","ORWDX",83,0)
 S ORVP=ORVP_";DPT(",ORL(2)=ORL_";SC(",ORL=ORL(2)
"RTN","ORWDX",84,0)
 I ORDG=$O(^ORD(100.98,"B","LAB",0)) D  ;use section
"RTN","ORWDX",85,0)
 . N OI,SUB S OI=+$G(ORDIALOG($$PTR^ORCD("OR GTX ORDERABLE ITEM"),1))
"RTN","ORWDX",86,0)
 . S SUB=$P($G(^ORD(101.43,OI,"LR")),U,6),ORDG=$$DGRP^ORMLR(SUB)
"RTN","ORWDX",87,0)
 K:'ORDG ORDG K:'ORIT ORIT ; Dgrp & Quick must be non-zero
"RTN","ORWDX",88,0)
 M ORCHECK=ORDIALOG("ORCHECK") K ORDIALOG("ORCHECK")
"RTN","ORWDX",89,0)
 S ORDIALOG=$O(^ORD(101.41,"AB",DLG,0))
"RTN","ORWDX",90,0)
 I 'ORDIALOG S ORDIALOG=$O(^ORD(101.41,"B",DLG,0))
"RTN","ORWDX",91,0)
 I $D(ORDIALOG("ORLEAD")) S ORLEAD=ORDIALOG("ORLEAD")
"RTN","ORWDX",92,0)
 I $D(ORDIALOG("ORTRAIL")) S ORTRAIL=ORDIALOG("ORTRAIL")
"RTN","ORWDX",93,0)
 D GETDLG1^ORCD(ORDIALOG)
"RTN","ORWDX",94,0)
 I $L(ORCATFN) S ORCAT=ORCATFN
"RTN","ORWDX",95,0)
 I $G(ORWP94) D
"RTN","ORWDX",96,0)
 . N SIGPRMT S SIGPRMT=$O(^ORD(101.41,"B","OR GTX SIG",0))
"RTN","ORWDX",97,0)
 . N INSPRMT S INSPRMT=$O(^ORD(101.41,"B","OR GTX INSTRUCTIONS",0))
"RTN","ORWDX",98,0)
 . I $L($G(ORDIALOG(SIGPRMT,1))) S ORDIALOG(INSPRMT,"FORMAT")="@"
"RTN","ORWDX",99,0)
 . I ORCAT="O" S ORPKG=$O(^DIC(9.4,"C","PSO",0))
"RTN","ORWDX",100,0)
 . I ORCAT="I" S ORPKG=$O(^DIC(9.4,"C","PSJ",0))
"RTN","ORWDX",101,0)
 S ORSRC=$G(ORSRC)
"RTN","ORWDX",102,0)
 D DELPI^ORWDX1 ;delete empty PI
"RTN","ORWDX",103,0)
 I $G(ORIFN)="" D  ; new order
"RTN","ORWDX",104,0)
 . D EN^ORCSAVE
"RTN","ORWDX",105,0)
 . S REC="" I ORIFN D GETBYIFN^ORWORR(.REC,ORIFN)
"RTN","ORWDX",106,0)
 . I '$D(^TMP("ORECALL",$J,ORDIALOG)) M ^TMP("ORECALL",$J,ORDIALOG)=ORDIALOG
"RTN","ORWDX",107,0)
 E  D
"RTN","ORWDX",108,0)
 . N OR0
"RTN","ORWDX",109,0)
 . S OR0=$G(^OR(100,+ORIFN,0)),ORSTS=$P($G(^(3)),U,3),ORDG=$P(OR0,U,11)
"RTN","ORWDX",110,0)
 . I $L($P(OR0,U,17)),ORSTS=10 S OREVENT=$P(OR0,U,17),OREVENT("TS")=$P(OR0,U,13)
"RTN","ORWDX",111,0)
 . D XX^ORCSAVE ; edit order
"RTN","ORWDX",112,0)
 . S REC="" S ORIFN=+ORIFN_";"_ORDA D GETBYIFN^ORWORR(.REC,ORIFN)
"RTN","ORWDX",113,0)
 Q
"RTN","ORWDX",114,0)
SENDED(ORWLST,ORIENS,TS,LOC) ; Release EDOs to svc
"RTN","ORWDX",115,0)
 N OK,ORVP,ORWERR,ORSIGST,ORDA,ORNATURE,ORIX,X,PTEVT,ORIFN,J,EVENT,LOCK,OR3
"RTN","ORWDX",116,0)
 S ORWERR="",ORIX=0,LOC=LOC_";SC("
"RTN","ORWDX",117,0)
 F  S ORIX=$O(ORIENS(ORIX)) Q:'ORIX  D  Q:ORWERR]""
"RTN","ORWDX",118,0)
 . S (ORIFN,ORWLST(ORIX))=ORIENS(ORIX)
"RTN","ORWDX",119,0)
 . S PTEVT=$P(^OR(100,+ORIFN,0),U,17)
"RTN","ORWDX",120,0)
 . I PTEVT D
"RTN","ORWDX",121,0)
 .. I $D(EVENT(PTEVT)) S LOCK=1 Q
"RTN","ORWDX",122,0)
 .. S LOCK=$$LCKEVT^ORX2(PTEVT) S:LOCK EVENT(PTEVT)=""
"RTN","ORWDX",123,0)
 . I 'LOCK S ORWERR="1^delayed event is locked - another user is processing orders for this event" S ORWLST(ORIX)=ORWLST(ORIX)_"^E^"_ORWERR Q
"RTN","ORWDX",124,0)
 . S ORDA=$P(ORIFN,";",2) S:'ORDA ORDA=1
"RTN","ORWDX",125,0)
 . S ORVP=$P($G(^OR(100,+ORIFN,0)),U,2)
"RTN","ORWDX",126,0)
 . I $D(^OR(100,+ORIFN,8,ORDA,0)) D
"RTN","ORWDX",127,0)
 .. S ORSIGST=$P($G(^(0)),U,4),ORNATURE=$P($G(^(0)),U,12) ;naked references refer to OR(100,+ORIFN,8,ORDA on line above
"RTN","ORWDX",128,0)
 . S OK=$$LOCK1^ORX2(ORIFN) I 'OK S ORWERR="1^"_$P(OK,U,2)
"RTN","ORWDX",129,0)
 . I OK,$G(LOCK) D
"RTN","ORWDX",130,0)
 .. S OR3=$G(^OR(100,+ORIFN,3)) I $P(OR3,"^",3)'=10!($P(OR3,"^",9)]"") D UNLK1^ORX2(ORIENS(ORIX)) Q  ;order already released or has a parent
"RTN","ORWDX",131,0)
 .. S:$G(LOC) $P(^OR(100,+ORIFN,0),U,10)=LOC ;set location
"RTN","ORWDX",132,0)
 .. S:$G(TS) $P(^OR(100,+ORIFN,0),U,13)=TS ;set specialty
"RTN","ORWDX",133,0)
 .. D EN2^ORCSEND(ORIENS(ORIX),ORSIGST,ORNATURE,.ORWERR),UNLK1^ORX2(ORIENS(ORIX)) ;add ,LOCK to if statement for 195
"RTN","ORWDX",134,0)
 . I $L(ORWERR) S ORWLST(ORIX)=ORWLST(ORIX)_"^E^"_ORWERR Q
"RTN","ORWDX",135,0)
 . E  D
"RTN","ORWDX",136,0)
 .. S PTEVT=$P($G(^OR(100,+ORIENS(ORIX),0)),U,17)
"RTN","ORWDX",137,0)
 .. D:$$TYPE^OREVNTX(PTEVT)="M" SAVE^ORMEVNT1(ORIENS(ORIX),PTEVT,2)
"RTN","ORWDX",138,0)
 . S X="RS"
"RTN","ORWDX",139,0)
 . S $P(ORWLST(ORIX),U,2)=X
"RTN","ORWDX",140,0)
 S J=0 F  S J=$O(EVENT(J)) Q:'+J  D UNLEVT^ORX2(J) ;195
"RTN","ORWDX",141,0)
 Q
"RTN","ORWDX",142,0)
SEND(ORWLST,DFN,ORNP,ORL,ES,ORWREC) ; Sign
"RTN","ORWDX",143,0)
 ; DFN=Patient, ORNP=Provider, ORL=Location, ES=Encrypted ES code
"RTN","ORWDX",144,0)
 ; ORWREC(n)=ORIFN;Action^Signature Sts^Release Sts^Nature of Order
"RTN","ORWDX",145,0)
SEND1 N ORVP,ORWI,ORWERR,ORWREL,ORWSIG,ORWNATR,ORDERID,ORBEF,ORLR,ORLAB,X,I
"RTN","ORWDX",146,0)
 S ORVP=DFN_";DPT(",ORL=ORL_";SC(",ORL(2)=ORL,ORWLST=0
"RTN","ORWDX",147,0)
 F I="LR","VBEC" S X=+$O(^DIC(9.4,"C",I,0)) S:X ORLR(X)=1
"RTN","ORWDX",148,0)
 S ORWI=0 F  S ORWI=$O(ORWREC(ORWI)) Q:'ORWI  D
"RTN","ORWDX",149,0)
 . S X=ORWREC(ORWI),ORWERR=""
"RTN","ORWDX",150,0)
 . S ORDERID=$P(X,U),ORWSIG=$P(X,U,2),ORWREL=$P(X,U,3),ORWNATR=$P(X,U,4)
"RTN","ORWDX",151,0)
 . S ORBEF=0
"RTN","ORWDX",152,0)
 . I '$D(^OR(100,+ORDERID,0)) Q
"RTN","ORWDX",153,0)
 . I $D(^OR(100,+ORDERID,8,+$P(ORDERID,";",2),0)) S ORBEF=$P(^OR(100,+ORDERID,8,+$P(ORDERID,";",2),0),U,15)
"RTN","ORWDX",154,0)
 . S:$D(^OR(100,+ORDERID,8,+$P(ORDERID,";",2),0)) ORWNATR=$S($P(^OR(100,+ORDERID,8,+$P(ORDERID,";",2),0),"^",4)=3:"",1:ORWNATR)
"RTN","ORWDX",155,0)
 . S ORWERR=$$CHKACT^ORWDXR(ORDERID,ORWSIG,ORWREL,ORWNATR)
"RTN","ORWDX",156,0)
 . I $L(ORWERR) S ORWERR="1^"_ORWERR
"RTN","ORWDX",157,0)
 . I '$L(ORWERR) D
"RTN","ORWDX",158,0)
 .. I $G(ORLR(+$P(^OR(100,+ORDERID,0),U,14))),'$G(ORLAB) D  ; lab batch start
"RTN","ORWDX",159,0)
 ... I $L($T(BHS^ORMBLD)) D BHS^ORMBLD(ORVP) S ORLAB=1
"RTN","ORWDX",160,0)
 .. N OK S OK=$$LOCK1^ORX2(ORDERID) I 'OK S ORWERR="1^"_$P(OK,U,2)
"RTN","ORWDX",161,0)
 .. I OK D EN^ORCSEND(ORDERID,"",ORWSIG,ORWREL,ORWNATR,"",.ORWERR),UNLK1^ORX2(ORDERID)
"RTN","ORWDX",162,0)
 . S ORWLST(ORWI)=ORDERID,X=""
"RTN","ORWDX",163,0)
 . I $L(ORWERR) S ORWLST(ORWI)=ORWLST(ORWI)_"^E^"_ORWERR Q
"RTN","ORWDX",164,0)
 . I ORWREL,((ORBEF=10)!(ORBEF=11)),($P(^OR(100,+ORDERID,3),U,3)'=10) S X="R"
"RTN","ORWDX",165,0)
 . I ORWSIG'=2 S X=X_"S"
"RTN","ORWDX",166,0)
 . S $P(ORWLST(ORWI),U,2)=X
"RTN","ORWDX",167,0)
 I $G(ORLAB) D BTS^ORMBLD(ORVP)
"RTN","ORWDX",168,0)
 I $D(ORWLST)>9 D
"RTN","ORWDX",169,0)
 . N I,A
"RTN","ORWDX",170,0)
 . S I=0 F  S I=$O(ORWLST(I)) Q:I=""  S A=$G(ORWLST(I)) I A["Invalid Procedure, Inactive, no Imaging Type" D SM^ORWDX2(A)
"RTN","ORWDX",171,0)
  Q
"RTN","ORWDX",172,0)
DLGID(VAL,ORIFN) ; return dlg IEN for order
"RTN","ORWDX",173,0)
 S VAL=$P(^OR(100,+ORIFN,0),U,5)
"RTN","ORWDX",174,0)
 S VAL=$S($P(VAL,";",2)="ORD(101.41,":+VAL,1:0)
"RTN","ORWDX",175,0)
 Q
"RTN","ORWDX",176,0)
FORMID(VAL,ORIFN) ; Base dlg FormID for an order
"RTN","ORWDX",177,0)
 N DLG
"RTN","ORWDX",178,0)
 S VAL=0,DLG=$P(^OR(100,+ORIFN,0),U,5)
"RTN","ORWDX",179,0)
 Q:$P(DLG,";",2)'="ORD(101.41,"
"RTN","ORWDX",180,0)
 D FORMID^ORWDXM(.VAL,+DLG)
"RTN","ORWDX",181,0)
 Q
"RTN","ORWDX",182,0)
AGAIN(VAL,DLG) ; return true to keep dlg for another order
"RTN","ORWDX",183,0)
 S VAL=''$P($G(^ORD(101.41,DLG,0)),U,9)
"RTN","ORWDX",184,0)
 Q
"RTN","ORWDX",185,0)
DGRP(VAL,DLG) ; Display grp pointer for a dlg
"RTN","ORWDX",186,0)
 S DLG=$S($E(DLG)="`":+$P(DLG,"`",2),1:$O(^ORD(101.41,"AB",DLG,0))) ;kcm
"RTN","ORWDX",187,0)
 S VAL=$P($G(^ORD(101.41,DLG,0)),U,5)
"RTN","ORWDX",188,0)
 Q
"RTN","ORWDX",189,0)
DGNM(VAL,NM) ; Display grp pointer for name
"RTN","ORWDX",190,0)
 S VAL=$O(^ORD(100.98,"B",NM,0))
"RTN","ORWDX",191,0)
 Q
"RTN","ORWDX",192,0)
WRLST(LST,LOC) ; List of dlgs for writing orders
"RTN","ORWDX",193,0)
 G WRLST1^ORWDX1
"RTN","ORWDX",194,0)
MSG(LST,IEN) ; Msg text for orderable item
"RTN","ORWDX",195,0)
 N I
"RTN","ORWDX",196,0)
 S I=0 F  S I=$O(^ORD(101.43,IEN,8,I)) Q:I'>0  S LST(I)=^(I,0)
"RTN","ORWDX",197,0)
 Q
"RTN","ORWDX",198,0)
DISMSG(VAL,IEN) ; Disabled mge for ordering dlg
"RTN","ORWDX",199,0)
 S VAL=$P($G(^ORD(101.41,+IEN,0)),U,3)
"RTN","ORWDX",200,0)
 Q
"RTN","ORWDX",201,0)
LOCK(OK,DFN) ; Attempt to lock pt for ordering
"RTN","ORWDX",202,0)
 S OK=$$LOCK^ORX2(DFN)
"RTN","ORWDX",203,0)
 Q
"RTN","ORWDX",204,0)
UNLOCK(OK,DFN) ; Unlock pt for ordering
"RTN","ORWDX",205,0)
 D UNLOCK^ORX2(DFN) S OK=1
"RTN","ORWDX",206,0)
 Q
"RTN","ORWDX",207,0)
LOCKORD(OK,ORIFN) ; Attempt to lock order
"RTN","ORWDX",208,0)
 S OK=$$LOCK1^ORX2(ORIFN)
"RTN","ORWDX",209,0)
 Q
"RTN","ORWDX",210,0)
UNLKORD(OK,ORIFN) ; Unlock order
"RTN","ORWDX",211,0)
 D UNLK1^ORX2(ORIFN) S OK=1
"RTN","ORWDX",212,0)
 Q
"RTN","ORWDX",213,0)
UNLKOTH(OK,ORIFN) ; Unlock pt not by this session
"RTN","ORWDX",214,0)
 K ^XTMP("ORPTLK-"_ORIFN) S OK=1
"RTN","ORWDX",215,0)
 Q
"RTN","ORWDX1")
0^64^B53489734
"RTN","ORWDX1",1,0)
ORWDX1 ; SLC/KCM/REV - Utilities for Order Dialogs ;12/16/14  10:35
"RTN","ORWDX1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**85,187,195,215,243,296,341,350**;Dec 17, 1997;Build 77
"RTN","ORWDX1",3,0)
 ;
"RTN","ORWDX1",4,0)
WRLST(LST,LOC) ; Return list of dialogs for writing orders
"RTN","ORWDX1",5,0)
 ; .Y(n): DlgName^ListBox Text
"RTN","ORWDX1",6,0)
WRLST1 N ANENT
"RTN","ORWDX1",7,0)
 S LOC=+$G(LOC)_";SC(" I 'LOC S LOC=""
"RTN","ORWDX1",8,0)
 S ANENT="ALL^"_LOC_$S($G(^VA(200,DUZ,5)):"^SRV.`"_+$G(^(5)),1:"")
"RTN","ORWDX1",9,0)
 D WRLSTB(.LST) Q:$D(LST)>1  ; check ORWDX WRITE ORDERS first
"RTN","ORWDX1",10,0)
 N ORX,X0,X5,ORERR,I,SEQ,IEN,DGRP,FID,TXT,TYP
"RTN","ORWDX1",11,0)
 D GETLST^XPAR(.ORX,ANENT,"ORWOR WRITE ORDERS LIST","Q",.ORERR) Q:ORERR
"RTN","ORWDX1",12,0)
 S I=0 F  S I=$O(ORX(I)) Q:'I  D
"RTN","ORWDX1",13,0)
 . S SEQ=+ORX(I),IEN=$P(ORX(I),U,2),X0=$G(^ORD(101.41,+IEN,0)),X5=$G(^(5))
"RTN","ORWDX1",14,0)
 . S DGRP=+$P(X0,U,5),FID=+$P(X5,U,5),TXT=$P(X5,U,4),TYP=$P(X0,U,4)
"RTN","ORWDX1",15,0)
 . S:'$L(TXT) TXT=$P(X0,U,2)
"RTN","ORWDX1",16,0)
 . I $P(X0,U,4)="M" S:'FID FID=1001
"RTN","ORWDX1",17,0)
 . S LST(SEQ)=IEN_";"_FID_";"_DGRP_";"_TYP_U_TXT
"RTN","ORWDX1",18,0)
 Q
"RTN","ORWDX1",19,0)
WRLSTB(LST)     ; return menu from which Write Orders list is built
"RTN","ORWDX1",20,0)
 N MNU,SEQ,IEN,ITM,TXT,FID,DGRP,X,TYP
"RTN","ORWDX1",21,0)
 S MNU=$$GET^XPAR(ANENT,"ORWDX WRITE ORDERS LIST",1,"I") Q:'MNU
"RTN","ORWDX1",22,0)
 S SEQ=0 F  S SEQ=$O(^ORD(101.41,MNU,10,"B",SEQ)) Q:'SEQ  D
"RTN","ORWDX1",23,0)
 . S IEN=0 F  S IEN=$O(^ORD(101.41,MNU,10,"B",SEQ,IEN)) Q:'IEN  D
"RTN","ORWDX1",24,0)
 . . S X=$G(^ORD(101.41,MNU,10,IEN,0)),ITM=+$P(X,U,2),TXT=$P(X,U,4)
"RTN","ORWDX1",25,0)
 . . S X=$G(^ORD(101.41,ITM,5)),FID=+$P(X,U,5)
"RTN","ORWDX1",26,0)
 . . S X=$G(^ORD(101.41,ITM,0)),TYP=$P(X,U,4),DGRP=+$P(X,U,5)
"RTN","ORWDX1",27,0)
 . . S:'$L(TXT) TXT=$P(X,U,2)
"RTN","ORWDX1",28,0)
 . . I TYP="M" S:'FID FID=1001
"RTN","ORWDX1",29,0)
 . . S LST(SEQ)=ITM_";"_FID_";"_DGRP_";"_TYP_U_TXT
"RTN","ORWDX1",30,0)
 Q
"RTN","ORWDX1",31,0)
DELPI ; delete PI from ORDIALOG if PI = ""
"RTN","ORWDX1",32,0)
 ;Called from SAVE^ORWDX
"RTN","ORWDX1",33,0)
 N ORPI S ORPI=0
"RTN","ORWDX1",34,0)
 S ORPI=$O(^ORD(101.41,"B","OR GTX PATIENT INSTRUCTIONS",ORPI))
"RTN","ORWDX1",35,0)
 Q:'$D(ORDIALOG(ORPI))
"RTN","ORWDX1",36,0)
 I '$D(ORDIALOG(ORPI,1)) K ORDIALOG(ORPI),ORDIALOG("WP",ORPI) Q
"RTN","ORWDX1",37,0)
 N PINODE,PITX
"RTN","ORWDX1",38,0)
 S PITX="",PINODE=$G(ORDIALOG(ORPI,1))
"RTN","ORWDX1",39,0)
 S PITX=$G(@PINODE@(1,0))
"RTN","ORWDX1",40,0)
 S PITX=$TR(PITX," ","")
"RTN","ORWDX1",41,0)
 I '$L(PITX) K ORDIALOG(ORPI),ORDIALOG("WP",ORPI) Q
"RTN","ORWDX1",42,0)
 N ORSIG S ORSIG=+$O(^ORD(101.41,"B","OR GTX SIG",0))
"RTN","ORWDX1",43,0)
 I $$STR^ORWDXR(ORSIG)[$$STR^ORWDXR(ORPI) S ORDIALOG(ORPI,"FORMAT")="@"
"RTN","ORWDX1",44,0)
 Q
"RTN","ORWDX1",45,0)
FNDINFO(Y,ODIEN) ;
"RTN","ORWDX1",46,0)
 N ODI,CRTM,FRM,XX
"RTN","ORWDX1",47,0)
 S FRM="",CRTM=$$NOW^XLFDT
"RTN","ORWDX1",48,0)
 F  S FRM=$O(^ORD(101.43,XRF,FRM)) Q:FRM=""  D
"RTN","ORWDX1",49,0)
 . S ODI=0 F  S ODI=$O(^ORD(101.43,XRF,FRM,ODI)) Q:'ODI  D
"RTN","ORWDX1",50,0)
 .. S XX=^ORD(101.43,XRF,FRM,ODI)
"RTN","ORWDX1",51,0)
 .. I +$P(XX,U,3),$P(XX,U,3)<CRTM Q
"RTN","ORWDX1",52,0)
 .. I ODI=ODIEN D
"RTN","ORWDX1",53,0)
 ... S NM=NM+1
"RTN","ORWDX1",54,0)
 ... I 'XX S Y(NM)=ODIEN_U_$P(XX,U,2)_U_$P(XX,U,2)
"RTN","ORWDX1",55,0)
 ... E  S Y(NM)=ODIEN_U_$P(XX,U,2)_$C(9)_"<"_$P(XX,U,4)_">"_U_$P(XX,U,4)
"RTN","ORWDX1",56,0)
 Q
"RTN","ORWDX1",57,0)
DLGDEF(LST,DLG) ; Format mapping for a dlg
"RTN","ORWDX1",58,0)
 N I,IEN,ILST,X0,X2,XW  S ILST=0
"RTN","ORWDX1",59,0)
 I $O(^ORD(101.41,"AB",DLG,0))>0 S DLG=$O(^ORD(101.41,"AB",DLG,0))
"RTN","ORWDX1",60,0)
 E  S DLG=$O(^ORD(101.41,"B",DLG,0))
"RTN","ORWDX1",61,0)
 Q:'DLG
"RTN","ORWDX1",62,0)
 S I=0 F  S I=$O(^ORD(101.41,DLG,10,I)) Q:I'>0  D
"RTN","ORWDX1",63,0)
 . S X0=$G(^ORD(101.41,DLG,10,I,0)),X2=$G(^(2)),IEN=+$P(X0,U,2)
"RTN","ORWDX1",64,0)
 . S ILST=ILST+1,LST(ILST)=U_IEN_U_$P(X2,U,1,7)
"RTN","ORWDX1",65,0)
 . I $P(X0,U,11) S $P(LST(ILST),U,11)=1
"RTN","ORWDX1",66,0)
 . S $P(LST(ILST),U)=$P($G(^ORD(101.41,IEN,1)),U,3)
"RTN","ORWDX1",67,0)
 . I $P($G(^ORD(101.41,IEN,0)),U)="OR GTX ADDITIVE" S $P(LST(ILST),U)="ADDITIVE"
"RTN","ORWDX1",68,0)
 . I $P($G(^ORD(101.41,IEN,0)),U)="OR GTX ADDL DIETS" S $P(LST(ILST),U)="ADDLDIETS"
"RTN","ORWDX1",69,0)
 . I $L($P(LST(ILST),U))=0 S $P(LST(ILST),U)="ID"_IEN
"RTN","ORWDX1",70,0)
 . I $D(^ORD(101.41,DLG,10,"DAD",IEN)) D
"RTN","ORWDX1",71,0)
 .. N SEQ,DA,CHILD S CHILD=""
"RTN","ORWDX1",72,0)
 .. S SEQ=0 F  S SEQ=$O(^ORD(101.41,DLG,10,"DAD",IEN,SEQ)) Q:'SEQ  D
"RTN","ORWDX1",73,0)
 ... S DA=0 F  S DA=$O(^ORD(101.41,DLG,10,"DAD",IEN,SEQ,DA)) Q:'DA  D
"RTN","ORWDX1",74,0)
 .... S CHILD=CHILD_+$P($G(^ORD(101.41,DLG,10,DA,0)),U,2)_"~"
"RTN","ORWDX1",75,0)
 .. S $P(LST(ILST),U,10)=CHILD
"RTN","ORWDX1",76,0)
 Q
"RTN","ORWDX1",77,0)
 ;
"RTN","ORWDX1",78,0)
CHANGE(ORLST,ORCLST,DFN,ISIMO) ;
"RTN","ORWDX1",79,0)
 N CATCH,CHANGE,CNT,INP,INPDIEN,IVM,IVMDIEN,ORIEN,ORLOC,OR3,ORDG
"RTN","ORWDX1",80,0)
 N CIEN,CIVIEN,DIAL,TDIAL,TDIEN,UDIEN,QORDDG,PACKIEN
"RTN","ORWDX1",81,0)
 S (INP,IVM,INPDIEN,IVMDIEN,UDIEN)=0
"RTN","ORWDX1",82,0)
 S (TDIAL,TDIEN)=0
"RTN","ORWDX1",83,0)
 S INP=$O(^ORD(101.41,"B","PSJ OR PAT OE","")) Q:INP'>0
"RTN","ORWDX1",84,0)
 S IVM=$O(^ORD(101.41,"B","PSJI OR PAT FLUID OE","")) Q:IVM'>0
"RTN","ORWDX1",85,0)
 S TDIAL=$O(^ORD(101.41,"B","OR GXTEXT WORD PROCESSING ORDER","")) Q:TDIAL'>0
"RTN","ORWDX1",86,0)
 S INPDIEN=$O(^ORD(100.98,"B","INPATIENT MEDICATIONS","")) Q:INPDIEN'>0
"RTN","ORWDX1",87,0)
 S IVMDIEN=$O(^ORD(100.98,"B","IV MEDICATIONS","")) Q:IVMDIEN'>0
"RTN","ORWDX1",88,0)
 S UDIEN=$O(^ORD(100.98,"B","UNIT DOSE MEDICATIONS","")) Q:UDIEN'>0
"RTN","ORWDX1",89,0)
 S TIEN=$O(^ORD(100.98,"B","NURSING","")) Q:TIEN'>0
"RTN","ORWDX1",90,0)
 S CIEN=$O(^ORD(100.98,"B","CLINIC MEDICATIONS","")) Q:CIEN'>0
"RTN","ORWDX1",91,0)
 S CIVIEN=$O(^ORD(100.98,"B","CLINIC INFUSIONS","")) Q:CIEN'>0
"RTN","ORWDX1",92,0)
 S CNT=0 F  S CNT=$O(ORCLST(CNT)) Q:CNT'>0  D
"RTN","ORWDX1",93,0)
 .S CHANGE=0
"RTN","ORWDX1",94,0)
 .S ORIEN=$P($G(ORCLST(CNT)),U),ORIEN=$P(ORIEN,";")
"RTN","ORWDX1",95,0)
 .S ORDG=$P($G(^OR(100,ORIEN,0)),U,11)
"RTN","ORWDX1",96,0)
 .S ORLOC=$P($G(ORCLST(CNT)),U,2)
"RTN","ORWDX1",97,0)
 .S OR3=$G(^OR(100,ORIEN,3))
"RTN","ORWDX1",98,0)
 .S DIAL=$P(OR3,U,4)
"RTN","ORWDX1",99,0)
 .;Remove Treating Speciality if the order location is the clinic
"RTN","ORWDX1",100,0)
 .I $P($G(^OR(100,ORIEN,0)),U,10)=(ORLOC_";SC("),$P($G(^SC(ORLOC,0)),U,3)="C" D  Q
"RTN","ORWDX1",101,0)
 ..S $P(^OR(100,ORIEN,0),U,13)=""
"RTN","ORWDX1",102,0)
 .;
"RTN","ORWDX1",103,0)
 .;CHANGE PATIENT LOCATION AND PATIENT STATUS.
"RTN","ORWDX1",104,0)
 .S $P(^OR(100,ORIEN,0),U,10)=ORLOC_";SC("
"RTN","ORWDX1",105,0)
 .S PACKIEN=$P(^OR(100,ORIEN,0),U,14)
"RTN","ORWDX1",106,0)
 .I $$GET1^DIQ(9.4,PACKIEN_",",1)'="PSO" S $P(^OR(100,ORIEN,0),U,12)="I"
"RTN","ORWDX1",107,0)
 .;
"RTN","ORWDX1",108,0)
 .;Check for IMO orders Nursing Dialog problem
"RTN","ORWDX1",109,0)
 .S CATCH=$P($G(^OR(100,ORIEN,0)),U,11)
"RTN","ORWDX1",110,0)
 .;
"RTN","ORWDX1",111,0)
 .S $P(^OR(100,ORIEN,0),U,11)=$S(DIAL=(IVM_";ORD(101.41,"):IVMDIEN,DIAL=(INP_";ORD(101.41,"):INPDIEN,DIAL=(TDIAL_";ORD(101.41,"):TIEN,1:CATCH)
"RTN","ORWDX1",112,0)
 .;
"RTN","ORWDX1",113,0)
 .;Check for Quick Order Dialog
"RTN","ORWDX1",114,0)
 .I CATCH=$P($G(^OR(100,ORIEN,0)),U,11),ISIMO=1 D
"RTN","ORWDX1",115,0)
 ..S QORDDG=$P($G(^ORD(101.41,+DIAL,0)),U,5)
"RTN","ORWDX1",116,0)
 ..I QORDDG=UDIEN!(QORDDG=INPDIEN) S $P(^OR(100,ORIEN,0),U,11)=INPDIEN,DIAL=(INP_";ORD(101.41,") Q
"RTN","ORWDX1",117,0)
 ..I QORDDG=IVMDIEN S $P(^OR(100,ORIEN,0),U,11)=IVMDIEN,DIAL=(IVM_";ORD(101.41,") Q
"RTN","ORWDX1",118,0)
 ..I QORDDG=TIEN S $P(^OR(100,ORIEN,0),U,11)=TIEN,DIAL=(TDIAL_";ORD(101.41,") Q
"RTN","ORWDX1",119,0)
 .;
"RTN","ORWDX1",120,0)
 .;Add treating spec if Inpatient order
"RTN","ORWDX1",121,0)
 .;I (ISIMO=1)&(DIAL=(IVM_";ORD(101.41,"))!(DIAL=(INP_";ORD(101.41,")) D
"RTN","ORWDX1",122,0)
 .;.S $P(^OR(100,ORIEN,0),U,13)=+$G(^DPT(DFN,.103))
"RTN","ORWDX1",123,0)
 .I ISIMO=0 S $P(^OR(100,ORIEN,0),U,13)=+$G(^DPT(DFN,.103))
"RTN","ORWDX1",124,0)
 Q
"RTN","ORWDX1",125,0)
 ;
"RTN","ORWDX1",126,0)
STCHANGE(ORY,DFN,ORYARR) ;
"RTN","ORWDX1",127,0)
 N CNT,DONE,NODE,PHARMID,STR,STATUS
"RTN","ORWDX1",128,0)
 S ORY=0,DONE=0
"RTN","ORWDX1",129,0)
 I '$$PATCH^XPDUTL("PSS*1.0*93") Q
"RTN","ORWDX1",130,0)
 S CNT=0 F  S CNT=$O(ORYARR(CNT)) Q:CNT'>0!(DONE>0)  D
"RTN","ORWDX1",131,0)
 . S NODE=$G(ORYARR(CNT))
"RTN","ORWDX1",132,0)
 . S PHARMID=$P(NODE,U),STATUS=$P(NODE,U,2)
"RTN","ORWDX1",133,0)
 . I $$UP^XLFSTR(STATUS)'=$$STATUS^PSSORUTE(DFN,PHARMID) S ORY=1,DONE=1
"RTN","ORWDX1",134,0)
 Q
"RTN","ORWDX1",135,0)
ORDMATCH(ORY,DFN,ORYARR) ;
"RTN","ORWDX1",136,0)
 N ACTION,CNT,IEN,MATCH,ORDERID,STATUS
"RTN","ORWDX1",137,0)
 S CNT=0,MATCH=1
"RTN","ORWDX1",138,0)
 F  S CNT=$O(ORYARR(CNT)) Q:CNT'>0!(MATCH=0)  D
"RTN","ORWDX1",139,0)
 . S ORDERID=$P(ORYARR(CNT),U),STATUS=$P(ORYARR(CNT),U,2)
"RTN","ORWDX1",140,0)
 . ;*341 Set up Action before validation.
"RTN","ORWDX1",141,0)
 . S IEN=$P(ORDERID,";"),ACTION=$P(ORDERID,";",2)
"RTN","ORWDX1",142,0)
 . I ORDERID=0,$G(ACTION)="" Q
"RTN","ORWDX1",143,0)
 . I STATUS=$P($G(^OR(100,IEN,3)),U,3) Q
"RTN","ORWDX1",144,0)
 . I $P($G(^ORD(100.01,STATUS,0)),U)="DISCONTINUED/EDIT" Q
"RTN","ORWDX1",145,0)
 . ;S MATCH=0
"RTN","ORWDX1",146,0)
 . I $P($G(^OR(100,IEN,8,ACTION,0)),U,15)'=STATUS S MATCH=0
"RTN","ORWDX1",147,0)
 S ORY=MATCH
"RTN","ORWDX1",148,0)
 Q
"RTN","ORWDX1",149,0)
 ;
"RTN","ORWDX1",150,0)
DCREN(ORY,ORYARR) ;
"RTN","ORWDX1",151,0)
 N ACT,CNT,CNT1,I,OR3,ORG,ORGID,ORID,TEXT,STATUS
"RTN","ORWDX1",152,0)
 S CNT1=0
"RTN","ORWDX1",153,0)
 S CNT=0 F  S CNT=$O(ORYARR(CNT)) Q:CNT'>0  D
"RTN","ORWDX1",154,0)
 .S ORGID=ORYARR(CNT)
"RTN","ORWDX1",155,0)
 .S ORID=+ORGID,ACT=$P(ORGID,";",2),TEXT=""
"RTN","ORWDX1",156,0)
 .S OR3=$G(^OR(100,ORID,3))
"RTN","ORWDX1",157,0)
 .;Make sure current order status is pending
"RTN","ORWDX1",158,0)
 .I $P($G(^ORD(100.01,$P(OR3,U,3),0)),U)'="PENDING" Q
"RTN","ORWDX1",159,0)
 .S ORG=$P($G(OR3),U,5) Q:ORG'>0
"RTN","ORWDX1",160,0)
 .;do not add original order if it is expired
"RTN","ORWDX1",161,0)
 .S STATUS=$P(^OR(100,ORG,3),U,3)
"RTN","ORWDX1",162,0)
 .I $P($G(^ORD(100.01,STATUS,0)),U)="EXPIRED" Q
"RTN","ORWDX1",163,0)
 .;Do not add original order if Stop date has pass
"RTN","ORWDX1",164,0)
 .I $P(^OR(100,ORG,0),U,9)'>$$NOW^XLFDT Q
"RTN","ORWDX1",165,0)
 .;make sure current order is a renewed order
"RTN","ORWDX1",166,0)
 .I $P(OR3,U,11)'=2 Q
"RTN","ORWDX1",167,0)
 .S ACT=+$P($G(^OR(100,ORG,3)),U,7)
"RTN","ORWDX1",168,0)
 .S CNT1=CNT1+1,ORY(CNT1)=ORGID_U_$P(OR3,U,5)_";"_ACT_U_TEXT
"RTN","ORWDX1",169,0)
 Q
"RTN","ORWDX1",170,0)
DCORIG(ORY,ORIEN) ;
"RTN","ORWDX1",171,0)
 S $P(^OR(100,+ORIEN,6),U,9)=1
"RTN","ORWDX1",172,0)
 Q
"RTN","ORWDX1",173,0)
UNDCORIG(ORY,ORYARR) ;
"RTN","ORWDX1",174,0)
 N CNT
"RTN","ORWDX1",175,0)
 S CNT=0 F  S CNT=$O(ORYARR(CNT)) Q:CNT'>0  S $P(^OR(100,+ORYARR(CNT),6),U,9)=0
"RTN","ORWDX1",176,0)
 Q
"RTN","ORWDX1",177,0)
PATWARD(ORY,DFN) ;
"RTN","ORWDX1",178,0)
 N TEMP
"RTN","ORWDX1",179,0)
 S ORY=""
"RTN","ORWDX1",180,0)
 I $G(^DPT(DFN,.1))="" Q
"RTN","ORWDX1",181,0)
 S TEMP=^DPT(DFN,.1)
"RTN","ORWDX1",182,0)
 S ORY=TEMP_U_+$G(^DIC(42,+$O(^DIC(42,"B",TEMP,0)),44))
"RTN","ORWDX1",183,0)
 Q
"RTN","ORWDX1",184,0)
 ;
"RTN","ORWDX1",185,0)
ISPEND(ORIFN) ;Is the order's status pending?
"RTN","ORWDX1",186,0)
 N ISPEND,PENDST,N3 S ISPEND=0
"RTN","ORWDX1",187,0)
 Q:'$D(^OR(100,+ORIFN,3))
"RTN","ORWDX1",188,0)
 S PENDST=$O(^ORD(100.01,"B","PENDING",0))
"RTN","ORWDX1",189,0)
 S N3=$G(^OR(100,+ORIFN,3))
"RTN","ORWDX1",190,0)
 I $P(N3,U,3)=PENDST S ISPEND=1
"RTN","ORWDX1",191,0)
 Q ISPEND
"RTN","ORWDXM1")
0^65^B106096775
"RTN","ORWDXM1",1,0)
ORWDXM1 ;SLC/KCM - Order Dialogs, Menus ;09/09/15  16:12
"RTN","ORWDXM1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,131,132,141,178,185,187,215,243,280,331,388,350**;Dec 17, 1997;Build 77
"RTN","ORWDXM1",3,0)
 ;
"RTN","ORWDXM1",4,0)
BLDQRSP(LST,ORIT,FLDS,ISIMO,ENCLOC) ; Build responses for an order
"RTN","ORWDXM1",5,0)
 ; LST=QuickLevel^ResponseID(ORIT;$H)^Dialog^Type^FormID^DGrp
"RTN","ORWDXM1",6,0)
 ; LST(n)=verify or reject text
"RTN","ORWDXM1",7,0)
 ; ORIT= ptr to 101.41 for quick order, 100 for copy
"RTN","ORWDXM1",8,0)
 ; 1 2 3 4 5 6 7 8 11-20
"RTN","ORWDXM1",9,0)
 ; FLDS=DFN^LOC^ORNP^INPT^SEX^AGE^EVENT^SC%^^^Key Variables...
"RTN","ORWDXM1",10,0)
 ; ORIT=+ORIT: ptr to 101.41, $E(ORIT)=C: copy $E(ORIT)=X: change
"RTN","ORWDXM1",11,0)
 ; !! SHOULD CHECK for PRE-CPRS ORDERS (treat as text?)
"RTN","ORWDXM1",12,0)
 K ^TMP("ORWDXMQ",$J)
"RTN","ORWDXM1",13,0)
 N ORWMODE ; 0:Dlg,Quick 1:copy 2:change
"RTN","ORWDXM1",14,0)
 N TEMPCAT ; pt cat from DPT
"RTN","ORWDXM1",15,0)
 N ISXFER ; Trnsfr order?
"RTN","ORWDXM1",16,0)
 N ORIMO ;If IMO(inpt med on opt)
"RTN","ORWDXM1",17,0)
 N TEMPORIT
"RTN","ORWDXM1",18,0)
 N ADMLOC,PATLOC,ORDLOC,LEVEL,DELAY,SCHLOC,SCHTYP
"RTN","ORWDXM1",19,0)
 S PATLOC=$P(FLDS,U,2)
"RTN","ORWDXM1",20,0)
 S ORDLOC=$S(ORIT["C":+$P($G(^OR(100,+$P(ORIT,"C",2),0)),U,10),1:0)
"RTN","ORWDXM1",21,0)
 S ORIMO=$G(ISIMO)
"RTN","ORWDXM1",22,0)
 S ORWMODE=0,ISXFER=""
"RTN","ORWDXM1",23,0)
 S:$E(ORIT)="C" ORWMODE=1 S:$E(ORIT)="T" ORWMODE=1,ISXFER=";T" ;treat xfer as copy
"RTN","ORWDXM1",24,0)
 S:$E(ORIT)="X" ORWMODE=2
"RTN","ORWDXM1",25,0)
 S TEMPORIT=ORIT
"RTN","ORWDXM1",26,0)
 I ORWMODE S ORIT=$E(ORIT,2,999)
"RTN","ORWDXM1",27,0)
 S LST(0)=""
"RTN","ORWDXM1",28,0)
 ;disable
"RTN","ORWDXM1",29,0)
 D CHKDSBL^ORWDXM3(.LST,ORIT,ORWMODE) Q:+LST(0)=8
"RTN","ORWDXM1",30,0)
 ;action
"RTN","ORWDXM1",31,0)
 D CHKVACT^ORWDXM3(.LST,ORIT,ORWMODE,$P(FLDS,U,3)) Q:+LST(0)=8
"RTN","ORWDXM1",32,0)
 ;no copy
"RTN","ORWDXM1",33,0)
 I ORWMODE=1 D CHKCOPY^ORWDXM3(.LST,ORIT,FLDS) Q:+LST(0)=8
"RTN","ORWDXM1",34,0)
 ;change
"RTN","ORWDXM1",35,0)
 I ORWMODE=2 D BLD4CHG^ORWDXM3(.LST,ORIT,FLDS) Q
"RTN","ORWDXM1",36,0)
 I 'ORWMODE,($P(^ORD(101.41,+ORIT,0),U,4)="D"),'($O(^DIC(9.4,"C","OR",0))[$P(^ORD(101.41,+ORIT,0),U,7)) S LST(0)="0^0^"_$$DLGINFO^ORWDXM3(ORIT,ORWMODE_ISXFER) Q
"RTN","ORWDXM1",37,0)
 N ORIMTYPE,ORCOMP,ORTAS,LRFZX,LRFSAMP,LRFSPEC,LRFDATE,LRFURG,LRFSCH
"RTN","ORWDXM1",38,0)
 N ORTIME,ORCOLLCT,ORMAX,ORTEST,ORIMTIME,ORSMAX,ORSTMS,ORSCH
"RTN","ORWDXM1",39,0)
 N PSJNOPC,ORMORE,ORINPT,ORXNP,ORSCHED,ORQTY,ORNOUNS,ORXNP,OREFILLS
"RTN","ORWDXM1",40,0)
 N ORCOMPLX,ORQTY,ORCOPAY,ORDRUG,ORWPSPIK,ORWPSWRG,ORSD,ORDSUP,ORWP94
"RTN","ORWDXM1",41,0)
 N ORPARAM,ORNPO,ORTIME,ORMEAL,ORTRAY,ORDATE,GMRCNOPD,GMRCNOAT,GMRCREAF
"RTN","ORWDXM1",42,0)
 N ORTYPE,ORVP,ORL,ORNP,ORSEX,ORAGE,ORWARD,OREVENT,ORDIV,ORSC,KEYVAR
"RTN","ORWDXM1",43,0)
 N ORDG,ORDIALOG,ORCAT,FIRST,ORQUIT,X,ORTRAIL,ORLEAD,RSPREF,AUTOACK
"RTN","ORWDXM1",44,0)
 N OREVNTYP
"RTN","ORWDXM1",45,0)
 S ORWP94=$O(^ORD(101.41,"AB","PS MEDS",0))>0
"RTN","ORWDXM1",46,0)
 S ORVP=$P(FLDS,U,1)_";DPT(",ORNP=+$P(FLDS,U,3),ORSC=$P(FLDS,U,8)
"RTN","ORWDXM1",47,0)
 S ORL=$P(FLDS,U,2)_";SC(",ORL(2)=ORL
"RTN","ORWDXM1",48,0)
 S ORSEX=$P(FLDS,U,5),ORAGE=$P(FLDS,U,6),ORTYPE="Q",FIRST=1
"RTN","ORWDXM1",49,0)
 I $P(FLDS,U,4),$G(^SC(+ORL,42)) S ORWARD=+^SC(+ORL,42)
"RTN","ORWDXM1",50,0)
 I $L($P(FLDS,U,7)) D
"RTN","ORWDXM1",51,0)
 . S OREVENT=$P(FLDS,U,7)
"RTN","ORWDXM1",52,0)
 . S OREVNTYP=$P(OREVENT,";",2)
"RTN","ORWDXM1",53,0)
 . S OREVENT("TS")=$P(OREVENT,";",3)
"RTN","ORWDXM1",54,0)
 . S OREVENT("EFFECTIVE")=$P(OREVENT,";",4)
"RTN","ORWDXM1",55,0)
 . S OREVENT=+$P(OREVENT,";",1)
"RTN","ORWDXM1",56,0)
 I 'ORWMODE D
"RTN","ORWDXM1",57,0)
 . D SETKEYV^ORWDXM3($P(FLDS,U,11,20)) ; from menu path
"RTN","ORWDXM1",58,0)
 . S KEYVAR=$$KEYVAR^ORWDXM3(ORIT) ; from entry action
"RTN","ORWDXM1",59,0)
 . D SETKEYV^ORWDXM3(KEYVAR)
"RTN","ORWDXM1",60,0)
 K ^TMP("ORWORD",$J)
"RTN","ORWDXM1",61,0)
 ; init return record based on auto-accept
"RTN","ORWDXM1",62,0)
 I ORWMODE S LST(0)="2^"_ORIT ;verify on copy
"RTN","ORWDXM1",63,0)
 E  S LST(0)=+$P($G(^ORD(101.41,ORIT,5)),U,8)_U_ORIT
"RTN","ORWDXM1",64,0)
 S TEMPCAT=$S($L($P($G(^DPT(+ORVP,.1)),U)):"I",1:"O")
"RTN","ORWDXM1",65,0)
 I TEMPCAT="I",+$P(FLDS,U,4)=1,$E(TEMPORIT)="C",$P($G(^ORD(100.98,$P($G(^OR(100,+ORIT,0)),U,11),0)),U)="OUTPATIENT MEDICATIONS" S TEMPCAT="O"
"RTN","ORWDXM1",66,0)
 I $L($G(OREVNTYP)) D
"RTN","ORWDXM1",67,0)
 . S ORCAT=$S(OREVNTYP="A":"I",OREVNTYP="T":"I",OREVNTYP="O":TEMPCAT,OREVNTYP="M":TEMPCAT,OREVNTYP="C":TEMPCAT,1:"O") I $G(OREVENT) D
"RTN","ORWDXM1",68,0)
 .. N X S X=$$EVT^OREVNTX(OREVENT),X=$P($G(^ORD(100.5,+X,0)),U,7)
"RTN","ORWDXM1",69,0)
 .. I OREVNTYP="T",X,X<4 S ORCAT="O" ;To pass=outpt
"RTN","ORWDXM1",70,0)
 .. I OREVNTYP="D",X=41 S ORCAT="I" ;From ASIH=inpt
"RTN","ORWDXM1",71,0)
 E  S ORCAT=TEMPCAT
"RTN","ORWDXM1",72,0)
 D SETUP^ORWDXM4 Q:+LST(0)=8
"RTN","ORWDXM1",73,0)
 S X="OR GTX START DATE"_$S($G(ORWP94):"/TIME",1:"")
"RTN","ORWDXM1",74,0)
 I ORWMODE,(ORDG=+$O(^ORD(100.98,"B","O RX",0))) D  ;remove old values
"RTN","ORWDXM1",75,0)
 . K ORDIALOG($$PTR^ORCD(X),1)
"RTN","ORWDXM1",76,0)
 . I ORWMODE=2,$$DRAFT^ORWDX2(ORIT) Q  ;keep comments
"RTN","ORWDXM1",77,0)
 . K:ISXFER'["T" ORDIALOG($$PTR^ORCD("OR GTX WORD PROCESSING 1"),1)
"RTN","ORWDXM1",78,0)
 D SETUPS^ORWDXM4 ;moved to save space, expects X
"RTN","ORWDXM1",79,0)
 Q:+LST(0)=8
"RTN","ORWDXM1",80,0)
 I $G(ORQUIT) S LST(0)="0^0^"_$$DLGINFO^ORWDXM3(ORIT,ORWMODE_ISXFER)_"^"_$G(KEYVAR) Q
"RTN","ORWDXM1",81,0)
 N SEQ,DA,XCODE,MUSTASK,PROMPT,INST,KEY,IVFID,CLIVFID
"RTN","ORWDXM1",82,0)
 S IVFID=$O(^ORD(101.41,"B","PSJI OR PAT FLUID OE",0))
"RTN","ORWDXM1",83,0)
 S CLIVFID=$O(^ORD(101.41,"B","CLINIC OR PAT FLUID OE",0))
"RTN","ORWDXM1",84,0)
 S AUTOACK=$S($D(ORWPSWRG):0,1:1)
"RTN","ORWDXM1",85,0)
 ; If copying, clear bad dates. Later, SETITEM will fill dates with default values. ;DJE-VM *331
"RTN","ORWDXM1",86,0)
 I ORWMODE=1 D  ;
"RTN","ORWDXM1",87,0)
 . I $L($$VAL^ORCD("START DATE")) D  ;
"RTN","ORWDXM1",88,0)
 . . S X=$$VAL^ORCD("START DATE"),%DT="TX" D ^%DT
"RTN","ORWDXM1",89,0)
 . . I Y'<$$DT^XLFDT,(($L($$VAL^ORCD("STOP DATE"))=0)!('$$FTDCOMP^ORCD("START DATE","STOP DATE",">"))) Q  ;quit if valid dates: start not in the past or stop after start
"RTN","ORWDXM1",90,0)
 . . K ORDIALOG($$PTR("START DATE"),1),ORDIALOG($$PTR("START DATE/TIME"),1) ;erase bad start and stop dates.
"RTN","ORWDXM1",91,0)
 . . K ORDIALOG($$PTR("STOP DATE"),1),ORDIALOG($$PTR("STOP DATE/TIME"),1)
"RTN","ORWDXM1",92,0)
 . ; check start and stop dates found in diet orders
"RTN","ORWDXM1",93,0)
 . I $L($$VAL^ORCD("EFFECTIVE DATE/TIME")) D  ;
"RTN","ORWDXM1",94,0)
 . . S X=$$VAL^ORCD("EFFECTIVE DATE/TIME"),%DT="TX" D ^%DT
"RTN","ORWDXM1",95,0)
 . . I Y'<$$DT^XLFDT,(($L($$VAL^ORCD("EXPIRATION DATE/TIME"))=0)!('$$FTDCOMP^ORCD("EFFECTIVE DATE/TIME","EXPIRATION DATE/TIME",">"))) Q  ;quit if valid dates: start not in the past or stop after start
"RTN","ORWDXM1",96,0)
 . . K ORDIALOG($P(ORDIALOG("B","EFFECTIVE DATE/TIME"),U,2),1) ;erase bad start and stop dates.
"RTN","ORWDXM1",97,0)
 . . K ORDIALOG($P(ORDIALOG("B","EXPIRATION DATE/TIME"),U,2),1)
"RTN","ORWDXM1",98,0)
 . ; check date desired field found in imaging orders
"RTN","ORWDXM1",99,0)
 . I $L($$VAL^ORCD("DATE DESIRED")) D  ;
"RTN","ORWDXM1",100,0)
 . . S X=$$VAL^ORCD("DATE DESIRED"),%DT="TX" D ^%DT
"RTN","ORWDXM1",101,0)
 . . I Y'<$$DT^XLFDT Q  ;quit if not a past date
"RTN","ORWDXM1",102,0)
 . . K ORDIALOG($P(ORDIALOG("B","DATE DESIRED"),U,2),1) ;erase bad date
"RTN","ORWDXM1",103,0)
 . ; check collection date field found in lab orders
"RTN","ORWDXM1",104,0)
 . I $L($$VAL^ORCD("COLLECTION DATE/TIME")) D  ;
"RTN","ORWDXM1",105,0)
 . . S X=$$VAL^ORCD("COLLECTION DATE/TIME")
"RTN","ORWDXM1",106,0)
 . . I X="NEXT" Q  ;No need to check this.
"RTN","ORWDXM1",107,0)
 . . S %DT="TX" D ^%DT
"RTN","ORWDXM1",108,0)
 . . I $P(Y,".",2),Y'<$E($$NOW^XLFDT,1,12) Q  ;quit if not a past date and time (lab is more precise than other dates)
"RTN","ORWDXM1",109,0)
 . . I $P(Y,".",2)="",Y'<$$DT^XLFDT Q  ;
"RTN","ORWDXM1",110,0)
 . . K ORDIALOG($P(ORDIALOG("B","COLLECTION DATE/TIME"),U,2),1) ;erase bad date
"RTN","ORWDXM1",111,0)
 S SEQ=0 F  S SEQ=$O(^ORD(101.41,+ORDIALOG,10,"B",SEQ)) Q:'SEQ  D
"RTN","ORWDXM1",112,0)
 . S DA=0 F  S DA=$O(^ORD(101.41,+ORDIALOG,10,"B",SEQ,DA)) Q:'DA  D
"RTN","ORWDXM1",113,0)
 . . ; skip if child prmpt
"RTN","ORWDXM1",114,0)
 . . I $P(^ORD(101.41,+ORDIALOG,10,DA,0),U,11) Q
"RTN","ORWDXM1",115,0)
 . . ; set dflt for prmpt, chk if interactive
"RTN","ORWDXM1",116,0)
 . . S PROMPT=$P(^ORD(101.41,+ORDIALOG,10,DA,0),U,2)
"RTN","ORWDXM1",117,0)
 . . D SETITEM(DA,PROMPT,1,.MUSTASK)
"RTN","ORWDXM1",118,0)
 . . I MUSTASK S AUTOACK=0 Q
"RTN","ORWDXM1",119,0)
 . . ; iterate through child items if parent & edit only
"RTN","ORWDXM1",120,0)
 . . Q:'$D(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT))
"RTN","ORWDXM1",121,0)
 . . N CSEQ,CDA,CPROMPT,INST,ORQUIT
"RTN","ORWDXM1",122,0)
 . . S CSEQ=0 F  S CSEQ=$O(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT,CSEQ)) Q:'CSEQ  D  Q:$G(ORQUIT)
"RTN","ORWDXM1",123,0)
 . . . S CDA=$O(^ORD(101.41,+ORDIALOG,10,"DAD",PROMPT,CSEQ,0))
"RTN","ORWDXM1",124,0)
 . . . S CPROMPT=$P(^ORD(101.41,+ORDIALOG,10,CDA,0),U,2)
"RTN","ORWDXM1",125,0)
 . . . ; if req & no instances then need interaction
"RTN","ORWDXM1",126,0)
 . . . I $P(^ORD(101.41,+ORDIALOG,10,CDA,0),U,6) D
"RTN","ORWDXM1",127,0)
 . . . . I ORDIALOG=IVFID!(ORDIALOG=CLIVFID) Q
"RTN","ORWDXM1",128,0)
 . . . . I '$O(ORDIALOG(CPROMPT,0)) S AUTOACK=0
"RTN","ORWDXM1",129,0)
 . . . S INST=0 F  S INST=$O(ORDIALOG(CPROMPT,INST)) Q:'INST  D
"RTN","ORWDXM1",130,0)
 . . . . N ORASK D VBASK^ORWDXM4(INST) ; set ORASK for VBECS
"RTN","ORWDXM1",131,0)
 . . . . ; set dflt for each child prmpt
"RTN","ORWDXM1",132,0)
 . . . . D SETITEM(CDA,CPROMPT,INST,.MUSTASK)
"RTN","ORWDXM1",133,0)
 . . . . ; if no val & child prmpt req'd then need interaction
"RTN","ORWDXM1",134,0)
 . . . . I MUSTASK,$P(^ORD(101.41,+ORDIALOG,10,CDA,0),U,6) S AUTOACK=0
"RTN","ORWDXM1",135,0)
 N IVDLG,CLINFDLG,SPLYDLG
"RTN","ORWDXM1",136,0)
 S IVDLG=$O(^ORD(101.41,"AB","PSJI OR PAT FLUID OE",0))
"RTN","ORWDXM1",137,0)
 S CLINFDLG=$O(^ORD(101.41,"AB","CLINIC OR PAT FLUID OE",0))
"RTN","ORWDXM1",138,0)
 S SPLYDLG=$O(^ORD(101.41,"AB","PSO SUPPLY",0))
"RTN","ORWDXM1",139,0)
 I $$ISMED(ORIT),(ORDIALOG'=IVDLG),(ORDIALOG'=CLINFDLG),(ORDIALOG'=SPLYDLG),(ORCAT="I") D
"RTN","ORWDXM1",140,0)
 . F P="PATIENT INSTRUCTIONS","DAYS SUPPLY","QUANTITY","REFILLS","ROUTING","SERVICE CONNECTED" K ORDIALOG($$PTR(P),1)
"RTN","ORWDXM1",141,0)
 . I '$$ISQO(ORIT) K ORDIALOG($$PTR("START DATE/TIME"),1) ; kill if not a non-VA med quick order. p388
"RTN","ORWDXM1",142,0)
 S KEY=$S(ORWMODE:"C",1:"")_ORIT_"-"_$P($H,",",2),SEQ=0
"RTN","ORWDXM1",143,0)
 I $$ISINPMED(ORIT) D
"RTN","ORWDXM1",144,0)
 .S LEVEL=$P(LST(0),U),DELAY=$S($P($G(OREVENT),";")>0:1,1:0)
"RTN","ORWDXM1",145,0)
 .I LEVEL=2!(ISIMO) D ADMTIME^ORWDXM2(ORDLOC,PATLOC,ENCLOC,DELAY,ISIMO)
"RTN","ORWDXM1",146,0)
 I ($$ISMED(ORIT)),'($$VALQO^ORWDXM3(ORIT)) S AUTOACK=0
"RTN","ORWDXM1",147,0)
 S PROMPT=0 F  S PROMPT=$O(ORDIALOG(PROMPT)) Q:'PROMPT  D
"RTN","ORWDXM1",148,0)
 . I '$D(^ORD(101.41,ORDIALOG,10,"D",PROMPT)) K ORDIALOG(PROMPT) Q
"RTN","ORWDXM1",149,0)
 . S INST=0 F  S INST=$O(ORDIALOG(PROMPT,INST)) Q:'INST  D
"RTN","ORWDXM1",150,0)
 . . S SEQ=SEQ+1,^TMP("ORWDXMQ",$J,KEY,SEQ,0)=U_PROMPT_U_INST
"RTN","ORWDXM1",151,0)
 . . ; save word proc val
"RTN","ORWDXM1",152,0)
 . . I $E(ORDIALOG(PROMPT,0))="W",$L(ORDIALOG(PROMPT,INST)) D
"RTN","ORWDXM1",153,0)
 . . . M ^TMP("ORWDXMQ",$J,KEY,SEQ,2)=@ORDIALOG(PROMPT,INST)
"RTN","ORWDXM1",154,0)
 . . ; save other val types
"RTN","ORWDXM1",155,0)
 . . E  S ^TMP("ORWDXMQ",$J,KEY,SEQ,1)=ORDIALOG(PROMPT,INST)
"RTN","ORWDXM1",156,0)
 I AUTOACK D
"RTN","ORWDXM1",157,0)
 . I ORWMODE S AUTOACK=2
"RTN","ORWDXM1",158,0)
 . I 'ORWMODE,($P(^ORD(101.41,ORIT,0),U,8)!'LST(0)) S AUTOACK=2
"RTN","ORWDXM1",159,0)
 ;I ($$ISMED(ORIT)),'($$VALQO^ORWDXM3(ORIT)) S AUTOACK=0
"RTN","ORWDXM1",160,0)
 I ORIMO,ORWMODE S AUTOACK=2
"RTN","ORWDXM1",161,0)
 ; accept Herbal/OTC/NonVA Med quick orders
"RTN","ORWDXM1",162,0)
 I $L($G(^ORD(101.41,+ORIT,0))),($P(^ORD(100.98,$P(^ORD(101.41,+ORIT,0),U,5),0),U,3)="NV RX"),($P($G(^ORD(101.41,+ORIT,5)),U,8)) S AUTOACK=1
"RTN","ORWDXM1",163,0)
 ;I AUTOACK=2,$$ISMED(ORIT),(ORDIALOG=IVDLG),$$VERORD^ORWDXM3=0 S AUTOACK=0
"RTN","ORWDXM1",164,0)
 I AUTOACK=2,$$ISMED(ORIT),$$VERORD^ORWDXM3(ORIT)=0 S AUTOACK=0
"RTN","ORWDXM1",165,0)
 I AUTOACK=2 D VERTXT^ORWDXM2
"RTN","ORWDXM1",166,0)
 S LST(0)=AUTOACK_U_KEY_U_$$DLGINFO^ORWDXM3(ORIT,ORWMODE_ISXFER)_"^"_$G(KEYVAR)
"RTN","ORWDXM1",167,0)
 I $P(LST(0),U,4)="D" S $P(LST(0),U,4)="Q"
"RTN","ORWDXM1",168,0)
 I ORWMODE=1 S $P(LST(0),U,4)="C"
"RTN","ORWDXM1",169,0)
 K ^TMP("ORWORD",$J)
"RTN","ORWDXM1",170,0)
 K ^TMP("PSJINS",$J),^TMP("PSJMR",$J),^TMP("PSJNOUN",$J)
"RTN","ORWDXM1",171,0)
 Q
"RTN","ORWDXM1",172,0)
SETITEM(DA,PROMPT,INST,MUSTASK) ; set dflt val & return if must prompt
"RTN","ORWDXM1",173,0)
 N EDITONLY,Y,VALIV,XCODE
"RTN","ORWDXM1",174,0)
 S MUSTASK=0,EDITONLY=0,VALIV=0
"RTN","ORWDXM1",175,0)
 I $D(^TMP("ORWDHTM",$J,ORDIALOG,PROMPT)) D
"RTN","ORWDXM1",176,0)
 . I $E(ORDIALOG(PROMPT,0))="W" D
"RTN","ORWDXM1",177,0)
 . . S ^TMP("ORWORD",$J,PROMPT,INST,1,0)=^TMP("ORWDHTM",$J,ORDIALOG,PROMPT)
"RTN","ORWDXM1",178,0)
 . . S ORDIALOG(PROMPT,INST)="^TMP(""ORWORD"","_$J_","_PROMPT_","_INST_")"
"RTN","ORWDXM1",179,0)
 . E  S ORDIALOG(PROMPT,INST)=^TMP("ORWDHTM",$J,ORDIALOG,PROMPT)
"RTN","ORWDXM1",180,0)
 I $D(^TMP("ORWDHTM",$J,ORIT,PROMPT)) D
"RTN","ORWDXM1",181,0)
 . S ORDIALOG(PROMPT,INST)=^TMP("ORWDHTM",$J,ORIT,PROMPT)
"RTN","ORWDXM1",182,0)
 . ; NEED TO CLEAN UP ^TMP("ORWDHTM") after process order set!!!
"RTN","ORWDXM1",183,0)
 ;
"RTN","ORWDXM1",184,0)
 ; skip if a value already exists for this prompt and not WP
"RTN","ORWDXM1",185,0)
 Q:$D(ORDIALOG(PROMPT,INST))&($E(ORDIALOG(PROMPT,0))'="W")
"RTN","ORWDXM1",186,0)
 ; execute default action if no value in QO, checking EDITONLY afterwards
"RTN","ORWDXM1",187,0)
 I '$D(ORDIALOG(PROMPT,INST)) D
"RTN","ORWDXM1",188,0)
 . ;
"RTN","ORWDXM1",189,0)
 . ;Intermittent IV orders do not require a solution or an infusion rate
"RTN","ORWDXM1",190,0)
 . I PROMPT=$$PTR("INFUSION RATE"),$$GETIVTYP^ORWDXM3="I" S VALIV=1 Q
"RTN","ORWDXM1",191,0)
 . I PROMPT=$$PTR("ORDERABLE ITEM"),$$GETIVTYP^ORWDXM3="I" S VALIV=1 Q
"RTN","ORWDXM1",192,0)
 . I $E(ORDIALOG(PROMPT,0))="W",$D(^ORD(101.41,+ORDIALOG,10,DA,8))>9 D
"RTN","ORWDXM1",193,0)
 . . M ^TMP("ORWORD",$J,PROMPT,INST)=^ORD(101.41,+ORDIALOG,10,DA,8)
"RTN","ORWDXM1",194,0)
 . . S ORDIALOG(PROMPT,INST)="^TMP(""ORWORD"","_$J_","_PROMPT_","_INST_")"
"RTN","ORWDXM1",195,0)
 . E  D
"RTN","ORWDXM1",196,0)
 . . S XCODE=$$SUBCODE($G(^ORD(101.41,+ORDIALOG,10,DA,7)))
"RTN","ORWDXM1",197,0)
 . . I $L(XCODE) X XCODE S:$D(Y) ORDIALOG(PROMPT,INST)=Y
"RTN","ORWDXM1",198,0)
 Q:VALIV=1
"RTN","ORWDXM1",199,0)
 Q:$G(EDITONLY)
"RTN","ORWDXM1",200,0)
 I 'ORWMODE,$P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,8) Q
"RTN","ORWDXM1",201,0)
 I ORWMODE,($P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,9)'["W"),'$P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,6)!$D(ORDIALOG(PROMPT,INST)) Q
"RTN","ORWDXM1",202,0)
 I 'ORWMODE,LST(0),$D(ORDIALOG(PROMPT,INST)),($E(ORDIALOG(PROMPT,0))="W") Q
"RTN","ORWDXM1",203,0)
 I 'ORWMODE,LST(0),'$P($G(^ORD(101.41,+ORDIALOG,10,DA,0)),U,6) Q
"RTN","ORWDXM1",204,0)
 S XCODE=$$SUBCODE($G(^ORD(101.41,+ORDIALOG,10,DA,3)))
"RTN","ORWDXM1",205,0)
 I $L(XCODE) X XCODE Q:'$T
"RTN","ORWDXM1",206,0)
 S MUSTASK=1
"RTN","ORWDXM1",207,0)
 Q
"RTN","ORWDXM1",208,0)
SUBCODE(X) ; substitute code
"RTN","ORWDXM1",209,0)
 I X["$$REQDCOMM^ORCDLR" Q "I $$LRRQCM^ORWDXM2"
"RTN","ORWDXM1",210,0)
 I X["$$ASKSAMP^ORCDLR" Q "I $$LRASMP^ORWDXM2"
"RTN","ORWDXM1",211,0)
 I X["$$SCHEDULD^ORCDRA1" Q "I $$SCHEDULD^ORWDXM2"
"RTN","ORWDXM1",212,0)
 I X["(^PSX(550,""C"")" Q "S Y=$E($$DEFPICK^ORWDPS32) K:'$L(Y) Y"
"RTN","ORWDXM1",213,0)
 I X["I $$ASKURG^ORCDVBEC" Q "I 1"
"RTN","ORWDXM1",214,0)
 I X["K:$G(ORASK)" Q "I $G(ORASK)"
"RTN","ORWDXM1",215,0)
 Q X
"RTN","ORWDXM1",216,0)
PTR(NAME) ; -- Returns pointer to OR GTX NAME
"RTN","ORWDXM1",217,0)
 Q +$O(^ORD(101.41,"AB",$E("OR GTX "_NAME,1,63),0))
"RTN","ORWDXM1",218,0)
 ;
"RTN","ORWDXM1",219,0)
ISINPMED(IFN) ;
"RTN","ORWDXM1",220,0)
 N PKG,RESULT,Y
"RTN","ORWDXM1",221,0)
 I 'ORWMODE S PKG=$P($G(^ORD(101.41,IFN,0)),U,7)
"RTN","ORWDXM1",222,0)
 E  S PKG=$P($G(^OR(100,+IFN,0)),U,14)
"RTN","ORWDXM1",223,0)
 S Y=$$GET1^DIQ(9.4,+PKG_",",1)
"RTN","ORWDXM1",224,0)
 S RESULT=$S($E(Y,1,3)="PSJ":1,1:0)
"RTN","ORWDXM1",225,0)
 Q RESULT
"RTN","ORWDXM1",226,0)
 ;
"RTN","ORWDXM1",227,0)
ISMED(IFN) ; return 1 if pharmacy order dlg used
"RTN","ORWDXM1",228,0)
 N PKG
"RTN","ORWDXM1",229,0)
 I 'ORWMODE S PKG=$P($G(^ORD(101.41,IFN,0)),U,7)
"RTN","ORWDXM1",230,0)
 E  S PKG=$P($G(^OR(100,+IFN,0)),U,14)
"RTN","ORWDXM1",231,0)
 Q $$NMSP^ORCD(PKG)="PS"
"RTN","ORWDXM1",232,0)
SITEVAL() ;return 1 if site does want the reason for study to carry through from past orders of this ordering session
"RTN","ORWDXM1",233,0)
 I $$GET^XPAR("ALL^SRV.`"_+^VA(200,DUZ,5),"OR RA RFS CARRY ON")=0 Q 0
"RTN","ORWDXM1",234,0)
 Q 1
"RTN","ORWDXM1",235,0)
SVRPC(RET,X) ;RPC FOR SITEVAL
"RTN","ORWDXM1",236,0)
 S RET=$$SITEVAL
"RTN","ORWDXM1",237,0)
 Q
"RTN","ORWDXM1",238,0)
ISQO(IFN) ;return 1 if a non-VA medication quick order type of order dialog. p388
"RTN","ORWDXM1",239,0)
 I $P($G(^ORD(101.41,IFN,0)),U,5)'=$O(^ORD(100.98,"B","NV RX",0)) Q 0
"RTN","ORWDXM1",240,0)
 I $P($G(^ORD(101.41,IFN,0)),U,4)="Q" Q 1
"RTN","ORWDXM1",241,0)
 Q 0
"RTN","ORWDXM3")
0^67^B111449239
"RTN","ORWDXM3",1,0)
ORWDXM3 ; SLC/KCM/JLI - Quick Orders ;11/10/15  11:45
"RTN","ORWDXM3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,131,132,141,185,187,190,195,215,243,303,296,280,350**;Dec 17, 1997;Build 77
"RTN","ORWDXM3",3,0)
 ;
"RTN","ORWDXM3",4,0)
 ;
"RTN","ORWDXM3",5,0)
 ;
"RTN","ORWDXM3",6,0)
VALCOUNT(NAME,ORDIALOG) ;
"RTN","ORWDXM3",7,0)
 N COUNT,IEN,NUM
"RTN","ORWDXM3",8,0)
 S NUM=0,COUNT=0
"RTN","ORWDXM3",9,0)
 S IEN=$P($G(ORDIALOG("B",NAME)),U,2) Q:IEN'>0
"RTN","ORWDXM3",10,0)
 F  S NUM=$O(ORDIALOG(IEN,NUM)) Q:+NUM'>0  S COUNT=COUNT+1
"RTN","ORWDXM3",11,0)
 Q COUNT
"RTN","ORWDXM3",12,0)
 ;
"RTN","ORWDXM3",13,0)
ISMISSFL(ORDIALOG,IVTYPE) ;
"RTN","ORWDXM3",14,0)
 N ADDCNT,RESULT,SOLCNT,STRCNT
"RTN","ORWDXM3",15,0)
 S RESULT=0
"RTN","ORWDXM3",16,0)
 S ADDCNT=$$VALCOUNT("ADDITIVE",.ORDIALOG)
"RTN","ORWDXM3",17,0)
 S STRCNT=$$VALCOUNT("STRENGTH",.ORDIALOG)
"RTN","ORWDXM3",18,0)
 S SOLCNT=$$VALCOUNT("SOLUTION",.ORDIALOG)
"RTN","ORWDXM3",19,0)
 I IVTYPE'="I",ADDCNT'=STRCNT S RESULT=1
"RTN","ORWDXM3",20,0)
 I IVTYPE="I" D
"RTN","ORWDXM3",21,0)
 .I ADDCNT=0,SOLCNT>0 Q
"RTN","ORWDXM3",22,0)
 .I ADDCNT=0 S RESULT=1 Q
"RTN","ORWDXM3",23,0)
 .I ADDCNT'=STRCNT S RESULT=1 Q
"RTN","ORWDXM3",24,0)
 Q RESULT
"RTN","ORWDXM3",25,0)
 ;
"RTN","ORWDXM3",26,0)
IVADFCHK(ORDIALOG) ;
"RTN","ORWDXM3",27,0)
 ; This line tag checks to see if there are the same number of values
"RTN","ORWDXM3",28,0)
 ;for ADDITIVE and Additive Frequency. This also checks to see if
"RTN","ORWDXM3",29,0)
 ;the value assigned to ADDFREQ is one of the three possible values
"RTN","ORWDXM3",30,0)
 ;All Bags, 1 bag/day, See Comments. If See Comments it also checks
"RTN","ORWDXM3",31,0)
 ;for text in the comment section.
"RTN","ORWDXM3",32,0)
 N ADDCNT,ADDFCNT,ADDFREQ,COMMENT,FREQ,INST,RESULT
"RTN","ORWDXM3",33,0)
 S ADDCNT=$$VALCOUNT("ADDITIVE",.ORDIALOG)
"RTN","ORWDXM3",34,0)
 S ADDFCNT=$$VALCOUNT("ADDITIVE FREQUENCY",.ORDIALOG)
"RTN","ORWDXM3",35,0)
 I ADDCNT'=ADDFCNT Q 0
"RTN","ORWDXM3",36,0)
 S ADDFREQ=$O(^ORD(101.41,"AB","OR GTX ADDITIVE FREQUENCY",""))
"RTN","ORWDXM3",37,0)
 S COMMENT=$O(^ORD(101.41,"AB","OR GTX WORD PROCESSING 1",""))
"RTN","ORWDXM3",38,0)
 I +$G(ADDFREQ)'>0 Q O
"RTN","ORWDXM3",39,0)
 S INST=0,RESULT=1
"RTN","ORWDXM3",40,0)
 F  S INST=$O(ORDIALOG(ADDFREQ,INST)) Q:INST'>0!(RESULT=0)  D
"RTN","ORWDXM3",41,0)
 .S FREQ=$$ADDFRQCV^ORMBLDP1($G(ORDIALOG(ADDFREQ,INST)),"O")
"RTN","ORWDXM3",42,0)
 .I FREQ="A"!(FREQ=1) Q
"RTN","ORWDXM3",43,0)
 .I FREQ="" S RESULT=0 Q
"RTN","ORWDXM3",44,0)
 .I FREQ="S",'$L($G(ORDIALOG(COMMENT,1))) S RESULT=0 Q
"RTN","ORWDXM3",45,0)
 Q RESULT
"RTN","ORWDXM3",46,0)
 ;
"RTN","ORWDXM3",47,0)
KEYVAR(DLG)  ; Parse entry action for key variables & return in string
"RTN","ORWDXM3",48,0)
 ; RV=CollTp^Samp^Spec^CollDt^Urg^Sched^NoComm^NoDiag^NoProv^NoRsn
"RTN","ORWDXM3",49,0)
 N XCODE,RV,POS,Z
"RTN","ORWDXM3",50,0)
 S XCODE=$G(^ORD(101.41,DLG,3)),RV=""
"RTN","ORWDXM3",51,0)
 I '$L(XCODE) Q ""
"RTN","ORWDXM3",52,0)
 S POS=$F(XCODE,"LRFZX=")    I POS S $P(RV,U,1)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",53,0)
 S POS=$F(XCODE,"LRFSAMP=")  I POS S $P(RV,U,2)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",54,0)
 S POS=$F(XCODE,"LRFSPEC=")  I POS S $P(RV,U,3)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",55,0)
 S POS=$F(XCODE,"LRFDATE=")  I POS S $P(RV,U,4)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",56,0)
 S POS=$F(XCODE,"LRFURG=")   I POS S $P(RV,U,5)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",57,0)
 S POS=$F(XCODE,"LRFSCH=")   I POS S $P(RV,U,6)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",58,0)
 S POS=$F(XCODE,"PSJNOPC=")  I POS S $P(RV,U,7)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",59,0)
 S POS=$F(XCODE,"GMRCNOPD=") I POS S $P(RV,U,8)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",60,0)
 S POS=$F(XCODE,"GMRCNOAT=") I POS S $P(RV,U,9)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",61,0)
 S POS=$F(XCODE,"GMRCREAF=") I POS S $P(RV,U,10)=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",62,0)
 S POS=$F(XCODE,"ORFORGET=") I POS D
"RTN","ORWDXM3",63,0)
 . ; need to change this so that it is executed in SETKEYV so
"RTN","ORWDXM3",64,0)
 . ; that it is executed each time menu is revisited
"RTN","ORWDXM3",65,0)
 . N ORFORGET S ORFORGET=$$VALUE(XCODE,POS)
"RTN","ORWDXM3",66,0)
 . I ORFORGET K ^TMP("ORECALL",$J,+ORFORGET)
"RTN","ORWDXM3",67,0)
 . E  K ^TMP("ORECALL",$J)
"RTN","ORWDXM3",68,0)
 Q RV
"RTN","ORWDXM3",69,0)
VALUE(STR,BEG) ; Return value of "var=" (copied from ORCONVRT)
"RTN","ORWDXM3",70,0)
 N X,Y,I S X=$E(STR,BEG,999),Y=""
"RTN","ORWDXM3",71,0)
 S:$E(X)="""" X=$E(X,2,999) ; strip leading "
"RTN","ORWDXM3",72,0)
 F I=1:1:$L(X) S Z=$E(X,I) Q:(Z=",")!(Z=" ")!(Z="""")  S Y=Y_Z
"RTN","ORWDXM3",73,0)
 Q $TR(Y,U,"")
"RTN","ORWDXM3",74,0)
 ;
"RTN","ORWDXM3",75,0)
SETKEYV(X)      ; Set the key variables based on contents of X
"RTN","ORWDXM3",76,0)
 I $L($P(X,U,1))  S LRFZX=$P(X,U,1)
"RTN","ORWDXM3",77,0)
 I $L($P(X,U,2))  S LRFSAMP=$P(X,U,2)
"RTN","ORWDXM3",78,0)
 I $L($P(X,U,3))  S LRFSPEC=$P(X,U,3)
"RTN","ORWDXM3",79,0)
 I $L($P(X,U,4))  S LRFDATE=$P(X,U,4)
"RTN","ORWDXM3",80,0)
 I $L($P(X,U,5))  S LRFURG=$P(X,U,5)
"RTN","ORWDXM3",81,0)
 I $L($P(X,U,6))  S LRFSCH=$P(X,U,6)
"RTN","ORWDXM3",82,0)
 I $L($P(X,U,7))  S PSJNOPC=$P(X,U,7)
"RTN","ORWDXM3",83,0)
 I $L($P(X,U,8))  S GMRCNOPD=$P(X,U,8)
"RTN","ORWDXM3",84,0)
 I $L($P(X,U,9))  S GMRCNOAT=$P(X,U,9)
"RTN","ORWDXM3",85,0)
 I $L($P(X,U,10)) S GMRCREAF=$P(X,U,10)
"RTN","ORWDXM3",86,0)
 Q
"RTN","ORWDXM3",87,0)
DLGINFO(IEN,MODE)    ; return information about a dialog
"RTN","ORWDXM3",88,0)
 ; IEN=DlgIEN or ORIFN, MODE=0:Dlg,1:Copy,2:Change
"RTN","ORWDXM3",89,0)
 ; RESULT=DlgIEN^DlgType^FormID^DGrp
"RTN","ORWDXM3",90,0)
 ; If MODE="1;T",don't check "PS MEDS" for transfer order
"RTN","ORWDXM3",91,0)
 ; PSMDGP=1: Unit/Dose  Group
"RTN","ORWDXM3",92,0)
 ; PSMDGP=2: OutPatient Group
"RTN","ORWDXM3",93,0)
 N X0,DLGIEN,TYP,FID,DGRP,PSMDGP,ISXF
"RTN","ORWDXM3",94,0)
 S PSMDGP=0,ISXF=""
"RTN","ORWDXM3",95,0)
 S ISXF=$P(MODE,";",2)
"RTN","ORWDXM3",96,0)
 S MODE=+MODE
"RTN","ORWDXM3",97,0)
 S DLGIEN=IEN I MODE,(ISXF'="T") D
"RTN","ORWDXM3",98,0)
 . S DLGIEN=+$P($G(^OR(100,+IEN,0)),U,5)
"RTN","ORWDXM3",99,0)
 . I $P(^ORD(101.41,DLGIEN,0),U)="PS MEDS" D
"RTN","ORWDXM3",100,0)
 . . N PTCAT S PTCAT=$P($G(^OR(100,+IEN,0)),U,12)
"RTN","ORWDXM3",101,0)
 . . I PTCAT="I" S DLGIEN=$O(^ORD(101.41,"B","PSJ OR PAT OE",0)),PSMDGP=1
"RTN","ORWDXM3",102,0)
 . . I PTCAT="O" S DLGIEN=$O(^ORD(101.41,"B","PSO OERR",0)),PSMDGP=2
"RTN","ORWDXM3",103,0)
 I MODE,(ISXF="T") S DLGIEN=+$P($G(^OR(100,+IEN,0)),U,5)
"RTN","ORWDXM3",104,0)
 S X0=$G(^ORD(101.41,DLGIEN,0)),TYP=$P(X0,U,4),DGRP=$P(X0,U,5)
"RTN","ORWDXM3",105,0)
 I MODE S DGRP=+$P($G(^OR(100,+IEN,0)),U,11)
"RTN","ORWDXM3",106,0)
 ;JD NEW START 11/13/02
"RTN","ORWDXM3",107,0)
 I DLGIEN=$O(^ORD(101.41,"B","PSJ OR PAT OE",0)) S PSMDGP=1
"RTN","ORWDXM3",108,0)
 I DLGIEN=$O(^ORD(101.41,"B","PSO OERR",0)) S PSMDGP=2
"RTN","ORWDXM3",109,0)
 ;JD NEW END 11/13/02
"RTN","ORWDXM3",110,0)
 ; for copy or change, if the base dialog has changed, use it's info
"RTN","ORWDXM3",111,0)
 I MODE,$G(ORDIALOG),(+DLGIEN'=+ORDIALOG),(PSMDGP=0) D
"RTN","ORWDXM3",112,0)
 . S DLGIEN=+ORDIALOG,DGRP=$P(^ORD(101.41,+ORDIALOG,0),U,5)
"RTN","ORWDXM3",113,0)
 D FORMID^ORWDXM(.FID,DLGIEN)
"RTN","ORWDXM3",114,0)
 Q DLGIEN_U_TYP_U_FID_U_DGRP
"RTN","ORWDXM3",115,0)
 ;
"RTN","ORWDXM3",116,0)
CHKDSBL(LST,ID,MODE)  ; return message if dialog disabled
"RTN","ORWDXM3",117,0)
 ; ID=DlgIEN or ORIFN, MODE=0:Dialog,1:Copy,2:Change
"RTN","ORWDXM3",118,0)
 ; LST=QL_REJECT + disabled message or unchanged
"RTN","ORWDXM3",119,0)
 S DLGIEN=+ID I MODE S DLGIEN=+$P($G(^OR(100,+ID,0)),U,5)
"RTN","ORWDXM3",120,0)
 S X0=$G(^ORD(101.41,DLGIEN,0)),X=$P(X0,U,3)
"RTN","ORWDXM3",121,0)
 I '$L(X),($P(X0,U,4)="Q") D  ; check default dialog
"RTN","ORWDXM3",122,0)
 . S DLGIEN=+$$DEFDLG^ORWDXQ($P(X0,U,5))
"RTN","ORWDXM3",123,0)
 . S X=$P($G(^ORD(101.41,DLGIEN,0)),U,3)
"RTN","ORWDXM3",124,0)
 I $L(X) D
"RTN","ORWDXM3",125,0)
 . I MODE D GETTXT^ORWORR(.LST,ID) S LST(.6)="",LST(.7)="Cannot "_$S(MODE=1:"Copy",1:"Change")_" -"
"RTN","ORWDXM3",126,0)
 . S LST(0)="8^0",LST(.5)="Dialog Disabled:  "_X
"RTN","ORWDXM3",127,0)
 Q
"RTN","ORWDXM3",128,0)
CHKVACT(LST,ID,MODE,ORNP)  ; return message if action not valid
"RTN","ORWDXM3",129,0)
 ; ID=DlgIEN or ORIFN, MODE=0:Dialog,1:Copy,2:Change
"RTN","ORWDXM3",130,0)
 ; LST=QL_REJECT + invalid action message or unchanged
"RTN","ORWDXM3",131,0)
 Q:'MODE  ; not an action on an order
"RTN","ORWDXM3",132,0)
 N X,ACT S ACT=$S(MODE=1:"RW",MODE=2:"XX",1:"")
"RTN","ORWDXM3",133,0)
 D VALID^ORWDXA(.X,ID,ACT,ORNP)
"RTN","ORWDXM3",134,0)
 I $L(X) D GETTXT^ORWORR(.LST,ID) D
"RTN","ORWDXM3",135,0)
 . S LST(0)="8^0",LST(.5)=X,LST(.6)="",LST(.7)="Cannot "_$S(MODE=1:"Copy",1:"Change")_" -"
"RTN","ORWDXM3",136,0)
 Q
"RTN","ORWDXM3",137,0)
CHKCOPY(LST,ID,FLDS)  ; return message if can't copy this order
"RTN","ORWDXM3",138,0)
 ; ID=ORIFN;ACT FLDS=EventType in 7th piece
"RTN","ORWDXM3",139,0)
 ; LST=QL_REJECT + cannot copy message or unchanged
"RTN","ORWDXM3",140,0)
 I "^A^D^T^"'[(U_$E($P(FLDS,U,7))_U) Q             ; not event delayed
"RTN","ORWDXM3",141,0)
 N PKG S PKG=$P($G(^OR(100,+ID,0)),U,14)
"RTN","ORWDXM3",142,0)
 S PKG=$$NMSP^ORCD(PKG) I PKG="OR"!(PKG="PS") Q    ; xfer meds, generics
"RTN","ORWDXM3",143,0)
 N ORWCAT S ORWCAT=$P($G(^OR(100,+ID,0)),U,12)
"RTN","ORWDXM3",144,0)
 I ORWCAT="I",("^A^T^"[(U_$E($P(FLDS,U,7))_U)) Q   ; admit, xfer inpt
"RTN","ORWDXM3",145,0)
 I ORWCAT="O",$E($P(FLDS,U,7))="D" Q               ; discharge outpt
"RTN","ORWDXM3",146,0)
 D GETTXT^ORWORR(.LST,ID)
"RTN","ORWDXM3",147,0)
 I ORWCAT="I" S LST(.5)="inpatient order to outpatient -"
"RTN","ORWDXM3",148,0)
 I ORWCAT="O" S LST(.5)="outpatient order to inpatient -"
"RTN","ORWDXM3",149,0)
 S:$D(LST(.5)) LST(.5)="Cannot copy the following "_LST(.5)
"RTN","ORWDXM3",150,0)
 S LST(0)="8^0",LST(.7)=""
"RTN","ORWDXM3",151,0)
 Q
"RTN","ORWDXM3",152,0)
BLD4CHG(LST,ID,FLDS)  ; build responses for an edit
"RTN","ORWDXM3",153,0)
 ; ID=ORIFN;ACT FLDS=unused right now
"RTN","ORWDXM3",154,0)
 ; LST(0)=Qlvl^RespID(XOrderID)^DlgIEN^DlgType^FormID^DGrp
"RTN","ORWDXM3",155,0)
 N OIDX,OI,CNT
"RTN","ORWDXM3",156,0)
 S (OI,OIDX,CNT)=0
"RTN","ORWDXM3",157,0)
 S:$D(^OR(100,+ID,4.5,"ID","ORDERABLE")) OIDX=$O(^OR(100,+ID,4.5,"ID","ORDERABLE",0))
"RTN","ORWDXM3",158,0)
 I $D(^OR(100,+ID,4.5,OIDX)) D
"RTN","ORWDXM3",159,0)
 . F  S CNT=$O(^OR(100,+ID,4.5,OIDX,CNT)) Q:'CNT  D
"RTN","ORWDXM3",160,0)
 . . S OI=^(CNT) D VALDOI
"RTN","ORWDXM3",161,0)
 I +LST(0)=8 S LST(.5)="You can not change this order." Q
"RTN","ORWDXM3",162,0)
 S LST(0)="0^X"_ID_U_$$DLGINFO(+ID,2)
"RTN","ORWDXM3",163,0)
 S $P(LST(0),U,4)="X"
"RTN","ORWDXM3",164,0)
 Q
"RTN","ORWDXM3",165,0)
GETIVTYP() ;
"RTN","ORWDXM3",166,0)
 N RESULT,TYPEIEN
"RTN","ORWDXM3",167,0)
 S RESULT=""
"RTN","ORWDXM3",168,0)
 S TYPEIEN=$O(^ORD(101.41,"B","OR GTX IV TYPE","")) I TYPEIEN'>0 Q RESULT
"RTN","ORWDXM3",169,0)
 S RESULT=$G(ORDIALOG(TYPEIEN,1))
"RTN","ORWDXM3",170,0)
 Q RESULT
"RTN","ORWDXM3",171,0)
 ;
"RTN","ORWDXM3",172,0)
VALDOI ; Validate the Orderable Items
"RTN","ORWDXM3",173,0)
 N ORQUIT,ORPS
"RTN","ORWDXM3",174,0)
 I $G(^ORD(101.43,OI,.1)),^(.1)'>$$NOW^XLFDT D
"RTN","ORWDXM3",175,0)
 . S ORQUIT=1
"RTN","ORWDXM3",176,0)
 . S LST(0)="8^0"
"RTN","ORWDXM3",177,0)
 I $D(ORQUIT) Q:ORQUIT
"RTN","ORWDXM3",178,0)
 S ORPS=$G(^ORD(101.43,+OI,"PS"))
"RTN","ORWDXM3",179,0)
 I $P(ORPS,U,1,4)="0^0^0^0",($P(ORPS,U,7)=0) S LST(0)="8^0"
"RTN","ORWDXM3",180,0)
 Q
"RTN","ORWDXM3",181,0)
VERDUR(ORDIALOG) ;
"RTN","ORWDXM3",182,0)
 ;check for duration value if a THEN conjunation is used
"RTN","ORWDXM3",183,0)
 N CONJ,CONVALUE,DUR,I,SUCC
"RTN","ORWDXM3",184,0)
 S SUCC=1
"RTN","ORWDXM3",185,0)
 S CONJ=$$PTR^ORCDPS1("AND/THEN")
"RTN","ORWDXM3",186,0)
 S DUR=$$PTR^ORCDPS1("DURATION")
"RTN","ORWDXM3",187,0)
 S I=0 F  S I=$O(ORDIALOG(CONJ,I)) Q:I'>0!(SUCC=0)  D
"RTN","ORWDXM3",188,0)
 . I $$UP^XLFSTR($E($G(ORDIALOG(CONJ,I)),1))="T" D
"RTN","ORWDXM3",189,0)
 . . I '$L($G(ORDIALOG(DUR,I))) S SUCC=0
"RTN","ORWDXM3",190,0)
 Q SUCC
"RTN","ORWDXM3",191,0)
 ;
"RTN","ORWDXM3",192,0)
VERORD(OIEN) ;
"RTN","ORWDXM3",193,0)
 N IFN,INFUSE,INFUID,ODG,ODP,ASSIV,SUCC,TYPE
"RTN","ORWDXM3",194,0)
 S SUCC=0,IFN=ORDIALOG
"RTN","ORWDXM3",195,0)
 S ODP=+$P($G(^ORD(101.41,+IFN,0)),U,7),ODG=+$P($G(^(0)),U,5)
"RTN","ORWDXM3",196,0)
 S ODP=$$GET1^DIQ(9.4,+ODP_",",1),ODG=$P($G(^ORD(100.98,ODG,0)),U,3)
"RTN","ORWDXM3",197,0)
 I ODP'["PS" Q 1
"RTN","ORWDXM3",198,0)
 I ODP="PSH" Q 1
"RTN","ORWDXM3",199,0)
 ;check infusion rate for IV QO
"RTN","ORWDXM3",200,0)
 I ODG="IV RX"!(ODG="TPN") D  Q SUCC
"RTN","ORWDXM3",201,0)
 .S TYPE=$$GETIVTYP
"RTN","ORWDXM3",202,0)
 .I TYPE=""
"RTN","ORWDXM3",203,0)
 .S PASSIV=$$IVRTECHK
"RTN","ORWDXM3",204,0)
 .I PASSIV=0
"RTN","ORWDXM3",205,0)
 .S INFUID=$O(^ORD(101.41,"B","OR GTX INFUSION RATE",0))
"RTN","ORWDXM3",206,0)
 .S INFUSE=$G(ORDIALOG(INFUID,1))
"RTN","ORWDXM3",207,0)
 .S SUCC=$$VALINF(TYPE,INFUSE)
"RTN","ORWDXM3",208,0)
 .I SUCC=0 Q
"RTN","ORWDXM3",209,0)
 .I TYPE="C" S SUCC=$$IVADFCHK(.ORDIALOG)
"RTN","ORWDXM3",210,0)
 I (ODP="PSJ")!(ODP="PSO"),ODG'="IV RX",ODG'="TPN" S SUCC=$$VERDUR(.ORDIALOG)
"RTN","ORWDXM3",211,0)
 Q SUCC
"RTN","ORWDXM3",212,0)
 ;
"RTN","ORWDXM3",213,0)
VALINF(TYPE,INFUSE) ;
"RTN","ORWDXM3",214,0)
 N SUCC
"RTN","ORWDXM3",215,0)
 S SUCC=0
"RTN","ORWDXM3",216,0)
 I TYPE="I" D  Q SUCC
"RTN","ORWDXM3",217,0)
 .I INFUSE="" S SUCC=1 Q
"RTN","ORWDXM3",218,0)
 .I $TR(INFUSE,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")["INFUSE OVER" S SUCC=1 Q
"RTN","ORWDXM3",219,0)
 .I $L(INFUSE)>4 Q
"RTN","ORWDXM3",220,0)
 Q 1
"RTN","ORWDXM3",221,0)
 ;
"RTN","ORWDXM3",222,0)
VALQO(IFN) ;Check to see if it's a good QO med
"RTN","ORWDXM3",223,0)
 ;If it's an IV QO: check if infusion rate entered
"RTN","ORWDXM3",224,0)
 ;If it's an UD QO: check if dosage entered
"RTN","ORWDXM3",225,0)
 ;regular order treated as good QO
"RTN","ORWDXM3",226,0)
 ;
"RTN","ORWDXM3",227,0)
 I IFN[";",($$UPCTCHK^ORWDXA(+IFN)) Q 0
"RTN","ORWDXM3",228,0)
 I $P($G(^ORD(101.41,IFN,0)),U,4)'="Q" Q 1
"RTN","ORWDXM3",229,0)
 N ODP,ODG,INFUID,INFUSE,DSAGEID,SUCC,PASSIV,TYPE,PRIORID,DONEID,OK
"RTN","ORWDXM3",230,0)
 S SUCC=0
"RTN","ORWDXM3",231,0)
 S ODP=+$P($G(^ORD(101.41,IFN,0)),U,7),ODG=+$P($G(^(0)),U,5)
"RTN","ORWDXM3",232,0)
 S ODP=$$GET1^DIQ(9.4,+ODP_",",1),ODG=$P($G(^ORD(100.98,ODG,0)),U,3)
"RTN","ORWDXM3",233,0)
 I ODP'["PS" Q 1
"RTN","ORWDXM3",234,0)
 I ODP="PSH" Q 1
"RTN","ORWDXM3",235,0)
 ;check for DONE urgency/priority on Outpatient QO
"RTN","ORWDXM3",236,0)
 I ODG="O RX" D  Q:'OK 0
"RTN","ORWDXM3",237,0)
 . S OK=1,PRIORID=$O(^ORD(101.41,"B","OR GTX URGENCY",0)) Q:'PRIORID
"RTN","ORWDXM3",238,0)
 . S DONEID=$O(^ORD(101.42,"B","DONE",0)) Q:'DONEID
"RTN","ORWDXM3",239,0)
 . I $G(ORDIALOG(PRIORID,1))=DONEID S OK=0
"RTN","ORWDXM3",240,0)
 ;check infusion rate for IV QO
"RTN","ORWDXM3",241,0)
 I ODG="IV RX"!(ODG="TPN") D
"RTN","ORWDXM3",242,0)
 . S INFUID=$O(^ORD(101.41,"B","OR GTX INFUSION RATE",0))
"RTN","ORWDXM3",243,0)
 . S TYPE=$$GETIVTYP
"RTN","ORWDXM3",244,0)
 . I TYPE="" Q
"RTN","ORWDXM3",245,0)
 . I $D(ORDIALOG(INFUID,1)) D
"RTN","ORWDXM3",246,0)
 . . I TYPE="I" D  Q
"RTN","ORWDXM3",247,0)
 . . . S INFUSE=$G(ORDIALOG(INFUID,1))
"RTN","ORWDXM3",248,0)
 . . . I INFUSE="" Q
"RTN","ORWDXM3",249,0)
 . . . I INFUSE["INFUSE OVER" S SUCC=1 Q
"RTN","ORWDXM3",250,0)
 . . . I $L(INFUSE)>4 Q
"RTN","ORWDXM3",251,0)
 . . . I +INFUSE>0 S INFUSE="INFUSE OVER "_INFUSE_" Minutes"
"RTN","ORWDXM3",252,0)
 . . . S ORDIALOG(INFUID,1)=INFUSE,SUCC=1
"RTN","ORWDXM3",253,0)
 . . S SUCC=1
"RTN","ORWDXM3",254,0)
 . ; additive frequency check/infusion rate checks for continuous orders
"RTN","ORWDXM3",255,0)
 . I TYPE="C" D  I SUCC=0 Q
"RTN","ORWDXM3",256,0)
 . . I $D(ORDIALOG(INFUID,1)) S SUCC=1 I SUCC=0 Q
"RTN","ORWDXM3",257,0)
 . . S SUCC=$$IVADFCHK(.ORDIALOG)
"RTN","ORWDXM3",258,0)
 . I SUCC=0 Q
"RTN","ORWDXM3",259,0)
 . I '$D(ORDIALOG(INFUID,1)),TYPE="I" S SUCC=1
"RTN","ORWDXM3",260,0)
 . S PASSIV=$$IVRTECHK
"RTN","ORWDXM3",261,0)
 . I SUCC=0 Q
"RTN","ORWDXM3",262,0)
 . I PASSIV=0 S SUCC=0
"RTN","ORWDXM3",263,0)
 . I SUCC=1,$$ISMISSFL(.ORDIALOG,TYPE)=1 S SUCC=0
"RTN","ORWDXM3",264,0)
 ;check dosage for UD QO
"RTN","ORWDXM3",265,0)
 I (ODP="PSJ")!(ODP="PSO"),ODG'="IV RX",ODG'="TPN" D
"RTN","ORWDXM3",266,0)
 . S DSAGEID=$O(^ORD(101.41,"B","OR GTX INSTRUCTIONS",0))
"RTN","ORWDXM3",267,0)
 . I $D(ORDIALOG(DSAGEID,1)) S SUCC=1
"RTN","ORWDXM3",268,0)
 . I SUCC=0 Q
"RTN","ORWDXM3",269,0)
 . ;
"RTN","ORWDXM3",270,0)
 . S SUCC=$$VERDUR(.ORDIALOG)
"RTN","ORWDXM3",271,0)
 ;
"RTN","ORWDXM3",272,0)
 I SUCC=1,$P($G(^ORD(101.41,IFN,5)),U,8) D
"RTN","ORWDXM3",273,0)
 .N COMMID,WPCNT
"RTN","ORWDXM3",274,0)
 .S COMMID=$O(^ORD(101.41,"B","OR GTX WORD PROCESSING 1",0))
"RTN","ORWDXM3",275,0)
 .S COMMID=$O(^ORD(101.41,IFN,6,"D",COMMID,0))
"RTN","ORWDXM3",276,0)
 .I COMMID S WPCNT=0 F  S WPCNT=$O(^ORD(101.41,IFN,6,COMMID,2,WPCNT)) Q:'WPCNT!('SUCC)  D
"RTN","ORWDXM3",277,0)
 ..I ^ORD(101.41,IFN,6,COMMID,2,WPCNT,0)["^" S SUCC=0
"RTN","ORWDXM3",278,0)
 Q SUCC
"RTN","ORWDXM3",279,0)
 ;
"RTN","ORWDXM3",280,0)
IVRTECHK() ;
"RTN","ORWDXM3",281,0)
 N RTIEN,RTVALUE,RESULT
"RTN","ORWDXM3",282,0)
 N CNT,NUM,ORDERIDS,OIIEN,OTYPE,ROUTE
"RTN","ORWDXM3",283,0)
 S CNT=0,RESULT=0
"RTN","ORWDXM3",284,0)
 S RTIEN=+$P($G(ORDIALOG("B","ROUTE")),U,2) I RTIEN'>0 Q RESULT
"RTN","ORWDXM3",285,0)
 S RTVALUE=+$G(ORDIALOG(RTIEN,1)) I RTVALUE'>0 Q RESULT
"RTN","ORWDXM3",286,0)
 F OTYPE="SOLUTION","ADDITIVE" D
"RTN","ORWDXM3",287,0)
 .S OIIEN=+$P($G(ORDIALOG("B",OTYPE)),U,2) I OIIEN>0 D
"RTN","ORWDXM3",288,0)
 ..S NUM=0 F  S NUM=$O(ORDIALOG(OIIEN,NUM)) Q:NUM'>0  I +$G(ORDIALOG(OIIEN,NUM))>0 D
"RTN","ORWDXM3",289,0)
 ...S CNT=CNT+1,ORDERIDS(CNT)=ORDIALOG(OIIEN,NUM)
"RTN","ORWDXM3",290,0)
 I $D(ORDERIDS)=0 Q
"RTN","ORWDXM3",291,0)
 S ROUTE=$$IVQOVAL^ORWDPS33(.ORDERIDS,RTVALUE)
"RTN","ORWDXM3",292,0)
 I ROUTE="" S ORDIALOG(RTIEN,1)=ROUTE
"RTN","ORWDXM3",293,0)
 I ROUTE'="" S RESULT=1
"RTN","ORWDXM3",294,0)
 ;K ^TMP($J,"ORWDXM3 IVRTECHK")
"RTN","ORWDXM3",295,0)
 ;D ALL^PSS51P2(RTVALUE,,,,"ORWDXM3 IVRTECHK")
"RTN","ORWDXM3",296,0)
 ;I +^TMP($J,"ORWDXM3 IVRTECHK",RTVALUE,6)'=1 S ORDIALOG(RTIEN,1)="",RESULT=0
"RTN","ORWDXM3",297,0)
 ;K ^TMP($J,"ORWDXM3 IVRTECHK")
"RTN","ORWDXM3",298,0)
 Q RESULT
"RTN","ORWDXM3",299,0)
 ;
"RTN","ORWDXM3",300,0)
ISUDQO(ORY,DLGID) ;True: is unit dose quick order
"RTN","ORWDXM3",301,0)
 S ORY=0
"RTN","ORWDXM3",302,0)
 Q:'$D(^ORD(101.41,DLGID,0))
"RTN","ORWDXM3",303,0)
 N CLODGRP,CLIVDGRP,UDGRP1,UDGRP2,DLGTYP,DLGGRP
"RTN","ORWDXM3",304,0)
 S UDGRP1=$O(^ORD(100.98,"B","UD RX",0))
"RTN","ORWDXM3",305,0)
 S UDGRP2=$O(^ORD(100.98,"B","I RX",0))
"RTN","ORWDXM3",306,0)
 S CLODGRP=$O(^ORD(100.98,"B","CLINIC MEDICATIONS",""))
"RTN","ORWDXM3",307,0)
 S CLIVDGRP=$O(^ORD(100.98,"B","CLINIC INFUSIONS",""))
"RTN","ORWDXM3",308,0)
 S DLGTYP=$P($G(^ORD(101.41,DLGID,0)),U,4)
"RTN","ORWDXM3",309,0)
 S DLGGRP=$P($G(^ORD(101.41,DLGID,0)),U,5)
"RTN","ORWDXM3",310,0)
 I (DLGTYP="Q"),((DLGGRP=UDGRP1)!(DLGGRP=UDGRP2)!(DLGGRP=CLODGRP)!(DLGGRP=CLIVDGRP)) S ORY=1
"RTN","ORWDXM3",311,0)
 Q
"RTN","ORWDXM4")
0^69^B43181122
"RTN","ORWDXM4",1,0)
ORWDXM4 ; SLC/KCM - Order Dialogs, Menus;10:42 AM  6 Sep 1998 ;12/16/14  10:07
"RTN","ORWDXM4",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,215,296,280,394,350**;Dec 17, 1997;Build 77
"RTN","ORWDXM4",3,0)
 ;
"RTN","ORWDXM4",4,0)
SETUP ; -- setup dialog (continued from ORWDXM1)
"RTN","ORWDXM4",5,0)
 ;    if xfer med order, setup ORDIALOG differently
"RTN","ORWDXM4",6,0)
 I ORWMODE,$$ISMED(ORIT),$$CHGSTS(ORCAT,ORIT) D MEDXFER Q
"RTN","ORWDXM4",7,0)
 ;    get base dialog (based on display group) & location of responses
"RTN","ORWDXM4",8,0)
 I ORWMODE D
"RTN","ORWDXM4",9,0)
 . S ORDG=$P(^OR(100,+ORIT,0),U,11),ORDIALOG=+$P(^(0),U,5)
"RTN","ORWDXM4",10,0)
 . S RSPREF="^OR(100,"_+ORIT_",4.5)"
"RTN","ORWDXM4",11,0)
 E  D
"RTN","ORWDXM4",12,0)
 . N X0 S X0=$G(^ORD(101.41,ORIT,0))
"RTN","ORWDXM4",13,0)
 . S ORDIALOG=$S($P(X0,U,4)="D":ORIT,1:0)
"RTN","ORWDXM4",14,0)
 . S ORDG=$P(X0,U,5) Q:'ORDG
"RTN","ORWDXM4",15,0)
 . I 'ORDIALOG S ORDIALOG=+$$DEFDLG^ORWDXQ(ORDG)
"RTN","ORWDXM4",16,0)
 . S RSPREF="^ORD(101.41,"_ORIT_",6)"
"RTN","ORWDXM4",17,0)
 ;    setup the ORDIALOG array
"RTN","ORWDXM4",18,0)
 D GETDLG^ORCD(ORDIALOG)
"RTN","ORWDXM4",19,0)
 D GETORDER^ORCD(RSPREF)
"RTN","ORWDXM4",20,0)
 Q
"RTN","ORWDXM4",21,0)
SETUPS ; -- setup for specific types of dialogs (continued from ORWDXM1)
"RTN","ORWDXM4",22,0)
 ; pharmacy uses ORCAT to know order package
"RTN","ORWDXM4",23,0)
 I ORDIALOG=$O(^ORD(101.41,"B","PSO OERR",0)) S ORCAT="O"
"RTN","ORWDXM4",24,0)
 I ORDIALOG=$O(^ORD(101.41,"B","PSJ OR PAT OE",0)) D
"RTN","ORWDXM4",25,0)
 . I ORCAT="O",'ORIMO S ORWPSWRG="" ; not auto-ack, pt not inpt
"RTN","ORWDXM4",26,0)
 . S ORCAT="I"
"RTN","ORWDXM4",27,0)
 I ORCAT="O",$D(OREVENT("EFFECTIVE")),(ORDG=+$O(^ORD(100.98,"B","O RX",0))) D
"RTN","ORWDXM4",28,0)
 . S ORDIALOG($O(^ORD(101.41,"B",X,0)),1)=OREVENT("EFFECTIVE")
"RTN","ORWDXM4",29,0)
 ;p394 force interactive dialog for imaging QO for female of child-bearing age.
"RTN","ORWDXM4",30,0)
 N ORRAORD S ORRAORD=0 ;set is radiology flag to false (0)
"RTN","ORWDXM4",31,0)
 I ORDIALOG=$O(^ORD(101.41,"B","RA OERR EXAM",0)) D
"RTN","ORWDXM4",32,0)
 . N ORPRMPT1,ORPRMPT2,ORCODE S ORRAORD=1
"RTN","ORWDXM4",33,0)
 . Q:($G(ORTYPE)'="Q")!($G(ORSEX)'="F")
"RTN","ORWDXM4",34,0)
 . S ORPRMPT1=$O(^ORD(101.41,"B","OR GTX PREGNANT",0)),ORPRMPT2=$P($G(ORDIALOG(ORPRMPT1)),"^")
"RTN","ORWDXM4",35,0)
 . S ORCODE=$G(^ORD(101.41,ORDIALOG,10,ORPRMPT2,7)) N Y S Y="Y" X ORCODE K ORCODE
"RTN","ORWDXM4",36,0)
 . S:Y="Y" ORWPSWRG="" ;
"RTN","ORWDXM4",37,0)
 I ORRAORD D RA^ORWDXM2 G XENV
"RTN","ORWDXM4",38,0)
 I ORDIALOG=$O(^ORD(101.41,"B","LR OTHER LAB TESTS",0))   D LR^ORWDXM2 G XENV
"RTN","ORWDXM4",39,0)
 I ORDIALOG=$O(^ORD(101.41,"B","FHW1",0))                 D DO^ORWDXM2 G XENV
"RTN","ORWDXM4",40,0)
 I ORDIALOG=$O(^ORD(101.41,"B","FHW2",0))                 D EL^ORWDXM2 G XENV
"RTN","ORWDXM4",41,0)
 I ORDIALOG=$O(^ORD(101.41,"B","PSJ OR PAT OE",0))        D UD^ORWDXM2 G XENV
"RTN","ORWDXM4",42,0)
 I ORDIALOG=$O(^ORD(101.41,"B","PSJ OR CLINIC OE",0))        D UD^ORWDXM2 G XENV
"RTN","ORWDXM4",43,0)
 I ORDIALOG=$O(^ORD(101.41,"B","PSJI OR PAT FLUID OE",0)) D IV^ORWDXM2 G XENV
"RTN","ORWDXM4",44,0)
 I ORDIALOG=$O(^ORD(101.41,"B","CLINIC OR PAT FLUID OE",0)) D IV^ORWDXM2 G XENV
"RTN","ORWDXM4",45,0)
 I ORDIALOG=$O(^ORD(101.41,"B","PSO OERR",0))             D OP^ORWDXM2 G XENV
"RTN","ORWDXM4",46,0)
 I ORDIALOG=$O(^ORD(101.41,"B","PSO SUPPLY",0))           D OP^ORWDXM2 G XENV
"RTN","ORWDXM4",47,0)
 I ORDIALOG=$O(^ORD(101.41,"B","PS MEDS",0))              D PS^ORWDPS3 G XENV
"RTN","ORWDXM4",48,0)
 I ORDIALOG=$O(^ORD(101.41,"B","VBEC BLOOD BANK",0))      D VB^ORWDXM4 G XENV
"RTN","ORWDXM4",49,0)
 I ORDIALOG=$O(^ORD(101.41,"B","GMRAOR ALLERGY ENTER/EDIT",0)) S ORQUIT=1
"RTN","ORWDXM4",50,0)
XENV ;    end case
"RTN","ORWDXM4",51,0)
 Q
"RTN","ORWDXM4",52,0)
MEDXFER ; -- setup ORDIALOG for a med that is transferred (from SETUP)
"RTN","ORWDXM4",53,0)
 ;
"RTN","ORWDXM4",54,0)
 ; use ORWDPS3 if OR*3*94 installed
"RTN","ORWDXM4",55,0)
 I ORWP94 G MEDXFER^ORWDPS3
"RTN","ORWDXM4",56,0)
 ;
"RTN","ORWDXM4",57,0)
 N UDLG,FDLG,ODLG,DLG,OI K ^TMP("PS",$J)
"RTN","ORWDXM4",58,0)
 S UDLG=$O(^ORD(101.41,"AB","PSJ OR PAT OE",0))
"RTN","ORWDXM4",59,0)
 S FDLG=$O(^ORD(101.41,"AB","PSJI OR PAT FLUID OE",0))
"RTN","ORWDXM4",60,0)
 S ODLG=$O(^ORD(101.41,"AB","PSO OERR",0))
"RTN","ORWDXM4",61,0)
 S DLG=$P($G(^OR(100,+ORIT,0)),U,5)
"RTN","ORWDXM4",62,0)
 S ORDIALOG=$S(+DLG=UDLG:ODLG,+DLG=ODLG:UDLG,+DLG=FDLG:FDLG,1:0)
"RTN","ORWDXM4",63,0)
 I 'ORDIALOG D SETERR(ORIT,"Incomplete Order Record") Q
"RTN","ORWDXM4",64,0)
 S ORDG=+$P(^ORD(101.41,ORDIALOG,0),U,5)
"RTN","ORWDXM4",65,0)
 D GETDLG^ORCD(ORDIALOG)
"RTN","ORWDXM4",66,0)
 D GETORDER^ORCD("^OR(100,"_+ORIT_",4.5)")
"RTN","ORWDXM4",67,0)
 S OI=$$VAL^ORCD("MEDICATION")
"RTN","ORWDXM4",68,0)
 I '$$MEDOK(OI,ORCAT) D SETERR(ORIT,"This may not be ordered as an "_$S(ORCAT="I":"in",1:"out")_"patient drug.") Q
"RTN","ORWDXM4",69,0)
 I $G(^ORD(101.43,OI,.1)),(^(.1)<$$NOW^XLFDT) D SETERR(ORIT,"This may no longer be ordered.") Q
"RTN","ORWDXM4",70,0)
 K ORDIALOG($$PTR("DISPENSE DRUG"),1)
"RTN","ORWDXM4",71,0)
 K ORDIALOG($$PTR("WORD PROCESSING 1"),1)
"RTN","ORWDXM4",72,0)
 I ORDIALOG=ODLG D IN2OUT  ; could call  IN^ORCMED except for writes
"RTN","ORWDXM4",73,0)
 I ORDIALOG=UDLG D OUT2IN  ; could call OUT^ORCMED except for writes
"RTN","ORWDXM4",74,0)
 Q
"RTN","ORWDXM4",75,0)
IN2OUT ; -- make inpatient responses into outpatient
"RTN","ORWDXM4",76,0)
 N I,DDRUG,PKGID,DOSE
"RTN","ORWDXM4",77,0)
 S DOSE=$G(ORDIALOG($$PTR("INSTRUCTIONS"),1))
"RTN","ORWDXM4",78,0)
 F I="INSTRUCTIONS","UNITS/DOSE","FREE TEXT","DISPENSE DRUG" K ORDIALOG($$PTR(I),1)
"RTN","ORWDXM4",79,0)
 S PKGID=$G(^OR(100,+ORIT,4))_";"_$P(^(0),U,12)
"RTN","ORWDXM4",80,0)
 D OEL^PSOORRL(+ORVP,PKGID) S DDRUG=$G(^TMP("PS",$J,"DD",1,0))
"RTN","ORWDXM4",81,0)
 I $P(DDRUG,U,3) S ORDIALOG($$PTR("DISPENSE DRUG"),1)=$P(DDRUG,U,3)
"RTN","ORWDXM4",82,0)
 ;    keep instructions if IV med, otherwise use units returned
"RTN","ORWDXM4",83,0)
 I $P($G(^ORD(101.43,OI,"PS")),U)=2 S ORDIALOG($$PTR("INSTRUCTIONS"),1)=DOSE
"RTN","ORWDXM4",84,0)
 E  S:$P(DDRUG,U,2) ORDIALOG($$PTR("INSTRUCTIONS"),1)=$P(DDRUG,U,2)
"RTN","ORWDXM4",85,0)
 ;    change orderable item if new orderable item returned
"RTN","ORWDXM4",86,0)
 I $P(DDRUG,U,4),$P(DDRUG,U,4)'=+$P($G(^ORD(101.43,OI,0)),U,2) D
"RTN","ORWDXM4",87,0)
 . S OI=+$O(^ORD(101.43,"ID",+$P(DDRUG,U,4)_";99PSP",0))
"RTN","ORWDXM4",88,0)
 . S:OI ORDIALOG($$PTR("ORDERABLE ITEM"),1)=OI
"RTN","ORWDXM4",89,0)
 Q
"RTN","ORWDXM4",90,0)
OUT2IN ; make outpatient responses into inpatient
"RTN","ORWDXM4",91,0)
 N ORP,ORI,PROMPT,PKGID,DDRUG,ONE
"RTN","ORWDXM4",92,0)
 D CHANGED^ORCDPS("XFR") ; Kill extra values not in inpt dialog
"RTN","ORWDXM4",93,0)
 S PKGID=$G(^OR(100,+ORIT,4))_";"_$P(^(0),U,12)
"RTN","ORWDXM4",94,0)
 D OEL^PSOORRL(+ORVP,PKGID) S DDRUG=$G(^TMP("PS",$J,"DD",1,0))
"RTN","ORWDXM4",95,0)
 S:$P(DDRUG,U,3) ORDIALOG($$PTR("DISPENSE DRUG"),1)=$P(DDRUG,U,3)
"RTN","ORWDXM4",96,0)
 I $P(DDRUG,U,4),$P(DDRUG,U,4)'=+$P($G(^ORD(101.43,+OI,0)),U,2) D
"RTN","ORWDXM4",97,0)
 . S OI=+$O(^ORD(101.43,"ID",+$P(DDRUG,U,4)_";99PSP",0))
"RTN","ORWDXM4",98,0)
 . S:OI ORDIALOG($$PTR("ORDERABLE ITEM"),1)=OI
"RTN","ORWDXM4",99,0)
 S ONE=$O(ORDIALOG($$PTR("INSTRUCTIONS"),0)) ; first inst
"RTN","ORWDXM4",100,0)
 F ORP="ROUTE","SCHEDULE" D
"RTN","ORWDXM4",101,0)
 . S ORI=0,PROMPT=$$PTR(ORP)
"RTN","ORWDXM4",102,0)
 . F  S ORI=$O(ORDIALOG(PROMPT,ORI)) Q:ORI'>0  I ORDIALOG(PROMPT,ORI)=""!(ORI>ONE) K ORDIALOG(PROMPT,ORI)
"RTN","ORWDXM4",103,0)
 Q
"RTN","ORWDXM4",104,0)
PTR(NAME) ; -- Returns pointer to OR GTX NAME (copied from ORCMED)
"RTN","ORWDXM4",105,0)
 Q +$O(^ORD(101.41,"AB",$E("OR GTX "_NAME,1,63),0))
"RTN","ORWDXM4",106,0)
 ;
"RTN","ORWDXM4",107,0)
MEDOK(OI,CAT)   ; return 1 if med may be ordered for this patient category
"RTN","ORWDXM4",108,0)
 N P S P=$S(CAT="I":1,1:2)
"RTN","ORWDXM4",109,0)
 Q $P($G(^ORD(101.43,+OI,"PS")),U,P)
"RTN","ORWDXM4",110,0)
 ;
"RTN","ORWDXM4",111,0)
CHGSTS(ECAT,IFN)        ; return 1 if out to in or in to out
"RTN","ORWDXM4",112,0)
 N OCAT
"RTN","ORWDXM4",113,0)
 S OCAT=$P($G(^OR(100,+IFN,0)),U,12)
"RTN","ORWDXM4",114,0)
 Q OCAT'=ECAT
"RTN","ORWDXM4",115,0)
 ;
"RTN","ORWDXM4",116,0)
ISMED(IFN)      ; return 1 if this is a pharmacy order
"RTN","ORWDXM4",117,0)
 N PKG S PKG=$P($G(^OR(100,+IFN,0)),U,14)
"RTN","ORWDXM4",118,0)
 Q $$NMSP^ORCD(PKG)="PS"
"RTN","ORWDXM4",119,0)
SETERR(ID,X)       ; sets LST to rejection with error message
"RTN","ORWDXM4",120,0)
 D GETTXT^ORWORR(.LST,ID)
"RTN","ORWDXM4",121,0)
 S LST(0)="8^0",LST(.5)=X,LST(.6)=""
"RTN","ORWDXM4",122,0)
 Q
"RTN","ORWDXM4",123,0)
VB ; setup environment for VBECS
"RTN","ORWDXM4",124,0)
 ; -- setup ORTIME, ORIMTIME arrays
"RTN","ORWDXM4",125,0)
 D GETIMES^ORCDLR1
"RTN","ORWDXM4",126,0)
 ; -- setup ORCOMP, ORTEST, and ORTAS
"RTN","ORWDXM4",127,0)
 S (ORCOMP,ORTEST,ORTAS)=""
"RTN","ORWDXM4",128,0)
 N P,PROMPT,I,X,X0
"RTN","ORWDXM4",129,0)
 S P=+$O(^ORD(101.41,"AB","OR GTX ORDERABLE ITEM",0))
"RTN","ORWDXM4",130,0)
 S I=0 F  S I=$O(ORDIALOG(P,I)) Q:I<1  S X=+$G(ORDIALOG(P,I)) D
"RTN","ORWDXM4",131,0)
 . S X0=$G(^ORD(101.43,X,"VB")),X=+$P($G(^(0)),U,2)
"RTN","ORWDXM4",132,0)
 . I $P(X0,U) S ORCOMP=ORCOMP_$S($L(ORCOMP):U,1:"")_X Q
"RTN","ORWDXM4",133,0)
 . S ORTEST=ORTEST_$S($L(ORTEST):U,1:"")_X
"RTN","ORWDXM4",134,0)
 . I X=2 S ORTAS=1
"RTN","ORWDXM4",135,0)
 I '$D(ORTEST("Lab CollSamp")) D
"RTN","ORWDXM4",136,0)
 . N I,V,T,LC S LC=1
"RTN","ORWDXM4",137,0)
 . F I=1:1:$L(ORTEST,U) S V=+$P(ORTEST,U,I) D  Q:'LC  ;no LC samp
"RTN","ORWDXM4",138,0)
 .. S T=$$LAB60^ORCDVBEC(V) ;VBECS ID -> #60 ien
"RTN","ORWDXM4",139,0)
 .. I '$P($G(^LAB(60,T,0)),U,9) S LC=0 Q
"RTN","ORWDXM4",140,0)
 . S ORTEST("Lab CollSamp")=LC
"RTN","ORWDXM4",141,0)
 I '$D(ORTIME),'$D(ORIMTIME) D GETIMES^ORCDLR1
"RTN","ORWDXM4",142,0)
 S PROMPT=$O(^ORD(101.41,"B","OR GTX COLLECTION TYPE",0))
"RTN","ORWDXM4",143,0)
 I $D(ORDIALOG(PROMPT,1)) S ORCOLLCT=ORDIALOG(PROMPT,1) I 1
"RTN","ORWDXM4",144,0)
 E  S EDITONLY=0,ORCOLLCT=$$COLLTYPE^ORCDLR1
"RTN","ORWDXM4",145,0)
 I ORCOLLCT="I" D
"RTN","ORWDXM4",146,0)
 . S PROMPT=$O(^ORD(101.41,"B","OR GTX START DATE/TIME",0))
"RTN","ORWDXM4",147,0)
 . D LRICTMOK^ORWDXM2
"RTN","ORWDXM4",148,0)
 Q
"RTN","ORWDXM4",149,0)
VBASK(I) ; set the ORASK variable for child component prompts in VBECS order
"RTN","ORWDXM4",150,0)
 I ORDIALOG'=$O(^ORD(101.41,"B","VBEC BLOOD BANK",0)) Q
"RTN","ORWDXM4",151,0)
 N P S P=+$O(^ORD(101.41,"AB","OR GTX ORDERABLE ITEM",0))
"RTN","ORWDXM4",152,0)
 N OI S OI=+$G(ORDIALOG(P,I))
"RTN","ORWDXM4",153,0)
 I +$G(^ORD(101.43,+$G(OI),"VB")) S ORASK=1
"RTN","ORWDXM4",154,0)
 Q
"RTN","ORWDXM4",155,0)
VBQO(IFN) ;Check to see if it's a good VBECS QO
"RTN","ORWDXM4",156,0)
 ;regular order treated as good QO
"RTN","ORWDXM4",157,0)
 ;
"RTN","ORWDXM4",158,0)
 I $P($G(^ORD(101.41,IFN,0)),U,4)'="Q" Q 1
"RTN","ORWDXM4",159,0)
 N ODP,ODG,RESULT,P,TNS,I
"RTN","ORWDXM4",160,0)
 S RESULT=0
"RTN","ORWDXM4",161,0)
 S ODP=+$P($G(^ORD(101.41,IFN,0)),U,7),ODG=+$P($G(^(0)),U,5)
"RTN","ORWDXM4",162,0)
 S ODP=$$GET1^DIQ(9.4,+ODP_",",1),ODG=$P($G(^ORD(100.98,ODG,0)),U,3)
"RTN","ORWDXM4",163,0)
 I ODP'["VBEC" Q 1
"RTN","ORWDXM4",164,0)
 Q RESULT
"RTN","ORWDXR01")
0^68^B29178545
"RTN","ORWDXR01",1,0)
ORWDXR01 ;SLC/JDL - Utilities for Order Actions ;12/16/14  09:52
"RTN","ORWDXR01",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**187,190,195,215,280,345,311,350**;Dec 17, 1997;Build 77
"RTN","ORWDXR01",3,0)
CANCHG(ORY,ORIFN,TXTOD) ;
"RTN","ORWDXR01",4,0)
 ;If it's an pending or unsigned unreleased renewed order, can edit=True
"RTN","ORWDXR01",5,0)
 S ORY=0
"RTN","ORWDXR01",6,0)
 Q:'$D(^OR(100,+ORIFN,0))
"RTN","ORWDXR01",7,0)
 I TXTOD D TXTCAN(.ORY) Q
"RTN","ORWDXR01",8,0)
 N OUTGRP,URELSTS,USIGSTS,RNTYPE,PDSTS
"RTN","ORWDXR01",9,0)
 N ODGRP,ODREL,ODSIG,ODTYPE,LSTACT
"RTN","ORWDXR01",10,0)
 S OUTGRP=$O(^ORD(100.98,"B","O RX",0))
"RTN","ORWDXR01",11,0)
 S URELSTS=$O(^ORD(100.01,"B","UNRELEASED",0))
"RTN","ORWDXR01",12,0)
 S PDSTS=$O(^ORD(100.01,"B","PENDING",0))
"RTN","ORWDXR01",13,0)
 S USIGSTS=2 ; unsigned order
"RTN","ORWDXR01",14,0)
 S RNTYPE=2 ; renew action
"RTN","ORWDXR01",15,0)
 ;Data from the order entry
"RTN","ORWDXR01",16,0)
 S LSTACT=$P($G(^OR(100,+ORIFN,3)),U,7)
"RTN","ORWDXR01",17,0)
 S ODGRP=$P($G(^OR(100,+ORIFN,0)),U,11)
"RTN","ORWDXR01",18,0)
 S ODREL=$P($G(^OR(100,+ORIFN,3)),U,3)
"RTN","ORWDXR01",19,0)
 S ODSIG=$P($G(^OR(100,+ORIFN,8,LSTACT,0)),U,4)
"RTN","ORWDXR01",20,0)
 S ODTYPE=$P($G(^OR(100,+ORIFN,3)),U,11)
"RTN","ORWDXR01",21,0)
 I (ODGRP=OUTGRP),(ODREL=URELSTS),(ODSIG=USIGSTS),(ODTYPE=RNTYPE) S ORY=1
"RTN","ORWDXR01",22,0)
 Q
"RTN","ORWDXR01",23,0)
 ;
"RTN","ORWDXR01",24,0)
TXTCAN(ORY) ;
"RTN","ORWDXR01",25,0)
 ;if it's an unsigned unreleased renewed text order, can change=true
"RTN","ORWDXR01",26,0)
 N URELSTS,USIGSTS,RNTYPE
"RTN","ORWDXR01",27,0)
 N ODREL,ODSIG,ODTYPE,LSTACT
"RTN","ORWDXR01",28,0)
 S URELSTS=$O(^ORD(100.01,"B","UNRELEASED",0))
"RTN","ORWDXR01",29,0)
 S USIGSTS=2 ; unsigned order
"RTN","ORWDXR01",30,0)
 S RNTYPE=2 ; renew action
"RTN","ORWDXR01",31,0)
 ;Data from the order entry
"RTN","ORWDXR01",32,0)
 S LSTACT=$P($G(^OR(100,+ORIFN,3)),U,7)
"RTN","ORWDXR01",33,0)
 S ODREL=$P($G(^OR(100,+ORIFN,8,LSTACT,0)),U,15)
"RTN","ORWDXR01",34,0)
 S ODSIG=$P($G(^OR(100,+ORIFN,8,LSTACT,0)),U,4)
"RTN","ORWDXR01",35,0)
 S ODTYPE=$P($G(^OR(100,+ORIFN,3)),U,11)
"RTN","ORWDXR01",36,0)
 I (ODREL=URELSTS),(ODSIG=USIGSTS),(ODTYPE=RNTYPE) S ORY=1
"RTN","ORWDXR01",37,0)
 Q
"RTN","ORWDXR01",38,0)
 ;
"RTN","ORWDXR01",39,0)
SAVCHG(ORY,ORID,PARM1,PARM2,TXTOD) ;
"RTN","ORWDXR01",40,0)
 ;save new changes on the unreleased unsigned renewed order
"RTN","ORWDXR01",41,0)
 Q:'$D(^OR(100,+ORID,0))
"RTN","ORWDXR01",42,0)
 ;Update new start and stop date the text order
"RTN","ORWDXR01",43,0)
 I TXTOD D TXTSAV(.ORY,ORID,PARM1,PARM2) Q
"RTN","ORWDXR01",44,0)
 ;Update new refills and pickup for the med order
"RTN","ORWDXR01",45,0)
 N REFID,PICKID,ACT,IX,TXT,REFPOS,NDQUIT
"RTN","ORWDXR01",46,0)
 S (REFID,PICKID,ACT,REFPOS,NDQUIT)=0,ORY=""
"RTN","ORWDXR01",47,0)
 S ACT=+$P(ORID,";",2) S:ACT'>0 ACT=1
"RTN","ORWDXR01",48,0)
 S REFID=$O(^OR(100,+ORID,4.5,"ID","REFILLS",0))
"RTN","ORWDXR01",49,0)
 S PICKID=$O(^OR(100,+ORID,4.5,"ID","PICKUP",0))
"RTN","ORWDXR01",50,0)
 S:$D(^OR(100,+ORID,4.5,REFID,1)) ^(1)=PARM1
"RTN","ORWDXR01",51,0)
 S:$D(^OR(100,+ORID,4.5,PICKID,1)) ^(1)=PARM2
"RTN","ORWDXR01",52,0)
 S IX=0 F  S IX=$O(^OR(100,+ORID,8,ACT,.1,IX)) Q:('IX)!(NDQUIT)  D
"RTN","ORWDXR01",53,0)
 . S TXT=$G(^OR(100,+ORID,8,ACT,.1,IX,0))
"RTN","ORWDXR01",54,0)
 . I ($$UP^XLFSTR(TXT)["QUANTITY:"),($$UP^XLFSTR(TXT)["REFILLS:") D
"RTN","ORWDXR01",55,0)
 . . S REFPOS=$F($$UP^XLFSTR(TXT),"REFILLS")-$L("REFILLS")-1
"RTN","ORWDXR01",56,0)
 . . S TXT=$E(TXT,1,REFPOS)_"Refills: "_PARM1
"RTN","ORWDXR01",57,0)
 . . S ^OR(100,+ORID,8,ACT,.1,IX,0)=TXT,NDQUIT=1 Q
"RTN","ORWDXR01",58,0)
 D GETBYIFN^ORWORR(.ORY,+ORID)
"RTN","ORWDXR01",59,0)
 Q
"RTN","ORWDXR01",60,0)
 ;
"RTN","ORWDXR01",61,0)
TXTSAV(ORY,ORID,PARM1,PARM2) ;
"RTN","ORWDXR01",62,0)
 ; Update new start and stop date for the unsigned unreleased
"RTN","ORWDXR01",63,0)
 ; renewed text order
"RTN","ORWDXR01",64,0)
 N STRTID,STOPID
"RTN","ORWDXR01",65,0)
 S STRTID=$O(^OR(100,+ORID,4.5,"ID","START",0))
"RTN","ORWDXR01",66,0)
 S STOPID=$O(^OR(100,+ORID,4.5,"ID","STOP",0))
"RTN","ORWDXR01",67,0)
 S:$D(^OR(100,+ORID,4.5,STRTID,1)) ^(1)=PARM1
"RTN","ORWDXR01",68,0)
 S:$D(^OR(100,+ORID,4.5,STOPID,1)) ^(1)=PARM2
"RTN","ORWDXR01",69,0)
 D GETBYIFN^ORWORR(.ORY,+ORID)
"RTN","ORWDXR01",70,0)
 Q
"RTN","ORWDXR01",71,0)
 ;
"RTN","ORWDXR01",72,0)
ISSPLY(ORY,DLGID,QODLG) ;
"RTN","ORWDXR01",73,0)
 ; ORY=1: is "PSO SUPPLY" dialog
"RTN","ORWDXR01",74,0)
 S ORY=""
"RTN","ORWDXR01",75,0)
 Q:'$D(^ORD(101.41,DLGID,0))
"RTN","ORWDXR01",76,0)
 I 'QODLG,($P(^ORD(101.41,DLGID,0),U)="PSO SUPPLY") S ORY=1
"RTN","ORWDXR01",77,0)
 I QODLG D
"RTN","ORWDXR01",78,0)
 . N SPLYDG S SPLYDG=$O(^ORD(100.98,"B","SPLY",0))
"RTN","ORWDXR01",79,0)
 . I $P(^ORD(101.41,DLGID,0),U,5)=SPLYDG S ORY=1
"RTN","ORWDXR01",80,0)
 Q
"RTN","ORWDXR01",81,0)
 ;
"RTN","ORWDXR01",82,0)
OXDATA(ORY,ORIEN) ; Return orderable item data for order check usage
"RTN","ORWDXR01",83,0)
 Q:'$D(^OR(100,+ORIEN,0))
"RTN","ORWDXR01",84,0)
 D MAYBEIV(.ORY,ORIEN,1) I $L($G(ORY))>1 Q
"RTN","ORWDXR01",85,0)
 N DRUGID,OIID,IDX,IDY,DISPIN,DISPOUT,DISPID
"RTN","ORWDXR01",86,0)
 S (DRUGID,OIID,IDX,IDY,DISPIN,DISPOUT)=0
"RTN","ORWDXR01",87,0)
 S DISPID=""
"RTN","ORWDXR01",88,0)
 S DISPIN=$O(^ORD(100.98,"B","UD RX",0))
"RTN","ORWDXR01",89,0)
 S DISPOUT=$O(^ORD(100.98,"B","O RX",0))
"RTN","ORWDXR01",90,0)
 N DISPCM S DISPCM=$O(^ORD(100.98,"B","CLINIC MEDICATIONS",0))
"RTN","ORWDXR01",91,0)
 N DISPCMIV S DISPCMIV=$O(^ORD(100.98,"B","CLINIC INFUSIONS",0))
"RTN","ORWDXR01",92,0)
 S DRUGID=$O(^OR(100,+ORIEN,4.5,"ID","DRUG",0))
"RTN","ORWDXR01",93,0)
 S OIID=$O(^OR(100,+ORIEN,4.5,"ID","ORDERABLE",0))
"RTN","ORWDXR01",94,0)
 S DISPID=$P(^OR(100,+ORIEN,0),U,11)
"RTN","ORWDXR01",95,0)
 I DISPID=DISPIN S DISPID="PSI"
"RTN","ORWDXR01",96,0)
 I DISPID=DISPOUT S DISPID="PSO"
"RTN","ORWDXR01",97,0)
 I DISPID=DISPCM S DISPID="PSI"
"RTN","ORWDXR01",98,0)
 I DISPID=DISPCMIV S DISPID="PSI"
"RTN","ORWDXR01",99,0)
 I (DISPID'="PSI"),(DISPID'="PSO") Q
"RTN","ORWDXR01",100,0)
 I 'DRUGID,DISPID="PSI" D
"RTN","ORWDXR01",101,0)
 .N ORCHI S ORCHI=0 F  S ORCHI=$O(^OR(100,+ORIEN,2,ORCHI)) Q:'ORCHI  D
"RTN","ORWDXR01",102,0)
 ..N ORCHDRID,ORCHOIID,ORCHIDX,ORCHIDY
"RTN","ORWDXR01",103,0)
 ..S ORCHDRID=$O(^OR(100,+ORCHI,4.5,"ID","DRUG",0))
"RTN","ORWDXR01",104,0)
 ..S ORCHOIID=$O(^OR(100,+ORCHI,4.5,"ID","ORDERABLE",0))
"RTN","ORWDXR01",105,0)
 ..Q:'ORCHDRID
"RTN","ORWDXR01",106,0)
 ..Q:'ORCHOIID
"RTN","ORWDXR01",107,0)
 ..S ORCHIDX=$O(^OR(100,+ORCHI,4.5,ORCHDRID,0))
"RTN","ORWDXR01",108,0)
 ..S ORCHIDY=$O(^OR(100,+ORCHI,4.5,ORCHOIID,0))
"RTN","ORWDXR01",109,0)
 ..I ORCHIDX,ORCHIDY S ORY=$G(^OR(100,+ORCHI,4.5,ORCHOIID,ORCHIDY))_U_DISPID_U_$G(^OR(100,+ORCHI,4.5,ORCHDRID,ORCHIDX))_"|"_$G(ORY)
"RTN","ORWDXR01",110,0)
 Q:'DRUGID
"RTN","ORWDXR01",111,0)
 Q:'OIID
"RTN","ORWDXR01",112,0)
 S IDX=$O(^OR(100,+ORIEN,4.5,DRUGID,0))
"RTN","ORWDXR01",113,0)
 S IDY=$O(^OR(100,+ORIEN,4.5,OIID,0))
"RTN","ORWDXR01",114,0)
 I IDX,IDY,'+DISPID S ORY=$G(^OR(100,+ORIEN,4.5,OIID,IDY))_U_DISPID_U_$G(^OR(100,+ORIEN,4.5,DRUGID,IDX))
"RTN","ORWDXR01",115,0)
 Q
"RTN","ORWDXR01",116,0)
 ;
"RTN","ORWDXR01",117,0)
MAYBEIV(ORY,ORIEN,FORMAT) ; Return orderable item data for iv order check usage
"RTN","ORWDXR01",118,0)
 ;PARAMETERS: ORY   => REFERENCE TO ARRAY THAT STORES ORDERABLE ITEM DATA
"RTN","ORWDXR01",119,0)
 ;            ORIEN => ORDER NUMBER FROM ORDER FILE (#100)
"RTN","ORWDXR01",120,0)
 ;            FORMAT => FLAG DENOTING WHICH FORMAT TO RETURN THE DATA IN:
"RTN","ORWDXR01",121,0)
 ;                      NULL OR ZERO - NEW FORMAT (USING PIPE DELMITER)
"RTN","ORWDXR01",122,0)
 ;                      1 - OLD FORMAT (USING CAROT DELIMITER)
"RTN","ORWDXR01",123,0)
 N X0,ORDIALOG,DELIMIT
"RTN","ORWDXR01",124,0)
 S DELIMIT=$S($G(FORMAT):"|",1:U)
"RTN","ORWDXR01",125,0)
 S X0=^OR(100,+ORIEN,0)
"RTN","ORWDXR01",126,0)
 S ORDIALOG=+$P(X0,U,5)
"RTN","ORWDXR01",127,0)
 D GETDLG^ORCD(ORDIALOG)
"RTN","ORWDXR01",128,0)
 D GETORDER^ORCD(+ORIEN)
"RTN","ORWDXR01",129,0)
 I $D(ORDIALOG("B","SOLUTION")) D
"RTN","ORWDXR01",130,0)
 .N ORI,ORSUB
"RTN","ORWDXR01",131,0)
 .S ORSUB=$P(ORDIALOG("B","SOLUTION"),U,2)
"RTN","ORWDXR01",132,0)
 .S ORI=0 F  S ORI=$O(ORDIALOG(ORSUB,ORI)) Q:'ORI  D
"RTN","ORWDXR01",133,0)
 ..S:DELIMIT="|" ORY=$G(ORY)_"|"_$G(ORDIALOG(ORSUB,ORI))_U_"PSIV"_U_"B;"
"RTN","ORWDXR01",134,0)
 ..S:DELIMIT=U ORY=$G(ORY)_U_$G(ORDIALOG(ORSUB,ORI))_"|"_"PSIV"_"|"_ORSUB_"||"_ORIEN_"||"_"B"
"RTN","ORWDXR01",135,0)
 I $D(ORDIALOG("B","ADDITIVE")) D
"RTN","ORWDXR01",136,0)
 .N ORI,ORSUB
"RTN","ORWDXR01",137,0)
 .S ORSUB=$P(ORDIALOG("B","ADDITIVE"),U,2)
"RTN","ORWDXR01",138,0)
 .S ORI=0 F  S ORI=$O(ORDIALOG(ORSUB,ORI)) Q:'ORI  D
"RTN","ORWDXR01",139,0)
 ..S:DELIMIT="|" ORY=$G(ORY)_"|"_$G(ORDIALOG(ORSUB,ORI))_U_"PSIV"_U_"A"
"RTN","ORWDXR01",140,0)
 ..S:DELIMIT=U ORY=$G(ORY)_U_$G(ORDIALOG(ORSUB,ORI))_"|"_"PSIV"_"|"_ORSUB_"||"_ORIEN_"||"_"A"
"RTN","ORWDXR01",141,0)
 I $L($G(ORY),DELIMIT)>1 S ORY=$P(ORY,DELIMIT,2,$L(ORY,DELIMIT))
"RTN","ORWDXR01",142,0)
 Q
"RTN","ORWDXR01",143,0)
 ;
"RTN","ORWGAPID")
0^81^B58657928
"RTN","ORWGAPID",1,0)
ORWGAPID ; SLC/STAFF - Graph API Details ;08/31/15  09:38
"RTN","ORWGAPID",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**215,243,350**;Dec 17, 1997;Build 77
"RTN","ORWGAPID",3,0)
 ;
"RTN","ORWGAPID",4,0)
DETAILS(DATA,DFN,DATE1,DATE2,FILEITEM) ; from ORWGAPI (series click)
"RTN","ORWGAPID",5,0)
 N ITEM,FILE,SUBHEAD,TYPEITEM K SUBHEAD,TYPEITEM
"RTN","ORWGAPID",6,0)
 K ^TMP("LR7OGX",$J),^TMP("LRC",$J)
"RTN","ORWGAPID",7,0)
 K ^TMP("ORLRC",$J),^TMP("PSBO",$J),^TMP("TIUVIEW",$J)
"RTN","ORWGAPID",8,0)
 S FILE=$P(FILEITEM,U)
"RTN","ORWGAPID",9,0)
 S ITEM=$$UP^ORWGAPIX($P(FILEITEM,U,2))
"RTN","ORWGAPID",10,0)
 I '$L(ITEM) Q
"RTN","ORWGAPID",11,0)
 D
"RTN","ORWGAPID",12,0)
 . I FILE=63 D  Q
"RTN","ORWGAPID",13,0)
 .. D INTERIM^ORWLRR(.DATA,DFN,DATE1,DATE2)
"RTN","ORWGAPID",14,0)
 .. M ^TMP("ORWGRPC",$J)=^TMP("LR7OGX",$J,"OUTPUT")
"RTN","ORWGAPID",15,0)
 . I FILE="63MI" D  Q
"RTN","ORWGAPID",16,0)
 .. D MICRO^ORWLRR(.DATA,DFN,DATE1,DATE2)
"RTN","ORWGAPID",17,0)
 .. M ^TMP("ORWGRPC",$J)=^TMP("LR7OGX",$J,"OUTPUT")
"RTN","ORWGAPID",18,0)
 . I FILE="63AP" D   Q
"RTN","ORWGAPID",19,0)
 .. S SUBHEAD("CYTOPATHOLOGY")=""
"RTN","ORWGAPID",20,0)
 .. S SUBHEAD("SURGICAL PATHOLOGY")=""
"RTN","ORWGAPID",21,0)
 .. S SUBHEAD("EM")=""
"RTN","ORWGAPID",22,0)
 .. S SUBHEAD("AUTOPSY")=""
"RTN","ORWGAPID",23,0)
 .. D LABSUM^ORWGAPIC(.DATA,DFN,DATE1,DATE2,.SUBHEAD)
"RTN","ORWGAPID",24,0)
 .. M ^TMP("ORWGRPC",$J)=^TMP("LRC",$J)
"RTN","ORWGAPID",25,0)
 . I FILE="63BB" D  Q
"RTN","ORWGAPID",26,0)
 .. D BLR^ORWRP1(.DATA,DFN,"",DATE1,DATE2)
"RTN","ORWGAPID",27,0)
 .. M ^TMP("ORWGRPC",$J)=^TMP("ORLRC",$J)
"RTN","ORWGAPID",28,0)
 . I FILE="53.79" D  Q
"RTN","ORWGAPID",29,0)
 .. ;D BCMA1^ORWRP1A(.DATA,DFN,"",DATE1,DATE2) ***** BA 12/14/07
"RTN","ORWGAPID",30,0)
 .. D BCMA1^ORWRP1A(.DATA,DFN,"",DATE2,DATE1)
"RTN","ORWGAPID",31,0)
 .. M ^TMP("ORWGRPC",$J)=^TMP("PSBO",$J)
"RTN","ORWGAPID",32,0)
 . I FILE="8925" D  Q
"RTN","ORWGAPID",33,0)
 .. D NOTE(.DATA,DFN,DATE1,DATE2,ITEM)
"RTN","ORWGAPID",34,0)
 .. ;M ^TMP("ORWGRPC",$J)=^TMP("TIUVIEW",$J)
"RTN","ORWGAPID",35,0)
 . S TYPEITEM(1)=FILE_"^0"
"RTN","ORWGAPID",36,0)
 . D DETAIL(.DATA,DFN,DATE1,DATE2,.TYPEITEM)
"RTN","ORWGAPID",37,0)
 K ^TMP("LR7OGX",$J),^TMP("LRC",$J)
"RTN","ORWGAPID",38,0)
 K ^TMP("ORLRC",$J),^TMP("PSBO",$J),^TMP("TIUVIEW",$J)
"RTN","ORWGAPID",39,0)
 Q
"RTN","ORWGAPID",40,0)
 ;
"RTN","ORWGAPID",41,0)
DETAIL(DATA,DFN,DATE1,DATE2,TYPEITEM) ; from ORWGAPI (legend click)
"RTN","ORWGAPID",42,0)
 N CNT,FILE,GMTSPX1,GMTSPX2,ITEM,TITEMS,TYPE
"RTN","ORWGAPID",43,0)
 N COMP,NEWITEMS K COMP,NEWITEMS
"RTN","ORWGAPID",44,0)
 K ^TMP("ORDATA",$J)
"RTN","ORWGAPID",45,0)
 S DFN=+$G(DFN) I 'DFN Q
"RTN","ORWGAPID",46,0)
 I '$L($O(TYPEITEM(0))) Q
"RTN","ORWGAPID",47,0)
 S TYPE=""
"RTN","ORWGAPID",48,0)
 F  S TYPE=$O(TYPEITEM(TYPE)) Q:TYPE=""  D
"RTN","ORWGAPID",49,0)
 . S TITEMS=TYPEITEM(TYPE)
"RTN","ORWGAPID",50,0)
 . S FILE=$P(TITEMS,U) I '$L(FILE) Q
"RTN","ORWGAPID",51,0)
 . S ITEM=$P(TITEMS,U,2) I '$L(ITEM) Q
"RTN","ORWGAPID",52,0)
 . S NEWITEMS(FILE,ITEM)=""
"RTN","ORWGAPID",53,0)
 S CNT=0
"RTN","ORWGAPID",54,0)
 S FILE=""
"RTN","ORWGAPID",55,0)
 F  S FILE=$O(NEWITEMS(FILE)) Q:FILE=""  D
"RTN","ORWGAPID",56,0)
 . S CNT=CNT+1
"RTN","ORWGAPID",57,0)
 . S COMP(CNT)=$$COMPTYPE^ORWGAPIT(FILE)
"RTN","ORWGAPID",58,0)
 S GMTSPX1=DATE1,GMTSPX2=DATE2
"RTN","ORWGAPID",59,0)
 D REPORT^ORWRP2(.DATA,.COMP,DFN)
"RTN","ORWGAPID",60,0)
 M ^TMP("ORWGRPC",$J)=^TMP("ORDATA",$J)
"RTN","ORWGAPID",61,0)
 ;K ^TMP("ORDATA",$J)
"RTN","ORWGAPID",62,0)
 ;Q
"RTN","ORWGAPID",63,0)
 ;
"RTN","ORWGAPID",64,0)
 S CNT=0
"RTN","ORWGAPID",65,0)
 S TYPE=""
"RTN","ORWGAPID",66,0)
 F  S TYPE=$O(TYPEITEM(TYPE)) Q:TYPE=""  D
"RTN","ORWGAPID",67,0)
 . S TITEMS=TYPEITEM(TYPE)
"RTN","ORWGAPID",68,0)
 . S CNT=CNT+1
"RTN","ORWGAPID",69,0)
 . S ^TMP("ORWGRPC",$J,CNT/10000)="~~~^"_TITEMS
"RTN","ORWGAPID",70,0)
 ;
"RTN","ORWGAPID",71,0)
 K ^TMP("ORDATA",$J)
"RTN","ORWGAPID",72,0)
 Q
"RTN","ORWGAPID",73,0)
 ;
"RTN","ORWGAPID",74,0)
GETDATES(DATA,REPORTID) ; from ORWGAPI
"RTN","ORWGAPID",75,0)
 N DAT,TMP K DAT
"RTN","ORWGAPID",76,0)
 D RETURN^ORWGAPIW(.TMP,.DATA)
"RTN","ORWGAPID",77,0)
 S DAT(1)="S^Date Range..."
"RTN","ORWGAPID",78,0)
 S DAT(2)="1^Today"
"RTN","ORWGAPID",79,0)
 S DAT(3)="2^One Week"
"RTN","ORWGAPID",80,0)
 S DAT(4)="3^One Month"
"RTN","ORWGAPID",81,0)
 S DAT(5)="4^Six Months"
"RTN","ORWGAPID",82,0)
 S DAT(6)="5^One Year"
"RTN","ORWGAPID",83,0)
 S DAT(7)="6^Two Years"
"RTN","ORWGAPID",84,0)
 S DAT(8)="7^All Results"
"RTN","ORWGAPID",85,0)
 D DATES^ORWGAPIP(.DAT,REPORTID)
"RTN","ORWGAPID",86,0)
 I TMP M ^TMP(DATA,$J)=DAT
"RTN","ORWGAPID",87,0)
 I 'TMP M DATA=DAT
"RTN","ORWGAPID",88,0)
 Q
"RTN","ORWGAPID",89,0)
 ;
"RTN","ORWGAPID",90,0)
NOTE(DATA,DFN,DATE1,DATE2,ITEM) ;
"RTN","ORWGAPID",91,0)
 N CNT,DATE,DOC,DOCCLASS,DOCTYPE,DUM,IEN,LINE,NUM,RESULTS K DUM
"RTN","ORWGAPID",92,0)
 K ^TMP("TIUR",$J),^TMP("TIUVIEW",$J)
"RTN","ORWGAPID",93,0)
 S CNT=$G(CNT)
"RTN","ORWGAPID",94,0)
 F DOCTYPE="P","D","C" D
"RTN","ORWGAPID",95,0)
 . S DOCCLASS=$$DOCCLASS^ORWGAPIA(DOCTYPE)
"RTN","ORWGAPID",96,0)
 . K ^TMP("TIUR",$J)
"RTN","ORWGAPID",97,0)
 . D TIU^ORWGAPIA(.DUM,DOCCLASS,5,DFN,DATE1,DATE2)
"RTN","ORWGAPID",98,0)
 . S DOC=0
"RTN","ORWGAPID",99,0)
 . F  S DOC=$O(^TMP("TIUR",$J,DOC)) Q:DOC<1  D
"RTN","ORWGAPID",100,0)
 .. S RESULTS=^TMP("TIUR",$J,DOC)
"RTN","ORWGAPID",101,0)
 .. S IEN=+$P(RESULTS,U)
"RTN","ORWGAPID",102,0)
 .. K ^TMP("TIUVIEW",$J)
"RTN","ORWGAPID",103,0)
 .. D GETTIU^ORWGAPIA(.DATA,IEN)
"RTN","ORWGAPID",104,0)
 .. S NUM=0
"RTN","ORWGAPID",105,0)
 .. F  S NUM=$O(^TMP("TIUVIEW",$J,NUM)) Q:NUM<1  D
"RTN","ORWGAPID",106,0)
 ... S LINE=$G(^TMP("TIUVIEW",$J,NUM))
"RTN","ORWGAPID",107,0)
 ... S CNT=CNT+1
"RTN","ORWGAPID",108,0)
 ... S ^TMP("ORWGRPC",$J,CNT)=LINE
"RTN","ORWGAPID",109,0)
 .. I CNT>1 D
"RTN","ORWGAPID",110,0)
 ... S CNT=CNT+1
"RTN","ORWGAPID",111,0)
 ... S ^TMP("ORWGRPC",$J,CNT)=" "
"RTN","ORWGAPID",112,0)
 ... S CNT=CNT+1
"RTN","ORWGAPID",113,0)
 ... S ^TMP("ORWGRPC",$J,CNT)=" "
"RTN","ORWGAPID",114,0)
 ... S ^TMP("ORWGRPC",$J,CNT/10000)="~~~^"_^TMP("TIUR",$J,DOC)
"RTN","ORWGAPID",115,0)
 K ^TMP("TIUR",$J),^TMP("TIUVIEW",$J)
"RTN","ORWGAPID",116,0)
 Q
"RTN","ORWGAPID",117,0)
 ;
"RTN","ORWGAPID",118,0)
TAX(DATA,ALL,REMTAX) ; from ORWGAPI
"RTN","ORWGAPID",119,0)
 N CNT,REM,CODE,NUM,TMP
"RTN","ORWGAPID",120,0)
 K ^TMP("ORWG TEMP",$J)
"RTN","ORWGAPID",121,0)
 D RETURN^ORWGAPIW(.TMP,.DATA)
"RTN","ORWGAPID",122,0)
 S CNT=0
"RTN","ORWGAPID",123,0)
 S REM=0
"RTN","ORWGAPID",124,0)
 I ALL F  S REM=$O(^PXD(811.2,REM)) Q:REM<1  D TEMP(REM)
"RTN","ORWGAPID",125,0)
 I 'ALL D
"RTN","ORWGAPID",126,0)
 . S NUM=0
"RTN","ORWGAPID",127,0)
 . F  S NUM=$O(REMTAX(NUM)) Q:NUM<1  D
"RTN","ORWGAPID",128,0)
 .. S REM=REMTAX(NUM)
"RTN","ORWGAPID",129,0)
 .. D TEMP(REM)
"RTN","ORWGAPID",130,0)
 S CODE=""
"RTN","ORWGAPID",131,0)
 F  S CODE=$O(^TMP("ORWG TEMP",$J,CODE)) Q:CODE=""  D
"RTN","ORWGAPID",132,0)
 . D SETUP^ORWGAPIW(.DATA,CODE,TMP,.CNT)
"RTN","ORWGAPID",133,0)
 K ^TMP("ORWG TEMP",$J)
"RTN","ORWGAPID",134,0)
 Q
"RTN","ORWGAPID",135,0)
 ;
"RTN","ORWGAPID",136,0)
TEMP(REM) ;
"RTN","ORWGAPID",137,0)
 N NODE,NUM,SUB
"RTN","ORWGAPID",138,0)
 I $P($G(^PXD(811.2,REM,0)),U,6)=1 Q
"RTN","ORWGAPID",139,0)
 F SUB=80,80.1,81 D
"RTN","ORWGAPID",140,0)
 . S NUM=0
"RTN","ORWGAPID",141,0)
 . F  S NUM=$O(^PXD(811.3,REM,SUB,NUM)) Q:NUM<1  D
"RTN","ORWGAPID",142,0)
 .. S NODE=+$G(^PXD(811.3,REM,SUB,NUM,0))
"RTN","ORWGAPID",143,0)
 .. I 'NODE Q
"RTN","ORWGAPID",144,0)
 .. I SUB=80 D  Q
"RTN","ORWGAPID",145,0)
 ... S ^TMP("ORWG TEMP",$J,"45DX;"_NODE)=""
"RTN","ORWGAPID",146,0)
 ... S ^TMP("ORWG TEMP",$J,"9000010.07;"_NODE)=""
"RTN","ORWGAPID",147,0)
 ... S ^TMP("ORWG TEMP",$J,"9000011;"_NODE)=""
"RTN","ORWGAPID",148,0)
 .. I SUB=80.1 D  Q
"RTN","ORWGAPID",149,0)
 ... S ^TMP("ORWG TEMP",$J,"45OP;"_NODE)=""
"RTN","ORWGAPID",150,0)
 .. I SUB=81 D  Q
"RTN","ORWGAPID",151,0)
 ... S ^TMP("ORWG TEMP",$J,"9000010.18;"_NODE)=""
"RTN","ORWGAPID",152,0)
 Q
"RTN","ORWGAPID",153,0)
 ;
"RTN","ORWGAPID",154,0)
PLX2(ITEMS,DFN,FMT,OLDEST,NEWEST,CNT,TMP) ; from ORWGAPIR
"RTN","ORWGAPID",155,0)
 N DATE,DTONSET,DTPLUS1,DTRESOLV,NODE,PRIORITY,PROB,PROBDX,PSTATUS,RESULT,STATUS,VALUE
"RTN","ORWGAPID",156,0)
 K ^TMP("ORWGRPC TEMP",$J)
"RTN","ORWGAPID",157,0)
 S DTPLUS1=$$FMADD^ORWGAPIX(DT,1)
"RTN","ORWGAPID",158,0)
 S STATUS=""
"RTN","ORWGAPID",159,0)
 F  S STATUS=$O(^PXRMINDX(9000011,"PSPI",DFN,STATUS)) Q:STATUS=""  D
"RTN","ORWGAPID",160,0)
 . S PRIORITY=""
"RTN","ORWGAPID",161,0)
 . F  S PRIORITY=$O(^PXRMINDX(9000011,"PSPI",DFN,STATUS,PRIORITY)) Q:PRIORITY=""  D
"RTN","ORWGAPID",162,0)
 .. S ITEM=""
"RTN","ORWGAPID",163,0)
 .. F  S ITEM=$O(^PXRMINDX(9000011,"PSPI",DFN,STATUS,PRIORITY,ITEM)) Q:ITEM=""  D
"RTN","ORWGAPID",164,0)
 ... S DATE=""
"RTN","ORWGAPID",165,0)
 ... F  S DATE=$O(^PXRMINDX(9000011,"PSPI",DFN,STATUS,PRIORITY,ITEM,DATE)) Q:DATE=""  D
"RTN","ORWGAPID",166,0)
 .... S NODE=""
"RTN","ORWGAPID",167,0)
 .... F  S NODE=$O(^PXRMINDX(9000011,"PSPI",DFN,STATUS,PRIORITY,ITEM,DATE,NODE)) Q:NODE=""  D
"RTN","ORWGAPID",168,0)
 ..... D PROB^ORWGAPIA(.PROB,.PSTATUS,.PROBDX,.DTONSET,.DTRESOLV,NODE)
"RTN","ORWGAPID",169,0)
 ..... I 'DTRESOLV S ^TMP("ORWGRPC TEMP",$J,PROBDX,DTONSET)=DTPLUS1 Q
"RTN","ORWGAPID",170,0)
 ..... S ^TMP("ORWGRPC TEMP",$J,PROBDX,DTONSET)=DTRESOLV
"RTN","ORWGAPID",171,0)
 S PROB=""
"RTN","ORWGAPID",172,0)
 F  S PROB=$O(^TMP("ORWGRPC TEMP",$J,PROB)) Q:PROB=""  D
"RTN","ORWGAPID",173,0)
 . S VALUE=$$EVALUE^ORWGAPIU(PROB,9000011,.01)
"RTN","ORWGAPID",174,0)
 . I FMT=0 D
"RTN","ORWGAPID",175,0)
 .. S CNT=CNT+1
"RTN","ORWGAPID",176,0)
 .. S RESULT=9999911_U_PROB_U_VALUE
"RTN","ORWGAPID",177,0)
 .. D SETUP^ORWGAPIW(.ITEMS,RESULT,TMP,.CNT)
"RTN","ORWGAPID",178,0)
 . I FMT=6 D
"RTN","ORWGAPID",179,0)
 .. S OK=0
"RTN","ORWGAPID",180,0)
 .. S DATE=0
"RTN","ORWGAPID",181,0)
 .. F  S DATE=$O(^TMP("ORWGRPC TEMP",$J,PROB,DATE)) Q:DATE=""  Q:DATE>NEWEST  D  Q:OK
"RTN","ORWGAPID",182,0)
 ... S DTRESOLV=^TMP("ORWGRPC TEMP",$J,PROB,DATE)
"RTN","ORWGAPID",183,0)
 ... I DTRESOLV<OLDEST Q
"RTN","ORWGAPID",184,0)
 ... S CNT=CNT+1
"RTN","ORWGAPID",185,0)
 ... S OK=1
"RTN","ORWGAPID",186,0)
 ... S RESULT=9999911_U_PROB
"RTN","ORWGAPID",187,0)
 .. I OK D SETUP^ORWGAPIW(.ITEMS,RESULT,TMP,.CNT)
"RTN","ORWGAPID",188,0)
 . I FMT=3 D
"RTN","ORWGAPID",189,0)
 .. S DATE=$O(^TMP("ORWGRPC TEMP",$J,PROB,""),-1)
"RTN","ORWGAPID",190,0)
 .. I 'DATE Q
"RTN","ORWGAPID",191,0)
 .. S CNT=CNT+1
"RTN","ORWGAPID",192,0)
 .. S RESULT=9999911_U_PROB_"^^"_VALUE_"^^"_DATE
"RTN","ORWGAPID",193,0)
 .. D SETUP^ORWGAPIW(.ITEMS,RESULT,TMP,.CNT)
"RTN","ORWGAPID",194,0)
 K ^TMP("ORWGRPC TEMP",$J)
"RTN","ORWGAPID",195,0)
 Q
"RTN","ORWGAPID",196,0)
 ;
"RTN","ORWGAPID",197,0)
PROBX4(DATA,ITEM,START,DFN,CNT,TMP) ; from ORWGAPIR
"RTN","ORWGAPID",198,0)
 N DATE,DTONSET,DTPLUS1,DTRESOLV,NODE,PRIORITY,PROB,PROBDX,PSTATUS,RESULT,STATUS,VALUE
"RTN","ORWGAPID",199,0)
 K ^TMP("ORWGRPC TEMP",$J)
"RTN","ORWGAPID",200,0)
 S CNT=$G(CNT),DTPLUS1=$$FMADD^ORWGAPIX(DT,1)
"RTN","ORWGAPID",201,0)
 S STATUS=""
"RTN","ORWGAPID",202,0)
 F  S STATUS=$O(^PXRMINDX(9000011,"PSPI",DFN,STATUS)) Q:STATUS=""  D
"RTN","ORWGAPID",203,0)
 . S PRIORITY=""
"RTN","ORWGAPID",204,0)
 . F  S PRIORITY=$O(^PXRMINDX(9000011,"PSPI",DFN,STATUS,PRIORITY)) Q:PRIORITY=""  D
"RTN","ORWGAPID",205,0)
 .. S DATE=""
"RTN","ORWGAPID",206,0)
 .. F  S DATE=$O(^PXRMINDX(9000011,"PSPI",DFN,STATUS,PRIORITY,ITEM,DATE)) Q:DATE=""  D
"RTN","ORWGAPID",207,0)
 ... I DATE>START Q
"RTN","ORWGAPID",208,0)
 ... S NODE=""
"RTN","ORWGAPID",209,0)
 ... F  S NODE=$O(^PXRMINDX(9000011,"PSPI",DFN,STATUS,PRIORITY,ITEM,DATE,NODE)) Q:NODE=""  D
"RTN","ORWGAPID",210,0)
 .... S ^TMP("ORWGRPC TEMP",$J,NODE)=""
"RTN","ORWGAPID",211,0)
 S NODE=""
"RTN","ORWGAPID",212,0)
 F  S NODE=$O(^TMP("ORWGRPC TEMP",$J,NODE)) Q:NODE=""  D
"RTN","ORWGAPID",213,0)
 . D PROB^ORWGAPIA(.PROB,.PSTATUS,.PROBDX,.DTONSET,.DTRESOLV,NODE)
"RTN","ORWGAPID",214,0)
 . I 'DTONSET Q
"RTN","ORWGAPID",215,0)
 . I 'DTRESOLV S DTRESOLV=DTPLUS1
"RTN","ORWGAPID",216,0)
 . S RESULT=9999911_U_PROBDX_U_DTONSET_U_DTRESOLV_U_$$EXT^ORWGAPIX(PSTATUS,9000011,.12)
"RTN","ORWGAPID",217,0)
 . D SETUP^ORWGAPIW(.DATA,RESULT,TMP,.CNT)
"RTN","ORWGAPID",218,0)
 K ^TMP("ORWGRPC TEMP",$J)
"RTN","ORWGAPID",219,0)
 Q
"RTN","ORWGAPID",220,0)
 ;
"RTN","ORWOR2")
0^21^B39008801
"RTN","ORWOR2",1,0)
ORWOR2 ;SLC/DCM - RESULT RPC FUNCTIONS ;04/28/2015  11:32
"RTN","ORWOR2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**141,350**;Dec 17, 1997;Build 77
"RTN","ORWOR2",3,0)
ORDHIST  ; -- orders - compare with ORDERS^ORCXPND1
"RTN","ORWOR2",4,0)
 I '$G(ORESULTS) D ORDERS^ORCXPND2 Q
"RTN","ORWOR2",5,0)
 ; -- Result History Display (Add more packages as available)
"RTN","ORWOR2",6,0)
 N PKG,TAB,ORIFN
"RTN","ORWOR2",7,0)
 S PKG=+$P($G(^OR(100,+ID,0)),"^",14),PKG=$$NMSP^ORCD(PKG)
"RTN","ORWOR2",8,0)
 S TAB=$S(PKG="LR":"LABS",PKG="GMRC":"CONSULTS",PKG="RA":"XRAYS",1:"")
"RTN","ORWOR2",9,0)
 I '$L(TAB)!(ID'>0) D  Q  ; no display available
"RTN","ORWOR2",10,0)
 . N ORY,I
"RTN","ORWOR2",11,0)
 . D TEXT^ORQ12(.ORY,+ID,80)
"RTN","ORWOR2",12,0)
 . S I=0 F  S I=$O(ORY(I)) Q:I'>0  D ITEM^ORCXPND(ORY(I))
"RTN","ORWOR2",13,0)
 . D BLANK^ORCXPND
"RTN","ORWOR2",14,0)
 . S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="There are no results to report in this time range."
"RTN","ORWOR2",15,0)
 I $O(^OR(100,+ID,2,0)) S ORIFN=+ID,ID=0 F  S ID=$O(^OR(100,ORIFN,2,ID)) Q:ID<1  I $D(^OR(100,ID,0)) D @TAB
"RTN","ORWOR2",16,0)
 I '$O(^OR(100,+ID,2,0)) D @TAB
"RTN","ORWOR2",17,0)
 Q
"RTN","ORWOR2",18,0)
LABS ; -- laboratory [RESULTS ONLY for ID=OE order #]
"RTN","ORWOR2",19,0)
 N ORIFN,X,Y,SUB,NAME,SS,IDE,IVDT,TST,CC,ORCY,IG,TCNT,ITEM,ORY,SDATE,EDATE,ITDATE,ITMDATE,NDT,STAR,LNM,LINE
"RTN","ORWOR2",20,0)
 K ^TMP("LRRR",$J),^TMP("LRAPI",$J)
"RTN","ORWOR2",21,0)
 S ORIFN=+ID,IDE=$G(^OR(100,+ID,4))
"RTN","ORWOR2",22,0)
 Q:'$L(IDE)  ; OE# -> Lab#
"RTN","ORWOR2",23,0)
 S ITEM=$$VALUE^ORX8(ID,"ORDERABLE",,"I"),ITMDATE=$S($P(ID,";",2):$P($G(^OR(100,ORIFN,8,$P(ID,";",2),0)),"^",16),1:$P(^OR(100,ORIFN,0),"^",8)),ITDATE=$$FMTE^XLFDT(ITMDATE,"1M")
"RTN","ORWOR2",24,0)
 Q:'ITEM
"RTN","ORWOR2",25,0)
 S ITEM=+$P($G(^ORD(101.43,+ITEM,0)),"^",2)
"RTN","ORWOR2",26,0)
 S $P(IDE,";",1,3)=";;"
"RTN","ORWOR2",27,0)
 S SDATE=9999999-$S($P(IDE,";",5):$P(IDE,";",5),1:ITMDATE),EDATE=$$FMADD^XLFDT(DT,-1825) ;Set for previous 5 years
"RTN","ORWOR2",28,0)
 D RR^LR7OR1(+ORVP,,SDATE,EDATE,,ITEM,,5)
"RTN","ORWOR2",29,0)
 K ORCY D TEXT^ORQ12(.ORCY,ORIFN,80)
"RTN","ORWOR2",30,0)
 S IG=0 F  S IG=$O(ORCY(IG)) Q:IG<1  S X=ORCY(IG) D ITEM^ORCXPND(X)
"RTN","ORWOR2",31,0)
 D BLANK^ORCXPND
"RTN","ORWOR2",32,0)
 I '$D(^TMP("LRRR",$J,+ORVP)) S LINE="No data available." D SETLINE(LINE,.LCNT) Q
"RTN","ORWOR2",33,0)
 S LINE=$S('$P(IDE,";",5):"(Results not yet available for this order)",1:"(* Results for this order)")
"RTN","ORWOR2",34,0)
 D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",35,0)
 S CC=0,SS="",TCNT=0
"RTN","ORWOR2",36,0)
 F  S SS=$O(^TMP("LRRR",$J,+ORVP,SS)) Q:SS=""  S IVDT=0 F  S IVDT=$O(^TMP("LRRR",$J,+ORVP,SS,IVDT)) Q:'IVDT  D  Q:SS="MI"  Q:SS="BB"
"RTN","ORWOR2",37,0)
 . S NDT=1,STAR=" "
"RTN","ORWOR2",38,0)
 . I SS="BB" K ^TMP("LRC",$J) D EN1^LR7OSBR(+ORVP) Q:'$D(^TMP("LRC",$J))  D  Q
"RTN","ORWOR2",39,0)
 .. N I S I=0 F  S I=$O(^TMP("LRC",$J,I)) Q:I<1  S X=^(I,0),LINE=X D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",40,0)
 .. K ^TMP("LRC",$J)
"RTN","ORWOR2",41,0)
 . I SS="MI" K ^TMP("LRC",$J) D EN^LR7OSMZ0(+ORVP) Q:'$D(^TMP("LRC",$J))  D  Q
"RTN","ORWOR2",42,0)
 .. S LINE="Previous 5 sets of related results within 5 years... " D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",43,0)
 .. N I S I=0 F  S I=$O(^TMP("LRC",$J,I)) Q:I<1  S X=^(I,0),LINE=X D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",44,0)
 .. K ^TMP("LRC",$J)
"RTN","ORWOR2",45,0)
 . I SS="CH",$O(^TMP("LRRR",$J,+ORVP,SS,IVDT,0)) D  Q
"RTN","ORWOR2",46,0)
 .. S TST=0 F  S TST=$O(^TMP("LRRR",$J,+ORVP,SS,IVDT,TST)) Q:TST=""  S CC=0,Y="",TCNT=TCNT+1,X=$S(TST:^TMP("LRRR",$J,+ORVP,SS,IVDT,TST),1:"") D
"RTN","ORWOR2",47,0)
 ... I TCNT=1 D
"RTN","ORWOR2",48,0)
 .... S LINE="Previous 5 sets of related results within 5 years... " D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",49,0)
 .... D BLANK^ORCXPND
"RTN","ORWOR2",50,0)
 .... S CC=0,LINE=$$S(1,CC," ")_$$S(1,CC,"Collection Time")_$$S(21,CC,"Test Name")_$$S(34,CC,"Result")_$$S(42,CC,"Units")_$$S(58,CC,"Range")_$$S(66,CC,"Site Code")_$$S(77,CC,"Report Released Time")
"RTN","ORWOR2",51,0)
 .... D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",52,0)
 .... S CC=0,LINE=$$S(1,CC," ")_$$S(1,CC,"------------------")_$$S(21,CC,"---------")_$$S(34,CC,"------")_$$S(42,CC,"-----")_$$S(58,CC,"-----")_$$S(66,CC,"---------")_$$S(77,CC,"--------------------")
"RTN","ORWOR2",53,0)
 .... D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",54,0)
 ... I TST S X=^TMP("LRRR",$J,+ORVP,SS,IVDT,TST),CC=0 I +X D
"RTN","ORWOR2",55,0)
 .... I NDT=1,$P(IDE,";",5)=IVDT S STAR="*"
"RTN","ORWOR2",56,0)
 .... S LNM=$S($D(^LAB(60,+X,.1)):$P(^(.1),U),1:$P(^(0),U))
"RTN","ORWOR2",57,0)
 .... S LINE=STAR_$S(NDT=1:$$S(1,CC,$$FMTE^XLFDT(9999999-IVDT,"1M")),1:$$S(1,CC,"   "))_$$S(20,CC,LNM)_$$S(30,CC,$J($P(X,U,2),7))
"RTN","ORWOR2",58,0)
 .... I $L($P(X,U,2))<8 D
"RTN","ORWOR2",59,0)
 ..... S LINE=LINE_$$S(36,CC,$S($L($P(X,U,3)):$P(X,U,3),1:""))_$$S(41,CC,$P(X,U,4))_$$S(47,CC,$J($P(X,U,5),15))
"RTN","ORWOR2",60,0)
 ..... S LINE=LINE_$$S(57,CC,$J($S($L($P(X,U,20)):"["_$P(X,U,20)_"]",1:""),10))_$S(NDT=1:$$S(76,CC,$J($$FMTE^XLFDT($P(X,U,21),"1M"),18)),1:$$S(76,CC,"   "))
"RTN","ORWOR2",61,0)
 ..... D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",62,0)
 .... E  S CC=0,$P(Y," ",38)="" D
"RTN","ORWOR2",63,0)
 ..... S LINE=$$S(1,CC,Y)_$$S(36,CC,$S($L($P(X,U,3)):$P(X,U,3),1:""))_$$S(42,CC,$P(X,U,4))_$$S(58,CC,$J($P(X,U,5),15))
"RTN","ORWOR2",64,0)
 ..... S LINE=LINE_$$S(66,CC,$J($S($L($P(X,U,20)):"["_$P(X,U,20)_"]",1:""),10))_$S(NDT=1:$$S(77,CC,$J($$FMTE^XLFDT($P(X,U,21),"1M"),18)),1:$$S(77,CC,"   "))
"RTN","ORWOR2",65,0)
 ..... D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",66,0)
 .... S NDT=0
"RTN","ORWOR2",67,0)
 ... I TST="N" S LINE="  Comments: " D SETLINE(LINE,.LCNT) D
"RTN","ORWOR2",68,0)
 .... N CMT S CMT=0 F  S CMT=$O(^TMP("LRRR",$J,+ORVP,SS,IVDT,"N",CMT)) Q:'CMT  S LINE="   "_^TMP("LRRR",$J,+ORVP,SS,IVDT,"N",CMT) D SETLINE(LINE,.LCNT)
"RTN","ORWOR2",69,0)
 K ^TMP("LRRR",$J),^TMP("LRAPI",$J)
"RTN","ORWOR2",70,0)
 Q
"RTN","ORWOR2",71,0)
SETLINE(LINE,CNT) ;
"RTN","ORWOR2",72,0)
 S CNT=CNT+1,^TMP("ORXPND",$J,CNT,0)=LINE
"RTN","ORWOR2",73,0)
 Q
"RTN","ORWOR2",74,0)
 ;
"RTN","ORWOR2",75,0)
CONSULTS ; -- consults
"RTN","ORWOR2",76,0)
 N I,X,SUB,ORTX
"RTN","ORWOR2",77,0)
 I $G(ORTAB)="CONSULTS" S X=$P($G(^TMP("OR",$J,ORTAB,"IDX",NUM)),U,4)
"RTN","ORWOR2",78,0)
 E  D TEXT^ORQ12(.ORTX,+ID) S X=ORTX(1),ID=+$G(^OR(100,+ID,4)) ; OE->GMRC order#
"RTN","ORWOR2",79,0)
 D ITEM^ORCXPND(X),BLANK^ORCXPND
"RTN","ORWOR2",80,0)
 I ID'>0 S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="No data available." Q
"RTN","ORWOR2",81,0)
 I '$G(ORESULTS) D  ;DT action
"RTN","ORWOR2",82,0)
 . S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="Consult No.:           "_ID
"RTN","ORWOR2",83,0)
 . N GMRCOER S GMRCOER=2 D DT^GMRCSLM2(ID) S SUB="DT"
"RTN","ORWOR2",84,0)
 I $G(ORESULTS) D RT^GMRCGUIA(ID,"^TMP(""GMRCR"",$J,""RT"")") S SUB="RT"
"RTN","ORWOR2",85,0)
 S I=0 F  S I=$O(^TMP("GMRCR",$J,SUB,I)) Q:I'>0  S X=$G(^(I,0)),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X
"RTN","ORWOR2",86,0)
 K ^TMP("GMRCR",$J)
"RTN","ORWOR2",87,0)
 Q
"RTN","ORWOR2",88,0)
 ;
"RTN","ORWOR2",89,0)
XRAYS ; -- Radiology
"RTN","ORWOR2",90,0)
 I '$G(ORESULTS) S ID=+ORVP_U_$TR(ID,"-","^") D EN3^RAO7PC3(ID)
"RTN","ORWOR2",91,0)
 I $G(ORESULTS) S ID=+$G(^OR(100,+ID,4)) D EN30^RAO7PC3(ID)
"RTN","ORWOR2",92,0)
 N CASE,PROC,PSET
"RTN","ORWOR2",93,0)
 S PSET=$D(^TMP($J,"RAE3",+ORVP,"PRINT_SET")),CASE=0
"RTN","ORWOR2",94,0)
 F  S CASE=$O(^TMP($J,"RAE3",+ORVP,CASE)) Q:CASE'>0  D
"RTN","ORWOR2",95,0)
 . I PSET S PROC=$O(^TMP($J,"RAE3",+ORVP,CASE,"")) D ITEM^ORCXPND(PROC) Q
"RTN","ORWOR2",96,0)
 . S PROC="" F  S PROC=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC)) Q:PROC=""  D ITEM^ORCXPND(PROC),BLANK^ORCXPND,XRPT,BLANK^ORCXPND
"RTN","ORWOR2",97,0)
 I PSET S CASE=$O(^TMP($J,"RAE3",+ORVP,0)),PROC=$O(^(CASE,"")) D BLANK^ORCXPND,XRPT,BLANK^ORCXPND ;printset=list all procs, then one report
"RTN","ORWOR2",98,0)
 K ^TMP($J,"RAE3",+ORVP) S VALM("RM")=81
"RTN","ORWOR2",99,0)
 Q
"RTN","ORWOR2",100,0)
XRPT ; -- body of report for CASE, PROC
"RTN","ORWOR2",101,0)
 N ORD,X,I
"RTN","ORWOR2",102,0)
 S ORD=$S($L($G(^TMP($J,"RAE3",+ORVP,"ORD"))):^("ORD"),$L($G(^("ORD",CASE))):^(CASE),1:"") I $L(ORD),ORD'=PROC S LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)="Proc Ord: "_ORD
"RTN","ORWOR2",103,0)
 S I=1 F  S I=$O(^TMP($J,"RAE3",+ORVP,CASE,PROC,I)) Q:I'>0  S X=^(I),LCNT=LCNT+1,^TMP("ORXPND",$J,LCNT,0)=X ;Skip pt ID on line 1
"RTN","ORWOR2",104,0)
 Q
"RTN","ORWOR2",105,0)
 ;
"RTN","ORWOR2",106,0)
S(X,Y,Z) ;Pad over
"RTN","ORWOR2",107,0)
 ;X=Column #
"RTN","ORWOR2",108,0)
 ;Y=Current length
"RTN","ORWOR2",109,0)
 ;Z=Text
"RTN","ORWOR2",110,0)
 ;SP=TEXT SENT
"RTN","ORWOR2",111,0)
 ;CC=Line position after input text
"RTN","ORWOR2",112,0)
 I '$D(Z) Q ""
"RTN","ORWOR2",113,0)
 N SP S SP=Z I X,Y,X>Y S SP=$E("                                                                             ",1,X-Y)_Z
"RTN","ORWOR2",114,0)
 S CC=$$INC(CC,SP)
"RTN","ORWOR2",115,0)
 Q SP
"RTN","ORWOR2",116,0)
INC(X,Y) ;Character position count
"RTN","ORWOR2",117,0)
 ;X=Current count
"RTN","ORWOR2",118,0)
 ;Y=Text
"RTN","ORWOR2",119,0)
 N INC S INC=X+$L(Y)
"RTN","ORWOR2",120,0)
 Q INC
"RTN","ORWPCE4")
0^77^B22821566
"RTN","ORWPCE4",1,0)
ORWPCE4 ; SLC/JM/REV - wrap calls to PCE and AICS ;07/30/15  07:30
"RTN","ORWPCE4",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,116,173,190,195,215,243,295,280,306,361,350**;Dec 17, 1997;Build 77
"RTN","ORWPCE4",3,0)
 ;
"RTN","ORWPCE4",4,0)
 ; DBIA 2950   LOOK^LEXA          ^TMP("LEXFND",$J)
"RTN","ORWPCE4",5,0)
 ; DBIA 1609   CONFIG^LEXSET      ^TMP("LEXSCH",$J)
"RTN","ORWPCE4",6,0)
 ; DBIA 1365   DSELECT^GMPLENFM   ^TMP("IB",$J)
"RTN","ORWPCE4",7,0)
 ; DBIA 3991   $$STATCHK^ICDAPIU
"RTN","ORWPCE4",8,0)
 ;
"RTN","ORWPCE4",9,0)
 Q
"RTN","ORWPCE4",10,0)
LEX(LST,X,APP,ORDATE,ORXTND,ORINCSYN) ; return list after lexicon lookup
"RTN","ORWPCE4",11,0)
 ; Call with: X           (Required) The search text entered by the user
"RTN","ORWPCE4",12,0)
 ;            APP         (Required) The Lexicon APP parameter (e.g., "GMPX"
"RTN","ORWPCE4",13,0)
 ;                                   for Problem List Subset, "10D" for ICD-10-CM, etc.
"RTN","ORWPCE4",14,0)
 ;            [ORDATE]    (Optional) the date of interest (Defaults to TODAY - should
"RTN","ORWPCE4",15,0)
 ;                                   be passed as DATE OF SERVICE if not TODAY)
"RTN","ORWPCE4",16,0)
 ;            [ORXTND]    (Optional) Boolean flag specifying whether or not to
"RTN","ORWPCE4",17,0)
 ;                                   use an extended search (Initial search is PL Subset
"RTN","ORWPCE4",18,0)
 ;                                   of SCT, extended search is ICD (or 10D after impl.)
"RTN","ORWPCE4",19,0)
 ;                                   (Defaults to 0 (FALSE))
"RTN","ORWPCE4",20,0)
 ;            [ORINCSYN]  (Optional) Boolean flag specifying whether or not to
"RTN","ORWPCE4",21,0)
 ;                                   include synonyms for SNOMED CT Concepts
"RTN","ORWPCE4",22,0)
 ;                                   (Defaults to 0 (FALSE))
"RTN","ORWPCE4",23,0)
 ;
"RTN","ORWPCE4",24,0)
 ;   Returns: LST=local array name passed by ref, which contains search result set as:
"RTN","ORWPCE4",25,0)
 ;            <lvn>(1..n)=LEXIEN^PREFTEXT^CODESYS^CONCEPTID^ICDVER^DESIGID^PARENTSUBSCRIPT
"RTN","ORWPCE4",26,0)
 ;
"RTN","ORWPCE4",27,0)
 N LEX,ILST,I,IEN,IMPLDT,SUBSET,FILTER
"RTN","ORWPCE4",28,0)
 S FILTER=""
"RTN","ORWPCE4",29,0)
 S IMPLDT=$$IMPDATE^LEXU("10D")
"RTN","ORWPCE4",30,0)
 S:APP="CPT" APP="CHP" ; LEX PATCH 10
"RTN","ORWPCE4",31,0)
 I APP="ICD",'+$G(ORXTND) S APP=$S($E(X,1,3)?.1A2.3N:"ICD",1:"GMPX")
"RTN","ORWPCE4",32,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORWPCE4",33,0)
 S ORINCSYN=+$G(ORINCSYN)
"RTN","ORWPCE4",34,0)
 I APP="ICD",(ORDATE'<IMPLDT) S APP="10D"
"RTN","ORWPCE4",35,0)
 S SUBSET=$S(APP="GMPX":$S(ORDATE<IMPLDT:"PLS",1:"CLF"),1:APP)
"RTN","ORWPCE4",36,0)
 ; call CONFIG^LEXSET to set-up the constraints of the Lexicon search
"RTN","ORWPCE4",37,0)
 D CONFIG^LEXSET(APP,SUBSET,ORDATE)  ;DBIA 1609
"RTN","ORWPCE4",38,0)
 I APP="CHP" D
"RTN","ORWPCE4",39,0)
 . ; Set the filter for CPT only using CS APIs - format is the same as for DIC("S")
"RTN","ORWPCE4",40,0)
 . S ^TMP("LEXSCH",$J,"FIL",0)="I $L($$CPTONE^LEXU(+Y,$G(ORDATE)))!($L($$CPCONE^LEXU(+Y,$G(ORDATE))))"  ;DBIA 1609
"RTN","ORWPCE4",41,0)
 . ; Set Applications Default Flag (Lexicon can not overwrite filter)
"RTN","ORWPCE4",42,0)
 . S ^TMP("LEXSCH",$J,"ADF",0)=1
"RTN","ORWPCE4",43,0)
 ; setup and/or search
"RTN","ORWPCE4",44,0)
 S X=$$UP^XLFSTR(X)
"RTN","ORWPCE4",45,0)
 ; execute the search
"RTN","ORWPCE4",46,0)
 D SRCH(.LST,X,APP,SUBSET,ORDATE,ORINCSYN)
"RTN","ORWPCE4",47,0)
LEXX K ^TMP("LEXFND",$J),^TMP("LEXHIT",$J),^TMP("LEXSCH",$J),^TMP("LEXLE",$J)
"RTN","ORWPCE4",48,0)
 Q
"RTN","ORWPCE4",49,0)
SRCH(LST,X,APP,SUBSET,ORDATE,ORINCSYN) ; call LOOK^LEXA to execute the search
"RTN","ORWPCE4",50,0)
 N LEX,I,IEN,ILST
"RTN","ORWPCE4",51,0)
 D LOOK^LEXA(X,APP,1,SUBSET,ORDATE)
"RTN","ORWPCE4",52,0)
 I '$D(LEX("LIST",1)) D  G LEXX
"RTN","ORWPCE4",53,0)
 . S LST(1)="-1^No matches found.^"_APP
"RTN","ORWPCE4",54,0)
 S ILST=0
"RTN","ORWPCE4",55,0)
 S LEX("LIST",1)=$$LEXXFRM(LEX("LIST",1),ORDATE,APP)
"RTN","ORWPCE4",56,0)
 I $S(APP="GMPX":1,APP="ICD":1,1:0),($P(LEX("LIST",1),U,6)'="799.9") D  I 1
"RTN","ORWPCE4",57,0)
 . I APP="ICD",($E($P(LEX("LIST",1),U,3),1,3)'="ICD") Q
"RTN","ORWPCE4",58,0)
 . S LST(1)=LEX("LIST",1),ILST=1
"RTN","ORWPCE4",59,0)
 E  S LST(1)=LEX("LIST",1),ILST=1
"RTN","ORWPCE4",60,0)
 I APP="GMPX",+$G(ORINCSYN) D SYNONYMS(.LST,.ILST,"SCT",$P(LST(1),U,4),ORDATE)
"RTN","ORWPCE4",61,0)
 S (I,IEN)=""
"RTN","ORWPCE4",62,0)
 F  S I=$O(^TMP("LEXFND",$J,I)) Q:I=""  D  ;DBIA 2950
"RTN","ORWPCE4",63,0)
 .F  S IEN=$O(^TMP("LEXFND",$J,I,IEN)) Q:IEN=""  D
"RTN","ORWPCE4",64,0)
 ..N TXT,ELEMENT S TXT=^TMP("LEXFND",$J,I,IEN)
"RTN","ORWPCE4",65,0)
 ..S ELEMENT=IEN_U_TXT
"RTN","ORWPCE4",66,0)
 ..S ELEMENT=$$LEXXFRM(ELEMENT,ORDATE,APP) Q:$S(APP="GMPX":1,APP="ICD":1,1:0)&($P(ELEMENT,U,6)="799.9")
"RTN","ORWPCE4",67,0)
 ..I APP="ICD",($E($P(ELEMENT,U,3),1,3)'="ICD") Q
"RTN","ORWPCE4",68,0)
 ..S ILST=ILST+1,LST(ILST)=ELEMENT
"RTN","ORWPCE4",69,0)
 ..I APP="GMPX",+$G(ORINCSYN) D SYNONYMS(.LST,.ILST,"SCT",$P(LST(ILST),U,4),ORDATE)
"RTN","ORWPCE4",70,0)
 I '$D(LST(1)) S LST(1)="-1^No matches found.^"_APP
"RTN","ORWPCE4",71,0)
 Q
"RTN","ORWPCE4",72,0)
LEXXFRM(ORX,ORDATE,ORAPP) ; Transform text for SCT look-up
"RTN","ORWPCE4",73,0)
 N ORLEX,ORY,ORICD,ORSCT,ORTXT,ORCODSYS,ORCCODE,ORDCODE
"RTN","ORWPCE4",74,0)
 S ORLEX=$P(ORX,U),ORTXT=$P(ORX,U,2),(ORCCODE,ORCODSYS)=""
"RTN","ORWPCE4",75,0)
 I ORTXT["*" S ORTXT=$$STRIP^XLFSTR(ORTXT,"*")
"RTN","ORWPCE4",76,0)
 I (ORTXT["("),(ORTXT[")") D
"RTN","ORWPCE4",77,0)
 . S ORCODSYS=$RE($P($P($RE(ORTXT),"("),")",2))
"RTN","ORWPCE4",78,0)
 . S ORCCODE=$$ONE^LEXU(+ORLEX,ORDATE,"SCT"),ORCODSYS=$RE($P($RE(ORCODSYS)," ",2,99))
"RTN","ORWPCE4",79,0)
 . S ORTXT=$$TRIM^XLFSTR($RE($P($RE(ORTXT),"(",2,99)))
"RTN","ORWPCE4",80,0)
 S ORY=$$SETELEM(ORLEX,ORTXT,ORCODSYS,ORCCODE,ORDATE)
"RTN","ORWPCE4",81,0)
 Q ORY
"RTN","ORWPCE4",82,0)
SYNONYMS(LST,ILST,ORCSYS,ORCCODE,ORDT) ; Get synonyms for expression
"RTN","ORWPCE4",83,0)
 N ORSYN,ORI,ORDAD S ORDT=$G(ORDT,DT),ORDAD=ILST
"RTN","ORWPCE4",84,0)
 D GETSYN^LEXTRAN1(ORCSYS,ORCCODE,ORDT,"ORSYN",1,1)
"RTN","ORWPCE4",85,0)
 S ORI=0 F  S ORI=$O(ORSYN("S",ORI)) Q:+ORI'>0  D
"RTN","ORWPCE4",86,0)
 . N ELEMENT,TXT,IEN,ORDCODE
"RTN","ORWPCE4",87,0)
 . S IEN=$P(ORSYN("S",ORI),U,2),TXT=$P(ORSYN("S",ORI),U),ORDCODE=$P(ORSYN("S",ORI),U,3)
"RTN","ORWPCE4",88,0)
 . S ELEMENT=$$SETELEM(IEN,TXT,"SNOMED CT",ORCCODE,ORDT,ORDCODE)_U_ORDAD
"RTN","ORWPCE4",89,0)
 . S ILST=ILST+1,LST(ILST)=ELEMENT
"RTN","ORWPCE4",90,0)
 Q
"RTN","ORWPCE4",91,0)
SETELEM(ORLEX,ORTXT,ORCODSYS,ORCCODE,ORDATE,ORDCODE) ; Set List Element
"RTN","ORWPCE4",92,0)
 ;LEXIEN^PREFTEXT^CODESYS^CONCEPTID^ICDVER^ICDCODE^DESIGID^PARENTSUBSCRIPT
"RTN","ORWPCE4",93,0)
 N ORY,ORIMPDT,ORICD,ORSYN,ORTYP,ORQT,ORNUM
"RTN","ORWPCE4",94,0)
 S ORIMPDT=$$IMPDATE^LEXU("10D"),(ORTYP,ORQT,ORNUM)=""
"RTN","ORWPCE4",95,0)
 S ORY=ORLEX_U_ORTXT_U_ORCODSYS_U_ORCCODE
"RTN","ORWPCE4",96,0)
 I $S(ORCODSYS["SNOMED":1,ORCODSYS["VHAT":1,1:0) D
"RTN","ORWPCE4",97,0)
 . S ORY=ORY_U_$S(ORDATE<ORIMPDT:"ICD-9-CM",1:"ICD-10-CM"),ORICD=""
"RTN","ORWPCE4",98,0)
 . S ORICD=$$GETDX^ORQQPL1(ORCCODE,ORCODSYS,ORDATE)
"RTN","ORWPCE4",99,0)
 . I '$D(ORDCODE) D
"RTN","ORWPCE4",100,0)
 . . S ORDCODE=$$GETSYN^LEXTRAN1("SCT",ORCCODE,ORDATE,"ORSYN",1,1)
"RTN","ORWPCE4",101,0)
 . . I $P(ORDCODE,U)'=1 S ORDCODE="" Q
"RTN","ORWPCE4",102,0)
 . . F  S ORTYP=$O(ORSYN(ORTYP)) Q:ORTYP="S"!(ORQT)  D
"RTN","ORWPCE4",103,0)
 . . . I $P(ORSYN(ORTYP),U)=ORTXT S ORDCODE=$P(ORSYN(ORTYP),U,3),ORQT=1 Q
"RTN","ORWPCE4",104,0)
 . . I ORTYP="S" F  S ORNUM=$O(ORSYN(ORTYP,ORNUM)) Q:ORNUM=""!(ORQT)  D
"RTN","ORWPCE4",105,0)
 . . . I $P(ORSYN(ORTYP,ORNUM),U)=ORTXT S ORDCODE=$P(ORSYN(ORTYP,ORNUM),U,3),ORQT=1 Q
"RTN","ORWPCE4",106,0)
 . I ORDCODE["^" S ORDCODE=""
"RTN","ORWPCE4",107,0)
 .S ORY=ORY_U_ORICD_U_ORDCODE
"RTN","ORWPCE4",108,0)
 E  S ORY=ORY_U_U
"RTN","ORWPCE4",109,0)
 Q ORY
"RTN","ORWPS")
0^61^B65076275
"RTN","ORWPS",1,0)
ORWPS ;SLC/KCM,JLI,REV,CLA - MEDS TAB;12/04/2014  13:06 ;08/31/15  10:47
"RTN","ORWPS",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,116,132,141,173,203,190,195,265,275,243,280,350**;Dec 17, 1997;Build 77
"RTN","ORWPS",3,0)
 ;;Per VHA Directive 6402, this routine should not be modified.
"RTN","ORWPS",4,0)
COVER(LST,DFN,FILTER) ; retrieve meds for cover sheet
"RTN","ORWPS",5,0)
 S FILTER=$G(FILTER,0)
"RTN","ORWPS",6,0)
 K ^TMP("PS",$J)
"RTN","ORWPS",7,0)
 D OCL^PSOORRL(DFN,"","")
"RTN","ORWPS",8,0)
 N ILST,ITMP,X,VAIN,VAERR S ILST=0
"RTN","ORWPS",9,0)
 D:FILTER INP^VADPT
"RTN","ORWPS",10,0)
 S ITMP="" F  S ITMP=$O(^TMP("PS",$J,ITMP)) Q:'ITMP  D
"RTN","ORWPS",11,0)
 . I FILTER,$G(VAIN(1))>0,$P(^TMP("PS",$J,ITMP,0),U)["N;O" Q
"RTN","ORWPS",12,0)
 . S X=^TMP("PS",$J,ITMP,0)
"RTN","ORWPS",13,0)
 . I '$L($P(X,U,2)) S X="??"  ; show something if drug empty
"RTN","ORWPS",14,0)
 . I $D(^TMP("PS",$J,ITMP,"CLINIC",0)) S LST($$NXT)=$P(X,U,1,2)_U_$P(X,U,8,9)_U_"C"
"RTN","ORWPS",15,0)
 . E  S LST($$NXT)=$P(X,U,1,2)_U_$P(X,U,8,9)
"RTN","ORWPS",16,0)
 K ^TMP("PS",$J)
"RTN","ORWPS",17,0)
 Q
"RTN","ORWPS",18,0)
DT(X) ; -- Returns FM date for X
"RTN","ORWPS",19,0)
 N Y,%DT S %DT="T",Y="" D:X'="" ^%DT
"RTN","ORWPS",20,0)
 Q Y
"RTN","ORWPS",21,0)
 ;
"RTN","ORWPS",22,0)
ACTIVE(LST,DFN,USER,VIEW,UPDATE) ; retrieve active inpatient & outpatient meds
"RTN","ORWPS",23,0)
 K ^TMP("PS",$J)
"RTN","ORWPS",24,0)
 K ^TMP("ORACT",$J)
"RTN","ORWPS",25,0)
 N BEG,DATE,END,ERROR,CTX,STVIEW
"RTN","ORWPS",26,0)
 S (BEG,END,CTX)=""
"RTN","ORWPS",27,0)
 S VIEW=+$G(VIEW)
"RTN","ORWPS",28,0)
 S UPDATE=+$G(UPDATE)
"RTN","ORWPS",29,0)
 I VIEW=0,UPDATE=0 S VIEW=1
"RTN","ORWPS",30,0)
 S CTX=$$GET^XPAR("ALL","ORCH CONTEXT MEDS")
"RTN","ORWPS",31,0)
 I CTX=";" D DEL^XPAR("USR.`"_DUZ,"ORCH CONTEXT MEDS")
"RTN","ORWPS",32,0)
 S CTX=$$GET^XPAR("ALL","ORCH CONTEXT MEDS")
"RTN","ORWPS",33,0)
 S BEG=$$DT($P(CTX,";")),END=$$DT($P(CTX,";",2))
"RTN","ORWPS",34,0)
 I +$G(USER)=0 S USER=DUZ
"RTN","ORWPS",35,0)
 I UPDATE=1 D
"RTN","ORWPS",36,0)
 .S STVIEW=$$GET^XPAR($G(USER)_";VA(200,","OR MEDS TAB SORT",1,"I")
"RTN","ORWPS",37,0)
 .I VIEW>0,+STVIEW'=VIEW D PUT^XPAR(DUZ_";VA(200,","OR MEDS TAB SORT",,VIEW,.ERROR) S STVIEW=VIEW
"RTN","ORWPS",38,0)
 .I VIEW=0,+STVIEW=0 D PUT^XPAR(DUZ_";VA(200,","OR MEDS TAB SORT",,"1",.ERROR) S STVIEW=1,VIEW=1
"RTN","ORWPS",39,0)
 .I VIEW=0,+STVIEW'=VIEW S VIEW=+STVIEW
"RTN","ORWPS",40,0)
 .S LST(0)=STVIEW_U
"RTN","ORWPS",41,0)
 .S DATE=""
"RTN","ORWPS",42,0)
 .I BEG>0,END>0 S DATE=" ("_$$FMTE^XLFDT(BEG,2)_"-"_$$FMTE^XLFDT(END,2)_")"
"RTN","ORWPS",43,0)
 .;I +BEG=0!(+END=0) S DATE=" (To set a specific date range go to Tools|Options|Other Parameters)"
"RTN","ORWPS",44,0)
 .S LST(0)=LST(0)_DATE
"RTN","ORWPS",45,0)
 D OCL^PSOORRL(DFN,BEG,END,VIEW)
"RTN","ORWPS",46,0)
 N ITMP,FIELDS,INSTRUCT,COMMENTS,REASON,NVSDT,TYPE,ILST,J S ILST=0
"RTN","ORWPS",47,0)
 S ITMP="" F  S ITMP=$O(^TMP("PS",$J,ITMP)) Q:'ITMP  D
"RTN","ORWPS",48,0)
 . K INSTRUCT,COMMENTS,REASON
"RTN","ORWPS",49,0)
 . K ^TMP("ORACT",$J,"COMMENTS")
"RTN","ORWPS",50,0)
 . S COMMENTS="^TMP(""ORACT"",$J,""COMMENTS"")"
"RTN","ORWPS",51,0)
 . S (INSTRUCT,@COMMENTS)="",FIELDS=^TMP("PS",$J,ITMP,0)
"RTN","ORWPS",52,0)
 . I +$P(FIELDS,"^",8),$D(^OR(100,+$P(FIELDS,"^",8),8,"C","XX")) D
"RTN","ORWPS",53,0)
 . . S $P(^TMP("PS",$J,ITMP,0),"^",2)="*"_$P(^TMP("PS",$J,ITMP,0),"^",2) ;dan testing
"RTN","ORWPS",54,0)
 . S TYPE=$S($P($P(FIELDS,U),";",2)="O":"OP",1:"UD")
"RTN","ORWPS",55,0)
 . I $D(^TMP("PS",$J,ITMP,"CLINIC",0)) S TYPE="CP"
"RTN","ORWPS",56,0)
 . N LOC,LOCEX S (LOC,LOCEX)=""
"RTN","ORWPS",57,0)
 . I TYPE="CP" S LOC=$G(^TMP("PS",$J,ITMP,"CLINIC",0))
"RTN","ORWPS",58,0)
 . S:LOC LOCEX=$P($G(^SC(+LOC,0)),U)_":"_+LOC ;IMO NEW
"RTN","ORWPS",59,0)
 . I TYPE="OP",$P(FIELDS,";")["N" S TYPE="NV"          ;non-VA med
"RTN","ORWPS",60,0)
 . I $O(^TMP("PS",$J,ITMP,"A",0))>0 S TYPE="IV"
"RTN","ORWPS",61,0)
 . I $O(^TMP("PS",$J,ITMP,"B",0))>0 S TYPE="IV"
"RTN","ORWPS",62,0)
 . I (TYPE="UD")!(TYPE="CP") D UDINST(.INSTRUCT,ITMP)
"RTN","ORWPS",63,0)
 . I TYPE="OP" D OPINST(.INSTRUCT,ITMP)
"RTN","ORWPS",64,0)
 . I TYPE="IV" D IVINST(.INSTRUCT,ITMP)
"RTN","ORWPS",65,0)
 . I TYPE="NV" D NVINST(.INSTRUCT,ITMP),NVREASON(.REASON,.NVSDT,ITMP)
"RTN","ORWPS",66,0)
 . I (TYPE="UD")!(TYPE="IV")!(TYPE="NV")!(TYPE="CP") D SETMULT(COMMENTS,ITMP,"SIO")
"RTN","ORWPS",67,0)
 . M COMMENTS=@COMMENTS
"RTN","ORWPS",68,0)
 . I $D(COMMENTS(1)) S COMMENTS(1)="\"_COMMENTS(1)
"RTN","ORWPS",69,0)
 . S:TYPE="NV" $P(FIELDS,U,4)=$G(NVSDT)
"RTN","ORWPS",70,0)
 . I LOC S LST($$NXT)="~CP:"_LOCEX_U_FIELDS
"RTN","ORWPS",71,0)
 . E  S LST($$NXT)="~"_TYPE_U_FIELDS
"RTN","ORWPS",72,0)
 . S J=0 F  S J=$O(INSTRUCT(J)) Q:'J  S LST($$NXT)=INSTRUCT(J)
"RTN","ORWPS",73,0)
 . S J=0 F  S J=$O(COMMENTS(J)) Q:'J  S LST($$NXT)="t"_COMMENTS(J)
"RTN","ORWPS",74,0)
 . S J=0 F  S J=$O(REASON(J)) Q:'J  S LST($$NXT)="t"_REASON(J)
"RTN","ORWPS",75,0)
 K ^TMP("PS",$J)
"RTN","ORWPS",76,0)
 K ^TMP("ORACT",$J)
"RTN","ORWPS",77,0)
 Q
"RTN","ORWPS",78,0)
NXT() ; increment ILST
"RTN","ORWPS",79,0)
 S ILST=ILST+1
"RTN","ORWPS",80,0)
 Q ILST
"RTN","ORWPS",81,0)
 ;
"RTN","ORWPS",82,0)
UDINST(Y,INDEX) ; assembles instructions for a unit dose order
"RTN","ORWPS",83,0)
 N I,X,RST
"RTN","ORWPS",84,0)
 S X=^TMP("PS",$J,INDEX,0)
"RTN","ORWPS",85,0)
 S RST="^TMP(""ORACT"",$J,""INSTRUCT"")"
"RTN","ORWPS",86,0)
 S @RST@(1)=" "_$P(X,U,2),@RST=1
"RTN","ORWPS",87,0)
 S X=$S($L($P(X,U,6)):$P(X,U,6),1:$P(X,U,7))
"RTN","ORWPS",88,0)
 I $L(X) S @RST=2,@RST@(2)=X
"RTN","ORWPS",89,0)
 E  S @RST=1 D SETMULT(.RST,INDEX,"SIG")
"RTN","ORWPS",90,0)
 S @RST@(2)="\Give: "_$G(@RST@(2)),@RST=$G(@RST,2)
"RTN","ORWPS",91,0)
 D SETMULT(RST,INDEX,"MDR"),SETMULT(RST,INDEX,"SCH")
"RTN","ORWPS",92,0)
 F I=3:1:@RST S @RST@(I)=" "_@RST@(I)
"RTN","ORWPS",93,0)
 M Y=@RST K @RST
"RTN","ORWPS",94,0)
 Q
"RTN","ORWPS",95,0)
OPINST(Y,INDEX) ; assembles instructions for an outpatient prescription
"RTN","ORWPS",96,0)
 N I,X,RST
"RTN","ORWPS",97,0)
 S X=^TMP("PS",$J,INDEX,0)
"RTN","ORWPS",98,0)
 S RST="^TMP(""ORACT"",$J,""INSTRUCT"")"
"RTN","ORWPS",99,0)
 S @RST@(1)=" "_$P(X,U,2),@RST=1
"RTN","ORWPS",100,0)
 I $L($P(X,U,12)) S @RST@(1)=@RST@(1)_"  Qty: "_$P(X,U,12)
"RTN","ORWPS",101,0)
 I $L($P(X,U,11)) S @RST@(1)=@RST@(1)_" for "_$P(X,U,11)_" days"
"RTN","ORWPS",102,0)
 D SETMULT(RST,INDEX,"SIG")
"RTN","ORWPS",103,0)
 I @RST=1 D
"RTN","ORWPS",104,0)
 . D SETMULT(RST,INDEX,"SIO")
"RTN","ORWPS",105,0)
 . D SETMULT(RST,INDEX,"MDR")
"RTN","ORWPS",106,0)
 . D SETMULT(RST,INDEX,"SCH")
"RTN","ORWPS",107,0)
 S @RST@(2)="\ Sig: "_$G(@RST@(2))
"RTN","ORWPS",108,0)
 F I=3:1:@RST S @RST@(I)=" "_@RST@(I)
"RTN","ORWPS",109,0)
 M Y=@RST K @RST
"RTN","ORWPS",110,0)
 Q
"RTN","ORWPS",111,0)
IVINST(Y,INDEX) ; assembles instructions for an IV order
"RTN","ORWPS",112,0)
 N SOLN1,I,RST,IVDUR,CNT
"RTN","ORWPS",113,0)
 S IVDUR=""
"RTN","ORWPS",114,0)
 S RST="^TMP(""ORACT"",$J,""INSTRUCT"")"
"RTN","ORWPS",115,0)
 S @RST=0 D SETMULT(RST,INDEX,"A") S SOLN1=@RST+1
"RTN","ORWPS",116,0)
 D SETMULT(RST,INDEX,"B")
"RTN","ORWPS",117,0)
 I $D(@RST@(SOLN1)),$L($P(FIELDS,U,2)) S @RST@(SOLN1)="in "_@RST@(SOLN1)
"RTN","ORWPS",118,0)
 S SOLN1=@RST+1
"RTN","ORWPS",119,0)
 S CNT=@RST
"RTN","ORWPS",120,0)
 D SETMULT(RST,INDEX,"MDR")
"RTN","ORWPS",121,0)
 I $D(^TMP("PS",$J,INDEX,"SCH",1,0)) S @RST@(@RST)=@RST@(@RST)_" "_^TMP("PS",$J,INDEX,"SCH",1,0)
"RTN","ORWPS",122,0)
 F I=1:1:@RST S @RST@(I)="\"_$TR(@RST@(I),U," ")
"RTN","ORWPS",123,0)
 I $D(@RST@(1)) S @RST@(1)=" "_$E(@RST@(1),2,999)
"RTN","ORWPS",124,0)
 S @RST@(@RST)=@RST@(@RST)_" "_$P(^TMP("PS",$J,INDEX,0),U,3)
"RTN","ORWPS",125,0)
 S:$D(^TMP("PS",$J,INDEX,"IVLIM",0)) IVDUR=$G(^TMP("PS",$J,INDEX,"IVLIM",0))
"RTN","ORWPS",126,0)
 I $L(IVDUR) D
"RTN","ORWPS",127,0)
 . N DURU,DURV S DURU="",DURV=0
"RTN","ORWPS",128,0)
 . I IVDUR["dose" D  Q
"RTN","ORWPS",129,0)
 . .S DURV=$P(IVDUR,"doses",2)
"RTN","ORWPS",130,0)
 . .S IVDUR="for a total of "_+DURV_$S(+DURV=1:"dose",+DURV>1:" doses",1:" dose")
"RTN","ORWPS",131,0)
 . .S @RST@(@RST)=@RST@(@RST)_" "_IVDUR
"RTN","ORWPS",132,0)
 . S DURU=$E(IVDUR,1),DURV=$E(IVDUR,2,$L(IVDUR))
"RTN","ORWPS",133,0)
 . I (DURU="D")!(DURU="d") S IVDUR="for "_+DURV_$S(+DURV=1:" day",+DURV>1:" days",1:" day")
"RTN","ORWPS",134,0)
 . I (DURU="H")!(DURU="h") S IVDUR="for "_+DURV_$S(+DURV=1:" hours",+DURV>1:" hours",1:" hour")
"RTN","ORWPS",135,0)
 . I (DURU="M")!(DURU="m") S IVDUR="with total volume "_+DURV_" ml"
"RTN","ORWPS",136,0)
 . I (DURU="L")!(DURU="l") S IVDUR="with total volume "_+DURV_" L"
"RTN","ORWPS",137,0)
 . S @RST@(@RST)=@RST@(@RST)_" "_IVDUR
"RTN","ORWPS",138,0)
 M Y=@RST K @RST
"RTN","ORWPS",139,0)
 Q
"RTN","ORWPS",140,0)
NVINST(Y,INDEX) ; assembles instructions for a non-VA med
"RTN","ORWPS",141,0)
 N I,X,RST
"RTN","ORWPS",142,0)
 S X=^TMP("PS",$J,INDEX,0)
"RTN","ORWPS",143,0)
 S RST="^TMP(""ORACT"",$J,""INSTRUCT"")"
"RTN","ORWPS",144,0)
 S @RST@(1)=" "_$P(X,U,2),@RST=1
"RTN","ORWPS",145,0)
 D SETMULT(RST,INDEX,"SIG")
"RTN","ORWPS",146,0)
 I @RST=1 D
"RTN","ORWPS",147,0)
 . D SETMULT(RST,INDEX,"SIO")
"RTN","ORWPS",148,0)
 . D SETMULT(RST,INDEX,"MDR")
"RTN","ORWPS",149,0)
 . D SETMULT(RST,INDEX,"SCH")
"RTN","ORWPS",150,0)
 S @RST@(2)="\ "_$G(@RST@(2))
"RTN","ORWPS",151,0)
 F I=3:1:@RST S @RST@(I)=" "_@RST@(I)
"RTN","ORWPS",152,0)
 M Y=@RST K @RST
"RTN","ORWPS",153,0)
 Q
"RTN","ORWPS",154,0)
NVREASON(ORR,NVSDT,INDEX) ; assembles start date and reasons for a non-VA med
"RTN","ORWPS",155,0)
 N ORI,J,X,ORN,ORA
"RTN","ORWPS",156,0)
 S ORI=0 K ORR
"RTN","ORWPS",157,0)
 S X=^TMP("PS",$J,INDEX,0)
"RTN","ORWPS",158,0)
 S ORN=+$P(X,U,8)
"RTN","ORWPS",159,0)
 I $D(^OR(100,ORN,0)) D
"RTN","ORWPS",160,0)
 .S NVSDT=$P(^OR(100,ORN,0),U,8)
"RTN","ORWPS",161,0)
 .D WPVAL^ORWDXR(.ORA,ORN,"STATEMENTS") I $D(ORA) D
"RTN","ORWPS",162,0)
 ..S J=0 F  S J=$O(ORA(J)) Q:J<1  S ORI=ORI+1,ORR(ORI)=ORA(J)
"RTN","ORWPS",163,0)
 Q
"RTN","ORWPS",164,0)
SETMULT(Y,INDEX,SUB) ; appends the multiple at the subscript to Y
"RTN","ORWPS",165,0)
 N I,X,J
"RTN","ORWPS",166,0)
 S J=$G(@Y)
"RTN","ORWPS",167,0)
 S I=0 F  S I=$O(^TMP("PS",$J,INDEX,SUB,I)) Q:'I  S X=$G(^(I,0)) D
"RTN","ORWPS",168,0)
 . I SUB="B",$L($P(X,U,3)) S X=$P(X,U)_" "_$P(X,U,3)_"^"_$P(X,U,2)
"RTN","ORWPS",169,0)
 . S J=J+1,@Y@(J)=X
"RTN","ORWPS",170,0)
 S @Y=J
"RTN","ORWPS",171,0)
 Q
"RTN","ORWPS",172,0)
COMPRESS(Y) ; concatenate Y subscripts into smallest possible number
"RTN","ORWPS",173,0)
 N I,J,X S J=1,X(J)=""
"RTN","ORWPS",174,0)
 S I=0 F  S I=$O(Y(I)) Q:'I  D
"RTN","ORWPS",175,0)
 . I ($L(Y(I))+$L(X(J)))>245 S J=J+1,X(J)=""
"RTN","ORWPS",176,0)
 . S X(J)=X(J)_$S($L(X(J)):" ",1:"")_Y(I)
"RTN","ORWPS",177,0)
 K Y M Y=X
"RTN","ORWPS",178,0)
 Q
"RTN","ORWPS",179,0)
DETAIL(ROOT,DFN,ID) ; -- show details for a med order
"RTN","ORWPS",180,0)
 K ^TMP("ORXPND",$J)
"RTN","ORWPS",181,0)
 N LCNT,ORVP
"RTN","ORWPS",182,0)
 S LCNT=0,ORVP=DFN_";DPT("
"RTN","ORWPS",183,0)
 D MEDS^ORCXPND1
"RTN","ORWPS",184,0)
 S ROOT=$NA(^TMP("ORXPND",$J))
"RTN","ORWPS",185,0)
 Q
"RTN","ORWPS",186,0)
MEDHIST(ORROOT,DFN,ORIFN) ; -- show admin history for a med  (RV)
"RTN","ORWPS",187,0)
 N ORPSID,HPIV,ISIV,CKPKG,ORPHMID
"RTN","ORWPS",188,0)
 N CLIVDISP
"RTN","ORWPS",189,0)
 S ORPSID=+$P($$OI^ORX8(ORIFN),U,3),ISIV=0,HPIV=0
"RTN","ORWPS",190,0)
 S ORROOT=$NA(^TMP("ORHIST",$J)) K @ORROOT
"RTN","ORWPS",191,0)
 S ORPHMID=$G(^OR(100,+ORIFN,4))  ;Pharmacy order number
"RTN","ORWPS",192,0)
 S ISIV=$O(^ORD(100.98,"B","IV RX",ISIV))
"RTN","ORWPS",193,0)
 S HPIV=$O(^ORD(100.98,"B","TPN",HPIV))
"RTN","ORWPS",194,0)
 S CLIVDISP=$O(^ORD(100.98,"B","CI RX",""))
"RTN","ORWPS",195,0)
 S CKPKG=$$PATCH^XPDUTL("PSB*2.0*19")
"RTN","ORWPS",196,0)
 ;if the order is pending or the order has no pharmacy #
"RTN","ORWPS",197,0)
 ;or the order is not in the Display Group IV MEDICATION
"RTN","ORWPS",198,0)
 ; then use the Orderable item number to get the MAH.
"RTN","ORWPS",199,0)
 I (ORPHMID["P")!(ORPHMID="") D  Q
"RTN","ORWPS",200,0)
 . I '$L($T(HISTORY^PSBMLHS)) D  Q
"RTN","ORWPS",201,0)
 . . S @ORROOT@(0)="This report is only available using BCMA version 2.0."
"RTN","ORWPS",202,0)
 . D HISTORY^PSBMLHS(.ORROOT,DFN,ORPSID)  ; DBIA #3459 for BCMA v2.0
"RTN","ORWPS",203,0)
 ; If the order has a Display Group of IV MEDICATION the use the Pharmacy order number to get the MA
"RTN","ORWPS",204,0)
 I ($P($G(^OR(100,+ORIFN,0)),U,11)=ISIV)!($P($G(^OR(100,+ORIFN,0)),U,11)=HPIV)!($P($G(^OR(100,+ORIFN,0)),U,11)=CLIVDISP) D  Q
"RTN","ORWPS",205,0)
 . I 'CKPKG S @ORROOT@(0)="Medication Administration History is not available at this time for IV fluids."
"RTN","ORWPS",206,0)
 . I CKPKG D
"RTN","ORWPS",207,0)
 . . D RPC^PSBO(.ORROOT,"PM",DFN,"","","","","","","","","",ORPHMID)  ;DBIA #3955
"RTN","ORWPS",208,0)
 . . I '$D(@ORROOT) S @ORROOT@(0)="No Medication Administration History found for the IV order."
"RTN","ORWPS",209,0)
 I '$L($T(HISTORY^PSBMLHS)) D  Q
"RTN","ORWPS",210,0)
 . S @ORROOT@(0)="This report is only available using BCMA version 2.0."
"RTN","ORWPS",211,0)
 D HISTORY^PSBMLHS(.ORROOT,DFN,ORPSID)  ; DBIA #3459 for BCMA v2.0
"RTN","ORWPS",212,0)
 Q
"RTN","ORWPS",213,0)
 ;
"RTN","ORWPS",214,0)
REASON(ORY) ; -- Return Non-VA Med Statement/Reasons
"RTN","ORWPS",215,0)
 N ORE
"RTN","ORWPS",216,0)
 D GETLST^XPAR(.ORY,"ALL","ORWD NONVA REASON","E")
"RTN","ORWPS",217,0)
 Q
"RTN","ORWRP1A")
0^22^B8386925
"RTN","ORWRP1A",1,0)
ORWRP1A ;SLC/DCM - REPORT CALLS CONTINUED ;03/17/2015  10:24
"RTN","ORWRP1A",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**109,160,350**;Dec 17, 1997;Build 77
"RTN","ORWRP1A",3,0)
BCMA1(OROOT,ORDFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,ORMAX,ORFHIE) ;BCMA Med Log
"RTN","ORWRP1A",4,0)
 Q:'$G(ORDFN)
"RTN","ORWRP1A",5,0)
 I $L($G(DTRANGE)),'$G(ALPHA) S ALPHA=$$FMADD^XLFDT(DT,-DTRANGE),OMEGA=$$NOW^XLFDT
"RTN","ORWRP1A",6,0)
 Q:'$G(ALPHA)  Q:'$G(OMEGA)
"RTN","ORWRP1A",7,0)
 I $L($T(RPC^PSBO)) D RPC^PSBO(.OROOT,"ML",ORDFN,ALPHA,OMEGA,"0^0^0^0^1^1")
"RTN","ORWRP1A",8,0)
 I '$L($G(OROOT)) Q
"RTN","ORWRP1A",9,0)
 I '$O(@OROOT@(0)) S @OROOT@(1)="",@OROOT@(2)="No report available..."
"RTN","ORWRP1A",10,0)
 Q
"RTN","ORWRP1A",11,0)
BCMA2(OROOT,ORDFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,ORMAX,ORFHIE) ;BCMA MAH Report
"RTN","ORWRP1A",12,0)
 Q:'$G(ORDFN)
"RTN","ORWRP1A",13,0)
 I $L($G(DTRANGE)),'$G(ALPHA) S ALPHA=$$FMADD^XLFDT(DT,-DTRANGE),OMEGA=$$NOW^XLFDT
"RTN","ORWRP1A",14,0)
 Q:'$G(ALPHA)  Q:'$G(OMEGA)
"RTN","ORWRP1A",15,0)
 I $L($T(RPC^PSBO)) D RPC^PSBO(.OROOT,"MH",ORDFN,ALPHA,OMEGA,"")
"RTN","ORWRP1A",16,0)
 I '$L($G(OROOT)) Q
"RTN","ORWRP1A",17,0)
 I '$O(@OROOT@(0)) S @OROOT@(1)="",@OROOT@(2)="No report available..."
"RTN","ORWRP1A",18,0)
 Q
"RTN","ORWRP1A",19,0)
EM(OROOT,ORDFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,ORMAX,ORFHIE) ; -- get Electron Microscopy Report
"RTN","ORWRP1A",20,0)
 N I,C,LINES,X,ORSBHEAD,ORZIP
"RTN","ORWRP1A",21,0)
 K ^TMP("LRC",$J),^TMP("LRH",$J)
"RTN","ORWRP1A",22,0)
 S ORSBHEAD("EM")=""
"RTN","ORWRP1A",23,0)
 D EN^LR7OSUM(.ORZIP,ORDFN,,,,80,.ORSBHEAD)
"RTN","ORWRP1A",24,0)
 I '$O(^TMP("LRC",$J,0)) S ^TMP("LRC",$J,1,0)="",^TMP("LRC",$J,2,0)="No EM reports available..."
"RTN","ORWRP1A",25,0)
 S OROOT=$NA(^TMP("LRC",$J))
"RTN","ORWRP1A",26,0)
 K ^TMP("LRH",$J)
"RTN","ORWRP1A",27,0)
 Q
"RTN","ORWRP1A",28,0)
CY(OROOT,ORDFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,ORMAX,ORFHIE) ; -- get Cytology Report
"RTN","ORWRP1A",29,0)
 N I,C,LINES,X,ORSBHEAD,ORZIP
"RTN","ORWRP1A",30,0)
 K ^TMP("LRC",$J),^TMP("LRH",$J)
"RTN","ORWRP1A",31,0)
 S ORSBHEAD("CYTOPATHOLOGY")=""
"RTN","ORWRP1A",32,0)
 D EN^LR7OSUM(.ORZIP,ORDFN,,,,80,.ORSBHEAD)
"RTN","ORWRP1A",33,0)
 I '$O(^TMP("LRC",$J,0)) S ^TMP("LRC",$J,1,0)="",^TMP("LRC",$J,2,0)="No Cytology reports available..."
"RTN","ORWRP1A",34,0)
 S OROOT=$NA(^TMP("LRC",$J))
"RTN","ORWRP1A",35,0)
 K ^TMP("LRH",$J)
"RTN","ORWRP1A",36,0)
 Q
"RTN","ORWRP1A",37,0)
SP(OROOT,ORDFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,ORMAX,ORFHIE) ; -- get Surgical Pathology Report
"RTN","ORWRP1A",38,0)
 N I,C,LINES,X,ORSBHEAD,ORZIP
"RTN","ORWRP1A",39,0)
 K ^TMP("LRC",$J),^TMP("LRH",$J)
"RTN","ORWRP1A",40,0)
 S ORSBHEAD("SURGICAL PATHOLOGY")=""
"RTN","ORWRP1A",41,0)
 D EN^LR7OSUM(.ORZIP,ORDFN,,,,80,.ORSBHEAD)
"RTN","ORWRP1A",42,0)
 I '$O(^TMP("LRC",$J,0)) S ^TMP("LRC",$J,1,0)="",^TMP("LRC",$J,2,0)="No Surgical Pathology reports available..."
"RTN","ORWRP1A",43,0)
 S OROOT=$NA(^TMP("LRC",$J))
"RTN","ORWRP1A",44,0)
 K ^TMP("LRH",$J)
"RTN","ORWRP1A",45,0)
 Q
"RTN","ORWRP1A",46,0)
AU(OROOT,ORDFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,ORMAX,ORFHIE) ; -- get Autopsy Report
"RTN","ORWRP1A",47,0)
 N I,C,LINES,X,ORSBHEAD,ORZIP
"RTN","ORWRP1A",48,0)
 K ^TMP("LRC",$J),^TMP("LRH",$J)
"RTN","ORWRP1A",49,0)
 S ORSBHEAD("AUTOPSY")=""
"RTN","ORWRP1A",50,0)
 D EN^LR7OSUM(.ORZIP,ORDFN,,,,80,.ORSBHEAD)
"RTN","ORWRP1A",51,0)
 I '$O(^TMP("LRC",$J,0)) S ^TMP("LRC",$J,1,0)="",^TMP("LRC",$J,2,0)="No Autopsy report available..."
"RTN","ORWRP1A",52,0)
 S OROOT=$NA(^TMP("LRC",$J))
"RTN","ORWRP1A",53,0)
 K ^TMP("LRH",$J)
"RTN","ORWRP1A",54,0)
 Q
"RTN","ORWRP1A",55,0)
RADIO(OROOT) ; -- get value of OR REPORT DATE SELECT TYPE parameter
"RTN","ORWRP1A",56,0)
 S OROOT=$$GET^XPAR("DIV^SYS^PKG","OR REPORT DATE SELECT TYPE",1,"Q")
"RTN","ORWRP1A",57,0)
 Q
"RTN","ORWRP3")
0^23^B12651269
"RTN","ORWRP3",1,0)
ORWRP3 ;SLC/DCM - OE/RR REPORT EXTRACT RPCS ;03/17/2015  10:24
"RTN","ORWRP3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**109,120,132,215,243,350**;Dec 17, 1997;Build 77
"RTN","ORWRP3",3,0)
 ;
"RTN","ORWRP3",4,0)
 ; DBIA 4011   Access ^XWB(8994)
"RTN","ORWRP3",5,0)
 ;
"RTN","ORWRP3",6,0)
EX(ROOT,TST) ;Expand columns
"RTN","ORWRP3",7,0)
  ;TST=ptr to file 101.24
"RTN","ORWRP3",8,0)
  ;Y(i)=id^Name^Qualifier^IOM^Entry^Routine^Remote^Type^Category^RPC^ifn^sort_order^max_days^direct^hdr^fhie
"RTN","ORWRP3",9,0)
  Q:'$G(TST)
"RTN","ORWRP3",10,0)
  N J,X,X0,X1,X2,X4,RPC,HEAD,ORX0,ORX2,ORX4,ORX,ORTIMOCC,MAX
"RTN","ORWRP3",11,0)
  I '$L($G(C)) S C=0
"RTN","ORWRP3",12,0)
  S ORTIMOCC=$$GET^XPAR("USR.`"_DUZ_"^SYS^PKG","ORWRP TIME/OCC LIMITS INDV",+TST,"I")
"RTN","ORWRP3",13,0)
  I '$L(ORTIMOCC) S ORTIMOCC=$$GET^XPAR("USR.`"_DUZ_"^SYS^PKG","ORWRP TIME/OCC LIMITS ALL",1,"I")
"RTN","ORWRP3",14,0)
  S X0=$G(^ORD(101.24,+TST,0)),X2=$G(^(2)),X4=$G(^(4)),MAX=$P(X4,"^",2),X=$P($P(ORTIMOCC,";"),"-",2)
"RTN","ORWRP3",15,0)
  I $P(X4,"^",10) Q
"RTN","ORWRP3",16,0)
  I X,MAX,X>MAX S ORTIMOCC="T-"_MAX_";"_$P(ORTIMOCC,";",2,99)
"RTN","ORWRP3",17,0)
  I '$L(ORTIMOCC) S ORTIMOCC=";;"
"RTN","ORWRP3",18,0)
  I '$O(^ORD(101.24,+TST,10,0)) D  Q
"RTN","ORWRP3",19,0)
  . Q:$P(X0,"^",12)="L"
"RTN","ORWRP3",20,0)
  . S RPC=$P($G(^XWB(8994,+$P(X0,"^",13),0)),"^")  ;DBIA 4011
"RTN","ORWRP3",21,0)
  . S HEAD=$P(X0,"^")
"RTN","ORWRP3",22,0)
  . I $L($P(X2,"^",3)) S HEAD=$P(X2,"^",3)
"RTN","ORWRP3",23,0)
  . S X1=$P(X0,U,2)_U_HEAD_U_ORTIMOCC_";"_$P(X0,U,4)_U_$P(X0,U,19)_";"_$P(X0,U,20)_";"
"RTN","ORWRP3",24,0)
  . S X=X1_+$P(X0,U,21)_U_$P(X0,U,6)_U_$P(X0,U,5)_U_$P(X0,U,3)_U_$P(X0,U,12)_U_$P(X0,U,7)_U_RPC_U_+TST_U_$P(X4,U)_U_$P(X4,U,2)_U_$P(X4,U,4)_U_$P(X4,U,5)_U_$P(X4,U,8)_U_$P(X4,U,9)
"RTN","ORWRP3",25,0)
  . D SETITEM(.ROOT,X)
"RTN","ORWRP3",26,0)
  I $O(^ORD(101.24,+TST,10,0)) S ORX0=^ORD(101.24,+TST,0),ORX2=$G(^(2)),ORX4=$G(^(4)) D
"RTN","ORWRP3",27,0)
  . I $P(ORX4,"^",10) Q
"RTN","ORWRP3",28,0)
  . S RPC=$P($G(^XWB(8994,+$P(X0,"^",13),0)),"^")  ;DBIA 4011
"RTN","ORWRP3",29,0)
  . S X=ORX0,HEAD=$P(X,"^")
"RTN","ORWRP3",30,0)
  . I $L($P(ORX2,"^",3)) S HEAD=$P(ORX2,"^",3)
"RTN","ORWRP3",31,0)
  . S X1=$P(X,U,2)_U_HEAD_U_ORTIMOCC_";"_$P(X,U,4)_U_$P(X,U,19)_";"_$P(X,U,20)_";"
"RTN","ORWRP3",32,0)
  . S ORX=X1_+$P(X,U,21)_U_$P(X,U,6)_U_$P(X,U,5)_U_$P(X,U,3)_U_$P(X,U,12)_U_$P(X,U,7)_U_RPC_U_+TST_U_$P(ORX4,U)_U_$P(ORX4,U,2)_U_$P(ORX4,U,4)_U_$P(ORX4,U,5)_U_$P(ORX4,U,8)_U_$P(X4,U,9)
"RTN","ORWRP3",33,0)
  . D SETITEM(.ROOT,"[PARENT START]^"_ORX)
"RTN","ORWRP3",34,0)
  . S J=0 F  S J=$O(^ORD(101.24,+TST,10,J)) Q:J<1  S X=^(J,0) D EX(.ROOT,+X)
"RTN","ORWRP3",35,0)
  . D SETITEM(.ROOT,"[PARENT END]^"_ORX)
"RTN","ORWRP3",36,0)
  Q
"RTN","ORWRP3",37,0)
LIST(LST,TAB)       ;Get list for Reports & Labs Tab Treeview
"RTN","ORWRP3",38,0)
 N ROOT
"RTN","ORWRP3",39,0)
 S ROOT=$NA(LST)
"RTN","ORWRP3",40,0)
 K @ROOT
"RTN","ORWRP3",41,0)
 D TRY1(.ROOT,$G(TAB))
"RTN","ORWRP3",42,0)
 Q
"RTN","ORWRP3",43,0)
TRY1(ROOT,TAB)    ;Test expanding reports using established parameters
"RTN","ORWRP3",44,0)
 N I,ORLIST,ORENT,ORDEF,ORJUNK,ORNLIST,C
"RTN","ORWRP3",45,0)
 D SETITEM(.ROOT,"[REPORT LIST]")
"RTN","ORWRP3",46,0)
 D GETLST^XPAR(.ORLIST,"ALL",$S($G(TAB)="LABS":"ORWRP REPORT LAB LIST",1:"ORWRP REPORT LIST"))
"RTN","ORWRP3",47,0)
 I $G(TAB)="LABS" D
"RTN","ORWRP3",48,0)
 . S ORENT="ALL^"_$G(ORL)_$S($G(^VA(200,DUZ,5)):"^SRV.`"_+$G(^(5)),1:"")
"RTN","ORWRP3",49,0)
 . S ORDEF=$$GET^XPAR(ORENT,"OR LAB TAB DEFAULT REPORT") Q:ORDEF'>0
"RTN","ORWRP3",50,0)
 . S I=0,ORJUNK=0 F  S I=$O(ORLIST(I)) Q:'I  I $P(ORLIST(I),"^",2)=ORDEF S ORJUNK=I Q
"RTN","ORWRP3",51,0)
 . S I=0,C=1,ORNLIST(1)="1^"_ORDEF F  S I=$O(ORLIST(I)) Q:'I  I I'=ORJUNK S C=C+1,ORNLIST(C)=ORLIST(I)
"RTN","ORWRP3",52,0)
 . K ORLIST M ORLIST=ORNLIST
"RTN","ORWRP3",53,0)
 S I=0
"RTN","ORWRP3",54,0)
 F  S I=$O(ORLIST(I)) Q:'I  Q:'$D(^ORD(101.24,$P(ORLIST(I),"^",2),0))  D EX(.ROOT,$P(ORLIST(I),"^",2))
"RTN","ORWRP3",55,0)
 D SETITEM(.ROOT,"$$END")
"RTN","ORWRP3",56,0)
 Q
"RTN","ORWRP3",57,0)
SETITEM(ROOT,X) ; -- set item in list
"RTN","ORWRP3",58,0)
 S @ROOT@($O(@ROOT@(9999),-1)+1)=X
"RTN","ORWRP3",59,0)
 Q
"RTN","ORWU")
0^53^B62530173
"RTN","ORWU",1,0)
ORWU ;SLC/KCM - GENERAL UTILITIES FOR WINDOWS CALLS ;04/01/2015  04:17
"RTN","ORWU",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,132,148,149,187,195,215,243,350**;Dec 17, 1997;Build 77
"RTN","ORWU",3,0)
 ;
"RTN","ORWU",4,0)
DT(Y,X,%DT) ; Internal Fileman Date/Time
"RTN","ORWU",5,0)
 ; change the '00:00' that could be passed so Fileman doesn't reject
"RTN","ORWU",6,0)
 I $L($P(X,"@",2)),("00000000"[$TR($P(X,"@",2),":","")) S $P(X,"@",2)="00:00:01"
"RTN","ORWU",7,0)
 S %DT=$G(%DT,"TS") D ^%DT K %DT
"RTN","ORWU",8,0)
 Q
"RTN","ORWU",9,0)
VALDT(Y,X,%DT) ; Validate date/time
"RTN","ORWU",10,0)
 S:'$D(%DT) %DT="TX" D ^%DT
"RTN","ORWU",11,0)
 Q
"RTN","ORWU",12,0)
USERINFO(REC) ; Relevant info for current user
"RTN","ORWU",13,0)
 ; return DUZ^NAME^USRCLS^CANSIGN^ISPROVIDER^ORDERROLE^NOORDER^DTIME^
"RTN","ORWU",14,0)
 ;        COUNTDOWN^ENABLEVERIFY^NOTIFYAPPS^MSGHANG^DOMAIN^SERVICE^
"RTN","ORWU",15,0)
 ;        AUTOSAVE^INITTAB^LASTTAB^WEBACCESS^ALLOWHOLD^ISRPL^RPLLIST^
"RTN","ORWU",16,0)
 ;        CORTABS^RPTTAB^STANUM^GECSTATUS^PRODACCT
"RTN","ORWU",17,0)
 N X,ORRPL,ORRPL1,ORRPL2,ORTAB,CORTABS,RPTTAB,ORDT,OREFF,OREXP,ORDATEOK
"RTN","ORWU",18,0)
 S REC=DUZ_U_$P(^VA(200,DUZ,0),U)
"RTN","ORWU",19,0)
 S $P(REC,U,3)=$S($D(^XUSEC("ORES",DUZ)):3,$D(^XUSEC("ORELSE",DUZ)):2,$D(^XUSEC("OREMAS",DUZ)):1,1:0)
"RTN","ORWU",20,0)
 S $P(REC,U,4)=$D(^XUSEC("ORES",DUZ))&$D(^XUSEC("PROVIDER",DUZ))
"RTN","ORWU",21,0)
 S $P(REC,U,5)=$D(^XUSEC("PROVIDER",DUZ))
"RTN","ORWU",22,0)
 S $P(REC,U,6)=$$ORDROLE
"RTN","ORWU",23,0)
 S $P(REC,U,7)=$$GET^XPAR("USR^SYS^PKG","ORWOR DISABLE ORDERING",1,"I")
"RTN","ORWU",24,0)
 S $P(REC,U,8)=$$GET^XPAR("USR^SYS","ORWOR TIMEOUT CHART",1,"I")
"RTN","ORWU",25,0)
 I '$P(REC,U,8),$G(DTIME) S $P(REC,U,8)=DTIME
"RTN","ORWU",26,0)
 S $P(REC,U,9)=$$GET^XPAR("USR^SYS^PKG","ORWOR TIMEOUT COUNTDOWN",1,"I")
"RTN","ORWU",27,0)
 S X=$$GET^XPAR("USR^SYS^PKG","ORWOR ENABLE VERIFY",1,"I")
"RTN","ORWU",28,0)
 S $P(REC,U,10)=$S(X=1:1,X=2:0,1:'$P(REC,U,7))
"RTN","ORWU",29,0)
 S $P(REC,U,11)=$$GET^XPAR("USR^SYS^PKG","ORWOR BROADCAST MESSAGES",1,"I")
"RTN","ORWU",30,0)
 S $P(REC,U,12)=$$GET^XPAR("USR^SYS^PKG","ORWOR AUTO CLOSE PT MSG",1,"I")
"RTN","ORWU",31,0)
 S $P(REC,U,13)=$$KSP^XUPARAM("WHERE")  ; domain
"RTN","ORWU",32,0)
 S $P(REC,U,14)=+$G(^VA(200,DUZ,5))     ; service/section
"RTN","ORWU",33,0)
 S $P(REC,U,15)=$$GET^XPAR("USR^SYS^PKG","ORWOR AUTOSAVE NOTE",1,"I")
"RTN","ORWU",34,0)
 S $P(REC,U,16)=$$GET^XPAR("USR^DIV^SYS^PKG","ORCH INITIAL TAB",1,"I")
"RTN","ORWU",35,0)
 S $P(REC,U,17)=$$GET^XPAR("USR^DIV^SYS^PKG","ORCH USE LAST TAB",1,"I")
"RTN","ORWU",36,0)
 S $P(REC,U,18)=$$GET^XPAR("USR^DIV^SYS^PKG","ORWOR DISABLE WEB ACCESS",1,"I")
"RTN","ORWU",37,0)
 S $P(REC,U,19)=$$GET^XPAR("SYS^PKG","ORWOR DISABLE HOLD ORDERS",1,"I")
"RTN","ORWU",38,0)
 ; 2 pieces added by PKS on 11/5/2001 for "Reports Only:"
"RTN","ORWU",39,0)
 ; IA# 10060 allows read access to ^VA(200 file.
"RTN","ORWU",40,0)
 S ORRPL=$G(^VA(200,DUZ,101))           ; RPL node.
"RTN","ORWU",41,0)
 S ORRPL1=$P(ORRPL,U)
"RTN","ORWU",42,0)
 S $P(REC,U,20)=ORRPL1                  ; ISRPL piece.
"RTN","ORWU",43,0)
 S ORRPL2=$P(ORRPL,U,2)
"RTN","ORWU",44,0)
 S $P(REC,U,21)=ORRPL2                  ; RPLLIST piece.
"RTN","ORWU",45,0)
 ;
"RTN","ORWU",46,0)
 ; Additional pieces for CPRS tabs access:
"RTN","ORWU",47,0)
 ; IA# 10060 allows read access to ^VA(200.01013 multiple.
"RTN","ORWU",48,0)
 S ORDT=DT                              ; Today.
"RTN","ORWU",49,0)
 S (CORTABS,RPTTAB)=0
"RTN","ORWU",50,0)
 S ORRPL=0
"RTN","ORWU",51,0)
 F  S ORRPL=$O(^VA(200,DUZ,"ORD",ORRPL)) Q:ORRPL<1  D
"RTN","ORWU",52,0)
 .S ORTAB=$G(^VA(200,DUZ,"ORD",ORRPL,0))
"RTN","ORWU",53,0)
 .I ORTAB="" Q
"RTN","ORWU",54,0)
 .S OREFF=$P(ORTAB,U,2)
"RTN","ORWU",55,0)
 .S OREXP=$P(ORTAB,U,3)
"RTN","ORWU",56,0)
 .S ORTAB=$P(ORTAB,U)
"RTN","ORWU",57,0)
 .I ORTAB="" Q
"RTN","ORWU",58,0)
 .S ORTAB=$G(^ORD(101.13,ORTAB,0))
"RTN","ORWU",59,0)
 .I ORTAB="" Q
"RTN","ORWU",60,0)
 .S ORTAB=$P(ORTAB,U)
"RTN","ORWU",61,0)
 .I ORTAB="" Q
"RTN","ORWU",62,0)
 .S ORTAB=$$UP^XLFSTR(ORTAB)
"RTN","ORWU",63,0)
 .S ORDATEOK=1                             ; Default.
"RTN","ORWU",64,0)
 .I ((OREFF="")!(OREFF>ORDT)) S ORDATEOK=0 ; Eff. date NG.
"RTN","ORWU",65,0)
 .I ORDATEOK  D
"RTN","ORWU",66,0)
 ..I OREXP="" Q                            ; No exp. date.
"RTN","ORWU",67,0)
 ..I (OREXP<ORDT) S ORDATEOK=0             ; Exp. date NG.
"RTN","ORWU",68,0)
 ..I (OREXP=ORDT) S ORDATEOK=0             ; Exp. date NG.
"RTN","ORWU",69,0)
 .;
"RTN","ORWU",70,0)
 .; Set TRUE if OK:
"RTN","ORWU",71,0)
 .I ((ORTAB="COR")&(ORDATEOK)) S CORTABS=1
"RTN","ORWU",72,0)
 .I ((ORTAB="RPT")&(ORDATEOK)) S RPTTAB=1
"RTN","ORWU",73,0)
 ;
"RTN","ORWU",74,0)
 ; When done, set all valid tabs for access:
"RTN","ORWU",75,0)
 S $P(REC,U,22)=CORTABS                 ; "Core" tabs.
"RTN","ORWU",76,0)
 S $P(REC,U,23)=RPTTAB                  ; "Reports" tab.
"RTN","ORWU",77,0)
 ;
"RTN","ORWU",78,0)
 S $P(REC,U,24)=$P($$SITE^VASITE,U,3)
"RTN","ORWU",79,0)
 S $P(REC,U,25)=$$GET^XPAR("USR^TEA","PXRM GEC STATUS CHECK",1,"I")
"RTN","ORWU",80,0)
 S $P(REC,U,26)=$$PROD^XUPROD
"RTN","ORWU",81,0)
 Q
"RTN","ORWU",82,0)
 ;
"RTN","ORWU",83,0)
HASKEY(VAL,KEY) ; returns TRUE if the user possesses the security key
"RTN","ORWU",84,0)
 S VAL=''$D(^XUSEC(KEY,DUZ))
"RTN","ORWU",85,0)
 Q
"RTN","ORWU",86,0)
HASOPTN(VAL,OPTION) ; returns TRUE if the user has access to a menu option
"RTN","ORWU",87,0)
 S VAL=+$$ACCESS^XQCHK(DUZ,OPTION)
"RTN","ORWU",88,0)
 I VAL'>0 S VAL=0
"RTN","ORWU",89,0)
 E  S VAL=1
"RTN","ORWU",90,0)
 Q
"RTN","ORWU",91,0)
NPHASKEY(VAL,NP,KEY) ; returns TRUE if the person has the security key
"RTN","ORWU",92,0)
 S VAL=''$D(^XUSEC(KEY,NP))
"RTN","ORWU",93,0)
 Q
"RTN","ORWU",94,0)
ORDROLE() ; returns the role a person takes in ordering
"RTN","ORWU",95,0)
 ; VAL: 0=nokey, 1=clerk, 2=nurse, 3=physician, 4=student, 5=bad keys
"RTN","ORWU",96,0)
 ;I '$G(ORWCLVER) Q 0  ; version of client is to old for ordering
"RTN","ORWU",97,0)
 I ($D(^XUSEC("OREMAS",DUZ))+$D(^XUSEC("ORELSE",DUZ))+$D(^XUSEC("ORES",DUZ)))>1 Q 5
"RTN","ORWU",98,0)
 I $D(^XUSEC("OREMAS",DUZ)) Q 1                           ; clerk
"RTN","ORWU",99,0)
 I $D(^XUSEC("ORELSE",DUZ)) Q 2                           ; nurse
"RTN","ORWU",100,0)
 I $D(^XUSEC("ORES",DUZ)),$D(^XUSEC("PROVIDER",DUZ)) Q 3  ; doctor
"RTN","ORWU",101,0)
 I $D(^XUSEC("PROVIDER",DUZ)) Q 4                         ; student
"RTN","ORWU",102,0)
 Q 0
"RTN","ORWU",103,0)
VALIDSIG(ESOK,X) ; returns TRUE if valid electronic signature
"RTN","ORWU",104,0)
 S X=$$DECRYP^XUSRB1(X),ESOK=0                   ; network encrypted
"RTN","ORWU",105,0)
 D HASH^XUSHSHP
"RTN","ORWU",106,0)
 I X=$P($G(^VA(200,+DUZ,20)),U,4) S ESOK=1
"RTN","ORWU",107,0)
 Q
"RTN","ORWU",108,0)
TOOLMENU(ORLST) ; returns a list of items for the Tools menu
"RTN","ORWU",109,0)
 N ANENT
"RTN","ORWU",110,0)
 S ANENT="ALL^"_$S($G(^VA(200,DUZ,5)):"^SRV.`"_+$G(^(5)),1:"")
"RTN","ORWU",111,0)
 D GETLST^XPAR(.ORLST,ANENT,"ORWT TOOLS MENU","N")
"RTN","ORWU",112,0)
 Q
"RTN","ORWU",113,0)
ACTLOC(LOC) ; Function: returns TRUE if active hospital location
"RTN","ORWU",114,0)
 ; IA# 10040.
"RTN","ORWU",115,0)
 N D0,X I +$G(^SC(LOC,"OOS")) Q 0                ; screen out OOS entry
"RTN","ORWU",116,0)
 S D0=+$G(^SC(LOC,42)) I D0 D WIN^DGPMDDCF Q 'X  ; chk out of svc wards
"RTN","ORWU",117,0)
 S X=$G(^SC(LOC,"I")) I +X=0 Q 1                 ; no inactivate date
"RTN","ORWU",118,0)
 I DT>$P(X,U)&($P(X,U,2)=""!(DT<$P(X,U,2))) Q 0  ; chk reactivate date
"RTN","ORWU",119,0)
 Q 1                                             ; must still be active
"RTN","ORWU",120,0)
 ;
"RTN","ORWU",121,0)
CLINLOC(Y,FROM,DIR) ; Return a set of clinics from HOSPITAL LOCATION
"RTN","ORWU",122,0)
 ; .Y=returned list, FROM=text to $O from, DIR=$O direction,
"RTN","ORWU",123,0)
 N I,IEN,CNT S I=0,CNT=44
"RTN","ORWU",124,0)
 F  Q:I'<CNT  S FROM=$O(^SC("B",FROM),DIR) Q:FROM=""  D  ; IA# 10040.
"RTN","ORWU",125,0)
 . S IEN="" F  S IEN=$O(^SC("B",FROM,IEN),DIR) Q:'IEN  D
"RTN","ORWU",126,0)
 . . I ($P($G(^SC(IEN,0)),U,3)'="C")!('$$ACTLOC(IEN)) Q
"RTN","ORWU",127,0)
 . . S I=I+1,Y(I)=IEN_"^"_FROM
"RTN","ORWU",128,0)
 Q
"RTN","ORWU",129,0)
INPLOC(Y,FROM,DIR) ;Return a set of wards from HOSPITAL LOCATION
"RTN","ORWU",130,0)
 ; .Y=returned list, FROM=text to $O from, DIR=$O direction,
"RTN","ORWU",131,0)
 N I,IEN,CNT S I=0,CNT=44
"RTN","ORWU",132,0)
 F  Q:I'<CNT  S FROM=$O(^SC("B",FROM),DIR) Q:FROM=""  D  ; IA# 10040.
"RTN","ORWU",133,0)
 . S IEN="" F  S IEN=$O(^SC("B",FROM,IEN),DIR) Q:'IEN  D
"RTN","ORWU",134,0)
 . . I ($P($G(^SC(IEN,0)),U,3)'="W") Q
"RTN","ORWU",135,0)
 . . I '$$ACTLOC(IEN) Q
"RTN","ORWU",136,0)
 . . S I=I+1,Y(I)=IEN_"^"_FROM
"RTN","ORWU",137,0)
 Q
"RTN","ORWU",138,0)
HOSPLOC(Y,FROM,DIR) ; Return a set of locations from HOSPITAL LOCATION
"RTN","ORWU",139,0)
 ; .Y=returned list, FROM=text to $O from, DIR=$O direction,
"RTN","ORWU",140,0)
 N I,IEN,CNT S I=0,CNT=44
"RTN","ORWU",141,0)
 F  Q:I'<CNT  S FROM=$O(^SC("B",FROM),DIR) Q:FROM=""  D  ; IA# 10040.
"RTN","ORWU",142,0)
 . S IEN="" F  S IEN=$O(^SC("B",FROM,IEN),DIR) Q:'IEN  D
"RTN","ORWU",143,0)
 . . Q:("CW"'[$P($G(^SC(IEN,0)),U,3)!('$$ACTLOC(IEN)))
"RTN","ORWU",144,0)
 . . S I=I+1,Y(I)=IEN_"^"_FROM
"RTN","ORWU",145,0)
 Q
"RTN","ORWU",146,0)
NEWPERS(ORY,ORFROM,ORDIR,ORKEY,ORDATE,ORVIZ,ORALL) ; Return a set of names from the NEW PERSON file.
"RTN","ORWU",147,0)
 ; SLC/PKS: Code moved to ORWU1 on 12/3/2002.
"RTN","ORWU",148,0)
 D NP1^ORWU1
"RTN","ORWU",149,0)
 Q
"RTN","ORWU",150,0)
GBLREF(VAL,FN) ; return global reference for file number
"RTN","ORWU",151,0)
 S VAL="" Q:'FN
"RTN","ORWU",152,0)
 S VAL=$$ROOT^DILFD(+FN)
"RTN","ORWU",153,0)
 ; I $E($RE(VAL))="," S VAL=$E(VAL,1,$L(VAL)-1)_")"
"RTN","ORWU",154,0)
 ; I $E($RE(VAL))="(" S VAL=$P(VAL,"(",1)
"RTN","ORWU",155,0)
 Q
"RTN","ORWU",156,0)
GENERIC(Y,FROM,DIR,REF) ; Return a set of entries from xref in REF
"RTN","ORWU",157,0)
 ; .Y=returned list, FROM=text to $O from, DIR=$O direction,
"RTN","ORWU",158,0)
 N I,IEN,CNT S I=0,CNT=44
"RTN","ORWU",159,0)
 F  Q:I'<CNT  S FROM=$O(@REF@(FROM),DIR) Q:FROM=""  D
"RTN","ORWU",160,0)
 . S IEN="" F  S IEN=$O(@REF@(FROM,IEN),DIR) Q:'IEN  D
"RTN","ORWU",161,0)
 . . S I=I+1,Y(I)=IEN_"^"_FROM
"RTN","ORWU",162,0)
 Q
"RTN","ORWU",163,0)
EXTNAME(VAL,IEN,FN) ; return external form of pointer
"RTN","ORWU",164,0)
 ; IEN=internal number, FN=file number
"RTN","ORWU",165,0)
 N REF S REF=$G(^DIC(FN,0,"GL")),VAL=""
"RTN","ORWU",166,0)
 I $L(REF),+IEN S VAL=$P($G(@(REF_IEN_",0)")),U)
"RTN","ORWU",167,0)
 Q
"RTN","ORWU",168,0)
PARAM(VAL,APARAM) ; return a parameter value for a user
"RTN","ORWU",169,0)
 ; call assumes current user, default entities, single instance
"RTN","ORWU",170,0)
 S VAL=$$GET^XPAR("ALL",APARAM,1,"I")
"RTN","ORWU",171,0)
 Q
"RTN","ORWU",172,0)
PARAMS(ORLIST,APARAM) ; return a list of parameter values
"RTN","ORWU",173,0)
 ; call assumes current user, default entities, multiple instances
"RTN","ORWU",174,0)
 D GETLST^XPAR(.ORLIST,"ALL",APARAM,"Q")
"RTN","ORWU",175,0)
 Q
"RTN","ORWU",176,0)
DEVICE(Y,FROM,DIR) ; Return a subset of entries from the Device file
"RTN","ORWU",177,0)
 ; .LST(n)=IEN;Name^DisplayName^Location^RMar^PLen
"RTN","ORWU",178,0)
 ; FROM=text to $O from, DIR=$O direction
"RTN","ORWU",179,0)
 N I,IEN,CNT,SHOW,X S I=0,CNT=20
"RTN","ORWU",180,0)
 I FROM["<" S FROM=$RE($P($RE(FROM),"<  ",2))
"RTN","ORWU",181,0)
 F  Q:I'<CNT  S FROM=$O(^%ZIS(1,"B",FROM),DIR) Q:FROM=""  D
"RTN","ORWU",182,0)
 . S IEN=0 F  S IEN=$O(^%ZIS(1,"B",FROM,IEN)) Q:'IEN  D
"RTN","ORWU",183,0)
 .. N X0,X1,X90,X91,X95,XTYPE,XSTYPE,XTIME,ORA,ORPX,POP
"RTN","ORWU",184,0)
 .. Q:'$D(^%ZIS(1,IEN,0))  S X0=^(0),X1=$G(^(1)),X90=$G(^(90)),X91=$G(^(91)),X95=$G(^(95)),XSTYPE=$G(^("SUBTYPE")),XTIME=$G(^("TIME")),XTYPE=$G(^("TYPE"))
"RTN","ORWU",185,0)
 .. I $E($G(^%ZIS(2,+XSTYPE,0)))'="P" Q  ;Printers only
"RTN","ORWU",186,0)
 .. S X=$P(XTYPE,"^") I X'="TRM",X'="HG",X'="HFS",X'="CHAN" Q  ;Device Types
"RTN","ORWU",187,0)
 .. S X=X0 I ($P(X,U,2)="0")!($P(X,U,12)=2) Q  ;Queuing allowed
"RTN","ORWU",188,0)
 .. S X=+X90 I X,(X'>DT) Q  ;Out of Service
"RTN","ORWU",189,0)
 .. I XTIME]"" S ORA=$P(XTIME,"^"),ORPX=$P($H,",",2),ORPCNT=ORPX\60#60+(ORPX\3600*100),ORPX=$P(ORA,"-",2) I ORPX'<ORA&(ORPCNT'>ORPX&(ORPCNT'<ORA))!(ORPX<ORA&(ORPCNT'<ORA!(ORPCNT'>ORPX))) Q  ;Prohibited Times
"RTN","ORWU",190,0)
 .. S POP=0
"RTN","ORWU",191,0)
 .. I X95]"" S ORPX=$G(DUZ(0)) I ORPX'="@" S POP=1 F ORA=1:1:$L(ORPX) I X95[$E(ORPX,ORA) S POP=0 Q
"RTN","ORWU",192,0)
 .. Q:POP  ;Security check
"RTN","ORWU",193,0)
 .. S SHOW=$P(X0,U) I SHOW'=FROM S SHOW=FROM_"  <"_SHOW_">"
"RTN","ORWU",194,0)
 .. S I=I+1,Y(I)=IEN_";"_$P(X0,U)_U_SHOW_U_$P(X1,U)_U_$P(X91,U)_U_$P(X91,U,3)
"RTN","ORWU",195,0)
 Q
"RTN","ORWU",196,0)
URGENCY(Y) ; -- retrieve set values from dd for discharge summary urgency
"RTN","ORWU",197,0)
 N ORDD,I,X
"RTN","ORWU",198,0)
 D FIELD^DID(8925,.09,"","POINTER","ORDD")
"RTN","ORWU",199,0)
 F I=1:1 S X=$P(ORDD("POINTER"),";",I) Q:X=""   S Y(I)=$TR(X,":","^")
"RTN","ORWU",200,0)
 Q
"RTN","ORWU",201,0)
PATCH(VAL,X) ; Return 1 if patch X is installed
"RTN","ORWU",202,0)
 S VAL=$$PATCH^XPDUTL(X)
"RTN","ORWU",203,0)
 Q
"RTN","ORWU",204,0)
VERSION(VAL,X) ;Return version of package or namespace
"RTN","ORWU",205,0)
 S VAL=$$VERSION^XPDUTL(X)
"RTN","ORWU",206,0)
 Q
"RTN","ORWU",207,0)
VERSRV(VAL,X,CLVER) ; Return server version of option name
"RTN","ORWU",208,0)
 S ORWCLVER=$G(CLVER)  ; leave in partition for session
"RTN","ORWU",209,0)
 N BADVAL,ORLST
"RTN","ORWU",210,0)
 D FIND^DIC(19,"",1,"X",X,1,,,,"ORLST")
"RTN","ORWU",211,0)
 I 'ORLST("DILIST",0) S VAL="0.0.0.0" Q
"RTN","ORWU",212,0)
 S VAL=ORLST("DILIST","ID",1,1)
"RTN","ORWU",213,0)
 S VAL=$P(VAL,"version ",2)
"RTN","ORWU",214,0)
 S BADVAL=0
"RTN","ORWU",215,0)
 I $P(VAL,".",1)="" S BADVAL=1
"RTN","ORWU",216,0)
 I $P(VAL,".",2)="" S BADVAL=1
"RTN","ORWU",217,0)
 I $P(VAL,".",3)="" S BADVAL=1
"RTN","ORWU",218,0)
 I $P(VAL,".",4)="" S BADVAL=1
"RTN","ORWU",219,0)
 I ((BADVAL)!('VAL)!(VAL="")) S VAL="0.0.0.0"
"RTN","ORWU",220,0)
 Q
"RTN","ORWU",221,0)
OVERDL(VAL) ;Return parameter value of ORPARAM OVER DATELINE
"RTN","ORWU",222,0)
 S VAL=$$GET^XPAR("ALL","ORPARAM OVER DATELINE")
"RTN","ORWU",223,0)
 Q
"RTN","ORWU",224,0)
MOBAPP(VAL,ORAPP) ;set ^TMP($J,"OR MOB APP")
"RTN","ORWU",225,0)
 S ^TMP($J,"OR MOB APP")=ORAPP
"RTN","ORWU",226,0)
 S VAL=1
"RTN","ORWU",227,0)
 S ^XTMP("OR JMH ORDER COM",$H)=$J
"RTN","ORWU",228,0)
 Q
"RTN","ORY350")
0^^B70128695
"RTN","ORY350",1,0)
ORY350 ;ISP/RFR - PRE- AND POST-INSTALL FOR PATCH OR*3.0*350 ;08/31/15  09:58
"RTN","ORY350",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORY350",3,0)
 Q
"RTN","ORY350",4,0)
PRE ;PRE-INSTALL SECTION
"RTN","ORY350",5,0)
 ;DELETE EXISTING NOTIFICATION(S)
"RTN","ORY350",6,0)
 D PRE^ORY350B
"RTN","ORY350",7,0)
 N ORMSG,ORFDA,ORERROR,IDX
"RTN","ORY350",8,0)
 I $D(^ORD(100.9,78,0)) D
"RTN","ORY350",9,0)
 .S ORMSG(1)="WARNING:",ORMSG(2)="A notification already exists in entry number 78 and will be overwritten."
"RTN","ORY350",10,0)
 .D BMES^XPDUTL(.ORMSG)
"RTN","ORY350",11,0)
 .S ORFDA(100.9,"78,",.01)="@"
"RTN","ORY350",12,0)
 I $D(^ORD(100.9,73)) S ORFDA(100.9,"73,",.01)="@"
"RTN","ORY350",13,0)
 I $D(ORFDA) D
"RTN","ORY350",14,0)
 .D FILE^DIE(,"ORFDA","ORERROR")
"RTN","ORY350",15,0)
 .I $D(ORERROR) D  Q
"RTN","ORY350",16,0)
 ..K ORMSG
"RTN","ORY350",17,0)
 ..S ORMSG(1)="ERROR: Unable to delete the existing notification."
"RTN","ORY350",18,0)
 ..S ORMSG(2)="VA FileMan Error #"_ORERROR("DIERR",1)_":"
"RTN","ORY350",19,0)
 ..F IDX=1:1:+$O(ORERROR("DIERR",1,"TEXT","A"),-1) D
"RTN","ORY350",20,0)
 ...S ORMSG(IDX+2)=ORERROR("DIERR",1,"TEXT",IDX)
"RTN","ORY350",21,0)
 ..D BMES^XPDUTL(.ORMSG)
"RTN","ORY350",22,0)
 ..S XPDABORT=1
"RTN","ORY350",23,0)
 D BMES^XPDUTL("  Deleting data dictionaries:")
"RTN","ORY350",24,0)
 D MES^XPDUTL("   PROCESSING FLAGS FIELD (#2) IN OE/RR NOTIFICATIONS FILE")
"RTN","ORY350",25,0)
 N DIU
"RTN","ORY350",26,0)
 S DIU="100.92",DIU(0)="ST"
"RTN","ORY350",27,0)
 D EN^DIU2
"RTN","ORY350",28,0)
 D MES^XPDUTL("  Finished deleting data dictionaries")
"RTN","ORY350",29,0)
 Q
"RTN","ORY350",30,0)
POST ;POST-INSTALL SECTION
"RTN","ORY350",31,0)
 N XPDIDTOT,ORSTNUM,ORPOST
"RTN","ORY350",32,0)
 S XPDIDTOT=8,ORSTNUM=0,ORPOST=1
"RTN","ORY350",33,0)
 D UPDATE^XPDID(1)
"RTN","ORY350",34,0)
 D UPDATE^XPDID(ORSTNUM)
"RTN","ORY350",35,0)
 D DLGBULL
"RTN","ORY350",36,0)
 D BMES^XPDUTL("Updating parameter values...")
"RTN","ORY350",37,0)
 D MOBVERS
"RTN","ORY350",38,0)
 D POST^ORY350B
"RTN","ORY350",39,0)
 D BMES^XPDUTL("DONE")
"RTN","ORY350",40,0)
 D UPDATE^XPDID(2)
"RTN","ORY350",41,0)
 S ORSTNUM=3
"RTN","ORY350",42,0)
 D BMES^XPDUTL("Correcting supply orderable items...")
"RTN","ORY350",43,0)
 D SUPPLY^ORY350A
"RTN","ORY350",44,0)
 D BMES^XPDUTL("DONE")
"RTN","ORY350",45,0)
 D UPDATE^XPDID(ORSTNUM)
"RTN","ORY350",46,0)
 S ORSTNUM=ORSTNUM+1
"RTN","ORY350",47,0)
 D BMES^XPDUTL("Correcting supply quick orders...")
"RTN","ORY350",48,0)
 I $$SQOCONV^ORY350A D BMES^XPDUTL("DONE")
"RTN","ORY350",49,0)
 D UPDATE^XPDID(ORSTNUM)
"RTN","ORY350",50,0)
 S ORSTNUM=ORSTNUM+1
"RTN","ORY350",51,0)
 D QUEUE("order cleanup/conversion","ORDCONV^ORY350(""?"")","OE/RR ORDER CLEANUP AND CONVERSION",.ORSTNUM)
"RTN","ORY350",52,0)
 D QUEUE("quick order dialog report","QODLGCON^ORY350","OE/RR QUICK ORDER DIALOG REPORT",.ORSTNUM)
"RTN","ORY350",53,0)
 D BMES^XPDUTL("Correcting existing order dialogs...")
"RTN","ORY350",54,0)
 N ARRAY,DLG,ITM
"RTN","ORY350",55,0)
 ;
"RTN","ORY350",56,0)
 S ARRAY($$PTR^ORCD("PSO OERR"))=1      ;Outpatient Meds
"RTN","ORY350",57,0)
 S ARRAY($$PTR^ORCD("PSJ OR PAT OE"))=1 ;Unit Dose Meds
"RTN","ORY350",58,0)
 S ARRAY($$PTR^ORCD("PSH OERR"))=1      ;Non-VA Meds
"RTN","ORY350",59,0)
 S ARRAY($$PTR^ORCD("PSO SUPPLY"))=1    ;Supplies/Devices
"RTN","ORY350",60,0)
 ;
"RTN","ORY350",61,0)
 S DLG="" F  S DLG=$O(ARRAY(DLG)) Q:DLG=""  D  ;
"RTN","ORY350",62,0)
 . ; Find the index for the OR GTX SCHEDULE field
"RTN","ORY350",63,0)
 . S ITM=$O(^ORD(101.41,DLG,10,"D",$$PTR^ORCD("OR GTX SCHEDULE"),""))
"RTN","ORY350",64,0)
 . ; Does the field have the previous standard text?
"RTN","ORY350",65,0)
 . I $G(^ORD(101.41,DLG,10,ITM,9))="S:ORCAT=""I"" REQD=$$SCHREQ^PSJORPOE(OROUTE,OROI,$G(ORDRUG))" D  ;
"RTN","ORY350",66,0)
 . . ; Add check for quick orders
"RTN","ORY350",67,0)
 . . S ^ORD(101.41,DLG,10,ITM,9)="I $G(ORTYPE)'=""Z"" S:ORCAT=""I"" REQD=$$SCHREQ^PSJORPOE(OROUTE,OROI,$G(ORDRUG))"
"RTN","ORY350",68,0)
 D BMES^XPDUTL("DONE")
"RTN","ORY350",69,0)
 D UPDATE^XPDID(ORSTNUM)
"RTN","ORY350",70,0)
 S ORSTNUM=ORSTNUM+1
"RTN","ORY350",71,0)
 D BMES^XPDUTL("Loading new notifications...")
"RTN","ORY350",72,0)
 I $$NOTIFI^ORY350A D BMES^XPDUTL("DONE")
"RTN","ORY350",73,0)
 D UPDATE^XPDID(ORSTNUM)
"RTN","ORY350",74,0)
 S ORSTNUM=ORSTNUM+1
"RTN","ORY350",75,0)
 Q
"RTN","ORY350",76,0)
ORDCONV(ORIEN) ;LOOP THROUGH ALL ORDERS AND PERFORM THE NECESSARY ACTIONS (TASKED)
"RTN","ORY350",77,0)
 ;PARAMETERS: ORIEN => STARTING ORDER NUMBER (REQUIRED)
"RTN","ORY350",78,0)
 N ORREP,ORRECP,ORSTAT
"RTN","ORY350",79,0)
 F  S ORIEN=$O(^OR(100,ORIEN),-1) Q:+ORIEN=0!($G(ZTSTOP)=1)  D
"RTN","ORY350",80,0)
 .;FOR HELD MEDICATION ORDERS, CHECK PHARMACY'S ORDER STATUS
"RTN","ORY350",81,0)
 .I $P($G(^OR(100,ORIEN,3)),U,3)=3,("^2^3^4^23^"[(U_$P($G(^OR(100,ORIEN,0)),U,11)_U)) D
"RTN","ORY350",82,0)
 ..D MSG^ORMBLD(ORIEN,"SS")
"RTN","ORY350",83,0)
 .;STOP IF ASKED TO
"RTN","ORY350",84,0)
 .I ORIEN#1000=0,($$S^%ZTLOAD) N X S ZTSTOP=1,X=$$S^%ZTLOAD("Received shutdown request")
"RTN","ORY350",85,0)
 ;SEND STATUS EMAIL
"RTN","ORY350",86,0)
 I +$G(ZTSTOP)=0 D
"RTN","ORY350",87,0)
 .S ORREP(1)="The order cleanup/conversion process was successfully completed."
"RTN","ORY350",88,0)
 E  D
"RTN","ORY350",89,0)
 .K ORREP
"RTN","ORY350",90,0)
 .S ORREP(1)="The order cleanup/conversion process has unexpectedly stopped."
"RTN","ORY350",91,0)
 .S ORREP(2)="If you or the system manager did not stop the process, please check the"
"RTN","ORY350",92,0)
 .S ORREP(3)="error log and file a Remedy ticket for assistance."
"RTN","ORY350",93,0)
 .S ORREP(4)=""
"RTN","ORY350",94,0)
 .S ORREP(5)="To requeue the cleanup/conversion process, run ORDREST^ORY350 from the"
"RTN","ORY350",95,0)
 .S ORREP(6)="programmer prompt and when asked for the starting order number, enter"
"RTN","ORY350",96,0)
 .S ORREP(7)=ORIEN+1
"RTN","ORY350",97,0)
 S ORRECP(DUZ)=""
"RTN","ORY350",98,0)
 S ORSTAT=$$MAIL^ORUTL("ORREP(","PATCH OR*3.0*350 ORDER CLEANUP/CONVERSION STATUS",.ORRECP)
"RTN","ORY350",99,0)
 I +ORSTAT,($G(ZTSTOP)=1) D
"RTN","ORY350",100,0)
 .S ^XTMP("ORY350",0)=$$FMADD^XLFDT($$NOW^XLFDT,7,0,0,0)_U_$$NOW^XLFDT_U_"OR*3*350 POST-INSTALL DATA"
"RTN","ORY350",101,0)
 .S ^XTMP("ORY350","ORDER")=(ORIEN+1)
"RTN","ORY350",102,0)
 S ZTREQ="@"
"RTN","ORY350",103,0)
 Q
"RTN","ORY350",104,0)
ORDREST ;ALLOW USER TO RESTART THE ORDER CLEANUP/CONVERSION PROCESS
"RTN","ORY350",105,0)
 N DIC,Y,X,DTOUT,DUOUT
"RTN","ORY350",106,0)
 S DIC="^OR(100,",DIC(0)="AEQX",DIC("A")="ENTER THE STARTING ORDER NUMBER FROM THE STATUS EMAIL: "
"RTN","ORY350",107,0)
 D ^DIC
"RTN","ORY350",108,0)
 Q:+Y<1
"RTN","ORY350",109,0)
 W !,"Queueing order cleanup/conversion..."
"RTN","ORY350",110,0)
 D QUEUE("order cleanup/conversion","ORDCONV^ORY350("_+Y_")","OE/RR ORDER CLEANUP AND CONVERSION")
"RTN","ORY350",111,0)
 Q
"RTN","ORY350",112,0)
QODLGCON ;LOOP THROUGH ALL ORDER DIALOGS AND REPORT ON COMPLEX DIALOGS WITH TYPE NON-VA MEDICATIONS (TASKED)
"RTN","ORY350",113,0)
 N ORREP,ORNONDG,ORINSIEN,ORCOUNT,ORINIEN,ORIEN,ORSTAT,ORLINE
"RTN","ORY350",114,0)
 I '$D(ZTQUEUED) W "Assembling the non-VA medication quick order dialog report...",!
"RTN","ORY350",115,0)
 S ORLINE=1,ORREP=$NA(^TMP($J,"ORQODLGCON")) K @ORREP
"RTN","ORY350",116,0)
 S @ORREP@(ORLINE)="The following non-VA medication quick order dialogs contain a complex dose.",ORLINE=ORLINE+1
"RTN","ORY350",117,0)
 S @ORREP@(ORLINE)="",ORLINE=ORLINE+1
"RTN","ORY350",118,0)
 S @ORREP@(ORLINE)="QUICK ORDER DIALOG",ORLINE=ORLINE+1
"RTN","ORY350",119,0)
 S @ORREP@(ORLINE)=$$REPEAT^XLFSTR("-",72),ORLINE=ORLINE+1
"RTN","ORY350",120,0)
 S ORNONDG=+$O(^ORD(100.98,"B","NON-VA MEDICATIONS",0))
"RTN","ORY350",121,0)
 I ORNONDG=0 D
"RTN","ORY350",122,0)
 .K @ORREP
"RTN","ORY350",123,0)
 .S @ORREP@(ORLINE)="Unable to find the NON-VA MEDICATIONS display group in the DISPLAY",ORLINE=ORLINE+1
"RTN","ORY350",124,0)
 .S @ORREP@(ORLINE)="GROUP file (#100.98).",ORLINE=ORLINE+1
"RTN","ORY350",125,0)
 .S @ORREP@(ORLINE)="Please log a Remedy ticket for assistance.",ORLINE=ORLINE+1
"RTN","ORY350",126,0)
 .S @ORREP@(ORLINE)="",ORLINE=ORLINE+1
"RTN","ORY350",127,0)
 S ORINSIEN=+$O(^ORD(101.41,"B","OR GTX INSTRUCTIONS",0))
"RTN","ORY350",128,0)
 I ORINSIEN=0 D
"RTN","ORY350",129,0)
 .K @ORREP
"RTN","ORY350",130,0)
 .S @ORREP@(ORLINE)="Unable to find the OR GTX INSTRUCTIONS dialog in the ORDER DIALOG file",ORLINE=ORLINE+1
"RTN","ORY350",131,0)
 .S @ORREP@(ORLINE)="(#100.41).",ORLINE=ORLINE+1
"RTN","ORY350",132,0)
 .S @ORREP@(ORLINE)="Please log a Remedy ticket for assistance.",ORLINE=ORLINE+1
"RTN","ORY350",133,0)
 I ORNONDG&(ORINSIEN) D
"RTN","ORY350",134,0)
 .S ORIEN=0 F  S ORIEN=$O(^ORD(101.41,ORIEN)) Q:+ORIEN=0!($G(ZTSTOP)=1)  D
"RTN","ORY350",135,0)
 ..Q:$P(^ORD(101.41,ORIEN,0),U,5)'=ORNONDG!($P(^ORD(101.41,ORIEN,0),U,1)="PSH OERR")!($P(^ORD(101.41,ORIEN,0),U,4)'="Q")
"RTN","ORY350",136,0)
 ..;COUNT THE NUMBER OF OR GTX INSTRUCTIONS DIALOG INSTANCES
"RTN","ORY350",137,0)
 ..S ORCOUNT=0,ORINIEN=""
"RTN","ORY350",138,0)
 ..F  S ORINIEN=$O(^ORD(101.41,ORIEN,6,"D",ORINSIEN,ORINIEN)) Q:+ORINIEN=0  S ORCOUNT=ORCOUNT+1
"RTN","ORY350",139,0)
 ..;COMPLEX ORDERS HAVE MORE THAN ONE INSTANCE
"RTN","ORY350",140,0)
 ..S:ORCOUNT>1 @ORREP@(ORLINE)=$P(^ORD(101.41,ORIEN,0),U,1),ORLINE=ORLINE+1
"RTN","ORY350",141,0)
 ..;STOP IF ASKED TO
"RTN","ORY350",142,0)
 ..I ORIEN#100=0,($$S^%ZTLOAD) N X S ZTSTOP=1,X=$$S^%ZTLOAD("Received shutdown request")
"RTN","ORY350",143,0)
 .I +$G(ZTSTOP)=0 D
"RTN","ORY350",144,0)
 ..S @ORREP@(ORLINE)="",ORLINE=ORLINE+1
"RTN","ORY350",145,0)
 ..S @ORREP@(ORLINE)="[END OF REPORT]",ORLINE=ORLINE+1
"RTN","ORY350",146,0)
 .E  D
"RTN","ORY350",147,0)
 ..S @ORREP@(ORLINE)="",ORLINE=ORLINE+1
"RTN","ORY350",148,0)
 ..S @ORREP@(ORLINE)="The quick order dialog report process has unexpectedly stopped.",ORLINE=ORLINE+1
"RTN","ORY350",149,0)
 ..S @ORREP@(ORLINE)="If you or the system manager did not stop the process, please check the",ORLINE=ORLINE+1
"RTN","ORY350",150,0)
 ..S @ORREP@(ORLINE)="error log and file a Remedy ticket for assistance.",ORLINE=ORLINE+1
"RTN","ORY350",151,0)
 ..S @ORREP@(ORLINE)="",ORLINE=ORLINE+1
"RTN","ORY350",152,0)
 I 'ORNONDG!('ORINSIEN)!($G(ZTSTOP)) D
"RTN","ORY350",153,0)
 .S @ORREP@(ORLINE)="To rerun the report, execute QODLGCON^ORY350 from the programmer prompt.",ORLINE=ORLINE+1
"RTN","ORY350",154,0)
 S ORSTAT=$$MAIL^ORUTL($P(ORREP,")",1)_",","NON-VA MEDICATION COMPLEX QUICK ORDER DIALOG REPORT",,"ORY350QORECIPS")
"RTN","ORY350",155,0)
 K @ORREP
"RTN","ORY350",156,0)
 I $D(ZTQUEUED)>0 S ZTREQ="@"
"RTN","ORY350",157,0)
 E  W !,"Report successfully generated.",!
"RTN","ORY350",158,0)
 Q
"RTN","ORY350",159,0)
QUEUE(ORMSG,ZTRTN,ZTDESC,ORCURITM) ;CREATE A SPECIFIED TASK
"RTN","ORY350",160,0)
 ;PARAMETERS: ORMSG    => STRING CONTAINING THE TEXT TO OUTPUT TO THE SCREEN
"RTN","ORY350",161,0)
 ;            ZTRTN    => STRING CONTAINING THE ROUTINE TASKMAN SHOULD EXECUTE
"RTN","ORY350",162,0)
 ;            ZTDESC   => STRING CONTAINING THE TASK'S DESCRIPTION
"RTN","ORY350",163,0)
 ;            ORCURITM => REFERENCE TO THE VARIABLE STORING THE NUMBER OF THE CURRENT ITEM
"RTN","ORY350",164,0)
 N ZTDTH,ZTIO,ZTSK
"RTN","ORY350",165,0)
 D BMES^XPDUTL("Queueing "_ORMSG_"...")
"RTN","ORY350",166,0)
 S ZTDTH=$$FMADD^XLFDT($$NOW^XLFDT,0,0,0,10)
"RTN","ORY350",167,0)
 S ZTIO=""
"RTN","ORY350",168,0)
 D ^%ZTLOAD
"RTN","ORY350",169,0)
 I +$G(ZTSK)=0 D
"RTN","ORY350",170,0)
 .I $G(ORPOST) D BMES^XPDUTL("Unable to queue the "_ORMSG_"; file a Remedy ticket for assistance.")
"RTN","ORY350",171,0)
 .E  W "ERROR",!,"Unable to queue the "_ORMSG_"; file a Remedy ticket for assistance.",!
"RTN","ORY350",172,0)
 E  D
"RTN","ORY350",173,0)
 .I $G(ORPOST) D
"RTN","ORY350",174,0)
 ..D BMES^XPDUTL("DONE - Task #"_ZTSK)
"RTN","ORY350",175,0)
 ..D UPDATE^XPDID(ORCURITM)
"RTN","ORY350",176,0)
 ..S ORCURITM=ORCURITM+1
"RTN","ORY350",177,0)
 .E  W "DONE",!,"Task #"_ZTSK,!
"RTN","ORY350",178,0)
 Q
"RTN","ORY350",179,0)
 ;
"RTN","ORY350",180,0)
MOBVERS ;set the package level MOB DLL version
"RTN","ORY350",181,0)
 D PUT^XPAR("PKG","OR MOB DLL VERSION",1,"2.0.16.0")
"RTN","ORY350",182,0)
 Q
"RTN","ORY350",183,0)
 ;
"RTN","ORY350",184,0)
SENDDLG(ANAME) ; Return true if the current order dialog should be sent
"RTN","ORY350",185,0)
 I ANAME="PSO OERR" Q 1
"RTN","ORY350",186,0)
 I ANAME="GMRCOR CONSULT" Q 1
"RTN","ORY350",187,0)
 I ANAME="GMRCOR REQUEST" Q 1
"RTN","ORY350",188,0)
 Q 0
"RTN","ORY350",189,0)
 ;
"RTN","ORY350",190,0)
DLGBULL ; send bulletin about modified dialogs <on first install>
"RTN","ORY350",191,0)
 N I,ORD
"RTN","ORY350",192,0)
 F I="PSO OERR","GMRCOR CONSULT","GMRCOR REQUEST" S ORD(I)=""
"RTN","ORY350",193,0)
 D EN^ORYDLG(350,.ORD)
"RTN","ORY350",194,0)
 Q
"RTN","ORY350A")
0^15^B20572876
"RTN","ORY350A",1,0)
ORY350A ;ISP/JLC,RFR - POST-INSTALL FOR PATCH OR*3.0*350 ;04/27/2015  08:48
"RTN","ORY350A",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORY350A",3,0)
 Q
"RTN","ORY350A",4,0)
SUPPLY ;correct entries in 101.43 and build list of supply
"RTN","ORY350A",5,0)
 ;entries in 101.44
"RTN","ORY350A",6,0)
 N S1,S2,S3,PSOI,PSVAC,FDA,ORFIEN
"RTN","ORY350A",7,0)
 K ^TMP($J,"ORY350A"),^TMP($J,"ORY350A1")
"RTN","ORY350A",8,0)
 S S1="" F  S S1=$O(^ORD(101.43,"S.SPLY",S1)) Q:S1=""  D
"RTN","ORY350A",9,0)
 . S S2=0
"RTN","ORY350A",10,0)
 . F  S S2=$O(^ORD(101.43,"S.SPLY",S1,S2)) Q:'S2  D
"RTN","ORY350A",11,0)
 .. S ORFIEN=S2_",",PSOI=+$P(^ORD(101.43,S2,0),"^",2) D DRGIEN^PSS50P7(PSOI,"","ORY350A")
"RTN","ORY350A",12,0)
 .. I ^TMP($J,"ORY350A",0)'>0 Q
"RTN","ORY350A",13,0)
 .. S S3=0
"RTN","ORY350A",14,0)
 .. F  S S3=$O(^TMP($J,"ORY350A",S3)) Q:'S3  D
"RTN","ORY350A",15,0)
 ... D ZERO^PSS50(S3,,,,,"ORY350A1")
"RTN","ORY350A",16,0)
 ... I ^TMP($J,"ORY350A1",0)'>0 Q
"RTN","ORY350A",17,0)
 ... S PSVAC=$G(^TMP($J,"ORY350A1",S3,2)),FDA(101.43,ORFIEN,50.5)=0
"RTN","ORY350A",18,0)
 ... I PSVAC?1"XA".E!(PSVAC?1"XX".E)!(PSVAC="DX900"&($G(^TMP($J,"ORY350A1",S3,3))["S")) S FDA(101.43,ORFIEN,50.5)=1
"RTN","ORY350A",19,0)
 ... D FILE^DIE("","FDA")
"RTN","ORY350A",20,0)
 ;build supply item list for order dialog
"RTN","ORY350A",21,0)
 D FVBLDQ^ORWUL("SPLY",1)
"RTN","ORY350A",22,0)
 Q
"RTN","ORY350A",23,0)
NOTIFI() ;CREATE NEW NOTIFICATIONS
"RTN","ORY350A",24,0)
 N ORFDA,ORIEN,ORERROR,ENT,PAR,INST,ORERROR,EXIT,ORVALUE
"RTN","ORY350A",25,0)
 D MES^XPDUTL("    LAPSED UNSIGNED ORDER")
"RTN","ORY350A",26,0)
 S ENT="PKG."_"ORDER ENTRY/RESULTS REPORTING",INST="LAPSED UNSIGNED ORDER"
"RTN","ORY350A",27,0)
 S ORVALUE("ORB ARCHIVE PERIOD")=30
"RTN","ORY350A",28,0)
 S ORVALUE("ORB DELETE MECHANISM")="Individual Recipient"
"RTN","ORY350A",29,0)
 S ORVALUE("ORB FORWARD BACKUP REVIEWER")=0
"RTN","ORY350A",30,0)
 S ORVALUE("ORB FORWARD SUPERVISOR")=0
"RTN","ORY350A",31,0)
 S ORVALUE("ORB FORWARD SURROGATES")=0
"RTN","ORY350A",32,0)
 S ORVALUE("ORB PROCESSING FLAG")="Disabled"
"RTN","ORY350A",33,0)
 S ORVALUE("ORB PROVIDER RECIPIENTS")="OAPT"
"RTN","ORY350A",34,0)
 S ORVALUE("ORB URGENCY")="High"
"RTN","ORY350A",35,0)
 S PAR="" F  S PAR=$O(ORVALUE(PAR)) Q:$G(PAR)=""!($G(EXIT))  D
"RTN","ORY350A",36,0)
 .D EN^XPAR(ENT,PAR,INST,ORVALUE(PAR),.ORERROR)  ;ICR #2336
"RTN","ORY350A",37,0)
 .I +ORERROR D
"RTN","ORY350A",38,0)
 ..S ORMSG(1)=" ",EXIT=1
"RTN","ORY350A",39,0)
 ..S ORMSG(2)="ERROR: Unable to configure the new Lapsed Unsigned Order(s) notification"
"RTN","ORY350A",40,0)
 ..S ORMSG(3)="Kernel Parameter Tools Error #"_+ORERROR_": "_$P(ORERROR,U,2)
"RTN","ORY350A",41,0)
 ..D BMES^XPDUTL(.ORMSG)
"RTN","ORY350A",42,0)
 Q:$G(EXIT) 0
"RTN","ORY350A",43,0)
 Q 1
"RTN","ORY350A",44,0)
SQOCONV() ;CONVERT EXISTING OUTPATIENT MEDICATION QUICK ORDERS INTO SUPPLY QUICK ORDERS
"RTN","ORY350A",45,0)
 N DG,DLG,ORTEXT
"RTN","ORY350A",46,0)
 S DG("OUT")=$O(^ORD(100.98,"B","OUTPATIENT MEDICATIONS",0))
"RTN","ORY350A",47,0)
 I +DG("OUT")=0 D  Q 0
"RTN","ORY350A",48,0)
 .S ORTEXT(1)="Unable to find the OUTPATIENT MEDICATIONS display group in the DISPLAY GROUP"
"RTN","ORY350A",49,0)
 .S ORTEXT(2)="file (#100.98). Please log a Remedy ticket for assistance."
"RTN","ORY350A",50,0)
 .D BMES^XPDUTL(.ORTEXT)
"RTN","ORY350A",51,0)
 S DG("SUPPLY")=$O(^ORD(100.98,"B","SUPPLIES/DEVICES",0))
"RTN","ORY350A",52,0)
 I +DG("SUPPLY")=0 D  Q 0
"RTN","ORY350A",53,0)
 .S ORTEXT(1)="Unable to find the SUPPLIES/DEVICES display group in the DISPLAY GROUP file"
"RTN","ORY350A",54,0)
 .S ORTEXT(2)="(#100.98). Please log a Remedy ticket for assistance."
"RTN","ORY350A",55,0)
 .D BMES^XPDUTL(.ORTEXT)
"RTN","ORY350A",56,0)
 S DLG("ORDERABLE ITEM")=+$O(^ORD(101.41,"B","OR GTX ORDERABLE ITEM",0))
"RTN","ORY350A",57,0)
 I DLG("ORDERABLE ITEM")=0 D  Q 0
"RTN","ORY350A",58,0)
 .S ORTEXT(1)="Unable to find the OR GTX ORDERABLE ITEM dialog in the ORDER DIALOG file"
"RTN","ORY350A",59,0)
 .S ORTEXT(2)="(#101.41). Please log a Remedy ticket for assistance."
"RTN","ORY350A",60,0)
 N IEN,EXIT
"RTN","ORY350A",61,0)
 S IEN=0 F  S IEN=$O(^ORD(101.41,IEN)) Q:+$G(IEN)=0!($G(EXIT))  D
"RTN","ORY350A",62,0)
 .;SKIP DISABLED QUICK ORDER (FIELD #3 NOT BLANK)
"RTN","ORY350A",63,0)
 .Q:$P(^ORD(101.41,IEN,0),U,3)'=""
"RTN","ORY350A",64,0)
 .;SKIP NON-QUICK ORDER
"RTN","ORY350A",65,0)
 .Q:$P(^ORD(101.41,IEN,0),U,4)'="Q"
"RTN","ORY350A",66,0)
 .;SKIP NON-OUTPATIENT MEDICATIONS
"RTN","ORY350A",67,0)
 .Q:$P(^ORD(101.41,IEN,0),U,5)'=DG("OUT")
"RTN","ORY350A",68,0)
 .;DETERMINE IF THE ORDERABLE ITEM IS A SUPPLY
"RTN","ORY350A",69,0)
 .N RIEN,ORPHOI,ORDRGIEN,SET
"RTN","ORY350A",70,0)
 .S RIEN=+$O(^ORD(101.41,IEN,6,"D",DLG("ORDERABLE ITEM"),0))
"RTN","ORY350A",71,0)
 .Q:RIEN=0
"RTN","ORY350A",72,0)
 .S ORPHOI=+$P($G(^ORD(101.41,IEN,6,RIEN,1)),U,1)
"RTN","ORY350A",73,0)
 .Q:ORPHOI=0
"RTN","ORY350A",74,0)
 .S ORPHOI=$P($G(^ORD(101.43,ORPHOI,0)),U,2)
"RTN","ORY350A",75,0)
 .Q:$P(ORPHOI,";",2)'="99PSP"
"RTN","ORY350A",76,0)
 .D DRGIEN^PSS50P7(+ORPHOI,,"ORSUPPLY")
"RTN","ORY350A",77,0)
 .Q:+^TMP($J,"ORSUPPLY",0)<1
"RTN","ORY350A",78,0)
 .S ORDRGIEN=0 F  S ORDRGIEN=$O(^TMP($J,"ORSUPPLY",ORDRGIEN)) Q:'+$G(ORDRGIEN)!($G(EXIT))!($G(SET))  D
"RTN","ORY350A",79,0)
 ..D ZERO^PSS50(ORDRGIEN,,,,,"ORDRUG")
"RTN","ORY350A",80,0)
 ..Q:+^TMP($J,"ORDRUG",0)<1
"RTN","ORY350A",81,0)
 ..I $$ISSUPPLY(ORDRGIEN),'$G(SET) D
"RTN","ORY350A",82,0)
 ...;CHANGE THE DISPLAY GROUP
"RTN","ORY350A",83,0)
 ...N FDA,ERROR
"RTN","ORY350A",84,0)
 ...S FDA(101.41,IEN_",",5)=DG("SUPPLY")
"RTN","ORY350A",85,0)
 ...D FILE^DIE("K","FDA","ERROR")
"RTN","ORY350A",86,0)
 ...I $D(ERROR) D  Q
"RTN","ORY350A",87,0)
 ....D ERROR("Unable to convert quick order IEN #"_IEN,.ERROR)
"RTN","ORY350A",88,0)
 ....S EXIT=1
"RTN","ORY350A",89,0)
 ...S SET=1
"RTN","ORY350A",90,0)
 K ^TMP($J,"ORSUPPLY")
"RTN","ORY350A",91,0)
 Q 1
"RTN","ORY350A",92,0)
ISSUPPLY(ORDRGIEN) ;DETERMINE IF DRUG IS A SUPPLY ITEM
"RTN","ORY350A",93,0)
 ;PARAMETERS: ORDRGIEN=>DRUG IEN IN ^TMP($J,"ORDRUG") GLOBAL
"RTN","ORY350A",94,0)
 Q:"^XA^XX^"[(U_$E(^TMP($J,"ORDRUG",ORDRGIEN,2),1,2)_U)!(^TMP($J,"ORDRUG",ORDRGIEN,2)="DX900"&($G(^TMP($J,"ORDRUG",ORDRGIEN,3))["S")) 1
"RTN","ORY350A",95,0)
 Q 0
"RTN","ORY350A",96,0)
ERROR(TEXT,ERROR) ;OUTPUT FILEMAN ERROR MESSAGE(S)
"RTN","ORY350A",97,0)
 N ORMSG,IDX
"RTN","ORY350A",98,0)
 S ORMSG(1)=" "
"RTN","ORY350A",99,0)
 S ORMSG(2)="ERROR: "_TEXT_"."
"RTN","ORY350A",100,0)
 S ORMSG(3)="VA FileMan Error #"_ERROR("DIERR",1)_":"
"RTN","ORY350A",101,0)
 F IDX=1:1:+$O(ERROR("DIERR",1,"TEXT","A"),-1) D
"RTN","ORY350A",102,0)
 .S ORMSG(IDX+2)=ERROR("DIERR",1,"TEXT",IDX)
"RTN","ORY350A",103,0)
 D BMES^XPDUTL(.ORMSG)
"RTN","ORY350A",104,0)
 Q
"RTN","ORY350B")
0^29^B73339519
"RTN","ORY350B",1,0)
ORY350B ;SLCOIFO - PRE- AND POST-INSTALL B FOR PATCH OR*3.0*350 ;04/16/15  07:44
"RTN","ORY350B",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORY350B",3,0)
 ;
"RTN","ORY350B",4,0)
PRE ;Pre-Init Entry Point
"RTN","ORY350B",5,0)
 D PEOMRPT
"RTN","ORY350B",6,0)
 D EDITEAD
"RTN","ORY350B",7,0)
 D CONSULT
"RTN","ORY350B",8,0)
 Q
"RTN","ORY350B",9,0)
POST ;Post-Init Entry Point
"RTN","ORY350B",10,0)
 D PAR
"RTN","ORY350B",11,0)
 D CONSPAR
"RTN","ORY350B",12,0)
 Q
"RTN","ORY350B",13,0)
PEOMRPT ;Remove new & changed reports from OE/RR REPORTS file (101.24)
"RTN","ORY350B",14,0)
 N ORI,DA,DIK
"RTN","ORY350B",15,0)
 S ORI=999
"RTN","ORY350B",16,0)
 F  S ORI=$O(^ORD(101.24,ORI)) Q:'ORI  I ORI<1110!(ORI>1116) S DA=ORI,DIK="^ORD(101.24," D ^DIK
"RTN","ORY350B",17,0)
 Q
"RTN","ORY350B",18,0)
PAR ; Parameter Value Transport
"RTN","ORY350B",19,0)
 D DEL,PUT
"RTN","ORY350B",20,0)
 K ^TMP($J,"XPARRSTR")
"RTN","ORY350B",21,0)
 N ENT,IDX,ROOT,REF,VAL,I
"RTN","ORY350B",22,0)
 S ROOT=$NAME(^TMP($J,"XPARRSTR")),ROOT=$E(ROOT,1,$L(ROOT)-1)_","
"RTN","ORY350B",23,0)
 D LOAD
"RTN","ORY350B",24,0)
 S IDX=0,ENT="PKG.ORDER ENTRY/RESULTS REPORTING"
"RTN","ORY350B",25,0)
 F  S IDX=$O(^TMP($J,"XPARRSTR",IDX)) Q:'IDX  D
"RTN","ORY350B",26,0)
 . N PAR,INST,ORVAL,ORERR
"RTN","ORY350B",27,0)
 . S PAR=$P(^TMP($J,"XPARRSTR",IDX,"KEY"),U),INST=$P(^("KEY"),U,2)
"RTN","ORY350B",28,0)
 . M ORVAL=^TMP($J,"XPARRSTR",IDX,"VAL")
"RTN","ORY350B",29,0)
 . D EN^XPAR(ENT,PAR,INST,.ORVAL,.ORERR)
"RTN","ORY350B",30,0)
 K ^TMP($J,"XPARRSTR")
"RTN","ORY350B",31,0)
 Q
"RTN","ORY350B",32,0)
LOAD ; load data into ^TMP (expects ROOT to be defined)
"RTN","ORY350B",33,0)
 S I=1 F  S REF=$T(DATA+I) Q:REF=""  S VAL=$T(DATA+I+1) D
"RTN","ORY350B",34,0)
 . S I=I+2,REF=$P(REF,";",3,999),VAL=$P(VAL,";",3,999)
"RTN","ORY350B",35,0)
 . S @(ROOT_REF)=VAL
"RTN","ORY350B",36,0)
 Q
"RTN","ORY350B",37,0)
DEL ;Delete package level parameters
"RTN","ORY350B",38,0)
 N P
"RTN","ORY350B",39,0)
 S P="ORWRP REPORT LAB LIST"
"RTN","ORY350B",40,0)
 D SET("@",P,5)
"RTN","ORY350B",41,0)
 D SET("@",P,10)
"RTN","ORY350B",42,0)
 D SET("@",P,15)
"RTN","ORY350B",43,0)
 D SET("@",P,20)
"RTN","ORY350B",44,0)
 D SET("@",P,25)
"RTN","ORY350B",45,0)
 D SET("@",P,30)
"RTN","ORY350B",46,0)
 D SET("@",P,35)
"RTN","ORY350B",47,0)
 D SET("@",P,40)
"RTN","ORY350B",48,0)
 D SET("@",P,45)
"RTN","ORY350B",49,0)
 D SET("@",P,50)
"RTN","ORY350B",50,0)
 D SET("@",P,55)
"RTN","ORY350B",51,0)
 D SET("@",P,60)
"RTN","ORY350B",52,0)
 D SET("@",P,65)
"RTN","ORY350B",53,0)
 Q
"RTN","ORY350B",54,0)
PUT ;Setup package level parameters
"RTN","ORY350B",55,0)
 N P
"RTN","ORY350B",56,0)
 S P="ORWRP REPORT LAB LIST"
"RTN","ORY350B",57,0)
 D SET("ORRPL LAB OVERVIEW",P,10)
"RTN","ORY350B",58,0)
 D SET("ORRPL LAB ORDERS PEND",P,15)
"RTN","ORY350B",59,0)
 D SET("ORL MOST RECENT",P,20)
"RTN","ORY350B",60,0)
 D SET("ORL WORKSHEET",P,25)
"RTN","ORY350B",61,0)
 D SET("ORL GRAPH",P,30)
"RTN","ORY350B",62,0)
 D SET("ORL ALL TESTS BY DATE",P,35)
"RTN","ORY350B",63,0)
 D SET("ORL SELECTED TESTS BY DATE",P,40)
"RTN","ORY350B",64,0)
 D SET("ORL MICROBIOLOGY",P,45)
"RTN","ORY350B",65,0)
 D SET("ORL ANATOMIC PATHOLOGY",P,50)
"RTN","ORY350B",66,0)
 D SET("ORL BLOOD BANK",P,55)
"RTN","ORY350B",67,0)
 D SET("ORRPL LAB ORDERS ALL",P,60)
"RTN","ORY350B",68,0)
 D SET("ORL CUMULATIVE",P,65)
"RTN","ORY350B",69,0)
 Q
"RTN","ORY350B",70,0)
SET(ONAME,P,S) ;Set the parameter
"RTN","ORY350B",71,0)
 ;ONAME=Report name
"RTN","ORY350B",72,0)
 ;P=Parameter name
"RTN","ORY350B",73,0)
 ;S=Sequence (count)
"RTN","ORY350B",74,0)
 N ORERR
"RTN","ORY350B",75,0)
 D EN^XPAR("PKG.ORDER ENTRY/RESULTS REPORTING",P,S,ONAME,.ORERR)
"RTN","ORY350B",76,0)
 Q
"RTN","ORY350B",77,0)
EDITEAD ;edit OR GTX EARLIEST DATE to OR GTX CLINICALLY INDICATED DATE
"RTN","ORY350B",78,0)
 D BMES^XPDUTL("Converting ORDER DIALOG OR GTX EARLIEST DATE to OR GTX CLINICALLY INDICATED DATE")
"RTN","ORY350B",79,0)
 N DIE,DA,DR,ORNAME,ORDISTXT,ORID
"RTN","ORY350B",80,0)
 S ORNAME="OR GTX CLINICALLY INDICATED DATE",ORDISTXT="Clinically indicated date:",ORID="CLINICALLY"
"RTN","ORY350B",81,0)
 Q:+$O(^ORD(101.41,"B",ORNAME,""))'=0
"RTN","ORY350B",82,0)
 S DIE="^ORD(101.41,"
"RTN","ORY350B",83,0)
 S DA=$O(^ORD(101.41,"B","OR GTX EARLIEST DATE",""))
"RTN","ORY350B",84,0)
 I +$G(DA)'>0  D  S XPDABORT=1 Q
"RTN","ORY350B",85,0)
 .D BMES^XPDUTL("Cannot find OR GTX EARLIEST DATE in file 101.41")
"RTN","ORY350B",86,0)
 .D MES^XPDUTL("No changes have been made.  Install will abort.")
"RTN","ORY350B",87,0)
 .D MES^XPDUTL("Please submit a Remedy ticket for assistance.")
"RTN","ORY350B",88,0)
 I $G(XPDABORT)=1 Q
"RTN","ORY350B",89,0)
 S DR=".01///^S X=ORNAME;2///^S X=ORDISTXT;13///^S X=ORID"
"RTN","ORY350B",90,0)
 D ^DIE
"RTN","ORY350B",91,0)
 L +^FILE(101.41,DA):0 I $T D ^DIE L -^FILE(101.41,DA) D MES^XPDUTL("Conversion Complete") Q
"RTN","ORY350B",92,0)
 D MES^XPDUTL("Unable to lock OR GTX EARLIEST DATE for edit. No changes made.")
"RTN","ORY350B",93,0)
 S XPDABORT=1 D MES^XPDUTL("Install will abort. Please try again.")
"RTN","ORY350B",94,0)
 Q
"RTN","ORY350B",95,0)
LU(FILE,NAME,FLAGS,SCREEN,INDEXES) ; call FileMan Finder to look up file entry
"RTN","ORY350B",96,0)
 Q $$FIND1^DIC(FILE,"",$G(FLAGS),NAME,$G(INDEXES),$G(SCREEN),"MSGERR")
"RTN","ORY350B",97,0)
CONSPAR ; set any value found for EAD at PKG level back into the CID at SYS level.
"RTN","ORY350B",98,0)
 D BMES^XPDUTL("The System level value for ORCDGMRC CLIN IND DATE DEFAULT will now")
"RTN","ORY350B",99,0)
 D MES^XPDUTL("be set to the Package level value for ORCDGMRC EARLIEST DATE DEFAULT.")
"RTN","ORY350B",100,0)
 D MES^XPDUTL("When that is complete, the ORCDGMRC EARLIEST DATE DEFAULT parameter")
"RTN","ORY350B",101,0)
 D MES^XPDUTL("will be removed from the system.")
"RTN","ORY350B",102,0)
 N ORPARVAL,ORERR,ORPAREAD,ORPARCID,OREADIEN,ORCIDIEN,ORMSG
"RTN","ORY350B",103,0)
 S ORPAREAD="ORCDGMRC EARLIEST DATE DEFAULT",ORPARCID="ORCDGMRC CLIN IND DATE DEFAULT"
"RTN","ORY350B",104,0)
 S OREADIEN=$$LU(8989.51,ORPAREAD,"X")
"RTN","ORY350B",105,0)
 S ORCIDIEN=$$LU(8989.51,ORPARCID,"X")
"RTN","ORY350B",106,0)
 I +$G(OREADIEN)'>0 D BMES^XPDUTL("Unable to find "_ORPAREAD_". No value set.") Q
"RTN","ORY350B",107,0)
 I +$G(ORCIDIEN)'>0 D BMES^XPDUTL("Unable to find "_ORPARCID_". No value set.") Q
"RTN","ORY350B",108,0)
 S ORPARVAL=$$GET^XPAR("PKG",ORPAREAD,1,"I")
"RTN","ORY350B",109,0)
 I $L($G(ORPARVAL))>0 D EN^XPAR("SYS",ORPARCID,1,ORPARVAL,.ORERR)
"RTN","ORY350B",110,0)
 I +$G(ORERR)'=0 D  Q
"RTN","ORY350B",111,0)
 .D BMES^XPDUTL("ERROR OCCURRED SETTING "_ORPARCID)
"RTN","ORY350B",112,0)
 .D MES^XPDUTL("AT THE SYSTEM LEVEL. THE ERROR IS:")
"RTN","ORY350B",113,0)
 .D BMES^XPDUTL("ERROR NUMBER: "_+$G(ORERR))
"RTN","ORY350B",114,0)
 .D MES^XPDUTL("ERROR TEXT: "_$P($G(ORERR),U,2))
"RTN","ORY350B",115,0)
 E  D
"RTN","ORY350B",116,0)
 .S:ORPARVAL="" ORMSG="NULL"
"RTN","ORY350B",117,0)
 .D BMES^XPDUTL(ORPARCID_" has been set to "_ORPARVAL)
"RTN","ORY350B",118,0)
 .D DELPARM
"RTN","ORY350B",119,0)
 Q
"RTN","ORY350B",120,0)
 ;
"RTN","ORY350B",121,0)
DELPARM ;remove ORCDGMRC EARLIEST DATE DEFAULT from the system
"RTN","ORY350B",122,0)
 N ORLIST,ENT,PAR,OERR
"RTN","ORY350B",123,0)
 ;get instances of parameter
"RTN","ORY350B",124,0)
 S ENT="",PAR="ORCDGMRC EARLIEST DATE DEFAULT"
"RTN","ORY350B",125,0)
 D ENVAL^XPAR(.ORLIST,PAR,1,.OERR)
"RTN","ORY350B",126,0)
 ;delete instances
"RTN","ORY350B",127,0)
 D BMES^XPDUTL("Attempting to remove values for parameter ORCDGMRC EARLIEST DATE DEFAULT...")
"RTN","ORY350B",128,0)
 F  S ENT=$O(ORLIST(ENT)) Q:ENT=""  D DEL^XPAR(ENT,PAR,1,.OERR) I $G(OERR)>0 W !,OERR
"RTN","ORY350B",129,0)
 D:+$G(OERR)=0 MES^XPDUTL("Values have been removed")
"RTN","ORY350B",130,0)
 ;delete parameter
"RTN","ORY350B",131,0)
 N DA,DIK
"RTN","ORY350B",132,0)
 S DIK="^XTV(8989.51,"
"RTN","ORY350B",133,0)
 S DA=$O(^XTV(8989.51,"B",PAR,"")) Q:+$G(DA)'>0  D BMES^XPDUTL("Attempting to delete parameter ORCDGMRC EARLIEST DATE DEFAULT from PARAMETER DEFINITION file")
"RTN","ORY350B",134,0)
 D ^DIK D:+$G(DA)>0 MES^XPDUTL("Delete successful")
"RTN","ORY350B",135,0)
 Q
"RTN","ORY350B",136,0)
CONSULT ;
"RTN","ORY350B",137,0)
 K ^TMP("OR350_EADID",$J)
"RTN","ORY350B",138,0)
 N ZTIO,ZTRTN,ZTDESC,ZTSAVE,ZTSK,ORCONREC
"RTN","ORY350B",139,0)
 S ORCONREC=$G(DUZ),ZTSAVE("ORCONREC")=""
"RTN","ORY350B",140,0)
 S ZTIO="",ZTRTN="START^ORY350B",ZTDESC="Find Consult Orders and Edit ID Field"
"RTN","ORY350B",141,0)
 D ^%ZTLOAD
"RTN","ORY350B",142,0)
 I +$G(ZTSK)>0 D BMES^XPDUTL("TASK "_$G(ZTSK)_" HAS BEEN QUEUED.")
"RTN","ORY350B",143,0)
 I +$G(ZTSK)=0 D BMES^XPDUTL("Unable to queue the """_ZTDESC_""" task; file a Remedy ticket for assistance.")
"RTN","ORY350B",144,0)
 Q
"RTN","ORY350B",145,0)
 ;
"RTN","ORY350B",146,0)
START ;start search for consult orders
"RTN","ORY350B",147,0)
 D FINDORD
"RTN","ORY350B",148,0)
 D SENDMAIL
"RTN","ORY350B",149,0)
 Q
"RTN","ORY350B",150,0)
 ;
"RTN","ORY350B",151,0)
FINDORD ;find cons/proc orders and change OR GTX EARLIEST DATE item ID value from EARLIEST to CLINICALLY
"RTN","ORY350B",152,0)
 N ORCOUNT S ORCOUNT=1
"RTN","ORY350B",153,0)
 S ^TMP("OR350_EADID",$J,ORCOUNT)="This message contains a list of ORDER file (#100) IENs where the ID field",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",154,0)
 S ^TMP("OR350_EADID",$J,ORCOUNT)="was edited from EARLIEST to CLINICALLY for the OR GTX EARLIEST DATE Item Entry.",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",155,0)
 S ^TMP("OR350_EADID",$J,ORCOUNT)="Any unsuccessful edits are also captured and noted as such.",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",156,0)
 S ^TMP("OR350_EADID",$J,ORCOUNT)="For those orders, you may manually edit the ID field for the ",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",157,0)
 S ^TMP("OR350_EADID",$J,ORCOUNT)="OR GTX CLINICALLY INDICATED DATE Item Entry",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",158,0)
 S ^TMP("OR350_EADID",$J,ORCOUNT)="Change the value from EARLIEST to CLINICALLY.",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",159,0)
 S ^TMP("OR350_EADID",$J,ORCOUNT)="Submit a Remedy ticket if you need/prefer assistance with these edits.",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",160,0)
 S ^TMP("OR350_EADID",$J,ORCOUNT)="",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",161,0)
 N ORCON,ORPROC,ORIFN,ORDISGRP
"RTN","ORY350B",162,0)
 S ORCON=$O(^ORD(100.98,"B","CONSULTS","")) Q:+$G(ORCON)'>0
"RTN","ORY350B",163,0)
 S ORPROC=$O(^ORD(100.98,"B","PROCEDURES","")) Q:+$G(ORPROC)'>0
"RTN","ORY350B",164,0)
 N ORDATE S ORDATE=3080701 ;start search before EARLIEST DATE was live (8/4/2010 first prod install)
"RTN","ORY350B",165,0)
 N ORIDX S ORIDX=$Q(^OR(100,"AF",ORDATE))
"RTN","ORY350B",166,0)
 F  S ORIDX=$Q(@ORIDX) Q:ORIDX'?1"^OR(100,""AF"",".E  D
"RTN","ORY350B",167,0)
 .S ORIFN=$P(ORIDX,",",4) Q:+$G(ORIFN)'>0
"RTN","ORY350B",168,0)
 .Q:$D(^OR(100,ORIFN,0))=0
"RTN","ORY350B",169,0)
 .S ORDISGRP=$P(^OR(100,ORIFN,0),U,11) Q:+$G(ORDISGRP)'>0
"RTN","ORY350B",170,0)
 .Q:(+$G(ORDISGRP)'=ORCON)&(+$G(ORDISGRP)'=ORPROC)
"RTN","ORY350B",171,0)
 .D UPDATEID(ORIFN)
"RTN","ORY350B",172,0)
 I ORCOUNT'>9 D
"RTN","ORY350B",173,0)
 .S ^TMP("OR350_EADID",$J,ORCOUNT)="No orders found to edit.  If this is the first time this report has been run,",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",174,0)
 .S ^TMP("OR350_EADID",$J,ORCOUNT)="please submit a Remedy ticket for assistance.",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",175,0)
 Q
"RTN","ORY350B",176,0)
 ;
"RTN","ORY350B",177,0)
UPDATEID(ORDA) ;update ID value for order.  Change "EARLIEST" to "CLINICALLY"
"RTN","ORY350B",178,0)
 Q:+$G(ORDA)'>0
"RTN","ORY350B",179,0)
 N DIE,DA,DR,ORITEM S ORITEM=0
"RTN","ORY350B",180,0)
 S DR=".04///CLINICALLY"
"RTN","ORY350B",181,0)
 F  S ORITEM=$O(^OR(100,ORDA,4.5,ORITEM)) Q:+$G(ORITEM)'>0  D
"RTN","ORY350B",182,0)
 .Q:$P(^OR(100,ORDA,4.5,ORITEM,0),U,4)'="EARLIEST"
"RTN","ORY350B",183,0)
 .S DIE="^OR(100,"_ORDA_",4.5,",DA(1)=ORDA,DA=ORITEM
"RTN","ORY350B",184,0)
 .L +^FILE(100,ORDA):0 I $T D ^DIE L -^FILE(100,ORDA) S ^TMP("OR350_EADID",$J,ORCOUNT)=ORDA,ORCOUNT=ORCOUNT+1 Q
"RTN","ORY350B",185,0)
 .S ^TMP("OR350_EADID",$J,ORCOUNT)=ORDA_"^Could not lock file entry for edit",ORCOUNT=ORCOUNT+1
"RTN","ORY350B",186,0)
 Q
"RTN","ORY350B",187,0)
 ;
"RTN","ORY350B",188,0)
SENDMAIL ;send message with list of edited orders
"RTN","ORY350B",189,0)
 N XMSUB,XMTEXT,XMY,XMZ,XMDUZ,XMMG,DIFROM
"RTN","ORY350B",190,0)
 S XMSUB="CONSULT ORDERS: ID FIELD EDIT"
"RTN","ORY350B",191,0)
 S:$G(DUZ) XMY(DUZ)=""
"RTN","ORY350B",192,0)
 S XMDUZ="OR*3.0*350 INSTALL"
"RTN","ORY350B",193,0)
 S XMTEXT="^TMP(""OR350_EADID"",$J,"
"RTN","ORY350B",194,0)
 D ^XMD
"RTN","ORY350B",195,0)
 Q
"RTN","ORY350B",196,0)
 ;
"RTN","ORY350B",197,0)
DATA ; parameter data
"RTN","ORY350B",198,0)
 ;;9345,"KEY")
"RTN","ORY350B",199,0)
 ;;OR LAB TAB DEFAULT REPORT^1
"RTN","ORY350B",200,0)
 ;;9345,"VAL")
"RTN","ORY350B",201,0)
 ;;ORL MOST RECENT
"RTN","ORY350E")
0^30^B23254860
"RTN","ORY350E",1,0)
ORY350E ;ISP/RFR - ENVIRONMENT CHECK FOR PATCH OR*3*350 ;04/28/2015  06:39
"RTN","ORY350E",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**350**;Dec 17, 1997;Build 77
"RTN","ORY350E",3,0)
ENV ;ENVIRONMENT CHECK SECTION
"RTN","ORY350E",4,0)
 ;CHECK EXISTING NOTIFICATION(S)
"RTN","ORY350E",5,0)
 N ORENTRY,ORERROR,OROW
"RTN","ORY350E",6,0)
 S OROW=0
"RTN","ORY350E",7,0)
 I $D(^ORD(100.9,78,0)) D
"RTN","ORY350E",8,0)
 .D GETS^DIQ(100.9,"78,","*",,"ORENTRY","ORERROR")
"RTN","ORY350E",9,0)
 .S:ORENTRY(100.9,"78,",.001)'=78 OROW=1
"RTN","ORY350E",10,0)
 .S:ORENTRY(100.9,"78,",.01)'="LAPSED UNSIGNED ORDER" OROW=1
"RTN","ORY350E",11,0)
 .S:ORENTRY(100.9,"78,",.02)'="OR" OROW=1
"RTN","ORY350E",12,0)
 .S:ORENTRY(100.9,"78,",.03)'="Lapsed Unsigned Order(s)" OROW=1
"RTN","ORY350E",13,0)
 .S:ORENTRY(100.9,"78,",.04)'="PACKAGE PROVIDES A VARIABLE MESSAGE" OROW=1
"RTN","ORY350E",14,0)
 .S:ORENTRY(100.9,"78,",.05)'="RUN ROUTINE" OROW=1
"RTN","ORY350E",15,0)
 .S:ORENTRY(100.9,"78,",.06)'="INDORDER" OROW=1
"RTN","ORY350E",16,0)
 .S:ORENTRY(100.9,"78,",.07)'="ORB3FUP1" OROW=1
"RTN","ORY350E",17,0)
 .S:ORENTRY(100.9,"78,",1)'="" OROW=1
"RTN","ORY350E",18,0)
 .S:ORENTRY(100.9,"78,",1.5)'="OR" OROW=1
"RTN","ORY350E",19,0)
 .S:ORENTRY(100.9,"78,",4)'="This notification is triggered when one or more unsigned orders are lapsed for a patient. The follow-up action displays the orders that were lapsed to the user." OROW=1
"RTN","ORY350E",20,0)
 .S:ORENTRY(100.9,"78,",5)'="" OROW=1
"RTN","ORY350E",21,0)
 Q:$$OW(.OROW,78)
"RTN","ORY350E",22,0)
 S OROW=0
"RTN","ORY350E",23,0)
 I $D(^ORD(100.9,73,0)) D
"RTN","ORY350E",24,0)
 .D GETS^DIQ(100.9,"73,","*",,"ORENTRY","ORERROR")
"RTN","ORY350E",25,0)
 .S:ORENTRY(100.9,"73,",.001)'=73 OROW=1
"RTN","ORY350E",26,0)
 .S:ORENTRY(100.9,"73,",.01)'="OP RX RENEWAL REQUEST" OROW=1
"RTN","ORY350E",27,0)
 .S:ORENTRY(100.9,"73,",.02)'="OR" OROW=1
"RTN","ORY350E",28,0)
 .S:ORENTRY(100.9,"73,",.03)'="Rx Renewal Request" OROW=1
"RTN","ORY350E",29,0)
 .S:ORENTRY(100.9,"73,",.04)'="PACKAGE PROVIDES A VARIABLE MESSAGE" OROW=1
"RTN","ORY350E",30,0)
 .S:ORENTRY(100.9,"73,",.05)'="RUN ROUTINE" OROW=1
"RTN","ORY350E",31,0)
 .S:ORENTRY(100.9,"73,",.06)'="INFODEL" OROW=1
"RTN","ORY350E",32,0)
 .S:ORENTRY(100.9,"73,",.07)'="ORB3FUP2" OROW=1
"RTN","ORY350E",33,0)
 .S:ORENTRY(100.9,"73,",1)'="" OROW=1
"RTN","ORY350E",34,0)
 .S:ORENTRY(100.9,"73,",1.5)'="" OROW=1
"RTN","ORY350E",35,0)
 .S:ORENTRY(100.9,"73,",4)'="Triggered when an automated process (for example, AudioCARE) submits a request to renew an Outpatient prescription for a non-renewable drug." OROW=1
"RTN","ORY350E",36,0)
 .S:ORENTRY(100.9,"73,",5)'="" OROW=1
"RTN","ORY350E",37,0)
 .I OROW D
"RTN","ORY350E",38,0)
 ..N OROW1,ORDESC
"RTN","ORY350E",39,0)
 ..S:ORENTRY(100.9,"73,",.01)="OP NON-RENEWABLE RX RENEWAL" OROW1=1+$G(OROW1)
"RTN","ORY350E",40,0)
 ..S:ORENTRY(100.9,"73,",.03)="Non-Renewable Rx Renewal Request" OROW1=1+$G(OROW1)
"RTN","ORY350E",41,0)
 ..S:ORENTRY(100.9,"73,",.06)="INDORDER" OROW1=1+$G(OROW1)
"RTN","ORY350E",42,0)
 ..S:ORENTRY(100.9,"73,",.07)="ORB3FUP1" OROW1=1+$G(OROW1)
"RTN","ORY350E",43,0)
 ..S:ORENTRY(100.9,"73,",1.5)="OR" OROW1=1+$G(OROW1)
"RTN","ORY350E",44,0)
 ..S ORDESC="This notification is triggered when an automated process (for example, AudioCARE) submits a request to renew an outpatient prescription for a non-renewable drug. The follow-up action displays the order that is non-renewable."
"RTN","ORY350E",45,0)
 ..S:ORENTRY(100.9,"73,",4)=ORDESC OROW1=1+$G(OROW1)
"RTN","ORY350E",46,0)
 ..S:$G(OROW1)=6 OROW=0
"RTN","ORY350E",47,0)
 Q:$$OW(.OROW,73)
"RTN","ORY350E",48,0)
 Q
"RTN","ORY350E",49,0)
OW(OROW,DA) ;ASK THE USER TO CONTINUE WITH INSTALLATION
"RTN","ORY350E",50,0)
 Q:'$G(OROW) 0
"RTN","ORY350E",51,0)
 N DIC,DIQ,DIR,X,Y,DTOUT,DUOUT,DIRUT,DIROUT
"RTN","ORY350E",52,0)
 S DIC="^ORD(100.9,",DIQ(0)="CR"
"RTN","ORY350E",53,0)
 D EN^DIQ
"RTN","ORY350E",54,0)
 W !,"The above notification will be overwritten.",!
"RTN","ORY350E",55,0)
 S DIR(0)="Y^",DIR("A")="Do you wish to proceed with installation of this patch",DIR("B")="NO"
"RTN","ORY350E",56,0)
 D ^DIR
"RTN","ORY350E",57,0)
 W !
"RTN","ORY350E",58,0)
 S:+$G(Y)=0 XPDQUIT=2
"RTN","ORY350E",59,0)
 Q:$G(XPDQUIT)=2 1
"RTN","ORY350E",60,0)
 Q 0
"RTN","ORY350E",61,0)
RECIP ;PROMPT FOR RECIPIENTS
"RTN","ORY350E",62,0)
 K:$D(^XTMP("ORY350QORECIPS")) ^XTMP("ORY350QORECIPS")
"RTN","ORY350E",63,0)
 K:$D(^XTMP("ORY350SOIRECIPS")) ^XTMP("ORY350SOIRECIPS")
"RTN","ORY350E",64,0)
 W !,$$CJ^XLFSTR("*** NON-VA MEDICATION COMPLEX QUICK ORDER DIALOG REPORT QUESTIONS ***",80," "),!
"RTN","ORY350E",65,0)
 W !,"The post-install will create the NON-VA MEDICATION COMPLEX QUICK ORDER DIALOG",!
"RTN","ORY350E",66,0)
 W "REPORT, which contains non-VA medication quick orders with a complex dosage.",!
"RTN","ORY350E",67,0)
 W "The installer is strongly encouraged to include the site's local Clinical",!
"RTN","ORY350E",68,0)
 W "Application Coordinators (CACs) as recipients of this report.",!!
"RTN","ORY350E",69,0)
 W "Please select the recipients for the NON-VA MEDICATION COMPLEX QUICK ORDER",!
"RTN","ORY350E",70,0)
 W "DIALOG REPORT below."
"RTN","ORY350E",71,0)
 N XMDUZ,XMDF,XMMG,X,XMOUT,XMY,DIR
"RTN","ORY350E",72,0)
 S XMDUZ=DUZ
"RTN","ORY350E",73,0)
 D DES^XMA21 ;ICR #10067
"RTN","ORY350E",74,0)
 I $D(XMY)>9 D
"RTN","ORY350E",75,0)
 .S ^XTMP("ORY350QORECIPS",0)=$$FMADD^XLFDT(DT,31)_U_DT_U_"RECIPIENTS OF NON-VA MEDICATION COMPLEX QUICK ORDER DIALOG REPORT"
"RTN","ORY350E",76,0)
 .M ^XTMP("ORY350QORECIPS")=XMY
"RTN","ORY350E",77,0)
 Q
"RTN","ORY350E",78,0)
QUES(DIR) ;
"RTN","ORY350E",79,0)
 ;ASK A QUESTION
"RTN","ORY350E",80,0)
 Q:$G(DIR("A"))=""
"RTN","ORY350E",81,0)
 N DIRUT,Y
"RTN","ORY350E",82,0)
 F  D  Q:$D(Y)
"RTN","ORY350E",83,0)
 .N X,DTOUT,DUOUT,DIROUT
"RTN","ORY350E",84,0)
 .S DIR(0)="Y"_U,DIR("B")="YES"
"RTN","ORY350E",85,0)
 .D ^DIR
"RTN","ORY350E",86,0)
 .I $D(DIRUT) W !,"A response is required.",! K Y
"RTN","ORY350E",87,0)
 Q $G(Y)
"RTN","ORY350E",88,0)
INCNOTIF(IEN) ;Include OE/RR NOTIFICATIONS file entry?
"RTN","ORY350E",89,0)
 Q:IEN=73 1
"RTN","ORY350E",90,0)
 Q:IEN=78 1
"RTN","ORY350E",91,0)
 Q 0
"RTN","ORY350F")
1^63
"VER")
8.0^22.0
"^DD",100.9,100.9,0)
FIELD^^2^13
"^DD",100.9,100.9,0,"DDA")
N
"^DD",100.9,100.9,0,"DT")
3140915
"^DD",100.9,100.9,0,"IX","B",100.9,.01)

"^DD",100.9,100.9,0,"IX","C",100.9,.02)

"^DD",100.9,100.9,0,"IX","D",100.9,.03)

"^DD",100.9,100.9,0,"NM","OE/RR NOTIFICATIONS")

"^DD",100.9,100.9,0,"PT",100.21019,.01)

"^DD",100.9,100.9,0,"PT",860.22,3)

"^DD",100.9,100.9,0,"PT",21695.2,.1)

"^DD",100.9,100.9,0,"PT",21695.52,.01)

"^DD",100.9,100.9,0,"VRPK")
OR
"^DD",100.9,100.9,.001,0)
NUMBER^NJ9,0X^^ ^K:+X'=X!(X>99999)!(X<1)!(X?.E1"."1N.N)!('$$VALNUM^ORBINPTR(X)) X
"^DD",100.9,100.9,.001,3)
Enter your station number, followed by 01 to 99. For example, 66001. Numbers 1-9999 are reserved for National notifications only.
"^DD",100.9,100.9,.001,21,0)
^^11^11^3121106^
"^DD",100.9,100.9,.001,21,1,0)
This is the internal entry number assigned to a notification.  Entries
"^DD",100.9,100.9,.001,21,2,0)
1 through 9999 are reserved for National release by the OE/RR 
"^DD",100.9,100.9,.001,21,3,0)
Notifications package.
"^DD",100.9,100.9,.001,21,4,0)
 
"^DD",100.9,100.9,.001,21,5,0)
For local site-defined notifications, the internal entry number must be 
"^DD",100.9,100.9,.001,21,6,0)
specific to your VAMC in the following format:
"^DD",100.9,100.9,.001,21,7,0)
 
"^DD",100.9,100.9,.001,21,8,0)
<your station number><incremental notification number 01-99>
"^DD",100.9,100.9,.001,21,9,0)
 
"^DD",100.9,100.9,.001,21,10,0)
For example, if your site is number 456, your first locally created 
"^DD",100.9,100.9,.001,21,11,0)
notification would be 45601.                         
"^DD",100.9,100.9,.001,23,0)
^.001^3^3^3121106^^^^
"^DD",100.9,100.9,.001,23,1,0)
This field is used by DHCP packages triggering notifications (Lab, MAS, etc)
"^DD",100.9,100.9,.001,23,2,0)
to send the correct message and parameters to OE/RR.  These numbers must not
"^DD",100.9,100.9,.001,23,3,0)
be altered in any fashion.
"^DD",100.9,100.9,.001,"DT")
3121026
"^DD",100.9,100.9,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",100.9,100.9,.01,1,0)
^.1
"^DD",100.9,100.9,.01,1,1,0)
100.9^B
"^DD",100.9,100.9,.01,1,1,1)
S ^ORD(100.9,"B",$E(X,1,30),DA)=""
"^DD",100.9,100.9,.01,1,1,2)
K ^ORD(100.9,"B",$E(X,1,30),DA)
"^DD",100.9,100.9,.01,1,2,0)
^^TRIGGER^100.9^.02
"^DD",100.9,100.9,.01,1,2,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^ORD(100.9,D0,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X=DIV S X="OR" X ^DD(100.9,.01,1,2,1.4)
"^DD",100.9,100.9,.01,1,2,1.4)
S DIH=$S($D(^ORD(100.9,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,2)=DIV,DIH=100.9,DIG=.02 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",100.9,100.9,.01,1,2,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^ORD(100.9,D0,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X=DIV S X=X X ^DD(100.9,.01,1,2,2.4)
"^DD",100.9,100.9,.01,1,2,2.4)
S DIH=$S($D(^ORD(100.9,DIV(0),0)):^(0),1:""),DIV=X S $P(^(0),U,2)=DIV,DIH=100.9,DIG=.02 D ^DICR:$O(^DD(DIH,DIG,1,0))>0
"^DD",100.9,100.9,.01,1,2,"%D",0)
^^2^2^2920505^
"^DD",100.9,100.9,.01,1,2,"%D",1,0)
Automatically trigger the setting of the PACKAGE ID field with "OR"
"^DD",100.9,100.9,.01,1,2,"%D",2,0)
to indicate ORder entry when a notification is created.
"^DD",100.9,100.9,.01,1,2,"CREATE VALUE")
"OR"
"^DD",100.9,100.9,.01,1,2,"DELETE VALUE")
OLD NAME
"^DD",100.9,100.9,.01,1,2,"DT")
2920505
"^DD",100.9,100.9,.01,1,2,"FIELD")
PACKAGE ID
"^DD",100.9,100.9,.01,3)
Answer must be 3-30 characters in length. Enter the name of the notification.  The name should match the entry in the MESSAGE TEXT field as closely as possible.
"^DD",100.9,100.9,.01,21,0)
^^4^4^2990416^^^^
"^DD",100.9,100.9,.01,21,1,0)
This is the name of the notification.  It should match the text in the
"^DD",100.9,100.9,.01,21,2,0)
MESSAGE TEXT field as closely as possible (it may be an abbreviated version
"^DD",100.9,100.9,.01,21,3,0)
of the entry in MESSAGE TEXT.)  This field is displayed to users when
"^DD",100.9,100.9,.01,21,4,0)
selecting or reviewing entries in this file (100.9).
"^DD",100.9,100.9,.01,"DT")
2920505
"^DD",100.9,100.9,.02,0)
PACKAGE ID^RFX^^0;2^S X="OR" ;K:X[""""!($A(X)=^ X I $D(X) K:$L(X)>20!($L(X)<2) X
"^DD",100.9,100.9,.02,1,0)
^.1
"^DD",100.9,100.9,.02,1,1,0)
100.9^C
"^DD",100.9,100.9,.02,1,1,1)
S ^ORD(100.9,"C",$E(X,1,30),DA)=""
"^DD",100.9,100.9,.02,1,1,2)
K ^ORD(100.9,"C",$E(X,1,30),DA)
"^DD",100.9,100.9,.02,1,1,"%D",0)
^^2^2^2920427^^
"^DD",100.9,100.9,.02,1,1,"%D",1,0)
This cross-reference provides a way to group notifications by package or 
"^DD",100.9,100.9,.02,1,1,"%D",2,0)
other category.
"^DD",100.9,100.9,.02,1,1,"DT")
2910429
"^DD",100.9,100.9,.02,3)
Always enter "OR" in this field.  This field is used to create the XQAID field passed to the XQALERT entry points.  It will typically be the Package ID. 
"^DD",100.9,100.9,.02,5,1,0)
100.9^.01^2
"^DD",100.9,100.9,.02,9)
^
"^DD",100.9,100.9,.02,21,0)
^^10^10^2990416^^^^
"^DD",100.9,100.9,.02,21,1,0)
This entry should always be "OR" to indicate the alert (notification) is 
"^DD",100.9,100.9,.02,21,2,0)
processed by OE/RR.  "OR" is stuffed via a trigger x-ref in field .01.
"^DD",100.9,100.9,.02,21,3,0)
This Package ID will have ";DFN;NIEN" concatenated to the end of it, to
"^DD",100.9,100.9,.02,21,4,0)
make the XQAID variable which is used by the XQALERT routine to provide a
"^DD",100.9,100.9,.02,21,5,0)
unique cross-reference.  The order entry notification system will check
"^DD",100.9,100.9,.02,21,6,0)
the New person file to determine if this message is already pending for
"^DD",100.9,100.9,.02,21,7,0)
the user.  If it already exists, the user will not receive a second message.
"^DD",100.9,100.9,.02,21,8,0)
 
"^DD",100.9,100.9,.02,21,9,0)
DFN is the Patient File internal entry number.
"^DD",100.9,100.9,.02,21,10,0)
NIEN is the Notification File internal entry number.
"^DD",100.9,100.9,.02,"DT")
2911008
"^DD",100.9,100.9,.03,0)
MESSAGE TEXT^RF^^0;3^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>51!($L(X)<3) X
"^DD",100.9,100.9,.03,1,0)
^.1
"^DD",100.9,100.9,.03,1,1,0)
100.9^D
"^DD",100.9,100.9,.03,1,1,1)
S ^ORD(100.9,"D",$E(X,1,30),DA)=""
"^DD",100.9,100.9,.03,1,1,2)
K ^ORD(100.9,"D",$E(X,1,30),DA)
"^DD",100.9,100.9,.03,1,1,"%D",0)
^^1^1^2910429^
"^DD",100.9,100.9,.03,1,1,"%D",1,0)
This cross reference provides a look-up based on the Message Text.
"^DD",100.9,100.9,.03,1,1,"DT")
2910429
"^DD",100.9,100.9,.03,3)
Answer must be 3-51 characters in length.  This entry is used as the actual text of the notification (MESSAGE TYPE = 'NOT') or the default text (MESSAGE TEXT = 'PKG').
"^DD",100.9,100.9,.03,21,0)
^^6^6^2920224^^^^
"^DD",100.9,100.9,.03,21,1,0)
This text will be appended to the Patient last name and last 4 characters of
"^DD",100.9,100.9,.03,21,2,0)
the social security number to create the order notification text.
"^DD",100.9,100.9,.03,21,3,0)
(e.g., SMITH (4356): Unsigned orders. - Where "Unsigned orders." is the 
"^DD",100.9,100.9,.03,21,4,0)
content of MESSAGE TEXT.)  Text entered into this field is the default text
"^DD",100.9,100.9,.03,21,5,0)
for notifications where the text message usually comes from the package
"^DD",100.9,100.9,.03,21,6,0)
(MESSAGE TYPE = PKG).
"^DD",100.9,100.9,.03,"DT")
2911008
"^DD",100.9,100.9,.04,0)
MESSAGE TYPE^RS^PKG:PACKAGE PROVIDES A VARIABLE MESSAGE;NOT:NOTIFICATION FILE PROVIDES MESSAGE;^0;4^Q
"^DD",100.9,100.9,.04,3)
Messages can be provided by the NOTIFICATION file where they are defined with the notification 'NOT' or they can be variable messages supplied by the package 'PKG' when the notification is triggered.
"^DD",100.9,100.9,.04,21,0)
^^1^1^2960503^^^^
"^DD",100.9,100.9,.04,21,1,0)
MESSAGE TYPE field is used as a flag to determine where the message text originates.  If from the NOTIFICATION file, MESSAGE TYPE is 'NOT.'  If the message comes from the package, MESSAGE TYPE is 'PKG.'
"^DD",100.9,100.9,.04,"DT")
2910627
"^DD",100.9,100.9,.05,0)
ACTION FLAG^RS^I:INFORMATION ONLY;R:RUN ROUTINE;^0;5^Q
"^DD",100.9,100.9,.05,3)
Enter 'I' if the user is to take no follow-up action for this notification.  Enter 'R' if the user is to take a follow-up action after viewing this notification (e.g. Sign an unsigned order.)
"^DD",100.9,100.9,.05,21,0)
^^7^7^2920417^^^^
"^DD",100.9,100.9,.05,21,1,0)
This a mandatory flag used to regulate processing in XQALERT processing.
"^DD",100.9,100.9,.05,21,2,0)
The flag is set to I to indicate the notification is for INFORMATION ONLY - 
"^DD",100.9,100.9,.05,21,3,0)
no follow-up action is to be taken.  'I' notifications are deleted as each
"^DD",100.9,100.9,.05,21,4,0)
user reviews them.  'R' notifications have a follow-up action associated
"^DD",100.9,100.9,.05,21,5,0)
with them.  The user will be taken to another routine or option when they
"^DD",100.9,100.9,.05,21,6,0)
select a notification with ACTION FLAG = R and a follow-up routine/option
"^DD",100.9,100.9,.05,21,7,0)
is defined.
"^DD",100.9,100.9,.05,"DT")
2910627
"^DD",100.9,100.9,.06,0)
ENTRY POINT^F^^0;6^K:$L(X)>8!($L(X)<1) X
"^DD",100.9,100.9,.06,3)
Answer must be 1-8 characters in length.  This should be the tag to be concatenated with the ROUTINE NAME (.07) field.  It is the entry point for follow-up action in that routine.
"^DD",100.9,100.9,.06,21,0)
^^2^2^2920224^^^
"^DD",100.9,100.9,.06,21,1,0)
This is an optional field used to create the XQAROU variable to be used by
"^DD",100.9,100.9,.06,21,2,0)
the XQALERT routine.  This field represents the TAG in tag^routine. 
"^DD",100.9,100.9,.06,"DT")
2910429
"^DD",100.9,100.9,.07,0)
ROUTINE NAME^F^^0;7^K:$L(X)>8!($L(X)<2) X
"^DD",100.9,100.9,.07,3)
Answer must be 2-8 characters in length.  This is concatenated with the ENTRY POINT (.06) to create XQAROU.  It is the routine where the follow-up action (if any) for this notification is initiated.
"^DD",100.9,100.9,.07,21,0)
^^2^2^2920224^^^
"^DD",100.9,100.9,.07,21,1,0)
This is an optional variable identifying a routine or tag(field .06)^routine
"^DD",100.9,100.9,.07,21,2,0)
used to create XQAROU for processing by XQALERT.
"^DD",100.9,100.9,.07,"DT")
2910429
"^DD",100.9,100.9,1,0)
NON-MENU TYPE OPTION ACTION^P19'^DIC(19,^1;1^Q
"^DD",100.9,100.9,1,3)
This field is for future enhancements.  It is currently (5/92) unused.
"^DD",100.9,100.9,1,21,0)
^^5^5^2920506^^^^
"^DD",100.9,100.9,1,21,1,0)
This is an optional field used to create the variable XQAOPT for use
"^DD",100.9,100.9,1,21,2,0)
by XQALERT.  It should indicate a non-menu type option on the user's
"^DD",100.9,100.9,1,21,3,0)
primary or secondary menu, not on the Common menu.  The phantom jump 
"^DD",100.9,100.9,1,21,4,0)
is used to navigate to the destination option and will check pathway
"^DD",100.9,100.9,1,21,5,0)
restrictions in doing so.
"^DD",100.9,100.9,1,"DT")
2910429
"^DD",100.9,100.9,1.5,0)
RELATED PACKAGE^F^^1;2^K:$L(X)>30!($L(X)<2) X
"^DD",100.9,100.9,1.5,3)
Answer must be 2-30 characters in length.  Enter the appropriate name of the package where the notification originates (e.g., LAB, MAS, Pharmacy.)
"^DD",100.9,100.9,1.5,21,0)
^^1^1^2920224^^^
"^DD",100.9,100.9,1.5,21,1,0)
This field contains the name of the package where the notification originates or is triggered (e.g., LAB, MAS, Pharmacy.)
"^DD",100.9,100.9,1.5,"DT")
2910627
"^DD",100.9,100.9,2,0)
PROCESSING FLAGS^100.92S^^5;0
"^DD",100.9,100.9,2,21,0)
^^2^2^3140701^
"^DD",100.9,100.9,2,21,1,0)
This field tells the notification system any special instructions to 
"^DD",100.9,100.9,2,21,2,0)
follow when creating the notification.
"^DD",100.9,100.9,4,0)
DESCRIPTION^RF^^4;1^K:$L(X)>250!($L(X)<3) X
"^DD",100.9,100.9,4,3)
Answer must be 3-250 characters in length.  Enter a description of the notification with emphasis on what triggers the notification and what actions delete it.
"^DD",100.9,100.9,4,21,0)
^^2^2^2950711^^^
"^DD",100.9,100.9,4,21,1,0)
This field contains free text describing the notification, how it is trig-
"^DD",100.9,100.9,4,21,2,0)
gered and what action(s) delete it.
"^DD",100.9,100.9,4,"DT")
2950424
"^DD",100.9,100.9,5,0)
FOLLOW-UP TYPE^S^0:REPORT;1:COSIGN_PN;2:EXPIRING_ORDER;3:FLAGGED_ORDER;4:ORDER;5:UNLINKED;6:NEW_CONSULT;7:NEW_ORDER;8:COSIGN_ORDER;9:ES_ORDER;10:UNSIGN_PN;11:UNVERIFIED_MED;^3;2^Q
"^DD",100.9,100.9,5,3)
Enter the follow-up code correspond to the notification's follow-up action.  If unsure, leave blank.
"^DD",100.9,100.9,5,21,0)
^^5^5^2990412^^^^
"^DD",100.9,100.9,5,21,1,0)
This field contains the type of follow-up action to be taken.  It is used 
"^DD",100.9,100.9,5,21,2,0)
by the application managing the follow-up action  (e.g. GUI interface) to
"^DD",100.9,100.9,5,21,3,0)
initiate the proper follow-up action separate from the underlying data 
"^DD",100.9,100.9,5,21,4,0)
base and application layers.  Example follow-up types include: report,
"^DD",100.9,100.9,5,21,5,0)
e/s, flag.
"^DD",100.9,100.9,5,23,0)
^^6^6^2990412^^^^
"^DD",100.9,100.9,5,23,1,0)
This field is basically a flag for the environment (e.g. GUI - Delphi)
"^DD",100.9,100.9,5,23,2,0)
handling notification follow-up to initiate the appropriate action.  For
"^DD",100.9,100.9,5,23,3,0)
example if the type was report, the data returned in the API call would be
"^DD",100.9,100.9,5,23,4,0)
stuffed into a generic text box for display; whereas if the type was
"^DD",100.9,100.9,5,23,5,0)
flag, the follow-up action would be to find and display all flagged orders
"^DD",100.9,100.9,5,23,6,0)
for the patient and allow unflagging.
"^DD",100.9,100.9,5,"DT")
2990412
"^DD",100.9,100.92,0)
PROCESSING FLAGS SUB-FIELD^^.01^1
"^DD",100.9,100.92,0,"DT")
3140915
"^DD",100.9,100.92,0,"IX","B",100.92,.01)

"^DD",100.9,100.92,0,"NM","PROCESSING FLAGS")

"^DD",100.9,100.92,0,"UP")
100.9
"^DD",100.9,100.92,.01,0)
PROCESSING FLAG^MSX^ONPP:GENERATE ONE NOTIFICATION PER PATIENT;CD:COMBINE DATA FROM DUPLICATES;^0;1^I X="ONPP",$P(^ORD(100.9,DA(1),0),U,6,7)='"INDORDER^ORB3FUP1" K X
"^DD",100.9,100.92,.01,1,0)
^.1
"^DD",100.9,100.92,.01,1,1,0)
100.92^B
"^DD",100.9,100.92,.01,1,1,1)
S ^ORD(100.9,DA(1),5,"B",$E(X,1,30),DA)=""
"^DD",100.9,100.92,.01,1,1,2)
K ^ORD(100.9,DA(1),5,"B",$E(X,1,30),DA)
"^DD",100.9,100.92,.01,3)
Select the flag to control creation of this notification.
"^DD",100.9,100.92,.01,21,0)
^^2^2^3140701^
"^DD",100.9,100.92,.01,21,1,0)
This field stores a special instruction that the notification system will 
"^DD",100.9,100.92,.01,21,2,0)
follow when creating the notification.
"^DD",100.9,100.92,.01,"DT")
3140915
"^DD",101.24,101.24,0)
FIELD^^.47^43
"^DD",101.24,101.24,0,"DDA")
N
"^DD",101.24,101.24,0,"DT")
3051006
"^DD",101.24,101.24,0,"ID",.23)
W:$D(^(2)) "   ",$P(^(2),U,3)
"^DD",101.24,101.24,0,"ID",.24)
W:$D(^(2)) "   ",$P(^(2),U,4)
"^DD",101.24,101.24,0,"IX","AC",101.24,.02)

"^DD",101.24,101.24,0,"IX","B",101.24,.01)

"^DD",101.24,101.24,0,"NM","OE/RR REPORT")

"^DD",101.24,101.24,0,"PT",101.24,.18)

"^DD",101.24,101.24,0,"PT",101.241,.01)

"^DD",101.24,101.24,0,"VRPK")
OR
"^DD",101.24,101.24,0,"VRRV")
1^3070507
"^DD",101.24,101.24,.001,0)
NUMBER^NJ5,0^^ ^K:+X'=X!(X>10000)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.24,101.24,.001,3)
Type a Number between 1 and 10000, 0 Decimal Digits
"^DD",101.24,101.24,.001,21,0)
^^1^1^3000921^
"^DD",101.24,101.24,.001,21,1,0)
This is the Number field for the file.
"^DD",101.24,101.24,.001,"DT")
3000920
"^DD",101.24,101.24,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",101.24,101.24,.01,1,0)
^.1^^-1
"^DD",101.24,101.24,.01,1,1,0)
101.24^B
"^DD",101.24,101.24,.01,1,1,1)
S ^ORD(101.24,"B",$E(X,1,30),DA)=""
"^DD",101.24,101.24,.01,1,1,2)
K ^ORD(101.24,"B",$E(X,1,30),DA)
"^DD",101.24,101.24,.01,3)
Answer must be 3-30 characters in length.
"^DD",101.24,101.24,.01,21,0)
^^1^1^3000921^
"^DD",101.24,101.24,.01,21,1,0)
This is the Name of the report.
"^DD",101.24,101.24,.01,"DT")
3010510
"^DD",101.24,101.24,.02,0)
ID^RF^^0;2^K:$L(X)>10!($L(X)<1) X
"^DD",101.24,101.24,.02,1,0)
^.1
"^DD",101.24,101.24,.02,1,1,0)
101.24^AC
"^DD",101.24,101.24,.02,1,1,1)
S ^ORD(101.24,"AC",$E(X,1,30),DA)=""
"^DD",101.24,101.24,.02,1,1,2)
K ^ORD(101.24,"AC",$E(X,1,30),DA)
"^DD",101.24,101.24,.02,1,1,"DT")
3001005
"^DD",101.24,101.24,.02,3)
Answer must be 1-10 characters in length.
"^DD",101.24,101.24,.02,21,0)
^^4^4^3000921^
"^DD",101.24,101.24,.02,21,1,0)
This is the code that identifies the report.  Each tab in CPRS that
"^DD",101.24,101.24,.02,21,2,0)
uses reports looks for this ID in order to process the report.
"^DD",101.24,101.24,.02,21,3,0)
Each tab also uses a unique set of ID's.  An ID of 5 on the Reports
"^DD",101.24,101.24,.02,21,4,0)
Tab may not identify the same report on a different tab.
"^DD",101.24,101.24,.02,"DT")
3001005
"^DD",101.24,101.24,.03,0)
REMOTE^S^1:YES;2:REMOTE ONLY;^0;3^Q
"^DD",101.24,101.24,.03,21,0)
^^2^2^3000921^
"^DD",101.24,101.24,.03,21,1,0)
This field is used to identify which reports allow remote access through
"^DD",101.24,101.24,.03,21,2,0)
Remote Data Views.
"^DD",101.24,101.24,.03,"DT")
3050512
"^DD",101.24,101.24,.04,0)
QUALIFIER^S^1:HSType;2:DateTime;3:Imaging;4:NutrAssess;19:MedicineProcedure;39:ListView;5:HSComponent;6:HSWPComponent;28:Surgery;^0;4^Q
"^DD",101.24,101.24,.04,21,0)
^.001^2^2^3010531^^^
"^DD",101.24,101.24,.04,21,1,0)
This field identifies which qualifier to use when processing the report.
"^DD",101.24,101.24,.04,21,2,0)
Examples of qualifiers are HSType, DateTime, Imaging and NutrAssess.
"^DD",101.24,101.24,.04,"DT")
3011004
"^DD",101.24,101.24,.05,0)
ROUTINE^FI^^0;5^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.05,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.05,8.5)
@
"^DD",101.24,101.24,.05,9)
@
"^DD",101.24,101.24,.05,21,0)
^.001^1^1^3001026^^^
"^DD",101.24,101.24,.05,21,1,0)
This is the routine that is invoked to produce the report.
"^DD",101.24,101.24,.05,23,0)
^.001^2^2^3001026^^
"^DD",101.24,101.24,.05,23,1,0)
The Labs Tab does not have a value for this field.  The CPRS executable
"^DD",101.24,101.24,.05,23,2,0)
calls separate RPC's for each report.
"^DD",101.24,101.24,.05,"DT")
3040126
"^DD",101.24,101.24,.06,0)
ENTRY POINT^FI^^0;6^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.06,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.06,8.5)
@
"^DD",101.24,101.24,.06,9)
@
"^DD",101.24,101.24,.06,21,0)
^.001^2^2^3001026^^
"^DD",101.24,101.24,.06,21,1,0)
This is the entry point for the ROUTINE that is invoked to produce the
"^DD",101.24,101.24,.06,21,2,0)
report.
"^DD",101.24,101.24,.06,23,0)
^.001^2^2^3001026^^
"^DD",101.24,101.24,.06,23,1,0)
The Labs Tab does not have a value for this field.  The CPRS executable
"^DD",101.24,101.24,.06,23,2,0)
calls separate RPC's for each report.
"^DD",101.24,101.24,.06,"DT")
3040126
"^DD",101.24,101.24,.07,0)
CATEGORY^S^0:FIXED;1:FIXED W/DATE;2:FIXED W/HEADER;3:FIXED W/DATE&HEADER;4:SPECIALIZED;5:GRAPHIC;6:LISTVIEW;^0;7^Q
"^DD",101.24,101.24,.07,3)
Enter a category for this report
"^DD",101.24,101.24,.07,21,0)
^^2^2^3001004^
"^DD",101.24,101.24,.07,21,1,0)
This field puts reports into a category that is evaluated by the GUI
"^DD",101.24,101.24,.07,21,2,0)
when the report is processed.
"^DD",101.24,101.24,.07,"DT")
3010215
"^DD",101.24,101.24,.08,0)
TAB^S^R:REPORTS TAB;L:LABS TAB;C:COVER SHEET;CD:COVER SHEET DETAILS;^0;8^Q
"^DD",101.24,101.24,.08,3)
Enter the appropriate code for this report.
"^DD",101.24,101.24,.08,21,0)
^.001^1^1^3001003^^
"^DD",101.24,101.24,.08,21,1,0)
This fields identifies the appropriate tab for a report in CPRS.
"^DD",101.24,101.24,.08,"DT")
3001011
"^DD",101.24,101.24,.09,0)
MIXEDCASE^S^1:YES;^0;9^Q
"^DD",101.24,101.24,.09,3)
Enter YES to display the list in mixed case
"^DD",101.24,101.24,.09,21,0)
^^2^2^3001004^
"^DD",101.24,101.24,.09,21,1,0)
This is used in the cover sheet and is used to display the returned
"^DD",101.24,101.24,.09,21,2,0)
list in mixed case.
"^DD",101.24,101.24,.09,"DT")
3001004
"^DD",101.24,101.24,.1,0)
INVERT^S^1:YES;^0;10^Q
"^DD",101.24,101.24,.1,3)
Enter YES to have the returned list inverted.
"^DD",101.24,101.24,.1,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.1,21,1,0)
This field is used to invert a list of data returned in the Cover sheet
"^DD",101.24,101.24,.1,"DT")
3001004
"^DD",101.24,101.24,.11,0)
TEXT COLOR^S^Black:BLACK;Maroon:MAROON;Green:GREEN;Olive:OLIVE;Purple:PURPLE;Teal:TEAL;Red:RED;Lime:LIME;Yellow:YELLOW;Blue:BLUE;Fuchsia:FUCHSIA;Aqua:AQUA;^0;11^Q
"^DD",101.24,101.24,.11,3)
Enter the color for the text
"^DD",101.24,101.24,.11,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.11,21,1,0)
This field determines the text color for the returned data.
"^DD",101.24,101.24,.11,"DT")
3001004
"^DD",101.24,101.24,.12,0)
TYPE^S^R:REPORT;H:HTML;L:LISTMAN ONLY;S:SELECTION LIST;V:LISTVIEW;M:MENU;G:GRAPH;^0;12^Q
"^DD",101.24,101.24,.12,3)
Enter the type for this entry.
"^DD",101.24,101.24,.12,21,0)
^.001^1^1^3001017^^
"^DD",101.24,101.24,.12,21,1,0)
This field identifies the type for an entry.
"^DD",101.24,101.24,.12,"DT")
3041208
"^DD",101.24,101.24,.13,0)
RPC^P8994'^XWB(8994,^0;13^Q
"^DD",101.24,101.24,.13,3)
Select the RPC that produces this report.
"^DD",101.24,101.24,.13,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.13,21,1,0)
This is the RPC that is called inside the GUI to produce the report.
"^DD",101.24,101.24,.13,"DT")
3001004
"^DD",101.24,101.24,.14,0)
DATE FORMAT^S^D:DATE ONLY;T:DATE WITH TIME;^0;14^Q
"^DD",101.24,101.24,.14,3)
Enter the code for the desired date format.
"^DD",101.24,101.24,.14,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.14,21,1,0)
This field determines what kind of format to display date/time fields.
"^DD",101.24,101.24,.14,"DT")
3001004
"^DD",101.24,101.24,.15,0)
DATE PIECE^NJ2,0^^0;15^K:+X'=X!(X>15)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.24,101.24,.15,3)
Type a Number between 1 and 15, 0 Decimal Digits
"^DD",101.24,101.24,.15,21,0)
^^2^2^3001004^
"^DD",101.24,101.24,.15,21,1,0)
This is used on the Cover Sheet to determine which piece the date field
"^DD",101.24,101.24,.15,21,2,0)
occupies.
"^DD",101.24,101.24,.15,"DT")
3001004
"^DD",101.24,101.24,.16,0)
TAB POSITIONS^F^^0;16^K:$L(X)>15!($L(X)<1) X
"^DD",101.24,101.24,.16,3)
Answer must be 1-15 characters in length.
"^DD",101.24,101.24,.16,21,0)
^^2^2^3001005^
"^DD",101.24,101.24,.16,21,1,0)
This is the value that will be used for the Tab property for the listbox
"^DD",101.24,101.24,.16,21,2,0)
associated with this report on the Cover Sheet.
"^DD",101.24,101.24,.16,"DT")
3001005
"^DD",101.24,101.24,.17,0)
PIECES^F^^0;17^K:$L(X)>20!($L(X)<1) X
"^DD",101.24,101.24,.17,3)
Answer must be 1-20 characters in length.
"^DD",101.24,101.24,.17,21,0)
^^2^2^3001011^
"^DD",101.24,101.24,.17,21,1,0)
This field is used by the Cover Sheet to determine what pieces of data
"^DD",101.24,101.24,.17,21,2,0)
to display in the listbox.
"^DD",101.24,101.24,.17,"DT")
3001011
"^DD",101.24,101.24,.18,0)
DETAIL REPORT^*P101.24'^ORD(101.24,^0;18^S DIC("S")="I $P(^(0),""^"",8)=""CD""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",101.24,101.24,.18,3)
Enter the report to get the details for this report.
"^DD",101.24,101.24,.18,12)
Allow only Cover sheet detail type reports
"^DD",101.24,101.24,.18,12.1)
S DIC("S")="I $P(^(0),""^"",8)=""CD"""
"^DD",101.24,101.24,.18,21,0)
^^1^1^3001011^
"^DD",101.24,101.24,.18,21,1,0)
This field is used to get the details of an item on the cover sheet.
"^DD",101.24,101.24,.18,"DT")
3001011
"^DD",101.24,101.24,.19,0)
REPORT TAG^F^^0;19^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.19,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.19,21,0)
^.001^1^1^3010503^^
"^DD",101.24,101.24,.19,21,1,0)
This is the entry point tag for a report extract.
"^DD",101.24,101.24,.19,"DT")
3110720
"^DD",101.24,101.24,.191,0)
REPORT ROUTINE^F^^0;20^K:$L(X)>8!($L(X)<3) X
"^DD",101.24,101.24,.191,3)
Answer must be 3-8 characters in length.
"^DD",101.24,101.24,.191,21,0)
^.001^1^1^3010503^^
"^DD",101.24,101.24,.191,21,1,0)
This is the routine associated with the REPORT TAG for report extracts.
"^DD",101.24,101.24,.191,"DT")
3110720
"^DD",101.24,101.24,.192,0)
REPORT COMPONENT^P142.1'^GMT(142.1,^0;21^Q
"^DD",101.24,101.24,.192,21,0)
^.001^1^1^3010503^^
"^DD",101.24,101.24,.192,21,1,0)
This is the report component associated with this report.
"^DD",101.24,101.24,.192,"DT")
3010503
"^DD",101.24,101.24,.21,0)
PARAM 1^F^^2;1^K:$L(X)>30!($L(X)<1) X
"^DD",101.24,101.24,.21,3)
Answer must be 1-30 characters in length.
"^DD",101.24,101.24,.21,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.21,21,1,0)
This is the 1st parameter passed to the RPC, if needed.
"^DD",101.24,101.24,.21,"DT")
3001004
"^DD",101.24,101.24,.22,0)
PARAM 2^F^^2;2^K:$L(X)>30!($L(X)<1) X
"^DD",101.24,101.24,.22,3)
Answer must be 1-30 characters in length.
"^DD",101.24,101.24,.22,21,0)
^^1^1^3001004^
"^DD",101.24,101.24,.22,21,1,0)
This is the 2nd parameter passed to the RPC, if needed.
"^DD",101.24,101.24,.22,"DT")
3001004
"^DD",101.24,101.24,.23,0)
HEADING^F^^2;3^K:$L(X)>75!($L(X)<1) X
"^DD",101.24,101.24,.23,1,0)
^.1^^0
"^DD",101.24,101.24,.23,3)
Answer must be 1-75 characters in length.
"^DD",101.24,101.24,.23,21,0)
^^1^1^3001031^
"^DD",101.24,101.24,.23,21,1,0)
This is the heading used on the Cover sheet for the list of items.
"^DD",101.24,101.24,.23,"DT")
3010510
"^DD",101.24,101.24,.24,0)
DESCRIPTIVE TEXT^RF^^2;4^K:$L(X)>55!($L(X)<2) X
"^DD",101.24,101.24,.24,3)
Answer must be 2-55 characters in length.
"^DD",101.24,101.24,.24,21,0)
^.001^2^2^3010510^^
"^DD",101.24,101.24,.24,21,1,0)
This is a more descriptive name than what might be included in the 
"^DD",101.24,101.24,.24,21,2,0)
NAME field.
"^DD",101.24,101.24,.24,"DT")
3010510
"^DD",101.24,101.24,.25,0)
NODE^F^^2;5^K:$L(X)>10!($L(X)<1) X
"^DD",101.24,101.24,.25,3)
Answer must be 1-10 characters in length.
"^DD",101.24,101.24,.25,21,0)
^^2^2^3001005^
"^DD",101.24,101.24,.25,21,1,0)
This is used by the Cover Sheet routines to define the node in the ^XTMP
"^DD",101.24,101.24,.25,21,2,0)
global to store the data.
"^DD",101.24,101.24,.25,"DT")
3001005
"^DD",101.24,101.24,.26,0)
PRINT TAG^FI^^2;6^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.26,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.26,21,0)
^^2^2^3010614^
"^DD",101.24,101.24,.26,21,1,0)
This is the entry point tag used when printing reports that do their own
"^DD",101.24,101.24,.26,21,2,0)
Write statements.
"^DD",101.24,101.24,.26,"DT")
3040126
"^DD",101.24,101.24,.27,0)
PRINT ROUTINE^FI^^2;7^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.27,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.27,21,0)
^^2^2^3010614^
"^DD",101.24,101.24,.27,21,1,0)
This is the entry point routine used when printing reports that do their own
"^DD",101.24,101.24,.27,21,2,0)
Write statements.
"^DD",101.24,101.24,.27,"DT")
3040126
"^DD",101.24,101.24,.28,0)
EXTRACT TAG^FI^^2;8^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.28,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.28,21,0)
^^2^2^3010711^
"^DD",101.24,101.24,.28,21,1,0)
This is the entry point for the extract routine that pulls the data from
"^DD",101.24,101.24,.28,21,2,0)
package API's and/or package files.
"^DD",101.24,101.24,.28,"DT")
3051222
"^DD",101.24,101.24,.29,0)
EXTRACT ROUTINE^FI^^2;9^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.29,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.29,21,0)
^^2^2^3010711^
"^DD",101.24,101.24,.29,21,1,0)
This is the extract routine that pulls data from package API's and/or
"^DD",101.24,101.24,.29,21,2,0)
package files.
"^DD",101.24,101.24,.29,"DT")
3040126
"^DD",101.24,101.24,.41,0)
SORT ORDER^F^^4;1^K:$L(X)>15!($L(X)<3)!'(X?1N1":"1N) X
"^DD",101.24,101.24,.41,3)
Answer must be 3-15 characters in length.
"^DD",101.24,101.24,.41,21,0)
^^6^6^3010717^
"^DD",101.24,101.24,.41,21,1,0)
This field is used when sorting columns of data on at grid within CPRS.
"^DD",101.24,101.24,.41,21,2,0)
It determines the sort order to be used in a multi-column sort.  The
"^DD",101.24,101.24,.41,21,3,0)
primary sort column is always the column header clicked on by the user.
"^DD",101.24,101.24,.41,21,4,0)
If this field has values in the form #:#, then a multi-column sort is
"^DD",101.24,101.24,.41,21,5,0)
done, using the column numbers identified in this field for the second
"^DD",101.24,101.24,.41,21,6,0)
and third level sorting.
"^DD",101.24,101.24,.41,"DT")
3010717
"^DD",101.24,101.24,.42,0)
MAXIMUM DAYS BACK^NJ4,0^^4;2^K:+X'=X!(X>9999)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.24,101.24,.42,3)
Type a Number between 1 and 9999, 0 Decimal Digits
"^DD",101.24,101.24,.42,21,0)
^^1^1^3011004^
"^DD",101.24,101.24,.42,21,1,0)
This field restricts the report date range to the maximum value specified.
"^DD",101.24,101.24,.42,"DT")
3011004
"^DD",101.24,101.24,.43,0)
FHIE REPORT^F^^4;3^K:$L(X)>10!($L(X)<2) X
"^DD",101.24,101.24,.43,3)
Answer must be 2-10 characters in length.
"^DD",101.24,101.24,.43,21,0)
^.001^3^3^3040126^^^^
"^DD",101.24,101.24,.43,21,1,0)
This field identifies reports that are available through FHIE.
"^DD",101.24,101.24,.43,21,2,0)
The item in this field is the code for the report available through
"^DD",101.24,101.24,.43,21,3,0)
the FHIE server.
"^DD",101.24,101.24,.43,23,0)
^.001^3^3^3040126^^^^
"^DD",101.24,101.24,.43,23,1,0)
This field is not looked at by reports that have a 'listview' format.
"^DD",101.24,101.24,.43,23,2,0)
It is only used by straight text reports that go through the routine:
"^DD",101.24,101.24,.43,23,3,0)
  ORDV01
"^DD",101.24,101.24,.43,"DT")
3031008
"^DD",101.24,101.24,.44,0)
DIRECT^S^0:NO;1:YES;^4;4^Q
"^DD",101.24,101.24,.44,3)
ENTER YES TO MAKE DIRECT REMOTE DATA CALLS
"^DD",101.24,101.24,.44,21,0)
^^4^4^3050201^
"^DD",101.24,101.24,.44,21,1,0)
This field allows a report to make a direct remote data call to
"^DD",101.24,101.24,.44,21,2,0)
a remote site.  Use caution in setting this field to yes.  It has
"^DD",101.24,101.24,.44,21,3,0)
the effect of disabling CPRS until the remote call is finished, but
"^DD",101.24,101.24,.44,21,4,0)
also may speed up the query by bypassing taskman latency.
"^DD",101.24,101.24,.44,"DT")
3050201
"^DD",101.24,101.24,.45,0)
HDR REPORT^S^1:YES;^4;5^Q
"^DD",101.24,101.24,.45,3)
Enter 'YES' if this report comes from the HDR.
"^DD",101.24,101.24,.45,21,0)
^^1^1^3051006^
"^DD",101.24,101.24,.45,21,1,0)
This field flags reports that are generated from the HDR.
"^DD",101.24,101.24,.45,"DT")
3051006
"^DD",101.24,101.24,.46,0)
HDR ROUTINE^F^^4;6^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.46,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.46,21,0)
^^1^1^3051006^
"^DD",101.24,101.24,.46,21,1,0)
This is the HDR routine that modifies HDR data for CPRS.
"^DD",101.24,101.24,.46,"DT")
3051006
"^DD",101.24,101.24,.47,0)
HDR ENTRY POINT^F^^4;7^K:$L(X)>8!($L(X)<1) X
"^DD",101.24,101.24,.47,3)
Answer must be 1-8 characters in length.
"^DD",101.24,101.24,.47,21,0)
^^1^1^3051006^
"^DD",101.24,101.24,.47,21,1,0)
This is the HDR entry point that modifies HDR data for CPRS.
"^DD",101.24,101.24,.47,"DT")
3051006
"^DD",101.24,101.24,.48,0)
FHIE DATA^S^1:YES;^4;8^Q
"^DD",101.24,101.24,.48,3)
Enter YES if this report gets data from DOD/FHIE
"^DD",101.24,101.24,.48,21,0)
^.001^3^3^3070208^^
"^DD",101.24,101.24,.48,21,1,0)
This field is used to tell CPRS that DOD/FHIE data can be accessed
"^DD",101.24,101.24,.48,21,2,0)
for this report.  Special code has to be written by CPRS and DOD
"^DD",101.24,101.24,.48,21,3,0)
for this to happen.
"^DD",101.24,101.24,.48,"DT")
3070208
"^DD",101.24,101.24,.49,0)
FHIE/REMOTE DATA ONLY^S^1:YES;^4;9^Q
"^DD",101.24,101.24,.49,3)
Enter YES if Local data should be excluded from this report.
"^DD",101.24,101.24,.49,21,0)
^.001^5^5^3100302^^
"^DD",101.24,101.24,.49,21,1,0)
This field determines if a report can show local VA data and Remote 
"^DD",101.24,101.24,.49,21,2,0)
data. Enter YES if LOCAL data should be excluded from the report.
"^DD",101.24,101.24,.49,21,3,0)
Some Department of Defense (DOD) reports don't have a VistA
"^DD",101.24,101.24,.49,21,4,0)
equivalent (Questionnaires, Histories). An entry of YES would be
"^DD",101.24,101.24,.49,21,5,0)
appropriate for those kinds of reports.
"^DD",101.24,101.24,.49,"DT")
3100302
"^DD",101.24,101.24,.491,0)
DISABLE^S^1:YES;^4;10^Q
"^DD",101.24,101.24,.491,3)
Enter YES to disable this report.
"^DD",101.24,101.24,.491,21,0)
^^1^1^3080416^
"^DD",101.24,101.24,.491,21,1,0)
This field will disable a report.
"^DD",101.24,101.24,.491,"DT")
3080416
"^DD",101.24,101.24,3,0)
COLUMN HEADERS^101.243^^3;0
"^DD",101.24,101.24,10,0)
ITEM^101.241P^^10;0
"^DD",101.24,101.241,0)
ITEM SUB-FIELD^^.03^3
"^DD",101.24,101.241,0,"DT")
3010215
"^DD",101.24,101.241,0,"IX","B",101.241,.01)

"^DD",101.24,101.241,0,"NM","ITEM")

"^DD",101.24,101.241,0,"UP")
101.24
"^DD",101.24,101.241,.01,0)
ITEM^MP101.24^ORD(101.24,^0;1^Q
"^DD",101.24,101.241,.01,1,0)
^.1
"^DD",101.24,101.241,.01,1,1,0)
101.241^B
"^DD",101.24,101.241,.01,1,1,1)
S ^ORD(101.24,DA(1),10,"B",$E(X,1,30),DA)=""
"^DD",101.24,101.241,.01,1,1,2)
K ^ORD(101.24,DA(1),10,"B",$E(X,1,30),DA)
"^DD",101.24,101.241,.01,3)

"^DD",101.24,101.241,.01,21,0)
^^1^1^3010215^
"^DD",101.24,101.241,.01,21,1,0)
This is used in building a treeview of reports for CPRS GUI.
"^DD",101.24,101.241,.01,"DT")
3010215
"^DD",101.24,101.241,.02,0)
HEADER TEXT^F^^0;2^K:$L(X)>30!($L(X)<1) X
"^DD",101.24,101.241,.02,3)
Answer must be 1-30 characters in length.
"^DD",101.24,101.241,.02,21,0)
^^1^1^3010215^
"^DD",101.24,101.241,.02,21,1,0)
This is the header to be used.
"^DD",101.24,101.241,.02,"DT")
3010215
"^DD",101.24,101.241,.03,0)
SEQUENCE^NJ7,1^^0;3^K:+X'=X!(X>99999)!(X<.1)!(X?.E1"."2N.N) X
"^DD",101.24,101.241,.03,3)
Type a Number between .1 and 99999, 1 Decimal Digit
"^DD",101.24,101.241,.03,21,0)
^^1^1^3010215^
"^DD",101.24,101.241,.03,21,1,0)
This is the sequence number for this report.
"^DD",101.24,101.241,.03,"DT")
3010215
"^DD",101.24,101.243,0)
COLUMN HEADERS SUB-FIELD^^1^11
"^DD",101.24,101.243,0,"DT")
3051006
"^DD",101.24,101.243,0,"IX","B",101.243,.01)

"^DD",101.24,101.243,0,"IX","C",101.243,.03)

"^DD",101.24,101.243,0,"NM","COLUMN HEADERS")

"^DD",101.24,101.243,0,"UP")
101.24
"^DD",101.24,101.243,.01,0)
COLUMN HEADERS^MF^^0;1^K:$L(X)>60!($L(X)<1) X
"^DD",101.24,101.243,.01,1,0)
^.1
"^DD",101.24,101.243,.01,1,1,0)
101.243^B
"^DD",101.24,101.243,.01,1,1,1)
S ^ORD(101.24,DA(1),3,"B",$E(X,1,30),DA)=""
"^DD",101.24,101.243,.01,1,1,2)
K ^ORD(101.24,DA(1),3,"B",$E(X,1,30),DA)
"^DD",101.24,101.243,.01,3)
Answer must be 1-60 characters in length.
"^DD",101.24,101.243,.01,21,0)
^.001^1^1^3010709^^^^
"^DD",101.24,101.243,.01,21,1,0)
These are the column headings used on a report in ListView format.
"^DD",101.24,101.243,.01,"DT")
3010709
"^DD",101.24,101.243,.02,0)
VISIBLE^S^0:YES;1:NO;^0;2^Q
"^DD",101.24,101.243,.02,3)
Set this field to NO to hide the column.
"^DD",101.24,101.243,.02,21,0)
^^1^1^3010420^
"^DD",101.24,101.243,.02,21,1,0)
This field determines the visible property of the column.
"^DD",101.24,101.243,.02,"DT")
3010420
"^DD",101.24,101.243,.03,0)
SEQUENCE^NJ6,1^^0;3^K:+X'=X!(X>9999)!(X<.1)!(X?.E1"."2N.N) X
"^DD",101.24,101.243,.03,1,0)
^.1
"^DD",101.24,101.243,.03,1,1,0)
101.243^C
"^DD",101.24,101.243,.03,1,1,1)
S ^ORD(101.24,DA(1),3,"C",$E(X,1,30),DA)=""
"^DD",101.24,101.243,.03,1,1,2)
K ^ORD(101.24,DA(1),3,"C",$E(X,1,30),DA)
"^DD",101.24,101.243,.03,1,1,"DT")
3010321
"^DD",101.24,101.243,.03,3)
Type a Number between .1 and 9999, 1 Decimal Digit
"^DD",101.24,101.243,.03,21,0)
^^1^1^3010215^
"^DD",101.24,101.243,.03,21,1,0)
This is the sequence for the column header.
"^DD",101.24,101.243,.03,"DT")
3010321
"^DD",101.24,101.243,.04,0)
TYPE^S^0:SINGLE PIECE VALUE;1:WORD PROCESSING;^0;4^Q
"^DD",101.24,101.243,.04,3)
Enter '1' if the value of this column contains multiple lines of text.
"^DD",101.24,101.243,.04,21,0)
^^1^1^3010420^
"^DD",101.24,101.243,.04,21,1,0)
This field identifies columns that contain multiple lines of text.
"^DD",101.24,101.243,.04,"DT")
3010420
"^DD",101.24,101.243,.05,0)
INCLUDE ON DETAIL^S^0:NO;1:YES;^0;5^Q
"^DD",101.24,101.243,.05,3)
Enter YES to include this field in detailed report
"^DD",101.24,101.243,.05,21,0)
^.001^2^2^3010628^^^^
"^DD",101.24,101.243,.05,21,1,0)
This field is used to determine what data to include in the details of
"^DD",101.24,101.243,.05,21,2,0)
a report.
"^DD",101.24,101.243,.05,"DT")
3010628
"^DD",101.24,101.243,.06,0)
PRINT LENGTH^NJ2,0^^0;6^K:+X'=X!(X>20)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.24,101.243,.06,3)
Type a Number between 1 and 20, 0 Decimal Digits
"^DD",101.24,101.243,.06,21,0)
^^1^1^3010628^
"^DD",101.24,101.243,.06,21,1,0)
This is the field length used when printing this column on a report.
"^DD",101.24,101.243,.06,"DT")
3010628
"^DD",101.24,101.243,.07,0)
INCLUDE ON PRINT^S^0:NO;1:YES;^0;7^Q
"^DD",101.24,101.243,.07,21,0)
^^2^2^3010628^
"^DD",101.24,101.243,.07,21,1,0)
This field determines which columns are included when a printout is
"^DD",101.24,101.243,.07,21,2,0)
requested.
"^DD",101.24,101.243,.07,"DT")
3010628
"^DD",101.24,101.243,.08,0)
PRINT TITLE^F^^0;8^K:$L(X)>20!($L(X)<1) X
"^DD",101.24,101.243,.08,3)
Answer must be 1-20 characters in length.
"^DD",101.24,101.243,.08,21,0)
^^1^1^3010628^
"^DD",101.24,101.243,.08,21,1,0)
This field is used when printing this field in lieu of the Column Header.
"^DD",101.24,101.243,.08,"DT")
3010628
"^DD",101.24,101.243,.09,0)
DATA TYPE^S^0:FREE TEXT;1:NUMERIC;2:DATE/TIME;^0;9^Q
"^DD",101.24,101.243,.09,3)
Enter the type of data that is in this column.
"^DD",101.24,101.243,.09,21,0)
^.001^3^3^3010718^^
"^DD",101.24,101.243,.09,21,1,0)
This is the data type of the column.  It is used when sorting columns.
"^DD",101.24,101.243,.09,21,2,0)
The default data type is 0 - FREE TEXT.  If no value is entered, it is
"^DD",101.24,101.243,.09,21,3,0)
assumed to be FREE TEXT.
"^DD",101.24,101.243,.09,"DT")
3010718
"^DD",101.24,101.243,.1,0)
WIDTH^NJ4,0^^0;10^K:+X'=X!(X>4000)!(X<-2)!(X?.E1"."1N.N) X
"^DD",101.24,101.243,.1,3)
Type a Number between -2 and 4000, 0 Decimal Digits
"^DD",101.24,101.243,.1,21,0)
^^5^5^3010727^
"^DD",101.24,101.243,.1,21,1,0)
This field is for the column width.  No value needs to be entered because
"^DD",101.24,101.243,.1,21,2,0)
the value is actually obtained from a User level parameter.  The field
"^DD",101.24,101.243,.1,21,3,0)
is defined here to reserve the 10 piece of this node so that future
"^DD",101.24,101.243,.1,21,4,0)
field definitions won't break the RPC used in CPRS to get column properties
"^DD",101.24,101.243,.1,21,5,0)
where the width is stored in the 10 piece.
"^DD",101.24,101.243,.1,"DT")
3010727
"^DD",101.24,101.243,1,0)
HDR MODIFIER^K^^1;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.24,101.243,1,3)
This is Standard MUMPS code.
"^DD",101.24,101.243,1,9)
@
"^DD",101.24,101.243,1,21,0)
^^5^5^3051006^
"^DD",101.24,101.243,1,21,1,0)
This is code executed when HDR data needs to be modified.
"^DD",101.24,101.243,1,21,2,0)
When this field is executed, the variable ORX will have the value
"^DD",101.24,101.243,1,21,3,0)
passed in from the HDR.  If this value needs to be manipulated, set the
"^DD",101.24,101.243,1,21,4,0)
new value into ORX.  If the value is ignored (not to be displayed),
"^DD",101.24,101.243,1,21,5,0)
then set the value of ORX="-1-"
"^DD",101.24,101.243,1,"DT")
3051006
"^DD",101.41,101.41,0)
FIELD^^99^30
"^DD",101.41,101.41,0,"DDA")
N
"^DD",101.41,101.41,0,"DT")
2980501
"^DD",101.41,101.41,0,"IX","AB",101.41,.01)

"^DD",101.41,101.41,0,"IX","AD",101.412,2)

"^DD",101.41,101.41,0,"IX","AM",101.41,99)

"^DD",101.41,101.41,0,"IX","AM2",101.41,2)

"^DD",101.41,101.41,0,"IX","AM51",101.41,51)

"^DD",101.41,101.41,0,"IX","AM52",101.41,52)

"^DD",101.41,101.41,0,"IX","AMM",101.412,.01)

"^DD",101.41,101.41,0,"IX","AMM2",101.412,2)

"^DD",101.41,101.41,0,"IX","AMM3",101.412,3)

"^DD",101.41,101.41,0,"IX","AMM4",101.412,4)

"^DD",101.41,101.41,0,"IX","AMM5",101.412,5)

"^DD",101.41,101.41,0,"IX","APKG",101.41,7)

"^DD",101.41,101.41,0,"IX","C",101.41,2)

"^DD",101.41,101.41,0,"NM","ORDER DIALOG")

"^DD",101.41,101.41,0,"PT",100,2)

"^DD",101.41,101.41,0,"PT",100,7)

"^DD",101.41,101.41,0,"PT",100.045,.02)

"^DD",101.41,101.41,0,"PT",100.5,4)

"^DD",101.41,101.41,0,"PT",100.5,5)

"^DD",101.41,101.41,0,"PT",100.98,4)

"^DD",101.41,101.41,0,"PT",101.412,1)

"^DD",101.41,101.41,0,"PT",101.412,2)

"^DD",101.41,101.41,0,"PT",101.415,2)

"^DD",101.41,101.41,0,"PT",101.416,.02)

"^DD",101.41,101.41,0,"PT",101.441,.01)

"^DD",101.41,101.41,0,"PT",801.41,15)

"^DD",101.41,101.41,0,"PT",801.4118,.01)

"^DD",101.41,101.41,0,"VRPK")
OR
"^DD",101.41,101.41,.01,0)
NAME^RF^^0;1^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>63!($L(X)<3)!'(X'?1P.E) X
"^DD",101.41,101.41,.01,1,0)
^.1^^-1
"^DD",101.41,101.41,.01,1,2,0)
101.41^AB
"^DD",101.41,101.41,.01,1,2,1)
S ^ORD(101.41,"AB",$E(X,1,63),DA)=""
"^DD",101.41,101.41,.01,1,2,2)
K ^ORD(101.41,"AB",$E(X,1,63),DA)
"^DD",101.41,101.41,.01,1,2,"%D",0)
^^1^1^2971020^
"^DD",101.41,101.41,.01,1,2,"%D",1,0)
This is a regular index on the full 63 characters of the Name field.
"^DD",101.41,101.41,.01,1,2,"DT")
2971020
"^DD",101.41,101.41,.01,3)
Answer must be 3-63 characters in length.
"^DD",101.41,101.41,.01,21,0)
^^3^3^2971219^
"^DD",101.41,101.41,.01,21,1,0)
This is the name of the dialog; entries that were converted from the
"^DD",101.41,101.41,.01,21,2,0)
Protocol file will retain the same name.  Namespacing is not required,
"^DD",101.41,101.41,.01,21,3,0)
but still encouraged.
"^DD",101.41,101.41,.01,"DT")
2971020
"^DD",101.41,101.41,2,0)
DISPLAY TEXT^FX^^0;2^K:$L(X)>80!($L(X)<3)!($$CHKNAM^ORUTL(X)) X
"^DD",101.41,101.41,2,1,0)
^.1
"^DD",101.41,101.41,2,1,1,0)
101.41^C
"^DD",101.41,101.41,2,1,1,1)
S ^ORD(101.41,"C",$$UP^XLFSTR($E(X,1,63)),DA)=""
"^DD",101.41,101.41,2,1,1,2)
K ^ORD(101.41,"C",$$UP^XLFSTR($E(X,1,63)),DA)
"^DD",101.41,101.41,2,1,1,"DT")
2950112
"^DD",101.41,101.41,2,1,2,0)
101.41^AM2^MUMPS
"^DD",101.41,101.41,2,1,2,1)
D REDOM^ORDD41
"^DD",101.41,101.41,2,1,2,2)
D REDOM^ORDD41
"^DD",101.41,101.41,2,1,2,"%D",0)
^^1^1^2990210^
"^DD",101.41,101.41,2,1,2,"%D",1,0)
Update TIMESTAMP whenever DISPLAY TEXT is changed.
"^DD",101.41,101.41,2,1,2,"DT")
2990210
"^DD",101.41,101.41,2,3)
Answer must be 3-80 characters in length and cannot contain a semicolon (;), a comma (,), an up-arrow (^), a dash (-), or an equal sign (=). 
"^DD",101.41,101.41,2,21,0)
^.001^1^1^3010913^^^^
"^DD",101.41,101.41,2,21,1,0)
The text of this dialog's name as it appears on a menu or subheader.
"^DD",101.41,101.41,2,"DT")
3000823
"^DD",101.41,101.41,3,0)
DISABLE^F^^0;3^K:$L(X)>40!($L(X)<1) X
"^DD",101.41,101.41,3,3)
Enter a message here to disable this dialog, 1-40 characters in length.
"^DD",101.41,101.41,3,21,0)
^^3^3^2950112^
"^DD",101.41,101.41,3,21,1,0)
This field disables use of this dialog when it contains text.  The text
"^DD",101.41,101.41,3,21,2,0)
should be a short message explaining why use of this dialog has been
"^DD",101.41,101.41,3,21,3,0)
disabled, as it will be displayed if this dialog is selected.
"^DD",101.41,101.41,3,"DT")
2950112
"^DD",101.41,101.41,4,0)
TYPE^RS^P:prompt;D:dialog;Q:quick order;O:order set;M:menu;A:action;^0;4^Q
"^DD",101.41,101.41,4,3)
Specify a type for this dialog.
"^DD",101.41,101.41,4,21,0)
^^5^5^2950716^^^^
"^DD",101.41,101.41,4,21,1,0)
This field defines the type of order dialog to be processed.  Control
"^DD",101.41,101.41,4,21,2,0)
will be passed to the OE/RR Dialog Processor for dialog items; menu types
"^DD",101.41,101.41,4,21,3,0)
are used for displaying and selecting dialog items.  Action types will only
"^DD",101.41,101.41,4,21,4,0)
execute the entry and exit actions, ignoring any items that may exist; these
"^DD",101.41,101.41,4,21,5,0)
dialogs should not create entries in the Orders file.
"^DD",101.41,101.41,4,"DT")
2950716
"^DD",101.41,101.41,5,0)
DISPLAY GROUP^P100.98'^ORD(100.98,^0;5^Q
"^DD",101.41,101.41,5,3)
Enter the display group containing orderable items defined by this dialog.
"^DD",101.41,101.41,5,21,0)
^^3^3^2950112^
"^DD",101.41,101.41,5,21,1,0)
This field determines what display group this dialog has been defined for.
"^DD",101.41,101.41,5,21,2,0)
It will define which orderable items are selectable with this dialog,
"^DD",101.41,101.41,5,21,3,0)
as well as what service to send the order to when it is complete.
"^DD",101.41,101.41,5,"DT")
2950112
"^DD",101.41,101.41,6,0)
SIGNATURE REQUIRED^S^0:NONE;1:ORELSE;2:ORES;^0;6^Q
"^DD",101.41,101.41,6,3)
Enter the OR key required to sign orders created by this dialog
"^DD",101.41,101.41,6,21,0)
^^6^6^2970318^^
"^DD",101.41,101.41,6,21,1,0)
This field indicates what signature will be required for orders created by
"^DD",101.41,101.41,6,21,2,0)
this dialog, to be considered complete and ready to release to the service
"^DD",101.41,101.41,6,21,3,0)
for action.  If this flag is set to NO and the dialog contains a prompt
"^DD",101.41,101.41,6,21,4,0)
for item(s) from the Orderable Item file, the order created may still
"^DD",101.41,101.41,6,21,5,0)
require a signature if any of the items ordered are individually flagged
"^DD",101.41,101.41,6,21,6,0)
as requiring a signature.
"^DD",101.41,101.41,6,"DT")
2970318
"^DD",101.41,101.41,7,0)
PACKAGE^P9.4'^DIC(9.4,^0;7^Q
"^DD",101.41,101.41,7,1,0)
^.1
"^DD",101.41,101.41,7,1,1,0)
101.41^APKG
"^DD",101.41,101.41,7,1,1,1)
S ^ORD(101.41,"APKG",$E(X,1,30),DA)=""
"^DD",101.41,101.41,7,1,1,2)
K ^ORD(101.41,"APKG",$E(X,1,30),DA)
"^DD",101.41,101.41,7,1,1,"DT")
2970325
"^DD",101.41,101.41,7,3)
Enter the VISTA package that is to receive orders created by this dialog.
"^DD",101.41,101.41,7,21,0)
^^3^3^2950208^
"^DD",101.41,101.41,7,21,1,0)
This is the VISTA package that is intended to receive orders created by
"^DD",101.41,101.41,7,21,2,0)
this dialog; this is required for creating the HL7 messages to pass the
"^DD",101.41,101.41,7,21,3,0)
order.
"^DD",101.41,101.41,7,"DT")
2970325
"^DD",101.41,101.41,8,0)
VERIFY ORDER^S^1:YES;0:NO;^0;8^Q
"^DD",101.41,101.41,8,3)
Enter YES to have orders created by this dialog presented to the user before saving, with the opportunity to edit.
"^DD",101.41,101.41,8,21,0)
^^3^3^2950623^
"^DD",101.41,101.41,8,21,1,0)
This field is a flag, which determines if the order created by this dialog
"^DD",101.41,101.41,8,21,2,0)
will be presented to the user for verification before saving in the Orders
"^DD",101.41,101.41,8,21,3,0)
file; for most quick orders, this flag should be set to 0 (no).
"^DD",101.41,101.41,8,"DT")
2950623
"^DD",101.41,101.41,9,0)
ASK FOR ANOTHER ORDER^S^0:NO;1:YES;2:YES-DON'T ASK;^0;9^Q
"^DD",101.41,101.41,9,3)
Enter YES to have the user asked to enter another order from this dialog before exiting.
"^DD",101.41,101.41,9,21,0)
^^6^6^2970616^^^
"^DD",101.41,101.41,9,21,1,0)
This field allows the user to add another order from this dialog, when the
"^DD",101.41,101.41,9,21,2,0)
initial order is accepted and placed; if set to YES, the user will be
"^DD",101.41,101.41,9,21,3,0)
asked "Add another <dialog display text> order?" to allow for either
"^DD",101.41,101.41,9,21,4,0)
exiting the processor or adding an additional order of the same type.
"^DD",101.41,101.41,9,21,5,0)
This field can also be set to YES-DON'T ASK to force the processor to
"^DD",101.41,101.41,9,21,6,0)
automatically drop into prompting for another order without asking first.
"^DD",101.41,101.41,9,"DT")
2970616
"^DD",101.41,101.41,10,0)
ITEMS^101.412IA^^10;0
"^DD",101.41,101.41,10,21,0)
^^5^5^2990211^^^^
"^DD",101.41,101.41,10,21,1,0)
This field contains the components for dialogs:
"^DD",101.41,101.41,10,21,2,0)
     Dialogs      -> prompts
"^DD",101.41,101.41,10,21,3,0)
     Quick orders -> prompts (completed)
"^DD",101.41,101.41,10,21,4,0)
     Order sets   -> dialogs or quick orders
"^DD",101.41,101.41,10,21,5,0)
     Menus        -> dialogs, quick orders, or order sets
"^DD",101.41,101.41,11,0)
DATA TYPE^S^D:date/time;R:free text date/time;F:free text;N:numeric;S:set of codes;Y:yes/no;P:pointer;W:word processing;^1;1^Q
"^DD",101.41,101.41,11,3)
Enter the type of data to be collected at this prompt.
"^DD",101.41,101.41,11,21,0)
^^2^2^2950823^^
"^DD",101.41,101.41,11,21,1,0)
This is the type of data being prompted for; this field is used to define
"^DD",101.41,101.41,11,21,2,0)
a call to the reader (^DIR) in most cases.
"^DD",101.41,101.41,11,23,0)
^^1^1^2950823^^
"^DD",101.41,101.41,11,23,1,0)
Used with Prompt-type only.
"^DD",101.41,101.41,11,"DT")
2950407
"^DD",101.41,101.41,12,0)
DOMAIN^F^^1;2^K:$L(X)>235!($L(X)<1) X
"^DD",101.41,101.41,12,3)
Answer must be 1-235 characters in length.
"^DD",101.41,101.41,12,21,0)
^^3^3^2990225^^^^
"^DD",101.41,101.41,12,21,1,0)
This is a parameter that may be used to further specify the data type.
"^DD",101.41,101.41,12,21,2,0)
The string stored here should be appropriate for the second ^-piece of
"^DD",101.41,101.41,12,21,3,0)
DIR(0) when used with the data type field.
"^DD",101.41,101.41,12,23,0)
^^1^1^2990225^^^^
"^DD",101.41,101.41,12,23,1,0)
Used with Prompt-type only.
"^DD",101.41,101.41,12,"DT")
2990225
"^DD",101.41,101.41,13,0)
ID^F^^1;3^K:$L(X)>10!($L(X)<2) X
"^DD",101.41,101.41,13,3)
Answer must be 2-10 characters in length.
"^DD",101.41,101.41,13,21,0)
^.001^20^20^3010727^^
"^DD",101.41,101.41,13,21,1,0)
This field may contain a single word identifier which will be
"^DD",101.41,101.41,13,21,2,0)
stored with the user response in the Orders file #100, where it
"^DD",101.41,101.41,13,21,3,0)
will be indexed for quick reference to certain values in the
"^DD",101.41,101.41,13,21,4,0)
order dialog.  The following are some examples of values
"^DD",101.41,101.41,13,21,5,0)
currently in use:
"^DD",101.41,101.41,13,21,6,0)
 
"^DD",101.41,101.41,13,21,7,0)
   START      -> Start date/time
"^DD",101.41,101.41,13,21,8,0)
   STOP       -> Stop date/time
"^DD",101.41,101.41,13,21,9,0)
   SCHEDULE   -> Administration Schedule
"^DD",101.41,101.41,13,21,10,0)
   ORDERABLE  -> Orderable Item
"^DD",101.41,101.41,13,21,11,0)
   DRUG       -> Dispense Drug
"^DD",101.41,101.41,13,21,12,0)
   CANCEL     -> Cancel Future Orders flag
"^DD",101.41,101.41,13,21,13,0)
   COMMENT    -> Word processing comments
"^DD",101.41,101.41,13,21,14,0)
 
"^DD",101.41,101.41,13,21,15,0)
These values must be unique among entries within an order dialog
"^DD",101.41,101.41,13,21,16,0)
but do not need to be unique across the entire file.  Be sure to
"^DD",101.41,101.41,13,21,17,0)
check the IDs assigned to generic text entries to make sure that
"^DD",101.41,101.41,13,21,18,0)
all IDs are unique.  In order to avoid potential problems it's
"^DD",101.41,101.41,13,21,19,0)
recommended that you use unique IDs for any local entries that you
"^DD",101.41,101.41,13,21,20,0)
create.
"^DD",101.41,101.41,13,"DT")
2960215
"^DD",101.41,101.41,17,0)
VALIDATION^K^^7;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.41,17,3)
This is Standard MUMPS code.
"^DD",101.41,101.41,17,9)
@
"^DD",101.41,101.41,17,21,0)
^^3^3^2960912^
"^DD",101.41,101.41,17,21,1,0)
This is MUMPS code that will be executed at the time of releasing an
"^DD",101.41,101.41,17,21,2,0)
order created with this dialog; dialog responses may be checked again
"^DD",101.41,101.41,17,21,3,0)
here before releasing the order to the service.
"^DD",101.41,101.41,17,"DT")
2960912
"^DD",101.41,101.41,19,0)
ADDITIONAL TEXT^K^^9;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.41,19,3)
This is Standard MUMPS code.
"^DD",101.41,101.41,19,9)
@
"^DD",101.41,101.41,19,21,0)
^^3^3^2960405^^
"^DD",101.41,101.41,19,21,1,0)
This is MUMPS code that will be executed when order ORIFN created by this
"^DD",101.41,101.41,19,21,2,0)
dialog is about to be displayed; any string that should be appended to the
"^DD",101.41,101.41,19,21,3,0)
order text should be returned in Y.
"^DD",101.41,101.41,19,"DT")
2960405
"^DD",101.41,101.41,20,0)
DESCRIPTION^101.411^^2;0
"^DD",101.41,101.41,20,21,0)
^^1^1^2971219^
"^DD",101.41,101.41,20,21,1,0)
This is a description of the dialog and its uses.
"^DD",101.41,101.41,21,0)
RESPONSES^101.416^^6;0
"^DD",101.41,101.41,21,21,0)
^^2^2^2971219^
"^DD",101.41,101.41,21,21,1,0)
This multiple contains any responses to prompts that have been pre-answered
"^DD",101.41,101.41,21,21,2,0)
to create a quick order.
"^DD",101.41,101.41,30,0)
ENTRY ACTION^K^^3;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.41,30,3)
This is Standard MUMPS code.
"^DD",101.41,101.41,30,9)
@
"^DD",101.41,101.41,30,21,0)
^^4^4^2950425^
"^DD",101.41,101.41,30,21,1,0)
This is MUMPS code that will be executed at the top of a dialog, prior to
"^DD",101.41,101.41,30,21,2,0)
the execution of any prompts; it may perform functions such as listing
"^DD",101.41,101.41,30,21,3,0)
the recent Radiology exams before ordering a new one, or alerting the
"^DD",101.41,101.41,30,21,4,0)
user to an existing diet order before making a change.
"^DD",101.41,101.41,30,"DT")
2950425
"^DD",101.41,101.41,31,0)
QUICK SETUP^K^^3.1;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.41,31,3)
This is Standard MUMPS code.
"^DD",101.41,101.41,31,9)
@
"^DD",101.41,101.41,31,21,0)
^^3^3^2970113^
"^DD",101.41,101.41,31,21,1,0)
This is MUMPS code that will be executed in the place of the Entry Action
"^DD",101.41,101.41,31,21,2,0)
when creating quick orders for this dialog; variables may be set here
"^DD",101.41,101.41,31,21,3,0)
instead to bypass the usual dependence on specific patient values.
"^DD",101.41,101.41,31,"DT")
2970113
"^DD",101.41,101.41,40,0)
EXIT ACTION^K^^4;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.41,40,3)
This is Standard MUMPS code.
"^DD",101.41,101.41,40,9)
@
"^DD",101.41,101.41,40,21,0)
^^2^2^2950622^
"^DD",101.41,101.41,40,21,1,0)
This is MUMPS code that will be executed upon completion of processing the
"^DD",101.41,101.41,40,21,2,0)
dialog; it is currently used only with dialog-type entries.
"^DD",101.41,101.41,40,"DT")
2950622
"^DD",101.41,101.41,50,0)
CONTROLS^101.415A^^50;0
"^DD",101.41,101.41,51,0)
COLUMN WIDTH^NJ3,0^^5;1^K:+X'=X!(X>240)!(X<20)!(X?.E1"."1N.N) X
"^DD",101.41,101.41,51,1,0)
^.1
"^DD",101.41,101.41,51,1,1,0)
101.41^AM51^MUMPS
"^DD",101.41,101.41,51,1,1,1)
D REDO^ORDD41
"^DD",101.41,101.41,51,1,1,2)
D REDO^ORDD41
"^DD",101.41,101.41,51,1,1,"%D",0)
^^1^1^2990210^
"^DD",101.41,101.41,51,1,1,"%D",1,0)
Update TIMESTAMP whenever COLUMN WIDTH is changed.
"^DD",101.41,101.41,51,1,1,"DT")
2990210
"^DD",101.41,101.41,51,3)
Type a Number between 20 and 240, 0 Decimal Digits
"^DD",101.41,101.41,51,21,0)
^^2^2^2950623^
"^DD",101.41,101.41,51,21,1,0)
This is the width, in characters, for each column in a menu.  For example,
"^DD",101.41,101.41,51,21,2,0)
to have 3 columns on an 80 character device, enter a width of 26.
"^DD",101.41,101.41,51,"DT")
2990210
"^DD",101.41,101.41,52,0)
MNEMONIC WIDTH^NJ1,0^^5;2^K:+X'=X!(X>9)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.41,101.41,52,1,0)
^.1
"^DD",101.41,101.41,52,1,1,0)
101.41^AM52^MUMPS
"^DD",101.41,101.41,52,1,1,1)
D REDO^ORDD41
"^DD",101.41,101.41,52,1,1,2)
D REDO^ORDD41
"^DD",101.41,101.41,52,1,1,"%D",0)
^^1^1^2990210^
"^DD",101.41,101.41,52,1,1,"%D",1,0)
Update TIMESTAMP whenever MNEMONIC WIDTH is changed.
"^DD",101.41,101.41,52,1,1,"DT")
2990210
"^DD",101.41,101.41,52,3)
Type a Number between 1 and 9, 0 Decimal Digits
"^DD",101.41,101.41,52,21,0)
^^2^2^2950623^
"^DD",101.41,101.41,52,21,1,0)
This field allows the width of item mnemonics to be varied; the default
"^DD",101.41,101.41,52,21,2,0)
value is 5.
"^DD",101.41,101.41,52,"DT")
2990210
"^DD",101.41,101.41,53,0)
PATH SWITCH^S^1:YES;0:NO;^5;3^Q
"^DD",101.41,101.41,53,3)
Enter YES if this menu should be redisplayed when traversing back up the menu tree.
"^DD",101.41,101.41,53,21,0)
^^5^5^2950623^
"^DD",101.41,101.41,53,21,1,0)
This switch allows the user, when traversing back UP the tree of menus and
"^DD",101.41,101.41,53,21,2,0)
items, to select a new path back down the tree.  In other words, the menu
"^DD",101.41,101.41,53,21,3,0)
is redisplayed when returning to that menu's level in the tree and
"^DD",101.41,101.41,53,21,4,0)
processing back down the tree is possible from that point.  If nothing is
"^DD",101.41,101.41,53,21,5,0)
selected from the menu, the path continues back up the tree.
"^DD",101.41,101.41,53,"DT")
2950623
"^DD",101.41,101.41,54,0)
LISTBOX TEXT^F^^5;4^K:$L(X)>30!($L(X)<1) X
"^DD",101.41,101.41,54,3)
Answer must be 1-30 characters in length.
"^DD",101.41,101.41,54,"DT")
2960524
"^DD",101.41,101.41,55,0)
WINDOW FORM ID^NJ4,0^^5;5^K:+X'=X!(X>9999)!(X<0)!(X?.E1"."1N.N) X
"^DD",101.41,101.41,55,3)
Type a Number between 0 and 9999, 0 Decimal Digits
"^DD",101.41,101.41,55,21,0)
^.001^23^23^3010727^^
"^DD",101.41,101.41,55,21,1,0)
This field tells the GUI DELPHI code which form to use to process the
"^DD",101.41,101.41,55,21,2,0)
order dialog.  Each number represents a unique form.  Following are some
"^DD",101.41,101.41,55,21,3,0)
of the more common codes and their corresponding form in DELPHI.
"^DD",101.41,101.41,55,21,4,0)
 
"^DD",101.41,101.41,55,21,5,0)
    Form Name     Windows Form ID
"^DD",101.41,101.41,55,21,6,0)
    ---------     ---------------
"^DD",101.41,101.41,55,21,7,0)
  OD_ACTIVITY           100
"^DD",101.41,101.41,55,21,8,0)
  OD_ALLERGY            105
"^DD",101.41,101.41,55,21,9,0)
  OD_CONSULT            110
"^DD",101.41,101.41,55,21,10,0)
  OD_PROCEDURE          112
"^DD",101.41,101.41,55,21,11,0)
  OD_DIET_TXT           115
"^DD",101.41,101.41,55,21,12,0)
  OD_DIET               117
"^DD",101.41,101.41,55,21,13,0)
  OD_LAB                120
"^DD",101.41,101.41,55,21,14,0)
  OD_MEDINPT            130
"^DD",101.41,101.41,55,21,15,0)
  OD_MEDS               135
"^DD",101.41,101.41,55,21,16,0)
  OD_MEDOUTPT           140
"^DD",101.41,101.41,55,21,17,0)
  OD_NURSING            150
"^DD",101.41,101.41,55,21,18,0)
  OD_MISC               151
"^DD",101.41,101.41,55,21,19,0)
  OD_GENERIC            152
"^DD",101.41,101.41,55,21,20,0)
  OD_IMAGING            160
"^DD",101.41,101.41,55,21,21,0)
  OD_VITALS             171 
"^DD",101.41,101.41,55,21,22,0)
  OD_MEDIV              180
"^DD",101.41,101.41,55,21,23,0)
  OD_TEXTONLY           999
"^DD",101.41,101.41,55,"DT")
2960804
"^DD",101.41,101.41,56,0)
CREATE PARENT ORDER^S^1:YES;0:NO;^5;6^Q
"^DD",101.41,101.41,56,3)
Enter YES if a parent order should be created for this order set
"^DD",101.41,101.41,56,21,0)
^^6^6^2970227^
"^DD",101.41,101.41,56,21,1,0)
This flag indicates whether a parent order should be created to group
"^DD",101.41,101.41,56,21,2,0)
together all the orders created by this order set; this flag is only
"^DD",101.41,101.41,56,21,3,0)
valid with SET type order dialogs.  If this value is YES, a parent
"^DD",101.41,101.41,56,21,4,0)
order will be created, and only the parent will be presented on the
"^DD",101.41,101.41,56,21,5,0)
orders list for display and action; NO will prevent a parent from being
"^DD",101.41,101.41,56,21,6,0)
created and all orders will be created and displayed independently.
"^DD",101.41,101.41,56,"DT")
2970227
"^DD",101.41,101.41,57,0)
DISPLAY SUBHEADER^S^1:YES;0:NO;^5;7^Q
"^DD",101.41,101.41,57,3)
Enter YES if a subheader should be displayed as each order in this set is processed
"^DD",101.41,101.41,57,21,0)
^^3^3^2970227^
"^DD",101.41,101.41,57,21,1,0)
This flag indicates whether a subheader is to be displayed for each order
"^DD",101.41,101.41,57,21,2,0)
in this set as it is processed and placed; this flag is only valid with
"^DD",101.41,101.41,57,21,3,0)
SET type order dialogs.
"^DD",101.41,101.41,57,"DT")
2970227
"^DD",101.41,101.41,58,0)
AUTO-ACCEPT QUICK ORDER^S^1:YES;^5;8^Q
"^DD",101.41,101.41,58,3)
Enter 'Yes' if the order should be placed without displaying the dialog window.
"^DD",101.41,101.41,58,21,0)
^^2^2^2980902^
"^DD",101.41,101.41,58,21,1,0)
This can be set to yes for a quick order so that it can be placed simply
"^DD",101.41,101.41,58,21,2,0)
by clicking on it in the GUI (no ordering dialog is displayed).
"^DD",101.41,101.41,58,"DT")
2980902
"^DD",101.41,101.41,99,0)
TIMESTAMP^F^^99;1^K:$L(X)>15!($L(X)<1) X
"^DD",101.41,101.41,99,1,0)
^.1
"^DD",101.41,101.41,99,1,1,0)
101.41^AM^MUMPS
"^DD",101.41,101.41,99,1,1,1)
D SET^ORDD41(DA)
"^DD",101.41,101.41,99,1,1,2)
D KILL^ORDD41(DA)
"^DD",101.41,101.41,99,1,1,"%D",0)
^^2^2^2990210^
"^DD",101.41,101.41,99,1,1,"%D",1,0)
Recompiles order dialog menus in ^XUTL("XQORM",<dialog#>_";ORD(101.41,")
"^DD",101.41,101.41,99,1,1,"%D",2,0)
whenever fields necessary to displaying the menu are changed.
"^DD",101.41,101.41,99,1,1,"DT")
2990210
"^DD",101.41,101.41,99,3)
Answer must be 1-15 characters in length.
"^DD",101.41,101.41,99,21,0)
^^2^2^2980501^
"^DD",101.41,101.41,99,21,1,0)
For menus, this contains the $H time the menu was last compiled for use
"^DD",101.41,101.41,99,21,2,0)
with the Unwinder utility (^XQOR).
"^DD",101.41,101.41,99,"DT")
2990210
"^DD",101.41,101.411,0)
DESCRIPTION SUB-FIELD^^.01^1
"^DD",101.41,101.411,0,"DT")
2950407
"^DD",101.41,101.411,0,"NM","DESCRIPTION")

"^DD",101.41,101.411,0,"UP")
101.41
"^DD",101.41,101.411,.01,0)
DESCRIPTION^W^^0;1^Q
"^DD",101.41,101.411,.01,3)
Enter a description of this dialog.
"^DD",101.41,101.411,.01,21,0)
^^1^1^2950425^^
"^DD",101.41,101.411,.01,21,1,0)
This field contains a description of the content and use of this dialog.
"^DD",101.41,101.411,.01,"DT")
2950407
"^DD",101.41,101.412,0)
ITEMS SUB-FIELD^^117^37
"^DD",101.41,101.412,0,"DT")
2971117
"^DD",101.41,101.412,0,"ID","WRITE")
N OR0,ORNM S OR0=^(0) I $P(OR0,U,2) S ORNM=$P($G(^ORD(101.41,+$P(OR0,U,2),0)),U) D:$L(ORNM) EN^DDIOL(ORNM,,"?10")
"^DD",101.41,101.412,0,"IX","ATXT",101.412,21)

"^DD",101.41,101.412,0,"IX","B",101.412,.01)

"^DD",101.41,101.412,0,"IX","D",101.412,2)

"^DD",101.41,101.412,0,"IX","DAD",101.412,1)

"^DD",101.41,101.412,0,"IX","DAD1",101.412,.01)

"^DD",101.41,101.412,0,"NM","ITEMS")

"^DD",101.41,101.412,0,"UP")
101.41
"^DD",101.41,101.412,.01,0)
SEQUENCE^MNJ5,1^^0;1^K:+X'=X!(X>999.9)!(X<.1)!(X?.E1"."2N.N) X
"^DD",101.41,101.412,.01,1,0)
^.1
"^DD",101.41,101.412,.01,1,1,0)
101.412^B
"^DD",101.41,101.412,.01,1,1,1)
S ^ORD(101.41,DA(1),10,"B",$E(X,1,30),DA)=""
"^DD",101.41,101.412,.01,1,1,2)
K ^ORD(101.41,DA(1),10,"B",$E(X,1,30),DA)
"^DD",101.41,101.412,.01,1,2,0)
101.412^DAD1^MUMPS
"^DD",101.41,101.412,.01,1,2,1)
N ORP S ORP=$P(^ORD(101.41,DA(1),10,DA,0),U,11) S:ORP ^ORD(101.41,DA(1),10,"DAD",ORP,X,DA)=""
"^DD",101.41,101.412,.01,1,2,2)
N ORP S ORP=$P(^ORD(101.41,DA(1),10,DA,0),U,11) K:ORP ^ORD(101.41,DA(1),10,"DAD",ORP,X,DA)
"^DD",101.41,101.412,.01,1,2,"%D",0)
^^1^1^2950511^
"^DD",101.41,101.412,.01,1,2,"%D",1,0)
Allows retrieval of 'child' prompts in sequence by parent.
"^DD",101.41,101.412,.01,1,2,"DT")
2950511
"^DD",101.41,101.412,.01,1,3,0)
101.41^AMM^MUMPS
"^DD",101.41,101.412,.01,1,3,1)
D REDOX^ORDD41
"^DD",101.41,101.412,.01,1,3,2)
D REDOX^ORDD41
"^DD",101.41,101.412,.01,1,3,"%D",0)
^^1^1^2990210^
"^DD",101.41,101.412,.01,1,3,"%D",1,0)
Update TIMESTAMP whenever SEQUENCE is changed.
"^DD",101.41,101.412,.01,1,3,"DT")
2990210
"^DD",101.41,101.412,.01,3)
Type a Number between .1 and 999.9, 1 Decimal Digit
"^DD",101.41,101.412,.01,21,0)
^^2^2^2971117^^^^
"^DD",101.41,101.412,.01,21,1,0)
This field specifies the order in which this item will be displayed or
"^DD",101.41,101.412,.01,21,2,0)
processed.
"^DD",101.41,101.412,.01,"DT")
2990210
"^DD",101.41,101.412,.1,0)
INPUT TRANSFORM^K^^.1;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,.1,3)
This is Standard MUMPS code.
"^DD",101.41,101.412,.1,9)
@
"^DD",101.41,101.412,.1,21,0)
^^2^2^2950816^
"^DD",101.41,101.412,.1,21,1,0)
This is code that will be used as the third piece of DIR(0) when asking
"^DD",101.41,101.412,.1,21,2,0)
this prompt.
"^DD",101.41,101.412,.1,"DT")
2950816
"^DD",101.41,101.412,1,0)
PARENT^P101.41'^ORD(101.41,^0;11^Q
"^DD",101.41,101.412,1,1,0)
^.1
"^DD",101.41,101.412,1,1,1,0)
101.412^DAD^MUMPS
"^DD",101.41,101.412,1,1,1,1)
S ^ORD(101.41,DA(1),10,"DAD",X,$P(^ORD(101.41,DA(1),10,DA,0),U),DA)=""
"^DD",101.41,101.412,1,1,1,2)
K ^ORD(101.41,DA(1),10,"DAD",X,$P(^ORD(101.41,DA(1),10,DA,0),U),DA)
"^DD",101.41,101.412,1,1,1,"%D",0)
^^1^1^2950511^^
"^DD",101.41,101.412,1,1,1,"%D",1,0)
Allows retrieval of 'child' prompts in sequence by parent.
"^DD",101.41,101.412,1,1,1,"DT")
2950511
"^DD",101.41,101.412,1,3)
If this prompt is subordinate to another in this dialog, enter the parent prompt here
"^DD",101.41,101.412,1,21,0)
^^4^4^2950511^
"^DD",101.41,101.412,1,21,1,0)
This field controls the behavior of this prompt.  If a parent is defined
"^DD",101.41,101.412,1,21,2,0)
here, this prompt will be asked from within the parent's dialog; when it
"^DD",101.41,101.412,1,21,3,0)
is invoked independently based on its position sequence number, the child
"^DD",101.41,101.412,1,21,4,0)
prompt will be ignored.
"^DD",101.41,101.412,1,"DT")
2950511
"^DD",101.41,101.412,2,0)
ITEM^P101.41'X^ORD(101.41,^0;2^D TREE^ORDD41
"^DD",101.41,101.412,2,1,0)
^.1
"^DD",101.41,101.412,2,1,1,0)
101.41^AD
"^DD",101.41,101.412,2,1,1,1)
S ^ORD(101.41,"AD",$E(X,1,30),DA(1),DA)=""
"^DD",101.41,101.412,2,1,1,2)
K ^ORD(101.41,"AD",$E(X,1,30),DA(1),DA)
"^DD",101.41,101.412,2,1,1,"DT")
2950123
"^DD",101.41,101.412,2,1,2,0)
101.412^D
"^DD",101.41,101.412,2,1,2,1)
S ^ORD(101.41,DA(1),10,"D",$E(X,1,30),DA)=""
"^DD",101.41,101.412,2,1,2,2)
K ^ORD(101.41,DA(1),10,"D",$E(X,1,30),DA)
"^DD",101.41,101.412,2,1,2,"DT")
2950411
"^DD",101.41,101.412,2,1,3,0)
101.41^AMM2^MUMPS
"^DD",101.41,101.412,2,1,3,1)
D REDOX^ORDD41
"^DD",101.41,101.412,2,1,3,2)
D REDOX^ORDD41
"^DD",101.41,101.412,2,1,3,"%D",0)
^^1^1^2990210^
"^DD",101.41,101.412,2,1,3,"%D",1,0)
Update TIMESTAMP whenever ITEM is changed.
"^DD",101.41,101.412,2,1,3,"DT")
2990210
"^DD",101.41,101.412,2,3)
Enter an order dialog; a dialog that is an ancestor may not also be a sub-item.
"^DD",101.41,101.412,2,21,0)
^^3^3^2950123^
"^DD",101.41,101.412,2,21,1,0)
This field points to an order dialog which is subordinate to this dialog.
"^DD",101.41,101.412,2,21,2,0)
NOTE:  The parent dialog menu or one of its ancestors may not be entered
"^DD",101.41,101.412,2,21,3,0)
as an item.
"^DD",101.41,101.412,2,"DT")
2990217
"^DD",101.41,101.412,3,0)
MNEMONIC^FX^^0;3^K:$L(X)>4!($L(X)<1)!(+X=X&($L(X,".")>1))!($$CHKMNE^ORUTL(X)) X
"^DD",101.41,101.412,3,1,0)
^.1
"^DD",101.41,101.412,3,1,1,0)
101.41^AMM3^MUMPS
"^DD",101.41,101.412,3,1,1,1)
D REDOX^ORDD41
"^DD",101.41,101.412,3,1,1,2)
D REDOX^ORDD41
"^DD",101.41,101.412,3,1,1,"%D",0)
^^1^1^2990210^
"^DD",101.41,101.412,3,1,1,"%D",1,0)
Update TIMESTAMP whenever MNEMONIC is changed.
"^DD",101.41,101.412,3,1,1,"DT")
2990210
"^DD",101.41,101.412,3,3)
Enter a mnemonic to be used when this dialog is displayed for selection, 1-4 characters in length with no decimal places if numeric. Standard list manager mnemonics may not be used.
"^DD",101.41,101.412,3,21,0)
^.001^2^2^3010727^^^^
"^DD",101.41,101.412,3,21,1,0)
This is a short abbreviation for this item dialog to be used when this
"^DD",101.41,101.412,3,21,2,0)
dialog is displayed for selection.
"^DD",101.41,101.412,3,"DT")
3000822
"^DD",101.41,101.412,4,0)
DISPLAY TEXT^FX^^0;4^K:$L(X)>80!($L(X)<1)!($$CHKNAM^ORUTL(X)) X
"^DD",101.41,101.412,4,1,0)
^.1
"^DD",101.41,101.412,4,1,1,0)
101.41^AMM4^MUMPS
"^DD",101.41,101.412,4,1,1,1)
D REDOX^ORDD41
"^DD",101.41,101.412,4,1,1,2)
D REDOX^ORDD41
"^DD",101.41,101.412,4,1,1,"%D",0)
^^1^1^2990210^
"^DD",101.41,101.412,4,1,1,"%D",1,0)
Update TIMESTAMP whenever DISPLAY TEXT is changed.
"^DD",101.41,101.412,4,1,1,"DT")
2990210
"^DD",101.41,101.412,4,3)
Answer must be 1-80 characters in length and cannot contain a semicolon (;), a comma (,), an up-arrow (^), a dash (-), or an equal sign (=).
"^DD",101.41,101.412,4,21,0)
^.001^2^2^3010419^^^^
"^DD",101.41,101.412,4,21,1,0)
This field allows the text that normally appears for this item to be
"^DD",101.41,101.412,4,21,2,0)
replaced with alternate text for use in this dialog or menu.
"^DD",101.41,101.412,4,"DT")
3000823
"^DD",101.41,101.412,5,0)
DISPLAY ONLY?^S^0:NO;1:YES;2:YES-HEADER;^0;5^Q
"^DD",101.41,101.412,5,1,0)
^.1
"^DD",101.41,101.412,5,1,1,0)
101.41^AMM5^MUMPS
"^DD",101.41,101.412,5,1,1,1)
D REDOX^ORDD41
"^DD",101.41,101.412,5,1,1,2)
D REDOX^ORDD41
"^DD",101.41,101.412,5,1,1,"%D",0)
^^1^1^2990210^
"^DD",101.41,101.412,5,1,1,"%D",1,0)
Update TIMESTAMP whenever DISPLAY ONLY? is changed.
"^DD",101.41,101.412,5,1,1,"DT")
2990210
"^DD",101.41,101.412,5,3)
Enter YES if this item is text for display only and not a selectable item.
"^DD",101.41,101.412,5,21,0)
^^3^3^2970409^^^^
"^DD",101.41,101.412,5,21,1,0)
This field identifies an item as being free text for display purposes
"^DD",101.41,101.412,5,21,2,0)
only.  The text in the Display Text field will be displayed, but it
"^DD",101.41,101.412,5,21,3,0)
is not selectable; if designated as a header, the text will be underlined.
"^DD",101.41,101.412,5,"DT")
2990210
"^DD",101.41,101.412,6,0)
REQUIRED^S^1:YES;0:NO;^0;6^Q
"^DD",101.41,101.412,6,3)
Enter YES if a response to this prompt is mandatory.
"^DD",101.41,101.412,6,21,0)
^^1^1^2950407^
"^DD",101.41,101.412,6,21,1,0)
This field indicates that the user must enter a response to this prompt.
"^DD",101.41,101.412,6,"DT")
2950407
"^DD",101.41,101.412,7,0)
MULTIPLE VALUED^S^1:YES;0:NO;^0;7^Q
"^DD",101.41,101.412,7,3)
Enter YES if this prompt is to be asked multiple times.
"^DD",101.41,101.412,7,21,0)
^^3^3^2950407^
"^DD",101.41,101.412,7,21,1,0)
This field determines if this prompt will be allowed to have multiple
"^DD",101.41,101.412,7,21,2,0)
values, or be prompted for only once; if this prompt is a sub-dialog,
"^DD",101.41,101.412,7,21,3,0)
the entire dialog will be asked once or many times, as a group.
"^DD",101.41,101.412,7,"DT")
2950407
"^DD",101.41,101.412,7.1,0)
MAX NUMBER OF MULTIPLES^NJ2,0^^0;12^K:+X'=X!(X>99)!(X<2)!(X?.E1"."1N.N) X
"^DD",101.41,101.412,7.1,3)
Type a Number between 2 and 99, 0 Decimal Digits
"^DD",101.41,101.412,7.1,21,0)
^^4^4^2950815^
"^DD",101.41,101.412,7.1,21,1,0)
This is the maximum number of values that may be entered for this prompt,
"^DD",101.41,101.412,7.1,21,2,0)
if it is flagged as being multiple-valued.  For example, a diet order may
"^DD",101.41,101.412,7.1,21,3,0)
have up to 5 diet modifications entered, where 5 is the maximum allowed
"^DD",101.41,101.412,7.1,21,4,0)
that would be entered here.
"^DD",101.41,101.412,7.1,"DT")
2950815
"^DD",101.41,101.412,7.2,0)
TITLE^F^^0;13^K:$L(X)>30!($L(X)<3) X
"^DD",101.41,101.412,7.2,3)
Answer must be 3-30 characters in length.
"^DD",101.41,101.412,7.2,21,0)
^^8^8^2970430^^
"^DD",101.41,101.412,7.2,21,1,0)
This is text that will be used in place of the prompt when the order is
"^DD",101.41,101.412,7.2,21,2,0)
displayed for place, edit, or cancel, or at the top of a multiple-valued
"^DD",101.41,101.412,7.2,21,3,0)
prompt.  The Display Text for the prompt will be used together with the
"^DD",101.41,101.412,7.2,21,4,0)
instance number to prompt for user input; for example if Title="Lab Tests:"
"^DD",101.41,101.412,7.2,21,5,0)
and Display Text="Test:" the user would see
"^DD",101.41,101.412,7.2,21,6,0)
  Lab Tests:
"^DD",101.41,101.412,7.2,21,7,0)
  1. Test:
"^DD",101.41,101.412,7.2,21,8,0)
  2. Test:
"^DD",101.41,101.412,7.2,"DT")
2950815
"^DD",101.41,101.412,7.3,0)
PROMPT^F^^0;14^K:$L(X)>10!($L(X)<1) X
"^DD",101.41,101.412,7.3,3)
Answer must be 1-10 characters in length.
"^DD",101.41,101.412,7.3,21,0)
^^3^3^2970618^
"^DD",101.41,101.412,7.3,21,1,0)
This field contains text that will be appended to the beginning of the
"^DD",101.41,101.412,7.3,21,2,0)
display text when prompting for additional values; if this field is
"^DD",101.41,101.412,7.3,21,3,0)
empty, then "Another " will be used.
"^DD",101.41,101.412,7.3,"DT")
2970618
"^DD",101.41,101.412,8,0)
ASK ON EDIT ONLY^S^1:YES;0:NO;^0;8^Q
"^DD",101.41,101.412,8,3)
Enter YES if this prompt should not be asked initially when creating this order, only if the user chooses to edit the order.
"^DD",101.41,101.412,8,21,0)
^^4^4^2960112^^^
"^DD",101.41,101.412,8,21,1,0)
This field determines the behaviour of the dialog driver for this prompt;
"^DD",101.41,101.412,8,21,2,0)
if no value or the defined default is usually correct for this prompt,
"^DD",101.41,101.412,8,21,3,0)
enter YES here to have this prompt skipped on the first pass through this
"^DD",101.41,101.412,8,21,4,0)
dialog when creating an order.
"^DD",101.41,101.412,8,"DT")
2950407
"^DD",101.41,101.412,9,0)
ASK ON ACTION^F^^0;9^K:$L(X)>3!($L(X)<1) X
"^DD",101.41,101.412,9,3)
Answer must be 1-3 characters in length.
"^DD",101.41,101.412,9,21,0)
^^6^6^2970708^^^
"^DD",101.41,101.412,9,21,1,0)
This field determines the behaviour of the dialog driver for this prompt
"^DD",101.41,101.412,9,21,2,0)
when taking a particular action on an order created by this dialog.  If
"^DD",101.41,101.412,9,21,3,0)
this string contains "R", this prompt will be asked when renewing an order;
"^DD",101.41,101.412,9,21,4,0)
if this string contains "C", this prompt will be asked when changing an
"^DD",101.41,101.412,9,21,5,0)
order; if this string contains "W", this prompt will be asked when
"^DD",101.41,101.412,9,21,6,0)
rewriting an order.
"^DD",101.41,101.412,9,"DT")
2970708
"^DD",101.41,101.412,10,0)
INDEX^F^^0;10^K:$L(X)>25!($L(X)<1) X
"^DD",101.41,101.412,10,3)
Answer must be 1-25 characters in length.
"^DD",101.41,101.412,10,21,0)
^^3^3^2950713^^^
"^DD",101.41,101.412,10,21,1,0)
For pointer-type prompts, this is the index to use when searching the file;
"^DD",101.41,101.412,10,21,2,0)
it must be in the form of a regular cross-reference.  To search on multiple
"^DD",101.41,101.412,10,21,3,0)
indices, enter a string of index names separated by semi-colons, i.e. "B;C".
"^DD",101.41,101.412,10,"DT")
2950713
"^DD",101.41,101.412,11,0)
HELP MESSAGE^F^^1;1^K:$L(X)>160!($L(X)<1) X
"^DD",101.41,101.412,11,3)
Answer must be 1-160 characters in length.
"^DD",101.41,101.412,11,21,0)
^^2^2^2970609^^
"^DD",101.41,101.412,11,21,1,0)
This field contains the help message to be presented when the user enters
"^DD",101.41,101.412,11,21,2,0)
a question mark at this prompt.
"^DD",101.41,101.412,11,"DT")
2970609
"^DD",101.41,101.412,12,0)
SPECIAL LOOKUP ROUTINE^F^^1;2^K:$L(X)>20!($L(X)<3) X
"^DD",101.41,101.412,12,3)
Enter the routine to use instead of DIC to do this lookup, as [TAG;]ROUTINE
"^DD",101.41,101.412,12,21,0)
^^3^3^2970609^
"^DD",101.41,101.412,12,21,1,0)
This field contains a routine to execute that will replace the standard
"^DD",101.41,101.412,12,21,2,0)
DIC lookup for this prompt; it must be entered here as LINETAG;ROUTINE
"^DD",101.41,101.412,12,21,3,0)
using a ; instead of ^ and where LINETAG is optional.
"^DD",101.41,101.412,12,"DT")
2970609
"^DD",101.41,101.412,13,0)
ASK ON CONDITION^K^^3;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,13,3)
This is MUMPS code that sets $T to determine if this prompt should be asked, or given a default value and bypassed.
"^DD",101.41,101.412,13,9)
@
"^DD",101.41,101.412,13,21,0)
^^5^5^2950407^
"^DD",101.41,101.412,13,21,1,0)
This is MUMPS code that sets $T to determine if this prompt should be asked
"^DD",101.41,101.412,13,21,2,0)
or simply given a default value and presented to the user for acceptance
"^DD",101.41,101.412,13,21,3,0)
or editing.  For example, the prompt "Pregnant: " may have code here to
"^DD",101.41,101.412,13,21,4,0)
check the sex of the current patient, i.e. I ORSEX="F" will allow it to be
"^DD",101.41,101.412,13,21,5,0)
asked only for female patients.
"^DD",101.41,101.412,13,"DT")
2950407
"^DD",101.41,101.412,14,0)
SCREEN^K^^4;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,14,3)
This is Standard MUMPS code.
"^DD",101.41,101.412,14,9)
@
"^DD",101.41,101.412,14,21,0)
^^2^2^2950407^
"^DD",101.41,101.412,14,21,1,0)
For pointer-type prompts, this field may contain MUMPS code that will be
"^DD",101.41,101.412,14,21,2,0)
set into DIC("S") to screen the possible choices in the pointed-to file.
"^DD",101.41,101.412,14,"DT")
2950407
"^DD",101.41,101.412,15,0)
POST-SELECTION ACTION^K^^5;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,15,3)
This is Standard MUMPS code.
"^DD",101.41,101.412,15,9)
@
"^DD",101.41,101.412,15,21,0)
^^3^3^2970923^^^^
"^DD",101.41,101.412,15,21,1,0)
This is code that will be executed after a response is entered to this
"^DD",101.41,101.412,15,21,2,0)
prompt; if this prompt should be re-asked, kill the variable DONE.
"^DD",101.41,101.412,15,21,3,0)
If execution of the ordering dialog should be stopped, set ORQUIT=1.
"^DD",101.41,101.412,15,"DT")
2970923
"^DD",101.41,101.412,16,0)
XECUTABLE HELP^K^^6;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,16,3)
This is Standard MUMPS code.
"^DD",101.41,101.412,16,9)
@
"^DD",101.41,101.412,16,21,0)
^^2^2^2950407^
"^DD",101.41,101.412,16,21,1,0)
This is code that is to be executed when the user enters two or more
"^DD",101.41,101.412,16,21,2,0)
question marks at this prompt.
"^DD",101.41,101.412,16,"DT")
2950407
"^DD",101.41,101.412,17,0)
DEFAULT^K^^7;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,17,3)
This is Standard MUMPS code.
"^DD",101.41,101.412,17,9)
@
"^DD",101.41,101.412,17,21,0)
^^2^2^2971219^^^^
"^DD",101.41,101.412,17,21,1,0)
This is code that is to be executed to determine the appropriate default
"^DD",101.41,101.412,17,21,2,0)
value for this prompt, setting Y=internal form of this value.
"^DD",101.41,101.412,17,"DT")
2950519
"^DD",101.41,101.412,18,0)
DEFAULT WORD-PROCESSING TEXT^101.41218^^8;0
"^DD",101.41,101.412,18,21,0)
^^1^1^2971219^
"^DD",101.41,101.412,18,21,1,0)
This is default text to be stuffed into this word-processing prompt.
"^DD",101.41,101.412,19,0)
ENTRY ACTION^K^^9;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,19,3)
This is Standard MUMPS code.
"^DD",101.41,101.412,19,9)
@
"^DD",101.41,101.412,19,21,0)
^^3^3^2970609^
"^DD",101.41,101.412,19,21,1,0)
This is code that will be executed at the beginning of the processing of
"^DD",101.41,101.412,19,21,2,0)
this prompt, before the Default and Ask on Condition fields are executed;
"^DD",101.41,101.412,19,21,3,0)
any special setup required for this field should be done here.
"^DD",101.41,101.412,19,"DT")
2970609
"^DD",101.41,101.412,20,0)
EXIT ACTION^K^^10;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,20,3)
This is Standard MUMPS code.
"^DD",101.41,101.412,20,9)
@
"^DD",101.41,101.412,20,21,0)
^^3^3^2970609^
"^DD",101.41,101.412,20,21,1,0)
This is code that will be executed at the very end of the processing of
"^DD",101.41,101.412,20,21,2,0)
this prompt, after prompting and the Validation field is executed;
"^DD",101.41,101.412,20,21,3,0)
any special cleanup should be done here.
"^DD",101.41,101.412,20,"DT")
2970609
"^DD",101.41,101.412,21,0)
ORDER TEXT SEQUENCE^NJ5,2^^2;1^K:+X'=X!(X>99.99)!(X<1)!(X?.E1"."3N.N) X
"^DD",101.41,101.412,21,1,0)
^.1
"^DD",101.41,101.412,21,1,1,0)
101.412^ATXT
"^DD",101.41,101.412,21,1,1,1)
S ^ORD(101.41,DA(1),10,"ATXT",$E(X,1,30),DA)=""
"^DD",101.41,101.412,21,1,1,2)
K ^ORD(101.41,DA(1),10,"ATXT",$E(X,1,30),DA)
"^DD",101.41,101.412,21,1,1,"%D",0)
^^1^1^2960226^
"^DD",101.41,101.412,21,1,1,"%D",1,0)
Used to build order text.
"^DD",101.41,101.412,21,1,1,"DT")
2960226
"^DD",101.41,101.412,21,3)
Enter the order in which this value should be added to the order text, as a number between 1 and 99.99; leave this field blank to prevent this value from being included
"^DD",101.41,101.412,21,21,0)
^^3^3^2970607^^^
"^DD",101.41,101.412,21,21,1,0)
This field indicates the order in which values will be concatenated
"^DD",101.41,101.412,21,21,2,0)
together to build the order text; this may differ from the prompting
"^DD",101.41,101.412,21,21,3,0)
order defined in the .01 Sequence field.
"^DD",101.41,101.412,21,"DT")
2960226
"^DD",101.41,101.412,22,0)
FORMAT^F^^2;2^K:$L(X)>10!($L(X)<1) X
"^DD",101.41,101.412,22,3)
Answer must be 1-10 characters in length.
"^DD",101.41,101.412,22,21,0)
^^15^15^2971207^^^^
"^DD",101.41,101.412,22,21,1,0)
This is a string of characters that will define any exceptions to how
"^DD",101.41,101.412,22,21,2,0)
the external form of this value is generated.  Possible values include:
"^DD",101.41,101.412,22,21,3,0)
  Pointer         -> <field #>~<piece in RPC list of field #>, default =.01
"^DD",101.41,101.412,22,21,4,0)
  Set of Codes    -> 1~<piece in RPC list of code> to use code for name
"^DD",101.41,101.412,22,21,5,0)
  Date/Time       -> Format string to pass $$FMTE^XLFDT (default = 2)
"^DD",101.41,101.412,22,21,6,0)
  
"^DD",101.41,101.412,22,21,7,0)
  Suppress value  -> @
"^DD",101.41,101.412,22,21,8,0)
  Replace value   -> @<ptr> where ptr is the Dialog IEN of the prompt
"^DD",101.41,101.412,22,21,9,0)
                      whose value, when present, supersedes this value
"^DD",101.41,101.412,22,21,10,0)
  Required value  -> *<ptr> where ptr is the Dialog IEN of the prompt
"^DD",101.41,101.412,22,21,11,0)
                      whose value is required to be present to include
"^DD",101.41,101.412,22,21,12,0)
                      this value
"^DD",101.41,101.412,22,21,13,0)
  Ignore if same  -> =<ptr> where ptr is the Dialog IEN of the prompt
"^DD",101.41,101.412,22,21,14,0)
                      whose value, if the external form is the same,
"^DD",101.41,101.412,22,21,15,0)
                      supersedes this value
"^DD",101.41,101.412,22,"DT")
2960226
"^DD",101.41,101.412,23,0)
OMIT TEXT^F^^2;3^K:$L(X)>30!($L(X)<1) X
"^DD",101.41,101.412,23,3)
Answer must be 1-30 characters in length.
"^DD",101.41,101.412,23,21,0)
^^3^3^2970829^^^^
"^DD",101.41,101.412,23,21,1,0)
This is the external form of a value that is not to be included when building
"^DD",101.41,101.412,23,21,2,0)
the order text.  E.g. to include the urgency in the order text unless it
"^DD",101.41,101.412,23,21,3,0)
is routine, enter "ROUTINE" here.
"^DD",101.41,101.412,23,"DT")
2970829
"^DD",101.41,101.412,24,0)
LEADING TEXT^F^^2;4^K:$L(X)>80!($L(X)<1) X
"^DD",101.41,101.412,24,3)
Answer must be 1-80 characters in length.
"^DD",101.41,101.412,24,21,0)
^^3^3^2970724^^^^
"^DD",101.41,101.412,24,21,1,0)
This field contains text that will be appended to the order text
"^DD",101.41,101.412,24,21,2,0)
immediately in front of this value, e.g. "Instructions:".  If this text
"^DD",101.41,101.412,24,21,3,0)
is contained in a variable, enter @NAME where NAME is the variable name.
"^DD",101.41,101.412,24,"DT")
2970724
"^DD",101.41,101.412,25,0)
TRAILING TEXT^F^^2;5^K:$L(X)>80!($L(X)<1) X
"^DD",101.41,101.412,25,3)
Answer must be 1-80 characters in length.
"^DD",101.41,101.412,25,21,0)
^^3^3^2970724^^^^
"^DD",101.41,101.412,25,21,1,0)
This field contains text that will be appended to the order text
"^DD",101.41,101.412,25,21,2,0)
immediately following this value, e.g. "refills".  If this text is
"^DD",101.41,101.412,25,21,3,0)
contained in a variable, enter @NAME where NAME is the variable name.
"^DD",101.41,101.412,25,"DT")
2970724
"^DD",101.41,101.412,26,0)
START NEW LINE^S^1:YES;0:NO;^2;6^Q
"^DD",101.41,101.412,26,3)
Enter YES if this value should begin on a new line in the order text.
"^DD",101.41,101.412,26,21,0)
0^^2^2^2970911^
"^DD",101.41,101.412,26,21,1,0)
This field determines if this value is concatenated onto the current line
"^DD",101.41,101.412,26,21,2,0)
when building the order text, or if a new line is started with this value.
"^DD",101.41,101.412,26,"DT")
2970911
"^DD",101.41,101.412,27,0)
WORD-WRAP^S^1:DON'T WRAP;0:WRAP;^2;7^Q
"^DD",101.41,101.412,27,3)
Enter 'Don't Wrap' to have the text be added line-by-line as it is stored; the default formatting is 'Wrap'.
"^DD",101.41,101.412,27,21,0)
^^3^3^2970926^^^
"^DD",101.41,101.412,27,21,1,0)
This field determines if this text should be wrapped when added to the
"^DD",101.41,101.412,27,21,2,0)
order text, or appended line by line as stored in the file; this is only
"^DD",101.41,101.412,27,21,3,0)
used for word-processing type prompts.
"^DD",101.41,101.412,27,"DT")
2970926
"^DD",101.41,101.412,101,0)
WINDOWS CONTROL^F^^W;1^K:$L(X)>30!($L(X)<1) X
"^DD",101.41,101.412,101,3)
Answer must be 1-30 characters in length.
"^DD",101.41,101.412,101,21,0)
^^2^2^2950715^
"^DD",101.41,101.412,101,21,1,0)
Stores the type of Windows control necessary to get the data for this
"^DD",101.41,101.412,101,21,2,0)
prompt.
"^DD",101.41,101.412,101,"DT")
2960517
"^DD",101.41,101.412,102,0)
API NAME^F^^W;2^K:$L(X)>30!($L(X)<1) X
"^DD",101.41,101.412,102,3)
Answer must be 1-30 characters in length.
"^DD",101.41,101.412,102,21,0)
^^3^3^2950715^
"^DD",101.41,101.412,102,21,1,0)
This is the API that should be called when the control is used.  How the API
"^DD",101.41,101.412,102,21,2,0)
is used varys with the control.  Examples are: filling list boxes, getting
"^DD",101.41,101.412,102,21,3,0)
boilerplate text, etc.
"^DD",101.41,101.412,102,"DT")
2951002
"^DD",101.41,101.412,103,0)
API PARAMETER #1^F^^W;3^K:$L(X)>30!($L(X)<1) X
"^DD",101.41,101.412,103,3)
Answer must be 1-30 characters in length.
"^DD",101.41,101.412,103,21,0)
^^1^1^2950715^
"^DD",101.41,101.412,103,21,1,0)
A parameter that is used by the API call may be stored here.
"^DD",101.41,101.412,103,"DT")
2950715
"^DD",101.41,101.412,113,0)
WINDOWS CONDITION^K^^W3;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,113,3)
This is Standard MUMPS code.
"^DD",101.41,101.412,113,9)
@
"^DD",101.41,101.412,113,21,0)
^^3^3^2950715^
"^DD",101.41,101.412,113,21,1,0)
This is silent code that is executed when building the dialog for windows.
"^DD",101.41,101.412,113,21,2,0)
It identifies which prompts should be included in the dialog.  The condition
"^DD",101.41,101.412,113,21,3,0)
should leave $T false if the prompt should not be asked.
"^DD",101.41,101.412,113,"DT")
2950715
"^DD",101.41,101.412,117,0)
WINDOWS DEFAULT^K^^W7;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",101.41,101.412,117,3)
This is Standard MUMPS code.
"^DD",101.41,101.412,117,9)
@
"^DD",101.41,101.412,117,21,0)
^^2^2^2950715^
"^DD",101.41,101.412,117,21,1,0)
This code should silently set the default value of a prompt when it is 
"^DD",101.41,101.412,117,21,2,0)
selected.
"^DD",101.41,101.412,117,"DT")
2950715
"^DD",101.41,101.41218,0)
DEFAULT WORD-PROCESSING TEXT SUB-FIELD^^.01^1
"^DD",101.41,101.41218,0,"DT")
2950407
"^DD",101.41,101.41218,0,"NM","DEFAULT WORD-PROCESSING TEXT")

"^DD",101.41,101.41218,0,"UP")
101.412
"^DD",101.41,101.41218,.01,0)
DEFAULT WORD-PROCESSING TEXT^W^^0;1^Q
"^DD",101.41,101.41218,.01,3)
Enter the default response for a word-processing type prompt.
"^DD",101.41,101.41218,.01,21,0)
^^2^2^2950407^
"^DD",101.41,101.41218,.01,21,1,0)
This field contains the text to be presented as the default for this prompt,
"^DD",101.41,101.41218,.01,21,2,0)
for word-processing type prompts.
"^DD",101.41,101.41218,.01,"DT")
2950407
"^DD",101.41,101.415,0)
CONTROLS SUB-FIELD^^14^14
"^DD",101.41,101.415,0,"DT")
2960202
"^DD",101.41,101.415,0,"IX","AC",101.415,3)

"^DD",101.41,101.415,0,"IX","B",101.415,.01)

"^DD",101.41,101.415,0,"NM","CONTROLS")

"^DD",101.41,101.415,0,"UP")
101.41
"^DD",101.41,101.415,.01,0)
LOGICAL NAME^MF^^0;1^K:$L(X)>8!($L(X)<1)!'(X?1.8U) X
"^DD",101.41,101.415,.01,1,0)
^.1
"^DD",101.41,101.415,.01,1,1,0)
101.415^B
"^DD",101.41,101.415,.01,1,1,1)
S ^ORD(101.41,DA(1),50,"B",$E(X,1,30),DA)=""
"^DD",101.41,101.415,.01,1,1,2)
K ^ORD(101.41,DA(1),50,"B",$E(X,1,30),DA)
"^DD",101.41,101.415,.01,3)
Answer must be 1-8 characters in length.
"^DD",101.41,101.415,.01,21,0)
^^1^1^2960202^
"^DD",101.41,101.415,.01,21,1,0)
This is the name by which controls can refer to each other.
"^DD",101.41,101.415,.01,"DT")
2960202
"^DD",101.41,101.415,2,0)
ITEM^P101.41'^ORD(101.41,^0;2^Q
"^DD",101.41,101.415,2,"DT")
2960202
"^DD",101.41,101.415,3,0)
CREATE SEQUENCE^NJ2,0^^0;3^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.41,101.415,3,1,0)
^.1
"^DD",101.41,101.415,3,1,1,0)
101.415^AC
"^DD",101.41,101.415,3,1,1,1)
S ^ORD(101.41,DA(1),50,"AC",$E(X,1,30),DA)=""
"^DD",101.41,101.415,3,1,1,2)
K ^ORD(101.41,DA(1),50,"AC",$E(X,1,30),DA)
"^DD",101.41,101.415,3,1,1,"%D",0)
^^2^2^2960202^
"^DD",101.41,101.415,3,1,1,"%D",1,0)
The 'AC' cross-reference puts in window controls in order by creation 
"^DD",101.41,101.415,3,1,1,"%D",2,0)
sequence.
"^DD",101.41,101.415,3,1,1,"DT")
2960202
"^DD",101.41,101.415,3,3)
Type a Number between 1 and 99, 0 Decimal Digits
"^DD",101.41,101.415,3,"DT")
2960202
"^DD",101.41,101.415,4,0)
CONTROL TYPE^S^0:Label;1:Button;2:Edit;3:Memo;4:ListBox;5:SimpleCombo;6:DropDownList;7:LongCombo;^0;4^Q
"^DD",101.41,101.415,4,"DT")
2960202
"^DD",101.41,101.415,5,0)
LABEL^F^^0;5^K:$L(X)>30!($L(X)<1) X
"^DD",101.41,101.415,5,3)
Answer must be 1-30 characters in length.
"^DD",101.41,101.415,5,"DT")
2960202
"^DD",101.41,101.415,6,0)
BESIDE^F^^0;6^K:$L(X)>8!($L(X)<1) X
"^DD",101.41,101.415,6,3)
Answer must be 1-8 characters in length.
"^DD",101.41,101.415,6,"DT")
2960202
"^DD",101.41,101.415,7,0)
BELOW^F^^0;7^K:$L(X)>8!($L(X)<1) X
"^DD",101.41,101.415,7,3)
Answer must be 1-8 characters in length.
"^DD",101.41,101.415,7,"DT")
2960202
"^DD",101.41,101.415,8,0)
WIDTH^NJ6,4^^0;8^K:+X'=X!(X>1)!(X<0)!(X?.E1"."5N.N) X
"^DD",101.41,101.415,8,3)
Type a Number between 0 and 1, 4 Decimal Digits
"^DD",101.41,101.415,8,"DT")
2960202
"^DD",101.41,101.415,9,0)
LEFT CONTROL^F^^0;9^K:$L(X)>8!($L(X)<1) X
"^DD",101.41,101.415,9,3)
Answer must be 1-8 characters in length.
"^DD",101.41,101.415,9,"DT")
2960202
"^DD",101.41,101.415,10,0)
RIGHT CONTROL^F^^0;10^K:$L(X)>8!($L(X)<1) X
"^DD",101.41,101.415,10,3)
Answer must be 1-8 characters in length.
"^DD",101.41,101.415,10,"DT")
2960202
"^DD",101.41,101.415,11,0)
HEIGHT^NJ2,0^^0;11^K:+X'=X!(X>15)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.41,101.415,11,3)
Type a Number between 1 and 15, 0 Decimal Digits
"^DD",101.41,101.415,11,"DT")
2960202
"^DD",101.41,101.415,12,0)
UPPER CONTROL^F^^0;12^K:$L(X)>8!($L(X)<1) X
"^DD",101.41,101.415,12,3)
Answer must be 1-8 characters in length.
"^DD",101.41,101.415,12,"DT")
2960202
"^DD",101.41,101.415,13,0)
LOWER CONTROL^F^^0;13^K:$L(X)>8!($L(X)<1) X
"^DD",101.41,101.415,13,3)
Answer must be 1-8 characters in length.
"^DD",101.41,101.415,13,"DT")
2960202
"^DD",101.41,101.415,14,0)
TAB SEQUENCE^NJ2,0^^0;14^K:+X'=X!(X>89)!(X<0)!(X?.E1"."1N.N) X
"^DD",101.41,101.415,14,3)
Type a Number between 0 and 89, 0 Decimal Digits
"^DD",101.41,101.415,14,"DT")
2960202
"^DD",101.41,101.416,0)
RESPONSES SUB-FIELD^^2^5
"^DD",101.41,101.416,0,"DT")
2960717
"^DD",101.41,101.416,0,"IX","D",101.416,.02)

"^DD",101.41,101.416,0,"NM","RESPONSES")

"^DD",101.41,101.416,0,"UP")
101.41
"^DD",101.41,101.416,.01,0)
ITEM ENTRY^MNJ7,0^^0;1^K:+X'=X!(X>9999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.41,101.416,.01,1,0)
^.1^^0
"^DD",101.41,101.416,.01,3)
Type a Number between 1 and 9999999, 0 Decimal Digits
"^DD",101.41,101.416,.01,21,0)
^^2^2^2971219^^^
"^DD",101.41,101.416,.01,21,1,0)
This is the internal entry number of the prompt in the Item multiple
"^DD",101.41,101.416,.01,21,2,0)
by which this response was obtained.
"^DD",101.41,101.416,.01,"DT")
2961118
"^DD",101.41,101.416,.02,0)
DIALOG^P101.41'^ORD(101.41,^0;2^Q
"^DD",101.41,101.416,.02,1,0)
^.1
"^DD",101.41,101.416,.02,1,1,0)
101.416^D
"^DD",101.41,101.416,.02,1,1,1)
S ^ORD(101.41,DA(1),6,"D",$E(X,1,30),DA)=""
"^DD",101.41,101.416,.02,1,1,2)
K ^ORD(101.41,DA(1),6,"D",$E(X,1,30),DA)
"^DD",101.41,101.416,.02,1,1,"DT")
2961118
"^DD",101.41,101.416,.02,3)
Select the dialog prompt from which this response was generated.
"^DD",101.41,101.416,.02,21,0)
^^2^2^2960717^
"^DD",101.41,101.416,.02,21,1,0)
This is a pointer to the dialog prompt, which is in the Order Dialog file
"^DD",101.41,101.416,.02,21,2,0)
as type prompt.
"^DD",101.41,101.416,.02,"DT")
2961118
"^DD",101.41,101.416,.03,0)
INSTANCE^NJ7,0^^0;3^K:+X'=X!(X>9999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",101.41,101.416,.03,3)
Type a Number between 1 and 9999999, 0 Decimal Digits
"^DD",101.41,101.416,.03,21,0)
^^2^2^2960717^
"^DD",101.41,101.416,.03,21,1,0)
In the case of multiple answers for the same item, this identifies the
"^DD",101.41,101.416,.03,21,2,0)
individual instance.
"^DD",101.41,101.416,.03,"DT")
2960717
"^DD",101.41,101.416,1,0)
VALUE^FO^^1;1^K:$L(X)>245!($L(X)<1) X
"^DD",101.41,101.416,1,2)
S Y(0)=Y S Y=$$OUTPUT^ORCMEDT5(Y)
"^DD",101.41,101.416,1,2.1)
S Y=$$OUTPUT^ORCMEDT5(Y)
"^DD",101.41,101.416,1,3)
Answer must be 1-245 characters in length.
"^DD",101.41,101.416,1,21,0)
^^2^2^2971219^^
"^DD",101.41,101.416,1,21,1,0)
This contains the actual response, unless the value is a word processing
"^DD",101.41,101.416,1,21,2,0)
type.
"^DD",101.41,101.416,1,"DT")
2980717
"^DD",101.41,101.416,2,0)
TEXT^101.4162^^2;0
"^DD",101.41,101.416,2,21,0)
^^1^1^2971219^
"^DD",101.41,101.416,2,21,1,0)
This contains the actual response, for word-processing type prompts.
"^DD",101.41,101.416,2,"DT")
2960717
"^DD",101.41,101.4162,0)
TEXT SUB-FIELD^^.01^1
"^DD",101.41,101.4162,0,"DT")
2960717
"^DD",101.41,101.4162,0,"NM","TEXT")

"^DD",101.41,101.4162,0,"UP")
101.416
"^DD",101.41,101.4162,.01,0)
TEXT^WL^^0;1^Q
"^DD",101.41,101.4162,.01,21,0)
^^1^1^2960717^^
"^DD",101.41,101.4162,.01,21,1,0)
This contains responses to items that are a word processing type.
"^DD",101.41,101.4162,.01,"DT")
2960717
"^DIC",100.9,100.9,0)
OE/RR NOTIFICATIONS^100.9
"^DIC",100.9,100.9,0,"GL")
^ORD(100.9,
"^DIC",100.9,100.9,"%D",0)
^^5^5^2970731^^^
"^DIC",100.9,100.9,"%D",1,0)
This file contains data used to generate notifications.  Packages
"^DIC",100.9,100.9,"%D",2,0)
determine if a notification should be sent then send the patient ID and
"^DIC",100.9,100.9,"%D",3,0)
notification ID (IEN in this file) to order entry routines.  Based on the
"^DIC",100.9,100.9,"%D",4,0)
notification IEN, data from this file is used to generate the notification
"^DIC",100.9,100.9,"%D",5,0)
and help determine its recipients.
"^DIC",100.9,"B","OE/RR NOTIFICATIONS",100.9)

"^DIC",101.24,101.24,0)
OE/RR REPORT^101.24
"^DIC",101.24,101.24,0,"GL")
^ORD(101.24,
"^DIC",101.24,101.24,"%",0)
^1.005^^0
"^DIC",101.24,101.24,"%D",0)
^1.001^7^7^3020924^^^
"^DIC",101.24,101.24,"%D",1,0)
This file contains definitions and parameters used in various reports
"^DIC",101.24,101.24,"%D",2,0)
within CPRS.
"^DIC",101.24,101.24,"%D",3,0)
 
"^DIC",101.24,101.24,"%D",4,0)
Entry numbers >1000 are reserved for national use.  Any local entries
"^DIC",101.24,101.24,"%D",5,0)
should be added to a number <1000.  If this convention is not followed,
"^DIC",101.24,101.24,"%D",6,0)
you run the risk of having your local entries overwritten by a patch
"^DIC",101.24,101.24,"%D",7,0)
or future release of CPRS.
"^DIC",101.24,"B","OE/RR REPORT",101.24)

"^DIC",101.41,101.41,0)
ORDER DIALOG^101.41
"^DIC",101.41,101.41,0,"GL")
^ORD(101.41,
"^DIC",101.41,101.41,"%D",0)
^^2^2^2960819^^
"^DIC",101.41,101.41,"%D",1,0)
This file contains the information needed to define how to prompt for each
"^DIC",101.41,101.41,"%D",2,0)
order, what values are acceptable, etc.
"^DIC",101.41,"B","ORDER DIALOG",101.41)

**END**
**END**
