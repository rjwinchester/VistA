KIDS Distribution saved on Jan 28, 2015@09:55:11
OR*3*391
**KIDS**:OR*3.0*391^

**INSTALL NAME**
OR*3.0*391
"BLD",8923,0)
OR*3.0*391^ORDER ENTRY/RESULTS REPORTING^0^3150128^y
"BLD",8923,1,0)
^^2^2^3141126^
"BLD",8923,1,1,0)
The description of this patch may be found in the National Patch Module
"BLD",8923,1,2,0)
under OR*3.0*391.
"BLD",8923,4,0)
^9.64PA^^
"BLD",8923,6.3)
11
"BLD",8923,"ABPKG")
n
"BLD",8923,"INI")
PRE^ORY391
"BLD",8923,"INIT")
POST^ORY391
"BLD",8923,"KRN",0)
^9.67PA^779.2^20
"BLD",8923,"KRN",.4,0)
.4
"BLD",8923,"KRN",.401,0)
.401
"BLD",8923,"KRN",.402,0)
.402
"BLD",8923,"KRN",.403,0)
.403
"BLD",8923,"KRN",.5,0)
.5
"BLD",8923,"KRN",.84,0)
.84
"BLD",8923,"KRN",3.6,0)
3.6
"BLD",8923,"KRN",3.8,0)
3.8
"BLD",8923,"KRN",9.2,0)
9.2
"BLD",8923,"KRN",9.8,0)
9.8
"BLD",8923,"KRN",9.8,"NM",0)
^9.68A^6^6
"BLD",8923,"KRN",9.8,"NM",1,0)
ORAMSET^^0^B59301848
"BLD",8923,"KRN",9.8,"NM",2,0)
ORAM^^0^B83839096
"BLD",8923,"KRN",9.8,"NM",3,0)
ORAM2^^0^B58023259
"BLD",8923,"KRN",9.8,"NM",4,0)
ORAMX^^0^B169673089
"BLD",8923,"KRN",9.8,"NM",5,0)
ORAM1^^0^B175474289
"BLD",8923,"KRN",9.8,"NM",6,0)
ORAMX1^^0^B81414252
"BLD",8923,"KRN",9.8,"NM","B","ORAM",2)

"BLD",8923,"KRN",9.8,"NM","B","ORAM1",5)

"BLD",8923,"KRN",9.8,"NM","B","ORAM2",3)

"BLD",8923,"KRN",9.8,"NM","B","ORAMSET",1)

"BLD",8923,"KRN",9.8,"NM","B","ORAMX",4)

"BLD",8923,"KRN",9.8,"NM","B","ORAMX1",6)

"BLD",8923,"KRN",19,0)
19
"BLD",8923,"KRN",19.1,0)
19.1
"BLD",8923,"KRN",101,0)
101
"BLD",8923,"KRN",409.61,0)
409.61
"BLD",8923,"KRN",771,0)
771
"BLD",8923,"KRN",779.2,0)
779.2
"BLD",8923,"KRN",870,0)
870
"BLD",8923,"KRN",8989.51,0)
8989.51
"BLD",8923,"KRN",8989.51,"NM",0)
^9.68A^6^6
"BLD",8923,"KRN",8989.51,"NM",1,0)
ORAM INDICATIONS FOR CARE^^0
"BLD",8923,"KRN",8989.51,"NM",2,0)
ORAM AUTO PRIMARY INDICATION^^0
"BLD",8923,"KRN",8989.51,"NM",3,0)
ORAM I10 INDICATIONS FOR CARE^^0
"BLD",8923,"KRN",8989.51,"NM",4,0)
ORAM I10 AUTO PRIM INDICATION^^0
"BLD",8923,"KRN",8989.51,"NM",5,0)
ORAM AUTO SECONDARY INDICATION^^0
"BLD",8923,"KRN",8989.51,"NM",6,0)
ORAM I10 AUTO SEC INDICATION^^0
"BLD",8923,"KRN",8989.51,"NM","B","ORAM AUTO PRIMARY INDICATION",2)

"BLD",8923,"KRN",8989.51,"NM","B","ORAM AUTO SECONDARY INDICATION",5)

"BLD",8923,"KRN",8989.51,"NM","B","ORAM I10 AUTO PRIM INDICATION",4)

"BLD",8923,"KRN",8989.51,"NM","B","ORAM I10 AUTO SEC INDICATION",6)

"BLD",8923,"KRN",8989.51,"NM","B","ORAM I10 INDICATIONS FOR CARE",3)

"BLD",8923,"KRN",8989.51,"NM","B","ORAM INDICATIONS FOR CARE",1)

"BLD",8923,"KRN",8989.52,0)
8989.52
"BLD",8923,"KRN",8989.52,"NM",0)
^9.68A^2^2
"BLD",8923,"KRN",8989.52,"NM",1,0)
ORAM CLINIC PARAMETERS^^0
"BLD",8923,"KRN",8989.52,"NM",2,0)
ORAM SITE PARAMETERS^^0
"BLD",8923,"KRN",8989.52,"NM","B","ORAM CLINIC PARAMETERS",1)

"BLD",8923,"KRN",8989.52,"NM","B","ORAM SITE PARAMETERS",2)

"BLD",8923,"KRN",8994,0)
8994
"BLD",8923,"KRN",8994,"NM",0)
^9.68A^2^2
"BLD",8923,"KRN",8994,"NM",1,0)
ORAMSET GET^^0
"BLD",8923,"KRN",8994,"NM",2,0)
ORAM1 ACDATA^^0
"BLD",8923,"KRN",8994,"NM","B","ORAM1 ACDATA",2)

"BLD",8923,"KRN",8994,"NM","B","ORAMSET GET",1)

"BLD",8923,"KRN","B",.4,.4)

"BLD",8923,"KRN","B",.401,.401)

"BLD",8923,"KRN","B",.402,.402)

"BLD",8923,"KRN","B",.403,.403)

"BLD",8923,"KRN","B",.5,.5)

"BLD",8923,"KRN","B",.84,.84)

"BLD",8923,"KRN","B",3.6,3.6)

"BLD",8923,"KRN","B",3.8,3.8)

"BLD",8923,"KRN","B",9.2,9.2)

"BLD",8923,"KRN","B",9.8,9.8)

"BLD",8923,"KRN","B",19,19)

"BLD",8923,"KRN","B",19.1,19.1)

"BLD",8923,"KRN","B",101,101)

"BLD",8923,"KRN","B",409.61,409.61)

"BLD",8923,"KRN","B",771,771)

"BLD",8923,"KRN","B",779.2,779.2)

"BLD",8923,"KRN","B",870,870)

"BLD",8923,"KRN","B",8989.51,8989.51)

"BLD",8923,"KRN","B",8989.52,8989.52)

"BLD",8923,"KRN","B",8994,8994)

"BLD",8923,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8923,"QUES",0)
^9.62^^
"BLD",8923,"REQB",0)
^9.611^2^2
"BLD",8923,"REQB",1,0)
OR*3.0*330^2
"BLD",8923,"REQB",2,0)
OR*3.0*361^2
"BLD",8923,"REQB","B","OR*3.0*330",1)

"BLD",8923,"REQB","B","OR*3.0*361",2)

"INI")
PRE^ORY391
"INIT")
POST^ORY391
"KRN",8989.51,604,0)
ORAM ADDRESS LINE 1^Address Line 1^0^^Address Line 1
"KRN",8989.51,604,1)
F^1:50^Answer must be 1-50 characters in length.
"KRN",8989.51,604,20,0)
^8989.512^1^1^3090305^^^^
"KRN",8989.51,604,20,1,0)
This is the first line of the Anticoagulation Clinic address.
"KRN",8989.51,604,30,0)
^8989.513I^2^2
"KRN",8989.51,604,30,1,0)
1^44
"KRN",8989.51,604,30,2,0)
2^4
"KRN",8989.51,605,0)
ORAM ADDRESS LINE 2^Address Line 2^^^Address Line 2
"KRN",8989.51,605,1)
F^1:30^Answer must be 1-30 characters in length.
"KRN",8989.51,605,20,0)
^^1^1^3081022^
"KRN",8989.51,605,20,1,0)
This is the second line of the Anticoagulation Clinic address.
"KRN",8989.51,605,30,0)
^8989.513I^2^2
"KRN",8989.51,605,30,1,0)
1^44
"KRN",8989.51,605,30,2,0)
2^4
"KRN",8989.51,606,0)
ORAM ADDRESS LINE 3^Address Line 3^^^Address Line 3
"KRN",8989.51,606,1)
F^1:60^Answer must be 1-60 characters in length.
"KRN",8989.51,606,20,0)
^^1^1^3081022^
"KRN",8989.51,606,20,1,0)
This is the (optional) third line of the Anticoagulation Clinic address.
"KRN",8989.51,606,30,0)
^8989.513I^2^2
"KRN",8989.51,606,30,1,0)
1^44
"KRN",8989.51,606,30,2,0)
2^4
"KRN",8989.51,607,0)
ORAM DISCHARGE NOTE^Anticoagulation Discharge Note^^^Discharge Note Title
"KRN",8989.51,607,1)
P^8925.1:AEMQ^Select the TIU Document Title for the Discharge Note.
"KRN",8989.51,607,3)
I $P(^TIU(8925.1,+Y,0),U,4)="DOC",($P(^(0),U,7)=11)
"KRN",8989.51,607,20,0)
^8989.512^3^3^3081021^^
"KRN",8989.51,607,20,1,0)
This is the TIU Document Title that identifies the Anticoagulation
"KRN",8989.51,607,20,2,0)
Discharge Note, which is entered upon the patient's discharge from the
"KRN",8989.51,607,20,3,0)
Anticoagulation clinic.
"KRN",8989.51,607,30,0)
^8989.513I^1^1
"KRN",8989.51,607,30,1,0)
1^4
"KRN",8989.51,608,0)
ORAM INTERIM NOTE^Anticoagulation Interim Note^^^Interim Note Title
"KRN",8989.51,608,1)
P^8925.1:AEMQ^Select the TIU Document Title for the Interim Note.
"KRN",8989.51,608,3)
I $P(^TIU(8925.1,+Y,0),U,4)="DOC",($P(^(0),U,7)=11)
"KRN",8989.51,608,20,0)
^8989.512^3^3^3081203^^
"KRN",8989.51,608,20,1,0)
This is the TIU Document Title that identifies the Anticoagulation Interim
"KRN",8989.51,608,20,2,0)
Note, which is entered during the patient's ongoing treatment by the
"KRN",8989.51,608,20,3,0)
Anticoagulation clinic.
"KRN",8989.51,608,30,0)
^8989.513I^1^1
"KRN",8989.51,608,30,1,0)
1^4
"KRN",8989.51,609,0)
ORAM INITIAL NOTE^Anticoagulation Initial Note^^^Initial Note Title
"KRN",8989.51,609,1)
P^8925.1:AEMQ^Select the TIU Document Title for the Initial Assessment Note.
"KRN",8989.51,609,3)
I $P(^TIU(8925.1,+Y,0),U,4)="DOC",($P(^(0),U,7)=11)
"KRN",8989.51,609,20,0)
^8989.512^3^3^3081021^^^
"KRN",8989.51,609,20,1,0)
This is the TIU Document Title that identifies the Anticoagulation Initial
"KRN",8989.51,609,20,2,0)
Assessment Note, which is entered for the patient's first visit upon
"KRN",8989.51,609,20,3,0)
enrollment in the Clinic.
"KRN",8989.51,609,30,0)
^8989.513I^1^1
"KRN",8989.51,609,30,1,0)
1^4
"KRN",8989.51,610,0)
ORAM TEAM LIST (ALL)^Anticoagulation Team (All)^^^Anticoagulation Team (All)
"KRN",8989.51,610,1)
P^100.21:AEMQ^Select the Patient Team List for ALL Anticoagulation patients.
"KRN",8989.51,610,20,0)
^8989.512^4^4^3081022^^^
"KRN",8989.51,610,20,1,0)
The ALL Patient list, shows everyone scheduled for that team for that day
"KRN",8989.51,610,20,2,0)
AND any patients NOT completed on previous days.
"KRN",8989.51,610,20,3,0)
                                 
"KRN",8989.51,610,20,4,0)
Patients drop off this list as they are completed in the Anticoagulator.
"KRN",8989.51,610,30,0)
^8989.513I^2^2
"KRN",8989.51,610,30,1,0)
1^44
"KRN",8989.51,610,30,2,0)
2^4
"KRN",8989.51,611,0)
ORAM TEAM LIST (COMPLEX)^Anticoagulation Team (Complex)^^^Anticoagulation Team (Complex)
"KRN",8989.51,611,1)
P^100.21:AEMQ^Select the Patient Team List for incomplete Anticoagulation patients.
"KRN",8989.51,611,20,0)
^8989.512^4^4^3081022^^
"KRN",8989.51,611,20,1,0)
The complex patient list pulls out these patients so that they are not
"KRN",8989.51,611,20,2,0)
lost on the larger list (they appear on both lists).
"KRN",8989.51,611,20,3,0)
                                 
"KRN",8989.51,611,20,4,0)
Patients drop off this list as they are completed in the Anticoagulator.
"KRN",8989.51,611,30,0)
^8989.513I^2^2
"KRN",8989.51,611,30,1,0)
1^44
"KRN",8989.51,611,30,2,0)
2^4
"KRN",8989.51,612,0)
ORAM CLINIC FAX NUMBER^Clinic FAX Number^^^Clinic FAX Number
"KRN",8989.51,612,1)
F^4:25^Enter the phone number of the clinic (e.g., (###)###-####x####)
"KRN",8989.51,612,2)
K:X'?4.25NAP X
"KRN",8989.51,612,20,0)
^8989.512^2^2^3090309^^
"KRN",8989.51,612,20,1,0)
Telephone number, with extension if needed, for FAXes to be sent to the
"KRN",8989.51,612,20,2,0)
anticoagulation clinic. For patient letters.
"KRN",8989.51,612,30,0)
^8989.513I^2^2
"KRN",8989.51,612,30,1,0)
1^44
"KRN",8989.51,612,30,2,0)
2^4
"KRN",8989.51,613,0)
ORAM CLINIC PHONE NUMBER^Clinic Phone Number^^^Clinic Phone Number
"KRN",8989.51,613,1)
F^4:25^Enter the phone number of the clinic (e.g., (###)###-####x####)
"KRN",8989.51,613,2)
K:X'?4.25NAP X
"KRN",8989.51,613,20,0)
^8989.512^2^2^3090309^^
"KRN",8989.51,613,20,1,0)
Telephone number, with extension if needed, for patient to contact the
"KRN",8989.51,613,20,2,0)
anticoagulation clinic. For patient letters.
"KRN",8989.51,613,30,0)
^8989.513I^2^2
"KRN",8989.51,613,30,1,0)
1^44
"KRN",8989.51,613,30,2,0)
2^4
"KRN",8989.51,614,0)
ORAM CONSULT LINK ENABLED^Consult Link Enabled^^^Consult Link Enabled
"KRN",8989.51,614,1)
Y^^Indicate whether or not the Consult Linkage should be enabled.
"KRN",8989.51,614,20,0)
^8989.512^2^2^3081023^^
"KRN",8989.51,614,20,1,0)
Indicates if Consult Linker will be used. If NO: prompt will not be seen
"KRN",8989.51,614,20,2,0)
to complete consult.
"KRN",8989.51,614,30,0)
^8989.513I^2^2
"KRN",8989.51,614,30,1,0)
1^44
"KRN",8989.51,614,30,2,0)
2^4
"KRN",8989.51,615,0)
ORAM CONSULT REQUEST SERVICE^Consult Request Service Name^^^Consult Request Service Name
"KRN",8989.51,615,1)
P^123.5:AEMQ^Select the Consult Request Service for the Anticoagulation Clinic.
"KRN",8989.51,615,20,0)
^8989.512^3^3^3081211^^^
"KRN",8989.51,615,20,1,0)
This is the reference to the Consult Request Service with which Consult
"KRN",8989.51,615,20,2,0)
data will be associated for the Anticoagulation clinic. It is used only if
"KRN",8989.51,615,20,3,0)
the linkage with the Consult Package is enabled.
"KRN",8989.51,615,30,0)
^8989.513I^2^2
"KRN",8989.51,615,30,1,0)
1^44
"KRN",8989.51,615,30,2,0)
2^4
"KRN",8989.51,616,0)
ORAM CPT FOR COMPLEX PHONE^Complex Phone Visit (CPT)^^^Complex Phone Visit (CPT)
"KRN",8989.51,616,1)
P^81:AEMQ^Enter the current CPT code for a Complex Telephone Visit.
"KRN",8989.51,616,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,616,20,0)
^^2^2^3081021^
"KRN",8989.51,616,20,1,0)
This is the CPT code for a Complex Telephone Visit (i.e., HC PRO PHONE
"KRN",8989.51,616,20,2,0)
CALL 21-30 MIN (CPT-4 98968), as of 10/2008).
"KRN",8989.51,616,30,0)
^8989.513I^2^2
"KRN",8989.51,616,30,1,0)
1^44
"KRN",8989.51,616,30,2,0)
2^4
"KRN",8989.51,617,0)
ORAM CPT FOR INITIAL VISIT^Initial Office Visit (CPT)^^^Initial Office Visit (CPT)
"KRN",8989.51,617,1)
P^81:AEMQ^Enter the CPT code for the Initial Office Visit
"KRN",8989.51,617,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,617,20,0)
^^2^2^3081021^
"KRN",8989.51,617,20,1,0)
This is the CPT code for the Initial Office Visit (i.e., ANTICOAG MGMT, 
"KRN",8989.51,617,20,2,0)
INIT (CPT-4 99363), as of 10/2008).
"KRN",8989.51,617,30,0)
^8989.513I^2^2
"KRN",8989.51,617,30,1,0)
1^44
"KRN",8989.51,617,30,2,0)
2^4
"KRN",8989.51,618,0)
ORAM CPT FOR LETTER TO PT^Letter To Patient (CPT)^^^Letter to Patient (CPT)
"KRN",8989.51,618,1)
P^81:AEMQ^Enter the CPT code for Letter to patient.
"KRN",8989.51,618,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,618,20,0)
^^2^2^3081021^
"KRN",8989.51,618,20,1,0)
This is the CPT code for a Letter to the Patient (i.e., (CPT-4 98966), as
"KRN",8989.51,618,20,2,0)
of 10/2008).
"KRN",8989.51,618,30,0)
^8989.513I^2^2
"KRN",8989.51,618,30,1,0)
1^44
"KRN",8989.51,618,30,2,0)
2^4
"KRN",8989.51,619,0)
ORAM CPT FOR ORIENTATION^Orientation Class (CPT)^^^Orientation Class (CPT)
"KRN",8989.51,619,1)
P^81:AEMQ^This is the current CPT code for the Orientation Class Visit.
"KRN",8989.51,619,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,619,20,0)
^^2^2^3081021^
"KRN",8989.51,619,20,1,0)
This is the CPT code for the Orientation Class Visit (i.e., GROUP HEALTH 
"KRN",8989.51,619,20,2,0)
EDUCATION (CPT-4 99078), as of 10/2008).
"KRN",8989.51,619,30,0)
^8989.513I^2^2
"KRN",8989.51,619,30,1,0)
1^44
"KRN",8989.51,619,30,2,0)
2^4
"KRN",8989.51,620,0)
ORAM CPT FOR SIMPLE PHONE^Simple Phone Visit (CPT)^^^Simple Telephone Visit (CPT)
"KRN",8989.51,620,1)
P^81:AEMQ^Current CPT code for a Simple Telephone Visit.
"KRN",8989.51,620,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,620,20,0)
^8989.512^2^2^3081022^^^^
"KRN",8989.51,620,20,1,0)
This is the CPT code for a Simple Telephone Visit (i.e., HC PRO PHONE CALL
"KRN",8989.51,620,20,2,0)
5-10 MIN (CPT-4 98966), as of 10/2008).
"KRN",8989.51,620,30,0)
^8989.513I^2^2
"KRN",8989.51,620,30,1,0)
1^44
"KRN",8989.51,620,30,2,0)
2^4
"KRN",8989.51,621,0)
ORAM CPT FOR SUBSEQUENT VISIT^Subsequent Visit (CPT)^^^Subsequent Office Visit (CPT)
"KRN",8989.51,621,1)
P^81:AEMQ^Enter the CPT code for a Subsequent Office Visit.
"KRN",8989.51,621,3)
I +$$STATCHK^ICPTAPIU(+Y,DT)=1
"KRN",8989.51,621,20,0)
^^2^2^3081021^
"KRN",8989.51,621,20,1,0)
This is the CPT code for Subsequent Anticoagulation Management (i.e.,
"KRN",8989.51,621,20,2,0)
ANTICOAG MGMT, SUBSEQ (CPT-4 99364), as of 10/2008).
"KRN",8989.51,621,30,0)
^8989.513I^2^2
"KRN",8989.51,621,30,1,0)
1^44
"KRN",8989.51,621,30,2,0)
2^4
"KRN",8989.51,624,0)
ORAM HCT/HGB REFERENCE^Hematocrit (HCT) or Hemoglobin (Hgb)^^^Hematocrit (HCT) or Hemoglobin (Hgb)
"KRN",8989.51,624,1)
P^60:AEMQ^Select the Laboratory Test for Hematocrit or Hemoglobin.
"KRN",8989.51,624,3)
I +$$VALIDLAB^ORAMX(+Y)
"KRN",8989.51,624,20,0)
^^3^3^3091214^
"KRN",8989.51,624,20,1,0)
This is the reference to the Lab Test for Hematocrit (HCT) or Hemoglobin 
"KRN",8989.51,624,20,2,0)
(Hgb). It will determine whether the Demographics Tab will display the 
"KRN",8989.51,624,20,3,0)
most recent Hematocrit or the last Hemoglobin.
"KRN",8989.51,624,30,0)
^8989.513I^1^1
"KRN",8989.51,624,30,1,0)
1^4
"KRN",8989.51,625,0)
ORAM MEDICAL CENTER NAME^Medical Center Name^^^Medical Center Name
"KRN",8989.51,625,1)
F^3:70^Answer must be 3-70 characters in length.
"KRN",8989.51,625,20,0)
^8989.512^1^1^3090306^^
"KRN",8989.51,625,20,1,0)
Name of medical facility for letter head.
"KRN",8989.51,625,30,0)
^8989.513I^2^2
"KRN",8989.51,625,30,1,0)
1^4
"KRN",8989.51,625,30,2,0)
2^4.2
"KRN",8989.51,626,0)
ORAM NON-COUNT LOCATION^Anticoagulation NON-COUNT Clinic^^^Anticoagulation NON-COUNT Clinic
"KRN",8989.51,626,1)
P^44:AEMQ^NON-COUNT Clinic for Anticoagulation.
"KRN",8989.51,626,3)
I $P(^SC(+Y,0),U,3)="C",((+$G(^("I"))'>0)!(+$P($G(^("I")),U,2)>0))
"KRN",8989.51,626,20,0)
^8989.512^19^19^3081022^^
"KRN",8989.51,626,20,1,0)
Clinic Locations 
"KRN",8989.51,626,20,2,0)
                                 
"KRN",8989.51,626,20,3,0)
Without PCE Functions: Clinic location you choose is the clinic the note
"KRN",8989.51,626,20,4,0)
will be associated with.  This requires a number from the Hospital
"KRN",8989.51,626,20,5,0)
Location file.  
"KRN",8989.51,626,20,6,0)
                                 
"KRN",8989.51,626,20,7,0)
If you do NOT use the PCE function, then your site is responsible for
"KRN",8989.51,626,20,8,0)
encounters, etc.  The program does NOT care if you use a count or a
"KRN",8989.51,626,20,9,0)
non-count clinic.  
"KRN",8989.51,626,20,10,0)
                                 
"KRN",8989.51,626,20,11,0)
With PCE Functions: If you DO use PCE functions, then you will be asked
"KRN",8989.51,626,20,12,0)
for three clinics, one for face contact (the one on the yellow sheet), one
"KRN",8989.51,626,20,13,0)
for phone contact, and one that is non count (these are on the PCE form).
"KRN",8989.51,626,20,14,0)
The "VISIT"  location (the ANTICOAG VISIT Clinic Location) should be a
"KRN",8989.51,626,20,15,0)
Clinic for FACE to FACE visits.  The program does not care if you use the
"KRN",8989.51,626,20,16,0)
same clinic for both the phone and face to face, but for PCE credit they
"KRN",8989.51,626,20,17,0)
must be COUNT CLINICS.
"KRN",8989.51,626,20,18,0)
                                 
"KRN",8989.51,626,20,19,0)
The non-count clinic is used for notes only, when no PCE data is recorded.
"KRN",8989.51,626,30,0)
^8989.513I^2^2
"KRN",8989.51,626,30,1,0)
1^44
"KRN",8989.51,626,30,2,0)
2^4
"KRN",8989.51,627,0)
ORAM PCE LINK ENABLED^PCE Link Enabled^^^PCE Link Enabled
"KRN",8989.51,627,1)
Y^^Indicate whether the interface to PCE should be enabled.
"KRN",8989.51,627,20,0)
^8989.512^3^3^3081030^^
"KRN",8989.51,627,20,1,0)
Indicates if interface with PCE will be used. If NO: prompt will not be
"KRN",8989.51,627,20,2,0)
seen to enter PCE information, and the information will not be passed to
"KRN",8989.51,627,20,3,0)
the Event Capture system.
"KRN",8989.51,627,30,0)
^8989.513I^2^2
"KRN",8989.51,627,30,1,0)
1^44
"KRN",8989.51,627,30,2,0)
2^4
"KRN",8989.51,628,0)
ORAM PHONE CLINIC^Anticoagulation PHONE Clinic Location^^^Anticoagulation PHONE Clinic Location
"KRN",8989.51,628,1)
P^44:AEMQ^Telephone Clinic for Anticoagulation.
"KRN",8989.51,628,3)
I $P(^SC(+Y,0),U,3)="C",((+$G(^("I"))'>0)!(+$P($G(^("I")),U,2)>0))
"KRN",8989.51,628,20,0)
^8989.512^19^19^3081022^^
"KRN",8989.51,628,20,1,0)
Clinic Locations 
"KRN",8989.51,628,20,2,0)
                                 
"KRN",8989.51,628,20,3,0)
Without PCE Functions: Clinic location you choose is the clinic the note
"KRN",8989.51,628,20,4,0)
will be associated with.  This requires a number from the Hospital
"KRN",8989.51,628,20,5,0)
Location file.  
"KRN",8989.51,628,20,6,0)
                                 
"KRN",8989.51,628,20,7,0)
If you do NOT use the PCE function, then your site is responsible for
"KRN",8989.51,628,20,8,0)
encounters, etc.  The program does NOT care if you use a count or a
"KRN",8989.51,628,20,9,0)
non-count clinic.  
"KRN",8989.51,628,20,10,0)
                                 
"KRN",8989.51,628,20,11,0)
With PCE Functions: If you DO use PCE functions, then you will be asked
"KRN",8989.51,628,20,12,0)
for three clinics, one for face contact (the one on the yellow sheet), one
"KRN",8989.51,628,20,13,0)
for phone contact, and one that is non count (these are on the PCE form).
"KRN",8989.51,628,20,14,0)
The "VISIT"  location (the ANTICOAG VISIT Clinic Location) should be a
"KRN",8989.51,628,20,15,0)
Clinic for FACE to FACE visits.  The program does not care if you use the
"KRN",8989.51,628,20,16,0)
same clinic for both the phone and face to face, but for PCE credit they
"KRN",8989.51,628,20,17,0)
must be COUNT CLINICS.
"KRN",8989.51,628,20,18,0)
                                 
"KRN",8989.51,628,20,19,0)
The non-count clinic is used for notes only, when no PCE data is recorded.
"KRN",8989.51,628,30,0)
^8989.513I^2^2
"KRN",8989.51,628,30,1,0)
1^44
"KRN",8989.51,628,30,2,0)
2^4
"KRN",8989.51,629,0)
ORAM POINT OF CONTACT NAME^Point of Contact Name^^^Point of Contact Name
"KRN",8989.51,629,1)
F^1:45^Answer must be 1-45 characters in length.
"KRN",8989.51,629,20,0)
^8989.512^2^2^3081022^^
"KRN",8989.51,629,20,1,0)
Name of Contact Person (or Clinic) for the "CALL IF QUESTIONS" block on
"KRN",8989.51,629,20,2,0)
patient letters.
"KRN",8989.51,629,30,0)
^8989.513I^2^2
"KRN",8989.51,629,30,1,0)
1^44
"KRN",8989.51,629,30,2,0)
2^4
"KRN",8989.51,630,0)
ORAM RAV FILE PATH^Complete path to network folder^^^Complete path to network folder
"KRN",8989.51,630,1)
F^1:99^Answer must be 1-99 characters in length.
"KRN",8989.51,630,2)
K:X'?1.99ANP X
"KRN",8989.51,630,20,0)
^8989.512^7^7^3090407^^^
"KRN",8989.51,630,20,1,0)
To use the letter programs the Anticoagulator needs to know where to find
"KRN",8989.51,630,20,2,0)
them.  This path is where you put the 2 .rav files (cvisit.rav and
"KRN",8989.51,630,20,3,0)
mappt.rav).  Usually placed in the same network file as the the .EXE file
"KRN",8989.51,630,20,4,0)
for the program for ease of updating, etc.
"KRN",8989.51,630,20,5,0)
                                 
"KRN",8989.51,630,20,6,0)
This field contains the path up to the slash before the exe.  Portland
"KRN",8989.51,630,20,7,0)
example: \\vhaporfpc11\ClinApps\DelphiExe\antiC\
"KRN",8989.51,630,30,0)
^8989.513I^2^2
"KRN",8989.51,630,30,1,0)
1^4
"KRN",8989.51,630,30,2,0)
2^4.2
"KRN",8989.51,631,0)
ORAM SIGNATURE BLOCK NAME^Signature Block Name or Clinic^^^Signature Block Name or Clinic
"KRN",8989.51,631,1)
F^1:45^Answer must be 1-45 characters in length.
"KRN",8989.51,631,20,0)
^^1^1^3081022^
"KRN",8989.51,631,20,1,0)
Signing name to be used in the letter signature blocks.
"KRN",8989.51,631,30,0)
^8989.513I^2^2
"KRN",8989.51,631,30,1,0)
1^44
"KRN",8989.51,631,30,2,0)
2^4
"KRN",8989.51,632,0)
ORAM SIGNATURE BLOCK TITLE^Signature Block Title^^^Signature Block Title
"KRN",8989.51,632,1)
F^1:45^Answer must be 1-45 characters in length.
"KRN",8989.51,632,20,0)
^8989.512^1^1^3081022^^^
"KRN",8989.51,632,20,1,0)
Title used in letter signature blocks.
"KRN",8989.51,632,30,0)
^8989.513I^2^2
"KRN",8989.51,632,30,1,0)
1^44
"KRN",8989.51,632,30,2,0)
2^4
"KRN",8989.51,633,0)
ORAM CLINIC NAME^Clinic Name^^^Clinic Name
"KRN",8989.51,633,1)
F^3:30^Name of the Clinic as it will appear in the Choose Location ComboBox.
"KRN",8989.51,633,20,0)
^^3^3^3090305^
"KRN",8989.51,633,20,1,0)
Specifies the name of the Clinic with which the user may associate the 
"KRN",8989.51,633,20,2,0)
patient whose flowsheet is being viewed/entered (3 - 30 characters in 
"KRN",8989.51,633,20,3,0)
length).
"KRN",8989.51,633,30,0)
^8989.513I^2^2
"KRN",8989.51,633,30,1,0)
1^44
"KRN",8989.51,633,30,2,0)
2^4
"KRN",8989.51,634,0)
ORAM VISIT LOCATION^Anticoagulation VISIT Clinic Location^^^Anticoagulation VISIT Clinic Location
"KRN",8989.51,634,1)
P^44:AEMQ^Face-to-face Clinic for Anticoagulation.
"KRN",8989.51,634,3)
I $P(^SC(+Y,0),U,3)="C",((+$G(^("I"))'>0)!(+$P($G(^("I")),U,2)>0))
"KRN",8989.51,634,20,0)
^^19^19^3081022^
"KRN",8989.51,634,20,1,0)
Clinic Locations 
"KRN",8989.51,634,20,2,0)
                                 
"KRN",8989.51,634,20,3,0)
Without PCE Functions: Clinic location you choose is the clinic the note
"KRN",8989.51,634,20,4,0)
will be associated with.  This requires a number from the Hospital
"KRN",8989.51,634,20,5,0)
Location file.  
"KRN",8989.51,634,20,6,0)
                                 
"KRN",8989.51,634,20,7,0)
If you do NOT use the PCE function, then your site is responsible for
"KRN",8989.51,634,20,8,0)
encounters, etc.  The program does NOT care if you use a count or a
"KRN",8989.51,634,20,9,0)
non-count clinic.  
"KRN",8989.51,634,20,10,0)
                                 
"KRN",8989.51,634,20,11,0)
With PCE Functions: If you DO use PCE functions, then you will be asked
"KRN",8989.51,634,20,12,0)
for three clinics, one for face contact (the one on the yellow sheet), one
"KRN",8989.51,634,20,13,0)
for phone contact, and one that is non count (these are on the PCE form).
"KRN",8989.51,634,20,14,0)
The "VISIT"  location (the ANTICOAG VISIT Clinic Location) should be a
"KRN",8989.51,634,20,15,0)
Clinic for FACE to FACE visits.  The program does not care if you use the
"KRN",8989.51,634,20,16,0)
same clinic for both the phone and face to face, but for PCE credit they
"KRN",8989.51,634,20,17,0)
must be COUNT CLINICS.
"KRN",8989.51,634,20,18,0)
                                 
"KRN",8989.51,634,20,19,0)
The non-count clinic is used for notes only, when no PCE data is recorded.
"KRN",8989.51,634,30,0)
^8989.513I^2^2
"KRN",8989.51,634,30,1,0)
1^44
"KRN",8989.51,634,30,2,0)
2^4
"KRN",8989.51,635,0)
ORAM DEFAULT PILL STRENGTH^Default Pill Strength^0^^Default Pill Strength
"KRN",8989.51,635,1)
N^2:10:2^This is the default pill strength for your clinic (2-10 mg).
"KRN",8989.51,635,4,0)
^8989.514^2^2
"KRN",8989.51,635,4,1,0)
Anticoagulation
"KRN",8989.51,635,4,2,0)
Strength
"KRN",8989.51,635,4,"B","Anticoagulation",1)

"KRN",8989.51,635,4,"B","Strength",2)

"KRN",8989.51,635,20,0)
^^3^3^3090422^
"KRN",8989.51,635,20,1,0)
This is the default Pill Strength in milligrams for the Clinic in question
"KRN",8989.51,635,20,2,0)
(e.g., 2.5, 5, or 10). If you do not specify a pill strength, the program 
"KRN",8989.51,635,20,3,0)
will default to 5 mg.
"KRN",8989.51,635,30,0)
^8989.513I^1^1
"KRN",8989.51,635,30,1,0)
1^44
"KRN",8989.51,636,0)
ORAM INCL TIME W/NEXT INR DATE^Include Time with Next INR Date^0^^Include Time with Next INR
"KRN",8989.51,636,1)
S^0:None;1:Time of Day;2:Morning;3:Afternoon;4:Lab Procedures as Instructed^Will Time of Day be included with INR Draw Date?
"KRN",8989.51,636,20,0)
^^11^11^3090909^
"KRN",8989.51,636,20,1,0)
Please indicate whether time of day will be asked for, and/or included in
"KRN",8989.51,636,20,2,0)
the instructions in Patient Letters, when specifying the Return for INR
"KRN",8989.51,636,20,3,0)
Date.
"KRN",8989.51,636,20,4,0)
 
"KRN",8989.51,636,20,5,0)
The following values may be selected:
"KRN",8989.51,636,20,6,0)
        0 - None (i.e., no time of day will be asked or included)
"KRN",8989.51,636,20,7,0)
        1 - Time of Day (a specific time will be prompted for & included)
"KRN",8989.51,636,20,8,0)
        2 - Morning (pt. will be instructed to arrive in the morning)
"KRN",8989.51,636,20,9,0)
        3 - Afternoon (pt. will be instructed to arrive in the afternoon)
"KRN",8989.51,636,20,10,0)
        4 - Lab Procedures as Instructed (pt. will be instructed to
"KRN",8989.51,636,20,11,0)
              follow local lab procedures)
"KRN",8989.51,636,30,0)
^8989.513I^2^2
"KRN",8989.51,636,30,1,0)
1^44
"KRN",8989.51,636,30,2,0)
2^4
"KRN",8989.51,637,0)
ORAM TOLL FREE PHONE^Toll Free Phone Number^0^^Toll Free Phone Number
"KRN",8989.51,637,1)
F^4:25^Enter the toll free phone number for the clinic (e.g., 1-800-###-####)
"KRN",8989.51,637,2)
K:X'?4.25NAP X
"KRN",8989.51,637,20,0)
^^2^2^3090514^
"KRN",8989.51,637,20,1,0)
Toll free telephone number, for patient to contact the anticoagulation
"KRN",8989.51,637,20,2,0)
clinic. For patient letters.
"KRN",8989.51,637,30,0)
^8989.513I^2^2
"KRN",8989.51,637,30,1,0)
1^44
"KRN",8989.51,637,30,2,0)
2^4
"KRN",8989.51,638,0)
ORAM INR QUICK ORDER^INR Quick Order^^^INR Quick Order
"KRN",8989.51,638,1)
P^101.41:AEMQ^Select the Quick Order for INR.
"KRN",8989.51,638,3)
I $P($G(^ORD(101.41,+Y,0)),U,3)']""
"KRN",8989.51,638,20,0)
^^17^17^3090805^
"KRN",8989.51,638,20,1,0)
This is the reference to the Quick Order Dialog for the INR (International
"KRN",8989.51,638,20,2,0)
Normalized Ratio) for Prothrombin Times.
"KRN",8989.51,638,20,3,0)
                                 
"KRN",8989.51,638,20,4,0)
INR: International normalized ratio, a system established by the World
"KRN",8989.51,638,20,5,0)
Health Organization (WHO) and the International Committee on Thrombosis
"KRN",8989.51,638,20,6,0)
and Hemostasis for reporting the results of blood coagulation (clotting)
"KRN",8989.51,638,20,7,0)
tests. All results are standardized using the international sensitivity
"KRN",8989.51,638,20,8,0)
index for the particular thromboplastin reagent and instrument combination
"KRN",8989.51,638,20,9,0)
utilized to perform the test.
"KRN",8989.51,638,20,10,0)
                                 
"KRN",8989.51,638,20,11,0)
For example, a person taking the anticoagulant ("blood thinner") warfarin
"KRN",8989.51,638,20,12,0)
(brand name: Coumadin) might optimally maintain a prothrombin time (a "pro
"KRN",8989.51,638,20,13,0)
time" or PT) of 2 to 3 INR. No matter what laboratory checks the
"KRN",8989.51,638,20,14,0)
prothrombin time, the result should be the same even if different
"KRN",8989.51,638,20,15,0)
thromboplastins and instruments are used. This international
"KRN",8989.51,638,20,16,0)
standardization permits the patient on warfarin to travel and still obtain
"KRN",8989.51,638,20,17,0)
comparable test results.
"KRN",8989.51,638,30,0)
^8989.513I^1^1
"KRN",8989.51,638,30,1,0)
1^4
"KRN",8989.51,639,0)
ORAM CBC QUICK ORDER^CBC Quick Order^^^CBC Quick Order
"KRN",8989.51,639,1)
P^101.41:AEQM^Choose the Quick Order for CBC.
"KRN",8989.51,639,3)
I $P($G(^ORD(101.41,+Y,0)),U,3)']""
"KRN",8989.51,639,20,0)
^^2^2^3090805^
"KRN",8989.51,639,20,1,0)
This is the reference to the Quick Order Dialog for Complete Blood Count
"KRN",8989.51,639,20,2,0)
(CBC).
"KRN",8989.51,639,30,0)
^8989.513I^1^1
"KRN",8989.51,639,30,1,0)
1^4
"KRN",8989.51,640,-1)
0^1
"KRN",8989.51,640,0)
ORAM INDICATIONS FOR CARE^Indications for Care (ICD-9-CM)^1^Indication Text^ICD-9-CM Diagnosis
"KRN",8989.51,640,1)
P^80^Enter the current ICD-9-CM code for the Indicator.
"KRN",8989.51,640,3)
I +$$STATCHK^ICDAPIU($P($G(^ICD9(+Y,0)),U),$$GETCMPDT^ORAMSET("ICD"))=1
"KRN",8989.51,640,6)
F^2:30^Please enter the text that will identify the Indicator
"KRN",8989.51,640,20,0)
^8989.512^1^1^3140305^^^^
"KRN",8989.51,640,20,1,0)
These are the Indications for care and their associated ICD-9-CM codes.
"KRN",8989.51,640,30,0)
^8989.513I^2^2
"KRN",8989.51,640,30,1,0)
1^4.2
"KRN",8989.51,640,30,2,0)
2^9.4
"KRN",8989.51,641,-1)
0^2
"KRN",8989.51,641,0)
ORAM AUTO PRIMARY INDICATION^Auto Primary Indic for Care (ICD-9-CM)^0^^Auto Primary Indic for Care (ICD-9-CM)
"KRN",8989.51,641,1)
P^80:AEMQ^Enter the current ICD-9-CM code for the Indication.
"KRN",8989.51,641,3)
I +$$ISCODEOK^ORAMSET($P($G(^ICD9(+Y,0)),U),"ICD")
"KRN",8989.51,641,6)
^^
"KRN",8989.51,641,20,0)
^^10^10^3141010^
"KRN",8989.51,641,20,1,0)
This is an Indication for care which will automatically be filed as the 
"KRN",8989.51,641,20,2,0)
Primary Indication for each visit to the applicable Clinic.
"KRN",8989.51,641,20,3,0)
 
"KRN",8989.51,641,20,4,0)
(e.g., if all visits to a non-licensed provider should be filed with 
"KRN",8989.51,641,20,5,0)
V58.61 L/T (CURRENT) USE - ANTICOAG as the primary indication, you can
"KRN",8989.51,641,20,6,0)
specify that with this parameter. If all visits should also have V58.83 
"KRN",8989.51,641,20,7,0)
ENCTR THERAP DRUG MONITOR as an automatic Secondary Indication for care, 
"KRN",8989.51,641,20,8,0)
you can express that by setting the Auto Secondary Indic for Care (ICD-9-
"KRN",8989.51,641,20,9,0)
CM) parameter. The user will still be able to select additional 
"KRN",8989.51,641,20,10,0)
indication(s) from the list).
"KRN",8989.51,641,30,0)
^8989.513I^2^2
"KRN",8989.51,641,30,1,0)
1^44
"KRN",8989.51,641,30,2,0)
2^9.4
"KRN",8989.51,642,0)
ORAM APPT MATCH LOOK-BACK^Look-back Days for Appointment Matching^0^^Look-back Days for Appointment Matching
"KRN",8989.51,642,1)
N^0:7^This is the inclusive lower limit (0-7 days) for appointment matching.
"KRN",8989.51,642,20,0)
^8989.512^9^9^3100114^^
"KRN",8989.51,642,20,1,0)
This is the whole number of days to look-back when attempting to match the
"KRN",8989.51,642,20,2,0)
Anticoagulation Encounter to a scheduled appointment in the VistA 
"KRN",8989.51,642,20,3,0)
Scheduling Package.
"KRN",8989.51,642,20,4,0)
 
"KRN",8989.51,642,20,5,0)
Please enter a number between 0 and 7, no decimal digits.
"KRN",8989.51,642,20,6,0)
 
"KRN",8989.51,642,20,7,0)
The default will be one (1) day (i.e., yesterday). A value of zero (0)
"KRN",8989.51,642,20,8,0)
will restrict the search to begin with today's appointments (i.e.,
"KRN",8989.51,642,20,9,0)
T@00:00).
"KRN",8989.51,642,30,0)
^8989.513I^2^2
"KRN",8989.51,642,30,1,0)
1^44
"KRN",8989.51,642,30,2,0)
2^4
"KRN",8989.51,643,0)
ORAM APPT MATCH LOOK-AHEAD^Look-ahead Days for Appointment Matching^0^^Look-ahead Days for Appointment Matching
"KRN",8989.51,643,1)
N^0:3^This is the inclusive upper limit (0-3 days) for appointment matching.
"KRN",8989.51,643,20,0)
^^8^8^3100114^
"KRN",8989.51,643,20,1,0)
This is the whole number of days to look-ahead (into the future) when
"KRN",8989.51,643,20,2,0)
attempting to match the Anticoagulation Encounter to a scheduled
"KRN",8989.51,643,20,3,0)
appointment in the VistA Scheduling Package.
"KRN",8989.51,643,20,4,0)
 
"KRN",8989.51,643,20,5,0)
Please enter a number between 0 and 3, no decimal digits.
"KRN",8989.51,643,20,6,0)
 
"KRN",8989.51,643,20,7,0)
The default will be one (1) day (i.e., tomorrow). A value of zero (0) will
"KRN",8989.51,643,20,8,0)
restrict the search to end with today's appointments (i.e., T@23:59).
"KRN",8989.51,643,30,0)
^8989.513I^2^2
"KRN",8989.51,643,30,1,0)
1^44
"KRN",8989.51,643,30,2,0)
2^4
"KRN",8989.51,758,-1)
0^3
"KRN",8989.51,758,0)
ORAM I10 INDICATIONS FOR CARE^Indications for Care (ICD-10-CM)^1^Indication Text^ICD-10-CM Diagnosis
"KRN",8989.51,758,1)
P^80^Enter the current ICD-10-CM code for the Indicator.
"KRN",8989.51,758,3)
I +$$STATCHK^ICDAPIU($P($G(^ICD9(+Y,0)),U),$$GETCMPDT^ORAMSET("10D"))=1
"KRN",8989.51,758,6)
F^2:30^Please enter the text that will identify the Indicator
"KRN",8989.51,758,20,0)
^8989.512^1^1^3140320^^^
"KRN",8989.51,758,20,1,0)
These are the Indications for care and their associated ICD-10-CM codes.
"KRN",8989.51,758,30,0)
^8989.513I^2^2
"KRN",8989.51,758,30,1,0)
1^4.2
"KRN",8989.51,758,30,2,0)
2^9.4
"KRN",8989.51,759,-1)
0^4
"KRN",8989.51,759,0)
ORAM I10 AUTO PRIM INDICATION^Auto Primary Indic for Care (ICD-10-CM)^0^^Auto Primary Indic for Care (ICD-10-CM)
"KRN",8989.51,759,1)
P^80:AEMQ^Enter the current ICD-10-CM code for the Indication.
"KRN",8989.51,759,3)
I +$$ISCODEOK^ORAMSET($P($G(^ICD9(+Y,0)),U),"10D")
"KRN",8989.51,759,20,0)
^^10^10^3141010^
"KRN",8989.51,759,20,1,0)
This is an Indication for care which will automatically be filed as the 
"KRN",8989.51,759,20,2,0)
Primary Indication for each visit to the applicable Clinic.
"KRN",8989.51,759,20,3,0)
 
"KRN",8989.51,759,20,4,0)
(e.g., if all visits to a non-licensed provider should be filed with 
"KRN",8989.51,759,20,5,0)
Z79.01 Long term (current) use of anticoagulants , you can specify that
"KRN",8989.51,759,20,6,0)
with this parameter. If all visits should also have Z51.81 Encounter for 
"KRN",8989.51,759,20,7,0)
therapeutic drug level monitoring as an automatic Secondary Indication for
"KRN",8989.51,759,20,8,0)
care, you can express that by setting the Auto Secondary Indic for Care
"KRN",8989.51,759,20,9,0)
(ICD-10-CM) parameter. The user will still be able to select additional
"KRN",8989.51,759,20,10,0)
indication(s) from the list).
"KRN",8989.51,759,30,0)
^8989.513I^2^2
"KRN",8989.51,759,30,1,0)
1^44
"KRN",8989.51,759,30,2,0)
2^9.4
"KRN",8989.51,767,-1)
0^5
"KRN",8989.51,767,0)
ORAM AUTO SECONDARY INDICATION^Auto Secondary Indic for Care (ICD-9-CM)^0^^Auto Secondary Indic for Care (ICD-9-CM)
"KRN",8989.51,767,1)
P^80:AEMQ^Enter the current ICD-9-CM code for the Indication.
"KRN",8989.51,767,3)
I +$$ISCODEOK^ORAMSET($P($G(^ICD9(+Y,0)),U),"ICD")
"KRN",8989.51,767,20,0)
^^7^7^3141010^
"KRN",8989.51,767,20,1,0)
This is an Indication for care which will automatically be filed as the 
"KRN",8989.51,767,20,2,0)
first Secondary Indication for each visit to the applicable Clinic.
"KRN",8989.51,767,20,3,0)
 
"KRN",8989.51,767,20,4,0)
(e.g., if all visits to a non-licensed provider should be filed with 
"KRN",8989.51,767,20,5,0)
V58.83 ENCTR THERAP DRUG MONITOR as the first secondary indication, you
"KRN",8989.51,767,20,6,0)
can specify that with this parameter, and the user will still be able to
"KRN",8989.51,767,20,7,0)
select additional secondary indication(s) from the list).
"KRN",8989.51,767,30,0)
^8989.513I^2^2
"KRN",8989.51,767,30,1,0)
1^44
"KRN",8989.51,767,30,2,0)
2^9.4
"KRN",8989.51,768,-1)
0^6
"KRN",8989.51,768,0)
ORAM I10 AUTO SEC INDICATION^Auto Secondary Ind for Care (ICD-10-CM)^0^^Auto Secondary Ind for Care (ICD-10-CM)
"KRN",8989.51,768,1)
P^80:AEMQ^Enter the current ICD-10-CM code for the Indication.
"KRN",8989.51,768,3)
I +$$ISCODEOK^ORAMSET($P($G(^ICD9(+Y,0)),U),"10D")
"KRN",8989.51,768,20,0)
^^8^8^3141010^
"KRN",8989.51,768,20,1,0)
This is an Indication for care which will automatically be filed as the 
"KRN",8989.51,768,20,2,0)
first Secondary Indication for each visit to the applicable Clinic.
"KRN",8989.51,768,20,3,0)
 
"KRN",8989.51,768,20,4,0)
(e.g., if all visits to a non-licensed provider should be filed with 
"KRN",8989.51,768,20,5,0)
Z51.81 Encounter for therapeutic drug level monitoring as the first
"KRN",8989.51,768,20,6,0)
secondary indication, you can specify that with this parameter, and the
"KRN",8989.51,768,20,7,0)
user will still be able to select additional secondary indication(s) 
"KRN",8989.51,768,20,8,0)
from the list).
"KRN",8989.51,768,30,0)
^8989.513I^2^2
"KRN",8989.51,768,30,1,0)
1^44
"KRN",8989.51,768,30,2,0)
2^9.4
"KRN",8989.52,118,-1)
0^1
"KRN",8989.52,118,0)
ORAM CLINIC PARAMETERS^Anticoagulation Clinic Params^44
"KRN",8989.52,118,10,0)
^8989.521IA^32^32
"KRN",8989.52,118,10,1,0)
10^ORAM TEAM LIST (ALL)
"KRN",8989.52,118,10,2,0)
20^ORAM TEAM LIST (COMPLEX)
"KRN",8989.52,118,10,3,0)
30^ORAM ADDRESS LINE 1
"KRN",8989.52,118,10,4,0)
40^ORAM ADDRESS LINE 2
"KRN",8989.52,118,10,5,0)
50^ORAM ADDRESS LINE 3
"KRN",8989.52,118,10,6,0)
60^ORAM CLINIC PHONE NUMBER
"KRN",8989.52,118,10,7,0)
70^ORAM CLINIC FAX NUMBER
"KRN",8989.52,118,10,8,0)
80^ORAM POINT OF CONTACT NAME
"KRN",8989.52,118,10,9,0)
90^ORAM SIGNATURE BLOCK NAME
"KRN",8989.52,118,10,10,0)
100^ORAM SIGNATURE BLOCK TITLE
"KRN",8989.52,118,10,11,0)
110^ORAM CONSULT LINK ENABLED
"KRN",8989.52,118,10,12,0)
120^ORAM CONSULT REQUEST SERVICE
"KRN",8989.52,118,10,13,0)
130^ORAM PCE LINK ENABLED
"KRN",8989.52,118,10,14,0)
140^ORAM VISIT LOCATION
"KRN",8989.52,118,10,15,0)
5^ORAM CLINIC NAME
"KRN",8989.52,118,10,16,0)
150^ORAM PHONE CLINIC
"KRN",8989.52,118,10,17,0)
160^ORAM NON-COUNT LOCATION
"KRN",8989.52,118,10,18,0)
170^ORAM DEFAULT PILL STRENGTH
"KRN",8989.52,118,10,19,0)
75^ORAM TOLL FREE PHONE
"KRN",8989.52,118,10,20,0)
175^ORAM INCL TIME W/NEXT INR DATE
"KRN",8989.52,118,10,21,0)
131^ORAM CPT FOR SIMPLE PHONE
"KRN",8989.52,118,10,22,0)
132^ORAM CPT FOR COMPLEX PHONE
"KRN",8989.52,118,10,23,0)
133^ORAM CPT FOR LETTER TO PT
"KRN",8989.52,118,10,24,0)
134^ORAM CPT FOR ORIENTATION
"KRN",8989.52,118,10,25,0)
135^ORAM CPT FOR INITIAL VISIT
"KRN",8989.52,118,10,26,0)
136^ORAM CPT FOR SUBSEQUENT VISIT
"KRN",8989.52,118,10,27,0)
130.5^ORAM AUTO PRIMARY INDICATION
"KRN",8989.52,118,10,28,0)
180^ORAM APPT MATCH LOOK-BACK
"KRN",8989.52,118,10,29,0)
185^ORAM APPT MATCH LOOK-AHEAD
"KRN",8989.52,118,10,30,0)
130.7^ORAM I10 AUTO PRIM INDICATION
"KRN",8989.52,118,10,31,0)
130.6^ORAM AUTO SECONDARY INDICATION
"KRN",8989.52,118,10,32,0)
130.8^ORAM I10 AUTO SEC INDICATION
"KRN",8989.52,120,-1)
0^2
"KRN",8989.52,120,0)
ORAM SITE PARAMETERS^Anticoagulation Site Params^4
"KRN",8989.52,120,10,0)
^8989.521IA^14^14
"KRN",8989.52,120,10,1,0)
10^ORAM MEDICAL CENTER NAME
"KRN",8989.52,120,10,2,0)
20^ORAM RAV FILE PATH
"KRN",8989.52,120,10,3,0)
30^ORAM INR QUICK ORDER
"KRN",8989.52,120,10,4,0)
40^ORAM CBC QUICK ORDER
"KRN",8989.52,120,10,5,0)
50^ORAM HCT/HGB REFERENCE
"KRN",8989.52,120,10,6,0)
60^ORAM INITIAL NOTE
"KRN",8989.52,120,10,7,0)
70^ORAM INTERIM NOTE
"KRN",8989.52,120,10,8,0)
80^ORAM DISCHARGE NOTE
"KRN",8989.52,120,10,9,0)
90^ORAM CPT FOR SIMPLE PHONE
"KRN",8989.52,120,10,10,0)
100^ORAM CPT FOR COMPLEX PHONE
"KRN",8989.52,120,10,11,0)
110^ORAM CPT FOR LETTER TO PT
"KRN",8989.52,120,10,12,0)
120^ORAM CPT FOR ORIENTATION
"KRN",8989.52,120,10,13,0)
130^ORAM CPT FOR INITIAL VISIT
"KRN",8989.52,120,10,14,0)
140^ORAM CPT FOR SUBSEQUENT VISIT
"KRN",8994,2816,-1)
0^2
"KRN",8994,2816,0)
ORAM1 ACDATA^ACDATA^ORAM1^2^P^0^^0
"KRN",8994,2816,1,0)
^8994.01^2^2^3140709^^^
"KRN",8994,2816,1,1,0)
Retrieves record header information (e.g., indication for treatment,
"KRN",8994,2816,1,2,0)
permissions, risks, goals, etc.) for the current patient.
"KRN",8994,2816,2,0)
^8994.02A^2^2
"KRN",8994,2816,2,1,0)
DFN^1^^^1
"KRN",8994,2816,2,2,0)
VISITDATE^1^^^2
"KRN",8994,2816,2,2,1,0)
^^2^2^3140709^
"KRN",8994,2816,2,2,1,1,0)
This is the Date of Service (i.e., visit date) when the provider saw the 
"KRN",8994,2816,2,2,1,2,0)
patient.
"KRN",8994,2816,2,"B","DFN",1)

"KRN",8994,2816,2,"B","VISITDATE",2)

"KRN",8994,2816,2,"PARAMSEQ",1,1)

"KRN",8994,2816,2,"PARAMSEQ",2,2)

"KRN",8994,2835,-1)
0^1
"KRN",8994,2835,0)
ORAMSET GET^GET^ORAMSET^2^S^0^^0
"KRN",8994,2835,1,0)
^8994.01^2^2^3140319^^^^
"KRN",8994,2835,1,1,0)
Returns the Anticoagulation Manager parameters for the division which the
"KRN",8994,2835,1,2,0)
user is logged into.
"KRN",8994,2835,2,0)
^8994.02A^2^2
"KRN",8994,2835,2,1,0)
CLINICLOC^1^^0^1
"KRN",8994,2835,2,1,1,0)
^^2^2^3140319^
"KRN",8994,2835,2,1,1,1,0)
This is the entry of the clinic in the HOSPITAL LOCATION FILE (#44), 
"KRN",8994,2835,2,1,1,2,0)
expressed in variable pointer format (e.g., "32;SC(").
"KRN",8994,2835,2,2,0)
VISITDT^1^^0^2
"KRN",8994,2835,2,2,1,0)
^8994.021^2^2^3140319^^
"KRN",8994,2835,2,2,1,1,0)
This is the date/time of the visit in Intenal VA FileMan format (e.g., 
"KRN",8994,2835,2,2,1,2,0)
3140929.1400).
"KRN",8994,2835,2,"B","CLINICLOC",1)

"KRN",8994,2835,2,"B","VISITDT",2)

"KRN",8994,2835,2,"PARAMSEQ",1,1)

"KRN",8994,2835,2,"PARAMSEQ",2,2)

"KRN",8994,2835,3,0)
^^14^14^3140319^
"KRN",8994,2835,3,1,0)
RESULT(0)=SITE NAME^TEAM LIST ALL PTS^TEAM LIST COMPLEX PTS^INTAKE NOTE 
"KRN",8994,2835,3,2,0)
          TITLE^INTERIM NOTE TITLE^DISCHARGE NOTE TITLE^SIMPLE PHONE
"KRN",8994,2835,3,3,0)
          CPT^SUBSEQUENT VISIT CPT^COMPLEX PHONE CPT^ORIENTATION
"KRN",8994,2835,3,4,0)
          CPT^INITIAL VISIT CPT^CONSULT LINK ENABLED^PCE ENABLED^LETTER
"KRN",8994,2835,3,5,0)
          SENT CPT^^ADDRESS 1^ADDRESS 2^ADDRESS 3
"KRN",8994,2835,3,6,0)
 
"KRN",8994,2835,3,7,0)
RESULT(1)=SIGNATURE NAME^SIGNATURE TITLE^POC NAME^CLINIC PHONE#|CLINIC 
"KRN",8994,2835,3,8,0)
          FAX#^MED CENTER NAME^DFLT PILL STRENGTH^DAYS TIL NEXT DRAW^TOLL
"KRN",8994,2835,3,9,0)
          FREE PHONE#
"KRN",8994,2835,3,10,0)
 
"KRN",8994,2835,3,11,0)
RESULT(2)=VISIT CLINIC|PHONE CLINIC|NON-COUNT CLINIC^INR QUICK ORDER|CBC 
"KRN",8994,2835,3,12,0)
          QUICK ORDER^STATION #^DSS UNIT#^DSS ID#^CONSULT SERVICE^HCT TEST
"KRN",8994,2835,3,13,0)
          #|HCT TEST NAME^NETWORK PATH^DEF PRIM IND CODE^DEF PRIM IND
"KRN",8994,2835,3,14,0)
          TEXT^ICD-10CM ACTIVE (Y/N)
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"ORD",21,8989.52)
8989.52;21;1;;PAR2E1^XPDTA2;PAR2F1^XPDIA3;PAR2E1^XPDIA3;PAR2F2^XPDIA3;;PAR2DEL^XPDIA3(%)
"ORD",21,8989.52,0)
PARAMETER TEMPLATE
"PKG",170,-1)
1^1
"PKG",170,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",170,20,0)
^9.402P^^
"PKG",170,22,0)
^9.49I^1^1
"PKG",170,22,1,0)
3.0^2971217^2980917^11712
"PKG",170,22,1,"PAH",1,0)
391^3150128^10000000196
"PKG",170,22,1,"PAH",1,1,0)
^^2^2^3150128
"PKG",170,22,1,"PAH",1,1,1,0)
The description of this patch may be found in the National Patch Module
"PKG",170,22,1,"PAH",1,1,2,0)
under OR*3.0*391.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
7
"RTN","ORAM")
0^2^B83839096
"RTN","ORAM",1,0)
ORAM ;POR/RSF - ANTICOAGULATION MANAGEMENT RPCS (1 of 4) ;11/26/14  12:08
"RTN","ORAM",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307,330,391**;Dec 17, 1997;Build 11
"RTN","ORAM",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAM",4,0)
 Q
"RTN","ORAM",5,0)
 ;
"RTN","ORAM",6,0)
PATIENT(RESULT,ORAMDFN) ;Returns current Patient info as:
"RTN","ORAM",7,0)
 ;DFN^NAME^GENDER^ADMISSION^CURRENT DT/TIME (internal)^SSN^CURRENT DT/TIME (external)^CLINIC LOCATION^DTIME
"RTN","ORAM",8,0)
 ;RPC=ORAM PATIENT
"RTN","ORAM",9,0)
 N CURADM,PTNAME,GENDER,ORAMNOW,ORAMRD,ORAMSSN,ORAMPLOC,ORAMVDT,ORAMLOCS
"RTN","ORAM",10,0)
 I '$G(ORAMDFN) D
"RTN","ORAM",11,0)
 . N DIC,X,Y
"RTN","ORAM",12,0)
 . S DIC="^DPT(",DIC(0)="Z",X=" "
"RTN","ORAM",13,0)
 . D ^DIC
"RTN","ORAM",14,0)
 . S ORAMDFN=+$G(Y)
"RTN","ORAM",15,0)
 I ORAMDFN<1 S ORAMDFN=0 G PATIENTQ
"RTN","ORAM",16,0)
 S CURADM=$G(^DPT(ORAMDFN,.105))   ;CHECKS IF PATIENT IS ADMITTED
"RTN","ORAM",17,0)
 S PTNAME=$P(^DPT(ORAMDFN,0),U)
"RTN","ORAM",18,0)
 I $L(PTNAME)>19 D
"RTN","ORAM",19,0)
 . N ORFMT
"RTN","ORAM",20,0)
 . F ORFMT="LAST,FIRST MI","LAST,FI MI" S PTNAME=$$NAME^ORAMX(PTNAME,ORFMT) Q:$L(PTNAME)'>19
"RTN","ORAM",21,0)
 S GENDER=$P(^DPT(ORAMDFN,0),U,2)
"RTN","ORAM",22,0)
 S ORAMSSN=$P(^DPT(ORAMDFN,0),U,9)
"RTN","ORAM",23,0)
 S ORAMNOW=$$NOW^XLFDT S ORAMRD=$$FMTE^XLFDT($E(ORAMNOW,1,12),2)
"RTN","ORAM",24,0)
 S ORAMPLOC=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAM",25,0)
 ; if pt enrolled in a clinic, use that location and look for an appt in look-up range
"RTN","ORAM",26,0)
 I +ORAMPLOC>0 D  I 1
"RTN","ORAM",27,0)
 . S ORAMPLOC=ORAMPLOC_";SC("
"RTN","ORAM",28,0)
 . S ORAMVDT=$$GETAPPT(ORAMDFN,+ORAMPLOC)
"RTN","ORAM",29,0)
 E  D  ; otherwise check whether pt has appt at any anticoag clinic in look-up range
"RTN","ORAM",30,0)
 . N ORAMLOCS,ORI S ORI=0
"RTN","ORAM",31,0)
 . D GETCLINS^ORAMSET(.ORAMLOCS) Q:+$G(ORAMLOCS(0))'>0
"RTN","ORAM",32,0)
 . F  S ORI=$O(ORAMLOCS(ORI)) D  Q:+ORI'>0!+ORAMVDT
"RTN","ORAM",33,0)
 . . S ORAMPLOC=$P($G(ORAMLOCS(ORI)),U,2)
"RTN","ORAM",34,0)
 . . S ORAMVDT=$$GETAPPT(ORAMDFN,+ORAMPLOC)
"RTN","ORAM",35,0)
 S:+$G(ORAMVDT)'>0 ORAMVDT=ORAMNOW
"RTN","ORAM",36,0)
 S:$L($P(ORAMRD,"/",1))=1 $P(ORAMRD,"/",1)="0"_$P(ORAMRD,"/",1)
"RTN","ORAM",37,0)
 S:$L($P(ORAMRD,"/",2))=1 $P(ORAMRD,"/",2)="0"_$P(ORAMRD,"/",2)
"RTN","ORAM",38,0)
 S RESULT=$G(ORAMDFN)_U_$G(PTNAME)_U_$G(GENDER)_U_$G(CURADM)_U_ORAMNOW_U_$G(ORAMSSN)_U_$G(ORAMRD)_U_ORAMPLOC_U_$G(DTIME)_U_ORAMVDT
"RTN","ORAM",39,0)
PATIENTQ Q
"RTN","ORAM",40,0)
 ;
"RTN","ORAM",41,0)
APPTMTCH(RESULT,ORAMDFN,ORAMCL) ; Find appt match on clinic change
"RTN","ORAM",42,0)
 S RESULT=$$GETAPPT(ORAMDFN,+ORAMCL)
"RTN","ORAM",43,0)
 Q
"RTN","ORAM",44,0)
 ;
"RTN","ORAM",45,0)
GETAPPT(ORAMDFN,ORAMCL) ; Find most recent appointment to Clinic from t-1 to t+1 days
"RTN","ORAM",46,0)
 N ORAMC,ORAMEDT,ORAMLDT,ORAMOK,ORAMY,ORAMDIFF,ORAMTCL,ORAMVCL,ORAMLAD,ORAMLBD,ORAMFLTR,ORAMAPPT
"RTN","ORAM",47,0)
 S ORAMOK=0
"RTN","ORAM",48,0)
 S ORAMY=$$NOW^XLFDT
"RTN","ORAM",49,0)
 I +ORAMCL'>0 G GETAPPX
"RTN","ORAM",50,0)
 S ORAMLBD=$$GET^XPAR(ORAMCL_";SC(^ALL","ORAM APPT MATCH LOOK-BACK",1,"I")
"RTN","ORAM",51,0)
 S ORAMDIFF=$S(ORAMLBD]"":-ORAMLBD,1:-1)
"RTN","ORAM",52,0)
 S ORAMEDT=$$FMADD^XLFDT(DT,ORAMDIFF)
"RTN","ORAM",53,0)
 S ORAMLAD=$$GET^XPAR(ORAMCL_";SC(^ALL","ORAM APPT MATCH LOOK-AHEAD",1,"I")
"RTN","ORAM",54,0)
 S ORAMDIFF=$S(ORAMLAD]"":ORAMLAD,1:1)
"RTN","ORAM",55,0)
 S ORAMLDT=$$FMADD^XLFDT(DT,ORAMDIFF)_".2359"
"RTN","ORAM",56,0)
 S ORAMVCL=$$GET^XPAR(ORAMCL_";SC(","ORAM VISIT LOCATION",1,"I")
"RTN","ORAM",57,0)
 S ORAMTCL=$$GET^XPAR(ORAMCL_";SC(","ORAM PHONE CLINIC",1,"I")
"RTN","ORAM",58,0)
 F ORAMC=ORAMVCL,ORAMTCL D
"RTN","ORAM",59,0)
 . N ORAMOK
"RTN","ORAM",60,0)
 . S ORAMFLTR(1)=ORAMEDT_";"_ORAMLDT
"RTN","ORAM",61,0)
 . S ORAMFLTR(2)=ORAMC
"RTN","ORAM",62,0)
 . S ORAMFLTR(3)="R;I;NT"
"RTN","ORAM",63,0)
 . S ORAMFLTR(4)=ORAMDFN
"RTN","ORAM",64,0)
 . S ORAMFLTR("MAX")=-3
"RTN","ORAM",65,0)
 . S ORAMFLTR("FLDS")="1;2;4"
"RTN","ORAM",66,0)
 . S ORAMOK=$$SDAPI^SDAMA301(.ORAMFLTR)
"RTN","ORAM",67,0)
 . I +ORAMOK>0 M ORAMAPPT=^TMP($J,"SDAMA301")
"RTN","ORAM",68,0)
 I +$D(ORAMAPPT)>9 S ORAMY=$$NEAREST($NA(ORAMAPPT(ORAMDFN)))
"RTN","ORAM",69,0)
 K ^TMP($J,"SDAMA301")
"RTN","ORAM",70,0)
GETAPPX Q ORAMY
"RTN","ORAM",71,0)
 ;
"RTN","ORAM",72,0)
NEAREST(APPTS) ; Find the nearest appointment to NOW
"RTN","ORAM",73,0)
 N ORC,ORI,ORY,ORNOW,ORDIFFS S (ORC,ORY)=0,ORNOW=$$NOW^XLFDT
"RTN","ORAM",74,0)
 F  S ORC=$O(@APPTS@(ORC)) Q:+ORC'>0  D
"RTN","ORAM",75,0)
 . N ORDT S ORDT=0
"RTN","ORAM",76,0)
 . F  S ORDT=$O(@APPTS@(ORC,ORDT)) Q:+ORDT'>0  S ORDIFFS($$ABS^XLFMTH($$FMDIFF^XLFDT(ORNOW,ORDT,2)))=ORDT
"RTN","ORAM",77,0)
 S ORI=$O(ORDIFFS(0))
"RTN","ORAM",78,0)
 S:+ORI>0 ORY=ORDIFFS(ORI)
"RTN","ORAM",79,0)
 Q ORY
"RTN","ORAM",80,0)
 ;
"RTN","ORAM",81,0)
PROVIDER(RESULT) ;GETS DUZ/NAME OF PROVIDER WHO IS SIGNED IN
"RTN","ORAM",82,0)
 ;;RPC=ORAM PROVIDER
"RTN","ORAM",83,0)
 N PN,INIT
"RTN","ORAM",84,0)
 S DUZ=$G(DUZ)
"RTN","ORAM",85,0)
 S PN=$P(^VA(200,DUZ,0),U)
"RTN","ORAM",86,0)
 S INIT=$P(^VA(200,DUZ,0),U,2)
"RTN","ORAM",87,0)
 S RESULT=$G(DUZ)_U_PN_U_$G(INIT)
"RTN","ORAM",88,0)
 Q
"RTN","ORAM",89,0)
 ;
"RTN","ORAM",90,0)
INRCHK(ORAMQO) ; Resolve Lab Test id from Quick Order
"RTN","ORAM",91,0)
 N TST,N,ORAM60,ORAMT2,ORAMTT,ORAMPP,ORAMTST,ORAMTSTN,ORAMNEW,ORAML,ORAMT60,ORAMORD,ORY
"RTN","ORAM",92,0)
 S ORAMORD=$$QOORD(ORAMQO),ORY=""
"RTN","ORAM",93,0)
 I +$G(ORAMQO) D
"RTN","ORAM",94,0)
 . N ORAMC
"RTN","ORAM",95,0)
 . S ORAM60=+$P(^ORD(101.43,ORAMORD,0),U,2) Q:'+$G(ORAM60)
"RTN","ORAM",96,0)
 . S ORAMT60=$P($P($G(^LAB(60,ORAM60,0)),U,5),";",2) I +$G(ORAMT60) S ORY=ORAMT60 Q
"RTN","ORAM",97,0)
 . I '$G(ORAMT60),$D(^LAB(60,ORAM60,2,0)) S ORAMC=0 F  S ORAMC=$O(^LAB(60,ORAM60,2,ORAMC)) Q:'+$G(ORAMC)!(+$G(ORY))  D
"RTN","ORAM",98,0)
 .. S ORAMNEW=^LAB(60,ORAM60,2,ORAMC,0) I +ORAMNEW>0,$$ISINR(ORAMNEW) S ORY=$P($P($G(^LAB(60,ORAMNEW,0)),U,5),";",2) Q
"RTN","ORAM",99,0)
 Q ORY
"RTN","ORAM",100,0)
 ;
"RTN","ORAM",101,0)
ISINR(ORTEST) ; Is the lab test an INR?
"RTN","ORAM",102,0)
 N ORY,ORNM S ORY=0
"RTN","ORAM",103,0)
 S ORNM=$P($G(^LAB(60,ORTEST,0)),U)
"RTN","ORAM",104,0)
 S ORY=$S(ORNM["INR":1,(ORNM["INT")&(ORNM["NORM")&(ORNM["RAT"):1,1:0)
"RTN","ORAM",105,0)
 Q ORY
"RTN","ORAM",106,0)
 ;
"RTN","ORAM",107,0)
LABCHK(RESULT) ;
"RTN","ORAM",108,0)
 ;;RPC=ORAM ORDERABLES
"RTN","ORAM",109,0)
 N ORAMINR,ORAMCBC,C,Y S (C,Y)=0,RESULT="0|0"
"RTN","ORAM",110,0)
 S ORAMINR=0 F  S ORAMINR=$O(^ORD(101.43,"B","INR",ORAMINR)) Q:'+$G(ORAMINR)!(+$G(C))  I +$G(ORAMINR) S $P(RESULT,"|")=ORAMINR,C=1
"RTN","ORAM",111,0)
 I $G(ORAMINR)="" S ORAMINR=0 F  S ORAMINR=$O(^ORD(101.43,"B","INR ",ORAMINR)) Q:'+$G(ORAMINR)!(+$G(C))  I +$G(ORAMINR) S $P(RESULT,"|")=ORAMINR,C=1
"RTN","ORAM",112,0)
 I $G(ORAMINR)="" S ORAMINR=0 F  S ORAMINR=$O(^ORD(101.43,"B","INR/PT",ORAMINR)) Q:'+$G(ORAMINR)!(+$G(C))  I +$G(ORAMINR) S $P(RESULT,"|")=ORAMINR,C=1
"RTN","ORAM",113,0)
 I $G(ORAMINR)="" S ORAMINR=0 F  S ORAMINR=$O(^ORD(101.43,"B","PT",ORAMINR)) Q:'+$G(ORAMINR)!(+$G(C))  I +$G(ORAMINR) S $P(RESULT,"|")=ORAMINR,C=1
"RTN","ORAM",114,0)
 S ORAMCBC=0 F  S ORAMCBC=$O(^ORD(101.43,"B","CBC",ORAMCBC)) Q:'+$G(ORAMCBC)!(+$G(Y))  I +$G(ORAMCBC) S $P(RESULT,"|",2)=ORAMCBC,Y=1
"RTN","ORAM",115,0)
 I $G(ORAMCBC)="" S ORAMCBC=$O(^ORD(101.43,"B","CBC ",ORAMCBC)) Q:'+$G(ORAMCBC)!(+$G(Y))  I +$G(ORAMCBC) S $P(RESULT,"|",2)=ORAMCBC,Y=1
"RTN","ORAM",116,0)
 Q
"RTN","ORAM",117,0)
 ;
"RTN","ORAM",118,0)
SIGCHECK(RESULT,ESCODE) ;
"RTN","ORAM",119,0)
 ;;CHECKS SIG CODE
"RTN","ORAM",120,0)
 ;;RPC=ORAM SIGCHECK
"RTN","ORAM",121,0)
 N SUCCESS,X
"RTN","ORAM",122,0)
 S SUCCESS=0
"RTN","ORAM",123,0)
 Q:ESCODE=""
"RTN","ORAM",124,0)
 S X=ESCODE D HASH^XUSHSHP
"RTN","ORAM",125,0)
 I $P($G(^VA(200,DUZ,20)),U,4)=X S SUCCESS=1 ;SIG CODE CORRECT
"RTN","ORAM",126,0)
 S RESULT=$G(SUCCESS)
"RTN","ORAM",127,0)
SIGQ Q
"RTN","ORAM",128,0)
 ;
"RTN","ORAM",129,0)
HCT(RESULT,ORAMDFN) ;GET HCT
"RTN","ORAM",130,0)
 ;;GETS MOST RECENT HCT
"RTN","ORAM",131,0)
 ;;RPC=ORAM HCT
"RTN","ORAM",132,0)
 N HCT,LDATE,HCTDATE,LOOPCNT,HCTDIFF,LRDFN,ORAMS,ORAMHCT,ORAMDNM,OHCT,OHCTD,ORAMFM,ORAMHCTN
"RTN","ORAM",133,0)
 I '$G(ORAMDFN) S RESULT="" Q  ;IF DFN IS NOT PASSED, EXIT
"RTN","ORAM",134,0)
 S LRDFN=$$LAB($G(ORAMDFN)) I +LRDFN'>0 S RESULT="Patient has no VistA Lab Data." Q
"RTN","ORAM",135,0)
 S ORAMHCT=$$GET^XPAR("ALL","ORAM HCT/HGB REFERENCE",1,"B")
"RTN","ORAM",136,0)
 I +$G(ORAMHCT)'>0 S RESULT="HCT Param not set." Q
"RTN","ORAM",137,0)
 S ORAMHCTN=$P(ORAMHCT,U,2),ORAMHCT=$P(ORAMHCT,U)
"RTN","ORAM",138,0)
 ; Get Lab Data Name based on IEN in ^LAB(60,
"RTN","ORAM",139,0)
 S ORAMDNM=$P($P(^LAB(60,+ORAMHCT,0),U,5),";",2) I ORAMDNM']"" S RESULT="Data Name not defined for "_ORAMHCTN_" in Lab Test File." Q
"RTN","ORAM",140,0)
 S LDATE=0 F  SET LDATE=$O(^LR(LRDFN,"CH",LDATE)) S LOOPCNT=0 Q:LDATE=""!(+$G(HCT))  D  Q:LOOPCNT
"RTN","ORAM",141,0)
 . S RESULT=$G(^LR(LRDFN,"CH",LDATE,ORAMDNM))
"RTN","ORAM",142,0)
 . Q:RESULT=""
"RTN","ORAM",143,0)
 . Q:$P(RESULT,U,1)=""  ;QUIT IF NO HCT DATA
"RTN","ORAM",144,0)
 . S HCT=$P(RESULT,U,1)  ;HCT
"RTN","ORAM",145,0)
 . S HCTDATE=9999999-LDATE
"RTN","ORAM",146,0)
 . S LOOPCNT=1
"RTN","ORAM",147,0)
 . Q:+HCT
"RTN","ORAM",148,0)
 I LDATE="" S RESULT="NONE"
"RTN","ORAM",149,0)
 I $D(^ORAM(103,ORAMDFN,6)),($L($P(^ORAM(103,ORAMDFN,6),U,4),"|")=3) D
"RTN","ORAM",150,0)
 . S OHCT=$P($P(^ORAM(103,ORAMDFN,6),U,4),"|"),OHCTD=$P($P(^ORAM(103,ORAMDFN,6),U,4),"|",2)
"RTN","ORAM",151,0)
 . I +$G(OHCT) D DT^DILF(,OHCTD,.ORAMFM)
"RTN","ORAM",152,0)
 I +$G(HCTDATE),$G(ORAMFM)>HCTDATE S HCT=OHCT_" (Outside Lab)",HCTDATE=ORAMFM,ORAMHCTN="HCT"
"RTN","ORAM",153,0)
 I '+$G(HCTDATE) S:+$G(OHCT) HCT=OHCT_" (Outside Lab)",ORAMHCTN="HCT" S:$G(ORAMFM)'="" HCTDATE=ORAMFM
"RTN","ORAM",154,0)
 I +$G(HCTDATE) S HCTDATE=$$FMTE^XLFDT($E(HCTDATE,1,7),2)
"RTN","ORAM",155,0)
 S RESULT=$G(HCT)_U_$G(HCTDATE)_U_ORAMHCTN
"RTN","ORAM",156,0)
 Q
"RTN","ORAM",157,0)
 ;
"RTN","ORAM",158,0)
INR(RESULT,ORAMDFN) ; Gets most recent INR
"RTN","ORAM",159,0)
 ;;RPC=ORAM INR
"RTN","ORAM",160,0)
 N LDATE,INR,INRFD,LRDFN,HDATE,TDIFF,SIXMON,COUNT,SCORE,ORAMITST,INRHD,INRRD
"RTN","ORAM",161,0)
 N ORAMQO
"RTN","ORAM",162,0)
 S RESULT=""
"RTN","ORAM",163,0)
 I '$G(ORAMDFN) Q  ;IF DFN IS NOT PASSED, EXIT
"RTN","ORAM",164,0)
 S LRDFN=$$LAB($G(ORAMDFN))  I +LRDFN'>0 S RESULT="Patient has no Lab Data." Q
"RTN","ORAM",165,0)
 S ORAMQO=$$GET^XPAR("ALL","ORAM INR QUICK ORDER",1,"I") S ORAMITST=$$INRCHK(ORAMQO)
"RTN","ORAM",166,0)
 I +ORAMITST'>0 Q
"RTN","ORAM",167,0)
 S (LDATE,COUNT)=0,SIXMON=$$FMADD^XLFDT(DT,-180)
"RTN","ORAM",168,0)
 F  S LDATE=$O(^LR(LRDFN,"CH",LDATE)) Q:+LDATE'>0!(LDATE>(9999999-SIXMON))  D
"RTN","ORAM",169,0)
 . N SCORE,INR,INRFD,INRHD,INRRD,XDT
"RTN","ORAM",170,0)
 . S SCORE=$G(^LR(LRDFN,"CH",LDATE,ORAMITST))
"RTN","ORAM",171,0)
 . Q:SCORE=""  ;QUIT IF NO INR TEST
"RTN","ORAM",172,0)
 . S INR=$P(SCORE,U)  ;INR
"RTN","ORAM",173,0)
 . Q:INR=""  ;QUIT IF NO INR DATA
"RTN","ORAM",174,0)
 . S INRFD=9999999-LDATE
"RTN","ORAM",175,0)
 . S XDT=$P(INRFD,".") S INRHD=$$FMTH^XLFDT(XDT,1),INRRD=$$FMTE^XLFDT(XDT,"2P")
"RTN","ORAM",176,0)
 . S RESULT(COUNT)=$G(INR)_"^^"_$G(INRRD)_U_$G(INRHD)
"RTN","ORAM",177,0)
 . Q:INRFD<SIXMON  ;Q WHEN SEARCHED LAST 6 MONTHS
"RTN","ORAM",178,0)
 . S COUNT=COUNT+1
"RTN","ORAM",179,0)
 Q
"RTN","ORAM",180,0)
 ;
"RTN","ORAM",181,0)
CONCOMP(RESULT,ORAMCNUM,ORAMNNUM,ORAMDUZ) ;
"RTN","ORAM",182,0)
 ;;BRINGS IN CONSULT NUMBER(ORAMCNUM)
"RTN","ORAM",183,0)
 ;;BRINGS IN NOTE NUMBER(ORAMNNUM), COMPLETES CONSULT
"RTN","ORAM",184,0)
 ;;RPC=ORAM CONCOMP
"RTN","ORAM",185,0)
 N ORAMCST
"RTN","ORAM",186,0)
 S RESULT=0
"RTN","ORAM",187,0)
 S ORAMCST=$S($$STATUS^TIULC(ORAMNNUM)="completed":"COMPLETE",1:"INCOMPLETE")
"RTN","ORAM",188,0)
 D GET^GMRCTIU(ORAMCNUM,ORAMNNUM,ORAMCST,ORAMDUZ)
"RTN","ORAM",189,0)
 S RESULT=1
"RTN","ORAM",190,0)
 Q
"RTN","ORAM",191,0)
 ;
"RTN","ORAM",192,0)
LAB(DFN) ;GET LAB NUMBER
"RTN","ORAM",193,0)
 N LRDFN
"RTN","ORAM",194,0)
 IF 'DFN S LRDFN="" G LABQ ;IF DFN IS NOT PASSED, EXIT
"RTN","ORAM",195,0)
 S LRDFN=$G(^DPT(DFN,"LR"))
"RTN","ORAM",196,0)
LABQ Q LRDFN
"RTN","ORAM",197,0)
 ;
"RTN","ORAM",198,0)
ORDER(ORESULT,DFN,ORNP,ORLOC,ORQO,ORCDT) ; Place Quick Order for INR or CBC
"RTN","ORAM",199,0)
 ; RPC ORAM ORDER
"RTN","ORAM",200,0)
 ;  in: DFN   - pt id file 2
"RTN","ORAM",201,0)
 ;      ORNP  - ordering provider id file 200
"RTN","ORAM",202,0)
 ;      ORLOC - location id file 42
"RTN","ORAM",203,0)
 ;      ORQO  - quick order id file 101.41
"RTN","ORAM",204,0)
 ;      ORCDT - collection date/time
"RTN","ORAM",205,0)
 N ORANS,ORDIALOG,ORDG,ORDLG
"RTN","ORAM",206,0)
 I +$G(DFN)'>0 S ORESULT="0^invalid Patient id" Q
"RTN","ORAM",207,0)
 I +$G(ORNP)'>0 S ORESULT="0^invalid Provider id" Q
"RTN","ORAM",208,0)
 I +$G(ORLOC)'>0 S ORESULT="0^invalid Location id" Q
"RTN","ORAM",209,0)
 I +$G(ORQO)'>0 S ORESULT="0^invalid Quick Order id" Q
"RTN","ORAM",210,0)
 I $G(ORCDT)']"" S ORESULT="0^invalid Collection Date/Time" Q
"RTN","ORAM",211,0)
 D GETQDLG^ORCD(ORQO)
"RTN","ORAM",212,0)
 I '$D(ORDIALOG) S ORESULT="0^invalid Quick Order id" Q
"RTN","ORAM",213,0)
 S ORDLG=$$GET1^DIQ(101.41,+ORDIALOG_",",.01)
"RTN","ORAM",214,0)
 I ORDLG']"" S ORESULT="0^invalid Quick Order id" Q
"RTN","ORAM",215,0)
 S ORDG=$$GET1^DIQ(101.41,ORQO_",",5,"I")
"RTN","ORAM",216,0)
 I +ORDG'>0 S ORESULT="0^invalid Quick Order id - no Display Group" Q
"RTN","ORAM",217,0)
 S ORDIALOG(6,1)=$$IDATE(ORCDT)
"RTN","ORAM",218,0)
 D SAVE^ORWDX(.ORESULT,DFN,ORNP,ORLOC,ORDLG,ORDG,ORQO,"",.ORDIALOG) ; Place the order
"RTN","ORAM",219,0)
 ; if the order is placed, call UNOTIF^ORCSIGN to avoid duplicate alerts,
"RTN","ORAM",220,0)
 ; then call NOTIF^ORCSIGN to generate an unsigned order notification
"RTN","ORAM",221,0)
 I +ORESULT D
"RTN","ORAM",222,0)
 . N ORVP,ORIFN,Y
"RTN","ORAM",223,0)
 . S ORVP=DFN_";DPT(",ORIFN=$P($P($G(ORESULT(1)),"~",2),";")
"RTN","ORAM",224,0)
 . D UNOTIF^ORCSIGN
"RTN","ORAM",225,0)
 . D NOTIF^ORCSIGN
"RTN","ORAM",226,0)
 Q
"RTN","ORAM",227,0)
IDATE(ORX) ; Convert External Date/time to FM Internal format
"RTN","ORAM",228,0)
 N ORY S ORY=""
"RTN","ORAM",229,0)
 D DT^DILF("T",ORX,.ORY) S:+ORY'>0 ORY=""
"RTN","ORAM",230,0)
 Q ORY
"RTN","ORAM",231,0)
QOORD(ORQO) ; Given Quick Order, find the IEN of the Orderable Item
"RTN","ORAM",232,0)
 N ORI,ORDIALOG,ORY S ORY=0
"RTN","ORAM",233,0)
 D GETQDLG^ORCD(+$G(ORQO))
"RTN","ORAM",234,0)
 I '$D(ORDIALOG) G QOORDX
"RTN","ORAM",235,0)
 S ORI=0
"RTN","ORAM",236,0)
 F  S ORI=$O(ORDIALOG(ORI)) Q:ORI'>0!+ORY>0  D
"RTN","ORAM",237,0)
 . I $G(ORDIALOG(ORI))["ORDERABLE" S ORY=$G(ORDIALOG(ORI,1))
"RTN","ORAM",238,0)
QOORDX Q ORY
"RTN","ORAM1")
0^5^B175474289
"RTN","ORAM1",1,0)
ORAM1 ;POR/RSF - ANTICOAGULATION MANAGEMENT RPCS (2 of 4) ;11/14/14  15:37
"RTN","ORAM1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307,339,351,361,391**;Dec 17, 1997;Build 11
"RTN","ORAM1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAM1",4,0)
 Q
"RTN","ORAM1",5,0)
 ;
"RTN","ORAM1",6,0)
 ;  External References:
"RTN","ORAM1",7,0)
 ;  $$EXTERNAL^DILFD     ICR #2055
"RTN","ORAM1",8,0)
 ;  $$FMTE/$$NOW^XLFDT   ICR #10103
"RTN","ORAM1",9,0)
 ;  $$GET^XPAR           ICR #2263
"RTN","ORAM1",10,0)
 ;
"RTN","ORAM1",11,0)
TERASE(RESULT,ORAMDFN,ORAMCOMP) ; Manage Team Lists
"RTN","ORAM1",12,0)
 N ORAMKEY,ORAMTMP,ORAMCEY,ORAMCLIN,ORAMCLNM,ORAMCOM,ORAMALL,ORAMCPLX,ORAMENT,QQ,DA,DIK,D0
"RTN","ORAM1",13,0)
 Q:'+$G(ORAMDFN)
"RTN","ORAM1",14,0)
 S ORAMCLIN=+$P($G(^ORAM(103,ORAMDFN,6)),U,2),ORAMENT=$S(+ORAMCLIN>0:ORAMCLIN_";SC(",1:"ALL")
"RTN","ORAM1",15,0)
 I +ORAMCLIN S ORAMCLNM=$$EXTERNAL^DILFD(103,101,"",ORAMCLIN)
"RTN","ORAM1",16,0)
 S ORAMALL=$$GET^XPAR(ORAMENT,"ORAM TEAM LIST (ALL)",1,"I"),ORAMCPLX=$$GET^XPAR(ORAMENT,"ORAM TEAM LIST (COMPLEX)",1,"I")
"RTN","ORAM1",17,0)
 I +$G(ORAMALL) D  I 1
"RTN","ORAM1",18,0)
 . S DA(1)=ORAMALL,DIK="^OR(100.21"_","_DA(1)_",10,"
"RTN","ORAM1",19,0)
 . S ORAMTMP=ORAMDFN_";DPT("
"RTN","ORAM1",20,0)
 . S ORAMKEY=$O(^OR(100.21,ORAMALL,10,"B",ORAMTMP,0)) Q:+ORAMKEY'>0  S DA=ORAMKEY
"RTN","ORAM1",21,0)
 . D ^DIK
"RTN","ORAM1",22,0)
 . K DA,DIK
"RTN","ORAM1",23,0)
 . K D0
"RTN","ORAM1",24,0)
 . S RESULT=1
"RTN","ORAM1",25,0)
 E  S RESULT="0^ORAM TEAM LIST (ALL) not defined for Clinic "_ORAMCLNM_"."
"RTN","ORAM1",26,0)
 I +$G(ORAMCPLX) D  I 1
"RTN","ORAM1",27,0)
 . S DA(1)=ORAMCPLX,DIK="^OR(100.21"_","_DA(1)_",10,"
"RTN","ORAM1",28,0)
 . S ORAMCEY=$O(^OR(100.21,ORAMCPLX,10,"B",ORAMTMP,0)) Q:+ORAMCEY'>0  S DA=ORAMCEY
"RTN","ORAM1",29,0)
 . D ^DIK
"RTN","ORAM1",30,0)
 . K DA,DIK
"RTN","ORAM1",31,0)
 . S:'$D(RESULT) RESULT=1
"RTN","ORAM1",32,0)
 E  S RESULT="0^ORAM TEAM LIST (COMPLEX) not defined for Clinic "_ORAMCLNM_"."
"RTN","ORAM1",33,0)
 Q
"RTN","ORAM1",34,0)
 ;
"RTN","ORAM1",35,0)
 ;ICDCODE(RESULT,ICODE); Map ICD Code //REMOVED BECAUSE OF DIRECT READ OF ^ICD9( FILE
"RTN","ORAM1",36,0)
 ;N ORAMICD
"RTN","ORAM1",37,0)
 ;S ORAMICD=ICODE_" "
"RTN","ORAM1",38,0)
 ;S RESULT=$O(^ICD9("AB",ORAMICD,0))
"RTN","ORAM1",39,0)
 ;Q
"RTN","ORAM1",40,0)
 ;
"RTN","ORAM1",41,0)
PTCHECK(RESULT,ORAMDFN) ; CHECKS TO SEE IF PT IS IN FILE
"RTN","ORAM1",42,0)
 N ORPTLOC
"RTN","ORAM1",43,0)
 Q:'+$G(ORAMDFN)
"RTN","ORAM1",44,0)
 S RESULT=0
"RTN","ORAM1",45,0)
 I $S('$D(^ORAM(103,ORAMDFN)):1,+$O(^ORAM(103,ORAMDFN,3,0))'>0:1,1:0) S RESULT=1 Q
"RTN","ORAM1",46,0)
 S ORPTLOC=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAM1",47,0)
 I ORPTLOC']"" S RESULT=2 Q
"RTN","ORAM1",48,0)
 I +ORPTLOC,'$L($$GET^XPAR(ORPTLOC_";SC(^DIV.`"_DUZ(2),"ORAM CLINIC NAME",1,"I")) S RESULT=99
"RTN","ORAM1",49,0)
 Q
"RTN","ORAM1",50,0)
 ;
"RTN","ORAM1",51,0)
PTENTER(RESULT,DFN) ; ENTERS PATIENT INTO FILE WITH ALL DATES = TODAY
"RTN","ORAM1",52,0)
 N DO,DD,DIC,DINUM,X
"RTN","ORAM1",53,0)
 S DIC="^ORAM(103,"
"RTN","ORAM1",54,0)
 S DIC(0)="Z"
"RTN","ORAM1",55,0)
 S (DINUM,X)=DFN
"RTN","ORAM1",56,0)
 D FILE^DICN
"RTN","ORAM1",57,0)
 K DO,DD
"RTN","ORAM1",58,0)
 S RESULT=1
"RTN","ORAM1",59,0)
 Q
"RTN","ORAM1",60,0)
 ;
"RTN","ORAM1",61,0)
ACDATA(RESULT,DFN,ORAMEDT) ; HEADING DATA
"RTN","ORAM1",62,0)
 N ORAMSTOT,ORAMRTOT,ORAMRAT,ORAMMSGT,ORAMRAT,ORAMBRT,ORAMX,ORI,ORLINE
"RTN","ORAM1",63,0)
 N ORAMD0,ORAMD4,ORAMD5,ORAMD6,ORAMD9,ORAMD15,ORAMD17,ORAMD18
"RTN","ORAM1",64,0)
 N ORAMT4,ORAMT5,ORAMT6,ORAMT9,ORAMT15,ORAMT17,ORAMT18,ORAMDXT,ORAMDXC,ORDXI,ORAMPOP
"RTN","ORAM1",65,0)
 S ORAMEDT=$G(ORAMEDT,DT)
"RTN","ORAM1",66,0)
 S ORAMX=0
"RTN","ORAM1",67,0)
 I '$D(^ORAM(103,DFN)) D  ;IF NOT IN FILE ALREADY...
"RTN","ORAM1",68,0)
 . N DD,DIC,DINUM,DO,X
"RTN","ORAM1",69,0)
 . S DIC="^ORAM(103,"
"RTN","ORAM1",70,0)
 . S DIC(0)="Z"
"RTN","ORAM1",71,0)
 . S (DINUM,X)=DFN
"RTN","ORAM1",72,0)
 . D FILE^DICN
"RTN","ORAM1",73,0)
 . K DO,DD
"RTN","ORAM1",74,0)
 . S ORAMX=1
"RTN","ORAM1",75,0)
 I ORAMX=1 S RESULT(0)=0 G ACDATAQ
"RTN","ORAM1",76,0)
 S ORAMD0=^ORAM(103,DFN,0)
"RTN","ORAM1",77,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,1,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,1,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMSTOT=$G(ORAMSTOT)_U_ORLINE
"RTN","ORAM1",78,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,2,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,2,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMRTOT=$G(ORAMRTOT)_U_ORLINE
"RTN","ORAM1",79,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,4,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,4,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMMSGT=$G(ORAMMSGT)_U_ORLINE
"RTN","ORAM1",80,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,5,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,5,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMRAT=$G(ORAMRAT)_U_ORLINE
"RTN","ORAM1",81,0)
 S ORI=0 F  S ORI=$O(^ORAM(103,DFN,7,ORI)) Q:+ORI'>0  S ORLINE=$G(^ORAM(103,DFN,7,ORI,0)) S:ORLINE="" ORLINE=" " S ORAMBRT=$G(ORAMBRT)_U_ORLINE
"RTN","ORAM1",82,0)
 S RESULT(0)=$G(ORAMSTOT)
"RTN","ORAM1",83,0)
 S RESULT(1)=$G(ORAMRTOT)
"RTN","ORAM1",84,0)
 S RESULT(2)=$G(ORAMMSGT)
"RTN","ORAM1",85,0)
 S RESULT(4)=$G(ORAMRAT)
"RTN","ORAM1",86,0)
 S RESULT(5)=$S($G(ORAMBRT)]"":$P($G(^ORAM(103,DFN,6)),"^",5)_"^"_$P($G(ORAMBRT),"^",2,99),1:"")
"RTN","ORAM1",87,0)
 S ORAMD4=$P(ORAMD0,"^",4),ORAMD5=$P(ORAMD0,"^",5),ORAMD6=$P(ORAMD0,"^",6),ORAMD9=$P(ORAMD0,"^",9),ORAMD15=$P(ORAMD0,"^",15),ORAMD17=$P(ORAMD0,"^",17),ORAMD18=$P(ORAMD0,"^",18)
"RTN","ORAM1",88,0)
 S ORAMT4=$$FMTE^XLFDT($E($G(ORAMD4),1,12),"2P"),ORAMT5=$$FMTE^XLFDT($E($G(ORAMD5),1,12),"2P"),ORAMT6=$$FMTE^XLFDT($E($G(ORAMD6),1,12),"2P"),ORAMT9=$$FMTE^XLFDT($E($G(ORAMD9),1,12),"2P")
"RTN","ORAM1",89,0)
 S ORAMT15=$$FMTE^XLFDT($E($G(ORAMD15),1,12),"2P"),ORAMT17=$$FMTE^XLFDT($E($G(ORAMD17),1,12),"2P"),ORAMT18=$$FMTE^XLFDT($E($G(ORAMD18),1,12),"2P")
"RTN","ORAM1",90,0)
 S:$L($P(ORAMT4,"/",1))=1 $P(ORAMT4,"/",1)="0"_$P(ORAMT4,"/",1)
"RTN","ORAM1",91,0)
 S:$L($P(ORAMT4,"/",2))=1 $P(ORAMT4,"/",2)="0"_$P(ORAMT4,"/",2)
"RTN","ORAM1",92,0)
 S:$L($P(ORAMT15,"/",1))=1 $P(ORAMT15,"/",1)="0"_$P(ORAMT15,"/",1)
"RTN","ORAM1",93,0)
 S:$L($P(ORAMT15,"/",2))=1 $P(ORAMT15,"/",2)="0"_$P(ORAMT15,"/",2)
"RTN","ORAM1",94,0)
 S:$L($P(ORAMT17,"/",1))=1 $P(ORAMT17,"/",1)="0"_$P(ORAMT17,"/",1)
"RTN","ORAM1",95,0)
 S:$L($P(ORAMT17,"/",2))=1 $P(ORAMT17,"/",2)="0"_$P(ORAMT17,"/",2)
"RTN","ORAM1",96,0)
 S:$L($P(ORAMT18,"/",1))=1 $P(ORAMT18,"/",1)="0"_$P(ORAMT18,"/",1)
"RTN","ORAM1",97,0)
 S:$L($P(ORAMT18,"/",2))=1 $P(ORAMT18,"/",2)="0"_$P(ORAMT18,"/",2)
"RTN","ORAM1",98,0)
 ; OR*3*391 Check validity of legacy Dx code
"RTN","ORAM1",99,0)
 S ORAMDXT=$P($P(ORAMD0,U,3),"="),ORAMDXC=$P($P(ORAMD0,U,3),"=",2),ORAMPOP=0
"RTN","ORAM1",100,0)
 F ORDXI=1:1:$L(ORAMDXC,"/") D  Q:+ORAMPOP
"RTN","ORAM1",101,0)
 . N ORDXC,ORDX S ORDXC=$P(ORAMDXC,"/",ORDXI)
"RTN","ORAM1",102,0)
 . I (ORDXC]""),(ORDXC'[".") S ORDXC=ORDXC_"."
"RTN","ORAM1",103,0)
 . S ORDX=+$$ICDDATA^ICDXCODE("DIAGNOSIS",ORDXC,ORAMEDT,"E")
"RTN","ORAM1",104,0)
 . I +ORDX'>0 S ORAMDXC=""
"RTN","ORAM1",105,0)
 S $P(ORAMD0,U,3)=ORAMDXT_"="_ORAMDXC
"RTN","ORAM1",106,0)
 S $P(ORAMD0,"^",4)=$G(ORAMT4),$P(ORAMD0,"^",5)=$G(ORAMT5),$P(ORAMD0,"^",6)=$G(ORAMT6),$P(ORAMD0,"^",9)=$G(ORAMT9),$P(ORAMD0,"^",15)=$G(ORAMT15),$P(ORAMD0,"^",17)=$G(ORAMT17),$P(ORAMD0,"^",18)=$G(ORAMT18)
"RTN","ORAM1",107,0)
 S RESULT(3)=ORAMD0 S:$D(^ORAM(103,DFN,6)) RESULT(3)=RESULT(3)_"^"_$P(^ORAM(103,DFN,6),"^")
"RTN","ORAM1",108,0)
ACDATAQ Q
"RTN","ORAM1",109,0)
 ;
"RTN","ORAM1",110,0)
ADDTOP(RESULT,TOPARR) ; File ANTICOAG data
"RTN","ORAM1",111,0)
 N ORAM0,SI,RISK,PEEP,ORAMSIL,ORAMRL,ORAMPEPL,ORAMDAY,ORAMST,ORAMBACK,ORAMSTP,ORAMOR,ORAMFB,ORAMREM,ORAMRML,ORAMR,ORAMC
"RTN","ORAM1",112,0)
 N ORAMBRG,ORAMBRGC,ORAMBRGL,ORAMLOC,OLDRTN,DFN,R,X,FDA
"RTN","ORAM1",113,0)
 D NOW^%DTC S ORAMDAY=X
"RTN","ORAM1",114,0)
 S DFN=TOPARR(0),ORAM0=TOPARR(1),SI=TOPARR(2),RISK=TOPARR(3),PEEP=TOPARR(4),ORAMREM=TOPARR(5)
"RTN","ORAM1",115,0)
 S ORAMBRG=$G(TOPARR(6)),ORAMBRGC=$G(TOPARR(7)),ORAMLOC=$G(TOPARR(8))
"RTN","ORAM1",116,0)
 S OLDRTN=$P($G(^ORAM(103,DFN,0)),"^",4)
"RTN","ORAM1",117,0)
 I SI'="" K ^ORAM(103,DFN,1) S ORAMSIL=$L(SI,"^"),^ORAM(103,DFN,1,0)="^^"_ORAMSIL_"^"_ORAMSIL_"^"_ORAMDAY_"^" F R=1:1:ORAMSIL D
"RTN","ORAM1",118,0)
 . S ^ORAM(103,DFN,1,R,0)=$P(SI,"^",R)
"RTN","ORAM1",119,0)
 I RISK'="" K ^ORAM(103,DFN,2) S ORAMRL=$L(RISK,"^"),^ORAM(103,DFN,2,0)="^^"_ORAMRL_"^"_ORAMRL_"^"_ORAMDAY_"^" F R=1:1:ORAMRL D
"RTN","ORAM1",120,0)
 . S ^ORAM(103,DFN,2,R,0)=$P(RISK,"^",R)
"RTN","ORAM1",121,0)
 I PEEP'="" K ^ORAM(103,DFN,4) S ORAMPEPL=$L(PEEP,"^"),^ORAM(103,DFN,4,0)="^^"_ORAMPEPL_"^"_ORAMPEPL_"^"_ORAMDAY_"^" F R=1:1:ORAMPEPL D
"RTN","ORAM1",122,0)
 . S ^ORAM(103,DFN,4,R,0)=$P(PEEP,"^",R)
"RTN","ORAM1",123,0)
 K ^ORAM(103,DFN,5)
"RTN","ORAM1",124,0)
 I ORAMREM'="" D
"RTN","ORAM1",125,0)
 . S ORAMRML=$L(ORAMREM,"^"),^ORAM(103,DFN,5,0)="^^"_ORAMRML_"^"_ORAMRML_"^"_ORAMDAY_"^"
"RTN","ORAM1",126,0)
 . F R=1:1:ORAMRML S ^ORAM(103,DFN,5,R,0)=$P(ORAMREM,"^",R)
"RTN","ORAM1",127,0)
 ;*351 Use Fileman so x-ref updates.
"RTN","ORAM1",128,0)
 S:ORAMLOC>0 FDA(1,103,DFN_",",101)=ORAMLOC
"RTN","ORAM1",129,0)
 S FDA(1,103,DFN_",",111)=+ORAMBRG
"RTN","ORAM1",130,0)
 D UPDATE^DIE(,"FDA(1)")
"RTN","ORAM1",131,0)
 I +ORAMBRG,(ORAMBRGC]"") D
"RTN","ORAM1",132,0)
 . K ^ORAM(103,DFN,7)
"RTN","ORAM1",133,0)
 . S ORAMBRGL=$L(ORAMBRGC,"^"),^ORAM(103,DFN,7,0)="^^"_ORAMBRGL_"^"_ORAMBRGL_"^"_ORAMDAY_"^"
"RTN","ORAM1",134,0)
 . F R=1:1:ORAMBRGL S ^ORAM(103,DFN,7,R,0)=$P(ORAMBRGC,"^",R)
"RTN","ORAM1",135,0)
 I $P($G(ORAM0),"^",4)'="" S X="",ORAMBACK=$P(ORAM0,"^",4) D DT^DILF("TS",ORAMBACK,.X) S $P(ORAM0,"^",4)=X
"RTN","ORAM1",136,0)
 I $P($G(ORAM0),"^",15)'="" S X="",ORAMFB=$P(ORAM0,"^",15) D DT^DILF(,ORAMFB,.X) S $P(ORAM0,"^",15)=X
"RTN","ORAM1",137,0)
 I $P($G(ORAM0),"^",17)'="" S X="",ORAMC=$P(ORAM0,"^",17) D DT^DILF(,ORAMC,.X) S $P(ORAM0,"^",17)=X
"RTN","ORAM1",138,0)
 I $P($G(ORAM0),"^",18)'="" S X="",ORAMR=$P(ORAM0,"^",18) D DT^DILF(,ORAMR,.X) S $P(ORAM0,"^",18)=X
"RTN","ORAM1",139,0)
 I OLDRTN'="" K ^ORAM(103,"L",OLDRTN,DFN)
"RTN","ORAM1",140,0)
 S ^ORAM(103,DFN,0)=ORAM0 S:$P($G(ORAM0),"^",4)'="" ^ORAM(103,"L",$P(ORAM0,"^",4),DFN)=""
"RTN","ORAM1",141,0)
 I $P(^ORAM(103,DFN,0),"^",13)="" S $P(^ORAM(103,DFN,0),"^",13)="SAVE"
"RTN","ORAM1",142,0)
 Q
"RTN","ORAM1",143,0)
 ;
"RTN","ORAM1",144,0)
OUTINR(RESULT,ORAMINR) ; INR VALUES FROM OUTSIDE LAB
"RTN","ORAM1",145,0)
 N ORAMLEN,ORAMPI,ORAMRI,ORAMZANY,ORAMHDT,ORAMNDT
"RTN","ORAM1",146,0)
 S ORAMLEN=$L($G(ORAMINR),"^"),ORAMRI=0
"RTN","ORAM1",147,0)
 F ORAMPI=1:2:ORAMLEN D
"RTN","ORAM1",148,0)
 . N %H,ORAMDT,X
"RTN","ORAM1",149,0)
 . S ORAMDT=$P(ORAMINR,"^",ORAMPI+1) I $L(ORAMDT) D DT^DILF("E",ORAMDT,.ORAMZANY) S X=ORAMZANY D H^%DTC S ORAMHDT=%H,ORAMNDT=$$FMTE^XLFDT(X,"2P")
"RTN","ORAM1",150,0)
 . I $L(ORAMDT) S RESULT(ORAMRI)=$P(ORAMINR,"^",ORAMPI)_"^"_$G(ORAMHDT)_"^"_$G(ORAMNDT)
"RTN","ORAM1",151,0)
 . E  S RESULT(ORAMRI)="^^"
"RTN","ORAM1",152,0)
 . S ORAMRI=ORAMRI+1
"RTN","ORAM1",153,0)
 Q
"RTN","ORAM1",154,0)
 ;
"RTN","ORAM1",155,0)
PCGOAL(RESULT,DFN,CMPLX) ; % of time Pt in current goal
"RTN","ORAM1",156,0)
 N ORAMSNO,ORAMPC,R,ORAMGOOD,ORAMDATE
"RTN","ORAM1",157,0)
 S R=0,ORAMGOOD=0,ORAMDATE=0
"RTN","ORAM1",158,0)
 S ORAMSNO=0 F  S ORAMSNO=$O(^ORAM(103,DFN,3,ORAMSNO)) Q:'ORAMSNO  D
"RTN","ORAM1",159,0)
 . N ORAMD0,ORAMINR,ORAMGOAL,ORAMGLOW,ORAMHIGH,LCNT,ORAMND
"RTN","ORAM1",160,0)
 . S ORAMD0=$G(^ORAM(103,DFN,3,ORAMSNO,0)),LCNT=$P($G(^ORAM(103,DFN,3,ORAMSNO,1,0)),"^",3)-1
"RTN","ORAM1",161,0)
 . I $G(CMPLX)=1,$G(^ORAM(103,DFN,3,ORAMSNO,1,LCNT,0))["COMPLEX PATIENT" Q
"RTN","ORAM1",162,0)
 . S ORAMND=$P(ORAMD0,"^"),ORAMINR=$P(ORAMD0,"^",3),ORAMGOAL=$P(ORAMD0,"^",12),ORAMGLOW=$P(ORAMGOAL,"-"),ORAMHIGH=$P(ORAMGOAL,"-",2) S:ORAMHIGH[" " ORAMHIGH=$P(ORAMHIGH," ",2)
"RTN","ORAM1",163,0)
 . S ORAMGLOW=ORAMGLOW-(.1*ORAMGLOW),ORAMHIGH=ORAMHIGH+(.1*ORAMHIGH)
"RTN","ORAM1",164,0)
 . I (ORAMND'=ORAMDATE)&(ORAMINR) S R=R+1,ORAMDATE=ORAMND I ((ORAMINR'<ORAMGLOW)&(ORAMINR'>ORAMHIGH)) S ORAMGOOD=ORAMGOOD+1
"RTN","ORAM1",165,0)
 I R>0 S ORAMPC=(ORAMGOOD/R)*100,ORAMPC=$E(ORAMPC,1,4)
"RTN","ORAM1",166,0)
 S RESULT=$G(ORAMPC)_"^"_$G(R)
"RTN","ORAM1",167,0)
PCGOALQ Q
"RTN","ORAM1",168,0)
 ;
"RTN","ORAM1",169,0)
COMPTEST(RESULT,COMMARR) ; File Flow Sheet Data
"RTN","ORAM1",170,0)
 ; RPC: ORAM1 COMPTEST
"RTN","ORAM1",171,0)
 N ORAMDFN,ORAMZERO,ORAMCOMM,ORAMDT,ORAMX,ORAMCL,ORAMTEMP,ORAMSAVE,ORAMRD,ORAMCOMPL,ORAMCCNT,DA,DIK,R,X
"RTN","ORAM1",172,0)
 N ORAMICNT,ORAMIOFF
"RTN","ORAM1",173,0)
 S ORAMDFN=COMMARR(0),ORAMZERO=COMMARR(1),ORAMSAVE=COMMARR(2),ORAMRD=COMMARR(3),ORAMCOMPL=COMMARR(4),ORAMCCNT=COMMARR(5)
"RTN","ORAM1",174,0)
 S ORAMIOFF=+ORAMCCNT+6,ORAMICNT=COMMARR(ORAMIOFF)
"RTN","ORAM1",175,0)
 S ORAMTEMP=$P(ORAMZERO,"^",1) D DT^DILF(,ORAMTEMP,.X) S $P(ORAMZERO,"^",1)=$S($G(X)]"":$G(X),1:DT)
"RTN","ORAM1",176,0)
 S ORAMDT=$$NOW^XLFDT
"RTN","ORAM1",177,0)
 S:$P(ORAMZERO,"^",9)="" $P(ORAMZERO,"^",9)=ORAMDT
"RTN","ORAM1",178,0)
 S ORAMX=$O(^ORAM(103,ORAMDFN,3," "),-1)
"RTN","ORAM1",179,0)
 I 'ORAMX S ORAMX=0
"RTN","ORAM1",180,0)
 I $P(^ORAM(103,ORAMDFN,0),"^",13)="TEMPSAVE" K DIK,DA S DIK="^ORAM(103,"_ORAMDFN_",3,",DA(1)=ORAMDFN,DA=ORAMX D ^DIK
"RTN","ORAM1",181,0)
 I $P(^ORAM(103,ORAMDFN,0),"^",13)="SAVE" S ORAMX=ORAMX+1
"RTN","ORAM1",182,0)
 ; Execute KILL Logic for cross-refs on update
"RTN","ORAM1",183,0)
 I $D(^ORAM(103,ORAMDFN)) D
"RTN","ORAM1",184,0)
 . S DIK="^ORAM(103,"
"RTN","ORAM1",185,0)
 . S DA=ORAMDFN
"RTN","ORAM1",186,0)
 . D IX2^DIK
"RTN","ORAM1",187,0)
 S ^ORAM(103,ORAMDFN,3,0)="^103.011DA^"_ORAMX_"^"_ORAMX
"RTN","ORAM1",188,0)
 S ^ORAM(103,ORAMDFN,3,ORAMX,0)=ORAMZERO
"RTN","ORAM1",189,0)
 I $P(ORAMRD,U,4)]"" S $P(^ORAM(103,ORAMDFN,6),U,1,4)=ORAMRD
"RTN","ORAM1",190,0)
 E  S $P(^ORAM(103,ORAMDFN,6),U,1,3)=$P(ORAMRD,U,1,3)
"RTN","ORAM1",191,0)
 ; If there are comments, file them
"RTN","ORAM1",192,0)
 I +ORAMCCNT>0 F R=1:1:(ORAMCCNT) D
"RTN","ORAM1",193,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,1,R,0)=COMMARR(R+5)
"RTN","ORAM1",194,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,1,0)="^^"_ORAMCCNT_"^"_ORAMCCNT_"^"_$P(ORAMZERO,"^",1)_"^"
"RTN","ORAM1",195,0)
 ; If there are complications, file them
"RTN","ORAM1",196,0)
 I $L(ORAMCOMPL)>0 D
"RTN","ORAM1",197,0)
 . N P1,P2,X
"RTN","ORAM1",198,0)
 . S P1=$P(ORAMCOMPL,"|"),P2=$P(ORAMCOMPL,"|",2)
"RTN","ORAM1",199,0)
 . I P1>99 S P1=2 ;CLOT in the 100 range...
"RTN","ORAM1",200,0)
 . E  I P1#10>0 S P1=1 ;MAJOR BLEED
"RTN","ORAM1",201,0)
 . E  I P1=10 S P1=3 ;MINOR BLEED
"RTN","ORAM1",202,0)
 . S:+$G(P1) $P(^ORAM(103,ORAMDFN,3,ORAMX,0),"^",2)=P1
"RTN","ORAM1",203,0)
 . F X=1:1:$L(P2,"^") D
"RTN","ORAM1",204,0)
 .. S ^ORAM(103,ORAMDFN,3,ORAMX,2,X,0)=$P(P2,"^",X)
"RTN","ORAM1",205,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,2,0)="^^"_$L(P2,"^")-1_"^"_$L(P2,"^")-1_"^"_$P(ORAMZERO,"^",1)_"^"
"RTN","ORAM1",206,0)
 ; If there are Patient Instructions, file them
"RTN","ORAM1",207,0)
 I +ORAMICNT>0 F R=1:1:(ORAMICNT) D
"RTN","ORAM1",208,0)
 . N ORLINE S ORLINE=COMMARR(R+ORAMIOFF)
"RTN","ORAM1",209,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,3,R,0)=$S(ORLINE="":" ",1:ORLINE)
"RTN","ORAM1",210,0)
 . S ^ORAM(103,ORAMDFN,3,ORAMX,3,0)="^^"_ORAMICNT_"^"_ORAMICNT_"^"_$P(ORAMZERO,"^",1)_"^"
"RTN","ORAM1",211,0)
 S ^ORAM(103,ORAMDFN,3,"B",$P(ORAMZERO,"^",1),ORAMX)=""
"RTN","ORAM1",212,0)
 S $P(^ORAM(103,ORAMDFN,0),"^",13)=ORAMSAVE
"RTN","ORAM1",213,0)
 ; Update all cross-refs for Flow Sheet entry
"RTN","ORAM1",214,0)
 S DIK="^ORAM(103,"
"RTN","ORAM1",215,0)
 S DA=ORAMDFN
"RTN","ORAM1",216,0)
 D IX^DIK
"RTN","ORAM1",217,0)
 S RESULT=1
"RTN","ORAM1",218,0)
 Q
"RTN","ORAM1",219,0)
 ;
"RTN","ORAM1",220,0)
FLOWTT(RESULT,DFN) ; GETS ANTICOAG FLOWSHEET DATA
"RTN","ORAM1",221,0)
 N FSARR,COMARR,ORAMI,ORI,ORX
"RTN","ORAM1",222,0)
 S (ORI,ORAMI,ORX)=0
"RTN","ORAM1",223,0)
 F  S ORI=$O(^ORAM(103,DFN,3,"B",ORI)) Q:+ORI'>0  D
"RTN","ORAM1",224,0)
 . N ORJ S ORJ=0
"RTN","ORAM1",225,0)
 . F  S ORJ=$O(^ORAM(103,DFN,3,"B",ORI,ORJ)) Q:+ORJ'>0  D
"RTN","ORAM1",226,0)
 .. N ORAMACFS,ORAMCOM,ORAMCOMP,ORAMCC,ORAMPROV,ORAMLCNT,ORAMTOT,ORAMT
"RTN","ORAM1",227,0)
 .. S ORAMACFS=^ORAM(103,DFN,3,ORJ,0),ORAMCC=$P(ORAMACFS,U,2)
"RTN","ORAM1",228,0)
 .. S ORAMCOM=$P(ORAMACFS,U),$P(ORAMACFS,U)=$$FMTE^XLFDT(ORAMCOM,"2P"),$P(ORAMACFS,U,2)=ORJ
"RTN","ORAM1",229,0)
 .. S ORAMPROV=$P(ORAMACFS,U,10) I +$G(ORAMPROV) S $P(ORAMACFS,U,10)=$P(^VA(200,+ORAMPROV,0),U)
"RTN","ORAM1",230,0)
 .. S ORAMLCNT=+$O(^ORAM(103,DFN,3,ORJ,1,""),-1)
"RTN","ORAM1",231,0)
 .. S ORAMCOMP=$O(^ORAM(103,DFN,3,ORJ,2,""),-1)
"RTN","ORAM1",232,0)
 .. S ORAMT=ORAMLCNT
"RTN","ORAM1",233,0)
 .. S:+$G(ORAMCC) ORAMT=$G(ORAMLCNT)_","_$G(ORAMCOMP)
"RTN","ORAM1",234,0)
 .. S ORAMTOT=$G(ORAMLCNT)+$G(ORAMCOMP)
"RTN","ORAM1",235,0)
 .. I +$G(ORAMTOT) D
"RTN","ORAM1",236,0)
 ... S RESULT(ORAMI)=$G(ORAMT)_"|"_$G(ORAMACFS)
"RTN","ORAM1",237,0)
 ... I +$G(ORAMLCNT) F ORX=(ORAMI+1):1:(ORAMLCNT+ORAMI) S RESULT(ORX)=$G(^ORAM(103,DFN,3,ORJ,1,(ORX-ORAMI),0))
"RTN","ORAM1",238,0)
 ... I +$G(ORAMCC),+$G(ORAMCOMP) D
"RTN","ORAM1",239,0)
 .... S ORAMI=ORX+2,RESULT(ORAMI)="Complications noted:"
"RTN","ORAM1",240,0)
 .... F ORX=(ORAMI+2):1:(ORAMCOMP+ORAMI) D
"RTN","ORAM1",241,0)
 ..... N ORAMCMPL
"RTN","ORAM1",242,0)
 ..... S ORAMCMPL=$G(^ORAM(103,DFN,3,ORJ,2,(ORX-ORAMI),0))
"RTN","ORAM1",243,0)
 ..... S RESULT(ORX)=$S((ORAMCMPL["MB:")!(ORAMCMPL["C:"):$P(ORAMCMPL,":",2),1:ORAMCMPL)
"RTN","ORAM1",244,0)
 .. E  S RESULT(ORAMI+1)="0|"_$G(ORAMACFS)
"RTN","ORAM1",245,0)
 .. S ORAMI=ORX+1
"RTN","ORAM1",246,0)
 Q
"RTN","ORAM1",247,0)
 ;
"RTN","ORAM1",248,0)
LOGIT(RESULT,FSARRAY,ORAMCOMP) ; RPC= ORAM1 LOG
"RTN","ORAM1",249,0)
 N ORAMDATE,ORAMINR,ORAMPTN,ORAMTWD,ORAMLOG,ORAMLOGN,TODAY,TTIME,COUNT,ORAMODFN,ORAMOD,ORAMND,ORAMNEWD,AROW
"RTN","ORAM1",250,0)
 N %,DA,DIK,ORAMDFN,ORAMRSF,R,X
"RTN","ORAM1",251,0)
 S RESULT=0
"RTN","ORAM1",252,0)
 D NOW^%DTC S TODAY=X,TTIME=%
"RTN","ORAM1",253,0)
 ;FIRST GET THE OLD FLOW SHEET DATA AND SAVE TO THE LOG FILE
"RTN","ORAM1",254,0)
 S ORAMDFN=$G(FSARRAY(0)),AROW=$G(FSARRAY(1))
"RTN","ORAM1",255,0)
 S ORAMDATE=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^"),ORAMINR=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",3),ORAMPTN=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",8),ORAMTWD=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",6)
"RTN","ORAM1",256,0)
 S ORAMODFN=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",10),ORAMOD=$P($G(^ORAM(103,ORAMDFN,3,AROW,0)),"^",9)
"RTN","ORAM1",257,0)
 S ORAMLOG="Original FS "_AROW_": DATE="_$G(ORAMDATE)_", INR="_$G(ORAMINR)_", PT NOTIFIED="_$G(ORAMPTN)_", TWD="_$G(ORAMTWD)_"; "_ORAMODFN_" ("_ORAMOD_"): EDITED: "_FSARRAY(6)_"("_TODAY_")"
"RTN","ORAM1",258,0)
 S ORAMLOGN=$P($G(^ORAM(103,ORAMDFN,3,AROW,"LOG",0)),"^",3)+1
"RTN","ORAM1",259,0)
 S ^ORAM(103,ORAMDFN,3,AROW,"LOG",ORAMLOGN,0)=ORAMLOG
"RTN","ORAM1",260,0)
 K ^ORAM(103,ORAMDFN,3,"B",$G(ORAMDATE),AROW)
"RTN","ORAM1",261,0)
 F ORAMRSF=1:1:$P($G(^ORAM(103,ORAMDFN,3,AROW,1,0)),"^",3) S COUNT=ORAMLOGN+ORAMRSF,^ORAM(103,ORAMDFN,3,AROW,"LOG",COUNT,0)=^ORAM(103,ORAMDFN,3,AROW,1,ORAMRSF,0)
"RTN","ORAM1",262,0)
 S ^ORAM(103,ORAMDFN,3,AROW,"LOG",0)="^^"_$G(COUNT)_"^"_$G(COUNT)_"^"_TODAY
"RTN","ORAM1",263,0)
 ;NOW SET NEW INFO FOR THE FLOW SHEET ENTRY
"RTN","ORAM1",264,0)
 ;Array order is: DFN;ARow;date;inr;ptnotified;twd;DUZ;#comment lines;comments
"RTN","ORAM1",265,0)
 S ORAMNEWD=$G(FSARRAY(2)) D DT^DILF(,ORAMNEWD,.X) S ORAMNEWD=X
"RTN","ORAM1",266,0)
 S $P(^ORAM(103,ORAMDFN,3,AROW,0),"^")=$G(ORAMNEWD),$P(^ORAM(103,ORAMDFN,3,AROW,0),"^",3)=$G(FSARRAY(3)),$P(^ORAM(103,ORAMDFN,3,AROW,0),"^",8)=$G(FSARRAY(4)),$P(^ORAM(103,ORAMDFN,3,AROW,0),"^",6)=$G(FSARRAY(5))
"RTN","ORAM1",267,0)
 S $P(^ORAM(103,ORAMDFN,3,AROW,0),"^",2)=$G(ORAMCOMP)
"RTN","ORAM1",268,0)
 S $P(^ORAM(103,ORAMDFN,3,AROW,0),"^",10)=$G(FSARRAY(6)),$P(^ORAM(103,ORAMDFN,3,AROW,0),"^",9)=TTIME
"RTN","ORAM1",269,0)
 I $G(FSARRAY(7))'="" K ^ORAM(103,ORAMDFN,3,AROW,1) F R=1:1:$G(FSARRAY(7)) D
"RTN","ORAM1",270,0)
 . S ^ORAM(103,ORAMDFN,3,AROW,1,R,0)=$G(FSARRAY(R+7))
"RTN","ORAM1",271,0)
 S ^ORAM(103,ORAMDFN,3,AROW,1,0)="^^"_$G(FSARRAY(7))_"^"_$G(FSARRAY(7))_"^"_TODAY_"^"  ;$E(ORAMDT,1,7)_"^"
"RTN","ORAM1",272,0)
 S ^ORAM(103,ORAMDFN,3,"B",$G(ORAMNEWD),AROW)=""
"RTN","ORAM1",273,0)
 S DIK="^ORAM(103,"
"RTN","ORAM1",274,0)
 S DA(1)=ORAMDFN,DA=AROW
"RTN","ORAM1",275,0)
 D IX^DIK
"RTN","ORAM1",276,0)
 S RESULT=1
"RTN","ORAM1",277,0)
 Q
"RTN","ORAM1",278,0)
 ;
"RTN","ORAM1",279,0)
LOCK(RESULT,DATA) ; Locks form   RPC=ORAM1 LOCK
"RTN","ORAM1",280,0)
 N X
"RTN","ORAM1",281,0)
 S RESULT=0
"RTN","ORAM1",282,0)
 Q:$P($G(DATA),"^")=""
"RTN","ORAM1",283,0)
 Q:$D(^ORAM(103,$P(DATA,"^")))=0
"RTN","ORAM1",284,0)
 D NOW^%DTC N ORAMTDAY S ORAMTDAY=X
"RTN","ORAM1",285,0)
 I $P(^ORAM(103,$P(DATA,"^"),0),"^",18,19)="" S $P(^ORAM(103,$P(DATA,"^"),0),"^",18)="^"
"RTN","ORAM1",286,0)
 S $P(^ORAM(103,$P(DATA,"^"),0),"^",19)=1_"|"_$P(^VA(200,$P(DATA,"^",2),0),"^")_"|"_ORAMTDAY,RESULT=1
"RTN","ORAM1",287,0)
 Q
"RTN","ORAM1",288,0)
 ;
"RTN","ORAM1",289,0)
UNLOCK(RESULT,DFN) ; Unlocks form  RPC=ORAM1 UNLOCK
"RTN","ORAM1",290,0)
 S RESULT=0
"RTN","ORAM1",291,0)
 Q:DFN<1
"RTN","ORAM1",292,0)
 Q:$D(^ORAM(103,DFN))=0
"RTN","ORAM1",293,0)
 S $P(^ORAM(103,DFN,0),"^",19)=0,RESULT=1
"RTN","ORAM1",294,0)
 Q
"RTN","ORAM1",295,0)
 ;
"RTN","ORAM1",296,0)
GETPT(RESULT) ; Get Pt list  RPC=ORAM1 PT LIST
"RTN","ORAM1",297,0)
 N ORAMPT
"RTN","ORAM1",298,0)
 S ORAMPT=0 F  S ORAMPT=$O(^ORAM(103,"B",ORAMPT)) Q:ORAMPT=""  D
"RTN","ORAM1",299,0)
 . S RESULT($G(ORAMPT))=$G(ORAMPT)_"^"_$P(^DPT(ORAMPT,0),"^")_"^"_$E($P(^DPT(ORAMPT,0),"^",9),6,9)
"RTN","ORAM1",300,0)
 Q
"RTN","ORAM1",301,0)
 ;
"RTN","ORAM1",302,0)
SETHCT(RESULT,ORAMORD) ; SET HCT LAB ITEM NUMBER
"RTN","ORAM1",303,0)
 Q:'+$G(ORAMORD)
"RTN","ORAM1",304,0)
 N ORAMX,ORAML60,ORAMCH S ORAMX=0 F  S ORAMX=$O(^ORD(101.43,$G(ORAMORD),10,ORAMX)) Q:'+$G(ORAMX)!+$G(ORAMCH)  D
"RTN","ORAM1",305,0)
 . I $P(^ORD(101.43,$G(ORAMORD),10,ORAMX,0),"^")["HCT" S ORAML60=+$P(^(0),"^",2)
"RTN","ORAM1",306,0)
 . I +$G(ORAML60) S ORAMCH=$P($P(^LAB(60,ORAML60,0),"^",5),";",2) S RESULT=ORAMCH
"RTN","ORAM1",307,0)
 Q
"RTN","ORAM1",308,0)
 ;
"RTN","ORAM2")
0^3^B58023259
"RTN","ORAM2",1,0)
ORAM2 ;POR/RSF - ANTICOAGULATION MANAGEMENT RPCS (3 of 4) ;12/19/14  11:39
"RTN","ORAM2",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307,339,354,361,391**;Dec 17, 1997;Build 11
"RTN","ORAM2",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAM2",4,0)
 Q
"RTN","ORAM2",5,0)
 ;
"RTN","ORAM2",6,0)
 ;  External References:
"RTN","ORAM2",7,0)
 ;  $$GET1^DIQ                             ICR #2056
"RTN","ORAM2",8,0)
 ;  $$SETSTR^VALM1                         ICR #10116
"RTN","ORAM2",9,0)
 ;  $$FMADD/$$FMDIFF/$$FMTE/$$NOW^XLFDT    ICR #10103
"RTN","ORAM2",10,0)
 ;  $$TITLE/$$UP^XLFSTR                    ICR #10104
"RTN","ORAM2",11,0)
 ;  $$GET^XPAR                             ICR #2263
"RTN","ORAM2",12,0)
 ;  ^AUTNPOV(                              ICR #1593
"RTN","ORAM2",13,0)
 ;
"RTN","ORAM2",14,0)
ALLGOAL(RESULT,DAYS,CLINIC) ; last inr for all pts seen in last x days
"RTN","ORAM2",15,0)
 ;;RPC = ORAM2 ALLGOAL
"RTN","ORAM2",16,0)
 N ORAMDFN,ORAMNOW,ORAMCUT,ORAMCNT,ORAMPC,ORAMGOOD,ORAMBAD,ORAMBL
"RTN","ORAM2",17,0)
 S ORAMDFN=0,ORAMCNT=0,ORAMGOOD=0,ORAMBAD=0
"RTN","ORAM2",18,0)
 S ORAMNOW=$$NOW^XLFDT
"RTN","ORAM2",19,0)
 S ORAMCUT=$$FMADD^XLFDT(ORAMNOW,-DAYS)
"RTN","ORAM2",20,0)
 F  S ORAMDFN=$O(^ORAM(103,ORAMDFN)) Q:'ORAMDFN  D
"RTN","ORAM2",21,0)
 . N ORAMFS,ORAM3D0,ORAMDATE,ORAMCLIN
"RTN","ORAM2",22,0)
 . S ORAMFS=$O(^ORAM(103,ORAMDFN,3," "),-1) Q:$G(ORAMFS)=""
"RTN","ORAM2",23,0)
 . S ORAMCLIN=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAM2",24,0)
 . I +$G(CLINIC),(ORAMCLIN'=CLINIC) Q
"RTN","ORAM2",25,0)
 . S ORAM3D0=$G(^ORAM(103,ORAMDFN,3,ORAMFS,0)),ORAMDATE=$P(ORAM3D0,"^")
"RTN","ORAM2",26,0)
 . I ($G(ORAMDATE)>$G(ORAMCUT)) D
"RTN","ORAM2",27,0)
 .. N ORAMINR,ORAMGOAL,ORAMGLO,ORAMGHI
"RTN","ORAM2",28,0)
 .. S ORAMINR=$P(ORAM3D0,"^",3),ORAMGOAL=$P(ORAM3D0,"^",12),ORAMGLO=$P(ORAMGOAL,"-"),ORAMGHI=$P(ORAMGOAL,"-",2) S:ORAMGHI[" " ORAMGHI=$P(ORAMGHI," ",2)
"RTN","ORAM2",29,0)
 .. S ORAMGLO=ORAMGLO-(.1*ORAMGLO),ORAMGHI=ORAMGHI+(.1*ORAMGHI)
"RTN","ORAM2",30,0)
 .. S ORAMCNT=ORAMCNT+1
"RTN","ORAM2",31,0)
 .. I (ORAMINR'<ORAMGLO)&(ORAMINR'>ORAMGHI) S ORAMGOOD=ORAMGOOD+1
"RTN","ORAM2",32,0)
 .. E  D
"RTN","ORAM2",33,0)
 ... N ORAMNAME,ORAMSSN,LINE
"RTN","ORAM2",34,0)
 ... S ORAMBAD=ORAMBAD+1,LINE=""
"RTN","ORAM2",35,0)
 ... S ORAMNAME=$P($P(^DPT(ORAMDFN,0),"^"),","),ORAMSSN=$E($P(^DPT(ORAMDFN,0),"^",9),6,9)
"RTN","ORAM2",36,0)
 ... S LINE=$$SETSTR^VALM1(ORAMNAME,LINE,1,15)
"RTN","ORAM2",37,0)
 ... S LINE=$$SETSTR^VALM1("("_ORAMSSN_")",LINE,17,6)
"RTN","ORAM2",38,0)
 ... S LINE=$$SETSTR^VALM1($S(+ORAMINR>0:ORAMINR,1:"N/A"),LINE,25,5)
"RTN","ORAM2",39,0)
 ... S LINE=$$SETSTR^VALM1("("_ORAMGOAL_")",LINE,32,9)
"RTN","ORAM2",40,0)
 ... S RESULT(ORAMBAD)=LINE
"RTN","ORAM2",41,0)
 I ORAMCNT>0 S ORAMPC=$J(((ORAMGOOD/ORAMCNT)*100),3,1)
"RTN","ORAM2",42,0)
 I ORAMBAD'="" S ORAMBL=$L(ORAMBAD,"^"),$P(ORAMBAD,"^",1)=ORAMBL
"RTN","ORAM2",43,0)
 S RESULT(0)=$G(ORAMPC)
"RTN","ORAM2",44,0)
 Q
"RTN","ORAM2",45,0)
 ;
"RTN","ORAM2",46,0)
PTAPPT(RESULT,CLINIC) ; Counts # of pts/day next 45 days
"RTN","ORAM2",47,0)
 ;RPC=ORAM2 PTAPPT
"RTN","ORAM2",48,0)
 N ORAMFDT,ORAMRDT,ORAMCNT
"RTN","ORAM2",49,0)
 S ORAMFDT=$$FMADD^XLFDT(DT,45)_".2359",ORAMRDT=DT
"RTN","ORAM2",50,0)
 F  S ORAMRDT=$O(^ORAM(103,"L",ORAMRDT)) Q:(+ORAMRDT'>0)!(ORAMRDT>ORAMFDT)  D
"RTN","ORAM2",51,0)
 . N ORAMDT,ORAMRD,ORAMDFN
"RTN","ORAM2",52,0)
 . S ORAMDT=$P(ORAMRDT,"."),ORAMRD=$$FMTE^XLFDT(ORAMDT,"2DF"),ORAMDFN=0
"RTN","ORAM2",53,0)
 . F  S ORAMDFN=$O(^ORAM(103,"L",ORAMRDT,ORAMDFN)) Q:'ORAMDFN  D
"RTN","ORAM2",54,0)
 .. N ORAMCLIN S ORAMCLIN=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAM2",55,0)
 .. Q:ORAMCLIN'=$G(CLINIC)
"RTN","ORAM2",56,0)
 .. S ORAMCNT(ORAMDT)=+$G(ORAMCNT(ORAMDT))+1
"RTN","ORAM2",57,0)
 .. S RESULT(ORAMDT)=ORAMRD_" - "_$G(ORAMCNT(ORAMDT))
"RTN","ORAM2",58,0)
PTAPPTQ Q
"RTN","ORAM2",59,0)
 ;
"RTN","ORAM2",60,0)
NOACT(RESULT,DAYS,CLINIC) ; Finds pts w/o AC activity past X days
"RTN","ORAM2",61,0)
 ;RPC=ORAM2 NOACT
"RTN","ORAM2",62,0)
 N ORAMDT,ORAMFDT,ORAMVST,ORAMDFN,ORAMPT,ORAMSSN,ORAMSORT,ORAMC,ORAMI,ORAMMIS,ORAMLAST,ORAMFS,ORMISVST,ORAMCLIN,ORAMDONE,ORAMFSTA
"RTN","ORAM2",63,0)
 S ORAMDT=$$NOW^XLFDT,ORAMFDT=$$FMADD^XLFDT(ORAMDT,-DAYS),ORAMDFN=0
"RTN","ORAM2",64,0)
 F  S ORAMDFN=$O(^ORAM(103,ORAMDFN)) Q:+ORAMDFN'>0  D
"RTN","ORAM2",65,0)
 . S ORAMFS=" ",ORAMLAST=0,ORAMMIS=0,ORAMCLIN=$P($G(^ORAM(103,ORAMDFN,6)),U,2),ORAMDONE=0
"RTN","ORAM2",66,0)
 . Q:(ORAMCLIN'=$G(CLINIC))!(2=$$GET1^DIQ(103,ORAMDFN,15,"I"))
"RTN","ORAM2",67,0)
 . F  S ORAMFS=$O(^ORAM(103,ORAMDFN,3,ORAMFS),-1) Q:(ORAMFS']"")!ORAMDONE  D
"RTN","ORAM2",68,0)
 .. I '$G(ORAMMIS)&$$MISSED(ORAMDFN,ORAMFS) S ORAMMIS=ORAMFS Q
"RTN","ORAM2",69,0)
 .. I '$G(ORAMLAST)&'$$MISSED(ORAMDFN,ORAMFS) S ORAMLAST=ORAMFS,ORAMDONE=1
"RTN","ORAM2",70,0)
 . Q:($$GET1^DIQ(103.011,ORAMLAST_","_ORAMDFN,.01,"I")'<ORAMFDT)
"RTN","ORAM2",71,0)
 . F ORAMFS="ORAMMIS","ORAMLAST" D
"RTN","ORAM2",72,0)
 .. K ORMISVST,ORAMFSTA
"RTN","ORAM2",73,0)
 .. I (ORAMFS="ORAMMIS") S ORMISVST=$$GET1^DIQ(103.011,@ORAMFS_","_ORAMDFN,80,"I"),ORAMFSTA=1
"RTN","ORAM2",74,0)
 .. Q:(ORAMFS="ORAMMIS")&($G(ORMISVST)'>ORAMFDT)
"RTN","ORAM2",75,0)
 .. S ORAMFS=@ORAMFS
"RTN","ORAM2",76,0)
 .. Q:'ORAMFS
"RTN","ORAM2",77,0)
 .. N LINE S LINE=""
"RTN","ORAM2",78,0)
 .. S ORAMPT=$P(^DPT(ORAMDFN,0),"^"),ORAMPT=$P(ORAMPT,","),ORAMSSN=$E($P(^DPT(ORAMDFN,0),"^",9),6,9)
"RTN","ORAM2",79,0)
 .. S ORAMVST=$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),"^")
"RTN","ORAM2",80,0)
 .. I $G(ORMISVST) S ORAMVST=ORMISVST
"RTN","ORAM2",81,0)
 .. S LINE=$$SETSTR^VALM1(ORAMPT,LINE,1,15)
"RTN","ORAM2",82,0)
 .. S LINE=$$SETSTR^VALM1("("_ORAMSSN_")",LINE,17,6)
"RTN","ORAM2",83,0)
 .. S LINE=$$SETSTR^VALM1($S($G(ORAMFSTA):"Missed Ap: ",1:"Last Seen: ")_$$FMTE^XLFDT($P(ORAMVST,"."),"2DF"),LINE,25,19)
"RTN","ORAM2",84,0)
 .. S ORAMSORT($P(ORAMVST,"."),ORAMPT_ORAMSSN)=LINE
"RTN","ORAM2",85,0)
 S (ORAMC,ORAMI)=0
"RTN","ORAM2",86,0)
 F  S ORAMI=$O(ORAMSORT(ORAMI)) Q:+ORAMI'>0  D
"RTN","ORAM2",87,0)
 . N ORAMJ S ORAMJ=""
"RTN","ORAM2",88,0)
 . F  S ORAMJ=$O(ORAMSORT(ORAMI,ORAMJ)) Q:ORAMJ']""  D
"RTN","ORAM2",89,0)
 .. S ORAMC=ORAMC+1,RESULT(ORAMC)=$G(ORAMSORT(ORAMI,ORAMJ))
"RTN","ORAM2",90,0)
 I ORAMC=0 S RESULT(0)="No patients lost to follow-up "_DAYS_" days or longer."
"RTN","ORAM2",91,0)
NOACTQ Q
"RTN","ORAM2",92,0)
 ;
"RTN","ORAM2",93,0)
MISSED(DFN,FS) ;*354 Added
"RTN","ORAM2",94,0)
 ;Input DFN -> Patient IEN
"RTN","ORAM2",95,0)
 ;      FS  -> FlowSheet IEN
"RTN","ORAM2",96,0)
 ;Output 1 if this flowsheet entry was a missed appt.
"RTN","ORAM2",97,0)
 ;       0 if this flowsheet entry was not a missed appt.
"RTN","ORAM2",98,0)
 ;
"RTN","ORAM2",99,0)
 N ORAMCM,IENS,I,RSLT
"RTN","ORAM2",100,0)
 Q:'$G(DFN)!'$G(FS) 0
"RTN","ORAM2",101,0)
 S IENS=FS_","_DFN_",",(I,RSLT)=0
"RTN","ORAM2",102,0)
 I $$GET1^DIQ(103.011,IENS,99,"","ORAMCM")="" Q RSLT
"RTN","ORAM2",103,0)
 F  S I=$O(ORAMCM(I)) Q:'I!RSLT  I ORAMCM(I)["Missed Appt; return:" S RSLT=1
"RTN","ORAM2",104,0)
 Q RSLT
"RTN","ORAM2",105,0)
 ;
"RTN","ORAM2",106,0)
SHOWRATE(RESULT,DFN) ; CALCULATES SHOWRATE
"RTN","ORAM2",107,0)
 ;;RPC=ORAM2 NOSHOW
"RTN","ORAM2",108,0)
 N ORAMFSDT,ORAMFS,ORAMR,ORAMARR,ORAMPC,ORAMPTT0,ORAMRDT,ORAMRDT0
"RTN","ORAM2",109,0)
 S ORAMR=0,ORAMPTT0=0,ORAMRDT0=""
"RTN","ORAM2",110,0)
 S ORAMFSDT=0 F  S ORAMFSDT=$O(^ORAM(103,DFN,3,"B",ORAMFSDT)) Q:'ORAMFSDT  D
"RTN","ORAM2",111,0)
 . S ORAMFS=0 F  S ORAMFS=$O(^ORAM(103,DFN,3,"B",ORAMFSDT,ORAMFS)) Q:'ORAMFS  D
"RTN","ORAM2",112,0)
 .. N ORAMD0,ORAMSD,ORAMSCR,ORAMPTT,ORAMLCNT,ORAMLLN,ORAMDIFF
"RTN","ORAM2",113,0)
 .. S ORAMD0=$G(^ORAM(103,DFN,3,ORAMFS,0)),ORAMSCR=$P(ORAMD0,"^",13),ORAMSD=$P($P(ORAMD0,"^"),"."),ORAMPTT=$P(ORAMD0,"^",3)
"RTN","ORAM2",114,0)
 .. S ORAMLCNT=$P($G(^ORAM(103,DFN,3,ORAMFS,1,0)),"^",3) Q:'ORAMLCNT
"RTN","ORAM2",115,0)
 .. S ORAMLLN=$G(^ORAM(103,DFN,3,ORAMFS,1,ORAMLCNT,0))
"RTN","ORAM2",116,0)
 .. S ORAMRDT=$S($G(ORAMLLN)["Next draw:":$P($G(ORAMLLN)," ",3),$G(ORAMLLN)["Callback:":"C",$G(ORAMLLN)["Missed Appt;":"M",$G(ORAMLLN)["Edited by:":"E",1:$P($G(ORAMLLN)," "))
"RTN","ORAM2",117,0)
 .. I ORAMRDT="E" S ORAMLCNT=ORAMLCNT-1,ORAMLLN=$G(^ORAM(103,DFN,3,ORAMFS,1,ORAMLCNT,0))
"RTN","ORAM2",118,0)
 .. I  S ORAMRDT=$S($G(ORAMLLN)["Next draw:":$P($G(ORAMLLN)," ",3),$G(ORAMLLN)["Callback:":$P($G(ORAMLLN)," ",2),$G(ORAMLLN)["Missed Appt;":"Q",1:$P($G(ORAMLLN)," "))
"RTN","ORAM2",119,0)
 .. I ORAMRDT="M" S ORAMRDT=$P($G(ORAMLLN)," ",4),ORAMR=ORAMR+1 D DT^DILF("T",ORAMRDT,.ORAMRDT) S ORAMRDT0=ORAMRDT Q  ;NOTE PT MISSED DRAW, ADD ONE TO DENOMINATOR
"RTN","ORAM2",120,0)
 .. I $L(ORAMRDT)>1 D DT^DILF("T",ORAMRDT,.ORAMRDT)
"RTN","ORAM2",121,0)
 .. I ORAMRDT="C" S ORAMRDT=$P($G(ORAMLLN)," ",2) D DT^DILF("T",ORAMRDT,.ORAMRDT) S ORAMRDT=$$FMADD^XLFDT(ORAMRDT,-1)
"RTN","ORAM2",122,0)
 .. I 'ORAMPTT!($G(ORAMPTT0)=$G(ORAMPTT)) S ORAMRDT0=ORAMRDT Q
"RTN","ORAM2",123,0)
 .. S ORAMPTT0=ORAMPTT
"RTN","ORAM2",124,0)
 .. I ORAMRDT0'="" S ORAMDIFF=$$FMDIFF^XLFDT(ORAMSD,ORAMRDT0,2) S ORAMR=ORAMR+1 I ORAMDIFF>-172801&(ORAMDIFF<172801) S ORAMARR(0)=$G(ORAMARR(0))+1
"RTN","ORAM2",125,0)
 .. S ORAMRDT0=ORAMRDT
"RTN","ORAM2",126,0)
 I ORAMR>0 S ORAMPC=($G(ORAMARR(0))/ORAMR)*100,ORAMPC=$E(ORAMPC,1,4)
"RTN","ORAM2",127,0)
 S RESULT=$G(ORAMPC)_"^"_$G(ORAMR)
"RTN","ORAM2",128,0)
 Q
"RTN","ORAM2",129,0)
 ;
"RTN","ORAM2",130,0)
RPTSTART(ROOT,DFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,MAX,ORFHIE) ;
"RTN","ORAM2",131,0)
 ;;
"RTN","ORAM2",132,0)
 D START^ORWRP(80,"RPT^ORAM2(.ROOT,.DFN,.ID,.ALPHA,.OMEGA,.DTRANGE,.REMOTE,.MAX,.ORFHIE)",999)
"RTN","ORAM2",133,0)
 Q
"RTN","ORAM2",134,0)
 ;
"RTN","ORAM2",135,0)
RPT(ROOT,DFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,MAX,ORFHIE) ; Generate report for CPRS
"RTN","ORAM2",136,0)
 D RPT^ORAMX1(.ROOT,$G(DFN),$G(ID),$G(ALPHA),$G(OMEGA),$G(DTRANGE),$G(REMOTE),$G(MAX),$G(ORFHIE))
"RTN","ORAM2",137,0)
 Q
"RTN","ORAM2",138,0)
 ;
"RTN","ORAM2",139,0)
DTCHK(DFN,ALPHA,OMEGA,ORAMFSD) ; CHECKS DATE RANGE WITH ALPHA AND OMEGA FROM CPRS
"RTN","ORAM2",140,0)
 N ORAMFDT,ORAMVAL
"RTN","ORAM2",141,0)
 S ORAMVAL=0
"RTN","ORAM2",142,0)
 S ORAMFDT=$P(^ORAM(103,DFN,3,ORAMFSD,0),"^")
"RTN","ORAM2",143,0)
 S:ORAMFDT'<ALPHA ORAMVAL=1
"RTN","ORAM2",144,0)
 S:ORAMFDT>OMEGA ORAMVAL=0
"RTN","ORAM2",145,0)
 Q ORAMVAL
"RTN","ORAM2",146,0)
 ;
"RTN","ORAM2",147,0)
TEAMCHK(RESULT,ORAMTMS) ; SET-UP VERIFY NAMES
"RTN","ORAM2",148,0)
 ;RPC=ORAM2 TEAM CHECK
"RTN","ORAM2",149,0)
 N ORAMSKIP,ORAMI,ORAMERR
"RTN","ORAM2",150,0)
 Q:$G(ORAMTMS)=""
"RTN","ORAM2",151,0)
 F ORAMI=1:1:20 S ORAMSKIP=$G(ORAMSKIP)_" "
"RTN","ORAM2",152,0)
 S ORAMERR=0
"RTN","ORAM2",153,0)
 F ORAMI=1:1:$L(ORAMTMS,"^") D
"RTN","ORAM2",154,0)
 . N ORAMN
"RTN","ORAM2",155,0)
 . I $P(ORAMTMS,"^",ORAMI)'="" S ORAMN=$P(ORAMTMS,"^",ORAMI) D
"RTN","ORAM2",156,0)
 .. S RESULT(ORAMI)=ORAMN_$E(ORAMSKIP,1,(20-$L(ORAMN)))
"RTN","ORAM2",157,0)
 .. I $D(^OR(100.21,ORAMN)) S RESULT(ORAMI)=RESULT(ORAMI)_$P(^OR(100.21,ORAMN,0),"^")
"RTN","ORAM2",158,0)
 .. E  S RESULT(ORAMI)=RESULT(ORAMI)_"clinic not found.",ORAMERR=$G(ORAMERR)+1
"RTN","ORAM2",159,0)
 S RESULT(0)=$G(ORAMERR)
"RTN","ORAM2",160,0)
 Q
"RTN","ORAM2",161,0)
 ;
"RTN","ORAM2",162,0)
REMIND(RESULT,ORAMDFN,ORAMDT,ORAMREM) ; RPC=ORAM2 REMINDER
"RTN","ORAM2",163,0)
 N ORAMRML,ORAMDAY,ORAMR,D0,DA,DIK,X
"RTN","ORAM2",164,0)
 Q:'+$G(ORAMDFN)  Q:$G(ORAMDT)=""  Q:$G(ORAMREM)=""
"RTN","ORAM2",165,0)
 S RESULT=0
"RTN","ORAM2",166,0)
 D NOW^%DTC S ORAMDAY=X D DT^DILF(,ORAMDT,.X) S ORAMDT=X
"RTN","ORAM2",167,0)
 S $P(^ORAM(103,ORAMDFN,0),"^",18)=$G(ORAMDT)
"RTN","ORAM2",168,0)
 K ^ORAM(103,ORAMDFN,5)
"RTN","ORAM2",169,0)
 S ORAMRML=$L(ORAMREM,"^"),^ORAM(103,ORAMDFN,5,0)="^^"_ORAMRML_"^"_ORAMRML_"^"_ORAMDAY_"^"
"RTN","ORAM2",170,0)
 F ORAMR=1:1:ORAMRML D
"RTN","ORAM2",171,0)
 . S ^ORAM(103,ORAMDFN,5,ORAMR,0)=$P(ORAMREM,"^",ORAMR)
"RTN","ORAM2",172,0)
 S DIK="^ORAM(103,",DA=ORAMDFN
"RTN","ORAM2",173,0)
 D IX^DIK
"RTN","ORAM2",174,0)
 S RESULT=1
"RTN","ORAM2",175,0)
 Q
"RTN","ORAMSET")
0^1^B59301848
"RTN","ORAMSET",1,0)
ORAMSET ; ISL/JER - Anticoagulation Setup ;11/20/14  11:12
"RTN","ORAMSET",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307,361,391**;Dec 17, 1997;Build 11
"RTN","ORAMSET",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAMSET",4,0)
 Q
"RTN","ORAMSET",5,0)
 ;
"RTN","ORAMSET",6,0)
 ;  External References:
"RTN","ORAMSET",7,0)
 ;  $$GET1^DIQ             ICR #2056
"RTN","ORAMSET",8,0)
 ;  $$FMDIFF/$$NOW^XLFDT   ICR #10103
"RTN","ORAMSET",9,0)
 ;  $$TITLE^XLFSTR         ICR #10104
"RTN","ORAMSET",10,0)
 ;  $$GET^XPAR             ICR #2263
"RTN","ORAMSET",11,0)
 ;  $$KSP^XUPARAM          ICR #2541
"RTN","ORAMSET",12,0)
 ;
"RTN","ORAMSET",13,0)
SET ; Enter Parameters
"RTN","ORAMSET",14,0)
 N ORAMDIV,ORAMPARM,DIRUT,DUOUT,DTOUT,ORT0,ORAMTOUT K DIROUT
"RTN","ORAMSET",15,0)
 S ORAMDIV=$$GETDIV Q:+ORAMDIV'>0
"RTN","ORAMSET",16,0)
 S ORT0=$$NOW^XLFDT
"RTN","ORAMSET",17,0)
 D TED^XPAREDIT("ORAM PARAMETERS","B",ORAMDIV) Q:+$G(DIROUT)!+$$TIMEOUT(ORT0)
"RTN","ORAMSET",18,0)
 ; If Consult Link Enabled, ask Consult Request Service
"RTN","ORAMSET",19,0)
 I +$$GET^XPAR(ORAMDIV,"ORAM CONSULT LINK ENABLED") D  Q:+$D(DUOUT)!+$D(DTOUT)
"RTN","ORAMSET",20,0)
 . S ORAMPARM=+$$GETPARM("ORAM CONSULT REQUEST SERVICE")_U_"Consult Request Service" Q:+ORAMPARM'>0
"RTN","ORAMSET",21,0)
 . D EDIT^XPAREDIT(ORAMDIV,ORAMPARM)
"RTN","ORAMSET",22,0)
 ; Ask PCE Link Enabled
"RTN","ORAMSET",23,0)
 S ORAMPARM=+$$GETPARM("ORAM PCE LINK ENABLED")_U_"PCE Link Enabled" Q:+ORAMPARM'>0
"RTN","ORAMSET",24,0)
 D EDIT^XPAREDIT(ORAMDIV,ORAMPARM) Q:+$G(DIROUT)!+$G(DIRUT)!+$D(DTOUT)
"RTN","ORAMSET",25,0)
 ; Continue with PCE Parameter Template if TRUE
"RTN","ORAMSET",26,0)
 I +$$GET^XPAR(ORAMDIV,"ORAM PCE LINK ENABLED") D  Q:+$G(DIROUT)!+$G(ORAMTOUT)
"RTN","ORAMSET",27,0)
 . S ORT0=$$NOW^XLFDT
"RTN","ORAMSET",28,0)
 . D TED^XPAREDIT("ORAM PCE PARAMETERS","B",ORAMDIV)
"RTN","ORAMSET",29,0)
 . S ORAMTOUT=$$TIMEOUT(ORT0)
"RTN","ORAMSET",30,0)
 ; Continue with Letter Template
"RTN","ORAMSET",31,0)
 D TED^XPAREDIT("ORAM LETTER PARAMETERS","B",ORAMDIV)
"RTN","ORAMSET",32,0)
 Q
"RTN","ORAMSET",33,0)
 ;
"RTN","ORAMSET",34,0)
SETDIV ; Enter Site Parameters
"RTN","ORAMSET",35,0)
 N ORAMDIV,DIRUT,DUOUT,DTOUT K DIROUT
"RTN","ORAMSET",36,0)
 S ORAMDIV=$$GETDIV Q:+ORAMDIV'>0
"RTN","ORAMSET",37,0)
 D TED^XPAREDIT("ORAM SITE PARAMETERS","BA",ORAMDIV)
"RTN","ORAMSET",38,0)
 Q
"RTN","ORAMSET",39,0)
 ;
"RTN","ORAMSET",40,0)
SETCLIN ; Enter Clinic Parameters
"RTN","ORAMSET",41,0)
 N ORAMCLIN,DIRUT,DUOUT,DTOUT K DIROUT
"RTN","ORAMSET",42,0)
 S ORAMCLIN=$$SELLOC Q:+ORAMCLIN'>0
"RTN","ORAMSET",43,0)
 D TED^XPAREDIT("ORAM CLINIC PARAMETERS","BA",ORAMCLIN)
"RTN","ORAMSET",44,0)
 Q
"RTN","ORAMSET",45,0)
 ;
"RTN","ORAMSET",46,0)
TIMEOUT(T0) ; Evaluate whether TED^XPAREDIT timed-out (since it NEWs DTOUT and DIRUT)
"RTN","ORAMSET",47,0)
 Q $S($$FMDIFF^XLFDT($$NOW^XLFDT,T0,2)'<DTIME:1,1:0)
"RTN","ORAMSET",48,0)
 ;
"RTN","ORAMSET",49,0)
GETCLINS(RESULT) ; Get Clinics
"RTN","ORAMSET",50,0)
 N LIST,ERR,ORAME,ORAMI S ORAME="",ORAMI=0
"RTN","ORAMSET",51,0)
 D ENVAL^XPAR(.LIST,"ORAM CLINIC NAME",1,.ERR)
"RTN","ORAMSET",52,0)
 I 'LIST S RESULT(0)=0 Q
"RTN","ORAMSET",53,0)
 F  S ORAME=$O(LIST(ORAME)) Q:ORAME']""  D
"RTN","ORAMSET",54,0)
 . N ORAMV S ORAMV=$G(LIST(ORAME,1)) Q:ORAMV']""
"RTN","ORAMSET",55,0)
 . S ORAMI=ORAMI+1,RESULT(ORAMI)=ORAMV_U_ORAME
"RTN","ORAMSET",56,0)
 . S RESULT(0)=ORAMI
"RTN","ORAMSET",57,0)
 Q
"RTN","ORAMSET",58,0)
 ;
"RTN","ORAMSET",59,0)
CLIN4PT(RESULT,ORAMDFN) ; Get the Clinic which is following the patient
"RTN","ORAMSET",60,0)
 N ORAMCL
"RTN","ORAMSET",61,0)
 S ORAMCL=$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAMSET",62,0)
 S RESULT=$S(+ORAMCL>0:ORAMCL_";SC(",1:0)
"RTN","ORAMSET",63,0)
 Q
"RTN","ORAMSET",64,0)
 ;
"RTN","ORAMSET",65,0)
GET(RESULT,ORAMENT,ORVDT) ; Get Parameters
"RTN","ORAMSET",66,0)
 N ADD1,ADD2,ADD3,DNOTE,ENOTE,INOTE,ATEAM,CBCQO,CTEAM,CFAX,CPHONE,ORAMALL,IMPLDT,ICDCP
"RTN","ORAMSET",67,0)
 N CENAB,CSVC,CPLXPH,IVST,LTR,ORIENT,SMPLPH,SVST,DSSID,DSSUNIT,HCT,HCTNM,NLABTM,TOLLFREE
"RTN","ORAMSET",68,0)
 N INRQO,MCNM,NCLOC,PCEON,PHCLIN,POCNM,RPATH,SIGNM,SIGTTL,SITENM,VLOC,PILLSTR,ICDC,DPIND
"RTN","ORAMSET",69,0)
 N SICDC,DSIND,ICDCS
"RTN","ORAMSET",70,0)
 S ORVDT=$G(ORVDT,DT),ICDCS="ICD-9-CM"
"RTN","ORAMSET",71,0)
 S IMPLDT=$$IMPDATE^LEXU("10D")
"RTN","ORAMSET",72,0)
 S ORAMENT=$S($G(ORAMENT)]"":$G(ORAMENT),1:"ALL"),DPIND=""
"RTN","ORAMSET",73,0)
 S ORAMALL=$S(ORAMENT["ALL":ORAMENT,1:"ALL^"_ORAMENT)
"RTN","ORAMSET",74,0)
 S ADD1=$$GET^XPAR(ORAMENT,"ORAM ADDRESS LINE 1",1,"I")
"RTN","ORAMSET",75,0)
 S ADD2=$$GET^XPAR(ORAMENT,"ORAM ADDRESS LINE 2",1,"I")
"RTN","ORAMSET",76,0)
 S ADD3=$$GET^XPAR(ORAMENT,"ORAM ADDRESS LINE 3",1,"I")
"RTN","ORAMSET",77,0)
 S DNOTE=$$GET^XPAR(ORAMALL,"ORAM DISCHARGE NOTE",1,"I")
"RTN","ORAMSET",78,0)
 S ENOTE=$$GET^XPAR(ORAMALL,"ORAM INTERIM NOTE",1,"I")
"RTN","ORAMSET",79,0)
 S INOTE=$$GET^XPAR(ORAMALL,"ORAM INITIAL NOTE",1,"I")
"RTN","ORAMSET",80,0)
 S ATEAM=$$GET^XPAR(ORAMENT,"ORAM TEAM LIST (ALL)",1,"I")
"RTN","ORAMSET",81,0)
 S CTEAM=$$GET^XPAR(ORAMENT,"ORAM TEAM LIST (COMPLEX)",1,"I")
"RTN","ORAMSET",82,0)
 S CBCQO=$$GET^XPAR(ORAMALL,"ORAM CBC QUICK ORDER",1,"I")
"RTN","ORAMSET",83,0)
 S CFAX=$$GET^XPAR(ORAMENT,"ORAM CLINIC FAX NUMBER",1,"I")
"RTN","ORAMSET",84,0)
 S CPHONE=$$GET^XPAR(ORAMENT,"ORAM CLINIC PHONE NUMBER",1,"I")
"RTN","ORAMSET",85,0)
 S TOLLFREE=$$GET^XPAR(ORAMENT,"ORAM TOLL FREE PHONE",1,"I")
"RTN","ORAMSET",86,0)
 S CENAB=$$GET^XPAR(ORAMENT,"ORAM CONSULT LINK ENABLED",1,"I")
"RTN","ORAMSET",87,0)
 S CSVC=$$GET^XPAR(ORAMENT,"ORAM CONSULT REQUEST SERVICE",1,"E")
"RTN","ORAMSET",88,0)
 S CPLXPH=$$GET^XPAR(ORAMALL,"ORAM CPT FOR COMPLEX PHONE",1,"I")
"RTN","ORAMSET",89,0)
 S IVST=$$GET^XPAR(ORAMALL,"ORAM CPT FOR INITIAL VISIT",1,"I")
"RTN","ORAMSET",90,0)
 S LTR=$$GET^XPAR(ORAMALL,"ORAM CPT FOR LETTER TO PT",1,"I")
"RTN","ORAMSET",91,0)
 S ORIENT=$$GET^XPAR(ORAMALL,"ORAM CPT FOR ORIENTATION",1,"I")
"RTN","ORAMSET",92,0)
 S SMPLPH=$$GET^XPAR(ORAMALL,"ORAM CPT FOR SIMPLE PHONE",1,"I")
"RTN","ORAMSET",93,0)
 S SVST=$$GET^XPAR(ORAMALL,"ORAM CPT FOR SUBSEQUENT VISIT",1,"I")
"RTN","ORAMSET",94,0)
 S DSSID=$$GET^XPAR(ORAMALL,"ORAM DSS ID",1,"I")
"RTN","ORAMSET",95,0)
 S DSSUNIT=$$GET^XPAR(ORAMALL,"ORAM DSS UNIT",1,"I")
"RTN","ORAMSET",96,0)
 S HCT=$$GET^XPAR(ORAMALL,"ORAM HCT/HGB REFERENCE",1,"B")
"RTN","ORAMSET",97,0)
 S HCTNM=$P(HCT,U,2)
"RTN","ORAMSET",98,0)
 S HCT=$P(HCT,U)
"RTN","ORAMSET",99,0)
 S INRQO=$$GET^XPAR(ORAMALL,"ORAM INR QUICK ORDER",1,"I")
"RTN","ORAMSET",100,0)
 S MCNM=$$GET^XPAR(ORAMALL,"ORAM MEDICAL CENTER NAME",1,"I")
"RTN","ORAMSET",101,0)
 S NCLOC=$$GET^XPAR(ORAMENT,"ORAM NON-COUNT LOCATION",1,"I")
"RTN","ORAMSET",102,0)
 S PCEON=$$GET^XPAR(ORAMENT,"ORAM PCE LINK ENABLED",1,"I")
"RTN","ORAMSET",103,0)
 ; If I10 not yet implemented use I9 auto-prim indic, else use I10
"RTN","ORAMSET",104,0)
 I (IMPLDT>ORVDT) D  I 1
"RTN","ORAMSET",105,0)
 . S ICDC=$$GET^XPAR(ORAMENT,"ORAM AUTO PRIMARY INDICATION",1,"E"),ICDCS="ICD-9-CM"
"RTN","ORAMSET",106,0)
 E  D
"RTN","ORAMSET",107,0)
 . S ICDC=$$GET^XPAR(ORAMENT,"ORAM I10 AUTO PRIM INDICATION",1,"E"),ICDCS="ICD-10-CM"
"RTN","ORAMSET",108,0)
 I ICDC]"" D  I 1
"RTN","ORAMSET",109,0)
 . N ICDDESC
"RTN","ORAMSET",110,0)
 . D ICDDESC^ICDXCODE("DIAGNOSIS",ICDC,DT,.ICDDESC)
"RTN","ORAMSET",111,0)
 . S DPIND=ICDC_U_$$TITLE^XLFSTR($G(ICDDESC(1)))_" ("_ICDCS_" "_ICDC_")"
"RTN","ORAMSET",112,0)
 E  S DPIND="^"
"RTN","ORAMSET",113,0)
 ; If I10 not yet implemented use I9 auto-secondary indic, else use I10
"RTN","ORAMSET",114,0)
 I (IMPLDT>ORVDT) D  I 1
"RTN","ORAMSET",115,0)
 . S SICDC=$$GET^XPAR(ORAMENT,"ORAM AUTO SECONDARY INDICATION",1,"E"),ICDCS="ICD-9-CM"
"RTN","ORAMSET",116,0)
 E  D
"RTN","ORAMSET",117,0)
 . S SICDC=$$GET^XPAR(ORAMENT,"ORAM I10 AUTO SEC INDICATION",1,"E"),ICDCS="ICD-10-CM"
"RTN","ORAMSET",118,0)
 I SICDC]"" D  I 1
"RTN","ORAMSET",119,0)
 . N ICDDESC
"RTN","ORAMSET",120,0)
 . D ICDDESC^ICDXCODE("DIAGNOSIS",SICDC,DT,.ICDDESC)
"RTN","ORAMSET",121,0)
 . S DSIND=SICDC_U_$$TITLE^XLFSTR($G(ICDDESC(1)))_" ("_ICDCS_" "_SICDC_")"
"RTN","ORAMSET",122,0)
 E  S DSIND="^"
"RTN","ORAMSET",123,0)
 S PHCLIN=$$GET^XPAR(ORAMENT,"ORAM PHONE CLINIC",1,"I")
"RTN","ORAMSET",124,0)
 S PILLSTR=$$GET^XPAR(ORAMENT,"ORAM DEFAULT PILL STRENGTH",1,"I")
"RTN","ORAMSET",125,0)
 S NLABTM=$$GET^XPAR(ORAMENT,"ORAM INCL TIME W/NEXT INR DATE",1,"I")
"RTN","ORAMSET",126,0)
 S POCNM=$$GET^XPAR(ORAMENT,"ORAM POINT OF CONTACT NAME",1,"I")
"RTN","ORAMSET",127,0)
 S RPATH=$$GET^XPAR(ORAMALL,"ORAM RAV FILE PATH",1,"I")
"RTN","ORAMSET",128,0)
 S SIGNM=$$GET^XPAR(ORAMENT,"ORAM SIGNATURE BLOCK NAME",1,"I")
"RTN","ORAMSET",129,0)
 S SIGTTL=$$GET^XPAR(ORAMENT,"ORAM SIGNATURE BLOCK TITLE",1,"I")
"RTN","ORAMSET",130,0)
 S SITENM=$$GET^XPAR(ORAMENT,"ORAM CLINIC NAME",1,"I")
"RTN","ORAMSET",131,0)
 S VLOC=$$GET^XPAR(ORAMENT,"ORAM VISIT LOCATION",1,"I")
"RTN","ORAMSET",132,0)
 S RESULT(0)=SITENM_U_ATEAM_U_CTEAM_U_INOTE_U_ENOTE_U_DNOTE_U_SMPLPH_U_SVST_U_CPLXPH_U_ORIENT_U_IVST_U_CENAB_U_PCEON_U_LTR_U_U_ADD1_U_ADD2_U_ADD3
"RTN","ORAMSET",133,0)
 S RESULT(1)=SIGNM_U_SIGTTL_U_POCNM_U_CPHONE_"|"_CFAX_U_MCNM_U_PILLSTR_U_NLABTM_U_TOLLFREE
"RTN","ORAMSET",134,0)
 S RESULT(2)=VLOC_"|"_PHCLIN_"|"_NCLOC_U_INRQO_"|"_CBCQO_U_DUZ(2)_U_DSSUNIT_U_DSSID_U_CSVC_U_HCT_"|"_HCTNM_U_RPATH_U_DPIND_U_(IMPLDT'>ORVDT)
"RTN","ORAMSET",135,0)
 S RESULT(3)=DSIND
"RTN","ORAMSET",136,0)
 Q
"RTN","ORAMSET",137,0)
 ;
"RTN","ORAMSET",138,0)
INDICS(RESULT,ORVDT) ; RPC To Get indications for care
"RTN","ORAMSET",139,0)
 N IMPLDT
"RTN","ORAMSET",140,0)
 S ORVDT=$G(ORVDT,DT)
"RTN","ORAMSET",141,0)
 S IMPLDT=$$IMPDATE^LEXU("10D")
"RTN","ORAMSET",142,0)
 ; If I10 not yet implemented use I9 auto-prim indic, else use I10
"RTN","ORAMSET",143,0)
 I (IMPLDT>ORVDT) D  I 1
"RTN","ORAMSET",144,0)
 . D GETLST^XPAR(.RESULT,"SYS^PKG","ORAM INDICATIONS FOR CARE","E")
"RTN","ORAMSET",145,0)
 E  D
"RTN","ORAMSET",146,0)
 . D GETLST^XPAR(.RESULT,"SYS^PKG","ORAM I10 INDICATIONS FOR CARE","E")
"RTN","ORAMSET",147,0)
 I +RESULT'>0 S RESULT(0)=0
"RTN","ORAMSET",148,0)
 Q
"RTN","ORAMSET",149,0)
 ;
"RTN","ORAMSET",150,0)
GETDIV() ; get division
"RTN","ORAMSET",151,0)
 N DIV,ORAMY
"RTN","ORAMSET",152,0)
 S DIV=$$KSP^XUPARAM("INST"),ORAMY=0
"RTN","ORAMSET",153,0)
 I $$GET1^DIQ(4,DIV_",",5,"I")'="Y" S ORAMY=DIV_";DIC(4," I 1
"RTN","ORAMSET",154,0)
 E  S ORAMY=$$SELDIV
"RTN","ORAMSET",155,0)
 Q ORAMY
"RTN","ORAMSET",156,0)
SELDIV() ; select division
"RTN","ORAMSET",157,0)
 N DIC,X,Y
"RTN","ORAMSET",158,0)
 W !!,"Enter Anticoagulation Management Parameters by Division:",!
"RTN","ORAMSET",159,0)
 S DIC=4,DIC(0)="AEMQ",DIC("S")="I +$O(^DG(40.8,""AD"",+Y,0))"
"RTN","ORAMSET",160,0)
 D ^DIC S:+Y>0 Y=+Y_";DIC(4,"
"RTN","ORAMSET",161,0)
 Q Y
"RTN","ORAMSET",162,0)
SELLOC() ; select hospital location
"RTN","ORAMSET",163,0)
 N DIC,X,Y,TIUAPDT S DIC=44,DIC(0)="AEMQ"
"RTN","ORAMSET",164,0)
 S DIC("A")="Select CLINIC: "
"RTN","ORAMSET",165,0)
 S DIC("S")="I $$GOODLOC^ORAMSET(Y)"
"RTN","ORAMSET",166,0)
 D ^DIC K DIC("S") S:+Y>0 Y=+Y_";SC("
"RTN","ORAMSET",167,0)
 Q Y
"RTN","ORAMSET",168,0)
GOODLOC(LOC) ; Returns 1 if ^SC hospital location IFN LOC is good, else 0
"RTN","ORAMSET",169,0)
 N GOODLOC,INACTIVE,OOS,CLINIC,NONCOUNT S (GOODLOC,INACTIVE,NONCOUNT)=0
"RTN","ORAMSET",170,0)
 I +$G(^SC(LOC,"I"))>0,(+$G(^("I"))'>DT) D
"RTN","ORAMSET",171,0)
 . S INACTIVE=1
"RTN","ORAMSET",172,0)
 . ; check if reactivated:
"RTN","ORAMSET",173,0)
 . I +$P($G(^("I")),U,2)>0,$P($G(^("I")),U,2)'>DT S INACTIVE=0
"RTN","ORAMSET",174,0)
 S OOS=+$D(^SC(LOC,"OOS")) ; Occasion of service
"RTN","ORAMSET",175,0)
 S CLINIC=+($P(^SC(LOC,0),U,3)="C")
"RTN","ORAMSET",176,0)
 S NONCOUNT=$S($P(^SC(LOC,0),U,17)="Y":1,1:0)
"RTN","ORAMSET",177,0)
 I 'INACTIVE,'OOS,'NONCOUNT,CLINIC S GOODLOC=1
"RTN","ORAMSET",178,0)
 Q GOODLOC
"RTN","ORAMSET",179,0)
GETPARM(X) ; Get parameter as IEN^NAME
"RTN","ORAMSET",180,0)
 N DIC,Y S DIC=8989.51,DIC(0)="MQ"
"RTN","ORAMSET",181,0)
 D ^DIC
"RTN","ORAMSET",182,0)
 Q Y
"RTN","ORAMSET",183,0)
GETCMPDT(CODESYS) ; Returns compare date for indication set-up
"RTN","ORAMSET",184,0)
 N Y,IDT
"RTN","ORAMSET",185,0)
 S CODESYS=$G(CODESYS,"10D"),Y=DT
"RTN","ORAMSET",186,0)
 S IDT=$$IMPDATE^LEXU("10D")
"RTN","ORAMSET",187,0)
 S Y=$S(CODESYS="10D":IDT,1:+$$FMADD^XLFDT(IDT,-1))
"RTN","ORAMSET",188,0)
 Q Y
"RTN","ORAMSET",189,0)
ISCODEOK(CODE,CODESYS) ; Boolean - is code active as of compare date for code system
"RTN","ORAMSET",190,0)
 N Y,CDT,CODESTAT
"RTN","ORAMSET",191,0)
 S CODESYS=$G(CODESYS,"10D"),Y=0
"RTN","ORAMSET",192,0)
 S CDT=$$GETCMPDT(CODESYS)
"RTN","ORAMSET",193,0)
 S CODESTAT=$$STATCHK^ICDEX(CODE,CDT,CODESYS)
"RTN","ORAMSET",194,0)
 I +CODESTAT=1,(+$P(CODESTAT,U,3)>0),($P(CODESTAT,U,3)'>CDT) S Y=1
"RTN","ORAMSET",195,0)
 Q Y
"RTN","ORAMX")
0^4^B169673089
"RTN","ORAMX",1,0)
ORAMX ;POR/RSF - ADDITIONAL ANTICOAGULATION CALLS ;11/10/14  10:28
"RTN","ORAMX",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**307,339,361,391**;Dec 17, 1997;Build 11
"RTN","ORAMX",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAMX",4,0)
 Q
"RTN","ORAMX",5,0)
 ;
"RTN","ORAMX",6,0)
 ;  External References:
"RTN","ORAMX",7,0)
 ;  $$EXTERNAL^DILFD        ICR #2055
"RTN","ORAMX",8,0)
 ;  $$ICDDATA^ICDXCODE      ICR #5699
"RTN","ORAMX",9,0)
 ;  $$DATA2PCE^PXAPI        ICR #1889
"RTN","ORAMX",10,0)
 ;  $$FMTE/$$NOW^XLFDT      ICR #10103
"RTN","ORAMX",11,0)
 ;  $$LOW/$$UP^XLFSTR       ICR #10104
"RTN","ORAMX",12,0)
 ;
"RTN","ORAMX",13,0)
COMPRPT  ; Complications Report [ORAM COMPLICATIONS REPORT]
"RTN","ORAMX",14,0)
 N DIRUT,ORAMSDT,ORAMEDT,ORAMSD,ORAMED,ORAMM,ORAMDL,ORAMT,ORAFMT,ORAMDFN,ORAMCNT,ORAMARR,ORAMINCM,ORAMSORT
"RTN","ORAMX",15,0)
 S (ORAMED,ORAMSD)="",ORAMINCM=1
"RTN","ORAMX",16,0)
 W !!,"Anticoagulation Complications Report",!
"RTN","ORAMX",17,0)
 F  D  Q:+ORAMED>+ORAMSD!+$G(DIRUT)
"RTN","ORAMX",18,0)
 . S ORAMSD=+$$READ("DA^::E","    Please Enter START Date: ","T-90","Enter a start date for the report")
"RTN","ORAMX",19,0)
 . Q:'ORAMSD
"RTN","ORAMX",20,0)
 . S ORAMED=+$$READ("DA^::E","      Please Enter END Date: ","T","Enter an INCLUSIVE end date for the report")
"RTN","ORAMX",21,0)
 . Q:'ORAMED
"RTN","ORAMX",22,0)
 . I $L(ORAMED,".")=1 S ORAMED=ORAMED_".2359"
"RTN","ORAMX",23,0)
 . I ORAMSD>ORAMED W !,"END DATE must be more recent than the START DATE" S (ORAMSD,ORAMED)=""
"RTN","ORAMX",24,0)
 Q:$S(ORAMSD'>0:1,ORAMED'>0:1,1:0)
"RTN","ORAMX",25,0)
 S ORAMSDT=$$FMTE^XLFDT(ORAMSD,2),ORAMEDT=$$FMTE^XLFDT(ORAMED,2)
"RTN","ORAMX",26,0)
 W ! S ORAFMT=$$READ("SA^r:Report;e:Export to Spreadsheet","      Please Specify Format: ","Report")
"RTN","ORAMX",27,0)
 Q:+$G(DIRUT)
"RTN","ORAMX",28,0)
 S:"Ee"[$P(ORAFMT,U) ORAMDL=1 S:"Rr"[$P(ORAFMT,U) ORAMDL=0
"RTN","ORAMX",29,0)
 W ! S ORAMSORT=$$READ("SA^c:Clinic;d:Division","              Sort/Tally By: ","Clinic")
"RTN","ORAMX",30,0)
 Q:+$G(DIRUT)
"RTN","ORAMX",31,0)
 S ORAMSORT=$P(ORAMSORT,U)
"RTN","ORAMX",32,0)
 W ! S ORAMINCM=+$$READ("YA","Include Minor Complications? ","YES")
"RTN","ORAMX",33,0)
 Q:+$G(DIRUT)
"RTN","ORAMX",34,0)
 S (ORAMCNT,ORAMDFN)=0
"RTN","ORAMX",35,0)
 F  S ORAMDFN=$O(^ORAM(103,ORAMDFN)) Q:'$G(ORAMDFN)  D
"RTN","ORAMX",36,0)
 . N ORAMFS S ORAMFS=" "
"RTN","ORAMX",37,0)
 . F  S ORAMFS=$O(^ORAM(103,ORAMDFN,3,ORAMFS),-1) Q:'+$G(ORAMFS)  D
"RTN","ORAMX",38,0)
 .. N ORAMCP
"RTN","ORAMX",39,0)
 .. I $P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U)<ORAMSD Q
"RTN","ORAMX",40,0)
 .. I $P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U)>ORAMED Q
"RTN","ORAMX",41,0)
 .. S ORAMCP=$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U,2)
"RTN","ORAMX",42,0)
 .. I +$G(ORAMCP) D
"RTN","ORAMX",43,0)
 ... N ORAMLOC,ORAMM,ORAMCLNO,ORAMCLNM,ORAMDIVN,ORAMDIV
"RTN","ORAMX",44,0)
 ... I (+ORAMINCM'>0),(ORAMCP>2) Q
"RTN","ORAMX",45,0)
 ... S ORAMCLNO=+$P($G(^ORAM(103,ORAMDFN,6)),U,2)
"RTN","ORAMX",46,0)
 ... I ORAMCLNO>0 D
"RTN","ORAMX",47,0)
 .... S ORAMDIVN=+$P($G(^SC(ORAMCLNO,0)),U,15)
"RTN","ORAMX",48,0)
 .... S ORAMCLNM=$$EXTERNAL^DILFD(103,101,"",ORAMCLNO) S:$G(ORAMCLNM)="" ORAMCLNM="CLINIC UNKNOWN"
"RTN","ORAMX",49,0)
 .... S ORAMDIV=$$EXTERNAL^DILFD(44,3.5,"",ORAMDIVN) S:$G(ORAMDIV)="" ORAMDIV="DIVISION UNKNOWN"
"RTN","ORAMX",50,0)
 ... E  S ORAMCLNM="CLINIC UNKNOWN",ORAMDIV="DIVISION UNKNOWN"
"RTN","ORAMX",51,0)
 ... S ORAMLOC=$S(ORAMSORT="c":ORAMCLNM,1:ORAMDIV)
"RTN","ORAMX",52,0)
 ... S ORAMARR(ORAMLOC,0)=$G(ORAMARR(ORAMLOC,0))+1
"RTN","ORAMX",53,0)
 ... S ORAMM=$E($P(^DPT($G(ORAMDFN),0),U),1,10)_" ("_$E($P(^(0),U,9),6,9)_")"
"RTN","ORAMX",54,0)
 ... I ORAMCP=1!(+ORAMINCM&(ORAMCP=3)) D
"RTN","ORAMX",55,0)
 .... S ORAMARR(ORAMLOC,"B",0)=$G(ORAMARR(ORAMLOC,"B",0))+1
"RTN","ORAMX",56,0)
 .... S ORAMARR(ORAMLOC,"B",ORAMDFN,$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U)_ORAMFS,1)=ORAMM_": INR Draw date - "_$$FMTE^XLFDT($P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U),"2P")
"RTN","ORAMX",57,0)
 .... N ORAMJ S ORAMJ=0
"RTN","ORAMX",58,0)
 .... F  S ORAMJ=$O(^ORAM(103,ORAMDFN,3,ORAMFS,2,ORAMJ)) Q:+ORAMJ'>0  D
"RTN","ORAMX",59,0)
 ..... N ORAMCMPL,ORAMFS0
"RTN","ORAMX",60,0)
 ..... S ORAMFS0=$G(^ORAM(103,ORAMDFN,3,ORAMFS,0))
"RTN","ORAMX",61,0)
 ..... S ORAMCMPL=$G(^ORAM(103,ORAMDFN,3,ORAMFS,2,ORAMJ,0))
"RTN","ORAMX",62,0)
 ..... S:$L(ORAMCMPL,":")>1 ORAMCMPL=$S($P(ORAMCMPL,":")="MB":"Major Bleed: ",$P(ORAMCMPL,":")="C":"  ",1:ORAMCMPL)_$P(ORAMCMPL,":",2)
"RTN","ORAMX",63,0)
 ..... S ORAMARR(ORAMLOC,"B",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,1_"."_ORAMJ)=$S(ORAMJ=1:"Complication date: ",1:"")_ORAMCMPL
"RTN","ORAMX",64,0)
 ..... S ORAMARR(ORAMLOC,"BX",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,99)=$TR(ORAMLOC,";",",")_";"_$S(ORAMCP=3:"Minor Bleed",1:"Hemorrhagic")_";"_ORAMM_";"_$$FMTE^XLFDT($P(ORAMFS0,U),"2P")_";"
"RTN","ORAMX",65,0)
 ..... S ORAMARR(ORAMLOC,"BX",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,99)=ORAMARR(ORAMLOC,"BX",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,99)_$G(^ORAM(103,ORAMDFN,3,ORAMFS,2,1,0))
"RTN","ORAMX",66,0)
 ... I ORAMCP=2 D
"RTN","ORAMX",67,0)
 .... S ORAMARR(ORAMLOC,"C",0)=$G(ORAMARR(ORAMLOC,"C",0))+1
"RTN","ORAMX",68,0)
 .... S ORAMARR(ORAMLOC,"C",ORAMDFN,$P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U)_ORAMFS,1)=ORAMM_": INR Draw date - "_$$FMTE^XLFDT($P(^ORAM(103,ORAMDFN,3,ORAMFS,0),U),"2P")
"RTN","ORAMX",69,0)
 .... N ORAMJ S ORAMJ=0
"RTN","ORAMX",70,0)
 .... F  S ORAMJ=$O(^ORAM(103,ORAMDFN,3,ORAMFS,2,ORAMJ)) Q:'+$G(ORAMJ)  D
"RTN","ORAMX",71,0)
 ..... N ORAMCMPL,ORAMFS0
"RTN","ORAMX",72,0)
 ..... S ORAMFS0=$G(^ORAM(103,ORAMDFN,3,ORAMFS,0))
"RTN","ORAMX",73,0)
 ..... S ORAMCMPL=^ORAM(103,ORAMDFN,3,ORAMFS,2,ORAMJ,0)
"RTN","ORAMX",74,0)
 ..... S:$L(ORAMCMPL,":")>1 ORAMCMPL=$S($P(ORAMCMPL,":")="MB":"Major Bleed: ",$P(ORAMCMPL,":")="C":"  ",1:ORAMCMPL)_$P(ORAMCMPL,":",2)
"RTN","ORAMX",75,0)
 ..... S ORAMARR(ORAMLOC,"C",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,1_"."_ORAMJ)=$S(ORAMJ=1:"Complication date: ",1:"")_ORAMCMPL
"RTN","ORAMX",76,0)
 ..... S ORAMARR(ORAMLOC,"CX",ORAMDFN,$P(ORAMFS0,U)_ORAMFS,99)=$TR(ORAMLOC,";",",")_";Thrombotic;"_ORAMM_";"_$$FMTE^XLFDT($P(ORAMFS0,U),"2P")_";"_$G(^ORAM(103,ORAMDFN,3,ORAMFS,2,1,0))
"RTN","ORAMX",77,0)
 I ORAMDL=0 D COMP0(.ORAMARR,ORAMSDT,ORAMEDT,ORAMINCM)
"RTN","ORAMX",78,0)
 I ORAMDL=1 D COMP1(.ORAMARR,ORAMSDT,ORAMEDT,ORAMINCM,ORAMSORT)
"RTN","ORAMX",79,0)
 Q
"RTN","ORAMX",80,0)
COMP0(ORAMARR,ORAMSDT,ORAMEDT,ORAMINCM) ; Print Report Format
"RTN","ORAMX",81,0)
 N OCLINIC
"RTN","ORAMX",82,0)
 W @IOF,"COMPLICATIONS REPORT - ANTICOAGULATION: ",ORAMSDT," - ",ORAMEDT,!,$S('ORAMINCM:"  (** EXCLUDING MINOR COMPLICATIONS **)"_$C(13)_$C(10),1:"")
"RTN","ORAMX",83,0)
 I '$D(ORAMARR) W !,?5,"No Complications Noted."  Q
"RTN","ORAMX",84,0)
 S OCLINIC=""
"RTN","ORAMX",85,0)
 F  S OCLINIC=$O(ORAMARR(OCLINIC)) Q:OCLINIC']""  D
"RTN","ORAMX",86,0)
 . W !!,?5,OCLINIC,": Total Complications - ",ORAMARR(OCLINIC,0)
"RTN","ORAMX",87,0)
 . I $G(ORAMARR(OCLINIC,"B",0))>0 D  ;BLEEDS FOR THIS CLINIC
"RTN","ORAMX",88,0)
 .. N ODFN
"RTN","ORAMX",89,0)
 .. W !!,?7," Bleeds (",ORAMARR(OCLINIC,"B",0),")",!
"RTN","ORAMX",90,0)
 .. W !,?7," Details:"
"RTN","ORAMX",91,0)
 .. S ODFN=0 F  S ODFN=$O(ORAMARR(OCLINIC,"B",ODFN)) Q:+ODFN'>0  D
"RTN","ORAMX",92,0)
 ... N OCDATE S OCDATE=0
"RTN","ORAMX",93,0)
 ... F  S OCDATE=$O(ORAMARR(OCLINIC,"B",ODFN,OCDATE)) Q:+OCDATE'>0  D
"RTN","ORAMX",94,0)
 .... N OCNT S OCNT=0 W !
"RTN","ORAMX",95,0)
 .... F  S OCNT=$O(ORAMARR(OCLINIC,"B",ODFN,OCDATE,OCNT)) Q:+OCNT'>0  D
"RTN","ORAMX",96,0)
 ..... W !,?8,ORAMARR(OCLINIC,"B",ODFN,OCDATE,OCNT)
"RTN","ORAMX",97,0)
 . I $G(ORAMARR(OCLINIC,"C",0))>0 D  ;CLOTS FOR THIS CLINIC
"RTN","ORAMX",98,0)
 .. N ODFN
"RTN","ORAMX",99,0)
 .. W !!,?7," Clots (",ORAMARR(OCLINIC,"C",0),")",!
"RTN","ORAMX",100,0)
 .. W !,?7," Details:"
"RTN","ORAMX",101,0)
 .. S ODFN=0 F  S ODFN=$O(ORAMARR(OCLINIC,"C",ODFN)) Q:+ODFN'>0  D
"RTN","ORAMX",102,0)
 ... N OCDATE S OCDATE=0
"RTN","ORAMX",103,0)
 ... F  S OCDATE=$O(ORAMARR(OCLINIC,"C",ODFN,OCDATE)) Q:+OCDATE'>0  D
"RTN","ORAMX",104,0)
 .... N OCNT S OCNT=0 W !
"RTN","ORAMX",105,0)
 .... F  S OCNT=$O(ORAMARR(OCLINIC,"C",ODFN,OCDATE,OCNT)) Q:+OCNT'>0  D
"RTN","ORAMX",106,0)
 ..... W !,?8,ORAMARR(OCLINIC,"C",ODFN,OCDATE,OCNT)
"RTN","ORAMX",107,0)
 Q
"RTN","ORAMX",108,0)
COMP1(ORAMARR,ORAMSDT,ORAMEDT,ORAMINCM,ORAMSORT) ; Print Export Format
"RTN","ORAMX",109,0)
 N OCLINIC
"RTN","ORAMX",110,0)
 W @IOF,"COMPLICATIONS REPORT - ANTICOAGULATION: ",ORAMSDT," - ",ORAMEDT,!,$S('ORAMINCM:"  (** EXCLUDING MINOR COMPLICATIONS **)"_$C(13)_$C(10),1:"")
"RTN","ORAMX",111,0)
 I '$D(ORAMARR) W !,?5,"No Complications Noted."  Q
"RTN","ORAMX",112,0)
 W !,$S(ORAMSORT="c":"Clinic",1:"Division"),";Event;Patient;INR Draw Date;Complication Date"
"RTN","ORAMX",113,0)
 S OCLINIC="" F  S OCLINIC=$O(ORAMARR(OCLINIC)) Q:OCLINIC']""  D
"RTN","ORAMX",114,0)
 . I $D(ORAMARR(OCLINIC,"BX")) D  ;BLEEDS FOR THIS CLINIC
"RTN","ORAMX",115,0)
 .. N ODFN S ODFN=0 F  S ODFN=$O(ORAMARR(OCLINIC,"BX",ODFN)) Q:'+$G(ODFN)  D
"RTN","ORAMX",116,0)
 ... N OCDATE S OCDATE=0 F  S OCDATE=$O(ORAMARR(OCLINIC,"BX",ODFN,OCDATE)) Q:'+$G(OCDATE)  D
"RTN","ORAMX",117,0)
 .... W !,ORAMARR(OCLINIC,"BX",ODFN,OCDATE,99)
"RTN","ORAMX",118,0)
 . I $D(ORAMARR(OCLINIC,"CX")) D  ;CLOTS FOR THIS CLINIC
"RTN","ORAMX",119,0)
 .. N ODFN S ODFN=0 F  S ODFN=$O(ORAMARR(OCLINIC,"CX",ODFN)) Q:'+$G(ODFN)  D
"RTN","ORAMX",120,0)
 ... N OCDATE S OCDATE=0 F  S OCDATE=$O(ORAMARR(OCLINIC,"CX",ODFN,OCDATE)) Q:'+$G(OCDATE)  D
"RTN","ORAMX",121,0)
 .... W !,ORAMARR(OCLINIC,"CX",ODFN,OCDATE,99)
"RTN","ORAMX",122,0)
 Q
"RTN","ORAMX",123,0)
 ;
"RTN","ORAMX",124,0)
CONSULT(RESULT,ORAMDFN,ORAMCNM) ; Called from RPC=ORAMX CONSULT
"RTN","ORAMX",125,0)
 I '+$G(ORAMDFN) S RESULT(0)=0 Q
"RTN","ORAMX",126,0)
 I $G(ORAMCNM)="" S RESULT(0)=0 Q
"RTN","ORAMX",127,0)
 N ORAMCLST S ORAMCLST(0)=0
"RTN","ORAMX",128,0)
 D RPCLIST^GMRCTIU(.ORAMCLST,ORAMDFN)
"RTN","ORAMX",129,0)
 Q:ORAMCLST(0)=0  ;SHOULD BE NUMBER IN THE ARRAY
"RTN","ORAMX",130,0)
 I ORAMCLST(0)>0 D
"RTN","ORAMX",131,0)
 . N ORAMC S ORAMC=0 F  S ORAMC=$O(ORAMCLST(ORAMC)) Q:'+$G(ORAMC)  D
"RTN","ORAMX",132,0)
 .. Q:ORAMCNM'=$P(ORAMCLST(ORAMC),U,3)
"RTN","ORAMX",133,0)
 .. N ORAMK,ORAMCSTS
"RTN","ORAMX",134,0)
 .. S ORAMK=0,ORAMCSTS=$P(ORAMCLST(ORAMC),U,5)
"RTN","ORAMX",135,0)
 .. I $S(ORAMCSTS="PENDING":1,ORAMCSTS="ACTIVE":1,ORAMCSTS="SCHEDULED":1,1:0) S ORAMK=1
"RTN","ORAMX",136,0)
 .. Q:'+ORAMK
"RTN","ORAMX",137,0)
 .. N ORAMD S ORAMD=$$FMTE^XLFDT($P(ORAMCLST(ORAMC),U,2),"2P")
"RTN","ORAMX",138,0)
 .. S RESULT(ORAMC)=ORAMD_":  "_$P(ORAMCLST(ORAMC),U,3)_"  ^"_$P(ORAMCLST(ORAMC),U,1)
"RTN","ORAMX",139,0)
 Q
"RTN","ORAMX",140,0)
PCESET(RESULT,ORAMDFN,ORAMD1,ORAMSC44,ORAMEDT,ORAMSVC,ORAMNARR,ORAMPDX,ORAMSDX) ; RPC to file PCE Data
"RTN","ORAMX",141,0)
 ; RPC = ORAMX PCESET
"RTN","ORAMX",142,0)
 ; ORAMDFN  = Pt. ID
"RTN","ORAMX",143,0)
 ; ORAMD1   = Data string e.g., 1143~27898|300|99363|427.31|^SC~0^IR~0^EC~1^MST~0^HNC~1^SHAD~0
"RTN","ORAMX",144,0)
 ; ORAMSC44 = Hosp Loc IEN
"RTN","ORAMX",145,0)
 ; ORAMEDT  = Enc Dt/Tm
"RTN","ORAMX",146,0)
 ; ORAMSVC  = Svc Cat (e.g., "A"mb or "T"elecomm)
"RTN","ORAMX",147,0)
 ; ORAMNARR = Prov Narr
"RTN","ORAMX",148,0)
 ; ORAMPDX  = Auto Pri Indic
"RTN","ORAMX",149,0)
 ; ORAMSDX  = Auto Sec Indic
"RTN","ORAMX",150,0)
 ;
"RTN","ORAMX",151,0)
 I '+$G(ORAMDFN) S RESULT=99 Q
"RTN","ORAMX",152,0)
 I '+$G(ORAMSC44) S RESULT=99 Q
"RTN","ORAMX",153,0)
 I $G(ORAMD1)']"" S RESULT=99 Q
"RTN","ORAMX",154,0)
 N ORAMNOW,ORAMDAY S ORAMNOW=$$NOW^XLFDT
"RTN","ORAMX",155,0)
 S RESULT=0,ORAMEDT=$G(ORAMEDT,ORAMNOW),ORAMDAY=$P(ORAMEDT,"."),ORAMSVC=$G(ORAMSVC,"A")
"RTN","ORAMX",156,0)
 I $G(ORAMD1)'="" D
"RTN","ORAMX",157,0)
 . N ORAMPPR,ORAMSPR,ORAMCPT,ORAMSC,ORAMQ,ORAMVST,ERRARR,ERRPROB,ORAMPDXN,ORAMDXC,ORDXI
"RTN","ORAMX",158,0)
 . S ORAMPPR=$P($P(ORAMD1,"|"),"~"),ORAMSPR=$P($P(ORAMD1,"|"),"~",2),ORAMSC=$P(ORAMD1,"|",2),ORAMCPT=$P(ORAMD1,"|",3),ORAMQ=$P(ORAMD1,"|",5)
"RTN","ORAMX",159,0)
 . S ORAMDXC=$P(ORAMD1,"|",4)
"RTN","ORAMX",160,0)
 . I $P($G(ORAMPDX),U)]"" D
"RTN","ORAMX",161,0)
 .. N ORAMPDXC,ORAMPDXT,ORDXINC
"RTN","ORAMX",162,0)
 .. S ORAMPDXC=$P(ORAMPDX,U),ORAMPDXT=$P(ORAMPDX,U,2),ORDXINC=1
"RTN","ORAMX",163,0)
 .. I (ORAMPDXC]""),(ORAMPDXC'[".") S ORAMPDXC=ORAMPDXC_"."
"RTN","ORAMX",164,0)
 .. S ORAMPDXN=+$$ICDDATA^ICDXCODE("DIAGNOSIS",ORAMPDXC,ORAMEDT,"E")
"RTN","ORAMX",165,0)
 .. Q:+ORAMPDXN'>0
"RTN","ORAMX",166,0)
 .. S ^TMP("ORAMPCE",$J,"DX/PL",1,"DIAGNOSIS")=$G(ORAMPDXN)
"RTN","ORAMX",167,0)
 .. S ^TMP("ORAMPCE",$J,"DX/PL",1,"PRIMARY")="P"
"RTN","ORAMX",168,0)
 .. S:ORAMPDXT]"" ^TMP("ORAMPCE",$J,"DX/PL",1,"NARRATIVE")=ORAMPDXT
"RTN","ORAMX",169,0)
 .. I $P($G(ORAMSDX),U)]"" D
"RTN","ORAMX",170,0)
 ... N ORAMSDXC,ORAMSDXT,ORAMSDXN
"RTN","ORAMX",171,0)
 ... S ORAMSDXC=$P(ORAMSDX,U),ORAMSDXT=$P(ORAMSDX,U,2),ORDXINC=2
"RTN","ORAMX",172,0)
 ... I (ORAMSDXC]""),(ORAMSDXC'[".") S ORAMSDXC=ORAMSDXC_"."
"RTN","ORAMX",173,0)
 ... S ORAMSDXN=+$$ICDDATA^ICDXCODE("DIAGNOSIS",ORAMSDXC,ORAMEDT,"E")
"RTN","ORAMX",174,0)
 ... Q:+ORAMSDXN'>0
"RTN","ORAMX",175,0)
 ... S ^TMP("ORAMPCE",$J,"DX/PL",2,"DIAGNOSIS")=$G(ORAMSDXN)
"RTN","ORAMX",176,0)
 ... S ^TMP("ORAMPCE",$J,"DX/PL",2,"PRIMARY")="S"
"RTN","ORAMX",177,0)
 ... S:ORAMSDXT]"" ^TMP("ORAMPCE",$J,"DX/PL",2,"NARRATIVE")=ORAMSDXT
"RTN","ORAMX",178,0)
 .. Q:+ORAMDXC']""
"RTN","ORAMX",179,0)
 .. F ORDXI=1:1:$L(ORAMDXC,"/") D
"RTN","ORAMX",180,0)
 ... N ORDXC,ORDX S ORDXC=$P(ORAMDXC,"/",ORDXI)
"RTN","ORAMX",181,0)
 ... I (ORDXC]""),(ORDXC'[".") S ORDXC=ORDXC_"."
"RTN","ORAMX",182,0)
 ... S ORDX=+$$ICDDATA^ICDXCODE("DIAGNOSIS",ORDXC,ORAMEDT,"E")
"RTN","ORAMX",183,0)
 ... I +ORDX'>0 Q
"RTN","ORAMX",184,0)
 ... S ^TMP("ORAMPCE",$J,"DX/PL",ORDXI+ORDXINC,"DIAGNOSIS")=$G(ORDX)
"RTN","ORAMX",185,0)
 ... S ^TMP("ORAMPCE",$J,"DX/PL",ORDXI+ORDXINC,"PRIMARY")="S"
"RTN","ORAMX",186,0)
 ... S:$G(ORAMNARR)]"" ^TMP("ORAMPCE",$J,"DX/PL",ORDXI+ORDXINC,"NARRATIVE")=ORAMNARR
"RTN","ORAMX",187,0)
 . E  D
"RTN","ORAMX",188,0)
 .. Q:+ORAMDXC']""
"RTN","ORAMX",189,0)
 .. F ORDXI=1:1:$L(ORAMDXC,"/") D
"RTN","ORAMX",190,0)
 ... N ORDXC,ORDX S ORDXC=$P(ORAMDXC,"/",ORDXI)
"RTN","ORAMX",191,0)
 ... I (ORDXC]""),(ORDXC'[".") S ORDXC=ORDXC_"."
"RTN","ORAMX",192,0)
 ... S ORDX=+$$ICDDATA^ICDXCODE("DIAGNOSIS",ORDXC,ORAMEDT,"E")
"RTN","ORAMX",193,0)
 ... I +ORDX'>0 Q
"RTN","ORAMX",194,0)
 ... S:ORDXI=1 ORAMPDXN=ORDX
"RTN","ORAMX",195,0)
 ... S ^TMP("ORAMPCE",$J,"DX/PL",ORDXI,"DIAGNOSIS")=$G(ORDX)
"RTN","ORAMX",196,0)
 ... S ^TMP("ORAMPCE",$J,"DX/PL",ORDXI,"PRIMARY")=$S(ORDXI=1:"P",1:"S")
"RTN","ORAMX",197,0)
 ... S:$G(ORAMNARR)]"" ^TMP("ORAMPCE",$J,"DX/PL",ORDXI,"NARRATIVE")=ORAMNARR
"RTN","ORAMX",198,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"DSS ID")=$G(ORAMSC)  ;STOP CODE 40.7
"RTN","ORAMX",199,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"ENC D/T")=ORAMEDT
"RTN","ORAMX",200,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"HOS LOC")=ORAMSC44  ;9727 ;8005
"RTN","ORAMX",201,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"PATIENT")=ORAMDFN
"RTN","ORAMX",202,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"ENCOUNTER TYPE")="P"  ;PRIMARY OR ANCILLARY
"RTN","ORAMX",203,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"SERVICE CATEGORY")=ORAMSVC
"RTN","ORAMX",204,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"CHECKOUT D/T")=$$NOW^XLFDT
"RTN","ORAMX",205,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"PROCEDURE")=$G(ORAMCPT)
"RTN","ORAMX",206,0)
 . S:+ORAMPDXN>0 ^TMP("ORAMPCE",$J,"PROCEDURE",1,"DIAGNOSIS")=ORAMPDXN
"RTN","ORAMX",207,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"EVENT D/T")=ORAMEDT
"RTN","ORAMX",208,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"QTY")=1
"RTN","ORAMX",209,0)
 . S:ORAMPPR]"" ^TMP("ORAMPCE",$J,"PROCEDURE",1,"ENC PROVIDER")=ORAMPPR   ;FILE 200
"RTN","ORAMX",210,0)
 . S ^TMP("ORAMPCE",$J,"PROCEDURE",1,"DEPARTMENT")=$G(ORAMSC)  ;STOP CODE 40.7
"RTN","ORAMX",211,0)
 . S ^TMP("ORAMPCE",$J,"PROVIDER",1,"NAME")=ORAMPPR
"RTN","ORAMX",212,0)
 . S:ORAMPPR]"" ^TMP("ORAMPCE",$J,"PROVIDER",1,"PRIMARY")=1
"RTN","ORAMX",213,0)
 . ; If Secondary Provider is passed, include them
"RTN","ORAMX",214,0)
 . I ORAMSPR]"" D
"RTN","ORAMX",215,0)
 . . S ^TMP("ORAMPCE",$J,"PROVIDER",2,"NAME")=ORAMSPR
"RTN","ORAMX",216,0)
 . . S ^TMP("ORAMPCE",$J,"PROVIDER",2,"PRIMARY")=0
"RTN","ORAMX",217,0)
 . ;comes in like: ^SC~0^IR~0^EC~1^MST~0
"RTN","ORAMX",218,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"SC")=""
"RTN","ORAMX",219,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"AO")=""
"RTN","ORAMX",220,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"IR")=""
"RTN","ORAMX",221,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"EC")=""
"RTN","ORAMX",222,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"MST")=""
"RTN","ORAMX",223,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"HNC")=""
"RTN","ORAMX",224,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"CV")=""
"RTN","ORAMX",225,0)
 . S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,"SHAD")=""
"RTN","ORAMX",226,0)
 . N ORAMCNT,I S ORAMCNT=$L(ORAMQ,U)
"RTN","ORAMX",227,0)
 . I +$G(ORAMCNT) F I=2:1:ORAMCNT D
"RTN","ORAMX",228,0)
 .. N T S T=$P(ORAMQ,U,I) Q:$G(T)=""
"RTN","ORAMX",229,0)
 .. I $P(T,"~",1)'="" S ^TMP("ORAMPCE",$J,"ENCOUNTER",1,$P(T,"~",1))=$P(T,"~",2)
"RTN","ORAMX",230,0)
 . S RESULT=$$DATA2PCE^PXAPI("^TMP(""ORAMPCE"",$J)","ORAM","ORAM ANTICOAGULATION MANAGEMENT PROGRAM",.ORAMVST,DUZ,,.ERRARR,,.ERRPROB)
"RTN","ORAMX",231,0)
 Q
"RTN","ORAMX",232,0)
READ(TYPE,PROMPT,DEFAULT,HELP,SCREEN) ; Calls reader, returns response
"RTN","ORAMX",233,0)
 N DIR,X,Y
"RTN","ORAMX",234,0)
 S DIR(0)=TYPE
"RTN","ORAMX",235,0)
 I $D(SCREEN) S DIR("S")=SCREEN
"RTN","ORAMX",236,0)
 I $G(PROMPT)]"" S DIR("A")=PROMPT
"RTN","ORAMX",237,0)
 I $G(DEFAULT)]"" S DIR("B")=DEFAULT
"RTN","ORAMX",238,0)
 I $D(HELP) S DIR("?")=HELP
"RTN","ORAMX",239,0)
 D ^DIR
"RTN","ORAMX",240,0)
 I $G(X)="@" S Y="@" G READX
"RTN","ORAMX",241,0)
 I Y]"",($L($G(Y),U)'=2) S Y=Y_U_$G(Y(0),Y)
"RTN","ORAMX",242,0)
READX Q Y
"RTN","ORAMX",243,0)
NAME(X,FMT) ; Call with X="LAST,FIRST MI", FMT=Return Format ("LAST, FI")
"RTN","ORAMX",244,0)
 N ORLAST,ORLI,ORFIRST,ORFI,ORMI,ORI
"RTN","ORAMX",245,0)
 I X']"" S FMT="" G NAMEX
"RTN","ORAMX",246,0)
 I $S('$D(FMT):1,'$L(FMT):1,1:0) S FMT="LAST,FIRST"
"RTN","ORAMX",247,0)
 S FMT=$$LOW^XLFSTR(FMT)
"RTN","ORAMX",248,0)
 S ORLAST=$P(X,","),ORLI=$E(ORLAST),ORFIRST=$P(X,",",2)
"RTN","ORAMX",249,0)
 S ORFI=$E(ORFIRST)
"RTN","ORAMX",250,0)
 S ORMI=$S($P(ORFIRST," ",2)'="NMI":$E($P(ORFIRST," ",2)),1:"")
"RTN","ORAMX",251,0)
 S ORFIRST=$P(ORFIRST," ")
"RTN","ORAMX",252,0)
 F ORI="last","li","first","fi","mi" I FMT[ORI S FMT=$P(FMT,ORI)_@("OR"_$$UP^XLFSTR(ORI))_$P(FMT,ORI,2)
"RTN","ORAMX",253,0)
NAMEX Q FMT
"RTN","ORAMX",254,0)
PATIENT() ; Select a patient
"RTN","ORAMX",255,0)
 N X,DIC,Y
"RTN","ORAMX",256,0)
 S DIC=2,DIC(0)="AEMQ" D ^DIC
"RTN","ORAMX",257,0)
 Q Y
"RTN","ORAMX",258,0)
VALIDORD(ORDA) ; Screen Orderable for INR
"RTN","ORAMX",259,0)
 N ORDNM,ORY,ORDGDA,ORID S ORDNM="",ORY=0
"RTN","ORAMX",260,0)
 ; if orderable item inactive, exclude it
"RTN","ORAMX",261,0)
 I +$G(^ORD(101.43,+ORDA,.1))>0 G VOX
"RTN","ORAMX",262,0)
 ; if display group is not LABORATORY, exclude it
"RTN","ORAMX",263,0)
 S ORDGDA=$P($G(^ORD(101.43,+ORDA,0)),U,5)
"RTN","ORAMX",264,0)
 I $S(+ORDGDA'>0:1,$P($G(^ORD(100.98,+ORDGDA,0)),U)'="LABORATORY":1,1:0) G VOX
"RTN","ORAMX",265,0)
 ; if ID not valid, exclude it
"RTN","ORAMX",266,0)
 S ORID=+$P($G(^ORD(101.43,+ORDA,0)),U,2)
"RTN","ORAMX",267,0)
 I '$$VALIDLAB(ORID) G VOX
"RTN","ORAMX",268,0)
 ; otherwise, allow selection
"RTN","ORAMX",269,0)
 S ORY=1
"RTN","ORAMX",270,0)
VOX Q ORY
"RTN","ORAMX",271,0)
VALIDLAB(ORID) ; Is lab test valid?
"RTN","ORAMX",272,0)
 N ORY S ORY=0
"RTN","ORAMX",273,0)
 I $S(+ORID'>0:1,'$D(^LAB(60,+ORID,0)):1,1:0) G VLX
"RTN","ORAMX",274,0)
 ; if entry in LABORATORY TEST file (#60) doesn't have a LOCATION (DATA NAME), exclude it
"RTN","ORAMX",275,0)
 I '$L($P($G(^LAB(60,+ORID,0)),U,5)) G VLX
"RTN","ORAMX",276,0)
 ; otherwise, allow selection
"RTN","ORAMX",277,0)
 S ORY=1
"RTN","ORAMX",278,0)
VLX Q ORY
"RTN","ORAMX",279,0)
TEAMLIST(ORLIST) ; Team List Reports
"RTN","ORAMX",280,0)
 N DIC,DHD,FLDS,L,FR,BY,TO,ORCL,ORPAR,ORALIST,ORCLIST
"RTN","ORAMX",281,0)
 S DIC="^OR(100.21,",L=0,FLDS="[ORAM TEAM LIST]",BY="[ORAM TEAM LIST]"
"RTN","ORAMX",282,0)
 W !!,"List of ",$S(ORLIST="A":"ALL",1:"COMPLEX")," Anticoagulation Patients for a Clinic",!
"RTN","ORAMX",283,0)
 S ORCL=$$SELLOC^ORAMSET
"RTN","ORAMX",284,0)
 I +ORCL'>0 D  Q
"RTN","ORAMX",285,0)
 . W $C(7),!!,"You must select a Clinic to proceed...",!
"RTN","ORAMX",286,0)
 D GET^ORAMSET(.ORPAR,ORCL)
"RTN","ORAMX",287,0)
 S ORALIST=$P($G(ORPAR(0)),U,2),ORCLIST=$P($G(ORPAR(0)),U,3)
"RTN","ORAMX",288,0)
 S:+ORALIST ORALIST=$P($G(^OR(100.21,ORALIST,0)),U)
"RTN","ORAMX",289,0)
 S:+ORCLIST ORCLIST=$P($G(^OR(100.21,ORCLIST,0)),U)
"RTN","ORAMX",290,0)
 S (FR,TO,DHD)=$S(ORLIST="A":ORALIST,1:ORCLIST)
"RTN","ORAMX",291,0)
 I FR']"" D  Q
"RTN","ORAMX",292,0)
 . W !,"You must define a list for ",$S(ORLIST="A":"ALL",1:"COMPLEX")," Anticoagulation Patients."
"RTN","ORAMX",293,0)
 . W $$READ("EA","Press Return to Continue...")
"RTN","ORAMX",294,0)
 D EN1^DIP
"RTN","ORAMX",295,0)
 Q
"RTN","ORAMX",296,0)
NEXTLAB ; Next Lab Report
"RTN","ORAMX",297,0)
 N DIC,DHD,FLDS,L,FR,BY,TO,ORCL,OREDT,ORLDT
"RTN","ORAMX",298,0)
 S DIC="^ORAM(103,",L=0,FLDS="[ORAM TEAM LIST]",BY="@CLINIC,NEXT LAB,@PATIENT",(OREDT,ORLDT)=""
"RTN","ORAMX",299,0)
 W !!,"List Anticoagulation Patients with Pending Lab Draws",!
"RTN","ORAMX",300,0)
 S ORCL=$$SELLOC^ORAMSET
"RTN","ORAMX",301,0)
 I +ORCL'>0 D  Q
"RTN","ORAMX",302,0)
 . W $C(7),!!,"You must select a Clinic to proceed...",!
"RTN","ORAMX",303,0)
 S ORCL=$P($G(^SC(+ORCL,0)),U)
"RTN","ORAMX",304,0)
 F  D  Q:+ORLDT>+OREDT!$D(DIRUT)
"RTN","ORAMX",305,0)
 . S OREDT=+$$READ("DA^::E","Please Enter START Date: ","T","Enter a start date for the report")
"RTN","ORAMX",306,0)
 . Q:'OREDT
"RTN","ORAMX",307,0)
 . S ORLDT=+$$READ("DA^::E","  Please Enter END Date: ","T+14","Enter an INCLUSIVE end date for the report")
"RTN","ORAMX",308,0)
 . Q:'ORLDT
"RTN","ORAMX",309,0)
 . I $L(ORLDT,".")=1 S ORLDT=ORLDT_".2359"
"RTN","ORAMX",310,0)
 . I OREDT>ORLDT W !,"END DATE must be more recent than the START DATE" S (OREDT,ORLDT)=""
"RTN","ORAMX",311,0)
 Q:$S(OREDT'>0:1,ORLDT'>0:1,1:0)
"RTN","ORAMX",312,0)
 S OREDT=$$FMTE^XLFDT(OREDT,2),ORLDT=$$FMTE^XLFDT(ORLDT,2)
"RTN","ORAMX",313,0)
 S DHD=ORCL_" Next Lab Report"
"RTN","ORAMX",314,0)
 S FR=ORCL_","_OREDT,TO=ORCL_","_ORLDT
"RTN","ORAMX",315,0)
 D EN1^DIP
"RTN","ORAMX",316,0)
 Q
"RTN","ORAMX1")
0^6^B81414252
"RTN","ORAMX1",1,0)
ORAMX1 ;ISL/JER - ADDITIONAL ANTICOAGULATION CALLS ;12/05/14  09:42
"RTN","ORAMX1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**391**;Dec 17, 1997;Build 11
"RTN","ORAMX1",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORAMX1",4,0)
 Q
"RTN","ORAMX1",5,0)
 ;
"RTN","ORAMX1",6,0)
RPT(ROOT,DFN,ID,ALPHA,OMEGA,DTRANGE,REMOTE,MAX,ORFHIE) ; Generate report for CPRS
"RTN","ORAMX1",7,0)
 N ORAMCNT,ORAMJ,ORAMHCT,ORAMCLIN,ORAMPIND,ORAMSIND,ORAICODE,ORAINARR,ORAITXT,ORAIDESC,ORAIND,ORVDT,ORDXS,IMPLDT,CODSYS
"RTN","ORAMX1",8,0)
 I '$D(^ORAM(103,"B",DFN)) Q
"RTN","ORAMX1",9,0)
 W $P(^DPT(DFN,0),"^"),"  ",$E($P(^DPT(DFN,0),"^",9),1,3),"-",$E($P(^DPT(DFN,0),"^",9),4,5),"-",$E($P(^DPT(DFN,0),"^",9),6,9)
"RTN","ORAMX1",10,0)
 I $P(^ORAM(103,DFN,0),"^",10)=1 W !,?10,"******* COMPLEX PATIENT *******"
"RTN","ORAMX1",11,0)
 S ORAMCLIN=$P($G(^ORAM(103,DFN,6)),U,2),(ORAMPIND,ORAMSIND)=""
"RTN","ORAMX1",12,0)
 S ORVDT=$O(^ORAM(103,DFN,3,"B",""),-1)
"RTN","ORAMX1",13,0)
 I +ORVDT'>0 S ORVDT=DT
"RTN","ORAMX1",14,0)
 E  D
"RTN","ORAMX1",15,0)
 . N ORDA,ORDFS0
"RTN","ORAMX1",16,0)
 . S ORDA=$O(^ORAM(103,DFN,3,"B",ORVDT,0)) Q:+ORDA'>0
"RTN","ORAMX1",17,0)
 . S ORDFS0=$G(^ORAM(103,DFN,3,ORDA,0))
"RTN","ORAMX1",18,0)
 . S:$P(ORDFS0,U,9)>0 ORVDT=$P(ORDFS0,U,9)
"RTN","ORAMX1",19,0)
 . D:+ORAMCLIN GETVSIT(.ORDXS,DFN,ORVDT,ORAMCLIN)
"RTN","ORAMX1",20,0)
 S IMPLDT=$$IMPDATE^LEXU("10D")
"RTN","ORAMX1",21,0)
 S CODSYS=$S(ORVDT<IMPLDT:"ICD-9-CM",1:"ICD-10-CM")
"RTN","ORAMX1",22,0)
 I +$G(ORDXS)'>0 D  I 1
"RTN","ORAMX1",23,0)
 . N ICDCS
"RTN","ORAMX1",24,0)
 . I +ORAMCLIN D
"RTN","ORAMX1",25,0)
 .. N ICDC
"RTN","ORAMX1",26,0)
 .. I ORVDT<IMPLDT D  I 1
"RTN","ORAMX1",27,0)
 ... S ICDC=$$GET^XPAR(ORAMCLIN_";SC(","ORAM AUTO PRIMARY INDICATION",1,"E")
"RTN","ORAMX1",28,0)
 .. E  D
"RTN","ORAMX1",29,0)
 ... S ICDC=$$GET^XPAR(ORAMCLIN_";SC(","ORAM I10 AUTO PRIM INDICATION",1,"E")
"RTN","ORAMX1",30,0)
 .. I ICDC]"" D
"RTN","ORAMX1",31,0)
 ... N ICDD,ICDDESC,ICDCS
"RTN","ORAMX1",32,0)
 ... S ICDCS=$P($$CODECS^ICDEX(ICDC,80,ORVDT),U,2) S:ICDCS]"" CODSYS=ICDCS
"RTN","ORAMX1",33,0)
 ... D ICDDESC^ICDXCODE("DIAGNOSIS",ICDC,ORVDT,.ICDDESC)
"RTN","ORAMX1",34,0)
 ... S ORAMPIND=ICDC_U_$$TITLE^XLFSTR($G(ICDDESC(1)))_" ("_CODSYS_" "_ICDC_")"
"RTN","ORAMX1",35,0)
 .. S ICDC=""
"RTN","ORAMX1",36,0)
 .. I ORVDT<IMPLDT D  I 1
"RTN","ORAMX1",37,0)
 ... S ICDC=$$GET^XPAR(ORAMCLIN_";SC(","ORAM AUTO SECONDARY INDICATION",1,"E")
"RTN","ORAMX1",38,0)
 .. E  D
"RTN","ORAMX1",39,0)
 ... S ICDC=$$GET^XPAR(ORAMCLIN_";SC(","ORAM I10 AUTO SEC INDICATION",1,"E")
"RTN","ORAMX1",40,0)
 .. I ICDC]"" D
"RTN","ORAMX1",41,0)
 ... N ICDD,ICDDESC,ICDCS
"RTN","ORAMX1",42,0)
 ... S ICDCS=$P($$CODECS^ICDEX(ICDC,80,ORVDT),U,2) S:ICDCS]"" CODSYS=ICDCS
"RTN","ORAMX1",43,0)
 ... D ICDDESC^ICDXCODE("DIAGNOSIS",ICDC,ORVDT,.ICDDESC)
"RTN","ORAMX1",44,0)
 ... S ORAMSIND=ICDC_U_$$TITLE^XLFSTR($G(ICDDESC(1)))_" ("_CODSYS_" "_ICDC_")"
"RTN","ORAMX1",45,0)
 . S ORAITXT=$P($P(^ORAM(103,DFN,0),"^",3),"=")
"RTN","ORAMX1",46,0)
 . S ORAICODE=$P($P(^ORAM(103,DFN,0),"^",3),"=",2) S:ORAICODE'["." ORAICODE=ORAICODE_"."
"RTN","ORAMX1",47,0)
 . S ICDCS=$P($$CODECS^ICDEX(ORAICODE,80,ORVDT),U,2) S:ICDCS]"" CODSYS=ICDCS
"RTN","ORAMX1",48,0)
 . D ICDDESC^ICDXCODE("DIAGNOSIS",ORAICODE,ORVDT,.ORAIDESC)
"RTN","ORAMX1",49,0)
 . S ORAINARR=$$TITLE^XLFSTR($G(ORAIDESC(1)))
"RTN","ORAMX1",50,0)
 . S ORAIND=ORAICODE_U_$S($$UP^XLFSTR(ORAITXT)'=$$UP^XLFSTR(ORAINARR):ORAITXT_" - ",1:"")_ORAINARR_" ("_CODSYS_" "_ORAICODE_")"
"RTN","ORAMX1",51,0)
 . I ORAMPIND]"" D
"RTN","ORAMX1",52,0)
 .. N PIND,AIND,ORI
"RTN","ORAMX1",53,0)
 .. S PIND=$$WRAP($P(ORAMPIND,U,2),55)
"RTN","ORAMX1",54,0)
 .. W !!,"Primary Indication: ",$P(PIND,"|")
"RTN","ORAMX1",55,0)
 .. F ORI=2:1:$L(PIND,"|") W !?22,$P(PIND,"|",ORI)
"RTN","ORAMX1",56,0)
 .. I ORAMSIND]"" D
"RTN","ORAMX1",57,0)
 ... N SIND,ORJ
"RTN","ORAMX1",58,0)
 ... S SIND=$$WRAP($P(ORAMSIND,U,2),55)
"RTN","ORAMX1",59,0)
 ... W !," Add'l Indications: ",$P(SIND,"|")
"RTN","ORAMX1",60,0)
 ... F ORJ=2:1:$L(SIND,"|") W !?22,$P(SIND,"|",ORJ)
"RTN","ORAMX1",61,0)
 .. S AIND=$$WRAP($P(ORAIND,U,2),55)
"RTN","ORAMX1",62,0)
 .. W !,$S($D(ORAMSIND):"                    ",1:"  Add'l Indication: "),$P(AIND,"|")
"RTN","ORAMX1",63,0)
 .. F ORI=2:1:$L(AIND,"|") W !?22,$P(AIND,"|",ORI)
"RTN","ORAMX1",64,0)
 . E  D
"RTN","ORAMX1",65,0)
 .. N AIND,ORI
"RTN","ORAMX1",66,0)
 .. S AIND=$$WRAP($P(ORAIND,U,2),55)
"RTN","ORAMX1",67,0)
 .. W !!,"Primary Indication: ",$P(AIND,"|")
"RTN","ORAMX1",68,0)
 .. F ORI=2:1:$L(AIND,"|") W !?22,$P(AIND,"|",ORI)
"RTN","ORAMX1",69,0)
 E  D
"RTN","ORAMX1",70,0)
 . N PIND,AIND,ORI,ORJ
"RTN","ORAMX1",71,0)
 . S PIND=$$WRAP($P(ORDXS(1),U,2),55)
"RTN","ORAMX1",72,0)
 . W !!,"Primary Indication: ",$P(PIND,"|")
"RTN","ORAMX1",73,0)
 . F ORI=2:1:$L(PIND,"|") W !?22,$P(PIND,"|",ORI)
"RTN","ORAMX1",74,0)
 . Q:ORDXS'>1
"RTN","ORAMX1",75,0)
 . S AIND=$$WRAP($P(ORDXS(2),U,2),55)
"RTN","ORAMX1",76,0)
 . W !?$S(ORDXS>2:1,1:2),"Add'l Indication",$S(ORDXS>2:"s",1:""),": ",$P(AIND,"|")
"RTN","ORAMX1",77,0)
 . F ORI=2:1:$L(AIND,"|") W !?22,$P(AIND,"|",ORI)
"RTN","ORAMX1",78,0)
 . F ORJ=3:1:ORDXS D
"RTN","ORAMX1",79,0)
 .. S AIND=$$WRAP($P(ORDXS(ORJ),U,2),55)
"RTN","ORAMX1",80,0)
 .. F ORI=1:1:$L(AIND,"|") W !?$S(ORI=1:20,1:22),$P(AIND,"|",ORI)
"RTN","ORAMX1",81,0)
 W !!,"          Goal INR: ",$P(^ORAM(103,DFN,0),"^",2)
"RTN","ORAMX1",82,0)
 D HCT^ORAM(.ORAMHCT,DFN)
"RTN","ORAMX1",83,0)
 I $L(ORAMHCT,U)>1 D  I 1
"RTN","ORAMX1",84,0)
 . W !?10,"Last ",$S($$UP^XLFSTR($P(ORAMHCT,U,3))["HGB":"Hgb",$$UP^XLFSTR($P(ORAMHCT,U,3))["HEMOGLOBIN":"Hgb",1:"HCT"),": "
"RTN","ORAMX1",85,0)
 . W $S($P(ORAMHCT,U)]"":$P(ORAMHCT,U),1:"No result")," on ",$S($P(ORAMHCT,U,2)]"":$P(ORAMHCT,U,2),1:"file")
"RTN","ORAMX1",86,0)
 E  W !!?10,ORAMHCT
"RTN","ORAMX1",87,0)
 I +$P($G(^ORAM(103,DFN,6)),U,5)!+$O(^ORAM(103,DFN,7,0)) D
"RTN","ORAMX1",88,0)
 . W !!,"Patient is Eligible for LMWH Bridging"
"RTN","ORAMX1",89,0)
 . I +$O(^ORAM(103,DFN,7,0)) D
"RTN","ORAMX1",90,0)
 .. N ORI S ORI=0
"RTN","ORAMX1",91,0)
 .. W ":"
"RTN","ORAMX1",92,0)
 .. F  S ORI=$O(^ORAM(103,DFN,7,ORI)) Q:+ORI'>0  W !?2,$G(^ORAM(103,DFN,7,ORI,0))
"RTN","ORAMX1",93,0)
 . E  W "."
"RTN","ORAMX1",94,0)
 I $P($G(^ORAM(103,DFN,1,0)),"^",3)>0 S ORAMCNT=$P(^ORAM(103,DFN,1,0),"^",3) D
"RTN","ORAMX1",95,0)
 . W !!,"Special Instructions:"
"RTN","ORAMX1",96,0)
 . F ORAMJ=1:1:ORAMCNT W !?2,^ORAM(103,DFN,1,ORAMJ,0)
"RTN","ORAMX1",97,0)
 I $P(^ORAM(103,DFN,0),"^",11)=2 W !?2,"Pt has given permission to leave anticoag msg on msg machine."
"RTN","ORAMX1",98,0)
 I $P($G(^ORAM(103,DFN,4,0)),"^",3)>0 S ORAMCNT=$P(^ORAM(103,DFN,4,0),"^",3) D
"RTN","ORAMX1",99,0)
 . W !?2,"OK to leave anticoagulation message with:"
"RTN","ORAMX1",100,0)
 . F ORAMJ=1:1:ORAMCNT W !?4,^ORAM(103,DFN,4,ORAMJ,0)
"RTN","ORAMX1",101,0)
 I $P($G(^ORAM(103,DFN,2,0)),"^",3)>0 S ORAMCNT=$P(^ORAM(103,DFN,2,0),"^",3) D
"RTN","ORAMX1",102,0)
 . W !!,"Secondary Indication(s)/Risk Factors:"
"RTN","ORAMX1",103,0)
 . F ORAMJ=1:1:ORAMCNT W !?2,^ORAM(103,DFN,2,ORAMJ,0)
"RTN","ORAMX1",104,0)
 W !
"RTN","ORAMX1",105,0)
 I $P(^ORAM(103,DFN,0),"^",5)'="" W !,"Start Date: ",$P(^ORAM(103,DFN,0),"^",5)
"RTN","ORAMX1",106,0)
 I $P(^ORAM(103,DFN,0),"^",7)'="" W ?35,"Duration: ",$P(^ORAM(103,DFN,0),"^",7)
"RTN","ORAMX1",107,0)
 W !,"==========================================================================="
"RTN","ORAMX1",108,0)
 W !,"DATE",?10,"INR",?18,"Notified",?30,"TWD",?36,"Comments:"
"RTN","ORAMX1",109,0)
 W !,"---------------------------------------------------------------------------"
"RTN","ORAMX1",110,0)
 I $D(^ORAM(103,DFN,3,"B")) D
"RTN","ORAMX1",111,0)
 . N ORAMFSD S ORAMFSD=" ",ORAMCNT=0
"RTN","ORAMX1",112,0)
 . F  S ORAMFSD=$O(^ORAM(103,DFN,3,ORAMFSD),-1) Q:$G(ORAMFSD)<1  D
"RTN","ORAMX1",113,0)
 .. I $$DTCHK^ORAM2(DFN,ALPHA,OMEGA,ORAMFSD)=0 Q  ;need to change this to the new date
"RTN","ORAMX1",114,0)
 .. N ORAMDD1,ORAMDOSE,ORAMPS,ORAMPNOT
"RTN","ORAMX1",115,0)
 .. I '+$D(^ORAM(103,DFN,3,ORAMFSD,"LOG",0)) W !,$$FMTE^XLFDT($E($P(^ORAM(103,DFN,3,ORAMFSD,0),"^",9),1,7),2)  ;changed from $P(^ORAM(103,DFN,3,ORAMCNT,0),"^")
"RTN","ORAMX1",116,0)
 .. I +$D(^ORAM(103,DFN,3,ORAMFSD,"LOG",0)) S ORAMDD1=$P($P(^ORAM(103,DFN,3,ORAMFSD,"LOG",1,0),"(",2),".") Q:'+$G(ORAMDD1)  W !,$$FMTE^XLFDT(ORAMDD1,2)
"RTN","ORAMX1",117,0)
 .. S ORAMPNOT=$$WRAP($P(^ORAM(103,DFN,3,ORAMFSD,0),"^",8),11)
"RTN","ORAMX1",118,0)
 .. W ?11,$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",3) ;INR
"RTN","ORAMX1",119,0)
 .. W ?18,$P(ORAMPNOT,"|") ;Pt Notified
"RTN","ORAMX1",120,0)
 .. W ?30,$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",6) ;TWD
"RTN","ORAMX1",121,0)
 .. ; Comments
"RTN","ORAMX1",122,0)
 .. I $P($G(^ORAM(103,DFN,3,ORAMFSD,1,0)),"^",3)>0 D  I 1
"RTN","ORAMX1",123,0)
 ... N ORAMCC,ORAMCLN S (ORAMCC,ORAMCLN)=0
"RTN","ORAMX1",124,0)
 ... F  S ORAMCLN=$O(^ORAM(103,DFN,3,ORAMFSD,1,ORAMCLN)) Q:+ORAMCLN'>0  D
"RTN","ORAMX1",125,0)
 .... I $P(^ORAM(103,DFN,3,ORAMFSD,0),"^",3)'="",ORAMCLN=2 W ?10,$$FMTE^XLFDT($P(^ORAM(103,DFN,3,ORAMFSD,0),"^"),2)
"RTN","ORAMX1",126,0)
 .... W:ORAMCLN>1 ?18,$P(ORAMPNOT,"|",ORAMCLN)
"RTN","ORAMX1",127,0)
 .... W ?38,^ORAM(103,DFN,3,ORAMFSD,1,ORAMCLN,0),!
"RTN","ORAMX1",128,0)
 .... S ORAMCC=ORAMCC+1
"RTN","ORAMX1",129,0)
 ... I $L(ORAMPNOT,"|")>ORAMCC D
"RTN","ORAMX1",130,0)
 .... N ORAMI S ORAMI=0 F ORAMI=ORAMCC+1:1:$L(ORAMPNOT,"|") W ?18,$P(ORAMPNOT,"|",ORAMI),!
"RTN","ORAMX1",131,0)
 .. E  D  W !
"RTN","ORAMX1",132,0)
 ... I $L(ORAMPNOT,"|")>1 D
"RTN","ORAMX1",133,0)
 .... N ORAMI S ORAMI=0 F ORAMI=2:1:$L(ORAMPNOT,"|") W ?18,$P(ORAMPNOT,"|",ORAMI),!
"RTN","ORAMX1",134,0)
 .. ; Patient Instructions
"RTN","ORAMX1",135,0)
 .. I +$O(^ORAM(103,DFN,3,ORAMFSD,3,0)) D
"RTN","ORAMX1",136,0)
 ... N ORI S ORI=0
"RTN","ORAMX1",137,0)
 ... W !,"Patient Instructions (from Letter):"
"RTN","ORAMX1",138,0)
 ... F  S ORI=$O(^ORAM(103,DFN,3,ORAMFSD,3,ORI)) Q:+ORI'>0  D
"RTN","ORAMX1",139,0)
 .... N ORPILN,ORJ S ORPILN=$G(^ORAM(103,DFN,3,ORAMFSD,3,ORI,0))
"RTN","ORAMX1",140,0)
 .... S:$L(ORPILN)>77 ORPILN=$$WRAP(ORPILN,77)
"RTN","ORAMX1",141,0)
 .... F ORJ=1:1:$L(ORPILN,"|") W !?2,$P(ORPILN,"|",ORJ)
"RTN","ORAMX1",142,0)
 ... W !
"RTN","ORAMX1",143,0)
 .. ; Daily Dosing
"RTN","ORAMX1",144,0)
 .. S ORAMDOSE=$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",7)
"RTN","ORAMX1",145,0)
 .. I $L(ORAMDOSE) D
"RTN","ORAMX1",146,0)
 ... N ORAMTP,ORAMTM,ORI
"RTN","ORAMX1",147,0)
 ... S ORAMPS=$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",5),(ORAMTP,ORAMTM)=0
"RTN","ORAMX1",148,0)
 ... W !,"Current Dosing (using ",ORAMPS," mg tab):",!
"RTN","ORAMX1",149,0)
 ... W ?6,$J("Sun",6),?12,$J("Mon",6),?18,$J("Tue",6),?24,$J("Wed",6),?30,$J("Thu",6),?36,$J("Fri",6),?42,$J("Sat",6),?48,$J("Tot",6),!
"RTN","ORAMX1",150,0)
 ... W "Tab" F ORI=1:1:$L(ORAMDOSE,"|") S ORAMTP=ORAMTP+($P(ORAMDOSE,"|",ORI)/ORAMPS) W ?(6*ORI),$J(($P(ORAMDOSE,"|",ORI)/ORAMPS),6)
"RTN","ORAMX1",151,0)
 ... W ?48,$J(ORAMTP,6),!
"RTN","ORAMX1",152,0)
 ... W "mgs" F ORI=1:1:$L(ORAMDOSE,"|") S ORAMTM=ORAMTM+$P(ORAMDOSE,"|",ORI) W ?(6*ORI),$J($P(ORAMDOSE,"|",ORI),6)
"RTN","ORAMX1",153,0)
 ... W ?48,$J(ORAMTM,6),!
"RTN","ORAMX1",154,0)
 .. ; Complications
"RTN","ORAMX1",155,0)
 .. I +$P(^ORAM(103,DFN,3,ORAMFSD,0),"^",2) D
"RTN","ORAMX1",156,0)
 ... N ORAMCTXT,ORAMCMPL
"RTN","ORAMX1",157,0)
 ... S ORAMCTXT=$S($P(^ORAM(103,DFN,3,ORAMFSD,0),"^",2)=1:"Major Bleed ",$P(^(0),"^",2)=2:"Complication(s) ",$P(^(0),"^",2)=3:"Minor Bleed ",1:"")
"RTN","ORAMX1",158,0)
 ... I $D(^ORAM(103,DFN,3,ORAMFSD,2)) N ORAMRSF S ORAMRSF=0 F  S ORAMRSF=$O(^ORAM(103,DFN,3,ORAMFSD,2,ORAMRSF)) Q:ORAMRSF<1  D
"RTN","ORAMX1",159,0)
 .... N ORI
"RTN","ORAMX1",160,0)
 .... I ORAMRSF=1 W ?38,ORAMCTXT,"noted: (",^ORAM(103,DFN,3,ORAMFSD,2,ORAMRSF,0),")",! Q
"RTN","ORAMX1",161,0)
 .... S ORAMCMPL=^ORAM(103,DFN,3,ORAMFSD,2,ORAMRSF,0)
"RTN","ORAMX1",162,0)
 .... I $S(ORAMCMPL["MB:":1,ORAMCMPL["C:":1,1:0) S ORAMCMPL=$P(ORAMCMPL,":",2)
"RTN","ORAMX1",163,0)
 .... I $L(ORAMCMPL)>37 S ORAMCMPL=$$WRAP(ORAMCMPL,37)
"RTN","ORAMX1",164,0)
 .... F ORI=1:1:$L(ORAMCMPL,"|") W ?$S(ORI=1:38,1:40),$P(ORAMCMPL,"|",ORI),!
"RTN","ORAMX1",165,0)
 .. W ?38,"-------------------------------------",!
"RTN","ORAMX1",166,0)
 Q
"RTN","ORAMX1",167,0)
 ;
"RTN","ORAMX1",168,0)
WRAP(TEXT,LENGTH) ; Breaks text string into substrings of length LENGTH
"RTN","ORAMX1",169,0)
 N ORAMI,ORAMJ,LINE,ORAMX,ORAMX1,ORAMX2,ORAMY
"RTN","ORAMX1",170,0)
 I $G(TEXT)']"" Q ""
"RTN","ORAMX1",171,0)
 F ORAMI=1:1 D  Q:ORAMI=$L(TEXT," ")
"RTN","ORAMX1",172,0)
 . S ORAMX=$P(TEXT," ",ORAMI)
"RTN","ORAMX1",173,0)
 . I $L(ORAMX)>LENGTH D
"RTN","ORAMX1",174,0)
 .. S ORAMX1=$E(ORAMX,1,LENGTH),ORAMX2=$E(ORAMX,LENGTH+1,$L(ORAMX))
"RTN","ORAMX1",175,0)
 .. S $P(TEXT," ",ORAMI)=ORAMX1_" "_ORAMX2
"RTN","ORAMX1",176,0)
 S LINE=1,ORAMX(1)=$P(TEXT," ")
"RTN","ORAMX1",177,0)
 F ORAMI=2:1 D  Q:ORAMI'<$L(TEXT," ")
"RTN","ORAMX1",178,0)
 . S:$L($G(ORAMX(LINE))_" "_$P(TEXT," ",ORAMI))>LENGTH LINE=LINE+1,ORAMY=1
"RTN","ORAMX1",179,0)
 . S ORAMX(LINE)=$G(ORAMX(LINE))_$S(+$G(ORAMY):"",1:" ")_$P(TEXT," ",ORAMI),ORAMY=0
"RTN","ORAMX1",180,0)
 S ORAMJ=0,TEXT="" F ORAMI=1:1 S ORAMJ=$O(ORAMX(ORAMJ)) Q:+ORAMJ'>0  S TEXT=TEXT_$S(ORAMI=1:"",1:"|")_ORAMX(ORAMJ)
"RTN","ORAMX1",181,0)
 Q TEXT
"RTN","ORAMX1",182,0)
 ;
"RTN","ORAMX1",183,0)
GETVSIT(ORDXS,ORDFN,ORVDT,ORLOC) ; Find the Visit for a given Pt, Location, and Visit Date(/Time)
"RTN","ORAMX1",184,0)
 N ORVSIT,ORI
"RTN","ORAMX1",185,0)
 K ^TMP("PXKENC",$J)
"RTN","ORAMX1",186,0)
 S ORDXS=0
"RTN","ORAMX1",187,0)
 S ORVSIT=$$GETENC^PXAPI(ORDFN,ORVDT,ORLOC)
"RTN","ORAMX1",188,0)
 I +ORVSIT'>0 S ORDXS=ORDXS_"^No Visit Found" Q
"RTN","ORAMX1",189,0)
 I '$D(^TMP("PXKENC",$J,ORVSIT,"POV")) S ORDXS=ORDXS_"^No Dxs for Visit" Q
"RTN","ORAMX1",190,0)
 S ORI=0
"RTN","ORAMX1",191,0)
 F  S ORI=$O(^TMP("PXKENC",$J,ORVSIT,"POV",ORI)) Q:+ORI'>0  D
"RTN","ORAMX1",192,0)
 . N ORPOV,ORDX,ORDXC,ORDXT
"RTN","ORAMX1",193,0)
 . S ORPOV=$G(^TMP("PXKENC",$J,ORVSIT,"POV",ORI,0))
"RTN","ORAMX1",194,0)
 . S ORDX=$P(ORPOV,U) Q:+ORDX'>0
"RTN","ORAMX1",195,0)
 . S ORDXC=$$CODEC^ICDEX(80,ORDX)
"RTN","ORAMX1",196,0)
 . S ORDXT=$$TITLE^XLFSTR($$VLTD^ICDEX(ORDX,ORVDT))
"RTN","ORAMX1",197,0)
 . S ORDXS=ORDXS+1
"RTN","ORAMX1",198,0)
 . S ORDXS(ORDXS)=ORDXC_U_$$SETNARR^ORWPCE3($P(ORPOV,U,4),ORDXC)
"RTN","ORAMX1",199,0)
 K ^TMP("PXKENC",$J)
"RTN","ORAMX1",200,0)
 Q
"RTN","ORY391")
0^^B58110854
"RTN","ORY391",1,0)
ORY391 ; ISL/JER - Anticoagulation Management Installation ;11/26/14  08:59
"RTN","ORY391",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**391**;Dec 17, 1997;Build 11
"RTN","ORY391",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified
"RTN","ORY391",4,0)
 Q
"RTN","ORY391",5,0)
PRE ; Pre-install routine
"RTN","ORY391",6,0)
 N DA,DIK
"RTN","ORY391",7,0)
 ; find/delete ORAM SITE PARAMETERS template
"RTN","ORY391",8,0)
 D BMES^XPDUTL(" Executing Pre-Install Routine...")
"RTN","ORY391",9,0)
 S DA=$$FIND1^DIC(8989.52,"","X","ORAM SITE PARAMETERS","","","")
"RTN","ORY391",10,0)
 S DIK="^XTV(8989.52,"
"RTN","ORY391",11,0)
 D ^DIK
"RTN","ORY391",12,0)
 Q
"RTN","ORY391",13,0)
POST ; Post-install routine
"RTN","ORY391",14,0)
 D REGRPCS
"RTN","ORY391",15,0)
 D PARAM
"RTN","ORY391",16,0)
 Q
"RTN","ORY391",17,0)
 ;
"RTN","ORY391",18,0)
REGRPCS ; Register RPCS
"RTN","ORY391",19,0)
 D BMES^XPDUTL(" Registering RPCs with Context Menu ORAM ANTICOAGULATION CONTEXT...")
"RTN","ORY391",20,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","ORWLEX GETFREQ")
"RTN","ORY391",21,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","ORWLEX GETI10DX")
"RTN","ORY391",22,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","ORWPCE LEXCODE")
"RTN","ORY391",23,0)
 D REGISTER("ORAM ANTICOAGULATION CONTEXT","ORWPCE4 LEX")
"RTN","ORY391",24,0)
 Q
"RTN","ORY391",25,0)
 ;
"RTN","ORY391",26,0)
REGISTER(OPTION,RPC) ; Call FM Updater to register each RPC
"RTN","ORY391",27,0)
 ; Input  -- OPTION   Option file (#19) Name field (#.01)
"RTN","ORY391",28,0)
 ;           RPC      RPC sub-file (#19.05) RPC field (#.01)
"RTN","ORY391",29,0)
 ; Output -- None
"RTN","ORY391",30,0)
 N FDA,FDAIEN,ERR,DIERR
"RTN","ORY391",31,0)
 S FDA(19,"?1,",.01)=OPTION
"RTN","ORY391",32,0)
 S FDA(19.05,"?+2,?1,",.01)=RPC
"RTN","ORY391",33,0)
 D UPDATE^DIE("E","FDA","FDAIEN","ERR")
"RTN","ORY391",34,0)
 Q
"RTN","ORY391",35,0)
 ;
"RTN","ORY391",36,0)
PARAM ; main (initial) parameter transport routine
"RTN","ORY391",37,0)
 N ORENT,IDX,ROOT,REF,ORVAL,I
"RTN","ORY391",38,0)
 D BMES^XPDUTL(" Installing List of Indications for Care...")
"RTN","ORY391",39,0)
 S ROOT=$NAME(^TMP("ORAMY",$J)) K @ROOT
"RTN","ORY391",40,0)
 D LOAD(ROOT)
"RTN","ORY391",41,0)
 S IDX=0,ORENT="PKG.ORDER ENTRY/RESULTS REPORTING"
"RTN","ORY391",42,0)
 F  S IDX=$O(@ROOT@(IDX)) Q:'IDX  D
"RTN","ORY391",43,0)
 . N ORPAR,ORINST,ORIVAL,OREVAL,ORERR
"RTN","ORY391",44,0)
 . S ORPAR=$P(@ROOT@(IDX,"KEY"),U),ORINST=$P(^("KEY"),U,2)
"RTN","ORY391",45,0)
 . S ORIVAL=$P(@ROOT@(IDX,"VAL"),U),OREVAL=$P(^("VAL"),U,2)
"RTN","ORY391",46,0)
 . D BMES^XPDUTL(" Installing "_ORINST_" = "_OREVAL)
"RTN","ORY391",47,0)
 . D EN^XPAR(ORENT,ORPAR,ORINST,ORIVAL,.ORERR)
"RTN","ORY391",48,0)
 . I +$G(ORERR)>0 D BMES^XPDUTL(" Error Occurred for "_ORINST_" = "_OREVAL_": "_$P(ORERR,U,2))
"RTN","ORY391",49,0)
 K @ROOT
"RTN","ORY391",50,0)
 Q
"RTN","ORY391",51,0)
 ;
"RTN","ORY391",52,0)
LOAD(ROOT) ; load data into ^TMP (expects ROOT to be defined)
"RTN","ORY391",53,0)
 N I,REF
"RTN","ORY391",54,0)
 S I=1,ROOT=$E(ROOT,1,$L(ROOT)-1)_","
"RTN","ORY391",55,0)
 F  S REF=$P($T(DATA+I),";",3,999) Q:REF=""  D
"RTN","ORY391",56,0)
 . N ORVAL
"RTN","ORY391",57,0)
 . S ORVAL=$P($T(DATA+I+1),";",3,999)
"RTN","ORY391",58,0)
 . S @(ROOT_REF)=ORVAL,I=I+2
"RTN","ORY391",59,0)
 Q
"RTN","ORY391",60,0)
 ;
"RTN","ORY391",61,0)
DATA ; parameter data
"RTN","ORY391",62,0)
 ;;1,"KEY")
"RTN","ORY391",63,0)
 ;;ORAM I10 INDICATIONS FOR CARE^A Fib
"RTN","ORY391",64,0)
 ;;1,"VAL")
"RTN","ORY391",65,0)
 ;;`508208^I48.91
"RTN","ORY391",66,0)
 ;;2,"KEY")
"RTN","ORY391",67,0)
 ;;ORAM I10 INDICATIONS FOR CARE^A Flutter
"RTN","ORY391",68,0)
 ;;2,"VAL")
"RTN","ORY391",69,0)
 ;;`508209^I48.92
"RTN","ORY391",70,0)
 ;;3,"KEY")
"RTN","ORY391",71,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Act Prot C Res
"RTN","ORY391",72,0)
 ;;3,"VAL")
"RTN","ORY391",73,0)
 ;;`502779^D68.51
"RTN","ORY391",74,0)
 ;;4,"KEY")
"RTN","ORY391",75,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Acute MI (within 4 weeks)
"RTN","ORY391",76,0)
 ;;4,"VAL")
"RTN","ORY391",77,0)
 ;;`508039^I21.3
"RTN","ORY391",78,0)
 ;;5,"KEY")
"RTN","ORY391",79,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Antiphospholipid Synd
"RTN","ORY391",80,0)
 ;;5,"VAL")
"RTN","ORY391",81,0)
 ;;`502782^D68.61
"RTN","ORY391",82,0)
 ;;6,"KEY")
"RTN","ORY391",83,0)
 ;;ORAM I10 INDICATIONS FOR CARE^CVA (unspecified sequela)
"RTN","ORY391",84,0)
 ;;6,"VAL")
"RTN","ORY391",85,0)
 ;;`508495^I69.30
"RTN","ORY391",86,0)
 ;;7,"KEY")
"RTN","ORY391",87,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Cerebrovascular Disease
"RTN","ORY391",88,0)
 ;;7,"VAL")
"RTN","ORY391",89,0)
 ;;`508391^I67.89
"RTN","ORY391",90,0)
 ;;8,"KEY")
"RTN","ORY391",91,0)
 ;;ORAM I10 INDICATIONS FOR CARE^DVT Bilat LE Unspec Veins
"RTN","ORY391",92,0)
 ;;8,"VAL")
"RTN","ORY391",93,0)
 ;;`508955^I82.403
"RTN","ORY391",94,0)
 ;;9,"KEY")
"RTN","ORY391",95,0)
 ;;ORAM I10 INDICATIONS FOR CARE^DVT LLE Unspecified Veins
"RTN","ORY391",96,0)
 ;;9,"VAL")
"RTN","ORY391",97,0)
 ;;`508954^I82.402
"RTN","ORY391",98,0)
 ;;10,"KEY")
"RTN","ORY391",99,0)
 ;;ORAM I10 INDICATIONS FOR CARE^DVT RLE Unspecified Veins
"RTN","ORY391",100,0)
 ;;10,"VAL")
"RTN","ORY391",101,0)
 ;;`508953^I82.401
"RTN","ORY391",102,0)
 ;;11,"KEY")
"RTN","ORY391",103,0)
 ;;ORAM I10 INDICATIONS FOR CARE^DVT Uspec veins, unspec LE
"RTN","ORY391",104,0)
 ;;11,"VAL")
"RTN","ORY391",105,0)
 ;;`508956^I82.409
"RTN","ORY391",106,0)
 ;;12,"KEY")
"RTN","ORY391",107,0)
 ;;ORAM I10 INDICATIONS FOR CARE^DVT oth spec veins not in LE
"RTN","ORY391",108,0)
 ;;12,"VAL")
"RTN","ORY391",109,0)
 ;;`509045^I82.890
"RTN","ORY391",110,0)
 ;;13,"KEY")
"RTN","ORY391",111,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Enctr for Tx Drug Monitoring
"RTN","ORY391",112,0)
 ;;13,"VAL")
"RTN","ORY391",113,0)
 ;;`569128^Z51.81
"RTN","ORY391",114,0)
 ;;14,"KEY")
"RTN","ORY391",115,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Hypercoag State
"RTN","ORY391",116,0)
 ;;14,"VAL")
"RTN","ORY391",117,0)
 ;;`502781^D68.59
"RTN","ORY391",118,0)
 ;;15,"KEY")
"RTN","ORY391",119,0)
 ;;ORAM I10 INDICATIONS FOR CARE^L/T (Current) Anticoag Tx
"RTN","ORY391",120,0)
 ;;15,"VAL")
"RTN","ORY391",121,0)
 ;;`569395^Z79.01
"RTN","ORY391",122,0)
 ;;16,"KEY")
"RTN","ORY391",123,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Lupus Anticoag Synd
"RTN","ORY391",124,0)
 ;;16,"VAL")
"RTN","ORY391",125,0)
 ;;`502783^D68.62
"RTN","ORY391",126,0)
 ;;17,"KEY")
"RTN","ORY391",127,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Old MI (> 4 wks, no curr symp)
"RTN","ORY391",128,0)
 ;;17,"VAL")
"RTN","ORY391",129,0)
 ;;`508064^I25.2
"RTN","ORY391",130,0)
 ;;18,"KEY")
"RTN","ORY391",131,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Oth Prim Thrombophilia
"RTN","ORY391",132,0)
 ;;18,"VAL")
"RTN","ORY391",133,0)
 ;;`502781^D68.59
"RTN","ORY391",134,0)
 ;;19,"KEY")
"RTN","ORY391",135,0)
 ;;ORAM I10 INDICATIONS FOR CARE^PE
"RTN","ORY391",136,0)
 ;;19,"VAL")
"RTN","ORY391",137,0)
 ;;`508111^I26.99
"RTN","ORY391",138,0)
 ;;20,"KEY")
"RTN","ORY391",139,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Prothrombin Gene Mut
"RTN","ORY391",140,0)
 ;;20,"VAL")
"RTN","ORY391",141,0)
 ;;`502780^D68.52
"RTN","ORY391",142,0)
 ;;21,"KEY")
"RTN","ORY391",143,0)
 ;;ORAM I10 INDICATIONS FOR CARE^TIA
"RTN","ORY391",144,0)
 ;;21,"VAL")
"RTN","ORY391",145,0)
 ;;`504577^G45.9
"RTN","ORY391",146,0)
 ;;22,"KEY")
"RTN","ORY391",147,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Valve-Mech
"RTN","ORY391",148,0)
 ;;22,"VAL")
"RTN","ORY391",149,0)
 ;;`569742^Z95.2
"RTN","ORY391",150,0)
 ;;23,"KEY")
"RTN","ORY391",151,0)
 ;;ORAM I10 INDICATIONS FOR CARE^Valve-Tissue
"RTN","ORY391",152,0)
 ;;23,"VAL")
"RTN","ORY391",153,0)
 ;;`569743^Z95.3
"RTN","ORY391",154,0)
 ;;24,"KEY")
"RTN","ORY391",155,0)
 ;;ORAM INDICATIONS FOR CARE^A Fib
"RTN","ORY391",156,0)
 ;;24,"VAL")
"RTN","ORY391",157,0)
 ;;`2557^427.31
"RTN","ORY391",158,0)
 ;;25,"KEY")
"RTN","ORY391",159,0)
 ;;ORAM INDICATIONS FOR CARE^A Flutter
"RTN","ORY391",160,0)
 ;;25,"VAL")
"RTN","ORY391",161,0)
 ;;`2558^427.32
"RTN","ORY391",162,0)
 ;;26,"KEY")
"RTN","ORY391",163,0)
 ;;ORAM INDICATIONS FOR CARE^Antiphospholipid Antibodies
"RTN","ORY391",164,0)
 ;;26,"VAL")
"RTN","ORY391",165,0)
 ;;`1052^286.9
"RTN","ORY391",166,0)
 ;;27,"KEY")
"RTN","ORY391",167,0)
 ;;ORAM INDICATIONS FOR CARE^Antithrombin III Deficiency
"RTN","ORY391",168,0)
 ;;27,"VAL")
"RTN","ORY391",169,0)
 ;;`1052^286.9
"RTN","ORY391",170,0)
 ;;28,"KEY")
"RTN","ORY391",171,0)
 ;;ORAM INDICATIONS FOR CARE^Apical Thrombus
"RTN","ORY391",172,0)
 ;;28,"VAL")
"RTN","ORY391",173,0)
 ;;`12480^429.79
"RTN","ORY391",174,0)
 ;;29,"KEY")
"RTN","ORY391",175,0)
 ;;ORAM INDICATIONS FOR CARE^Arterial Thrombosis
"RTN","ORY391",176,0)
 ;;29,"VAL")
"RTN","ORY391",177,0)
 ;;`2628^444.9
"RTN","ORY391",178,0)
 ;;30,"KEY")
"RTN","ORY391",179,0)
 ;;ORAM INDICATIONS FOR CARE^CAD (Coronary Art Dis)
"RTN","ORY391",180,0)
 ;;30,"VAL")
"RTN","ORY391",181,0)
 ;;`12989^414.00
"RTN","ORY391",182,0)
 ;;31,"KEY")
"RTN","ORY391",183,0)
 ;;ORAM INDICATIONS FOR CARE^CHF (Cong Heart Fail)
"RTN","ORY391",184,0)
 ;;31,"VAL")
"RTN","ORY391",185,0)
 ;;`9061^428.0
"RTN","ORY391",186,0)
 ;;32,"KEY")
"RTN","ORY391",187,0)
 ;;ORAM INDICATIONS FOR CARE^CVA
"RTN","ORY391",188,0)
 ;;32,"VAL")
"RTN","ORY391",189,0)
 ;;`2599^437.9
"RTN","ORY391",190,0)
 ;;33,"KEY")
"RTN","ORY391",191,0)
 ;;ORAM INDICATIONS FOR CARE^Cardiomyopathy
"RTN","ORY391",192,0)
 ;;33,"VAL")
"RTN","ORY391",193,0)
 ;;`2535^425.4
"RTN","ORY391",194,0)
 ;;34,"KEY")
"RTN","ORY391",195,0)
 ;;ORAM INDICATIONS FOR CARE^Carotid Stenosis - Plaque
"RTN","ORY391",196,0)
 ;;34,"VAL")
"RTN","ORY391",197,0)
 ;;`12857^433.10
"RTN","ORY391",198,0)
 ;;35,"KEY")
"RTN","ORY391",199,0)
 ;;ORAM INDICATIONS FOR CARE^Cerebrovascular Disease
"RTN","ORY391",200,0)
 ;;35,"VAL")
"RTN","ORY391",201,0)
 ;;`9069^436.
"RTN","ORY391",202,0)
 ;;36,"KEY")
"RTN","ORY391",203,0)
 ;;ORAM INDICATIONS FOR CARE^Clotted Graft
"RTN","ORY391",204,0)
 ;;36,"VAL")
"RTN","ORY391",205,0)
 ;;`12511^996.74
"RTN","ORY391",206,0)
 ;;37,"KEY")
"RTN","ORY391",207,0)
 ;;ORAM INDICATIONS FOR CARE^DVT
"RTN","ORY391",208,0)
 ;;37,"VAL")
"RTN","ORY391",209,0)
 ;;`15011^453.89
"RTN","ORY391",210,0)
 ;;38,"KEY")
"RTN","ORY391",211,0)
 ;;ORAM INDICATIONS FOR CARE^Enctr for Tx Drug Monitoring
"RTN","ORY391",212,0)
 ;;38,"VAL")
"RTN","ORY391",213,0)
 ;;`13529^V58.83
"RTN","ORY391",214,0)
 ;;39,"KEY")
"RTN","ORY391",215,0)
 ;;ORAM INDICATIONS FOR CARE^Hypercoag State
"RTN","ORY391",216,0)
 ;;39,"VAL")
"RTN","ORY391",217,0)
 ;;`13798^289.81
"RTN","ORY391",218,0)
 ;;40,"KEY")
"RTN","ORY391",219,0)
 ;;ORAM INDICATIONS FOR CARE^L/T (Current) Anticoag Use
"RTN","ORY391",220,0)
 ;;40,"VAL")
"RTN","ORY391",221,0)
 ;;`13194^V58.61
"RTN","ORY391",222,0)
 ;;41,"KEY")
"RTN","ORY391",223,0)
 ;;ORAM INDICATIONS FOR CARE^LV Thrombus
"RTN","ORY391",224,0)
 ;;41,"VAL")
"RTN","ORY391",225,0)
 ;;`12480^429.79
"RTN","ORY391",226,0)
 ;;42,"KEY")
"RTN","ORY391",227,0)
 ;;ORAM INDICATIONS FOR CARE^Mesenteric Thrombosis
"RTN","ORY391",228,0)
 ;;42,"VAL")
"RTN","ORY391",229,0)
 ;;`9212^557.0
"RTN","ORY391",230,0)
 ;;43,"KEY")
"RTN","ORY391",231,0)
 ;;ORAM INDICATIONS FOR CARE^PAD (Peripheral Art Dis)
"RTN","ORY391",232,0)
 ;;43,"VAL")
"RTN","ORY391",233,0)
 ;;`2622^443.9
"RTN","ORY391",234,0)
 ;;44,"KEY")
"RTN","ORY391",235,0)
 ;;ORAM INDICATIONS FOR CARE^PE
"RTN","ORY391",236,0)
 ;;44,"VAL")
"RTN","ORY391",237,0)
 ;;`13157^415.19
"RTN","ORY391",238,0)
 ;;45,"KEY")
"RTN","ORY391",239,0)
 ;;ORAM INDICATIONS FOR CARE^Prophylaxis S/P Ortho Surgery
"RTN","ORY391",240,0)
 ;;45,"VAL")
"RTN","ORY391",241,0)
 ;;`13755^V54.89
"RTN","ORY391",242,0)
 ;;46,"KEY")
"RTN","ORY391",243,0)
 ;;ORAM INDICATIONS FOR CARE^Recurrent DVT
"RTN","ORY391",244,0)
 ;;46,"VAL")
"RTN","ORY391",245,0)
 ;;`15003^453.79
"RTN","ORY391",246,0)
 ;;47,"KEY")
"RTN","ORY391",247,0)
 ;;ORAM INDICATIONS FOR CARE^Recurrent PE
"RTN","ORY391",248,0)
 ;;47,"VAL")
"RTN","ORY391",249,0)
 ;;`14990^416.2
"RTN","ORY391",250,0)
 ;;48,"KEY")
"RTN","ORY391",251,0)
 ;;ORAM INDICATIONS FOR CARE^TIA
"RTN","ORY391",252,0)
 ;;48,"VAL")
"RTN","ORY391",253,0)
 ;;`2591^435.9
"RTN","ORY391",254,0)
 ;;49,"KEY")
"RTN","ORY391",255,0)
 ;;ORAM INDICATIONS FOR CARE^Valve-Mech
"RTN","ORY391",256,0)
 ;;49,"VAL")
"RTN","ORY391",257,0)
 ;;`11527^V43.3
"RTN","ORY391",258,0)
 ;;50,"KEY")
"RTN","ORY391",259,0)
 ;;ORAM INDICATIONS FOR CARE^Valve-Tissue
"RTN","ORY391",260,0)
 ;;50,"VAL")
"RTN","ORY391",261,0)
 ;;`11516^V42.2
"VER")
8.0^22.0
**END**
**END**
