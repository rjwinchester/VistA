Released OR*3*401 SEQ #382
Extracted from mail message
**KIDS**:OR*3.0*401^

**INSTALL NAME**
OR*3.0*401
"BLD",10438,0)
OR*3.0*401^ORDER ENTRY/RESULTS REPORTING^0^3170921^y
"BLD",10438,1,0)
^^1^1^3160812^
"BLD",10438,1,1,0)
Option ORK EDITABLE BY USER, ORQQPL4 RPC fix
"BLD",10438,4,0)
^9.64PA^^
"BLD",10438,6)
2^
"BLD",10438,6.3)
11
"BLD",10438,"ABPKG")
n
"BLD",10438,"INID")
^y
"BLD",10438,"INIT")
RUN^ORY401
"BLD",10438,"KRN",0)
^9.67PA^779.2^20
"BLD",10438,"KRN",.4,0)
.4
"BLD",10438,"KRN",.401,0)
.401
"BLD",10438,"KRN",.402,0)
.402
"BLD",10438,"KRN",.403,0)
.403
"BLD",10438,"KRN",.5,0)
.5
"BLD",10438,"KRN",.84,0)
.84
"BLD",10438,"KRN",3.6,0)
3.6
"BLD",10438,"KRN",3.8,0)
3.8
"BLD",10438,"KRN",9.2,0)
9.2
"BLD",10438,"KRN",9.8,0)
9.8
"BLD",10438,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",10438,"KRN",9.8,"NM",1,0)
ORKMGR^^0^B31961626
"BLD",10438,"KRN",9.8,"NM",2,0)
ORQQPL4^^0^B16376171
"BLD",10438,"KRN",9.8,"NM",3,0)
ORY401^^0^B7864323
"BLD",10438,"KRN",9.8,"NM","B","ORKMGR",1)
 
"BLD",10438,"KRN",9.8,"NM","B","ORQQPL4",2)
 
"BLD",10438,"KRN",9.8,"NM","B","ORY401",3)

"BLD",10438,"KRN",19,0)
19
"BLD",10438,"KRN",19.1,0)
19.1
"BLD",10438,"KRN",101,0)
101
"BLD",10438,"KRN",409.61,0)
409.61
"BLD",10438,"KRN",771,0)
771
"BLD",10438,"KRN",779.2,0)
779.2
"BLD",10438,"KRN",870,0)
870
"BLD",10438,"KRN",8989.51,0)
8989.51
"BLD",10438,"KRN",8989.52,0)
8989.52
"BLD",10438,"KRN",8994,0)
8994
"BLD",10438,"KRN","B",.4,.4)
 
"BLD",10438,"KRN","B",.401,.401)
 
"BLD",10438,"KRN","B",.402,.402)
 
"BLD",10438,"KRN","B",.403,.403)
 
"BLD",10438,"KRN","B",.5,.5)
 
"BLD",10438,"KRN","B",.84,.84)
 
"BLD",10438,"KRN","B",3.6,3.6)
 
"BLD",10438,"KRN","B",3.8,3.8)
 
"BLD",10438,"KRN","B",9.2,9.2)
 
"BLD",10438,"KRN","B",9.8,9.8)
 
"BLD",10438,"KRN","B",19,19)
 
"BLD",10438,"KRN","B",19.1,19.1)
 
"BLD",10438,"KRN","B",101,101)
 
"BLD",10438,"KRN","B",409.61,409.61)
 
"BLD",10438,"KRN","B",771,771)
 
"BLD",10438,"KRN","B",779.2,779.2)
 
"BLD",10438,"KRN","B",870,870)
 
"BLD",10438,"KRN","B",8989.51,8989.51)
 
"BLD",10438,"KRN","B",8989.52,8989.52)
 
"BLD",10438,"KRN","B",8994,8994)
 
"BLD",10438,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",10438,"QUES",0)
^9.62^^
"BLD",10438,"REQB",0)
^9.611^2^2
"BLD",10438,"REQB",1,0)
OR*3.0*105^1
"BLD",10438,"REQB",2,0)
OR*3.0*350^1
"BLD",10438,"REQB","B","OR*3.0*105",1)

"BLD",10438,"REQB","B","OR*3.0*350",2)

"INIT")
RUN^ORY401
"MBREQ")
0
"PKG",188,-1)
1^1
"PKG",188,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",188,20,0)
^9.402P^^
"PKG",188,22,0)
^9.49I^1^1
"PKG",188,22,1,0)
3.0^2971217^2981113^1
"PKG",188,22,1,"PAH",1,0)
401^3170921^520824646
"PKG",188,22,1,"PAH",1,1,0)
^^1^1^3170921
"PKG",188,22,1,"PAH",1,1,1,0)
Option ORK EDITABLE BY USER, ORQQPL4 RPC fix
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","ORKMGR")
0^1^B31961626^B20726138
"RTN","ORKMGR",1,0)
ORKMGR ; SLC/AEB,CLA - Manager Options - Order Checking Parameters ;9/22/97
"RTN","ORKMGR",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**9,85,105,401**;Dec 17, 1997;Build 11
"RTN","ORKMGR",3,0)
 ;
"RTN","ORKMGR",4,0)
 ;References to ^XPAR supported by IA #2263
"RTN","ORKMGR",5,0)
 ;Direct read of 8989.51 "B" index supported by IA #2685
"RTN","ORKMGR",6,0)
 ;References to ^DIR supported by IA #10026
"RTN","ORKMGR",7,0)
 ;Fileman read of File 200 Field .01 field supported by IA #10060
"RTN","ORKMGR",8,0)
 ;Fileman read of File 44 Field .01 field supported by IA #10040
"RTN","ORKMGR",9,0)
 ;Fileman read of File 49 Field .01 supported by IA #10093
"RTN","ORKMGR",10,0)
 ;Fileman read of File 4 Field .01 supported by IA #10090
"RTN","ORKMGR",11,0)
 ;Fileman read of File 4.2 Field .01 supported by IA #1966
"RTN","ORKMGR",12,0)
 ;Fileman read of File 9.4 Field .01 supported by IA #10048
"RTN","ORKMGR",13,0)
 ;Reference to $$GET1^DIQ() supported by IA #2056
"RTN","ORKMGR",14,0)
 ;
"RTN","ORKMGR",15,0)
PFLAG ;
"RTN","ORKMGR",16,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",17,0)
 S ORKT="Enable/Disable an Order Check",PIEN=0
"RTN","ORKMGR",18,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK PROCESSING FLAG",PIEN)) Q:PIEN=""
"RTN","ORKMGR",19,0)
 S PAR=PIEN
"RTN","ORKMGR",20,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",21,0)
 Q
"RTN","ORKMGR",22,0)
 ;
"RTN","ORKMGR",23,0)
CLINDL ;
"RTN","ORKMGR",24,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",25,0)
 S ORKT="Set Clinical Danger Level for an Order Check",PIEN=0
"RTN","ORKMGR",26,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK CLINICAL DANGER LEVEL",PIEN)) Q:PIEN=""
"RTN","ORKMGR",27,0)
 S PAR=PIEN
"RTN","ORKMGR",28,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",29,0)
 Q
"RTN","ORKMGR",30,0)
 ;
"RTN","ORKMGR",31,0)
CTLIMH ;
"RTN","ORKMGR",32,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",33,0)
 S ORKT="CT Scanner Height Limit",PIEN=0
"RTN","ORKMGR",34,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK CT LIMIT HT",PIEN)) Q:PIEN=""
"RTN","ORKMGR",35,0)
 S PAR=PIEN
"RTN","ORKMGR",36,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",37,0)
 Q
"RTN","ORKMGR",38,0)
 ;
"RTN","ORKMGR",39,0)
CTLIMW ;
"RTN","ORKMGR",40,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",41,0)
 S ORKT="CAT Scanner Weight Limit",PIEN=0
"RTN","ORKMGR",42,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK CT LIMIT WT",PIEN)) Q:PIEN=""
"RTN","ORKMGR",43,0)
 S PAR=PIEN
"RTN","ORKMGR",44,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",45,0)
 Q
"RTN","ORKMGR",46,0)
 ;
"RTN","ORKMGR",47,0)
MRLIMH ;
"RTN","ORKMGR",48,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",49,0)
 S ORKT="MRI Scanner Height Limit",PIEN=0
"RTN","ORKMGR",50,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK MRI LIMIT HT",PIEN)) Q:PIEN=""
"RTN","ORKMGR",51,0)
 S PAR=PIEN
"RTN","ORKMGR",52,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",53,0)
 Q
"RTN","ORKMGR",54,0)
 ;
"RTN","ORKMGR",55,0)
MRLIMW ;
"RTN","ORKMGR",56,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",57,0)
 S ORKT="MRI Scanner Weight Limit",PIEN=0
"RTN","ORKMGR",58,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK MRI LIMIT WT",PIEN)) Q:PIEN=""
"RTN","ORKMGR",59,0)
 S PAR=PIEN
"RTN","ORKMGR",60,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",61,0)
 Q
"RTN","ORKMGR",62,0)
 ;
"RTN","ORKMGR",63,0)
DUPOR ;
"RTN","ORKMGR",64,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",65,0)
 S ORKT="Orderable Item Duplicate Order Range",PIEN=0
"RTN","ORKMGR",66,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK DUP ORDER RANGE OI",PIEN)) Q:PIEN=""
"RTN","ORKMGR",67,0)
 S PAR=PIEN
"RTN","ORKMGR",68,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",69,0)
 Q
"RTN","ORKMGR",70,0)
 ;
"RTN","ORKMGR",71,0)
DUPLR ;
"RTN","ORKMGR",72,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",73,0)
 S ORKT="Lab Duplicate Order Range",PIEN=0
"RTN","ORKMGR",74,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK DUP ORDER RANGE LAB",PIEN)) Q:PIEN=""
"RTN","ORKMGR",75,0)
 S PAR=PIEN
"RTN","ORKMGR",76,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",77,0)
 Q
"RTN","ORKMGR",78,0)
 ;
"RTN","ORKMGR",79,0)
DUPRA ;
"RTN","ORKMGR",80,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",81,0)
 S ORKT="Imaging Duplicate Order Range",PIEN=0
"RTN","ORKMGR",82,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK DUP ORDER RANGE RADIOLOGY",PIEN)) Q:PIEN=""
"RTN","ORKMGR",83,0)
 S PAR=PIEN
"RTN","ORKMGR",84,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",85,0)
 Q
"RTN","ORKMGR",86,0)
 ;
"RTN","ORKMGR",87,0)
SYSEN ;
"RTN","ORKMGR",88,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",89,0)
 S ORKT="Enable or Disable Order Checking System",PIEN=0
"RTN","ORKMGR",90,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK SYSTEM ENABLE/DISABLE",PIEN)) Q:PIEN=""
"RTN","ORKMGR",91,0)
 S PAR=PIEN
"RTN","ORKMGR",92,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",93,0)
 Q
"RTN","ORKMGR",94,0)
 ;
"RTN","ORKMGR",95,0)
DEBUG ;
"RTN","ORKMGR",96,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",97,0)
 S ORKT="Enable or Disable Logging Debug Messages",PIEN=0
"RTN","ORKMGR",98,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK DEBUG ENABLE/DISABLE",PIEN)) Q:PIEN=""
"RTN","ORKMGR",99,0)
 S PAR=PIEN
"RTN","ORKMGR",100,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",101,0)
 Q
"RTN","ORKMGR",102,0)
 ;
"RTN","ORKMGR",103,0)
POLYRX ;
"RTN","ORKMGR",104,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",105,0)
 S ORKT="Set Number of Meds for Polypharmacy",PIEN=0
"RTN","ORKMGR",106,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK POLYPHARMACY",PIEN)) Q:PIEN=""
"RTN","ORKMGR",107,0)
 S PAR=PIEN
"RTN","ORKMGR",108,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",109,0)
 Q
"RTN","ORKMGR",110,0)
 ;
"RTN","ORKMGR",111,0)
GLUCREAT ;
"RTN","ORKMGR",112,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",113,0)
 S ORKT="Set Creatinine Search Range for Glucophage-Lab Results Order Check",PIEN=0
"RTN","ORKMGR",114,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK GLUCOPHAGE CREATININE",PIEN)) Q:PIEN=""
"RTN","ORKMGR",115,0)
 S PAR=PIEN
"RTN","ORKMGR",116,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",117,0)
 Q
"RTN","ORKMGR",118,0)
 ;
"RTN","ORKMGR",119,0)
EDITUSER ;
"RTN","ORKMGR",120,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",121,0)
 S ORKT="Set One or More Order Checks to be Uneditable By End Users",PIEN=0
"RTN","ORKMGR",122,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK EDITABLE BY USER",PIEN)) Q:PIEN=""
"RTN","ORKMGR",123,0)
 ;P.401 added check for existing disabled parameters
"RTN","ORKMGR",124,0)
 N OLDLIST,NEWLIST,ERR,ORPFIEN
"RTN","ORKMGR",125,0)
 S ORPFIEN=0 S ORPFIEN=$O(^XTV(8989.51,"B","ORK PROCESSING FLAG",ORPFIEN))
"RTN","ORKMGR",126,0)
 D ENVAL^XPAR(.OLDLIST,PIEN,,.ERR)
"RTN","ORKMGR",127,0)
 S PAR=PIEN
"RTN","ORKMGR",128,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",129,0)
 I '$G(ERR) D ENVAL^XPAR(.NEWLIST,PIEN,,.ERR)
"RTN","ORKMGR",130,0)
 Q:$G(ERR)
"RTN","ORKMGR",131,0)
 N ORENT S ORENT=""  F  S ORENT=$O(NEWLIST(ORENT)) Q:'ORENT  N ORINST S ORINST="" F  S ORINST=$O(NEWLIST(ORENT,ORINST)) Q:'ORINST  I ('$D(OLDLIST(ORENT,ORINST))!($G(OLDLIST(ORENT,ORINST))=1))&(($G(NEWLIST(ORENT,ORINST))=0)) D
"RTN","ORKMGR",132,0)
 .N PFLIST D ENVAL^XPAR(.PFLIST,ORPFIEN,,.ERR) Q:$G(ERR)
"RTN","ORKMGR",133,0)
 .N PFENT S PFENT="" F  S PFENT=$O(PFLIST(PFENT)) Q:'PFENT  N PFINST S PFINST="" F  S PFINST=$O(PFLIST(PFENT,PFINST)) Q:'PFINST  I PFINST=ORINST D
"RTN","ORKMGR",134,0)
 ..D CHG^XPAR(PFENT,ORPFIEN,"`"_PFINST,"E",.ERR)
"RTN","ORKMGR",135,0)
 Q
"RTN","ORKMGR",136,0)
 ;
"RTN","ORKMGR",137,0)
CMCREAT ;
"RTN","ORKMGR",138,0)
 N ORKT,PAR,PIEN
"RTN","ORKMGR",139,0)
 S ORKT="Set Creatinine Search Range for Biochem Abnormality for Contrast Media Order Chk",PIEN=0
"RTN","ORKMGR",140,0)
 S PIEN=$O(^XTV(8989.51,"B","ORK CONTRAST MEDIA CREATININE",PIEN)) Q:PIEN=""
"RTN","ORKMGR",141,0)
 S PAR=PIEN
"RTN","ORKMGR",142,0)
 D TITLE(ORKT) D PROC(PAR)
"RTN","ORKMGR",143,0)
 Q
"RTN","ORKMGR",144,0)
 ;
"RTN","ORKMGR",145,0)
TITLE(ORKT) ;
"RTN","ORKMGR",146,0)
 ; Center and write title - Parameter to be set
"RTN","ORKMGR",147,0)
 S IOP=0 D ^%ZIS K IOP W @IOF
"RTN","ORKMGR",148,0)
 W !,?(80-$L(ORKT)-1/2),ORKT
"RTN","ORKMGR",149,0)
 Q
"RTN","ORKMGR",150,0)
PROC(PAR) ; Process Parameter Settings
"RTN","ORKMGR",151,0)
 D EDITPAR^XPAREDIT(PAR)
"RTN","ORKMGR",152,0)
 Q
"RTN","ORKMGR",153,0)
USRCHKS ; List order checks a user could receive
"RTN","ORKMGR",154,0)
 N ORKUSR
"RTN","ORKMGR",155,0)
 ;  Get user DUZ number
"RTN","ORKMGR",156,0)
 K DIC,Y S DIC="^VA(200,",DIC(0)="AEQ",DIC("A")="Enter user's name: ",DIC("B")=DUZ D ^DIC Q:Y<1
"RTN","ORKMGR",157,0)
 S ORKUSR=$S(Y'<1:$P(Y,"^"),1:DUZ) K DIC,Y,DUOUT,DTOUT
"RTN","ORKMGR",158,0)
 D USRCHKS^ORKUTL(ORKUSR)
"RTN","ORKMGR",159,0)
 Q
"RTN","ORQQPL4")
0^2^B16376171^B15703032
"RTN","ORQQPL4",1,0)
ORQQPL4 ; ISL/JER/TC - Lexicon Look-up w/Synonyms ;07/30/15  08:25
"RTN","ORQQPL4",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**306,361,350,401**;Dec 17, 1997;Build 11
"RTN","ORQQPL4",3,0)
 ;
"RTN","ORQQPL4",4,0)
 ; DBIA 2950   LOOK^LEXA          ^TMP("LEXFND",$J)
"RTN","ORQQPL4",5,0)
 ; DBIA 1609   CONFIG^LEXSET      ^TMP("LEXSCH",$J)
"RTN","ORQQPL4",6,0)
 ;  ICR 5699   $$ICDDATA^ICDXCODE
"RTN","ORQQPL4",7,0)
 ;
"RTN","ORQQPL4",8,0)
 Q
"RTN","ORQQPL4",9,0)
LEX(LST,X,VIEW,ORDATE,ORINCSYN) ; return list after lexicon lookup
"RTN","ORQQPL4",10,0)
 ; Call with: X           (Required) The search text entered by the user
"RTN","ORQQPL4",11,0)
 ;            [VIEW]      (Optional) The Lexicon VIEW parameter (Defaults to
"RTN","ORQQPL4",12,0)
 ;                                   Problem List Subset (i.e., "PLS")
"RTN","ORQQPL4",13,0)
 ;            [ORDATE]    (Optional) the date of interest (Defaults to TODAY)
"RTN","ORQQPL4",14,0)
 ;            [ORINCSYN]  (Optional) Boolean flag specifying whether or not to
"RTN","ORQQPL4",15,0)
 ;                                   include synonyms for SNOMED CT Concepts
"RTN","ORQQPL4",16,0)
 ;                                   (Defaults to 0 (FALSE))
"RTN","ORQQPL4",17,0)
 ;
"RTN","ORQQPL4",18,0)
 ;   Returns: LST=gvn of ^TMP("ORLEX",$J), which contains search result set as:
"RTN","ORQQPL4",19,0)
 ;            ^TMP("ORLEX",$J,1..n)=LEXIEN^PREFTEXT^ICDCODE(S)^ICDIEN^CODESYS^CONCEPTID^DESIGID^ICDVER^PARENTSUBSCRIPT
"RTN","ORQQPL4",20,0)
 ;            ^TMP("ORLEX",$J,n+1)="<n> matches found"
"RTN","ORQQPL4",21,0)
 ;
"RTN","ORQQPL4",22,0)
 N LEX,ILST,I,IEN,APP
"RTN","ORQQPL4",23,0)
 N DIC ; p401  if an erroneous DIC("S") is left in memory it causes issues in LOOK^LEXA
"RTN","ORQQPL4",24,0)
 S APP="GMPX",LST=$NA(^TMP("ORLEX",$J)) K @LST
"RTN","ORQQPL4",25,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORQQPL4",26,0)
 S:'$L($G(VIEW)) VIEW="PLS"
"RTN","ORQQPL4",27,0)
 S ORINCSYN=+$G(ORINCSYN)
"RTN","ORQQPL4",28,0)
 I $S(X?.1A2.3N.1".".2N:1,X?.1A2.3N1"+":1,1:0) D  Q
"RTN","ORQQPL4",29,0)
 . S @LST@(1)="icd^Searching by code on the Problems Tab supports SNOMED CT, but not ICD."
"RTN","ORQQPL4",30,0)
 . S @LST@(2)="Please try a different search"
"RTN","ORQQPL4",31,0)
 D CONFIG^LEXSET(APP,VIEW,ORDATE)
"RTN","ORQQPL4",32,0)
 ; call LOOK^LEXA to execute the search as defined by the call to CONFIG^LEXSET
"RTN","ORQQPL4",33,0)
 D LOOK^LEXA(X,,1,,ORDATE)
"RTN","ORQQPL4",34,0)
 I '$D(LEX("LIST",1)) D  G LEXX
"RTN","ORQQPL4",35,0)
 . S:X?.N @LST@(1)="Code search failed"
"RTN","ORQQPL4",36,0)
 S ILST=0
"RTN","ORQQPL4",37,0)
 S @LST@(1)=$$LEXXFRM(LEX("LIST",1),ORDATE,APP),ILST=1
"RTN","ORQQPL4",38,0)
 D:ORINCSYN SYNONYMS(.LST,.ILST,"SCT",$P(@LST@(1),U,6),ORDATE)
"RTN","ORQQPL4",39,0)
 S (I,IEN)=""
"RTN","ORQQPL4",40,0)
 F  S I=$O(^TMP("LEXFND",$J,I)) Q:I=""  D  ;DBIA 2950
"RTN","ORQQPL4",41,0)
 .F  S IEN=$O(^TMP("LEXFND",$J,I,IEN)) Q:IEN=""  D
"RTN","ORQQPL4",42,0)
 ..N TXT,ELEMENT S TXT=^TMP("LEXFND",$J,I,IEN)
"RTN","ORQQPL4",43,0)
 ..S ELEMENT=IEN_U_TXT
"RTN","ORQQPL4",44,0)
 ..S ELEMENT=$$LEXXFRM(ELEMENT,ORDATE,APP)
"RTN","ORQQPL4",45,0)
 ..S ILST=ILST+1,@LST@(ILST)=ELEMENT
"RTN","ORQQPL4",46,0)
 ..D:ORINCSYN SYNONYMS(.LST,.ILST,"SCT",$P(ELEMENT,U,6),ORDATE)
"RTN","ORQQPL4",47,0)
 I '$D(@LST@(1)) S @LST@(1)="No matches found"
"RTN","ORQQPL4",48,0)
 E  S @LST@(ILST+1)=ILST_$S(ILST=1:" match",1:" matches")_" found"
"RTN","ORQQPL4",49,0)
LEXX K ^TMP("LEXFND",$J),^TMP("LEXHIT",$J),^TMP("LEXSCH",$J),^TMP("LEXLE",$J)
"RTN","ORQQPL4",50,0)
 Q
"RTN","ORQQPL4",51,0)
LEXXFRM(ORX,ORDATE,ORAPP) ; Transform text for SCT look-up
"RTN","ORQQPL4",52,0)
 N ORLEX,ORY,ORICD,ORSCT,ORTXT,ORCODSYS,ORCCODE,ORDCODE
"RTN","ORQQPL4",53,0)
 S ORLEX=$P(ORX,U),ORTXT=$P(ORX,U,2),(ORCCODE,ORCODSYS)=""
"RTN","ORQQPL4",54,0)
 I ORTXT["*" S ORTXT=$$STRIP^XLFSTR(ORTXT,"*")
"RTN","ORQQPL4",55,0)
 I (ORTXT["("),(ORTXT[")") D
"RTN","ORQQPL4",56,0)
 . S ORCODSYS=$RE($P($P($RE(ORTXT),"("),")",2))
"RTN","ORQQPL4",57,0)
 . S ORCCODE=$$ONE^LEXU(+ORLEX,ORDATE,"SCT"),ORCODSYS=$RE($P($RE(ORCODSYS)," ",2,99))
"RTN","ORQQPL4",58,0)
 . S ORTXT=$$TRIM^XLFSTR($RE($P($RE(ORTXT),"(",2,99)))
"RTN","ORQQPL4",59,0)
 S ORY=$$SETELEM(ORLEX,ORTXT,ORCODSYS,ORCCODE,ORDATE)
"RTN","ORQQPL4",60,0)
 Q ORY
"RTN","ORQQPL4",61,0)
SYNONYMS(LST,ILST,ORCSYS,ORCCODE,ORDT) ; Get synonyms for expression
"RTN","ORQQPL4",62,0)
 N ORSYN,ORI,ORDAD S ORDT=$G(ORDT,DT),ORDAD=ILST
"RTN","ORQQPL4",63,0)
 D GETSYN^LEXTRAN1(ORCSYS,ORCCODE,ORDT,"ORSYN",1,1)
"RTN","ORQQPL4",64,0)
 S ORI=0 F  S ORI=$O(ORSYN("S",ORI)) Q:+ORI'>0  D
"RTN","ORQQPL4",65,0)
 . N ELEMENT,TXT,IEN,ORDCODE
"RTN","ORQQPL4",66,0)
 . S IEN=$P(ORSYN("S",ORI),U,2),TXT=$P(ORSYN("S",ORI),U),ORDCODE=$P(ORSYN("S",ORI),U,3)
"RTN","ORQQPL4",67,0)
 . S ELEMENT=$$SETELEM(IEN,TXT,"SNOMED CT",ORCCODE,ORDT,ORDCODE)_U_ORDAD
"RTN","ORQQPL4",68,0)
 . S ILST=ILST+1,@LST@(ILST)=ELEMENT
"RTN","ORQQPL4",69,0)
 Q
"RTN","ORQQPL4",70,0)
SETELEM(ORLEX,ORTXT,ORCODSYS,ORCCODE,ORDATE,ORDCODE) ; Set List Element
"RTN","ORQQPL4",71,0)
 N ORY,ORIMPDT,ORICD,ORICDID,ORSYN,ORTYP,ORQT,ORNUM
"RTN","ORQQPL4",72,0)
 S ORIMPDT=$$IMPDATE^LEXU("10D"),(ORTYP,ORQT,ORNUM)=""
"RTN","ORQQPL4",73,0)
 I '$D(ORDCODE) D
"RTN","ORQQPL4",74,0)
 . S ORDCODE=$$GETSYN^LEXTRAN1("SCT",ORCCODE,ORDATE,"ORSYN",1,1)
"RTN","ORQQPL4",75,0)
 . I $P(ORDCODE,U)'=1 S ORDCODE="" Q
"RTN","ORQQPL4",76,0)
 . F  S ORTYP=$O(ORSYN(ORTYP)) Q:ORTYP="S"!(ORQT)  D
"RTN","ORQQPL4",77,0)
 . . I $P(ORSYN(ORTYP),U)=ORTXT S ORDCODE=$P(ORSYN(ORTYP),U,3),ORQT=1 Q
"RTN","ORQQPL4",78,0)
 . I ORTYP="S" F  S ORNUM=$O(ORSYN(ORTYP,ORNUM)) Q:ORNUM=""!(ORQT)  D
"RTN","ORQQPL4",79,0)
 . . I $P(ORSYN(ORTYP,ORNUM),U)=ORTXT S ORDCODE=$P(ORSYN(ORTYP,ORNUM),U,3),ORQT=1 Q
"RTN","ORQQPL4",80,0)
 I ORDCODE["^" S ORDCODE=""
"RTN","ORQQPL4",81,0)
 S ORICD=$$GETDX^ORQQPL1(ORCCODE,ORCODSYS,ORDATE)
"RTN","ORQQPL4",82,0)
 S ORICDID=+$$ICDDATA^ICDXCODE("DIAG",$P(ORICD,"/"),ORDATE,"E")
"RTN","ORQQPL4",83,0)
 S ORY=ORLEX_U_ORTXT_U_ORICD_U_ORICDID_U_ORCODSYS_U_ORCCODE_U_ORDCODE
"RTN","ORQQPL4",84,0)
 I (ORCODSYS["SNOMED")!(ORCODSYS["VHAT") D
"RTN","ORQQPL4",85,0)
 .S ORY=ORY_U_$S(ORDATE<ORIMPDT:"ICD-9-CM",1:"ICD-10-CM")
"RTN","ORQQPL4",86,0)
 Q ORY
"RTN","ORY401")
0^3^B7864323^n/a
"RTN","ORY401",1,0)
ORY401 ;MWA/VMP - POST INSTALL FOR PATCH OR*3.0*401 ; 8/9/16 10:11am
"RTN","ORY401",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**401**;;Build 11
"RTN","ORY401",3,0)
 Q  ; this routine should only be called from an entry point
"RTN","ORY401",4,0)
RUN ; main entry tag
"RTN","ORY401",5,0)
 N PIEN,LIST,ERR,ORPFIEN,MSGCNT,ORMSG
"RTN","ORY401",6,0)
 S MSGCNT=4
"RTN","ORY401",7,0)
 S PIEN=0,PIEN=$O(^XTV(8989.51,"B","ORK EDITABLE BY USER",PIEN)) Q:PIEN=""
"RTN","ORY401",8,0)
 S ORPFIEN=0,ORPFIEN=$O(^XTV(8989.51,"B","ORK PROCESSING FLAG",ORPFIEN))
"RTN","ORY401",9,0)
 D ENVAL^XPAR(.LIST,PIEN,,.ERR)
"RTN","ORY401",10,0)
 Q:$G(ERR)
"RTN","ORY401",11,0)
 N ORENT,PCNT S ORENT=""  F  S ORENT=$O(LIST(ORENT)) Q:'ORENT  N ORINST S ORINST="" F  S ORINST=$O(LIST(ORENT,ORINST)) Q:'ORINST  I $G(LIST(ORENT,ORINST))=0 D
"RTN","ORY401",12,0)
 .S ORMSG(MSGCNT)="INSTANCE """_$G(^ORD(100.8,+ORINST,0))_""":",MSGCNT=MSGCNT+1,PCNT=MSGCNT
"RTN","ORY401",13,0)
 .N PFLIST D ENVAL^XPAR(.PFLIST,ORPFIEN,,.ERR) Q:$G(ERR)
"RTN","ORY401",14,0)
 .N PFENT S PFENT="" F  S PFENT=$O(PFLIST(PFENT)) Q:'PFENT  N PFINST S PFINST="" F  S PFINST=$O(PFLIST(PFENT,PFINST)) Q:'PFINST  I PFINST=ORINST D
"RTN","ORY401",15,0)
 ..Q:PFLIST(PFENT,PFINST)="E"
"RTN","ORY401",16,0)
 ..D CHG^XPAR(PFENT,ORPFIEN,"`"_PFINST,"E",.ERR)
"RTN","ORY401",17,0)
 ..N FILENUM,FILE,P2,VALUE,IEN S P2=$P(PFENT,";",2) S FILENUM=$S(P2="VA(200,":200,P2="SC(":44,P2="DIC(49,":49,P2="DIC(4,":4,P2="DIC(4.2,":4.2,P2="DIC(9.4,":9.4,1:+$P(P2,"(",2))
"RTN","ORY401",18,0)
 ..S IEN=$P(PFENT,";"),VALUE=$$GET1^DIQ(FILENUM,IEN_",",.01)
"RTN","ORY401",19,0)
 ..S FILE=$S(P2="VA(200,":"NEW PERSON",P2="SC(":"HOSPITAL LOCATION",P2="DIC(49,":"SERVICE/SECTION",P2="DIC(4,":"INSTITUTION",P2="DIC(4.2,":"DOMAIN",P2="DIC(9.4,":"PACKAGE",1:P2)
"RTN","ORY401",20,0)
 ..S ORMSG(MSGCNT)="  "_FILE_" - "_VALUE,MSGCNT=MSGCNT+1
"RTN","ORY401",21,0)
 .I PCNT=MSGCNT S ORMSG(MSGCNT)="  No changes",MSGCNT=MSGCNT+1
"RTN","ORY401",22,0)
 .S ORMSG(MSGCNT)=" ",MSGCNT=MSGCNT+1
"RTN","ORY401",23,0)
 D MAIL
"RTN","ORY401",24,0)
 Q
"RTN","ORY401",25,0)
MAIL ; send mailman message
"RTN","ORY401",26,0)
 N XMSUB,XMDUZ,XMTEXT,XMY,DIFROM
"RTN","ORY401",27,0)
 S ORMSG(1)="OR*3.0*401 Post install routine has completed"
"RTN","ORY401",28,0)
 S ORMSG(2)="The ORK PROCESSING FLAG PARAMETER for the following entities have been changed to ENABLED"
"RTN","ORY401",29,0)
 S ORMSG(3)=" "
"RTN","ORY401",30,0)
 I '$D(ORMSG(4)) S ORMSG(4)="No changes"
"RTN","ORY401",31,0)
 S XMSUB="OR*3.0*401 Post install routine has completed"
"RTN","ORY401",32,0)
 S XMDUZ="ORDER ENTRY/RESULTS REPORTING PACKAGE"
"RTN","ORY401",33,0)
 S XMTEXT="ORMSG("
"RTN","ORY401",34,0)
 S XMY(DUZ)=""
"RTN","ORY401",35,0)
 D ^XMD
"RTN","ORY401",36,0)
 Q
"VER")
8.0^22.2
"BLD",10438,6)
^382
**END**
**END**

