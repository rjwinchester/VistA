Released OR*3*379 SEQ #338
Extracted from mail message
**KIDS**:OR*3.0*379^

**INSTALL NAME**
OR*3.0*379
"BLD",9484,0)
OR*3.0*379^ORDER ENTRY/RESULTS REPORTING^0^3140411^y
"BLD",9484,1,0)
^^3^3^3130912^
"BLD",9484,1,1,0)
Modified the API LMENTRY^ORB3U1 to properly parse out the alert message 
"BLD",9484,1,2,0)
containing the CV tagged data in addition to the current parsing 
"BLD",9484,1,3,0)
mechanism in place.
"BLD",9484,4,0)
^9.64PA^^
"BLD",9484,6)
1^
"BLD",9484,6.3)
13
"BLD",9484,"ABPKG")
n
"BLD",9484,"KRN",0)
^9.67PA^779.2^20
"BLD",9484,"KRN",.4,0)
.4
"BLD",9484,"KRN",.401,0)
.401
"BLD",9484,"KRN",.402,0)
.402
"BLD",9484,"KRN",.403,0)
.403
"BLD",9484,"KRN",.5,0)
.5
"BLD",9484,"KRN",.84,0)
.84
"BLD",9484,"KRN",3.6,0)
3.6
"BLD",9484,"KRN",3.8,0)
3.8
"BLD",9484,"KRN",9.2,0)
9.2
"BLD",9484,"KRN",9.8,0)
9.8
"BLD",9484,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9484,"KRN",9.8,"NM",1,0)
ORB3U1^^0^B66692365
"BLD",9484,"KRN",9.8,"NM","B","ORB3U1",1)

"BLD",9484,"KRN",19,0)
19
"BLD",9484,"KRN",19,"NM",0)
^9.68A^^
"BLD",9484,"KRN",19.1,0)
19.1
"BLD",9484,"KRN",101,0)
101
"BLD",9484,"KRN",409.61,0)
409.61
"BLD",9484,"KRN",771,0)
771
"BLD",9484,"KRN",779.2,0)
779.2
"BLD",9484,"KRN",870,0)
870
"BLD",9484,"KRN",8989.51,0)
8989.51
"BLD",9484,"KRN",8989.52,0)
8989.52
"BLD",9484,"KRN",8994,0)
8994
"BLD",9484,"KRN","B",.4,.4)

"BLD",9484,"KRN","B",.401,.401)

"BLD",9484,"KRN","B",.402,.402)

"BLD",9484,"KRN","B",.403,.403)

"BLD",9484,"KRN","B",.5,.5)

"BLD",9484,"KRN","B",.84,.84)

"BLD",9484,"KRN","B",3.6,3.6)

"BLD",9484,"KRN","B",3.8,3.8)

"BLD",9484,"KRN","B",9.2,9.2)

"BLD",9484,"KRN","B",9.8,9.8)

"BLD",9484,"KRN","B",19,19)

"BLD",9484,"KRN","B",19.1,19.1)

"BLD",9484,"KRN","B",101,101)

"BLD",9484,"KRN","B",409.61,409.61)

"BLD",9484,"KRN","B",771,771)

"BLD",9484,"KRN","B",779.2,779.2)

"BLD",9484,"KRN","B",870,870)

"BLD",9484,"KRN","B",8989.51,8989.51)

"BLD",9484,"KRN","B",8989.52,8989.52)

"BLD",9484,"KRN","B",8994,8994)

"BLD",9484,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",9484,"QUES",0)
^9.62^^
"BLD",9484,"REQB",0)
^9.611^1^1
"BLD",9484,"REQB",1,0)
OR*3.0*250^1
"BLD",9484,"REQB","B","OR*3.0*250",1)

"MBREQ")
0
"PKG",174,-1)
1^1
"PKG",174,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",174,20,0)
^9.402P^^
"PKG",174,22,0)
^9.49I^1^1
"PKG",174,22,1,0)
3.0^2971217^2990325^66481
"PKG",174,22,1,"PAH",1,0)
379^3140411
"PKG",174,22,1,"PAH",1,1,0)
^^3^3^3140411
"PKG",174,22,1,"PAH",1,1,1,0)
Modified the API LMENTRY^ORB3U1 to properly parse out the alert message 
"PKG",174,22,1,"PAH",1,1,2,0)
containing the CV tagged data in addition to the current parsing 
"PKG",174,22,1,"PAH",1,1,3,0)
mechanism in place.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","ORB3U1")
0^1^B66692365^B66271462
"RTN","ORB3U1",1,0)
ORB3U1 ; slc/CLA - Utilities which support OE/RR 3 Notifications ;12/15/97
"RTN","ORB3U1",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**9,74,88,91,105,179,220,250,379**;Dec 17, 1997;Build 13
"RTN","ORB3U1",3,0)
 Q
"RTN","ORB3U1",4,0)
LIST(Y) ;return list of notifications from Notification File [#100.9]
"RTN","ORB3U1",5,0)
 ; RETURN IEN^NAME^URGENCY
"RTN","ORB3U1",6,0)
 N I,J,V
"RTN","ORB3U1",7,0)
 S I=1
"RTN","ORB3U1",8,0)
 S J=0 F  S J=$O(^ORD(100.9,"B",J)) Q:J=""  S V=0,V=$O(^ORD(100.9,"B",J,V)) S Y(I)=V_"^"_J_"^"_^ORD(100.9,V,3),I=I+1
"RTN","ORB3U1",9,0)
 Q
"RTN","ORB3U1",10,0)
 ;
"RTN","ORB3U1",11,0)
ALRTHX ;report the recipients for an alert, when received, action taken
"RTN","ORB3U1",12,0)
 N ORBDFN,ORBSDT,ORBEDT
"RTN","ORB3U1",13,0)
 ;prompt for patient (required):
"RTN","ORB3U1",14,0)
 K DIC S DIC="^DPT(",DIC("A")="PATIENT (req'd): ",DIC(0)="AEQNM" D ^DIC
"RTN","ORB3U1",15,0)
 I Y<1 K DIC,Y Q
"RTN","ORB3U1",16,0)
 S ORBDFN=+Y,ORBPT=$P(Y,U,2)
"RTN","ORB3U1",17,0)
 K DIC,Y,DUOUT,DTOUT
"RTN","ORB3U1",18,0)
 ;
"RTN","ORB3U1",19,0)
 S %DT="AET",%DT("A")="Start Date/Time (req'd): ",%DT("B")="T-30" D ^%DT
"RTN","ORB3U1",20,0)
 I Y<1 K %DT,Y Q
"RTN","ORB3U1",21,0)
 S ORBSDT=Y
"RTN","ORB3U1",22,0)
 ;
"RTN","ORB3U1",23,0)
 S %DT="AET",%DT("A")="End Date/Time (req'd): ",%DT("B")="NOW" D ^%DT
"RTN","ORB3U1",24,0)
 I Y<1 K %DT,Y Q
"RTN","ORB3U1",25,0)
 S ORBEDT=Y
"RTN","ORB3U1",26,0)
 ;
"RTN","ORB3U1",27,0)
 ;get alerts for this patient from the alert tracking file:
"RTN","ORB3U1",28,0)
 D PATIENT^XQALERT("^TMP(""ORB"",$J)",ORBDFN,ORBSDT,ORBEDT)
"RTN","ORB3U1",29,0)
 W !!,"Processing..."
"RTN","ORB3U1",30,0)
 ;
"RTN","ORB3U1",31,0)
 D EN^VALM("OR PATIENT ALERTS")
"RTN","ORB3U1",32,0)
 Q
"RTN","ORB3U1",33,0)
SELECT ;if one or more alerts selected, display/print recipient data:
"RTN","ORB3U1",34,0)
 N ORN,ORNUMS,ORI,ORJ,ORBAL,ORBAID,ORBSMSG,ORY,DESC,HDR
"RTN","ORB3U1",35,0)
 S ORNUMS=$P(XQORNOD(0),"=",2)
"RTN","ORB3U1",36,0)
 Q:'$L(ORNUMS)
"RTN","ORB3U1",37,0)
 D FULL^VALM1
"RTN","ORB3U1",38,0)
 ;
"RTN","ORB3U1",39,0)
 S ORJ=1
"RTN","ORB3U1",40,0)
 F ORI=1:1:$L(ORNUMS,",")-1 D
"RTN","ORB3U1",41,0)
 .S ORN=$P(ORNUMS,",",ORI)
"RTN","ORB3U1",42,0)
 .S ORBAL=$G(^TMP("OR",$J,"ALERTS","IDX",ORN)) I $L(ORBAL) D
"RTN","ORB3U1",43,0)
 ..S ORBAID=$P(ORBAL,U)
"RTN","ORB3U1",44,0)
 ..S ORBSMSG=$P(ORBAL,U,2)
"RTN","ORB3U1",45,0)
 ..S ORY(ORJ)="RECIPIENTS OF ALERT: "_ORBSMSG,ORJ=ORJ+1
"RTN","ORB3U1",46,0)
 ..D GETRECS(ORBAID)  ;get recipient data
"RTN","ORB3U1",47,0)
 ..S ORJ=ORJ+1,ORY(ORJ)="",ORJ=ORJ+1,ORY(ORJ)="",ORJ=ORJ+1
"RTN","ORB3U1",48,0)
 S DESC="Recipients of a Kernel Alert"
"RTN","ORB3U1",49,0)
 S HDR="RECIPIENTS OF ALERTS FOR PATIENT: "_ORBPT
"RTN","ORB3U1",50,0)
 D OUTPUT(.ORY,DESC,HDR)
"RTN","ORB3U1",51,0)
 S VALMBCK="R"
"RTN","ORB3U1",52,0)
 Q
"RTN","ORB3U1",53,0)
LMHDR ; header for ListMgr display
"RTN","ORB3U1",54,0)
 S VALMHDR(1)="Alerts for "_ORBPT
"RTN","ORB3U1",55,0)
 Q
"RTN","ORB3U1",56,0)
LMHELP ; help for List Mgr display
"RTN","ORB3U1",57,0)
 N X
"RTN","ORB3U1",58,0)
 D FULL^VALM1 S VALMBCK="R"
"RTN","ORB3U1",59,0)
 W !!,"Enter the display number of the alert whose recipients you wish to review in detail."
"RTN","ORB3U1",60,0)
 W !!,"Press <return> to continue ..."
"RTN","ORB3U1",61,0)
 R X:DTIME
"RTN","ORB3U1",62,0)
 Q
"RTN","ORB3U1",63,0)
LMEXIT ; exit code for List Mgr display
"RTN","ORB3U1",64,0)
 D CLEAR^VALM1
"RTN","ORB3U1",65,0)
 K ORBPT,^TMP("OR",$J,"ALERTS"),XQORM("ALT"),^TMP("ORB",$J)
"RTN","ORB3U1",66,0)
 Q
"RTN","ORB3U1",67,0)
LMALT ; alternative selection code
"RTN","ORB3U1",68,0)
 D FULL^VALM1
"RTN","ORB3U1",69,0)
 S VALMBCK="R"
"RTN","ORB3U1",70,0)
 Q
"RTN","ORB3U1",71,0)
LMENTRY ; entry code for List Mgr display
"RTN","ORB3U1",72,0)
 N ORBA,ORBAID,ORBDT,ORBMSG,ORBX,ORNUM,ORDATA,ORAD,LCNT,NUM
"RTN","ORB3U1",73,0)
 N ORX,ORY,ORBMSGP1,ORBMSGP2
"RTN","ORB3U1",74,0)
 ;
"RTN","ORB3U1",75,0)
 D CLEAN^VALM10
"RTN","ORB3U1",76,0)
 ;
"RTN","ORB3U1",77,0)
 S ORBA="" F  S ORBA=$O(^TMP("ORB",$J,ORBA)) Q:ORBA=""  D
"RTN","ORB3U1",78,0)
 .S ORBX=$G(^TMP("ORB",$J,ORBA)) I $L(ORBX) D
"RTN","ORB3U1",79,0)
 ..S ORBAID=$P(ORBX,U,2)
"RTN","ORB3U1",80,0)
 ..Q:$P(ORBAID,",")'="OR"  ;quit if not "OR" (OE/RR Notifications) alert
"RTN","ORB3U1",81,0)
 ..W "."
"RTN","ORB3U1",82,0)
 ..;
"RTN","ORB3U1",83,0)
 ..;get alert details:
"RTN","ORB3U1",84,0)
 ..D ALERTDAT^XQALBUTL(ORBAID,"ORAD")
"RTN","ORB3U1",85,0)
 ..S ORBMSG=ORAD(1.01) I $L(ORBMSG) D
"RTN","ORB3U1",86,0)
 ...S ORBDT=$P(ORAD(.02),U)
"RTN","ORB3U1",87,0)
 ...S ORDATA=$G(ORAD(2))
"RTN","ORB3U1",88,0)
 ...S ORNUM=""
"RTN","ORB3U1",89,0)
 ...I ORDATA["@" S ORNUM=$P(ORDATA,"@")
"RTN","ORB3U1",90,0)
 ...S ORNUM=$S(+$G(ORNUM)>0:"["_+ORNUM_"]",1:"")
"RTN","ORB3U1",91,0)
 ...S ORBMSG=$S($F(ORBMSG,": "):$E(ORBMSG,$F(ORBMSG,": "),$L(ORBMSG)),1:"") ;p379
"RTN","ORB3U1",92,0)
 ...S ORBMSGP1=$P(ORBMSG,":",1) ;jeh
"RTN","ORB3U1",93,0)
 ...S ORBMSGP2=$P(ORBMSG,":",2,3)   ;jeh 
"RTN","ORB3U1",94,0)
 ...I $G(ORBMSGP1)="Order(s) needing clarification" D    ;jeh Shorten output to make room for OR IEN 
"RTN","ORB3U1",95,0)
 ....S ORBMSGP1="Order needs clarifying"  ;jeh
"RTN","ORB3U1",96,0)
 ....S ORBMSG=ORBMSGP1_":"_ORBMSGP2   ;jeh
"RTN","ORB3U1",97,0)
 ...S ORBMSG=$E(ORBMSG_$S($L(ORNUM):" "_$G(ORNUM),1:"")_U_"                                                            ",1,60)
"RTN","ORB3U1",98,0)
 ...S ^TMP("OR",$J,"ALERTS","B",9999999-ORBDT_ORBAID)=ORBAID_U_$P(ORBMSG,U)_U_$$FMTE^XLFDT($E(ORBDT,1,12),"2")
"RTN","ORB3U1",99,0)
 ;
"RTN","ORB3U1",100,0)
 S (LCNT,NUM)=0
"RTN","ORB3U1",101,0)
 S ORX="" F  S ORX=$O(^TMP("OR",$J,"ALERTS","B",ORX)) Q:ORX=""  D
"RTN","ORB3U1",102,0)
 .S ORY=^TMP("OR",$J,"ALERTS","B",ORX)
"RTN","ORB3U1",103,0)
 .S ORBMSG=$P(ORY,U,2)
"RTN","ORB3U1",104,0)
 .S ORBDT=$P(ORY,U,3)
"RTN","ORB3U1",105,0)
 .S LCNT=LCNT+1,NUM=NUM+1
"RTN","ORB3U1",106,0)
 .S ^TMP("OR",$J,"ALERTS","IDX",NUM)=ORY   ;alert id^text^date/time
"RTN","ORB3U1",107,0)
 .S ^TMP("OR",$J,"ALERTS",LCNT,0)=$$LJ^XLFSTR(NUM,4)_$$LJ^XLFSTR(ORBMSG,61)_$$LJ^XLFSTR(ORBDT,15)
"RTN","ORB3U1",108,0)
 .D CNTRL^VALM10(LCNT,1,5,IOINHI,IOINORM)
"RTN","ORB3U1",109,0)
 ;
"RTN","ORB3U1",110,0)
 S ^TMP("OR",$J,"ALERTS",0)=LCNT_U_NUM_U_"Patient Alerts"
"RTN","ORB3U1",111,0)
 S ^TMP("OR",$J,"ALERTS","#")=$O(^ORD(101,"B","OR SELECT ALERTS",0))_"^1:"_NUM
"RTN","ORB3U1",112,0)
 K VALMHDR
"RTN","ORB3U1",113,0)
 S VALMCNT=LCNT,VALMBG=1,VALMBCK="R"
"RTN","ORB3U1",114,0)
 Q
"RTN","ORB3U1",115,0)
GETRECS(ORBAID)  ;get recipient data for an alert
"RTN","ORB3U1",116,0)
 N ORX,ORBI,ORBR,ORBHX
"RTN","ORB3U1",117,0)
 D AHISTORY^XQALBUTL(ORBAID,"ORBHX")
"RTN","ORB3U1",118,0)
 S:$L($G(ORBHX(20,0))) ORX=$P(ORBHX(20,0),U,4)
"RTN","ORB3U1",119,0)
 F ORBI=1:1:ORX D
"RTN","ORB3U1",120,0)
 .S ORBR=ORBHX(20,ORBI,0)
"RTN","ORB3U1",121,0)
 .S ORY(ORJ)="",ORJ=ORJ+1
"RTN","ORB3U1",122,0)
 .S ORY(ORJ)=$P(^VA(200,$P(ORBR,U),0),U),ORJ=ORJ+1
"RTN","ORB3U1",123,0)
 .S ORY(ORJ)="  1st displayed to recipient: "_$$FMTE^XLFDT($P(ORBR,U,2),"1"),ORJ=ORJ+1
"RTN","ORB3U1",124,0)
 .S ORY(ORJ)="  1st selected by recipient:  "_$$FMTE^XLFDT($P(ORBR,U,3),"1"),ORJ=ORJ+1
"RTN","ORB3U1",125,0)
 .S ORY(ORJ)="  Processed by recipient:     "_$$FMTE^XLFDT($P(ORBR,U,4),"1"),ORJ=ORJ+1
"RTN","ORB3U1",126,0)
 .S ORY(ORJ)="  Deleted:                    "_$$FMTE^XLFDT($P(ORBR,U,5),"1"),ORJ=ORJ+1
"RTN","ORB3U1",127,0)
 .S ORY(ORJ)="  Auto deleted:               "_$$FMTE^XLFDT($P(ORBR,U,6),"1"),ORJ=ORJ+1
"RTN","ORB3U1",128,0)
 .S ORY(ORJ)="  Forwarded by:               "_$S($P(ORBR,U,7):$P(^VA(200,$P(ORBR,U,7),0),U),1:""),ORJ=ORJ+1
"RTN","ORB3U1",129,0)
 .S ORY(ORJ)="  Forwarded to recipient:     "_$$FMTE^XLFDT($P(ORBR,U,8),"1"),ORJ=ORJ+1
"RTN","ORB3U1",130,0)
 .S ORY(ORJ)="  Non-process deletion by:    "_$S($P(ORBR,U,9):$P(^VA(200,$P(ORBR,U,9),0),U),1:""),ORJ=ORJ+1
"RTN","ORB3U1",131,0)
 Q
"RTN","ORB3U1",132,0)
RECIPS ;determine/report the list of recipients for a notification
"RTN","ORB3U1",133,0)
 N ORY,ORN,ORBDFN,ORNUM,ORBADUZ,DESC,HDR,ORBPR,ORDIV
"RTN","ORB3U1",134,0)
 ;prompt for patient (required):
"RTN","ORB3U1",135,0)
 K DIC S DIC="^DPT(",DIC("A")="PATIENT (req'd): ",DIC(0)="AEQNM" D ^DIC Q:Y<1
"RTN","ORB3U1",136,0)
 S ORBDFN=+Y
"RTN","ORB3U1",137,0)
 Q:$D(DUOUT)
"RTN","ORB3U1",138,0)
 K DIC,Y,DUOUT,DTOUT
"RTN","ORB3U1",139,0)
 ;
"RTN","ORB3U1",140,0)
 ;prompt for notification (required):
"RTN","ORB3U1",141,0)
 S DIC="^ORD(100.9,",DIC("A")="NOTIFICATION (req'd): ",DIC(0)="AEQN" D ^DIC Q:Y<1
"RTN","ORB3U1",142,0)
 S ORN=+Y
"RTN","ORB3U1",143,0)
 Q:$D(DUOUT)
"RTN","ORB3U1",144,0)
 K DIC,Y,DUOUT,DTOUT
"RTN","ORB3U1",145,0)
 ;
"RTN","ORB3U1",146,0)
 S ORBPR=$$GET^XPAR("DIV^SYS^PKG","ORB PROVIDER RECIPIENTS",ORN,"I")
"RTN","ORB3U1",147,0)
 ;
"RTN","ORB3U1",148,0)
 ;prompt for order num if notif processes order num or is a flagged oi:
"RTN","ORB3U1",149,0)
 I (ORN=32)!(ORN=41)!(ORN=60)!(ORN=61)!(ORN=64)!(ORN=65)!(ORBPR["O")!(ORBPR["E") D
"RTN","ORB3U1",150,0)
 .K DIR S DIR(0)="NAO^::2",DIR("A")="ORDER NUMBER: "
"RTN","ORB3U1",151,0)
 .S DIR("?",1)="This notification uses order number to help determine alert recipients."
"RTN","ORB3U1",152,0)
 .S DIR("?",2)="Enter the order number associated with the alert for most accurate results."
"RTN","ORB3U1",153,0)
 .S DIR("?",3)="Order number must be entered as a whole number (e.g. 458829)."
"RTN","ORB3U1",154,0)
 .;
"RTN","ORB3U1",155,0)
 .S DIR("?")=" "
"RTN","ORB3U1",156,0)
 .D ^DIR
"RTN","ORB3U1",157,0)
 .S ORNUM=+Y
"RTN","ORB3U1",158,0)
 .I +$G(ORNUM)>0 D
"RTN","ORB3U1",159,0)
 ..S ORDIV=$$ORDIV^ORB31(ORNUM)
"RTN","ORB3U1",160,0)
 ..S:+$G(ORDIV)>0 ORBPR=$$GET^XPAR(ORDIV_";DIV(4,^SYS^PKG","ORB PROVIDER RECIPIENTS",ORN,"I")
"RTN","ORB3U1",161,0)
 Q:$D(DUOUT)
"RTN","ORB3U1",162,0)
 K DIR,Y,X,DTOUT,DUOUT,DIRUT
"RTN","ORB3U1",163,0)
 ;
"RTN","ORB3U1",164,0)
 ; get recipients for Lab Threshold notif:
"RTN","ORB3U1",165,0)
 I ORN=68 D LABTHR^ORB3U2(.ORBADUZ,ORBDFN,$G(ORNUM))
"RTN","ORB3U1",166,0)
 ;
"RTN","ORB3U1",167,0)
 ;prompt for pkg-defined recips if normally occurs with notif:
"RTN","ORB3U1",168,0)
 I (ORN=21)!(ORN=22)!(ORN=23)!(ORN=27)!(ORN=30)!(ORN=51)!(ORN=52)!(ORN=53)!(ORN=63) D
"RTN","ORB3U1",169,0)
 .F  K DIC,Y S DIC="^VA(200,",DIC(0)="AEQN",DIC("A")="RECIPIENT(S) FROM PACKAGE WHEN NOTIF WAS TRIGGERED: " D ^DIC Q:Y<1  S ORBADUZ(+Y)=""
"RTN","ORB3U1",170,0)
 Q:$D(DUOUT)
"RTN","ORB3U1",171,0)
 K DIC,Y,DUOUT,DTOUT
"RTN","ORB3U1",172,0)
 ;
"RTN","ORB3U1",173,0)
 ;prompt for recips entered at special GUI recipients prompts:
"RTN","ORB3U1",174,0)
 I (ORN=6)!(ORN=33) D
"RTN","ORB3U1",175,0)
 .F  K DIC,Y S DIC="^VA(200,",DIC(0)="AEQN",DIC("A")="RECIPIENT(S) ENTERED AT GUI PROMPTS: " D ^DIC Q:Y<1  S ORBADUZ(+Y)=""
"RTN","ORB3U1",176,0)
 Q:$D(DUOUT)
"RTN","ORB3U1",177,0)
 K DIC,Y,DUOUT,DTOUT
"RTN","ORB3U1",178,0)
 ;
"RTN","ORB3U1",179,0)
 W !,"Processing, please stand by..."
"RTN","ORB3U1",180,0)
 ;determine recipients and why:
"RTN","ORB3U1",181,0)
 S ORY="1"
"RTN","ORB3U1",182,0)
 D UTL^ORB3(.ORY,ORN,ORBDFN,$G(ORNUM),.ORBADUZ,"","")
"RTN","ORB3U1",183,0)
 S DESC="Determine Notification Recipients Report"
"RTN","ORB3U1",184,0)
 S HDR="DETERMINE NOTIFICATION RECIPIENTS REPORT"
"RTN","ORB3U1",185,0)
 D OUTPUT(.ORY,DESC,HDR)
"RTN","ORB3U1",186,0)
 Q
"RTN","ORB3U1",187,0)
OUTPUT(ORY,ORBDESC,ORBHDR) ;prompt for device and send report
"RTN","ORB3U1",188,0)
 N POP
"RTN","ORB3U1",189,0)
 ;prompt for device:
"RTN","ORB3U1",190,0)
 S %ZIS="Q"  ;prompt for Queueing
"RTN","ORB3U1",191,0)
 D ^%ZIS
"RTN","ORB3U1",192,0)
 Q:$G(POP)>0
"RTN","ORB3U1",193,0)
 I $D(IO("Q")) D  ;queue the report
"RTN","ORB3U1",194,0)
 .S ZTRTN="PRINT^ORB3U1"
"RTN","ORB3U1",195,0)
 .S ZTSAVE("ORY(")="",ZTSAVE("ORBHDR")=""
"RTN","ORB3U1",196,0)
 .S ZTDESC=ORBDESC
"RTN","ORB3U1",197,0)
 .D ^%ZTLOAD
"RTN","ORB3U1",198,0)
 .K ZTDESC,ZTRTN,ZTSAVE
"RTN","ORB3U1",199,0)
 .I $D(ZTSK)[0 W !!?5,"Report canceled!"
"RTN","ORB3U1",200,0)
 .E  W !!?5,"Report queued."
"RTN","ORB3U1",201,0)
 .D HOME^%ZIS
"RTN","ORB3U1",202,0)
 K %ZIS
"RTN","ORB3U1",203,0)
 I $D(IO("Q")) K IO("Q") Q
"RTN","ORB3U1",204,0)
PRINT ;print body of Determine Notification Recipients Report
"RTN","ORB3U1",205,0)
 N END,PAGE,X
"RTN","ORB3U1",206,0)
 S (END,PAGE,I)=0
"RTN","ORB3U1",207,0)
 U IO
"RTN","ORB3U1",208,0)
 D @("HDR"_(2-($E(IOST,1,2)="C-")))
"RTN","ORB3U1",209,0)
 F  S I=$O(ORY(I)) Q:I=""!(END=1)  D
"RTN","ORB3U1",210,0)
 .D HDR:$Y+5>IOSL
"RTN","ORB3U1",211,0)
 .Q:END=1
"RTN","ORB3U1",212,0)
 .W !,ORY(I)
"RTN","ORB3U1",213,0)
 I END=1 W !!,"           - Report Interrupted -",!
"RTN","ORB3U1",214,0)
 E  W !!!,"           - End of Report -",!
"RTN","ORB3U1",215,0)
 I ($E(IOST,1,2)="C-") W !,"Press RETURN to continue: " R X:DTIME
"RTN","ORB3U1",216,0)
 D ^%ZISC
"RTN","ORB3U1",217,0)
 D:$G(ZTSK) KILL^%ZTLOAD
"RTN","ORB3U1",218,0)
 Q
"RTN","ORB3U1",219,0)
HDR ;print header of report
"RTN","ORB3U1",220,0)
 I PAGE,($E(IOST,1,2)="C-") D
"RTN","ORB3U1",221,0)
 .W !,"Press RETURN to continue or '^' to exit: "
"RTN","ORB3U1",222,0)
 .R X:DTIME S END='$T!(X="^")
"RTN","ORB3U1",223,0)
 Q:END=1
"RTN","ORB3U1",224,0)
HDR1 W:'($E(IOST,1,2)='"C-"&'PAGE) @IOF
"RTN","ORB3U1",225,0)
HDR2 S PAGE=PAGE+1 W ?20,ORBHDR
"RTN","ORB3U1",226,0)
 W ?(IOM-10),"Page: ",$J(PAGE,3),!!
"RTN","ORB3U1",227,0)
 Q
"VER")
8.0^22.0
"BLD",9484,6)
^338
**END**
**END**

