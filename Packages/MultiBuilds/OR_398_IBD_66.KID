KIDS Distribution saved on Oct 17, 2014@15:16:23
OR*3.0*398 & IBD*3.0*66 Bundle
**KIDS**:OR*3.0*398^IBD*3.0*66^

**INSTALL NAME**
OR*3.0*398
"BLD",9270,0)
OR*3.0*398^ORDER ENTRY/RESULTS REPORTING^0^3141017^y
"BLD",9270,1,0)
^^2^2^3140919^
"BLD",9270,1,1,0)
The description of this patch may be found in the National Patch Module
"BLD",9270,1,2,0)
under OR*3.0*398.
"BLD",9270,4,0)
^9.64PA^^
"BLD",9270,6)
1^
"BLD",9270,6.3)
16
"BLD",9270,"ABPKG")
n
"BLD",9270,"KRN",0)
^9.67PA^779.2^20
"BLD",9270,"KRN",.4,0)
.4
"BLD",9270,"KRN",.401,0)
.401
"BLD",9270,"KRN",.402,0)
.402
"BLD",9270,"KRN",.403,0)
.403
"BLD",9270,"KRN",.5,0)
.5
"BLD",9270,"KRN",.84,0)
.84
"BLD",9270,"KRN",3.6,0)
3.6
"BLD",9270,"KRN",3.8,0)
3.8
"BLD",9270,"KRN",9.2,0)
9.2
"BLD",9270,"KRN",9.8,0)
9.8
"BLD",9270,"KRN",9.8,"NM",0)
^9.68A^5^1
"BLD",9270,"KRN",9.8,"NM",5,0)
ORWPCE^^0^B63752206
"BLD",9270,"KRN",9.8,"NM","B","ORWPCE",5)

"BLD",9270,"KRN",19,0)
19
"BLD",9270,"KRN",19,"NM",0)
^9.68A^^0
"BLD",9270,"KRN",19.1,0)
19.1
"BLD",9270,"KRN",101,0)
101
"BLD",9270,"KRN",409.61,0)
409.61
"BLD",9270,"KRN",771,0)
771
"BLD",9270,"KRN",779.2,0)
779.2
"BLD",9270,"KRN",870,0)
870
"BLD",9270,"KRN",8989.51,0)
8989.51
"BLD",9270,"KRN",8989.52,0)
8989.52
"BLD",9270,"KRN",8994,0)
8994
"BLD",9270,"KRN",8994,"NM",0)
^9.68A^^0
"BLD",9270,"KRN","B",.4,.4)

"BLD",9270,"KRN","B",.401,.401)

"BLD",9270,"KRN","B",.402,.402)

"BLD",9270,"KRN","B",.403,.403)

"BLD",9270,"KRN","B",.5,.5)

"BLD",9270,"KRN","B",.84,.84)

"BLD",9270,"KRN","B",3.6,3.6)

"BLD",9270,"KRN","B",3.8,3.8)

"BLD",9270,"KRN","B",9.2,9.2)

"BLD",9270,"KRN","B",9.8,9.8)

"BLD",9270,"KRN","B",19,19)

"BLD",9270,"KRN","B",19.1,19.1)

"BLD",9270,"KRN","B",101,101)

"BLD",9270,"KRN","B",409.61,409.61)

"BLD",9270,"KRN","B",771,771)

"BLD",9270,"KRN","B",779.2,779.2)

"BLD",9270,"KRN","B",870,870)

"BLD",9270,"KRN","B",8989.51,8989.51)

"BLD",9270,"KRN","B",8989.52,8989.52)

"BLD",9270,"KRN","B",8994,8994)

"BLD",9270,"QDEF")
^^^^^^^^^^
"BLD",9270,"QUES",0)
^9.62^^
"BLD",9270,"REQB",0)
^9.611^1^1
"BLD",9270,"REQB",1,0)
OR*3.0*385^2
"BLD",9270,"REQB","B","OR*3.0*385",1)

"MBREQ")
0
"PKG",35,-1)
1^1
"PKG",35,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",35,20,0)
^9.402P^^
"PKG",35,22,0)
^9.49I^1^1
"PKG",35,22,1,0)
3.0
"PKG",35,22,1,"PAH",1,0)
398^3141017^100916
"PKG",35,22,1,"PAH",1,1,0)
^^2^2^3141017
"PKG",35,22,1,"PAH",1,1,1,0)
The description of this patch may be found in the National Patch Module
"PKG",35,22,1,"PAH",1,1,2,0)
under OR*3.0*398.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","ORWPCE")
0^5^B63752206
"RTN","ORWPCE",1,0)
ORWPCE ; SLC/JM/REV - wrap calls to PCE and AICS ;09/18/14  12:36
"RTN","ORWPCE",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,116,173,190,195,215,243,295,280,306,361,385,398**;Dec 17, 1997;Build 16
"RTN","ORWPCE",3,0)
 ;
"RTN","ORWPCE",4,0)
 ; DBIA 2950   LOOK^LEXA          ^TMP("LEXFND",$J)
"RTN","ORWPCE",5,0)
 ; DBIA 1609   CONFIG^LEXSET      ^TMP("LEXSCH",$J)
"RTN","ORWPCE",6,0)
 ; DBIA 1365   DSELECT^GMPLENFM   ^TMP("IB",$J)
"RTN","ORWPCE",7,0)
 ; DBIA 1296   GETLST^IBDF18A
"RTN","ORWPCE",8,0)
 ; DBIA 5699   $$ICDDESC^ICDXCODE
"RTN","ORWPCE",9,0)
 ;
"RTN","ORWPCE",10,0)
 Q
"RTN","ORWPCE",11,0)
VISIT(LST,CLINIC,ORDATE) ; get list of visit types for clinic
"RTN","ORWPCE",12,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORWPCE",13,0)
 D GETLST^IBDF18A(CLINIC,"DG SELECT VISIT TYPE CPT PROCEDURES","LST",,,,ORDATE)
"RTN","ORWPCE",14,0)
 Q
"RTN","ORWPCE",15,0)
PROC(LST,CLINIC,ORDATE) ; get list of procedures for clinic P12 for CPTMods
"RTN","ORWPCE",16,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORWPCE",17,0)
 D GETLST^IBDF18A(CLINIC,"DG SELECT CPT PROCEDURE CODES","LST",,,1,ORDATE)
"RTN","ORWPCE",18,0)
 N IDX,MOD,CODES,FIRST S IDX=0
"RTN","ORWPCE",19,0)
 F  S IDX=$O(LST(IDX)) Q:'+IDX  D
"RTN","ORWPCE",20,0)
 . I LST(IDX)="" K LST(IDX) Q
"RTN","ORWPCE",21,0)
 . S MOD=0,CODES="",FIRST=1
"RTN","ORWPCE",22,0)
 . F  S MOD=$O(LST(IDX,"MODIFIER",MOD)) Q:(MOD="")  D
"RTN","ORWPCE",23,0)
 . . I FIRST S FIRST=0
"RTN","ORWPCE",24,0)
 . . E  S CODES=CODES_";"
"RTN","ORWPCE",25,0)
 . . S CODES=CODES_LST(IDX,"MODIFIER",MOD)
"RTN","ORWPCE",26,0)
 . K LST(IDX,"MODIFIER")
"RTN","ORWPCE",27,0)
 . I 'FIRST S $P(LST(IDX),U,12)=CODES
"RTN","ORWPCE",28,0)
 Q
"RTN","ORWPCE",29,0)
CPTMODS(LST,ORCPTCOD,ORDATE) ;Return CPT Modifiers for a CPT Code
"RTN","ORWPCE",30,0)
 N ORM,ORIDX,ORI,MODNAME
"RTN","ORWPCE",31,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORWPCE",32,0)
 I +($$CODM^ICPTCOD(ORCPTCOD,$NA(ORM),0,ORDATE)),+$D(ORM) D
"RTN","ORWPCE",33,0)
 . S ORIDX="",ORI=0
"RTN","ORWPCE",34,0)
 . F  S ORIDX=$O(ORM(ORIDX)) Q:(ORIDX="")  D
"RTN","ORWPCE",35,0)
 . . S ORI=ORI+1,MODNAME=$P(ORM(ORIDX),U,1)
"RTN","ORWPCE",36,0)
 . . S LST(MODNAME_ORI)=$P(ORM(ORIDX),U,2)_U_MODNAME_U_ORIDX
"RTN","ORWPCE",37,0)
 Q
"RTN","ORWPCE",38,0)
GETMOD(MODINFO,ORMODIEN,ORDATE) ;Returns info for a specific CPT Modifier
"RTN","ORWPCE",39,0)
 N ORDATA
"RTN","ORWPCE",40,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORWPCE",41,0)
 S ORDATA=$$MOD^ICPTMOD(ORMODIEN,"I",ORDATE,1)
"RTN","ORWPCE",42,0)
 I +ORDATA>0 S MODINFO=ORMODIEN_U_$P(ORDATA,U,3)_U_$P(ORDATA,U,2)
"RTN","ORWPCE",43,0)
 Q
"RTN","ORWPCE",44,0)
DIAG(LST,CLINIC,ORDATE) ; get list of diagnoses for clinic
"RTN","ORWPCE",45,0)
 N ORI S ORI=0
"RTN","ORWPCE",46,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORWPCE",47,0)
 D GETLST^IBDF18A(CLINIC,"DG SELECT ICD DIAGNOSIS CODES","LST",,,,ORDATE)
"RTN","ORWPCE",48,0)
 F  S ORI=$O(LST(ORI)) Q:+ORI'>0  D
"RTN","ORWPCE",49,0)
 . I $P(LST(ORI),U)]"" S $P(LST(ORI),U,10)=$$VLTD^ICDEX($$CODEBA^ICDEX($P(LST(ORI),U),80),DT)
"RTN","ORWPCE",50,0)
 Q
"RTN","ORWPCE",51,0)
IMM(LST,CLINIC) ;get list of immunizations for clinic
"RTN","ORWPCE",52,0)
 D GETLST^IBDF18A(CLINIC,"PX SELECT IMMUNIZATIONS","LST")
"RTN","ORWPCE",53,0)
 Q
"RTN","ORWPCE",54,0)
SK(LST,CLINIC) ;get list of skin test for clinic
"RTN","ORWPCE",55,0)
 D GETLST^IBDF18A(CLINIC,"PX SELECT SKIN TESTS","LST")
"RTN","ORWPCE",56,0)
 Q
"RTN","ORWPCE",57,0)
HF(LST,CLINIC) ;get list of health factors for clinic
"RTN","ORWPCE",58,0)
 D GETLST^IBDF18A(CLINIC,"PX SELECT HEALTH FACTORS","LST")
"RTN","ORWPCE",59,0)
 Q
"RTN","ORWPCE",60,0)
PED(LST,CLINIC) ;get list of education topices for clinic
"RTN","ORWPCE",61,0)
 D GETLST^IBDF18A(CLINIC,"PX SELECT EDUCATION TOPICS","LST")
"RTN","ORWPCE",62,0)
 Q
"RTN","ORWPCE",63,0)
TRT(LST,CLINIC) ;get list of treatments for clinic
"RTN","ORWPCE",64,0)
 D GETLST^IBDF18A(CLINIC,"PX SELECT TREATMENTS","LST")
"RTN","ORWPCE",65,0)
 Q
"RTN","ORWPCE",66,0)
XAM(LST,CLINIC) ;get list of exams for clinic
"RTN","ORWPCE",67,0)
 D GETLST^IBDF18A(CLINIC,"PX SELECT EXAMS","LST")
"RTN","ORWPCE",68,0)
 Q
"RTN","ORWPCE",69,0)
ACTPROB(GLST,DFN,ORDATE) ;get list of patient's active problems
"RTN","ORWPCE",70,0)
 N ORPROB,ORPROBIX,ORPRCNT,ORTXT,ORTXT1,ORCODSYS,ORCOD,ORDT,ORTRY,QTLTXT,SCD,ORDATA,GMPINDT,DIAGINC,ORIMPDT
"RTN","ORWPCE",71,0)
 K ^TMP("IB",$J,"INTERFACES","GMP SELECT PATIENT ACTIVE PROBLEMS")
"RTN","ORWPCE",72,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORWPCE",73,0)
 S GMPINDT=ORDATE,ORIMPDT=$$IMPDATE^LEXU("10D")
"RTN","ORWPCE",74,0)
 D DSELECT^GMPLENFM  ;DBIA 1365
"RTN","ORWPCE",75,0)
 S ORPRCNT=0
"RTN","ORWPCE",76,0)
 S ORPROBIX=0
"RTN","ORWPCE",77,0)
 F  S ORPROBIX=$O(^TMP("IB",$J,"INTERFACES","GMP SELECT PATIENT ACTIVE PROBLEMS",ORPROBIX)) Q:'ORPROBIX  D  ;DBIA 1365
"RTN","ORWPCE",78,0)
 . I (ORDATE<ORIMPDT)&($P(^TMP("IB",$J,"INTERFACES","GMP SELECT PATIENT ACTIVE PROBLEMS",ORPROBIX),"^",14)="10D") K ^TMP("IB",$J,"INTERFACES","GMP SELECT PATIENT ACTIVE PROBLEMS",ORPROBIX) Q
"RTN","ORWPCE",79,0)
 . S ORPROB=$P(^TMP("IB",$J,"INTERFACES","GMP SELECT PATIENT ACTIVE PROBLEMS",ORPROBIX),"^",2,3)
"RTN","ORWPCE",80,0)
 . I $L(ORPROB)>255 S $P(ORPROB,U)=$E($P(ORPROB,U),1,245)
"RTN","ORWPCE",81,0)
 . I $E(ORPROB,1)="$" S ORPROB=$E(ORPROB,2,255)
"RTN","ORWPCE",82,0)
 . I '$D(ORPROB(ORPROB)) D
"RTN","ORWPCE",83,0)
 .. S ORPROB(ORPROB)=""
"RTN","ORWPCE",84,0)
 .. S ORPRCNT=ORPRCNT+1
"RTN","ORWPCE",85,0)
 .. S $P(^TMP("IB",$J,"INTERFACES","GMP SELECT PATIENT ACTIVE PROBLEMS",ORPROBIX),"^",2,3)=ORPROB
"RTN","ORWPCE",86,0)
 . E  K ^TMP("IB",$J,"INTERFACES","GMP SELECT PATIENT ACTIVE PROBLEMS",ORPROBIX)
"RTN","ORWPCE",87,0)
 S ^TMP("IB",$J,"INTERFACES","GMP SELECT PATIENT ACTIVE PROBLEMS",0)=ORPRCNT
"RTN","ORWPCE",88,0)
 S GLST=$NA(^TMP("IB",$J,"INTERFACES","GMP SELECT PATIENT ACTIVE PROBLEMS"))
"RTN","ORWPCE",89,0)
 Q
"RTN","ORWPCE",90,0)
SCSEL(VAL,DFN,ATM,LOC,VST) ; return SC conditions that may be selected
"RTN","ORWPCE",91,0)
 ; VAL=SCallow^SCdflt;AOallow^AOdflt;IRallow^IRdflt;ECallow^ECdflt;
"RTN","ORWPCE",92,0)
 ;     MSTallow^MSTdflt;HNCallow^HNCdflt;CVAllow^CVDflt;SHADAllow^SHADDflt
"RTN","ORWPCE",93,0)
 N ORX,S S S=";"
"RTN","ORWPCE",94,0)
 D SCCOND^PXUTLSCC(DFN,ATM,LOC,$G(VST),.ORX)
"RTN","ORWPCE",95,0)
 S VAL=$G(ORX("SC"))_S_$G(ORX("AO"))_S_$G(ORX("IR"))_S_$G(ORX("EC"))_S_$G(ORX("MST"))_S_$G(ORX("HNC"))_S_$G(ORX("CV"))_S_$G(ORX("SHAD"))
"RTN","ORWPCE",96,0)
 Q
"RTN","ORWPCE",97,0)
SCDIS(LST,DFN) ; Return service connected % and rated disabilities
"RTN","ORWPCE",98,0)
 N VAEL,VAERR,I,ILST,DIS,SC,X
"RTN","ORWPCE",99,0)
 D ELIG^VADPT
"RTN","ORWPCE",100,0)
 S LST(1)="Service Connected: "_$S(+VAEL(3):$P(VAEL(3),U,2)_"%",1:"NO")
"RTN","ORWPCE",101,0)
 I 'VAEL(4),'$P($G(^DG(391,+VAEL(6),0)),U,2) S LST(2)="NOT A VETERAN." Q
"RTN","ORWPCE",102,0)
 S I=0,ILST=1 F  S I=$O(^DPT(DFN,.372,I)) Q:'I  S X=^(I,0) D
"RTN","ORWPCE",103,0)
 . S DIS=$P($G(^DIC(31,+X,0)),U) Q:DIS=""
"RTN","ORWPCE",104,0)
 . S SC=$S($P(X,U,3):"SC",$P(X,U,3)']"":"not specified",1:"NSC")
"RTN","ORWPCE",105,0)
 . S ILST=ILST+1,LST(ILST)=DIS_" ("_$P(X,U,2)_"% "_SC_")"
"RTN","ORWPCE",106,0)
 I ILST=1 S LST(2)="Rated Disabilities: NONE STATED"
"RTN","ORWPCE",107,0)
 Q
"RTN","ORWPCE",108,0)
CPTREQD(VAL,IEN) ; return 1 in VAL if note still needs a CPT code
"RTN","ORWPCE",109,0)
 S VAL=+$P(^TIU(8925,IEN,0),U,11)
"RTN","ORWPCE",110,0)
 Q
"RTN","ORWPCE",111,0)
NOTEVSTR(VAL,IEN) ; return the VSTR^AUTHOR for a note
"RTN","ORWPCE",112,0)
 N X0,X12,VISIT
"RTN","ORWPCE",113,0)
 S X0=$G(^TIU(8925,+IEN,0)),X12=$G(^(12)),VISIT=$P(X12,U,7)
"RTN","ORWPCE",114,0)
 I +VISIT S VAL=$$VSTRBLD^TIUSRVP(VISIT) I 1
"RTN","ORWPCE",115,0)
 E  S VAL=$P(X12,U,11)_";"_$P(X0,U,7)_";"_$P(X0,U,13)
"RTN","ORWPCE",116,0)
 Q
"RTN","ORWPCE",117,0)
HASVISIT(ORY,IEN,DFN,ORLOC,ORDTE) ;Has visit or is stand alone
"RTN","ORWPCE",118,0)
 N ORVISIT
"RTN","ORWPCE",119,0)
 S ORY=-1
"RTN","ORWPCE",120,0)
 I +$G(IEN)>0 S ORVISIT=+$P($G(^TIU(8925,+IEN,0)),U,3)
"RTN","ORWPCE",121,0)
 I +$G(ORVISIT)'>0 S ORVISIT=$$GETENC^PXAPI(DFN,ORDTE,ORLOC)
"RTN","ORWPCE",122,0)
 I +$G(ORVISIT)>0 S ORY=$$VST2APPT^PXAPI(ORVISIT)
"RTN","ORWPCE",123,0)
 Q
"RTN","ORWPCE",124,0)
DELETE(VAL,VSTR,DFN) ; delete PCE info when deleting a note
"RTN","ORWPCE",125,0)
 N VISIT,ORCOUNT,ORDTE,ORLOC
"RTN","ORWPCE",126,0)
 N ZTIO,ZTRTN,ZTDTH,ZTSAVE,ZTDESC,ZTSYNC,ZTSK
"RTN","ORWPCE",127,0)
 S ORLOC=$P(VSTR,";"),ORDTE=$P(VSTR,";",2)
"RTN","ORWPCE",128,0)
 I '$D(^TMP("ORWPCE",$J,VSTR))&('$$GETENC^PXAPI(DFN,ORDTE,ORLOC)) S VAL=0 Q  ; no PCE data saved yet
"RTN","ORWPCE",129,0)
 I $P(VSTR,";",3)="H" S VAL=0 Q           ; leave inpatient alone
"RTN","ORWPCE",130,0)
 I $L($T(DOCCNT^TIUSRVLV))=0 S VAL=0 Q    ; leave if no tiu entry point
"RTN","ORWPCE",131,0)
 D DOCCNT^TIUSRVLV(.ORCOUNT,DFN,VSTR)     ; Do not delete if another
"RTN","ORWPCE",132,0)
 I ORCOUNT>0 S VAL=0 Q                    ; title points to visit
"RTN","ORWPCE",133,0)
 S ZTIO="ORW/PXAPI RESOURCE",ZTRTN="DQDEL^ORWPCE1",ZTDTH=$H
"RTN","ORWPCE",134,0)
 S (ZTSAVE("VSTR"),ZTSAVE("DFN"))="",ZTDESC="CPRS Delete Note/PCE"
"RTN","ORWPCE",135,0)
 S ZTSYNC="ORW"_VSTR
"RTN","ORWPCE",136,0)
 D ^%ZTLOAD I '$D(ZTSK) D DQDEL^ORWPCE1
"RTN","ORWPCE",137,0)
 Q
"RTN","ORWPCE",138,0)
SAVE(OK,PCELIST,NOTEIEN,ORLOC) ; save PCE information
"RTN","ORWPCE",139,0)
 N VSTR,GMPLUSER
"RTN","ORWPCE",140,0)
 N ZTIO,ZTRTN,ZTDTH,ZTSAVE,ZTDESC,ZTSYNC,ZTSK
"RTN","ORWPCE",141,0)
 S VSTR=$P(PCELIST(1),U,4) K ^TMP("ORWPCE",$J,VSTR)
"RTN","ORWPCE",142,0)
 M ^TMP("ORWPCE",$J,VSTR)=PCELIST
"RTN","ORWPCE",143,0)
 S GMPLUSER=$$CLINUSER^ORQQPL1(DUZ),NOTEIEN=+$G(NOTEIEN)
"RTN","ORWPCE",144,0)
 S ZTIO="ORW/PXAPI RESOURCE",ZTRTN="DQSAVE^ORWPCE1",ZTDTH=$H
"RTN","ORWPCE",145,0)
 S ZTSAVE("PCELIST(")="",ZTDESC="Data from CPRS to PCE"
"RTN","ORWPCE",146,0)
 S ZTSAVE("GMPLUSER")="",ZTSAVE("NOTEIEN")="",ZTSAVE("DUZ")=""
"RTN","ORWPCE",147,0)
 I VSTR'["E" S ZTSYNC="ORW"_VSTR
"RTN","ORWPCE",148,0)
 S ZTSAVE("ORLOC")=""
"RTN","ORWPCE",149,0)
 D ^%ZTLOAD I '$D(ZTSK) D DQSAVE^ORWPCE1
"RTN","ORWPCE",150,0)
 Q
"RTN","ORWPCE",151,0)
LEX(LST,X,APP,ORDATE) ; return list after lexicon lookup
"RTN","ORWPCE",152,0)
 N LEX,ILST,I,IEN,ORIMPDT
"RTN","ORWPCE",153,0)
 S ORIMPDT=$$IMPDATE^LEXU("10D")
"RTN","ORWPCE",154,0)
 S:APP="CPT" APP="CHP" ; LEX PATCH 10
"RTN","ORWPCE",155,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORWPCE",156,0)
 I APP="ICD",(ORDATE'<ORIMPDT) S APP="10D"
"RTN","ORWPCE",157,0)
 D CONFIG^LEXSET(APP,APP,ORDATE)  ;DBIA 1609
"RTN","ORWPCE",158,0)
 I APP="CHP" D
"RTN","ORWPCE",159,0)
 . ; Set the filter for CPT only using CS APIs - format is the same as for DIC("S")
"RTN","ORWPCE",160,0)
 . S ^TMP("LEXSCH",$J,"FIL",0)="I $L($$CPTONE^LEXU(+Y,$G(ORDATE)))!($L($$CPCONE^LEXU(+Y,$G(ORDATE))))"  ;DBIA 1609
"RTN","ORWPCE",161,0)
 . ; Set Applications Default Flag (Lexicon can not overwrite filter)
"RTN","ORWPCE",162,0)
 . S ^TMP("LEXSCH",$J,"ADF",0)=1
"RTN","ORWPCE",163,0)
 D LOOK^LEXA(X,APP,1,"",ORDATE)
"RTN","ORWPCE",164,0)
 I '$D(LEX("LIST",1)) D  G LEXX
"RTN","ORWPCE",165,0)
 . S LST(1)="-1^No matches found.^"_APP
"RTN","ORWPCE",166,0)
 S LST(1)=LEX("LIST",1),ILST=1
"RTN","ORWPCE",167,0)
 S (I,IEN)=""
"RTN","ORWPCE",168,0)
 F  S I=$O(^TMP("LEXFND",$J,I)) Q:I=""  D  ;DBIA 2950
"RTN","ORWPCE",169,0)
 .F  S IEN=$O(^TMP("LEXFND",$J,I,IEN)) Q:IEN=""  D
"RTN","ORWPCE",170,0)
 ..S ILST=ILST+1,LST(ILST)=IEN_U_^TMP("LEXFND",$J,I,IEN)
"RTN","ORWPCE",171,0)
LEXX K ^TMP("LEXFND",$J),^TMP("LEXHIT",$J),^TMP("LEXSCH",$J),^TMP("LEXLE",$J)
"RTN","ORWPCE",172,0)
 Q
"RTN","ORWPCE",173,0)
LEXCODE(VAL,IEN,APP,ORDATE)     ; return code for a lexicon entry
"RTN","ORWPCE",174,0)
 S VAL=""
"RTN","ORWPCE",175,0)
 S:'+$G(ORDATE) ORDATE=DT
"RTN","ORWPCE",176,0)
 I APP="ICD"!(APP="10D") S VAL=$$ONE^LEXU(IEN,ORDATE,APP)_U_$S(APP="ICD":"ICD-9-CM",1:"ICD-10-CM")
"RTN","ORWPCE",177,0)
 I APP="CPT"!(APP="CHP") S VAL=$$CPTONE^LEXU(IEN,ORDATE)_U_"CPT-4"
"RTN","ORWPCE",178,0)
 I $P(VAL,U)="",(APP="CHP") S VAL=$$CPCONE^LEXU(IEN,ORDATE)_U_"HCPCS"
"RTN","ORWPCE",179,0)
 Q
"RTN","ORWPCE",180,0)
ADDRES ; Add the ORW/PXAPI RESOURCE device
"RTN","ORWPCE",181,0)
 N X
"RTN","ORWPCE",182,0)
 S X=$$RES^XUDHSET("ORW/PXAPI RESOURCE",,5,"CPRS to PCE transactions")
"RTN","ORWPCE",183,0)
 Q
"RTN","ORWPCE",184,0)
GETSVC(NEWSVC,SVC,LOC,INP) ; Returns the correct Service Connected Category
"RTN","ORWPCE",185,0)
 N DSS,ORWSVC
"RTN","ORWPCE",186,0)
 S DSS=$P($G(^SC(+LOC,0)),U,7)
"RTN","ORWPCE",187,0)
 Q:'+DSS
"RTN","ORWPCE",188,0)
 M ORWSVC=SVC
"RTN","ORWPCE",189,0)
 S NEWSVC=$$SVC^PXKCO(.ORWSVC,DSS,INP,LOC) ; DBIA #3225
"RTN","ORWPCE",190,0)
 Q
"RTN","ORWPCE",191,0)
ICDVER(RESULT,ORDT) ; Get ICD codeset version (i.e., ICD-9-CM or ICD-10-CM)
"RTN","ORWPCE",192,0)
 S ORDT=+$G(ORDT) S:'ORDT ORDT=DT
"RTN","ORWPCE",193,0)
 S RESULT="ICD^ICD-9-CM"
"RTN","ORWPCE",194,0)
 G:'$L($T(IMPDATE^LEXU)) ICDVERX
"RTN","ORWPCE",195,0)
 I +$$IMPDATE^LEXU("10D")'>ORDT S RESULT="10D^ICD-10-CM"
"RTN","ORWPCE",196,0)
ICDVERX Q
"RTN","ORWPCE",197,0)
I10IMPDT(RESULT) ; Get ICD-10 Implementation Date
"RTN","ORWPCE",198,0)
 S RESULT=""
"RTN","ORWPCE",199,0)
 G:'$L($T(IMPDATE^LEXU)) I10IMPX
"RTN","ORWPCE",200,0)
 S RESULT=$$IMPDATE^LEXU("10D")
"RTN","ORWPCE",201,0)
I10IMPX Q
"VER")
8.0^22.0
**INSTALL NAME**
IBD*3.0*66
"BLD",9271,0)
IBD*3.0*66^AUTOMATED INFO COLLECTION SYS^0^3141017^y
"BLD",9271,4,0)
^9.64PA^^
"BLD",9271,6)
1^
"BLD",9271,6.3)
5
"BLD",9271,"ABPKG")
n
"BLD",9271,"KRN",0)
^9.67PA^779.2^20
"BLD",9271,"KRN",.4,0)
.4
"BLD",9271,"KRN",.401,0)
.401
"BLD",9271,"KRN",.402,0)
.402
"BLD",9271,"KRN",.403,0)
.403
"BLD",9271,"KRN",.5,0)
.5
"BLD",9271,"KRN",.84,0)
.84
"BLD",9271,"KRN",3.6,0)
3.6
"BLD",9271,"KRN",3.8,0)
3.8
"BLD",9271,"KRN",9.2,0)
9.2
"BLD",9271,"KRN",9.8,0)
9.8
"BLD",9271,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9271,"KRN",9.8,"NM",1,0)
IBDF18A2^^0^B10678203
"BLD",9271,"KRN",9.8,"NM","B","IBDF18A2",1)

"BLD",9271,"KRN",19,0)
19
"BLD",9271,"KRN",19.1,0)
19.1
"BLD",9271,"KRN",101,0)
101
"BLD",9271,"KRN",409.61,0)
409.61
"BLD",9271,"KRN",771,0)
771
"BLD",9271,"KRN",779.2,0)
779.2
"BLD",9271,"KRN",870,0)
870
"BLD",9271,"KRN",8989.51,0)
8989.51
"BLD",9271,"KRN",8989.52,0)
8989.52
"BLD",9271,"KRN",8994,0)
8994
"BLD",9271,"KRN","B",.4,.4)

"BLD",9271,"KRN","B",.401,.401)

"BLD",9271,"KRN","B",.402,.402)

"BLD",9271,"KRN","B",.403,.403)

"BLD",9271,"KRN","B",.5,.5)

"BLD",9271,"KRN","B",.84,.84)

"BLD",9271,"KRN","B",3.6,3.6)

"BLD",9271,"KRN","B",3.8,3.8)

"BLD",9271,"KRN","B",9.2,9.2)

"BLD",9271,"KRN","B",9.8,9.8)

"BLD",9271,"KRN","B",19,19)

"BLD",9271,"KRN","B",19.1,19.1)

"BLD",9271,"KRN","B",101,101)

"BLD",9271,"KRN","B",409.61,409.61)

"BLD",9271,"KRN","B",771,771)

"BLD",9271,"KRN","B",779.2,779.2)

"BLD",9271,"KRN","B",870,870)

"BLD",9271,"KRN","B",8989.51,8989.51)

"BLD",9271,"KRN","B",8989.52,8989.52)

"BLD",9271,"KRN","B",8994,8994)

"BLD",9271,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",9271,"QUES",0)
^9.62^^
"BLD",9271,"REQB",0)
^9.611^1^1
"BLD",9271,"REQB",1,0)
IBD*3.0*63^1
"BLD",9271,"REQB","B","IBD*3.0*63",1)

"MBREQ")
0
"PKG",76,-1)
1^1
"PKG",76,0)
AUTOMATED INFO COLLECTION SYS^IBD^The utilities for generating a paper encounter form.
"PKG",76,22,0)
^9.49I^1^1
"PKG",76,22,1,0)
3.0^2970212^2970501^1
"PKG",76,22,1,"PAH",1,0)
66^3141017^100916
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","IBDF18A2")
0^1^B10678203
"RTN","IBDF18A2",1,0)
IBDF18A2 ;WISC/TN - ENCOUNTER FORM - utilities for PCE ;04/30/03
"RTN","IBDF18A2",2,0)
 ;;3.0;AUTOMATED INFO COLLECTION SYS;**51,55,63,66**;APR 30, 2003;Build 5
"RTN","IBDF18A2",3,0)
 ;
"RTN","IBDF18A2",4,0)
 ; Reference to $$STATCHK^ICDEX supported by ICR #5747
"RTN","IBDF18A2",5,0)
 ;
"RTN","IBDF18A2",6,0)
 QUIT  ;Call at CHKLST
"RTN","IBDF18A2",7,0)
 ;
"RTN","IBDF18A2",8,0)
CHKLST ;Create a new list to pass to calling packages.
"RTN","IBDF18A2",9,0)
 ;The new array will have CPT or ICD codes which
"RTN","IBDF18A2",10,0)
 ;are valid for the encounter date passed.
"RTN","IBDF18A2",11,0)
 ;
"RTN","IBDF18A2",12,0)
 ;CALLED BY: IBDF18A
"RTN","IBDF18A2",13,0)
 ;
"RTN","IBDF18A2",14,0)
 ;Quit if no date is passed.
"RTN","IBDF18A2",15,0)
 S ENCDATE=$G(ENCDATE) I ENCDATE="" Q
"RTN","IBDF18A2",16,0)
 ;
"RTN","IBDF18A2",17,0)
 NEW AA,CNT,CNT1,CNT2,MOD,TYPE,NODE,IBDCSYS,IBDIMPDA,IBDX
"RTN","IBDF18A2",18,0)
 K ^TMP("IBDCSV",$J) S U="^"
"RTN","IBDF18A2",19,0)
 ;
"RTN","IBDF18A2",20,0)
 S CNT=0,AA=0,TYPE="",NODE="MODIFIER"
"RTN","IBDF18A2",21,0)
 S:PACKAGE="DG SELECT CPT PROCEDURE CODES" TYPE="CPT"
"RTN","IBDF18A2",22,0)
 S:PACKAGE="DG SELECT ICD-9 DIAGNOSIS CODE" TYPE="ICD"
"RTN","IBDF18A2",23,0)
 S:PACKAGE="DG SELECT ICD DIAGNOSIS CODES" TYPE="ICD"
"RTN","IBDF18A2",24,0)
 S:PACKAGE="DG SELECT ICD-10 DIAGNOSIS COD" TYPE="ICD10"
"RTN","IBDF18A2",25,0)
 S:PACKAGE="DG SELECT VISIT TYPE CPT PROCE" TYPE="CPT"
"RTN","IBDF18A2",26,0)
 S:PACKAGE="GMP INPUT CLINIC COMMON PROBLE" TYPE="ICD"
"RTN","IBDF18A2",27,0)
 S:PACKAGE="GMP PATIENT ACTIVE PROBLEMS" TYPE="ICD"
"RTN","IBDF18A2",28,0)
 ;
"RTN","IBDF18A2",29,0)
 I TYPE="" D  Q
"RTN","IBDF18A2",30,0)
 . K @ARY
"RTN","IBDF18A2",31,0)
 . S @ARY@(0)=1
"RTN","IBDF18A2",32,0)
 . S @ARY@(1)="^AICS ERROR - Missing code type for "_PACKAGE
"RTN","IBDF18A2",33,0)
 ;
"RTN","IBDF18A2",34,0)
 ;Make copy of array and kill the original
"RTN","IBDF18A2",35,0)
 M ^TMP("IBDCSV",$J)=@ARY KILL @ARY
"RTN","IBDF18A2",36,0)
 ;
"RTN","IBDF18A2",37,0)
 S CNT=0,AA=0
"RTN","IBDF18A2",38,0)
 F  S AA=$O(^TMP("IBDCSV",$J,AA)) Q:'AA  D
"RTN","IBDF18A2",39,0)
 . ;
"RTN","IBDF18A2",40,0)
 . I $E(^TMP("IBDCSV",$J,AA))="^" S CNT=CNT+1,@ARY@(CNT)=^TMP("IBDCSV",$J,AA) Q  ;header
"RTN","IBDF18A2",41,0)
 . ;
"RTN","IBDF18A2",42,0)
 . S CODE=$P(^TMP("IBDCSV",$J,AA),U) I CODE="" Q
"RTN","IBDF18A2",43,0)
 . ;
"RTN","IBDF18A2",44,0)
 . ;Validate the CPT code for the date passed
"RTN","IBDF18A2",45,0)
 . I TYPE="CPT" D  Q
"RTN","IBDF18A2",46,0)
 . . I $P($$CPT^ICPTCOD(CODE,ENCDATE),U,7)=1 D
"RTN","IBDF18A2",47,0)
 . . . S CNT=CNT+1,@ARY@(CNT)=^TMP("IBDCSV",$J,AA)
"RTN","IBDF18A2",48,0)
 . . . ;
"RTN","IBDF18A2",49,0)
 . . . ;Check for modifiers.
"RTN","IBDF18A2",50,0)
 . . . I '$G(^TMP("IBDCSV",$J,AA,NODE,0)) Q
"RTN","IBDF18A2",51,0)
 . . . ;
"RTN","IBDF18A2",52,0)
 . . . S CNT1=^TMP("IBDCSV",$J,AA,NODE,0)
"RTN","IBDF18A2",53,0)
 . . . F CNT2=1:1:CNT1 S MOD=^TMP("IBDCSV",$J,AA,NODE,CNT2) D
"RTN","IBDF18A2",54,0)
 . . . . ;
"RTN","IBDF18A2",55,0)
 . . . . ;If the status is 1 for the modifier
"RTN","IBDF18A2",56,0)
 . . . . I $P($$MOD^ICPTMOD(MOD,"E",ENCDATE),U,7)=1 D
"RTN","IBDF18A2",57,0)
 . . . . . S @ARY@(CNT,NODE,CNT2)=^TMP("IBDCSV",$J,AA,NODE,CNT2)
"RTN","IBDF18A2",58,0)
 . . . . . S @ARY@(CNT,NODE,0)=CNT2
"RTN","IBDF18A2",59,0)
 . . . . ;
"RTN","IBDF18A2",60,0)
 . ;Validate the ICD code for the date passed
"RTN","IBDF18A2",61,0)
 . S IBDIMPDA=$$IMPDATE^IBDUTICD("10D")
"RTN","IBDF18A2",62,0)
 . I TYPE="ICD10",ENCDATE'<IBDIMPDA D  Q
"RTN","IBDF18A2",63,0)
 . . ; IBD*3*66 - Call $$STATCHK^ICDEX to speed up dx status retrieval
"RTN","IBDF18A2",64,0)
 . . S IBDX=$$STATCHK^ICDEX(CODE,ENCDATE,30) I +IBDX>0 D  ;Active
"RTN","IBDF18A2",65,0)
 . . . S CNT=CNT+1,@ARY@(CNT)=^TMP("IBDCSV",$J,AA)
"RTN","IBDF18A2",66,0)
 . I TYPE="ICD" D  ;This includes BOTH DG SELECT ICD-9 DIAGNOSIS CODES and DG SELECT ICD DIAGNOSIS CODES dependent upon ENCDATE
"RTN","IBDF18A2",67,0)
 . . S IBDCSYS=$S(ENCDATE<IBDIMPDA:1,1:30)
"RTN","IBDF18A2",68,0)
 . . ; IBD*3*66 - Call $$STATCHK^ICDEX to speed up dx status retrieval
"RTN","IBDF18A2",69,0)
 . . S IBDX=$$STATCHK^ICDEX(CODE,ENCDATE,IBDCSYS) I +IBDX>0 D  ;Active
"RTN","IBDF18A2",70,0)
 . . . S CNT=CNT+1,@ARY@(CNT)=^TMP("IBDCSV",$J,AA)
"RTN","IBDF18A2",71,0)
 ;
"RTN","IBDF18A2",72,0)
 S @ARY@(0)=CNT
"RTN","IBDF18A2",73,0)
 K ^TMP("IBDCSV",$J)
"RTN","IBDF18A2",74,0)
 Q
"VER")
8.0^22.0
**END**
**END**
