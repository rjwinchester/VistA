KIDS Distribution saved on Oct 10, 2017@07:18:13
Problem Selection List Build 1.0
**KIDS**:PROBLEM SELECTION LIST BUILD 1.0^GMPL*2.0*49^OR*3.0*429^

**INSTALL NAME**
PROBLEM SELECTION LIST BUILD 1.0
"BLD",9849,0)
PROBLEM SELECTION LIST BUILD 1.0^^1^3171010^y
"BLD",9849,1,0)
^^3^3^3170216^
"BLD",9849,1,1,0)
This combined build contains the two patches that will implement the 
"BLD",9849,1,2,0)
Problem selection list enhancements and streamline the entry of common 
"BLD",9849,1,3,0)
patient problems.
"BLD",9849,6.3)
35
"BLD",9849,10,0)
^9.63^2^2
"BLD",9849,10,1,0)
GMPL*2.0*49^1
"BLD",9849,10,2,0)
OR*3.0*429^1
"BLD",9849,10,"B","GMPL*2.0*49",1)

"BLD",9849,10,"B","OR*3.0*429",2)

"BLD",9849,"KRN",0)
^9.67PA^779.2^20
"BLD",9849,"KRN",.4,0)
.4
"BLD",9849,"KRN",.401,0)
.401
"BLD",9849,"KRN",.402,0)
.402
"BLD",9849,"KRN",.403,0)
.403
"BLD",9849,"KRN",.5,0)
.5
"BLD",9849,"KRN",.84,0)
.84
"BLD",9849,"KRN",3.6,0)
3.6
"BLD",9849,"KRN",3.8,0)
3.8
"BLD",9849,"KRN",9.2,0)
9.2
"BLD",9849,"KRN",9.8,0)
9.8
"BLD",9849,"KRN",19,0)
19
"BLD",9849,"KRN",19.1,0)
19.1
"BLD",9849,"KRN",101,0)
101
"BLD",9849,"KRN",409.61,0)
409.61
"BLD",9849,"KRN",771,0)
771
"BLD",9849,"KRN",779.2,0)
779.2
"BLD",9849,"KRN",870,0)
870
"BLD",9849,"KRN",8989.51,0)
8989.51
"BLD",9849,"KRN",8989.52,0)
8989.52
"BLD",9849,"KRN",8994,0)
8994
"BLD",9849,"KRN","B",.4,.4)

"BLD",9849,"KRN","B",.401,.401)

"BLD",9849,"KRN","B",.402,.402)

"BLD",9849,"KRN","B",.403,.403)

"BLD",9849,"KRN","B",.5,.5)

"BLD",9849,"KRN","B",.84,.84)

"BLD",9849,"KRN","B",3.6,3.6)

"BLD",9849,"KRN","B",3.8,3.8)

"BLD",9849,"KRN","B",9.2,9.2)

"BLD",9849,"KRN","B",9.8,9.8)

"BLD",9849,"KRN","B",19,19)

"BLD",9849,"KRN","B",19.1,19.1)

"BLD",9849,"KRN","B",101,101)

"BLD",9849,"KRN","B",409.61,409.61)

"BLD",9849,"KRN","B",771,771)

"BLD",9849,"KRN","B",779.2,779.2)

"BLD",9849,"KRN","B",870,870)

"BLD",9849,"KRN","B",8989.51,8989.51)

"BLD",9849,"KRN","B",8989.52,8989.52)

"BLD",9849,"KRN","B",8994,8994)

"MBREQ")
0
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"VER")
8.0^22.2
**INSTALL NAME**
GMPL*2.0*49
"BLD",9821,0)
GMPL*2.0*49^PROBLEM LIST^0^3171010^y
"BLD",9821,1,0)
^^2^2^3170209^
"BLD",9821,1,1,0)
The description of this patch may be found in the National Patch Module
"BLD",9821,1,2,0)
under GMPL*2.0*49.
"BLD",9821,4,0)
^9.64PA^125.11^2
"BLD",9821,4,125,0)
125
"BLD",9821,4,125,222)
y^y^f^^y^^y^r^n
"BLD",9821,4,125,224)
I $$SENDLIST^GMPLY49($P(^(0),U))
"BLD",9821,4,125.11,0)
125.11
"BLD",9821,4,125.11,222)
y^y^f^^y^^y^r^n
"BLD",9821,4,125.11,224)
I $$SENDLIST^GMPLY49($P(^(0),U))
"BLD",9821,4,"B",125,125)

"BLD",9821,4,"B",125.11,125.11)

"BLD",9821,6)
^43
"BLD",9821,6.3)
43
"BLD",9821,"INI")
PRE^GMPLY49
"BLD",9821,"INID")
^y^y
"BLD",9821,"INIT")
POST^GMPLY49
"BLD",9821,"KRN",0)
^9.67PA^779.2^20
"BLD",9821,"KRN",.4,0)
.4
"BLD",9821,"KRN",.401,0)
.401
"BLD",9821,"KRN",.402,0)
.402
"BLD",9821,"KRN",.403,0)
.403
"BLD",9821,"KRN",.5,0)
.5
"BLD",9821,"KRN",.84,0)
.84
"BLD",9821,"KRN",3.6,0)
3.6
"BLD",9821,"KRN",3.8,0)
3.8
"BLD",9821,"KRN",9.2,0)
9.2
"BLD",9821,"KRN",9.8,0)
9.8
"BLD",9821,"KRN",9.8,"NM",0)
^9.68A^21^19
"BLD",9821,"KRN",9.8,"NM",1,0)
GMPL^^0^B27126039
"BLD",9821,"KRN",9.8,"NM",2,0)
GMPLBLD2^^0^B88445928
"BLD",9821,"KRN",9.8,"NM",3,0)
GMPLBLD1^^0^B39853125
"BLD",9821,"KRN",9.8,"NM",4,0)
GMPLBLD^^0^B62962648
"BLD",9821,"KRN",9.8,"NM",5,0)
GMPLBLCK^^0^B78808461
"BLD",9821,"KRN",9.8,"NM",6,0)
GMPLBLD3^^0^B21650915
"BLD",9821,"KRN",9.8,"NM",7,0)
GMPLBLDC^^0^B105378779
"BLD",9821,"KRN",9.8,"NM",8,0)
GMPLCOPY^^0^B19671489
"BLD",9821,"KRN",9.8,"NM",9,0)
GMPLINTR^^0^B27139569
"BLD",9821,"KRN",9.8,"NM",11,0)
GMPLUTL2^^0^B93151761
"BLD",9821,"KRN",9.8,"NM",13,0)
GMPLX^^0^B127583491
"BLD",9821,"KRN",9.8,"NM",14,0)
GMPLUTL4^^0^B16873320
"BLD",9821,"KRN",9.8,"NM",15,0)
GMPLCLN^^0^B127703293
"BLD",9821,"KRN",9.8,"NM",16,0)
GMPLSAVE^^0^B133926032
"BLD",9821,"KRN",9.8,"NM",17,0)
GMPLSLRP^^0^B3033052
"BLD",9821,"KRN",9.8,"NM",18,0)
GMPLSLI1^^0^B186261431
"BLD",9821,"KRN",9.8,"NM",19,0)
GMPLSLI2^^0^B11257875
"BLD",9821,"KRN",9.8,"NM",20,0)
GMPLY49A^^0^B22998218
"BLD",9821,"KRN",9.8,"NM",21,0)
GMPL1^^0^B42997601
"BLD",9821,"KRN",9.8,"NM","B","GMPL",1)

"BLD",9821,"KRN",9.8,"NM","B","GMPL1",21)

"BLD",9821,"KRN",9.8,"NM","B","GMPLBLCK",5)

"BLD",9821,"KRN",9.8,"NM","B","GMPLBLD",4)

"BLD",9821,"KRN",9.8,"NM","B","GMPLBLD1",3)

"BLD",9821,"KRN",9.8,"NM","B","GMPLBLD2",2)

"BLD",9821,"KRN",9.8,"NM","B","GMPLBLD3",6)

"BLD",9821,"KRN",9.8,"NM","B","GMPLBLDC",7)

"BLD",9821,"KRN",9.8,"NM","B","GMPLCLN",15)

"BLD",9821,"KRN",9.8,"NM","B","GMPLCOPY",8)

"BLD",9821,"KRN",9.8,"NM","B","GMPLINTR",9)

"BLD",9821,"KRN",9.8,"NM","B","GMPLSAVE",16)

"BLD",9821,"KRN",9.8,"NM","B","GMPLSLI1",18)

"BLD",9821,"KRN",9.8,"NM","B","GMPLSLI2",19)

"BLD",9821,"KRN",9.8,"NM","B","GMPLSLRP",17)

"BLD",9821,"KRN",9.8,"NM","B","GMPLUTL2",11)

"BLD",9821,"KRN",9.8,"NM","B","GMPLUTL4",14)

"BLD",9821,"KRN",9.8,"NM","B","GMPLX",13)

"BLD",9821,"KRN",9.8,"NM","B","GMPLY49A",20)

"BLD",9821,"KRN",19,0)
19
"BLD",9821,"KRN",19,"NM",0)
^9.68A^7^5
"BLD",9821,"KRN",19,"NM",3,0)
GMPL SELECTION LIST CSV CHECK^^0
"BLD",9821,"KRN",19,"NM",4,0)
GMPL ASSIGN LIST^^0
"BLD",9821,"KRN",19,"NM",5,0)
GMPL SELECTION LIST IMPORT^^0
"BLD",9821,"KRN",19,"NM",6,0)
GMPL BUILD LIST MENU^^2
"BLD",9821,"KRN",19,"NM",7,0)
GMPL DE-ASSIGN LIST^^1^
"BLD",9821,"KRN",19,"NM","B","GMPL ASSIGN LIST",4)

"BLD",9821,"KRN",19,"NM","B","GMPL BUILD LIST MENU",6)

"BLD",9821,"KRN",19,"NM","B","GMPL DE-ASSIGN LIST",7)

"BLD",9821,"KRN",19,"NM","B","GMPL SELECTION LIST CSV CHECK",3)

"BLD",9821,"KRN",19,"NM","B","GMPL SELECTION LIST IMPORT",5)

"BLD",9821,"KRN",19.1,0)
19.1
"BLD",9821,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",9821,"KRN",19.1,"NM",1,0)
GMPL IMPRT UTIL^^0
"BLD",9821,"KRN",19.1,"NM","B","GMPL IMPRT UTIL",1)

"BLD",9821,"KRN",101,0)
101
"BLD",9821,"KRN",101,"NM",0)
^9.68A^5^4
"BLD",9821,"KRN",101,"NM",1,0)
GMPL MENU SAVE GROUP^^0
"BLD",9821,"KRN",101,"NM",2,0)
GMPL MENU SAVE LIST^^0
"BLD",9821,"KRN",101,"NM",3,0)
GMPL MENU COPY GROUP^^0
"BLD",9821,"KRN",101,"NM",5,0)
GMPL MENU ASSIGN LIST^^0
"BLD",9821,"KRN",101,"NM","B","GMPL MENU ASSIGN LIST",5)

"BLD",9821,"KRN",101,"NM","B","GMPL MENU COPY GROUP",3)

"BLD",9821,"KRN",101,"NM","B","GMPL MENU SAVE GROUP",1)

"BLD",9821,"KRN",101,"NM","B","GMPL MENU SAVE LIST",2)

"BLD",9821,"KRN",409.61,0)
409.61
"BLD",9821,"KRN",771,0)
771
"BLD",9821,"KRN",779.2,0)
779.2
"BLD",9821,"KRN",870,0)
870
"BLD",9821,"KRN",8989.51,0)
8989.51
"BLD",9821,"KRN",8989.52,0)
8989.52
"BLD",9821,"KRN",8994,0)
8994
"BLD",9821,"KRN","B",.4,.4)

"BLD",9821,"KRN","B",.401,.401)

"BLD",9821,"KRN","B",.402,.402)

"BLD",9821,"KRN","B",.403,.403)

"BLD",9821,"KRN","B",.5,.5)

"BLD",9821,"KRN","B",.84,.84)

"BLD",9821,"KRN","B",3.6,3.6)

"BLD",9821,"KRN","B",3.8,3.8)

"BLD",9821,"KRN","B",9.2,9.2)

"BLD",9821,"KRN","B",9.8,9.8)

"BLD",9821,"KRN","B",19,19)

"BLD",9821,"KRN","B",19.1,19.1)

"BLD",9821,"KRN","B",101,101)

"BLD",9821,"KRN","B",409.61,409.61)

"BLD",9821,"KRN","B",771,771)

"BLD",9821,"KRN","B",779.2,779.2)

"BLD",9821,"KRN","B",870,870)

"BLD",9821,"KRN","B",8989.51,8989.51)

"BLD",9821,"KRN","B",8989.52,8989.52)

"BLD",9821,"KRN","B",8994,8994)

"BLD",9821,"QUES",0)
^9.62^^
"BLD",9821,"REQB",0)
^9.611^3^2
"BLD",9821,"REQB",2,0)
GMPL*2.0*40^2
"BLD",9821,"REQB",3,0)
GMPL*2.0*45^2
"BLD",9821,"REQB","B","GMPL*2.0*40",2)

"BLD",9821,"REQB","B","GMPL*2.0*45",3)

"DATA",125,20,0)
VA-NATIONAL PROBLEM SELECTION LIST^3171010^^N
"DATA",125,20,1,0)
^125.01P^26^26
"DATA",125,20,1,1,0)
34^1^Primary Care (VA)^1
"DATA",125,20,1,2,0)
35^2^Cardiology (VA)^1
"DATA",125,20,1,3,0)
36^3^Dental (VA)^1
"DATA",125,20,1,4,0)
37^4^Dermatology (VA)^1
"DATA",125,20,1,5,0)
38^5^Diabetes (VA)^1
"DATA",125,20,1,6,0)
40^6^ENT (VA)^1
"DATA",125,20,1,7,0)
41^7^Emergency Dept (VA)^1
"DATA",125,20,1,8,0)
42^8^Endo Metab Except Diabetes (VA)^1
"DATA",125,20,1,9,0)
43^9^Gastroenterology (VA)^1
"DATA",125,20,1,10,0)
44^10^General Surgery (VA)^1
"DATA",125,20,1,11,0)
49^11^Gynecology (VA)^1
"DATA",125,20,1,12,0)
50^12^Hematology (VA)^1
"DATA",125,20,1,13,0)
51^13^Infectious Disease (VA)^1
"DATA",125,20,1,14,0)
52^14^Mental Health (VA)^1
"DATA",125,20,1,15,0)
53^15^Neurology (VA)^1
"DATA",125,20,1,16,0)
54^16^Neurosurgery (VA)^1
"DATA",125,20,1,17,0)
55^17^Oncology (VA)^1
"DATA",125,20,1,18,0)
56^18^Ophthalmology (VA)^1
"DATA",125,20,1,19,0)
57^19^Orthopedics (VA)^1
"DATA",125,20,1,20,0)
58^20^Pain (VA)^1
"DATA",125,20,1,21,0)
59^21^Plastic Surgery (VA)^1
"DATA",125,20,1,22,0)
60^22^Polytrauma (VA)^1
"DATA",125,20,1,23,0)
62^23^Pulmonary (VA)^1
"DATA",125,20,1,24,0)
63^24^Renal Nephrology (VA)^1
"DATA",125,20,1,25,0)
64^25^Rheumatology (VA)^1
"DATA",125,20,1,26,0)
65^26^Urology (VA)^1
"DATA",125.11,34,0)
VA-PRIMARY CARE^3171010^N
"DATA",125.11,34,1,0)
^125.111P^59^59
"DATA",125.11,34,1,1,0)
7659182^1^AF- Atrial Fibrillation (SCT 49436004)^I48.91^49436004^1230726010
"DATA",125.11,34,1,2,0)
7026741^2^Alcohol Abuse (SCT 15167005)^F10.10^15167005^25750014
"DATA",125.11,34,1,3,0)
7542243^3^History of Alcohol Abuse (SCT 371434005)^F10.21^371434005^1210092019
"DATA",125.11,34,1,4,0)
7109935^4^Allergic Rhinitis (SCT 61582004)^J30.9^61582004^102311013
"DATA",125.11,34,1,5,0)
7420143^5^Anemia (SCT 271737000)^D64.9^271737000^406636013
"DATA",125.11,34,1,6,0)
7086883^6^Anxiety (SCT 48694002)^F41.9^48694002^81133019
"DATA",125.11,34,1,7,0)
7287631^7^Asthma (SCT 195967001)^J45.909^195967001^301485011
"DATA",125.11,34,1,8,0)
7359365^8^Benign Prostatic Hypertrophy With Outflow Obstruction (SCT 236646007)^N40.1/N13.8^236646007^2470105014
"DATA",125.11,34,1,9,0)
8117575^9^Benign Prostatic Hypertrophy Without Outflow Obstruction (SCT 254902007)^N40.0^254902007^2773349010
"DATA",125.11,34,1,10,0)
7284377^10^Blindness - Both Eyes (SCT 193699007)^H54.3^193699007^298251016
"DATA",125.11,34,1,11,0)
7040649^11^Blindness of One Eye (SCT 22950006)^H54.40^22950006^38553019
"DATA",125.11,34,1,12,0)
7663749^12^CAD - Coronary Artery Disease (SCT 53741008)^I25.10^53741008^2536394018
"DATA",125.11,34,1,13,0)
7601169^13^Chronic Ischemic Heart Disease (SCT 413838009)^I25.9^413838009^2534671011
"DATA",125.11,34,1,14,0)
7053027^14^Chest Pain (SCT 29857009)^R07.9^29857009^49966017
"DATA",125.11,34,1,15,0)
7651747^15^CHF - Congestive Heart Failure (SCT 42343007)^I50.9^42343007^493289014
"DATA",125.11,34,1,16,0)
7035275^16^Cirrhosis of Liver (SCT 19943007)^K74.60^19943007^33568015
"DATA",125.11,34,1,17,0)
7943760^17^Alcoholic Cirrhosis (SCT 420054005)^K70.30^420054005^2576981019
"DATA",125.11,34,1,18,0)
7414107^18^Cirrhosis - Non-Alcoholic (SCT 266468003)^K74.60^266468003^396389015
"DATA",125.11,34,1,19,0)
7417893^19^Carcinoma of Colon (SCT 269533000)^C18.9^269533000^403809019
"DATA",125.11,34,1,20,0)
8230307^20^Polyp Colon (SCT 68496003)^K63.5^68496003^2920839016
"DATA",125.11,34,1,21,0)
7622187^21^COPD - Chronic Obstructive Pulmonary Disease (SCT 13645005)^J44.9^13645005^475427019
"DATA",125.11,34,1,22,0)
7026025^22^Constipation (SCT 14760008)^K59.00^14760008^25076018
"DATA",125.11,34,1,23,0)
7673413^23^CVD - Cerebrovascular Disease (SCT 62914000)^I67.9^62914000^499414018
"DATA",125.11,34,1,24,0)
7093661^24^Dementia (SCT 52448006)^F03.90^52448006^87274019
"DATA",125.11,34,1,25,0)
7644549^25^Depression (SCT 35489007)^F32.9^35489007^486184015
"DATA",125.11,34,1,26,0)
7083159^26^Diabetes Mellitus Type 1 (SCT 46635009)^E10.9^46635009^197985011
"DATA",125.11,34,1,27,0)
7078519^27^Diabetes Mellitus Type 2 (SCT 44054006)^E11.9^44054006^197763012
"DATA",125.11,34,1,28,0)
7802573^28^Impaired Fasting Glucose (SCT 390951007)^R73.01^390951007^2476951018
"DATA",125.11,34,1,29,0)
8234552^29^Erectile Dysfunction (SCT 397803000)^N52.9^397803000^2955652011
"DATA",125.11,34,1,30,0)
8176838^30^GERD - Gastro-Esophageal Reflux Disease (SCT 235595009)^K21.9^235595009^2535970019
"DATA",125.11,34,1,31,0)
7161849^31^Gout (SCT 90560007)^M10.9^90560007^150085018
"DATA",125.11,34,1,32,0)
7044423^32^Headache (SCT 25064002)^R51.^25064002^41990019
"DATA",125.11,34,1,33,0)
7026781^33^Hearing Loss (SCT 15188001)^H91.90^15188001^25788011
"DATA",125.11,34,1,34,0)
7660613^34^Hepatitis C (SCT 50711007)^B19.20^50711007^84516016
"DATA",125.11,34,1,35,0)
7058515^35^Homeless (SCT 32911000)^Z59.0^32911000^485356010
"DATA",125.11,34,1,36,0)
7647485^36^HTN - Hypertension (SCT 38341003)^I10.^38341003^2164904016
"DATA",125.11,34,1,37,0)
7099689^37^Hyperlipidemia (SCT 55822004)^E78.5^55822004^92826017
"DATA",125.11,34,1,38,0)
7415239^38^Mixed Hyperlipidemia (SCT 267434003)^E78.2^267434003^398859011
"DATA",125.11,34,1,39,0)
7024039^39^Hypercholesterolemia (SCT 13644009)^E78.00^13644009^23283015
"DATA",125.11,34,1,40,0)
7072959^40^Hypothyroidism (SCT 40930008)^E03.9^40930008^68268011
"DATA",125.11,34,1,41,0)
7284041^41^Insomnia (SCT 193462001)^G47.00^193462001^297924011
"DATA",125.11,34,1,42,0)
7055083^42^Knee Pain (SCT 30989003)^M25.569^30989003^51875014
"DATA",125.11,34,1,43,0)
7433625^43^Low Back Pain (SCT 279039007)^M54.5^279039007^416139010
"DATA",125.11,34,1,44,0)
7145949^44^Neck Pain (SCT 81680005)^M54.2^81680005^135489010
"DATA",125.11,34,1,45,0)
7080801^45^Shoulder Pain (SCT 45326000)^M25.519^45326000^75568012
"DATA",125.11,34,1,46,0)
7804380^46^OA - Osteoarthritis (SCT 396275006)^M19.90^396275006^1785522017
"DATA",125.11,34,1,47,0)
7603305^47^Obesity (SCT 414916001)^E66.9^414916001^2535065012
"DATA",125.11,34,1,48,0)
7746984^48^Patient Overweight (SCT 238131007)^E66.3^238131007^356961016
"DATA",125.11,34,1,49,0)
7115815^49^Osteoporosis (SCT 64859006)^M81.0^64859006^107806013
"DATA",125.11,34,1,50,0)
7036611^50^Peripheral Venous Insufficiency (SCT 20696009)^I87.2^20696009^34824018
"DATA",125.11,34,1,51,0)
7804290^51^Elevated PSA (SCT 396152005)^R97.20^396152005^1785467014
"DATA",125.11,34,1,52,0)
8306669^52^Prostate Cancer (SCT 254900004)^C61.^254900004^3036967016
"DATA",125.11,34,1,53,0)
8224841^53^Psychosexual Dysfunction Associated with Inhibited Sexual Excitement (SCT 153151000119100)^F52.9^153151000119100^2984175015
"DATA",125.11,34,1,54,0)
7657192^54^PTSD - Post-Traumatic Stress Disorder (SCT 47505003)^F43.10^47505003^494849017
"DATA",125.11,34,1,55,0)
7358939^55^Renal Impairment (SCT 236423003)^N28.9^236423003^354406016
"DATA",125.11,34,1,56,0)
7131165^56^Sleep Apnea (SCT 73430006)^G47.30^73430006^121941010
"DATA",125.11,34,1,57,0)
7191611^57^Tobacco User (SCT 110483000)^Z72.0^110483000^175325014
"DATA",125.11,34,1,58,0)
8222817^58^History of Tobacco Use (SCT 1221000119103)^Z87.891^1221000119103^2966944018
"DATA",125.11,34,1,59,0)
7061753^59^Vitamin D Deficiency (SCT 4713006)^E55.9^34713006^57937016
"DATA",125.11,35,0)
VA-CARDIOLOGY^3171010^N
"DATA",125.11,35,1,0)
^125.111P^22^22
"DATA",125.11,35,1,1,0)
7659182^1^AF-Atrial Fibrillation (SCT 49436004)^I48.91^49436004^1230726010
"DATA",125.11,35,1,2,0)
7009381^2^Atrial Flutter (SCT 5370000)^I48.92^5370000^9988012
"DATA",125.11,35,1,3,0)
8270997^3^Angina Pectoris (SCT 194828000)^I20.9^194828000^299757012
"DATA",125.11,35,1,4,0)
7015347^4^Aortic Valve Disorder (SCT 8722008)^I35.9^8722008^15387019
"DATA",125.11,35,1,5,0)
7663749^5^CAD - Coronary Artery Disease (SCT 53741008)^I25.10^53741008^2536394018
"DATA",125.11,35,1,6,0)
8215235^6^Cardiac Arrhythmia (SCT 698247007)^I49.9^698247007^2972872011
"DATA",125.11,35,1,7,0)
7014395^7^Cardiomegaly (SCT 8186001)^I51.7^8186001^14506018
"DATA",125.11,35,1,8,0)
7153473^8^Cardiomyopathy (SCT 85898001)^I42.9^85898001^142397010
"DATA",125.11,35,1,9,0)
7053027^9^Chest Pain (SCT 29857009)^R07.9^29857009^49966017
"DATA",125.11,35,1,10,0)
7651747^10^CHF - Congestive Heart Failure (SCT 42343007)^I50.9^42343007^493289014
"DATA",125.11,35,1,11,0)
7601169^11^Chronic Ischemic Heart Disease (SCT 413838009)^I25.9^413838009^2534671011
"DATA",125.11,35,1,12,0)
7414739^12^Dyspnea (SCT 267036007)^R06.00^267036007^397885013
"DATA",125.11,35,1,13,0)
7414743^13^Edema (SCT 267038008)^R60.9^267038008^397895018
"DATA",125.11,35,1,14,0)
7158329^14^Heart Murmur (SCT 88610006)^R01.1^88610006^146919019
"DATA",125.11,35,1,15,0)
7647485^15^HTN-Hypertension (SCT 38341003)^I10.^38341003^2164904016
"DATA",125.11,35,1,16,0)
7099689^16^Hyperlipidemia (SCT 55822004)^E78.5^55822004^92826017
"DATA",125.11,35,1,17,0)
7415239^17^Mixed Hyperlipidemia (SCT 267434003)^E78.2^267434003^398859011
"DATA",125.11,35,1,18,0)
7072959^18^Hypothyroidism (SCT 40930008)^E03.9^40930008^68268011
"DATA",125.11,35,1,19,0)
7020847^19^Mitral Valve Disorder (SCT 11851006)^I05.9^11851006^20449013
"DATA",125.11,35,1,20,0)
7143497^20^Palpitations (SCT 80313002)^R00.2^80313002^133268018
"DATA",125.11,35,1,21,0)
7807291^21^PVD - Peripheral Vascular Disease (SCT 400047006)^I73.9^400047006^2162392019
"DATA",125.11,35,1,22,0)
7492137^22^Syncope and Collapse (SCT 309585006)^R55.^309585006^453038013
"DATA",125.11,36,0)
VA-DENTAL^3171010^N
"DATA",125.11,36,1,0)
^125.111P^20^20
"DATA",125.11,36,1,1,0)
7011051^1^Accretion on Teeth (SCT 6288001)^K03.6^6288001^11440019
"DATA",125.11,36,1,2,0)
8128749^2^Acquired Absence of All Teeth (SCT 441935006)^K08.109^441935006^2817985015
"DATA",125.11,36,1,3,0)
7190093^3^Acquired Absence of Multiple Teeth (SCT 109673006)^K08.109^109673006^174319017
"DATA",125.11,36,1,4,0)
8218595^4^Carious Exposure of Pulp (SCT 700046006)^K02.9^700046006^2988798013
"DATA",125.11,36,1,5,0)
7054217^5^Cementum Caries (SCT 30512007)^K02.7^30512007^51063015
"DATA",125.11,36,1,6,0)
7009947^6^Chronic Periodontitis (SCT 5689008)^K05.30^5689008^10478013
"DATA",125.11,36,1,7,0)
8262577^7^Generalized Chronic Periodontitis (SCT 707251008)^K05.329^707251008^3029511012
"DATA",125.11,36,1,8,0)
7190237^8^Cracked Tooth (SCT 109747007)^K03.81^109747007^174408016
"DATA",125.11,36,1,9,0)
7190203^9^Defective Dental Restoration (SCT 109728009)^K08.50^109728009^174386019
"DATA",125.11,36,1,10,0)
7144683^10^Dental Caries (SCT 80967001)^K02.9^80967001^134311013
"DATA",125.11,36,1,11,0)
8129981^11^Dental Caries Extending into Dentine (SCT 442551007)^K02.9^442551007^2820469019
"DATA",125.11,36,1,12,0)
7083025^12^Disorder of Hard Tissues of Teeth (SCT 46557008)^K03.9^46557008^2474877013
"DATA",125.11,36,1,13,0)
7116965^13^Generalized Gingival Recession (SCT 65510006)^K06.020^65510006^108846016
"DATA",125.11,36,1,14,0)
7414033^14^Gingival and Periodontal Disease (SCT 266418006)^K06.9/K05.6^266418006^396315018
"DATA",125.11,36,1,15,0)
8262549^15^Gingival Disease Due to Dental Plaque (SCT 707237008)^K06.9^707237008^3029427015
"DATA",125.11,36,1,16,0)
7652130^16^Necrotic Pulp (SCT 42711005)^K04.1^42711005^71269011
"DATA",125.11,36,1,17,0)
8145137^17^Partial Edentulism (SCT 444818007)^K08.409^444818007^2872695018
"DATA",125.11,36,1,18,0)
7288155^18^Periapical Abscess Without Sinus Tract (SCT 196339009)^K04.7^196339009^301974019
"DATA",125.11,36,1,19,0)
7118891^19^Retained Dental Root (SCT 66569006)^K08.3^66569006^110594019
"DATA",125.11,36,1,20,0)
8265651^20^Unsatisfactory Tooth Restoration (SCT 112481000119103)^K08.50^112481000119103^3023244014
"DATA",125.11,37,0)
VA-DERMATOLOGY^3171010^N
"DATA",125.11,37,1,0)
^125.111P^19^19
"DATA",125.11,37,1,1,0)
7020027^1^Acne (SCT 11381005)^L70.9^11381005^19696016
"DATA",125.11,37,1,2,0)
7295401^2^Actinic Keratosis (SCT 201101007)^L57.0^201101007^1208677014
"DATA",125.11,37,1,3,0)
7574377^3^Atrophoderma (SCT 399979006)^L90.9^399979006^1779257016
"DATA",125.11,37,1,4,0)
7165235^4^Benign Neoplasm of Skin (SCT 92384009)^D23.9^92384009^152883016
"DATA",125.11,37,1,5,0)
7278113^5^Benign Neoplasm of Skin of Trunk, Excluding Scrotum (SCT 189066003)^D23.5^189066003^290466017
"DATA",125.11,37,1,6,0)
7062173^6^Chronic Dermatitis (SCT 34936007)^L30.9^34936007^58295015
"DATA",125.11,37,1,7,0)
7071767^7^Contact Dermatitis (SCT 40275004)^L25.9^40275004^63652013
"DATA",125.11,37,1,8,0)
7090235^8^Seborrheic Dermatitis (SCT 50563003)^L21.9^50563003^84228013
"DATA",125.11,37,1,9,0)
8129575^9^Inflamed Seborrheic Keratosis (SCT 43116000)^L82.0^442348004^2819742013
"DATA",125.11,37,1,10,0)
7005567^10^Discoloration of Skin (SCT 3253007)^R23.8^3253007^6491015
"DATA",125.11,37,1,11,0)
7076879^11^Eczema (SCT 43116000)^L30.9^43116000^71923017
"DATA",125.11,37,1,12,0)
7295311^12^Lichenification and Lichen Simplex Chronicus (SCT 201020007)^L28.1^201020007^308810011
"DATA",125.11,37,1,13,0)
7286767^13^Non-Neoplastic Nevus (SCT 195381005)^I78.1^195381005^300616016
"DATA",125.11,37,1,14,0)
7015869^14^Psoriasis (SCT 9014002)^L40.9^9014002^15886015
"DATA",125.11,37,1,15,0)
7572253^15^Rosacea (SCT 398909004)^L71.9^398909004^1778393010
"DATA",125.11,37,1,16,0)
7961420^16^Sebaceous Cyst (SCT 419603000)^L72.3^419603000^2580186011
"DATA",125.11,37,1,17,0)
7005901^17^Disorder of Sebaceous Gland (SCT 3441005)^L73.9^3441005^2470252014
"DATA",125.11,37,1,18,0)
7010557^18^Tinea Pedis (SCT 6020002)^B35.3^6020002^11001016
"DATA",125.11,37,1,19,0)
7667294^19^Wart (SCT 57019003)^B07.9^57019003^497766018
"DATA",125.11,38,0)
VA-DIABETES^3171010^N
"DATA",125.11,38,1,0)
^125.111P^20^20
"DATA",125.11,38,1,1,0)
7083159^1^Diabetes Mellitus Type 1 (SCT 46635009)^E10.9^46635009^197985011
"DATA",125.11,38,1,2,0)
7078519^2^Diabetes Mellitus Type 2 (SCT 44054006)^E11.9^44054006^197763012
"DATA",125.11,38,1,3,0)
8271859^3^Diabetic Oculopathy Associated With Type 1 Diabetes Mellitus (SCT 421165007)^E10.39^421165007^2967768012
"DATA",125.11,38,1,4,0)
8271877^4^Diabetic Oculopathy Associated With Type 2 Diabetes Mellitus (SCT 422099009)^E11.39^422099009^2967746019
"DATA",125.11,38,1,5,0)
8265825^5^Foot Ulcer Due To Type 1 Diabetes Mellitus (SCT 164881000119109)^E10.621/L97.509^164881000119109^3013515014
"DATA",125.11,38,1,6,0)
8272507^6^Foot Ulcer Due To Type 2 Diabetes Mellitus (SCT 1521000119100)^E11.621^1521000119100^3013067017
"DATA",125.11,38,1,7,0)
7479973^7^Hypoglycemia (SCT 302866003)^E16.2^302866003^444845012
"DATA",125.11,38,1,8,0)
7802573^8^Impaired Fasting Glucose (SCT 390951007)^R73.01^390951007^2476951018
"DATA",125.11,38,1,9,0)
8189394^9^Kidney Disorder Associated With Type 1 Diabetes Mellitus (SCT 421893009)^E10.21^421893009^2623057018
"DATA",125.11,38,1,10,0)
8188348^10^Kidney Disorder Associated With Type 2 Diabetes Mellitus (SCT 420279001)^E11.21^420279001^2623051017
"DATA",125.11,38,1,11,0)
8110643^11^Chronic Kidney Disease Stage 2 (SCT 431856006)^N18.2^431856006^2767384012
"DATA",125.11,38,1,12,0)
8113219^12^Chronic Kidney Disease Stage 3 (SCT 433144002)^N18.3^433144002^2773184015
"DATA",125.11,38,1,13,0)
8110645^13^Chronic Kidney Disease Stage 4 (SCT 431857002)^N18.4^431857002^2767385013
"DATA",125.11,38,1,14,0)
8113223^14^Chronic Kidney Disease Stage 5 (SCT 433146000)^N18.5^433146000^2767154014
"DATA",125.11,38,1,15,0)
7415239^15^Mixed Hyperlipidemia (SCT 267434003)^E78.2^267434003^398859011
"DATA",125.11,38,1,16,0)
7279659^16^Non-Toxic Uninodular Goiter (SCT 190237002)^E04.1^190237002^292307019
"DATA",125.11,38,1,17,0)
7603305^17^Obesity (SCT 414916001)^E66.9^414916001^2535065012
"DATA",125.11,38,1,18,0)
8297500^18^Peripheral Neuropathy Due To Type 1 Diabetes Mellitus (SCT 71791000119104)^E10.40^71791000119104^3289695015
"DATA",125.11,38,1,19,0)
8222897^19^Diabetic Peripheral Neuropathy Associated With Type 2 Diabetes Mellitus (SCT 1511000119107)^E11.42^1511000119107^2967635011
"DATA",125.11,38,1,20,0)
7193535^20^Testicular Hypofunction (SCT 111551000)^E29.1^111551000^178795019
"DATA",125.11,40,0)
VA-EARS NOSE THROAT^3171010^N
"DATA",125.11,40,1,0)
^125.111P^22^22
"DATA",125.11,40,1,1,0)
7068009^1^Abnormal Voice (SCT 38160000)^R49.9^38160000^64800019
"DATA",125.11,40,1,2,0)
7109935^2^Allergic Rhinitis (SCT 61582004)^J30.9^61582004^102311013
"DATA",125.11,40,1,3,0)
7153835^3^Chronic Rhinitis (SCT 86094006)^J31.0^86094006^142764012
"DATA",125.11,40,1,4,0)
7071375^4^Chronic Sinusitis (SCT 40055000)^J32.9^40055000^66718013
"DATA",125.11,40,1,5,0)
7217355^5^Deviated Nasal Septum (SCT 126660000)^J34.2^126660000^118500019
"DATA",125.11,40,1,6,0)
7583413^6^Dizziness (SCT 404640003)^R42.^404640003^2156535017
"DATA",125.11,40,1,7,0)
7072621^7^Dysphagia (SCT 40739000)^R13.10^40739000^67950018
"DATA",125.11,40,1,8,0)
7021909^8^Epistaxis (SCT 12441001)^R04.0^12441001^21406015
"DATA",125.11,40,1,9,0)
7666958^9^ETD - Eustachian Tube Dysfunction (SCT 56713002)^H69.90^56713002^1231637014
"DATA",125.11,40,1,10,0)
8176838^10^GERD - Gastro-Esophageal Reflux Disease (SCT 235595009)^K21.9^235595009^2535970019
"DATA",125.11,40,1,11,0)
7026781^11^Hearing Loss (SCT 15188001)^H91.90^15188001^25788011
"DATA",125.11,40,1,12,0)
7138477^12^Mixed Conductive and Sensorineural Hearing Loss (SCT 77507001)^H90.8^77507001^128669010
"DATA",125.11,40,1,13,0)
7108347^13^Sensorineural Hearing Loss (SCT 60700002)^H90.5^60700002^100850012
"DATA",125.11,40,1,14,0)
7285375^14^Sensorineural Hearing Loss,  Bilateral (SCT 194424005)^H90.3^194424005^299259014
"DATA",125.11,40,1,15,0)
8102188^15^Asymmetrical Sensorineural Hearing Loss (SCT 428887009)^H90.5^428887009^2692342018
"DATA",125.11,40,1,16,0)
7030853^16^Hypertrophy of Nasal Turbinates (SCT 17467004)^J34.3^17467004^29523013
"DATA",125.11,40,1,17,0)
7031933^17^Impacted Cerumen (SCT 18070006)^H61.20^18070006^30529014
"DATA",125.11,40,1,18,0)
7005355^18^Otitis Externa (SCT 3135009)^H60.90^3135009^6305018
"DATA",125.11,40,1,19,0)
7277129^19^Malignant Neoplasm of Head,  Neck and Face (SCT 188353002)^C76.0^188353002^289424013
"DATA",125.11,40,1,20,0)
7425757^20^Mass in Head or Neck (SCT 274751001)^R22.0/R22.1^274751001^410612011
"DATA",125.11,40,1,21,0)
7670766^21^Perforated Eardrum (SCT 60442001)^H72.90^60442001^1232089019
"DATA",125.11,40,1,22,0)
7108641^22^Tinnitus (SCT 60862001)^H93.19^60862001^101130017
"DATA",125.11,41,0)
VA-EMERGENCY DEPARTMENT^3171010^N
"DATA",125.11,41,1,0)
^125.111P^23^23
"DATA",125.11,41,1,1,0)
7038099^1^Abdominal Pain (SCT 21522001)^R10.9^21522001^36112013
"DATA",125.11,41,1,2,0)
7018503^2^Acute Bronchitis (SCT 10509002)^J20.9^10509002^18268014
"DATA",125.11,41,1,3,0)
7027861^3^Acute Sinusitis (SCT 15805002)^J01.90^15805002^26785019
"DATA",125.11,41,1,4,0)
7097165^4^Acute Upper Respiratory Infection (SCT 4398005)^J06.9^54398005^90415012
"DATA",125.11,41,1,5,0)
7045569^5^Alcohol Intoxication (SCT 25702006)^F10.129^25702006^43081018
"DATA",125.11,41,1,6,0)
7281289^6^Alcohol Withdrawal Syndrome (SCT 191480000)^F10.239^191480000^294674018
"DATA",125.11,41,1,7,0)
7086883^7^Anxiety (SCT 48694002)^F41.9^48694002^81133019
"DATA",125.11,41,1,8,0)
7886708^8^Backache (SCT 161891005)^M54.9^161891005^252311015
"DATA",125.11,41,1,9,0)
7219429^9^Cellulitis (SCT 128045006)^L03.90^128045006^474280013
"DATA",125.11,41,1,10,0)
7053027^10^Chest Pain (SCT 29857009)^R07.9^29857009^49966017
"DATA",125.11,41,1,11,0)
7651747^11^CHF - Congestive Heart Failure (SCT 42343007)^I50.9^42343007^493289014
"DATA",125.11,41,1,12,0)
7088747^12^Cough (SCT 49727002)^R05.^49727002^82824016
"DATA",125.11,41,1,13,0)
7060637^13^Dehydration (SCT 34095006)^E86.0^34095006^56942018
"DATA",125.11,41,1,14,0)
7111251^14^Diarrhea (SCT 62315008)^R19.7^62315008^103576018
"DATA",125.11,41,1,15,0)
7583413^15^Dizziness (SCT 404640003)^R42.^404640003^2156535017
"DATA",125.11,41,1,16,0)
7099435^16^Drug Overdose (SCT 55680006)^T50.901A^55680006^92561019
"DATA",125.11,41,1,17,0)
7044423^17^Headache (SCT 25064002)^R51.^25064002^41990019
"DATA",125.11,41,1,18,0)
7353673^18^Pneumonia (SCT 233604007)^J18.9^233604007^350049016
"DATA",125.11,41,1,19,0)
7123819^19^Psychotic Disorder (SCT 69322001)^F29.^69322001^115142010
"DATA",125.11,41,1,20,0)
7759635^20^SOB - Shortness of Breath (SCT 267036007)^R06.00^267036007^397889019
"DATA",125.11,41,1,21,0)
7414805^21^Suicidal (SCT 267073005)^R45.851^267073005^397957012
"DATA",125.11,41,1,22,0)
7492137^22^Syncope and Collapse (SCT 309585006)^R55.^309585006^453038013
"DATA",125.11,41,1,23,0)
7679240^23^UTI - Urinary Tract Infection (SCT 68566005)^N39.0^68566005^1233066018
"DATA",125.11,42,0)
VA-ENDO METAB EXCEPT DIABETES^3171010^N
"DATA",125.11,42,1,0)
^125.111P^19^19
"DATA",125.11,42,1,1,0)
7092379^1^Disorder Of Anterior Pituitary (SCT 51742006)^E23.7^51742006^86162019
"DATA",125.11,42,1,2,0)
8234552^2^Erectile Dysfunction (SCT 397803000)^N52.9^397803000^2955652011
"DATA",125.11,42,1,3,0)
7119539^3^Hypercalcemia (SCT 66931009)^E83.52^66931009^111167017
"DATA",125.11,42,1,4,0)
7119671^4^Hyperparathyroidism (SCT 66999008)^E21.3^66999008^111289013
"DATA",125.11,42,1,5,0)
7064739^5^Primary Hyperparathyroidism (SCT 36348003)^E21.0^36348003^60663012
"DATA",125.11,42,1,6,0)
7072959^6^Hypothyroidism (SCT 40930008)^E03.9^40930008^68268011
"DATA",125.11,42,1,7,0)
7047999^7^Postoperative Hypothyroidism (SCT 27059002)^E89.0^27059002^2532363015
"DATA",125.11,42,1,8,0)
7415239^8^Mixed Hyperlipidemia (SCT 267434003)^E78.2^267434003^398859011
"DATA",125.11,42,1,9,0)
7064541^9^Non-Toxic Multinodular Goiter (SCT 36241006)^E04.2^36241006^60489015
"DATA",125.11,42,1,10,0)
7279659^10^Non-Toxic Uninodular Goiter (SCT 190237002)^E04.1^190237002^292307019
"DATA",125.11,42,1,11,0)
7603305^11^Obesity (SCT 414916001)^E66.9^414916001^2535065012
"DATA",125.11,42,1,12,0)
7139129^12^Osteochondropathy (SCT 77881008)^M93.90^77881008^129246013
"DATA",125.11,42,1,13,0)
7115815^13^Osteoporosis (SCT 64859006)^M81.0^64859006^107806013
"DATA",125.11,42,1,14,0)
7722743^14^Pituitary Tumor (SCT 127024001)^D49.7^127024001^1217495012
"DATA",125.11,42,1,15,0)
7193535^15^Testicular Hypofunction (SCT 111551000)^E29.1^111551000^178795019
"DATA",125.11,42,1,16,0)
7790839^16^Thyroid Cancer (SCT 363478007)^C73.^363478007^1228592014
"DATA",125.11,42,1,17,0)
7162189^17^Thyrotoxicosis (SCT 90739004)^E05.90^90739004^150375010
"DATA",125.11,42,1,18,0)
7415131^18^Toxic Diffuse Goiter (SCT 267374005)^E05.00^267374005^398779013
"DATA",125.11,42,1,19,0)
7061753^19^Vitamin D Deficiency (SCT 34713006)^E55.9^34713006^57937016
"DATA",125.11,43,0)
VA-GASTROENTEROLOGY^3171010^N
"DATA",125.11,43,1,0)
^125.111P^22^22
"DATA",125.11,43,1,1,0)
7038099^1^Abdominal Pain (SCT 21522001)^R10.9^21522001^36112013
"DATA",125.11,43,1,2,0)
7420143^2^Anemia (SCT 271737000)^D64.9^271737000^406636013
"DATA",125.11,43,1,3,0)
7156381^3^Iron Deficiency Anemia (SCT 87522002)^D50.9^87522002^145104011
"DATA",125.11,43,1,4,0)
7480053^4^Barrett's Esophagus (SCT 302914006)^K22.70^302914006^444920013
"DATA",125.11,43,1,5,0)
7164633^5^Benign Neoplasm Of Colon (SCT 92065004)^D12.6^92065004^152477010
"DATA",125.11,43,1,6,0)
7219877^6^Chronic Hepatitis C (SCT 128302006)^B18.2^128302006^206586011
"DATA",125.11,43,1,7,0)
7142463^7^Chronic Nonalcoholic Liver Disease (SCT 79720007)^K76.9^79720007^132267018
"DATA",125.11,43,1,8,0)
7035275^8^Cirrhosis Of Liver (SCT 19943007)^K74.60^19943007^33568015
"DATA",125.11,43,1,9,0)
7026025^9^Constipation (SCT 14760008)^K59.00^14760008^25076018
"DATA",125.11,43,1,10,0)
7060469^10^Crohn's Disease (SCT 34000006)^K50.90^34000006^56765016
"DATA",125.11,43,1,11,0)
7111251^11^Diarrhea (SCT 62315008)^R19.7^62315008^103576018
"DATA",125.11,43,1,12,0)
7805557^12^Diverticulosis Of Colon (SCT 398050005)^K57.30^398050005^1786076019
"DATA",125.11,43,1,13,0)
7072621^13^Dysphagia (SCT 40739000)^R13.10^40739000^67950018
"DATA",125.11,43,1,14,0)
8176838^14^GERD - Gastro-Esophageal Reflux Disease (SCT 235595009)^K21.9^235595009^2535970019
"DATA",125.11,43,1,15,0)
7585571^15^Hematochezia (SCT 405729008)^K92.1^405729008^2155014017
"DATA",125.11,43,1,16,0)
7414103^16^Hemorrhage Of Rectum And Anus (SCT 266464001)^K62.5^266464001^396383019
"DATA",125.11,43,1,17,0)
7619464^17^IBS - Irritable Bowel Syndrome (SCT 10743008)^K58.9^10743008^1219342015
"DATA",125.11,43,1,18,0)
7289249^18^Irritable Bowel Syndrome With Diarrhea (SCT 197125005)^K58.0^197125005^303173017
"DATA",125.11,43,1,19,0)
7243315^19^Liver Function Tests Abnormal (SCT 166603001)^R94.5^166603001^258893017
"DATA",125.11,43,1,20,0)
8195874^20^Nash - Nonalcoholic Steatohepatitis (SCT 442685003)^K75.81^442685003^2819665012
"DATA",125.11,43,1,21,0)
7603305^21^Obesity (SCT 414916001)^E66.9^414916001^2535065012
"DATA",125.11,43,1,22,0)
7115653^22^Ulcerative Colitis (SCT 64766004)^K51.90^64766004^107644019
"DATA",125.11,44,0)
VA-GENERAL SURGERY^3171010^N
"DATA",125.11,44,1,0)
^125.111P^22^22
"DATA",125.11,44,1,1,0)
7038099^1^Abdominal Pain (SCT 21522001)^R10.9^21522001^36112013
"DATA",125.11,44,1,2,0)
7219429^2^Cellulitis (SCT 128045006)^L03.90^128045006^474280013
"DATA",125.11,44,1,3,0)
7045963^3^Calculus of Gallbladder With Cholecystitis (SCT 25924004)^K80.10^25924004^43438012
"DATA",125.11,44,1,4,0)
7035323^4^Cholecystitis Without Calculus (SCT 19968009)^K81.9^19968009^33615015
"DATA",125.11,44,1,5,0)
8176838^5^GERD - Gastro-Esophageal Reflux Disease (SCT 235595009)^K21.9^235595009^2535970019
"DATA",125.11,44,1,6,0)
8117610^6^Gastroesophageal Reflux Disease Without Esophagitis (SCT 266435005)^K21.9^266435005^2773407016
"DATA",125.11,44,1,7,0)
7414057^7^Gastro-Esophageal Reflux Disease With Esophagitis (SCT 266433003)^K21.0^266433003^396337013
"DATA",125.11,44,1,8,0)
7358023^8^Gallstone (SCT 235919008)^K80.20^235919008^353661012
"DATA",125.11,44,1,9,0)
7710990^9^Groin Pain (SCT 102570003)^R10.2^102570003^165874019
"DATA",125.11,44,1,10,0)
7093355^10^Unilateral Inguinal Hernia (SCT 52278004)^K40.90^52278004^86990016
"DATA",125.11,44,1,11,0)
7152761^11^Bilateral Inguinal Hernia (SCT 85502002)^K40.20^85502002^141720018
"DATA",125.11,44,1,12,0)
7358241^12^Incisional Hernia (SCT 236037000)^K43.2^236037000^353815010
"DATA",125.11,44,1,13,0)
7567231^13^Umbilical Hernia (SCT 396347007)^K42.9^396347007^1776299016
"DATA",125.11,44,1,14,0)
7814234^14^Ventral Hernia (SCT 414396006)^K43.9^414396006^2536953015
"DATA",125.11,44,1,15,0)
8230307^15^Polyp Colon (SCT 68496003)^K63.5^68496003^2920839016
"DATA",125.11,44,1,16,0)
7193233^16^Diverticulitis of Colon (SCT 111359004)^K57.32^111359004^178595017
"DATA",125.11,44,1,17,0)
7790718^17^Cancer of Colon (SCT 363406005)^C18.9^363406005^1228536014
"DATA",125.11,44,1,18,0)
7125299^18^Hemorrhoids (SCT 70153002)^K64.9^70153002^116509010
"DATA",125.11,44,1,19,0)
7161667^19^Internal Hemorrhoids (SCT 90458007)^K64.8^90458007^149919015
"DATA",125.11,44,1,20,0)
7704425^20^Lipoma (SCT 93163002)^D17.9^93163002^510227014
"DATA",125.11,44,1,21,0)
7961420^21^Sebaceous Cyst (SCT 419603000)^L72.3^419603000^2580186011
"DATA",125.11,44,1,22,0)
7144129^22^Disorder of Skin and/or Subcutaneous Tissue (SCT 80659006)^L98.9^80659006^2474928016
"DATA",125.11,49,0)
VA-GYNECOLOGY^3171010^N
"DATA",125.11,49,1,0)
^125.111P^19^19
"DATA",125.11,49,1,1,0)
7038099^1^Abdominal Pain (SCT 21522001)^R10.9^21522001^36112013
"DATA",125.11,49,1,2,0)
8123082^2^Abnormal Cervical Papanicolaou Smear (SCT 439888000)^R87.619^439888000^2790920019
"DATA",125.11,49,1,3,0)
8195681^3^Abnormal Cervical Papanicolaou Smear with Positive Human Papillomavirus Deoxyribonucleic Acid (DNA) Test (SCT 441667007)^R87.619^441667007^2816704015
"DATA",125.11,49,1,4,0)
7800163^4^Abnormal Menstruation (SCT 386804004)^N92.6^386804004^2536534017
"DATA",125.11,49,1,5,0)
7093647^5^Atrophic Vaginitis (SCT 52441000)^N95.2^52441000^87266015
"DATA",125.11,49,1,6,0)
7159327^6^Breast Lump (SCT 89164003)^N63.0^89164003^508381015
"DATA",125.11,49,1,7,0)
7033853^7^Dysfunctional Uterine Bleeding (SCT 19155002)^N93.8^19155002^32278010
"DATA",125.11,49,1,8,0)
7414233^8^Dysmenorrhea (SCT 266599000)^N94.6^266599000^396782010
"DATA",125.11,49,1,9,0)
7414235^9^Excessive and Frequent Menstruation (SCT 266601003)^N92.0^266601003^396785012
"DATA",125.11,49,1,10,0)
7011833^10^Female Infertility (SCT 6738008)^N97.9^6738008^12167015
"DATA",125.11,49,1,11,0)
8162838^11^Female Urinary Stress Incontinence (SCT 60241006)^N39.3^60241006^2671390018
"DATA",125.11,49,1,12,0)
7143267^12^Irregular Periods (SCT 80182007)^N92.6^80182007^133036018
"DATA",125.11,49,1,13,0)
7038597^13^Menopausal Symptom (SCT 21801002)^N95.1^21801002^36581019
"DATA",125.11,49,1,14,0)
7690861^14^Ovarian Cyst (SCT 79883001)^N83.209^79883001^132536019
"DATA",125.11,49,1,15,0)
7146001^15^Pain in Female Genitalia on Intercourse (SCT 81712001)^N94.19^81712001^504773014
"DATA",125.11,49,1,16,0)
7124811^16^Polycystic Ovaries (SCT 69878008)^E28.2^69878008^116049013
"DATA",125.11,49,1,17,0)
7137073^17^Postmenopausal Bleeding (SCT 76742009)^N95.0^76742009^127423017
"DATA",125.11,49,1,18,0)
7707128^18^Uterine Fibroid (SCT 95315005)^D25.9^95315005^512054010
"DATA",125.11,49,1,19,0)
7290837^19^Vaginitis and Vulvovaginitis (SCT 198212006)^N76.0^198212006^304741012
"DATA",125.11,50,0)
VA-HEMATOLOGY^3171010^N
"DATA",125.11,50,1,0)
^125.111P^21^21
"DATA",125.11,50,1,1,0)
7420143^1^Anemia (SCT 271737000)^D64.9^271737000^406636013
"DATA",125.11,50,1,2,0)
7485765^2^Aplastic Anemia (SCT 306058006)^D61.9^306058006^448864010
"DATA",125.11,50,1,3,0)
7156381^3^Iron Deficiency Anemia (SCT 87522002)^D50.9^87522002^145104011
"DATA",125.11,50,1,4,0)
7705540^4^Bony Metastasis (SCT 94222008)^C79.51^94222008^1235816014
"DATA",125.11,50,1,5,0)
7790718^5^Cancer Of Colon (SCT 363406005)^C18.9^363406005^1228536014
"DATA",125.11,50,1,6,0)
7704049^6^CLL - Chronic Lymphocytic Leukemia (SCT 92814006)^C91.90^92814006^1218765019
"DATA",125.11,50,1,7,0)
8222649^7^Acute Deep Vein Thrombosis Of Lower Limb (SCT 651000119108)^I82.409^651000119108^2967724010
"DATA",125.11,50,1,8,0)
8224599^8^Chronic Deep Venous Thrombosis Of Lower Extremity (SCT 132141000119106)^I82.509^132141000119106^2984377018
"DATA",125.11,50,1,9,0)
7236251^9^H/O: Deep Vein Thrombosis (SCT 161508001)^Z86.718^161508001^2547692019
"DATA",125.11,50,1,10,0)
8224657^10^Chronic Pulmonary Embolism (SCT 133971000119108)^I27.82^133971000119108^2968248015
"DATA",125.11,50,1,11,0)
7236259^11^H/O: Pulmonary Embolus (SCT 161512007)^Z86.711^161512007^251693011
"DATA",125.11,50,1,12,0)
7151559^12^Leukopenia (SCT 84828003)^D72.819^84828003^140635015
"DATA",125.11,50,1,13,0)
7415251^13^Monoclonal Paraproteinemia (SCT 267440005)^D47.2^267440005^398874013
"DATA",125.11,50,1,14,0)
7190663^14^Multiple Myeloma (SCT 109989006)^C90.00^109989006^344820010
"DATA",125.11,50,1,15,0)
8167779^15^Myelodysplastic Syndrome (SCT 109995007)^D46.9^109995007^2659757019
"DATA",125.11,50,1,16,0)
7603697^16^Plasmacytoma (SCT 415112005)^C90.30^415112005^2534490012
"DATA",125.11,50,1,17,0)
8306669^17^Prostate Cancer (SCT 254900004)^C61.^254900004^3036967016
"DATA",125.11,50,1,18,0)
7358939^18^Renal Impairment (SCT 236423003)^N28.9^236423003^354406016
"DATA",125.11,50,1,19,0)
7079971^19^Secondary Polycythemia (SCT 44865000)^D75.1^44865000^178835014
"DATA",125.11,50,1,20,0)
7771877^20^Thrombocytopenia (SCT 302215000)^D69.6^302215000^1227080015
"DATA",125.11,50,1,21,0)
7096631^21^White Blood Cell Disorder (SCT 54097007)^D72.9^54097007^89916012
"DATA",125.11,51,0)
VA-INFECTIOUS DISEASE^3171010^N
"DATA",125.11,51,1,0)
^125.111P^19^19
"DATA",125.11,51,1,1,0)
7420143^1^Anemia (SCT 271737000)^D64.9^271737000^406636013
"DATA",125.11,51,1,2,0)
7010077^2^Bacteremia (SCT 5758002)^R78.81^5758002^10590012
"DATA",125.11,51,1,3,0)
7219429^3^Cellulitis (SCT 128045006)^L03.90^128045006^474280013
"DATA",125.11,51,1,4,0)
8280723^4^Chronic Kidney Disease (SCT 709044004)^N18.9^709044004^3036750018
"DATA",125.11,51,1,5,0)
7035275^5^Cirrhosis of Liver (SCT 19943007)^K74.60^19943007^33568015
"DATA",125.11,51,1,6,0)
7111251^6^Diarrhea (SCT 62315008)^R19.7^62315008^103576018
"DATA",125.11,51,1,7,0)
7555873^7^Fever (SCT 386661006)^R50.9^386661006^1480803010
"DATA",125.11,51,1,8,0)
7707190^8^Foot Ulcer (SCT 95345008)^L97.909^95345008^512081010
"DATA",125.11,51,1,9,0)
7672430^9^Chronic Viral Hepatitis B (SCT 61977001)^B18.1^61977001^1232261014
"DATA",125.11,51,1,10,0)
7501361^10^Hepatitis C Antibody Test Positive (SCT 314706002)^R76.0^314706002^459095018
"DATA",125.11,51,1,11,0)
7357925^11^Acute hepatitis C (SCT 235866006)^B17.10^235866006^353576014
"DATA",125.11,51,1,12,0)
7219877^12^Chronic Hepatitis C (SCT 128302006)^B18.2^128302006^206586011
"DATA",125.11,51,1,13,0)
7697613^13^HIV - Human Immunodeficiency Virus Infection (SCT 86406008)^B20.^86406008^1235134011
"DATA",125.11,51,1,14,0)
8274257^14^MRSA (Methicillin resistant Staphylococcus aureus) Infection (SCT 266096002)^A49.02^266096002^3015382018
"DATA",125.11,51,1,15,0)
8128571^15^Nonspecific Tuberculin Test Reaction (SCT 441846005)^R76.11^441846005^2818013016
"DATA",125.11,51,1,16,0)
7107413^16^Osteomyelitis (SCT 60168000)^M86.9^60168000^99949018
"DATA",125.11,51,1,17,0)
7353673^17^Pneumonia (SCT 233604007)^J18.9^233604007^350049016
"DATA",125.11,51,1,18,0)
7807291^18^PVD-Peripheral Vascular Disease (SCT 400047006)^I73.9^400047006^2162392019
"DATA",125.11,51,1,19,0)
7679240^19^UTI - Urinary Tract Infection (SCT 68566005)^N39.0^68566005^1233066018
"DATA",125.11,52,0)
VA-MENTAL HEALTH^3171010^N
"DATA",125.11,52,1,0)
^125.111P^29^29
"DATA",125.11,52,1,1,0)
7120003^1^Acute Stress Disorder (SCT 67195008)^F43.0^67195008^111640012
"DATA",125.11,52,1,2,0)
7099413^2^Adjustment Disorder with Mixed Emotional Features (SCT 55668003)^F43.23^55668003^92542018
"DATA",125.11,52,1,3,0)
7026741^3^Alcohol Abuse (SCT 15167005)^F10.10^15167005^25750014
"DATA",125.11,52,1,4,0)
7118927^4^Alcohol Dependence (SCT 66590003)^F10.20^66590003^110628016
"DATA",125.11,52,1,5,0)
7281811^5^Chronic Alcoholism in Remission (SCT 191813001)^F10.21^191813001^295142015
"DATA",125.11,52,1,6,0)
7281937^6^Nondependent Alcohol Abuse in Remission (SCT 191884001)^F10.10^191884001^295254011
"DATA",125.11,52,1,7,0)
7086883^7^Anxiety (SCT 48694002)^F41.9^48694002^81133019
"DATA",125.11,52,1,8,0)
7038771^8^Generalized Anxiety Disorder (SCT 21897009)^F41.1^21897009^36731013
"DATA",125.11,52,1,9,0)
7542545^9^Bipolar I Disorder (SCT 371596008)^F31.9^371596008^1210225015
"DATA",125.11,52,1,10,0)
7148703^10^Bipolar II Disorder (SCT 83225003)^F31.81^83225003^138029017
"DATA",125.11,52,1,11,0)
7281951^11^Nondependent Cannabis Abuse (SCT 191891003)^F12.10^191891003^295261010
"DATA",125.11,52,1,12,0)
7056823^12^Cocaine Dependence (SCT 31956009)^F14.20^31956009^53398019
"DATA",125.11,52,1,13,0)
7644549^13^Depression (SCT 35489007)^F32.9^35489007^486184015
"DATA",125.11,52,1,14,0)
7065783^14^Major Depression, Single Episode (SCT 36923009)^F32.9^36923009^61590015
"DATA",125.11,52,1,15,0)
7118483^15^Recurrent Major Depression (SCT 66344007)^F33.9^66344007^110183011
"DATA",125.11,52,1,16,0)
7033271^16^Moderate Recurrent Major Depression (SCT 18818009)^F33.1^18818009^31734016
"DATA",125.11,52,1,17,0)
7064971^17^Severe Recurrent Major Depression Without Psychotic Features (SCT 36474008)^F33.2^36474008^60885016
"DATA",125.11,52,1,18,0)
7140557^18^Dysthymia (SCT 78667006)^F34.1^78667006^130532011
"DATA",125.11,52,1,19,0)
7009795^19^Opioid Abuse (SCT 5602001)^F11.10^5602001^10350013
"DATA",125.11,52,1,20,0)
7134915^20^Opioid Dependence (SCT 75544000)^F11.20^75544000^125472011
"DATA",125.11,52,1,21,0)
7155693^21^Opioid Withdrawal (SCT 87132004)^F11.93^87132004^144489015
"DATA",125.11,52,1,22,0)
8224937^22^History of Opioid Abuse (SCT 288831000119100)^F11.10^288831000119100^2310581000119114
"DATA",125.11,52,1,23,0)
7679973^23^Psychosis (SCT 69322001)^F29.^69322001^115146013
"DATA",125.11,52,1,24,0)
7657192^24^PTSD - Post-Traumatic Stress Disorder (SCT 47505003)^F43.10^47505003^494849017
"DATA",125.11,52,1,25,0)
7123043^25^Schizoaffective Disorder (SCT 68890003)^F25.9^68890003^114425016
"DATA",125.11,52,1,26,0)
7118251^26^Substance Abuse (SCT 66214007)^F19.10^66214007^109958011
"DATA",125.11,52,1,27,0)
7236199^27^H/O: Attempted Suicide (SCT 161474000)^Z91.5^161474000^251636018
"DATA",125.11,52,1,28,0)
7501055^28^H/O: Deliberate Self Harm (SCT 314550003)^Z91.5^314550003^458925017
"DATA",125.11,52,1,29,0)
7011371^29^Suicidal Thoughts (SCT 6471006)^R45.851^6471006^499928015
"DATA",125.11,53,0)
VA-NEUROLOGY^3171010^N
"DATA",125.11,53,1,0)
^125.111P^20^20
"DATA",125.11,53,1,1,0)
8130513^1^Abnormal Gait (SCT 22325002)^R26.9^22325002^37486015
"DATA",125.11,53,1,2,0)
7404229^2^Abnormal Involuntary Movement (SCT 260912008)^R25.9^260912008^388569010
"DATA",125.11,53,1,3,0)
7102523^3^Carpal Tunnel Syndrome (SCT 57406009)^G56.00^57406009^95473010
"DATA",125.11,53,1,4,0)
7583413^4^Dizziness (SCT 404640003)^R42.^404640003^2156535017
"DATA",125.11,53,1,5,0)
7151429^5^Epilepsy (SCT 84757009)^G40.909^84757009^178739011
"DATA",125.11,53,1,6,0)
7044423^6^Headache (SCT 25064002)^R51.^25064002^41990019
"DATA",125.11,53,1,7,0)
7570595^7^Tension-Type Headache (SCT 398057008)^G44.209^398057008^1777627014
"DATA",125.11,53,1,8,0)
7007751^8^Migraine with Aura (SCT 4473006)^G43.109^4473006^7595017
"DATA",125.11,53,1,9,0)
7100189^9^Migraine without Aura (SCT 56097005)^G43.009^56097005^93294013
"DATA",125.11,53,1,10,0)
7057973^10^Mononeuritis (SCT 32595002)^G58.9^32595002^54416010
"DATA",125.11,53,1,11,0)
7633378^11^MS - Multiple Sclerosis (SCT 24700007)^G35.^24700007^1223980016
"DATA",125.11,53,1,12,0)
7145949^12^Neck Pain (SCT 81680005)^M54.2^81680005^135489010
"DATA",125.11,53,1,13,0)
8285386^13^Neurocognitive Disorder (SCT 709073001)^F09.^709073001^3037963010
"DATA",125.11,53,1,14,0)
8297924^14^Neuropathy Due to Type 2 Diabetes Mellitus (SCT 368581000119106)^E11.40^368581000119106^3286868011
"DATA",125.11,53,1,15,0)
7283617^15^Hereditary and Idiopathic Peripheral Neuropathy (SCT 193157005)^G60.9^193157005^297511018
"DATA",125.11,53,1,16,0)
7087509^16^Parkinson's Disease (SCT 49049000)^G20.^49049000^81717011
"DATA",125.11,53,1,17,0)
7162973^17^Seizure (SCT 91175000)^R56.9^91175000^151074011
"DATA",125.11,53,1,18,0)
7144581^18^Skin Sensation Disturbance (SCT 80910005)^R20.9^80910005^504547018
"DATA",125.11,53,1,19,0)
7762506^19^H/O: Stroke (SCT 275526006)^Z86.73^275526006^2476091017
"DATA",125.11,53,1,20,0)
7046237^20^Tremor (SCT 26079004)^R25.1^26079004^43694015
"DATA",125.11,54,0)
VA-NEUROSURGERY^3171010^N
"DATA",125.11,54,1,0)
^125.111P^22^22
"DATA",125.11,54,1,1,0)
8172957^1^Back Pain (SCT 161891005)^M54.9^161891005^2646370015
"DATA",125.11,54,1,2,0)
7130225^2^Brachial Neuritis (SCT 121077018)^M54.10^72893007^121077018
"DATA",125.11,54,1,3,0)
7102523^3^Carpal Tunnel Syndrome (SCT 57406009)^G56.00^57406009^95473010
"DATA",125.11,54,1,4,0)
7097173^4^Cervical Radiculopathy (SCT 54404000)^M54.12^54404000^198517017
"DATA",125.11,54,1,5,0)
7694716^5^Cervical Spinal Stenosis (SCT 83561009)^M48.02^83561009^138588018
"DATA",125.11,54,1,6,0)
7116513^6^Cervical Spondylosis with Myelopathy (SCT 65260001)^M47.12^65260001^108431018
"DATA",125.11,54,1,7,0)
7415847^7^Cervical Spondylosis without Myelopathy (SCT 267970006)^M47.812^267970006^400267013
"DATA",125.11,54,1,8,0)
7123591^8^Degeneration of Cervical Intervertebral Disc (SCT 69195002)^M50.30^69195002^114931012
"DATA",125.11,54,1,9,0)
7047059^9^Degeneration of Lumbar Intervertebral Disc (SCT 26538006)^M51.36^26538006^44436017
"DATA",125.11,54,1,10,0)
7108779^10^Degeneration of Lumbosacral Intervertebral Disc (SCT 60937000)^M51.37^60937000^101247013
"DATA",125.11,54,1,11,0)
7152263^11^Displacement of Cervical Intervertebral Disc without Myelopathy (SCT 85216006)^M50.20^85216006^141276013
"DATA",125.11,54,1,12,0)
7035419^12^Displacement of Lumbar Intervertebral Disc without Myelopathy (SCT 20021007)^M51.26^20021007^33702015
"DATA",125.11,54,1,13,0)
7134773^13^Intervertebral Disc Disorder of Cervical Region with Myelopathy (SCT 75467001)^M50.00^75467001^125342018
"DATA",125.11,54,1,14,0)
7534685^14^Lesion of Ulnar Nerve (SCT 367475009)^G56.20^367475009^492283017
"DATA",125.11,54,1,15,0)
7004075^15^Lumbosacral Radiculopathy (SCT 2415007)^M54.17^2415007^5134010
"DATA",125.11,54,1,16,0)
7086017^16^Lumbosacral Spondylosis without Myelopathy (SCT 48210000)^M47.817^48210000^80324016
"DATA",125.11,54,1,17,0)
7145949^17^Neck Pain (SCT 81680005)^M54.2^81680005^135489010
"DATA",125.11,54,1,18,0)
7480325^18^Neurogenic Claudication (SCT 303081002)^G96.8^303081002^445146016
"DATA",125.11,54,1,19,0)
7162365^19^Pain in Limb (SCT 90834002)^M79.609^90834002^150521017
"DATA",125.11,54,1,20,0)
7144581^20^Skin Sensation Disturbance (SCT 80910005)^R20.9^80910005^504547018
"DATA",125.11,54,1,21,0)
7032453^21^Spinal Stenosis of Lumbar Region (SCT 18347007)^M48.061^18347007^30977016
"DATA",125.11,54,1,22,0)
7298059^22^Thoracic and Lumbosacral Neuritis (SCT 202796002)^M54.14/M54.17^202796002^311256011
"DATA",125.11,55,0)
VA-ONCOLOGY^3171010^N
"DATA",125.11,55,1,0)
^125.111P^21^21
"DATA",125.11,55,1,1,0)
7420143^1^Anemia (SCT 271737000)^D64.9^271737000^406636013
"DATA",125.11,55,1,2,0)
7156381^2^Iron Deficiency Anemia (SCT 87522002)^D50.9^87522002^145104011
"DATA",125.11,55,1,3,0)
7705540^3^Bony Metastasis (SCT 94222008)^C79.51^94222008^1235816014
"DATA",125.11,55,1,4,0)
8307106^4^Female Breast Cancer (SCT 372064008)^C50.919^372064008^3036010011
"DATA",125.11,55,1,5,0)
7790718^5^Cancer of Colon (SCT  363406005)^C18.9^363406005^1228536014
"DATA",125.11,55,1,6,0)
7704049^6^CLL - Chronic Lymphocytic Leukemia (SCT 92814006)^C91.90^92814006^1218765019
"DATA",125.11,55,1,7,0)
7705130^7^Liver Cancer (SCT 93870000)^C22.9^93870000^510773010
"DATA",125.11,55,1,8,0)
7705845^8^Metastasis to Liver (SCT 94381002)^C78.7^94381002^511275014
"DATA",125.11,55,1,9,0)
7189541^9^Overlapping Malignant Neoplasm of Bronchus and Lung (SCT 109371002)^C34.80^109371002^173925017
"DATA",125.11,55,1,10,0)
7704985^10^Primary Bronchial Cancer (SCT 93734005)^C34.90^93734005^1235802016
"DATA",125.11,55,1,11,0)
8305145^11^Lung Cancer (SCT 93880001)^C34.90^93880001^3288586014
"DATA",125.11,55,1,12,0)
7705869^12^Pulmonary Metastasis (SCT 94391008)^C78.00^94391008^1235838011
"DATA",125.11,55,1,13,0)
7722421^13^Tumor of Lung (SCT 126713003)^D49.1^126713003^473789015
"DATA",125.11,55,1,14,0)
7415251^14^Monoclonal Paraproteinemia (SCT 267440005)^D47.2^267440005^398874013
"DATA",125.11,55,1,15,0)
7190663^15^Multiple Myeloma (SCT 109989006)^C90.00^109989006^344820010
"DATA",125.11,55,1,16,0)
7079971^16^Secondary Polycythemia (SCT 44865000)^D75.1^44865000^178835014
"DATA",125.11,55,1,17,0)
8306669^17^Prostate Cancer (SCT 254900004)^C61.^254900004^3036967016
"DATA",125.11,55,1,18,0)
7790573^18^Rectal Cancer (SCT 63351006)^C20.^363351006^1228486017
"DATA",125.11,55,1,19,0)
8233802^19^Renal Cancer (SCT 363518003)^C64.9^363518003^2990214011
"DATA",125.11,55,1,20,0)
7771877^20^Thrombocytopenia (SCT 302215000)^D69.6^302215000^1227080015
"DATA",125.11,55,1,21,0)
7096631^21^White Blood Cell Disorder (SCT 54097007)^D72.9^54097007^89916012
"DATA",125.11,56,0)
VA-OPHTHALMOLOGY^3171010^N
"DATA",125.11,56,1,0)
^125.111P^24^24
"DATA",125.11,56,1,1,0)
7415553^1^Age Related Macular Degeneration (SCT 267718000)^H35.30^267718000^399670012
"DATA",125.11,56,1,2,0)
7073897^2^Blepharitis (SCT 1446000)^H01.009^41446000^69126011
"DATA",125.11,56,1,3,0)
7040649^3^Blindness of One Eye (SCT 22950006)^H54.40^22950006^38553019
"DATA",125.11,56,1,4,0)
7284377^4^Blindness - Both Eyes (SCT 193699007)^H54.3^193699007^298251016
"DATA",125.11,56,1,5,0)
7117771^5^Legal blindness (SCT 65956007)^H54.8^65956007^109538018
"DATA",125.11,56,1,6,0)
7284201^6^Cataract (SCT 93570009)^H26.9^193570009^298076010
"DATA",125.11,56,1,7,0)
7655742^7^Dry eye syndrome (SCT 46152009)^H04.129^46152009^76953011
"DATA",125.11,56,1,8,0)
7498203^8^Diabetic Macular Edema (SCT 312912001)^E11.311^312912001^456716010
"DATA",125.11,56,1,9,0)
8233585^9^Mild Nonproliferative Diabetic Retinopathy (SCT 312903003)^E11.3299^312903003^2921114017
"DATA",125.11,56,1,10,0)
7498187^10^Moderate Nonproliferative Diabetic Retinopathy (SCT 312904009)^E11.3399^312904009^1775724010
"DATA",125.11,56,1,11,0)
7498189^11^Severe Nonproliferative Diabetic Retinopathy (SCT 312905005)^E11.3499^312905005^1775725011
"DATA",125.11,56,1,12,0)
7105825^12^Proliferative Diabetic Retinopathy (SCT 59276001)^E11.3599^59276001^98476015
"DATA",125.11,56,1,13,0)
7350771^13^Glaucoma Suspect (SCT 232079008)^H40.009^232079008^347743016
"DATA",125.11,56,1,14,0)
7137681^14^Primary Open Angle Glaucoma (SCT 77075001)^H40.1190^77075001^127956010
"DATA",125.11,56,1,15,0)
8302667^15^Narrow Angle Glaucoma of Left Eye (SCT 15736761000119101)^H40.20X0^15736761000119101^721231000124111
"DATA",125.11,56,1,16,0)
8302665^16^Narrow-Angle Glaucoma of Right Eye (SCT 15736681000119100)^H40.20X0^15736681000119100^721211000124117
"DATA",125.11,56,1,17,0)
7007277^17^Ocular Hypertension (SCT 4210003)^H40.059^4210003^8093016
"DATA",125.11,56,1,18,0)
7170567^18^Pseudophakia (SCT 95217000)^Z96.1^95217000^157735015
"DATA",125.11,56,1,19,0)
7020997^19^Ptosis of Eyelid (SCT 11934000)^H02.409^11934000^20576010
"DATA",125.11,56,1,20,0)
7128827^20^Disorder of Refraction and/or Accommodation (SCT 2128008)^H52.7^72128008^119863019
"DATA",125.11,56,1,21,0)
8223911^21^History of Repair of Retina for Retinal Detachment (SCT 65381000119107)^Z98.890^65381000119107^2989799010
"DATA",125.11,56,1,22,0)
7236219^22^H/O: Retinal Detachment (SCT 161487006)^Z86.69^161487006^251652015
"DATA",125.11,56,1,23,0)
7220185^23^Uveitis (SCT 128473001)^H20.9^128473001^206795017
"DATA",125.11,56,1,24,0)
7107449^24^Vitreous Degeneration (SCT C60189009)^H43.819^60189009^99979013
"DATA",125.11,57,0)
VA-ORTHOPEDICS^3171010^N
"DATA",125.11,57,1,0)
^125.111P^15^15
"DATA",125.11,57,1,1,0)
7102523^1^Carpal Tunnel Syndrome (SCT 57406009)^G56.00^57406009^95473010
"DATA",125.11,57,1,2,0)
7064225^2^Chondromalacia of Patella (SCT 36071006)^M22.40^36071006^60194013
"DATA",125.11,57,1,3,0)
7147055^3^Degenerative Joint Disease of Ankle and/or Foot (SCT 82300000)^M19.079^82300000^136512016
"DATA",125.11,57,1,4,0)
8129371^4^Disorder of Joint of Ankle and/or Foot (SCT 442246002)^M25.879^442246002^2819642019
"DATA",125.11,57,1,5,0)
8146457^5^Degenerative Joint Disease of Pelvis (SCT 445478004)^M16.9^445478004^2871421010
"DATA",125.11,57,1,6,0)
7120227^6^Degenerative Joint Disease of Shoulder Region (SCT 67315001)^M19.019^67315001^111849010
"DATA",125.11,57,1,7,0)
8169249^7^Disorder of Shoulder Region (SCT 118944007)^M25.819^118944007^2663223019
"DATA",125.11,57,1,8,0)
7085513^8^Foot Pain (SCT 47933007)^M79.673^47933007^494960013
"DATA",125.11,57,1,9,0)
7055083^9^Knee Pain (SCT 30989003)^M25.569^30989003^51875014
"DATA",125.11,57,1,10,0)
7674190^10^Internal Derangement of Knee Joint (SCT 63643000)^M23.90^63643000^1232487012
"DATA",125.11,57,1,11,0)
7365253^11^Osteoarthritis of Knee (SCT 239873007)^M17.9^239873007^359420013
"DATA",125.11,57,1,12,0)
7567087^12^Osteoarthritis (SCT 396275006)^M19.90^396275006^1776248011
"DATA",125.11,57,1,13,0)
7612877^13^Rotator Cuff Tear (SCT 4106009)^M75.100^4106009^1229713013
"DATA",125.11,57,1,14,0)
7736169^14^Complete Rupture of Rotator Cuff (SCT 202843000)^M75.120^202843000^2535869019
"DATA",125.11,57,1,15,0)
8289372^15^Trigger Finger (SCT 448251000124102)^M65.30^448251000124102^697461000124114
"DATA",125.11,58,0)
VA-PAIN^3171010^N
"DATA",125.11,58,1,0)
^125.111P^31^31
"DATA",125.11,58,1,1,0)
7130225^1^Brachial Neuritis (SCT 72893007)^G54.0^72893007^121077018
"DATA",125.11,58,1,2,0)
7297875^2^Cervical Spondylosis With Radiculopathy (SCT 202683005)^M47.22^202683005^311091014
"DATA",125.11,58,1,3,0)
7415847^3^Cervical Spondylosis Without Myelopathy (SCT 267970006)^M47.812^267970006^400267013
"DATA",125.11,58,1,4,0)
8109893^4^Chronic Pain Due to Injury (SCT 431481001)^G89.21^431481001^2769112019
"DATA",125.11,58,1,5,0)
7546467^5^Chronic Pain Syndrome (SCT 373621006)^G89.4^373621006^1212086019
"DATA",125.11,58,1,6,0)
8224559^6^Chronic Pain in Coccyx for More Than Three Months (SCT 129511000119105)^M53.3/G89.29^129511000119105^2967558017
"DATA",125.11,58,1,7,0)
7643799^7^Coccydynia (SCT 34789001)^M53.3^34789001^58060012
"DATA",125.11,58,1,8,0)
7660534^8^CRPS - Complex Regional Pain Syndrome Type I (SCT 50642008)^G90.50^50642008^495736014
"DATA",125.11,58,1,9,0)
7811491^9^CRPS - Complex Regional Pain Syndrome Type II (SCT 408751001)^G56.40^408751001^2477179018
"DATA",125.11,58,1,10,0)
7123591^10^Degeneration of Cervical Intervertebral Disc (SCT 69195002)^M50.30^69195002^114931012
"DATA",125.11,58,1,11,0)
7122687^11^Degeneration of Thoracic Intervertebral Disc (SCT 68675004)^M51.34^68675004^114066012
"DATA",125.11,58,1,12,0)
7047059^12^Degeneration of Lumbar Intervertebral Disc (SCT 26538006)^M51.36^26538006^44436017
"DATA",125.11,58,1,13,0)
7108779^13^Degeneration of Lumbosacral Intervertebral Disc (SCT 60937000)^M51.37^60937000^101247013
"DATA",125.11,58,1,14,0)
7022581^14^Disorder of Sacrum (SCT 12820001)^M53.3^12820001^21995018
"DATA",125.11,58,1,15,0)
7905644^15^Fibromyalgia (SCT 203082005)^M79.7^203082005^311662010
"DATA",125.11,58,1,16,0)
7148283^16^Generalized Aches and Pains (SCT 82991003)^R52.^82991003^505378014
"DATA",125.11,58,1,17,0)
7044423^17^Headache (SCT 25064002)^R51.^25064002^41990019
"DATA",125.11,58,1,18,0)
7433625^18^Low Back Pain (SCT 279039007)^M54.5^279039007^416139010
"DATA",125.11,58,1,19,0)
7433281^19^Acute Low Back Pain (SCT 278862001)^M54.5^278862001^415892010
"DATA",125.11,58,1,20,0)
7433277^20^Chronic Low Back Pain (SCT 860009)^M54.5^278860009^415888015
"DATA",125.11,58,1,21,0)
7297941^21^Lumbar Post-Laminectomy Syndrome (SCT 202725007)^M96.1^202725007^311156016
"DATA",125.11,58,1,22,0)
7004075^22^Lumbosacral Radiculopathy (SCT 2415007)^M54.17^2415007^5134010
"DATA",125.11,58,1,23,0)
7086017^23^Lumbosacral Spondylosis without Myelopathy (SCT 48210000)^M47.817^48210000^80324016
"DATA",125.11,58,1,24,0)
7679604^24^Myalgia (SCT 68962001)^M79.1^68962001^114542013
"DATA",125.11,58,1,25,0)
7047691^25^Myositis (SCT 26889001)^M60.9^26889001^44991019
"DATA",125.11,58,1,26,0)
7145949^26^Neck Pain (SCT 81680005)^M54.2^81680005^135489010
"DATA",125.11,58,1,27,0)
7018663^27^Pain in Lower Limb (SCT 10601006)^M79.606^10601006^297707010
"DATA",125.11,58,1,28,0)
7178437^28^Pain in Upper Limb (SCT 102556003)^M79.603^102556003^251425018
"DATA",125.11,58,1,29,0)
7297545^29^Sacroiliac Joint Pain (SCT 202487003)^M53.3^202487003^310834012
"DATA",125.11,58,1,30,0)
7032453^30^Spinal Stenosis of Lumbar Region (SCT 18347007)^M48.061^18347007^30977016
"DATA",125.11,58,1,31,0)
7298059^31^Thoracic and Lumbosacral Neuritis (SCT 202796002)^M54.14/M54.17^202796002^311256011
"DATA",125.11,59,0)
VA-PLASTIC SURGERY^3171010^N
"DATA",125.11,59,1,0)
^125.111P^17^17
"DATA",125.11,59,1,1,0)
7295401^1^Actinic Keratosis (SCT 201101007)^L57.0^201101007^1208677014
"DATA",125.11,59,1,2,0)
7579247^2^Basal Cell Carcinoma of Face (SCT 402519009)^C44.310^402519009^1781645013
"DATA",125.11,59,1,3,0)
7392787^3^Basal Cell Carcinoma of Skin (SCT 254701007)^C44.91^254701007^379314010
"DATA",125.11,59,1,4,0)
7165235^4^Benign Neoplasm of Skin (SCT 92384009)^D23.9^92384009^152883016
"DATA",125.11,59,1,5,0)
7165931^5^Carcinoma in Situ of Skin (SCT 92749008)^D04.9^92749008^153358015
"DATA",125.11,59,1,6,0)
7102523^6^Carpal Tunnel Syndrome (SCT 57406009)^G56.00^57406009^95473010
"DATA",125.11,59,1,7,0)
7595373^7^Contracture of Palmar Fascia (SCT 410813000)^M72.0^410813000^2472465014
"DATA",125.11,59,1,8,0)
8304773^8^Ganglion Cyst of Joint (SCT 78435003)^M67.40^78435003^3036281011
"DATA",125.11,59,1,9,0)
7543847^9^Hypertrophy of Breast (SCT 372281005)^N62.^372281005^1210851012
"DATA",125.11,59,1,10,0)
7059853^10^Keloid Scar (SCT 33659008)^L91.0^33659008^485594014
"DATA",125.11,59,1,11,0)
7574751^11^Acquired Keratoderma (SCT 400166009)^L85.1^400166009^1779418010
"DATA",125.11,59,1,12,0)
7534685^12^Lesion of Ulnar Nerve (SCT 367475009)^G56.20^367475009^492283017
"DATA",125.11,59,1,13,0)
7170317^13^Neoplasm of Uncertain Behavior of Skin (SCT 95087004)^D48.5^95087004^157564010
"DATA",125.11,59,1,14,0)
7020997^14^Ptosis of Eyelid (SCT 11934000)^H02.409^11934000^20576010
"DATA",125.11,59,1,15,0)
7295605^15^Scar Conditions and Fibrosis of Skin (SCT 201307004)^L90.5^201307004^309250011
"DATA",125.11,59,1,16,0)
7961420^16^Sebaceous Cyst (SCT 419603000)^L72.3^419603000^2580186011
"DATA",125.11,59,1,17,0)
8289372^17^Trigger Finger (SCT 448251000124102)^M65.30^448251000124102^697461000124114
"DATA",125.11,60,0)
VA-POLYTRAUMA^3171010^N
"DATA",125.11,60,1,0)
^125.111P^11^11
"DATA",125.11,60,1,1,0)
8172957^1^Back Pain (SCT 161891005)^M54.9^161891005^2646370015
"DATA",125.11,60,1,2,0)
7583413^2^Dizziness (SCT 404640003)^R42.^404640003^2156535017
"DATA",125.11,60,1,3,0)
7044423^3^Headache (SCT 25064002)^R51.^25064002^41990019
"DATA",125.11,60,1,4,0)
7347767^4^Chronic Post-Traumatic Headache (SCT 230477005)^G44.329^230477005^345367011
"DATA",125.11,60,1,5,0)
7800169^5^Cognitive Impairment (SCT 386806002)^R41.89^386806002^1491795010
"DATA",125.11,60,1,6,0)
7284041^6^Insomnia (SCT 193462001)^G47.00^193462001^297924011
"DATA",125.11,60,1,7,0)
7556151^7^Memory Impairment (SCT 386807006)^R41.3^386807006^1480927011
"DATA",125.11,60,1,8,0)
7067355^8^Migraine (SCT 37796009)^G43.909^37796009^63055014
"DATA",125.11,60,1,9,0)
7145949^9^Neck Pain (SCT 81680005)^M54.2^81680005^135489010
"DATA",125.11,60,1,10,0)
7108641^10^Tinnitus (SCT 60862001)^H93.19^60862001^101130017
"DATA",125.11,60,1,11,0)
7013605^11^Visual Discomfort (SCT 7751009)^H53.149^7751009^13821013
"DATA",125.11,62,0)
VA-PULMONARY^3171010^N
"DATA",125.11,62,1,0)
^125.111P^25^25
"DATA",125.11,62,1,1,0)
7425367^1^Abnormal Findings on Diagnostic Imaging of Lung (SCT 274533004)^R91.8^274533004^410354017
"DATA",125.11,62,1,2,0)
7287631^2^Asthma (SCT 195967001)^J45.909^195967001^301485011
"DATA",125.11,62,1,3,0)
8195461^3^Chest Mass (SCT 440299000)^R22.2^440299000^2794435017
"DATA",125.11,62,1,4,0)
7651747^4^CHF - Congestive Heart Failure (SCT 42343007)^I50.9^42343007^493289014
"DATA",125.11,62,1,5,0)
7622187^5^COPD - Chronic Obstructive Pulmonary Disease (SCT 13645005)^J44.9^13645005^475427019
"DATA",125.11,62,1,6,0)
7148817^6^Cor Pulmonale (SCT 83291003)^I27.81^83291003^138131012
"DATA",125.11,62,1,7,0)
7088747^7^Cough (SCT 49727002)^R05.^49727002^82824016
"DATA",125.11,62,1,8,0)
7414739^8^Dyspnea (SCT 267036007)^R06.00^267036007^397885013
"DATA",125.11,62,1,9,0)
7698610^9^Emphysema of Lung (SCT 87433001)^J43.9^87433001^144967010
"DATA",125.11,62,1,10,0)
7092145^10^Fibrosis of Lung (SCT 51615001)^J84.10^51615001^85957013
"DATA",125.11,62,1,11,0)
7560567^11^Hypoxemia (SCT 389087006)^R09.02^389087006^1477186012
"DATA",125.11,62,1,12,0)
7417797^12^Malignant Neoplasm of Upper Lobe, Bronchus or Lung (SCT 269464000)^C34.10^269464000^403688010
"DATA",125.11,62,1,13,0)
7276431^13^Malignant Neoplasm of Middle Lobe, Bronchus or Lung (SCT 187864008)^C34.2^187864008^288822013
"DATA",125.11,62,1,14,0)
7276439^14^Malignant Neoplasm of Lower Lobe, Bronchus or Lung (SCT 187868006)^C34.30^187868006^288826011
"DATA",125.11,62,1,15,0)
7603305^15^Obesity (SCT 414916001)^E66.9^414916001^2535065012
"DATA",125.11,62,1,16,0)
7107201^16^Pleural Effusion (SCT 60046008)^J90.^60046008^99753013
"DATA",125.11,62,1,17,0)
7353673^17^Pneumonia (SCT 233604007)^J18.9^233604007^350049016
"DATA",125.11,62,1,18,0)
7669584^18^PE - Pulmonary Embolism (SCT 59282003)^I26.99^59282003^1231937012
"DATA",125.11,62,1,19,0)
7056061^19^Sarcoidosis (SCT 31541009)^D86.9^31541009^52728016
"DATA",125.11,62,1,20,0)
7131165^20^Sleep Apnea (SCT 73430006)^G47.30^73430006^121941010
"DATA",125.11,62,1,21,0)
7139841^21^Obstructive Sleep Apnea Syndrome (SCT 78275009)^G47.33^78275009^129889015
"DATA",125.11,62,1,22,0)
7141661^22^Hypersomnia with Sleep Apnea (SCT 79280005)^G47.10/G47.30^79280005^131540013
"DATA",125.11,62,1,23,0)
7653534^23^Sleep Disturbance (SCT 44186003)^G47.9^44186003^493802012
"DATA",125.11,62,1,24,0)
8094411^24^Solitary Nodule of Lung (SCT 427359005)^R91.1^427359005^2674145019
"DATA",125.11,62,1,25,0)
7191611^25^Tobacco User (SCT 110483000)^Z72.0^110483000^175325014
"DATA",125.11,63,0)
VA-RENAL NEPHROLOGY^3171010^N
"DATA",125.11,63,1,0)
^125.111P^19^19
"DATA",125.11,63,1,1,0)
7091715^1^Acidosis (SCT 51387008)^E87.2^51387008^85589013
"DATA",125.11,63,1,2,0)
8229067^2^Acute Renal Failure (SCT 14669001)^N17.9^14669001^2920634011
"DATA",125.11,63,1,3,0)
7420143^3^Anemia (SCT 271737000)^D64.9^271737000^406636013
"DATA",125.11,63,1,4,0)
7088713^4^Anemia of Chronic Renal Failure (SCT 49708008)^N18.9/D63.1^49708008^82792016
"DATA",125.11,63,1,5,0)
7651747^5^CHF - Congestive Heart Failure (SCT 42343007)^I50.9^42343007^493289014
"DATA",125.11,63,1,6,0)
8110643^6^Chronic Kidney Disease Stage 2 (SCT 431856006)^N18.2^431856006^2767384012
"DATA",125.11,63,1,7,0)
8113219^7^Chronic Kidney Disease Stage 3 (SCT 433144002)^N18.3^433144002^2773184015
"DATA",125.11,63,1,8,0)
8110645^8^Chronic Kidney Disease Stage 4 (SCT 431857002)^N18.4^431857002^2767385013
"DATA",125.11,63,1,9,0)
8113223^9^Chronic Kidney Disease Stage 5 (SCT 433146000)^N18.5^433146000^2767154014
"DATA",125.11,63,1,10,0)
8308284^10^Diabetes Type 2 with Nephropathy (SCT 420279001)^E11.21^420279001^3035432019
"DATA",125.11,63,1,11,0)
7414743^11^Edema (SCT 267038008)^R60.9^267038008^397895018
"DATA",125.11,63,1,12,0)
7655768^12^ESRD - End Stage Renal Disease (SCT 46177005)^N18.6^46177005^1230316017
"DATA",125.11,63,1,13,0)
7161849^13^Gout (SCT 90560007)^M10.9^90560007^150085018
"DATA",125.11,63,1,14,0)
7024921^14^Hyperkalemia (SCT 14140009)^E87.5^14140009^24062011
"DATA",125.11,63,1,15,0)
7068583^15^Hypertensive Renal Disease (SCT 38481006)^I12.9/N18.9^38481006^64282015
"DATA",125.11,63,1,16,0)
7171215^16^Kidney Stone (SCT 95570007)^N20.0^95570007^158296018
"DATA",125.11,63,1,17,0)
7052813^17^Proteinuria (SCT 29738008)^R80.9^29738008^49755019
"DATA",125.11,63,1,18,0)
8273014^18^Renal Failure (SCT 42399005)^N19.^42399005^3014127011
"DATA",125.11,63,1,19,0)
7627537^19^Secondary Hyperparathyroidism of Renal Origin (SCT 19034001)^N25.81^19034001^1222225011
"DATA",125.11,64,0)
VA-RHEUMATOLOGY^3171010^N
"DATA",125.11,64,1,0)
^125.111P^30^30
"DATA",125.11,64,1,1,0)
7379443^1^Ankle Pain (SCT 247373008)^M25.579^247373008^369388017
"DATA",125.11,64,1,2,0)
7016969^2^Ankylosing Spondylitis (SCT 9631008)^M45.9^9631008^16833013
"DATA",125.11,64,1,3,0)
7572965^3^Arthropathy (SCT 399269003)^M12.9^399269003^1778721018
"DATA",125.11,64,1,4,0)
8290582^4^Bilateral Knee Pain (SCT 11874791000119104)^M25.562/M25.561^11874791000119104^696281000124117
"DATA",125.11,64,1,5,0)
7147055^5^Degenerative Joint Disease of Ankle And/Or Foot (SCT 82300000)^M19.079^82300000^136512016
"DATA",125.11,64,1,6,0)
7085513^6^Foot Pain (SCT 47933007)^M79.673^47933007^494960013
"DATA",125.11,64,1,7,0)
8289086^7^Pain in Left Foot (SCT 316751000119107)^M79.672^316751000119107^692891000124119
"DATA",125.11,64,1,8,0)
8289090^8^Pain in Right Foot (SCT 316891000119107)^M79.671^316891000119107^692941000124118
"DATA",125.11,64,1,9,0)
7161849^9^Gout (SCT 90560007)^M10.9^90560007^150085018
"DATA",125.11,64,1,10,0)
7608093^10^Inflammatory Polyarthropathy (SCT 417373000)^M06.4^417373000^2548331017
"DATA",125.11,64,1,11,0)
7102999^11^Joint Pain (SCT 57676002)^M25.50^57676002^95910010
"DATA",125.11,64,1,12,0)
7063505^12^Multiple Joint Pain (SCT 35678005)^M25.50^35678005^486238018
"DATA",125.11,64,1,13,0)
7123171^13^Muscle Pain (SCT 68962001)^M79.1^68962001^114543015
"DATA",125.11,64,1,14,0)
7047691^14^Myositis (SCT 26889001)^M60.9^26889001^44991019
"DATA",125.11,64,1,15,0)
7145949^15^Neck Pain (SCT 81680005)^M54.2^81680005^135489010
"DATA",125.11,64,1,16,0)
7567087^16^Osteoarthritis (SCT 396275006)^M19.90^396275006^1776248011
"DATA",125.11,64,1,17,0)
7365253^17^Osteoarthritis of Knee (SCT 239873007)^M17.9^239873007^359420013
"DATA",125.11,64,1,18,0)
7139129^18^Osteochondropathy (SCT 77881008)^M93.90^77881008^129246013
"DATA",125.11,64,1,19,0)
7115815^19^Osteoporosis (SCT 64859006)^M81.0^64859006^107806013
"DATA",125.11,64,1,20,0)
8289088^20^Pain in Left Knee (SCT 316791000119102)^M25.562^316791000119102^692741000124116
"DATA",125.11,64,1,21,0)
8289096^21^Pain in Right Knee (SCT 316931000119104)^M25.561^316931000119104^692721000124111
"DATA",125.11,64,1,22,0)
7162365^22^Pain in Limb (SCT 90834002)^M79.609^90834002^150521017
"DATA",125.11,64,1,23,0)
7116621^23^Polymyalgia Rheumatica (SCT 65323003)^M35.3^65323003^108529013
"DATA",125.11,64,1,24,0)
7015869^24^Psoriasis (SCT 9014002)^L40.9^9014002^15886015
"DATA",125.11,64,1,25,0)
7059271^25^Psoriasis with Arthropathy (SCT 33339001)^L40.50^33339001^55626019
"DATA",125.11,64,1,26,0)
7680564^26^RA - Rheumatoid Arthritis (SCT 69896004)^M06.9^69896004^1233202011
"DATA",125.11,64,1,27,0)
7099039^27^Systemic Lupus Erythematosus (SCT 55464009)^M32.9^55464009^92208011
"DATA",125.11,64,1,28,0)
7612877^28^Rotator Cuff Tear (SCT 4106009)^M75.100^4106009^1229713013
"DATA",125.11,64,1,29,0)
8290588^29^Tear of Left Rotator Cuff (SCT 11892411000119102)^M75.102^11892411000119102^695751000124112
"DATA",125.11,64,1,30,0)
8290586^30^Tear of Right Rotator Cuff (SCT 11892371000119103)^M75.101^11892371000119103^696491000124115
"DATA",125.11,65,0)
VA-UROLOGY^3171010^N
"DATA",125.11,65,1,0)
^125.111P^19^19
"DATA",125.11,65,1,1,0)
7359365^1^Benign Prostatic Hypertrophy With Outflow Obstruction (SCT 236646007)^N40.1/N13.8^236646007^2470105014
"DATA",125.11,65,1,2,0)
8117575^2^Benign Prostatic Hypertrophy Without Outflow Obstruction (SCT 254902007)^N40.0^254902007^2773349010
"DATA",125.11,65,1,3,0)
7806753^3^Bladder Cancer (SCT 399326009)^C67.9^399326009^1786810016
"DATA",125.11,65,1,4,0)
7804290^4^Elevated PSA (SCT 396152005)^R97.20^396152005^1785467014
"DATA",125.11,65,1,5,0)
8234552^5^Erectile Dysfunction (SCT 397803000)^N52.9^397803000^2955652011
"DATA",125.11,65,1,6,0)
7290471^6^Frank Hematuria (SCT 197941005)^R31.0^197941005^304351010
"DATA",125.11,65,1,7,0)
7643442^7^Hematuria (SCT 34436003)^R31.9^34436003^57479019
"DATA",125.11,65,1,8,0)
7290469^8^Microscopic Hematuria (SCT 197940006)^R31.29^197940006^304350011
"DATA",125.11,65,1,9,0)
7171215^9^Kidney Stone (SCT 95570007)^N20.0^95570007^158296018
"DATA",125.11,65,1,10,0)
7774340^10^LUTS - Lower Urinary Tract Symptoms (SCT 307541003)^R39.9^307541003^450832014
"DATA",125.11,65,1,11,0)
7570609^11^Neurogenic Bladder (SCT 398064005)^N31.9^398064005^1777632010
"DATA",125.11,65,1,12,0)
7846854^12^Nocturia (SCT 139394000)^R35.1^139394000^221079019
"DATA",125.11,65,1,13,0)
8306669^13^Prostate Cancer (SCT 254900004)^C61.^254900004^3036967016
"DATA",125.11,65,1,14,0)
8224841^14^Psychosexual Dysfunction Associated With Inhibited Sexual Excitement (SCT 153151000119100)^F52.9^153151000119100^2984175015
"DATA",125.11,65,1,15,0)
7414791^15^Retention of Urine (SCT 267064002)^R33.9^267064002^397937013
"DATA",125.11,65,1,16,0)
7237089^16^Increased Frequency of Urination (SCT 162116003)^R35.0^162116003^252775019
"DATA",125.11,65,1,17,0)
7134123^17^Urgent Desire to Urinate (SCT 75088002)^R39.15^75088002^502913011
"DATA",125.11,65,1,18,0)
7242159^18^Urinary Incontinence (SCT 165232002)^R32.^165232002^1489736014
"DATA",125.11,65,1,19,0)
7679240^19^UTI - Urinary Tract Infection (SCT 68566005)^N39.0^68566005^1233066018
"FIA",125)
PROBLEM SELECTION LIST
"FIA",125,0)
^GMPL(125,
"FIA",125,0,0)
125I
"FIA",125,0,1)
y^y^f^^y^^y^r^n
"FIA",125,0,10)

"FIA",125,0,11)
I $$SENDLIST^GMPLY49($P(^(0),U))
"FIA",125,0,"RLRO")

"FIA",125,0,"VR")
2.0^GMPL
"FIA",125,125)
0
"FIA",125,125.01)
0
"FIA",125.11)
PROBLEM SELECTION CATEGORY
"FIA",125.11,0)
^GMPL(125.11,
"FIA",125.11,0,0)
125.11I
"FIA",125.11,0,1)
y^y^f^^y^^y^r^n
"FIA",125.11,0,10)

"FIA",125.11,0,11)
I $$SENDLIST^GMPLY49($P(^(0),U))
"FIA",125.11,0,"RLRO")

"FIA",125.11,0,"VR")
2.0^GMPL
"FIA",125.11,125.11)
0
"FIA",125.11,125.111)
0
"INI")
PRE^GMPLY49
"INIT")
POST^GMPLY49
"IX",125,125,"AC",0)
125^AC^Index of Categories associated with a list^MU^^F^IR^W^125.01^^^^^A
"IX",125,125,"AC",.1,0)
^^6^6^3160830^
"IX",125,125,"AC",.1,1,0)
This cross-reference allows the retrieval of categories in a sequential 
"IX",125,125,"AC",.1,2,0)
order of a list. The indexes are stored as follows: 
"IX",125,125,"AC",.1,3,0)
^GMPL(125,"AC",CAT,DA(1)).
"IX",125,125,"AC",.1,4,0)
 
"IX",125,125,"AC",.1,5,0)
DA(1) is the IEN of File #125 or the record number of the list the 
"IX",125,125,"AC",.1,6,0)
category is associated with. CAT is the category within that list.
"IX",125,125,"AC",1)
S ^GMPL(125,"AC",X(1),DA(1))=""
"IX",125,125,"AC",2)
K ^GMPL(125,"AC",X(1),DA(1))
"IX",125,125,"AC",11.1,0)
^.114IA^1^1
"IX",125,125,"AC",11.1,1,0)
1^F^125.01^.01^^1^F
"IX",125,125,"AD",0)
125^AD^Index of list contents in sequenced order^MU^^F^IR^W^125.01^^^^^A
"IX",125,125,"AD",.1,0)
^^7^7^3160915^
"IX",125,125,"AD",.1,1,0)
This cross-reference allows the retrieval of the list categories in a 
"IX",125,125,"AD",.1,2,0)
sequential order. The indexes are stored as follows: 
"IX",125,125,"AD",.1,3,0)
^GMPL(125,"AD",DA(1),CSEQ,DA).
"IX",125,125,"AD",.1,4,0)
 
"IX",125,125,"AD",.1,5,0)
DA(1) is the IEN of File #125 or the record number of the list. CSEQ is 
"IX",125,125,"AD",.1,6,0)
the sequence number of the categories associated with that list. DA is 
"IX",125,125,"AD",.1,7,0)
the sub-record number for those categories.
"IX",125,125,"AD",1)
S ^GMPL(125,"AD",DA(1),X(1),DA)=""
"IX",125,125,"AD",2)
K ^GMPL(125,"AD",DA(1),X(1),DA)
"IX",125,125,"AD",11.1,0)
^.114IA^1^1
"IX",125,125,"AD",11.1,1,0)
1^F^125.01^.02^^1^F
"IX",125,125,"B",0)
125^B^New Style B cross-reference^R^^F^IR^I^125^^^^^LS
"IX",125,125,"B",.1,0)
^^7^7^3170209^
"IX",125,125,"B",.1,1,0)
This cross-reference allows for the look up and sorting of selection list 
"IX",125,125,"B",.1,2,0)
names. A primary key is created to ensure uniqueness in the selection 
"IX",125,125,"B",.1,3,0)
list names. 
"IX",125,125,"B",.1,4,0)
 
"IX",125,125,"B",.1,5,0)
The indexes are stored as follows: ^GMPL(125,"B",NAME,DA), where NAME is 
"IX",125,125,"B",.1,6,0)
the selection list name and DA is the IEN of File #125 or the record 
"IX",125,125,"B",.1,7,0)
number of the selection list.
"IX",125,125,"B",1)
S ^GMPL(125,"B",$E(X,1,65),DA)=""
"IX",125,125,"B",2)
K ^GMPL(125,"B",$E(X,1,65),DA)
"IX",125,125,"B",2.5)
K ^GMPL(125,"B")
"IX",125,125,"B",11.1,0)
^.114IA^1^1
"IX",125,125,"B",11.1,1,0)
1^F^125^.01^65^1^F
"IX",125.11,125.11,"APSQ",0)
125.11^APSQ^Index of Sequenced Category Problems^MU^^F^IR^W^125.111^^^^^A
"IX",125.11,125.11,"APSQ",.1,0)
^^8^8^3160817^
"IX",125.11,125.11,"APSQ",.1,1,0)
This cross-reference allows the retrieval of category problems in a 
"IX",125.11,125.11,"APSQ",.1,2,0)
sequenced order. The indexes are stored as follows: 
"IX",125.11,125.11,"APSQ",.1,3,0)
^GMPL(125.11,"C",DA(1),PSEQ,DA).
"IX",125.11,125.11,"APSQ",.1,4,0)
 
"IX",125.11,125.11,"APSQ",.1,5,0)
DA(1) is the IEN of File #125.11 or the pointer value of the Category for 
"IX",125.11,125.11,"APSQ",.1,6,0)
which the problems are grouped under. PSEQ is the sequence number of the 
"IX",125.11,125.11,"APSQ",.1,7,0)
problem under a specific category. DA is the sub-record number associated 
"IX",125.11,125.11,"APSQ",.1,8,0)
with the problem entry.
"IX",125.11,125.11,"APSQ",1)
S ^GMPL(125.11,"C",DA(1),X(1),DA)=""
"IX",125.11,125.11,"APSQ",2)
K ^GMPL(125.11,"C",DA(1),X(1),DA)
"IX",125.11,125.11,"APSQ",11.1,0)
^.114IA^1^1
"IX",125.11,125.11,"APSQ",11.1,1,0)
1^F^125.111^.02^^1^F
"IX",125.11,125.11,"APSQ",11.1,1,3)

"IX",125.11,125.11,"B",0)
125.11^B^New Style B cross-reference^R^^F^IR^I^125.11^^^^^LS
"IX",125.11,125.11,"B",.1,0)
^^7^7^3170209^
"IX",125.11,125.11,"B",.1,1,0)
This cross-reference allows for the look up and sorting of selection list 
"IX",125.11,125.11,"B",.1,2,0)
category names. A primary key is created to ensure uniqueness in the 
"IX",125.11,125.11,"B",.1,3,0)
selection list category names. 
"IX",125.11,125.11,"B",.1,4,0)
 
"IX",125.11,125.11,"B",.1,5,0)
The indexes are stored as follows: ^GMPL(125,"B",NAME,DA), where NAME is 
"IX",125.11,125.11,"B",.1,6,0)
the selection list category name and DA is the IEN of File #125.11 or the 
"IX",125.11,125.11,"B",.1,7,0)
record number of the selection list category.
"IX",125.11,125.11,"B",1)
S ^GMPL(125.11,"B",$E(X,1,65),DA)=""
"IX",125.11,125.11,"B",2)
K ^GMPL(125.11,"B",$E(X,1,65),DA)
"IX",125.11,125.11,"B",2.5)
K ^GMPL(125.11,"B")
"IX",125.11,125.11,"B",11.1,0)
^.114IA^1^1
"IX",125.11,125.11,"B",11.1,1,0)
1^F^125.11^.01^65^1
"KEY",125,125,"A",0)
125^A^P^1312
"KEY",125,125,"A",2,0)
^.312IA^1^1
"KEY",125,125,"A",2,1,0)
.01^125^1
"KEY",125.11,125.11,"A",0)
125.11^A^P^1458
"KEY",125.11,125.11,"A",2,0)
^.312IA^1^1
"KEY",125.11,125.11,"A",2,1,0)
.01^125.11^1
"KEYPTR",125,125,"A")
125^B
"KEYPTR",125.11,125.11,"A")
125.11^B
"KRN",19,8496,-1)
2^6
"KRN",19,8496,0)
GMPL BUILD LIST MENU^Create Problem Selection Lists^^M^.5^^^^^^^402
"KRN",19,8496,10,0)
^19.01IP^9^6
"KRN",19,8496,10,3,0)
8497^3^3
"KRN",19,8496,10,3,"^")
GMPL ASSIGN LIST
"KRN",19,8496,10,7,0)
12401^5^5
"KRN",19,8496,10,7,"^")
GMPL SELECTION LIST CSV CHECK
"KRN",19,8496,10,9,0)
14538^6^6
"KRN",19,8496,10,9,"^")
GMPL SELECTION LIST IMPORT
"KRN",19,8496,"U")
CREATE PROBLEM SELECTION LISTS
"KRN",19,8497,-1)
0^4
"KRN",19,8497,0)
GMPL ASSIGN LIST^Assign/Remove Problem Selection List^^R^^^^^^^^PROBLEM LIST^^
"KRN",19,8497,1,0)
^^10^10^3170209^
"KRN",19,8497,1,1,0)
This option allows a selection list to be assigned to user(s) as his/her
"KRN",19,8497,1,2,0)
preferred menu of problems to select from and/or to a clinic location as 
"KRN",19,8497,1,3,0)
its default list. A user's assignment will override a clinic assignment.
"KRN",19,8497,1,4,0)
 
"KRN",19,8497,1,5,0)
If a list is specified for the user in the Default Problem Selection List 
"KRN",19,8497,1,6,0)
Display [ORQQPL SELECTION LIST] parameter, then the Add New Problem(s)
"KRN",19,8497,1,7,0)
option will present this list of problems to select from. If there are no 
"KRN",19,8497,1,8,0)
user defined lists, then a default clinic list will be presented.
"KRN",19,8497,1,9,0)
Searching the Lexicon Utility for a problem not on this list is always an
"KRN",19,8497,1,10,0)
option from these menus as well.
"KRN",19,8497,20)

"KRN",19,8497,25)
ASSIGN^GMPLBLD2
"KRN",19,8497,"U")
ASSIGN/REMOVE PROBLEM SELECTIO
"KRN",19,12401,-1)
0^3
"KRN",19,12401,0)
GMPL SELECTION LIST CSV CHECK^Check Problem Selection List Problem Codes^^R^^^^^^^^PROBLEM LIST
"KRN",19,12401,1,0)
^^5^5^3160916^
"KRN",19,12401,1,1,0)
This option will produce a report related to Problem Selection Lists. The
"KRN",19,12401,1,2,0)
report will contain a list of any Problem Selection Lists that contain 
"KRN",19,12401,1,3,0)
problems with inactive SNOMED and/or ICD codes attached. It will also
"KRN",19,12401,1,4,0)
determine if any attached ICD codes are due to be inactivated in the
"KRN",19,12401,1,5,0)
future and a report of those findings is also included.
"KRN",19,12401,25)
CSVOPT^GMPLBLCK
"KRN",19,12401,"U")
CHECK PROBLEM SELECTION LIST P
"KRN",19,14538,-1)
0^5
"KRN",19,14538,0)
GMPL SELECTION LIST IMPORT^Import Problem Selection List^^R^^GMPL IMPRT UTIL^^^^^^PROBLEM LIST
"KRN",19,14538,1,0)
^^3^3^3170112^
"KRN",19,14538,1,1,0)
This option allows users to import National Problem Selection List 
"KRN",19,14538,1,2,0)
content to the VistA system using two import methods: 1) CSV host file or 
"KRN",19,14538,1,3,0)
2) CSV file from a web site.
"KRN",19,14538,25)
IMP^GMPLSLI1
"KRN",19,14538,"U")
IMPORT PROBLEM SELECTION LIST
"KRN",19,14627,-1)
1^7
"KRN",19,14627,0)
GMPL DE-ASSIGN LIST
"KRN",19.1,729,-1)
0^1
"KRN",19.1,729,0)
GMPL IMPRT UTIL^GMPL IMPORT UTILITY ACCESS^^n^0
"KRN",19.1,729,1,0)
^19.11^3^3^3170413^^^^
"KRN",19.1,729,1,1,0)
Users who hold this key will be allowed to import Problem Selection List 
"KRN",19.1,729,1,2,0)
content using the Import Problem Selection List [GMPL SELECTION LIST 
"KRN",19.1,729,1,3,0)
IMPORT] option.
"KRN",101,2403,-1)
0^2
"KRN",101,2403,0)
GMPL MENU SAVE LIST^Save List and Quit^^A^^^^^^^^PROBLEM LIST
"KRN",101,2403,1,0)
^^2^2^2931213^^^^
"KRN",101,2403,1,1,0)
This action allows the user to save any changes that have been made to
"KRN",101,2403,1,2,0)
the current list and exit the utility.
"KRN",101,2403,15)
S ^GMPL(125,+GMPLSLST,0)=$P(GMPLSLST,U,2)_U_DT_U_$P(GMPLSLST,U,4)_U_$P(GMPLSLST,U,5) D HDR^GMPLBLD
"KRN",101,2403,20)
D SAVE^GMPLBLD2
"KRN",101,2403,99)
56232,37689
"KRN",101,2408,-1)
0^1
"KRN",101,2408,0)
GMPL MENU SAVE GROUP^Save Category and Quit^^A^^^^^^^^PROBLEM LIST
"KRN",101,2408,1,0)
^^2^2^2931213^^^^
"KRN",101,2408,1,1,0)
This action allows the user to save any changes that have been made to
"KRN",101,2408,1,2,0)
the current category and exit the utility.
"KRN",101,2408,15)
S ^GMPL(125.11,+GMPLGRP,0)=$P(GMPLGRP,U,2)_U_DT_U_$P(GMPLGRP,U,4) D HDR^GMPLBLDC
"KRN",101,2408,20)
D SAVE^GMPLBLD2
"KRN",101,2408,99)
56232,37689
"KRN",101,2422,-1)
0^5
"KRN",101,2422,0)
GMPL MENU ASSIGN LIST^Assign List^^A^^^^^^^^PROBLEM LIST
"KRN",101,2422,1,0)
^^6^6^2940202^^^^
"KRN",101,2422,1,1,0)
This action allows the user to assign this list to a clinic or to user(s).
"KRN",101,2422,1,2,0)
Linking a list to a clinic will invoke the list whenever a user selects
"KRN",101,2422,1,3,0)
that clinic as the location where the patient was seen, when adding
"KRN",101,2422,1,4,0)
new problems.  If a list is linked to a user, this is the list that will
"KRN",101,2422,1,5,0)
always be invoked when that user is adding new problems, regardless of
"KRN",101,2422,1,6,0)
the clinic specified that the patient was seen in.
"KRN",101,2422,20)
D ASSIGN^GMPLBLD2
"KRN",101,2422,99)
56232,37686
"KRN",101,6381,-1)
0^3
"KRN",101,6381,0)
GMPL MENU COPY GROUP^Copy to New Category^^A^^^^^^^^PROBLEM LIST
"KRN",101,6381,1,0)
^^4^4^3160920^
"KRN",101,6381,1,1,0)
This action allows the user to copy an existing category to a new 
"KRN",101,6381,1,2,0)
category. Local/VISN categories may not be copied into a National 
"KRN",101,6381,1,3,0)
category. However National categories may be adopted/copied into a 
"KRN",101,6381,1,4,0)
Local/VISN category for local modifications.
"KRN",101,6381,20)
D COPY^GMPLBLDC
"KRN",101,6381,99)
64181,34660
"MBREQ")
1
"ORD",3,19.1)
19.1;3;;;KEY^XPDTA1;KEYF1^XPDIA1;KEYE1^XPDIA1;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PGL",125,0,3,.03)
CLINIC^*P44'^SC(^0;3^S DIC("S")="I $P(^(0),U,3)=""C""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"PKG",402,-1)
1^1
"PKG",402,0)
PROBLEM LIST^GMPL^Automated Patient Problem List
"PKG",402,22,0)
^9.49I^1^1
"PKG",402,22,1,0)
2.0^2940825^2941216
"PKG",402,22,1,"PAH",1,0)
49^3171010
"PKG",402,22,1,"PAH",1,1,0)
^^2^2^3171010
"PKG",402,22,1,"PAH",1,1,1,0)
The description of this patch may be found in the National Patch Module
"PKG",402,22,1,"PAH",1,1,2,0)
under GMPL*2.0*49.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
20
"RTN","GMPL")
0^1^B27126039
"RTN","GMPL",1,0)
GMPL ; SLC/MKB/AJB/TC -- Problem List Driver;09/07/17  13:29
"RTN","GMPL",2,0)
 ;;2.0;Problem List;**3,11,28,42,49**;Aug 25, 1994;Build 43
"RTN","GMPL",3,0)
EN ; -- main entry point for GMPL PROBLEM LIST
"RTN","GMPL",4,0)
 S GMPLUSER=1
"RTN","GMPL",5,0)
 D EN^VALM("GMPL PROBLEM LIST")
"RTN","GMPL",6,0)
 Q
"RTN","GMPL",7,0)
 ;
"RTN","GMPL",8,0)
DE ; -- main entry point for GMPL DATA ENTRY
"RTN","GMPL",9,0)
 K GMPLUSER
"RTN","GMPL",10,0)
 D EN^VALM("GMPL DATA ENTRY")
"RTN","GMPL",11,0)
 Q
"RTN","GMPL",12,0)
 ;
"RTN","GMPL",13,0)
ADD ; -- add a new problem
"RTN","GMPL",14,0)
 S VALMBCK="",GMPCLIN="" K GMPREBLD
"RTN","GMPL",15,0)
 I +$P(GMPDFN,U,4),'$$CKDEAD^GMPLX1($P(GMPDFN,U,4)) G ADDQ
"RTN","GMPL",16,0)
 S:$E(GMPLVIEW("VIEW"))'="S" GMPCLIN=$$CLINIC^GMPLX1("") G:GMPCLIN="^" ADDQ
"RTN","GMPL",17,0)
 S GMPLSLST=$$GET^XPAR(DUZ_";VA(200,","ORQQPL SELECTION LIST",1)
"RTN","GMPL",18,0)
 I 'GMPLSLST,GMPCLIN S GMPLSLST=$$GET^XPAR(+GMPCLIN_";SC(","ORQQPL SELECTION LIST",1) ; if user has no list but clinic does, use clinic list
"RTN","GMPL",19,0)
 I GMPLSLST D  G ADD1
"RTN","GMPL",20,0)
 . S $P(GMPLSLST,U,2)=$P($G(^GMPL(125,+GMPLSLST,0)),U)
"RTN","GMPL",21,0)
 . D EN^VALM("GMPL LIST MENU")
"RTN","GMPL",22,0)
 W @IOF D FULL^VALM1 F  D ADD^GMPL1 Q:$D(GMPQUIT)  S:$D(GMPSAVED) GMPREBLD=1 K DUOUT,DTOUT,GMPSAVED W !!!,">>>  Please enter another problem, or press <return> to exit."
"RTN","GMPL",23,0)
 S VALMBCK="R"
"RTN","GMPL",24,0)
ADD1 I $D(GMPREBLD) D
"RTN","GMPL",25,0)
 . S VALMBCK="R",GMPRINT=1
"RTN","GMPL",26,0)
 . S VALMBG=$S(GMPARAM("REV"):1,VALMCNT<10:1,1:VALMCNT-9)
"RTN","GMPL",27,0)
 . D BUILD^GMPLMGR(.GMPLIST),HDR^GMPLMGR
"RTN","GMPL",28,0)
ADDQ D KILL^GMPLX S VALMSG=$$MSG^GMPLX S:'VALMCC VALMBCK="R"
"RTN","GMPL",29,0)
 Q
"RTN","GMPL",30,0)
 ;
"RTN","GMPL",31,0)
STATUS ; -- inactivate a problem
"RTN","GMPL",32,0)
 S VALMBCK="" G:+$G(GMPCOUNT)'>0 STQ
"RTN","GMPL",33,0)
 I GMPLVIEW("ACT")="I" W $C(7),!!,"Currently displayed problems are already inactive!",! G STQ
"RTN","GMPL",34,0)
 S GMPLSEL=$$SEL^GMPLX("inactivate") G:GMPLSEL="^" STQ
"RTN","GMPL",35,0)
 S GMPLNO=$L(GMPLSEL,",")
"RTN","GMPL",36,0)
 F GMPI=1:1:GMPLNO S GMPLNUM=$P(GMPLSEL,",",GMPI) I GMPLNUM D  Q:$D(GMPQUIT)
"RTN","GMPL",37,0)
 . S GMPIFN=$P($G(^TMP("GMPLIDX",$J,+GMPLNUM)),U,2) Q:GMPIFN'>0
"RTN","GMPL",38,0)
 . I $P(^AUPNPROB(GMPIFN,0),U,12)="I" W !!,$$PROBTEXT^GMPLX(GMPIFN),!,"is already inactive!",! H 2 Q
"RTN","GMPL",39,0)
 . I $P($G(^AUPNPROB(GMPIFN,1)),U,2)="H" W !!,$$PROBTEXT^GMPLX(GMPIFN),!,"has been removed from this patient's problem list!",! H 2 Q
"RTN","GMPL",40,0)
 . L +^AUPNPROB(GMPIFN,0):1 I '$T W $C(7),!!,$$LOCKED^GMPLX,! H 2 Q
"RTN","GMPL",41,0)
 . D STATUS^GMPL1 L -^AUPNPROB(GMPIFN,0)
"RTN","GMPL",42,0)
 I $D(GMPSAVED) D
"RTN","GMPL",43,0)
 . S VALMBCK="R",GMPRINT=1
"RTN","GMPL",44,0)
 . D BUILD^GMPLMGR(.GMPLIST),HDR^GMPLMGR
"RTN","GMPL",45,0)
STQ D KILL^GMPLX S VALMSG=$$MSG^GMPLX S:'VALMCC VALMBCK="R"
"RTN","GMPL",46,0)
 Q
"RTN","GMPL",47,0)
 ;
"RTN","GMPL",48,0)
NOTES ; -- annotate a problem
"RTN","GMPL",49,0)
 S VALMBCK="" G:+$G(GMPCOUNT)'>0 NTQ
"RTN","GMPL",50,0)
 S GMPLNUM=$$SEL1^GMPLX("add comment(s) to") G:GMPLNUM="^" NTQ
"RTN","GMPL",51,0)
 S GMPIFN=$P($G(^TMP("GMPLIDX",$J,+GMPLNUM)),U,2) G:GMPIFN'>0 NTQ
"RTN","GMPL",52,0)
 I $P($G(^AUPNPROB(GMPIFN,1)),U,2)="H" W !!,$$PROBTEXT^GMPLX(GMPIFN),!,"has been removed from this patient's problem list!",! H 2 G NTQ
"RTN","GMPL",53,0)
 L +^AUPNPROB(GMPIFN,0):1 I '$T W $C(7),!!,$$LOCKED^GMPLX,! H 2 G NTQ
"RTN","GMPL",54,0)
 D NEWNOTE^GMPL1 I $D(GMPSAVED) D
"RTN","GMPL",55,0)
 . S VALMBCK="R",GMPRINT=1
"RTN","GMPL",56,0)
 . D BUILD^GMPLMGR(.GMPLIST)
"RTN","GMPL",57,0)
 L -^AUPNPROB(GMPIFN,0)
"RTN","GMPL",58,0)
NTQ D KILL^GMPLX S VALMSG=$$MSG^GMPLX S:'VALMCC VALMBCK="R"
"RTN","GMPL",59,0)
 Q
"RTN","GMPL",60,0)
 ;
"RTN","GMPL",61,0)
EDIT ; -- edit allowable fields of a problem
"RTN","GMPL",62,0)
 S VALMBCK="" G:+$G(GMPCOUNT)'>0 EDQ
"RTN","GMPL",63,0)
 S GMPLNUM=$$SEL1^GMPLX("edit") G:GMPLNUM="^" EDQ
"RTN","GMPL",64,0)
 S GMPIFN=$P($G(^TMP("GMPLIDX",$J,+GMPLNUM)),U,2) G:GMPIFN'>0 EDQ
"RTN","GMPL",65,0)
 ; Code Set Versioning (CSV)
"RTN","GMPL",66,0)
 ; I '$$CODESTS^GMPLX(GMPIFN,DT) W !!,$$PROBTEXT^GMPLX(GMPIFN),!,"has an inactive ICD code.",! H 3 G EDQ
"RTN","GMPL",67,0)
 I $P($G(^AUPNPROB(GMPIFN,1)),U,2)="H" W !!,$$PROBTEXT^GMPLX(GMPIFN),!,"has been removed from this patient's problem list!",! H 2 G EDQ
"RTN","GMPL",68,0)
 L +^AUPNPROB(GMPIFN,0):1 I '$T W $C(7),!!,$$LOCKED^GMPLX,! H 2 G EDQ
"RTN","GMPL",69,0)
 D EN^VALM("GMPL EDIT PROBLEM")
"RTN","GMPL",70,0)
 I $D(GMPSAVED) D BUILD^GMPLMGR(.GMPLIST),HDR^GMPLMGR S GMPRINT=1
"RTN","GMPL",71,0)
 S VALMBCK="R" L -^AUPNPROB(GMPIFN,0)
"RTN","GMPL",72,0)
EDQ D KILL^GMPLX S VALMSG=$$MSG^GMPLX S:'VALMCC VALMBCK="R"
"RTN","GMPL",73,0)
 Q
"RTN","GMPL",74,0)
 ;
"RTN","GMPL",75,0)
DELETE ; -- delete a problem
"RTN","GMPL",76,0)
 S VALMBCK="" G:+$G(GMPCOUNT)'>0 DELQ
"RTN","GMPL",77,0)
 S GMPLSEL=$$SEL^GMPLX("remove from the list") G:GMPLSEL="^" DELQ
"RTN","GMPL",78,0)
 S GMPLNO=$L(GMPLSEL,",") G:'$$SUREDEL^GMPLEDT2(GMPLNO-1) DELQ
"RTN","GMPL",79,0)
 F GMPI=1:1:GMPLNO S GMPLNUM=$P(GMPLSEL,",",GMPI) I GMPLNUM D  Q:$D(GMPQUIT)
"RTN","GMPL",80,0)
 . S GMPIFN=$P($G(^TMP("GMPLIDX",$J,+GMPLNUM)),U,2) Q:GMPIFN'>0
"RTN","GMPL",81,0)
 . I $P($G(^AUPNPROB(GMPIFN,1)),U,2)="H" W !!,$$PROBTEXT^GMPLX(GMPIFN),!,"has already been removed from this patient's problem list!",! H 2 Q
"RTN","GMPL",82,0)
 . L +^AUPNPROB(GMPIFN,0):1 I '$T W $C(7),!!,$$LOCKED^GMPLX,! H 2 Q
"RTN","GMPL",83,0)
 . D DELETE^GMPL1 L -^AUPNPROB(GMPIFN,0)
"RTN","GMPL",84,0)
 I $D(GMPSAVED) D
"RTN","GMPL",85,0)
 . S VALMBCK="R",GMPRINT=1 D BUILD^GMPLMGR(.GMPLIST),HDR^GMPLMGR
"RTN","GMPL",86,0)
DELQ D KILL^GMPLX S VALMSG=$$MSG^GMPLX S:'VALMCC VALMBCK="R"
"RTN","GMPL",87,0)
 Q
"RTN","GMPL",88,0)
 ;
"RTN","GMPL",89,0)
VERIFY ; -- verify a problem
"RTN","GMPL",90,0)
 S VALMBCK="" Q:+$G(GMPCOUNT)'>0
"RTN","GMPL",91,0)
 W !!,"Select the problem(s) you wish to verify as correct."
"RTN","GMPL",92,0)
 S GMPLSEL=$$SEL^GMPLX("mark as verified") G:GMPLSEL="^" VERQ
"RTN","GMPL",93,0)
 S GMPLNO=$L(GMPLSEL,",")
"RTN","GMPL",94,0)
 F GMPI=1:1:GMPLNO S GMPLNUM=$P(GMPLSEL,",",GMPI) I GMPLNUM D
"RTN","GMPL",95,0)
 . S GMPIFN=$P($G(^TMP("GMPLIDX",$J,GMPLNUM)),U,2)
"RTN","GMPL",96,0)
 . D:GMPIFN VERIFY^GMPL1
"RTN","GMPL",97,0)
 I $D(GMPSAVED) D BUILD^GMPLMGR(.GMPLIST) S VALMBCK="R"
"RTN","GMPL",98,0)
VERQ D KILL^GMPLX S VALMSG=$$MSG^GMPLX S:'VALMCC VALMBCK="R"
"RTN","GMPL",99,0)
 Q
"RTN","GMPL",100,0)
 ;
"RTN","GMPL",101,0)
EXPAND ; -- detailed display of a problem
"RTN","GMPL",102,0)
 S VALMBCK="" Q:+$G(GMPCOUNT)'>0
"RTN","GMPL",103,0)
 S GMPLSEL=$$SEL^GMPLX("view") G:GMPLSEL="^" EXPQ
"RTN","GMPL",104,0)
 S GMPLNO=$L(GMPLSEL,",")-1,GMPI=0
"RTN","GMPL",105,0)
 D EN^VALM("GMPL DETAILED DISPLAY")
"RTN","GMPL",106,0)
 S VALMBCK="R"
"RTN","GMPL",107,0)
EXPQ D KILL^GMPLX S VALMSG=$$MSG^GMPLX S:'VALMCC VALMBCK="R"
"RTN","GMPL",108,0)
 Q
"RTN","GMPL1")
0^21^B42997601
"RTN","GMPL1",1,0)
GMPL1 ; SLC/MKB/AJB/TC -- Problem List actions ;10/04/17  06:46
"RTN","GMPL1",2,0)
 ;;2.0;Problem List;**3,20,28,43,42,45,49**;Aug 25, 1994;Build 43
"RTN","GMPL1",3,0)
 ; 10 MAR 2000 - MA - Added to the routine another user prompt
"RTN","GMPL1",4,0)
 ; to backup and refine Lexicon search if ICD code 799.9 or R69.
"RTN","GMPL1",5,0)
ADD ;add new entry to list - Requires GMPDFN
"RTN","GMPL1",6,0)
 N GMPROB,GMPTERM,GMPICD,Y,DUP,GMPIMPDT W !
"RTN","GMPL1",7,0)
 S GMPIMPDT=$$IMPDATE^LEXU("10D")
"RTN","GMPL1",8,0)
 S GMPROB=$$TEXT^GMPLEDT4("") I GMPROB="^" S GMPQUIT=1 Q
"RTN","GMPL1",9,0)
 I 'GMPARAM("CLU")!('$D(GMPLUSER)&('$D(^XUSEC("GMPL ICD CODE",DUZ)))) S GMPTERM="",GMPICD=$S(DT<GMPIMPDT:"799.9",1:"R69.") G ADD1
"RTN","GMPL1",10,0)
 F  D  Q:$D(GMPQUIT)!(+$G(Y))
"RTN","GMPL1",11,0)
 . D SEARCH^GMPLX(.GMPROB,.Y,"PROBLEM: ","1")
"RTN","GMPL1",12,0)
 . I +Y'>0 S GMPQUIT=1 Q
"RTN","GMPL1",13,0)
 . S DUP=$$DUPL^GMPLX(+GMPDFN,+Y,GMPROB)
"RTN","GMPL1",14,0)
 . I DUP,'$$DUPLOK^GMPLX(DUP) S (Y,GMPROB)=""
"RTN","GMPL1",15,0)
 . I +Y=1 D ICDMSG
"RTN","GMPL1",16,0)
 Q:$D(GMPQUIT)
"RTN","GMPL1",17,0)
 S GMPTERM=$S(+$G(Y)>1:Y,1:""),GMPICD=$G(Y(1))
"RTN","GMPL1",18,0)
 S:'$L(GMPICD) GMPICD=$S(DT<GMPIMPDT:"799.9",1:"R69.")
"RTN","GMPL1",19,0)
ADD1 ; set up default values
"RTN","GMPL1",20,0)
 ; -- May enter here with GMPROB=text,GMPICD=code,GMPTERM=#^term
"RTN","GMPL1",21,0)
 ; added for Code Set Versioning (CSV)
"RTN","GMPL1",22,0)
 N I,GMPSTAT,GMPCSREC,GMPCSPTR,GMPCSNME,GMPSCTC,GMPSCTD,GMPTXT,GMPTYP,GMPNUM,GMPQT,GMPSYN
"RTN","GMPL1",23,0)
 S (GMPSCTC,GMPSCTD,GMPTXT,GMPTYP)="",(GMPNUM,GMPQT)=0
"RTN","GMPL1",24,0)
 I GMPICD["/" F I=1:1:$L(GMPICD,"/") D  Q:GMPSTAT
"RTN","GMPL1",25,0)
 . N GMPCODE S GMPCODE=$P(GMPICD,"/",I),GMPSTAT=0
"RTN","GMPL1",26,0)
 . S GMPCSREC=$$CODECS^ICDEX(GMPCODE,80,DT),GMPCSPTR=$P(GMPCSREC,U),GMPCSNME=$P(GMPCSREC,U,2)
"RTN","GMPL1",27,0)
 . S:'+$$STATCHK^ICDXCODE(GMPCSPTR,GMPCODE,DT) GMPSTAT=1
"RTN","GMPL1",28,0)
 E  D
"RTN","GMPL1",29,0)
 . S GMPSTAT=0,GMPCSREC=$$CODECS^ICDEX(GMPICD,80,DT),GMPCSPTR=$P(GMPCSREC,U),GMPCSNME=$P(GMPCSREC,U,2)
"RTN","GMPL1",30,0)
 . S:'+$$STATCHK^ICDXCODE(GMPCSPTR,GMPICD,DT) GMPSTAT=1
"RTN","GMPL1",31,0)
 I GMPSTAT W !,GMPROB,!,"has an inactive ICD code.  Please edit before adding." H 3 Q
"RTN","GMPL1",32,0)
 I (GMPROB["(SCT"),(GMPROB[")") D
"RTN","GMPL1",33,0)
 . S GMPSCTC=$$ONE^LEXU(+GMPTERM,DT,"SCT")
"RTN","GMPL1",34,0)
 . I 'GMPSCTC S GMPSCTC=$P($P(GMPROB,"SCT ",2),")")
"RTN","GMPL1",35,0)
 . S GMPTXT=$$STRIPSPC^GMPLX($$TRIM^XLFSTR($RE($P($RE(GMPROB),"(",2,99))))
"RTN","GMPL1",36,0)
 . S GMPSCTD=$$GETSYN^LEXTRAN1("SCT",GMPSCTC,DT,"GMPSYN",1,1)
"RTN","GMPL1",37,0)
 . I $P(GMPSCTD,U)'=1 S GMPSCTD="" Q
"RTN","GMPL1",38,0)
 . F  S GMPTYP=$O(GMPSYN(GMPTYP)) Q:GMPTYP=""!(GMPQT)  D
"RTN","GMPL1",39,0)
 . . I GMPTYP="S" F  S GMPNUM=$O(GMPSYN(GMPTYP,GMPNUM)) Q:GMPNUM=""!(GMPQT)  D
"RTN","GMPL1",40,0)
 . . . I $$STRIPSPC^GMPLX($P(GMPSYN(GMPTYP,GMPNUM),U))=GMPTXT S GMPSCTD=$P(GMPSYN(GMPTYP,GMPNUM),U,3),GMPQT=1 Q
"RTN","GMPL1",41,0)
 . . I (GMPNUM=""),(GMPSCTD="") S GMPQT=1 Q
"RTN","GMPL1",42,0)
 . . Q:GMPQT
"RTN","GMPL1",43,0)
 . . I $$STRIPSPC^GMPLX($P(GMPSYN(GMPTYP),U))=GMPTXT S GMPSCTD=$P(GMPSYN(GMPTYP),U,3),GMPQT=1 Q
"RTN","GMPL1",44,0)
 N OK,GMPI,GMPFLD K GMPLJUMP,GMPSYN
"RTN","GMPL1",45,0)
 S GMPFLD(1.01)=GMPTERM,GMPFLD(.05)=U_GMPROB
"RTN","GMPL1",46,0)
 S GMPFLD(.01)=$P($$ICDDATA^ICDXCODE(GMPCSPTR,$P(GMPICD,"/"),DT,"E"),U)_U_GMPICD
"RTN","GMPL1",47,0)
 S GMPFLD(80202)=$$SAB^ICDEX(GMPCSPTR,DT)_U_$G(GMPCSNME)
"RTN","GMPL1",48,0)
 S:'GMPFLD(.01)!($P(GMPFLD(.01),U)<0) GMPFLD(.01)=$$NOS^GMPLX($P(GMPFLD(80202),U),DT) ; cannot resolve code
"RTN","GMPL1",49,0)
 S (GMPFLD(1.04),GMPFLD(1.05))=$G(GMPROV),GMPFLD(1.03)=DUZ
"RTN","GMPL1",50,0)
 S GMPFLD(1.06)=$$SERVICE^GMPLX1(+GMPFLD(1.04)),GMPFLD(1.08)=$G(GMPCLIN)
"RTN","GMPL1",51,0)
 S (GMPFLD(.08),GMPFLD(80201),GMPFLD(1.09))=DT_U_$$EXTDT^GMPLX(DT)
"RTN","GMPL1",52,0)
 S GMPFLD(.12)="A^ACTIVE",GMPFLD(1.14)="",GMPFLD(10,0)=0
"RTN","GMPL1",53,0)
 S GMPFLD(1.02)=$S('$G(GMPARAM("VER")):"P",$D(GMPLUSER):"P",1:"T")
"RTN","GMPL1",54,0)
 S (GMPFLD(.13),GMPFLD(1.07))="" ; initialize dates
"RTN","GMPL1",55,0)
 S GMPFLD(1.1)=$S('GMPSC:"0^NO",1:""),GMPFLD(1.11)=$S('GMPAGTOR:"0^NO",1:"")
"RTN","GMPL1",56,0)
 S GMPFLD(1.12)=$S('GMPION:"0^NO",1:""),GMPFLD(1.13)=$S('GMPGULF:"0^NO",1:"")
"RTN","GMPL1",57,0)
 S GMPFLD(80001)=GMPSCTC_U_GMPSCTC,GMPFLD(80002)=GMPSCTD_U_GMPSCTD
"RTN","GMPL1",58,0)
ADD2 ; prompt for values
"RTN","GMPL1",59,0)
 D FLDS^GMPLEDT3 ; set GMPFLD("FLD") of editable fields
"RTN","GMPL1",60,0)
 F GMPI=2:1:7 D @(GMPFLD("FLD",GMPI)_"^GMPLEDT1") Q:$D(GMPQUIT)  K GMPLJUMP ; cannot ^-jump here
"RTN","GMPL1",61,0)
 Q:$D(GMPQUIT)
"RTN","GMPL1",62,0)
ADD3 ; Ok to save?
"RTN","GMPL1",63,0)
 S OK=$$ACCEPT^GMPLDIS1(.GMPFLD),GMPLJUMP=0 ; ok to save values?
"RTN","GMPL1",64,0)
 I OK="^" W !!?10,"< Nothing Saved !! >",! S GMPQUIT=1 H 1 Q
"RTN","GMPL1",65,0)
 I OK D  Q  ; ck DA for error?
"RTN","GMPL1",66,0)
 . N I W !!,"Saving ..." D NEW^GMPLSAVE
"RTN","GMPL1",67,0)
 . S I=$S(GMPLIST(0)'>0:1,GMPARAM("REV"):$O(GMPLIST(0))-.01,1:GMPLIST(0)+1)
"RTN","GMPL1",68,0)
 . S GMPLIST(I)=DA,GMPLIST("B",DA)=I,GMPLIST(0)=$G(GMPLIST(0))+1
"RTN","GMPL1",69,0)
 . W " done."
"RTN","GMPL1",70,0)
 ; Not ok -- edit values, ask again
"RTN","GMPL1",71,0)
 F GMPI=1:1:GMPFLD("FLD",0) D @(GMPFLD("FLD",GMPI)_"^GMPLEDT1") Q:$D(GMPQUIT)!($D(GMPSAVED))  I $G(GMPLJUMP) S GMPI=GMPLJUMP-1 S GMPLJUMP=0 ; reset GMPI to desired fld
"RTN","GMPL1",72,0)
 Q:$D(DTOUT)  K GMPQUIT,DUOUT G ADD3
"RTN","GMPL1",73,0)
 Q
"RTN","GMPL1",74,0)
 ;
"RTN","GMPL1",75,0)
 ; *********************************************************************
"RTN","GMPL1",76,0)
 ; *  GMPIFN expected for the following calls:
"RTN","GMPL1",77,0)
 ;
"RTN","GMPL1",78,0)
STATUS ; -- inactivate problem
"RTN","GMPL1",79,0)
 N DIE,DA,DR,X,Y,CHNGE,GMPFLD,PROMPT,DEFAULT
"RTN","GMPL1",80,0)
 S GMPFLD(.13)=$P($G(^AUPNPROB(GMPIFN,0)),U,13) ; Onset
"RTN","GMPL1",81,0)
 W !!,$$PROBTEXT^GMPLX(GMPIFN) D RESOLVED^GMPLEDT4 Q:$D(GMPQUIT)
"RTN","GMPL1",82,0)
 S PROMPT="COMMENT (<60 char): ",DEFAULT="" D EDNOTE^GMPLEDT4 Q:$D(GMPQUIT)
"RTN","GMPL1",83,0)
 W ! I Y'="" S GMPFLD(10,"NEW",1)=Y D NEWNOTE^GMPLSAVE W "."
"RTN","GMPL1",84,0)
 S DIE="^AUPNPROB(",DR=".12///I;1.07////"_$P($G(GMPFLD(1.07)),U)
"RTN","GMPL1",85,0)
 S DA=GMPIFN D ^DIE W "."
"RTN","GMPL1",86,0)
 S CHNGE=GMPIFN_"^.12^"_$$HTFM^XLFDT($H)_U_DUZ_"^A^I^^"_+$G(GMPROV)
"RTN","GMPL1",87,0)
 D AUDIT^GMPLX(CHNGE,"") W "." ; audit trail
"RTN","GMPL1",88,0)
 D DTMOD^GMPLX(GMPIFN) W "." ; update Dt Last Mod
"RTN","GMPL1",89,0)
 W "... inactivated!",!
"RTN","GMPL1",90,0)
 H 1 S GMPSAVED=1
"RTN","GMPL1",91,0)
 Q
"RTN","GMPL1",92,0)
 ;
"RTN","GMPL1",93,0)
NEWNOTE ; -- add a new comment
"RTN","GMPL1",94,0)
 N GMPFLD
"RTN","GMPL1",95,0)
 W !!,$$PROBTEXT^GMPLX(GMPIFN)
"RTN","GMPL1",96,0)
 D NOTE^GMPLEDT1 Q:$D(GMPQUIT)!($D(GMPFLD(10,"NEW"))'>9)
"RTN","GMPL1",97,0)
 D NEWNOTE^GMPLSAVE,DTMOD^GMPLX(GMPIFN)
"RTN","GMPL1",98,0)
 S GMPSAVED=1
"RTN","GMPL1",99,0)
 Q
"RTN","GMPL1",100,0)
 ;
"RTN","GMPL1",101,0)
DELETE ; -- delete a problem
"RTN","GMPL1",102,0)
 N PROMPT,DEFAULT,X,Y,CHNGE,GMPFLD
"RTN","GMPL1",103,0)
 W !!,$$PROBTEXT^GMPLX(GMPIFN)
"RTN","GMPL1",104,0)
 S PROMPT="REASON FOR REMOVAL: ",DEFAULT=""
"RTN","GMPL1",105,0)
 D EDNOTE^GMPLEDT4 Q:$D(GMPQUIT)  W !
"RTN","GMPL1",106,0)
 I Y'="" S GMPFLD(10,"NEW",1)=Y D NEWNOTE^GMPLSAVE W "."
"RTN","GMPL1",107,0)
 S CHNGE=GMPIFN_"^1.02^"_$$HTFM^XLFDT($H)_U_DUZ_"^P^H^Deleted^"_+$G(GMPROV)
"RTN","GMPL1",108,0)
 S $P(^AUPNPROB(GMPIFN,1),U,2)="H",GMPSAVED=1 W "."
"RTN","GMPL1",109,0)
 D AUDIT^GMPLX(CHNGE,""),DTMOD^GMPLX(GMPIFN) W "."
"RTN","GMPL1",110,0)
 W "... removed!",! H 1
"RTN","GMPL1",111,0)
 Q
"RTN","GMPL1",112,0)
 ;
"RTN","GMPL1",113,0)
VERIFY ; -- verify a transcribed problem, if parameter on
"RTN","GMPL1",114,0)
 N NOW,CHNGE S NOW=$$HTFM^XLFDT($H)
"RTN","GMPL1",115,0)
 W !!,$$PROBTEXT^GMPLX(GMPIFN),!
"RTN","GMPL1",116,0)
 I '$$CODESTS^GMPLX(GMPIFN,DT) W "has an inactive ICD code. Edit the problem before verification.",! H 2 Q
"RTN","GMPL1",117,0)
 I $P($G(^AUPNPROB(GMPIFN,1)),U,2)'="T" W "does not require verification.",! H 2 Q
"RTN","GMPL1",118,0)
 L +^AUPNPROB(GMPIFN,0):1 I '$T W $C(7),$$LOCKED^GMPLX,! H 2 Q
"RTN","GMPL1",119,0)
 S $P(^AUPNPROB(GMPIFN,1),U,2)="P",GMPSAVED=1 W "."
"RTN","GMPL1",120,0)
 S CHNGE=GMPIFN_"^1.02^"_NOW_U_DUZ_"^T^P^Verified^"_DUZ W "."
"RTN","GMPL1",121,0)
 D AUDIT^GMPLX(CHNGE,""),DTMOD^GMPLX(GMPIFN) W "."
"RTN","GMPL1",122,0)
 L -^AUPNPROB(GMPIFN,0) W " verified.",!
"RTN","GMPL1",123,0)
 Q
"RTN","GMPL1",124,0)
ICDMSG ; If Lexicon returns ICD code 799.9 or R69.
"RTN","GMPL1",125,0)
 N DIR,DTOUT,DUOUT,GMPLY,GMPROB,GMPCODE,GMPDESC,GMPIMPDT
"RTN","GMPL1",126,0)
 S GMPIMPDT=$$IMPDATE^LEXU("10D"),GMPCODE=$S(DT<GMPIMPDT:"799.9",1:"R69. ")
"RTN","GMPL1",127,0)
 S GMPDESC=$S(GMPCODE="799.9":"OTHER UNKNOWN AND UNSPECIFIED CAUSE OF MORBIDITY OR MORTALITY",1:"ILLNESS, UNSPECIFIED")
"RTN","GMPL1",128,0)
 S DIR(0)="YAO"
"RTN","GMPL1",129,0)
 S DIR("A",1)="<< If you PROCEED WITH THIS NON SPECIFIC TERM, an ICD CODE OF"_GMPCODE_" >>"
"RTN","GMPL1",130,0)
 I GMPCODE="799.9" D
"RTN","GMPL1",131,0)
 . S DIR("A",2)="<< "_GMPDESC_"    >>"
"RTN","GMPL1",132,0)
 . S DIR("A",3)="<< will be assigned.  Adding more specificity to your diagnosis may >>"
"RTN","GMPL1",133,0)
 . S DIR("A",4)="<< allow a more accurate ICD code.                                  >>"
"RTN","GMPL1",134,0)
 . S DIR("A",5)=""
"RTN","GMPL1",135,0)
 E  D
"RTN","GMPL1",136,0)
 . S DIR("A",2)="<< "_GMPDESC_" will be assigned.  Adding more specificity  >>"
"RTN","GMPL1",137,0)
 . S DIR("A",3)="<< to your diagnosis may allow a more accurate ICD code.            >>"
"RTN","GMPL1",138,0)
 . S DIR("A",4)=""
"RTN","GMPL1",139,0)
 S DIR("A")="Continue (YES/NO) ",DIR("B")="NO"
"RTN","GMPL1",140,0)
 S DIR("T")=DTIME
"RTN","GMPL1",141,0)
 D ^DIR
"RTN","GMPL1",142,0)
 I $D(DTOUT)!$D(DUOUT) S Y=0
"RTN","GMPL1",143,0)
 I +Y=0 S (GMPLY,GMPROB)=""
"RTN","GMPL1",144,0)
 Q
"RTN","GMPLBLCK")
0^5^B78808461
"RTN","GMPLBLCK",1,0)
GMPLBLCK ;SLC/JFR/TC - check selection list ICD codes ;07/06/17  12:01
"RTN","GMPLBLCK",2,0)
 ;;2.0;Problem List;**28,42,49**;Aug 25, 1994;Build 43
"RTN","GMPLBLCK",3,0)
 ;
"RTN","GMPLBLCK",4,0)
 ; External References:
"RTN","GMPLBLCK",5,0)
 ;   ICR  2056   $$GET1^DIQ
"RTN","GMPLBLCK",6,0)
 ;   ICR  5747   $$CODECS^ICDEX,$$STATCHK^ICDEX,$$HIST^ICDEX
"RTN","GMPLBLCK",7,0)
 ;   ICR  10026  ^DIR
"RTN","GMPLBLCK",8,0)
 ;   ICR  10063  ^%ZTLOAD
"RTN","GMPLBLCK",9,0)
 ;   ICR  10070  ^XMD
"RTN","GMPLBLCK",10,0)
 ;   ICR  10086  %ZIS,HOME^%ZIS
"RTN","GMPLBLCK",11,0)
 ;   ICR  10089  %ZISC
"RTN","GMPLBLCK",12,0)
 ;   ICR  10103  $$DT^XLFDT,$$FMTE^XLFDT
"RTN","GMPLBLCK",13,0)
 ;   ICR  10104  $$REPEAT^XLFSTR
"RTN","GMPLBLCK",14,0)
 Q
"RTN","GMPLBLCK",15,0)
CSVPEP ;called from protocol GMPL SELECTION LIST CSV EVENT
"RTN","GMPLBLCK",16,0)
 N CAT,LN,LST,LIST,XMSUB,XMTEXT,XMDUZ,XMY
"RTN","GMPLBLCK",17,0)
 D CKLISTS,CKCODES
"RTN","GMPLBLCK",18,0)
 K ^TMP("GMPLMSG",$J)
"RTN","GMPLBLCK",19,0)
 S LN=1
"RTN","GMPLBLCK",20,0)
 I $D(^TMP("GMPLSL",$J,"I")) D
"RTN","GMPLBLCK",21,0)
 . S ^TMP("GMPLMSG",$J,LN)="The following Problem Selection Lists contain one or more problems that have",LN=LN+1
"RTN","GMPLBLCK",22,0)
 . S ^TMP("GMPLMSG",$J,LN)="inactive SNOMED and/or ICD codes attached to them. Any current users or clinics",LN=LN+1
"RTN","GMPLBLCK",23,0)
 . S ^TMP("GMPLMSG",$J,LN)="using these Selection Lists, will not be able to add the problems with inactive",LN=LN+1
"RTN","GMPLBLCK",24,0)
 . S ^TMP("GMPLMSG",$J,LN)="codes, until the list and the inactive codes are updated. The list may not be",LN=LN+1
"RTN","GMPLBLCK",25,0)
 . S ^TMP("GMPLMSG",$J,LN)="assigned to any additional users or clinics until updated.",LN=LN+1
"RTN","GMPLBLCK",26,0)
 . S LST=0
"RTN","GMPLBLCK",27,0)
 . F  S LST=$O(^TMP("GMPLSL",$J,"I",LST)) Q:'LST  D
"RTN","GMPLBLCK",28,0)
 .. S ^TMP("GMPLMSG",$J,LN)="   "_^TMP("GMPLSL",$J,"I",LST)
"RTN","GMPLBLCK",29,0)
 .. S LN=LN+1
"RTN","GMPLBLCK",30,0)
 ;
"RTN","GMPLBLCK",31,0)
 I $D(^TMP("GMPLSL",$J,"F")) D  ;no future inact. dates
"RTN","GMPLBLCK",32,0)
 . S ^TMP("GMPLMSG",$J,LN)="",LN=LN+1
"RTN","GMPLBLCK",33,0)
 . S ^TMP("GMPLMSG",$J,LN)="",LN=LN+1
"RTN","GMPLBLCK",34,0)
 . S ^TMP("GMPLMSG",$J,LN)="The following Problem Selection List categories contain problems with ICD",LN=LN+1
"RTN","GMPLBLCK",35,0)
 . S ^TMP("GMPLMSG",$J,LN)="codes that have a future inactivation date. These Categories should be updated",LN=LN+1
"RTN","GMPLBLCK",36,0)
 . S ^TMP("GMPLMSG",$J,LN)="as soon as possible after the inactivation date to reduce the interruption of",LN=LN+1
"RTN","GMPLBLCK",37,0)
 . S ^TMP("GMPLMSG",$J,LN)="use of the selection list(s) by users or clinics.",LN=LN+1
"RTN","GMPLBLCK",38,0)
 . S ^TMP("GMPLMSG",$J,LN)="",LN=LN+1
"RTN","GMPLBLCK",39,0)
 . S CAT=0
"RTN","GMPLBLCK",40,0)
 . F  S CAT=$O(^TMP("GMPLSL",$J,"F",CAT)) Q:'CAT  D
"RTN","GMPLBLCK",41,0)
 .. S ^TMP("GMPLMSG",$J,LN)=" Category name: "_$$GET1^DIQ(125.11,CAT,.01)
"RTN","GMPLBLCK",42,0)
 .. S LN=LN+1
"RTN","GMPLBLCK",43,0)
 .. S ^TMP("GMPLMSG",$J,LN)="",LN=LN+1
"RTN","GMPLBLCK",44,0)
 .. S ^TMP("GMPLMSG",$J,LN)="    Problems with ICD codes due to be inactivated:",LN=LN+1
"RTN","GMPLBLCK",45,0)
 .. S ^TMP("GMPLMSG",$J,LN)="",LN=LN+1
"RTN","GMPLBLCK",46,0)
 .. N PROB,TXT
"RTN","GMPLBLCK",47,0)
 .. S PROB=0
"RTN","GMPLBLCK",48,0)
 .. F  S PROB=$O(^TMP("GMPLSL",$J,"F",CAT,PROB)) Q:'PROB  D
"RTN","GMPLBLCK",49,0)
 ... S TXT=^TMP("GMPLSL",$J,"F",CAT,PROB)
"RTN","GMPLBLCK",50,0)
 ... S ^TMP("GMPLMSG",$J,LN)="       Problem text: "_$P(TXT,U),LN=LN+1
"RTN","GMPLBLCK",51,0)
 ... S ^TMP("GMPLMSG",$J,LN)="       Display text: "_$P(TXT,U,2),LN=LN+1
"RTN","GMPLBLCK",52,0)
 ... S ^TMP("GMPLMSG",$J,LN)="               Code: "_$P(TXT,U,3),LN=LN+1
"RTN","GMPLBLCK",53,0)
 ... S ^TMP("GMPLMSG",$J,LN)="      Inactive Date: "_$$FMTE^XLFDT($P(TXT,U,4),2),LN=LN+1
"RTN","GMPLBLCK",54,0)
 ... S ^TMP("GMPLMSG",$J,LN)="",LN=LN+1
"RTN","GMPLBLCK",55,0)
 .. I '$D(^TMP("GMPLSL",$J,"F",CAT,"L")) Q  ; category not part of lists
"RTN","GMPLBLCK",56,0)
 .. S ^TMP("GMPLMSG",$J,LN)="",LN=LN+1
"RTN","GMPLBLCK",57,0)
 .. S ^TMP("GMPLMSG",$J,LN)="    This Category is part of the following Problem Selection Lists:",LN=LN+1
"RTN","GMPLBLCK",58,0)
 .. S LIST=0
"RTN","GMPLBLCK",59,0)
 .. F  S LIST=$O(^TMP("GMPLSL",$J,"F",CAT,"L",LIST)) Q:'LIST  D
"RTN","GMPLBLCK",60,0)
 ... S ^TMP("GMPLMSG",$J,LN)="     "_^TMP("GMPLSL",$J,"F",CAT,"L",LIST)
"RTN","GMPLBLCK",61,0)
 ... S LN=LN+1
"RTN","GMPLBLCK",62,0)
 .. S ^TMP("GMPLMSG",$J,LN)="",LN=LN+1
"RTN","GMPLBLCK",63,0)
 .. S ^TMP("GMPLMSG",$J,LN)="",LN=LN+1
"RTN","GMPLBLCK",64,0)
 .. Q
"RTN","GMPLBLCK",65,0)
 I '$D(^TMP("GMPLSL",$J)) D  ; no problems found
"RTN","GMPLBLCK",66,0)
 . S ^TMP("GMPLMSG",$J,LN)="No Problems Selection List corrections/review required"
"RTN","GMPLBLCK",67,0)
 . S LN=LN+1
"RTN","GMPLBLCK",68,0)
 S XMY("G.GMPL CODE SET VERSION UPDATES")=""
"RTN","GMPLBLCK",69,0)
 S XMSUB="Problem Selection List Code Set Version review"
"RTN","GMPLBLCK",70,0)
 S XMDUZ="Code Set Version Install"
"RTN","GMPLBLCK",71,0)
 S XMTEXT="^TMP(""GMPLMSG"",$J,"
"RTN","GMPLBLCK",72,0)
 D ^XMD
"RTN","GMPLBLCK",73,0)
 K ^TMP("GMPLSL",$J),^TMP("GMPLMSG",$J)
"RTN","GMPLBLCK",74,0)
 Q
"RTN","GMPLBLCK",75,0)
 ;
"RTN","GMPLBLCK",76,0)
CSVOPT ; called from option GMPL SELECTION LIST CSV CHECK
"RTN","GMPLBLCK",77,0)
 ;
"RTN","GMPLBLCK",78,0)
 N %ZIS,POP
"RTN","GMPLBLCK",79,0)
 S %ZIS="QM" D ^%ZIS Q:POP
"RTN","GMPLBLCK",80,0)
 I $D(IO("Q")) D  D ^%ZISC,HOME^%ZIS Q
"RTN","GMPLBLCK",81,0)
 . N ZTRTN,ZTDESC,ZTIO,ZTDTH,ZTSK
"RTN","GMPLBLCK",82,0)
 . S ZTDESC="Review of GMPL SEL LISTS for CSV"
"RTN","GMPLBLCK",83,0)
 . S ZTRTN="QUEUE^GMPLBLCK",ZTIO=ION,ZTDTH=$H
"RTN","GMPLBLCK",84,0)
 . D ^%ZTLOAD
"RTN","GMPLBLCK",85,0)
 . I '$G(ZTSK) W !,"Unable to task report"
"RTN","GMPLBLCK",86,0)
 . Q
"RTN","GMPLBLCK",87,0)
 ;
"RTN","GMPLBLCK",88,0)
QUEUE ; entry point for tasked report
"RTN","GMPLBLCK",89,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","GMPLBLCK",90,0)
 U IO
"RTN","GMPLBLCK",91,0)
 N CAT,LN,GMPLST,LIST,PAGE,GMPLCAT,GMPLI,GMPLTITL
"RTN","GMPLBLCK",92,0)
 D CKLISTS,CKCODES
"RTN","GMPLBLCK",93,0)
 S GMPLTITL="Code Set Version Review of Problem Selection Lists"
"RTN","GMPLBLCK",94,0)
 S PAGE=1 D PAGE^GMPLSLRP(.PAGE,GMPLTITL)
"RTN","GMPLBLCK",95,0)
 I '$D(^TMP("GMPLSL",$J)) D  ; no problems found
"RTN","GMPLBLCK",96,0)
 . W !,"No Problems Selection List corrections/review required"
"RTN","GMPLBLCK",97,0)
 . I $E(IOST,1,2)="C-" D
"RTN","GMPLBLCK",98,0)
 .. N DIR,DTOUT,DIRUT,DUOUT,X,Y
"RTN","GMPLBLCK",99,0)
 .. S DIR(0)="E" D ^DIR
"RTN","GMPLBLCK",100,0)
 . Q
"RTN","GMPLBLCK",101,0)
 ;
"RTN","GMPLBLCK",102,0)
 I $D(^TMP("GMPLSL",$J,"I")) D  ; some inactive problem codes
"RTN","GMPLBLCK",103,0)
 . W !,"The following Problem Selection List(s) contain one or more problems that have"
"RTN","GMPLBLCK",104,0)
 . W !,"inactive SNOMED and/or ICD codes attached to them. Any current users or clinics"
"RTN","GMPLBLCK",105,0)
 . W !,"using these Selection Lists, will not be able to add the problems with inactive"
"RTN","GMPLBLCK",106,0)
 . W !,"codes, until the list and the inactive codes are updated. The list may not be"
"RTN","GMPLBLCK",107,0)
 . W !,"assigned to any additional users or clinics until updated.",!
"RTN","GMPLBLCK",108,0)
 . S (GMPLST,GMPLCAT,GMPLI)=0
"RTN","GMPLBLCK",109,0)
 . F  S GMPLST=$O(^TMP("GMPLSL",$J,"I",GMPLST)) Q:GMPLST=""!(PAGE<1)  D
"RTN","GMPLBLCK",110,0)
 . . W !!," "_GMPLST_":"
"RTN","GMPLBLCK",111,0)
 . . F  S GMPLCAT=$O(^TMP("GMPLSL",$J,"I",GMPLST,GMPLCAT)) Q:GMPLCAT=""!(PAGE<1)  D
"RTN","GMPLBLCK",112,0)
 . . . W !,"   "_GMPLCAT_":"
"RTN","GMPLBLCK",113,0)
 . . . F  S GMPLI=$O(^TMP("GMPLSL",$J,"I",GMPLST,GMPLCAT,GMPLI)) Q:GMPLI=""!(PAGE<1)  D
"RTN","GMPLBLCK",114,0)
 . . . . I IOSL-$Y<3 D PAGE^GMPLSLRP(.PAGE,GMPLTITL) Q:'PAGE
"RTN","GMPLBLCK",115,0)
 . . . . N GMPLREC,GMPLDTXT,GMPLICD,GMPLCSYS,GMPLPROB,GMPLTEXT,GMPLK
"RTN","GMPLBLCK",116,0)
 . . . . S GMPLREC=$G(^TMP("GMPLSL",$J,"I",GMPLST,GMPLCAT,GMPLI)),GMPLK=0
"RTN","GMPLBLCK",117,0)
 . . . . S GMPLDTXT=$P(GMPLREC,U),GMPLICD=$P(GMPLREC,U,2),GMPLCSYS=$P(GMPLREC,U,3)
"RTN","GMPLBLCK",118,0)
 . . . . S GMPLPROB="     "_GMPLDTXT_" "_GMPLICD_"   <INACTIVE "_GMPLCSYS_" CODE>"
"RTN","GMPLBLCK",119,0)
 . . . . D WRAP^GMPLX(GMPLPROB,79,.GMPLTEXT)
"RTN","GMPLBLCK",120,0)
 . . . . F  S GMPLK=$O(GMPLTEXT(GMPLK)) Q:GMPLK=""  D
"RTN","GMPLBLCK",121,0)
 . . . . . W !,$S(GMPLK>1:"     "_GMPLTEXT(GMPLK),1:GMPLTEXT(GMPLK))
"RTN","GMPLBLCK",122,0)
 ;
"RTN","GMPLBLCK",123,0)
 I $D(^TMP("GMPLSL",$J,"F")) D  ; future inact. dates
"RTN","GMPLBLCK",124,0)
 . D PAGE^GMPLSLRP(.PAGE,GMPLTITL) Q:'PAGE
"RTN","GMPLBLCK",125,0)
 . W !,"The following Problem Selection List categories contain problems with ICD"
"RTN","GMPLBLCK",126,0)
 . W !,"codes that have a future inactivation date. These Categories should be updated"
"RTN","GMPLBLCK",127,0)
 . W !,"as soon as possible after the inactivation date to reduce the interruption of"
"RTN","GMPLBLCK",128,0)
 . W !,"use of the selection list(s) by users or clinics.",!
"RTN","GMPLBLCK",129,0)
 . S CAT=0
"RTN","GMPLBLCK",130,0)
 . F  S CAT=$O(^TMP("GMPLSL",$J,"F",CAT)) Q:'CAT  D
"RTN","GMPLBLCK",131,0)
 .. I IOSL-$Y<8 D PAGE^GMPLSLRP(.PAGE,GMPLTITL) Q:'PAGE
"RTN","GMPLBLCK",132,0)
 .. W !!!," Category name: "_$$GET1^DIQ(125.11,CAT,.01),!
"RTN","GMPLBLCK",133,0)
 .. W !,"    Problems with ICD codes due to be inactivated:",!
"RTN","GMPLBLCK",134,0)
 .. N PROB,TXT
"RTN","GMPLBLCK",135,0)
 .. S PROB=0
"RTN","GMPLBLCK",136,0)
 .. F  S PROB=$O(^TMP("GMPLSL",$J,"F",CAT,PROB)) Q:'PROB!(PAGE<1)  D
"RTN","GMPLBLCK",137,0)
 ... S TXT=^TMP("GMPLSL",$J,"F",CAT,PROB)
"RTN","GMPLBLCK",138,0)
 ... I IOSL-$Y<5 D PAGE^GMPLSLRP(.PAGE,GMPLTITL) Q:'PAGE
"RTN","GMPLBLCK",139,0)
 ... W !,"       Problem text: "_$P(TXT,U)
"RTN","GMPLBLCK",140,0)
 ... W !,"       Display text: "_$P(TXT,U,2)
"RTN","GMPLBLCK",141,0)
 ... W !,"               Code: "_$P(TXT,U,3)
"RTN","GMPLBLCK",142,0)
 ... W !,"      Inactive Date: "_$P(TXT,U,4),!
"RTN","GMPLBLCK",143,0)
 .. I '$D(^TMP("GMPLSL",$J,"F",CAT,"L")) Q  ; category not part of lists
"RTN","GMPLBLCK",144,0)
 .. I IOSL-$Y<3 D PAGE^GMPLSLRP(.PAGE,GMPLTITL) Q:'PAGE
"RTN","GMPLBLCK",145,0)
 .. W !!,"    This Category is part of the following Problem Selection Lists:",!
"RTN","GMPLBLCK",146,0)
 .. S LIST=0
"RTN","GMPLBLCK",147,0)
 .. F  S LIST=$O(^TMP("GMPLSL",$J,"F",CAT,"L",LIST)) Q:'LIST!(PAGE<1)  D
"RTN","GMPLBLCK",148,0)
 ... I IOSL-$Y<3 D PAGE^GMPLSLRP(.PAGE,GMPLTITL) Q:'PAGE
"RTN","GMPLBLCK",149,0)
 ... W !,"     "_^TMP("GMPLSL",$J,"F",CAT,"L",LIST)
"RTN","GMPLBLCK",150,0)
 .. Q
"RTN","GMPLBLCK",151,0)
 . Q
"RTN","GMPLBLCK",152,0)
 D:$E(IOST,1,2)'="C-" ^%ZISC
"RTN","GMPLBLCK",153,0)
 D HOME^%ZIS
"RTN","GMPLBLCK",154,0)
 K ^TMP("GMPLSL",$J)
"RTN","GMPLBLCK",155,0)
 Q
"RTN","GMPLBLCK",156,0)
 ;
"RTN","GMPLBLCK",157,0)
CKLISTS ; loop lists and see if any inactive problems
"RTN","GMPLBLCK",158,0)
 ;
"RTN","GMPLBLCK",159,0)
 ; returns ^TMP("GMPLSL",$J,"I"
"RTN","GMPLBLCK",160,0)
 ;
"RTN","GMPLBLCK",161,0)
 K ^TMP("GMPLSL",$J,"I")
"RTN","GMPLBLCK",162,0)
 N LST,GMPLCNME,GMPLSEQ,GMPLREC,GMPLCNT
"RTN","GMPLBLCK",163,0)
 S (LST,GMPLCNME,GMPLSEQ)=0
"RTN","GMPLBLCK",164,0)
 F  S LST=$O(^GMPL(125,LST)) Q:'LST  D
"RTN","GMPLBLCK",165,0)
 . N GMPLCLST
"RTN","GMPLBLCK",166,0)
 . I '$$VALLIST^GMPLBLD2(LST,"GMPLCLST") D
"RTN","GMPLBLCK",167,0)
 . . S GMPLCNT=0
"RTN","GMPLBLCK",168,0)
 . . I $D(GMPLCLST) D
"RTN","GMPLBLCK",169,0)
 . . . F  S GMPLCNME=$O(GMPLCLST(GMPLCNME)) Q:GMPLCNME=""  D
"RTN","GMPLBLCK",170,0)
 . . . . F  S GMPLSEQ=$O(GMPLCLST(GMPLCNME,GMPLSEQ)) Q:GMPLSEQ=""  D
"RTN","GMPLBLCK",171,0)
 . . . . . S GMPLREC=GMPLCLST(GMPLCNME,GMPLSEQ),GMPLCNT=GMPLCNT+1
"RTN","GMPLBLCK",172,0)
 . . . . . S ^TMP("GMPLSL",$J,"I",$P(^GMPL(125,LST,0),U),GMPLCNME,GMPLCNT)=$P(GMPLREC,U)_U_$P(GMPLREC,U,2)_U_$P(GMPLREC,U,3)
"RTN","GMPLBLCK",173,0)
 . Q
"RTN","GMPLBLCK",174,0)
 Q
"RTN","GMPLBLCK",175,0)
 ;
"RTN","GMPLBLCK",176,0)
CKCODES ; check probs on lists for future inactivation dates
"RTN","GMPLBLCK",177,0)
 ;
"RTN","GMPLBLCK",178,0)
 ; returns:
"RTN","GMPLBLCK",179,0)
 ;   ^TMP("GMPLSL",$J,"F",category,problem)
"RTN","GMPLBLCK",180,0)
 ;   ^TMP("GMPLSL",$J,"F",category,"L",list)
"RTN","GMPLBLCK",181,0)
 ;
"RTN","GMPLBLCK",182,0)
 K ^TMP("GMPLSL",$J,"F")
"RTN","GMPLBLCK",183,0)
 N CAT,LIST,GMPCAT,GMPPSQ,GMPDA,GMPDT
"RTN","GMPLBLCK",184,0)
 S (GMPCAT,GMPPSQ,GMPDA)=0,GMPDT=$$DT^XLFDT
"RTN","GMPLBLCK",185,0)
 F  S GMPCAT=$O(^GMPL(125.11,"C",GMPCAT)) Q:'GMPCAT  D
"RTN","GMPLBLCK",186,0)
 . F  S GMPPSQ=$O(^GMPL(125.11,"C",GMPCAT,GMPPSQ)) Q:'GMPPSQ  D
"RTN","GMPLBLCK",187,0)
 . . F  S GMPDA=$O(^GMPL(125.11,"C",GMPCAT,GMPPSQ,GMPDA)) Q:'GMPDA  D
"RTN","GMPLBLCK",188,0)
 . . . I $L($P(^GMPL(125.11,GMPCAT,1,GMPDA,0),U,4)) D
"RTN","GMPLBLCK",189,0)
 . . . . N GMPL0,GMPPROB,GMPARY,GMPADT,GMPCSPTR,GMPICD
"RTN","GMPLBLCK",190,0)
 . . . . S GMPL0=$G(^GMPL(125.11,GMPCAT,1,GMPDA,0)),GMPICD=$P(GMPL0,U,4)
"RTN","GMPLBLCK",191,0)
 . . . . S GMPCSPTR=+$$CODECS^ICDEX(GMPICD,80,GMPDT)
"RTN","GMPLBLCK",192,0)
 . . . . I '$$STATCHK^ICDEX(GMPICD,GMPDT,GMPCSPTR) Q  ;already inactive
"RTN","GMPLBLCK",193,0)
 . . . . S GMPARY=$$HIST^ICDEX(GMPICD,.GMPARY,GMPCSPTR)
"RTN","GMPLBLCK",194,0)
 . . . . S GMPADT=+$O(GMPARY(GMPDT))
"RTN","GMPLBLCK",195,0)
 . . . . Q:'GMPADT  ; no future activity
"RTN","GMPLBLCK",196,0)
 . . . . I $G(GMPARY(GMPADT)) Q  ; no future inactivation = OK
"RTN","GMPLBLCK",197,0)
 . . . . S GMPPROB=$$GET1^DIQ(125.111,""_GMPDA_","_GMPCAT_",",.01)
"RTN","GMPLBLCK",198,0)
 . . . . S ^TMP("GMPLSL",$J,"F",GMPCAT,GMPDA)=GMPPROB_U_$P(GMPL0,U,3)_U_GMPICD_U_$$FMTE^XLFDT(GMPADT)
"RTN","GMPLBLCK",199,0)
 . . . . Q
"RTN","GMPLBLCK",200,0)
 ;
"RTN","GMPLBLCK",201,0)
 ; find lists that contain the categories
"RTN","GMPLBLCK",202,0)
 S CAT=0
"RTN","GMPLBLCK",203,0)
 F  S CAT=$O(^TMP("GMPLSL",$J,"F",CAT)) Q:'CAT  D
"RTN","GMPLBLCK",204,0)
 . I '$D(^GMPL(125,"AC",CAT)) Q  ; category not part of any lists
"RTN","GMPLBLCK",205,0)
 . N LIST S LIST=0
"RTN","GMPLBLCK",206,0)
 . F  S LIST=$O(^GMPL(125,"AC",CAT,LIST)) Q:'LIST  D
"RTN","GMPLBLCK",207,0)
 .. S ^TMP("GMPLSL",$J,"F",CAT,"L",LIST)=$$GET1^DIQ(125,LIST,.01)
"RTN","GMPLBLCK",208,0)
 .. Q
"RTN","GMPLBLCK",209,0)
 . Q
"RTN","GMPLBLCK",210,0)
 Q
"RTN","GMPLBLD")
0^4^B62962648
"RTN","GMPLBLD",1,0)
GMPLBLD ; SLC/MKB/TC -- Build Problem Selection Lists ;02/22/17  14:07
"RTN","GMPLBLD",2,0)
 ;;2.0;Problem List;**3,28,33,36,42,49**;Aug 25, 1994;Build 43
"RTN","GMPLBLD",3,0)
 ;
"RTN","GMPLBLD",4,0)
 ; External References:
"RTN","GMPLBLD",5,0)
 ;   ICR  2056   $$GET1^DIQ
"RTN","GMPLBLD",6,0)
 ;   ICR  4083   $$STATCHK^LEXSRC2
"RTN","GMPLBLD",7,0)
 ;   ICR  5747   $$CODECS^ICDEX,$$STATCHK^ICDEX
"RTN","GMPLBLD",8,0)
 ;   ICR  10026  ^DIR
"RTN","GMPLBLD",9,0)
 ;   ICR  10103  $$DT^XLFDT,$$FMTE^XLFDT
"RTN","GMPLBLD",10,0)
 ;   ICR  10116  FULL^VALM1
"RTN","GMPLBLD",11,0)
 ;   ICR  10117  CNTRL^VALM10
"RTN","GMPLBLD",12,0)
 ;   ICR  10118  EN^VALM
"RTN","GMPLBLD",13,0)
 ;
"RTN","GMPLBLD",14,0)
EN ; -- main entry point
"RTN","GMPLBLD",15,0)
 D EN^VALM("GMPL SELECTION LIST BUILD")
"RTN","GMPLBLD",16,0)
 Q
"RTN","GMPLBLD",17,0)
 ;
"RTN","GMPLBLD",18,0)
HDR ; -- header code
"RTN","GMPLBLD",19,0)
 N NAME,NUM,DATE
"RTN","GMPLBLD",20,0)
 S NUM=+^TMP("GMPLST",$J,0)_" categor"_$S(+^TMP("GMPLST",$J,0)'=1:"ies",1:"y")
"RTN","GMPLBLD",21,0)
 S DATE="Last Modified: "_$S(+$P(GMPLSLST,U,3):$$FMTE^XLFDT($P(GMPLSLST,U,3)),1:"<new list>")
"RTN","GMPLBLD",22,0)
 S VALMHDR(1)=DATE_$J(NUM,79-$L(DATE))
"RTN","GMPLBLD",23,0)
 S NAME=$P(GMPLSLST,U,2),VALMHDR(2)=$J(NAME,$L(NAME)\2+41)
"RTN","GMPLBLD",24,0)
 Q
"RTN","GMPLBLD",25,0)
 ;
"RTN","GMPLBLD",26,0)
INIT ; -- init variables and list array
"RTN","GMPLBLD",27,0)
 S GMPLSLST=$$LIST^GMPLBLD2("L") I GMPLSLST="^" S VALMQUIT=1 Q
"RTN","GMPLBLD",28,0)
 L +^GMPL(125,+GMPLSLST,0):1 I '$T D  G INIT
"RTN","GMPLBLD",29,0)
 . W $C(7),!!,"This list is currently being edited by another user!",!
"RTN","GMPLBLD",30,0)
 S GMPLMODE="E",VALMSG=$$MSG^GMPLX
"RTN","GMPLBLD",31,0)
 D GETLIST,BUILD("^TMP(""GMPLIST"",$J)",GMPLMODE)
"RTN","GMPLBLD",32,0)
 ;D LENGTH
"RTN","GMPLBLD",33,0)
 Q
"RTN","GMPLBLD",34,0)
 ;
"RTN","GMPLBLD",35,0)
GETLIST ; Build ^TMP("GMPLIST",$J,#)
"RTN","GMPLBLD",36,0)
 N GRP,ITEM,CNT,GMPLDA K ^TMP("GMPLIST",$J) S CNT=0,(GMPLDA,GMPLCSQ)=""
"RTN","GMPLBLD",37,0)
 W !,"Searching for the list ..."
"RTN","GMPLBLD",38,0)
 F  S GMPLCSQ=$O(^GMPL(125,"AD",+GMPLSLST,GMPLCSQ)) Q:'GMPLCSQ  D
"RTN","GMPLBLD",39,0)
 . F  S GMPLDA=$O(^GMPL(125,"AD",+GMPLSLST,GMPLCSQ,GMPLDA)) Q:GMPLDA'>0  D
"RTN","GMPLBLD",40,0)
 . . S ITEM=$G(^GMPL(125,+GMPLSLST,1,GMPLDA,0)),GRP=$P(ITEM,U,1)
"RTN","GMPLBLD",41,0)
 . . S ^TMP("GMPLIST",$J,GMPLDA)=$G(ITEM),CNT=CNT+1 ; group ^ seq ^ subhdr ^ probs
"RTN","GMPLBLD",42,0)
 . . S (^TMP("GMPLIST",$J,"GRP",GRP),^TMP("GMPLIST",$J,"SEQ",GMPLCSQ))=GMPLDA
"RTN","GMPLBLD",43,0)
 S ^TMP("GMPLIST",$J,0)=CNT
"RTN","GMPLBLD",44,0)
 Q
"RTN","GMPLBLD",45,0)
 ;
"RTN","GMPLBLD",46,0)
BUILD(LIST,MODE) ; Build ^TMP("GMPLST",$J,)
"RTN","GMPLBLD",47,0)
 N LCNT,NUM,HDR,GROUP,GMPSEQ,ITEM,IFN,PSEQ,GMPIFN,GMPLCSQ,GMPDT,GMPCLASS,GMPLSHDR,GMPLCOL D CLEAN^VALM10
"RTN","GMPLBLD",48,0)
 S:'$D(^TMP("GMPLIST",$J,0)) ^TMP("GMPLIST",$J,0)=0
"RTN","GMPLBLD",49,0)
 I $P($G(^TMP("GMPLIST",$J,0)),U,1)'>0 S ^TMP("GMPLST",$J,1,0)="   ",^TMP("GMPLST",$J,2,0)="No items available.",^TMP("GMPLST",$J,0)="0^2",VALMCNT=2 Q
"RTN","GMPLBLD",50,0)
 S (LCNT,NUM,GMPSEQ)=0,GMPDT=$$DT^XLFDT
"RTN","GMPLBLD",51,0)
 F  S GMPSEQ=$O(^TMP("GMPLIST",$J,"SEQ",GMPSEQ)) Q:GMPSEQ'>0  D
"RTN","GMPLBLD",52,0)
 . S GMPIFN=^TMP("GMPLIST",$J,"SEQ",GMPSEQ),LCNT=LCNT+1,NUM=NUM+1
"RTN","GMPLBLD",53,0)
 . S GROUP=$P(^TMP("GMPLIST",$J,GMPIFN),U,1),GMPLCSQ=$P(^TMP("GMPLIST",$J,GMPIFN),U,2)
"RTN","GMPLBLD",54,0)
 . S HDR=$P(^TMP("GMPLIST",$J,GMPIFN),U,3),GMPCLASS=$$GET1^DIQ(125.11,""_GROUP_",",.03)
"RTN","GMPLBLD",55,0)
 . S:'$L(HDR) HDR="<no header>"
"RTN","GMPLBLD",56,0)
 . S HDR=HDR_"   ("_GMPCLASS_")"
"RTN","GMPLBLD",57,0)
 . I LCNT>1,+$P(^TMP("GMPLIST",$J,GMPIFN),U,4),^TMP("GMPLST",$J,LCNT-1,0)'="   " S LCNT=LCNT+1,^TMP("GMPLST",$J,LCNT,0)="   "
"RTN","GMPLBLD",58,0)
 . S GMPLSHDR=$J(NUM,3)_" "_HDR
"RTN","GMPLBLD",59,0)
 . S ^TMP("GMPLST",$J,LCNT,0)=$S(MODE="I":"<"_GMPLCSQ_">",1:"   ")_GMPLSHDR,^TMP("GMPLST",$J,"B",NUM)=GMPIFN
"RTN","GMPLBLD",60,0)
 . S GMPLCOL=(($L(^TMP("GMPLST",$J,LCNT,0)))-($L(GMPLSHDR)))+1
"RTN","GMPLBLD",61,0)
 . D CNTRL^VALM10(LCNT,GMPLCOL,$L(GMPLSHDR),IOINHI,IOINORM)
"RTN","GMPLBLD",62,0)
 . Q:'+$P(^TMP("GMPLIST",$J,GMPIFN),U,4)
"RTN","GMPLBLD",63,0)
 . D CNTRL^VALM10(LCNT,8,$L(HDR),IOUON,IOUOFF)
"RTN","GMPLBLD",64,0)
 . F PSEQ=0:0 S PSEQ=$O(^GMPL(125.11,"C",+GROUP,PSEQ)) Q:PSEQ'>0  D
"RTN","GMPLBLD",65,0)
 .. N GMPCSYS,GMPLSCT,GMPLICD,GMPSCTC,GMPICD,GMPDTXT S (GMPLSCT,GMPLICD)=0
"RTN","GMPLBLD",66,0)
 .. S IFN=$O(^GMPL(125.11,"C",+GROUP,PSEQ,0)),LCNT=LCNT+1
"RTN","GMPLBLD",67,0)
 .. S ITEM=$G(^GMPL(125.11,+GROUP,1,IFN,0)),GMPDTXT=$P(ITEM,U,3)
"RTN","GMPLBLD",68,0)
 .. S GMPSCTC=$P(ITEM,U,5),GMPICD=$P(ITEM,U,4)
"RTN","GMPLBLD",69,0)
 .. S ^TMP("GMPLST",$J,LCNT,0)="       "_GMPDTXT
"RTN","GMPLBLD",70,0)
 .. I $L(GMPSCTC) D
"RTN","GMPLBLD",71,0)
 ... I $$STATCHK^LEXSRC2(GMPSCTC,GMPDT,"","SCT") Q
"RTN","GMPLBLD",72,0)
 ... S GMPLSCT=1
"RTN","GMPLBLD",73,0)
 .. I $L(GMPICD) D
"RTN","GMPLBLD",74,0)
 ... N GMI,GMPCSPTR,GMPCSREC,GMPCSNME
"RTN","GMPLBLD",75,0)
 ... S GMPCSREC=$$CODECS^ICDEX($P(GMPICD,"/"),80,GMPDT),GMPCSPTR=$P(GMPCSREC,U),GMPCSNME=$P(GMPCSREC,U,2)
"RTN","GMPLBLD",76,0)
 ... S ^TMP("GMPLST",$J,LCNT,0)=^TMP("GMPLST",$J,LCNT,0)_" ("_GMPCSNME_" "_GMPICD_")"
"RTN","GMPLBLD",77,0)
 ... F GMI=1:1:$L(GMPICD,"/") D
"RTN","GMPLBLD",78,0)
 .... I $$STATCHK^ICDEX($P(GMPICD,"/",GMI),GMPDT,GMPCSPTR) Q  ; code is active
"RTN","GMPLBLD",79,0)
 .... S GMPLICD=1
"RTN","GMPLBLD",80,0)
 .. S GMPCSYS=$S(GMPLSCT:"SCT",GMPLICD:"ICD",(GMPLSCT&GMPLICD):"SCT/ICD",1:"")
"RTN","GMPLBLD",81,0)
 .. S:GMPCSYS'="" ^TMP("GMPLST",$J,LCNT,0)=^TMP("GMPLST",$J,LCNT,0)_"    <INACTIVE "_GMPCSYS_" CODE>"
"RTN","GMPLBLD",82,0)
 . S LCNT=LCNT+1,^TMP("GMPLST",$J,LCNT,0)="   "
"RTN","GMPLBLD",83,0)
 S ^TMP("GMPLST",$J,0)=NUM_U_LCNT,VALMCNT=LCNT
"RTN","GMPLBLD",84,0)
 Q
"RTN","GMPLBLD",85,0)
 ;
"RTN","GMPLBLD",86,0)
HELP ; -- help code
"RTN","GMPLBLD",87,0)
 N X
"RTN","GMPLBLD",88,0)
 W !!?4,"You may take a variety of actions to update this selection list."
"RTN","GMPLBLD",89,0)
 W !?4,"New categories may be added to this list, or an existing one"
"RTN","GMPLBLD",90,0)
 W !?4,"removed; Edit Category will allow you to change the contents of"
"RTN","GMPLBLD",91,0)
 W !?4,"a category, or create a new one that may be added to this list."
"RTN","GMPLBLD",92,0)
 W !?4,"You may also change how each category appears in this list,"
"RTN","GMPLBLD",93,0)
 W !?4,"view each category's sequence number to facilitate resequencing,"
"RTN","GMPLBLD",94,0)
 W !?4,"assign this list to a clinic or user(s), or edit a different list."
"RTN","GMPLBLD",95,0)
 W !!,"Press <return> to continue ..." R X:DTIME
"RTN","GMPLBLD",96,0)
 S VALMSG=$$MSG^GMPLX,VALMBCK=$S(VALMCC:"",1:"R")
"RTN","GMPLBLD",97,0)
 Q
"RTN","GMPLBLD",98,0)
 ;
"RTN","GMPLBLD",99,0)
EXIT ; -- exit code
"RTN","GMPLBLD",100,0)
 N GMPDT
"RTN","GMPLBLD",101,0)
 I $D(GMPLSAVE),$$CKSAVE^GMPLBLD2 D
"RTN","GMPLBLD",102,0)
 . S GMPDT=$$DT^XLFDT
"RTN","GMPLBLD",103,0)
 . D SAVE^GMPLBLD2
"RTN","GMPLBLD",104,0)
 . S ^GMPL(125,+GMPLSLST,0)=$P(GMPLSLST,U,2)_U_GMPDT_U_$P(GMPLSLST,U,4)_U_$P(GMPLSLST,U,5)
"RTN","GMPLBLD",105,0)
 L -^GMPL(125,+GMPLSLST,0)
"RTN","GMPLBLD",106,0)
 K GMPLIST,GMPLST,GMPLMODE,GMPLSLST,GMPLSAVE,GMPREBLD,GMPQUIT,RT,TMPLST
"RTN","GMPLBLD",107,0)
 K ^TMP("GMPLIST",$J),^TMP("GMPLST",$J)
"RTN","GMPLBLD",108,0)
 Q
"RTN","GMPLBLD",109,0)
 ;
"RTN","GMPLBLD",110,0)
ADD ; Add group(s)
"RTN","GMPLBLD",111,0)
 N SEQ,GROUP,HDR,IFN,GMPQUIT,GMPREBLD D FULL^VALM1
"RTN","GMPLBLD",112,0)
 I $P($G(GMPLSLST),U,5)="N" W !!,"Cannot make edits to a National list." H 2 G ADQ
"RTN","GMPLBLD",113,0)
 F  D  Q:$D(GMPQUIT)  W !
"RTN","GMPLBLD",114,0)
 . S GROUP=$$GROUP^GMPLBLD2("") I GROUP="^" S GMPQUIT=1 Q
"RTN","GMPLBLD",115,0)
 . I $P(GROUP,U,4)="N" D  Q
"RTN","GMPLBLD",116,0)
 . . W !!,"Cannot add a National category to a list. Please use the Copy to New Category"
"RTN","GMPLBLD",117,0)
 . . W !,"menu action under the Enter/Edit Category menu to copy into a local category."
"RTN","GMPLBLD",118,0)
 . . H 2 G ADQ
"RTN","GMPLBLD",119,0)
 . I $D(^TMP("GMPLIST",$J,"GRP",+GROUP)) W !?4,">>>  This category is already part of this list!" Q
"RTN","GMPLBLD",120,0)
 . I '$$VALGRP^GMPLBLD2(+GROUP) D  Q
"RTN","GMPLBLD",121,0)
 . . D FULL^VALM1
"RTN","GMPLBLD",122,0)
 . . W !!,$C(7),"This category contains one or more problems with inactive SNOMED and/or ICD"
"RTN","GMPLBLD",123,0)
 . . W !,"codes. These codes must be updated before adding the category to a selection"
"RTN","GMPLBLD",124,0)
 . . W !,"list."
"RTN","GMPLBLD",125,0)
 . . N DIR,DTOUT,DIRUT,DUOUT,X,Y
"RTN","GMPLBLD",126,0)
 . . S DIR(0)="E" D ^DIR
"RTN","GMPLBLD",127,0)
 . . S VALMBCK="R"
"RTN","GMPLBLD",128,0)
 . S HDR=$$HDR^GMPLBLD1($P(GROUP,U,2)) I HDR="^" S GMPQUIT=1 Q
"RTN","GMPLBLD",129,0)
 . S RT="^TMP(""GMPLIST"",$J,""SEQ"",",SEQ=+$$LAST^GMPLBLD2(RT)+1
"RTN","GMPLBLD",130,0)
 . S SEQ=$$SEQ^GMPLBLD1(SEQ) I SEQ="^" S GMPQUIT=1 Q
"RTN","GMPLBLD",131,0)
 . S IFN=$$TMPIFN^GMPLBLD1,^TMP("GMPLIST",$J,IFN)=+GROUP_U_SEQ_U_HDR_"^1"
"RTN","GMPLBLD",132,0)
 . S (^TMP("GMPLIST",$J,"GRP",+GROUP),^TMP("GMPLIST",$J,"SEQ",SEQ))=IFN,^TMP("GMPLIST",$J,0)=^TMP("GMPLIST",$J,0)+1,GMPREBLD=1
"RTN","GMPLBLD",133,0)
 I $D(GMPREBLD) S VALMBCK="R",GMPLSAVE=1 D BUILD("^TMP(""GMPLIST"",$J)",GMPLMODE),HDR
"RTN","GMPLBLD",134,0)
ADQ S VALMBCK="R",VALMSG=$$MSG^GMPLX
"RTN","GMPLBLD",135,0)
 Q
"RTN","GMPLBLD",136,0)
 ;
"RTN","GMPLBLD",137,0)
EDIT ; Edit category contents
"RTN","GMPLBLD",138,0)
 N GMPLIST,GMPLST,GMPLMODE,GMPLGRP,GMPLSAVE
"RTN","GMPLBLD",139,0)
 I $P($G(GMPLSLST),U,5)="N" W !!,"Cannot make edits to a National list." H 2 G EDQ
"RTN","GMPLBLD",140,0)
 D EN^VALM("GMPL SELECTION GROUP BUILD")
"RTN","GMPLBLD",141,0)
 S GMPLMODE="E"
"RTN","GMPLBLD",142,0)
 D GETLIST,BUILD("TMP(""GMPLIST"",$J)",GMPLMODE)
"RTN","GMPLBLD",143,0)
EDQ S VALMBCK="R",VALMSG=$$MSG^GMPLX
"RTN","GMPLBLD",144,0)
 Q
"RTN","GMPLBLD",145,0)
 ;
"RTN","GMPLBLD",146,0)
REMOVE ; Remove group
"RTN","GMPLBLD",147,0)
 N NUM,IFN,SEQ,GRP,DIR,X,Y,GMPLCIEN S VALMBCK=""
"RTN","GMPLBLD",148,0)
 I $P($G(GMPLSLST),U,5)="N" W !!,"Cannot make edits to a National list." H 2 G RMQ
"RTN","GMPLBLD",149,0)
 S NUM=$$SEL1^GMPLBLD1 G:NUM="^" RMQ
"RTN","GMPLBLD",150,0)
 S IFN=$G(^TMP("GMPLST",$J,"B",NUM)) G:+IFN'>0 RMQ
"RTN","GMPLBLD",151,0)
 S GMPLCIEN=$P($G(^TMP("GMPLIST",$J,IFN)),U,1)
"RTN","GMPLBLD",152,0)
 I "@"[$G(^TMP("GMPLIST",$J,IFN)) W $C(7),!!,"Category is not part of this list!" H 2 G RMQ
"RTN","GMPLBLD",153,0)
 I $P(^GMPL(125.11,GMPLCIEN,0),U,3)="N",($P($G(GMPLSLST),U,5)="N") W $C(7),!!,"Category may not be removed from this National list!" H 2 G RMQ
"RTN","GMPLBLD",154,0)
 S DIR("A")="Are you sure you want to remove '"_$P(^TMP("GMPLIST",$J,IFN),U,3)_"'? "
"RTN","GMPLBLD",155,0)
 S DIR("?")="Enter YES to delete this category from the current list; enter NO to exit."
"RTN","GMPLBLD",156,0)
 S DIR(0)="YA",DIR("B")="NO" D ^DIR
"RTN","GMPLBLD",157,0)
 I 'Y W !?5,"< Nothing removed! >" H 1 G RMQ
"RTN","GMPLBLD",158,0)
 D DELETE^GMPLBLD1(IFN) S VALMBCK="R",GMPLSAVE=1
"RTN","GMPLBLD",159,0)
 D BUILD("^TMP(""GMPLIST"",$J)",GMPLMODE),HDR
"RTN","GMPLBLD",160,0)
RMQ S:'VALMCC VALMBCK="R" S VALMSG=$$MSG^GMPLX
"RTN","GMPLBLD",161,0)
 Q
"RTN","GMPLBLD",162,0)
 ;
"RTN","GMPLBLD",163,0)
LENGTH ;SHORTEN THE ICD9'S DESCRIPTION TO FIT SCREEN
"RTN","GMPLBLD",164,0)
 S LLCNT=0
"RTN","GMPLBLD",165,0)
 F  S LLCNT=$O(^TMP("GMPLST",$J,LLCNT)) Q:LLCNT=""  Q:LLCNT'?1N.N  D
"RTN","GMPLBLD",166,0)
 .; I '$D(^TMP("GMPLST",$J,LLCNT,O)) Q
"RTN","GMPLBLD",167,0)
 . S ICD9VAR=^TMP("GMPLST",$J,LLCNT,0) I $L(ICD9VAR)>50 D
"RTN","GMPLBLD",168,0)
 .. S ICD9VAR=$P(ICD9VAR,"(",1)
"RTN","GMPLBLD",169,0)
 .. S ICD9VAR=$E(ICD9VAR,1,50)_" ("_$P(^TMP("GMPLST",$J,LLCNT,0),"(",2)
"RTN","GMPLBLD",170,0)
 .. S ^TMP("GMPLST",$J,LLCNT,0)=ICD9VAR
"RTN","GMPLBLD",171,0)
 Q
"RTN","GMPLBLD1")
0^3^B39853125
"RTN","GMPLBLD1",1,0)
GMPLBLD1 ; ISL/MKB,JER,TC - Bld PL Selection Lists cont;05/02/17  11:28
"RTN","GMPLBLD1",2,0)
 ;;2.0;Problem List;**3,28,36,42,49**;Aug 25, 1994;Build 43
"RTN","GMPLBLD1",3,0)
 ;
"RTN","GMPLBLD1",4,0)
 ; External References:
"RTN","GMPLBLD1",5,0)
 ;   ICR  5747   $$CODECS^ICDEX
"RTN","GMPLBLD1",6,0)
 ;   ICR  10026  ^DIR
"RTN","GMPLBLD1",7,0)
 ;   ICR  10103  $$DT^XLFDT
"RTN","GMPLBLD1",8,0)
 ;
"RTN","GMPLBLD1",9,0)
SEL() ; Select item(s) from list
"RTN","GMPLBLD1",10,0)
 N DIR,X,Y,MAX,GRP,DTOUT S GRP=$D(GMPLGRP) ; =1 if editing groups, 0 if lists
"RTN","GMPLBLD1",11,0)
 S MAX=$P($G(^TMP("GMPLST",$J,0)),U,1) I MAX'>0 Q "^"
"RTN","GMPLBLD1",12,0)
 S DIR(0)="LAO^1:"_MAX,DIR("A")="Select "_$S('GRP:"Category",1:"Problem")_"(s)"
"RTN","GMPLBLD1",13,0)
 S:MAX>1 DIR("A")=DIR("A")_" (1-"_MAX_"): "
"RTN","GMPLBLD1",14,0)
 S:MAX'>1 DIR("A")=DIR("A")_": ",DIR("B")=1
"RTN","GMPLBLD1",15,0)
 S DIR("?")="Enter the "_$S('GRP:"categories",1:"problems")_" you wish to select, as a range or list of numbers"
"RTN","GMPLBLD1",16,0)
 D ^DIR S:$D(DTOUT)!(X="") Y="^"
"RTN","GMPLBLD1",17,0)
 Q Y
"RTN","GMPLBLD1",18,0)
 ;
"RTN","GMPLBLD1",19,0)
SEL1() ; Select item from list
"RTN","GMPLBLD1",20,0)
 N DIR,X,Y,MAX,GRP,DTOUT S GRP=$D(GMPLGRP) ; =1 if editing groups, 0 if lists
"RTN","GMPLBLD1",21,0)
 S MAX=$P($G(^TMP("GMPLST",$J,0)),U,1) I MAX'>0 Q "^"
"RTN","GMPLBLD1",22,0)
 S DIR(0)="NAO^1:"_MAX_":0",DIR("A")="Select "_$S('GRP:"Category",1:"Problem")
"RTN","GMPLBLD1",23,0)
 S:MAX>1 DIR("A")=DIR("A")_" (1-"_MAX_"): "
"RTN","GMPLBLD1",24,0)
 S:MAX'>1 DIR("A")=DIR("A")_": ",DIR("B")=1
"RTN","GMPLBLD1",25,0)
 S DIR("?")="Enter the "_$S('GRP:"category",1:"problem")_" you wish to select, by number"
"RTN","GMPLBLD1",26,0)
 D ^DIR I $D(DTOUT)!(X="") S Y="^"
"RTN","GMPLBLD1",27,0)
 Q Y
"RTN","GMPLBLD1",28,0)
 ;
"RTN","GMPLBLD1",29,0)
SEQ(NUM) ; Enter/edit seq #, returns new #
"RTN","GMPLBLD1",30,0)
 N DIR,X,Y,GRP,DTOUT S GRP=$D(GMPLGRP) ; =1 if editing groups, 0 if lists
"RTN","GMPLBLD1",31,0)
 S DIR(0)="NA^.01:999.99:2",DIR("A")="SEQUENCE: " S:NUM DIR("B")=NUM
"RTN","GMPLBLD1",32,0)
 S DIR("?",1)="Enter a number indicating the sequence of this item in the "_$S('GRP:"list;",1:"category;")
"RTN","GMPLBLD1",33,0)
 S DIR("?")="up to 2 decimal places may be used, to order these items."
"RTN","GMPLBLD1",34,0)
SQ D ^DIR I $D(DTOUT)!(X="^") Q "^"
"RTN","GMPLBLD1",35,0)
 I X?1"^".E W $C(7),$$NOJUMP G SQ
"RTN","GMPLBLD1",36,0)
 I Y=NUM Q NUM
"RTN","GMPLBLD1",37,0)
 I $D(^TMP("GMPLIST",$J,"SEQ",Y)) D  G SQ
"RTN","GMPLBLD1",38,0)
 . W $C(7),!!,"Sequence number already in use!  Please enter another number."
"RTN","GMPLBLD1",39,0)
 . W !,"Use the 'Change View' option to display the current sequence numbers.",!
"RTN","GMPLBLD1",40,0)
 Q Y
"RTN","GMPLBLD1",41,0)
 ;
"RTN","GMPLBLD1",42,0)
HDR(TEXT) ; Enter/edit group subheader text in list
"RTN","GMPLBLD1",43,0)
 N DIR,X,Y,DTOUT S:$L(TEXT) DIR("B")=TEXT
"RTN","GMPLBLD1",44,0)
 S DIR(0)="FAO^2:65",DIR("A")="HEADER: "
"RTN","GMPLBLD1",45,0)
 S DIR("?")="Enter the text you wish displayed as a header for this category of problems"
"RTN","GMPLBLD1",46,0)
 S:$D(DIR("B")) DIR("?",1)=DIR("?")_";",DIR("?")="enter '@' if no header text is desired."
"RTN","GMPLBLD1",47,0)
H1 D ^DIR I $D(DTOUT)!(X="^") Q "^"
"RTN","GMPLBLD1",48,0)
 I X?1"^".E W $C(7),$$NOJUMP G H1
"RTN","GMPLBLD1",49,0)
 I X="@" Q:$$SURE^GMPLX "" G H1
"RTN","GMPLBLD1",50,0)
 Q Y
"RTN","GMPLBLD1",51,0)
 ;
"RTN","GMPLBLD1",52,0)
TEXT(TEXT) ; Edit problem text
"RTN","GMPLBLD1",53,0)
 N DIR,X,Y,DTOUT S:$L(TEXT) DIR("B")=TEXT
"RTN","GMPLBLD1",54,0)
 S DIR(0)="FAO^2:80",DIR("A")=" DISPLAY TEXT: "
"RTN","GMPLBLD1",55,0)
 S DIR("?")="Enter the text you wish presented here for this problem."
"RTN","GMPLBLD1",56,0)
T1 D ^DIR I $D(DTOUT)!("^"[X) S Y="^" G TQ
"RTN","GMPLBLD1",57,0)
 I X?1"^".E W $C(7),$$NOJUMP G T1
"RTN","GMPLBLD1",58,0)
 I X="@" G:'$$SURE^GMPLX T1 S Y="@" G TQ
"RTN","GMPLBLD1",59,0)
TQ Q Y
"RTN","GMPLBLD1",60,0)
 ;
"RTN","GMPLBLD1",61,0)
CODE(SCTCODE,ICDCODE) ; Confirm problem codes
"RTN","GMPLBLD1",62,0)
 N DIR,X,Y,CODESYS,GMPCSREC,DTOUT
"RTN","GMPLBLD1",63,0)
 S GMPCSREC=$$CODECS^ICDEX(ICDCODE,80,$$DT^XLFDT),CODESYS=$P(GMPCSREC,U,2)
"RTN","GMPLBLD1",64,0)
 W !!?2,"The following ",$S(SCTCODE]"":"SNOMED CT & ",1:""),CODESYS," Code(s) are associated with the problem",!?2,"you selected:"
"RTN","GMPLBLD1",65,0)
 I SCTCODE]"" W !!?2,"SNOMED CT: ",SCTCODE,?24,CODESYS,": ",ICDCODE,!
"RTN","GMPLBLD1",66,0)
 E  W !!?2,CODESYS,": ",ICDCODE,!
"RTN","GMPLBLD1",67,0)
 S DIR(0)="YA",DIR("A")="  ... Yes? "
"RTN","GMPLBLD1",68,0)
 S DIR("?")="Please indicate ((Y)es or (N)o) whether the problem/code(s) specified are appropriate."
"RTN","GMPLBLD1",69,0)
C1 D ^DIR I $D(DTOUT)!(X="^") S Y="^" G CQ
"RTN","GMPLBLD1",70,0)
 I X?1"^".E W $C(7),$$NOJUMP G C1
"RTN","GMPLBLD1",71,0)
 I X="@" G:'$$SURE^GMPLX C1 S Y=""
"RTN","GMPLBLD1",72,0)
 S:+Y'>0 Y="" S:+Y>0 Y=ICDCODE
"RTN","GMPLBLD1",73,0)
 W !
"RTN","GMPLBLD1",74,0)
CQ Q Y
"RTN","GMPLBLD1",75,0)
 ;
"RTN","GMPLBLD1",76,0)
FLAG(DFLT) ; Edit category flag
"RTN","GMPLBLD1",77,0)
 N DIR,X,Y,DTOUT S DIR(0)="YAO",DIR("B")=$S(+DFLT:"YES",1:"NO")
"RTN","GMPLBLD1",78,0)
 S DIR("A")="SHOW PROBLEMS AUTOMATICALLY? "
"RTN","GMPLBLD1",79,0)
 S DIR("?",1)="Enter YES if you wish the problems contained in this category to be",DIR("?",2)="automatically displayed upon entry to this list; NO will display only the",DIR("?")="category header until the user selects it to view."
"RTN","GMPLBLD1",80,0)
F1 D ^DIR I $D(DTOUT)!(X="^") Q "^"
"RTN","GMPLBLD1",81,0)
 I X?1"^".E W $C(7),$$NOJUMP G F1
"RTN","GMPLBLD1",82,0)
 Q Y
"RTN","GMPLBLD1",83,0)
 ;
"RTN","GMPLBLD1",84,0)
NOJUMP() ; Message
"RTN","GMPLBLD1",85,0)
 Q "   ^-jumping not allowed!"
"RTN","GMPLBLD1",86,0)
 ;
"RTN","GMPLBLD1",87,0)
RETURN() ; End of page prompt
"RTN","GMPLBLD1",88,0)
 N DIR,X,Y
"RTN","GMPLBLD1",89,0)
 S DIR(0)="E" D ^DIR
"RTN","GMPLBLD1",90,0)
 Q +Y
"RTN","GMPLBLD1",91,0)
 ;
"RTN","GMPLBLD1",92,0)
TMPIFN() ; Get temporary IFN ("#N") for ^TMP("GMPLIST",$J,)
"RTN","GMPLBLD1",93,0)
 N I,LAST S (I,LAST)=0
"RTN","GMPLBLD1",94,0)
 F  S I=$O(^TMP("GMPLIST",$J,I)) Q:+I'>0  S:I?1.N1"N" LAST=+I
"RTN","GMPLBLD1",95,0)
 S I=LAST+1,I=$E("0000",1,4-$L(I))_I
"RTN","GMPLBLD1",96,0)
TMPQ Q I_"N"
"RTN","GMPLBLD1",97,0)
 ;
"RTN","GMPLBLD1",98,0)
DELETE(IFN) ; Kill entry in ^TMP("GMPLIST",$J,)
"RTN","GMPLBLD1",99,0)
 N SEQ,GROUP S ^TMP("GMPLIST",$J,0)=^TMP("GMPLIST",$J,0)-1
"RTN","GMPLBLD1",100,0)
 S SEQ=$P(^TMP("GMPLIST",$J,IFN),U,2),GROUP=$P(^TMP("GMPLIST",$J,IFN),U,1),^TMP("GMPLIST",$J,IFN)="@"
"RTN","GMPLBLD1",101,0)
 K ^TMP("GMPLIST",$J,"SEQ",SEQ),^TMP("GMPLIST",$J,"PROB",GROUP),^TMP("GMPLIST",$J,"GRP",GROUP)
"RTN","GMPLBLD1",102,0)
 K:IFN?1.N1"N" ^TMP("GMPLIST",$J,IFN)
"RTN","GMPLBLD1",103,0)
 Q
"RTN","GMPLBLD1",104,0)
 ;
"RTN","GMPLBLD1",105,0)
RESEQ ; Resequence items
"RTN","GMPLBLD1",106,0)
 N SEL,NUM,SEQ,NSEQ,PIECE,IFN,GMPQUIT S VALMBCK=""
"RTN","GMPLBLD1",107,0)
 I $P($G(GMPLGRP),U,4)="N" W !!,"Cannot make edits to a National category." H 2 G RSQ
"RTN","GMPLBLD1",108,0)
 I $P($G(GMPLSLST),U,5)="N",'$D(GMPLGRP) W !!,"Cannot make edits to a National list." H 2 G RSQ
"RTN","GMPLBLD1",109,0)
 S SEL=$$SEL G:SEL="^" RSQ
"RTN","GMPLBLD1",110,0)
 F PIECE=1:1:$L(SEL,",") D  Q:$D(GMPQUIT)  W !
"RTN","GMPLBLD1",111,0)
 . S NUM=$P(SEL,",",PIECE) Q:NUM'>0
"RTN","GMPLBLD1",112,0)
 . S IFN=$P($G(^TMP("GMPLST",$J,"B",NUM)),U,1) Q:+IFN'>0  S SEQ=$P(^TMP("GMPLIST",$J,IFN),U,2)
"RTN","GMPLBLD1",113,0)
 . W !!,$P(^TMP("GMPLIST",$J,IFN),U,3)
"RTN","GMPLBLD1",114,0)
 . S NSEQ=$$SEQ(SEQ) I NSEQ="^" S GMPQUIT=1 Q
"RTN","GMPLBLD1",115,0)
 .I SEQ'=NSEQ S ^TMP("GMPLIST",$J,IFN)=$P(^TMP("GMPLIST",$J,IFN),U,1)_U_NSEQ_U_$P(^TMP("GMPLIST",$J,IFN),U,3,$L(^TMP("GMPLIST",$J,IFN),U)),^TMP("GMPLIST",$J,"SEQ",NSEQ)=IFN,GMPREBLD=1 K ^TMP("GMPLIST",$J,"SEQ",SEQ)
"RTN","GMPLBLD1",116,0)
 I $D(GMPREBLD) S VALMBCK="R",GMPLSAVE=1 ; D BUILD in exit action
"RTN","GMPLBLD1",117,0)
RSQ S:'VALMCC VALMBCK="R" S VALMSG=$$MSG^GMPLX
"RTN","GMPLBLD1",118,0)
 Q
"RTN","GMPLBLD1",119,0)
 ;
"RTN","GMPLBLD1",120,0)
EDIT ; Edit category display
"RTN","GMPLBLD1",121,0)
 N GRPS,NUM,IFN,HDR,FLG,PIECE,GMPQUIT,GMPREBLD S VALMBCK=""
"RTN","GMPLBLD1",122,0)
 I $P($G(GMPLSLST),U,5)="N" W !!,"Cannot make edits to a National list." H 2 G EDQ
"RTN","GMPLBLD1",123,0)
 S GRPS=$$SEL G:GRPS="^" EDQ
"RTN","GMPLBLD1",124,0)
 F PIECE=1:1:$L(GRPS,",") D  Q:$D(GMPQUIT)  W !
"RTN","GMPLBLD1",125,0)
 . S NUM=$P(GRPS,",",PIECE) Q:NUM'>0
"RTN","GMPLBLD1",126,0)
 .S IFN=$P($G(^TMP("GMPLST",$J,"B",NUM)),U,1) Q:+IFN'>0
"RTN","GMPLBLD1",127,0)
 . S HDR=$P(^TMP("GMPLIST",$J,IFN),U,3),FLG=$P(^TMP("GMPLIST",$J,IFN),U,4)
"RTN","GMPLBLD1",128,0)
 . S HDR=$$HDR(HDR) I HDR="^" S GMPQUIT=1 Q
"RTN","GMPLBLD1",129,0)
 . S FLG=$$FLAG(FLG) I FLG="^" S GMPQUIT=1 Q
"RTN","GMPLBLD1",130,0)
 . S $P(^TMP("GMPLIST",$J,IFN),U,3,4)=HDR_U_FLG,GMPREBLD=1
"RTN","GMPLBLD1",131,0)
 I $D(GMPREBLD) S VALMBCK="R",GMPLSAVE=1 D BUILD^GMPLBLD("^TMP(""GMPLIST"",$J)",GMPLMODE)
"RTN","GMPLBLD1",132,0)
EDQ S:'VALMCC VALMBCK="R" S VALMSG=$$MSG^GMPLX
"RTN","GMPLBLD1",133,0)
 Q
"RTN","GMPLBLD2")
0^2^B88445928
"RTN","GMPLBLD2",1,0)
GMPLBLD2 ; SLC/MKB,JFR,TC -- Bld PL Selection Lists cont ;07/19/17  13:32
"RTN","GMPLBLD2",2,0)
 ;;2.0;Problem List;**3,28,36,42,49**;Aug 25, 1994;Build 43
"RTN","GMPLBLD2",3,0)
 ;
"RTN","GMPLBLD2",4,0)
 ; External References:
"RTN","GMPLBLD2",5,0)
 ;   ICR  2053   $$FILE^DIE,$$UPDATE^DIE
"RTN","GMPLBLD2",6,0)
 ;   ICR  2336   $$GETENT,$$EDIT,$$EDITPAR^XPAREDIT
"RTN","GMPLBLD2",7,0)
 ;   ICR  4083   $$STATCHK^LEXSRC2
"RTN","GMPLBLD2",8,0)
 ;   ICR  5747   $$CODECS^ICDEX,$$STATCHK^ICDEX
"RTN","GMPLBLD2",9,0)
 ;   ICR  10103  $$DT^XLFDT
"RTN","GMPLBLD2",10,0)
 ;   ICR  10006  ^DIC
"RTN","GMPLBLD2",11,0)
 ;   ICR  10013  ^DIK
"RTN","GMPLBLD2",12,0)
 ;   ICR  10026  ^DIR
"RTN","GMPLBLD2",13,0)
 ;   ICR  10116  FULL^VALM1
"RTN","GMPLBLD2",14,0)
 ;
"RTN","GMPLBLD2",15,0)
NEWGRP ; Change problem groups
"RTN","GMPLBLD2",16,0)
 N NEWGRP D FULL^VALM1
"RTN","GMPLBLD2",17,0)
 I $D(GMPLSAVE),$$CKSAVE D SAVE
"RTN","GMPLBLD2",18,0)
NG1 S NEWGRP=$$GROUP("L") G:+NEWGRP'>0 NGQ G:+NEWGRP=+GMPLGRP NGQ
"RTN","GMPLBLD2",19,0)
 L +^GMPL(125.11,+NEWGRP,0):1 I '$T D  G NG1
"RTN","GMPLBLD2",20,0)
 . W $C(7),!!,"This category is currently being edited by another user!",!
"RTN","GMPLBLD2",21,0)
 L -^GMPL(125.11,+GMPLGRP,0) S GMPLGRP=NEWGRP
"RTN","GMPLBLD2",22,0)
 D GETLIST^GMPLBLDC,BUILD^GMPLBLDC("^TMP(""GMPLIST"",$J)",GMPLMODE),HDR^GMPLBLDC
"RTN","GMPLBLD2",23,0)
NGQ S VALMBCK="R",VALMSG=$$MSG^GMPLX
"RTN","GMPLBLD2",24,0)
 Q
"RTN","GMPLBLD2",25,0)
 ;
"RTN","GMPLBLD2",26,0)
GROUP(L) ; Lookup into Problem Selection Group file #125.11
"RTN","GMPLBLD2",27,0)
 N DIC,X,Y,DLAYGO,GMPDT ; L = "" or "L", if LAYGO is [not] allowed
"RTN","GMPLBLD2",28,0)
 S GMPDT=$$DT^XLFDT
"RTN","GMPLBLD2",29,0)
 S DIC="^GMPL(125.11,",DIC(0)="AEQMZ"_L,DIC("A")="Select CATEGORY NAME: "
"RTN","GMPLBLD2",30,0)
 I DIC(0)["L" S DLAYGO=125.11,DIC("DR")=".02////"_GMPDT_";.03",DIC("?N","125.11")=6
"RTN","GMPLBLD2",31,0)
 E  S DIC("S")="I $P(^(0),U,3)'=""N"""
"RTN","GMPLBLD2",32,0)
 D ^DIC S:Y'>0 Y="^" S:Y'="^" Y=+Y_U_Y(0)
"RTN","GMPLBLD2",33,0)
 Q Y
"RTN","GMPLBLD2",34,0)
 ;
"RTN","GMPLBLD2",35,0)
NEWLST ; Change selection lists
"RTN","GMPLBLD2",36,0)
 N NEWLST D FULL^VALM1
"RTN","GMPLBLD2",37,0)
 I $D(GMPLSAVE),$$CKSAVE D SAVE
"RTN","GMPLBLD2",38,0)
NL1 S NEWLST=$$LIST("L") G:+NEWLST'>0 NLQ G:+NEWLST=+GMPLSLST NLQ
"RTN","GMPLBLD2",39,0)
 L +^GMPL(125,+NEWLST,0):1 I '$T D  G NL1
"RTN","GMPLBLD2",40,0)
 . W $C(7),!!,"This list is currently being edited by another user!",!
"RTN","GMPLBLD2",41,0)
 L -^GMPL(125,+GMPLSLST,0) S GMPLSLST=NEWLST
"RTN","GMPLBLD2",42,0)
 D GETLIST^GMPLBLD,BUILD^GMPLBLD("^TMP(""GMPLIST"",$J)",GMPLMODE),HDR^GMPLBLD
"RTN","GMPLBLD2",43,0)
NLQ S VALMBCK="R",VALMSG=$$MSG^GMPLX
"RTN","GMPLBLD2",44,0)
 Q
"RTN","GMPLBLD2",45,0)
 ;
"RTN","GMPLBLD2",46,0)
LIST(L) ; Lookup into Problem Selection List file #125
"RTN","GMPLBLD2",47,0)
 N DIC,X,Y,DLAYGO,GMPDT ; L="" or "L" if LAYGO [not] allowed
"RTN","GMPLBLD2",48,0)
 S GMPDT=$$DT^XLFDT
"RTN","GMPLBLD2",49,0)
 S DIC="^GMPL(125,",DIC(0)="AEQMZ"_L,DIC("A")="Select LIST NAME: "
"RTN","GMPLBLD2",50,0)
 S:DIC(0)["L" DLAYGO=125,DIC("DR")=".02////"_GMPDT_";.04"
"RTN","GMPLBLD2",51,0)
 D ^DIC S:Y<0!($D(DTOUT))!($D(DUOUT)) Y="^" S:Y'="^" Y=+Y_U_Y(0)
"RTN","GMPLBLD2",52,0)
 Q Y
"RTN","GMPLBLD2",53,0)
 ;
"RTN","GMPLBLD2",54,0)
LAST(ROOT) ; Returns last subscript
"RTN","GMPLBLD2",55,0)
 N I,J S (I,J)=""
"RTN","GMPLBLD2",56,0)
 F  S I=$O(@(ROOT_"I)")) Q:I=""  S J=I
"RTN","GMPLBLD2",57,0)
 Q J
"RTN","GMPLBLD2",58,0)
 ;
"RTN","GMPLBLD2",59,0)
CKSAVE() ; Save [changes] ??
"RTN","GMPLBLD2",60,0)
 N DIR,X,Y,TEXT S TEXT=$S($D(GMPLGRP):"category",1:"list")
"RTN","GMPLBLD2",61,0)
 S DIR("A")="Save the changes to this "_TEXT_"? ",DIR("B")="YES"
"RTN","GMPLBLD2",62,0)
 S DIR("?",1)="Enter YES to save the changes that have been made to this "_TEXT,DIR("?")="before exiting it; NO will leave this "_TEXT_" unchanged."
"RTN","GMPLBLD2",63,0)
 S DIR(0)="YA" D ^DIR
"RTN","GMPLBLD2",64,0)
 Q +Y
"RTN","GMPLBLD2",65,0)
 ;
"RTN","GMPLBLD2",66,0)
SAVE ; Save changes to group/list
"RTN","GMPLBLD2",67,0)
 N GMPLQT,LABEL,DA,GMPDT
"RTN","GMPLBLD2",68,0)
 S GMPLQT=0,GMPDT=$$DT^XLFDT
"RTN","GMPLBLD2",69,0)
 I $D(GMPLGRP) D  I GMPLQT Q
"RTN","GMPLBLD2",70,0)
 . N ITM,CODE
"RTN","GMPLBLD2",71,0)
 . S ITM=0
"RTN","GMPLBLD2",72,0)
 . F  S ITM=$O(^TMP("GMPLIST",$J,ITM)) Q:'ITM!(GMPLQT)  D
"RTN","GMPLBLD2",73,0)
 .. N GMI,GMPSCTC
"RTN","GMPLBLD2",74,0)
 .. S GMPSCTC=$P(^TMP("GMPLIST",$J,ITM),U,5) Q:'$L(GMPSCTC)
"RTN","GMPLBLD2",75,0)
 .. I '$$STATCHK^LEXSRC2(GMPSCTC,GMPDT,"","SCT") S GMPLQT=1 Q
"RTN","GMPLBLD2",76,0)
 .. S CODE=$P(^TMP("GMPLIST",$J,ITM),U,4) Q:'$L(CODE)
"RTN","GMPLBLD2",77,0)
 .. F GMI=1:1:$L(CODE,"/") D
"RTN","GMPLBLD2",78,0)
 ... N GMPLCPTR S GMPLCPTR=$P($$CODECS^ICDEX($P(CODE,"/",GMI),80,GMPDT),U)
"RTN","GMPLBLD2",79,0)
 ... I '$$STATCHK^ICDEX($P(CODE,"/",GMI),GMPDT,GMPLCPTR) S GMPLQT=1 Q
"RTN","GMPLBLD2",80,0)
 . I 'GMPLQT Q  ;no inactive codes in the category
"RTN","GMPLBLD2",81,0)
 . D FULL^VALM1
"RTN","GMPLBLD2",82,0)
 . W !!,$C(7),"This Group contains problems with inactive SNOMED or ICD codes associated"
"RTN","GMPLBLD2",83,0)
 . W !,"with them. The codes must be edited and corrected before the group can be saved."
"RTN","GMPLBLD2",84,0)
 . N DIR,DUOUT,DTOUT,DIRUT
"RTN","GMPLBLD2",85,0)
 . S DIR(0)="E" D ^DIR
"RTN","GMPLBLD2",86,0)
 . S VALMBCK="R",GMPLQT=1
"RTN","GMPLBLD2",87,0)
 . Q
"RTN","GMPLBLD2",88,0)
 ;
"RTN","GMPLBLD2",89,0)
 I '$D(GMPLGRP),$D(GMPLSLST) D  I GMPLQT Q
"RTN","GMPLBLD2",90,0)
 . N GRP
"RTN","GMPLBLD2",91,0)
 . S GRP=0
"RTN","GMPLBLD2",92,0)
 . F  S GRP=$O(^TMP("GMPLIST",$J,"GRP",GRP)) Q:'GRP!(GMPLQT)  D
"RTN","GMPLBLD2",93,0)
 .. I $$VALGRP(GRP) Q  ;no inactive codes in the GROUP
"RTN","GMPLBLD2",94,0)
 .. S GMPLQT=1
"RTN","GMPLBLD2",95,0)
 . I 'GMPLQT Q  ; all groups and problems OK
"RTN","GMPLBLD2",96,0)
 . D FULL^VALM1
"RTN","GMPLBLD2",97,0)
 . W !!,$C(7),"This Selection List contains problems with inactive SNOMED or ICD codes"
"RTN","GMPLBLD2",98,0)
 . W !,"associated with them. The codes must be edited and corrected before the"
"RTN","GMPLBLD2",99,0)
 . W !,"list can be saved."
"RTN","GMPLBLD2",100,0)
 . N DIR,DUOUT,DTOUT,DIRUT
"RTN","GMPLBLD2",101,0)
 . S DIR(0)="E" D ^DIR
"RTN","GMPLBLD2",102,0)
 . S VALMBCK="R",GMPLQT=1
"RTN","GMPLBLD2",103,0)
 . Q
"RTN","GMPLBLD2",104,0)
 W !!,"Saving ..."
"RTN","GMPLBLD2",105,0)
 S DA=0,LABEL=$S($D(GMPLGRP):"SAVGRP",1:"SAVLST")
"RTN","GMPLBLD2",106,0)
 F  S DA=$O(^TMP("GMPLIST",$J,DA)) Q:+DA'>0  D @LABEL
"RTN","GMPLBLD2",107,0)
 K GMPLSAVE S:$D(GMPLGRP) GMPSAVED=1
"RTN","GMPLBLD2",108,0)
 S VALMBCK="Q" W " done." H 1
"RTN","GMPLBLD2",109,0)
 Q
"RTN","GMPLBLD2",110,0)
SAVGRP ; Save changes to existing group
"RTN","GMPLBLD2",111,0)
 N I,DIK,ITEM,TMPITEM,GMPJ,GMPFDA,GMPERR,GMPSFN,GMPLTXT
"RTN","GMPLBLD2",112,0)
 S DA(1)=+GMPLGRP,DIK="^GMPL(125.11,"_DA(1)_",1,"
"RTN","GMPLBLD2",113,0)
 S GMPSFN="125.111"
"RTN","GMPLBLD2",114,0)
 I +DA'=DA D  Q
"RTN","GMPLBLD2",115,0)
 . Q:"@"[$G(^TMP("GMPLIST",$J,DA))  ; nothing to save
"RTN","GMPLBLD2",116,0)
 . S TMPITEM=^TMP("GMPLIST",$J,DA) D NEW(GMPSFN,+GMPLGRP,TMPITEM)
"RTN","GMPLBLD2",117,0)
 I "@"[$G(^TMP("GMPLIST",$J,DA)) D ^DIK Q
"RTN","GMPLBLD2",118,0)
 S ITEM=$G(^GMPL(125.11,+GMPLGRP,1,DA,0))
"RTN","GMPLBLD2",119,0)
 I ITEM'=^TMP("GMPLIST",$J,DA) D
"RTN","GMPLBLD2",120,0)
 . F I=1:1:6 D
"RTN","GMPLBLD2",121,0)
 .. S GMPJ=$S(I=1:".01",I=2:".02",I=3:".03",I=4:".04",I=5:".05",1:".06")
"RTN","GMPLBLD2",122,0)
 .. Q:$P(^TMP("GMPLIST",$J,DA),U,I)=$P(ITEM,U,I)
"RTN","GMPLBLD2",123,0)
 .. S GMPFDA(125.111,""_DA_","_+GMPLGRP_",",GMPJ)=$S($P(^TMP("GMPLIST",$J,DA),U,I)="":"@",1:$P(^TMP("GMPLIST",$J,DA),U,I))
"RTN","GMPLBLD2",124,0)
 . D FILE^DIE("K","GMPFDA","GMPERR")
"RTN","GMPLBLD2",125,0)
 I $D(GMPERR) D
"RTN","GMPLBLD2",126,0)
 . S GMPLTXT(1)="Error updating Rec #"_+GMPLGRP_", Sub-rec #"_DA_"."
"RTN","GMPLBLD2",127,0)
 . S GMPLTXT(2)="Error "_GMPERR("DIERR",1)_": "_GMPERR("DIERR",1,"TEXT",1)
"RTN","GMPLBLD2",128,0)
 . D EN^DDIOL(.GMPLTXT)
"RTN","GMPLBLD2",129,0)
 Q
"RTN","GMPLBLD2",130,0)
 ;
"RTN","GMPLBLD2",131,0)
SAVLST ; Save changes to existing list
"RTN","GMPLBLD2",132,0)
 N I,DIK,ITEM,TMPLST,GMPJ,GMPFDA,GMPERR,GMPSFN
"RTN","GMPLBLD2",133,0)
 S DA(1)=+GMPLSLST,DIK="^GMPL(125,"_DA(1)_",1,"
"RTN","GMPLBLD2",134,0)
 S GMPSFN="125.01"
"RTN","GMPLBLD2",135,0)
 I +DA'=DA D  Q  ; new link
"RTN","GMPLBLD2",136,0)
 . Q:"@"[$G(^TMP("GMPLIST",$J,DA))  ; nothing to save
"RTN","GMPLBLD2",137,0)
 . S TMPLST=^TMP("GMPLIST",$J,DA) D NEW(GMPSFN,+GMPLSLST,TMPLST)
"RTN","GMPLBLD2",138,0)
 I "@"[$G(^TMP("GMPLIST",$J,DA)) D ^DIK Q
"RTN","GMPLBLD2",139,0)
 S ITEM=$G(^GMPL(125,+GMPLSLST,1,DA,0))
"RTN","GMPLBLD2",140,0)
 I ITEM'=^TMP("GMPLIST",$J,DA) D
"RTN","GMPLBLD2",141,0)
 . F I=1:1:4 D
"RTN","GMPLBLD2",142,0)
 .. S GMPJ=$S(I=1:".01",I=2:".02",I=3:".03",1:".04")
"RTN","GMPLBLD2",143,0)
 .. Q:$P(^TMP("GMPLIST",$J,DA),U,I)=$P(ITEM,U,I)
"RTN","GMPLBLD2",144,0)
 .. S GMPFDA(125.01,""_DA_","_+GMPLSLST_",",GMPJ)=$S($P(^TMP("GMPLIST",$J,DA),U,I)="":"@",1:$P(^TMP("GMPLIST",$J,DA),U,I))
"RTN","GMPLBLD2",145,0)
 . D FILE^DIE("K","GMPFDA","GMPERR")
"RTN","GMPLBLD2",146,0)
 I $D(GMPERR) D
"RTN","GMPLBLD2",147,0)
 . S GMPLTXT(1)="Error updating Rec #"_+GMPLSLST_", Sub-rec #"_DA_"."
"RTN","GMPLBLD2",148,0)
 . S GMPLTXT(2)="Error "_GMPERR("DIERR",1)_": "_GMPERR("DIERR",1,"TEXT",1)
"RTN","GMPLBLD2",149,0)
 . D EN^DDIOL(.GMPLTXT)
"RTN","GMPLBLD2",150,0)
 Q
"RTN","GMPLBLD2",151,0)
 ;
"RTN","GMPLBLD2",152,0)
NEW(GMPSFN,LIST,ITEM) ; Create new contents entry in subfile #125.01 or #125.111
"RTN","GMPLBLD2",153,0)
 N I,GMPFDA,GMPJ,GMPNF,GMPERR,GMPFILE
"RTN","GMPLBLD2",154,0)
 S GMPFILE=$S(GMPSFN="125.01":"125",1:"125.11")
"RTN","GMPLBLD2",155,0)
 S GMPNF=$S(GMPSFN="125.01":4,1:6)
"RTN","GMPLBLD2",156,0)
 F I=1:1:GMPNF D
"RTN","GMPLBLD2",157,0)
 . S GMPJ=$S(I=1:".01",I=2:".02",I=3:".03",I=4:".04",I=5:".05",1:".06")
"RTN","GMPLBLD2",158,0)
 . S GMPFDA(GMPSFN,"+2,"_LIST_",",GMPJ)=$P(ITEM,U,I)
"RTN","GMPLBLD2",159,0)
 L +^GMPL(GMPFILE,LIST):5 I '$T D  Q
"RTN","GMPLBLD2",160,0)
 . W !,"Lock Error: error updating record #"_LIST_" in File #"_GMPFILE_"."
"RTN","GMPLBLD2",161,0)
 D UPDATE^DIE("","GMPFDA","","GMPERR")
"RTN","GMPLBLD2",162,0)
 L -^GMPL(GMPFILE,LIST)
"RTN","GMPLBLD2",163,0)
 Q
"RTN","GMPLBLD2",164,0)
 ;
"RTN","GMPLBLD2",165,0)
DELETE ; Delete problem group
"RTN","GMPLBLD2",166,0)
 N DIR,X,Y,DA,DIK,IFN,GMPLSEQ,GMPLDA S VALMBCK=$S(VALMCC:"",1:"R")
"RTN","GMPLBLD2",167,0)
 I $P($G(GMPLGRP),U,4)="N" W !!,"Cannot make edits to a National category." H 2 Q
"RTN","GMPLBLD2",168,0)
 I $D(^GMPL(125,"AC",+GMPLGRP)) W $C(7),!!,">>>  This category belongs to at least one problem selection list!",!,"     CANNOT DELETE" H 2 Q
"RTN","GMPLBLD2",169,0)
 S DIR(0)="YA",DIR("B")="NO",DIR("A")="Are you sure you want to delete the entire '"_$P(GMPLGRP,U,2)_"' category? "
"RTN","GMPLBLD2",170,0)
 S DIR("?")="Enter YES to completely remove this category and all its items."
"RTN","GMPLBLD2",171,0)
 D ^DIR Q:'Y
"RTN","GMPLBLD2",172,0)
DEL1 ; Ok, go for it ...
"RTN","GMPLBLD2",173,0)
 W !!,"Deleting category items ..."
"RTN","GMPLBLD2",174,0)
 S (GMPLSEQ,GMPLDA)=0
"RTN","GMPLBLD2",175,0)
 F  S GMPLSEQ=$O(^GMPL(125.11,"C",+GMPLGRP,GMPLSEQ)) Q:'GMPLSEQ  D
"RTN","GMPLBLD2",176,0)
 . F  S GMPLDA=$O(^GMPL(125.11,"C",+GMPLGRP,GMPLSEQ,GMPLDA)) Q:'GMPLDA  D
"RTN","GMPLBLD2",177,0)
 . . S DA(1)=+GMPLGRP,DA=GMPLDA,DIK="^GMPL(125.11,"_DA(1)_",1," D ^DIK W "."
"RTN","GMPLBLD2",178,0)
 . K ^GMPL(125.11,+GMPLGRP,1,0)
"RTN","GMPLBLD2",179,0)
 S DA=+GMPLGRP,DIK="^GMPL(125.11," D ^DIK W "."
"RTN","GMPLBLD2",180,0)
 L -^GMPL(125.11,+GMPLGRP,0) S GMPLGRP=0 K GMPLSAVE W " <done>"
"RTN","GMPLBLD2",181,0)
 D NEWGRP S:+GMPLGRP'>0 VALMBCK="Q"
"RTN","GMPLBLD2",182,0)
 Q
"RTN","GMPLBLD2",183,0)
 ;
"RTN","GMPLBLD2",184,0)
VALGRP(GMPLCAT,GMPLCODE) ; check all problems in the category for inactive SNOMED/ICD codes
"RTN","GMPLBLD2",185,0)
 ; Input:
"RTN","GMPLBLD2",186,0)
 ;    GMPLCAT  = ien from file 125.11
"RTN","GMPLBLD2",187,0)
 ;    GMPLCODE = Name of array where the categories & probs w/inactive codes are stored (Optional)
"RTN","GMPLBLD2",188,0)
 ;
"RTN","GMPLBLD2",189,0)
 ; Output:
"RTN","GMPLBLD2",190,0)
 ;    1     = category has no problems with inactive codes
"RTN","GMPLBLD2",191,0)
 ;    0     = category has one or more problems with inactive codes
"RTN","GMPLBLD2",192,0)
 ;    0^GMPLCODE = category has one or more problems with inactive codes^array w/inactive codes
"RTN","GMPLBLD2",193,0)
 ;    0^ERR = category is invalid^error message
"RTN","GMPLBLD2",194,0)
 ;
"RTN","GMPLBLD2",195,0)
 ; Array format (if returned):
"RTN","GMPLBLD2",196,0)
 ;    GMPLCODE(Category Name, Problem Sequence)=Display Text^(ICD-9/10-CM Code)^Inactive coding system (ICD,SCT,SCT/ICD)
"RTN","GMPLBLD2",197,0)
 ;
"RTN","GMPLBLD2",198,0)
 I '$G(GMPLCAT) Q "0^No category selected"
"RTN","GMPLBLD2",199,0)
 N GMPLSEQ,GMPLVALC,GMPLDA,GMPDT,GMPLCNME
"RTN","GMPLBLD2",200,0)
 S GMPLVALC=1,(GMPLSEQ,GMPLDA)=0,GMPDT=$$DT^XLFDT
"RTN","GMPLBLD2",201,0)
 S GMPLCNME=$$GET1^DIQ(125.11,GMPLCAT,.01)
"RTN","GMPLBLD2",202,0)
 F  S GMPLSEQ=$O(^GMPL(125.11,"C",GMPLCAT,GMPLSEQ)) Q:'GMPLSEQ  D
"RTN","GMPLBLD2",203,0)
 . F  S GMPLDA=$O(^GMPL(125.11,"C",GMPLCAT,GMPLSEQ,GMPLDA)) Q:'GMPLDA  D
"RTN","GMPLBLD2",204,0)
 . . N GMPLICD,GMPLSCTC,GMI,GMPLX,GMPSCT,GMPICD
"RTN","GMPLBLD2",205,0)
 . . N GMPLICDS,GMPLCLBL,GMPLCPTR,GMPCSYS,GMPLDTXT
"RTN","GMPLBLD2",206,0)
 . . S (GMPSCT,GMPICD)=0
"RTN","GMPLBLD2",207,0)
 . . S GMPLX=$G(^GMPL(125.11,GMPLCAT,1,GMPLDA,0))
"RTN","GMPLBLD2",208,0)
 . . S GMPLDTXT=$P(GMPLX,U,3)
"RTN","GMPLBLD2",209,0)
 . . S GMPLICD=$P(GMPLX,U,4),GMPLSCTC=$P(GMPLX,U,5)
"RTN","GMPLBLD2",210,0)
 . . Q:'$L(GMPLICD)&('$L(GMPLSCTC))  ; no code there
"RTN","GMPLBLD2",211,0)
 . . I $L(GMPLSCTC) D
"RTN","GMPLBLD2",212,0)
 . . . I '$$STATCHK^LEXSRC2(GMPLSCTC,GMPDT,"","SCT") S GMPLVALC=0,GMPSCT=1
"RTN","GMPLBLD2",213,0)
 . . S GMPLICDS=$$CODECS^ICDEX($P(GMPLICD,"/"),80,GMPDT)
"RTN","GMPLBLD2",214,0)
 . . S GMPLCPTR=$P(GMPLICDS,U),GMPLCLBL=$P(GMPLICDS,U,2)
"RTN","GMPLBLD2",215,0)
 . . I $L(GMPLICD) D
"RTN","GMPLBLD2",216,0)
 . . . F GMI=1:1:$L(GMPLICD,"/") D
"RTN","GMPLBLD2",217,0)
 . . . . I '$$STATCHK^ICDEX($P(GMPLICD,"/",GMI),GMPDT,GMPLCPTR) S GMPLVALC=0,GMPICD=1
"RTN","GMPLBLD2",218,0)
 . . I $D(GMPLCODE),(GMPSCT!GMPICD) D
"RTN","GMPLBLD2",219,0)
 . . . S GMPCSYS=$S((GMPSCT&GMPICD):"SCT/ICD",GMPSCT:"SCT",GMPICD:"ICD",1:"")
"RTN","GMPLBLD2",220,0)
 . . . S @GMPLCODE@(GMPLCNME,GMPLSEQ)=GMPLDTXT_U_"("_GMPLCLBL_" "_GMPLICD_")"_U_GMPCSYS
"RTN","GMPLBLD2",221,0)
 . Q
"RTN","GMPLBLD2",222,0)
 I $D(GMPLCODE),('GMPLVALC) S GMPLVALC=GMPLVALC_U_GMPLCODE
"RTN","GMPLBLD2",223,0)
 Q GMPLVALC
"RTN","GMPLBLD2",224,0)
 ;
"RTN","GMPLBLD2",225,0)
VALLIST(LIST,GMPLCODE) ;check all categories in list for probs w/ inactive SNOMED/ICD codes
"RTN","GMPLBLD2",226,0)
 ; Input:
"RTN","GMPLBLD2",227,0)
 ;   LIST = ien from file 125
"RTN","GMPLBLD2",228,0)
 ;   GMPLCODE = Name of array where the categories & probs w/inactive codes are stored (Optional)
"RTN","GMPLBLD2",229,0)
 ;
"RTN","GMPLBLD2",230,0)
 ; Output:
"RTN","GMPLBLD2",231,0)
 ;    1     = list has no problems with inactive codes
"RTN","GMPLBLD2",232,0)
 ;    0     = list has one or more problems with inactive codes
"RTN","GMPLBLD2",233,0)
 ;    0^GMPLCODE = list has one or more problems with inactive codes^array w/inactive codes
"RTN","GMPLBLD2",234,0)
 ;    O^ERR = list is invalid^error message
"RTN","GMPLBLD2",235,0)
 ;
"RTN","GMPLBLD2",236,0)
 ; Array format (if returned):
"RTN","GMPLBLD2",237,0)
 ;    GMPLCODE(Category Name, Problem Sequence)=Display Text^(ICD-9/10-CM Code)^Inactive coding system (ICD,SCT,SCT/ICD)
"RTN","GMPLBLD2",238,0)
 ;
"RTN","GMPLBLD2",239,0)
 N GMPLIEN,GMPLVAL
"RTN","GMPLBLD2",240,0)
 I '$G(LIST) Q 0
"RTN","GMPLBLD2",241,0)
 S GMPLCAT=0,GMPLVAL=1
"RTN","GMPLBLD2",242,0)
 F  S GMPLCAT=$O(^GMPL(125,LIST,1,"B",GMPLCAT)) Q:'GMPLCAT  D
"RTN","GMPLBLD2",243,0)
 . I $D(GMPLCODE) D
"RTN","GMPLBLD2",244,0)
 . . I '$$VALGRP(GMPLCAT,GMPLCODE) S GMPLVAL=0
"RTN","GMPLBLD2",245,0)
 . E  I '$$VALGRP(GMPLCAT) S GMPLVAL=0
"RTN","GMPLBLD2",246,0)
 . Q
"RTN","GMPLBLD2",247,0)
 I $D(GMPLCODE) S GMPLVAL=GMPLVAL_U_GMPLCODE
"RTN","GMPLBLD2",248,0)
 Q GMPLVAL
"RTN","GMPLBLD2",249,0)
 ;
"RTN","GMPLBLD2",250,0)
ASSIGN ; assign or remove selection list to users/clinic
"RTN","GMPLBLD2",251,0)
 ;
"RTN","GMPLBLD2",252,0)
 N GMPLENT,GMPLPAR,GMPJUST1,GMPLDTXT
"RTN","GMPLBLD2",253,0)
 I $D(VALMCC) D FULL^VALM1
"RTN","GMPLBLD2",254,0)
 S GMPLPAR=$$FIND1^DIC(8989.51,,"BX","ORQQPL SELECTION LIST")
"RTN","GMPLBLD2",255,0)
 I $D(GMPLPAR) S GMPLDTXT=$$GET1^DIQ(8989.51,GMPLPAR,.02),GMPLPAR=GMPLPAR_U_GMPLDTXT
"RTN","GMPLBLD2",256,0)
 F  D GETENT^XPAREDIT(.GMPLENT,GMPLPAR,.GMPJUST1) Q:'GMPLENT  D EDIT^XPAREDIT(GMPLENT,GMPLPAR) Q:GMPJUST1
"RTN","GMPLBLD2",257,0)
 I $D(VALMCC) S VALMBCK="R",VALMSG=$$MSG^GMPLX
"RTN","GMPLBLD2",258,0)
 Q
"RTN","GMPLBLD3")
0^6^B21650915
"RTN","GMPLBLD3",1,0)
GMPLBLD3 ; SLC/MKB,TC -- Bld PL Selection Lists cont ;08/22/17  14:15
"RTN","GMPLBLD3",2,0)
 ;;2.0;Problem List;**28,42,49**;Aug 25, 1994;Build 43
"RTN","GMPLBLD3",3,0)
 ;
"RTN","GMPLBLD3",4,0)
 ; External References:
"RTN","GMPLBLD3",5,0)
 ;   ICR  1966   $$GET1^DIQ(4.2,GMPLIFN,.01)
"RTN","GMPLBLD3",6,0)
 ;   ICR  2056   $$GET1^DIQ
"RTN","GMPLBLD3",7,0)
 ;   ICR  2263   ENVAL^XPAR
"RTN","GMPLBLD3",8,0)
 ;   ICR  4083   $$STATCHK^LEXSRC2
"RTN","GMPLBLD3",9,0)
 ;   ICR  5747   $$CODECS^ICDEX,$$STATCHK^ICDEX
"RTN","GMPLBLD3",10,0)
 ;   ICR  10103  $$DT^XLFDT
"RTN","GMPLBLD3",11,0)
 ;   ICR  10013  ^DIK
"RTN","GMPLBLD3",12,0)
 ;   ICR  10026  ^DIR
"RTN","GMPLBLD3",13,0)
 ;   ICR  10040  $$GET1^DIQ(44,GMPLIFN,.01)
"RTN","GMPLBLD3",14,0)
 ;   ICR  10060  $$GET1^DIQ(200,DUZ,.01)
"RTN","GMPLBLD3",15,0)
 ;   ICR  10090  $$GET1^DIQ(4,GMPLIFN,.01)
"RTN","GMPLBLD3",16,0)
 ;
"RTN","GMPLBLD3",17,0)
DELETE ; Delete Selection List
"RTN","GMPLBLD3",18,0)
 N DIR,DIK,DA,X,Y,GMPQUIT,GMPLSLST,GMPLSEQ,GMPLDA,GMPLFDA,GMPLMSG
"RTN","GMPLBLD3",19,0)
 N GMPLPAR,GMPLERR,GMPLENT,GMPLVIEW,GMPCNT,GMPLPLST,GMPLENTY
"RTN","GMPLBLD3",20,0)
 N GMPLUSR,GMPLDUZ,GMPLLST,GMPLERR1,GMPLTXT,GMPLUCNT,GMPLSUC
"RTN","GMPLBLD3",21,0)
 S (GMPLENT,GMPLENTY,GMPLUSR,GMPLDUZ)="",(GMPCNT,GMPLUCNT)=0,GMPLSUC=1
"RTN","GMPLBLD3",22,0)
 S GMPLSLST=$$LIST^GMPLBLD2("") Q:GMPLSLST="^"
"RTN","GMPLBLD3",23,0)
 I $P($G(GMPLSLST),U,5)="N" W !!,"Cannot delete a National Selection List." G DELQT
"RTN","GMPLBLD3",24,0)
 W !!,"Checking the Default Problem Selection List parameter for use of this list ..."
"RTN","GMPLBLD3",25,0)
 D ENVAL^XPAR(.GMPLPAR,"ORQQPL SELECTION LIST",1,.GMPLERR)
"RTN","GMPLBLD3",26,0)
 I +$G(GMPLERR)>0 W !!,"Error: "_$P(GMPLERR,U,2) G DELQT
"RTN","GMPLBLD3",27,0)
 I GMPLPAR>1 D
"RTN","GMPLBLD3",28,0)
 . F  S GMPLENT=$O(GMPLPAR(GMPLENT)) Q:GMPLENT=""  D
"RTN","GMPLBLD3",29,0)
 . . S GMPLVIEW=$G(GMPLPAR(GMPLENT,1)) Q:'GMPLVIEW  Q:GMPLVIEW'=+GMPLSLST
"RTN","GMPLBLD3",30,0)
 . . S GMPCNT=GMPCNT+1,GMPLPLST(GMPLENT)="" W "."
"RTN","GMPLBLD3",31,0)
 I GMPCNT D  Q
"RTN","GMPLBLD3",32,0)
 . W !!,"CANNOT DELETE",!,"This list is currently assigned to the following entities:",!!
"RTN","GMPLBLD3",33,0)
 . F  S GMPLENTY=$O(GMPLPLST(GMPLENTY)) Q:GMPLENTY=""  D
"RTN","GMPLBLD3",34,0)
 . . I GMPLENTY["VA(" W ?7,"User: "_$$GET1^DIQ(200,$P(GMPLENTY,";"),.01),! Q
"RTN","GMPLBLD3",35,0)
 . . I GMPLENTY["SC(" W ?7,"Clinic: "_$$GET1^DIQ(44,$P(GMPLENTY,";"),.01),! Q
"RTN","GMPLBLD3",36,0)
 . . I GMPLENTY["DIC(4.2" W ?7,"System: "_$$GET1^DIQ(4.2,$P(GMPLENTY,";"),.01),! Q
"RTN","GMPLBLD3",37,0)
 . . I GMPLENTY["DIC(4" W ?7,"Division: "_$$GET1^DIQ(4,$P(GMPLENTY,";"),.01),! Q
"RTN","GMPLBLD3",38,0)
 . G DELQT
"RTN","GMPLBLD3",39,0)
 W !,"No other parameter settings found."
"RTN","GMPLBLD3",40,0)
DEL1 S DIR(0)="Y",DIR("B")="NO"
"RTN","GMPLBLD3",41,0)
 S DIR("A")="Are you sure you want to delete this list"
"RTN","GMPLBLD3",42,0)
 S DIR("?",1)="Enter YES if you wish to completely remove this list; press <return>",DIR("?")="to leave this list unchanged and exit this option."
"RTN","GMPLBLD3",43,0)
 W $C(7),! D ^DIR Q:'Y
"RTN","GMPLBLD3",44,0)
 W !!,"Deleting "_$P(GMPLSLST,U,2)_" selection list ..."
"RTN","GMPLBLD3",45,0)
 S GMPLFDA(125,""_+GMPLSLST_",",.01)="@"
"RTN","GMPLBLD3",46,0)
 D FILE^DIE("K","GMPLFDA","GMPLMSG")
"RTN","GMPLBLD3",47,0)
 I $D(GMPLMSG) D EN^DDIOL("Error: "_GMPLMSG("DIERR",1,"TEXT",1))
"RTN","GMPLBLD3",48,0)
 E  D
"RTN","GMPLBLD3",49,0)
 . W !,"DONE."
"RTN","GMPLBLD3",50,0)
 . I $D(^GMPL(125,0)) S $P(^GMPL(125,0),U,3)=0
"RTN","GMPLBLD3",51,0)
 W !!,"Checking the NEW PERSON file for any pointers to this list and removing them..."
"RTN","GMPLBLD3",52,0)
 F  S GMPLUSR=$O(^VA(200,"B",GMPLUSR)) Q:GMPLUSR=""  D
"RTN","GMPLBLD3",53,0)
 . F  S GMPLDUZ=$O(^VA(200,"B",GMPLUSR,GMPLDUZ)) Q:GMPLDUZ=""  D
"RTN","GMPLBLD3",54,0)
 . . S GMPLLST=$$GET1^DIQ(200,GMPLDUZ,125.1,"I") Q:'GMPLLST
"RTN","GMPLBLD3",55,0)
 . . I +GMPLSLST=GMPLLST D
"RTN","GMPLBLD3",56,0)
 . . . S GMPLUCNT=GMPLUCNT+1
"RTN","GMPLBLD3",57,0)
 . . . S GMPLFDA(200,""_GMPLDUZ_",",125.1)="@"
"RTN","GMPLBLD3",58,0)
 . . . D FILE^DIE("K","GMPLFDA","GMPLERR1")
"RTN","GMPLBLD3",59,0)
 . . . I $D(GMPLERR1) D
"RTN","GMPLBLD3",60,0)
 . . . . S GMPLTXT(1)="Error deleting pointer #"_GMPLLST_" from user "_GMPLUSR_"."
"RTN","GMPLBLD3",61,0)
 . . . . S GMPLTXT(2)="Error: "_GMPLERR("DIERR",1,"TEXT",1),GMPLSUC=0
"RTN","GMPLBLD3",62,0)
 . . . . D EN^DDIOL(.GMPLTXT)
"RTN","GMPLBLD3",63,0)
 I 'GMPLUCNT W !,"No pointers found." G DELQT
"RTN","GMPLBLD3",64,0)
 I GMPLSUC W !,"DONE."
"RTN","GMPLBLD3",65,0)
DELQT W ! D PAUSE^GMPLX
"RTN","GMPLBLD3",66,0)
 Q
"RTN","GMPLBLD3",67,0)
 ;
"RTN","GMPLBLD3",68,0)
MENU ; -- init variables and list array for GMPL LIST MENU list template
"RTN","GMPLBLD3",69,0)
 ;    Expects GMPLSLST=selection list
"RTN","GMPLBLD3",70,0)
 N GSEQ,PSEQ,GCNT,PCNT,GROUP,HDR,IFN,LCNT,ITEM,TEXT,GMPICD,GMPLCPTR,GMPSCTC,GMPDT
"RTN","GMPLBLD3",71,0)
 S (GSEQ,GCNT,LCNT)=0,GMPDT=$$DT^XLFDT K ^TMP("GMPLMENU",$J)
"RTN","GMPLBLD3",72,0)
 W !!,"Retrieving list of "_$P(GMPLSLST,U,2)_" problems ..."
"RTN","GMPLBLD3",73,0)
 F  S GSEQ=$O(^GMPL(125,"AD",+GMPLSLST,GSEQ)) Q:GSEQ'>0  D
"RTN","GMPLBLD3",74,0)
 . S IFN=$O(^GMPL(125,"AD",+GMPLSLST,GSEQ,0)) Q:IFN'>0
"RTN","GMPLBLD3",75,0)
 . S ITEM=$G(^GMPL(125,+GMPLSLST,1,IFN,0)),GROUP=$P(ITEM,U,1),HDR=$P(ITEM,U,3,4)
"RTN","GMPLBLD3",76,0)
 . S GCNT=GCNT+1,(PSEQ,PCNT)=0,^TMP("GMPLMENU",$J,GCNT,0)=HDR
"RTN","GMPLBLD3",77,0)
 . F  S PSEQ=$O(^GMPL(125.11,"C",+GROUP,PSEQ)) Q:PSEQ'>0  D
"RTN","GMPLBLD3",78,0)
 . . S IFN=$O(^GMPL(125.11,"C",+GROUP,PSEQ,0)) Q:IFN'>0
"RTN","GMPLBLD3",79,0)
 . . S ITEM=$G(^GMPL(125.11,+GROUP,1,IFN,0)),TEXT=$P(ITEM,U,3)
"RTN","GMPLBLD3",80,0)
 . . S GMPICD=$P(ITEM,U,4),GMPSCTC=$P(ITEM,U,5)
"RTN","GMPLBLD3",81,0)
 . . I $L(GMPSCTC) D
"RTN","GMPLBLD3",82,0)
 . . . I '$$STATCHK^LEXSRC2(GMPSCTC,GMPDT,"","SCT") Q
"RTN","GMPLBLD3",83,0)
 . . I $L(GMPICD) D
"RTN","GMPLBLD3",84,0)
 . . . N GMPLCPTR,GMI S GMPLCPTR=$P($$CODECS^ICDEX($P(GMPICD,"/"),80,GMPDT),U)
"RTN","GMPLBLD3",85,0)
 . . . F GMI=1:1:$L(GMPICD,"/") D
"RTN","GMPLBLD3",86,0)
 . . . . I '$$STATCHK^ICDEX($P(GMPICD,"/",GMI),GMPDT,GMPLCPTR) Q  ; screen inactive codes
"RTN","GMPLBLD3",87,0)
 . . S PCNT=PCNT+1,^TMP("GMPLMENU",$J,GCNT,PCNT)=$P(ITEM,U,1)_U_$P(ITEM,U,3,4)
"RTN","GMPLBLD3",88,0)
 I '$D(^TMP("GMPLMENU",$J)) W !!,"No items available.  Returning to Problem List ..." H 2 S VALMBCK="Q",VALMQUIT=1 Q
"RTN","GMPLBLD3",89,0)
 D BUILD^GMPLMENU
"RTN","GMPLBLD3",90,0)
 Q
"RTN","GMPLBLDC")
0^7^B105378779
"RTN","GMPLBLDC",1,0)
GMPLBLDC ; SLC/MKB,TC -- Build Problem Selection Categories ;09/20/17  11:56
"RTN","GMPLBLDC",2,0)
 ;;2.0;Problem List;**3,7,28,36,42,45,49**;Aug 25, 1994;Build 43
"RTN","GMPLBLDC",3,0)
 ;
"RTN","GMPLBLDC",4,0)
 ; External References:
"RTN","GMPLBLDC",5,0)
 ;   ICR  2950/6267  LOOK^LEXA
"RTN","GMPLBLDC",6,0)
 ;   ICR  4083     $$STATCHK^LEXSRC2
"RTN","GMPLBLDC",7,0)
 ;   ICR  5006     $$GETSYN^LEXTRAN1
"RTN","GMPLBLDC",8,0)
 ;   ICR  5679     $$ONE^LEXU,$$IMPDATE^LEXU
"RTN","GMPLBLDC",9,0)
 ;   ICR  5747     $$CODECS^ICDEX,$$STATCHK^ICDEX
"RTN","GMPLBLDC",10,0)
 ;   ICR  10103    $$DT^XLFDT,$$FMTE^XLFDT,$$NOW^XLFDT
"RTN","GMPLBLDC",11,0)
 ;   ICR  10104    $$UP^XLFSTR
"RTN","GMPLBLDC",12,0)
 ;   ICR  10116    FULL^VALM1
"RTN","GMPLBLDC",13,0)
 ;   ICR  10117    CNTRL^VALM10
"RTN","GMPLBLDC",14,0)
 ;   ICR  10118    EN^VALM
"RTN","GMPLBLDC",15,0)
 ;
"RTN","GMPLBLDC",16,0)
EN ; -- main entry point for GMPL SELECTION GROUP BUILD
"RTN","GMPLBLDC",17,0)
 D EN^VALM("GMPL SELECTION GROUP BUILD")
"RTN","GMPLBLDC",18,0)
 Q
"RTN","GMPLBLDC",19,0)
 ;
"RTN","GMPLBLDC",20,0)
HDR ; -- header code
"RTN","GMPLBLDC",21,0)
 N NAME,NUM,DATE S NUM=+^TMP("GMPLST",$J,0)_" problem"_$S(+^TMP("GMPLST",$J,0)'=1:"s",1:"")
"RTN","GMPLBLDC",22,0)
 S DATE="Last Modified: "_$S(+$P(GMPLGRP,U,3):$$FMTE^XLFDT($P(GMPLGRP,U,3)),1:"<new category>")
"RTN","GMPLBLDC",23,0)
 S VALMHDR(1)=DATE_$J(NUM,79-$L(DATE))
"RTN","GMPLBLDC",24,0)
 S NAME=$P(GMPLGRP,U,2),VALMHDR(2)=$J(NAME,$L(NAME)\2+41)
"RTN","GMPLBLDC",25,0)
 Q
"RTN","GMPLBLDC",26,0)
 ;
"RTN","GMPLBLDC",27,0)
INIT ; -- init variables and list array
"RTN","GMPLBLDC",28,0)
 S GMPLGRP=$$GROUP^GMPLBLD2("L") I GMPLGRP="^" S VALMQUIT=1 Q
"RTN","GMPLBLDC",29,0)
 L +^GMPL(125.11,+GMPLGRP,0):1 I '$T D  G INIT
"RTN","GMPLBLDC",30,0)
 . W $C(7),!!,"This category is currently being edited by another user!",!
"RTN","GMPLBLDC",31,0)
 S GMPLMODE="E",VALMSG=$$MSG^GMPLX
"RTN","GMPLBLDC",32,0)
 D GETLIST,BUILD("^TMP(""GMPLIST"",$J)",GMPLMODE)
"RTN","GMPLBLDC",33,0)
 Q
"RTN","GMPLBLDC",34,0)
 ;
"RTN","GMPLBLDC",35,0)
GETLIST ; Build ^TMP("GMPLIST",$J,#) of problems
"RTN","GMPLBLDC",36,0)
 N ITEM,PROB,CNT,GMPSEQ,GMPLDA K ^TMP("GMPLIST",$J) S CNT=0
"RTN","GMPLBLDC",37,0)
 W !,"Searching for the problems ..."
"RTN","GMPLBLDC",38,0)
 S (GMPSEQ,GMPLDA)=""
"RTN","GMPLBLDC",39,0)
 F  S GMPSEQ=$O(^GMPL(125.11,"C",+GMPLGRP,GMPSEQ)) Q:'GMPSEQ  D
"RTN","GMPLBLDC",40,0)
 . F  S GMPLDA=$O(^GMPL(125.11,"C",+GMPLGRP,GMPSEQ,GMPLDA)) Q:'GMPLDA  D
"RTN","GMPLBLDC",41,0)
 . . S ITEM=$G(^GMPL(125.11,+GMPLGRP,1,GMPLDA,0)),PROB=$P(ITEM,U,1)
"RTN","GMPLBLDC",42,0)
 . . ; prob ^ seq ^ text ^ ICD code ^ snomed ct concept ^ snomed ct designation
"RTN","GMPLBLDC",43,0)
 . . S ^TMP("GMPLIST",$J,GMPLDA)=$G(ITEM),CNT=CNT+1
"RTN","GMPLBLDC",44,0)
 . . S (^TMP("GMPLIST",$J,"PROB",PROB),^TMP("GMPLIST",$J,"SEQ",GMPSEQ))=GMPLDA ; Xrefs
"RTN","GMPLBLDC",45,0)
 S ^TMP("GMPLIST",$J,0)=CNT
"RTN","GMPLBLDC",46,0)
 Q
"RTN","GMPLBLDC",47,0)
 ;
"RTN","GMPLBLDC",48,0)
BUILD(LIST,MODE) ; Build ^TMP("GMPLST",$J,) of current items in LIST for display
"RTN","GMPLBLDC",49,0)
 N GMPSEQ,GMPIFN,LCNT,NUM,PROB,TEXT,ITEM,GMPDT D CLEAN^VALM10
"RTN","GMPLBLDC",50,0)
 I $P($G(^TMP("GMPLIST",$J,0)),U,1)'>0 S ^TMP("GMPLST",$J,1,0)="   ",^TMP("GMPLST",$J,2,0)="No items available.",^TMP("GMPLST",$J,0)="0^2",VALMCNT=2 Q
"RTN","GMPLBLDC",51,0)
 S (LCNT,NUM,GMPSEQ)=0,GMPDT=$$DT^XLFDT
"RTN","GMPLBLDC",52,0)
 F  S GMPSEQ=$O(^TMP("GMPLIST",$J,"SEQ",GMPSEQ)) Q:GMPSEQ'>0  D
"RTN","GMPLBLDC",53,0)
 . N GMI,GMPLCSYS,GMPLCPTR,GMPSCT,GMPSCTC,GMPICD,GMPICDC,GMPCSYS
"RTN","GMPLBLDC",54,0)
 . S (GMPSCT,GMPICD)=0,LCNT=LCNT+1,NUM=NUM+1
"RTN","GMPLBLDC",55,0)
 . S GMPIFN=$G(^TMP("GMPLIST",$J,"SEQ",GMPSEQ))
"RTN","GMPLBLDC",56,0)
 . S PROB=$P(^TMP("GMPLIST",$J,GMPIFN),U,1),TEXT=$P(^TMP("GMPLIST",$J,GMPIFN),U,3)
"RTN","GMPLBLDC",57,0)
 . S GMPICDC=$P(^TMP("GMPLIST",$J,GMPIFN),U,4),GMPSCTC=$P(^TMP("GMPLIST",$J,GMPIFN),U,5)
"RTN","GMPLBLDC",58,0)
 . S ^TMP("GMPLST",$J,LCNT,0)=$S(MODE="I":"<"_GMPSEQ_">",1:"   ")_$J(NUM,3)_" "_TEXT
"RTN","GMPLBLDC",59,0)
 . I $L(GMPSCTC) D
"RTN","GMPLBLDC",60,0)
 . . I $$STATCHK^LEXSRC2(GMPSCTC,GMPDT,"","SCT") Q
"RTN","GMPLBLDC",61,0)
 . . S GMPSCT=1
"RTN","GMPLBLDC",62,0)
 . I $L(GMPICDC) D
"RTN","GMPLBLDC",63,0)
 . . S ^TMP("GMPLST",$J,LCNT,0)=^TMP("GMPLST",$J,LCNT,0)_" ("_$P($$CODECS^ICDEX($P(GMPICDC,"/"),80,GMPDT),U,2)_" "_GMPICDC_")"
"RTN","GMPLBLDC",64,0)
 . . F GMI=1:1:$L(GMPICDC,"/") D
"RTN","GMPLBLDC",65,0)
 . . . N GMPLCPTR S GMPLCPTR=$P($$CODECS^ICDEX($P(GMPICDC,"/",GMI),80,GMPDT),U)
"RTN","GMPLBLDC",66,0)
 . . . I $$STATCHK^ICDEX($P(GMPICDC,"/",GMI),GMPDT,GMPLCPTR) Q  ; OK - code is active
"RTN","GMPLBLDC",67,0)
 . . . S GMPICD=1
"RTN","GMPLBLDC",68,0)
 . S GMPCSYS=$S(GMPSCT:"SCT",GMPICD:"ICD",(GMPSCT&GMPICD):"SCT/ICD",1:"")
"RTN","GMPLBLDC",69,0)
 . S:GMPCSYS'="" ^TMP("GMPLST",$J,LCNT,0)=^TMP("GMPLST",$J,LCNT,0)_"    <INACTIVE "_GMPCSYS_" CODE>"
"RTN","GMPLBLDC",70,0)
 . D CNTRL^VALM10(LCNT,6,1,IOINHI,IOINORM)
"RTN","GMPLBLDC",71,0)
 . S ^TMP("GMPLST",$J,"B",NUM)=GMPIFN
"RTN","GMPLBLDC",72,0)
 S ^TMP("GMPLST",$J,0)=NUM_U_LCNT,VALMCNT=LCNT
"RTN","GMPLBLDC",73,0)
 Q
"RTN","GMPLBLDC",74,0)
 ;
"RTN","GMPLBLDC",75,0)
HELP ; -- help code
"RTN","GMPLBLDC",76,0)
 N X
"RTN","GMPLBLDC",77,0)
 W !!?4,"You may take a variety of actions from this prompt.  To update"
"RTN","GMPLBLDC",78,0)
 W !?4,"this category you may add new problems or remove an existing"
"RTN","GMPLBLDC",79,0)
 W !?4,"one; you may also change the text or code displayed, or the order"
"RTN","GMPLBLDC",80,0)
 W !?4,"in which each problem is displayed.  Select View w/wo Seq Numbers"
"RTN","GMPLBLDC",81,0)
 W !?4,"to toggle seeing the sequence number in addition to the display"
"RTN","GMPLBLDC",82,0)
 W !?4,"number per problem.  If necessary, the current category may be"
"RTN","GMPLBLDC",83,0)
 W !?4,"deleted; you may change to a different category to continue editing."
"RTN","GMPLBLDC",84,0)
 W !!,"Press <return> to continue ..." R X:DTIME
"RTN","GMPLBLDC",85,0)
 S VALMSG=$$MSG^GMPLX,VALMBCK=$S(VALMCC:"",1:"R")
"RTN","GMPLBLDC",86,0)
 Q
"RTN","GMPLBLDC",87,0)
 ;
"RTN","GMPLBLDC",88,0)
EXIT ; -- exit code
"RTN","GMPLBLDC",89,0)
 N GMPDT
"RTN","GMPLBLDC",90,0)
 I $D(GMPLSAVE),$$CKSAVE^GMPLBLD2 D
"RTN","GMPLBLDC",91,0)
 . S GMPDT=$$DT^XLFDT
"RTN","GMPLBLDC",92,0)
 . D SAVE^GMPLBLD2
"RTN","GMPLBLDC",93,0)
 . S ^GMPL(125.11,+GMPLGRP,0)=$P(GMPLGRP,U,2)_U_GMPDT_U_$P(GMPLGRP,U,4)
"RTN","GMPLBLDC",94,0)
 L -^GMPL(125.11,+GMPLGRP,0)
"RTN","GMPLBLDC",95,0)
 K GMPLIST,GMPLST,GMPLMODE,GMPLGRP,GMPLSAVE,GMPREBLD,GMPQUIT,RT1,TMPITEM
"RTN","GMPLBLDC",96,0)
 K VALMBCK,VALMCNT,VALMSG,VALMHDR
"RTN","GMPLBLDC",97,0)
 K ^TMP("GMPLIST",$J),^TMP("GMPLST",$J)
"RTN","GMPLBLDC",98,0)
 Q
"RTN","GMPLBLDC",99,0)
 ;
"RTN","GMPLBLDC",100,0)
ADD ; Add new problem(s)
"RTN","GMPLBLDC",101,0)
 N GMPVOCAB,GMPQUIT,GMPREBLD,GMPIMPDT S VALMBCK="" D FULL^VALM1
"RTN","GMPLBLDC",102,0)
 S GMPVOCAB="" ; $$VOCAB^GMPLX1 Q:GMPVOCAB="^"
"RTN","GMPLBLDC",103,0)
 I $P($G(GMPLGRP),U,4)="N" W !!,"Cannot make edits to a National category." H 2 Q
"RTN","GMPLBLDC",104,0)
 S GMPIMPDT=$$IMPDATE^LEXU("10D")
"RTN","GMPLBLDC",105,0)
 F  D  Q:$D(GMPQUIT)  W !!
"RTN","GMPLBLDC",106,0)
ASKAG . N X,Y,GMPLSEQ,GMPLCODE,GMPLIFN,GMPLSCTT,GMPLSCTC,GMPLSCTD
"RTN","GMPLBLDC",107,0)
 . N GMPLDUP,GMPLTERM,GMPLICD,GMPTYP,GMPNUM,GMPQT,GMPSYN,GMPDT,GMPROB
"RTN","GMPLBLDC",108,0)
 . S (X,Y,GMPLSCTT,GMPLSCTC,GMPLSCTD,GMPTYP)="",(GMPNUM,GMPQT)=0
"RTN","GMPLBLDC",109,0)
 . D SEARCH^GMPLX(.X,.Y,"PROBLEM: ","1",GMPVOCAB)
"RTN","GMPLBLDC",110,0)
 . S GMPDT=$$DT^XLFDT
"RTN","GMPLBLDC",111,0)
 . I +Y'>0 S GMPQUIT=1 Q
"RTN","GMPLBLDC",112,0)
 . S GMPLDUP=$$DUPL(.Y,X)
"RTN","GMPLBLDC",113,0)
 . I GMPLDUP S (Y,GMPROB)="" W !,X,!,"is already on the selection list.  Please enter another search term to add." G ASKAG
"RTN","GMPLBLDC",114,0)
 . S GMPLTERM=$S(+$G(Y)>1:Y,1:""),GMPLICD=$G(Y(1))
"RTN","GMPLBLDC",115,0)
 . S:'$L(GMPLICD) GMPLICD=$S(GMPDT<GMPIMPDT:"799.9",1:"R69.")
"RTN","GMPLBLDC",116,0)
 . N GMPLI,GMPSTAT,GMPCSREC,GMPCSPTR,GMPCSNME,GMPLRSLT,GMPLRT1
"RTN","GMPLBLDC",117,0)
 . I GMPLICD["/" F GMPLI=1:1:$L(GMPLICD,"/") D  Q:GMPSTAT
"RTN","GMPLBLDC",118,0)
 . . N GMPCODE S GMPCODE=$P(GMPLICD,"/",GMPLI),GMPSTAT=0
"RTN","GMPLBLDC",119,0)
 . . S GMPCSREC=$$CODECS^ICDEX(GMPCODE,80,GMPDT),GMPCSPTR=$P(GMPCSREC,U),GMPCSNME=$P(GMPCSREC,U,2)
"RTN","GMPLBLDC",120,0)
 . . S:'+$$STATCHK^ICDEX(GMPCODE,GMPDT,GMPCSPTR) GMPSTAT=1
"RTN","GMPLBLDC",121,0)
 . E  D
"RTN","GMPLBLDC",122,0)
 . . S GMPSTAT=0,GMPCSREC=$$CODECS^ICDEX(GMPLICD,80,GMPDT),GMPCSPTR=$P(GMPCSREC,U),GMPCSNME=$P(GMPCSREC,U,2)
"RTN","GMPLBLDC",123,0)
 . . S:'+$$STATCHK^ICDEX(GMPLICD,GMPDT,GMPCSPTR) GMPSTAT=1
"RTN","GMPLBLDC",124,0)
 . I GMPSTAT W !,X,!,"has an inactive ICD code.  Please enter another search term to add." G ASKAG
"RTN","GMPLBLDC",125,0)
 . I X["(SCT" D
"RTN","GMPLBLDC",126,0)
 . . S GMPLSCTT=$P(X," (SCT ")
"RTN","GMPLBLDC",127,0)
 . . S GMPLSCTC=$$ONE^LEXU(+GMPLTERM,GMPDT,"SCT")
"RTN","GMPLBLDC",128,0)
 . . S GMPLRSLT=$$GETSYN^LEXTRAN1("SCT",GMPLSCTC,GMPDT,"GMPSYN",1,1)
"RTN","GMPLBLDC",129,0)
 . . I +GMPLRSLT<0 S GMPLSCTD="" Q
"RTN","GMPLBLDC",130,0)
 . . S GMPLSCTT=$$STRIPSPC^GMPLX(GMPLSCTT)
"RTN","GMPLBLDC",131,0)
 . . F  S GMPTYP=$O(GMPSYN(GMPTYP)) Q:GMPTYP=""!(GMPQT)  D
"RTN","GMPLBLDC",132,0)
 . . . I GMPTYP="S" F  S GMPNUM=$O(GMPSYN(GMPTYP,GMPNUM)) Q:GMPNUM=""!(GMPQT)  D
"RTN","GMPLBLDC",133,0)
 . . . . I $$STRIPSPC^GMPLX($P(GMPSYN(GMPTYP,GMPNUM),U))=GMPLSCTT S GMPLSCTD=$P(GMPSYN(GMPTYP,GMPNUM),U,3),GMPQT=1 Q
"RTN","GMPLBLDC",134,0)
 . . . I (GMPNUM=""),(GMPLSCTD="") S GMPQT=1 Q
"RTN","GMPLBLDC",135,0)
 . . . Q:GMPQT
"RTN","GMPLBLDC",136,0)
 . . . I $$STRIPSPC^GMPLX($P(GMPSYN(GMPTYP),U))=GMPLSCTT S GMPLSCTD=$P(GMPSYN(GMPTYP),U,3),GMPQT=1 Q
"RTN","GMPLBLDC",137,0)
 . W !!,"  DISPLAY TEXT: "_X
"RTN","GMPLBLDC",138,0)
 . S GMPLCODE=$$CODE^GMPLBLD1($G(GMPLSCTC),$G(Y(1))) I GMPLCODE']"" S GMPQUIT=1 Q
"RTN","GMPLBLDC",139,0)
 . S GMPLRT1="^TMP(""GMPLIST"",$J,""SEQ"",",GMPLSEQ=+$$LAST^GMPLBLD2(GMPLRT1)+1 ; dflt = next #
"RTN","GMPLBLDC",140,0)
 . S GMPLSEQ=$$SEQ^GMPLBLD1(GMPLSEQ) I GMPLSEQ="^" S GMPQUIT=1 Q
"RTN","GMPLBLDC",141,0)
 . S GMPLIFN=$$TMPIFN^GMPLBLD1,^TMP("GMPLIST",$J,0)=^TMP("GMPLIST",$J,0)+1
"RTN","GMPLBLDC",142,0)
 . S ^TMP("GMPLIST",$J,GMPLIFN)=+Y_U_GMPLSEQ_U_X_U_GMPLCODE_U_GMPLSCTC_U_GMPLSCTD ; prob ^ seq ^ text ^ code ^ snomed ct concept ^ snomed ct designation
"RTN","GMPLBLDC",143,0)
 . S (^TMP("GMPLIST",$J,"PROB",+Y),^TMP("GMPLIST",$J,"SEQ",GMPLSEQ))=GMPLIFN,GMPREBLD=1
"RTN","GMPLBLDC",144,0)
 I $D(GMPREBLD) S VALMBCK="R",GMPLSAVE=1 D BUILD("^TMP(""GMPLIST"",$J)",GMPLMODE),HDR
"RTN","GMPLBLDC",145,0)
 S VALMBCK="R" S VALMSG=$$MSG^GMPLX K GMPSYN
"RTN","GMPLBLDC",146,0)
 Q
"RTN","GMPLBLDC",147,0)
 ;
"RTN","GMPLBLDC",148,0)
COPY ; Copy an existing category into a new category
"RTN","GMPLBLDC",149,0)
 N GMPVAL
"RTN","GMPLBLDC",150,0)
 D COPYCAT^GMPLCOPY(.GMPVAL)
"RTN","GMPLBLDC",151,0)
 I $D(GMPVAL) S GMPLGRP=GMPVAL
"RTN","GMPLBLDC",152,0)
 S VALMBCK="R",VALMSG=$$MSG^GMPLX
"RTN","GMPLBLDC",153,0)
 D GETLIST,BUILD("^TMP(""GMPLIST"",$J)",GMPLMODE),HDR
"RTN","GMPLBLDC",154,0)
 Q
"RTN","GMPLBLDC",155,0)
 ;
"RTN","GMPLBLDC",156,0)
REMOVE ; Remove problem from group
"RTN","GMPLBLDC",157,0)
 N NUM,IFN S VALMBCK=""
"RTN","GMPLBLDC",158,0)
 I $P($G(GMPLGRP),U,4)="N" W !!,"Cannot make edits to a National category." H 2 G RMQ
"RTN","GMPLBLDC",159,0)
 S NUM=$$SEL1^GMPLBLD1 G:NUM="^" RMQ
"RTN","GMPLBLDC",160,0)
 S IFN=$P($G(^TMP("GMPLST",$J,"B",NUM)),U,1) G:+IFN'>0 RMQ
"RTN","GMPLBLDC",161,0)
 I "@"[$G(^TMP("GMPLIST",$J,IFN)) W $C(7),!!,"Problem does not exist in this category!" H 2 G RMQ
"RTN","GMPLBLDC",162,0)
 I '$$SURE^GMPLX W !?5,"< Nothing removed! >" H 1 G RMQ
"RTN","GMPLBLDC",163,0)
 D DELETE^GMPLBLD1(IFN) S VALMBCK="R",GMPLSAVE=1
"RTN","GMPLBLDC",164,0)
 D BUILD("^TMP(""GMPLIST"",$J)",GMPLMODE),HDR
"RTN","GMPLBLDC",165,0)
RMQ S:'VALMCC VALMBCK="R" S VALMSG=$$MSG^GMPLX
"RTN","GMPLBLDC",166,0)
 Q
"RTN","GMPLBLDC",167,0)
 ;
"RTN","GMPLBLDC",168,0)
EDIT ; Edit problem text and code
"RTN","GMPLBLDC",169,0)
 N NUM,SEL,IFN,PIECE,CODE,PROB,PROBLEM,GMPQUIT,GMPREBLD S VALMBCK="" D FULL^VALM1
"RTN","GMPLBLDC",170,0)
 I $P($G(GMPLGRP),U,4)="N" W !!,"Cannot make edits to a National category." H 2 G EDQ
"RTN","GMPLBLDC",171,0)
 S SEL=$$SEL^GMPLBLD1 G:SEL="^" EDQ
"RTN","GMPLBLDC",172,0)
 F PIECE=1:1:$L(SEL,",") D  Q:$D(GMPQUIT)  W !
"RTN","GMPLBLDC",173,0)
 . S NUM=$P(SEL,",",PIECE) Q:NUM'>0
"RTN","GMPLBLDC",174,0)
 . S IFN=$P($G(^TMP("GMPLST",$J,"B",NUM)),U,1) Q:IFN'>0
"RTN","GMPLBLDC",175,0)
 . I "@"[$G(^TMP("GMPLIST",$J,IFN)) W $C(7),!!,"Problem #"_NUM_" does not exist in this category!" H 2 Q
"RTN","GMPLBLDC",176,0)
 . W !!,">>>  Problem #"_NUM S PROBLEM=^TMP("GMPLIST",$J,IFN)
"RTN","GMPLBLDC",177,0)
 . W:$P(PROBLEM,U,1)>1 " = "_$G(^LEX(757.01,+$P(PROBLEM,U,1),0)) W ! ; KER
"RTN","GMPLBLDC",178,0)
 . S PROB=$$TEXT^GMPLBLD1($P(PROBLEM,U,3)) I PROB="^" S GMPQUIT=1 Q
"RTN","GMPLBLDC",179,0)
 . I PROB="@" D DELETE^GMPLBLD1(IFN) S GMPREBLD=1 Q
"RTN","GMPLBLDC",180,0)
 . S CODE=$$CODE^GMPLBLD1($P(PROBLEM,U,5),$P(PROBLEM,U,4)) I CODE="^" S GMPQUIT=1 Q
"RTN","GMPLBLDC",181,0)
 . S ^TMP("GMPLIST",$J,IFN)=$P(PROBLEM,U,1,2)_U_PROB_U_CODE_U_$P(PROBLEM,U,5,6),GMPREBLD=1
"RTN","GMPLBLDC",182,0)
 I $D(GMPREBLD) S VALMBCK="R",GMPLSAVE=1 D BUILD("^TMP(""GMPLIST"",$J)",GMPLMODE)
"RTN","GMPLBLDC",183,0)
EDQ S:'VALMCC VALMBCK="R" S VALMSG=$$MSG^GMPLX
"RTN","GMPLBLDC",184,0)
 Q
"RTN","GMPLBLDC",185,0)
 ;
"RTN","GMPLBLDC",186,0)
DUPL(Y,TEXT) ; Check for Duplicates within problem selection list category
"RTN","GMPLBLDC",187,0)
 N DA,IFN,GMPOTHR,GMPNOW,GMPSRC,GMPCODE,SCTCNEW,ICDNEW,PICDNEW
"RTN","GMPLBLDC",188,0)
 S DA=0
"RTN","GMPLBLDC",189,0)
 I '$D(^TMP("GMPLIST")) G DUPLX
"RTN","GMPLBLDC",190,0)
 S GMPNOW=$E($$NOW^XLFDT,1,7)
"RTN","GMPLBLDC",191,0)
 S GMPOTHR=$S(GMPNOW<($$IMPDATE^LEXU("10D")):"799.9",1:"R69.")
"RTN","GMPLBLDC",192,0)
 D EXP2CODE^GMPLX(+Y,.GMPSRC,.GMPCODE)
"RTN","GMPLBLDC",193,0)
 S SCTCNEW=$S(GMPSRC="SNOMED CT"&($D(GMPCODE)):GMPCODE,1:$P($P(TEXT," (SCT ",2),")"))
"RTN","GMPLBLDC",194,0)
 S ICDNEW=$S(GMPSRC="SNOMED CT":$G(Y(1)),1:GMPCODE),PICDNEW=$P(ICDNEW,"/")
"RTN","GMPLBLDC",195,0)
 S IFN=""
"RTN","GMPLBLDC",196,0)
 F  S IFN=$O(^TMP("GMPLIST",$J,IFN)) Q:IFN=""  D  Q:DA>0
"RTN","GMPLBLDC",197,0)
 .N PICDEXT,ICDEXT,SLST,SCTCEXT,TERMEXT,EXPTXT
"RTN","GMPLBLDC",198,0)
 .S SLST=$G(^TMP("GMPLIST",$J,IFN)),SCTCEXT=$P(SLST,U,5)
"RTN","GMPLBLDC",199,0)
 .S ICDEXT=$P(SLST,U,4),PICDEXT=$P(ICDEXT,"/")
"RTN","GMPLBLDC",200,0)
 .S TERMEXT=$P(SLST,U,1)
"RTN","GMPLBLDC",201,0)
 .;Compare problems with SNOMED CT concept codes & ICD code(s) only
"RTN","GMPLBLDC",202,0)
 .I $L(SCTCEXT),(GMPSRC="SNOMED CT"),($G(SCTCNEW)>0),($L(ICDNEW)) D
"RTN","GMPLBLDC",203,0)
 ..;if SCT concepts & primary + multiple ICD targets match => dup
"RTN","GMPLBLDC",204,0)
 ..I ICDEXT["/",ICDNEW["/" D
"RTN","GMPLBLDC",205,0)
 ...N I,J,SICDEXT S J=0 F I=2:1:$L(ICDEXT,"/") D
"RTN","GMPLBLDC",206,0)
 ....S J=J+1,SICDEXT(J)=$P(ICDEXT,"/",I)
"RTN","GMPLBLDC",207,0)
 ...N K,L,SICDNEW S L=0 F K=2:1:$L(ICDNEW,"/") D
"RTN","GMPLBLDC",208,0)
 ....S L=L+1,SICDNEW(L)=$P(ICDNEW,"/",K)
"RTN","GMPLBLDC",209,0)
 ...N T F T=1:1:L D
"RTN","GMPLBLDC",210,0)
 ....I SCTCEXT=SCTCNEW,(PICDEXT=PICDNEW),SICDEXT(T)=SICDNEW(T) S DA=IFN Q
"RTN","GMPLBLDC",211,0)
 ..;if SCT concept codes match => dup
"RTN","GMPLBLDC",212,0)
 ..E  I ICDNEW=GMPOTHR!(PICDNEW=GMPOTHR) D
"RTN","GMPLBLDC",213,0)
 ...I SCTCEXT=SCTCNEW S DA=IFN Q
"RTN","GMPLBLDC",214,0)
 ..;if SCT concepts & primary ICD diagnosis match => dup
"RTN","GMPLBLDC",215,0)
 ..E  I SCTCEXT=SCTCNEW,(PICDEXT=PICDNEW) S DA=IFN Q
"RTN","GMPLBLDC",216,0)
 .;Compare legacy problems with ICD codes only
"RTN","GMPLBLDC",217,0)
 .E  I $L(ICDEXT),'$L(SCTCEXT),(GMPSRC["ICD"),(+$G(ICDNEW)>0) D
"RTN","GMPLBLDC",218,0)
 ..;if Exprs match => dup
"RTN","GMPLBLDC",219,0)
 ..I +Y>1&(TERMEXT=+Y) S DA=IFN Q
"RTN","GMPLBLDC",220,0)
 ..;if Text matches Expr from old => dup
"RTN","GMPLBLDC",221,0)
 ..D LOOK^LEXA("`"_TERMEXT)
"RTN","GMPLBLDC",222,0)
 ..S EXPTXT=$P($G(LEX("LIST",1)),U,2)
"RTN","GMPLBLDC",223,0)
 ..S TEXT=$$UP^XLFSTR($P(TEXT," (ICD"))
"RTN","GMPLBLDC",224,0)
 ..I LEX>1&(TEXT=$$UP^XLFSTR($S(EXPTXT["*":$P(EXPTXT," *"),1:EXPTXT))) S DA=IFN Q
"RTN","GMPLBLDC",225,0)
 ..;if prim ICD of new = prim ICD of old => dup
"RTN","GMPLBLDC",226,0)
 ..I PICDEXT'=GMPOTHR,(PICDNEW'=GMPOTHR),(PICDEXT=PICDNEW) S DA=IFN Q
"RTN","GMPLBLDC",227,0)
DUPLX Q DA
"RTN","GMPLCLN")
0^15^B127703293
"RTN","GMPLCLN",1,0)
GMPLCLN ;ISP/TC - Problem File Cleanup Utilities ;03/07/17  08:51
"RTN","GMPLCLN",2,0)
 ;;2.0;Problem List;**40,49**;Aug 25, 1994;Build 43
"RTN","GMPLCLN",3,0)
 ;
"RTN","GMPLCLN",4,0)
 ;
"RTN","GMPLCLN",5,0)
 ; External References
"RTN","GMPLCLN",6,0)
 ;    BROWSE^DDBR           ICR   2607
"RTN","GMPLCLN",7,0)
 ;    $$NOW^XLFDT           ICR  10103
"RTN","GMPLCLN",8,0)
 ;    $$FMADD^XLFDT         ICR  10103
"RTN","GMPLCLN",9,0)
 ;    $$FMTE^XLFDT          ICR  10103
"RTN","GMPLCLN",10,0)
 ;    $$REPEAT^XLFSTR       ICR  10104
"RTN","GMPLCLN",11,0)
 ;    $$LJ^XLFSTR           ICR  10104
"RTN","GMPLCLN",12,0)
 ;    MES^XPDUTL            ICR  10141
"RTN","GMPLCLN",13,0)
 ;
"RTN","GMPLCLN",14,0)
BLDLEMSG(GMPLMSG,GMPLNERR,GMPLFROM,GMPLNODE) ; Build Lock Error MailMan message and send to installer
"RTN","GMPLCLN",15,0)
 N GMPLTO,GMPXMSUB,SUB,GMPMAXER,GMPLEND,GMPI,GMPJ,GMPK,GMPCNT,GMPCNTR
"RTN","GMPLCLN",16,0)
 S GMPCNT=4,GMPK=""
"RTN","GMPLCLN",17,0)
 I GMPLNERR=0 Q
"RTN","GMPLCLN",18,0)
 S GMPMAXER=200
"RTN","GMPLCLN",19,0)
 K ^TMP("GMPXMZLE",$J)
"RTN","GMPLCLN",20,0)
 S SUB="GMPXMZLE"
"RTN","GMPLCLN",21,0)
 S ^TMP(SUB,$J,1,0)="A lock on the following record entries could not be obtained because another"
"RTN","GMPLCLN",22,0)
 S ^TMP(SUB,$J,2,0)="user was editing the entry. As a result these entries could not be corrected/"
"RTN","GMPLCLN",23,0)
 S ^TMP(SUB,$J,3,0)="updated."
"RTN","GMPLCLN",24,0)
 S ^TMP(SUB,$J,4,0)=""
"RTN","GMPLCLN",25,0)
 I $D(GMPLMSG) D
"RTN","GMPLCLN",26,0)
 . F  S GMPK=$O(GMPLMSG(GMPK)) Q:'GMPK  D
"RTN","GMPLCLN",27,0)
 . . S GMPCNT=GMPCNT+1
"RTN","GMPLCLN",28,0)
 . . S ^TMP(SUB,$J,GMPCNT,0)=$G(GMPLMSG(GMPK))
"RTN","GMPLCLN",29,0)
 S GMPCNT=GMPCNT+1
"RTN","GMPLCLN",30,0)
 I $D(GMPLMSG) S ^TMP(SUB,$J,GMPCNT,0)=""
"RTN","GMPLCLN",31,0)
 S GMPLEND=$S(GMPLNERR'>GMPMAXER:GMPLNERR+GMPCNT,1:GMPMAXER)
"RTN","GMPLCLN",32,0)
 S GMPLEND=$S(GMPLNERR'>GMPMAXER:GMPLEND-1,1:GMPLEND)
"RTN","GMPLCLN",33,0)
 S GMPJ=GMPLNERR+1
"RTN","GMPLCLN",34,0)
 F GMPI=GMPCNT:1:GMPLEND D
"RTN","GMPLCLN",35,0)
 . S GMPJ=GMPJ-1,GMPCNTR=$S($D(GMPLMSG):GMPI+1,1:GMPI)
"RTN","GMPLCLN",36,0)
 . S ^TMP(SUB,$J,GMPCNTR,0)=^TMP(GMPLNODE,$J,GMPJ,0)
"RTN","GMPLCLN",37,0)
 I GMPLEND=GMPMAXER S ^TMP(SUB,$J,GMPMAXER+1,0)="Maximum number of errors reached, will not report anymore."
"RTN","GMPLCLN",38,0)
 K ^TMP(GMPLNODE,$J)
"RTN","GMPLCLN",39,0)
 S GMPXMSUB="Lock Errors during Problem File Cleanup"
"RTN","GMPLCLN",40,0)
 S GMPLTO(DUZ)=""
"RTN","GMPLCLN",41,0)
 D SEND^GMPLUTL4(SUB,GMPXMSUB,.GMPLTO,GMPLFROM)
"RTN","GMPLCLN",42,0)
 Q
"RTN","GMPLCLN",43,0)
BLDNEMSG(GMPLMSG,GMPLSUB,GMPLFROM,GMPLRNTM) ; Build No Error Found MailMan message and send to installer
"RTN","GMPLCLN",44,0)
 N GMPLTO,SUB,GMPJ,GMPCNT S GMPJ="",GMPCNT=3
"RTN","GMPLCLN",45,0)
 K ^TMP("GMPXMZNE",$J)
"RTN","GMPLCLN",46,0)
 S SUB="GMPXMZNE"
"RTN","GMPLCLN",47,0)
 S GMPLTO(DUZ)=""
"RTN","GMPLCLN",48,0)
 S ^TMP(SUB,$J,1,0)="A scan of your system's Problem file #9000011 has been performed on:"
"RTN","GMPLCLN",49,0)
 S ^TMP(SUB,$J,2,0)=""_$$FMTE^XLFDT(GMPLRNTM,1)_""
"RTN","GMPLCLN",50,0)
 S ^TMP(SUB,$J,3,0)=""
"RTN","GMPLCLN",51,0)
 I $D(GMPLMSG) D
"RTN","GMPLCLN",52,0)
 . F  S GMPJ=$O(GMPLMSG(GMPJ)) Q:'GMPJ  D
"RTN","GMPLCLN",53,0)
 . . S GMPCNT=GMPCNT+1
"RTN","GMPLCLN",54,0)
 . . S ^TMP(SUB,$J,GMPCNT,0)=$G(GMPLMSG(GMPJ))
"RTN","GMPLCLN",55,0)
 D SEND^GMPLUTL4(SUB,GMPLSUB,.GMPLTO,GMPLFROM)
"RTN","GMPLCLN",56,0)
 Q
"RTN","GMPLCLN",57,0)
BLDERMSG(GMPLNERR) ; Build MailMan error message content and send to installer
"RTN","GMPLCLN",58,0)
 N GMPLTO,GMPLFROM,GMPXMSUB,SUB
"RTN","GMPLCLN",59,0)
 K ^TMP("GMPLXMZE",$J)
"RTN","GMPLCLN",60,0)
 S SUB="GMPLXMZE"
"RTN","GMPLCLN",61,0)
 S GMPXMSUB="Problem File Error Scan Complete"
"RTN","GMPLCLN",62,0)
 S GMPLFROM="GMPL*2.0*40 INSTALL"
"RTN","GMPLCLN",63,0)
 S GMPLTO(DUZ)=""
"RTN","GMPLCLN",64,0)
 S ^TMP(SUB,$J,1,0)="A scan of your system's Problem file #9000011 has been performed for possible"
"RTN","GMPLCLN",65,0)
 S ^TMP(SUB,$J,2,0)="errors. There are "_GMPLNERR_" record entries that contain a SNOMED CT concept code"
"RTN","GMPLCLN",66,0)
 S ^TMP(SUB,$J,3,0)="in the Diagnosis field #.01."
"RTN","GMPLCLN",67,0)
 S ^TMP(SUB,$J,4,0)=""
"RTN","GMPLCLN",68,0)
 S ^TMP(SUB,$J,5,0)="To see a report of these records, please access the SNOMED in Diagnosis Field"
"RTN","GMPLCLN",69,0)
 S ^TMP(SUB,$J,6,0)="Error Report [GMPL DIAG ERROR REPORT] which is attached to the Problem List Mgt"
"RTN","GMPLCLN",70,0)
 S ^TMP(SUB,$J,7,0)="Menu [GMPL MGT MENU]."
"RTN","GMPLCLN",71,0)
 S ^TMP(SUB,$J,8,0)=""
"RTN","GMPLCLN",72,0)
 S ^TMP(SUB,$J,9,0)="These record entries will initially be corrected with the installation of"
"RTN","GMPLCLN",73,0)
 S ^TMP(SUB,$J,10,0)="GMPL*2.0*40 or by running the Generate SNOMED in Diagnosis Field Err/Cleanup"
"RTN","GMPLCLN",74,0)
 S ^TMP(SUB,$J,11,0)="Rpt [GMPL GENERATE DIAG RPTS] menu option off the Problem List Mgt Menu."
"RTN","GMPLCLN",75,0)
 S ^TMP(SUB,$J,12,0)=""
"RTN","GMPLCLN",76,0)
 S ^TMP(SUB,$J,13,0)="Once the cleanup is complete, a separate MailMan message will be sent to the"
"RTN","GMPLCLN",77,0)
 S ^TMP(SUB,$J,14,0)="installer containing instructions on how to access the cleanup report."
"RTN","GMPLCLN",78,0)
 D SEND^GMPLUTL4(SUB,GMPXMSUB,.GMPLTO,GMPLFROM)
"RTN","GMPLCLN",79,0)
 Q
"RTN","GMPLCLN",80,0)
BLDCLMSG(GMPLMSG,GMPLSUB,GMPLFROM,GMPLNCLN) ; Build MailMan cleanup message content and send to installer
"RTN","GMPLCLN",81,0)
 N GMPLTO,SUB,GMPJ,GMPCNT S GMPJ="",GMPCNT=3
"RTN","GMPLCLN",82,0)
 K ^TMP("GMPLXMZC",$J)
"RTN","GMPLCLN",83,0)
 S SUB="GMPLXMZC"
"RTN","GMPLCLN",84,0)
 S GMPLTO(DUZ)=""
"RTN","GMPLCLN",85,0)
 S ^TMP(SUB,$J,1,0)="A cleanup of the Problem file has been performed and "_GMPLNCLN_" record"
"RTN","GMPLCLN",86,0)
 S ^TMP(SUB,$J,2,0)="entries have been corrected."
"RTN","GMPLCLN",87,0)
 S ^TMP(SUB,$J,3,0)=""
"RTN","GMPLCLN",88,0)
 I $D(GMPLMSG) D
"RTN","GMPLCLN",89,0)
 . F  S GMPJ=$O(GMPLMSG(GMPJ)) Q:'GMPJ  D
"RTN","GMPLCLN",90,0)
 . . S GMPCNT=GMPCNT+1
"RTN","GMPLCLN",91,0)
 . . S ^TMP(SUB,$J,GMPCNT,0)=$G(GMPLMSG(GMPJ))
"RTN","GMPLCLN",92,0)
 D SEND^GMPLUTL4(SUB,GMPLSUB,.GMPLTO,GMPLFROM)
"RTN","GMPLCLN",93,0)
 Q
"RTN","GMPLCLN",94,0)
BLDRPMSG(GMPLNERR,GMPLRNTM) ; Build Error Report Mailman Message and send to installer
"RTN","GMPLCLN",95,0)
 N GMPLTO,GMPLFROM,GMPXMSUB,SUB,GMPLREC,GMPLCNT,GMPLDA S GMPLCNT=20,GMPLDA=""
"RTN","GMPLCLN",96,0)
 K ^TMP("GMPLXMZR",$J)
"RTN","GMPLCLN",97,0)
 S SUB="GMPLXMZR"
"RTN","GMPLCLN",98,0)
 S GMPXMSUB="Incorrect Mapping Report"
"RTN","GMPLCLN",99,0)
 S GMPLFROM="GMPL*2.0*40 INSTALL"
"RTN","GMPLCLN",100,0)
 S GMPLTO(DUZ)=""
"RTN","GMPLCLN",101,0)
 S ^TMP(SUB,$J,1,0)=""
"RTN","GMPLCLN",102,0)
 S ^TMP(SUB,$J,2,0)="Problem file scan runtime: "_$$FMTE^XLFDT(GMPLRNTM,1)
"RTN","GMPLCLN",103,0)
 S ^TMP(SUB,$J,3,0)=""
"RTN","GMPLCLN",104,0)
 S ^TMP(SUB,$J,4,0)="A scan of your system's Problem file #9000011 has been performed for possible"
"RTN","GMPLCLN",105,0)
 S ^TMP(SUB,$J,5,0)="errors. There are "_GMPLNERR_" record entries that contain an incorrect SNOMED CT"
"RTN","GMPLCLN",106,0)
 S ^TMP(SUB,$J,6,0)="428283002 to ICD-9-CM V15.89 code mapping for the term ""History of polyp of"
"RTN","GMPLCLN",107,0)
 S ^TMP(SUB,$J,7,0)="colon"". As a result the V15.89 code is incorrectly stored in the Diagnosis"
"RTN","GMPLCLN",108,0)
 S ^TMP(SUB,$J,8,0)="field #.01."
"RTN","GMPLCLN",109,0)
 S ^TMP(SUB,$J,9,0)=""
"RTN","GMPLCLN",110,0)
 S ^TMP(SUB,$J,10,0)="This report contains a list of these erroneous record entries which will be"
"RTN","GMPLCLN",111,0)
 S ^TMP(SUB,$J,11,0)="corrected after the installation of GMPL*2.0*40. Once the cleanup is complete,"
"RTN","GMPLCLN",112,0)
 S ^TMP(SUB,$J,12,0)="the correct V12.72 code will be stored in the Diagnosis field."
"RTN","GMPLCLN",113,0)
 S ^TMP(SUB,$J,13,0)=""
"RTN","GMPLCLN",114,0)
 S ^TMP(SUB,$J,14,0)="**ATTENTION CACs!!**: Once the cleanup is complete, please also review the"
"RTN","GMPLCLN",115,0)
 S ^TMP(SUB,$J,15,0)="Colonoscopy clinical reminders for the corresponding patients and verify that"
"RTN","GMPLCLN",116,0)
 S ^TMP(SUB,$J,16,0)="the corrections have been updated appropriately for those as well."
"RTN","GMPLCLN",117,0)
 S ^TMP(SUB,$J,17,0)=""
"RTN","GMPLCLN",118,0)
 S ^TMP(SUB,$J,18,0)=""
"RTN","GMPLCLN",119,0)
 S ^TMP(SUB,$J,19,0)="IEN"_$J("PATIENT",22)_$J("PROVIDER NARRATIVE",44)
"RTN","GMPLCLN",120,0)
 S ^TMP(SUB,$J,20,0)=$$REPEAT^XLFSTR("-",15)_$J($$REPEAT^XLFSTR("-",30),33)_$J($$REPEAT^XLFSTR("-",28),31)
"RTN","GMPLCLN",121,0)
 F  S GMPLDA=$O(^TMP("GMPLVCDE",$J,GMPLDA)) Q:'GMPLDA  D
"RTN","GMPLCLN",122,0)
 . S GMPLREC=$G(^TMP("GMPLVCDE",$J,GMPLDA)),GMPLCNT=GMPLCNT+1
"RTN","GMPLCLN",123,0)
 . S ^TMP(SUB,$J,GMPLCNT,0)=$$LJ^XLFSTR($G(GMPLDA),18)_$$LJ^XLFSTR($P(GMPLREC,U,1),33)_$$LJ^XLFSTR($P(GMPLREC,U,2),28)
"RTN","GMPLCLN",124,0)
 D SEND^GMPLUTL4(SUB,GMPXMSUB,.GMPLTO,GMPLFROM)
"RTN","GMPLCLN",125,0)
 Q
"RTN","GMPLCLN",126,0)
BLDERRPT(GMPLNERR,GMPLRNTM) ; Build Error Report
"RTN","GMPLCLN",127,0)
 N GMPDLM,GMPDA,GMPX,GMPJ,SUB,GMPLPSUB S (GMPDLM,GMPDA)="",GMPJ=20
"RTN","GMPLCLN",128,0)
 S GMPLPSUB=$O(^XTMP("GMPLERPT;"))
"RTN","GMPLCLN",129,0)
 I GMPLPSUB["GMPLERPT" K ^XTMP(GMPLPSUB)
"RTN","GMPLCLN",130,0)
 S SUB="GMPLERPT;"_$H
"RTN","GMPLCLN",131,0)
 S ^XTMP(SUB,0)=$$FMADD^XLFDT($$NOW^XLFDT,30)_U_$$NOW^XLFDT()_U_"SNOMED in Diagnosis Field Error Rpt"
"RTN","GMPLCLN",132,0)
 S ^XTMP(SUB,1,0)=""
"RTN","GMPLCLN",133,0)
 S ^XTMP(SUB,2,0)="**NOTE**: This report is retroactive as of the last Problem file scan runtime:"
"RTN","GMPLCLN",134,0)
 S ^XTMP(SUB,3,0)=""_$$FMTE^XLFDT(GMPLRNTM,1)_". This report will expire and be purged from the system in"
"RTN","GMPLCLN",135,0)
 S ^XTMP(SUB,4,0)="30 days. If the Generate SNOMED in Diagnosis Field Err/Cleanup Rpt [GMPL"
"RTN","GMPLCLN",136,0)
 S ^XTMP(SUB,5,0)="GENERATE DIAG RPTS] menu option is run prior to the 30 days, then this report"
"RTN","GMPLCLN",137,0)
 S ^XTMP(SUB,6,0)="will expire on the date/time the option is run. Whichever comes first."
"RTN","GMPLCLN",138,0)
 S ^XTMP(SUB,7,0)=""
"RTN","GMPLCLN",139,0)
 S ^XTMP(SUB,8,0)="A scan of your system's Problem file #9000011 has been performed for possible"
"RTN","GMPLCLN",140,0)
 S ^XTMP(SUB,9,0)="errors. The following "_GMPLNERR_" record entries contain a SNOMED CT concept code"
"RTN","GMPLCLN",141,0)
 S ^XTMP(SUB,10,0)="in the Diagnosis field #.01. This report contains 4 columns. Please scroll to"
"RTN","GMPLCLN",142,0)
 S ^XTMP(SUB,11,0)="the right to see a full display of the Problem text."
"RTN","GMPLCLN",143,0)
 S ^XTMP(SUB,12,0)=""
"RTN","GMPLCLN",144,0)
 S ^XTMP(SUB,13,0)="These record entries will be corrected and upon completion, a separate MailMan"
"RTN","GMPLCLN",145,0)
 S ^XTMP(SUB,14,0)="message will be sent to the installer containing instructions on how to access"
"RTN","GMPLCLN",146,0)
 S ^XTMP(SUB,15,0)="the cleanup report."
"RTN","GMPLCLN",147,0)
 S ^XTMP(SUB,16,0)=""
"RTN","GMPLCLN",148,0)
 S ^XTMP(SUB,17,0)=""
"RTN","GMPLCLN",149,0)
 S ^XTMP(SUB,18,0)=$J("DATE LAST",27)
"RTN","GMPLCLN",150,0)
 S ^XTMP(SUB,19,0)="IEN"_$J("MODIFIED",23)_$J("DIAGNOSIS",16)_$J("PROBLEM",19)
"RTN","GMPLCLN",151,0)
 S ^XTMP(SUB,20,0)=$$REPEAT^XLFSTR("-",15)_$J($$REPEAT^XLFSTR("-",12),15)_$J($$REPEAT^XLFSTR("-",18),21)_$J($$REPEAT^XLFSTR("-",25),28)
"RTN","GMPLCLN",152,0)
 F  S GMPDLM=$O(^TMP("GMPLSCT",$J,GMPDLM)) Q:'GMPDLM  D
"RTN","GMPLCLN",153,0)
 . F  S GMPDA=$O(^TMP("GMPLSCT",$J,GMPDLM,GMPDA)) Q:'GMPDA  D
"RTN","GMPLCLN",154,0)
 . . S GMPX=$G(^TMP("GMPLSCT",$J,GMPDLM,GMPDA)),GMPJ=GMPJ+1
"RTN","GMPLCLN",155,0)
 . . S ^XTMP(SUB,GMPJ,0)=$$LJ^XLFSTR($G(GMPDA),18)_$$LJ^XLFSTR($P(GMPX,U,1),15)_$$LJ^XLFSTR($P(GMPX,U,2),21)_$$LJ^XLFSTR($P(GMPX,U,3),$L($P(GMPX,U,3)))
"RTN","GMPLCLN",156,0)
 Q
"RTN","GMPLCLN",157,0)
 ;
"RTN","GMPLCLN",158,0)
BLDCLRPT(GMPLNCLN,GMPLRNTM) ; Build Cleanup Report
"RTN","GMPLCLN",159,0)
 N GMPLDLM,GMPLDA,GMPX,GMPJ,SUB,GMPLPSUB S (GMPLDLM,GMPLDA)="",GMPJ=21
"RTN","GMPLCLN",160,0)
 S GMPLPSUB=$O(^XTMP("GMPLCRPT;"))
"RTN","GMPLCLN",161,0)
 I GMPLPSUB["GMPLCRPT" K ^XTMP(GMPLPSUB)
"RTN","GMPLCLN",162,0)
 S SUB="GMPLCRPT;"_$H
"RTN","GMPLCLN",163,0)
 S ^XTMP(SUB,0)=$$FMADD^XLFDT($$NOW^XLFDT,30)_U_$$NOW^XLFDT()_U_"SNOMED in Diagnosis Field Cleanup Rpt"
"RTN","GMPLCLN",164,0)
 S ^XTMP(SUB,1,0)=""
"RTN","GMPLCLN",165,0)
 S ^XTMP(SUB,2,0)="**NOTE**: This report is retroactive as of the last Problem file cleanup runtime"
"RTN","GMPLCLN",166,0)
 S ^XTMP(SUB,3,0)=":"_$$FMTE^XLFDT(GMPLRNTM,1)_". This report will expire and be purged from the system in"
"RTN","GMPLCLN",167,0)
 S ^XTMP(SUB,4,0)="30 days. If the Generate SNOMED in Diagnosis Field Err/Cleanup Rpt [GMPL"
"RTN","GMPLCLN",168,0)
 S ^XTMP(SUB,5,0)="GENERATE DIAG RPTS] menu option is run prior to the 30 days, then this report"
"RTN","GMPLCLN",169,0)
 S ^XTMP(SUB,6,0)="will expire on the date/time the option is run. Whichever comes first."
"RTN","GMPLCLN",170,0)
 S ^XTMP(SUB,7,0)=""
"RTN","GMPLCLN",171,0)
 S ^XTMP(SUB,8,0)="A cleanup of the Problem file has been performed and the following "_GMPLNCLN
"RTN","GMPLCLN",172,0)
 S ^XTMP(SUB,9,0)="record entries have been corrected. This report contains 7 columns."
"RTN","GMPLCLN",173,0)
 S ^XTMP(SUB,10,0)="Please scroll to the right for more information."
"RTN","GMPLCLN",174,0)
 S ^XTMP(SUB,11,0)=""
"RTN","GMPLCLN",175,0)
 S ^XTMP(SUB,12,0)="These entries no longer contain a SNOMED CT concept code in the Diagnosis field"
"RTN","GMPLCLN",176,0)
 S ^XTMP(SUB,13,0)="#.01. The correct primary ICD diagnosis and secondary diagnosis code(s) is now"
"RTN","GMPLCLN",177,0)
 S ^XTMP(SUB,14,0)="stored in the appropriate fields. The corresponding SNOMED CT concept and"
"RTN","GMPLCLN",178,0)
 S ^XTMP(SUB,15,0)="designation codes have also been correctly filed in their respective fields. The "
"RTN","GMPLCLN",179,0)
 S ^XTMP(SUB,16,0)="provider narrative and problem fields were also updated accordingly as well."
"RTN","GMPLCLN",180,0)
 S ^XTMP(SUB,17,0)=""
"RTN","GMPLCLN",181,0)
 S ^XTMP(SUB,18,0)=""
"RTN","GMPLCLN",182,0)
 S ^XTMP(SUB,19,0)=$J("DATE LAST",27)_$J("PRIMARY",13)_$J("SNOMED CT",44)_$J("SNOMED CT",21)
"RTN","GMPLCLN",183,0)
 S ^XTMP(SUB,20,0)="IEN"_$J("MODIFIED",23)_$J("DIAGNOSIS",16)_$J("SECONDARY DIAGNOSIS",22)_$J("CONCEPT CODE",23)_$J("DESIGNATION CODE",25)_$J("PROBLEM",12)
"RTN","GMPLCLN",184,0)
 S ^XTMP(SUB,21,0)=$$REPEAT^XLFSTR("-",15)_$J($$REPEAT^XLFSTR("-",12),15)_$J($$REPEAT^XLFSTR("-",9),12)_$J($$REPEAT^XLFSTR("-",27),30)_$J($$REPEAT^XLFSTR("-",18),21)_$J($$REPEAT^XLFSTR("-",18),21)_$J($$REPEAT^XLFSTR("-",33),36)
"RTN","GMPLCLN",185,0)
 F  S GMPLDLM=$O(^TMP("GMPLCLNP",$J,GMPLDLM)) Q:'GMPLDLM  D
"RTN","GMPLCLN",186,0)
 . F  S GMPLDA=$O(^TMP("GMPLCLNP",$J,GMPLDLM,GMPLDA)) Q:'GMPLDA  D
"RTN","GMPLCLN",187,0)
 . . S GMPX=$G(^TMP("GMPLCLNP",$J,GMPLDLM,GMPLDA)),GMPJ=GMPJ+1
"RTN","GMPLCLN",188,0)
 . . S ^XTMP(SUB,GMPJ,0)=$$LJ^XLFSTR($G(GMPLDA),18)_$$LJ^XLFSTR($P(GMPX,U,1),15)_$$LJ^XLFSTR($P($P(GMPX,U,2),"/"),12)_$$LJ^XLFSTR($P($P(GMPX,U,2),"/",2,$L($P(GMPX,U,2),"/")),30)
"RTN","GMPLCLN",189,0)
 . . S ^XTMP(SUB,GMPJ,0)=^XTMP(SUB,GMPJ,0)_$$LJ^XLFSTR($P(GMPX,U,3),21)_$$LJ^XLFSTR($P(GMPX,U,4),21)_$$LJ^XLFSTR($P(GMPX,U,5),$L($P(GMPX,U,5)))
"RTN","GMPLCLN",190,0)
 K ^TMP("GMPLCLNP",$J)
"RTN","GMPLCLN",191,0)
 Q
"RTN","GMPLCLN",192,0)
 ;
"RTN","GMPLCLN",193,0)
VWERRPT ; View Error Report
"RTN","GMPLCLN",194,0)
 N GMPLX
"RTN","GMPLCLN",195,0)
 S GMPLX=$O(^XTMP("GMPLERPT;"))
"RTN","GMPLCLN",196,0)
 I GMPLX["GMPLERPT",$D(^XTMP(GMPLX)) D BROWSE^DDBR("^XTMP("""_GMPLX_""")","NR","Erroneous Problem File Record Entries Report")
"RTN","GMPLCLN",197,0)
 E  D
"RTN","GMPLCLN",198,0)
 . N GMPLTEXT
"RTN","GMPLCLN",199,0)
 . S GMPLTEXT(1)="There are currently no Problem File entries that contain this error."
"RTN","GMPLCLN",200,0)
 . D MES^XPDUTL(.GMPLTEXT)
"RTN","GMPLCLN",201,0)
 Q
"RTN","GMPLCLN",202,0)
VWCLRPT ; View Cleanup Report
"RTN","GMPLCLN",203,0)
 N GMPLX
"RTN","GMPLCLN",204,0)
 S GMPLX=$O(^XTMP("GMPLCRPT;"))
"RTN","GMPLCLN",205,0)
 I GMPLX["GMPLCRPT",$D(^XTMP(GMPLX)) D BROWSE^DDBR("^XTMP("""_GMPLX_""")","NR","Problem File Cleanup Report")
"RTN","GMPLCLN",206,0)
 E  D
"RTN","GMPLCLN",207,0)
 . N GMPLTEXT
"RTN","GMPLCLN",208,0)
 . S GMPLTEXT(1)="There are currently no Problem File entries that need correction."
"RTN","GMPLCLN",209,0)
 . D MES^XPDUTL(.GMPLTEXT)
"RTN","GMPLCLN",210,0)
 Q
"RTN","GMPLCOPY")
0^8^B19671489
"RTN","GMPLCOPY",1,0)
GMPLCOPY ;ISP/TC - Copy Problem Selection Lists/Categories ;09/21/16  09:03
"RTN","GMPLCOPY",2,0)
 ;;2.0;Problem List;**49**;Aug 25, 1994;Build 43
"RTN","GMPLCOPY",3,0)
 ;
"RTN","GMPLCOPY",4,0)
 ;=====================================================
"RTN","GMPLCOPY",5,0)
SETCLDLM(GMPFLNM,GMPIEN,GMPCLASS) ;Set the class field to GMPCLASS and update Date Last Modified
"RTN","GMPLCOPY",6,0)
 N GMPIENS,GMPFDA,GMPMSG,GMPFLD
"RTN","GMPLCOPY",7,0)
 S GMPIENS=GMPIEN_","
"RTN","GMPLCOPY",8,0)
 S GMPFLD=$S(GMPFLNM="125":".04",GMPFLNM="125.11":".03")
"RTN","GMPLCOPY",9,0)
 S GMPFDA(GMPFLNM,GMPIENS,GMPFLD)=GMPCLASS
"RTN","GMPLCOPY",10,0)
 S GMPFDA(GMPFLNM,GMPIENS,.02)=$$DT^XLFDT
"RTN","GMPLCOPY",11,0)
 D FILE^DIE("K","GMPFDA","GMPMSG")
"RTN","GMPLCOPY",12,0)
 I $D(GMPMSG) D AWRITE("GMPMSG")
"RTN","GMPLCOPY",13,0)
 Q
"RTN","GMPLCOPY",14,0)
 ;
"RTN","GMPLCOPY",15,0)
 ;=====================================================
"RTN","GMPLCOPY",16,0)
COPY(GMPPRMPT,GMPROOT,GMPWHAT,GMPVAL) ;Copy an entry of GMPROOT into a new entry.
"RTN","GMPLCOPY",17,0)
 N DIROUT,DTOUT,DUOUT
"RTN","GMPLCOPY",18,0)
 F  D GETORIG Q:$D(DIROUT)  Q:$D(DTOUT)
"RTN","GMPLCOPY",19,0)
 Q
"RTN","GMPLCOPY",20,0)
 ;
"RTN","GMPLCOPY",21,0)
 ;=====================================================
"RTN","GMPLCOPY",22,0)
COPYCAT(GMPVAL) ;Copy a selection list category.
"RTN","GMPLCOPY",23,0)
 N GMPPRMPT,GMPROOT,GMPWHAT
"RTN","GMPLCOPY",24,0)
 S GMPWHAT="category"
"RTN","GMPLCOPY",25,0)
 S GMPROOT="^GMPL(125.11,"
"RTN","GMPLCOPY",26,0)
 S GMPPRMPT="Select the category to copy: "
"RTN","GMPLCOPY",27,0)
 D COPY(GMPPRMPT,GMPROOT,GMPWHAT,.GMPVAL)
"RTN","GMPLCOPY",28,0)
 Q
"RTN","GMPLCOPY",29,0)
 ;
"RTN","GMPLCOPY",30,0)
 ;=====================================================
"RTN","GMPLCOPY",31,0)
COPYLIST ;Copy a selection list.
"RTN","GMPLCOPY",32,0)
 N GMPPRMPT,GMPROOT,GMPWHAT
"RTN","GMPLCOPY",33,0)
 S GMPWHAT="selection list"
"RTN","GMPLCOPY",34,0)
 S GMPROOT="^GMPL(125,"
"RTN","GMPLCOPY",35,0)
 S GMPPRMPT="Select the list to copy: "
"RTN","GMPLCOPY",36,0)
 D COPY(GMPPRMPT,GMPROOT,GMPWHAT)
"RTN","GMPLCOPY",37,0)
 Q
"RTN","GMPLCOPY",38,0)
 ;
"RTN","GMPLCOPY",39,0)
 ;=====================================================
"RTN","GMPLCOPY",40,0)
DELETE(DIK,DA) ;Delete the entry just added.
"RTN","GMPLCOPY",41,0)
 D ^DIK
"RTN","GMPLCOPY",42,0)
 W !!,"New entry not created due to invalid name!",!
"RTN","GMPLCOPY",43,0)
 Q
"RTN","GMPLCOPY",44,0)
 ;
"RTN","GMPLCOPY",45,0)
 ;=====================================================
"RTN","GMPLCOPY",46,0)
GETFOIEN(GMPROOT) ;Return the first open IEN in GMPROOT. This should be called
"RTN","GMPLCOPY",47,0)
 ;after a call to SETSTART.
"RTN","GMPLCOPY",48,0)
 N GMPENTRY,GMPNIEN,GMPOIEN
"RTN","GMPLCOPY",49,0)
 S GMPENTRY=GMPROOT_0_")"
"RTN","GMPLCOPY",50,0)
 S GMPOIEN=+$P(@GMPENTRY,U,3)
"RTN","GMPLCOPY",51,0)
 S GMPENTRY=GMPROOT_GMPOIEN_")"
"RTN","GMPLCOPY",52,0)
 F  S GMPNIEN=$O(@GMPENTRY) Q:+(GMPNIEN-GMPOIEN)>1  Q:+GMPNIEN'>0  S GMPOIEN=GMPNIEN,GMPENTRY=GMPROOT_GMPNIEN_")"
"RTN","GMPLCOPY",53,0)
 Q GMPOIEN+1
"RTN","GMPLCOPY",54,0)
 ;
"RTN","GMPLCOPY",55,0)
 ;=====================================================
"RTN","GMPLCOPY",56,0)
GETORIG  ;Look-up logic to get and copy source entry to destination.
"RTN","GMPLCOPY",57,0)
 N DIC,GMPIENN,GMPIENO,Y
"RTN","GMPLCOPY",58,0)
 S DIC=GMPROOT,DIC(0)="AEMQ",DIC("A")=GMPPRMPT
"RTN","GMPLCOPY",59,0)
 W !
"RTN","GMPLCOPY",60,0)
 D ^DIC
"RTN","GMPLCOPY",61,0)
 I $D(DUOUT)!$D(DTOUT) S DIROUT="" Q
"RTN","GMPLCOPY",62,0)
 S GMPIENO=$P(Y,U,1)
"RTN","GMPLCOPY",63,0)
 I GMPIENO=-1 S DIROUT="" Q
"RTN","GMPLCOPY",64,0)
 D GETORIGC(GMPIENO,.GMPIENN,GMPROOT,GMPWHAT,.GMPVAL)
"RTN","GMPLCOPY",65,0)
 Q
"RTN","GMPLCOPY",66,0)
 ;
"RTN","GMPLCOPY",67,0)
GETORIGC(GMPIENO,GMPIENN,GMPROOT,GMPWHAT,GMPVAL) ;
"RTN","GMPLCOPY",68,0)
 N DA,DIC,DIE,DIK,DIR,DIRUT,GMPFDA,GMPFLDLN,GMPFILE
"RTN","GMPLCOPY",69,0)
 N GMPIENS,GMPMSG,GMPNAME,GMPORGNM,X,Y,GMPL0
"RTN","GMPLCOPY",70,0)
 S DIC=GMPROOT
"RTN","GMPLCOPY",71,0)
 ;Set the starting place for additions.
"RTN","GMPLCOPY",72,0)
 D SETSTART(DIC)
"RTN","GMPLCOPY",73,0)
 S GMPIENN=$$GETFOIEN(GMPROOT)
"RTN","GMPLCOPY",74,0)
 D MERGE(GMPIENN,GMPIENO,GMPROOT)
"RTN","GMPLCOPY",75,0)
 ;
"RTN","GMPLCOPY",76,0)
 ;Get the new name.
"RTN","GMPLCOPY",77,0)
 S GMPORGNM=$P(@(GMPROOT_GMPIENO_",0)"),U,1)
"RTN","GMPLCOPY",78,0)
 S GMPFILE=+$P(@(GMPROOT_"0)"),U,2)
"RTN","GMPLCOPY",79,0)
 S GMPFLDLN=$$GET1^DID(GMPFILE,.01,"","FIELD LENGTH")
"RTN","GMPLCOPY",80,0)
 S DIR(0)="F"_U_"3:"_GMPFLDLN_U_"K:(X?.N)!'(X'?1P.E) X"
"RTN","GMPLCOPY",81,0)
 S DIR("A")="PLEASE ENTER A UNIQUE NAME"
"RTN","GMPLCOPY",82,0)
GETNAM D ^DIR
"RTN","GMPLCOPY",83,0)
 I $D(DIRUT) D DELETE(GMPROOT,GMPIENN) Q
"RTN","GMPLCOPY",84,0)
 S GMPNAME=Y
"RTN","GMPLCOPY",85,0)
 ;
"RTN","GMPLCOPY",86,0)
 ;Make sure the new name is valid.
"RTN","GMPLCOPY",87,0)
 I '$$VNAME^GMPLINTR(GMPNAME) G GETNAM
"RTN","GMPLCOPY",88,0)
 ;
"RTN","GMPLCOPY",89,0)
 ;Change to the new name.
"RTN","GMPLCOPY",90,0)
 S GMPIENS=GMPIENN_","
"RTN","GMPLCOPY",91,0)
 S GMPFDA(GMPFILE,GMPIENS,.01)=GMPNAME
"RTN","GMPLCOPY",92,0)
 K GMPMSG
"RTN","GMPLCOPY",93,0)
 D FILE^DIE("","GMPFDA","GMPMSG")
"RTN","GMPLCOPY",94,0)
 ;Check to make sure the name was not a duplicate.
"RTN","GMPLCOPY",95,0)
 I $G(GMPMSG("DIERR",1))=740 D  G GETNAM
"RTN","GMPLCOPY",96,0)
 . W !,GMPNAME," is not a unique name!"
"RTN","GMPLCOPY",97,0)
 ;Change the class to local and update Date Last Modified.
"RTN","GMPLCOPY",98,0)
 D SETCLDLM(GMPFILE,GMPIENN,"L")
"RTN","GMPLCOPY",99,0)
 ;
"RTN","GMPLCOPY",100,0)
 ;Reindex the cross-references.
"RTN","GMPLCOPY",101,0)
 S DIK=GMPROOT,DA=GMPIENN
"RTN","GMPLCOPY",102,0)
 D IX^DIK
"RTN","GMPLCOPY",103,0)
 ;
"RTN","GMPLCOPY",104,0)
 S GMPL0=$G(@(GMPROOT_GMPIENN_",0)"))
"RTN","GMPLCOPY",105,0)
 S GMPVAL=GMPIENN_U_GMPL0
"RTN","GMPLCOPY",106,0)
 W !!,"The original "_GMPWHAT_" "_GMPORGNM_" has been copied into "_GMPNAME_"." H 1
"RTN","GMPLCOPY",107,0)
 Q
"RTN","GMPLCOPY",108,0)
 ;
"RTN","GMPLCOPY",109,0)
 ;=====================================================
"RTN","GMPLCOPY",110,0)
MERGE(GMPIENN,GMPIENO,GMPROOT) ;Use MERGE to copy GMPROOT(GMPIENO into GMPROOT(GMPIENN.
"RTN","GMPLCOPY",111,0)
 N GMPDEST,GMPSRCE
"RTN","GMPLCOPY",112,0)
 S GMPDEST=GMPROOT_GMPIENN_")"
"RTN","GMPLCOPY",113,0)
 ;Lock the file before merging.
"RTN","GMPLCOPY",114,0)
 L +@GMPDEST:DILOCKTM
"RTN","GMPLCOPY",115,0)
 S GMPSRCE=GMPROOT_GMPIENO_")"
"RTN","GMPLCOPY",116,0)
 M @GMPDEST=@GMPSRCE
"RTN","GMPLCOPY",117,0)
 ;Unlock the file
"RTN","GMPLCOPY",118,0)
 L -@GMPDEST
"RTN","GMPLCOPY",119,0)
 Q
"RTN","GMPLCOPY",120,0)
 ;
"RTN","GMPLCOPY",121,0)
 ;=====================================================
"RTN","GMPLCOPY",122,0)
SETSTART(GMPROOT) ;Set the starting value to add new entries. Start
"RTN","GMPLCOPY",123,0)
 ;at the begining so empty spaces are filled in.
"RTN","GMPLCOPY",124,0)
 N GMPCUR,GMPENTRY
"RTN","GMPLCOPY",125,0)
 S GMPENTRY=GMPROOT_"0)"
"RTN","GMPLCOPY",126,0)
 S $P(@GMPENTRY,U,3)=1
"RTN","GMPLCOPY",127,0)
 Q
"RTN","GMPLCOPY",128,0)
 ;
"RTN","GMPLCOPY",129,0)
 ;=================================
"RTN","GMPLCOPY",130,0)
AWRITE(GMPREF) ;Write all the descendants of the array reference, including the
"RTN","GMPLCOPY",131,0)
 ;array. REF is the starting array reference, for example A or
"RTN","GMPLCOPY",132,0)
 ;^TMP("PXRM",$J).
"RTN","GMPLCOPY",133,0)
 N GMPDONE,GMPIND,GMPLEN,GMPLN,GMPPRT,GMPROOT,GMPSTRT,GMPTMP,GMPTXT
"RTN","GMPLCOPY",134,0)
 I GMPREF="" Q
"RTN","GMPLCOPY",135,0)
 S GMPLN=0
"RTN","GMPLCOPY",136,0)
 S GMPPRT=$P(GMPREF,")",1)
"RTN","GMPLCOPY",137,0)
 ;Build the root so we can tell when we are done.
"RTN","GMPLCOPY",138,0)
 S GMPTMP=$NA(@GMPREF)
"RTN","GMPLCOPY",139,0)
 S GMPROOT=$P(GMPTMP,")",1)
"RTN","GMPLCOPY",140,0)
 S GMPREF=$Q(@GMPREF)
"RTN","GMPLCOPY",141,0)
 I GMPREF'[GMPROOT Q
"RTN","GMPLCOPY",142,0)
 S GMPDONE=0
"RTN","GMPLCOPY",143,0)
 F  Q:(GMPREF="")!(GMPDONE)  D
"RTN","GMPLCOPY",144,0)
 . S GMPSTRT=$F(GMPREF,GMPROOT)
"RTN","GMPLCOPY",145,0)
 . S GMPLEN=$L(GMPREF)
"RTN","GMPLCOPY",146,0)
 . S GMPIND=$E(GMPREF,GMPSTRT,GMPLEN)
"RTN","GMPLCOPY",147,0)
 . S GMPLN=GMPLN+1,GMPTXT(GMPLN)=GMPPRT_GMPIND_"="_@GMPREF
"RTN","GMPLCOPY",148,0)
 . S GMPREF=$Q(@GMPREF)
"RTN","GMPLCOPY",149,0)
 . I GMPREF'[GMPROOT S GMPDONE=1
"RTN","GMPLCOPY",150,0)
 D MES^XPDUTL(.GMPTXT)
"RTN","GMPLCOPY",151,0)
 Q
"RTN","GMPLCOPY",152,0)
 ;
"RTN","GMPLINTR")
0^9^B27139569
"RTN","GMPLINTR",1,0)
GMPLINTR ;ISP/TC - Problem List Input Transform ;08/09/17  08:17
"RTN","GMPLINTR",2,0)
 ;;2.0;Problem List;**49**;Aug 25, 1994;Build 43
"RTN","GMPLINTR",3,0)
 ;
"RTN","GMPLINTR",4,0)
VCLASS(X,GMPIMPRT,GMPTYPE) ;Check for valid CLASS field
"RTN","GMPLINTR",5,0)
 ; Ordinary users cannot create National classes.
"RTN","GMPLINTR",6,0)
 ; Do not execute as part of a verify fields.
"RTN","GMPLINTR",7,0)
 I $G(DIUTIL)="VERIFY FIELDS" Q 1
"RTN","GMPLINTR",8,0)
 S:'$D(GMPIMPRT) GMPIMPRT=0
"RTN","GMPLINTR",9,0)
 S:'$D(GMPTYPE) GMPTYPE=""
"RTN","GMPLINTR",10,0)
 I '$L(X) D EN^DDIOL(" Error: "_GMPTYPE_" class cannot be empty.") Q 0
"RTN","GMPLINTR",11,0)
 I (X["N"),(DUZ(0)'="@"),('GMPIMPRT) D  Q 0
"RTN","GMPLINTR",12,0)
 . D EN^DDIOL("You are not allowed to create a NATIONAL class")
"RTN","GMPLINTR",13,0)
 S X=$$UP^XLFSTR(X)
"RTN","GMPLINTR",14,0)
 I X="NATIONAL"!(X="LOCAL")!(X="VISN")!(X="N")!(X="L")!(X="V") Q 1
"RTN","GMPLINTR",15,0)
 E  D EN^DDIOL(" Error: Invalid "_GMPTYPE_" class value, "_X_".") Q 0
"RTN","GMPLINTR",16,0)
 Q 1
"RTN","GMPLINTR",17,0)
VFLAG(GMPLFLAG) ;Check for a valid flag in CSV file
"RTN","GMPLINTR",18,0)
 N GMPLTXT,GMPLINV S GMPLINV=0
"RTN","GMPLINTR",19,0)
 I '$L(GMPLFLAG) S GMPLTXT(1)=" Add/delete cell cannot be empty.",GMPLINV=1
"RTN","GMPLINTR",20,0)
 E  I GMPLFLAG="#"!(GMPLFLAG="@") S GMPLINV=0
"RTN","GMPLINTR",21,0)
 E  S GMPLTXT(1)=" '"_GMPLFLAG_"' is an invalid character.",GMPLINV=1
"RTN","GMPLINTR",22,0)
 I GMPLINV D  Q 0
"RTN","GMPLINTR",23,0)
 . S GMPLTXT(1)=GMPLTXT(1)_" Must contain # (to add) or @ (to delete)."
"RTN","GMPLINTR",24,0)
 . S GMPLTXT(2)=" Please verify cell in import file and correct any errors."
"RTN","GMPLINTR",25,0)
 . D EN^DDIOL(.GMPLTXT)
"RTN","GMPLINTR",26,0)
 E  Q 1
"RTN","GMPLINTR",27,0)
VNAME(GMPNAME,GMPIMPRT,GMPTYPE) ;Check for a valid NAME value.
"RTN","GMPLINTR",28,0)
 ; The names of selection list components start with "VA-"
"RTN","GMPLINTR",29,0)
 ; and normal users are not allowed to create them.
"RTN","GMPLINTR",30,0)
 ; Do not execute as part of a verify fields.
"RTN","GMPLINTR",31,0)
 N GMPAUTH,GMPSTEXT,GMPTEXT,GMPVALID
"RTN","GMPLINTR",32,0)
 I $G(DIUTIL)="VERIFY FIELDS" Q 1
"RTN","GMPLINTR",33,0)
 S:'$D(GMPIMPRT) GMPIMPRT=0
"RTN","GMPLINTR",34,0)
 S:'$D(GMPTYPE) GMPTYPE=""
"RTN","GMPLINTR",35,0)
 I '$L(GMPNAME) D  Q GMPVALID
"RTN","GMPLINTR",36,0)
 . S GMPTEXT=" Error: "_GMPTYPE_" name cannot be empty."
"RTN","GMPLINTR",37,0)
 . D EN^DDIOL(GMPTEXT) S GMPVALID=0
"RTN","GMPLINTR",38,0)
 S GMPNAME=$$UP^XLFSTR(GMPNAME)
"RTN","GMPLINTR",39,0)
 S GMPVALID=1
"RTN","GMPLINTR",40,0)
 I GMPNAME["~" D
"RTN","GMPLINTR",41,0)
 . S GMPTEXT=" Name cannot contain the ""~"" character."
"RTN","GMPLINTR",42,0)
 . D EN^DDIOL(GMPTEXT)
"RTN","GMPLINTR",43,0)
 . H 2
"RTN","GMPLINTR",44,0)
 . S GMPVALID=0
"RTN","GMPLINTR",45,0)
 S GMPSTEXT=$E(GMPNAME,1,3)
"RTN","GMPLINTR",46,0)
 I (GMPSTEXT="VA-"),('GMPIMPRT) D
"RTN","GMPLINTR",47,0)
 . S GMPAUTH=(DUZ(0)="@")
"RTN","GMPLINTR",48,0)
 . I 'GMPAUTH D
"RTN","GMPLINTR",49,0)
 . . S GMPTEXT=" Name cannot start with ""VA-"", reserved for national selection list components!"
"RTN","GMPLINTR",50,0)
 . . D EN^DDIOL(GMPTEXT)
"RTN","GMPLINTR",51,0)
 . . H 2
"RTN","GMPLINTR",52,0)
 . . S GMPVALID=0
"RTN","GMPLINTR",53,0)
 Q GMPVALID
"RTN","GMPLINTR",54,0)
 ;
"RTN","GMPLINTR",55,0)
VICD(GMPLICD) ;Check for a valid ICD code
"RTN","GMPLINTR",56,0)
 N GMI,GMPDT,GMPVALID S GMPDT=$$DT^XLFDT,GMPVALID=0
"RTN","GMPLINTR",57,0)
 ; Do not execute if ICD-9 code and as part of verify fields report
"RTN","GMPLINTR",58,0)
 I GMPLICD?1.3(1.3N1"."0.3N0.1"/"),($G(DIUTIL)="VERIFY FIELDS") S GMPVALID=1
"RTN","GMPLINTR",59,0)
 I GMPLICD?1.3(1U2N1".".4N0.1"/")!(GMPLICD?1.3(1U2N1".".4U0.1"/")) S GMPVALID=1
"RTN","GMPLINTR",60,0)
 I GMPLICD?1.3(1U2N1".".3N.1U0.1"/")!(GMPLICD?1.3(1U2N1".".1U.3N0.1"/")) S GMPVALID=1
"RTN","GMPLINTR",61,0)
 I GMPLICD?1.3(1U2N1".".1N.1U0.2N0.1"/")!(GMPLICD?1.3(1U2N1"."0.2N.1U.1N0.1"/")) S GMPVALID=1
"RTN","GMPLINTR",62,0)
 I GMPVALID D
"RTN","GMPLINTR",63,0)
 . F GMI=1:1:$L(GMPLICD,"/") D
"RTN","GMPLINTR",64,0)
 . . N GMPLCPTR S GMPLCPTR=$P($$CODECS^ICDEX($P(GMPLICD,"/",GMI),80,GMPDT),U)
"RTN","GMPLINTR",65,0)
 . . I '$$STATCHK^ICDEX($P(GMPLICD,"/",GMI),GMPDT,GMPLCPTR) D  Q
"RTN","GMPLINTR",66,0)
 . . . D EN^DDIOL(" ICD Code: "_GMPLICD_" is inactive.")
"RTN","GMPLINTR",67,0)
 . . . S GMPVALID=0
"RTN","GMPLINTR",68,0)
 E  D EN^DDIOL(" ICD Code: "_GMPLICD_" is invalid.")
"RTN","GMPLINTR",69,0)
 Q GMPVALID
"RTN","GMPLINTR",70,0)
 ;
"RTN","GMPLINTR",71,0)
VSCTCODE(GMPLSCTC) ;Check for a valid SNOMED CT code
"RTN","GMPLINTR",72,0)
 N GMPDT,GMPVALID,GMPSCHK S GMPDT=$$DT^XLFDT,GMPVALID=1
"RTN","GMPLINTR",73,0)
 S GMPSCHK=$$STATCHK^LEXSRC2(GMPLSCTC,GMPDT,"","SCT")
"RTN","GMPLINTR",74,0)
 I '+GMPSCHK,($L($P(GMPSCHK,U,3))) D
"RTN","GMPLINTR",75,0)
 . D EN^DDIOL(" SNOMED CT Concept: "_GMPLSCTC_" is inactive.")
"RTN","GMPLINTR",76,0)
 . S GMPVALID=0
"RTN","GMPLINTR",77,0)
 E  I '+GMPSCHK,($P(GMPSCHK,U,2)<0) D
"RTN","GMPLINTR",78,0)
 . D EN^DDIOL(" SNOMED CT Concept: "_GMPLSCTC_" is invalid.")
"RTN","GMPLINTR",79,0)
 . S GMPVALID=0
"RTN","GMPLINTR",80,0)
 E  I '+GMPSCHK,('$L($P(GMPSCHK,U,3))) D
"RTN","GMPLINTR",81,0)
 . D EN^DDIOL(" SNOMED CT Concept: "_GMPLSCTC_" is not yet active.")
"RTN","GMPLINTR",82,0)
 . S GMPVALID=0
"RTN","GMPLINTR",83,0)
 Q GMPVALID
"RTN","GMPLINTR",84,0)
 ;
"RTN","GMPLINTR",85,0)
VSCTDSGN(GMPLSCTC,GMPLSCTD,GMPLDTXT) ;Check for a valid SNOMED CT designation code
"RTN","GMPLINTR",86,0)
 N GMPDT,GMPVALID,GMPLSDGN,GMPQT,GMPSYN,GMPTYP,GMPNUM,GMPLRSLT,GMPLTXT
"RTN","GMPLINTR",87,0)
 S GMPDT=$$DT^XLFDT,GMPVALID=1,(GMPQT,GMPNUM)=0,(GMPTYP,GMPLSDGN)=""
"RTN","GMPLINTR",88,0)
 S GMPLRSLT=$$GETSYN^LEXTRAN1("SCT",GMPLSCTC,GMPDT,"GMPSYN",1,1)
"RTN","GMPLINTR",89,0)
 I +GMPLRSLT<0 D  G VSCTDX Q
"RTN","GMPLINTR",90,0)
 . S GMPLTXT(2)=" Error: "_$P(GMPLRSLT,U,2)
"RTN","GMPLINTR",91,0)
 . S GMPVALID=0
"RTN","GMPLINTR",92,0)
 S GMPLDTXT=$$STRIPSPC^GMPLX(GMPLDTXT)
"RTN","GMPLINTR",93,0)
 F  S GMPTYP=$O(GMPSYN(GMPTYP)) Q:GMPTYP=""!(GMPQT)  D
"RTN","GMPLINTR",94,0)
 . I GMPTYP="S" F  S GMPNUM=$O(GMPSYN(GMPTYP,GMPNUM)) Q:GMPNUM=""!(GMPQT)  D
"RTN","GMPLINTR",95,0)
 . . I $$STRIPSPC^GMPLX($P(GMPSYN(GMPTYP,GMPNUM),U))=GMPLDTXT S GMPLSDGN=$P(GMPSYN(GMPTYP,GMPNUM),U,3),GMPQT=1 Q
"RTN","GMPLINTR",96,0)
 . I (GMPNUM=""),(GMPLSDGN="") D  G VSCTDX Q
"RTN","GMPLINTR",97,0)
 . . S GMPLTXT(2)=" Error: Check failed, problem description does not match that of system."
"RTN","GMPLINTR",98,0)
 . . S GMPVALID=0,GMPQT=1
"RTN","GMPLINTR",99,0)
 . Q:GMPQT
"RTN","GMPLINTR",100,0)
 . I $$STRIPSPC^GMPLX($P(GMPSYN(GMPTYP),U))=GMPLDTXT S GMPLSDGN=$P(GMPSYN(GMPTYP),U,3),GMPQT=1 Q
"RTN","GMPLINTR",101,0)
 I 'GMPVALID G VSCTDX1
"RTN","GMPLINTR",102,0)
 I +GMPLRSLT>0 D
"RTN","GMPLINTR",103,0)
 . I GMPLSCTD'=GMPLSDGN S GMPLTXT(2)=" Error: Check failed, designation code does not match that of system.",GMPVALID=0
"RTN","GMPLINTR",104,0)
VSCTDX I 'GMPVALID D
"RTN","GMPLINTR",105,0)
 . S GMPLTXT(1)=" SNOMED CT Designation: "_GMPLSCTD_" is invalid."
"RTN","GMPLINTR",106,0)
 . D EN^DDIOL(.GMPLTXT)
"RTN","GMPLINTR",107,0)
VSCTDX1 Q GMPVALID
"RTN","GMPLINTR",108,0)
 ;
"RTN","GMPLINTR",109,0)
VSEQ(X,GMPLTYPE) ; Check for valid SEQUENCE field
"RTN","GMPLINTR",110,0)
 N GMPLTXT,GMPLINV S GMPLINV=0
"RTN","GMPLINTR",111,0)
 I '$L(X) S GMPLTXT=" Error: "_GMPLTYPE_" sequence cannot be empty.",GMPLINV=1
"RTN","GMPLINTR",112,0)
 E  I +X'=X!(X>999.99)!(X<.01)!(X?.E1"."3N.N) S GMPLTXT=" "_GMPLTYPE_" Sequence: "_X_" is invalid.",GMPLINV=1
"RTN","GMPLINTR",113,0)
 I GMPLINV D EN^DDIOL(GMPLTXT) Q 0
"RTN","GMPLINTR",114,0)
 E  Q 1
"RTN","GMPLSAVE")
0^16^B133926032
"RTN","GMPLSAVE",1,0)
GMPLSAVE ; ISL/MKB,KER,JER,TC -- Save Problem List data ;04/28/17  12:03
"RTN","GMPLSAVE",2,0)
 ;;2.0;Problem List;**26,31,35,37,38,36,42,47,45,49**;Aug 25, 1994;Build 43
"RTN","GMPLSAVE",3,0)
 ;
"RTN","GMPLSAVE",4,0)
 ; External References
"RTN","GMPLSAVE",5,0)
 ;   ICR #5747   $$CSI^ICDEX,$$SAB^ICDEX,$$CODECS^ICDEX
"RTN","GMPLSAVE",6,0)
 ;   ICR #5009   $$GETDES^LEXTRAN1
"RTN","GMPLSAVE",7,0)
 ;   DBIA 10018  ^DIE
"RTN","GMPLSAVE",8,0)
 ;   DBIA 10013  ^DIK
"RTN","GMPLSAVE",9,0)
 ;   DBIA 10013  IX1^DIK
"RTN","GMPLSAVE",10,0)
 ;   DBIA 10103  $$HTFM^XLFDT
"RTN","GMPLSAVE",11,0)
 ;
"RTN","GMPLSAVE",12,0)
EN ; Save Changes made to Existing Problem
"RTN","GMPLSAVE",13,0)
 N FLD,NOW,CHNGE,I,NIFN,TEXT,OLDTEXT,FAC,NODE,AUDITED,DR,DA,DIE,DIK,GMPICD,GMPBULL,NEWNTDT,%DT,X,GMPNOW,GMPIMPDT
"RTN","GMPLSAVE",14,0)
 S GMPNOW=$$NOW^XLFDT,GMPIMPDT=$$IMPDATE^LEXU("10D")
"RTN","GMPLSAVE",15,0)
 S:'GMPORIG(.01) GMPORIG(.01)=$$NOS^GMPLX($P(GMPFLD(80202),U),$P(GMPFLD(80201),U))
"RTN","GMPLSAVE",16,0)
 S:'GMPFLD(.01) GMPFLD(.01)=$$NOS^GMPLX($P(GMPFLD(80202),U),$P(GMPFLD(80201),U))
"RTN","GMPLSAVE",17,0)
 S GMPICD=$P($G(GMPFLD(.01)),U,2)
"RTN","GMPLSAVE",18,0)
 S:$D(GMPFLD(.01)) GMPFLD(.01)=+GMPFLD(.01)
"RTN","GMPLSAVE",19,0)
 S:$P(GMPFLD(.01),U)=-1 GMPFLD(.01)=$$NOS^GMPLX($P(GMPFLD(80202),U),$P(GMPFLD(80201),U)) ;chk for error from ICD
"RTN","GMPLSAVE",20,0)
 S:$G(GMPFLD(80201))']"" GMPFLD(80201)=DT_U_$$EXTDT^GMPLX(DT)
"RTN","GMPLSAVE",21,0)
 S:$G(GMPFLD(80202))']"" GMPFLD(80202)=$$SAB^ICDEX($$CSI^ICDEX(80,+GMPFLD(.01)),DT)_U_$P($$CODECS^ICDEX($P(GMPICD,"/"),80,DT),U,2)
"RTN","GMPLSAVE",22,0)
 S:'GMPORIG(1.01) GMPORIG(1.01)="1^Unresolved"
"RTN","GMPLSAVE",23,0)
 S:'GMPFLD(1.01) GMPFLD(1.01)="1^Unresolved"
"RTN","GMPLSAVE",24,0)
 I $G(GMPFLD(1.01))["SNOMED CT" D
"RTN","GMPLSAVE",25,0)
 . N SCTS,SCTC,SCTD,SCTT,GMPTYP,GMPNUM,GMPQT,GMPSYN
"RTN","GMPLSAVE",26,0)
 . S (GMPTYP,GMPNUM,GMPQT)=""
"RTN","GMPLSAVE",27,0)
 . S SCTS=GMPFLD(1.01)
"RTN","GMPLSAVE",28,0)
 . S SCTT=$P($P(SCTS," (SNOMED CT "),U,2)
"RTN","GMPLSAVE",29,0)
 . S SCTC=$P($P(SCTS,"SNOMED CT ",2),")"),GMPFLD(80001)=SCTC_U_SCTC
"RTN","GMPLSAVE",30,0)
 . S SCTD=$$GETSYN^LEXTRAN1("SCT",SCTC,DT,"GMPSYN",1,1)
"RTN","GMPLSAVE",31,0)
 . I $P(SCTD,U)'=1 S SCTD="" Q
"RTN","GMPLSAVE",32,0)
 . F  S GMPTYP=$O(GMPSYN(GMPTYP)) Q:GMPTYP=""!(GMPQT)  D
"RTN","GMPLSAVE",33,0)
 . . I GMPTYP="S" F  S GMPNUM=$O(GMPSYN(GMPTYP,GMPNUM)) Q:GMPNUM=""!(GMPQT)  D
"RTN","GMPLSAVE",34,0)
 . . . I $P(GMPSYN(GMPTYP,GMPNUM),U)=SCTT S SCTD=$P(GMPSYN(GMPTYP,GMPNUM),U,3),GMPQT=1 Q
"RTN","GMPLSAVE",35,0)
 . . Q:GMPQT
"RTN","GMPLSAVE",36,0)
 . . I $P(GMPSYN(GMPTYP),U)=SCTT S SCTD=$P(GMPSYN(GMPTYP),U,3),GMPQT=1 Q
"RTN","GMPLSAVE",37,0)
 . S GMPFLD(80002)=SCTD_U_SCTD K GMPSYN
"RTN","GMPLSAVE",38,0)
 . I (+$G(GMPFLD(.01))=+$$NOS^GMPLX($P(GMPFLD(80202),U),$P(GMPFLD(80201),U))) S GMPFLD(80005)="1^PENDING"
"RTN","GMPLSAVE",39,0)
 I $G(GMPFLD(1.01))["VHAT" D
"RTN","GMPLSAVE",40,0)
 . N VHATC,VHATD,VHATS,VHATT
"RTN","GMPLSAVE",41,0)
 . S VHATS=GMPFLD(1.01)
"RTN","GMPLSAVE",42,0)
 . S VHATT=$P($P(VHATS," (VHAT "),U,2)
"RTN","GMPLSAVE",43,0)
 . S VHATC=$P($P(VHATS,"VHAT ",2),")")
"RTN","GMPLSAVE",44,0)
 . S GMPFLD(80003)=VHATC_U_VHATC
"RTN","GMPLSAVE",45,0)
 . S VHATD=$$GETDES^LEXTRAN1("VHAT",VHATT)
"RTN","GMPLSAVE",46,0)
 . I +VHATD=1 S VHATD=$P(VHATD,U,2),GMPFLD(80004)=VHATD_U_VHATD
"RTN","GMPLSAVE",47,0)
 S:'GMPFLD(.05) I=$P(GMPFLD(.05),U,2),GMPFLD(.05)=$$PROVNARR^GMPLX(I,+GMPFLD(1.01))
"RTN","GMPLSAVE",48,0)
 S NOW=$$HTFM^XLFDT($H),AUDITED=0
"RTN","GMPLSAVE",49,0)
 S DR="1.02////"_$S('$D(GMPLUSER):"T",1:GMPFLD(1.02))
"RTN","GMPLSAVE",50,0)
 I GMPORIG(1.02)="T",GMPFLD(1.02)="P" D
"RTN","GMPLSAVE",51,0)
 . S CHNGE=GMPIFN_"^1.02^"_NOW_U_DUZ_"^T^P^Verified^"_DUZ
"RTN","GMPLSAVE",52,0)
 . D AUDIT^GMPLX(CHNGE,"")
"RTN","GMPLSAVE",53,0)
 I $P($G(GMPORIG(.12)),U)="I",$P(GMPFLD(.12),U)="A" D REACTV S AUDITED=1
"RTN","GMPLSAVE",54,0)
 I +$G(GMPORIG(1.01))'=(+GMPFLD(1.01)) D REFORM S AUDITED=1
"RTN","GMPLSAVE",55,0)
 S GMPFLD(.01)=+GMPFLD(.01) ;to remove text left by ?? lex (~)
"RTN","GMPLSAVE",56,0)
 I (+$G(GMPFLD(.01))'=+$$NOS^GMPLX($P(GMPFLD(80202),U),$P(GMPFLD(80201),U))),($G(GMPROV)=.5) S GMPFLD(80005)="2^COMPLETED"
"RTN","GMPLSAVE",57,0)
 F FLD=.01,.05,.12,.13,1.01,1.05,1.06,1.07,1.08,1.09,1.1,1.11,1.12,1.13,1.14,1.15,1.16,1.17,1.18,80001,80002,80003,80004,80005,80201,80202 D
"RTN","GMPLSAVE",58,0)
 . Q:'$D(GMPFLD(FLD))  Q:$P($G(GMPORIG(FLD)),U)=$P($G(GMPFLD(FLD)),U)
"RTN","GMPLSAVE",59,0)
 . S DR=DR_";"_FLD_"////"_$S($P(GMPFLD(FLD),U)'="":$P(GMPFLD(FLD),U),1:"@")
"RTN","GMPLSAVE",60,0)
 . Q:AUDITED&((FLD=.12)!(FLD=1.01))  S CHNGE=GMPIFN_U_FLD_U_NOW_U_DUZ_U_$P(GMPORIG(FLD),U)_U_$P(GMPFLD(FLD),U)_"^^"_+$G(GMPROV)
"RTN","GMPLSAVE",61,0)
 . D AUDIT^GMPLX(CHNGE,"")
"RTN","GMPLSAVE",62,0)
 S DA=GMPIFN,DIE="^AUPNPROB(" D ^DIE S GMPSAVED=1
"RTN","GMPLSAVE",63,0)
 D COEXPRS(GMPIFN,GMPICD)
"RTN","GMPLSAVE",64,0)
 I (GMPNOW<GMPIMPDT),($P(GMPICD,"/")=$P($$NOS^GMPLX($P(GMPFLD(80202),U),$P(GMPFLD(80201),U)),U,2)),(+$P($G(GMPFLD(80001)),U)>0) D NTRTBULL(.GMPBULL,$P(GMPFLD(1.01),U,2),$P($G(GMPFLD(80001)),U,2),$G(GMPSRCH))
"RTN","GMPLSAVE",65,0)
NOTES ; Save Changes to Notes
"RTN","GMPLSAVE",66,0)
 F I=0:0 S I=$O(GMPORIG(10,I)) Q:I'>0  I GMPORIG(10,I)'=GMPFLD(10,I) D
"RTN","GMPLSAVE",67,0)
 . S NIFN=+GMPFLD(10,I),FAC=$P(GMPFLD(10,I),U,2),TEXT=$P(GMPFLD(10,I),U,3),OLDTEXT=$P(GMPORIG(10,I),U,3),NEWNTDT=$P($G(GMPFLD(10,I)),U,5)
"RTN","GMPLSAVE",68,0)
 . S %DT="X",X=NEWNTDT D ^%DT S NEWNTDT=Y
"RTN","GMPLSAVE",69,0)
 . S NODE=$G(^AUPNPROB(GMPIFN,11,FAC,11,NIFN,0))
"RTN","GMPLSAVE",70,0)
 . I TEXT'="" S $P(^AUPNPROB(GMPIFN,11,FAC,11,NIFN,0),U,3)=TEXT D
"RTN","GMPLSAVE",71,0)
 .. I TEXT=OLDTEXT Q
"RTN","GMPLSAVE",72,0)
 .. I $P($G(GMPORIG(10,I)),U,5)'=NEWNTDT S $P(^AUPNPROB(GMPIFN,11,FAC,11,NIFN,0),U,5)=NEWNTDT ;Date note added
"RTN","GMPLSAVE",73,0)
 .. I $P($G(GMPORIG(10,I)),U,6)'=$P($G(GMPFLD(10,I)),U,6) S $P(^AUPNPROB(GMPIFN,11,FAC,11,NIFN,0),U,6)=$P($G(GMPFLD(10,I)),U,6) ;Author
"RTN","GMPLSAVE",74,0)
 .. S CHNGE=GMPIFN_"^1101^"_NOW_U_DUZ_"^C^^Note Modified^"_+$G(GMPROV)
"RTN","GMPLSAVE",75,0)
 . I TEXT=OLDTEXT Q
"RTN","GMPLSAVE",76,0)
 . I TEXT="" S CHNGE=GMPIFN_"^1101^"_NOW_U_DUZ_"^A^^Deleted Note^"_+$G(GMPROV)
"RTN","GMPLSAVE",77,0)
 . D AUDIT^GMPLX(CHNGE,NODE)
"RTN","GMPLSAVE",78,0)
 . I TEXT="" D
"RTN","GMPLSAVE",79,0)
 .. S DIK="^AUPNPROB("_GMPIFN_",11,"_FAC_",11,"
"RTN","GMPLSAVE",80,0)
 .. S DA(2)=GMPIFN,DA(1)=FAC,DA=NIFN D ^DIK
"RTN","GMPLSAVE",81,0)
 I $D(GMPFLD(10,"NEW"))>9 D NEWNOTE
"RTN","GMPLSAVE",82,0)
EXIT ; Quit Saving Changes
"RTN","GMPLSAVE",83,0)
 D:$G(GMPSAVED) DTMOD^GMPLX(GMPIFN)
"RTN","GMPLSAVE",84,0)
 Q
"RTN","GMPLSAVE",85,0)
 ;
"RTN","GMPLSAVE",86,0)
REFORM ; Audit Entry that has been Reformulated
"RTN","GMPLSAVE",87,0)
 S CHNGE=GMPIFN_"^1.01^"_NOW_U_DUZ_U_+GMPORIG(1.01)_U_+GMPFLD(1.01)_"^Reformulated^"_+$G(GMPROV)
"RTN","GMPLSAVE",88,0)
 S NODE=$G(^AUPNPROB(GMPIFN,0))_U_$G(^AUPNPROB(GMPIFN,1))
"RTN","GMPLSAVE",89,0)
 D AUDIT^GMPLX(CHNGE,NODE)
"RTN","GMPLSAVE",90,0)
 Q
"RTN","GMPLSAVE",91,0)
 ;
"RTN","GMPLSAVE",92,0)
REACTV ; Audit Entry that has been Reactivated
"RTN","GMPLSAVE",93,0)
 S CHNGE=GMPIFN_"^.12^"_NOW_U_DUZ_"^I^A^Reactivated^"_+$G(GMPROV)
"RTN","GMPLSAVE",94,0)
 S NODE=$G(^AUPNPROB(GMPIFN,0))_U_$G(^AUPNPROB(GMPIFN,1))
"RTN","GMPLSAVE",95,0)
 D AUDIT^GMPLX(CHNGE,NODE)
"RTN","GMPLSAVE",96,0)
 Q
"RTN","GMPLSAVE",97,0)
 ;
"RTN","GMPLSAVE",98,0)
NEW ; Save Collected Values in new Problem Entry
"RTN","GMPLSAVE",99,0)
 ;   Output   DA (left defined)
"RTN","GMPLSAVE",100,0)
 N DATA,APCDLOOK,APCDALVR,NUM,I,DIK,GMPICD,GMPIFN,X,CSID,CSAB,CSDT,GMPNOW,GMPIMPDT
"RTN","GMPLSAVE",101,0)
 S GMPNOW=$$NOW^XLFDT,GMPIMPDT=$$IMPDATE^LEXU("10D")
"RTN","GMPLSAVE",102,0)
 S CSDT=$S($P($G(GMPFLD(80201)),U)]"":$P($G(GMPFLD(80201)),U),1:DT)
"RTN","GMPLSAVE",103,0)
 S CSID=$S(+$G(GMPFLD(.01))>0:$$CSI^ICDEX(80,+$G(GMPFLD(.01))),1:$$CS^ICDEX(80,"E",CSDT))
"RTN","GMPLSAVE",104,0)
 S CSAB=$S($P($G(GMPFLD(80202)),U)]"":$P($G(GMPFLD(80202)),U),1:$$SAB^ICDEX(CSID,CSDT))
"RTN","GMPLSAVE",105,0)
 S:'GMPFLD(.01) GMPFLD(.01)=$$NOS^GMPLX(CSAB,CSDT)
"RTN","GMPLSAVE",106,0)
 S:$P(+GMPFLD(.01),U)=-1 GMPFLD(.01)=$$NOS^GMPLX(CSAB,CSDT) ;chk for error from ICD
"RTN","GMPLSAVE",107,0)
 S GMPICD=$S($P($G(GMPFLD(.01)),U,2)]"":$P($G(GMPFLD(.01)),U,2),1:$$CODEC^ICDEX(80,$P($G(GMPFLD(.01)),U)))
"RTN","GMPLSAVE",108,0)
 I GMPICD["ICD" S GMPICD=$P($P(GMPICD," ",2),")",1)
"RTN","GMPLSAVE",109,0)
 S:$G(GMPFLD(80201))']"" GMPFLD(80201)=CSDT_U_$$EXTDT^GMPLX(CSDT)
"RTN","GMPLSAVE",110,0)
 S:$G(GMPFLD(80202))']"" GMPFLD(80202)=CSAB_U_$P($$CODECS^ICDEX($P(GMPICD,"/"),80,CSDT),U,2)
"RTN","GMPLSAVE",111,0)
 S GMPFLD(.01)=+GMPFLD(.01) ;to remove text left by ?? lex (~)
"RTN","GMPLSAVE",112,0)
 S:'GMPFLD(1.01) GMPFLD(1.01)="1^Unresolved"
"RTN","GMPLSAVE",113,0)
 S:'GMPFLD(.05) X=$P(GMPFLD(.05),U,2),GMPFLD(.05)=$$PROVNARR^GMPLX(X,+GMPFLD(1.01))
"RTN","GMPLSAVE",114,0)
 S:$G(GMPFLD(1.09))']"" GMPFLD(1.09)=$$DT^XLFDT
"RTN","GMPLSAVE",115,0)
 I $G(GMPFLD(1.01))["SNOMED CT" D
"RTN","GMPLSAVE",116,0)
 . N SCTC,SCTD,SCTS,SCTT,GMPTYP,GMPNUM,GMPQT,GMPSYN
"RTN","GMPLSAVE",117,0)
 . S (GMPTYP,GMPNUM,GMPQT)=""
"RTN","GMPLSAVE",118,0)
 . S SCTS=GMPFLD(1.01)
"RTN","GMPLSAVE",119,0)
 . S SCTT=$P($P(SCTS," (SNOMED CT "),U,2)
"RTN","GMPLSAVE",120,0)
 . S SCTC=$P($P(SCTS,"SNOMED CT ",2),")")
"RTN","GMPLSAVE",121,0)
 . S GMPFLD(80001)=SCTC_U_SCTC
"RTN","GMPLSAVE",122,0)
 . S SCTD=$$GETSYN^LEXTRAN1("SCT",SCTC,DT,"GMPSYN",1,1)
"RTN","GMPLSAVE",123,0)
 . I $P(SCTD,U)'=1 S SCTD="" Q
"RTN","GMPLSAVE",124,0)
 . F  S GMPTYP=$O(GMPSYN(GMPTYP)) Q:GMPTYP=""!(GMPQT)  D
"RTN","GMPLSAVE",125,0)
 . . I GMPTYP="S" F  S GMPNUM=$O(GMPSYN(GMPTYP,GMPNUM)) Q:GMPNUM=""!(GMPQT)  D
"RTN","GMPLSAVE",126,0)
 . . . I $P(GMPSYN(GMPTYP,GMPNUM),U)=SCTT S SCTD=$P(GMPSYN(GMPTYP,GMPNUM),U,3),GMPQT=1 Q
"RTN","GMPLSAVE",127,0)
 . . Q:GMPQT
"RTN","GMPLSAVE",128,0)
 . . I $P(GMPSYN(GMPTYP),U)=SCTT S SCTD=$P(GMPSYN(GMPTYP),U,3),GMPQT=1 Q
"RTN","GMPLSAVE",129,0)
 . S GMPFLD(80002)=SCTD_U_SCTD K GMPSYN
"RTN","GMPLSAVE",130,0)
 I $G(GMPFLD(1.01))["VHAT" D
"RTN","GMPLSAVE",131,0)
 . N VHATC,VHATD,VHATS,VHATT
"RTN","GMPLSAVE",132,0)
 . S VHATS=GMPFLD(1.01)
"RTN","GMPLSAVE",133,0)
 . S VHATT=$P($P(VHATS," (VHAT "),U,2)
"RTN","GMPLSAVE",134,0)
 . S VHATC=$P($P(VHATS,"VHAT ",2),")")
"RTN","GMPLSAVE",135,0)
 . S GMPFLD(80003)=VHATC_U_VHATC
"RTN","GMPLSAVE",136,0)
 . S VHATD=$$GETDES^LEXTRAN1("VHAT",VHATT)
"RTN","GMPLSAVE",137,0)
 . I +VHATD=1 S VHATD=$P(VHATD,U,2),GMPFLD(80004)=VHATD_U_VHATD
"RTN","GMPLSAVE",138,0)
 S DA=$$NEWPROB(+GMPFLD(.01),+GMPDFN) Q:DA'>0
"RTN","GMPLSAVE",139,0)
 S NUM=$$NEXTNMBR(+GMPDFN,+GMPVAMC),GMPSAVED=1 S:'NUM NUM=""
"RTN","GMPLSAVE",140,0)
 ;   Set Node 0
"RTN","GMPLSAVE",141,0)
 S DATA=^AUPNPROB(DA,0)_U_DT_"^^"_$P(GMPFLD(.05),U)_U_+GMPVAMC_U_+NUM_U_DT_"^^^^"_$P(GMPFLD(.12),U)_U_$P(GMPFLD(.13),U)
"RTN","GMPLSAVE",142,0)
 S ^AUPNPROB(DA,0)=DATA
"RTN","GMPLSAVE",143,0)
 ;   Set Node 1
"RTN","GMPLSAVE",144,0)
 S DATA=$P(GMPFLD(1.01),U) F I=1.02:.01:1.18 S DATA=DATA_U_$S($P($G(GMPFLD(+I)),U)="@":"",1:$P($G(GMPFLD(+I)),U))
"RTN","GMPLSAVE",145,0)
 S ^AUPNPROB(DA,1)=DATA
"RTN","GMPLSAVE",146,0)
 ;   Set Node 800
"RTN","GMPLSAVE",147,0)
 I $S($L($P($G(GMPFLD(80001)),U)):1,$L($P($G(GMPFLD(80003)),U)):1,$L($P($G(GMPFLD(80004)),U)):1,$L($P($G(GMPFLD(80005)),U)):1,1:0) D
"RTN","GMPLSAVE",148,0)
 . I $P($G(GMPFLD(.01)),U)=$P($$NOS^GMPLX($P(GMPFLD(80202),U),$P(GMPFLD(80201),U)),U) S GMPFLD(80005)="1^PENDING"
"RTN","GMPLSAVE",149,0)
 . S DATA=$P($G(GMPFLD(80001)),U)_U_$P($G(GMPFLD(80002)),U)_U_$P($G(GMPFLD(80003)),U)_U_$P($G(GMPFLD(80004)),U)_U_$P($G(GMPFLD(80005)),U)
"RTN","GMPLSAVE",150,0)
 . S ^AUPNPROB(DA,800)=DATA
"RTN","GMPLSAVE",151,0)
 ;   Set Node 801
"RTN","GMPLSAVE",152,0)
 I $S($L($P($G(GMPFLD(80101)),U)):1,$L($P($G(GMPFLD(80102)),U)):1,1:0) D
"RTN","GMPLSAVE",153,0)
 . S DATA=$P($G(GMPFLD(80101)),U)_U_$P($G(GMPFLD(80102)),U)
"RTN","GMPLSAVE",154,0)
 . S ^AUPNPROB(DA,801)=DATA
"RTN","GMPLSAVE",155,0)
 ;   Set Node 802
"RTN","GMPLSAVE",156,0)
 I $S($L($P($G(GMPFLD(80201)),U)):1,$L($P($G(GMPFLD(80202)),U)):1,1:0) D
"RTN","GMPLSAVE",157,0)
 . S DATA=$P($G(GMPFLD(80201)),U)_U_$P($G(GMPFLD(80202)),U)
"RTN","GMPLSAVE",158,0)
 . S ^AUPNPROB(DA,802)=DATA
"RTN","GMPLSAVE",159,0)
 ;   Handle multiple ICDs
"RTN","GMPLSAVE",160,0)
 I GMPICD["/" D COEXPRS(DA,GMPICD)
"RTN","GMPLSAVE",161,0)
 ;   Set X-Refs
"RTN","GMPLSAVE",162,0)
 S DIK="^AUPNPROB(",(APCDLOOK,APCDALVR)=1 D IX1^DIK
"RTN","GMPLSAVE",163,0)
 I $D(GMPFLD(10,"NEW"))>9 S GMPIFN=DA D NEWNOTE
"RTN","GMPLSAVE",164,0)
 I (GMPNOW<GMPIMPDT),($P(GMPICD,"/")=$P($$NOS^GMPLX($P(GMPFLD(80202),U),$P(GMPFLD(80201),U)),U,2)),(+$P($G(GMPFLD(80001)),U)>0) D NTRTBULL(.GMPBULL,$P(GMPFLD(1.01),U,2),$P($G(GMPFLD(80001)),U,2),$G(GMPSRCH))
"RTN","GMPLSAVE",165,0)
 ; broadcast event
"RTN","GMPLSAVE",166,0)
 N DFN S GMPIFN=DA,DFN=+GMPDFN
"RTN","GMPLSAVE",167,0)
 S X=+$O(^ORD(101,"B","GMPL EVENT",0))_";ORD(101," D:X EN1^XQOR
"RTN","GMPLSAVE",168,0)
 Q
"RTN","GMPLSAVE",169,0)
 ;
"RTN","GMPLSAVE",170,0)
NEWPROB(ICD,DFN) ; Creates New Problem Entry in file #9000011
"RTN","GMPLSAVE",171,0)
 N I,HDR,LAST,TOTAL,DA
"RTN","GMPLSAVE",172,0)
 L +^AUPNPROB(0):1 I '$T D  Q -1
"RTN","GMPLSAVE",173,0)
 . W !!,"Someone else is currently editing this file."
"RTN","GMPLSAVE",174,0)
 . W !,"Please try again later.",!
"RTN","GMPLSAVE",175,0)
 S HDR=$G(^AUPNPROB(0)) Q:HDR="" -1
"RTN","GMPLSAVE",176,0)
 S LAST=$P(HDR,U,3),TOTAL=$P(HDR,U,4)
"RTN","GMPLSAVE",177,0)
 F I=(LAST+1):1 Q:'$D(^AUPNPROB(I,0))
"RTN","GMPLSAVE",178,0)
 S DA=I,^AUPNPROB(DA,0)=ICD_U_DFN
"RTN","GMPLSAVE",179,0)
 S ^AUPNPROB("B",ICD,DA)="",^AUPNPROB("AC",DFN,DA)=""
"RTN","GMPLSAVE",180,0)
 S $P(^AUPNPROB(0),U,3,4)=DA_U_(TOTAL+1) L -^AUPNPROB(0)
"RTN","GMPLSAVE",181,0)
 Q DA
"RTN","GMPLSAVE",182,0)
 ;
"RTN","GMPLSAVE",183,0)
NEWNOTE ; Creates New Note Entries for Problem
"RTN","GMPLSAVE",184,0)
 ;   Requires GMPIFN   Pointer to Problem
"RTN","GMPLSAVE",185,0)
 ;            GMPROV   Current Provider
"RTN","GMPLSAVE",186,0)
 ;            GMPVAMC  Facility
"RTN","GMPLSAVE",187,0)
 N HDR,LAST,TOTAL,I,FAC,NIFN
"RTN","GMPLSAVE",188,0)
 L +^AUPNPROB(GMPIFN,11):1 I '$T Q
"RTN","GMPLSAVE",189,0)
 S FAC=+$O(^AUPNPROB(GMPIFN,11,"B",GMPVAMC,0)) I 'FAC D
"RTN","GMPLSAVE",190,0)
 . S:'$D(^AUPNPROB(GMPIFN,11,0)) ^(0)="^9000011.11PA^^"
"RTN","GMPLSAVE",191,0)
 . S HDR=^AUPNPROB(GMPIFN,11,0),LAST=$P(HDR,U,3),TOTAL=$P(HDR,U,4)
"RTN","GMPLSAVE",192,0)
 . F I=(LAST+1):1 Q:'$D(^AUPNPROB(GMPIFN,11,I,0))
"RTN","GMPLSAVE",193,0)
 . S ^AUPNPROB(GMPIFN,11,I,0)=GMPVAMC,^AUPNPROB(GMPIFN,11,"B",GMPVAMC,I)=""
"RTN","GMPLSAVE",194,0)
 . S FAC=I,$P(^AUPNPROB(GMPIFN,11,0),U,3,4)=FAC_U_(TOTAL+1)
"RTN","GMPLSAVE",195,0)
 I FAC'>0 G NNQ
"RTN","GMPLSAVE",196,0)
NN1 ; Get New Note
"RTN","GMPLSAVE",197,0)
 S:'$D(^AUPNPROB(GMPIFN,11,FAC,11,0)) ^(0)="^9000011.1111IA^^"
"RTN","GMPLSAVE",198,0)
 S HDR=^AUPNPROB(GMPIFN,11,FAC,11,0),LAST=$P(HDR,U,3),TOTAL=$P(HDR,U,4)
"RTN","GMPLSAVE",199,0)
 F I=(LAST+1):1 Q:'$D(^AUPNPROB(GMPIFN,11,FAC,11,I,0))
"RTN","GMPLSAVE",200,0)
 S NIFN=I
"RTN","GMPLSAVE",201,0)
 F I=0:0 S I=$O(GMPFLD(10,"NEW",I)) Q:I'>0  D
"RTN","GMPLSAVE",202,0)
 . S ^AUPNPROB(GMPIFN,11,FAC,11,NIFN,0)=NIFN_"^^"_GMPFLD(10,"NEW",I)_"^A^"_DT_U_+$G(GMPROV)
"RTN","GMPLSAVE",203,0)
 . S ^AUPNPROB(GMPIFN,11,FAC,11,"B",NIFN,NIFN)=""
"RTN","GMPLSAVE",204,0)
 . S TOTAL=TOTAL+1,LAST=NIFN,NIFN=NIFN+1
"RTN","GMPLSAVE",205,0)
 S $P(^AUPNPROB(GMPIFN,11,FAC,11,0),U,3,4)=LAST_U_TOTAL
"RTN","GMPLSAVE",206,0)
NNQ ; Quit Getting New Notes
"RTN","GMPLSAVE",207,0)
 L -^AUPNPROB(GMPIFN,11)
"RTN","GMPLSAVE",208,0)
 Q
"RTN","GMPLSAVE",209,0)
 ;
"RTN","GMPLSAVE",210,0)
NEXTNMBR(DFN,VAMC) ; Returns Next Available Problem Number
"RTN","GMPLSAVE",211,0)
 N I,J,NUM S NUM=1,I="" I '$D(^AUPNPROB("AA",DFN,VAMC)) Q NUM
"RTN","GMPLSAVE",212,0)
 F  S I=$O(^AUPNPROB("AA",DFN,VAMC,I)) Q:I=""  S J=$E(I,2,999),NUM=+J
"RTN","GMPLSAVE",213,0)
 S NUM=NUM+1
"RTN","GMPLSAVE",214,0)
 Q NUM
"RTN","GMPLSAVE",215,0)
NTRTBULL(GMPY,GMPTERM,GMPSCT,GMPSRCH) ; Send NTRT Request bulletin to NTRT mailgroup
"RTN","GMPLSAVE",216,0)
 N GMPSITE,GMPSVC,GMPUSER,GMPWRAP,XMBNM,XMDUZ,XMY,XMB,XMZ S GMPSITE=$$SITE^VASITE
"RTN","GMPLSAVE",217,0)
 I '$L(GMPTERM) S GMPY="0^Empty String - a valid term must be sent." Q
"RTN","GMPLSAVE",218,0)
 I '+$G(DUZ)!'$D(^VA(200,+$G(DUZ))) S GMPY="0^A valid user must be identified." Q
"RTN","GMPLSAVE",219,0)
 I '+$G(GMPSCT) S GMPSCT="N/A"
"RTN","GMPLSAVE",220,0)
 D USERINFO^XUSRB2(.GMPUSER) S GMPSVC=$G(GMPUSER(5))
"RTN","GMPLSAVE",221,0)
 S XMB="GMPL PROBLEM NTRT BULLETIN"
"RTN","GMPLSAVE",222,0)
 S XMDUZ="GMPL PROBLEM NTRT BULLETIN"
"RTN","GMPLSAVE",223,0)
 S XMY("G.PROBLEM LIST NTRT@domain.ext")=""
"RTN","GMPLSAVE",224,0)
 S GMPWRAP=$$WRAP^GMPLX1(GMPTERM,53)
"RTN","GMPLSAVE",225,0)
 S XMB(1)=GMPTERM
"RTN","GMPLSAVE",226,0)
 S XMB(2)=GMPSCT
"RTN","GMPLSAVE",227,0)
 S XMB(3)=$$GET1^DIQ(200,DUZ_",",.01)
"RTN","GMPLSAVE",228,0)
 S XMB(4)=$$FMTE^XLFDT($E(($$NOW^XLFDT),1,12),2)
"RTN","GMPLSAVE",229,0)
 S XMB(5)=GMPSVC
"RTN","GMPLSAVE",230,0)
 S XMB(6)=$P(GMPSITE,U,2)_" ("_$P(GMPSITE,U,3)_")"
"RTN","GMPLSAVE",231,0)
 S XMB(7)=$G(GMPSRCH)
"RTN","GMPLSAVE",232,0)
 D ^XMB,KILL^XM S GMPY=1
"RTN","GMPLSAVE",233,0)
 Q
"RTN","GMPLSAVE",234,0)
COEXPRS(GMPDA,GMPICD) ; File multiple ICDs
"RTN","GMPLSAVE",235,0)
 N GMPC,GMPI,GMPN,GMPJ,GMPORIG,NOW,GMPOCNT,GMPNCNT,CODSYS S NOW=$$NOW^XLFDT
"RTN","GMPLSAVE",236,0)
 ; Initialize CODSYS to "ICD" when ICD-10-CM is implemented, new codes will get "10D"
"RTN","GMPLSAVE",237,0)
 S CODSYS=$$SAB^ICDEX(+$$CODECS^ICDEX($P(GMPICD,"/"),80,DT),DT)
"RTN","GMPLSAVE",238,0)
 ; Merge previous entries into local GMPORIG array
"RTN","GMPLSAVE",239,0)
 I $D(^AUPNPROB(GMPDA,803)) M GMPORIG=^AUPNPROB(GMPDA,803)
"RTN","GMPLSAVE",240,0)
 ; If not sparce ICD string, remove previous entries
"RTN","GMPLSAVE",241,0)
 S GMPNCNT=+$P($G(^AUPNPROB(GMPDA,803,0)),U,4)
"RTN","GMPLSAVE",242,0)
 I '$$SPRCICD(GMPICD) D
"RTN","GMPLSAVE",243,0)
 . N GMPLFDA
"RTN","GMPLSAVE",244,0)
 . F GMPJ=1:1:GMPNCNT D
"RTN","GMPLSAVE",245,0)
 . . S GMPLFDA(9000011.803,""_GMPJ_","_GMPDA_",",.01)="@"
"RTN","GMPLSAVE",246,0)
 . . D FILE^DIE("","GMPLFDA")
"RTN","GMPLSAVE",247,0)
 ; Update sub-file
"RTN","GMPLSAVE",248,0)
 S GMPN=$L(GMPICD,"/")-1
"RTN","GMPLSAVE",249,0)
 F GMPI=1:1:GMPN D
"RTN","GMPLSAVE",250,0)
 . N GMPCODE,GMPD30,GMPNOS,GMPFDA,Y,GMPDT S GMPNOS=$$NOS^GMPLX(CODSYS)
"RTN","GMPLSAVE",251,0)
 . S GMPCODE=$P(GMPICD,"/",(GMPI+1)) Q:(GMPCODE="")
"RTN","GMPLSAVE",252,0)
 . S GMPD30=$G(^AUPNPROB(GMPDA,803,GMPI,0))
"RTN","GMPLSAVE",253,0)
 . I (GMPCODE=$P(GMPNOS,U,2)),($P(GMPD30,U)]""),($P(GMPD30,U)'=$P(GMPNOS,U,2)) Q
"RTN","GMPLSAVE",254,0)
 . S Y=DT D DD^%DT S GMPDT=$G(Y)
"RTN","GMPLSAVE",255,0)
 . S GMPFDA(9000011.803,"+2,"_GMPDA_",",.01)=GMPCODE
"RTN","GMPLSAVE",256,0)
 . S GMPFDA(9000011.803,"+2,"_GMPDA_",",.02)=CODSYS
"RTN","GMPLSAVE",257,0)
 . S GMPFDA(9000011.803,"+2,"_GMPDA_",",.03)=GMPDT
"RTN","GMPLSAVE",258,0)
 . D UPDATE^DIE("E","GMPFDA")
"RTN","GMPLSAVE",259,0)
 I '$D(GMPORIG) Q
"RTN","GMPLSAVE",260,0)
 S GMPOCNT=+$P($G(GMPORIG(0)),U,4)
"RTN","GMPLSAVE",261,0)
 ; Iterate through GMPORIG and audit changes
"RTN","GMPLSAVE",262,0)
 S GMPI=0 F  S GMPI=$O(GMPORIG(GMPI)) Q:+GMPI'>0  D
"RTN","GMPLSAVE",263,0)
 . N CHANGE,OLD0,NEW0
"RTN","GMPLSAVE",264,0)
 . S OLD0=$G(GMPORIG(GMPI,0)),NEW0=$G(^AUPNPROB(GMPDA,803,GMPI,0))
"RTN","GMPLSAVE",265,0)
 . I $P(NEW0,U)=$P(OLD0,U) Q  ; no substantive change change
"RTN","GMPLSAVE",266,0)
 . I NEW0'="" S CHANGE=GMPDA_"^302^"_NOW_U_DUZ_U_$P(OLD0,U)_U_$P(NEW0,U)_"^SNOMED CT Concept re-mapped by Enterprise Terminology Service^"_+$G(GMPROV)
"RTN","GMPLSAVE",267,0)
 . E  S CHANGE=GMPDA_"^302^"_NOW_U_DUZ_U_$P(OLD0,U)_U_"^Deleted Secondary Dx for SNOMED CT Concept^"_+$G(GMPROV)
"RTN","GMPLSAVE",268,0)
 . D AUDIT^GMPLX(CHANGE,OLD0)
"RTN","GMPLSAVE",269,0)
 I GMPNCNT>GMPOCNT D
"RTN","GMPLSAVE",270,0)
 . S GMPI=GMPOCNT
"RTN","GMPLSAVE",271,0)
 . F  S GMPI=$O(^AUPNPROB(GMPDA,803,GMPI)) Q:+GMPI'>0  D
"RTN","GMPLSAVE",272,0)
 . . N NEW0,CHANGE S NEW0=$G(^AUPNPROB(GMPDA,803,GMPI,0))
"RTN","GMPLSAVE",273,0)
 . . S CHANGE=GMPDA_"^302^"_NOW_U_DUZ_U_U_$P(NEW0,U)_"^Added as Secondary Dx for SNOMED CT Concept^"_+$G(GMPROV)
"RTN","GMPLSAVE",274,0)
 . . D AUDIT^GMPLX(CHANGE,"")
"RTN","GMPLSAVE",275,0)
 Q
"RTN","GMPLSAVE",276,0)
SPRCICD(GMPICD) ; Is ICD string sparce (i.e., called from SDS API w/order > 2)?
"RTN","GMPLSAVE",277,0)
 N GMPI,GMPY S GMPY=0
"RTN","GMPLSAVE",278,0)
 F GMPI=2:1:$L(GMPICD,"/") I $S($P(GMPICD,"/",GMPI)="":1,$P(GMPICD,"/",GMPI)=$P($$NOS^GMPLX,U,2):1,1:0) S GMPY=1
"RTN","GMPLSAVE",279,0)
 Q GMPY
"RTN","GMPLSLI1")
0^18^B186261431
"RTN","GMPLSLI1",1,0)
GMPLSLI1 ;ISP/TC - Problem Selection List Import Utility ;07/31/17  13:50
"RTN","GMPLSLI1",2,0)
 ;;2.0;Problem List;**49**;Aug 25, 1994;Build 43
"RTN","GMPLSLI1",3,0)
 ;
"RTN","GMPLSLI1",4,0)
 ; External References:
"RTN","GMPLSLI1",5,0)
 ;   ICR  2053   FILE/UPDATE^DIE
"RTN","GMPLSLI1",6,0)
 ;   ICR  2320   $$PWD/$$LIST/$$FTG^%ZISH
"RTN","GMPLSLI1",7,0)
 ;   ICR  2607   BROWSE^DDBR
"RTN","GMPLSLI1",8,0)
 ;   ICR  5553   $$GETURL^XTHC10
"RTN","GMPLSLI1",9,0)
 ;   ICR  10103  $$DT^XLFDT
"RTN","GMPLSLI1",10,0)
 ;   ICR  10104  $$LJ/$$LOW/$$REPEAT^XLFSTR
"RTN","GMPLSLI1",11,0)
 ;   ICR  10026  ^DIR
"RTN","GMPLSLI1",12,0)
 ;   ICR  10142  EN^DDIOL
"RTN","GMPLSLI1",13,0)
 ;
"RTN","GMPLSLI1",14,0)
IMP ; Import categories & diagnoses into a selection list
"RTN","GMPLSLI1",15,0)
 N DIR,Y,GMPLLDOK,GMPLOPT
"RTN","GMPLSLI1",16,0)
 ;Present the menu of import choices.
"RTN","GMPLSLI1",17,0)
 S DIR(0)="S^HF:CSV host file;"
"RTN","GMPLSLI1",18,0)
 S DIR(0)=DIR(0)_"WEB:CSV file from a web site"
"RTN","GMPLSLI1",19,0)
 S DIR("A")="Select the import method"
"RTN","GMPLSLI1",20,0)
 D ^DIR
"RTN","GMPLSLI1",21,0)
 S GMPLOPT=Y
"RTN","GMPLSLI1",22,0)
 I GMPLOPT="HF" D
"RTN","GMPLSLI1",23,0)
 . S GMPLLDOK=$$LOADHF("GMPLSLIM")
"RTN","GMPLSLI1",24,0)
 . I GMPLLDOK D IMPCSV("GMPLSLIM")
"RTN","GMPLSLI1",25,0)
 I GMPLOPT="WEB" D
"RTN","GMPLSLI1",26,0)
 . S GMPLLDOK=$$LOADWEB("GMPLSLIM")
"RTN","GMPLSLI1",27,0)
 . I GMPLLDOK D IMPCSV("GMPLSLIM")
"RTN","GMPLSLI1",28,0)
 Q
"RTN","GMPLSLI1",29,0)
 ;============================================
"RTN","GMPLSLI1",30,0)
IMPCSV(GMPLNODE) ;Import comma separated data into the Problem Selection List & Category files
"RTN","GMPLSLI1",31,0)
 ; Flag indicators: '#' - Add/edit, '@' - Delete
"RTN","GMPLSLI1",32,0)
 ;
"RTN","GMPLSLI1",33,0)
 ; The expected format is:
"RTN","GMPLSLI1",34,0)
 ;     #/@, Selection List Name, List Class, Category Class
"RTN","GMPLSLI1",35,0)
 ;     #/@, Category Sequence, Category Name, Subheader
"RTN","GMPLSLI1",36,0)
 ;     #/@, Problem Sequence, Display Text, ICD code, SCT code, SCT designation
"RTN","GMPLSLI1",37,0)
 ;
"RTN","GMPLSLI1",38,0)
 I '$D(^TMP($J,GMPLNODE)) Q 0
"RTN","GMPLSLI1",39,0)
 N GMPLI,GMPLABRT,GMPLTMP,GMPLFLAG,GMPLIMPT,GMPLRNDE
"RTN","GMPLSLI1",40,0)
 S (GMPLI,GMPLABRT)=0,GMPLIMPT=1,GMPLRNDE="GMPLIRPT"
"RTN","GMPLSLI1",41,0)
 D EN^DDIOL("Starting the import process ... ","","!!")
"RTN","GMPLSLI1",42,0)
 W !
"RTN","GMPLSLI1",43,0)
 F  S GMPLI=$O(^TMP($J,GMPLNODE,GMPLI)) Q:GMPLI=""  D
"RTN","GMPLSLI1",44,0)
 . S GMPLTMP=^TMP($J,GMPLNODE,GMPLI,1)
"RTN","GMPLSLI1",45,0)
 . I '$$ISCSV^GMPLSLI2(GMPLTMP) Q
"RTN","GMPLSLI1",46,0)
 . S GMPLFLAG=$P(GMPLTMP,",",1)
"RTN","GMPLSLI1",47,0)
 . ; Retrieve/validate selection list name & class
"RTN","GMPLSLI1",48,0)
 . I GMPLI=1 D
"RTN","GMPLSLI1",49,0)
 . . S GMPLABRT=$$VALSLST(GMPLTMP,GMPLFLAG,GMPLIMPT,GMPLRNDE,GMPLABRT)
"RTN","GMPLSLI1",50,0)
 . ; Retrieve/validate category information
"RTN","GMPLSLI1",51,0)
 . I GMPLFLAG'>0,(GMPLI>1),('$L($$STRIP^XLFSTR($P(GMPLTMP,",",5),""_$C(13)_""))) D
"RTN","GMPLSLI1",52,0)
 . . S GMPLABRT=$$VALCAT(GMPLTMP,GMPLFLAG,GMPLIMPT,GMPLRNDE,GMPLABRT)
"RTN","GMPLSLI1",53,0)
 . ; Check for valid Problem sequence numbers
"RTN","GMPLSLI1",54,0)
 . I GMPLI>2,($L($$STRIP^XLFSTR($P(GMPLTMP,",",5),""_$C(13)_""))) D
"RTN","GMPLSLI1",55,0)
 . . I '+$$VSEQ^GMPLINTR(GMPLFLAG,"Problem") S GMPLABRT=1
"RTN","GMPLSLI1",56,0)
 . ; Retrieve/validate category problems
"RTN","GMPLSLI1",57,0)
 . I GMPLFLAG>0 D
"RTN","GMPLSLI1",58,0)
 . . S GMPLABRT=$$VALCPROB(GMPLTMP,GMPLRNDE,GMPLABRT)
"RTN","GMPLSLI1",59,0)
 I GMPLABRT D EN^DDIOL("Import process aborted due to validation errors.","","!!") G IMPCSVQT
"RTN","GMPLSLI1",60,0)
 D MSGHNDL(GMPLNODE,GMPLRNDE)
"RTN","GMPLSLI1",61,0)
 K ^TMP($J,GMPLNODE),^TMP($J,GMPLRNDE)
"RTN","GMPLSLI1",62,0)
IMPCSVQT W ! D PAUSE^GMPLX
"RTN","GMPLSLI1",63,0)
 Q
"RTN","GMPLSLI1",64,0)
 ;============================================
"RTN","GMPLSLI1",65,0)
LOADHF(GMPLNOUT) ;Load the CSV host file into ^TMP.
"RTN","GMPLSLI1",66,0)
 ;The name of the host file should have a ".CSV" extension.
"RTN","GMPLSLI1",67,0)
 N GMPLFILE,GMPLGBL,GMPLLHF,GMPLPATH,GMPLTMP
"RTN","GMPLSLI1",68,0)
 S GMPLTMP=$$GETEHF^GMPLUTL4("CSV")
"RTN","GMPLSLI1",69,0)
 I GMPLTMP="" Q 0
"RTN","GMPLSLI1",70,0)
 S GMPLPATH=$P(GMPLTMP,U,1),GMPLFILE=$P(GMPLTMP,U,2)
"RTN","GMPLSLI1",71,0)
 ;Load the host file into ^TMP.
"RTN","GMPLSLI1",72,0)
 K ^TMP($J,GMPLNOUT),^TMP($J,"GMPLHCSV")
"RTN","GMPLSLI1",73,0)
 S GMPLGBL="^TMP($J,""GMPLHCSV"",1)"
"RTN","GMPLSLI1",74,0)
 S GMPLGBL=$NA(@GMPLGBL)
"RTN","GMPLSLI1",75,0)
 ;Load the file contents into ^TMP.
"RTN","GMPLSLI1",76,0)
 S GMPLLHF=$$FTG^%ZISH(GMPLPATH,GMPLFILE,GMPLGBL,3)
"RTN","GMPLSLI1",77,0)
 I GMPLLHF=0 D EN^DDIOL("The host file load failed") H 2 K ^TMP($J,"GMPLHCSV") Q 0
"RTN","GMPLSLI1",78,0)
 D RBLCKHF^GMPLSLI2("GMPLHCSV",GMPLNOUT)
"RTN","GMPLSLI1",79,0)
 K ^TMP($J,"GMPLHCSV")
"RTN","GMPLSLI1",80,0)
 Q 1
"RTN","GMPLSLI1",81,0)
 ;============================================
"RTN","GMPLSLI1",82,0)
LOADWEB(GMPLNOUT) ;Load the CSV file from a web site into ^TMP
"RTN","GMPLSLI1",83,0)
 N DIR,GMPLHDR,GMPLRSLT,GMPLTXT,GMPLURL,Y
"RTN","GMPLSLI1",84,0)
 S DIR(0)="F^10:245"
"RTN","GMPLSLI1",85,0)
 S DIR("A")="Input the URL for the CSV file"
"RTN","GMPLSLI1",86,0)
 D ^DIR
"RTN","GMPLSLI1",87,0)
 I (Y="")!(Y=U) Q 0
"RTN","GMPLSLI1",88,0)
 S GMPLURL=Y
"RTN","GMPLSLI1",89,0)
 S Y=$$LOW^XLFSTR(Y)
"RTN","GMPLSLI1",90,0)
 I $E(Y,1,5)="https" D  Q 0
"RTN","GMPLSLI1",91,0)
 . D EN^DDIOL("The https protocol is not supported.")
"RTN","GMPLSLI1",92,0)
 ;Load the file contents into ^TMP.
"RTN","GMPLSLI1",93,0)
 K ^TMP($J,GMPLNOUT),^TMP($J,"GMPLWCSV")
"RTN","GMPLSLI1",94,0)
 ;DBIA #5553
"RTN","GMPLSLI1",95,0)
 S GMPLRSLT=$$GETURL^XTHC10(GMPLURL,10,"^TMP($J,""GMPLWCSV"")",.GMPLHDR)
"RTN","GMPLSLI1",96,0)
 I $P(GMPLRSLT,U,1)'=200 D  Q 0
"RTN","GMPLSLI1",97,0)
 . S GMPLTXT="Could not load the csv file: "
"RTN","GMPLSLI1",98,0)
 . S GMPLTXT=GMPLTXT_"Error "_$P(GMPLRSLT,U,1)_" "_$P(GMPLRSLT,U,2)
"RTN","GMPLSLI1",99,0)
 . D EN^DDIOL(.GMPLTXT) H 2
"RTN","GMPLSLI1",100,0)
 . K ^TMP($J,"GMPLWCSV")
"RTN","GMPLSLI1",101,0)
 D RBLCKWEB^GMPLSLI2("GMPLWCSV",GMPLNOUT)
"RTN","GMPLSLI1",102,0)
 K ^TMP($J,"GMPLWCSV")
"RTN","GMPLSLI1",103,0)
 Q 1
"RTN","GMPLSLI1",104,0)
 ;============================================
"RTN","GMPLSLI1",105,0)
MSGHNDL(GMPLNODE,GMPLRNDE) ; Message prompt and handling
"RTN","GMPLSLI1",106,0)
 N GMPLANS,GMPLSVOK,GMPLPUOK,GMPLMSG
"RTN","GMPLSLI1",107,0)
 S GMPLANS=$$ASKYN^GMPLUTL4("Y","Do you want to review the problem selection list contents")
"RTN","GMPLSLI1",108,0)
 I GMPLANS D BROWSE^DDBR("^TMP($J,"""_GMPLRNDE_""")","NR","Selection List Contents To Be Imported")
"RTN","GMPLSLI1",109,0)
 S GMPLANS=$$ASKYN^GMPLUTL4("N","Do you want to save the imported list contents")
"RTN","GMPLSLI1",110,0)
 I GMPLANS D
"RTN","GMPLSLI1",111,0)
 . S GMPLSVOK=$$UPDTCNT(GMPLNODE)
"RTN","GMPLSLI1",112,0)
 . I GMPLSVOK D
"RTN","GMPLSLI1",113,0)
 . . S GMPLPUOK=$$POSTUPDT(GMPLNODE)
"RTN","GMPLSLI1",114,0)
 . . I GMPLPUOK D EN^DDIOL("Import process completed successfully.","","!!")
"RTN","GMPLSLI1",115,0)
 . . E  D
"RTN","GMPLSLI1",116,0)
 . . . S GMPLMSG(1)="Import process partially failed due to the above errors."
"RTN","GMPLSLI1",117,0)
 . . . S GMPLMSG(1,"F")="!!"
"RTN","GMPLSLI1",118,0)
 . . . S GMPLMSG(2)="Some content may/may not have been saved completely."
"RTN","GMPLSLI1",119,0)
 . . . S GMPLMSG(3)="Verify newly imported content w/the import file, correct any errors, & re-import"
"RTN","GMPLSLI1",120,0)
 . . . D EN^DDIOL(.GMPLMSG)
"RTN","GMPLSLI1",121,0)
 E  D EN^DDIOL("Import process aborted.","","!!")
"RTN","GMPLSLI1",122,0)
 Q
"RTN","GMPLSLI1",123,0)
 ;============================================
"RTN","GMPLSLI1",124,0)
POSTUPDT(GMPLNODE) ; Save the list categories & diagnoses
"RTN","GMPLSLI1",125,0)
 N GMPLI,GMPLREC,GMPLFLAG,GMPLLNME,GMPLCCLS
"RTN","GMPLSLI1",126,0)
 N GMPLCLS,GMPLCNME,GMPLADDC,GMPLOK
"RTN","GMPLSLI1",127,0)
 S (GMPLI,GMPLADDC)=0,GMPLOK=1
"RTN","GMPLSLI1",128,0)
 F  S GMPLI=$O(^TMP($J,GMPLNODE,GMPLI)) Q:GMPLI=""  D
"RTN","GMPLSLI1",129,0)
 . S GMPLREC=^TMP($J,GMPLNODE,GMPLI,1)
"RTN","GMPLSLI1",130,0)
 . I GMPLREC="" Q
"RTN","GMPLSLI1",131,0)
 . S GMPLFLAG=$P(GMPLREC,",",1)
"RTN","GMPLSLI1",132,0)
 . I GMPLI=1 D
"RTN","GMPLSLI1",133,0)
 . . S GMPLLNME=$P(GMPLREC,",",2),GMPLCCLS=$$UP^XLFSTR($P(GMPLREC,",",4))
"RTN","GMPLSLI1",134,0)
 . . S GMPLCLS=$S(GMPLCCLS="NATIONAL":"N",GMPLCCLS="LOCAL":"L",GMPLCCLS="VISN":"V",1:"")
"RTN","GMPLSLI1",135,0)
 . ; Retrieve & save category info
"RTN","GMPLSLI1",136,0)
 . I GMPLFLAG'>0,(GMPLI>1) D  Q
"RTN","GMPLSLI1",137,0)
 . . S GMPLCNME=$$UP^XLFSTR($P(GMPLREC,",",3)),GMPLADDC=$S(GMPLFLAG="#":1,1:0)
"RTN","GMPLSLI1",138,0)
 . . S GMPLOK=$$SVC12511(GMPLREC,GMPLFLAG,GMPLCLS,GMPLCCLS,GMPLOK)
"RTN","GMPLSLI1",139,0)
 . . I GMPLOK S GMPLOK=$$SVC12501(GMPLREC,GMPLFLAG,GMPLLNME,GMPLOK)
"RTN","GMPLSLI1",140,0)
 . ; Retrieve & save category problems
"RTN","GMPLSLI1",141,0)
 . I GMPLADDC,(GMPLFLAG>0) D
"RTN","GMPLSLI1",142,0)
 . . S GMPLOK=$$SVPROB(GMPLREC,GMPLCNME,GMPLOK)
"RTN","GMPLSLI1",143,0)
 I $D(^GMPL(125.11,0)) S $P(^GMPL(125.11,0),U,3)=0
"RTN","GMPLSLI1",144,0)
 K ^GMPLCIEN(1),^GMPLINRT(1)
"RTN","GMPLSLI1",145,0)
 Q GMPLOK
"RTN","GMPLSLI1",146,0)
 ;============================================
"RTN","GMPLSLI1",147,0)
SVC12501(GMPLREC,GMPLFLAG,GMPLLNME,GMPLOK) ; Save category info into subfile 125.01
"RTN","GMPLSLI1",148,0)
 N GMPLLIEN,GMPLDA,GMPLKFDA,GMPLFDA,GMPLIENS
"RTN","GMPLSLI1",149,0)
 N GMPLCSEQ,GMPLCNME,GMPLSHDR,GMPLMSG,GMPLTXT
"RTN","GMPLSLI1",150,0)
 S GMPLCSEQ=$P(GMPLREC,",",2),GMPLCNME=$$UP^XLFSTR($P(GMPLREC,",",3))
"RTN","GMPLSLI1",151,0)
 S GMPLSHDR=$P(GMPLREC,",",4)
"RTN","GMPLSLI1",152,0)
 S GMPLLIEN=+$$FIND1^DIC(125,"","K",GMPLLNME,"","","GMPLMSG")
"RTN","GMPLSLI1",153,0)
 I GMPLFLAG="@",(GMPLLIEN>0) D  G SVCQT
"RTN","GMPLSLI1",154,0)
 . S GMPLDA=+$$FIND1^DIC(125.01,","_GMPLLIEN_",","K",GMPLCNME,"","","GMPLMSG")
"RTN","GMPLSLI1",155,0)
 . I GMPLDA>0 D
"RTN","GMPLSLI1",156,0)
 . . S GMPLKFDA(125.01,""_GMPLDA_","_GMPLLIEN_",",.01)="@"
"RTN","GMPLSLI1",157,0)
 . . D FILE^DIE("K","GMPLKFDA","GMPLMSG")
"RTN","GMPLSLI1",158,0)
 I GMPLFLAG="@" G SVCQT
"RTN","GMPLSLI1",159,0)
 S GMPLIENS=$S(GMPLLIEN>0:"+2,"_GMPLLIEN_",",1:"+2,+1,")
"RTN","GMPLSLI1",160,0)
 S GMPLFDA(125.01,GMPLIENS,.01)=GMPLCNME
"RTN","GMPLSLI1",161,0)
 S GMPLFDA(125.01,GMPLIENS,.02)=GMPLCSEQ
"RTN","GMPLSLI1",162,0)
 S GMPLFDA(125.01,GMPLIENS,.03)=GMPLSHDR
"RTN","GMPLSLI1",163,0)
 S GMPLFDA(125.01,GMPLIENS,.04)="YES"
"RTN","GMPLSLI1",164,0)
 D UPDATE^DIE("E","GMPLFDA","","GMPLMSG")
"RTN","GMPLSLI1",165,0)
SVCQT I $D(GMPLMSG) D
"RTN","GMPLSLI1",166,0)
 . S GMPLTXT(1)="Unable to "_$S(GMPLFLAG="@":"delete",1:"store")
"RTN","GMPLSLI1",167,0)
 . S GMPLTXT(1)=GMPLTXT(1)_" category "_GMPLCNME_" under list "_GMPLLNME
"RTN","GMPLSLI1",168,0)
 . S GMPLTXT(2)="Error "_GMPLMSG("DIERR",1)_": "_GMPLMSG("DIERR",1,"TEXT",1)
"RTN","GMPLSLI1",169,0)
 . D EN^DDIOL(.GMPLTXT) S GMPLOK=0
"RTN","GMPLSLI1",170,0)
 Q GMPLOK
"RTN","GMPLSLI1",171,0)
 ;============================================
"RTN","GMPLSLI1",172,0)
SVC12511(GMPLREC,GMPLFLAG,GMPLCLS,GMPLCCLS,GMPLOK) ; Save category info into file 125.11
"RTN","GMPLSLI1",173,0)
 N GMPLCSEQ,GMPLCNME,GMPLSHDR,GMPLKFDA
"RTN","GMPLSLI1",174,0)
 N GMPLMSG,GMPLFDA,GMPLTXT
"RTN","GMPLSLI1",175,0)
 K ^GMPLCIEN(1),^GMPLINRT(1)
"RTN","GMPLSLI1",176,0)
 S GMPLCSEQ=$P(GMPLREC,",",2),GMPLCNME=$$UP^XLFSTR($P(GMPLREC,",",3))
"RTN","GMPLSLI1",177,0)
 S GMPLSHDR=$P(GMPLREC,",",4)
"RTN","GMPLSLI1",178,0)
 ;If there are any existing entries for this category,
"RTN","GMPLSLI1",179,0)
 ;delete them prior to storing the new set.
"RTN","GMPLSLI1",180,0)
 S ^GMPLCIEN(1)=+$$FIND1^DIC(125.11,"","K",GMPLCNME,"","","GMPLMSG")
"RTN","GMPLSLI1",181,0)
 I $G(^GMPLCIEN(1))>0 D
"RTN","GMPLSLI1",182,0)
 . S ^GMPLINRT(1)=^GMPLCIEN(1)
"RTN","GMPLSLI1",183,0)
 . S GMPLKFDA(125.11,""_$G(^GMPLCIEN(1))_",",.01)="@"
"RTN","GMPLSLI1",184,0)
 . D FILE^DIE("K","GMPLKFDA","GMPLMSG")
"RTN","GMPLSLI1",185,0)
 E  S ^GMPLINRT(1)=""
"RTN","GMPLSLI1",186,0)
 I GMPLFLAG="@" G SVCQT1
"RTN","GMPLSLI1",187,0)
 S GMPLFDA(125.11,"+1,",.01)=GMPLCNME
"RTN","GMPLSLI1",188,0)
 S GMPLFDA(125.11,"+1,",.02)=$$DT^XLFDT
"RTN","GMPLSLI1",189,0)
 S GMPLFDA(125.11,"+1,",.03)=GMPLCLS
"RTN","GMPLSLI1",190,0)
 D UPDATE^DIE("","GMPLFDA","^GMPLINRT","GMPLMSG")
"RTN","GMPLSLI1",191,0)
SVCQT1 I $D(GMPLMSG) D  Q
"RTN","GMPLSLI1",192,0)
 . S GMPLTXT(1)="Unable to "_$S(GMPLFLAG="@":"delete",1:"store")
"RTN","GMPLSLI1",193,0)
 . S GMPLTXT(1)=GMPLTXT(1)_" category "_GMPLCNME_" and class "_GMPLCCLS_" in file #125.11."
"RTN","GMPLSLI1",194,0)
 . S GMPLTXT(2)="Error "_GMPLMSG("DIERR",1)_": "_GMPLMSG("DIERR",1,"TEXT",1)
"RTN","GMPLSLI1",195,0)
 . D EN^DDIOL(.GMPLTXT) S GMPLOK=0
"RTN","GMPLSLI1",196,0)
 Q GMPLOK
"RTN","GMPLSLI1",197,0)
 ;============================================
"RTN","GMPLSLI1",198,0)
SVPROB(GMPLREC,GMPLCNME,GMPLOK) ; Save category problems into subfile 125.11
"RTN","GMPLSLI1",199,0)
 N GMPLDTXT,GMPLPSEQ,GMPLICD,GMPLSCTC,GMPLSCTD
"RTN","GMPLSLI1",200,0)
 N GMPLLTRM,GMPLMSG,GMPLTXT,GMPLISTR,GMPLFDA
"RTN","GMPLSLI1",201,0)
 I $L(GMPLREC,",")>5 D
"RTN","GMPLSLI1",202,0)
 . N GMPLTPC,GMPLDPC,GMPLK
"RTN","GMPLSLI1",203,0)
 . S GMPLTPC=$L(GMPLREC,","),GMPLDPC=GMPLTPC-4,GMPLDTXT=""
"RTN","GMPLSLI1",204,0)
 . F GMPLK=2:1:(GMPLDPC+1) S GMPLDTXT=GMPLDTXT_$S(GMPLK>2:",",1:"")_$P(GMPLREC,",",GMPLK)
"RTN","GMPLSLI1",205,0)
 . S GMPLPSEQ=$$STRIP^XLFSTR($P(GMPLREC,",",1)," "),GMPLDTXT=$$STRIP^XLFSTR(GMPLDTXT,"""")
"RTN","GMPLSLI1",206,0)
 . S GMPLICD=$$STRIP^XLFSTR($P(GMPLREC,",",(GMPLDPC+2))," ")
"RTN","GMPLSLI1",207,0)
 . S GMPLSCTC=$$STRIP^XLFSTR($$STRIP^XLFSTR($P(GMPLREC,",",(GMPLDPC+3)),"C")," ")
"RTN","GMPLSLI1",208,0)
 . S GMPLSCTD=$$STRIP^XLFSTR($$STRIP^XLFSTR($P($P(GMPLREC,",",(GMPLDPC+4)),""_$C(13)_""),"D")," ")
"RTN","GMPLSLI1",209,0)
 E  D
"RTN","GMPLSLI1",210,0)
 . S GMPLPSEQ=$$STRIP^XLFSTR($P(GMPLREC,",",1)," "),GMPLDTXT=$$STRIP^XLFSTR($P(GMPLREC,",",2),"""")
"RTN","GMPLSLI1",211,0)
 . S GMPLICD=$$STRIP^XLFSTR($P(GMPLREC,",",3)," "),GMPLSCTC=$$STRIP^XLFSTR($$STRIP^XLFSTR($P(GMPLREC,",",4),"C")," ")
"RTN","GMPLSLI1",212,0)
 . S GMPLSCTD=$$STRIP^XLFSTR($$STRIP^XLFSTR($P($P(GMPLREC,",",5),""_$C(13)_""),"D")," ")
"RTN","GMPLSLI1",213,0)
 S GMPLLTRM=$$GETEXIEN^GMPLX(GMPLSCTC,GMPLSCTD)
"RTN","GMPLSLI1",214,0)
 I GMPLDTXT["sct" S GMPLDTXT=$P(GMPLDTXT,"(")_"("_$$UP^XLFSTR($P($P(GMPLDTXT,"(",2)," "))_" "_$P($P(GMPLDTXT,"(",2)," ",2)
"RTN","GMPLSLI1",215,0)
 I GMPLDTXT'["SCT" S GMPLDTXT=GMPLDTXT_" (SCT "_GMPLSCTC_")"
"RTN","GMPLSLI1",216,0)
 I +GMPLLTRM<0 D  Q
"RTN","GMPLSLI1",217,0)
 . S GMPLTXT(1)="Unable to save "_GMPLDTXT
"RTN","GMPLSLI1",218,0)
 . S GMPLTXT(2)="Error: "_$P(GMPLLTRM,U,2)
"RTN","GMPLSLI1",219,0)
 . D EN^DDIOL(.GMPLTXT) S GMPLOK=0
"RTN","GMPLSLI1",220,0)
 S GMPLISTR=$S(^GMPLCIEN(1)>0:"+2,"_^GMPLCIEN(1)_",",1:"+2,"_^GMPLINRT(1)_",")
"RTN","GMPLSLI1",221,0)
 S GMPLFDA(125.111,GMPLISTR,.01)=GMPLLTRM
"RTN","GMPLSLI1",222,0)
 S GMPLFDA(125.111,GMPLISTR,.02)=GMPLPSEQ
"RTN","GMPLSLI1",223,0)
 S GMPLFDA(125.111,GMPLISTR,.03)=GMPLDTXT
"RTN","GMPLSLI1",224,0)
 S GMPLFDA(125.111,GMPLISTR,.04)=GMPLICD
"RTN","GMPLSLI1",225,0)
 S GMPLFDA(125.111,GMPLISTR,.05)=GMPLSCTC
"RTN","GMPLSLI1",226,0)
 S GMPLFDA(125.111,GMPLISTR,.06)=GMPLSCTD
"RTN","GMPLSLI1",227,0)
 D UPDATE^DIE("","GMPLFDA","","GMPLMSG")
"RTN","GMPLSLI1",228,0)
 I $D(GMPLMSG) D
"RTN","GMPLSLI1",229,0)
 . S GMPLTXT(1)="Unable to store problem: "_GMPLDTXT_" from category "_GMPLCNME_"."
"RTN","GMPLSLI1",230,0)
 . S GMPLTXT(2)="Error "_GMPLMSG("DIERR",1)_": "_GMPLMSG("DIERR",1,"TEXT",1)
"RTN","GMPLSLI1",231,0)
 . D EN^DDIOL(.GMPLTXT) S GMPLOK=0
"RTN","GMPLSLI1",232,0)
 Q GMPLOK
"RTN","GMPLSLI1",233,0)
 ;============================================
"RTN","GMPLSLI1",234,0)
UPDTCNT(GMPLNODE) ; Save/delete the list name & class
"RTN","GMPLSLI1",235,0)
 ; Flag indicators: # - Add/edit list, @ - Delete list
"RTN","GMPLSLI1",236,0)
 N GMPLLST,GMPLFDA,GMPLMSG,GMPLLNME,GMPLLCLS,GMPLCLS
"RTN","GMPLSLI1",237,0)
 N GMPLSUC,GMPLTXT,GMPLIEN,GMPLINRT,GMPLFLAG
"RTN","GMPLSLI1",238,0)
 S GMPLSUC=1
"RTN","GMPLSLI1",239,0)
 S GMPLLST=^TMP($J,GMPLNODE,1,1)
"RTN","GMPLSLI1",240,0)
 S GMPLFLAG=$P(GMPLLST,",",1)
"RTN","GMPLSLI1",241,0)
 S GMPLLNME=$$UP^XLFSTR($P(GMPLLST,",",2))
"RTN","GMPLSLI1",242,0)
 S GMPLLCLS=$$UP^XLFSTR($P(GMPLLST,",",3))
"RTN","GMPLSLI1",243,0)
 S GMPLCLS=$S(GMPLLCLS="NATIONAL":"N",GMPLLCLS="LOCAL":"L",GMPLLCLS="VISN":"V",1:"")
"RTN","GMPLSLI1",244,0)
 S GMPLIEN=+$$FIND1^DIC(125,"","K",GMPLLNME,"","","GMPLMSG")
"RTN","GMPLSLI1",245,0)
 I GMPLIEN>0 D
"RTN","GMPLSLI1",246,0)
 . S GMPLINRT(1)=GMPLIEN
"RTN","GMPLSLI1",247,0)
 . S GMPLFDA(125,""_GMPLIEN_",",.01)="@"
"RTN","GMPLSLI1",248,0)
 . D FILE^DIE("K","GMPLFDA","GMPLMSG")
"RTN","GMPLSLI1",249,0)
 I GMPLFLAG="@" G UPQT
"RTN","GMPLSLI1",250,0)
 S GMPLFDA(125,"+1,",.01)=GMPLLNME
"RTN","GMPLSLI1",251,0)
 S GMPLFDA(125,"+1,",.02)=$$DT^XLFDT
"RTN","GMPLSLI1",252,0)
 S GMPLFDA(125,"+1,",.04)=GMPLCLS
"RTN","GMPLSLI1",253,0)
 D UPDATE^DIE("","GMPLFDA","GMPLINRT","GMPLMSG")
"RTN","GMPLSLI1",254,0)
UPQT I $D(GMPLMSG) D
"RTN","GMPLSLI1",255,0)
 . S GMPLTXT(1)="Unable to "_$S(GMPLFLAG="@":"delete",1:"store")
"RTN","GMPLSLI1",256,0)
 . S GMPLTXT(1)=GMPLTXT(1)_" list "_GMPLLNME_" and class "_GMPLLCLS_" in file #125."
"RTN","GMPLSLI1",257,0)
 . S GMPLTXT(2)="Error: "_GMPLMSG("DIERR",1,"TEXT",1)
"RTN","GMPLSLI1",258,0)
 . D EN^DDIOL(.GMPLTXT)
"RTN","GMPLSLI1",259,0)
 . S GMPLSUC=0
"RTN","GMPLSLI1",260,0)
 ;Reset the 125 0 node so holes are not left.
"RTN","GMPLSLI1",261,0)
 I $D(^GMPL(125,0)) S $P(^GMPL(125,0),U,3)=0
"RTN","GMPLSLI1",262,0)
 Q GMPLSUC
"RTN","GMPLSLI1",263,0)
 ;============================================
"RTN","GMPLSLI1",264,0)
VALCAT(GMPLTMP,GMPLFLAG,GMPLIMPT,GMPLRNDE,GMPLABRT) ; Validate category info
"RTN","GMPLSLI1",265,0)
 N GMPLCSEQ,GMPLCNME,GMPLSHDR,GMPLHSTR,GMPLSQST,GMPLNL
"RTN","GMPLSLI1",266,0)
 S GMPLCSEQ=$P(GMPLTMP,",",2),GMPLCNME=$P(GMPLTMP,",",3)
"RTN","GMPLSLI1",267,0)
 S GMPLSHDR=$P(GMPLTMP,",",4),GMPLHSTR="Subheader: "_GMPLSHDR
"RTN","GMPLSLI1",268,0)
 S GMPLNL=$G(^TMP($J,GMPLRNDE))
"RTN","GMPLSLI1",269,0)
 I '+$$VFLAG^GMPLINTR(GMPLFLAG) S GMPLABRT=1
"RTN","GMPLSLI1",270,0)
 I '+$$VSEQ^GMPLINTR(GMPLCSEQ,"Category") S GMPLABRT=1
"RTN","GMPLSLI1",271,0)
 E  S GMPLSQST="Category Sequence: "_GMPLCSEQ
"RTN","GMPLSLI1",272,0)
 I '+$$VNAME^GMPLINTR(GMPLCNME,GMPLIMPT,"Category") D
"RTN","GMPLSLI1",273,0)
 . D EN^DDIOL(" For category sequence #"_GMPLCSEQ_".")
"RTN","GMPLSLI1",274,0)
 . S GMPLABRT=1
"RTN","GMPLSLI1",275,0)
 I 'GMPLABRT D
"RTN","GMPLSLI1",276,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)=""
"RTN","GMPLSLI1",277,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)="Category Name: "_GMPLCNME_$S(GMPLFLAG="@":"      ***MARKED FOR DELETION!!!***",1:"")
"RTN","GMPLSLI1",278,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)=$$LJ^XLFSTR(GMPLHSTR,47)_$$LJ^XLFSTR(GMPLSQST,33)
"RTN","GMPLSLI1",279,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)=""
"RTN","GMPLSLI1",280,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)="Prob"_$J("SNOMED CT",10)_$J("SNOMED CT",21)
"RTN","GMPLSLI1",281,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)="Seq"_$J("Concept",9)_$J("Designation",25)_$J("ICD Code",18)_$J("SNOMED CT Description",42)
"RTN","GMPLSLI1",282,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)=$$REPEAT^XLFSTR("-",150)
"RTN","GMPLSLI1",283,0)
 S ^TMP($J,GMPLRNDE)=GMPLNL
"RTN","GMPLSLI1",284,0)
 Q GMPLABRT
"RTN","GMPLSLI1",285,0)
 ;============================================
"RTN","GMPLSLI1",286,0)
VALCPROB(GMPLTMP,GMPLRNDE,GMPLABRT) ; Validate category problems
"RTN","GMPLSLI1",287,0)
 N GMPLPSEQ,GMPLDTXT,GMPLICD,GMPLSCTC,GMPLSCTD,GMPLNL
"RTN","GMPLSLI1",288,0)
 S GMPLNL=$G(^TMP($J,GMPLRNDE))
"RTN","GMPLSLI1",289,0)
 I $L(GMPLTMP,",")>5 D
"RTN","GMPLSLI1",290,0)
 . N GMPLTPC,GMPLDPC,GMPLK
"RTN","GMPLSLI1",291,0)
 . S GMPLTPC=$L(GMPLTMP,","),GMPLDPC=GMPLTPC-4,GMPLDTXT=""
"RTN","GMPLSLI1",292,0)
 . F GMPLK=2:1:(GMPLDPC+1) S GMPLDTXT=GMPLDTXT_$S(GMPLK>2:",",1:"")_$P(GMPLTMP,",",GMPLK)
"RTN","GMPLSLI1",293,0)
 . S GMPLPSEQ=$$STRIP^XLFSTR($P(GMPLTMP,",",1)," "),GMPLDTXT=$$STRIP^XLFSTR(GMPLDTXT,"""")
"RTN","GMPLSLI1",294,0)
 . S GMPLICD=$$STRIP^XLFSTR($P(GMPLTMP,",",(GMPLDPC+2))," ")
"RTN","GMPLSLI1",295,0)
 . S GMPLSCTC=$$STRIP^XLFSTR($$STRIP^XLFSTR($P(GMPLTMP,",",(GMPLDPC+3)),"C")," ")
"RTN","GMPLSLI1",296,0)
 . S GMPLSCTD=$$STRIP^XLFSTR($$STRIP^XLFSTR($P($P(GMPLTMP,",",(GMPLDPC+4)),""_$C(13)_""),"D")," ")
"RTN","GMPLSLI1",297,0)
 E  D
"RTN","GMPLSLI1",298,0)
 . S GMPLPSEQ=$$STRIP^XLFSTR($P(GMPLTMP,",",1)," "),GMPLDTXT=$$STRIP^XLFSTR($P(GMPLTMP,",",2),"""")
"RTN","GMPLSLI1",299,0)
 . S GMPLICD=$$STRIP^XLFSTR($P(GMPLTMP,",",3)," "),GMPLSCTC=$$STRIP^XLFSTR($$STRIP^XLFSTR($P(GMPLTMP,",",4),"C")," ")
"RTN","GMPLSLI1",300,0)
 . S GMPLSCTD=$$STRIP^XLFSTR($$STRIP^XLFSTR($P($P(GMPLTMP,",",5),""_$C(13)_""),"D")," ")
"RTN","GMPLSLI1",301,0)
 I GMPLDTXT["sct" S GMPLDTXT=$P(GMPLDTXT,"(")_"("_$$UP^XLFSTR($P($P(GMPLDTXT,"(",2)," "))_" "_$P($P(GMPLDTXT,"(",2)," ",2)
"RTN","GMPLSLI1",302,0)
 I GMPLDTXT'["SCT" S GMPLDTXT=GMPLDTXT_" (SCT "_GMPLSCTC_")"
"RTN","GMPLSLI1",303,0)
 I '+$$VICD^GMPLINTR(GMPLICD) S GMPLABRT=1
"RTN","GMPLSLI1",304,0)
 I '+$$VSCTCODE^GMPLINTR(GMPLSCTC) S GMPLABRT=1 Q GMPLABRT
"RTN","GMPLSLI1",305,0)
 I '+$$VSCTDSGN^GMPLINTR(GMPLSCTC,GMPLSCTD,$P(GMPLDTXT," (SCT")) S GMPLABRT=1
"RTN","GMPLSLI1",306,0)
 I 'GMPLABRT D
"RTN","GMPLSLI1",307,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)=$$LJ^XLFSTR(GMPLPSEQ,5)_$$LJ^XLFSTR(GMPLSCTC,21)_$$LJ^XLFSTR(GMPLSCTD,21)_$$LJ^XLFSTR(GMPLICD,29)_$$LJ^XLFSTR(GMPLDTXT,80)
"RTN","GMPLSLI1",308,0)
 S ^TMP($J,GMPLRNDE)=GMPLNL
"RTN","GMPLSLI1",309,0)
 Q GMPLABRT
"RTN","GMPLSLI1",310,0)
 ;============================================
"RTN","GMPLSLI1",311,0)
VALSLST(GMPLTMP,GMPLFLAG,GMPLIMPT,GMPLRNDE,GMPLABRT) ; Validate selection list & class
"RTN","GMPLSLI1",312,0)
 N GMPLLNME,GMPLLCLS,GMPLCCLS,GMPLNL
"RTN","GMPLSLI1",313,0)
 S GMPLLNME=$P(GMPLTMP,",",2),GMPLLCLS=$P(GMPLTMP,",",3)
"RTN","GMPLSLI1",314,0)
 S GMPLCCLS=$P(GMPLTMP,",",4),GMPLNL=0
"RTN","GMPLSLI1",315,0)
 K ^TMP($J,GMPLRNDE)
"RTN","GMPLSLI1",316,0)
 I GMPLFLAG="@" S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)="***MARKED FOR DELETION!!!***"
"RTN","GMPLSLI1",317,0)
 I '+$$VFLAG^GMPLINTR(GMPLFLAG) S GMPLABRT=1
"RTN","GMPLSLI1",318,0)
 I '+$$VNAME^GMPLINTR(GMPLLNME,GMPLIMPT,"List") S GMPLABRT=1
"RTN","GMPLSLI1",319,0)
 I '+$$VCLASS^GMPLINTR(GMPLLCLS,GMPLIMPT,"List") S GMPLABRT=1
"RTN","GMPLSLI1",320,0)
 I '+$$VCLASS^GMPLINTR(GMPLCCLS,GMPLIMPT,"Category") S GMPLABRT=1
"RTN","GMPLSLI1",321,0)
 I 'GMPLABRT D
"RTN","GMPLSLI1",322,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)="Selection List Name: "_GMPLLNME
"RTN","GMPLSLI1",323,0)
 . S GMPLNL=GMPLNL+1,^TMP($J,GMPLRNDE,GMPLNL)="List Class: "_GMPLLCLS_$J("Category Class: ",34)_GMPLCCLS
"RTN","GMPLSLI1",324,0)
 S ^TMP($J,GMPLRNDE)=GMPLNL
"RTN","GMPLSLI1",325,0)
 Q GMPLABRT
"RTN","GMPLSLI2")
0^19^B11257875
"RTN","GMPLSLI2",1,0)
GMPLSLI2 ;ISP/TC - Problem Selection List Import Utility ;07/18/17  09:43
"RTN","GMPLSLI2",2,0)
 ;;2.0;Problem List;**49**;Aug 25, 1994;Build 43
"RTN","GMPLSLI2",3,0)
 ;
"RTN","GMPLSLI2",4,0)
 ; External References:
"RTN","GMPLSLI2",5,0)
 ;   ICR  10142  EN^DDIOL
"RTN","GMPLSLI2",6,0)
 ;
"RTN","GMPLSLI2",7,0)
ISCSV(GMPLLINE) ;Verify that LINE is in CSV format with at least 3 pieces of data
"RTN","GMPLSLI2",8,0)
 I $L(GMPLLINE)=0 Q 0
"RTN","GMPLSLI2",9,0)
 N GMPLCSV
"RTN","GMPLSLI2",10,0)
 S GMPLCSV=$S($L(GMPLLINE,",")>2:1,1:0)
"RTN","GMPLSLI2",11,0)
 I 'GMPLCSV D
"RTN","GMPLSLI2",12,0)
 . N GMPLTXT
"RTN","GMPLSLI2",13,0)
 . S GMPLTXT(1)=""
"RTN","GMPLSLI2",14,0)
 . S GMPLTXT(2)="The following line is not in CSV format and cannot be processed:"
"RTN","GMPLSLI2",15,0)
 . S GMPLTXT(3)=" "_GMPLLINE
"RTN","GMPLSLI2",16,0)
 . D EN^DDIOL(.GMPLTXT)
"RTN","GMPLSLI2",17,0)
 . H 1
"RTN","GMPLSLI2",18,0)
 Q GMPLCSV
"RTN","GMPLSLI2",19,0)
 ;============================================
"RTN","GMPLSLI2",20,0)
RBLCKHF(GMPLNIN,GMPLNOUT) ;FTG^%ZISH breaks lines at 255 characters. This could
"RTN","GMPLSLI2",21,0)
 ;put a mapping across two lines. Format the ^TMP array so this does not
"RTN","GMPLSLI2",22,0)
 ;happen.
"RTN","GMPLSLI2",23,0)
 N GMPLCHAR,GMPLI,GMPLJ,GMPLK,GMPLL1,GMPLNL1,GMPLNL2,GMPLTMP
"RTN","GMPLSLI2",24,0)
 K ^TMP($J,"GMPLNOUT")
"RTN","GMPLSLI2",25,0)
 S GMPLI="",GMPLNL1=0
"RTN","GMPLSLI2",26,0)
 F  S GMPLI=+$O(^TMP($J,GMPLNIN,GMPLI)) Q:GMPLI=0  D
"RTN","GMPLSLI2",27,0)
 . S GMPLTMP=^TMP($J,GMPLNIN,GMPLI),GMPLNL1=GMPLNL1+1
"RTN","GMPLSLI2",28,0)
 . I '$D(^TMP($J,GMPLNIN,GMPLI,"OVF")) S ^TMP($J,GMPLNOUT,GMPLNL1,1)=GMPLTMP Q
"RTN","GMPLSLI2",29,0)
 . S GMPLL1="",GMPLNL2=0
"RTN","GMPLSLI2",30,0)
 . F GMPLJ=1:1:$L(GMPLTMP) D
"RTN","GMPLSLI2",31,0)
 .. S GMPLCHAR=$E(GMPLTMP,GMPLJ)
"RTN","GMPLSLI2",32,0)
 .. S GMPLL1=GMPLL1_GMPLCHAR
"RTN","GMPLSLI2",33,0)
 .. I $L(GMPLL1)>230,GMPLCHAR="," S GMPLNL2=GMPLNL2+1,^TMP($J,GMPLNOUT,GMPLNL1,GMPLNL2)=GMPLL1,GMPLL1=""
"RTN","GMPLSLI2",34,0)
 .;Check for overflow nodes.
"RTN","GMPLSLI2",35,0)
 . S GMPLJ=0
"RTN","GMPLSLI2",36,0)
 . F  S GMPLJ=+$O(^TMP($J,GMPLNIN,GMPLI,"OVF",GMPLJ)) Q:GMPLJ=0  D
"RTN","GMPLSLI2",37,0)
 .. S GMPLTMP=^TMP($J,GMPLNIN,GMPLI,"OVF",GMPLJ)
"RTN","GMPLSLI2",38,0)
 .. F GMPLK=1:1:$L(GMPLTMP) D
"RTN","GMPLSLI2",39,0)
 ... S GMPLCHAR=$E(GMPLTMP,GMPLK)
"RTN","GMPLSLI2",40,0)
 ... S GMPLL1=GMPLL1_GMPLCHAR
"RTN","GMPLSLI2",41,0)
 ... I $L(GMPLL1)>230,GMPLCHAR="," S GMPLNL2=GMPLNL2+1,^TMP($J,GMPLNOUT,GMPLNL1,GMPLNL2)=GMPLL1,GMPLL1=""
"RTN","GMPLSLI2",42,0)
 . I $L(GMPLL1)>0 S GMPLNL2=GMPLNL2+1,^TMP($J,GMPLNOUT,GMPLNL1,GMPLNL2)=GMPLL1
"RTN","GMPLSLI2",43,0)
 Q
"RTN","GMPLSLI2",44,0)
 ;============================================
"RTN","GMPLSLI2",45,0)
RBLCKWEB(GMPLNIN,GMPLNOUT) ;GETURL^XTHC10 breaks lines at 245 characters. This
"RTN","GMPLSLI2",46,0)
 ;could break a line into two lines. Format the ^TMP array so this does
"RTN","GMPLSLI2",47,0)
 ;not happen.
"RTN","GMPLSLI2",48,0)
 N GMPLCHAR,GMPLI,GMPLJ,GMPLK,GMPLL1,GMPLLEN,GMPLNL1,GMPLNL2,GMPLTMP
"RTN","GMPLSLI2",49,0)
 K ^TMP($J,"GMPLNOUT")
"RTN","GMPLSLI2",50,0)
 S GMPLI="",GMPLNL1=0
"RTN","GMPLSLI2",51,0)
 F  S GMPLI=+$O(^TMP($J,GMPLNIN,GMPLI)) Q:GMPLI=0  D
"RTN","GMPLSLI2",52,0)
 . S GMPLTMP=^TMP($J,GMPLNIN,GMPLI),GMPLLEN=$L(GMPLTMP)
"RTN","GMPLSLI2",53,0)
 . I GMPLLEN=0 S GMPLNL1=GMPLNL1+1,^TMP($J,GMPLNOUT,GMPLNL1,1)=GMPLTMP Q
"RTN","GMPLSLI2",54,0)
 . S GMPLNL1=GMPLNL1+1
"RTN","GMPLSLI2",55,0)
 . I $D(^TMP($J,GMPLNIN,GMPLI))<11 S ^TMP($J,GMPLNOUT,GMPLNL1,1)=$TR(GMPLTMP,$C(13),"") Q
"RTN","GMPLSLI2",56,0)
 . S GMPLL1="",GMPLNL2=0
"RTN","GMPLSLI2",57,0)
 . F GMPLJ=1:1:$L(GMPLTMP) D
"RTN","GMPLSLI2",58,0)
 .. S GMPLCHAR=$E(GMPLTMP,GMPLJ)
"RTN","GMPLSLI2",59,0)
 .. I GMPLCHAR=$C(13) Q
"RTN","GMPLSLI2",60,0)
 .. S GMPLL1=GMPLL1_GMPLCHAR
"RTN","GMPLSLI2",61,0)
 .. I $L(GMPLL1)>230,GMPLCHAR="," S GMPLNL2=GMPLNL2+1,^TMP($J,GMPLNOUT,GMPLNL1,GMPLNL2)=GMPLL1,GMPLL1=""
"RTN","GMPLSLI2",62,0)
 .;Check for overflow nodes.
"RTN","GMPLSLI2",63,0)
 . S GMPLJ=0
"RTN","GMPLSLI2",64,0)
 . F  S GMPLJ=+$O(^TMP($J,GMPLNIN,GMPLI,GMPLJ)) Q:GMPLJ=0  D
"RTN","GMPLSLI2",65,0)
 .. S GMPLTMP=^TMP($J,GMPLNIN,GMPLI,GMPLJ)
"RTN","GMPLSLI2",66,0)
 .. F GMPLK=1:1:$L(GMPLTMP) D
"RTN","GMPLSLI2",67,0)
 ... S GMPLCHAR=$E(GMPLTMP,GMPLK)
"RTN","GMPLSLI2",68,0)
 ... I GMPLCHAR=$C(13) Q
"RTN","GMPLSLI2",69,0)
 ... S GMPLL1=GMPLL1_GMPLCHAR
"RTN","GMPLSLI2",70,0)
 ... I $L(GMPLL1)>230,GMPLCHAR="," S GMPLNL2=GMPLNL2+1,^TMP($J,GMPLNOUT,GMPLNL1,GMPLNL2)=GMPLL1,GMPLL1=""
"RTN","GMPLSLI2",71,0)
 . I $L(GMPLL1)>0 S GMPLNL2=GMPLNL2+1,^TMP($J,GMPLNOUT,GMPLNL1,GMPLNL2)=GMPLL1
"RTN","GMPLSLI2",72,0)
 Q
"RTN","GMPLSLRP")
0^17^B3033052
"RTN","GMPLSLRP",1,0)
GMPLSLRP ;ISP/TC - Problem Selection List Reports ;08/22/17  06:38
"RTN","GMPLSLRP",2,0)
 ;;2.0;Problem List;**49**;Aug 25, 1994;Build 43
"RTN","GMPLSLRP",3,0)
 ;
"RTN","GMPLSLRP",4,0)
 ; External References:
"RTN","GMPLSLRP",5,0)
 ;   ICR  2056   $$GET1^DIQ
"RTN","GMPLSLRP",6,0)
 ;   ICR  10026  ^DIR
"RTN","GMPLSLRP",7,0)
 ;   ICR  10060  ^VA(200,"B"
"RTN","GMPLSLRP",8,0)
 ;   ICR  10104  $$REPEAT^XLFSTR
"RTN","GMPLSLRP",9,0)
 ;
"RTN","GMPLSLRP",10,0)
GETUSRLT(GMPLULST,GMPLELST) ; Retrieve pre-existing user problem selection lists
"RTN","GMPLSLRP",11,0)
 N GMPLUSR,GMPLDUZ,GMPLLNME,GMPLUSNM,GMPLST
"RTN","GMPLSLRP",12,0)
 S (GMPLUSR,GMPLDUZ)=""
"RTN","GMPLSLRP",13,0)
 F  S GMPLUSR=$O(^VA(200,"B",GMPLUSR)) Q:GMPLUSR=""  D
"RTN","GMPLSLRP",14,0)
 . F  S GMPLDUZ=$O(^VA(200,"B",GMPLUSR,GMPLDUZ)) Q:GMPLDUZ=""  D
"RTN","GMPLSLRP",15,0)
 . . S GMPLUSNM=$$GET1^DIQ(200,GMPLDUZ,.01) Q:'$L(GMPLUSNM)
"RTN","GMPLSLRP",16,0)
 . . S GMPLLNME=$$GET1^DIQ(200,GMPLDUZ,125.1),GMPLST=$$GET1^DIQ(200,GMPLDUZ,125.1,"I")
"RTN","GMPLSLRP",17,0)
 . . I '$L(GMPLLNME),GMPLST S GMPLELST(GMPLUSNM,GMPLST)=GMPLDUZ Q
"RTN","GMPLSLRP",18,0)
 . . E  Q:'$L(GMPLLNME)
"RTN","GMPLSLRP",19,0)
 . . S GMPLULST(GMPLUSNM,GMPLLNME)=""
"RTN","GMPLSLRP",20,0)
 Q
"RTN","GMPLSLRP",21,0)
 ;
"RTN","GMPLSLRP",22,0)
GETCLNLT(GMPLCLST) ; Retrieve pre-existing clinic problem selection lists
"RTN","GMPLSLRP",23,0)
 N GMPLCLIN,GMPLST,GMPLDA
"RTN","GMPLSLRP",24,0)
 S (GMPLDA,GMPLST)=""
"RTN","GMPLSLRP",25,0)
 F  S GMPLST=$O(^GMPL(125,"B",GMPLST)) Q:GMPLST=""  D
"RTN","GMPLSLRP",26,0)
 . F  S GMPLDA=$O(^GMPL(125,"B",GMPLST,GMPLDA)) Q:GMPLDA=""  D
"RTN","GMPLSLRP",27,0)
 . . S GMPLCLIN=$$GET1^DIQ(125,GMPLDA,.03) Q:GMPLCLIN=""
"RTN","GMPLSLRP",28,0)
 . . S GMPLCLST(GMPLCLIN,GMPLST)=""
"RTN","GMPLSLRP",29,0)
 Q
"RTN","GMPLSLRP",30,0)
 ;
"RTN","GMPLSLRP",31,0)
PAGE(GMPLNUM,GMPLTITL) ; Print header and raise page number
"RTN","GMPLSLRP",32,0)
 Q:'$G(GMPLNUM)
"RTN","GMPLSLRP",33,0)
 I GMPLNUM'=1,$E(IOST,1,2)="C-" D  Q:'GMPLNUM
"RTN","GMPLSLRP",34,0)
 . N DIR,DTOUT,DIRUT,DUOUT,X,Y
"RTN","GMPLSLRP",35,0)
 . S DIR(0)="E" D ^DIR
"RTN","GMPLSLRP",36,0)
 . I $D(DTOUT)!($D(DUOUT)) S GMPLNUM=0
"RTN","GMPLSLRP",37,0)
 W @IOF
"RTN","GMPLSLRP",38,0)
 W GMPLTITL
"RTN","GMPLSLRP",39,0)
 W ?70,"Page: ",GMPLNUM
"RTN","GMPLSLRP",40,0)
 W !,$$REPEAT^XLFSTR("-",78)
"RTN","GMPLSLRP",41,0)
 S GMPLNUM=GMPLNUM+1
"RTN","GMPLSLRP",42,0)
 Q
"RTN","GMPLUTL2")
0^11^B93151761
"RTN","GMPLUTL2",1,0)
GMPLUTL2 ; ISL/MKB,KER,JER,TC -- PL Utilities (OE/TIU) ;02/16/17  12:21
"RTN","GMPLUTL2",2,0)
 ;;2.0;Problem List;**10,18,21,26,35,36,42,45,49**;Aug 25, 1994;Build 43
"RTN","GMPLUTL2",3,0)
 ;
"RTN","GMPLUTL2",4,0)
 ; External References
"RTN","GMPLUTL2",5,0)
 ;   DBIA   348  ^DPT(  file #2
"RTN","GMPLUTL2",6,0)
 ;    ICR  5699  $$ICDDATA^ICDXCODE
"RTN","GMPLUTL2",7,0)
 ;    ICR  5747  $$SAB^ICDEX,$$CODECS^ICDEX,$$CSI^ICDEX
"RTN","GMPLUTL2",8,0)
 ;   DBIA 10040  ^SC(  file #44
"RTN","GMPLUTL2",9,0)
 ;   DBIA 10060  ^VA(200,$$GET1^DIQ(200
"RTN","GMPLUTL2",10,0)
 ;   DBIA  2716  $$GETSTAT^DGMSTAPI
"RTN","GMPLUTL2",11,0)
 ;   DBIA  3457  $$GETCUR^DGNTAPI
"RTN","GMPLUTL2",12,0)
 ;   DBIA 10062  7^VADPT
"RTN","GMPLUTL2",13,0)
 ;   DBIA 10062  DEM^VADPT
"RTN","GMPLUTL2",14,0)
 ;   DBIA 10118  EN^VALM
"RTN","GMPLUTL2",15,0)
 ;   DBIA 10116  CLEAR^VALM1
"RTN","GMPLUTL2",16,0)
 ;   DBIA 10103  $$HTFM^XLFDT
"RTN","GMPLUTL2",17,0)
 ;
"RTN","GMPLUTL2",18,0)
LIST(GMPL,GMPDFN,GMPSTAT,GMPCOMM) ; Returns list of Problems for Patient
"RTN","GMPLUTL2",19,0)
 D LIST^GMPLUTL3
"RTN","GMPLUTL2",20,0)
 Q
"RTN","GMPLUTL2",21,0)
 ;
"RTN","GMPLUTL2",22,0)
DETAIL(IFN,GMPL) ; Returns Detailed Data for Problem
"RTN","GMPLUTL2",23,0)
 ;
"RTN","GMPLUTL2",24,0)
 ; Input   IFN  Pointer to Problem file #9000011
"RTN","GMPLUTL2",25,0)
 ;
"RTN","GMPLUTL2",26,0)
 ; Output  GMPL Array, passed by reference
"RTN","GMPLUTL2",27,0)
 ;         GMPL("DATA NAME") = External Format of Value
"RTN","GMPLUTL2",28,0)
 ;
"RTN","GMPLUTL2",29,0)
 ;         GMPL("DIAGNOSIS")  ICD Code
"RTN","GMPLUTL2",30,0)
 ;         GMPL("ICDD")       ICD Description
"RTN","GMPLUTL2",31,0)
 ;         GMPL("CSYS")       Coding System (#80202) [ex: 10D (ICD-10) & ICD (ICD-9)]
"RTN","GMPLUTL2",32,0)
 ;         GMPL("DTINTEREST") Date of Interest (#80201)
"RTN","GMPLUTL2",33,0)
 ;         GMPL("PATIENT")    Patient Name
"RTN","GMPLUTL2",34,0)
 ;         GMPL("MODIFIED")   Date Last Modified
"RTN","GMPLUTL2",35,0)
 ;         GMPL("NARRATIVE")  Provider Narrative
"RTN","GMPLUTL2",36,0)
 ;         GMPL("ENTERED")    Date Entered ^ Entered by
"RTN","GMPLUTL2",37,0)
 ;         GMPL("STATUS")     Status
"RTN","GMPLUTL2",38,0)
 ;         GMPL("PRIORITY")   Priority Acute/Chronic
"RTN","GMPLUTL2",39,0)
 ;         GMPL("ONSET")      Date of Onset
"RTN","GMPLUTL2",40,0)
 ;         GMPL("PROVIDER")   Responsible Provider
"RTN","GMPLUTL2",41,0)
 ;         GMPL("RECORDED")   Date Recorded ^ Recorded by
"RTN","GMPLUTL2",42,0)
 ;         GMPL("CONDITION")  Patient Condition (#1.02)
"RTN","GMPLUTL2",43,0)
 ;         GMPL("RESOLVED")   Date Resolved (#1.07)
"RTN","GMPLUTL2",44,0)
 ;         GMPL("CLINIC")     Hospital Location
"RTN","GMPLUTL2",45,0)
 ;         GMPL("SERVICE")    Service (#1.06)
"RTN","GMPLUTL2",46,0)
 ;         GMPL("FACILITY")   Facility ID ^ Facility Name (#.06)
"RTN","GMPLUTL2",47,0)
 ;         GMPL("SC")         Service Connected SC/NSC/""
"RTN","GMPLUTL2",48,0)
 ;         GMPL("SCTC")       SNOMED-CT Concept Code
"RTN","GMPLUTL2",49,0)
 ;         GMPL("SCTD")       SNOMED-CT Designation Code
"RTN","GMPLUTL2",50,0)
 ;         GMPL("SCTT")       SNOMED-CT Preferred Text
"RTN","GMPLUTL2",51,0)
 ;         GMPL("VHATC")      VHAT Concept Code
"RTN","GMPLUTL2",52,0)
 ;         GMPL("VHATD")      VHAT Designation Code
"RTN","GMPLUTL2",53,0)
 ;         GMPL("VHATT")      VHAT Preferred Text
"RTN","GMPLUTL2",54,0)
 ;
"RTN","GMPLUTL2",55,0)
 ;         GMPL("ICD9MLTP") = #
"RTN","GMPLUTL2",56,0)
 ;         GMPL("ICD9MLTP",CNT) = ICD-9-CM/ICD-10-CM Code^ICD-9-CM/ICD-10-CM Description^ICD Coding System
"RTN","GMPLUTL2",57,0)
 ;
"RTN","GMPLUTL2",58,0)
 ;         GMPL("EXPOSURE") = #
"RTN","GMPLUTL2",59,0)
 ;         GMPL("EXPOSURE",X)="AGENT ORANGE"
"RTN","GMPLUTL2",60,0)
 ;         GMPL("EXPOSURE",X)="RADIATION"
"RTN","GMPLUTL2",61,0)
 ;         GMPL("EXPOSURE",X)="ENV CONTAMINANTS"
"RTN","GMPLUTL2",62,0)
 ;         GMPL("EXPOSURE",X)="HEAD AND/OR NECK CANCER"
"RTN","GMPLUTL2",63,0)
 ;         GMPL("EXPOSURE",X)="MILITARY SEXUAL TRAUMA"
"RTN","GMPLUTL2",64,0)
 ;         GMPL("EXPOSURE",X)="COMBAT VET"
"RTN","GMPLUTL2",65,0)
 ;         GMPL("EXPOSURE",X)="SHAD"
"RTN","GMPLUTL2",66,0)
 ;
"RTN","GMPLUTL2",67,0)
 ;         GMPL("COMMENT") = #
"RTN","GMPLUTL2",68,0)
 ;         GMPL("COMMENT",CNT) = Date ^ Author ^ Text of Note
"RTN","GMPLUTL2",69,0)
 ;
"RTN","GMPLUTL2",70,0)
 N GMPL0,GMPL1,GMPL800,GMPL802,GMPL803,GMPLP,X,I,FAC,CNT,NIFN,GMPLNTDT,GMPLATHR,GMPLTEXT Q:'$D(^AUPNPROB(IFN,0))
"RTN","GMPLUTL2",71,0)
 K ^TMP("GMPLCMT",$J)
"RTN","GMPLUTL2",72,0)
 S GMPLP=+($$PTR^GMPLUTL4)
"RTN","GMPLUTL2",73,0)
 S GMPL0=$G(^AUPNPROB(IFN,0)),GMPL1=$G(^(1)),GMPL800=$G(^(800)),GMPL802=$G(^(802)),GMPL803=$G(^(803,0))
"RTN","GMPLUTL2",74,0)
 S GMPL("DTINTEREST")=$S(+$P(GMPL802,U,1):$P(GMPL802,U,1),1:$P(GMPL0,U,8)),GMPL("CSYS")=$S($P(GMPL802,U,2)]"":$P(GMPL802,U,2),1:$$SAB^ICDEX($$CSI^ICDEX(80,+GMPL0),GMPL("DTINTEREST")))
"RTN","GMPLUTL2",75,0)
 S GMPL("DIAGNOSIS")=$P($$ICDDATA^ICDXCODE(GMPL("CSYS"),+GMPL0,GMPL("DTINTEREST"),"I"),U,2)
"RTN","GMPLUTL2",76,0)
 S GMPL("FACILITY")=$$RESOLVE(IFN,".06","IE")
"RTN","GMPLUTL2",77,0)
 S GMPL("ICDD")=$$ICDDESC(GMPL("DIAGNOSIS"),GMPL("DTINTEREST"),GMPL("CSYS"))
"RTN","GMPLUTL2",78,0)
 S GMPL("PATIENT")=$P($G(^DPT(+$P(GMPL0,U,2),0)),U)
"RTN","GMPLUTL2",79,0)
 S GMPL("MODIFIED")=$$EXTDT^GMPLX($P(GMPL0,U,3))
"RTN","GMPLUTL2",80,0)
 S GMPL("NARRATIVE")=$$PROBTEXT^GMPLX(IFN)
"RTN","GMPLUTL2",81,0)
 S GMPL("ENTERED")=$$EXTDT^GMPLX($P(GMPL0,U,8))_U_$P($G(^VA(200,+$P(GMPL1,U,3),0)),U)
"RTN","GMPLUTL2",82,0)
 S X=$P(GMPL0,U,12),GMPL("STATUS")=$S(X="A":"ACTIVE",1:"INACTIVE")
"RTN","GMPLUTL2",83,0)
 S X=$S(X'="A":"",1:$P(GMPL1,U,14)),GMPL("PRIORITY")=$S(X="A":"ACUTE",X="C":"CHRONIC",1:"")
"RTN","GMPLUTL2",84,0)
 S GMPL("ONSET")=$$EXTDT^GMPLX($P(GMPL0,U,13))
"RTN","GMPLUTL2",85,0)
 S GMPL("CONDITION")=$$RESOLVE(IFN,"1.02","E")
"RTN","GMPLUTL2",86,0)
 S GMPL("PROVIDER")=$P($G(^VA(200,+$P(GMPL1,U,5),0)),U)
"RTN","GMPLUTL2",87,0)
 S GMPL("RECORDED")=$$EXTDT^GMPLX($P(GMPL1,U,9))_U_$P($G(^VA(200,+$P(GMPL1,U,4),0)),U)
"RTN","GMPLUTL2",88,0)
 S GMPL("RESOLVED")=$$EXTDT^GMPLX($P(GMPL1,U,7))
"RTN","GMPLUTL2",89,0)
 S GMPL("CLINIC")=$P($G(^SC(+$P(GMPL1,U,8),0)),U)
"RTN","GMPLUTL2",90,0)
 S GMPL("SERVICE")=$$RESOLVE(IFN,1.06,"E")
"RTN","GMPLUTL2",91,0)
 S GMPL("SCTC")=$P(GMPL800,U),GMPL("SCTD")=$P(GMPL800,U,2)
"RTN","GMPLUTL2",92,0)
 I $L($G(GMPL("SCTC"))) S GMPL("SCTT")=$P($$SCTTEXT(GMPL("SCTC"),$P(GMPL0,U,8),"SCT"),U)
"RTN","GMPLUTL2",93,0)
 S GMPL("VHATC")=$P(GMPL800,U,3),GMPL("VHATD")=$P(GMPL800,U,4)
"RTN","GMPLUTL2",94,0)
 I $L($G(GMPL("VHATC"))) S GMPL("VHATT")=$$SCTTEXT(GMPL("VHATC"),$P(GMPL0,U,8),"VHAT")
"RTN","GMPLUTL2",95,0)
 S GMPL("ICD9MLTP")=""
"RTN","GMPLUTL2",96,0)
 I $L($G(GMPL803))>0 D
"RTN","GMPLUTL2",97,0)
 . N DA,ICDDESC S (CNT,DA)=0,GMPL("ICD9MLTP")=0 F  S DA=$O(^AUPNPROB(IFN,803,DA)) Q:'+DA  D
"RTN","GMPLUTL2",98,0)
 . . S X=$G(^AUPNPROB(IFN,803,DA,0)),ICDDESC=$$ICDDESC($P(X,U),$P(X,U,3),$P(X,U,2))
"RTN","GMPLUTL2",99,0)
 . . S CNT=CNT+1,GMPL("ICD9MLTP",CNT)=$P(X,U)_U_$G(ICDDESC)_U_$P(X,U,2)
"RTN","GMPLUTL2",100,0)
 . S GMPL("ICD9MLTP")=CNT
"RTN","GMPLUTL2",101,0)
 S GMPL("SC")=$S($P(GMPL1,U,10):"YES",$P(GMPL1,U,10)=0:"NO",1:"UNKNOWN")
"RTN","GMPLUTL2",102,0)
 S GMPL("EXPOSURE")=0
"RTN","GMPLUTL2",103,0)
 I $P(GMPL1,U,11) S X=GMPL("EXPOSURE")+1,GMPL("EXPOSURE",X)="AGENT ORANGE",GMPL("EXPOSURE")=X
"RTN","GMPLUTL2",104,0)
 I $P(GMPL1,U,12) S X=GMPL("EXPOSURE")+1,GMPL("EXPOSURE",X)="RADIATION",GMPL("EXPOSURE")=X
"RTN","GMPLUTL2",105,0)
 I $P(GMPL1,U,13) S X=GMPL("EXPOSURE")+1,GMPL("EXPOSURE",X)="ENV CONTAMINANTS",GMPL("EXPOSURE")=X
"RTN","GMPLUTL2",106,0)
 I $P(GMPL1,U,15) S X=GMPL("EXPOSURE")+1,GMPL("EXPOSURE",X)="HEAD AND/OR NECK CANCER",GMPL("EXPOSURE")=X
"RTN","GMPLUTL2",107,0)
 I $P(GMPL1,U,16) S X=GMPL("EXPOSURE")+1,GMPL("EXPOSURE",X)="MILITARY SEXUAL TRAUMA",GMPL("EXPOSURE")=X
"RTN","GMPLUTL2",108,0)
 I $P(GMPL1,U,17) S X=GMPL("EXPOSURE")+1,GMPL("EXPOSURE",X)="COMBAT VET",GMPL("EXPOSURE")=X
"RTN","GMPLUTL2",109,0)
 I $P(GMPL1,U,18)&(GMPLP'>0) S X=GMPL("EXPOSURE")+1,GMPL("EXPOSURE",X)="SHAD",GMPL("EXPOSURE")=X
"RTN","GMPLUTL2",110,0)
 S (FAC,CNT)=0,GMPL("COMMENT")=0
"RTN","GMPLUTL2",111,0)
 F FAC=0:0 S FAC=$O(^AUPNPROB(IFN,11,FAC)) Q:+FAC'>0  D
"RTN","GMPLUTL2",112,0)
 . F NIFN=0:0 S NIFN=$O(^AUPNPROB(IFN,11,FAC,11,NIFN)) Q:NIFN'>0  D
"RTN","GMPLUTL2",113,0)
 . . S X=$G(^AUPNPROB(IFN,11,FAC,11,NIFN,0))
"RTN","GMPLUTL2",114,0)
 . . S GMPLNTDT=$P(X,U,5),GMPLATHR=$P(X,U,6),GMPLTEXT=$P(X,U,3)
"RTN","GMPLUTL2",115,0)
 . . S ^TMP("GMPLCMT",$J,NIFN)=$$EXTDT^GMPLX(GMPLNTDT)_U_$$GET1^DIQ(200,""_+GMPLATHR_",",.01)_U_GMPLTEXT
"RTN","GMPLUTL2",116,0)
 S NIFN=""
"RTN","GMPLUTL2",117,0)
 F  S NIFN=$O(^TMP("GMPLCMT",$J,NIFN),-1) Q:NIFN=""  D
"RTN","GMPLUTL2",118,0)
  . S CNT=CNT+1,GMPL("COMMENT",CNT)=^TMP("GMPLCMT",$J,NIFN)
"RTN","GMPLUTL2",119,0)
 K ^TMP("GMPLCMT",$J)
"RTN","GMPLUTL2",120,0)
 S GMPL("COMMENT")=CNT D AUDIT
"RTN","GMPLUTL2",121,0)
 Q
"RTN","GMPLUTL2",122,0)
 ;
"RTN","GMPLUTL2",123,0)
RESOLVE(IEN,FIELD,FORMAT) ; Call GET1^DIQ to resolve field values
"RTN","GMPLUTL2",124,0)
 ;  Input:    IEN = Record #
"RTN","GMPLUTL2",125,0)
 ;          FIELD = Field # in PROBLEMS file #9000011
"RTN","GMPLUTL2",126,0)
 ;         FORMAT = "I"nternal, "E"xternal, or "IE" -> both
"RTN","GMPLUTL2",127,0)
 ; Output: GMPLY = value as specified by format
"RTN","GMPLUTL2",128,0)
 N GMPLY
"RTN","GMPLUTL2",129,0)
 S IEN=IEN_","
"RTN","GMPLUTL2",130,0)
 S GMPLY=$$GET1^DIQ(9000011,IEN,FIELD,FORMAT)
"RTN","GMPLUTL2",131,0)
 S:FORMAT="IE" GMPLY=GMPLY_U_$$GET1^DIQ(9000011,IEN,FIELD,"E")
"RTN","GMPLUTL2",132,0)
 Q GMPLY
"RTN","GMPLUTL2",133,0)
AUDIT ; 14 Sep 99 - MA - Add audit trail to OE Problem List.
"RTN","GMPLUTL2",134,0)
 ; Called from DETAIL, requires IFN and sets GMPL("AUDIT")
"RTN","GMPLUTL2",135,0)
 N IDT,AIFN,X0,X1,FLD,CNT
"RTN","GMPLUTL2",136,0)
 S CNT=0,GMPL("AUDIT")=CNT
"RTN","GMPLUTL2",137,0)
 F IDT=0:0 S IDT=$O(^GMPL(125.8,"AD",IFN,IDT)) Q:IDT'>0  D
"RTN","GMPLUTL2",138,0)
 . F AIFN=0:0 S AIFN=$O(^GMPL(125.8,"AD",IFN,IDT,AIFN)) Q:AIFN'>0  D
"RTN","GMPLUTL2",139,0)
 .. S X0=$G(^GMPL(125.8,AIFN,0)),X1=$G(^(1)) Q:'$L(X0)
"RTN","GMPLUTL2",140,0)
 .. S FLD=$$FLDNAME(+$P(X0,U,2))
"RTN","GMPLUTL2",141,0)
 .. S CNT=CNT+1
"RTN","GMPLUTL2",142,0)
 .. S GMPL("AUDIT",CNT,0)=$P(X0,U,2)_U_FLD_U_$P(X0,U,3,8)
"RTN","GMPLUTL2",143,0)
 .. ; = pointer#^fld name^date mod^who mod^old^new^reason^prov
"RTN","GMPLUTL2",144,0)
 .. S:$L(X1) GMPL("AUDIT",CNT,1)=X1
"RTN","GMPLUTL2",145,0)
 S GMPL("AUDIT")=CNT
"RTN","GMPLUTL2",146,0)
 Q
"RTN","GMPLUTL2",147,0)
 ;
"RTN","GMPLUTL2",148,0)
FLDNAME(NUM) ; Returns field name for display
"RTN","GMPLUTL2",149,0)
 N NAME,NM1,NM2,I,J S J=0,NAME=""
"RTN","GMPLUTL2",150,0)
 S NM1=".01^.05^.12^.13^1.01^1.02^1.04^1.05^1.06^1.07^1.08^1.09^1.1^1.11^1.12^1.13^1.14^1.15^1.16^1.17^1.18^80001^80002^80003^80004^80005^302^1101"
"RTN","GMPLUTL2",151,0)
 F I=1:1:$L(NM1,U) I +$P(NM1,U,I)=+NUM S J=I Q
"RTN","GMPLUTL2",152,0)
 G:J'>0 FNQ
"RTN","GMPLUTL2",153,0)
 S NM2="DIAGNOSIS^PROVIDER NARRATIVE^STATUS^DATE OF ONSET^PROBLEM^CONDITION^RECORDING PROVIDER^RESPONSIBLE PROVIDER"
"RTN","GMPLUTL2",154,0)
 S NM2=NM2_"^SERVICE^DATE RESOLVED^CLINIC^DATE RECORDED^SERVICE CONNECTED^AGENT ORANGE EXP^RADIATION EXP^ENV CONTAMINANTS EXP"
"RTN","GMPLUTL2",155,0)
 S NM2=NM2_"^IMMEDIACY^HEAD & NECK CANCER^MIL SEX TRAUMA^COMBAT VET^SHIPBOARD HAZARD EXP^SNOMED CT CONCEPT^SNOMED CT DESIGNATION"
"RTN","GMPLUTL2",156,0)
 S NM2=NM2_"^VHAT CONCEPT^VHAT DESIGNATION^SNOMED CT/ICD MAP STATUS^SECONDARY DIAGNOSIS^NOTE"
"RTN","GMPLUTL2",157,0)
 S NAME=$P(NM2,U,J)
"RTN","GMPLUTL2",158,0)
FNQ Q NAME
"RTN","GMPLUTL2",159,0)
 ;
"RTN","GMPLUTL2",160,0)
ADD(DFN,LOC,GMPROV) ; -- Interactive LMgr action to add new problem
"RTN","GMPLUTL2",161,0)
 N X,Y,GMPDFN,GMPVA,GMPVAMC,GMPSC,GMPAGTOR,GMPION,GMPGULF,GMPHNC,GMPMST,GMPCV,GMPSHD
"RTN","GMPLUTL2",162,0)
 N GMPARAM,GMPLVIEW,GMPLUSER,GMPCLIN,GMPLSLST,GMPQUIT,VALMCC,GMPSAVED,GMPCLPAR
"RTN","GMPLUTL2",163,0)
 Q:'DFN  Q:'LOC  D SETVARS
"RTN","GMPLUTL2",164,0)
 S GMPLSLST=$$GET^XPAR(DUZ_";VA(200,","ORQQPL SELECTION LIST",1),VALMCC=0
"RTN","GMPLUTL2",165,0)
 I +GMPCLIN S GMPCLPAR=$$GET^XPAR(+GMPCLIN_";SC(","ORQQPL SELECTION LIST",1)
"RTN","GMPLUTL2",166,0)
 I 'GMPLSLST,+GMPCLPAR S GMPLSLST=GMPCLPAR
"RTN","GMPLUTL2",167,0)
 I GMPLSLST D  Q
"RTN","GMPLUTL2",168,0)
 . S $P(GMPLSLST,U,2)=$P($G(^GMPL(125,+GMPLSLST,0)),U)
"RTN","GMPLUTL2",169,0)
 . D EN^VALM("GMPL LIST MENU")
"RTN","GMPLUTL2",170,0)
 F  D ADD^GMPL1 Q:$D(GMPQUIT)  K DUOUT,DTOUT,GMPSAVED W !!,">>>  Please enter another problem, or press <return> to exit."
"RTN","GMPLUTL2",171,0)
 Q
"RTN","GMPLUTL2",172,0)
 ;
"RTN","GMPLUTL2",173,0)
SETVARS ; -- Define GMP* variables used in ADD and EDIT
"RTN","GMPLUTL2",174,0)
 N VA,VADM,VAEL,VASV,X
"RTN","GMPLUTL2",175,0)
 Q:'DFN  D DEM^VADPT,7^VADPT
"RTN","GMPLUTL2",176,0)
 S GMPDFN=DFN_U_VADM(1)_U_$E(VADM(1))_VA("BID")_$S(VADM(6):U_+VADM(6),1:"")
"RTN","GMPLUTL2",177,0)
 S AUPNSEX=$P(VADM(5),U),GMPVA=1,GMPSC=VAEL(3),GMPAGTOR=VASV(2),GMPION=VASV(3)
"RTN","GMPLUTL2",178,0)
 S X=$P($G(^DPT(DFN,.322)),U,10),GMPGULF=$S(X="Y":1,X="N":0,1:"")
"RTN","GMPLUTL2",179,0)
 S GMPCV=0 I +$G(VASV(10)) S:DT'>$P($G(VASV(10,1)),U) GMPCV=1 ;CV
"RTN","GMPLUTL2",180,0)
 S GMPSHD=+$G(VASV(14,1)) ;SHAD
"RTN","GMPLUTL2",181,0)
 S X=$$GETCUR^DGNTAPI(DFN,"HNC"),X=+($G(HNC("STAT"))),GMPHNC=$S(X=4:1,X=5:1,X=1:0,X=6:0,1:"")
"RTN","GMPLUTL2",182,0)
 S X=$P($$GETSTAT^DGMSTAPI(DFN),"^",2),GMPMST=$S(X="Y":1,X="N":0,1:"")
"RTN","GMPLUTL2",183,0)
 S GMPLVIEW("VIEW")=$S($P($G(^SC(+$G(LOC),0)),U,3)="C":"C",1:"S")
"RTN","GMPLUTL2",184,0)
 S GMPCLIN="" I $G(LOC),GMPLVIEW("VIEW")="C" S GMPCLIN=+LOC_U_$P(^SC(+LOC,0),U)
"RTN","GMPLUTL2",185,0)
 S X=$$PARAM,GMPARAM("VER")=+$P(X,U,2),GMPARAM("CLU")=+$P(X,U,4),GMPARAM("REV")=+$P(X,U,5)
"RTN","GMPLUTL2",186,0)
 S:+GMPROV=DUZ GMPLUSER=1 S GMPVAMC=+$G(DUZ(2)),GMPLIST(0)=0
"RTN","GMPLUTL2",187,0)
 Q
"RTN","GMPLUTL2",188,0)
 ;
"RTN","GMPLUTL2",189,0)
EDIT(DFN,LOC,GMPROV,GMPIFN) ; Interactive LMgr action to edit a problem
"RTN","GMPLUTL2",190,0)
 N GMPARAM,GMPDFN,GMPVA,GMPSC,GMPAGTOR,GMPION,GMPGULF,GMPHNC,GMPMST,GMPCV,GMPSHD
"RTN","GMPLUTL2",191,0)
 N GMPLVIEW,GMPCLIN,GMPLJUMP,GMPQUIT,GMPLUSER,GMPLVAMC,AUPNSEX
"RTN","GMPLUTL2",192,0)
 L +^AUPNPROB(GMPIFN,0):1 I '$T W $C(7),!!,$$LOCKED^GMPLX,! H 2 Q
"RTN","GMPLUTL2",193,0)
 D SETVARS,EN^VALM("GMPL EDIT PROBLEM")
"RTN","GMPLUTL2",194,0)
 L -^AUPNPROB(GMPIFN,0)
"RTN","GMPLUTL2",195,0)
 Q
"RTN","GMPLUTL2",196,0)
 ;
"RTN","GMPLUTL2",197,0)
REMOVE(GMPIFN,GMPROV,TEXT,PLY) ; -- Remove problem GMPIFN
"RTN","GMPLUTL2",198,0)
 N GMPVAMC,CHANGE
"RTN","GMPLUTL2",199,0)
 S GMPVAMC=+$G(DUZ(2)),PLY=-1,PLY(0)=""
"RTN","GMPLUTL2",200,0)
 I '$L($G(^AUPNPROB(GMPIFN,0))) S PLY(0)="Invalid problem" Q
"RTN","GMPLUTL2",201,0)
 I '$D(^VA(200,+$G(GMPROV),0)) S PLY(0)="Invalid provider" Q
"RTN","GMPLUTL2",202,0)
 I $L($G(TEXT)) S GMPFLD(10,"NEW",1)=TEXT D NEWNOTE^GMPLSAVE
"RTN","GMPLUTL2",203,0)
 S CHANGE=GMPIFN_"^1.02^"_$$HTFM^XLFDT($H)_U_DUZ_U_$P($G(^AUPNPROB(GMPIFN,1)),U,2)_"^H^Deleted^"_+$G(GMPROV),$P(^AUPNPROB(GMPIFN,1),U,2)="H",PLY=GMPIFN
"RTN","GMPLUTL2",204,0)
 D AUDIT^GMPLX(CHANGE,""),DTMOD^GMPLX(GMPIFN)
"RTN","GMPLUTL2",205,0)
 Q
"RTN","GMPLUTL2",206,0)
 ;
"RTN","GMPLUTL2",207,0)
PARAM() ; -- Returns parameter values from 125.99
"RTN","GMPLUTL2",208,0)
 Q $G(^GMPL(125.99,1,0))
"RTN","GMPLUTL2",209,0)
 ;
"RTN","GMPLUTL2",210,0)
VAF(DFN,SILENT) ; -- print PL VA Form chart copy
"RTN","GMPLUTL2",211,0)
 ;
"RTN","GMPLUTL2",212,0)
 N VA,VADM,VAERR,GMPDFN,GMPVAMC,X,GMPARAM,GMPRT,GMPQUIT,GMPLCURR
"RTN","GMPLUTL2",213,0)
 Q:'$G(DFN)  D DEM^VADPT S GMPDFN=DFN_U_VADM(1)_U_$E(VADM(1))_VA("BID")
"RTN","GMPLUTL2",214,0)
 S GMPVAMC=+$G(DUZ(2)),GMPARAM("QUIET")=1
"RTN","GMPLUTL2",215,0)
 S X=$G(^GMPL(125.99,1,0)),GMPARAM("VER")=+$P(X,U,2),GMPARAM("PRT")=+$P(X,U,3),GMPARAM("CLU")=+$P(X,U,4),GMPARAM("REV")=$S($P(X,U,5)="R":1,1:0) K X
"RTN","GMPLUTL2",216,0)
 D VAF^GMPLPRNT I '$G(SILENT) D  Q:$G(GMPQUIT)
"RTN","GMPLUTL2",217,0)
 . I GMPRT'>0 W !!,"No problems available." S GMPQUIT=1 Q
"RTN","GMPLUTL2",218,0)
 . D DEVICE^GMPLPRNT Q:$G(GMPQUIT)  D CLEAR^VALM1
"RTN","GMPLUTL2",219,0)
 D PRT^GMPLPRNT
"RTN","GMPLUTL2",220,0)
 Q
"RTN","GMPLUTL2",221,0)
SCTTEXT(GMPLCODE,GMPDT,GMPSYS) ; Get Preferred Text for SCT Code
"RTN","GMPLUTL2",222,0)
 N %DT,GMPY,LEX,LEXY S GMPY="",GMPDT=$G(GMPDT,DT),GMPSYS=$G(GMPSYS,"SCT")
"RTN","GMPLUTL2",223,0)
 S LEXY=$$CODE^LEXTRAN(GMPLCODE,GMPSYS,GMPDT)
"RTN","GMPLUTL2",224,0)
 I '+LEXY G SCTTEXQ
"RTN","GMPLUTL2",225,0)
 S GMPY=$G(LEX("P"))
"RTN","GMPLUTL2",226,0)
SCTTEXQ Q GMPY
"RTN","GMPLUTL2",227,0)
ICDDESC(GMPLCODE,GMPDT,GMPLCSYS) ; Get description for ICD Code
"RTN","GMPLUTL2",228,0)
 N ICDD,GMPY,ICDY S GMPY="",GMPDT=$G(GMPDT,DT)
"RTN","GMPLUTL2",229,0)
 S:'$G(GMPLCSYS) GMPLCSYS=$$SAB^ICDEX($P($$CODECS^ICDEX(GMPLCODE,80,GMPDT),U),GMPDT)
"RTN","GMPLUTL2",230,0)
 S ICDY=$$ICDDESC^ICDXCODE(GMPLCSYS,GMPLCODE,GMPDT,.ICDD)
"RTN","GMPLUTL2",231,0)
 I 'ICDY G ICDDESQ
"RTN","GMPLUTL2",232,0)
 S GMPY=$G(ICDD(1))
"RTN","GMPLUTL2",233,0)
ICDDESQ Q GMPY
"RTN","GMPLUTL4")
0^14^B16873320
"RTN","GMPLUTL4",1,0)
GMPLUTL4 ; SLC/KER/TC -- PL Utilities (Misc) ;03/07/17  08:48
"RTN","GMPLUTL4",2,0)
 ;;2.0;Problem List;**26,49**;Aug 25, 1994;Build 43
"RTN","GMPLUTL4",3,0)
 ;
"RTN","GMPLUTL4",4,0)
 ; External References
"RTN","GMPLUTL4",5,0)
 ;   ICR  10066  XMZ^XMA2
"RTN","GMPLUTL4",6,0)
 ;   ICR  10070  ENT1^XMD
"RTN","GMPLUTL4",7,0)
 ;   DBIA 10096  ^%ZOSF("TEST")
"RTN","GMPLUTL4",8,0)
 ;
"RTN","GMPLUTL4",9,0)
 ; Variable Used but NEWed/KILLed Elsewhere
"RTN","GMPLUTL4",10,0)
 ;   IOT, ORWINDEV
"RTN","GMPLUTL4",11,0)
 ;
"RTN","GMPLUTL4",12,0)
 ;=================================================
"RTN","GMPLUTL4",13,0)
ASKYN(GMPLDEF,GMPLTEXT) ;
"RTN","GMPLUTL4",14,0)
 N DIR,Y
"RTN","GMPLUTL4",15,0)
 K DIROUT,DIRUT,DTOUT,DUOUT
"RTN","GMPLUTL4",16,0)
 S DIR(0)="Y0"
"RTN","GMPLUTL4",17,0)
 S DIR("A")=GMPLTEXT
"RTN","GMPLUTL4",18,0)
 S DIR("B")=GMPLDEF
"RTN","GMPLUTL4",19,0)
 S DIR("?")="Enter Y or N."
"RTN","GMPLUTL4",20,0)
 W !
"RTN","GMPLUTL4",21,0)
 D ^DIR
"RTN","GMPLUTL4",22,0)
 I $D(DTOUT)!$D(DUOUT) S Y=GMPLDEF
"RTN","GMPLUTL4",23,0)
 Q Y
"RTN","GMPLUTL4",24,0)
 ;
"RTN","GMPLUTL4",25,0)
 ;============================================
"RTN","GMPLUTL4",26,0)
GETEHF(GMPLEXT,GMPLDPTH) ;Get an existing host file.
"RTN","GMPLUTL4",27,0)
 ;Build a list of all .EXT files in the current directory.
"RTN","GMPLUTL4",28,0)
 N GMPLDEXT,DIR,DIROUT,DIRUT,DTOUT,DUOUT
"RTN","GMPLUTL4",29,0)
 N GMPLFSPC,GMPLFLST,GMPLPATH,X,Y,GMPLFILE
"RTN","GMPLUTL4",30,0)
 I GMPLEXT="" D
"RTN","GMPLUTL4",31,0)
 . S DIR(0)="FAU"_U_"1:32"
"RTN","GMPLUTL4",32,0)
 . S DIR("A")="Enter a file extension: "
"RTN","GMPLUTL4",33,0)
 . S DIR("?")="A file specification has the format name.extension."
"RTN","GMPLUTL4",34,0)
 . D ^DIR
"RTN","GMPLUTL4",35,0)
 . S GMPLEXT=Y
"RTN","GMPLUTL4",36,0)
 I $D(DIRUT) Q ""
"RTN","GMPLUTL4",37,0)
 S GMPLDEXT="*."_GMPLEXT
"RTN","GMPLUTL4",38,0)
 S GMPLFSPC(GMPLDEXT)=""
"RTN","GMPLUTL4",39,0)
 S GMPLPATH=$S($G(GMPLDPTH)'="":GMPLDPTH,1:$$PWD^%ZISH)
"RTN","GMPLUTL4",40,0)
 S DIR(0)="FAU"_U_"1:32"
"RTN","GMPLUTL4",41,0)
 S DIR("A")="Enter a path: "
"RTN","GMPLUTL4",42,0)
 S DIR("B")=GMPLPATH
"RTN","GMPLUTL4",43,0)
 S DIR("?",1)="A host file is a file on your host system."
"RTN","GMPLUTL4",44,0)
 S DIR("?",2)="A complete host file consists of a path, file name, and extension."
"RTN","GMPLUTL4",45,0)
 S DIR("?",3)="A path consists of a device and directory name."
"RTN","GMPLUTL4",46,0)
 I $G(GMPLEXT)'="" S DIR("?",4)="The default extension is "_GMPLEXT_"."
"RTN","GMPLUTL4",47,0)
 S DIR("?")="The default path is "_GMPLPATH
"RTN","GMPLUTL4",48,0)
 D ^DIR
"RTN","GMPLUTL4",49,0)
 I $D(DIRUT) Q ""
"RTN","GMPLUTL4",50,0)
 S GMPLPATH=Y
"RTN","GMPLUTL4",51,0)
 S Y=$$LIST^%ZISH(GMPLPATH,"GMPLFSPC","GMPLFLST")
"RTN","GMPLUTL4",52,0)
 I Y D
"RTN","GMPLUTL4",53,0)
 . W !,"The following "_GMPLEXT_" files were found in ",GMPLPATH
"RTN","GMPLUTL4",54,0)
 . S GMPLFILE=""
"RTN","GMPLUTL4",55,0)
 . F  S GMPLFILE=$O(GMPLFLST(GMPLFILE)) Q:GMPLFILE=""  W !,?2,GMPLFILE
"RTN","GMPLUTL4",56,0)
 E  W !,"No "_GMPLEXT_" files were found in path ",GMPLPATH
"RTN","GMPLUTL4",57,0)
 ;
"RTN","GMPLUTL4",58,0)
 K DIR,X,Y
"RTN","GMPLUTL4",59,0)
 S DIR(0)="FAOU"_U_"1:32"
"RTN","GMPLUTL4",60,0)
 S DIR("A")="Enter a file name: "
"RTN","GMPLUTL4",61,0)
 S DIR("?",1)="A file name has the format NAME.EXTENSION, the default extension is "_GMPLEXT
"RTN","GMPLUTL4",62,0)
 S DIR("?",2)="Therefore if you type in FILE for the file name, the host file will be"
"RTN","GMPLUTL4",63,0)
 S DIR("?")="  "_GMPLPATH_"FILE."_GMPLEXT
"RTN","GMPLUTL4",64,0)
 D ^DIR
"RTN","GMPLUTL4",65,0)
 I $D(DIRUT) Q ""
"RTN","GMPLUTL4",66,0)
 S GMPLFILE=Y
"RTN","GMPLUTL4",67,0)
 ;Add the default extension if there isn't one.
"RTN","GMPLUTL4",68,0)
 I GMPLFILE'["." S GMPLFILE=GMPLFILE_"."_GMPLEXT
"RTN","GMPLUTL4",69,0)
 Q GMPLPATH_U_GMPLFILE
"RTN","GMPLUTL4",70,0)
 ;
"RTN","GMPLUTL4",71,0)
PTR(X) ; Output to Printer
"RTN","GMPLUTL4",72,0)
 ;   1 = Yes
"RTN","GMPLUTL4",73,0)
 ;   0 = No
"RTN","GMPLUTL4",74,0)
 Q:+($$VISTA)>0!(+($$HFP)>0) 1
"RTN","GMPLUTL4",75,0)
 Q 0
"RTN","GMPLUTL4",76,0)
 ;
"RTN","GMPLUTL4",77,0)
VISTA(X) ; Vista Printer
"RTN","GMPLUTL4",78,0)
 Q:$E($G(ION),1,3)="NUL" 0  Q:$G(IOT)'="HFS"&($E($G(IOST),1,2)["P-")&($G(IOST)'="P-OTHER") 1
"RTN","GMPLUTL4",79,0)
 Q 0
"RTN","GMPLUTL4",80,0)
 ;
"RTN","GMPLUTL4",81,0)
HFP(X) ; Host File sent to Printer
"RTN","GMPLUTL4",82,0)
 ;   Check ORWINDEV
"RTN","GMPLUTL4",83,0)
 N GMTS85 S GMTS85=$$PROK("ORWRP",85)
"RTN","GMPLUTL4",84,0)
 Q:+($G(GMTS85))>0&(+($G(ORWINDEV))>0) 1
"RTN","GMPLUTL4",85,0)
 ;   Check Host File Server
"RTN","GMPLUTL4",86,0)
 Q:$G(IOT)'="HFS" 0
"RTN","GMPLUTL4",87,0)
 ;   Host File for GUI Scrollable Window
"RTN","GMPLUTL4",88,0)
 Q:$E($G(ION),1,14)["OR WORKSTATION" 0
"RTN","GMPLUTL4",89,0)
 ;   TCP/IP Printer
"RTN","GMPLUTL4",90,0)
 Q:$G(IO)["$PRT"!($G(IO)["PRN|") 1
"RTN","GMPLUTL4",91,0)
 ;   Windows Printer
"RTN","GMPLUTL4",92,0)
 Q:$E($G(ION),1,14)["OR WINDOWS HFS" 1
"RTN","GMPLUTL4",93,0)
 ;   Host Files (file or unspecifed printer)
"RTN","GMPLUTL4",94,0)
 Q 0
"RTN","GMPLUTL4",95,0)
 ;
"RTN","GMPLUTL4",96,0)
 ; Miscellaneous
"RTN","GMPLUTL4",97,0)
PROK(X,Y) ; Routine and Patch # OK
"RTN","GMPLUTL4",98,0)
 N GMTS,GMTSI,GMTSO S X=$G(X),Y=$G(Y) Q:'$L(X) 0 Q:Y'=""&(+Y=0)
"RTN","GMPLUTL4",99,0)
 S Y=+Y,GMTS=$$ROK(X) Q:'GMTS 0 Q:+Y=0 1 S GMTSO=0,GMTS=$T(@("+2^"_X)),GMTS=$P($P(GMTS,"**",2),"**",1)
"RTN","GMPLUTL4",100,0)
 F GMTSI=1:1:$L(GMTS,",") S:+($P(GMTS,",",GMTSI))=Y GMTSO=1 Q:GMTSO=1
"RTN","GMPLUTL4",101,0)
 S X=GMTSO Q X
"RTN","GMPLUTL4",102,0)
ROK(X) ; Routine OK (in UCI)
"RTN","GMPLUTL4",103,0)
 S X=$G(X) Q:'$L(X) 0  Q:$L(X)>8 0  X ^%ZOSF("TEST") Q:$T 1  Q 0
"RTN","GMPLUTL4",104,0)
SEND(GMPLNODE,GMPLSUB,GMPLTO,GMPLFROM) ; Send a MailMan message whose text is in
"RTN","GMPLUTL4",105,0)
 ;^TMP(GMPLNODE,$J,N,0). GMPLSUB is the subject. GMPLTO is the optional
"RTN","GMPLUTL4",106,0)
 ;list of addresses, setup exactly like ;the MailMan XMY array.
"RTN","GMPLUTL4",107,0)
 ;GMPLFROM is the optional message from, if it is not defined then from will be
"RTN","GMPLUTL4",108,0)
 ;Problem List Support. This can be free text or a DUZ.
"RTN","GMPLUTL4",109,0)
 ;
"RTN","GMPLUTL4",110,0)
 N GMPLNL,XMDUZ,XMSUB,XMY,XMZ
"RTN","GMPLUTL4",111,0)
 ;
"RTN","GMPLUTL4",112,0)
 ;Make sure the subject does not exceed 64 characters.
"RTN","GMPLUTL4",113,0)
 S XMSUB=$E(GMPLSUB,1,64)
"RTN","GMPLUTL4",114,0)
 ;
"RTN","GMPLUTL4",115,0)
 ;Make the default sender Problem List.
"RTN","GMPLUTL4",116,0)
 S XMDUZ=$S($G(GMPLFROM)="":"Problem List Support",1:GMPLFROM)
"RTN","GMPLUTL4",117,0)
 ;
"RTN","GMPLUTL4",118,0)
RETRY ;Get the message number.
"RTN","GMPLUTL4",119,0)
 D XMZ^XMA2
"RTN","GMPLUTL4",120,0)
 I XMZ<1 G RETRY
"RTN","GMPLUTL4",121,0)
 ;
"RTN","GMPLUTL4",122,0)
 ;Load the message
"RTN","GMPLUTL4",123,0)
 M ^XMB(3.9,XMZ,2)=^TMP(GMPLNODE,$J)
"RTN","GMPLUTL4",124,0)
 K ^TMP(GMPLNODE,$J)
"RTN","GMPLUTL4",125,0)
 S GMPLNL=$O(^XMB(3.9,XMZ,2,""),-1)
"RTN","GMPLUTL4",126,0)
 S ^XMB(3.9,XMZ,2,0)="^3.92^"_+GMPLNL_U_+GMPLNL_U_DT
"RTN","GMPLUTL4",127,0)
 ;
"RTN","GMPLUTL4",128,0)
 ;Send message to TO list if it is defined.
"RTN","GMPLUTL4",129,0)
 I $D(GMPLTO) M XMY=GMPLTO D ENT1^XMD Q
"RTN","GMPLUTL4",130,0)
 ;
"RTN","GMPLX")
0^13^B127583491
"RTN","GMPLX",1,0)
GMPLX ; ISL/MKB,AJB,JER,TC -- Problem List Problem Utilities ;07/03/17  09:13
"RTN","GMPLX",2,0)
 ;;2.0;Problem List;**7,23,26,28,27,36,42,40,49**;Aug 25, 1994;Build 43
"RTN","GMPLX",3,0)
 ;
"RTN","GMPLX",4,0)
 ; External References
"RTN","GMPLX",5,0)
 ;  DBIA   446 ^AUTNPOV(
"RTN","GMPLX",6,0)
 ;   ICR  5679 $$IMPDATE^LEXU
"RTN","GMPLX",7,0)
 ;   ICR  5699 $$ICDDATA^ICDXCODE,$$STATCHK^ICDXCODE
"RTN","GMPLX",8,0)
 ;   ICR  5747 $$CSI/SAB^ICDEX
"RTN","GMPLX",9,0)
 ;  DBIA 10060 ^VA(200
"RTN","GMPLX",10,0)
 ;  DBIA 10006 ^DIC
"RTN","GMPLX",11,0)
 ;  DBIA 10009 FILE^DICN
"RTN","GMPLX",12,0)
 ;  DBIA 10013 EN^DIK
"RTN","GMPLX",13,0)
 ;  DBIA 10013 IX1^DIK
"RTN","GMPLX",14,0)
 ;  DBIA 10026 ^DIR
"RTN","GMPLX",15,0)
 ;  DBIA  1609 CONFIG^LEXSET
"RTN","GMPLX",16,0)
 ;  DBIA 10103 $$FMTE^XLFDT
"RTN","GMPLX",17,0)
 ;  DBIA 10104 $$UP^XLFSTR
"RTN","GMPLX",18,0)
 ;  DBIA  2742 GMPLX
"RTN","GMPLX",19,0)
 ;
"RTN","GMPLX",20,0)
SEARCH(X,Y,PROMPT,UNRES,VIEW) ; Search Lexicon for Problem X
"RTN","GMPLX",21,0)
 N DIC S:'$L($G(VIEW)) VIEW="CLF" D CONFIG^LEXSET("GMPX",VIEW,DT)
"RTN","GMPLX",22,0)
 S DIC("A")=$S($L($G(PROMPT)):PROMPT,1:"Select PROBLEM: ")
"RTN","GMPLX",23,0)
 S DIC="^LEX(757.01,",DIC(0)=$S('$L($G(X)):"A",1:"")_"EQM"
"RTN","GMPLX",24,0)
 S:'$G(UNRES) LEXUN=0 D ^DIC
"RTN","GMPLX",25,0)
 I +Y>1 D
"RTN","GMPLX",26,0)
 .N CODE,SRC
"RTN","GMPLX",27,0)
 .S X=$P(Y,U,2)
"RTN","GMPLX",28,0)
 .D EXP2CODE(+Y,.SRC,.CODE)
"RTN","GMPLX",29,0)
 .I (SRC["SNOMED")!(SRC["VHAT") S (X,$P(Y,U,2))=X_" ("_$S(SRC["SNOMED":"SCT",1:"VHAT")_" "_CODE_")",Y(1)=$$GETDX(CODE,SRC)
"RTN","GMPLX",30,0)
 Q
"RTN","GMPLX",31,0)
 ;
"RTN","GMPLX",32,0)
PROVNARR(X,CL) ; Returns IFN ^ Text of Narrative (#9999999.27)
"RTN","GMPLX",33,0)
 N DIC,Y,DLAYGO,DD,DO,DA S:$L(X)>245 X=$E(X,1,245)
"RTN","GMPLX",34,0)
 S DIC="^AUTNPOV(",DIC(0)="L",DLAYGO=9999999.27,(DA,Y)=0
"RTN","GMPLX",35,0)
 F  S DA=$O(^AUTNPOV("B",$E(X,1,30),DA)) Q:DA'>0  I $P(^AUTNPOV(DA,0),U)=X S Y=DA_U_X Q
"RTN","GMPLX",36,0)
 I '(+Y) K DA,Y D FILE^DICN S:Y'>0 Y=U_X I Y>0,CL>1 S ^AUTNPOV(+Y,757)=CL
"RTN","GMPLX",37,0)
 Q $P(Y,U,1,2)
"RTN","GMPLX",38,0)
 ;
"RTN","GMPLX",39,0)
PROBTEXT(IFN) ; Returns Display Text
"RTN","GMPLX",40,0)
 N X,Y,ICD,SCTC,GMPL0,GMPL800,GMPL802,GMPLEXP,GMPLPOV,GMPLSO,GMPLTXT,GMPLDT,GMPLCSYS,GMPLILBL
"RTN","GMPLX",41,0)
 S GMPL0=$G(^AUPNPROB(IFN,0)),GMPL800=$G(^(800)),GMPL802=$G(^(802))
"RTN","GMPLX",42,0)
 I '$L(GMPL0) S X="" G PROBTX
"RTN","GMPLX",43,0)
 S GMPLDT=$S(+$P(GMPL802,U,1):$P(GMPL802,U,1),1:$P(GMPL0,U,8)),GMPLCSYS=$S($P(GMPL802,U,2)]"":$P(GMPL802,U,2),1:$$SAB^ICDEX($$CSI^ICDEX(80,+GMPL0),GMPLDT))
"RTN","GMPLX",44,0)
 S GMPLILBL=$S(GMPLCSYS="10D":"ICD-10-CM ",1:"ICD-9-CM ")
"RTN","GMPLX",45,0)
 S ICD=$P($$ICDDATA^ICDXCODE(GMPLCSYS,+GMPL0,GMPLDT,"I"),U,2),SCTC=$P(GMPL800,U)
"RTN","GMPLX",46,0)
 S Y=$P($G(^AUPNPROB(+IFN,0)),U,5),X=$P($G(^AUTNPOV(+Y,0)),U)
"RTN","GMPLX",47,0)
 S GMPLEXP=$$EP(IFN),GMPLSO=$$CS(X),GMPLPOV=$$PT(X,GMPLSO)
"RTN","GMPLX",48,0)
 S GMPLTXT=GMPLPOV S:$L(GMPLEXP) GMPLTXT=GMPLTXT_" ("_GMPLEXP_")"
"RTN","GMPLX",49,0)
 ;S:$L(GMPLSO)&(GMPLSO'["SNOMED") GMPLTXT=GMPLTXT_" "_GMPLSO
"RTN","GMPLX",50,0)
 S:GMPLTXT["*" GMPLTXT=$TR(GMPLTXT,"*","")
"RTN","GMPLX",51,0)
 ;S:$L(GMPLTXT) GMPLTXT=GMPLTXT_" ("_$$HFP^GMPLUTL4_","_$$PTR^GMPLUTL4_")"
"RTN","GMPLX",52,0)
 S:$L(GMPLTXT) GMPLTXT=GMPLTXT_$S($L($G(ICD))&('$L($G(SCTC))):" ("_GMPLILBL_$G(ICD)_")",$L($G(SCTC)):" (SCT "_$G(SCTC)_")",1:"")
"RTN","GMPLX",53,0)
 S:$L(GMPLTXT) X=GMPLTXT
"RTN","GMPLX",54,0)
PROBTX Q X
"RTN","GMPLX",55,0)
PROBNARR(IFN) ; Returns Provider Narrative
"RTN","GMPLX",56,0)
 N X,Y S Y=$P($G(^AUPNPROB(+IFN,0)),U,5),X=$P($G(^AUTNPOV(+Y,0)),U)
"RTN","GMPLX",57,0)
 Q X
"RTN","GMPLX",58,0)
CS(X) ; Problem Codes
"RTN","GMPLX",59,0)
 N GMPLSAB,GMPLSO S GMPLSO="" S X=$G(X) Q:X'["(" ""
"RTN","GMPLX",60,0)
 F GMPLSAB="ICD-","CPT-","DSM-","HCPCS","NANDA","NIC","NOC","LOINC","SNOMED","OMAHA","SCT" S:$G(X)[("("_GMPLSAB) GMPLSO="("_GMPLSAB_$P(X,("("_GMPLSAB),2,299) Q:$L(GMPLSO)
"RTN","GMPLX",61,0)
 I $L(GMPLSO) S X=GMPLSO Q X
"RTN","GMPLX",62,0)
 F GMPLSAB="ACR","AI/RHEUM","CONGRESS","COSTAR","COSTART","CRISP","DODFAC" S:$G(X)[("("_GMPLSAB) GMPLSO="("_GMPLSAB_$P(X,("("_GMPLSAB),2,299) Q:$L(GMPLSO)
"RTN","GMPLX",63,0)
 I $L(GMPLSO) S X=GMPLSO Q X
"RTN","GMPLX",64,0)
 F GMPLSAB="DORLAND","DXPLAIN","HHCC","MCMASTER","META","MTF","MeSH","RVC","TITLE 38","UMDNS","UWA" S:$G(X)[("("_GMPLSAB) GMPLSO="("_GMPLSAB_$P(X,("("_GMPLSAB),2,299) Q:$L(GMPLSO)
"RTN","GMPLX",65,0)
 I $L(GMPLSO) S X=GMPLSO Q X
"RTN","GMPLX",66,0)
 Q ""
"RTN","GMPLX",67,0)
EP(X) ; Exposures
"RTN","GMPLX",68,0)
 N GMPLSC S X=+($G(X)) D SCS^GMPLX1(+X,.GMPLSC) S X=$G(GMPLSC(1)) Q X
"RTN","GMPLX",69,0)
PT(X,C) ; Problem Text (only)
"RTN","GMPLX",70,0)
 N GMPLTERM,GMPLSO S GMPLTERM=$G(X),GMPLSO=$G(C)
"RTN","GMPLX",71,0)
 S:$L(GMPLSO)&(GMPLTERM[GMPLSO) GMPLTERM=$P(GMPLTERM,GMPLSO,1) S GMPLTERM=$$TRIM(GMPLTERM)
"RTN","GMPLX",72,0)
 S:$L(GMPLTERM) X=GMPLTERM Q X
"RTN","GMPLX",73,0)
TRIM(X) ; Trim Spaces and "*"
"RTN","GMPLX",74,0)
 S X=$G(X) F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMPLX",75,0)
 F  Q:$E(X,$L(X))'="*"  S X=$E(X,1,($L(X)-1))
"RTN","GMPLX",76,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","GMPLX",77,0)
 F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","GMPLX",78,0)
 Q X
"RTN","GMPLX",79,0)
WRAP(PROB,MAX,TEXT) ; Splits Text into TEXT array
"RTN","GMPLX",80,0)
 N I,J S J=0 K TEXT I $L(PROB)'>MAX S J=J+1,TEXT(J)=PROB G WRQ
"RTN","GMPLX",81,0)
WR0 ;   Loop for Remaining Text
"RTN","GMPLX",82,0)
 S I=$F(PROB," ") I ('I)!(I>(MAX+2)) S J=J+1,TEXT(J)=$E(PROB,1,MAX),PROB=$E(PROB,MAX+1,999)
"RTN","GMPLX",83,0)
 I $L(PROB)>MAX F I=(MAX+1):-1:1 I $E(PROB,I)=" " S J=J+1,TEXT(J)=$E(PROB,1,I-1),PROB=$E(PROB,I+1,999) Q
"RTN","GMPLX",84,0)
 G:$L(PROB)>MAX WR0
"RTN","GMPLX",85,0)
 S:$L(PROB) J=J+1,TEXT(J)=PROB
"RTN","GMPLX",86,0)
WRQ ;   Quit Wrap
"RTN","GMPLX",87,0)
 S TEXT=J
"RTN","GMPLX",88,0)
 Q
"RTN","GMPLX",89,0)
 ;
"RTN","GMPLX",90,0)
NOS(GMPLCSYS,GMPLDT) ; Return PTR ^ 799.9 or PTR ^ R69 ICD code
"RTN","GMPLX",91,0)
 N GMPIMPDT S GMPIMPDT=$$IMPDATE^LEXU("10D")
"RTN","GMPLX",92,0)
 S:'$D(GMPLDT) GMPLDT=DT
"RTN","GMPLX",93,0)
 S:'$D(GMPLCSYS) GMPLCSYS=$S(GMPLDT<GMPIMPDT:"ICD",1:"10D")
"RTN","GMPLX",94,0)
 Q $S(GMPLCSYS="10D":+$$ICDDATA^ICDXCODE(GMPLCSYS,"R69.",GMPLDT,"E")_"^R69.",1:+$$ICDDATA^ICDXCODE(GMPLCSYS,"799.9",GMPLDT,"E")_"^799.9")
"RTN","GMPLX",95,0)
 ;
"RTN","GMPLX",96,0)
SEL(HELP) ; Select List of Problems
"RTN","GMPLX",97,0)
 N X,Y,DIR,MAX,DTOUT S MAX=+$G(^TMP("GMPL",$J,0)) I MAX'>0 Q "^"
"RTN","GMPLX",98,0)
 S DIR(0)="LAO^1:"_MAX,DIR("A")="Select Problem(s)"
"RTN","GMPLX",99,0)
 S:MAX>1 DIR("A")=DIR("A")_" (1-"_MAX_"): "
"RTN","GMPLX",100,0)
 S:MAX'>1 DIR("A")=DIR("A")_": ",DIR("B")=1
"RTN","GMPLX",101,0)
 S DIR("?")="Enter the problems you wish to "
"RTN","GMPLX",102,0)
 S DIR("?")=DIR("?")_$S($L(HELP):HELP,1:"act on")_", as a range or list of numbers"
"RTN","GMPLX",103,0)
 D ^DIR I $D(DTOUT)!(X="") S Y="^"
"RTN","GMPLX",104,0)
 Q Y
"RTN","GMPLX",105,0)
 ;
"RTN","GMPLX",106,0)
SEL1(HELP) ; Select 1 Problem
"RTN","GMPLX",107,0)
 N X,Y,DIR,MAX,DTOUT S MAX=+$G(^TMP("GMPL",$J,0)) I MAX'>0 Q "^"
"RTN","GMPLX",108,0)
 S DIR(0)="NAO^1:"_MAX_":0",DIR("A")="Select Problem"
"RTN","GMPLX",109,0)
 S:MAX>1 DIR("A")=DIR("A")_" (1-"_MAX_"): "
"RTN","GMPLX",110,0)
 S:MAX'>1 DIR("A")=DIR("A")_": ",DIR("B")=1
"RTN","GMPLX",111,0)
 S DIR("?")="Enter the number of the problem you wish to "
"RTN","GMPLX",112,0)
 S DIR("?")=DIR("?")_$S($L(HELP):HELP,1:"act on")
"RTN","GMPLX",113,0)
 D ^DIR I $D(DTOUT)!(X="") S Y="^"
"RTN","GMPLX",114,0)
 Q Y
"RTN","GMPLX",115,0)
 ;
"RTN","GMPLX",116,0)
DUPL(DFN,TERM,TEXT) ; Check for Duplicates
"RTN","GMPLX",117,0)
 N DA,IFN,GMPOTHR,GMPNOW S DA=0,TEXT=$$UP^XLFSTR($S(TEXT["SCT":$P(TEXT," (SCT"),1:TEXT))
"RTN","GMPLX",118,0)
 I '$D(^AUPNPROB("AC",DFN)) G DUPLX
"RTN","GMPLX",119,0)
 S GMPNOW=$E($$NOW^XLFDT,1,7)
"RTN","GMPLX",120,0)
 S GMPOTHR=$S(GMPNOW<($$IMPDATE^LEXU("10D")):"799.9",1:"R69.")
"RTN","GMPLX",121,0)
 F IFN=0:0 S IFN=$O(^AUPNPROB("AC",DFN,IFN)) Q:IFN'>0  D  Q:DA>0
"RTN","GMPLX",122,0)
 .N PICDOLD,PICDNEW,NODE0,NODE1,NODE800,NODE802,NODE803,SCTD,PROVNAR,EXPTXT,GMPSRC,GMPCODE,GMPLDT,GMPLCSYS
"RTN","GMPLX",123,0)
 .S NODE0=$G(^AUPNPROB(IFN,0)),NODE1=$G(^(1)),NODE800=$G(^(800)),NODE802=$G(^(802)),NODE803=$G(^(803,0)) Q:$P(NODE1,U,2)="H"
"RTN","GMPLX",124,0)
 .S GMPLDT=$S(+$P(NODE802,U,1):$P(NODE802,U,1),1:$P(NODE0,U,8)),GMPLCSYS=$S($P(NODE802,U,2)]"":$P(NODE802,U,2),1:$$SAB^ICDEX($$CSI^ICDEX(80,+NODE0),GMPLDT))
"RTN","GMPLX",125,0)
 .S PICDOLD=$P($$ICDDATA^ICDXCODE(GMPLCSYS,+NODE0,GMPLDT,"I"),U,2)
"RTN","GMPLX",126,0)
 .D EXP2CODE(TERM,.GMPSRC,.GMPCODE)
"RTN","GMPLX",127,0)
 .S ICDNEW=$S(GMPSRC="SNOMED CT":$$GETDX(GMPCODE,GMPSRC),1:GMPCODE)
"RTN","GMPLX",128,0)
 .S PICDNEW=$P(ICDNEW,"/")
"RTN","GMPLX",129,0)
 .;Compare problems with SNOMED CT concept codes & ICD code(s) only
"RTN","GMPLX",130,0)
 .I +NODE800,(GMPSRC="SNOMED CT"),(+$G(GMPCODE)>0),($L(ICDNEW)) D  Q
"RTN","GMPLX",131,0)
 ..;if SCT concepts & primary + multiple ICD targets match => dup
"RTN","GMPLX",132,0)
 ..I $P(NODE803,U,4)>0,ICDNEW["/" D
"RTN","GMPLX",133,0)
 ...N I,J,SICDNEW S J=0 F I=2:1:$L(ICDNEW,"/") D
"RTN","GMPLX",134,0)
 ....S J=J+1,SICDNEW(J)=$P(ICDNEW,"/",I)
"RTN","GMPLX",135,0)
 ...N T F T=1:1:J D
"RTN","GMPLX",136,0)
 ....N IEN S IEN=0 F  S IEN=$O(^AUPNPROB(IFN,803,IEN)) Q:'+IEN  D
"RTN","GMPLX",137,0)
 .....I +NODE800=GMPCODE,(PICDOLD=PICDNEW),$P($G(^AUPNPROB(IFN,803,IEN,0)),U)=SICDNEW(T) S DA=IFN Q
"RTN","GMPLX",138,0)
 ..;if SCT concept codes match => dup
"RTN","GMPLX",139,0)
 ..E  I ICDNEW=GMPOTHR!(PICDNEW=GMPOTHR) D
"RTN","GMPLX",140,0)
 ...I +NODE800=GMPCODE S DA=IFN Q
"RTN","GMPLX",141,0)
 ..;if SCT concepts & primary ICD diagnosis match => dup
"RTN","GMPLX",142,0)
 ..E  I +NODE800=GMPCODE,(PICDOLD=PICDNEW) S DA=IFN Q
"RTN","GMPLX",143,0)
 .;Compare legacy problems with ICD codes only
"RTN","GMPLX",144,0)
 .E  I +NODE0,'$L($G(NODE800)),(GMPSRC["ICD"),(+$G(GMPCODE)>0) D
"RTN","GMPLX",145,0)
 ..;if Exprs match => dup
"RTN","GMPLX",146,0)
 ..I TERM>1&(+NODE1=TERM) S DA=IFN Q
"RTN","GMPLX",147,0)
 ..;if Text matches Expr from old => dup
"RTN","GMPLX",148,0)
 ..D LOOK^LEXA("`"_+NODE1)
"RTN","GMPLX",149,0)
 ..S EXPTXT=$P($G(LEX("LIST",1)),U,2)
"RTN","GMPLX",150,0)
 ..I LEX>1&(TEXT=$$UP^XLFSTR($S(EXPTXT["*":$P(EXPTXT," *"),1:EXPTXT))) S DA=IFN Q
"RTN","GMPLX",151,0)
 ..;if Text matches Prov Narr of old => dup
"RTN","GMPLX",152,0)
 ..S PROVNAR=$S($P(NODE0,U,5)]"":$P(^AUTNPOV($P(NODE0,U,5),0),U),1:"")
"RTN","GMPLX",153,0)
 ..I TEXT=$$UP^XLFSTR($S(PROVNAR["SNOMED":$P(PROVNAR," (SN"),PROVNAR[" *":$P(PROVNAR,"*"),1:PROVNAR)) S DA=IFN Q
"RTN","GMPLX",154,0)
 ..;if prim ICD of new = prim ICD of old => dup
"RTN","GMPLX",155,0)
 ..I PICDOLD'=GMPOTHR,(PICDNEW'=GMPOTHR),(PICDOLD=PICDNEW) S DA=IFN Q
"RTN","GMPLX",156,0)
DUPLX Q DA
"RTN","GMPLX",157,0)
 ;
"RTN","GMPLX",158,0)
DUPLOK(IFN) ; Ask if Dup OK
"RTN","GMPLX",159,0)
 N DIR,X,Y,GMPL0,GMPL1,DATE,PROV S DIR(0)="YA",GMPL0=$G(^AUPNPROB(IFN,0)),GMPL1=$G(^(1))
"RTN","GMPLX",160,0)
 S DIR("A")="Are you sure you want to continue? ",DIR("B")="NO"
"RTN","GMPLX",161,0)
 S DIR("?",1)="Enter YES if you want to duplicate this problem on this patient's list;",DIR("?")="press <return> to re-enter the problem name."
"RTN","GMPLX",162,0)
 W $C(7),!!,">>>  "_$$PROBTEXT(IFN),!?5,"is already an "
"RTN","GMPLX",163,0)
 W $S($P(GMPL0,U,12)="I":"IN",1:"")_"ACTIVE problem on this patient's list!",!
"RTN","GMPLX",164,0)
 S PROV=+$P(GMPL1,U,5) W:PROV !?5,"Provider: "_$P($G(^VA(200,PROV,0)),U)_" ("_$P($$SERVICE^GMPLX1(PROV),U,2)_")"
"RTN","GMPLX",165,0)
 I $P(GMPL0,U,12)="A" W !?8,"Onset: " S DATE=$P(GMPL0,U,13)
"RTN","GMPLX",166,0)
 I $P(GMPL0,U,12)="I" W !?5,"Resolved: " S DATE=$P(GMPL1,U,7)
"RTN","GMPLX",167,0)
 W $S(DATE>0:$$FMTE^XLFDT(DATE),1:"unspecified"),!
"RTN","GMPLX",168,0)
 D ^DIR W !
"RTN","GMPLX",169,0)
 Q +Y
"RTN","GMPLX",170,0)
 ;
"RTN","GMPLX",171,0)
LOCKED() ; Return Lock Msg
"RTN","GMPLX",172,0)
 Q "This problem is currently being edited by another user!"
"RTN","GMPLX",173,0)
 ;
"RTN","GMPLX",174,0)
SURE() ; Ask to Delete
"RTN","GMPLX",175,0)
 ;   Returns 1 if YES, else 0
"RTN","GMPLX",176,0)
 N DIR,X,Y S DIR(0)="YA",DIR("B")="NO"
"RTN","GMPLX",177,0)
 S DIR("?")="Enter YES to remove this value or NO to leave it unchanged."
"RTN","GMPLX",178,0)
 S DIR("A")="Are you sure you want to remove this value? " D ^DIR
"RTN","GMPLX",179,0)
 Q +Y
"RTN","GMPLX",180,0)
 ;
"RTN","GMPLX",181,0)
EXTDT(DATE) ; Format Date as MM/DD/YY
"RTN","GMPLX",182,0)
 N X,MM,DD,YY,YYY S X="",DATE=$P(DATE,".") Q:'DATE ""
"RTN","GMPLX",183,0)
 S MM=+$E(DATE,4,5),DD=+$E(DATE,6,7),YY=$E(DATE,2,3),YYY=$E(DATE,1,3)
"RTN","GMPLX",184,0)
 S:MM X=MM_"/" S:DD X=X_DD_"/" S X=$S($L(X):X_YY,1:1700+YYY)
"RTN","GMPLX",185,0)
 Q X
"RTN","GMPLX",186,0)
 ;
"RTN","GMPLX",187,0)
AUDIT(DATA,OLD) ; Make Entry in Audit File
"RTN","GMPLX",188,0)
 ; DATA = string for 0-node
"RTN","GMPLX",189,0)
 ; OLD  = string for 1-node
"RTN","GMPLX",190,0)
 ;      = 0-node from reform/react problem
"RTN","GMPLX",191,0)
 N DA,DD,DO,DIC,X,Y,DIK,DLAYGO
"RTN","GMPLX",192,0)
 S DIC="^GMPL(125.8,",DIC(0)="L",X=$P(DATA,U),DLAYGO=125.8
"RTN","GMPLX",193,0)
 D FILE^DICN Q:+Y'>0  S DA=+Y,DIK="^GMPL(125.8,"
"RTN","GMPLX",194,0)
 S ^GMPL(125.8,DA,0)=DATA D IX1^DIK
"RTN","GMPLX",195,0)
 S:$L(OLD) ^GMPL(125.8,DA,1)=OLD
"RTN","GMPLX",196,0)
 Q
"RTN","GMPLX",197,0)
 ;
"RTN","GMPLX",198,0)
DTMOD(DA) ; Update Date Modified
"RTN","GMPLX",199,0)
 N DIE,DR
"RTN","GMPLX",200,0)
 S DR=".03///TODAY",DIE="^AUPNPROB("
"RTN","GMPLX",201,0)
 D ^DIE
"RTN","GMPLX",202,0)
 ; broadcast problem change events
"RTN","GMPLX",203,0)
 N GMPIFN,DFN,X
"RTN","GMPLX",204,0)
 S GMPIFN=DA,DFN=+$P($G(^AUPNPROB(DA,0)),U,2)
"RTN","GMPLX",205,0)
 S X=+$O(^ORD(101,"B","GMPL EVENT",0))_";ORD(101," D:X EN1^XQOR
"RTN","GMPLX",206,0)
 Q
"RTN","GMPLX",207,0)
 ;
"RTN","GMPLX",208,0)
MSG() ; ListMan Msg Bar
"RTN","GMPLX",209,0)
 Q "+ Next Screen  - Prev Screen  ?? More actions"
"RTN","GMPLX",210,0)
 ;
"RTN","GMPLX",211,0)
KILL ; Clean-Up Vars
"RTN","GMPLX",212,0)
 K X,Y,DIC,DIE,DR,DA,DUOUT,DTOUT,GMPQUIT,GMPRT,GMPSAVED,GMPIFN,GMPLNO,GMPLNUM,GMPLSEL,GMPREBLD,GMPI,GMPLSLST,GMPLJUMP
"RTN","GMPLX",213,0)
 Q
"RTN","GMPLX",214,0)
 ;
"RTN","GMPLX",215,0)
CODESTS(PROB,ADATE) ;check status of ICD
"RTN","GMPLX",216,0)
 ; Input:
"RTN","GMPLX",217,0)
 ;  PROB  = pointer to the PROBLEM (#9000011) file
"RTN","GMPLX",218,0)
 ;  ADATE = FM date on which to check the status (opt.)
"RTN","GMPLX",219,0)
 ;
"RTN","GMPLX",220,0)
 ; Output:
"RTN","GMPLX",221,0)
 ;  1 = ACTIVE on the date passed or current date
"RTN","GMPLX",222,0)
 ;  0 = INACTIVE on the date passed or current date
"RTN","GMPLX",223,0)
 ;
"RTN","GMPLX",224,0)
 I '$G(ADATE) S ADATE=DT
"RTN","GMPLX",225,0)
 I '$D(^AUPNPROB(PROB,0)) Q 0
"RTN","GMPLX",226,0)
 N GMPL0,GMPL802,GMPLCSYS,GMPLCPTR,GMPLICD S GMPL0=$G(^AUPNPROB(PROB,0)),GMPL802=$G(^(802))
"RTN","GMPLX",227,0)
 S GMPLCPTR=$$CSI^ICDEX(80,+GMPL0),GMPLCSYS=$S($P(GMPL802,U,2)]"":$P(GMPL802,U,2),1:$$SAB^ICDEX(GMPLCPTR,ADATE))
"RTN","GMPLX",228,0)
 S GMPLICD=$P($$ICDDATA^ICDXCODE(GMPLCSYS,+GMPL0,ADATE,"I"),U,2)
"RTN","GMPLX",229,0)
 Q +$$STATCHK^ICDXCODE(GMPLCPTR,GMPLICD,ADATE)
"RTN","GMPLX",230,0)
EXP2CODE(X,GMPSRC,GMPCODE) ; Resolve SOURCE and CODE from Expression
"RTN","GMPLX",231,0)
 N LEX,SRCCODE,GMI S GMI=0,(GMPSRC,GMPCODE)=""
"RTN","GMPLX",232,0)
 D INFO^LEXA(X,DT)
"RTN","GMPLX",233,0)
 F  S GMI=$O(LEX("SEL","SRC",GMI)) Q:+GMI'>0  D  Q:($G(GMPSRC)]"")
"RTN","GMPLX",234,0)
 . S SRCCODE=$P($G(LEX("SEL","SRC",GMI)),U,1,2)
"RTN","GMPLX",235,0)
 . I $P(SRCCODE,U)["SNOMED CT"!($P(SRCCODE,U)["VHAT")!($P(SRCCODE,U)["ICD") S GMPSRC=$P(SRCCODE,U),GMPCODE=$P(SRCCODE,U,2)
"RTN","GMPLX",236,0)
 Q
"RTN","GMPLX",237,0)
GETDX(CODE,CODESYS,GMPDT) ; Get ICD associated with SCT or VHAT Code
"RTN","GMPLX",238,0)
 N LEX,GMPI,GMPY,GMPMPDEF,GMPIMPDT S GMPDT=$G(GMPDT,$$DT^XLFDT)
"RTN","GMPLX",239,0)
 S GMPY=0,GMPIMPDT=$$IMPDATE^LEXU("10D")
"RTN","GMPLX",240,0)
 S GMPMPDEF=$S(GMPDT<GMPIMPDT:"SCT2ICD",1:"SCT210D")
"RTN","GMPLX",241,0)
 I CODESYS["VHAT" S GMPY=$$GETASSN^LEXTRAN1(CODE,"VHAT2ICD",GMPDT) I 1
"RTN","GMPLX",242,0)
 E  S GMPY=$$GETASSN^LEXTRAN1(CODE,GMPMPDEF,GMPDT)
"RTN","GMPLX",243,0)
 I $S(+GMPY'>0:1,+$P(GMPY,U,2)'>0:1,+LEX'>0:1,1:0) S GMPY=$S(GMPDT<GMPIMPDT:"799.9",1:"R69.") G GETDXX
"RTN","GMPLX",244,0)
 S (GMPI,GMPY)=0
"RTN","GMPLX",245,0)
 F  S GMPI=$O(LEX(GMPI)) Q:+GMPI'>0  D
"RTN","GMPLX",246,0)
 .N ICD
"RTN","GMPLX",247,0)
 .S ICD=$O(LEX(GMPI,""))
"RTN","GMPLX",248,0)
 .I ICD]"" S GMPY=$S(GMPY'=0:GMPY_"/",1:"")_ICD
"RTN","GMPLX",249,0)
 I GMPY'["." S GMPY=GMPY_"."
"RTN","GMPLX",250,0)
GETDXX Q GMPY
"RTN","GMPLX",251,0)
PAD(GMPX,GMPL) ; Pads string to specified length
"RTN","GMPLX",252,0)
 N GMPY
"RTN","GMPLX",253,0)
 S GMPY="",$P(GMPY," ",(GMPL-$L(GMPX))+1)=""
"RTN","GMPLX",254,0)
 Q GMPY
"RTN","GMPLX",255,0)
GETEXIEN(GMPLSCTC,GMPLSCTD) ; Get Lexicon Expression IEN for SNOMED term
"RTN","GMPLX",256,0)
 N GMPLSYN,GMPLDT,GMPLRSLT,GMPLIEN,GMPLTYP,GMPLQT,GMPLNUM
"RTN","GMPLX",257,0)
 I '$D(GMPLSCTC)!('$D(GMPLSCTD)) S GMPLIEN="-1^Missing "_$S('$D(GMPLSCTC):"SNOMED CT Concept ID",1:"SNOMED CT Designation ID") G GETEXQT
"RTN","GMPLX",258,0)
 S GMPLDT=$$DT^XLFDT,(GMPLTYP,GMPLNUM,GMPLQT)=""
"RTN","GMPLX",259,0)
 S GMPLRSLT=$$GETSYN^LEXTRAN1("SCT",GMPLSCTC,GMPLDT,"GMPLSYN",1,1)
"RTN","GMPLX",260,0)
 I +GMPLRSLT<0 S GMPLIEN=GMPLRSLT G GETEXQT
"RTN","GMPLX",261,0)
 F  S GMPLTYP=$O(GMPLSYN(GMPLTYP)) Q:GMPLTYP=""!(GMPLQT)  D
"RTN","GMPLX",262,0)
 . I GMPLTYP="S" D
"RTN","GMPLX",263,0)
 . . F  S GMPLNUM=$O(GMPLSYN(GMPLTYP,GMPLNUM)) Q:GMPLNUM=""!(GMPLQT)  D
"RTN","GMPLX",264,0)
 . . . I $P(GMPLSYN(GMPLTYP,GMPLNUM),U,3)=GMPLSCTD S GMPLIEN=$P(GMPLSYN(GMPLTYP,GMPLNUM),U,2),GMPLQT=1 Q
"RTN","GMPLX",265,0)
 . . Q:GMPLQT
"RTN","GMPLX",266,0)
 . E  I $P(GMPLSYN(GMPLTYP),U,3)=GMPLSCTD S GMPLIEN=$P(GMPLSYN(GMPLTYP),U,2),GMPLQT=1 Q
"RTN","GMPLX",267,0)
 I GMPLQT="" S GMPLIEN="-1^Cannot find Expression IEN"
"RTN","GMPLX",268,0)
GETEXQT Q GMPLIEN
"RTN","GMPLX",269,0)
STRIPSPC(GMPLTXT) ; Strip string of spaces and convert to all uppercase for comparison
"RTN","GMPLX",270,0)
 N GMPLSTR,GMPLCHAR S GMPLCHAR=" "
"RTN","GMPLX",271,0)
 S GMPLSTR=$$UP^XLFSTR($$STRIP^XLFSTR(GMPLTXT,GMPLCHAR))
"RTN","GMPLX",272,0)
 Q GMPLSTR
"RTN","GMPLX",273,0)
 ;
"RTN","GMPLX",274,0)
MIXLOWCS(GMPLTXT) ; Check for mix/lower case
"RTN","GMPLX",275,0)
 N GMPLRSLT,GMPLPUNC S GMPLRSLT=0
"RTN","GMPLX",276,0)
 S GMPLPUNC=" ,!,"",#,$,%,&,',(,),*,+,-,,,_,.,/,\,:,;,<,=,>,?,@,[,],^,`,~,|,{,}"
"RTN","GMPLX",277,0)
 S GMPLTXT=$$STRIP^XLFSTR($TR(GMPLTXT,GMPLPUNC," ")," ")
"RTN","GMPLX",278,0)
 I GMPLTXT?.L1.(1.U1.L)!(GMPLTXT?1.L) S GMPLRSLT=1
"RTN","GMPLX",279,0)
 Q GMPLRSLT
"RTN","GMPLX",280,0)
 ;
"RTN","GMPLX",281,0)
PAUSE ; Pause for user to process info
"RTN","GMPLX",282,0)
 I $E(IOST,1,2)="C-" D
"RTN","GMPLX",283,0)
 . N DIR,DTOUT,DIRUT,DUOUT,X,Y
"RTN","GMPLX",284,0)
 . S DIR(0)="E" D ^DIR
"RTN","GMPLX",285,0)
 Q
"RTN","GMPLY49")
0^^B185098073
"RTN","GMPLY49",1,0)
GMPLY49 ;ISP/TC - Pre/Post Install Routine for GMPL*2.0*49 ;08/23/17  08:15
"RTN","GMPLY49",2,0)
 ;;2.0;Problem List;**49**;Aug 25, 1994;Build 43
"RTN","GMPLY49",3,0)
 ;
"RTN","GMPLY49",4,0)
 ; External References:
"RTN","GMPLY49",5,0)
 ;   ICR  872    PROTOCOL FILE #101
"RTN","GMPLY49",6,0)
 ;   ICR  1157   OUT^XPDMENU
"RTN","GMPLY49",7,0)
 ;   ICR  2051   $$FIND1^DIC
"RTN","GMPLY49",8,0)
 ;   ICR  2053   FILE^DIE
"RTN","GMPLY49",9,0)
 ;   ICR  10014  EN^DIU2
"RTN","GMPLY49",10,0)
 ;   ICR  10104  $$LJ/$$UP^XLFSTR
"RTN","GMPLY49",11,0)
 ;   ICR  10141  BMES/MES/PATCH^XPDUTL
"RTN","GMPLY49",12,0)
 ;   ICR  10156  OPTION FILE #19
"RTN","GMPLY49",13,0)
 ;
"RTN","GMPLY49",14,0)
ASGNRPT ; Retrieve pre-existing user/clinic selection list assignment report
"RTN","GMPLY49",15,0)
 N GMPLULST,GMPLCLST,GMPLELST,GMPLTXT
"RTN","GMPLY49",16,0)
 D GETUSRLT^GMPLSLRP(.GMPLULST,.GMPLELST)
"RTN","GMPLY49",17,0)
 D GETCLNLT^GMPLSLRP(.GMPLCLST)
"RTN","GMPLY49",18,0)
 I $D(GMPLULST)!($D(GMPLCLST))!($D(GMPLELST)) D
"RTN","GMPLY49",19,0)
 . D SENDARPT(.GMPLULST,.GMPLCLST,.GMPLELST)
"RTN","GMPLY49",20,0)
 . D MES^XPDUTL("  Report has been generated to the installer & OR CACS mailgroup via MailMan.")
"RTN","GMPLY49",21,0)
 E  D MES^XPDUTL("  No pre-existing USER or CLINIC selection list assignments found.")
"RTN","GMPLY49",22,0)
 I $D(GMPLELST) D
"RTN","GMPLY49",23,0)
 . N GMPLUSR,GMPLLST,GMPLFDA,GMPLDUZ,GMPLMSG,GMPLSUC
"RTN","GMPLY49",24,0)
 . S (GMPLUSR,GMPLLST)="",GMPLSUC=1
"RTN","GMPLY49",25,0)
 . D BMES^XPDUTL("  Removing invalid USER selection list assignments for...")
"RTN","GMPLY49",26,0)
 . F  S GMPLUSR=$O(GMPLELST(GMPLUSR)) Q:GMPLUSR=""  D
"RTN","GMPLY49",27,0)
 . . F  S GMPLLST=$O(GMPLELST(GMPLUSR,GMPLLST)) Q:GMPLLST=""  D
"RTN","GMPLY49",28,0)
 . . . D MES^XPDUTL("     "_GMPLUSR_": Invalid Selection List #"_GMPLLST_"")
"RTN","GMPLY49",29,0)
 . . . S GMPLDUZ=$G(GMPLELST(GMPLUSR,GMPLLST))
"RTN","GMPLY49",30,0)
 . . . S GMPLFDA(200,""_GMPLDUZ_",",125.1)="@"
"RTN","GMPLY49",31,0)
 . . . D FILE^DIE("K","GMPLFDA","GMPLMSG")
"RTN","GMPLY49",32,0)
 . . . I $D(GMPLMSG) S GMPLSUC=0 D MES^XPDUTL("     Error: "_GMPLMSG("DIERR",1,"TEXT",1))
"RTN","GMPLY49",33,0)
 . I GMPLSUC D MES^XPDUTL("  Done.")
"RTN","GMPLY49",34,0)
 K GMPLULST,GMPLCLST,GMPLELST
"RTN","GMPLY49",35,0)
 Q
"RTN","GMPLY49",36,0)
 ;
"RTN","GMPLY49",37,0)
CASECHK ; Check for mixed/lower case list/category name entries
"RTN","GMPLY49",38,0)
 N GMPLLIST,GMPLCAT,GMPLLNM,GMPLCNM,GMPLLDA,GMPLCDA,GMPLMSG,GMPLFDA,GMPLERR,GMPLTXT
"RTN","GMPLY49",39,0)
 S (GMPLLNM,GMPLCNM,GMPLLDA,GMPLCDA)=""
"RTN","GMPLY49",40,0)
 F  S GMPLLNM=$O(^GMPL(125,"B",GMPLLNM)) Q:GMPLLNM=""  D
"RTN","GMPLY49",41,0)
 . F  S GMPLLDA=$O(^GMPL(125,"B",GMPLLNM,GMPLLDA)) Q:GMPLLDA=""  D
"RTN","GMPLY49",42,0)
 . . I $$MIXLOWCS^GMPLX(GMPLLNM) D
"RTN","GMPLY49",43,0)
 . . . S GMPLFDA(125,""_GMPLLDA_",",.01)=$$UP^XLFSTR(GMPLLNM)
"RTN","GMPLY49",44,0)
 . . . D FILE^DIE("EK","GMPLFDA","GMPLMSG")
"RTN","GMPLY49",45,0)
 . . . I $D(GMPLMSG) D
"RTN","GMPLY49",46,0)
 . . . . S GMPLLIST("FAIL",GMPLLNM)="Record #"_GMPLLDA_U_"Error: "_GMPLMSG("DIERR",1,"TEXT",1)
"RTN","GMPLY49",47,0)
 . . . . K GMPLMSG
"RTN","GMPLY49",48,0)
 . . . E  S GMPLLIST("PASS",GMPLLNM)=""
"RTN","GMPLY49",49,0)
 F  S GMPLCNM=$O(^GMPL(125.11,"B",GMPLCNM)) Q:GMPLCNM=""  D
"RTN","GMPLY49",50,0)
 . F  S GMPLCDA=$O(^GMPL(125.11,"B",GMPLCNM,GMPLCDA)) Q:GMPLCDA=""  D
"RTN","GMPLY49",51,0)
 . . I $$MIXLOWCS^GMPLX(GMPLCNM) D
"RTN","GMPLY49",52,0)
 . . . S GMPLFDA(125.11,""_GMPLCDA_",",.01)=$$UP^XLFSTR(GMPLCNM)
"RTN","GMPLY49",53,0)
 . . . D FILE^DIE("EK","GMPLFDA","GMPLERR")
"RTN","GMPLY49",54,0)
 . . . I $D(GMPLERR) D
"RTN","GMPLY49",55,0)
 . . . . S GMPLCAT("FAIL",GMPLCNM)="Record #"_GMPLCDA_U_"Error: "_GMPLERR("DIERR",1,"TEXT",1)
"RTN","GMPLY49",56,0)
 . . . . K GMPLERR
"RTN","GMPLY49",57,0)
 . . . E  S GMPLCAT("PASS",GMPLCNM)=""
"RTN","GMPLY49",58,0)
 I $D(GMPLLIST)!($D(GMPLCAT)) D
"RTN","GMPLY49",59,0)
 . D SENDCRPT(.GMPLLIST,.GMPLCAT)
"RTN","GMPLY49",60,0)
 . S GMPLTXT(1)="  A mixed & lower case list/category name report has been generated to the"
"RTN","GMPLY49",61,0)
 . S GMPLTXT(2)="  installer and OR CACS mailgroup via MailMan."
"RTN","GMPLY49",62,0)
 . D BMES^XPDUTL(.GMPLTXT)
"RTN","GMPLY49",63,0)
 E  D MES^XPDUTL("  No mixed or lower case list/category names found.")
"RTN","GMPLY49",64,0)
 K GMPLLIST,GMPLCAT,GMPLMSG
"RTN","GMPLY49",65,0)
 Q
"RTN","GMPLY49",66,0)
 ;
"RTN","GMPLY49",67,0)
DUPCHK ; Check for duplicate selection list/category entry names
"RTN","GMPLY49",68,0)
 N GMPLSLST,GMPLCLST,GMPLDUPL,GMPLDUPC,GMPLLNM,GMPLCNM,GMPLTXT,GMPLIEN,GMPLDA
"RTN","GMPLY49",69,0)
 S (GMPLLNM,GMPLCNM)="",GMPLSLST("0")="",GMPLCLST("0")="",(GMPLIEN,GMPLDA)=0
"RTN","GMPLY49",70,0)
 F  S GMPLLNM=$O(^GMPL(125,"B",GMPLLNM)) Q:GMPLLNM=""  D
"RTN","GMPLY49",71,0)
 . F  S GMPLIEN=$O(^GMPL(125,"B",GMPLLNM,GMPLIEN)) Q:'GMPLIEN  D
"RTN","GMPLY49",72,0)
 . . I $$DUPL(.GMPLSLST,GMPLLNM) S GMPLDUPL(GMPLLNM)=""
"RTN","GMPLY49",73,0)
 . . S GMPLSLST(GMPLLNM)=""
"RTN","GMPLY49",74,0)
 F  S GMPLCNM=$O(^GMPL(125.11,"B",GMPLCNM)) Q:GMPLCNM=""  D
"RTN","GMPLY49",75,0)
 . F  S GMPLDA=$O(^GMPL(125.11,"B",GMPLCNM,GMPLDA)) Q:'GMPLDA  D
"RTN","GMPLY49",76,0)
 . . I $$DUPL(.GMPLCLST,GMPLCNM) S GMPLDUPC(GMPLCNM)=""
"RTN","GMPLY49",77,0)
 . . S GMPLCLST(GMPLCNM)=""
"RTN","GMPLY49",78,0)
 I $D(GMPLDUPL)!($D(GMPLDUPC)) D
"RTN","GMPLY49",79,0)
 . D SENDDRPT(.GMPLDUPL,.GMPLDUPC)
"RTN","GMPLY49",80,0)
 . S GMPLTXT(1)="  A duplicate list/category name report has been generated to the installer"
"RTN","GMPLY49",81,0)
 . S GMPLTXT(2)="  and OR CACS mailgroup via MailMan."
"RTN","GMPLY49",82,0)
 . D BMES^XPDUTL(.GMPLTXT)
"RTN","GMPLY49",83,0)
 E  D MES^XPDUTL("  No duplicate list/category names found.")
"RTN","GMPLY49",84,0)
 K GMPLSLST,GMPLCLST,GMPLDUPL,GMPLDUPC
"RTN","GMPLY49",85,0)
 Q
"RTN","GMPLY49",86,0)
 ;
"RTN","GMPLY49",87,0)
DUPL(GMPLARY,GMPLENT) ; Check if GMPLENT is a duplicate in GMPLARY
"RTN","GMPLY49",88,0)
 N GMPLSUB,GMPLRSLT S GMPLSUB="",GMPLRSLT=0
"RTN","GMPLY49",89,0)
 F  S GMPLSUB=$O(GMPLARY(GMPLSUB)) Q:GMPLSUB=""  D
"RTN","GMPLY49",90,0)
 . I $$UP^XLFSTR(GMPLENT)=$$UP^XLFSTR(GMPLSUB) S GMPLRSLT=1 Q
"RTN","GMPLY49",91,0)
 Q GMPLRSLT
"RTN","GMPLY49",92,0)
 ;
"RTN","GMPLY49",93,0)
POST ; Post-install subroutine
"RTN","GMPLY49",94,0)
 N GMPLOPT,GMPLOTXT
"RTN","GMPLY49",95,0)
 D BMES^XPDUTL("  Scanning for duplicate Problem Selection list/category names...")
"RTN","GMPLY49",96,0)
 D DUPCHK
"RTN","GMPLY49",97,0)
 D BMES^XPDUTL("  Marking GMPL CODE LIST menu option out of order...")
"RTN","GMPLY49",98,0)
 S GMPLOPT="GMPL CODE LIST",GMPLOTXT="This option is obsolete and disabled."
"RTN","GMPLY49",99,0)
 D OUT^XPDMENU(GMPLOPT,GMPLOTXT),MES^XPDUTL("  Done.")
"RTN","GMPLY49",100,0)
 D UPCHKMNU
"RTN","GMPLY49",101,0)
 D BMES^XPDUTL("  Updating display order of several items for GMPL BUILD LIST MENU option...")
"RTN","GMPLY49",102,0)
 D UPDTDORD
"RTN","GMPLY49",103,0)
 D BMES^XPDUTL("  Resequencing GMPL MENU BUILD GROUP protocol menu items...")
"RTN","GMPLY49",104,0)
 D RSEQPROT
"RTN","GMPLY49",105,0)
 Q:$$PATCH^XPDUTL("GMPL*2.0*49")
"RTN","GMPLY49",106,0)
 D EN^GMPLY49A
"RTN","GMPLY49",107,0)
 Q
"RTN","GMPLY49",108,0)
 ;
"RTN","GMPLY49",109,0)
PRE ; Pre-install subroutine
"RTN","GMPLY49",110,0)
 ; Remove old data dictionary for the Problem Selection List Files
"RTN","GMPLY49",111,0)
 N DIU
"RTN","GMPLY49",112,0)
 D BMES^XPDUTL("  Retrieving pre-existing USER/CLINIC selection list assignment report...")
"RTN","GMPLY49",113,0)
 D ASGNRPT
"RTN","GMPLY49",114,0)
 D BMES^XPDUTL("  Scanning for mixed or lower case Problem Selection list/category names...")
"RTN","GMPLY49",115,0)
 D CASECHK
"RTN","GMPLY49",116,0)
 D BMES^XPDUTL("  Removing old PROBLEM SELECTION LIST file #125 data dictionary...")
"RTN","GMPLY49",117,0)
 S DIU(0)=""
"RTN","GMPLY49",118,0)
 S DIU=125
"RTN","GMPLY49",119,0)
 D EN^DIU2 K DIU
"RTN","GMPLY49",120,0)
 D MES^XPDUTL("  Data dictionary for file #125 removed.")
"RTN","GMPLY49",121,0)
 N DIU
"RTN","GMPLY49",122,0)
 D BMES^XPDUTL("  Removing old PROBLEM SELECTION CATEGORY file #125.11 data dictionary...")
"RTN","GMPLY49",123,0)
 S DIU(0)=""
"RTN","GMPLY49",124,0)
 S DIU=125.11
"RTN","GMPLY49",125,0)
 D EN^DIU2 K DIU
"RTN","GMPLY49",126,0)
 D MES^XPDUTL("  Data dictionary for file #125.11 removed.")
"RTN","GMPLY49",127,0)
 I $D(^GMPL(125,0)) S $P(^GMPL(125,0),U,3)=0
"RTN","GMPLY49",128,0)
 I $D(^GMPL(125.11,0)) S $P(^GMPL(125.11,0),U,3)=0
"RTN","GMPLY49",129,0)
 Q
"RTN","GMPLY49",130,0)
 ;
"RTN","GMPLY49",131,0)
RSEQPROT ; Resequence GMPL MENU BUILD GROUP protocol menu items
"RTN","GMPLY49",132,0)
 N GMPLPIEN,GMPLMSG,GMPLDA,GMPLITEM,GMPLIENS,GMPLFDA,GMPLTXT,GMPLERR
"RTN","GMPLY49",133,0)
 S GMPLDA=0,GMPLERR=0
"RTN","GMPLY49",134,0)
 S GMPLPIEN=$$FIND1^DIC(101,"","BX","GMPL MENU BUILD GROUP","","","GMPLMSG")
"RTN","GMPLY49",135,0)
 I 'GMPLPIEN D BMES^XPDUTL("  Error: Cannot find GMPL MENU BUILD GROUP protocol.") Q
"RTN","GMPLY49",136,0)
 F  S GMPLDA=$O(^ORD(101,GMPLPIEN,10,GMPLDA)) Q:GMPLDA=""  D
"RTN","GMPLY49",137,0)
 . S GMPLITEM=$G(^ORD(101,GMPLPIEN,10,GMPLDA,0))
"RTN","GMPLY49",138,0)
 . I $P(GMPLITEM,U,2)="ED" D  Q
"RTN","GMPLY49",139,0)
 . . S GMPLIENS=""_GMPLDA_","_GMPLPIEN_","
"RTN","GMPLY49",140,0)
 . . S GMPLFDA(101.01,GMPLIENS,.01)="GMPL MENU COPY GROUP"
"RTN","GMPLY49",141,0)
 . . S GMPLFDA(101.01,GMPLIENS,2)="CN"
"RTN","GMPLY49",142,0)
 . . S GMPLFDA(101.01,GMPLIENS,3)="5"
"RTN","GMPLY49",143,0)
 . . D FILE^DIE("EK","GMPLFDA","GMPLMSG")
"RTN","GMPLY49",144,0)
 . . I $D(GMPLMSG) D
"RTN","GMPLY49",145,0)
 . . . S GMPLTXT(1)="  Unable to add GMPL MENU COPY GROUP as the 5th menu item. "
"RTN","GMPLY49",146,0)
 . . . S GMPLTXT(2)="  Error: "_GMPLMSG("DIERR",1,"TEXT",1),GMPLERR=1
"RTN","GMPLY49",147,0)
 . . . D BMES^XPDUTL(.GMPLTXT)
"RTN","GMPLY49",148,0)
 I 'GMPLERR D MES^XPDUTL("  Done.")
"RTN","GMPLY49",149,0)
 Q
"RTN","GMPLY49",150,0)
 ;
"RTN","GMPLY49",151,0)
SENDARPT(GMPLULST,GMPLCLST,GMPLELST) ; Build pre-existing user/clinic selection list assignment rpt and send via MailMan
"RTN","GMPLY49",152,0)
 N GMPLTO,GMPLFROM,GMPXMSUB,SUB,GMPLCNT
"RTN","GMPLY49",153,0)
 K ^TMP("GMPLASGN",$J)
"RTN","GMPLY49",154,0)
 S SUB="GMPLASGN",GMPLCNT=9
"RTN","GMPLY49",155,0)
 S GMPXMSUB="Pre-existing USER/CLINIC Selection List Assignment Report"
"RTN","GMPLY49",156,0)
 S GMPLFROM="GMPL*2.0*49 INSTALL"
"RTN","GMPLY49",157,0)
 S GMPLTO(DUZ)="",GMPLTO("G.OR CACS")=""
"RTN","GMPLY49",158,0)
 S ^TMP(SUB,$J,1,0)=""
"RTN","GMPLY49",159,0)
 S ^TMP(SUB,$J,2,0)="This report was auto generated during installation to identify Problem"
"RTN","GMPLY49",160,0)
 S ^TMP(SUB,$J,3,0)="Selection Lists assigned to users and clinics prior to the installation of"
"RTN","GMPLY49",161,0)
 S ^TMP(SUB,$J,4,0)="GMPL*2.0*49. After installation all users and clinic assignments will be"
"RTN","GMPLY49",162,0)
 S ^TMP(SUB,$J,5,0)="migrated to the new Default Selection List Display parameter setting. If users"
"RTN","GMPLY49",163,0)
 S ^TMP(SUB,$J,6,0)="and clinics desire to use the National Problem Selection List as their default"
"RTN","GMPLY49",164,0)
 S ^TMP(SUB,$J,7,0)="setting then use the Assign/Remove menu option to reassign those users or"
"RTN","GMPLY49",165,0)
 S ^TMP(SUB,$J,8,0)="clinics listed in the report."
"RTN","GMPLY49",166,0)
 S ^TMP(SUB,$J,9,0)=""
"RTN","GMPLY49",167,0)
 I $D(GMPLULST) D
"RTN","GMPLY49",168,0)
 . N GMPLUSR,GMPLST S (GMPLUSR,GMPLST)=""
"RTN","GMPLY49",169,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="User Selection List Assignments: "
"RTN","GMPLY49",170,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",171,0)
 . F  S GMPLUSR=$O(GMPLULST(GMPLUSR)) Q:GMPLUSR=""  D
"RTN","GMPLY49",172,0)
 . . F  S GMPLST=$O(GMPLULST(GMPLUSR,GMPLST)) Q:GMPLST=""  D
"RTN","GMPLY49",173,0)
 . . . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="   "_$$LJ^XLFSTR(GMPLUSR,35)_$$LJ^XLFSTR(GMPLST,40)
"RTN","GMPLY49",174,0)
 E  S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="There are no USER selection list assignments in the system currently."
"RTN","GMPLY49",175,0)
 S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",176,0)
 I $D(GMPLCLST) D
"RTN","GMPLY49",177,0)
 . N GMPLCLIN,GMPLLST S (GMPLCLIN,GMPLLST)=""
"RTN","GMPLY49",178,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="Clinic Selection List Assignments: "
"RTN","GMPLY49",179,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",180,0)
 . F  S GMPLCLIN=$O(GMPLCLST(GMPLCLIN)) Q:GMPLCLIN=""  D
"RTN","GMPLY49",181,0)
 . . F  S GMPLLST=$O(GMPLCLST(GMPLCLIN,GMPLLST)) Q:GMPLLST=""  D
"RTN","GMPLY49",182,0)
 . . . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="   "_$$LJ^XLFSTR(GMPLCLIN,35)_$$LJ^XLFSTR(GMPLLST,40)
"RTN","GMPLY49",183,0)
 E  S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="There are no CLINIC selection list assignments in the system currently."
"RTN","GMPLY49",184,0)
 I $D(GMPLELST) D
"RTN","GMPLY49",185,0)
 . N GMPLUSNM,GMPLSLDA S (GMPLUSNM,GMPLSLDA)=""
"RTN","GMPLY49",186,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",187,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="User(s) assigned to a Selection List that no longer exists:"
"RTN","GMPLY49",188,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",189,0)
 . F  S GMPLUSNM=$O(GMPLELST(GMPLUSNM)) Q:GMPLUSNM=""  D
"RTN","GMPLY49",190,0)
 . . F  S GMPLSLDA=$O(GMPLELST(GMPLUSNM,GMPLSLDA)) Q:GMPLSLDA=""  D
"RTN","GMPLY49",191,0)
 . . . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="   "_$$LJ^XLFSTR(GMPLUSNM,35)_$$LJ^XLFSTR("Selection List #"_GMPLSLDA,40)
"RTN","GMPLY49",192,0)
 D SEND^GMPLUTL4(SUB,GMPXMSUB,.GMPLTO,GMPLFROM)
"RTN","GMPLY49",193,0)
 Q
"RTN","GMPLY49",194,0)
 ;
"RTN","GMPLY49",195,0)
SENDCRPT(GMPLLIST,GMPLCAT) ; Build mix/lower case name report and send to installer via MailMan
"RTN","GMPLY49",196,0)
 N GMPLTO,GMPLFROM,GMPXMSUB,SUB,GMPLCNT,GMPLLNM,GMPLCNM
"RTN","GMPLY49",197,0)
 K ^TMP("GMPLCASE",$J)
"RTN","GMPLY49",198,0)
 S SUB="GMPLCASE",GMPLCNT=9,(GMPLLNM,GMPLCNM)=""
"RTN","GMPLY49",199,0)
 S GMPXMSUB="Mixed & Lower Case List/Category Name Report"
"RTN","GMPLY49",200,0)
 S GMPLFROM="GMPL*2.0*49 INSTALL"
"RTN","GMPLY49",201,0)
 S GMPLTO(DUZ)="",GMPLTO("G.OR CACS")=""
"RTN","GMPLY49",202,0)
 S ^TMP(SUB,$J,1,0)=""
"RTN","GMPLY49",203,0)
 S ^TMP(SUB,$J,2,0)="Mixed/lower case problem selection list/category names are no longer allowed"
"RTN","GMPLY49",204,0)
 S ^TMP(SUB,$J,3,0)="with patch GMPL*2.0*49. This patch scans the Problem Selection List and Problem"
"RTN","GMPLY49",205,0)
 S ^TMP(SUB,$J,4,0)="Selection Category files for any names in mixed or lower case letters and"
"RTN","GMPLY49",206,0)
 S ^TMP(SUB,$J,5,0)="converts them to upper case."
"RTN","GMPLY49",207,0)
 S ^TMP(SUB,$J,6,0)=""
"RTN","GMPLY49",208,0)
 S ^TMP(SUB,$J,7,0)="For those conversions that failed, please have a CAC or somebody with FileMan"
"RTN","GMPLY49",209,0)
 S ^TMP(SUB,$J,8,0)="access manually modify the name to upper case."
"RTN","GMPLY49",210,0)
 S ^TMP(SUB,$J,9,0)=""
"RTN","GMPLY49",211,0)
 I $D(GMPLLIST("PASS")) D
"RTN","GMPLY49",212,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="The following list names converted successfully:"
"RTN","GMPLY49",213,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",214,0)
 . F  S GMPLLNM=$O(GMPLLIST("PASS",GMPLLNM)) Q:GMPLLNM=""  D
"RTN","GMPLY49",215,0)
 . . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="     "_GMPLLNM
"RTN","GMPLY49",216,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",217,0)
 I $D(GMPLLIST("FAIL")) D
"RTN","GMPLY49",218,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="Failed list names:"
"RTN","GMPLY49",219,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="",GMPLLNM=""
"RTN","GMPLY49",220,0)
 . F  S GMPLLNM=$O(GMPLLIST("FAIL",GMPLLNM)) Q:GMPLLNM=""  D
"RTN","GMPLY49",221,0)
 . . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=$$LJ^XLFSTR("*"_GMPLLNM,34)_$$LJ^XLFSTR($P(GMPLLIST("FAIL",GMPLLNM),U),18)_$$LJ^XLFSTR($P(GMPLLIST("FAIL",GMPLLNM),U,2),80)
"RTN","GMPLY49",222,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",223,0)
 I $D(GMPLCAT("PASS")) D
"RTN","GMPLY49",224,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="The following category names converted successfully:"
"RTN","GMPLY49",225,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",226,0)
 . F  S GMPLCNM=$O(GMPLCAT("PASS",GMPLCNM)) Q:GMPLCNM=""  D
"RTN","GMPLY49",227,0)
 . . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="     "_GMPLCNM
"RTN","GMPLY49",228,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",229,0)
 I $D(GMPLCAT("FAIL")) D
"RTN","GMPLY49",230,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="Failed category names:"
"RTN","GMPLY49",231,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="",GMPLCNM=""
"RTN","GMPLY49",232,0)
 . F  S GMPLCNM=$O(GMPLCAT("FAIL",GMPLCNM)) Q:GMPLCNM=""  D
"RTN","GMPLY49",233,0)
 . . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=$$LJ^XLFSTR("*"_GMPLCNM,34)_$$LJ^XLFSTR($P(GMPLCAT("FAIL",GMPLCNM),U),18)_$$LJ^XLFSTR($P(GMPLCAT("FAIL",GMPLCNM),U,2),80)
"RTN","GMPLY49",234,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",235,0)
 D SEND^GMPLUTL4(SUB,GMPXMSUB,.GMPLTO,GMPLFROM)
"RTN","GMPLY49",236,0)
 Q
"RTN","GMPLY49",237,0)
 ;
"RTN","GMPLY49",238,0)
SENDDRPT(GMPLDUPL,GMPLDUPC) ; Build duplicate name report and send to installer via MailMan
"RTN","GMPLY49",239,0)
 N GMPLTO,GMPLFROM,GMPXMSUB,SUB,GMPLCNT,GMPLLIST,GMPLCAT
"RTN","GMPLY49",240,0)
 K ^TMP("GMPLDUP",$J)
"RTN","GMPLY49",241,0)
 S SUB="GMPLDUP",GMPLCNT=6,(GMPLLIST,GMPLCAT)=""
"RTN","GMPLY49",242,0)
 S GMPXMSUB="Duplicate Problem Selection List/Category Name Report"
"RTN","GMPLY49",243,0)
 S GMPLFROM="GMPL*2.0*49 INSTALL"
"RTN","GMPLY49",244,0)
 S GMPLTO(DUZ)="",GMPLTO("G.OR CACS")=""
"RTN","GMPLY49",245,0)
 S ^TMP(SUB,$J,1,0)=""
"RTN","GMPLY49",246,0)
 S ^TMP(SUB,$J,2,0)="Duplicate problem selection list/category names are no longer allowed with"
"RTN","GMPLY49",247,0)
 S ^TMP(SUB,$J,3,0)="patch GMPL*2.0*49. The following list/category names are duplicates. Please"
"RTN","GMPLY49",248,0)
 S ^TMP(SUB,$J,4,0)="have your CAC review these with the pre-existing file entries and rename,"
"RTN","GMPLY49",249,0)
 S ^TMP(SUB,$J,5,0)="delete, or reconcile the duplicate entries as needed."
"RTN","GMPLY49",250,0)
 S ^TMP(SUB,$J,6,0)=""
"RTN","GMPLY49",251,0)
 I $D(GMPLDUPL) D
"RTN","GMPLY49",252,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="     Duplicate List Names:"
"RTN","GMPLY49",253,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",254,0)
 . F  S GMPLLIST=$O(GMPLDUPL(GMPLLIST)) Q:GMPLLIST=""  D
"RTN","GMPLY49",255,0)
 . . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="     "_GMPLLIST
"RTN","GMPLY49",256,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",257,0)
 I $D(GMPLDUPC) D
"RTN","GMPLY49",258,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="     Duplicate Category Names:"
"RTN","GMPLY49",259,0)
 . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)=""
"RTN","GMPLY49",260,0)
 . F  S GMPLCAT=$O(GMPLDUPC(GMPLCAT)) Q:GMPLCAT=""  D
"RTN","GMPLY49",261,0)
 . . S GMPLCNT=GMPLCNT+1,^TMP(SUB,$J,GMPLCNT,0)="     "_GMPLCAT
"RTN","GMPLY49",262,0)
 D SEND^GMPLUTL4(SUB,GMPXMSUB,.GMPLTO,GMPLFROM)
"RTN","GMPLY49",263,0)
 Q
"RTN","GMPLY49",264,0)
 ;
"RTN","GMPLY49",265,0)
SENDLIST(GMPLSLST) ; Export national list/category data if prefixed with VA-
"RTN","GMPLY49",266,0)
 I $E(GMPLSLST,1,3)="VA-" Q 1
"RTN","GMPLY49",267,0)
 Q 0
"RTN","GMPLY49",268,0)
 ;
"RTN","GMPLY49",269,0)
UPCHKMNU ; Update GMPL SELECTION LIST CSV CHECK menu text
"RTN","GMPLY49",270,0)
 N GMPLIEN,GMPLFDA,GMPLMSG,GMPLERR,GMPLTXT
"RTN","GMPLY49",271,0)
 S GMPLIEN=+$$FIND1^DIC(19,"","KX","GMPL SELECTION LIST CSV CHECK","","","GMPLMSG")
"RTN","GMPLY49",272,0)
 I GMPLIEN>0 D
"RTN","GMPLY49",273,0)
 . D BMES^XPDUTL("  Updating GMPL SELECTION LIST CSV CHECK menu text...")
"RTN","GMPLY49",274,0)
 . S GMPLFDA(19,""_GMPLIEN_",",1)="Check Problem Selection List Problem Codes"
"RTN","GMPLY49",275,0)
 . D FILE^DIE("EK","GMPLFDA","GMPLERR")
"RTN","GMPLY49",276,0)
 I $D(GMPLERR) D
"RTN","GMPLY49",277,0)
 . S GMPLTXT(1)="  Error updating menu text."
"RTN","GMPLY49",278,0)
 . S GMPLTXT(2)="  Error "_GMPLERR("DIERR",1)_": "_GMPLERR("DIERR",1,"TEXT",1)
"RTN","GMPLY49",279,0)
 . D BMES^XPDUTL(.GMPLTXT)
"RTN","GMPLY49",280,0)
 E  D MES^XPDUTL("  Done.")
"RTN","GMPLY49",281,0)
 Q
"RTN","GMPLY49",282,0)
 ;
"RTN","GMPLY49",283,0)
UPDTDORD ; Update display order of several menu items for GMPL BUILD LIST MENU option
"RTN","GMPLY49",284,0)
 N GMPLI,GMPLOIEN,GMPLMSG,GMPLTXT,GMPLERR S GMPLERR=0
"RTN","GMPLY49",285,0)
 S GMPLOIEN=$$FIND1^DIC(19,"","BX","GMPL BUILD LIST MENU","","","GMPLMSG")
"RTN","GMPLY49",286,0)
 I 'GMPLOIEN D BMES^XPDUTL("  Error: Cannot find GMPL BUILD LIST MENU option") Q
"RTN","GMPLY49",287,0)
 F GMPLI=1:1:3 D
"RTN","GMPLY49",288,0)
 . N GMPLOPT,GMPLMIEN,GMPLIENS,GMPLVAL,GMPLFDA
"RTN","GMPLY49",289,0)
 . S GMPLOPT=$S(GMPLI=1:"GMPL DELETE LIST",GMPLI=2:"GMPL SELECTION LIST CSV CHECK",1:"GMPL SELECTION LIST IMPORT")
"RTN","GMPLY49",290,0)
 . S GMPLVAL=$S(GMPLI=1:"4",GMPLI=2:"5",1:"6")
"RTN","GMPLY49",291,0)
 . S GMPLMIEN=$$FIND1^DIC(19.01,","_GMPLOIEN_",","BX",GMPLOPT,"","","GMPLMSG")
"RTN","GMPLY49",292,0)
 . S GMPLIENS=""_GMPLMIEN_","_GMPLOIEN_","
"RTN","GMPLY49",293,0)
 . S GMPLFDA(19.01,GMPLIENS,2)=GMPLVAL
"RTN","GMPLY49",294,0)
 . S GMPLFDA(19.01,GMPLIENS,3)=GMPLVAL
"RTN","GMPLY49",295,0)
 . D FILE^DIE("EK","GMPLFDA","GMPLMSG")
"RTN","GMPLY49",296,0)
 . I $D(GMPLMSG) D
"RTN","GMPLY49",297,0)
 . . S GMPLTXT(1)="  Menu Item: "_GMPLOPT
"RTN","GMPLY49",298,0)
 . . S GMPLTXT(2)="  Error: "_GMPLMSG("DIERR",1,"TEXT",1),GMPLERR=1
"RTN","GMPLY49",299,0)
 . . D BMES^XPDUTL(.GMPLTXT)
"RTN","GMPLY49",300,0)
 I 'GMPLERR D MES^XPDUTL("  Done.")
"RTN","GMPLY49",301,0)
 Q
"RTN","GMPLY49",302,0)
 ;
"RTN","GMPLY49A")
0^20^B22998218
"RTN","GMPLY49A",1,0)
GMPLY49A ;ISP/TC - Problem Selection List Files Data Migration ;08/22/17  11:32
"RTN","GMPLY49A",2,0)
 ;;2.0;Problem List;**49**;Aug 25, 1994;Build 43
"RTN","GMPLY49A",3,0)
 ;
"RTN","GMPLY49A",4,0)
 ; External References:
"RTN","GMPLY49A",5,0)
 ;   ICR  2053   FILE/UPDATE^DIE
"RTN","GMPLY49A",6,0)
 ;   ICR  10103  $$DT^XLFDT
"RTN","GMPLY49A",7,0)
 ;   ICR  10141  MES/BMES^XPDUTL
"RTN","GMPLY49A",8,0)
 ;
"RTN","GMPLY49A",9,0)
EN ;
"RTN","GMPLY49A",10,0)
 N GMPLTXT,GMPLTXTC
"RTN","GMPLY49A",11,0)
 D SETCLASS("125",4,".04") ; Set for selection lists
"RTN","GMPLY49A",12,0)
 D SETCLASS("125.11",3,".03") ; Set for categories
"RTN","GMPLY49A",13,0)
 D BMES^XPDUTL("  Migrating data in File #125.1 to File #125...")
"RTN","GMPLY49A",14,0)
 D LSTMGRTN(.GMPLTXT)
"RTN","GMPLY49A",15,0)
 D BMES^XPDUTL(.GMPLTXT)
"RTN","GMPLY49A",16,0)
 D BMES^XPDUTL("  Migrating data in File #125.12 to File #125.11...")
"RTN","GMPLY49A",17,0)
 D CATMGRTN(.GMPLTXTC)
"RTN","GMPLY49A",18,0)
 D BMES^XPDUTL(.GMPLTXTC)
"RTN","GMPLY49A",19,0)
 Q
"RTN","GMPLY49A",20,0)
 ;
"RTN","GMPLY49A",21,0)
BLDERMSG(GMPLTXT,GMPLLKND,GMPLERND,GMPLFILE) ; Build migration error messages
"RTN","GMPLY49A",22,0)
 N GMPI,GMPJ,GMPK,GMPCNT,GMPX S (GMPI,GMPK)="",GMPJ=1
"RTN","GMPLY49A",23,0)
 S GMPLTXT(1)="  The following error(s) occurred during migration to File #"_GMPLFILE_":"
"RTN","GMPLY49A",24,0)
 F  S GMPI=$O(^TMP(GMPLLKND,$J,GMPI)) Q:'GMPI  D
"RTN","GMPLY49A",25,0)
 . S GMPJ=GMPJ+1
"RTN","GMPLY49A",26,0)
 . S GMPLTXT(GMPJ)=$G(^TMP(GMPLLKND,$J,GMPI))
"RTN","GMPLY49A",27,0)
 S GMPCNT=GMPJ
"RTN","GMPLY49A",28,0)
 F  S GMPK=$O(^TMP(GMPLERND,$J,GMPK)) Q:'GMPK  D
"RTN","GMPLY49A",29,0)
 . S GMPCNT=GMPCNT+1,GMPX=^TMP(GMPLERND,$J,GMPK)
"RTN","GMPLY49A",30,0)
 . S GMPLTXT(GMPCNT)="  Record #"_$P(GMPX,U)_"; Error: "_$P(GMPX,U,2)
"RTN","GMPLY49A",31,0)
 K ^TMP(GMPLLKND,$J),^TMP(GMPLERND,$J)
"RTN","GMPLY49A",32,0)
 Q
"RTN","GMPLY49A",33,0)
 ;
"RTN","GMPLY49A",34,0)
CATMGRTN(GMPLTXTC) ; Migrate data in file #125.12 to file #125.11
"RTN","GMPLY49A",35,0)
 N GMPLIEN,GMPLDA,GMPL0,GMPFDA,GMPERR,GMPI,GMPCNT,GMPLLKND,GMPLERND,GMPLFILE
"RTN","GMPLY49A",36,0)
 S (GMPLIEN,GMPLDA)="",(GMPCNT,GMPI)=0,GMPLFILE="125.11"
"RTN","GMPLY49A",37,0)
 K ^TMP("GMPERRCT",$J),^TMP("GMPLKERC",$J)
"RTN","GMPLY49A",38,0)
 F  S GMPLIEN=$O(^GMPL(125.12,"B",GMPLIEN)) Q:'GMPLIEN  D
"RTN","GMPLY49A",39,0)
 . F  S GMPLDA=$O(^GMPL(125.12,"B",GMPLIEN,GMPLDA)) Q:'GMPLDA  D
"RTN","GMPLY49A",40,0)
 . . L +^GMPL(125.11,GMPLIEN):5 I '$T D  Q
"RTN","GMPLY49A",41,0)
 . . . S GMPI=GMPI+1
"RTN","GMPLY49A",42,0)
 . . . S ^TMP("GMPLKERC",$J,GMPI)="   Lock Error: error updating record #"_GMPLIEN_" in File #125.11."
"RTN","GMPLY49A",43,0)
 . . S GMPCNT=GMPCNT+1,GMPL0=$G(^GMPL(125.12,GMPLDA,0))
"RTN","GMPLY49A",44,0)
 . . S GMPFDA(125.111,"+2,"_GMPLIEN_",",.01)=$P(GMPL0,U,3)
"RTN","GMPLY49A",45,0)
 . . S GMPFDA(125.111,"+2,"_GMPLIEN_",",.02)=$P(GMPL0,U,2)
"RTN","GMPLY49A",46,0)
 . . S GMPFDA(125.111,"+2,"_GMPLIEN_",",.03)=$P(GMPL0,U,4)
"RTN","GMPLY49A",47,0)
 . . S GMPFDA(125.111,"+2,"_GMPLIEN_",",.04)=$P(GMPL0,U,5)
"RTN","GMPLY49A",48,0)
 . . S GMPFDA(125.111,"+2,"_GMPLIEN_",",.05)=$P(GMPL0,U,6)
"RTN","GMPLY49A",49,0)
 . . S GMPFDA(125.111,"+2,"_GMPLIEN_",",.06)=$P(GMPL0,U,7)
"RTN","GMPLY49A",50,0)
 . . D UPDATE^DIE("","GMPFDA","","GMPERR")
"RTN","GMPLY49A",51,0)
 . . L -^GMPL(125.11,GMPLIEN)
"RTN","GMPLY49A",52,0)
 . . I $D(GMPERR) S ^TMP("GMPERRCT",$J,GMPCNT)=$G(GMPLIEN)_$G(GMPERR("DIERR",1,"TEXT",1))
"RTN","GMPLY49A",53,0)
 S GMPLLKND="GMPLKERC",GMPLERND="GMPERRCT"
"RTN","GMPLY49A",54,0)
 I '$D(^GMPL(125.12,"B")) S GMPLTXTC="  ...No data to migrate."
"RTN","GMPLY49A",55,0)
 E  I $D(^TMP("GMPERRCT",$J))!($D(^TMP("GMPLKERC",$J))) D BLDERMSG(.GMPLTXTC,GMPLLKND,GMPLERND,GMPLFILE)
"RTN","GMPLY49A",56,0)
 E  S GMPLTXTC="  ...Migration complete."
"RTN","GMPLY49A",57,0)
 Q
"RTN","GMPLY49A",58,0)
 ;
"RTN","GMPLY49A",59,0)
LSTMGRTN(GMPLTXT) ; Migrate data in file #125.1 to file #125
"RTN","GMPLY49A",60,0)
 N GMPLIEN,GMPLDA,GMPL0,GMPFDA,GMPERR,GMPCNT,GMPI,GMPLLKND,GMPLERND,GMPLFILE
"RTN","GMPLY49A",61,0)
 S (GMPLIEN,GMPLDA)="",(GMPCNT,GMPI)=0,GMPLFILE="125"
"RTN","GMPLY49A",62,0)
 K ^TMP("GMPERRLT",$J),^TMP("GMPLKERL",$J)
"RTN","GMPLY49A",63,0)
 F  S GMPLIEN=$O(^GMPL(125.1,"B",GMPLIEN)) Q:'GMPLIEN  D
"RTN","GMPLY49A",64,0)
 . F  S GMPLDA=$O(^GMPL(125.1,"B",GMPLIEN,GMPLDA)) Q:'GMPLDA  D
"RTN","GMPLY49A",65,0)
 . . L +^GMPL(125,GMPLIEN):5 I '$T D  Q
"RTN","GMPLY49A",66,0)
 . . . S GMPI=GMPI+1
"RTN","GMPLY49A",67,0)
 . . . S ^TMP("GMPLKERL",$J,GMPI)="   Lock Error: error updating record #"_GMPLIEN_" in File #125."
"RTN","GMPLY49A",68,0)
 . . S GMPCNT=GMPCNT+1,GMPL0=$G(^GMPL(125.1,GMPLDA,0))
"RTN","GMPLY49A",69,0)
 . . S GMPFDA(125.01,"+2,"_GMPLIEN_",",.01)=$P(GMPL0,U,3)
"RTN","GMPLY49A",70,0)
 . . S GMPFDA(125.01,"+2,"_GMPLIEN_",",.02)=$P(GMPL0,U,2)
"RTN","GMPLY49A",71,0)
 . . S GMPFDA(125.01,"+2,"_GMPLIEN_",",.03)=$P(GMPL0,U,4)
"RTN","GMPLY49A",72,0)
 . . S GMPFDA(125.01,"+2,"_GMPLIEN_",",.04)=$P(GMPL0,U,5)
"RTN","GMPLY49A",73,0)
 . . D UPDATE^DIE("","GMPFDA","","GMPERR")
"RTN","GMPLY49A",74,0)
 . . L -^GMPL(125,GMPLIEN)
"RTN","GMPLY49A",75,0)
 . . I $D(GMPERR) S ^TMP("GMPERRLT",$J,GMPCNT)=$G(GMPLIEN)_$G(GMPERR("DIERR",1,"TEXT",1))
"RTN","GMPLY49A",76,0)
 S GMPLLKND="GMPLKERL",GMPLERND="GMPERRLT"
"RTN","GMPLY49A",77,0)
 I '$D(^GMPL(125.1,"B")) S GMPLTXT="  ...No data to migrate."
"RTN","GMPLY49A",78,0)
 E  I $D(^TMP("GMPERRLT",$J))!($D(^TMP("GMPLKERL",$J))) D BLDERMSG(.GMPLTXT,GMPLLKND,GMPLERND,GMPLFILE)
"RTN","GMPLY49A",79,0)
 E  S GMPLTXT="  ...Migration complete."
"RTN","GMPLY49A",80,0)
 Q
"RTN","GMPLY49A",81,0)
 ;
"RTN","GMPLY49A",82,0)
SETCLASS(GMPLFNMB,GMPLPCE,GMPLCFLD) ; Set pre-existing lists and categories to LOCAL class
"RTN","GMPLY49A",83,0)
 N GMPLNM,GMPLIEN,GMPL0,GMPLFDA,GMPLERR,GMPLTXT,GMPLITEM
"RTN","GMPLY49A",84,0)
 S GMPLNM="",GMPLIEN=0
"RTN","GMPLY49A",85,0)
 S GMPLITEM=$S(GMPLFNMB="125":"lists",1:"categories")
"RTN","GMPLY49A",86,0)
 D BMES^XPDUTL("  Setting pre-existing "_GMPLITEM_" to a default LOCAL class...")
"RTN","GMPLY49A",87,0)
 F  S GMPLNM=$O(^GMPL(GMPLFNMB,"B",GMPLNM)) Q:GMPLNM=""  D
"RTN","GMPLY49A",88,0)
 . F  S GMPLIEN=$O(^GMPL(GMPLFNMB,"B",GMPLNM,GMPLIEN)) Q:'GMPLIEN  D
"RTN","GMPLY49A",89,0)
 . . S GMPL0=$G(^GMPL(GMPLFNMB,GMPLIEN,0))
"RTN","GMPLY49A",90,0)
 . . I '$L($P(GMPL0,U,GMPLPCE)) D
"RTN","GMPLY49A",91,0)
 . . . S GMPLFDA(GMPLFNMB,""_GMPLIEN_",",.02)=$$DT^XLFDT
"RTN","GMPLY49A",92,0)
 . . . S GMPLFDA(GMPLFNMB,""_GMPLIEN_",",GMPLCFLD)="L"
"RTN","GMPLY49A",93,0)
 . . . D FILE^DIE("K","GMPLFDA","GMPLERR")
"RTN","GMPLY49A",94,0)
 . . . I $D(GMPLERR) D
"RTN","GMPLY49A",95,0)
 . . . . S GMPLTXT="  Record #"_GMPLIEN_"; Error: "_GMPLERR("DIERR",1,"TEXT",1)
"RTN","GMPLY49A",96,0)
 . . . . D BMES^XPDUTL(.GMPLTXT)
"RTN","GMPLY49A",97,0)
 D BMES^XPDUTL("  ...Local class assignments completed.")
"RTN","GMPLY49A",98,0)
 Q
"RTN","GMPLY49A",99,0)
 ;
"SEC","^DIC",125,125,0,"DD")
@
"SEC","^DIC",125,125,0,"DEL")
@
"SEC","^DIC",125.11,125.11,0,"DD")
@
"VER")
8.0^22.2
"^DD",125,125,0)
FIELD^^.04^5
"^DD",125,125,0,"DDA")
N
"^DD",125,125,0,"DT")
3170919
"^DD",125,125,0,"ID",.04)
W "   ",@("$P($P($C(59)_$S($D(^DD(125,.04,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(0),U,4)_"":"",2),$C(59),1)")
"^DD",125,125,0,"IX","C",125,.03)

"^DD",125,125,0,"NM","PROBLEM SELECTION LIST")

"^DD",125,125,0,"PT",125.1,.01)

"^DD",125,125,0,"PT",200,125.1)

"^DD",125,125,.01,0)
NAME^RFXJ65^^0;1^K:$L(X)>65!(X?.N)!($L(X)<3)!'(X'?1P.E)!'(+$$VNAME^GMPLINTR(.X)) X
"^DD",125,125,.01,1,0)
^.1^^0
"^DD",125,125,.01,3)
Name must be 3-65 characters, not numeric or starting with punctuation
"^DD",125,125,.01,21,0)
^.001^2^2^3170209^^^
"^DD",125,125,.01,21,1,0)
This is a free text name for the list; it must be unique. National lists 
"^DD",125,125,.01,21,2,0)
are prefixed with a "VA-".
"^DD",125,125,.01,"DT")
3170629
"^DD",125,125,.02,0)
DATE LAST MODIFIED^D^^0;2^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
"^DD",125,125,.02,3)
Enter the date/time this list was last edited.
"^DD",125,125,.02,21,0)
^^2^2^2940107^^
"^DD",125,125,.02,21,1,0)
This is the date[/time] this list was last changed in any way; this value
"^DD",125,125,.02,21,2,0)
is stuffed in by the Problem List pkg utilities that manage this file.
"^DD",125,125,.02,"DT")
2931004
"^DD",125,125,.03,0)
CLINIC^*P44'^SC(^0;3^S DIC("S")="I $P(^(0),U,3)=""C""" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",125,125,.03,1,0)
^.1
"^DD",125,125,.03,1,1,0)
125^C
"^DD",125,125,.03,1,1,1)
S ^GMPL(125,"C",$E(X,1,30),DA)=""
"^DD",125,125,.03,1,1,2)
K ^GMPL(125,"C",$E(X,1,30),DA)
"^DD",125,125,.03,1,1,"DT")
2940107
"^DD",125,125,.03,3)
Enter the clinic to be associated with this list.
"^DD",125,125,.03,12)
Only hospital locations that are clinics are allowed.
"^DD",125,125,.03,12.1)
S DIC("S")="I $P(^(0),U,3)=""C"""
"^DD",125,125,.03,21,0)
^^7^7^3170206^
"^DD",125,125,.03,21,1,0)
This is the clinic to be associated with this list.  This should be the
"^DD",125,125,.03,21,2,0)
primary clinic in which this list will be used to populate patient
"^DD",125,125,.03,21,3,0)
problem lists; when adding new problems for a patient from this clinic,
"^DD",125,125,.03,21,4,0)
this list will automatically be presented to select problems from.
"^DD",125,125,.03,21,5,0)
 
"^DD",125,125,.03,21,6,0)
**NOTE**: This field will no longer be utilized with GMPL*2.0*49 and will 
"^DD",125,125,.03,21,7,0)
be replaced with the ORQQPL SELECTION LIST parameter settings.
"^DD",125,125,.03,"DT")
3170206
"^DD",125,125,.04,0)
CLASS^R*SX^N:National;V:VISN;L:Local;^0;4^K:'+$$VCLASS^GMPLINTR(X) X
"^DD",125,125,.04,3)
Enter the Class for this selection list.
"^DD",125,125,.04,12)
National lists are reserved for National Development and cannot be edited by sites.
"^DD",125,125,.04,12.1)
S DIC("S")="I Y'=""N"""
"^DD",125,125,.04,21,0)
^^3^3^3170919^
"^DD",125,125,.04,21,1,0)
This is the Class of the selection list. Possible classes are "N" for
"^DD",125,125,.04,21,2,0)
national, "V" for VISN, and "L" for local. National lists cannot be edited
"^DD",125,125,.04,21,3,0)
by sites.
"^DD",125,125,.04,"DT")
3170919
"^DD",125,125,1,0)
CATEGORY^125.01P^^1;0
"^DD",125,125,1,21,0)
^.001^1^1^3170223^^^
"^DD",125,125,1,21,1,0)
These are the problem categories that are associated with this list.
"^DD",125,125,1,"DT")
3160725
"^DD",125,125.01,0)
CATEGORY SUB-FIELD^^.04^4
"^DD",125,125.01,0,"DT")
3170223
"^DD",125,125.01,0,"IX","B",125.01,.01)

"^DD",125,125.01,0,"NM","CATEGORY")

"^DD",125,125.01,0,"UP")
125
"^DD",125,125.01,.01,0)
CATEGORY NAME^RP125.11'^GMPL(125.11,^0;1^Q
"^DD",125,125.01,.01,1,0)
^.1
"^DD",125,125.01,.01,1,1,0)
125.01^B
"^DD",125,125.01,.01,1,1,1)
S ^GMPL(125,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",125,125.01,.01,1,1,2)
K ^GMPL(125,DA(1),1,"B",$E(X,1,30),DA)
"^DD",125,125.01,.01,3)
Enter the problem category you wish to include in this list.
"^DD",125,125.01,.01,21,0)
^.001^2^2^3160725^^
"^DD",125,125.01,.01,21,1,0)
This is the category whose problem items are to be included in the current
"^DD",125,125.01,.01,21,2,0)
list; it may have a subheader in this list, and a designated order.
"^DD",125,125.01,.01,"DT")
3160825
"^DD",125,125.01,.02,0)
SEQUENCE^NJ6,2^^0;2^K:+X'=X!(X>999.99)!(X<.01)!(X?.E1"."3N.N) X
"^DD",125,125.01,.02,3)
Type a number between .01 and 999.99, 2 decimal digits.
"^DD",125,125.01,.02,21,0)
^^2^2^3160725^
"^DD",125,125.01,.02,21,1,0)
This is a number which will determine the order this group will appear in
"^DD",125,125.01,.02,21,2,0)
the current list; up to two decimal places may be used.
"^DD",125,125.01,.02,"DT")
3160831
"^DD",125,125.01,.03,0)
SUBHEADER^FJ65X^^0;3^K:$L(X)>65!($L(X)<2)!(X?.N)!'(X'?1P.E) X
"^DD",125,125.01,.03,3)
Answer must be 2-65 characters in length, non-numeric, and does not start with a punctuation.
"^DD",125,125.01,.03,21,0)
^.001^3^3^3170223^^^
"^DD",125,125.01,.03,21,1,0)
This is text which will appear in the list as a subheader or title to this
"^DD",125,125.01,.03,21,2,0)
group of problems. It will have a single blank row between it and the
"^DD",125,125.01,.03,21,3,0)
previous problem group, and it will be underlined.
"^DD",125,125.01,.03,"DT")
3170223
"^DD",125,125.01,.04,0)
SHOW PROBLEMS^S^1:YES;0:NO;^0;4^Q
"^DD",125,125.01,.04,3)
Enter YES to immediately display the problems in this category when using this list for selection.
"^DD",125,125.01,.04,21,0)
^^5^5^3160725^
"^DD",125,125.01,.04,21,1,0)
This field controls the initial display of this category in this selection
"^DD",125,125.01,.04,21,2,0)
list. If set to YES, the problems will automatically be displayed as part
"^DD",125,125.01,.04,21,3,0)
of the list when it is initially built and displayed; if null or NO, the
"^DD",125,125.01,.04,21,4,0)
category must be selected in order to expand the list and show the
"^DD",125,125.01,.04,21,5,0)
problems.
"^DD",125,125.01,.04,"DT")
3160725
"^DD",125.11,125.11,0)
FIELD^^.03^4
"^DD",125.11,125.11,0,"DDA")
N
"^DD",125.11,125.11,0,"DT")
3170920
"^DD",125.11,125.11,0,"ID",.03)
W "   ",@("$P($P($C(59)_$S($D(^DD(125.11,.03,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(0),U,3)_"":"",2),$C(59),1)")
"^DD",125.11,125.11,0,"NM","PROBLEM SELECTION CATEGORY")

"^DD",125.11,125.11,0,"PT",125.01,.01)

"^DD",125.11,125.11,0,"PT",125.1,2)

"^DD",125.11,125.11,0,"PT",125.12,.01)

"^DD",125.11,125.11,.01,0)
NAME^RFXJ65^^0;1^K:$L(X)>65!($L(X)<3)!(X?.N)!'(X'?1P.E)!'(+$$VNAME^GMPLINTR(.X)) X
"^DD",125.11,125.11,.01,1,0)
^.1^^0
"^DD",125.11,125.11,.01,3)
Name must be 3-65 characters, not numeric, or starting with a punctuation
"^DD",125.11,125.11,.01,21,0)
^^2^2^3170118^
"^DD",125.11,125.11,.01,21,1,0)
This is the name given to this problem group to identify and describe it. 
"^DD",125.11,125.11,.01,21,2,0)
It must be unique. National categories are prefixed with a "VA-".
"^DD",125.11,125.11,.01,"DT")
3170629
"^DD",125.11,125.11,.02,0)
DATE LAST MODIFIED^D^^0;2^S %DT="ETX" D ^%DT S X=Y K:Y<1 X
"^DD",125.11,125.11,.02,3)
Enter the date/time this problem group was edited last.
"^DD",125.11,125.11,.02,21,0)
^.001^2^2^3160726^^
"^DD",125.11,125.11,.02,21,1,0)
This is the date/time this group was last changed; it is stuffed in
"^DD",125.11,125.11,.02,21,2,0)
by the Problem List pkg utilities.
"^DD",125.11,125.11,.02,"DT")
3160726
"^DD",125.11,125.11,.03,0)
CLASS^R*SX^N:National;V:VISN;L:Local;^0;3^K:'+$$VCLASS^GMPLINTR(X) X
"^DD",125.11,125.11,.03,3)
Enter the Class for this category.
"^DD",125.11,125.11,.03,12)
National categories are reserved for National Development and cannot be edited by sites.
"^DD",125.11,125.11,.03,12.1)
S DIC("S")="I Y'=""N"""
"^DD",125.11,125.11,.03,21,0)
^^3^3^3170920^
"^DD",125.11,125.11,.03,21,1,0)
This is the Class of the category. Possible classes are "N" for national, 
"^DD",125.11,125.11,.03,21,2,0)
"V" for VISN, and "L" for local. National categories cannot be edited by 
"^DD",125.11,125.11,.03,21,3,0)
sites.
"^DD",125.11,125.11,.03,"DT")
3170920
"^DD",125.11,125.11,1,0)
CATEGORY CONTENTS^125.111P^^1;0
"^DD",125.11,125.11,1,21,0)
^.001^2^2^3170124^^^^
"^DD",125.11,125.11,1,21,1,0)
These are the problems that are associated with or grouped under this 
"^DD",125.11,125.11,1,21,2,0)
category.
"^DD",125.11,125.11,1,"DT")
3160726
"^DD",125.11,125.111,0)
CATEGORY CONTENTS SUB-FIELD^^.06^6
"^DD",125.11,125.111,0,"DT")
3170329
"^DD",125.11,125.111,0,"IX","B",125.111,.01)

"^DD",125.11,125.111,0,"NM","CATEGORY CONTENTS")

"^DD",125.11,125.111,0,"UP")
125.11
"^DD",125.11,125.111,.01,0)
PROBLEM^P757.01'^LEX(757.01,^0;1^Q
"^DD",125.11,125.111,.01,1,0)
^.1
"^DD",125.11,125.111,.01,1,1,0)
125.111^B
"^DD",125.11,125.111,.01,1,1,1)
S ^GMPL(125.11,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",125.11,125.111,.01,1,1,2)
K ^GMPL(125.11,DA(1),1,"B",$E(X,1,30),DA)
"^DD",125.11,125.111,.01,3)
Enter the problem you wish to include in this group.
"^DD",125.11,125.111,.01,21,0)
^.001^2^2^3160726^^^
"^DD",125.11,125.111,.01,21,1,0)
This is a problem from the Clinical Lexicon Utility, which is to be 
"^DD",125.11,125.111,.01,21,2,0)
included in this group.
"^DD",125.11,125.111,.01,"DT")
3160726
"^DD",125.11,125.111,.02,0)
SEQUENCE^NJ6,2^^0;2^K:+X'=X!(X>999.99)!(X<.01)!(X?.E1"."3N.N) X
"^DD",125.11,125.111,.02,3)
Type a number between .01 and 999.99, 2 decimal digits.
"^DD",125.11,125.111,.02,21,0)
^^4^4^3160726^
"^DD",125.11,125.111,.02,21,1,0)
This is a number which determines the order the problems will appear 
"^DD",125.11,125.111,.02,21,2,0)
within a category; up to two decimal places may be used. Problems in a 
"^DD",125.11,125.111,.02,21,3,0)
selection list will be automatically numbered for display and selection 
"^DD",125.11,125.111,.02,21,4,0)
in whole numbers, beginning with 1.
"^DD",125.11,125.111,.02,"DT")
3160817
"^DD",125.11,125.111,.03,0)
DISPLAY TEXT^FXJ245^^0;3^K:$L(X)>245!($L(X)<2)!'(X'?1P.E) X
"^DD",125.11,125.111,.03,3)
Answer must be 2-245 characters in length and not start with a punctuation.
"^DD",125.11,125.111,.03,21,0)
^^4^4^3160726^
"^DD",125.11,125.111,.03,21,1,0)
This is the text of the problem as it appears on the selection list
"^DD",125.11,125.111,.03,21,2,0)
display; if a suitable match was not found during a search of the 
"^DD",125.11,125.111,.03,21,3,0)
Clinical Lexicon Utility and an 'Unresolved' entry was returned, this 
"^DD",125.11,125.111,.03,21,4,0)
will be the text as specified by the user.
"^DD",125.11,125.111,.03,"DT")
3170329
"^DD",125.11,125.111,.04,0)
ASSOCIATED ICD CODE^FJ35X^^0;4^K:$L(X)>35!($L(X)<2)!'($$VICD^GMPLINTR(X)) X
"^DD",125.11,125.111,.04,3)
Answer must be 2-35 characters in length, active, and in the correct ICD-10 code format.
"^DD",125.11,125.111,.04,21,0)
^.001^2^2^3170124^^^
"^DD",125.11,125.111,.04,21,1,0)
This is the associating ICD code which is to be displayed with the text 
"^DD",125.11,125.111,.04,21,2,0)
of this problem.
"^DD",125.11,125.111,.04,"DT")
3170223
"^DD",125.11,125.111,.05,0)
SNOMED CT CONCEPT CODE^FJ40X^^0;5^K:$L(X)>40!($L(X)<1)!(X'?1.40N)!'($$VSCTCODE^GMPLINTR(X)) X
"^DD",125.11,125.111,.05,3)
Answer must be 1-40 characters in length, only numeric, and be an active SNOMED CT concept code.
"^DD",125.11,125.111,.05,21,0)
^^2^2^3160726^
"^DD",125.11,125.111,.05,21,1,0)
A clinical idea to which a unique Concept ID has been assigned in SNOMED 
"^DD",125.11,125.111,.05,21,2,0)
CT. Each Concept is represented by a row in the Concepts Table.
"^DD",125.11,125.111,.05,"DT")
3170223
"^DD",125.11,125.111,.06,0)
SNOMED CT DESIGNATION CODE^FJ40X^^0;6^K:$L(X)>40!($L(X)<1)!(X'?1.40N) X
"^DD",125.11,125.111,.06,3)
Answer must be 1-40 characters in length, only numeric, and be a valid SNOMED CT designation code.
"^DD",125.11,125.111,.06,21,0)
^^9^9^3160726^
"^DD",125.11,125.111,.06,21,1,0)
A single SNOMED CT Concept may have multiple Designations, where a 
"^DD",125.11,125.111,.06,21,2,0)
Designation may be considered an alternate way of expressing the concept.
"^DD",125.11,125.111,.06,21,3,0)
Synonyms, lexical variants, abbreviations are all different types of 
"^DD",125.11,125.111,.06,21,4,0)
designations. In many cases, a problem (as reported by the patient) and a 
"^DD",125.11,125.111,.06,21,5,0)
finding indicating a problem will share the same concept and concept code 
"^DD",125.11,125.111,.06,21,6,0)
(e.g., abdominal pain), but will have different designation codes (i.e., 
"^DD",125.11,125.111,.06,21,7,0)
the generic "abdominal pain" and "abdominal pain (finding)" share the 
"^DD",125.11,125.111,.06,21,8,0)
concept code 21522001, but they have the designation codes 36112013 and 
"^DD",125.11,125.111,.06,21,9,0)
750827015 respectively.
"^DD",125.11,125.111,.06,"DT")
3170329
"^DIC",125,125,0)
PROBLEM SELECTION LIST^125I
"^DIC",125,125,0,"GL")
^GMPL(125,
"^DIC",125,125,"%D",0)
^1.001^3^3^3170918^^^^
"^DIC",125,125,"%D",1,0)
This file contains information defining lists of problems commonly seen
"^DIC",125,125,"%D",2,0)
by a particular clinic or user.  These lists will be presented as menus
"^DIC",125,125,"%D",3,0)
to select from, to facilitate adding new problems.
"^DIC",125,"B","PROBLEM SELECTION LIST",125)

"^DIC",125.11,125.11,0)
PROBLEM SELECTION CATEGORY^125.11
"^DIC",125.11,125.11,0,"GL")
^GMPL(125.11,
"^DIC",125.11,125.11,"%D",0)
^1.001^3^3^3160726^^^^
"^DIC",125.11,125.11,"%D",1,0)
This file contains problems categorized into groups for inclusion in
"^DIC",125.11,125.11,"%D",2,0)
a Selection List.  Items within a category will be ordered according to
"^DIC",125.11,125.11,"%D",3,0)
the Sequence number; up to two decimal digits may be used.
"^DIC",125.11,"B","PROBLEM SELECTION CATEGORY",125.11)

**INSTALL NAME**
OR*3.0*429
"BLD",9822,0)
OR*3.0*429^ORDER ENTRY/RESULTS REPORTING^0^3171010^y
"BLD",9822,1,0)
^^1^1^3170214^
"BLD",9822,1,1,0)
The description of this patch can be found in the National Patch Module.
"BLD",9822,4,0)
^9.64PA^^
"BLD",9822,6.3)
33
"BLD",9822,"INID")
^y
"BLD",9822,"INIT")
POST^ORY429
"BLD",9822,"KRN",0)
^9.67PA^779.2^20
"BLD",9822,"KRN",.4,0)
.4
"BLD",9822,"KRN",.401,0)
.401
"BLD",9822,"KRN",.402,0)
.402
"BLD",9822,"KRN",.403,0)
.403
"BLD",9822,"KRN",.5,0)
.5
"BLD",9822,"KRN",.84,0)
.84
"BLD",9822,"KRN",3.6,0)
3.6
"BLD",9822,"KRN",3.8,0)
3.8
"BLD",9822,"KRN",9.2,0)
9.2
"BLD",9822,"KRN",9.8,0)
9.8
"BLD",9822,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",9822,"KRN",9.8,"NM",1,0)
ORQQPL3^^0^B81488349
"BLD",9822,"KRN",9.8,"NM",2,0)
ORY429^^0^B22955937
"BLD",9822,"KRN",9.8,"NM","B","ORQQPL3",1)

"BLD",9822,"KRN",9.8,"NM","B","ORY429",2)

"BLD",9822,"KRN",19,0)
19
"BLD",9822,"KRN",19.1,0)
19.1
"BLD",9822,"KRN",101,0)
101
"BLD",9822,"KRN",409.61,0)
409.61
"BLD",9822,"KRN",771,0)
771
"BLD",9822,"KRN",779.2,0)
779.2
"BLD",9822,"KRN",870,0)
870
"BLD",9822,"KRN",8989.51,0)
8989.51
"BLD",9822,"KRN",8989.51,"NM",0)
^9.68A^1^1
"BLD",9822,"KRN",8989.51,"NM",1,0)
ORQQPL SELECTION LIST^^0
"BLD",9822,"KRN",8989.51,"NM","B","ORQQPL SELECTION LIST",1)

"BLD",9822,"KRN",8989.52,0)
8989.52
"BLD",9822,"KRN",8994,0)
8994
"BLD",9822,"KRN","B",.4,.4)

"BLD",9822,"KRN","B",.401,.401)

"BLD",9822,"KRN","B",.402,.402)

"BLD",9822,"KRN","B",.403,.403)

"BLD",9822,"KRN","B",.5,.5)

"BLD",9822,"KRN","B",.84,.84)

"BLD",9822,"KRN","B",3.6,3.6)

"BLD",9822,"KRN","B",3.8,3.8)

"BLD",9822,"KRN","B",9.2,9.2)

"BLD",9822,"KRN","B",9.8,9.8)

"BLD",9822,"KRN","B",19,19)

"BLD",9822,"KRN","B",19.1,19.1)

"BLD",9822,"KRN","B",101,101)

"BLD",9822,"KRN","B",409.61,409.61)

"BLD",9822,"KRN","B",771,771)

"BLD",9822,"KRN","B",779.2,779.2)

"BLD",9822,"KRN","B",870,870)

"BLD",9822,"KRN","B",8989.51,8989.51)

"BLD",9822,"KRN","B",8989.52,8989.52)

"BLD",9822,"KRN","B",8994,8994)

"BLD",9822,"QUES",0)
^9.62^^
"BLD",9822,"REQB",0)
^9.611^1^1
"BLD",9822,"REQB",1,0)
OR*3.0*385^2
"BLD",9822,"REQB","B","OR*3.0*385",1)

"INIT")
POST^ORY429
"KRN",8989.5,18056,0)
170;DIC(9.4,^ORQQPL SELECTION LIST^1
"KRN",8989.5,18056,1)
VA-NATIONAL PROBLEM SELECTION LIST
"KRN",8989.51,909,-1)
0^1
"KRN",8989.51,909,0)
ORQQPL SELECTION LIST^Default Problem Selection List Display^0^^Selection List
"KRN",8989.51,909,1)
P^125^Enter the Problem selection list to display by default.
"KRN",8989.51,909,3)
I $$VALLIST^GMPLBLD2(+Y)
"KRN",8989.51,909,20,0)
^8989.512^2^2^3161018^^
"KRN",8989.51,909,20,1,0)
This parameter determines which Problem selection list the user will be 
"KRN",8989.51,909,20,2,0)
shown when adding a new patient problem.
"KRN",8989.51,909,30,0)
^8989.513I^5^5
"KRN",8989.51,909,30,1,0)
1^200
"KRN",8989.51,909,30,2,0)
2^44
"KRN",8989.51,909,30,3,0)
3^4
"KRN",8989.51,909,30,4,0)
4^4.2
"KRN",8989.51,909,30,5,0)
5^9.4
"MBREQ")
1
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PKG",170,-1)
1^1
"PKG",170,0)
ORDER ENTRY/RESULTS REPORTING^OR^Order Entry/Results Reporting
"PKG",170,20,0)
^9.402P^^
"PKG",170,22,0)
^9.49I^1^1
"PKG",170,22,1,0)
3.0^2971217^2980917^11712
"PKG",170,22,1,"PAH",1,0)
429^3171010
"PKG",170,22,1,"PAH",1,1,0)
^^1^1^3171010
"PKG",170,22,1,"PAH",1,1,1,0)
The description of this patch can be found in the National Patch Module.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","ORQQPL3")
0^1^B81488349
"RTN","ORQQPL3",1,0)
ORQQPL3 ; ALB/PDR,REV,ISL/JER/TC - Problem List RPCs ;02/13/17  14:04
"RTN","ORQQPL3",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,148,173,243,280,306,361,385,429**;Dec 17, 1997;Build 33
"RTN","ORQQPL3",3,0)
 ;
"RTN","ORQQPL3",4,0)
 ;  External References:
"RTN","ORQQPL3",5,0)
 ;  $$ICDDESC^GMPLUTL2                               ICR #2741
"RTN","ORQQPL3",6,0)
 ;  $$PROBTEXT^GMPLX                                 ICR #2742
"RTN","ORQQPL3",7,0)
 ;  $$CODECS/$$CSI/$$ICDDX/$$SAB/$$STATCHK^ICDEX     ICR #5747
"RTN","ORQQPL3",8,0)
 ;  $$ICDDATA/$$STATCHK^ICDXCODE                     ICR #5699
"RTN","ORQQPL3",9,0)
 ;  $$STATCHK^LEXSRC2                                ICR #4083
"RTN","ORQQPL3",10,0)
 ;  $$IMPDATE^LEXU                                   ICR #5679
"RTN","ORQQPL3",11,0)
 ;  $$DT^XLFDT                                       ICR #10103
"RTN","ORQQPL3",12,0)
 ;  $$GET^XPAR                                       ICR #2263
"RTN","ORQQPL3",13,0)
 ;
"RTN","ORQQPL3",14,0)
 ;---------------- LIST PATIENT PROBLEMS ------------------------
"RTN","ORQQPL3",15,0)
 ;
"RTN","ORQQPL3",16,0)
PROBL(ROOT,DFN,CONTEXT,ORIDT) ;  GET LIST OF PATIENT PROBLEMS
"RTN","ORQQPL3",17,0)
 N DIWL,DIWR,DIWF
"RTN","ORQQPL3",18,0)
 N ST,ORI,ORX
"RTN","ORQQPL3",19,0)
 S ORIDT=$G(ORIDT,DT)
"RTN","ORQQPL3",20,0)
 S (LCNT,NUM)=0
"RTN","ORQQPL3",21,0)
 S DIWL=1,DIWR=48,DIWF="C48"
"RTN","ORQQPL3",22,0)
 S CONTEXT=";;"_$G(CONTEXT)
"RTN","ORQQPL3",23,0)
 I CONTEXT=";;" S CONTEXT=";;A"
"RTN","ORQQPL3",24,0)
 S ST=$P(CONTEXT,";",3)
"RTN","ORQQPL3",25,0)
 ;
"RTN","ORQQPL3",26,0)
 I ST="R" D DELLIST(.ROOT,+DFN,ORIDT) ; show deleted only
"RTN","ORQQPL3",27,0)
 I ST'="R"  D LIST(.ROOT,+DFN,ST,ORIDT) ; show others - don't trust ELSE here
"RTN","ORQQPL3",28,0)
 ;
"RTN","ORQQPL3",29,0)
 I ROOT(0)<1 D
"RTN","ORQQPL3",30,0)
 . S LCNT=1
"RTN","ORQQPL3",31,0)
 . S ROOT(1)="     "_$$PAD^ORCHTAB("No data available.",49)_"|"
"RTN","ORQQPL3",32,0)
 Q
"RTN","ORQQPL3",33,0)
 ;
"RTN","ORQQPL3",34,0)
 ;
"RTN","ORQQPL3",35,0)
LIST(GMPL,GMPDFN,GMPSTAT,ORIDT) ; -- Returns list of problems for patient GMPDFN
"RTN","ORQQPL3",36,0)
 ;    in GMPL(#)=ifn^status^description^ICD^onset^last modified^SC^SpExp^Condition^Loc^
"RTN","ORQQPL3",37,0)
 ;                          loc.type^prov^service^priority^has comment^date recorded^SC condition(s)^
"RTN","ORQQPL3",38,0)
 ;               inactive flag^ICD long description^ICD coding system
"RTN","ORQQPL3",39,0)
 ;     & GMPL(0)=number of problems returned
"RTN","ORQQPL3",40,0)
 ; This is virtually same as LIST^GMPLUTL2 except that it appends the
"RTN","ORQQPL3",41,0)
 ; condition - T)ranscribed or P)ermanent,location,loc type,provider, service.
"RTN","ORQQPL3",42,0)
 ;
"RTN","ORQQPL3",43,0)
 N CNT,SP,NUM,ORLIST,ORVIEW,GMPARAM,IMPLDT
"RTN","ORQQPL3",44,0)
 Q:$G(GMPDFN)'>0
"RTN","ORQQPL3",45,0)
 S IMPLDT=$$IMPDATE^LEXU("10D")
"RTN","ORQQPL3",46,0)
 S ORIDT=$G(ORIDT,DT)
"RTN","ORQQPL3",47,0)
 S:ORIDT=0 ORIDT=DT
"RTN","ORQQPL3",48,0)
 S CNT=0,SP=""
"RTN","ORQQPL3",49,0)
 S GMPARAM("QUIET")=1
"RTN","ORQQPL3",50,0)
 S GMPARAM("REV")=$P($G(^GMPL(125.99,1,0)),U,5)="R"
"RTN","ORQQPL3",51,0)
 S ORVIEW("ACT")=GMPSTAT
"RTN","ORQQPL3",52,0)
 S ORVIEW("PROV")=0
"RTN","ORQQPL3",53,0)
 S ORVIEW("VIEW")=""
"RTN","ORQQPL3",54,0)
 ;
"RTN","ORQQPL3",55,0)
 D GETPLIST^GMPLMGR1(.ORLIST,.ORTOTAL,.ORVIEW)
"RTN","ORQQPL3",56,0)
 ;
"RTN","ORQQPL3",57,0)
 F NUM=0:0 S NUM=$O(ORLIST(NUM)) Q:NUM'>0  D
"RTN","ORQQPL3",58,0)
 . N GMPL0,GMPL1,GMPL800,GMPL802,I,IFN,SCT,ST,ONSET,ICD,LASTMOD,PRIO,DTREC,ICDD,ORDTINT,ORPLCSYS
"RTN","ORQQPL3",59,0)
 . N SC,ORTOTAL,LIN,LOC,LT,PROV,SERV,HASCMT,SCCOND,AO,IR,ENV,HNC,MST,CV,SHD,INACT
"RTN","ORQQPL3",60,0)
 . S IFN=+ORLIST(NUM) Q:IFN'>0
"RTN","ORQQPL3",61,0)
 . S (ICDD,INACT)=""
"RTN","ORQQPL3",62,0)
 . S GMPL0=$G(^AUPNPROB(IFN,0))
"RTN","ORQQPL3",63,0)
 . S GMPL1=$G(^AUPNPROB(IFN,1))
"RTN","ORQQPL3",64,0)
 . S GMPL800=$G(^AUPNPROB(IFN,800)),SCT=$P(GMPL800,U)
"RTN","ORQQPL3",65,0)
 . S GMPL802=$G(^AUPNPROB(IFN,802))
"RTN","ORQQPL3",66,0)
 . S HASCMT=($D(^AUPNPROB(IFN,11,0))>0)
"RTN","ORQQPL3",67,0)
 . S CNT=CNT+1
"RTN","ORQQPL3",68,0)
 . N LEX
"RTN","ORQQPL3",69,0)
 . S ORDTINT=$S(+$P(GMPL802,U,1):$P(GMPL802,U,1),1:$P(GMPL0,U,8))
"RTN","ORQQPL3",70,0)
 . S ORPLCSYS=$S($P(GMPL802,U,2)]"":$P(GMPL802,U,2),1:$$SAB^ICDEX($$CSI^ICDEX(80,+GMPL0),ORDTINT))
"RTN","ORQQPL3",71,0)
 . S ICD=$P($$ICDDATA^ICDXCODE(ORPLCSYS,+GMPL0,ORDTINT,"I"),U,2)
"RTN","ORQQPL3",72,0)
 . I (ORIDT<IMPLDT),(+$$STATCHK^ICDXCODE($$CSI^ICDEX(80,+GMPL0),ICD,ORIDT)'=1) S INACT="#"
"RTN","ORQQPL3",73,0)
 . I +$G(SCT),(+$$STATCHK^LEXSRC2(SCT,ORIDT,.LEX)'=1) S INACT="$"
"RTN","ORQQPL3",74,0)
 . I $D(^AUPNPROB(IFN,803)) D
"RTN","ORQQPL3",75,0)
 . . N I S I=0
"RTN","ORQQPL3",76,0)
 . . F  S I=$O(^AUPNPROB(IFN,803,I)) Q:+I'>0  S $P(ICD,"/",(I+1))=$P($G(^AUPNPROB(IFN,803,I,0)),U)
"RTN","ORQQPL3",77,0)
 . I +SCT'>0,(+ICD>0) S ICDD=$$ICDDESC^GMPLUTL2(ICD,ORIDT,ORPLCSYS)
"RTN","ORQQPL3",78,0)
 . S LASTMOD=$P(GMPL0,U,3)
"RTN","ORQQPL3",79,0)
 . S ST=$P(GMPL0,U,12)
"RTN","ORQQPL3",80,0)
 . S ONSET=$P(GMPL0,U,13)
"RTN","ORQQPL3",81,0)
 . S SC=$S(+$P(GMPL1,U,10):"SC",$P(GMPL1,U,10)=0:"NSC",1:"")
"RTN","ORQQPL3",82,0)
 . S AO=$S(+$P(GMPL1,U,11):"/AO",1:"")
"RTN","ORQQPL3",83,0)
 . S IR=$S(+$P(GMPL1,U,12):"/IR",1:"")
"RTN","ORQQPL3",84,0)
 . S ENV=$S(+$P(GMPL1,U,13):"/EC",1:"")
"RTN","ORQQPL3",85,0)
 . S HNC=$S(+$P(GMPL1,U,15):"/HNC",1:"")
"RTN","ORQQPL3",86,0)
 . S MST=$S(+$P(GMPL1,U,16):"/MST",1:"")
"RTN","ORQQPL3",87,0)
 . S CV=$S(+$P(GMPL1,U,17):"/CV",1:"")
"RTN","ORQQPL3",88,0)
 . S SHD=$S(+$P(GMPL1,U,18):"/SHD",1:"")
"RTN","ORQQPL3",89,0)
 . S SCCOND=SC_AO_IR_ENV_HNC_MST_CV_SHD
"RTN","ORQQPL3",90,0)
 . S LOC=$P(GMPL1,U,8)
"RTN","ORQQPL3",91,0)
 . S DTREC=$P(GMPL1,U,9)
"RTN","ORQQPL3",92,0)
 . S LT=""
"RTN","ORQQPL3",93,0)
 . I LOC'="" S LT=$P($G(^SC(LOC,0)),"^",3),LOC=LOC_";"_$P($G(^SC(LOC,0)),U,1)
"RTN","ORQQPL3",94,0)
 . S PROV=$P(GMPL1,U,5) ; responsible provider
"RTN","ORQQPL3",95,0)
 . I PROV'="" S PROV=PROV_";"_$P($G(^VA(200,PROV,0)),U,1)
"RTN","ORQQPL3",96,0)
 . S SERV=$P(GMPL1,U,6)
"RTN","ORQQPL3",97,0)
 . I SERV=0 S SERV="" ; not sure how it gets set to 0, but need consistency in GUI
"RTN","ORQQPL3",98,0)
 . I SERV'="" S SERV=SERV_";"_$P($G(^DIC(49,SERV,0)),U,1)
"RTN","ORQQPL3",99,0)
 . S SP=""
"RTN","ORQQPL3",100,0)
 . F I=11,12,13 S:$P(GMPL1,U,I) SP=SP_$S(I=11:"A",I=12:"I",1:"P")
"RTN","ORQQPL3",101,0)
 . S PRIO=$P(GMPL1,U,14)
"RTN","ORQQPL3",102,0)
 . S LIN=IFN_U_ST_U_$$PROBTEXT^GMPLX(IFN)_U_ICD_U_ONSET
"RTN","ORQQPL3",103,0)
 . S LIN=LIN_U_LASTMOD_U_SC_U_SP_U_$P(GMPL1,U,2)
"RTN","ORQQPL3",104,0)
 . S LIN=LIN_U_LOC_U_LT_U_PROV_U_SERV_U_PRIO_U_HASCMT_U_DTREC_U_SCCOND_U_INACT_U_ICDD_U_ORPLCSYS
"RTN","ORQQPL3",105,0)
 . S GMPL(CNT)=LIN
"RTN","ORQQPL3",106,0)
 S GMPL(0)=CNT
"RTN","ORQQPL3",107,0)
 Q
"RTN","ORQQPL3",108,0)
 ;
"RTN","ORQQPL3",109,0)
 ;
"RTN","ORQQPL3",110,0)
 ;------------------------ GET LIST OF DELETED PROBLEMS -----------------------------
"RTN","ORQQPL3",111,0)
 ;
"RTN","ORQQPL3",112,0)
DELLIST(RETURN,GMPDFN,ORIDT) ; GET LIST OF DELETED PROBLEMS
"RTN","ORQQPL3",113,0)
 ; see GETPLIST^GMPLMGR1 and LIST^GMPUTL2
"RTN","ORQQPL3",114,0)
 N S,I,IMPLDT
"RTN","ORQQPL3",115,0)
 S IMPLDT=$$IMPDATE^LEXU("10D")
"RTN","ORQQPL3",116,0)
 S ORIDT=$G(ORIDT,DT)
"RTN","ORQQPL3",117,0)
 S:ORIDT=0 ORIDT=DT
"RTN","ORQQPL3",118,0)
 S I=0,S=""
"RTN","ORQQPL3",119,0)
 F  S S=$O(^AUPNPROB("ACTIVE",GMPDFN,S)) Q:S=""  D
"RTN","ORQQPL3",120,0)
 . N IFN,L0,L1,L800,L802,SCT,ST,TXT,ICD,ONSET,MOD,SC,SP,LOC,LT,PROV,SERV,PRIO,HASCMT,DTREC
"RTN","ORQQPL3",121,0)
 . N SCCOND,AO,IR,ENV,HNC,MST,CV,SHD,INACT,ORPLCSYS,ICDD,ORDTINT
"RTN","ORQQPL3",122,0)
 . S IFN=""
"RTN","ORQQPL3",123,0)
 . F  S IFN=$O(^AUPNPROB("ACTIVE",+GMPDFN,S,IFN)) Q:IFN=""  D
"RTN","ORQQPL3",124,0)
 .. I $P($G(^AUPNPROB(IFN,1)),U,2)="H" D
"RTN","ORQQPL3",125,0)
 ... S L0=$G(^AUPNPROB(IFN,0))
"RTN","ORQQPL3",126,0)
 ... S L800=$G(^AUPNPROB(IFN,800)),SCT=$P(L800,U)
"RTN","ORQQPL3",127,0)
 ... S L802=$G(^AUPNPROB(IFN,802))
"RTN","ORQQPL3",128,0)
 ... Q:L0=""
"RTN","ORQQPL3",129,0)
 ... S (ICDD,INACT)=""
"RTN","ORQQPL3",130,0)
 ... S L1=$G(^AUPNPROB(IFN,1))
"RTN","ORQQPL3",131,0)
 ... S ST=$P(L0,U,12)
"RTN","ORQQPL3",132,0)
 ... S TXT=$$PROBTEXT^GMPLX(IFN)
"RTN","ORQQPL3",133,0)
 ... S ORDTINT=$S(+$P(L802,U,1):$P(L802,U,1),1:$P(L0,U,8))
"RTN","ORQQPL3",134,0)
 ... S ORPLCSYS=$S($P(L802,U,2)]"":$P(L802,U,2),1:$$SAB^ICDEX($$CSI^ICDEX(80,+L0),ORDTINT))
"RTN","ORQQPL3",135,0)
 ... S ICD=$P($$ICDDATA^ICDXCODE(ORPLCSYS,+L0,ORDTINT,"I"),U,2)
"RTN","ORQQPL3",136,0)
 ... I (ORIDT<IMPLDT),(+$$STATCHK^ICDXCODE($$CSI^ICDEX(80,+L0),ICD,ORIDT)'=1) S INACT="#"
"RTN","ORQQPL3",137,0)
 ... I +SCT'>0,(+ICD>0) S ICDD=$$ICDDESC^GMPLUTL2(ICD,ORIDT,ORPLCSYS)
"RTN","ORQQPL3",138,0)
 ... S ONSET=$P(L0,U,13)
"RTN","ORQQPL3",139,0)
 ... S MOD=$P(L0,U,3)
"RTN","ORQQPL3",140,0)
 ... S SC=$S(+$P(L1,U,10):"SC",$P(L1,U,10)=0:"NSC",1:"")
"RTN","ORQQPL3",141,0)
 ... S AO=$S(+$P(L1,U,11):"/AO",1:"")
"RTN","ORQQPL3",142,0)
 ... S IR=$S(+$P(L1,U,12):"/IR",1:"")
"RTN","ORQQPL3",143,0)
 ... S ENV=$S(+$P(L1,U,13):"/EC",1:"")
"RTN","ORQQPL3",144,0)
 ... S HNC=$S(+$P(L1,U,15):"/HNC",1:"")
"RTN","ORQQPL3",145,0)
 ... S MST=$S(+$P(L1,U,16):"/MST",1:"")
"RTN","ORQQPL3",146,0)
 ... S CV=$S(+$P(L1,U,17):"/CV",1:"")
"RTN","ORQQPL3",147,0)
 ... S SHD=$S(+$P(L1,U,18):"/SHD",1:"")
"RTN","ORQQPL3",148,0)
 ... S SCCOND=SC_AO_IR_ENV_HNC_MST_CV_SHD
"RTN","ORQQPL3",149,0)
 ... S SP=$$GETSP
"RTN","ORQQPL3",150,0)
 ... S LOC=$P(L1,U,8)
"RTN","ORQQPL3",151,0)
 ... S LT=""
"RTN","ORQQPL3",152,0)
 ... I LOC'="" S LT=$P($G(^SC(LOC,0)),"^",3)
"RTN","ORQQPL3",153,0)
 ... S PROV=$P(L1,U,5) ; responsible provider
"RTN","ORQQPL3",154,0)
 ... S SERV=$P(L1,U,6)
"RTN","ORQQPL3",155,0)
 ... S PRIO=$P(L1,U,14)
"RTN","ORQQPL3",156,0)
 ... S HASCMT=($D(^AUPNPROB(IFN,11,0))>0)
"RTN","ORQQPL3",157,0)
 ... S DTREC=$P(L1,U,9)
"RTN","ORQQPL3",158,0)
 ... S I=I+1
"RTN","ORQQPL3",159,0)
 ... S RETURN(I)=IFN_U_ST_U_TXT_U_ICD_U_ONSET
"RTN","ORQQPL3",160,0)
 ... S RETURN(I)=RETURN(I)_U_MOD_U_SC_U_SP_U_$P(L1,U,2)
"RTN","ORQQPL3",161,0)
 ... S RETURN(I)=RETURN(I)_U_LOC_U_LT_U_PROV_U_SERV
"RTN","ORQQPL3",162,0)
 ... S RETURN(I)=RETURN(I)_U_PRIO_U_HASCMT_U_DTREC_U_SCCOND_U_INACT_U_ICDD_U_ORPLCSYS
"RTN","ORQQPL3",163,0)
 S RETURN(0)=I
"RTN","ORQQPL3",164,0)
 Q
"RTN","ORQQPL3",165,0)
 ;
"RTN","ORQQPL3",166,0)
GETSP() ; GET EXPOSURES
"RTN","ORQQPL3",167,0)
 N I
"RTN","ORQQPL3",168,0)
 S SP=""
"RTN","ORQQPL3",169,0)
 F I=11,12,13 S:$P(L1,U,I) SP=SP_$S(I=11:"A",I=12:"I",1:"P")
"RTN","ORQQPL3",170,0)
 Q SP
"RTN","ORQQPL3",171,0)
 ;
"RTN","ORQQPL3",172,0)
 ; adapted from ^GMPLBLD3 ;9/96
"RTN","ORQQPL3",173,0)
 ;
"RTN","ORQQPL3",174,0)
 ; ----------------------- GET USER PROBLEM CATEGORIES --------------
"RTN","ORQQPL3",175,0)
 ;
"RTN","ORQQPL3",176,0)
CAT(ORTMP,ORDUZ,ORCLIN) ; Get user category list
"RTN","ORQQPL3",177,0)
 N ORGSEQ,ORGCNT,ORGROUP,ORHDR,ORIFN,ORLCNT,ORITEM,ORTG,ORSLST
"RTN","ORQQPL3",178,0)
 S ORTG=$NAME(ORTMP) ; put list in local
"RTN","ORQQPL3",179,0)
 K @ORTG
"RTN","ORQQPL3",180,0)
 S (ORGSEQ,ORGCNT,ORLCNT)=0
"RTN","ORQQPL3",181,0)
 ;
"RTN","ORQQPL3",182,0)
 S ORSLST=$$GET^XPAR("USR^LOC.`"_ORCLIN_"^DIV^SYS^PKG","ORQQPL SELECTION LIST",1) ; get approp default list
"RTN","ORQQPL3",183,0)
 ; Build multiple of category\problems
"RTN","ORQQPL3",184,0)
 ; Iterate categories
"RTN","ORQQPL3",185,0)
 F  S ORGSEQ=$O(^GMPL(125,"AD",+ORSLST,ORGSEQ)) Q:ORGSEQ'>0  D
"RTN","ORQQPL3",186,0)
 . S ORIFN=$O(^GMPL(125,"AD",+ORSLST,ORGSEQ,0)) Q:ORIFN'>0
"RTN","ORQQPL3",187,0)
 . S ORITEM=$G(^GMPL(125,+ORSLST,1,ORIFN,0))
"RTN","ORQQPL3",188,0)
 . S ORGROUP=+$P(ORITEM,U,1)
"RTN","ORQQPL3",189,0)
 . S ORHDR=ORGROUP_U_$P(ORITEM,U,3,4)
"RTN","ORQQPL3",190,0)
 . S ORGCNT=ORGCNT+1
"RTN","ORQQPL3",191,0)
 . S @ORTG@(ORGCNT)=ORHDR ; put category into temp global
"RTN","ORQQPL3",192,0)
 Q
"RTN","ORQQPL3",193,0)
 ;
"RTN","ORQQPL3",194,0)
 ;----------------------- USER PROBLEM LIST --------------------------
"RTN","ORQQPL3",195,0)
 ;
"RTN","ORQQPL3",196,0)
PROB(TMP,ORGROUP) ; Get user problem list for given group
"RTN","ORQQPL3",197,0)
 N ORPSEQ,ORPCNT,ORIFN,ORITEM,ORTG,ORICD,ORTEXT,ORPLCSYS,ORPLCPTR,ORDT,ORSCTC,ORLCNT
"RTN","ORQQPL3",198,0)
 S ORTG=$NAME(TMP) ; put list in local
"RTN","ORQQPL3",199,0)
 K @ORTG
"RTN","ORQQPL3",200,0)
 S ORLCNT=0
"RTN","ORQQPL3",201,0)
 ;
"RTN","ORQQPL3",202,0)
 ; iterate through problems in category
"RTN","ORQQPL3",203,0)
 S (ORPSEQ,ORPCNT)=0,ORDT=$$DT^XLFDT
"RTN","ORQQPL3",204,0)
 F  S ORPSEQ=$O(^GMPL(125.11,"C",ORGROUP,ORPSEQ)) Q:ORPSEQ'>0  D
"RTN","ORQQPL3",205,0)
 . N ORI,ORK,ORQUIT S ORQUIT=0
"RTN","ORQQPL3",206,0)
 . S ORIFN=$O(^GMPL(125.11,"C",ORGROUP,ORPSEQ,0)) Q:ORIFN'>0
"RTN","ORQQPL3",207,0)
 . S ORITEM=$G(^GMPL(125.11,ORGROUP,1,ORIFN,0))
"RTN","ORQQPL3",208,0)
 . S ORTEXT=$P(ORITEM,U,3),ORICD=$P(ORITEM,U,4)
"RTN","ORQQPL3",209,0)
 . S ORSCTC=$P(ORITEM,U,5)
"RTN","ORQQPL3",210,0)
 . ; exclude any problems w/inactive SNOMED codes
"RTN","ORQQPL3",211,0)
 . I $L(ORSCTC) D
"RTN","ORQQPL3",212,0)
 . . I '$$STATCHK^LEXSRC2(ORSCTC,ORDT,"","SCT") S ORQUIT=1 Q
"RTN","ORQQPL3",213,0)
 . ; if any ICD codes inactive, exclude from list
"RTN","ORQQPL3",214,0)
 . I $L(ORICD)&(ORICD["/") D
"RTN","ORQQPL3",215,0)
 . . F ORK=1:1:$L(ORICD,"/") Q:+ORQUIT  D
"RTN","ORQQPL3",216,0)
 . . . S ORPLCPTR=+$$CODECS^ICDEX($P(ORICD,"/",ORK),80,ORDT),ORPLCSYS=$$SAB^ICDEX(ORPLCPTR,ORDT)
"RTN","ORQQPL3",217,0)
 . . . I '+$$STATCHK^ICDEX($P(ORICD,"/",ORK),ORDT,ORPLCPTR) S ORQUIT=1 Q
"RTN","ORQQPL3",218,0)
 . . Q
"RTN","ORQQPL3",219,0)
 . E  D
"RTN","ORQQPL3",220,0)
 . . S ORPLCPTR=$S($L(ORICD):+$$CODECS^ICDEX(ORICD,80,ORDT),1:""),ORPLCSYS=$S($L(ORICD):$$SAB^ICDEX(ORPLCPTR,ORDT),1:"ICD")
"RTN","ORQQPL3",221,0)
 . . I '+$$STATCHK^ICDEX(ORICD,ORDT,ORPLCPTR) S ORQUIT=1 Q
"RTN","ORQQPL3",222,0)
 . . Q
"RTN","ORQQPL3",223,0)
 . I +ORQUIT Q
"RTN","ORQQPL3",224,0)
 . S ORPCNT=ORPCNT+1
"RTN","ORQQPL3",225,0)
 . ; RETURN:
"RTN","ORQQPL3",226,0)
 . ; PROBLEM^DISPLAY TEXT^ICD CODE^ICD CODE IFN^^SNOMED CT CONCEPT CODE^SNOMED CT DESIGNATION CODE
"RTN","ORQQPL3",227,0)
 . S @ORTG@(ORPCNT)=$P(ORITEM,U,1)_U_ORTEXT_U_"("_$P($$CODECS^ICDEX($P(ORICD,"/"),80,ORDT),U,2)_" "_$G(ORICD)_")"_U_+$$ICDDX^ICDEX($P(ORICD,"/"),ORDT,ORPLCSYS)_U_U_$P(ORITEM,U,5,6)
"RTN","ORQQPL3",228,0)
 Q
"RTN","ORQQPL3",229,0)
 ;
"RTN","ORQQPL3",230,0)
 ;------------------ Filter Providers ---------------------
"RTN","ORQQPL3",231,0)
 ;
"RTN","ORQQPL3",232,0)
GETRPRV(RETURN,INP) ; GET LIST OF RESPONSIBLE PROVIDERS FROM PRBLM LIST
"RTN","ORQQPL3",233,0)
 ; RETURN - aa list of responsible providers from which to select for filtering
"RTN","ORQQPL3",234,0)
 ; INP - array of problem list providers to select from
"RTN","ORQQPL3",235,0)
 ;
"RTN","ORQQPL3",236,0)
 N S
"RTN","ORQQPL3",237,0)
 S S=""
"RTN","ORQQPL3",238,0)
 F I=1:1 S S=$O(INP(S)) Q:S=""  D
"RTN","ORQQPL3",239,0)
 . I INP(S)'="",$G(^VA(200,INP(S),0))'="" D  Q  ; get next
"RTN","ORQQPL3",240,0)
 .. S RETURN(I)=INP(S)_U_$P(^VA(200,INP(S),0),U)
"RTN","ORQQPL3",241,0)
 S RETURN(0)="-1"_U_"<None recorded>" ; return empty provider
"RTN","ORQQPL3",242,0)
 Q
"RTN","ORQQPL3",243,0)
 ;
"RTN","ORQQPL3",244,0)
 ;------------------- GET FILTERED CLINIC LIST ------------------------
"RTN","ORQQPL3",245,0)
 ;
"RTN","ORQQPL3",246,0)
GETCLIN(RETURN,INP) ; Get FILTERED LIST OF CLINICS
"RTN","ORQQPL3",247,0)
 ; RETURN NAMES FOR LIST OF CLINICS PASSED IN
"RTN","ORQQPL3",248,0)
 N I,S
"RTN","ORQQPL3",249,0)
 S S=""
"RTN","ORQQPL3",250,0)
 F I=1:1 S S=$O(INP(S)) Q:S=""  D
"RTN","ORQQPL3",251,0)
 . I INP(S)'="",$G(^SC(INP(S),0))'="" D  Q  ; get next
"RTN","ORQQPL3",252,0)
 .. S RETURN(I)=INP(S)_U_$P(^SC(INP(S),0),U,1)
"RTN","ORQQPL3",253,0)
 ;. S RETURN(I)="-1"_U_"None" ; return empty location
"RTN","ORQQPL3",254,0)
 Q
"RTN","ORQQPL3",255,0)
 ;
"RTN","ORQQPL3",256,0)
GETSRVC(RETURN,INP) ; GET FILTERED LIST OF INPATIENT SERVICES
"RTN","ORQQPL3",257,0)
 ; RETURN NAMES FOR LIST OF IEN PASSED IN
"RTN","ORQQPL3",258,0)
 N I,S
"RTN","ORQQPL3",259,0)
 S S=""
"RTN","ORQQPL3",260,0)
 F I=1:1 S S=$O(INP(S)) Q:S=""  D
"RTN","ORQQPL3",261,0)
 . I INP(S)'="",$G(^DIC(49,INP(S),0))'="" D  Q  ; get next
"RTN","ORQQPL3",262,0)
 .. S RETURN(I)=INP(S)_U_$P(^DIC(49,INP(S),0),U,1)
"RTN","ORQQPL3",263,0)
 ;. S RETURN(I)="-1"_U_"None" ; return empty service
"RTN","ORQQPL3",264,0)
 Q
"RTN","ORY429")
0^2^B22955937
"RTN","ORY429",1,0)
ORY429 ; ISP/TC - Post Install Routine for OR*3.0*429 ;04/04/17  12:28
"RTN","ORY429",2,0)
 ;;3.0;ORDER ENTRY/RESULTS REPORTING;**429**;Dec 17, 1997;Build 33
"RTN","ORY429",3,0)
 ;
"RTN","ORY429",4,0)
 ; External References:
"RTN","ORY429",5,0)
 ;   ICR  2263   ADD/EN^XPAR
"RTN","ORY429",6,0)
 ;   ICR  2971   ^GMPL(125,"C"
"RTN","ORY429",7,0)
 ;   ICR  10040  $$GET1^DIQ(44,ORCLIN,.01)
"RTN","ORY429",8,0)
 ;   ICR  10060  ^VA(200,"B"
"RTN","ORY429",9,0)
 ;   ICR  10141  MES^XPDUTL
"RTN","ORY429",10,0)
 ;
"RTN","ORY429",11,0)
DUPLIST(ORINVLST,ORLSTNM) ; Check invalid list for any duplicate entries
"RTN","ORY429",12,0)
 N ORLIST,ORDUP S ORLIST="",ORDUP=0
"RTN","ORY429",13,0)
 F  S ORLIST=$O(ORINVLST(ORLIST)) Q:ORLIST=""  D
"RTN","ORY429",14,0)
 . I ORLSTNM=ORLIST S ORDUP=1 Q
"RTN","ORY429",15,0)
 Q ORDUP
"RTN","ORY429",16,0)
 ;
"RTN","ORY429",17,0)
POST ; Post-install subroutine
"RTN","ORY429",18,0)
 ;
"RTN","ORY429",19,0)
 N ORUSRMSG,ORCLNMSG,ORSYSMSG
"RTN","ORY429",20,0)
 Q:$$PATCH^XPDUTL("OR*3.0*429")
"RTN","ORY429",21,0)
 S ORUSRMSG(1)="Migrating default user Problem Selection list from NEW PERSON File to the"
"RTN","ORY429",22,0)
 S ORUSRMSG(2)="ORQQPL SELECTION LIST parameter..."
"RTN","ORY429",23,0)
 D MES^XPDUTL(.ORUSRMSG)
"RTN","ORY429",24,0)
 D SETUSRLT
"RTN","ORY429",25,0)
 S ORCLNMSG(1)=""
"RTN","ORY429",26,0)
 S ORCLNMSG(2)="Migrating default clinic Problem Selection list from PROBLEM SELECTION LIST"
"RTN","ORY429",27,0)
 S ORCLNMSG(3)="File to the ORQQPL SELECTION LIST parameter..."
"RTN","ORY429",28,0)
 D MES^XPDUTL(.ORCLNMSG)
"RTN","ORY429",29,0)
 D SETCLNLT
"RTN","ORY429",30,0)
 S ORSYSMSG(1)=""
"RTN","ORY429",31,0)
 S ORSYSMSG(2)="Setting system & package level for ORQQPL SELECTION LIST parameter to a default"
"RTN","ORY429",32,0)
 S ORSYSMSG(3)="VA National Selection List..."
"RTN","ORY429",33,0)
 D MES^XPDUTL(.ORSYSMSG)
"RTN","ORY429",34,0)
 D SETSYSPR
"RTN","ORY429",35,0)
 Q
"RTN","ORY429",36,0)
 ;
"RTN","ORY429",37,0)
PRNTERR(ORERR,ORACT,ORENTY,ORLSTNM) ; Print out any errors during migration
"RTN","ORY429",38,0)
 N ORTXT,ORFILE,ORENT
"RTN","ORY429",39,0)
 S ORENT=$S($P(ORENTY,U)="USR":"user",$P(ORENTY,U)="LOC":"clinic",$P(ORENTY,U)="SYS":"system",1:"package")
"RTN","ORY429",40,0)
 S ORTXT(1)=""
"RTN","ORY429",41,0)
 S ORTXT(2)="  "_ORACT_" failed for "_ORENT_$S($L($P(ORENTY,U,2))>0:": "_$P(ORENTY,U,2),1:"")
"RTN","ORY429",42,0)
 S ORTXT(3)="  Default list: "_ORLSTNM
"RTN","ORY429",43,0)
 S ORTXT(4)="  Error: "_$P(ORERR,U,2)
"RTN","ORY429",44,0)
 S ORTXT(5)=""
"RTN","ORY429",45,0)
 D MES^XPDUTL(.ORTXT)
"RTN","ORY429",46,0)
 Q
"RTN","ORY429",47,0)
 ;
"RTN","ORY429",48,0)
PRNTIERR(ORINVLST) ; Print out list with inactive codes
"RTN","ORY429",49,0)
 N ORTXT,ORLST
"RTN","ORY429",50,0)
 S ORTXT(1)=""
"RTN","ORY429",51,0)
 S ORTXT(2)="  The following selection lists could not be migrated to the ORQQPL SELECTION"
"RTN","ORY429",52,0)
 S ORTXT(3)="  LIST parameter because it contains one or more problems that have inactive"
"RTN","ORY429",53,0)
 S ORTXT(4)="  SNOMED and/or ICD codes attached to them."
"RTN","ORY429",54,0)
 S ORTXT(5)=""
"RTN","ORY429",55,0)
 D MES^XPDUTL(.ORTXT)
"RTN","ORY429",56,0)
 S ORLST=""
"RTN","ORY429",57,0)
 F  S ORLST=$O(ORINVLST(ORLST)) Q:ORLST=""  D MES^XPDUTL("          "_ORLST)
"RTN","ORY429",58,0)
 Q
"RTN","ORY429",59,0)
 ;
"RTN","ORY429",60,0)
SETCLNLT ; Migrate pre-existing clinic default list to ORQQPL SELECTION LIST param
"RTN","ORY429",61,0)
 N ORCLIN,ORLST,ORERR,ORLSTNM,ORINVLST,ORCLNNM,ORPRVCLN,ORDLM,ORPRVDLM,ORENTY,ORACT
"RTN","ORY429",62,0)
 S (ORCLIN,ORLST,ORPRVCLN,ORPRVDLM)=0,ORACT="Migration"
"RTN","ORY429",63,0)
 F  S ORCLIN=$O(^GMPL(125,"C",ORCLIN)) Q:'ORCLIN  D
"RTN","ORY429",64,0)
 . F  S ORLST=$O(^GMPL(125,"C",ORCLIN,ORLST)) Q:'ORLST  D
"RTN","ORY429",65,0)
 . . S ORLSTNM=$$GET1^DIQ(125,ORLST,.01)
"RTN","ORY429",66,0)
 . . Q:ORLSTNM=""
"RTN","ORY429",67,0)
 . . S ORCLNNM=$$GET1^DIQ(44,ORCLIN,.01)
"RTN","ORY429",68,0)
 . . S ORDLM=$$GET1^DIQ(125,ORLST,.02,"I")
"RTN","ORY429",69,0)
 . . I '$$VALLIST^GMPLBLD2(ORLST) D
"RTN","ORY429",70,0)
 . . . Q:$$DUPLIST(.ORINVLST,ORLSTNM)
"RTN","ORY429",71,0)
 . . . S ORINVLST(ORLSTNM)=""
"RTN","ORY429",72,0)
 . . E  D
"RTN","ORY429",73,0)
 . . . I ORCLIN=ORPRVCLN D
"RTN","ORY429",74,0)
 . . . . I ORDLM>=ORPRVDLM D EN^XPAR("LOC."_ORCLNNM,"ORQQPL SELECTION LIST",1,ORLSTNM,.ORERR)
"RTN","ORY429",75,0)
 . . . E  D EN^XPAR("LOC."_ORCLNNM,"ORQQPL SELECTION LIST",1,ORLSTNM,.ORERR)
"RTN","ORY429",76,0)
 . . I ORCLIN'=ORPRVCLN S ORPRVCLN=ORCLIN
"RTN","ORY429",77,0)
 . . I ORDLM'=ORPRVDLM S ORPRVDLM=ORDLM
"RTN","ORY429",78,0)
 . . S ORENTY="LOC^"_ORCLNNM
"RTN","ORY429",79,0)
 . . I +$G(ORERR)>0 D PRNTERR(ORERR,ORACT,ORENTY,ORLSTNM) K ORERR
"RTN","ORY429",80,0)
 I $D(ORINVLST) D PRNTIERR(.ORINVLST)
"RTN","ORY429",81,0)
 Q
"RTN","ORY429",82,0)
 ;
"RTN","ORY429",83,0)
SETSYSPR ; Set system & package level of ORQQPL SELECTION LIST param to VA National list
"RTN","ORY429",84,0)
 N ORLSTNM,ORSYSERR,ORPKGERR,ORACT,ORSENTY,ORPENTY
"RTN","ORY429",85,0)
 S ORLSTNM="",ORACT="Setting"
"RTN","ORY429",86,0)
 S ORSENTY="SYS^",ORPENTY="PKG^ORDER ENTRY/RESULTS REPORTING"
"RTN","ORY429",87,0)
 F  S ORLSTNM=$O(^GMPL(125,"B",ORLSTNM)) Q:ORLSTNM=""  D
"RTN","ORY429",88,0)
 . I $E(ORLSTNM,1,3)="VA-" D
"RTN","ORY429",89,0)
 . . D EN^XPAR("SYS","ORQQPL SELECTION LIST",1,ORLSTNM,.ORSYSERR)
"RTN","ORY429",90,0)
 . . D EN^XPAR("PKG","ORQQPL SELECTION LIST",1,ORLSTNM,.ORPKGERR)
"RTN","ORY429",91,0)
 . . I +$G(ORSYSERR)>0 D PRNTERR(ORSYSERR,ORACT,ORSENTY,ORLSTNM)
"RTN","ORY429",92,0)
 . . I +$G(ORPKGERR)>0 D PRNTERR(ORPKGERR,ORACT,ORPENTY,ORLSTNM)
"RTN","ORY429",93,0)
 Q
"RTN","ORY429",94,0)
 ;
"RTN","ORY429",95,0)
SETUSRLT ; Migrate pre-existing user default list to ORQQPL SELECTION LIST param
"RTN","ORY429",96,0)
 N ORDUZ,ORLST,ORLSTNM,ORUSR,ORERR,ORINVLST,ORENTY,ORACT
"RTN","ORY429",97,0)
 S (ORUSR,ORDUZ)="",ORACT="Migration"
"RTN","ORY429",98,0)
 F  S ORUSR=$O(^VA(200,"B",ORUSR)) Q:ORUSR=""  D
"RTN","ORY429",99,0)
 . F  S ORDUZ=$O(^VA(200,"B",ORUSR,ORDUZ)) Q:ORDUZ=""  D
"RTN","ORY429",100,0)
 . . S ORLST=$$GET1^DIQ(200,ORDUZ,125.1,"I")
"RTN","ORY429",101,0)
 . . Q:'ORLST
"RTN","ORY429",102,0)
 . . S ORLSTNM=$$GET1^DIQ(125,ORLST,.01)
"RTN","ORY429",103,0)
 . . I ($L(ORLSTNM)>0) D
"RTN","ORY429",104,0)
 . . . I '$$VALLIST^GMPLBLD2(ORLST) D
"RTN","ORY429",105,0)
 . . . . Q:$$DUPLIST(.ORINVLST,ORLSTNM)
"RTN","ORY429",106,0)
 . . . . S ORINVLST(ORLSTNM)=""
"RTN","ORY429",107,0)
 . . . E  D ADD^XPAR(ORDUZ_";VA(200,","ORQQPL SELECTION LIST",1,ORLSTNM,.ORERR)
"RTN","ORY429",108,0)
 . . S ORENTY="USR^"_ORUSR
"RTN","ORY429",109,0)
 . . I +$G(ORERR)>0 D PRNTERR(ORERR,ORACT,ORENTY,ORLSTNM) K ORERR
"RTN","ORY429",110,0)
 I $D(ORINVLST) D PRNTIERR(.ORINVLST)
"RTN","ORY429",111,0)
 Q
"RTN","ORY429",112,0)
 ;
"VER")
8.0^22.2
**END**
**END**
