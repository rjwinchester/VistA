Released TIU*1*311 SEQ #276
Extracted from mail message
**KIDS**:TIU*1.0*311^

**INSTALL NAME**
TIU*1.0*311
"BLD",10403,0)
TIU*1.0*311^TEXT INTEGRATION UTILITIES^0^3170313^y
"BLD",10403,1,0)
^^4^4^3170125^
"BLD",10403,1,1,0)
In preparation for the VA's transition to become two factor authentication
"BLD",10403,1,2,0)
(2FA) compliant, the Mobile Electronic Documentation (MED) Graphical User 
"BLD",10403,1,3,0)
Interface (GUI) requires an upgrade to Delphi version XE8 in order to
"BLD",10403,1,4,0)
implement the, new Remote Procedure Call (RPC) Broker allowing compliance.
"BLD",10403,4,0)
^9.64PA^^
"BLD",10403,6.3)
13
"BLD",10403,"INIT")
EN^TIU311P
"BLD",10403,"KRN",0)
^9.67PA^779.2^20
"BLD",10403,"KRN",.4,0)
.4
"BLD",10403,"KRN",.401,0)
.401
"BLD",10403,"KRN",.402,0)
.402
"BLD",10403,"KRN",.403,0)
.403
"BLD",10403,"KRN",.5,0)
.5
"BLD",10403,"KRN",.84,0)
.84
"BLD",10403,"KRN",3.6,0)
3.6
"BLD",10403,"KRN",3.8,0)
3.8
"BLD",10403,"KRN",9.2,0)
9.2
"BLD",10403,"KRN",9.8,0)
9.8
"BLD",10403,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",10403,"KRN",9.8,"NM",1,0)
TIUMED1^^0^B44094112
"BLD",10403,"KRN",9.8,"NM",2,0)
TIU311P^^0^B1140668
"BLD",10403,"KRN",9.8,"NM","B","TIU311P",2)

"BLD",10403,"KRN",9.8,"NM","B","TIUMED1",1)

"BLD",10403,"KRN",19,0)
19
"BLD",10403,"KRN",19,"NM",0)
^9.68A^1^1
"BLD",10403,"KRN",19,"NM",1,0)
TIU MED GUI RPC V2^^0
"BLD",10403,"KRN",19,"NM","B","TIU MED GUI RPC V2",1)

"BLD",10403,"KRN",19.1,0)
19.1
"BLD",10403,"KRN",101,0)
101
"BLD",10403,"KRN",409.61,0)
409.61
"BLD",10403,"KRN",771,0)
771
"BLD",10403,"KRN",779.2,0)
779.2
"BLD",10403,"KRN",870,0)
870
"BLD",10403,"KRN",8989.51,0)
8989.51
"BLD",10403,"KRN",8989.51,"NM",0)
^9.68A^1^1
"BLD",10403,"KRN",8989.51,"NM",1,0)
TIU MED GUI VERSION^^0
"BLD",10403,"KRN",8989.51,"NM","B","TIU MED GUI VERSION",1)

"BLD",10403,"KRN",8989.52,0)
8989.52
"BLD",10403,"KRN",8994,0)
8994
"BLD",10403,"KRN",8994,"NM",0)
^9.68A^1^1
"BLD",10403,"KRN",8994,"NM",1,0)
TIU MED GET VERSION^^0
"BLD",10403,"KRN",8994,"NM","B","TIU MED GET VERSION",1)

"BLD",10403,"KRN","B",.4,.4)

"BLD",10403,"KRN","B",.401,.401)

"BLD",10403,"KRN","B",.402,.402)

"BLD",10403,"KRN","B",.403,.403)

"BLD",10403,"KRN","B",.5,.5)

"BLD",10403,"KRN","B",.84,.84)

"BLD",10403,"KRN","B",3.6,3.6)

"BLD",10403,"KRN","B",3.8,3.8)

"BLD",10403,"KRN","B",9.2,9.2)

"BLD",10403,"KRN","B",9.8,9.8)

"BLD",10403,"KRN","B",19,19)

"BLD",10403,"KRN","B",19.1,19.1)

"BLD",10403,"KRN","B",101,101)

"BLD",10403,"KRN","B",409.61,409.61)

"BLD",10403,"KRN","B",771,771)

"BLD",10403,"KRN","B",779.2,779.2)

"BLD",10403,"KRN","B",870,870)

"BLD",10403,"KRN","B",8989.51,8989.51)

"BLD",10403,"KRN","B",8989.52,8989.52)

"BLD",10403,"KRN","B",8994,8994)

"BLD",10403,"QUES",0)
^9.62^^
"BLD",10403,"REQB",0)
^9.611^1^1
"BLD",10403,"REQB",1,0)
TIU*1.0*264^1
"BLD",10403,"REQB","B","TIU*1.0*264",1)

"INIT")
EN^TIU311P
"KRN",19,13659,-1)
0^1
"KRN",19,13659,0)
TIU MED GUI RPC V2^Mobile Electronic Documentation ^^B^^^^^^^n^
"KRN",19,13659,1,0)
^19.06^2^2^3101014^^^^
"KRN",19,13659,1,1,0)
This option is required by the Kernel Broker to give access to
"KRN",19,13659,1,2,0)
 the RPCs used by Mobile Electronic Documentation.
"KRN",19,13659,99.1)
61003,55036
"KRN",19,13659,"RPC",0)
^19.05P^21^21
"KRN",19,13659,"RPC",11,0)
DG SENSITIVE RECORD ACCESS
"KRN",19,13659,"RPC",12,0)
DG SENSITIVE RECORD BULLETIN
"KRN",19,13659,"RPC",13,0)
TIU MED PATIENT MANAGEMENT
"KRN",19,13659,"RPC",14,0)
TIU MED LIST ALL
"KRN",19,13659,"RPC",15,0)
TIU MED LAST5
"KRN",19,13659,"RPC",16,0)
TIU MED GET PATIENT LISTS
"KRN",19,13659,"RPC",17,0)
TIU MED GET PATIENT DATA
"KRN",19,13659,"RPC",18,0)
TIU MED GET LIST DATA
"KRN",19,13659,"RPC",19,0)
TIU MED GET HEALTH SUMMARY
"KRN",19,13659,"RPC",20,0)
TIU MED GET OBJECT
"KRN",19,13659,"RPC",21,0)
TIU MED GET VERSION
"KRN",19,13659,"U")
MOBILE ELECTRONIC DOCUMENTATIO
"KRN",8989.51,852,-1)
0^1
"KRN",8989.51,852,0)
TIU MED GUI VERSION^TIU MED GUI VERSION CHECK^0^Version Number^Version Number^0
"KRN",8989.51,852,1)
F^^THIS IS THE CURRENT VERSION NUMBER FOR THE TIU MED VERSION
"KRN",8989.51,852,20,0)
^8989.512^2^2^3170201^^
"KRN",8989.51,852,20,1,0)
This parameter is used to store the GUI version that is compatible with the
"KRN",8989.51,852,20,2,0)
current server version on the TIU Mobile Electronic Documentation application.
"KRN",8989.51,852,30,0)
^8989.513I^1^1
"KRN",8989.51,852,30,1,0)
1^4.2
"KRN",8994,3412,-1)
0^1
"KRN",8994,3412,0)
TIU MED GET VERSION^GUIVER^TIUMED1^1
"KRN",8994,3412,1,0)
^8994.01^2^2^3170205^^^
"KRN",8994,3412,1,1,0)
This call returns what MED GUI version is stored in the PARAMETERS file   
"KRN",8994,3412,1,2,0)
as the current version.
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"ORD",20,8989.51)
8989.51;20;;;PAR1E1^XPDTA2;PAR1F1^XPDIA3;PAR1E1^XPDIA3;PAR1F2^XPDIA3;;PAR1DEL^XPDIA3(%)
"ORD",20,8989.51,0)
PARAMETER DEFINITION
"PKG",470,-1)
1^1
"PKG",470,0)
TEXT INTEGRATION UTILITIES^TIU^Text Integration Utilities 
"PKG",470,20,0)
^9.402P^^
"PKG",470,22,0)
^9.49I^1^1
"PKG",470,22,1,0)
1.0^3010801^3010806^66481
"PKG",470,22,1,"PAH",1,0)
311^3170313
"PKG",470,22,1,"PAH",1,1,0)
^^4^4^3170313
"PKG",470,22,1,"PAH",1,1,1,0)
In preparation for the VA's transition to become two factor authentication
"PKG",470,22,1,"PAH",1,1,2,0)
(2FA) compliant, the Mobile Electronic Documentation (MED) Graphical User 
"PKG",470,22,1,"PAH",1,1,3,0)
Interface (GUI) requires an upgrade to Delphi version XE8 in order to
"PKG",470,22,1,"PAH",1,1,4,0)
implement the, new Remote Procedure Call (RPC) Broker allowing compliance.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","TIU311P")
0^2^B1140668^n/a
"RTN","TIU311P",1,0)
TIU311P ;MNTVBB/RRA - Post Installation Tasks;02/01/17
"RTN","TIU311P",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**311**;Jun 20, 1997;Build 13
"RTN","TIU311P",3,0)
 ;;Per VA Directive 6402, this routine should not be modified..
"RTN","TIU311P",4,0)
 ;
"RTN","TIU311P",5,0)
 ; This routine uses the following IAs:
"RTN","TIU311P",6,0)
 ;  #10141       - MES^XPDUTL                   Kernel                         (supported)
"RTN","TIU311P",7,0)
 ;  #2263        - EN^XPAR                      Kernel                         (supported)
"RTN","TIU311P",8,0)
 ;
"RTN","TIU311P",9,0)
 Q
"RTN","TIU311P",10,0)
EN ; 
"RTN","TIU311P",11,0)
 ;
"RTN","TIU311P",12,0)
 N TIUERR
"RTN","TIU311P",13,0)
 S TIUERR=""
"RTN","TIU311P",14,0)
 ; Installing commands in the command file...
"RTN","TIU311P",15,0)
 D MES^XPDUTL(" Post install starting....updating Parameters...")
"RTN","TIU311P",16,0)
 ;
"RTN","TIU311P",17,0)
 ; ADD TIU MED GUI VERSION with new build numbers for executables.  
"RTN","TIU311P",18,0)
 D ADD^XPAR("SYS","TIU MED GUI VERSION",1,"2.3.311.6",.TIUERR)
"RTN","TIU311P",19,0)
 I +$G(TIUERR) D
"RTN","TIU311P",20,0)
 . D BMES^XPDUTL("    "_TIUERR)
"RTN","TIU311P",21,0)
 . D BMES^XPDUTL("   ....Parameter not added  ")
"RTN","TIU311P",22,0)
 ;
"RTN","TIU311P",23,0)
 D BMES^XPDUTL(" TIU*1.0*311 Post Install complete")
"RTN","TIU311P",24,0)
 ;
"RTN","TIU311P",25,0)
 Q
"RTN","TIU311P",26,0)
 ;
"RTN","TIUMED1")
0^1^B44094112^B43223292
"RTN","TIUMED1",1,0)
TIUMED1 ; BP/AJB - Mobile Elec. Doc ; 4/30/12 7:40am
"RTN","TIUMED1",2,0)
 ;;1.0;TEXT INTEGRATION UTILITIES;**244,257,264,311**;Jun 20, 1997;Build 13
"RTN","TIUMED1",3,0)
 ; ^SC(     IA# 10040
"RTN","TIUMED1",4,0)
 ; XPAR     IA# 2263
"RTN","TIUMED1",5,0)
 ; XUPARAM  IA# 2541
"RTN","TIUMED1",6,0)
 ; XLFSTR   IA# 10104
"RTN","TIUMED1",7,0)
 ; GMTSDVR  IA# 744
"RTN","TIUMED1",8,0)
 ; %ZISH    IA# 2320
"RTN","TIUMED1",9,0)
 ; DGPMDDCF IA# 1246
"RTN","TIUMED1",10,0)
 ; 
"RTN","TIUMED1",11,0)
 Q
"RTN","TIUMED1",12,0)
ACTLOC(TIULOC) ; IA # 10040
"RTN","TIUMED1",13,0)
 N D0,X I +$G(^SC(TIULOC,"OOS")) Q 0
"RTN","TIUMED1",14,0)
 S D0=+$G(^SC(TIULOC,42)) I D0 D WIN^DGPMDDCF Q 'X  ; IA # 1246
"RTN","TIUMED1",15,0)
 S X=$G(^SC(TIULOC,"I")) I +X=0 Q 1
"RTN","TIUMED1",16,0)
 I DT>$P(X,U)&($P(X,U,2)=""!(DT<$P(X,U,2))) Q 0
"RTN","TIUMED1",17,0)
 Q 1
"RTN","TIUMED1",18,0)
CLINLOC(TIUY,TIUF,TIUDIR) ; returns a set of clinics from HOSPITAL LOCATION
"RTN","TIUMED1",19,0)
 N TIUCNT,TIUDT,TIUIEN,TIUQUIT
"RTN","TIUMED1",20,0)
 S TIUCNT=0
"RTN","TIUMED1",21,0)
 F  Q:TIUCNT'<44  S TIUF=$O(^SC("B",TIUF),TIUDIR) Q:TIUF=""  D  ; IA # 10040
"RTN","TIUMED1",22,0)
 . S TIUIEN="" F  S TIUIEN=$O(^SC("B",TIUF,TIUIEN),TIUDIR) Q:'TIUIEN  D
"RTN","TIUMED1",23,0)
 . . I ($P($G(^SC(TIUIEN,0)),U,3)'="C") Q
"RTN","TIUMED1",24,0)
 . . I '+$$ACTLOC(TIUIEN) Q
"RTN","TIUMED1",25,0)
 . . S TIUCNT=TIUCNT+1,TIUY(TIUCNT)=TIUIEN_"^"_TIUF
"RTN","TIUMED1",26,0)
 Q
"RTN","TIUMED1",27,0)
GETHS(TIUY,TIUDFN) ; get health summary
"RTN","TIUMED1",28,0)
 N POP,TIUHF,TIUHS,TIULOC,TIUX
"RTN","TIUMED1",29,0)
 S TIUHS=$$GET^XPAR(DUZ_";VA(200,","TIU MED HSTYPE",1,"Q") ; IA # 2263
"RTN","TIUMED1",30,0)
 I '+TIUHS D
"RTN","TIUMED1",31,0)
 . N TIU,TIUDIV,TIUSRV,TIUSYS D USERINFO^XUSRB2(.TIU)
"RTN","TIUMED1",32,0)
 . S TIUDIV=+TIU(3),TIUSRV=$$LU^TIUPS244(49,TIU(5),"X")
"RTN","TIUMED1",33,0)
 . S TIUHS=$$GET^XPAR(TIUSRV_";DIC(49,","TIU MED HSTYPE",1,"Q")
"RTN","TIUMED1",34,0)
 . S:'+TIUHS TIUHS=$$GET^XPAR(TIUDIV_";DIC(4,","TIU MED HSTYPE",1,"Q")
"RTN","TIUMED1",35,0)
 . I '+TIUHS D
"RTN","TIUMED1",36,0)
 . . S TIUSYS=$$KSP^XUPARAM("WHERE") ; IA # 2541
"RTN","TIUMED1",37,0)
 . . S TIUSYS=$$LU^TIUPS244(4.2,TIUSYS)
"RTN","TIUMED1",38,0)
 . . S TIUHS=$$GET^XPAR(TIUSYS_";DIC(4.2,","TIU MED HSTYPE",1,"Q")
"RTN","TIUMED1",39,0)
 S TIUHF=$$DEFDIR^%ZISH("") ; use default directory IA # 2320
"RTN","TIUMED1",40,0)
 I '+TIUHS S ^TMP("TIUMED",$J,0)="No Default Health Summary Selected" M TIUY=^TMP("TIUMED",$J) K ^TMP("TIUMED",$J) Q
"RTN","TIUMED1",41,0)
 S TIULOC=TIUDFN_$J_".DAT"
"RTN","TIUMED1",42,0)
 D OPEN^%ZISH("TIUMED_"_$J,TIUHF,TIULOC,"W")
"RTN","TIUMED1",43,0)
 Q:+POP
"RTN","TIUMED1",44,0)
 U IO
"RTN","TIUMED1",45,0)
 D ENX^GMTSDVR(TIUDFN,TIUHS,0,0) ; IA # 744
"RTN","TIUMED1",46,0)
 D CLOSE^%ZISH("TIUMED_"_$J)
"RTN","TIUMED1",47,0)
 K ^TMP("TIUMED",$J)
"RTN","TIUMED1",48,0)
 I '+$$FTG^%ZISH(TIUHF,TIULOC,$NA(^TMP("TIUMED",$J,0)),3) Q
"RTN","TIUMED1",49,0)
 S TIUX(TIULOC)="" I $$DEL^%ZISH(TIUHF,$NA(TIUX))
"RTN","TIUMED1",50,0)
 M TIUY=^TMP("TIUMED",$J)
"RTN","TIUMED1",51,0)
 K ^TMP("TIUMED",$J)
"RTN","TIUMED1",52,0)
 Q
"RTN","TIUMED1",53,0)
GETOBJ(TIUY,TIUDFN,TIUOBJ) ; get patient data object
"RTN","TIUMED1",54,0)
 N DFN,TIUX,VA,VADM,VAERR
"RTN","TIUMED1",55,0)
 K ^TMP("TIUMED",$J) S TIUY=$NA(^TMP("TIUMED",$J))
"RTN","TIUMED1",56,0)
 S TIUOBJ="|"_TIUOBJ_"|"
"RTN","TIUMED1",57,0)
 S DFN=$G(TIUDFN) I '+DFN Q
"RTN","TIUMED1",58,0)
 S TIUX=$$BOIL^TIUSRVD(TIUOBJ,"")
"RTN","TIUMED1",59,0)
 I TIUX["~@" S TIUX=$P(TIUX,"~@",2) M @TIUY=@TIUX K @TIUX Q
"RTN","TIUMED1",60,0)
 M @TIUY@(0)=TIUX
"RTN","TIUMED1",61,0)
 Q
"RTN","TIUMED1",62,0)
GETPATDT(TIUY,TIUDFN,TIUSEC,TIUGHS) ; get patient data
"RTN","TIUMED1",63,0)
 I +$D(TIUDFN)=1,+$G(TIUDFN) S TIUDFN(0)=TIUDFN
"RTN","TIUMED1",64,0)
 N TIULIST
"RTN","TIUMED1",65,0)
 S TIULIST="" F  S TIULIST=$O(TIUDFN(TIULIST)) Q:TIULIST=""  D
"RTN","TIUMED1",66,0)
 . N TIU,TIUERR
"RTN","TIUMED1",67,0)
 . D FIND^DIC(2,,".01;.02I;.03I;.09","AXQ",$G(TIUDFN(TIULIST)),1,,,,"TIU","TIUERR")
"RTN","TIUMED1",68,0)
 . S TIU("NAME")=$G(TIU("DILIST","ID",1,.01))
"RTN","TIUMED1",69,0)
 . S TIU("SEX")=$G(TIU("DILIST","ID",1,.02))
"RTN","TIUMED1",70,0)
 . S TIU("DOB")=$G(TIU("DILIST","ID",1,.03))
"RTN","TIUMED1",71,0)
 . S TIU("SSN")=$G(TIU("DILIST","ID",1,.09))
"RTN","TIUMED1",72,0)
 . S TIU("SECURITY")=+$$GET1^DIQ(38.1,$G(TIUDFN(TIULIST)),2,"I")
"RTN","TIUMED1",73,0)
 . I '+$G(TIUSEC),+TIU("SECURITY") S (TIU("SEX"),TIU("DOB"),TIU("SSN"))="*SENSITIVE*"
"RTN","TIUMED1",74,0)
 . I +$G(TIUGHS) D GETHS(.TIUY,$G(TIUDFN(TIULIST)))
"RTN","TIUMED1",75,0)
 . S TIUY(TIULIST)=$G(TIUDFN(TIULIST))_U_TIU("NAME")_U_TIU("SEX")_U_TIU("SSN")_U_TIU("DOB")_U_TIU("SECURITY")
"RTN","TIUMED1",76,0)
 Q
"RTN","TIUMED1",77,0)
LAST5(TIUY,TIUID) ; IA # 3291
"RTN","TIUMED1",78,0)
 D LAST5^ORWPT(.TIUY,TIUID)
"RTN","TIUMED1",79,0)
 Q
"RTN","TIUMED1",80,0)
LISTALL(TIUY,TIUFROM,TIUDIR) ; IA # 1685
"RTN","TIUMED1",81,0)
 D LISTALL^ORWPT(.TIUY,TIUFROM,TIUDIR)
"RTN","TIUMED1",82,0)
 Q
"RTN","TIUMED1",83,0)
DELPARM ;
"RTN","TIUMED1",84,0)
 N DIC,DIR,DIROUT,DIRUT,DTOUT,DUOUT,POP,TIUANS,TIUERR,TIUSYS,X,Y
"RTN","TIUMED1",85,0)
DCONT K DIC,DIR,DIROUT,DIRUT,DTOUT,DUOUT,POP,TIUANS,TIUERR,TIUSYS,X,Y
"RTN","TIUMED1",86,0)
 S TIUSYS=$$KSP^XUPARAM("WHERE") ; IA # 2541
"RTN","TIUMED1",87,0)
 S TIUSYS=$$LU^TIUPS244(4.2,TIUSYS)_U_TIUSYS
"RTN","TIUMED1",88,0)
 S DIR(0)="SO^1:User;2:Service;3:Division;4:System"
"RTN","TIUMED1",89,0)
 S DIR("L",1)="Delete a Health Summary for one the following:"
"RTN","TIUMED1",90,0)
 S DIR("L",2)=""
"RTN","TIUMED1",91,0)
 S DIR("L",3)="     1   User       [choose from NEW PERSON]"
"RTN","TIUMED1",92,0)
 S DIR("L",4)="     2   Service    [choose from SERVICE/SECTION]"
"RTN","TIUMED1",93,0)
 S DIR("L",5)="     3   Division   [choose from INSTITUTION]"
"RTN","TIUMED1",94,0)
 S DIR("L")="     4   System     ["_$P(TIUSYS,U,2)_"]"
"RTN","TIUMED1",95,0)
 S DIR("A")="Enter Selection"
"RTN","TIUMED1",96,0)
 W @IOF
"RTN","TIUMED1",97,0)
 D ^DIR Q:$D(DIRUT)
"RTN","TIUMED1",98,0)
 S TIUANS=$S(Y=1:"VA(200,",Y=2:"DIC(49,",Y=3:"DIC(4,",Y=4:"DIC(4.2,")
"RTN","TIUMED1",99,0)
 S DIC(0)="AE",DIC=U_TIUANS
"RTN","TIUMED1",100,0)
 S DIC("A")="Please select a "_$$UP^XLFSTR(Y(0))_": "
"RTN","TIUMED1",101,0)
 I Y'=4 W ! D ^DIC Q:$D(DIRUT)
"RTN","TIUMED1",102,0)
 I +Y'>0 G DCONT
"RTN","TIUMED1",103,0)
 S TIUANS=TIUANS_U_$S(Y=4:TIUSYS,1:Y)
"RTN","TIUMED1",104,0)
 W !!,"Delete the Health Summary for "_$$UP^XLFSTR(Y(0))_" ["_$P(TIUANS,U,3)_"]",!
"RTN","TIUMED1",105,0)
 I '+$$READ^TIUU("YA","Are you sure? ","NO") G DCONT
"RTN","TIUMED1",106,0)
 D DEL^XPAR($P(TIUANS,U,2)_";"_$P(TIUANS,U),"TIU MED HSTYPE")
"RTN","TIUMED1",107,0)
 W !!,"Parameter Deleted.",! I $$READ^TIUU("EA","RETURN to continue...")
"RTN","TIUMED1",108,0)
 D DCONT
"RTN","TIUMED1",109,0)
 Q
"RTN","TIUMED1",110,0)
PARMEDIT ;
"RTN","TIUMED1",111,0)
 N DIC,DIR,DIROUT,DIRUT,DTOUT,DUOUT,POP,TIUANS,TIUERR,TIUSYS,X,Y
"RTN","TIUMED1",112,0)
CONT K DIC,DIR,DIROUT,DIRUT,DTOUT,DUOUT,POP,TIUANS,TIUERR,TIUSYS,X,Y
"RTN","TIUMED1",113,0)
 S TIUSYS=$$KSP^XUPARAM("WHERE") ; IA # 2541
"RTN","TIUMED1",114,0)
 S TIUSYS=$$LU^TIUPS244(4.2,TIUSYS)_U_TIUSYS
"RTN","TIUMED1",115,0)
 S DIR(0)="SO^1:User;2:Service;3:Division;4:System"
"RTN","TIUMED1",116,0)
 S DIR("L",1)="TIU MED HSTYPE may be set for the following:"
"RTN","TIUMED1",117,0)
 S DIR("L",2)=""
"RTN","TIUMED1",118,0)
 S DIR("L",3)="     1   User       [choose from NEW PERSON]"
"RTN","TIUMED1",119,0)
 S DIR("L",4)="     2   Service    [choose from SERVICE/SECTION]"
"RTN","TIUMED1",120,0)
 S DIR("L",5)="     3   Division   [choose from INSTITUTION]"
"RTN","TIUMED1",121,0)
 S DIR("L")="     4   System     ["_$P(TIUSYS,U,2)_"]"
"RTN","TIUMED1",122,0)
 S DIR("A")="Enter Selection"
"RTN","TIUMED1",123,0)
 W @IOF
"RTN","TIUMED1",124,0)
 D ^DIR Q:$D(DIRUT)
"RTN","TIUMED1",125,0)
 S TIUANS=$S(Y=1:"VA(200,",Y=2:"DIC(49,",Y=3:"DIC(4,",Y=4:"DIC(4.2,")
"RTN","TIUMED1",126,0)
 S DIC(0)="AE",DIC=U_TIUANS
"RTN","TIUMED1",127,0)
 S DIC("A")="Please select a "_$$UP^XLFSTR(Y(0))_": "
"RTN","TIUMED1",128,0)
 I Y'=4 W ! D ^DIC Q:$D(DIRUT)
"RTN","TIUMED1",129,0)
 I +Y'>0 G CONT
"RTN","TIUMED1",130,0)
 S TIUANS=TIUANS_U_$S(Y=4:TIUSYS,1:Y)
"RTN","TIUMED1",131,0)
 S DIC="^GMT(142,",DIC("A")="Enter a HS for "_$$UP^XLFSTR(Y(0))_" ["_$S(Y(0)="System":$P(TIUSYS,U,2),1:$P(TIUANS,U,3))_"]: "
"RTN","TIUMED1",132,0)
 S DIC("B")=$$GET^XPAR($P(TIUANS,U,2)_";"_$P(TIUANS,U),"TIU MED HSTYPE",1,"Q") ; IA # 2263
"RTN","TIUMED1",133,0)
 W ! D ^DIC
"RTN","TIUMED1",134,0)
 ;*264 Update parameter to use IEN.
"RTN","TIUMED1",135,0)
 I +Y>0 D EN^XPAR($P(TIUANS,U,2)_";"_$P(TIUANS,U),"TIU MED HSTYPE",1,"`"_+Y,.TIUERR) ; IA # 2263
"RTN","TIUMED1",136,0)
 G CONT
"RTN","TIUMED1",137,0)
 Q
"RTN","TIUMED1",138,0)
PATMAN(TIUY) ;
"RTN","TIUMED1",139,0)
 N TIUP S TIUY=0
"RTN","TIUMED1",140,0)
 D OWNSKEY^XUSRB(.TIUP,"TIU MED MANUAL PATIENT") I +TIUP(0) S TIUY=1
"RTN","TIUMED1",141,0)
 D OWNSKEY^XUSRB(.TIUP,"TIU MED MANUAL OVERRIDE") I +TIUP(0) S TIUY=2
"RTN","TIUMED1",142,0)
 Q
"RTN","TIUMED1",143,0)
PLISTMEM(TIUY,TIULIST) ;
"RTN","TIUMED1",144,0)
 N TIU,TIUDFN,TIUERR,TIUI,TIUJ
"RTN","TIUMED1",145,0)
 S TIUI=$NA(TIU(100.2101))
"RTN","TIUMED1",146,0)
 D GETS^DIQ(100.21,$G(TIULIST),"10*","I","TIU","TIUERR")
"RTN","TIUMED1",147,0)
 S TIUJ="" F  S TIUJ=$O(@TIUI@(TIUJ)) Q:'TIUJ  S TIUDFN(+TIUJ)=+@TIUI@(TIUJ,.01,"I")
"RTN","TIUMED1",148,0)
 D GETPATDT(.TIUY,.TIUDFN)
"RTN","TIUMED1",149,0)
 Q
"RTN","TIUMED1",150,0)
PLISTS(TIUY) ;
"RTN","TIUMED1",151,0)
 N TIU,TIUERR,TIUI,TIUJ,TIUX
"RTN","TIUMED1",152,0)
 S TIUI=$NA(TIU("DILIST")),TIUJ=$NA(^OR(100.21))
"RTN","TIUMED1",153,0)
 D FIND^DIC(100.21,,"-.01","AXQ",DUZ,,"C","I $P($G(^OR(100.21,Y,0)),U,2)=""P""",,"TIU")
"RTN","TIUMED1",154,0)
 I '+$G(@TIUI@(0)) Q
"RTN","TIUMED1",155,0)
 S TIUX="" F  S TIUX=$O(@TIUI@("2",TIUX)) Q:'+TIUX  S TIUY(TIUX)=@TIUI@("2",TIUX)_U_@TIUJ@(@TIUI@("2",TIUX),0)
"RTN","TIUMED1",156,0)
 Q
"RTN","TIUMED1",157,0)
GUIVER(TIUMEDVER) ; Will retrieve the version number from the TIU MED GUI VERSION parameter
"RTN","TIUMED1",158,0)
 ;Input parameters
"RTN","TIUMED1",159,0)
 ;1. TIUMEDVER    Version number from TIU MED GUI VERSION parameter
"RTN","TIUMED1",160,0)
 ;IA# 2263 [Supported] XPAR Utilities
"RTN","TIUMED1",161,0)
 S TIUMEDVER=$$GET^XPAR("SYS","TIU MED GUI VERSION")
"RTN","TIUMED1",162,0)
 Q
"VER")
8.0^22.0
"BLD",10403,6)
^276
**END**
**END**

