Released LEX*2*87 SEQ #87
Extracted from mail message
**KIDS**:LEX*2.0*87^

**INSTALL NAME**
LEX*2.0*87
"BLD",8336,0)
LEX*2.0*87^LEXICON UTILITY^0^3140614^y
"BLD",8336,1,0)
^^2^2^3140508^
"BLD",8336,1,1,0)
Please see the National Patch Module for details of the enhancements
"BLD",8336,1,2,0)
included in this patch.
"BLD",8336,4,0)
^9.64PA^^
"BLD",8336,6.3)
1
"BLD",8336,"INIT")
POST^LEX2087P
"BLD",8336,"KRN",0)
^9.67PA^779.2^20
"BLD",8336,"KRN",.4,0)
.4
"BLD",8336,"KRN",.401,0)
.401
"BLD",8336,"KRN",.402,0)
.402
"BLD",8336,"KRN",.403,0)
.403
"BLD",8336,"KRN",.5,0)
.5
"BLD",8336,"KRN",.84,0)
.84
"BLD",8336,"KRN",3.6,0)
3.6
"BLD",8336,"KRN",3.8,0)
3.8
"BLD",8336,"KRN",9.2,0)
9.2
"BLD",8336,"KRN",9.8,0)
9.8
"BLD",8336,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",8336,"KRN",9.8,"NM",1,0)
LEX2087^^0^B164345418
"BLD",8336,"KRN",9.8,"NM",2,0)
LEX2087P^^0^B28656391
"BLD",8336,"KRN",9.8,"NM",3,0)
LEX2087A^^0^B124616164
"BLD",8336,"KRN",9.8,"NM","B","LEX2087",1)

"BLD",8336,"KRN",9.8,"NM","B","LEX2087A",3)

"BLD",8336,"KRN",9.8,"NM","B","LEX2087P",2)

"BLD",8336,"KRN",19,0)
19
"BLD",8336,"KRN",19.1,0)
19.1
"BLD",8336,"KRN",101,0)
101
"BLD",8336,"KRN",409.61,0)
409.61
"BLD",8336,"KRN",771,0)
771
"BLD",8336,"KRN",779.2,0)
779.2
"BLD",8336,"KRN",870,0)
870
"BLD",8336,"KRN",8989.51,0)
8989.51
"BLD",8336,"KRN",8989.52,0)
8989.52
"BLD",8336,"KRN",8994,0)
8994
"BLD",8336,"KRN","B",.4,.4)

"BLD",8336,"KRN","B",.401,.401)

"BLD",8336,"KRN","B",.402,.402)

"BLD",8336,"KRN","B",.403,.403)

"BLD",8336,"KRN","B",.5,.5)

"BLD",8336,"KRN","B",.84,.84)

"BLD",8336,"KRN","B",3.6,3.6)

"BLD",8336,"KRN","B",3.8,3.8)

"BLD",8336,"KRN","B",9.2,9.2)

"BLD",8336,"KRN","B",9.8,9.8)

"BLD",8336,"KRN","B",19,19)

"BLD",8336,"KRN","B",19.1,19.1)

"BLD",8336,"KRN","B",101,101)

"BLD",8336,"KRN","B",409.61,409.61)

"BLD",8336,"KRN","B",771,771)

"BLD",8336,"KRN","B",779.2,779.2)

"BLD",8336,"KRN","B",870,870)

"BLD",8336,"KRN","B",8989.51,8989.51)

"BLD",8336,"KRN","B",8989.52,8989.52)

"BLD",8336,"KRN","B",8994,8994)

"BLD",8336,"PRE")
LEX2087
"BLD",8336,"QDEF")
^^^^NO^^^^^^NO
"BLD",8336,"QUES",0)
^9.62^^
"BLD",8336,"REQB",0)
^9.611^4^4
"BLD",8336,"REQB",1,0)
ICD*18.0*57^2
"BLD",8336,"REQB",2,0)
LEX*2.0*80^2
"BLD",8336,"REQB",3,0)
LEX*2.0*95^2
"BLD",8336,"REQB",4,0)
ICD*18.0*64^2
"BLD",8336,"REQB","B","ICD*18.0*57",1)

"BLD",8336,"REQB","B","ICD*18.0*64",4)

"BLD",8336,"REQB","B","LEX*2.0*80",2)

"BLD",8336,"REQB","B","LEX*2.0*95",3)

"INIT")
POST^LEX2087P
"MBREQ")
0
"PKG",574,-1)
1^1
"PKG",574,0)
LEXICON UTILITY^LEX^Medical and Biomedical Terminology System.
"PKG",574,20,0)
^9.402P^^
"PKG",574,22,0)
^9.49I^1^1
"PKG",574,22,1,0)
2.0^2960915^2970127^1
"PKG",574,22,1,"PAH",1,0)
87^3140614^520665225
"PKG",574,22,1,"PAH",1,1,0)
^^2^2^3140614
"PKG",574,22,1,"PAH",1,1,1,0)
Please see the National Patch Module for details of the enhancements
"PKG",574,22,1,"PAH",1,1,2,0)
included in this patch.
"PRE")
LEX2087
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","LEX2087")
0^1^B164345418^n/a
"RTN","LEX2087",1,0)
LEX2087 ;ISL/KER - LEX*2.0*87 Env Check ;06/14/2014
"RTN","LEX2087",2,0)
 ;;2.0;LEXICON UTILITY;**87**;Sep 23, 1996;Build 1
"RTN","LEX2087",3,0)
 ;               
"RTN","LEX2087",4,0)
 ; Global Variables 
"RTN","LEX2087",5,0)
 ;    ^LEXM               N/A
"RTN","LEX2087",6,0)
 ;               
"RTN","LEX2087",7,0)
 ; External References
"RTN","LEX2087",8,0)
 ;    FIND^DIC            ICR   2051
"RTN","LEX2087",9,0)
 ;    $$IENS^DILF         ICR   2054
"RTN","LEX2087",10,0)
 ;    EN^DIQ1             ICR  10015
"RTN","LEX2087",11,0)
 ;    $$FMTE^XLFDT        ICR  10103
"RTN","LEX2087",12,0)
 ;    $$PATCH^XPDUTL      ICR  10141
"RTN","LEX2087",13,0)
 ;    $$VERSION^XPDUTL    ICR  10141
"RTN","LEX2087",14,0)
 ;    BMES^XPDUTL         ICR  10141
"RTN","LEX2087",15,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2087",16,0)
 ;               
"RTN","LEX2087",17,0)
 ; Local Variables Killed by Kernel after Install
"RTN","LEX2087",18,0)
 ;     XPDABORT,XPDDIQ,XPDQUIT
"RTN","LEX2087",19,0)
 ;     
"RTN","LEX2087",20,0)
 ; see Kernel Developer Guide
"RTN","LEX2087",21,0)
 ;     Chapter 14, KIDS Developer Tools
"RTN","LEX2087",22,0)
 ;     Advanced Build Techniques
"RTN","LEX2087",23,0)
 ;     
"RTN","LEX2087",24,0)
 ; The following sections must be updated with each patch
"RTN","LEX2087",25,0)
 ;        
"RTN","LEX2087",26,0)
 ;     IMP^LEX20nn   Import names
"RTN","LEX2087",27,0)
 ;     
"RTN","LEX2087",28,0)
 ;         This section sets the following variables:
"RTN","LEX2087",29,0)
 ;         
"RTN","LEX2087",30,0)
 ;         LEXBUILD   Build Name            LEX*2.0*nn
"RTN","LEX2087",31,0)
 ;         LEXPTYPE   Patch Type            Remedy or Quarterly
"RTN","LEX2087",32,0)
 ;         LEXIGHF    Name of Host File     LEX_2_nn.GBL
"RTN","LEX2087",33,0)
 ;         LEXLREV    Revision Number       nn
"RTN","LEX2087",34,0)
 ;         LEXFY      Fiscal Year           FYnn
"RTN","LEX2087",35,0)
 ;         LEXQTR     Quarter               1st, 2nd, 3rd, or 4th
"RTN","LEX2087",36,0)
 ;         LEXREQP(n) Required Patch Array
"RTN","LEX2087",37,0)
 ;
"RTN","LEX2087",38,0)
 ;     GD^LEX20nn    Global Data
"RTN","LEX2087",39,0)
 ;     
"RTN","LEX2087",40,0)
 ;         This is a listing of globals that this patch writes 
"RTN","LEX2087",41,0)
 ;         to, it contains a closed global root, a global ID, 
"RTN","LEX2087",42,0)
 ;         a global name and file numbers. 
"RTN","LEX2087",43,0)
 ;                          
"RTN","LEX2087",44,0)
 ;     IPL^LEX20nnP  Informational Patch List
"RTN","LEX2087",45,0)
 ;     
"RTN","LEX2087",46,0)
 ;         This is a listing of informational patches that 
"RTN","LEX2087",47,0)
 ;         accompany this patch.  It consist of a patch nane 
"RTN","LEX2087",48,0)
 ;         and a sequence number when available.
"RTN","LEX2087",49,0)
 ;               
"RTN","LEX2087",50,0)
ENV ; Environment Check
"RTN","LEX2087",51,0)
 ;                    
"RTN","LEX2087",52,0)
 ;   General
"RTN","LEX2087",53,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR,LEXG,LEXB,LEXE,LEXR,LEXSTR,LEXOK D IMP
"RTN","LEX2087",54,0)
 K XPDDIQ("XPZ1","B"),XPDDIQ("XPI1","B") S XPDDIQ("XPZ1","B")="NO",XPDDIQ("XPI1","B")="NO"
"RTN","LEX2087",55,0)
 S LEXSTR=$G(LEXPTYPE) S:$L($G(LEXFY))&($L($G(LEXQTR))) LEXSTR=LEXSTR_" for "_$G(LEXFY)_" "_$G(LEXQTR)_" Quarter"
"RTN","LEX2087",56,0)
 D BM(LEXSTR),M("")
"RTN","LEX2087",57,0)
 S U="^"
"RTN","LEX2087",58,0)
 ;     No user
"RTN","LEX2087",59,0)
 D:+($$UR)'>0 ET("User not defined (DUZ)")
"RTN","LEX2087",60,0)
 ;     No IO
"RTN","LEX2087",61,0)
 D:+($$SY)'>0 ET("Undefined IO variable(s)")
"RTN","LEX2087",62,0)
 I $D(LEXE) D ABRT Q
"RTN","LEX2087",63,0)
 ;                    
"RTN","LEX2087",64,0)
 ;   Load Distribution                        XPDENV = 0
"RTN","LEX2087",65,0)
 ;       Check Version (2.0)
"RTN","LEX2087",66,0)
 I $$VERSION^XPDUTL("LEX")'="2.0" D  D ABRT Q
"RTN","LEX2087",67,0)
 . D ET("Version 2.0 not found.  Please install Lexicon Utility v 2.0")
"RTN","LEX2087",68,0)
 N LEXOK,LEXA,LEXG,LEXR,LEXB,LEXI,LEXD
"RTN","LEX2087",69,0)
 ;       Check Required Patches
"RTN","LEX2087",70,0)
 D:$O(LEXREQP(0))'>0 IMP I $O(LEXREQP(0))>0 D
"RTN","LEX2087",71,0)
 . W ! N LEXPAT,LEXI,LEXPN,LEXP,LEXR,LEXC,LEXO,LEXC1,LEXC2,LEXC3,LEXC4,LEX
"RTN","LEX2087",72,0)
 . S (LEXR,LEXC)=0 S LEXC1=3,LEXC2=23,LEXC3=25,LEXC4=37
"RTN","LEX2087",73,0)
 . S LEXI=0  F  S LEXI=$O(LEXREQP(LEXI)) Q:+LEXI'>0  D
"RTN","LEX2087",74,0)
 . . S LEXC=LEXC+1,LEXPAT=$G(LEXREQP(LEXI))
"RTN","LEX2087",75,0)
 . S LEXI=0  F  S LEXI=$O(LEXREQP(LEXI)) Q:+LEXI'>0  D
"RTN","LEX2087",76,0)
 . . N LEXPAT,LEXREL,LEXINS,LEXCOM,LEXINE,LEXREQ,LEXTX S LEXREQ=$G(LEXREQP(LEXI))
"RTN","LEX2087",77,0)
 . . S LEXPAT=$P(LEXREQ,"^",1),LEXREL=$P(LEXREQ,"^",2),LEXCOM=$P(LEXREQ,"^",3)
"RTN","LEX2087",78,0)
 . . S LEXPN=$$INS(LEXPAT) S LEXINS=$$INSD(LEXPAT),LEXINE=$P(LEXINS,"^",2)
"RTN","LEX2087",79,0)
 . . I LEXI=1 D
"RTN","LEX2087",80,0)
 . . . W !,?LEXC1,"Checking for ",!
"RTN","LEX2087",81,0)
 . . . W !,?LEXC1,"Patch",?LEXC2,"",?LEXC3,"Installed",?LEXC4,"Content"
"RTN","LEX2087",82,0)
 . . S LEXTX=$J(" ",LEXC1)_LEXPAT
"RTN","LEX2087",83,0)
 . . S LEXTX=LEXTX_$J(" ",(LEXC2-$L(LEXTX)))
"RTN","LEX2087",84,0)
 . . S:LEXREL?7N LEXTX=LEXTX_$P($$FMTE^XLFDT(LEXREL,"5DZ"),"@",1)
"RTN","LEX2087",85,0)
 . . S LEXTX=LEXTX_$J(" ",(LEXC3-$L(LEXTX)))
"RTN","LEX2087",86,0)
 . . I +LEXPN>0 D
"RTN","LEX2087",87,0)
 . . . S LEXO=+($G(LEXO))+1 S:$L($G(LEXINE)) LEXTX=LEXTX_LEXINE
"RTN","LEX2087",88,0)
 . . . S LEXTX=LEXTX_$J(" ",(LEXC4-$L(LEXTX)))
"RTN","LEX2087",89,0)
 . . . S:$L(LEXCOM) LEXTX=LEXTX_LEXCOM
"RTN","LEX2087",90,0)
 . . D M(LEXTX)
"RTN","LEX2087",91,0)
 . . I +LEXPN'>0 D ET((" "_LEXPAT_" not found, please install "_LEXPAT_" before continuing"))
"RTN","LEX2087",92,0)
 . W:+($G(LEXO))'=LEXC !
"RTN","LEX2087",93,0)
 I $D(LEXE) D M(),ABRT Q
"RTN","LEX2087",94,0)
 S LEXG=$$RGBL
"RTN","LEX2087",95,0)
 I $D(LEXE)&(+LEXG=0) D ABRT Q
"RTN","LEX2087",96,0)
 I $D(LEXE)&(+LEXG<0) D ABRT Q
"RTN","LEX2087",97,0)
 I '$D(LEXFULL)&(+($G(XPDENV))'=1) D QUIT Q
"RTN","LEX2087",98,0)
 N LEXD,LEXI,LEXC,LEXA S LEXA(0)=0
"RTN","LEX2087",99,0)
 S LEXD=0 F  S LEXD=$O(^LEX(757.02,1,4,"B",LEXD)) Q:+LEXD'>0  D
"RTN","LEX2087",100,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^LEX(757.02,1,4,"B",LEXD,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2087",101,0)
 . . Q:LEXI'=1  N LEXC S LEXC=$O(LEXA(" "),-1)+1,LEXA(LEXC)=LEXD,LEXA(0)=LEXC
"RTN","LEX2087",102,0)
 S LEXD=$P($G(^LEX(757.02,1,4,2,0)),"^",1) I LEXD<3141001 D DR,ABRT  Q
"RTN","LEX2087",103,0)
 I $G(LEXA(0))>1 D DF,ABRT  Q
"RTN","LEX2087",104,0)
 ;                    
"RTN","LEX2087",105,0)
 ;   Install Package(s)                       XPDENV = 1
"RTN","LEX2087",106,0)
 ;       Checking Global "Write" Protection 
"RTN","LEX2087",107,0)
 D:+($G(XPDENV))=1 GBLS I $D(LEXE) D ABRT Q
"RTN","LEX2087",108,0)
 ;       Check Import Global Checksum 
"RTN","LEX2087",109,0)
 D:+($G(XPDENV))=1 CS I $D(LEXE) D ABRT Q
"RTN","LEX2087",110,0)
 ;                    
"RTN","LEX2087",111,0)
 ;   Quit, Exit or Abort
"RTN","LEX2087",112,0)
QUIT ;     Quit   Passed Environment Check
"RTN","LEX2087",113,0)
 K LEXFULL D OK
"RTN","LEX2087",114,0)
 Q
"RTN","LEX2087",115,0)
EXIT ;     Exit   Failed Environment Check
"RTN","LEX2087",116,0)
 D:$D(LEXE) ED S XPDQUIT=2 K LEXE,LEXFULL Q
"RTN","LEX2087",117,0)
ABRT ;     Abort  Failed Environment Check, KILL the distribution
"RTN","LEX2087",118,0)
 D:$D(LEXE) ED S XPDABORT=1,XPDQUIT=1 S:$L($G(LEXBUILD)) XPDQUIT(LEXBUILD)=1
"RTN","LEX2087",119,0)
 K LEXE,LEXFULL
"RTN","LEX2087",120,0)
 Q
"RTN","LEX2087",121,0)
 ;
"RTN","LEX2087",122,0)
 ; Testing Entry Points
"RTN","LEX2087",123,0)
T1 ;   Environment Check #1 - Test Load
"RTN","LEX2087",124,0)
 K XPDENV D ENV
"RTN","LEX2087",125,0)
 Q
"RTN","LEX2087",126,0)
T2 ;   Environment Check #2 - Test Install Package(s)
"RTN","LEX2087",127,0)
 N XPDENV S XPDENV=1 D ENV
"RTN","LEX2087",128,0)
 Q
"RTN","LEX2087",129,0)
 ;               
"RTN","LEX2087",130,0)
 ; Checks
"RTN","LEX2087",131,0)
GBLS ;   Check Write access on globals
"RTN","LEX2087",132,0)
 N LEXB1,LEXB2,LEXE,LEXGBL,LEXRT,LEXT,LEXF,LEXI,LEXX,LEXOK,LEXS,X S LEXOK=1
"RTN","LEX2087",133,0)
 D BM("   I will now check the protection on ^LEX, ^ICPT, ^ICD and ^DIC Globals.")
"RTN","LEX2087",134,0)
 D M("   If you get an ERROR, you will need to change the protection on these")
"RTN","LEX2087",135,0)
 D M("   globals to allow read/write as indicated:")
"RTN","LEX2087",136,0)
 D BM("                        Owner     Group    World   Network")
"RTN","LEX2087",137,0)
 D M("      Cache systems      RWD       RW       RW      RWD")
"RTN","LEX2087",138,0)
 D BM("   Checking:"),M(" ")
"RTN","LEX2087",139,0)
 S LEXS="",X=1 F LEXI=1:1 D  Q:'$L(LEXX)
"RTN","LEX2087",140,0)
 . S LEXX="" S LEXE="S LEXX=$T(GD+"_LEXI_")" X LEXE S LEXX=$$TRIM(LEXX) Q:'$L(LEXX)  Q:'$L($TR(LEXX,";",""))
"RTN","LEX2087",141,0)
 . S LEXGBL=$P(LEXX,";",3),LEXRT=$P(LEXX,";",4),LEXT=$P(LEXX,";",5),LEXF=$P(LEXX,";",6)
"RTN","LEX2087",142,0)
 . S (LEXB1,LEXB2)="",$P(LEXB1," ",(19-$L(LEXRT)))="",$P(LEXB2," ",(28-$L(LEXT)))=""
"RTN","LEX2087",143,0)
 . I '$D(@LEXGBL) D RGNF S LEXOK=0 D M(("      <"_LEXRT_" not found>")) Q
"RTN","LEX2087",144,0)
 . D M(("      "_LEXRT_LEXB1_LEXT_LEXB2_LEXF)) S @LEXGBL=$G(@LEXGBL) H 1
"RTN","LEX2087",145,0)
 D:LEXOK M("    --> ok") D:'LEXOK M("    ??") D M(" ")
"RTN","LEX2087",146,0)
 Q
"RTN","LEX2087",147,0)
RGBL(X) ;   Check Write access on globals
"RTN","LEX2087",148,0)
 N LEXS,LEXI,LEXX,LEXEC,LEXGBL,LEXRT,LEXT,LEXF,LEXB1,LEXB2
"RTN","LEX2087",149,0)
 S LEXS="",X=1 F LEXI=1:1 D  Q:'$L(LEXX)
"RTN","LEX2087",150,0)
 . S LEXX="" S LEXEC="S LEXX=$T(GD+"_LEXI_")" X LEXEC S LEXX=$$TRIM(LEXX) Q:'$L(LEXX)  Q:'$L($TR(LEXX,";",""))
"RTN","LEX2087",151,0)
 . S LEXGBL=$P(LEXX,";",3),LEXRT=$P(LEXX,";",4),LEXT=$P(LEXX,";",5),LEXF=$P(LEXX,";",6)
"RTN","LEX2087",152,0)
 . S (LEXB1,LEXB2)="",$P(LEXB1," ",(15-$L(LEXRT)))="",$P(LEXB2," ",(28-$L(LEXT)))=""
"RTN","LEX2087",153,0)
 . I '$D(@LEXGBL) S:LEXS'[LEXRT LEXS=LEXS_", "_LEXRT S X=-1 S:LEXGBL["LEXM("&(X=1) X=0
"RTN","LEX2087",154,0)
 I $L(LEXS),X'>0 D
"RTN","LEX2087",155,0)
 . S:LEXS[", " LEXS=$P(LEXS,", ",1,($L(LEXS,", ")-1))_" and "_$P(LEXS,", ",$L(LEXS,", "))
"RTN","LEX2087",156,0)
 . S:$E(LEXS,1,2)=", " LEXS=$E(LEXS,3,$L(LEXS)) S:$E(LEXS,1,7)[" and " LEXS=$P(LEXS," and ",2)
"RTN","LEX2087",157,0)
 . D:X=-1 ET(("Global"_$S(LEXS[", "!(LEXS[" and "):"s",1:"")_" "_LEXS_" either not found or incomplete."))
"RTN","LEX2087",158,0)
 . D:X=0 CM
"RTN","LEX2087",159,0)
 Q X
"RTN","LEX2087",160,0)
RGNF ;   Required global not found
"RTN","LEX2087",161,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP
"RTN","LEX2087",162,0)
 D:$G(LEXGBL)["^LEX"&($G(LEXGBL)'["^LEXM") ET(""),ET("Required global "_$P($G(LEXGBL),"(",1)_" not found.")
"RTN","LEX2087",163,0)
 D:$G(LEXGBL)["^LEX"&($G(LEXGBL)["^LEXM") CM
"RTN","LEX2087",164,0)
 Q
"RTN","LEX2087",165,0)
INS(X) ;   Installed
"RTN","LEX2087",166,0)
 N LEX,LEXP,LEXV,LEXI,LEXS S LEX=$P($G(X)," ",1) I $L(LEX,"*")=3 S X=$$PATCH^XPDUTL(LEX) Q X
"RTN","LEX2087",167,0)
 S LEXP=$$PKG^XPDUTL(LEX),LEXV=$$VER^XPDUTL(LEX),LEXI=$$VERSION^XPDUTL(LEXP)
"RTN","LEX2087",168,0)
 Q:+LEXV>0&(LEXV=LEXI) 1
"RTN","LEX2087",169,0)
 Q 0
"RTN","LEX2087",170,0)
INSD(X)  ;   Installed on
"RTN","LEX2087",171,0)
 N DA,LEX,LEXDA,LEXE,LEXI,LEXMSG,LEXNS,LEXOUT,LEXPI,LEXPN,LEXSCR,LEXVI,LEXVD,LEXVI,LEXVR S LEX=$G(X)
"RTN","LEX2087",172,0)
 S LEXNS=$$PKG^XPDUTL(LEX),LEXVR=$$VER^XPDUTL(LEX),LEXPN=$P(X,"*",3)
"RTN","LEX2087",173,0)
 Q:'$L(LEXNS) ""  S LEXVR=+LEXVR Q:LEXVR'>0 ""  S LEXPN=+LEXPN S:LEXVR'["." LEXVR=LEXVR_".0"
"RTN","LEX2087",174,0)
 S LEXSCR="I $G(^DIC(9.4,+($G(Y)),""VERSION""))="""_LEXVR_""""
"RTN","LEX2087",175,0)
 D FIND^DIC(9.4,,.01,"O",LEXNS,10,"C",LEXSCR,,"LEXOUT","LEXMSG")
"RTN","LEX2087",176,0)
 S LEXPI=$G(LEXOUT("DILIST",2,1)) K LEXOUT,LEXMSG Q:+LEXPI'>0 ""  Q:'$D(@("^DIC(9.4,"_LEXPI_",22)")) ""
"RTN","LEX2087",177,0)
 K DA S DA(1)=LEXPI S LEXDA=$$IENS^DILF(.DA)
"RTN","LEX2087",178,0)
 D FIND^DIC(9.49,LEXDA,".01;1I;2I","O",LEXVR,10,"B",,,"LEXOUT","LEXMSG")
"RTN","LEX2087",179,0)
 S LEXVD=$G(LEXOUT("DILIST","ID",1,2)) I $E(LEXVD,1,7)?7N&(+LEXPN'>0) D  Q X
"RTN","LEX2087",180,0)
 . S X=$E(LEXVD,1,7)_"^"_$TR($$FMTE^XLFDT($E(LEXVD,1,7),"5DZ"),"@"," ")
"RTN","LEX2087",181,0)
 S:$E(LEXVD,1,7)'?7N LEXVD=$G(LEXOUT("DILIST","ID",1,1)) I $E(LEXVD,1,7)?7N&(+LEXPN'>0) D  Q X
"RTN","LEX2087",182,0)
 . S X=$E(LEXVD,1,7)_"^"_$TR($$FMTE^XLFDT($E(LEXVD,1,7),"5DZ"),"@"," ")
"RTN","LEX2087",183,0)
 Q:+LEXPN'>0 ""  S LEXVI=$G(LEXOUT("DILIST",2,1)) K LEXOUT,LEXMSG
"RTN","LEX2087",184,0)
 Q:+LEXVI'>0 ""  Q:'$D(@("^DIC(9.4,"_LEXPI_",22,"_LEXVI_",""PAH"")")) ""
"RTN","LEX2087",185,0)
 K DA S DA(2)=LEXPI,DA(1)=LEXVI S LEXDA=$$IENS^DILF(.DA)
"RTN","LEX2087",186,0)
 S LEXSCR="I $G(^DIC(9.4,"_LEXPI_",22,"_LEXVI_",""PAH"",+($G(Y)),0))[""SEQ #"""
"RTN","LEX2087",187,0)
 D FIND^DIC(9.4901,LEXDA,".01;.02I",,LEXPN,10,"B",LEXSCR,,"LEXOUT","LEXMSG")
"RTN","LEX2087",188,0)
 S LEXI=$G(LEXOUT("DILIST","ID",1,.02)) I '$L(LEXI) D
"RTN","LEX2087",189,0)
 . S LEXSCR="" D FIND^DIC(9.4901,LEXDA,".01;.02I",,LEXPN,10,"B",LEXSCR,,"LEXOUT","LEXMSG")
"RTN","LEX2087",190,0)
 . S LEXI=$G(LEXOUT("DILIST","ID",1,.02))
"RTN","LEX2087",191,0)
 Q:'$L(LEXI) ""  Q:$P(LEXI,".",1)'?7N ""  S LEXE=$TR($$FMTE^XLFDT(LEXI,"5DZ"),"@"," ")
"RTN","LEX2087",192,0)
 Q:'$L(LEXE) ""  S X=LEXI_"^"_LEXE
"RTN","LEX2087",193,0)
 Q X
"RTN","LEX2087",194,0)
CHK ;   Check the Checksum
"RTN","LEX2087",195,0)
 D CS I $D(LEXE) D ED Q
"RTN","LEX2087",196,0)
 D BM("  OK"),M(" ")
"RTN","LEX2087",197,0)
 Q
"RTN","LEX2087",198,0)
CS ;   Checksum for import global
"RTN","LEX2087",199,0)
 K LEXE D BM("   Running checksum routine on the ^LEXM import global, please wait")
"RTN","LEX2087",200,0)
 N LEXCK,LEXND,LEXV S LEXCK=+($G(^LEXM(0,"CHECKSUM")))
"RTN","LEX2087",201,0)
 S LEXND=+($G(^LEXM(0,"NODES"))),LEXV=+($$VC(LEXCK,LEXND))
"RTN","LEX2087",202,0)
 D M(" ") D:LEXV>0 M("     Checksum is ok"),M(" ")
"RTN","LEX2087",203,0)
 D:LEXV=0 CM D:LEXV=-1 CW D:LEXV=-2 CU D:LEXV=-3 CF
"RTN","LEX2087",204,0)
 Q
"RTN","LEX2087",205,0)
VC(X,Y) ;   Verify Checksum for import global
"RTN","LEX2087",206,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR Q:'$D(^LEXM) 0
"RTN","LEX2087",207,0)
 D IMP I $G(^LEXM(0,"BUILD"))'=$G(LEXBUILD) Q -1
"RTN","LEX2087",208,0)
 N LEXCK,LEXND,LEXCNT,LEXLC,LEXL,LEXS,LEXNC,LEXD,LEXN,LEXC,LEXGCS,LEXP,LEXT
"RTN","LEX2087",209,0)
 S LEXCK=+($G(X)),LEXND=+($G(Y))
"RTN","LEX2087",210,0)
 Q:LEXCK'>0!(LEXND'>0) -2
"RTN","LEX2087",211,0)
 S LEXL=64,(LEXCNT,LEXLC)=0,LEXS=(+(LEXND\LEXL))
"RTN","LEX2087",212,0)
 S:LEXS=0 LEXS=1 D:+($O(^LEXM(0)))>0 M("")
"RTN","LEX2087",213,0)
 S (LEXC,LEXN)="^LEXM",(LEXNC,LEXGCS)=0 W "   "
"RTN","LEX2087",214,0)
 F  S LEXN=$Q(@LEXN) Q:LEXN=""!(LEXN'[LEXC)  D
"RTN","LEX2087",215,0)
 . Q:LEXN="^LEXM(0,""CHECKSUM"")"
"RTN","LEX2087",216,0)
 . Q:LEXN="^LEXM(0,""NODES"")"
"RTN","LEX2087",217,0)
 . S LEXCNT=LEXCNT+1
"RTN","LEX2087",218,0)
 . I LEXCNT'<LEXS S LEXLC=LEXLC+1 W:LEXLC'>LEXL "." S LEXCNT=0
"RTN","LEX2087",219,0)
 . S LEXNC=LEXNC+1,LEXD=@LEXN,LEXT=LEXN_"="_LEXD
"RTN","LEX2087",220,0)
 . F LEXP=1:1:$L(LEXT) S LEXGCS=$A(LEXT,LEXP)*LEXP+LEXGCS
"RTN","LEX2087",221,0)
 Q:LEXNC'=LEXND -3
"RTN","LEX2087",222,0)
 Q:LEXGCS'=LEXCK -3
"RTN","LEX2087",223,0)
 Q 1
"RTN","LEX2087",224,0)
SY(X) ;   Check System variables
"RTN","LEX2087",225,0)
 Q:'$D(IO)!('$D(IOF))!('$D(IOM))!('$D(ION))!('$D(IOSL))!('$D(IOST)) 0
"RTN","LEX2087",226,0)
 Q 1
"RTN","LEX2087",227,0)
UR(X) ;   Check User variables
"RTN","LEX2087",228,0)
 Q:'$L($G(DUZ(0))) 0
"RTN","LEX2087",229,0)
 Q:+($G(DUZ))=0!($$NOTDEF(+$G(DUZ))) 0
"RTN","LEX2087",230,0)
 Q 1
"RTN","LEX2087",231,0)
 ;               
"RTN","LEX2087",232,0)
 ; Error messages
"RTN","LEX2087",233,0)
CM ;   Missing ^LEXM
"RTN","LEX2087",234,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP D ET(""),ET("Missing import global ^LEXM.") D CO
"RTN","LEX2087",235,0)
 Q
"RTN","LEX2087",236,0)
CW ;   Wrong ^LEXM
"RTN","LEX2087",237,0)
 N LEXB,LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP S LEXB=$G(^LEXM(0,"BUILD")) D ET("")
"RTN","LEX2087",238,0)
 I $L(LEXBUILD),$L(LEXB),LEXBUILD'=LEXB D  Q
"RTN","LEX2087",239,0)
 . D ET(("Incorrect import global ^LEXM found ("_LEXB_" global).")) D CKO
"RTN","LEX2087",240,0)
 D ET("Incorrect import global ^LEXM found.") D CKO
"RTN","LEX2087",241,0)
 Q
"RTN","LEX2087",242,0)
CU ;   Unable to verify
"RTN","LEX2087",243,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP D ET(""),ET("Unable to verify checksum for import global ^LEXM (possibly corrupt).") D CKO
"RTN","LEX2087",244,0)
 Q
"RTN","LEX2087",245,0)
CF ;   Failed checksum
"RTN","LEX2087",246,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP D ET("") D ET("Import global ^LEXM failed checksum.") D CKO
"RTN","LEX2087",247,0)
 Q
"RTN","LEX2087",248,0)
CO ;   Obtain new global
"RTN","LEX2087",249,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP
"RTN","LEX2087",250,0)
 D ET(""),ET("    Please obtain a copy of the import global ^LEXM contained in the ")
"RTN","LEX2087",251,0)
 D ET(("    global host file "_LEXIGHF_" before continuing with the "_LEXBUILD))
"RTN","LEX2087",252,0)
 D ET(("    installation."))
"RTN","LEX2087",253,0)
 Q
"RTN","LEX2087",254,0)
CKO ;   Kill and Obtain new global
"RTN","LEX2087",255,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP D ET("")
"RTN","LEX2087",256,0)
 D ET(("    Use the entry point KALL^LEXXGI2 to safely KILL the existing "))
"RTN","LEX2087",257,0)
 D ET(("    import global ^LEXM from your system.  Then obtain a new copy"))
"RTN","LEX2087",258,0)
 D ET(("    of ^LEXM contained in the global host file "_LEXIGHF_" before"))
"RTN","LEX2087",259,0)
 D ET(("    continuing with the "_LEXBUILD_" installation."))
"RTN","LEX2087",260,0)
 Q
"RTN","LEX2087",261,0)
DR ;   Date Utility Ran
"RTN","LEX2087",262,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP D ET("")
"RTN","LEX2087",263,0)
 D ET(("    A Date Utility was ran in this account.  Toggle the date back to"))
"RTN","LEX2087",264,0)
 D ET(("    the original date.  Then run the index repair utility ONE^LEXRX"))
"RTN","LEX2087",265,0)
 D ET(("    and when prompted for a file, enter 757.02.  Then re-load and "))
"RTN","LEX2087",266,0)
 D ET(("    install LEX*2.0*87."))
"RTN","LEX2087",267,0)
 Q
"RTN","LEX2087",268,0)
DF ;   Date Utility Failed
"RTN","LEX2087",269,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR D IMP D ET("")
"RTN","LEX2087",270,0)
 D ET(("    A Date Utility failed to toggle the date back correctly."))
"RTN","LEX2087",271,0)
 D ET(("    Run the index repair utility ONE^LEXRX and when prompted for"))
"RTN","LEX2087",272,0)
 D ET(("    a file, enter 757.02.  Then re-load and install LEX*2.0*87."))
"RTN","LEX2087",273,0)
 Q
"RTN","LEX2087",274,0)
ET(X) ;   Error Text
"RTN","LEX2087",275,0)
 N LEXI S LEXI=+($G(LEXE(0))),LEXI=LEXI+1,LEXE(LEXI)="    "_$G(X),LEXE(0)=LEXI
"RTN","LEX2087",276,0)
 Q
"RTN","LEX2087",277,0)
ED ;   Error Display
"RTN","LEX2087",278,0)
 N LEXI S LEXI=0 F  S LEXI=$O(LEXE(LEXI)) Q:+LEXI=0  D M(LEXE(LEXI))
"RTN","LEX2087",279,0)
 D M(" ") K LEXE Q
"RTN","LEX2087",280,0)
 ;                   
"RTN","LEX2087",281,0)
 ; Miscellaneous
"RTN","LEX2087",282,0)
NOTDEF(IEN) ;   Check to see if user is defined
"RTN","LEX2087",283,0)
 N DA,DR,DIQ,LEX,DIC S DA=IEN,DR=.01,DIC=200,DIQ="LEX" D EN^DIQ1 Q '$D(LEX)
"RTN","LEX2087",284,0)
OK ;   Environment is OK
"RTN","LEX2087",285,0)
 N LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR,LEXT
"RTN","LEX2087",286,0)
 D IMP S LEXT="  Environment "_$S($L(LEXBUILD):("for patch/build "_LEXBUILD_" "),1:"")_"is ok"
"RTN","LEX2087",287,0)
 D BM(LEXT),M(" ")
"RTN","LEX2087",288,0)
 Q
"RTN","LEX2087",289,0)
BM(X) ;   Blank Line with Message
"RTN","LEX2087",290,0)
 S X=$G(X) S:$E(X,1)'=" " X=" "_X D BMES^XPDUTL(X) Q
"RTN","LEX2087",291,0)
M(X) ;   Message
"RTN","LEX2087",292,0)
 S X=$G(X) S:$E(X,1)'=" " X=" "_X D MES^XPDUTL(X) Q
"RTN","LEX2087",293,0)
TRIM(X) ;   Trim Spaces
"RTN","LEX2087",294,0)
 S X=$G(X) F  Q:$E(X,1)'=" "  S X=$E(X,2,$L(X))
"RTN","LEX2087",295,0)
 F  Q:$E(X,$L(X))'=" "  S X=$E(X,1,($L(X)-1))
"RTN","LEX2087",296,0)
 Q X
"RTN","LEX2087",297,0)
IMP ;   Import names
"RTN","LEX2087",298,0)
 S LEXPTYPE="Code Set Update"
"RTN","LEX2087",299,0)
 S LEXPTYPE="ICD-10 Data Update/Date Change"
"RTN","LEX2087",300,0)
 ;     Revision
"RTN","LEX2087",301,0)
 S LEXLREV=87
"RTN","LEX2087",302,0)
 ;     Required Builds Array
"RTN","LEX2087",303,0)
 ;        LEX(1)=build SEQ #^released date^subject
"RTN","LEX2087",304,0)
 ;        LEX(n)=build SEQ #^released date^subject
"RTN","LEX2087",305,0)
 S LEXREQP(1)="LEX*2.0*95 SEQ #84^^Code Set FY14 3rd Qtr"
"RTN","LEX2087",306,0)
 S LEXREQP(2)="ICD*18.0*57^^ICD-10 Implementation"
"RTN","LEX2087",307,0)
 S LEXREQP(3)="LEX*2.0*80^^ICD-10 Implementation"
"RTN","LEX2087",308,0)
 S LEXREQP(4)="ICD*18.0*64^^ICD-10 DRG Grouper"
"RTN","LEX2087",309,0)
 ;     This Build Name
"RTN","LEX2087",310,0)
 S LEXBUILD="LEX*2.0*87"
"RTN","LEX2087",311,0)
 ;     This Build's Export Global Host Filename
"RTN","LEX2087",312,0)
 S LEXIGHF="LEX_2_87.GBL"
"RTN","LEX2087",313,0)
 ;     Fiscal Year
"RTN","LEX2087",314,0)
 S LEXFY=""
"RTN","LEX2087",315,0)
 ;     Quarter
"RTN","LEX2087",316,0)
 S LEXQTR=""
"RTN","LEX2087",317,0)
 Q
"RTN","LEX2087",318,0)
EF ;   Exported Files
"RTN","LEX2087",319,0)
 ;;^LEX(757.01);^LEX(*;Lexicon;757-757.41
"RTN","LEX2087",320,0)
 ;;^LEXT(757.2);^LEXT(757.2);Lexicon Subsets/Defaults;757.2
"RTN","LEX2087",321,0)
 ;;
"RTN","LEX2087",322,0)
 ;;^ICPT(0);^ICPT(;CPT/HCPCS;81
"RTN","LEX2087",323,0)
 ;;^DIC(81.1,0);^DIC(81.1);CPT Category;81.1
"RTN","LEX2087",324,0)
 ;;^DIC(81.2,0);^DIC(81.2);CPT Copyright;81.2
"RTN","LEX2087",325,0)
 ;;^DIC(81.3,0);^DIC(81.3);CPT Modifier;81.3
"RTN","LEX2087",326,0)
 ;;
"RTN","LEX2087",327,0)
 ;;^ICD9(0);^ICD9(;ICD Diagnosis;80
"RTN","LEX2087",328,0)
 ;;^ICD0(0);^ICD0(;ICD Operation/Procedure;80.1
"RTN","LEX2087",329,0)
 ;;^ICDS(0);^ICDS(;ICD Coding System;80.4
"RTN","LEX2087",330,0)
 ;;^ICD(0);^ICD(;DRG Grouper;80.2
"RTN","LEX2087",331,0)
 ;;^ICM(0);^ICM(;MAJOR DIAGNOSTIC CATEGORY;80.3
"RTN","LEX2087",332,0)
 Q
"RTN","LEX2087",333,0)
GD ;   Global Data
"RTN","LEX2087",334,0)
 ;;^ICD9(0);^ICD9(;ICD Diagnosis;80
"RTN","LEX2087",335,0)
 ;;^ICD0(0);^ICD0(;ICD Operation/Procedure;80.1
"RTN","LEX2087",336,0)
 ;;^ICDS(0);^ICDS(;ICD Coding System;80.4
"RTN","LEX2087",337,0)
 ;;^LEX(757.01);^LEX(*;Lexicon;757-757.41
"RTN","LEX2087A")
0^3^B124616164^n/a
"RTN","LEX2087A",1,0)
LEX2087A ;ISL/KER - LEX*2.0*87 Pre/Post Install Check ;06/14/2014
"RTN","LEX2087A",2,0)
 ;;2.0;LEXICON UTILITY;**87**;Sep 23, 1996;Build 1
"RTN","LEX2087A",3,0)
 ;               
"RTN","LEX2087A",4,0)
 ; Global Variables 
"RTN","LEX2087A",5,0)
 ;    ^LEX(              N/A
"RTN","LEX2087A",6,0)
 ;    ^ICD9(             ICR  4485
"RTN","LEX2087A",7,0)
 ;    ^ICD0(             ICR  4486
"RTN","LEX2087A",8,0)
 ;    ^ICDS(             ICR  5755
"RTN","LEX2087A",9,0)
 ;               
"RTN","LEX2087A",10,0)
 ; External References
"RTN","LEX2087A",11,0)
 ;               
"RTN","LEX2087A",12,0)
 Q
"RTN","LEX2087A",13,0)
POST ; Check
"RTN","LEX2087A",14,0)
 Q:$$DT^XLFDT>3140930  K ^TMP("LEX2087A",$J)
"RTN","LEX2087A",15,0)
 N LEXT,LEXCK,LEXOK,LEXBEG,LEXEND,LEXDO,LEXDN,LEXELP,LEXOT,LEXNT S (LEXOT,LEXNT)=0
"RTN","LEX2087A",16,0)
 S LEXDO=3141001,LEXDN=3151001
"RTN","LEX2087A",17,0)
 S LEXBEG=$$NOW^XLFDT D BMES^XPDUTL(" Running Post-Install Environment Check:   2-5 minutes")
"RTN","LEX2087A",18,0)
 S LEXT=$J(" ",43)_"ICD Effective Dates" D T2("   "),T2(LEXT)
"RTN","LEX2087A",19,0)
 S LEXT="   File Name/Number" S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J("10/01/2014",10)
"RTN","LEX2087A",20,0)
 S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J("10/01/2015",10) D T2(LEXT)
"RTN","LEX2087A",21,0)
 S LEXT="   ---------------------------------    ----------     ----------" D T2(LEXT)
"RTN","LEX2087A",22,0)
 S LEXCK=1,LEXOK=$G(LEXOK)+($$F75702)
"RTN","LEX2087A",23,0)
 S LEXCK=2,LEXOK=$G(LEXOK)+($$F75703)
"RTN","LEX2087A",24,0)
 S LEXCK=3,LEXOK=$G(LEXOK)+($$F757033)
"RTN","LEX2087A",25,0)
 S LEXCK=4,LEXOK=$G(LEXOK)+($$F80)
"RTN","LEX2087A",26,0)
 S LEXCK=5,LEXOK=$G(LEXOK)+($$F801)
"RTN","LEX2087A",27,0)
 S LEXCK=6,LEXOK=$G(LEXOK)+($$F802)
"RTN","LEX2087A",28,0)
 S LEXCK=7,LEXOK=$G(LEXOK)+($$F804)
"RTN","LEX2087A",29,0)
 S LEXCK=8,LEXOK=$G(LEXOK)+($$F805)
"RTN","LEX2087A",30,0)
 I (LEXOT+LEXNT)>0 D
"RTN","LEX2087A",31,0)
 . S LEXT="   Totals"
"RTN","LEX2087A",32,0)
 . S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J($FN(LEXOT,","),10)
"RTN","LEX2087A",33,0)
 . S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J($FN(LEXNT,","),10)
"RTN","LEX2087A",34,0)
 . D T2(LEXT)
"RTN","LEX2087A",35,0)
 D:+($G(LEXCK))=+($G(LEXOK)) EOK D:+($G(LEXCK))'=+($G(LEXOK)) ENOK
"RTN","LEX2087A",36,0)
 S LEXEND=$$NOW^XLFDT
"RTN","LEX2087A",37,0)
 S LEXELP=$$FMDIFF^XLFDT(LEXEND,LEXBEG,3)
"RTN","LEX2087A",38,0)
 S:LEXELP[" "&($L(LEXELP," ")=2) LEXELP=$TR(LEXELP," ","0")
"RTN","LEX2087A",39,0)
 S LEXT="   Start:   "_$TR($$FMTE^XLFDT(LEXBEG,"5Z"),"@"," ") W:$D(TEST) !!,LEXT
"RTN","LEX2087A",40,0)
 S LEXT="   Finish:  "_$TR($$FMTE^XLFDT(LEXEND,"5Z"),"@"," ") W:$D(TEST) !,LEXT
"RTN","LEX2087A",41,0)
 S LEXT="   Elapsed: "_LEXELP W:$D(TEST) !,LEXT
"RTN","LEX2087A",42,0)
 S LEXT=" Post-Install Environment Check Complete:  "_$$FMTE^XLFDT(LEXEND)
"RTN","LEX2087A",43,0)
 D MES^XPDUTL(" "),MES^XPDUTL(LEXT),MES^XPDUTL(" ") D BM D:$O(^TMP("LEX2087A",$J,"MSG",0))>0 MAIL
"RTN","LEX2087A",44,0)
 Q
"RTN","LEX2087A",45,0)
F75702(X) ;
"RTN","LEX2087A",46,0)
 N LEXCD,LEXDN,LEXDO,LEXDTS,LEXEFF,LEXF,LEXHIEN,LEXIX,LEXN,LEXN0,LEXND
"RTN","LEX2087A",47,0)
 N LEXO,LEXOD,LEXR,LEXSAB,LEXSIEN,LEXSR,LEXSTA,LEXT
"RTN","LEX2087A",48,0)
 S LEXDO=3141001,LEXDN=3151001
"RTN","LEX2087A",49,0)
 F LEXSAB="ICD","ICP","10D","10P" D
"RTN","LEX2087A",50,0)
 . N LEXSIEN S LEXSIEN=0 F  S LEXSIEN=$O(^LEX(757.02,"ASRC",LEXSAB,LEXSIEN)) Q:+LEXSIEN'>0  D
"RTN","LEX2087A",51,0)
 . . N LEXHIEN,LEXEFF,LEXND,LEXN0,LEXCD,LEXIX,LEXSR,LEXSTA
"RTN","LEX2087A",52,0)
 . . S LEXN0=$G(^LEX(757.02,+LEXSIEN,0)),LEXCD=$P(LEXN0,"^",2),LEXSR=$P(LEXN0,"^",3)
"RTN","LEX2087A",53,0)
 . . S LEXHIEN=0 F  S LEXHIEN=$O(^LEX(757.02,LEXSIEN,4,LEXHIEN)) Q:+LEXHIEN'>0  D
"RTN","LEX2087A",54,0)
 . . . S LEXND=$G(^LEX(757.02,LEXSIEN,4,LEXHIEN,0)),LEXEFF=$P(LEXND,"^",1)
"RTN","LEX2087A",55,0)
 . . . S:LEXEFF=LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",56,0)
 . . . S:LEXEFF=LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",57,0)
 . . S LEXEFF="" F  S LEXEFF=$O(^LEX(757.02,LEXSIEN,4,"B",LEXEFF)) Q:'$L(LEXEFF)  D
"RTN","LEX2087A",58,0)
 . . . S:LEXEFF=LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",59,0)
 . . . S:LEXEFF=LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",60,0)
 . . ; ACT
"RTN","LEX2087A",61,0)
 . . S LEXSTA=0 F  S LEXSTA=$O(^LEX(757.02,"ACT",(LEXCD_" "),LEXSTA)) Q:+LEXSTA'>0  D
"RTN","LEX2087A",62,0)
 . . . N LEXEFF S LEXEFF="" F  S LEXEFF=$O(^LEX(757.02,"ACT",(LEXCD_" "),LEXSTA,LEXEFF)) Q:'$L(LEXEFF)  D
"RTN","LEX2087A",63,0)
 . . . . S:LEXEFF=LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",64,0)
 . . . . S:LEXEFF=LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",65,0)
 . . F LEXIX="ADX","APR" D
"RTN","LEX2087A",66,0)
 . . . N LEXEFF S LEXEFF="" F  S LEXEFF=$O(^LEX(757.02,LEXIX,(LEXCD_" "),LEXEFF)) Q:'$L(LEXEFF)  D
"RTN","LEX2087A",67,0)
 . . . . S:LEXEFF=LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",68,0)
 . . . . S:LEXEFF=LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",69,0)
 . S LEXEFF="" F  S LEXEFF=$O(^LEX(757.02,"AUPD",LEXSAB,LEXEFF)) Q:'$L(LEXEFF)  D
"RTN","LEX2087A",70,0)
 . . S:LEXEFF=LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",71,0)
 . . S:LEXEFF=LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",72,0)
 S LEXO=+($G(LEXDTS(LEXDO))),LEXOD=$$FMTE^XLFDT(LEXDO,"5Z")
"RTN","LEX2087A",73,0)
 S LEXN=+($G(LEXDTS(LEXDN))),LEXND=$$FMTE^XLFDT(LEXDN,"5Z")
"RTN","LEX2087A",74,0)
 S LEXT="CODE",LEXF=757.02,LEXR="^LEX(757.02,"
"RTN","LEX2087A",75,0)
 S LEXT="   "_LEXT_" file #"_LEXF
"RTN","LEX2087A",76,0)
 S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J($FN(LEXO,","),10)
"RTN","LEX2087A",77,0)
 S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J($FN(LEXN,","),10)
"RTN","LEX2087A",78,0)
 D T2(LEXT)
"RTN","LEX2087A",79,0)
 S LEXOT=+($G(LEXOT))+($G(LEXO)),LEXNT=+($G(LEXNT))+($G(LEXN))
"RTN","LEX2087A",80,0)
 S X=0 S:+($G(LEXO))'>0&(+($G(LEXN))>0) X=1
"RTN","LEX2087A",81,0)
 Q X
"RTN","LEX2087A",82,0)
F75703(X) ;
"RTN","LEX2087A",83,0)
 N LEXDN,LEXDO,LEXDTS,LEXEFF,LEXF,LEXN,LEXND,LEXO,LEXOD,LEXR,LEXT
"RTN","LEX2087A",84,0)
 S LEXDO=3141001,LEXDN=3151001
"RTN","LEX2087A",85,0)
 S LEXEFF=$P($G(^LEX(757.03,30,2)),"^",1)
"RTN","LEX2087A",86,0)
 S:LEXEFF=LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",87,0)
 S:LEXEFF=LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",88,0)
 S LEXEFF=$P($G(^LEX(757.03,31,2)),"^",1)
"RTN","LEX2087A",89,0)
 S:LEXEFF=LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",90,0)
 S:LEXEFF=LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",91,0)
 S LEXO=+($G(LEXDTS(LEXDO))),LEXOD=$$FMTE^XLFDT(LEXDO,"5Z")
"RTN","LEX2087A",92,0)
 S LEXN=+($G(LEXDTS(LEXDN))),LEXND=$$FMTE^XLFDT(LEXDN,"5Z")
"RTN","LEX2087A",93,0)
 S LEXT="CODING SYSTEMS",LEXF=757.03,LEXR="^LEX(757.03,"
"RTN","LEX2087A",94,0)
 S LEXT="   "_LEXT_" file #"_LEXF
"RTN","LEX2087A",95,0)
 S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J($FN(LEXO,","),10)
"RTN","LEX2087A",96,0)
 S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J($FN(LEXN,","),10)
"RTN","LEX2087A",97,0)
 D T2(LEXT)
"RTN","LEX2087A",98,0)
 S LEXOT=+($G(LEXOT))+($G(LEXO)),LEXNT=+($G(LEXNT))+($G(LEXN))
"RTN","LEX2087A",99,0)
 S X=0 S:+($G(LEXO))'>0&(+($G(LEXN))>0) X=1
"RTN","LEX2087A",100,0)
 Q X
"RTN","LEX2087A",101,0)
F757033(X) ;
"RTN","LEX2087A",102,0)
 N LEXDN,LEXDO,LEXDTS,LEXF,LEXN,LEXNC,LEXND,LEXNN,LEXO,LEXOD
"RTN","LEX2087A",103,0)
 N LEXR,LEXT S LEXDO=3141001,LEXDN=3151001
"RTN","LEX2087A",104,0)
 S LEXNN="^LEX(757.033)",LEXNC="^LEX(757.033,"
"RTN","LEX2087A",105,0)
 F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2087A",106,0)
 . N LEXND S LEXND=$G(@LEXNN)
"RTN","LEX2087A",107,0)
 . S:LEXND[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",108,0)
 . S:LEXND[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",109,0)
 . S:LEXNN[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",110,0)
 . S:LEXNN[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",111,0)
 S LEXO=+($G(LEXDTS(LEXDO))),LEXOD=$$FMTE^XLFDT(LEXDO,"5Z")
"RTN","LEX2087A",112,0)
 S LEXN=+($G(LEXDTS(LEXDN))),LEXND=$$FMTE^XLFDT(LEXDN,"5Z")
"RTN","LEX2087A",113,0)
 S LEXT="CHARACTER POSITIONS",LEXF=757.033,LEXR="^LEX(757.033,"
"RTN","LEX2087A",114,0)
 S LEXT="   "_LEXT_" file #"_LEXF
"RTN","LEX2087A",115,0)
 S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J($FN(LEXO,","),10)
"RTN","LEX2087A",116,0)
 S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J($FN(LEXN,","),10)
"RTN","LEX2087A",117,0)
 D T2(LEXT)
"RTN","LEX2087A",118,0)
 S LEXOT=+($G(LEXOT))+($G(LEXO)),LEXNT=+($G(LEXNT))+($G(LEXN))
"RTN","LEX2087A",119,0)
 S X=0 S:+($G(LEXO))'>0&(+($G(LEXN))>0) X=1
"RTN","LEX2087A",120,0)
 Q X
"RTN","LEX2087A",121,0)
F80(X) ;
"RTN","LEX2087A",122,0)
 N LEXDN,LEXDO,LEXDTS,LEXF,LEXN,LEXNC,LEXND,LEXNN,LEXO,LEXOD
"RTN","LEX2087A",123,0)
 N LEXR,LEXT S LEXDO=3141001,LEXDN=3151001
"RTN","LEX2087A",124,0)
 S LEXNN="^ICD9",LEXNC="^ICD9("
"RTN","LEX2087A",125,0)
 F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2087A",126,0)
 . N LEXND S LEXND=$G(@LEXNN)
"RTN","LEX2087A",127,0)
 . S:LEXND[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",128,0)
 . S:LEXND[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",129,0)
 . S:LEXNN[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",130,0)
 . S:LEXNN[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",131,0)
 S LEXO=+($G(LEXDTS(LEXDO))),LEXOD=$$FMTE^XLFDT(LEXDO,"5Z")
"RTN","LEX2087A",132,0)
 S LEXN=+($G(LEXDTS(LEXDN))),LEXND=$$FMTE^XLFDT(LEXDN,"5Z")
"RTN","LEX2087A",133,0)
 S LEXT="ICD DIAGNOSIS",LEXF=80,LEXR="^ICD9("
"RTN","LEX2087A",134,0)
 S LEXT="   "_LEXT_" file #"_LEXF
"RTN","LEX2087A",135,0)
 S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J($FN(LEXO,","),10)
"RTN","LEX2087A",136,0)
 S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J($FN(LEXN,","),10)
"RTN","LEX2087A",137,0)
 D T2(LEXT)
"RTN","LEX2087A",138,0)
 S LEXOT=+($G(LEXOT))+($G(LEXO)),LEXNT=+($G(LEXNT))+($G(LEXN))
"RTN","LEX2087A",139,0)
 S X=0 S:+($G(LEXO))'>0&(+($G(LEXN))>0) X=1
"RTN","LEX2087A",140,0)
 Q X
"RTN","LEX2087A",141,0)
F801(X) ;
"RTN","LEX2087A",142,0)
 N LEXDN,LEXDO,LEXDTS,LEXF,LEXN,LEXNC,LEXND,LEXNN,LEXO,LEXOD
"RTN","LEX2087A",143,0)
 N LEXR,LEXT S LEXDO=3141001,LEXDN=3151001
"RTN","LEX2087A",144,0)
 S LEXNN="^ICD0",LEXNC="^ICD0("
"RTN","LEX2087A",145,0)
 F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2087A",146,0)
 . N LEXND S LEXND=$G(@LEXNN)
"RTN","LEX2087A",147,0)
 . S:LEXND[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",148,0)
 . S:LEXND[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",149,0)
 . S:LEXNN[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",150,0)
 . S:LEXNN[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",151,0)
 S LEXO=+($G(LEXDTS(LEXDO))),LEXOD=$$FMTE^XLFDT(LEXDO,"5Z")
"RTN","LEX2087A",152,0)
 S LEXN=+($G(LEXDTS(LEXDN))),LEXND=$$FMTE^XLFDT(LEXDN,"5Z")
"RTN","LEX2087A",153,0)
 S LEXT="ICD OPERATION/PROCEDURE",LEXF=80.1,LEXR="^ICD0("
"RTN","LEX2087A",154,0)
 S LEXT="   "_LEXT_" file #"_LEXF
"RTN","LEX2087A",155,0)
 S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J($FN(LEXO,","),10)
"RTN","LEX2087A",156,0)
 S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J($FN(LEXN,","),10)
"RTN","LEX2087A",157,0)
 D T2(LEXT)
"RTN","LEX2087A",158,0)
 S LEXOT=+($G(LEXOT))+($G(LEXO)),LEXNT=+($G(LEXNT))+($G(LEXN))
"RTN","LEX2087A",159,0)
 S X=0 S:+($G(LEXO))'>0&(+($G(LEXN))>0) X=1
"RTN","LEX2087A",160,0)
 Q X
"RTN","LEX2087A",161,0)
F804(X) ;
"RTN","LEX2087A",162,0)
 N LEXDN,LEXDO,LEXDTS,LEXEFF,LEXF,LEXN,LEXND,LEXO,LEXOD,LEXR,LEXT
"RTN","LEX2087A",163,0)
 S LEXDO=3141001,LEXDN=3151001
"RTN","LEX2087A",164,0)
 S LEXEFF=$P($G(^ICDS(30,0)),"^",4)
"RTN","LEX2087A",165,0)
 S:LEXEFF=LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",166,0)
 S:LEXEFF=LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",167,0)
 S LEXEFF=$P($G(^ICDS(31,0)),"^",4)
"RTN","LEX2087A",168,0)
 S:LEXEFF=LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",169,0)
 S:LEXEFF=LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",170,0)
 S LEXO=+($G(LEXDTS(LEXDO))),LEXOD=$$FMTE^XLFDT(LEXDO,"5Z")
"RTN","LEX2087A",171,0)
 S LEXN=+($G(LEXDTS(LEXDN))),LEXND=$$FMTE^XLFDT(LEXDN,"5Z")
"RTN","LEX2087A",172,0)
 S LEXT="ICD CODING SYSTEMS",LEXF=80.4,LEXR="^ICDS("
"RTN","LEX2087A",173,0)
 S LEXT="   "_LEXT_" file #"_LEXF
"RTN","LEX2087A",174,0)
 S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J($FN(LEXO,","),10)
"RTN","LEX2087A",175,0)
 S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J($FN(LEXN,","),10)
"RTN","LEX2087A",176,0)
 D T2(LEXT)
"RTN","LEX2087A",177,0)
 S LEXOT=+($G(LEXOT))+($G(LEXO)),LEXNT=+($G(LEXNT))+($G(LEXN))
"RTN","LEX2087A",178,0)
 S X=0 S:+($G(LEXO))'>0&(+($G(LEXN))>0) X=1
"RTN","LEX2087A",179,0)
 Q X
"RTN","LEX2087A",180,0)
F802(X) ; ICD global
"RTN","LEX2087A",181,0)
 N LEXDN,LEXDO,LEXDTS,LEXF,LEXN,LEXNC,LEXND,LEXNN,LEXO,LEXOD
"RTN","LEX2087A",182,0)
 N LEXR,LEXT S LEXDO=3141001,LEXDN=3151001
"RTN","LEX2087A",183,0)
 S LEXNN="^ICD",LEXNC="^ICD("
"RTN","LEX2087A",184,0)
 F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2087A",185,0)
 . N LEXND S LEXND=$G(@LEXNN)
"RTN","LEX2087A",186,0)
 . S:LEXND[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",187,0)
 . S:LEXND[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",188,0)
 . S:LEXNN[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",189,0)
 . S:LEXNN[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",190,0)
 S LEXO=+($G(LEXDTS(LEXDO))),LEXOD=$$FMTE^XLFDT(LEXDO,"5Z")
"RTN","LEX2087A",191,0)
 S LEXN=+($G(LEXDTS(LEXDN))),LEXND=$$FMTE^XLFDT(LEXDN,"5Z")
"RTN","LEX2087A",192,0)
 S LEXT="DRG",LEXF=80.2,LEXR="^ICD("
"RTN","LEX2087A",193,0)
 S LEXT="   "_LEXT_" file #"_LEXF
"RTN","LEX2087A",194,0)
 S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J($FN(LEXO,","),10)
"RTN","LEX2087A",195,0)
 S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J($FN(LEXN,","),10)
"RTN","LEX2087A",196,0)
 D T2(LEXT)
"RTN","LEX2087A",197,0)
 S LEXOT=+($G(LEXOT))+($G(LEXO)),LEXNT=+($G(LEXNT))+($G(LEXN))
"RTN","LEX2087A",198,0)
 S X=0 S:+($G(LEXO))'>0&(+($G(LEXN))>0) X=1
"RTN","LEX2087A",199,0)
 Q X
"RTN","LEX2087A",200,0)
F805(X) ;
"RTN","LEX2087A",201,0)
 N LEXDN,LEXDO,LEXDTS,LEXF,LEXN,LEXNC,LEXND,LEXNN,LEXO,LEXOD
"RTN","LEX2087A",202,0)
 N LEXR,LEXT S LEXDO=3141001,LEXDN=3151001
"RTN","LEX2087A",203,0)
 S LEXNN="^ICDRS",LEXNC="^ICDRS("
"RTN","LEX2087A",204,0)
 F  S LEXNN=$Q(@LEXNN) Q:'$L(LEXNN)!(LEXNN'[LEXNC)  D
"RTN","LEX2087A",205,0)
 . N LEXND S LEXND=$G(@LEXNN)
"RTN","LEX2087A",206,0)
 . S:LEXND[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",207,0)
 . S:LEXND[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",208,0)
 . S:LEXNN[LEXDO LEXDTS(LEXDO)=+($G(LEXDTS(LEXDO)))+1
"RTN","LEX2087A",209,0)
 . S:LEXNN[LEXDN LEXDTS(LEXDN)=+($G(LEXDTS(LEXDN)))+1
"RTN","LEX2087A",210,0)
 S LEXO=+($G(LEXDTS(LEXDO))),LEXOD=$$FMTE^XLFDT(LEXDO,"5Z")
"RTN","LEX2087A",211,0)
 S LEXN=+($G(LEXDTS(LEXDN))),LEXND=$$FMTE^XLFDT(LEXDN,"5Z")
"RTN","LEX2087A",212,0)
 S LEXT="DRG SURGICAL HIERARCHY",LEXF=80.5,LEXR="^ICDRS("
"RTN","LEX2087A",213,0)
 S LEXT="   "_LEXT_" file #"_LEXF
"RTN","LEX2087A",214,0)
 S LEXT=LEXT_$J(" ",(40-$L(LEXT)))_$J($FN(LEXO,","),10)
"RTN","LEX2087A",215,0)
 S LEXT=LEXT_$J(" ",(55-$L(LEXT)))_$J($FN(LEXN,","),10)
"RTN","LEX2087A",216,0)
 D T2(LEXT)
"RTN","LEX2087A",217,0)
 S LEXOT=+($G(LEXOT))+($G(LEXO)),LEXNT=+($G(LEXNT))+($G(LEXN))
"RTN","LEX2087A",218,0)
 S X=0 S:+($G(LEXO))'>0&(+($G(LEXN))>0) X=1
"RTN","LEX2087A",219,0)
 Q X
"RTN","LEX2087A",220,0)
EOK ; Environment is OK
"RTN","LEX2087A",221,0)
 N LEXT I $G(LEXDO)'?7N!($G(LEXDN)'?7N) S LEXT="   Environment is ok." D T1(" "),T1(LEXT)
"RTN","LEX2087A",222,0)
 I $G(LEXDO)?7N,$G(LEXDN)?7N D
"RTN","LEX2087A",223,0)
 . D T1(" ") S LEXT="   Environment is ok.  All Effective dates of "_$$FMTE^XLFDT($G(LEXDO),"5Z")_" have"
"RTN","LEX2087A",224,0)
 . D T1(LEXT) S LEXT="   been changed to "_$$FMTE^XLFDT($G(LEXDN),"5Z") D T1(LEXT)
"RTN","LEX2087A",225,0)
 Q
"RTN","LEX2087A",226,0)
ENOK ; Environment is not OK
"RTN","LEX2087A",227,0)
 N LEXT I $G(LEXDO)'?7N!($G(LEXDN)'?7N) S LEXT="   Environment is not ok." D T1(" "),T1(LEXT)
"RTN","LEX2087A",228,0)
 I $G(LEXDO)?7N,$G(LEXDN)?7N D
"RTN","LEX2087A",229,0)
 . D T1(" ") S LEXT="   Environment is not ok.  Some effective dates of "_$$FMTE^XLFDT($G(LEXDO),"5Z")_" have"
"RTN","LEX2087A",230,0)
 . D T1(LEXT) S LEXT="   not been changed to "_$$FMTE^XLFDT($G(LEXDN),"5Z") D T1(LEXT)
"RTN","LEX2087A",231,0)
 Q
"RTN","LEX2087A",232,0)
BM ; Build Message
"RTN","LEX2087A",233,0)
 K ^TMP("LEX2087A",$J,"MSG") Q:$O(^TMP("LEX2087A",$J,1,0))'>0  Q:$O(^TMP("LEX2087A",$J,2,0))'>0
"RTN","LEX2087A",234,0)
 N LEXS F LEXS=1,2 D
"RTN","LEX2087A",235,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^TMP("LEX2087A",$J,LEXS,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2087A",236,0)
 . . N LEXT S LEXT=$G(^TMP("LEX2087A",$J,LEXS,LEXI)) D T3(LEXT)
"RTN","LEX2087A",237,0)
 Q 
"RTN","LEX2087A",238,0)
MAIL ; Mail Message
"RTN","LEX2087A",239,0)
 N DIFROM,LEXPRI,LEXADR,LEXI,LEXM,XCNP,XMDUZ,XMDUN,XMSCR,XMSUB,XMTEXT,XMY,XMZ
"RTN","LEX2087A",240,0)
 K ^TMP("LEXMSG",$J) S XMSUB="ICD-10 Date Change - Oct 1, 2015"
"RTN","LEX2087A",241,0)
 S LEXPRI=$$ADR G:'$L(LEXPRI) MAILQ S LEXPRI="G.LEXINS@"_LEXPRI
"RTN","LEX2087A",242,0)
 S LEXADR=$$GET1^DIQ(200,+($G(DUZ)),.01) G:'$L(LEXADR) MAILQ
"RTN","LEX2087A",243,0)
 S U="^" S LEXI=0 F  S LEXI=$O(^TMP("LEX2087A",$J,"MSG",LEXI)) Q:+LEXI=0  D
"RTN","LEX2087A",244,0)
 . S LEXM=+($O(^TMP("LEXMSG",$J," "),-1))+1
"RTN","LEX2087A",245,0)
 . S ^TMP("LEXMSG",$J,LEXM,0)=$E($G(^TMP("LEX2087A",$J,"MSG",LEXI)),1,79)
"RTN","LEX2087A",246,0)
 . S ^TMP("LEXMSG",$J,0)=LEXM
"RTN","LEX2087A",247,0)
 K ^TMP("LEX2087A",$J,"MSG") G:+($G(^TMP("LEXMSG",$J,0)))'>0 MAILQ
"RTN","LEX2087A",248,0)
 S XMY(LEXPRI)="",XMY(LEXADR)="",XMTEXT="^TMP(""LEXMSG"",$J,",XMDUZ=.5 D ^XMD
"RTN","LEX2087A",249,0)
MAILQ ; Quit Mail
"RTN","LEX2087A",250,0)
 K XCNP,XMSCR,XMDUZ,XMY,XMZ,XMSUB,XMY,XMTEXT,XMDUZ K ^TMP("LEXMSG",$J),^TMP("LEX2087A",$J)
"RTN","LEX2087A",251,0)
 Q
"RTN","LEX2087A",252,0)
ADR(LEX) ; Mailing Address
"RTN","LEX2087A",253,0)
 N DIC,DTOUT,DUOUT,X,Y S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="DOMAIN.EXT" D ^DIC Q:+Y>0 LEX
"RTN","LEX2087A",254,0)
 S DIC="^DIC(4.2,",DIC(0)="M",(LEX,X)="ISC-SLC.DOMAIN.EXT" D ^DIC Q:+Y>0 LEX
"RTN","LEX2087A",255,0)
 Q "ISC-SLC.DOMAIN.EXT"
"RTN","LEX2087A",256,0)
ST ; Show Text
"RTN","LEX2087A",257,0)
 N LEXS F LEXS=1,2,3 D
"RTN","LEX2087A",258,0)
 . N LEXI S LEXI=0 F  S LEXI=$O(^TMP("LEX2087A",$J,LEXS,LEXI)) Q:+LEXI'>0  D
"RTN","LEX2087A",259,0)
 . . W !,$G(^TMP("LEX2087A",$J,LEXS,LEXI))
"RTN","LEX2087A",260,0)
 Q
"RTN","LEX2087A",261,0)
T1(X) ; Text 1
"RTN","LEX2087A",262,0)
 N LEXI S LEXI=$O(^TMP("LEX2087A",$J,1," "),-1)+1
"RTN","LEX2087A",263,0)
 S ^TMP("LEX2087A",$J,1,LEXI)=$G(X) D MES^XPDUTL($G(X))
"RTN","LEX2087A",264,0)
 Q
"RTN","LEX2087A",265,0)
T2(X) ; Text 2
"RTN","LEX2087A",266,0)
 N LEXI S LEXI=$O(^TMP("LEX2087A",$J,2," "),-1)+1
"RTN","LEX2087A",267,0)
 S ^TMP("LEX2087A",$J,2,LEXI)=$G(X) D MES^XPDUTL($G(X))
"RTN","LEX2087A",268,0)
 Q
"RTN","LEX2087A",269,0)
T3(X) ; Text 3
"RTN","LEX2087A",270,0)
 N LEXI S LEXI=$O(^TMP("LEX2087A",$J,"MSG"," "),-1)+1
"RTN","LEX2087A",271,0)
 S ^TMP("LEX2087A",$J,"MSG",LEXI)=$G(X)
"RTN","LEX2087A",272,0)
 Q
"RTN","LEX2087P")
0^2^B28656391^n/a
"RTN","LEX2087P",1,0)
LEX2087P ;ISL/KER - LEX*2.0*87 Pre/Post Install ;06/14/2014
"RTN","LEX2087P",2,0)
 ;;2.0;LEXICON UTILITY;**87**;Sep 23, 1996;Build 1
"RTN","LEX2087P",3,0)
 ;               
"RTN","LEX2087P",4,0)
 ; Global Variables 
"RTN","LEX2087P",5,0)
 ;    ^LEXM(              N/A
"RTN","LEX2087P",6,0)
 ;               
"RTN","LEX2087P",7,0)
 ; External References
"RTN","LEX2087P",8,0)
 ;    ^DIC                ICR  10006
"RTN","LEX2087P",9,0)
 ;    $$NOW^XLFDT         ICR  10103
"RTN","LEX2087P",10,0)
 ;    $$PKGPAT^XPDIP      ICR   2067
"RTN","LEX2087P",11,0)
 ;    MES^XPDUTL          ICR  10141
"RTN","LEX2087P",12,0)
 ;               
"RTN","LEX2087P",13,0)
 Q
"RTN","LEX2087P",14,0)
POST ; Post-Install
"RTN","LEX2087P",15,0)
 ;            
"RTN","LEX2087P",16,0)
 ; From IMP in the Environment Check
"RTN","LEX2087P",17,0)
 ;            
"RTN","LEX2087P",18,0)
 ;      LEXBUILD   Build Name - LEX*2.0*nn
"RTN","LEX2087P",19,0)
 ;      LEXPTYPE   Patch Type - Remedy or Quarterly
"RTN","LEX2087P",20,0)
 ;      LEXFY      Fiscal Year - FYnn
"RTN","LEX2087P",21,0)
 ;      LEXQTR     Quarter - 1st, 2nd, 3rd, or 4th
"RTN","LEX2087P",22,0)
 ;      LEXIGHF    Name of Host File - LEX_2_nn.GBL
"RTN","LEX2087P",23,0)
 ;      LEXLREV    Revision - nn
"RTN","LEX2087P",24,0)
 ;      LEXREQP    Required Builds - build;build;build
"RTN","LEX2087P",25,0)
 ;      
"RTN","LEX2087P",26,0)
 ; Note:  The section IPL (Informational Patch List) must
"RTN","LEX2087P",27,0)
 ;        be updated with each patch
"RTN","LEX2087P",28,0)
 ;            
"RTN","LEX2087P",29,0)
 N LEXEDT,LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR,LEXB,LEXCD,LEXSTR,LEXLAST,LEXOK,X,Y S LEXOK=0 D IMP
"RTN","LEX2087P",30,0)
 S LEXEDT=$G(^LEXM(0,"CREATED")) D:LEXOK>0 LOAD,CON,IP
"RTN","LEX2087P",31,0)
 Q
"RTN","LEX2087P",32,0)
LOAD ; Load Data
"RTN","LEX2087P",33,0)
 ;             
"RTN","LEX2087P",34,0)
 ;      LEXSHORT   Send Short Message
"RTN","LEX2087P",35,0)
 ;      LEXMSG     Flag to send Message
"RTN","LEX2087P",36,0)
 ;            
"RTN","LEX2087P",37,0)
 N LEXSHORT,LEXMSG S LEXSHORT="",LEXMSG=""
"RTN","LEX2087P",38,0)
 S LEXSTR=$G(LEXPTYPE) S:$L($G(LEXFY))&($L($G(LEXQTR))) LEXSTR=LEXSTR_" for "_$G(LEXFY)_" "_$G(LEXQTR)_" Quarter"
"RTN","LEX2087P",39,0)
 S U="^",LEXB=$G(^LEXM(0,"BUILD")) Q:LEXB=""  Q:$G(LEXBUILD)=""
"RTN","LEX2087P",40,0)
 D:LEXB=LEXBUILD EN^LEXXGI
"RTN","LEX2087P",41,0)
LQ ; Load Quit
"RTN","LEX2087P",42,0)
 D KLEXM
"RTN","LEX2087P",43,0)
 Q
"RTN","LEX2087P",44,0)
 ;             
"RTN","LEX2087P",45,0)
KLEXM ; Subscripted Kill of ^LEXM
"RTN","LEX2087P",46,0)
 H 2 N DA S DA=0 F  S DA=$O(^LEXM(DA)) Q:+DA=0  K ^LEXM(DA)
"RTN","LEX2087P",47,0)
 N LEX S LEX=$G(^LEXM(0,"PRO")) K ^LEXM(0)
"RTN","LEX2087P",48,0)
 Q
"RTN","LEX2087P",49,0)
 ;
"RTN","LEX2087P",50,0)
IP ; Informational Patches
"RTN","LEX2087P",51,0)
 N LEX,LEXP,LEXPS,LEXSQ,LEXT,LEXI,LEXE,LEXX,LEXC,LEXPTYPE,LEXLREV,LEXREQP,LEXBUILD,LEXIGHF,LEXFY,LEXQTR,LEXSUB,LEXOK D IMP S LEXSUB=""
"RTN","LEX2087P",52,0)
 I $G(LEXPTYPE)="Code Set Update",$G(LEXFY)["FY",$L($G(LEXQTR)) S LEXSUB="Code Set "_LEXFY_" "_LEXQTR_" Qtr Update"
"RTN","LEX2087P",53,0)
 S LEXC=0 F LEXI=1:1 D  Q:'$L(LEXX)
"RTN","LEX2087P",54,0)
 . S LEXX="" S LEXE="S LEXX=$T(IPL+"_LEXI_")" X LEXE S:'$L($TR($G(LEXX),";","")) LEXX="" Q:'$L(LEXX)  S LEXPS=$P(LEXX,";;",2) S:$L(LEXPS,"*")=3 LEXC=LEXC+1
"RTN","LEX2087P",55,0)
 I LEXC>0 S LEXT=" Informational Patch"_$S(+($G(LEXC))>1:"es",1:"") S:$L(LEXSUB) LEXT=LEXT_" for the "_LEXSUB S LEXT=LEXT_":" D MES^XPDUTL(LEXT)
"RTN","LEX2087P",56,0)
 S LEXC=0 F LEXI=1:1 D  Q:'$L(LEXX)
"RTN","LEX2087P",57,0)
 . S LEXX="" S LEXE="S LEXX=$T(IPL+"_LEXI_")" X LEXE S:'$L($TR($G(LEXX),";","")) LEXX="" Q:'$L(LEXX)  S LEXPS=$P(LEXX,";;",2) S:'$L(LEXPS) LEXX="" Q:'$L(LEXX)
"RTN","LEX2087P",58,0)
 . S LEXSQ=+($P(LEXX,";;",3)) S:+LEXSQ>0 LEXPS=LEXPS_" SEQ #"_LEXSQ S LEXC=LEXC+1 D:LEXC=1 MES^XPDUTL(" ")
"RTN","LEX2087P",59,0)
 . W:$D(LEXTEST) !,?5,LEXPS D:'$D(LEXTEST) IPU(LEXPS)
"RTN","LEX2087P",60,0)
 D:LEXC>0 MES^XPDUTL(" ") N LEXTEST
"RTN","LEX2087P",61,0)
 Q
"RTN","LEX2087P",62,0)
IPU(X) ;   Patch Update
"RTN","LEX2087P",63,0)
 N LEXID,LEXOP,LEXPC,LEXPK,LEXPKI,LEXPN,LEXPTI,LEXSQ,LEXT,LEXVR,LEXVRI,LEXAR
"RTN","LEX2087P",64,0)
 S LEXPC=$G(X),LEXSQ=$P(LEXPC," ",2,299),LEXID=$P(LEXPC," ",1),LEXOP=""
"RTN","LEX2087P",65,0)
 S LEXPK=$S($P(LEXPC,"*",1)="ICD":"DRG GROUPER",$P(LEXPC,"*",1)="ICPT":"CPT/HCPCS CODES",$P(LEXPC,"*",1)="LEX":"LEXICON UTILITY",1:"") Q:'$L(LEXPK)
"RTN","LEX2087P",66,0)
 S LEXPKI=$$PIEN(LEXPK) Q:+LEXPKI'>0  S LEXVR=$P(LEXPC,"*",2) Q:'$L(LEXVR)  Q:LEXVR'["."  S LEXPN=$P(LEXPC,"*",3) Q:'$L(LEXPN)  Q:+LEXPN'>0
"RTN","LEX2087P",67,0)
 S LEXAR=LEXPN_"^"_$$NOW^XLFDT_"^"_$G(DUZ)
"RTN","LEX2087P",68,0)
 I $L($G(LEXBUILD)) S LEXOP=$$PKGPAT^XPDIP(LEXPKI,LEXVR,.LEXAR)
"RTN","LEX2087P",69,0)
 S LEXVRI=$P(LEXOP,"^",1),LEXPTI=$P(LEXOP,"^",2)
"RTN","LEX2087P",70,0)
 S LEXT="   "_LEXID,LEXT=LEXT_$J(" ",(17-$L(LEXT)))_LEXSQ,LEXT=LEXT_$J(" ",(28-$L(LEXT)))_LEXPK
"RTN","LEX2087P",71,0)
 I $L(LEXOP),LEXPTI>0 S LEXT=LEXT_$J(" ",(46-$L(LEXT)))_"Patch History updated" D MES^XPDUTL(LEXT)
"RTN","LEX2087P",72,0)
 I $L(LEXOP),LEXPTI'>0 S LEXT=LEXT_$J(" ",(46-$L(LEXT)))_"Patch History not updated" D MES^XPDUTL(LEXT)
"RTN","LEX2087P",73,0)
 I '$L(LEXOP) D MES^XPDUTL(LEXT)
"RTN","LEX2087P",74,0)
 Q
"RTN","LEX2087P",75,0)
IPL ;   Patch List  ;;Patch;;Sequence #
"RTN","LEX2087P",76,0)
 ;;ICD*18.0*68;;
"RTN","LEX2087P",77,0)
 ;;;;;;
"RTN","LEX2087P",78,0)
PRE ; Pre-Install              (N/A for this patch)
"RTN","LEX2087P",79,0)
 Q
"RTN","LEX2087P",80,0)
CON ; Conversion of data       (Post-Install Environment Check)
"RTN","LEX2087P",81,0)
 D BMES^XPDUTL(" Converting DRG data to use Oct 1, 2015") D ICD9,ICD,ICDRS
"RTN","LEX2087P",82,0)
 D POST^LEX2087A
"RTN","LEX2087P",83,0)
 Q
"RTN","LEX2087P",84,0)
ICD9 ; ICD9 Global
"RTN","LEX2087P",85,0)
 N DA,DIK
"RTN","LEX2087P",86,0)
 S DA(2)=502758,DA(1)=1,DA=2,DIK="^ICD9("_DA(2)_",68,"_DA(1)_",2,"
"RTN","LEX2087P",87,0)
 I $D(^ICD9(DA(2),68,DA(1),2,DA,0)) D ^DIK
"RTN","LEX2087P",88,0)
 S DA(2)=502758,DA(1)=1,DA=3,DIK="^ICD9("_DA(2)_",68,"_DA(1)_",2,"
"RTN","LEX2087P",89,0)
 I $D(^ICD9(DA(2),68,DA(1),2,DA,0)) D ^DIK
"RTN","LEX2087P",90,0)
 K ^ICD9("D","HYPERTENSION",502758,3141001,1,2)
"RTN","LEX2087P",91,0)
 K ^ICD9("D","HYPERTENSIVE",502758,3141001,1,3)
"RTN","LEX2087P",92,0)
 K ^ICD9("AD",30,"HYPERTENSION",502758,3141001,1,2)
"RTN","LEX2087P",93,0)
 K ^ICD9("AD",30,"HYPERTENSIVE",502758,3141001,1,3)
"RTN","LEX2087P",94,0)
 Q
"RTN","LEX2087P",95,0)
ICD ; ICD global
"RTN","LEX2087P",96,0)
 N LEXI,LEX9,LEX10 S LEX9=3141001,LEX10=3151001
"RTN","LEX2087P",97,0)
 S LEXI=0 F  S LEXI=$O(^ICD(LEXI)) Q:+LEXI'>0  D
"RTN","LEX2087P",98,0)
 . N LEXH S LEXH=0 F  S LEXH=$O(^ICD(LEXI,2,LEXH)) Q:+LEXH'>0  D
"RTN","LEX2087P",99,0)
 . . N LEXD,LEXT,DA,DIK S LEXD=$P($G(^ICD(LEXI,2,LEXH,0)),"^",1)
"RTN","LEX2087P",100,0)
 . . S LEXT=$P($G(^ICD(LEXI,2,LEXH,0)),"^",3) Q:LEXT'["ICD10"
"RTN","LEX2087P",101,0)
 . . Q:LEXD'=LEX9  S DA=LEXI,DIK="^ICD(" D IX2^DIK
"RTN","LEX2087P",102,0)
 . . S $P(^ICD(LEXI,2,LEXH,0),"^",1)=LEX10 D IX1^DIK
"RTN","LEX2087P",103,0)
 Q
"RTN","LEX2087P",104,0)
ICDRS ;
"RTN","LEX2087P",105,0)
 N LEXI,LEX9,LEX10 S LEX9=3141001,LEX10=3151001
"RTN","LEX2087P",106,0)
 S LEXI=0 F  S LEXI=$O(^ICDRS(LEXI)) Q:+LEXI'>0  D
"RTN","LEX2087P",107,0)
 . N LEXD,DA,DIK S LEXD=$P($G(^ICDRS(LEXI,0)),"^",1)
"RTN","LEX2087P",108,0)
 . Q:LEXD'=LEX9  S DA=LEXI,DIK="^ICDRS(" D IX2^DIK
"RTN","LEX2087P",109,0)
 . S $P(^ICDRS(LEXI,0),"^",1)=LEX10 D IX1^DIK
"RTN","LEX2087P",110,0)
 Q
"RTN","LEX2087P",111,0)
 ;            
"RTN","LEX2087P",112,0)
 ; Miscellaneous
"RTN","LEX2087P",113,0)
PIEN(X) ;   Package IEN
"RTN","LEX2087P",114,0)
 N DIC,DTOUT,DTOUT,Y S X=$G(X),DIC="^DIC(9.4,",DIC(0)="B" D ^DIC S X=+Y
"RTN","LEX2087P",115,0)
 Q X
"RTN","LEX2087P",116,0)
IMP ;   Call IMP in Environment Check
"RTN","LEX2087P",117,0)
 K LEXBUILD,LEXFY,LEXIGHF,LEXLREV,LEXPTYPE,LEXQTR,LEXREQP N LEXF
"RTN","LEX2087P",118,0)
 S LEXF=$P($T(+1)," ",1) S:$E(LEXF,$L(LEXF))="P" LEXF=$E(LEXF,1,($L(LEXF)-1)) Q:'$L(LEXF)
"RTN","LEX2087P",119,0)
 S LEXF="IMP^"_LEXF Q:'$L($T(@LEXF))  D @LEXF S:$L(LEXBUILD) LEXOK=1
"RTN","LEX2087P",120,0)
 Q
"VER")
8.0^22.0
"BLD",8336,6)
^87
**END**
**END**

