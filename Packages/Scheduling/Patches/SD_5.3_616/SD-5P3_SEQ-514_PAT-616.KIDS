EMERGENCY Released SD*5.3*616 SEQ #514
Extracted from mail message
**KIDS**:SD*5.3*616^

**INSTALL NAME**
SD*5.3*616
"BLD",9340,0)
SD*5.3*616^SCHEDULING^0^3140429^y
"BLD",9340,4,0)
^9.64PA^^
"BLD",9340,6.3)
3
"BLD",9340,"ABPKG")
n
"BLD",9340,"KRN",0)
^9.67PA^779.2^20
"BLD",9340,"KRN",.4,0)
.4
"BLD",9340,"KRN",.401,0)
.401
"BLD",9340,"KRN",.402,0)
.402
"BLD",9340,"KRN",.403,0)
.403
"BLD",9340,"KRN",.5,0)
.5
"BLD",9340,"KRN",.84,0)
.84
"BLD",9340,"KRN",3.6,0)
3.6
"BLD",9340,"KRN",3.8,0)
3.8
"BLD",9340,"KRN",9.2,0)
9.2
"BLD",9340,"KRN",9.8,0)
9.8
"BLD",9340,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9340,"KRN",9.8,"NM",1,0)
SD44AUDI^^0^B34851124
"BLD",9340,"KRN",9.8,"NM","B","SD44AUDI",1)

"BLD",9340,"KRN",19,0)
19
"BLD",9340,"KRN",19.1,0)
19.1
"BLD",9340,"KRN",101,0)
101
"BLD",9340,"KRN",409.61,0)
409.61
"BLD",9340,"KRN",771,0)
771
"BLD",9340,"KRN",779.2,0)
779.2
"BLD",9340,"KRN",870,0)
870
"BLD",9340,"KRN",8989.51,0)
8989.51
"BLD",9340,"KRN",8989.52,0)
8989.52
"BLD",9340,"KRN",8994,0)
8994
"BLD",9340,"KRN","B",.4,.4)

"BLD",9340,"KRN","B",.401,.401)

"BLD",9340,"KRN","B",.402,.402)

"BLD",9340,"KRN","B",.403,.403)

"BLD",9340,"KRN","B",.5,.5)

"BLD",9340,"KRN","B",.84,.84)

"BLD",9340,"KRN","B",3.6,3.6)

"BLD",9340,"KRN","B",3.8,3.8)

"BLD",9340,"KRN","B",9.2,9.2)

"BLD",9340,"KRN","B",9.8,9.8)

"BLD",9340,"KRN","B",19,19)

"BLD",9340,"KRN","B",19.1,19.1)

"BLD",9340,"KRN","B",101,101)

"BLD",9340,"KRN","B",409.61,409.61)

"BLD",9340,"KRN","B",771,771)

"BLD",9340,"KRN","B",779.2,779.2)

"BLD",9340,"KRN","B",870,870)

"BLD",9340,"KRN","B",8989.51,8989.51)

"BLD",9340,"KRN","B",8989.52,8989.52)

"BLD",9340,"KRN","B",8994,8994)

"BLD",9340,"QUES",0)
^9.62^^
"BLD",9340,"REQB",0)
^9.611^1^1
"BLD",9340,"REQB",1,0)
SD*5.3*568^1
"BLD",9340,"REQB","B","SD*5.3*568",1)

"MBREQ")
0
"PKG",16,-1)
1^1
"PKG",16,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",16,20,0)
^9.402P^^
"PKG",16,22,0)
^9.49I^1^1
"PKG",16,22,1,0)
5.3^2930813
"PKG",16,22,1,"PAH",1,0)
616^3140429
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","SD44AUDI")
0^1^B34851124^B10879260
"RTN","SD44AUDI",1,0)
SD44AUDI ;ALB/DHE - Audit print of file 44 fields ;4/29/14  16:51
"RTN","SD44AUDI",2,0)
 ;;5.3;Scheduling;**568,616**;Aug 13, 1993;Build 3
"RTN","SD44AUDI",3,0)
EN ;entry point from option
"RTN","SD44AUDI",4,0)
 ;Init variables and sort array
"RTN","SD44AUDI",5,0)
 N QFLG,SORT,SDX,SDNAM,SDSD,SDED,SDDT,SDNAME,SDST,SDSEQ,STCODE,D0,SDXPORT ;616
"RTN","SD44AUDI",6,0)
 ;
"RTN","SD44AUDI",7,0)
 S QFLG=0
"RTN","SD44AUDI",8,0)
 W !!,"This option prints a log of the changes made to Clinic Locations"
"RTN","SD44AUDI",9,0)
 ;
"RTN","SD44AUDI",10,0)
 ;Get sort
"RTN","SD44AUDI",11,0)
 D GETSORT Q:QFLG
"RTN","SD44AUDI",12,0)
 D DTRNG Q:QFLG
"RTN","SD44AUDI",13,0)
 S SDXPORT=$$EXPORT Q:SDXPORT=-1  ;616
"RTN","SD44AUDI",14,0)
 I '$G(SDXPORT) W !!,"** REPORT REQUIRES 132 COLUMNS TO PRINT CORRECTLY **" ;616
"RTN","SD44AUDI",15,0)
 D PRINT
"RTN","SD44AUDI",16,0)
 Q
"RTN","SD44AUDI",17,0)
GETSORT ;Prompt for sorting order for report
"RTN","SD44AUDI",18,0)
 N DIR,X,Y,DIRUT
"RTN","SD44AUDI",19,0)
 S DIR(0)="SO^1:USER NAME;2:DATE CHANGED"
"RTN","SD44AUDI",20,0)
 S DIR("A")="Select sort for Clinic Edit Log",DIR("B")=1
"RTN","SD44AUDI",21,0)
 D ^DIR
"RTN","SD44AUDI",22,0)
 I $D(DIRUT) S QFLG=1 Q
"RTN","SD44AUDI",23,0)
 S SORT=Y
"RTN","SD44AUDI",24,0)
 Q
"RTN","SD44AUDI",25,0)
PRINT ;Print report using fileman EN1^DIP 
"RTN","SD44AUDI",26,0)
 N L,DIR,DIC,DIA,FLDS,DHD,BY,FR,TO,DIOBEG,SDFIL,PG,SDFLG,IOP ;616
"RTN","SD44AUDI",27,0)
 S SDFIL=44,SDFLG=0
"RTN","SD44AUDI",28,0)
 S L=0,DIC="^DIA("_SDFIL_"," S DIOBEG=$S('$G(SDXPORT):"I $E(IOST,1,2)=""C-"" W @IOF",1:"W ""USER NAME^DATE/TIME CHANGED^CLINIC IEN^CLINIC NAME^FIELD NAME^OLD VALUE^NEW VALUE""") ;616
"RTN","SD44AUDI",29,0)
 I '$G(SDXPORT) D  ;616
"RTN","SD44AUDI",30,0)
 .S FLDS=".04;L23,.02;C25;L20,D CLINIEN^SD44AUDI;C47;L10,D CLINM^SD44AUDI;C59;L18," ;616
"RTN","SD44AUDI",31,0)
 .S FLDS=FLDS_"1.1;C79;L10,D STCODE^SD44AUDI(2);C90;L19,D STCODE^SD44AUDI(3);C110;L15" ;616
"RTN","SD44AUDI",32,0)
 I $G(SDXPORT) S FLDS=".04;X,""^"",.02;X,""^"",D CLINIEN^SD44AUDI;X,""^"",D CLINM^SD44AUDI;X,""^"",1.1;X;L40,""^"",D STCODE^SD44AUDI(2);X,""^"",D STCODE^SD44AUDI(3);X" ;616
"RTN","SD44AUDI",33,0)
 S DHD=$S('$G(SDXPORT):"W ?0 D RPTHDR^SD44AUDI",1:"@@") ;616
"RTN","SD44AUDI",34,0)
 I SORT=1 D
"RTN","SD44AUDI",35,0)
 .S BY=".04,.02",FR="A,"_SDSD,TO="Zz,"_SDED
"RTN","SD44AUDI",36,0)
 I SORT=2 D
"RTN","SD44AUDI",37,0)
 .S BY=".02,.04",FR=SDSD_",A",TO=SDED_",Zz"
"RTN","SD44AUDI",38,0)
 I $G(SDXPORT) D EXPDISP Q:IOP="^"  ;616
"RTN","SD44AUDI",39,0)
 D EN1^DIP
"RTN","SD44AUDI",40,0)
 I 'SDFLG,'$D(^DIA(SDFIL)) D
"RTN","SD44AUDI",41,0)
 .W !,"NO RECORDS FOUND"
"RTN","SD44AUDI",42,0)
 .I $E(IOST,1,2)="C-",'$G(SDXPORT) S DIR(0)="E" D ^DIR ;616
"RTN","SD44AUDI",43,0)
 I $G(SDXPORT) D  ;616
"RTN","SD44AUDI",44,0)
 .W !!,"Turn off your logging..."
"RTN","SD44AUDI",45,0)
 .W !,"...Then, pull your export text file into your spreadsheet.",!
"RTN","SD44AUDI",46,0)
 .S DIR(0)="E",DIR("A")="Press any key to continue" D ^DIR
"RTN","SD44AUDI",47,0)
 .D HOME^%ZIS
"RTN","SD44AUDI",48,0)
 Q
"RTN","SD44AUDI",49,0)
 ;
"RTN","SD44AUDI",50,0)
CLINM ;Clinic name
"RTN","SD44AUDI",51,0)
 I $G(X) D
"RTN","SD44AUDI",52,0)
 . W $E($P($G(^SC(+X,0)),"^"),1,18)
"RTN","SD44AUDI",53,0)
 Q
"RTN","SD44AUDI",54,0)
CLINIEN ;section added in 616
"RTN","SD44AUDI",55,0)
 W +X Q
"RTN","SD44AUDI",56,0)
 ;
"RTN","SD44AUDI",57,0)
SEQ ;retain sequence number
"RTN","SD44AUDI",58,0)
 S SDST=0 I $G(D0) D
"RTN","SD44AUDI",59,0)
 . S SDSEQ=D0
"RTN","SD44AUDI",60,0)
 . I $D(^DIA(44,SDSEQ,0)) D
"RTN","SD44AUDI",61,0)
 . I $P(^DIA(44,SDSEQ,0),"^",3)=8!($P(^(0),"^",3)=2503) D
"RTN","SD44AUDI",62,0)
 . . S SDST=1
"RTN","SD44AUDI",63,0)
 Q
"RTN","SD44AUDI",64,0)
STCODE(FLD) ;Get AMIS Stop Code #
"RTN","SD44AUDI",65,0)
 D SEQ
"RTN","SD44AUDI",66,0)
 D
"RTN","SD44AUDI",67,0)
 . I '$D(^DIA(44,D0,FLD)) S STCODE="" Q
"RTN","SD44AUDI",68,0)
 . I SDST=1 D
"RTN","SD44AUDI",69,0)
 . . S STCODE=$S(FLD=2:$P($G(^DIA(44,D0,2.1)),U),1:$P($G(^DIA(44,D0,3.1)),U))
"RTN","SD44AUDI",70,0)
 . . I $D(^DIC(40.7,+STCODE,0)) S STCODE=$P(^DIC(40.7,STCODE,0),"^",2)
"RTN","SD44AUDI",71,0)
 . . ;if stcode name has been changed then just print free txt
"RTN","SD44AUDI",72,0)
 . . I STCODE="" S STCODE=^DIA(44,D0,FLD)
"RTN","SD44AUDI",73,0)
 . . W $E(STCODE,1,18)
"RTN","SD44AUDI",74,0)
 . E  D
"RTN","SD44AUDI",75,0)
 . . W $E(^DIA(44,D0,FLD),1,18)
"RTN","SD44AUDI",76,0)
 Q
"RTN","SD44AUDI",77,0)
RPTHDR ;report header
"RTN","SD44AUDI",78,0)
 N LN
"RTN","SD44AUDI",79,0)
 S PG=$G(PG)+1,SDFLG=1
"RTN","SD44AUDI",80,0)
 W "CLINIC EDIT LOG ",?115,"Page ",PG,!
"RTN","SD44AUDI",81,0)
 W "Printed on ",$$HTE^XLFDT($H)," for ",SDSD," to ",SDED,!
"RTN","SD44AUDI",82,0)
 W "USER NAME",?24,"DATE/TIME CHANGED",?46,"CLINIC IEN",?58
"RTN","SD44AUDI",83,0)
 W "CLINIC NAME",?78,"FIELD NAME",?89,"OLD VALUE",?109,"NEW VALUE",!
"RTN","SD44AUDI",84,0)
 S $P(LN,"-",130)="" W LN,!
"RTN","SD44AUDI",85,0)
 Q
"RTN","SD44AUDI",86,0)
DTRNG ;report date range
"RTN","SD44AUDI",87,0)
 N %DT,ECDT,X,Y
"RTN","SD44AUDI",88,0)
DTREP S %DT="AEX",%DT("A")="Starting with Date: ",%DT(0)="-NOW" D ^%DT
"RTN","SD44AUDI",89,0)
 I Y<0 S QFLG=1 Q
"RTN","SD44AUDI",90,0)
 S SDDT=Y,SDSD=$$FMTE^XLFDT(Y,2)
"RTN","SD44AUDI",91,0)
 S %DT="AEX",%DT("A")="Ending with Date: ",%DT(0)="-NOW" D ^%DT
"RTN","SD44AUDI",92,0)
 I Y<0 S QFLG=1 Q
"RTN","SD44AUDI",93,0)
 I Y<SDDT D  G DTREP
"RTN","SD44AUDI",94,0)
 .W !!,"The ending date cannot be earlier than the starting date.",!
"RTN","SD44AUDI",95,0)
 I $E(Y,1,5)'=$E(SDDT,1,5) D  G DTREP
"RTN","SD44AUDI",96,0)
 .W !!,"Beginning and ending dates must be in the same month and year.",!
"RTN","SD44AUDI",97,0)
 S SDED=$$FMTE^XLFDT(Y,2)
"RTN","SD44AUDI",98,0)
 Q
"RTN","SD44AUDI",99,0)
EXPORT() ;Function indicates if report output is going to a device or to the screen in exportable format - API added in patch 616
"RTN","SD44AUDI",100,0)
 N DIR,DIRUT,DTOUT,DUOUT,DIROUT,X,Y,VAL
"RTN","SD44AUDI",101,0)
 W !
"RTN","SD44AUDI",102,0)
 S DIR("?",1)="Enter yes if you want the data to be displayed in an '^' delimited format",DIR("?")="that can be captured for exporting."
"RTN","SD44AUDI",103,0)
 S DIR(0)="SA^Y:YES;N:NO",DIR("B")="NO",DIR("A")="Do you want the output in exportable format? "
"RTN","SD44AUDI",104,0)
 D ^DIR
"RTN","SD44AUDI",105,0)
 S VAL=$S($D(DIRUT):-1,Y="N":0,1:1)
"RTN","SD44AUDI",106,0)
 I VAL=1 W !!,"Gathering data for export..."
"RTN","SD44AUDI",107,0)
 Q VAL
"RTN","SD44AUDI",108,0)
 ;
"RTN","SD44AUDI",109,0)
EXPDISP ;Displays report in exportable format.  API added in patch 616
"RTN","SD44AUDI",110,0)
 N I,%ZIS,POP,DIR,DTOUT,DIRUT,X,Y,DUOUT,ION
"RTN","SD44AUDI",111,0)
 W !!,"To ensure all data is captured during the export:"
"RTN","SD44AUDI",112,0)
 W !!,"1. Select 'Logging...' from the File Menu. Select your file, and where to save."
"RTN","SD44AUDI",113,0)
 W !,"2. On the Setup menu, select 'Display...',then 'screen' tab and modify 'columns'",!,"   setting to at least 225 characters."
"RTN","SD44AUDI",114,0)
 W !,"3. The DEVICE input for the columns should also contain a large enough",!,"   parameter (e.g. 225).  The DEVICE prompt is defaulted to 0;225;99999 for you.",!,"   You may change it if need be."
"RTN","SD44AUDI",115,0)
 W !,"Example: DEVICE: 0;225;99999 *Where 0 is your screen, 225 is the margin width",!?17,"and 99999 is the screen length."
"RTN","SD44AUDI",116,0)
 W !!,"NOTE:  In order for all number fields, such as SSN and Feeder Key, to be",!,"displayed correctly in the spreadsheet, these fields must be formatted as Text",!,"when importing the data into the spreadsheet.",!
"RTN","SD44AUDI",117,0)
 S %ZIS="N",%ZIS("B")="0;225;99999" D ^%ZIS S:POP IOP="^" S:'POP IOP=ION_";"_$G(IOM)_";"_$G(IOSL)
"VER")
8.0^22.0
"BLD",9340,6)
^514
**END**
**END**

