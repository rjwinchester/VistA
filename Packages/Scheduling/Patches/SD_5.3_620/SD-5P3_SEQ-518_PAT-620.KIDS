Released SD*5.3*620 SEQ #518
Extracted from mail message
**KIDS**:SD*5.3*620^

**INSTALL NAME**
SD*5.3*620
"BLD",9010,0)
SD*5.3*620^SCHEDULING^0^3140721^y
"BLD",9010,1,0)
^^3^3^3140721^
"BLD",9010,1,1,0)
This build includes legacy PCMM data extract routines used for comparison 
"BLD",9010,1,2,0)
to PCMM Web for data validation. The routines have been added as options
"BLD",9010,1,3,0)
to the SCMC PCMM Extracts menu.
"BLD",9010,4,0)
^9.64PA^^
"BLD",9010,6.3)
11
"BLD",9010,"KRN",0)
^9.67PA^779.2^20
"BLD",9010,"KRN",.4,0)
.4
"BLD",9010,"KRN",.401,0)
.401
"BLD",9010,"KRN",.402,0)
.402
"BLD",9010,"KRN",.403,0)
.403
"BLD",9010,"KRN",.5,0)
.5
"BLD",9010,"KRN",.84,0)
.84
"BLD",9010,"KRN",3.6,0)
3.6
"BLD",9010,"KRN",3.8,0)
3.8
"BLD",9010,"KRN",9.2,0)
9.2
"BLD",9010,"KRN",9.8,0)
9.8
"BLD",9010,"KRN",9.8,"NM",0)
^9.68A^8^8
"BLD",9010,"KRN",9.8,"NM",1,0)
SCRPTEAM^^0^B15183519
"BLD",9010,"KRN",9.8,"NM",2,0)
SCRPTHST^^0^B8383528
"BLD",9010,"KRN",9.8,"NM",3,0)
SCRPTPOS^^0^B35911981
"BLD",9010,"KRN",9.8,"NM",4,0)
SCRPTPHS^^0^B9381464
"BLD",9010,"KRN",9.8,"NM",5,0)
SCRPPTA^^0^B18005623
"BLD",9010,"KRN",9.8,"NM",6,0)
SCRPPTPA^^0^B20107233
"BLD",9010,"KRN",9.8,"NM",7,0)
SCRPPAHS^^0^B22427775
"BLD",9010,"KRN",9.8,"NM",8,0)
SCRPPRAH^^0^B13384637
"BLD",9010,"KRN",9.8,"NM","B","SCRPPAHS",7)

"BLD",9010,"KRN",9.8,"NM","B","SCRPPRAH",8)

"BLD",9010,"KRN",9.8,"NM","B","SCRPPTA",5)

"BLD",9010,"KRN",9.8,"NM","B","SCRPPTPA",6)

"BLD",9010,"KRN",9.8,"NM","B","SCRPTEAM",1)

"BLD",9010,"KRN",9.8,"NM","B","SCRPTHST",2)

"BLD",9010,"KRN",9.8,"NM","B","SCRPTPHS",4)

"BLD",9010,"KRN",9.8,"NM","B","SCRPTPOS",3)

"BLD",9010,"KRN",19,0)
19
"BLD",9010,"KRN",19,"NM",0)
^9.68A^9^9
"BLD",9010,"KRN",19,"NM",1,0)
SCMC PCMM EXTRACT ROUTINES^^0
"BLD",9010,"KRN",19,"NM",2,0)
SCMC TEAM FILE EXTRACT^^0
"BLD",9010,"KRN",19,"NM",3,0)
SCMC TEAM HISTORY FILE EXTRACT^^0
"BLD",9010,"KRN",19,"NM",4,0)
SCMC TEAM POSITION EXTRACT^^0
"BLD",9010,"KRN",19,"NM",5,0)
SCMC TEAM POS HISTORY EXTRACT^^0
"BLD",9010,"KRN",19,"NM",6,0)
SCMC PAT TEAM ASSIGN EXTRACT^^0
"BLD",9010,"KRN",19,"NM",7,0)
SCMC PAT TEAM POS ASGN EXTRACT^^0
"BLD",9010,"KRN",19,"NM",8,0)
SCMC POSITION ASSIGN EXTRACT^^0
"BLD",9010,"KRN",19,"NM",9,0)
SCMC PRECEPTOR ASSIGN EXTRACT^^0
"BLD",9010,"KRN",19,"NM","B","SCMC PAT TEAM ASSIGN EXTRACT",6)

"BLD",9010,"KRN",19,"NM","B","SCMC PAT TEAM POS ASGN EXTRACT",7)

"BLD",9010,"KRN",19,"NM","B","SCMC PCMM EXTRACT ROUTINES",1)

"BLD",9010,"KRN",19,"NM","B","SCMC POSITION ASSIGN EXTRACT",8)

"BLD",9010,"KRN",19,"NM","B","SCMC PRECEPTOR ASSIGN EXTRACT",9)

"BLD",9010,"KRN",19,"NM","B","SCMC TEAM FILE EXTRACT",2)

"BLD",9010,"KRN",19,"NM","B","SCMC TEAM HISTORY FILE EXTRACT",3)

"BLD",9010,"KRN",19,"NM","B","SCMC TEAM POS HISTORY EXTRACT",5)

"BLD",9010,"KRN",19,"NM","B","SCMC TEAM POSITION EXTRACT",4)

"BLD",9010,"KRN",19.1,0)
19.1
"BLD",9010,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",9010,"KRN",19.1,"NM",1,0)
PCMM DATA EXTRACTS^^0
"BLD",9010,"KRN",19.1,"NM","B","PCMM DATA EXTRACTS",1)

"BLD",9010,"KRN",101,0)
101
"BLD",9010,"KRN",409.61,0)
409.61
"BLD",9010,"KRN",771,0)
771
"BLD",9010,"KRN",779.2,0)
779.2
"BLD",9010,"KRN",870,0)
870
"BLD",9010,"KRN",8989.51,0)
8989.51
"BLD",9010,"KRN",8989.52,0)
8989.52
"BLD",9010,"KRN",8994,0)
8994
"BLD",9010,"KRN","B",.4,.4)

"BLD",9010,"KRN","B",.401,.401)

"BLD",9010,"KRN","B",.402,.402)

"BLD",9010,"KRN","B",.403,.403)

"BLD",9010,"KRN","B",.5,.5)

"BLD",9010,"KRN","B",.84,.84)

"BLD",9010,"KRN","B",3.6,3.6)

"BLD",9010,"KRN","B",3.8,3.8)

"BLD",9010,"KRN","B",9.2,9.2)

"BLD",9010,"KRN","B",9.8,9.8)

"BLD",9010,"KRN","B",19,19)

"BLD",9010,"KRN","B",19.1,19.1)

"BLD",9010,"KRN","B",101,101)

"BLD",9010,"KRN","B",409.61,409.61)

"BLD",9010,"KRN","B",771,771)

"BLD",9010,"KRN","B",779.2,779.2)

"BLD",9010,"KRN","B",870,870)

"BLD",9010,"KRN","B",8989.51,8989.51)

"BLD",9010,"KRN","B",8989.52,8989.52)

"BLD",9010,"KRN","B",8994,8994)

"BLD",9010,"QUES",0)
^9.62^^
"BLD",9010,"REQB",0)
^9.611^^
"KRN",19,11459,-1)
0^1
"KRN",19,11459,0)
SCMC PCMM EXTRACT ROUTINES^SCMC PCMM Extract Routines^^M^^PCMM DATA EXTRACTS^^^^^^SCHEDULING
"KRN",19,11459,1,0)
^19.06^14^14^3140520^^^^
"KRN",19,11459,1,1,0)
The PCMM Extract routines create a flat file that can be loaded into the 
"KRN",19,11459,1,2,0)
PCMMR data migration database to compare legacy PCMM data against PCMMR 
"KRN",19,11459,1,3,0)
data before the data migration.
"KRN",19,11459,1,4,0)
 
"KRN",19,11459,1,5,0)
Available extract routines:
"KRN",19,11459,1,6,0)
 
"KRN",19,11459,1,7,0)
TEAM Extract
"KRN",19,11459,1,8,0)
TEAM HISTORY Extract
"KRN",19,11459,1,9,0)
TEAM POSITION Extract
"KRN",19,11459,1,10,0)
TEAM POSITION HISTORY Extract
"KRN",19,11459,1,11,0)
PATIENT TEAM ASSIGNMENT Extract
"KRN",19,11459,1,12,0)
PATIENT TEAM POSITION ASSIGNMENT Extract
"KRN",19,11459,1,13,0)
POSITION ASSIGNMENT HISTORY Extract
"KRN",19,11459,1,14,0)
PRECEPTOR ASSIGNMENT HISTORY Extract
"KRN",19,11459,10,0)
^19.01IP^8^8
"KRN",19,11459,10,1,0)
11468^^1
"KRN",19,11459,10,1,"^")
SCMC TEAM FILE EXTRACT
"KRN",19,11459,10,2,0)
11461^^2
"KRN",19,11459,10,2,"^")
SCMC TEAM HISTORY FILE EXTRACT
"KRN",19,11459,10,3,0)
11462^^3
"KRN",19,11459,10,3,"^")
SCMC TEAM POSITION EXTRACT
"KRN",19,11459,10,4,0)
11469^^4
"KRN",19,11459,10,4,"^")
SCMC TEAM POS HISTORY EXTRACT
"KRN",19,11459,10,5,0)
11466^^5
"KRN",19,11459,10,5,"^")
SCMC PAT TEAM ASSIGN EXTRACT
"KRN",19,11459,10,6,0)
11467^^6
"KRN",19,11459,10,6,"^")
SCMC PAT TEAM POS ASGN EXTRACT
"KRN",19,11459,10,7,0)
11465^^7
"KRN",19,11459,10,7,"^")
SCMC POSITION ASSIGN EXTRACT
"KRN",19,11459,10,8,0)
11464^^8
"KRN",19,11459,10,8,"^")
SCMC PRECEPTOR ASSIGN EXTRACT
"KRN",19,11459,99)
63344,42856
"KRN",19,11459,"U")
SCMC PCMM EXTRACT ROUTINES
"KRN",19,11461,-1)
0^3
"KRN",19,11461,0)
SCMC TEAM HISTORY FILE EXTRACT^Team History File Extract^^R^^PCMM DATA EXTRACTS^^^^^^SCHEDULING
"KRN",19,11461,1,0)
^19.06^2^2^3140520^^
"KRN",19,11461,1,1,0)
This option creates a Vista Team History file data extract for the
"KRN",19,11461,1,2,0)
purpose of data validation against PCMMR.
"KRN",19,11461,25)
ENTER^SCRPTHST
"KRN",19,11461,"U")
TEAM HISTORY FILE EXTRACT
"KRN",19,11462,-1)
0^4
"KRN",19,11462,0)
SCMC TEAM POSITION EXTRACT^Team Position File Extract^^R^^PCMM DATA EXTRACTS^^^^^^SCHEDULING
"KRN",19,11462,1,0)
^19.06^2^2^3140520^^
"KRN",19,11462,1,1,0)
This option creates a Vista Team Position file data extract for the 
"KRN",19,11462,1,2,0)
purpose of data validation against PCMMR.
"KRN",19,11462,25)
ENTER^SCRPTPOS
"KRN",19,11462,"U")
TEAM POSITION FILE EXTRACT
"KRN",19,11464,-1)
0^9
"KRN",19,11464,0)
SCMC PRECEPTOR ASSIGN EXTRACT^Preceptor Assignment History Extract^^R^^PCMM DATA EXTRACTS^^^^^^SCHEDULING
"KRN",19,11464,1,0)
^^2^2^3140520^
"KRN",19,11464,1,1,0)
This option creates a Vista Preceptor Assignment History file data extract
"KRN",19,11464,1,2,0)
for the purpose of data validation against PCMMR.
"KRN",19,11464,25)
ENTER^SCRPPRAH
"KRN",19,11464,"U")
PRECEPTOR ASSIGNMENT HISTORY E
"KRN",19,11465,-1)
0^8
"KRN",19,11465,0)
SCMC POSITION ASSIGN EXTRACT^Position Assignment History Extract^^R^^PCMM DATA EXTRACTS^^^^^^SCHEDULING
"KRN",19,11465,1,0)
^^2^2^3140520^
"KRN",19,11465,1,1,0)
This option creates a Vista Position Assignment History file data extract
"KRN",19,11465,1,2,0)
for the purpose of data validation against PCMMR.
"KRN",19,11465,25)
ENTER^SCRPPAHS
"KRN",19,11465,"U")
POSITION ASSIGNMENT HISTORY EX
"KRN",19,11466,-1)
0^6
"KRN",19,11466,0)
SCMC PAT TEAM ASSIGN EXTRACT^Patient Team Assignment Extract^^R^^PCMM DATA EXTRACTS^^^^^^SCHEDULING
"KRN",19,11466,1,0)
^^2^2^3140520^
"KRN",19,11466,1,1,0)
This option creates a Vista Patient Team Assignment file data extract for
"KRN",19,11466,1,2,0)
the purpose of data validation against PCMMR.
"KRN",19,11466,25)
ENTER^SCRPPTA
"KRN",19,11466,"U")
PATIENT TEAM ASSIGNMENT EXTRAC
"KRN",19,11467,-1)
0^7
"KRN",19,11467,0)
SCMC PAT TEAM POS ASGN EXTRACT^Patient Team Position Assignment Extract^^R^^PCMM DATA EXTRACTS^^^^^^SCHEDULING
"KRN",19,11467,1,0)
^^2^2^3140520^
"KRN",19,11467,1,1,0)
This option creates a Vista Patient Team Position Assignment file data 
"KRN",19,11467,1,2,0)
extract for the purpose of data validation against PCMMR.
"KRN",19,11467,25)
ENTER^SCRPPTPA
"KRN",19,11467,"U")
PATIENT TEAM POSITION ASSIGNME
"KRN",19,11468,-1)
0^2
"KRN",19,11468,0)
SCMC TEAM FILE EXTRACT^Team File Extract^^R^^PCMM DATA EXTRACTS^^^^^^SCHEDULING
"KRN",19,11468,1,0)
^^2^2^3140520^
"KRN",19,11468,1,1,0)
This option creates a Vista Team file data extract for the purpose 
"KRN",19,11468,1,2,0)
of data validation against PCMMR.
"KRN",19,11468,25)
ENTER^SCRPTEAM
"KRN",19,11468,"U")
TEAM FILE EXTRACT
"KRN",19,11469,-1)
0^5
"KRN",19,11469,0)
SCMC TEAM POS HISTORY EXTRACT^Team Position History Extract^^R^^PCMM DATA EXTRACTS^^^^^^SCHEDULING
"KRN",19,11469,1,0)
^^2^2^3140520^
"KRN",19,11469,1,1,0)
This option creates a Vista Team Position History file data extract for 
"KRN",19,11469,1,2,0)
the purpose of data validation against PCMMR.
"KRN",19,11469,25)
ENTER^SCRPTPHS
"KRN",19,11469,"U")
TEAM POSITION HISTORY EXTRACT
"KRN",19.1,569,-1)
0^1
"KRN",19.1,569,0)
PCMM DATA EXTRACTS^PCMM DATA EXTRACTS
"KRN",19.1,569,1,0)
^^2^2^3140606^
"KRN",19.1,569,1,1,0)
This security key grants access to the user who holds the key to run the 
"KRN",19.1,569,1,2,0)
SCMC PCMM EXTRACT ROUTINES option.
"MBREQ")
0
"ORD",3,19.1)
19.1;3;;;KEY^XPDTA1;KEYF1^XPDIA1;KEYE1^XPDIA1;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",48,-1)
1^1
"PKG",48,0)
SCHEDULING^SD^APPOINTMENTS,PROFILES,LETTERS,AMIS REPORTS
"PKG",48,20,0)
^9.402P^^
"PKG",48,22,0)
^9.49I^1^1
"PKG",48,22,1,0)
5.3^2930813^2960613
"PKG",48,22,1,"PAH",1,0)
620^3140721
"PKG",48,22,1,"PAH",1,1,0)
^^3^3^3140721
"PKG",48,22,1,"PAH",1,1,1,0)
This build includes legacy PCMM data extract routines used for comparison 
"PKG",48,22,1,"PAH",1,1,2,0)
to PCMM Web for data validation. The routines have been added as options
"PKG",48,22,1,"PAH",1,1,3,0)
to the SCMC PCMM Extracts menu.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
8
"RTN","SCRPPAHS")
0^7^B22427775^n/a
"RTN","SCRPPAHS",1,0)
SCRPPAHS ;ALB/DJS - Position Assignment History Extract for PCMMR Data Validation; 04/18/14
"RTN","SCRPPAHS",2,0)
 ;;5.3;Scheduling;**620**;AUG 13, 1993;Build 11
"RTN","SCRPPAHS",3,0)
 ;
"RTN","SCRPPAHS",4,0)
ENTER ; Entry point
"RTN","SCRPPAHS",5,0)
 ; 
"RTN","SCRPPAHS",6,0)
 ; Extract file will be a delimited text file (.TXT) that will provide information for PCMM data validation
"RTN","SCRPPAHS",7,0)
 ; Delimiter is a pipe ("|") character
"RTN","SCRPPAHS",8,0)
 ;
"RTN","SCRPPAHS",9,0)
 ; FILE OUTPUT:
"RTN","SCRPPAHS",10,0)
 ;
"RTN","SCRPPAHS",11,0)
 ; STANUM - Station #
"RTN","SCRPPAHS",12,0)
 ; POSAHIEN - IEN of Position Assignment History
"RTN","SCRPPAHS",13,0)
 ; TPIEN - IEN of Team Position
"RTN","SCRPPAHS",14,0)
 ; TMPOS - Team Position
"RTN","SCRPPAHS",15,0)
 ; EFFDT - Effective Date
"RTN","SCRPPAHS",16,0)
 ; PRACTIEN - IEN of Practitioner
"RTN","SCRPPAHS",17,0)
 ; PRACTNR - Practitioner
"RTN","SCRPPAHS",18,0)
 ; STATUS - Status
"RTN","SCRPPAHS",19,0)
 ; STATRSN - Status Reason
"RTN","SCRPPAHS",20,0)
 ; FTEEEQU - FTEE Equivalent
"RTN","SCRPPAHS",21,0)
 ; DT4INACT - Date for Inactivation
"RTN","SCRPPAHS",22,0)
 ; AVAILPOS - Available Positions
"RTN","SCRPPAHS",23,0)
 ; MAXPT - Max # of Patients
"RTN","SCRPPAHS",24,0)
 ; CURACTPT - Current Active Patients
"RTN","SCRPPAHS",25,0)
 ; ADJPANEL - Adjusted Panel Size
"RTN","SCRPPAHS",26,0)
 ; AUTINACT - Inactivated Automatically
"RTN","SCRPPAHS",27,0)
 ; FTEEHST - FTEE History
"RTN","SCRPPAHS",28,0)
 ;
"RTN","SCRPPAHS",29,0)
 N SCMCPATH,SCMCHFS,SCMCERR,SCMCMODE,MSG,IOF
"RTN","SCRPPAHS",30,0)
 N SITE,SCDATA,SCIENS,STANUM,POSAHIEN,TPIEN,TMPOS,EFFDT,PRACTIEN,PRACTNR,STATUS,DATE,ENTRY,POP
"RTN","SCRPPAHS",31,0)
 N STATRSN,FTEEEQU,DT4INACT,AVAILPOS,MAXPT,CURACTPT,ADJPANEL,AUTINACT,FTEEHST,FTEEDAT,FTEEVAL
"RTN","SCRPPAHS",32,0)
 S SITE=$$SITE^VASITE,STANUM=$P(SITE,"^",3)
"RTN","SCRPPAHS",33,0)
 S SCMCPATH=$$DEFDIR^%ZISH(),SCMCHFS=STANUM_"_PCMMPOSITIONASSIGNMENTHISTORY.TXT",SCMCERR=0 U 0 W !!,SCMCPATH
"RTN","SCRPPAHS",34,0)
 D HFSOPEN("SCMCRP",SCMCPATH,SCMCHFS,"W") I SCMCERR G END
"RTN","SCRPPAHS",35,0)
 U IO
"RTN","SCRPPAHS",36,0)
 D COLHDR,SETREC G END
"RTN","SCRPPAHS",37,0)
 ;
"RTN","SCRPPAHS",38,0)
SETREC ;$O through position assignment history file
"RTN","SCRPPAHS",39,0)
 S POSAHIEN=0
"RTN","SCRPPAHS",40,0)
 F  S POSAHIEN=$O(^SCTM(404.52,POSAHIEN)) Q:POSAHIEN=""!(POSAHIEN'?.N)  D
"RTN","SCRPPAHS",41,0)
 .K SCDATA
"RTN","SCRPPAHS",42,0)
 .S SCIENS=+$G(POSAHIEN)_","
"RTN","SCRPPAHS",43,0)
 .D GETS^DIQ(404.52,SCIENS,".01;.02;.03;.04;.05;.07;.08;.09;.091;.096;.097;.098;.099;.11","IE","SCDATA","")
"RTN","SCRPPAHS",44,0)
 .S TPIEN=$G(SCDATA(404.52,SCIENS,.01,"I"))
"RTN","SCRPPAHS",45,0)
 .S TMPOS=$G(SCDATA(404.52,SCIENS,.01,"E"))
"RTN","SCRPPAHS",46,0)
 .S EFFDT=$G(SCDATA(404.52,SCIENS,.02,"E"))
"RTN","SCRPPAHS",47,0)
 .S PRACTIEN=$G(SCDATA(404.52,SCIENS,.03,"I"))
"RTN","SCRPPAHS",48,0)
 .S PRACTNR=$G(SCDATA(404.52,SCIENS,.03,"E"))
"RTN","SCRPPAHS",49,0)
 .S STATUS=$G(SCDATA(404.52,SCIENS,.04,"E"))
"RTN","SCRPPAHS",50,0)
 .S STATRSN=$G(SCDATA(404.52,SCIENS,.05,"E"))
"RTN","SCRPPAHS",51,0)
 .S FTEEEQU=$G(SCDATA(404.52,SCIENS,.09,"E"))
"RTN","SCRPPAHS",52,0)
 .S DT4INACT=$G(SCDATA(404.52,SCIENS,.091,"E"))
"RTN","SCRPPAHS",53,0)
 .S AVAILPOS=$G(SCDATA(404.52,SCIENS,.096,"E"))
"RTN","SCRPPAHS",54,0)
 .S MAXPT=$G(SCDATA(404.52,SCIENS,.097,"E"))
"RTN","SCRPPAHS",55,0)
 .S CURACTPT=$G(SCDATA(404.52,SCIENS,.098,"E"))
"RTN","SCRPPAHS",56,0)
 .S ADJPANEL=$G(SCDATA(404.52,SCIENS,.099,"E"))
"RTN","SCRPPAHS",57,0)
 .S AUTINACT=$G(SCDATA(404.52,SCIENS,.11,"I"))
"RTN","SCRPPAHS",58,0)
 .S FTEEHST=$S($D(^SCTM(404.52,POSAHIEN,1,0)):1,1:"") I FTEEHST S ENTRY=0 D
"RTN","SCRPPAHS",59,0)
 ..F  S ENTRY=$O(^SCTM(404.52,POSAHIEN,1,ENTRY)) Q:ENTRY=""!(ENTRY'?.N)  D
"RTN","SCRPPAHS",60,0)
 ...S FTEEDAT=$P(^SCTM(404.52,POSAHIEN,1,ENTRY,0),"^"),DATE=$$FMTE^XLFDT(FTEEDAT,1)
"RTN","SCRPPAHS",61,0)
 ...S FTEEVAL=$P(^SCTM(404.52,POSAHIEN,1,ENTRY,0),"^",2)
"RTN","SCRPPAHS",62,0)
 ...S WRTLN(ENTRY)="|"_DATE_"|"_FTEEVAL
"RTN","SCRPPAHS",63,0)
 ...Q
"RTN","SCRPPAHS",64,0)
 .W STANUM_"|"_POSAHIEN_"|"_TPIEN_"|"_TMPOS_"|"_EFFDT_"|"_PRACTIEN_"|"_PRACTNR_"|"_STATUS_"|"_STATRSN_"|"_FTEEEQU_"|"_DT4INACT_"|"_AVAILPOS_"|"_MAXPT_"|"_CURACTPT_"|"_ADJPANEL_"|"_AUTINACT I 'FTEEHST W !
"RTN","SCRPPAHS",65,0)
 .I FTEEHST F I=1:1 Q:'$D(WRTLN(I))  D
"RTN","SCRPPAHS",66,0)
 ..W:I>1 STANUM_"|||||||||||||||" W WRTLN(I),!
"RTN","SCRPPAHS",67,0)
 .K FTEEHST,WRTLN,I
"RTN","SCRPPAHS",68,0)
 .Q
"RTN","SCRPPAHS",69,0)
 Q
"RTN","SCRPPAHS",70,0)
 ;
"RTN","SCRPPAHS",71,0)
COLHDR ;Create column header for Position Assignment History extract file
"RTN","SCRPPAHS",72,0)
 W "Station #|Pos. Assign. History IEN|Team Position IEN|Team Position|Effective Date|Practitioner IEN|Practitioner|Status|Status Reason|FTEE Equivalent|Date Flagged for Inactivation|"
"RTN","SCRPPAHS",73,0)
 W "Available Positions|Max # of Patients|Current Active Patients|Adjusted Panel Size|Inactivated Automatically|FTEE Date|FTEE Value",!
"RTN","SCRPPAHS",74,0)
 Q
"RTN","SCRPPAHS",75,0)
 ;
"RTN","SCRPPAHS",76,0)
END D HFSCLOSE("SCMCRP",SCMCHFS)
"RTN","SCRPPAHS",77,0)
 I '+SCMCERR D  Q  ;Create pipe delimited output if no errors
"RTN","SCRPPAHS",78,0)
 .S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPPAHS",79,0)
 ;Replace "##FFFF##" with Form Feeds - code needed for LINUX environments
"RTN","SCRPPAHS",80,0)
 S I=0 F  S I=$O(^TMP("SCMC",$J,1,I)) Q:'I  D
"RTN","SCRPPAHS",81,0)
 .S:^TMP("SCMC",$J,1,I)["##FFFF##" ^TMP("SCMC",$J,1,I)=$P(^TMP("SCMC",$J,1,I),"##FFFF##")_$C(13,12)_$P(^TMP("SCMC",$J,1,I),"##FFFF##",2)
"RTN","SCRPPAHS",82,0)
 .S ^TMP("SCMC",$J,1,I)=^TMP("SCMC",$J,1,I)_$C(13)
"RTN","SCRPPAHS",83,0)
 .S:^TMP("SCMC",$J,1,I)["$END" ^TMP("SCMC",$J,1,I)=""
"RTN","SCRPPAHS",84,0)
 S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPPAHS",85,0)
 Q
"RTN","SCRPPAHS",86,0)
 ;
"RTN","SCRPPAHS",87,0)
HFSOPEN(HANDLE,SCMCPATH,SCMCHFS,SCMCMODE) ; Open File
"RTN","SCRPPAHS",88,0)
 D OPEN^%ZISH(HANDLE,SCMCPATH,SCMCHFS,$G(SCMCMODE,"W")) D:POP  Q:POP
"RTN","SCRPPAHS",89,0)
 .S SCMCERR=1,^TMP("SCMC",$J,1)="0^Unable to open file "
"RTN","SCRPPAHS",90,0)
 S IOF="$$IOF^SCRPPAHS"   ;resets screen position and adds page break flag - added to deal with Linux environments.
"RTN","SCRPPAHS",91,0)
 Q
"RTN","SCRPPAHS",92,0)
 ;
"RTN","SCRPPAHS",93,0)
HFSCLOSE(HANDLE,SCMHFS) ;Close HFS and unload data
"RTN","SCRPPAHS",94,0)
 D CLOSE^%ZISH(HANDLE)
"RTN","SCRPPAHS",95,0)
 Q
"RTN","SCRPPAHS",96,0)
 ;
"RTN","SCRPPAHS",97,0)
IOF() ;used to reset position and insert page break flag when @IOF is executed.
"RTN","SCRPPAHS",98,0)
 S $X=0,$Y=0
"RTN","SCRPPAHS",99,0)
 Q "##FFFF##"_$C(13,10)
"RTN","SCRPPAHS",100,0)
 ;
"RTN","SCRPPRAH")
0^8^B13384637^n/a
"RTN","SCRPPRAH",1,0)
SCRPPRAH ;ALB/DJS - Preceptor Assignment History Extract for PCMMR Data Validation; 04/18/14
"RTN","SCRPPRAH",2,0)
 ;;5.3;Scheduling;**620**;AUG 13, 1993;Build 11
"RTN","SCRPPRAH",3,0)
 ;
"RTN","SCRPPRAH",4,0)
ENTER ; Entry point
"RTN","SCRPPRAH",5,0)
 ; 
"RTN","SCRPPRAH",6,0)
 ; Extract file will be a delimited text file (.TXT) that will provide information for PCMM data validation
"RTN","SCRPPRAH",7,0)
 ; Delimiter is a pipe ("|") character
"RTN","SCRPPRAH",8,0)
 ;
"RTN","SCRPPRAH",9,0)
 ; FILE OUTPUT:
"RTN","SCRPPRAH",10,0)
 ;
"RTN","SCRPPRAH",11,0)
 ; STANUM - Station #
"RTN","SCRPPRAH",12,0)
 ; PREAHIEN - IEN of Preceptor Assignment History
"RTN","SCRPPRAH",13,0)
 ; TPIEN - IEN of Team Position
"RTN","SCRPPRAH",14,0)
 ; TMPOS - Team Position
"RTN","SCRPPRAH",15,0)
 ; EFFDT - Effective Date
"RTN","SCRPPRAH",16,0)
 ; STATUS - Status
"RTN","SCRPPRAH",17,0)
 ; STATRSN - Status Reason
"RTN","SCRPPRAH",18,0)
 ; PRCTPIEN - IEN of Preceptor Team Position
"RTN","SCRPPRAH",19,0)
 ; PRETMPOS - Preceptor Team Position
"RTN","SCRPPRAH",20,0)
 ; DATEENT - Date/Time Entered
"RTN","SCRPPRAH",21,0)
 ; PRECPTNM - Preceptor Name
"RTN","SCRPPRAH",22,0)
 ;
"RTN","SCRPPRAH",23,0)
 N SCMCPATH,SCMCHFS,SCMCERR,SCMCMODE,MSG,IOF
"RTN","SCRPPRAH",24,0)
 N SCDATA,SCIENS,STANUM,PREAHIEN,TPIEN,TMPOS,EFFDT,STATUS,STATRSN,PRCTPIEN,PRETMPOS,DATEENT,PRECPTNM,SITE
"RTN","SCRPPRAH",25,0)
 S SITE=$$SITE^VASITE,STANUM=$P(SITE,"^",3)
"RTN","SCRPPRAH",26,0)
 S SCMCPATH=$$DEFDIR^%ZISH(),SCMCHFS=STANUM_"_PCMMPRECEPTORASSIGNMENTHISTORY.TXT",SCMCERR=0 U 0 W !!,SCMCPATH
"RTN","SCRPPRAH",27,0)
 D HFSOPEN("SCMCRP",SCMCPATH,SCMCHFS,"W") I SCMCERR G END
"RTN","SCRPPRAH",28,0)
 U IO
"RTN","SCRPPRAH",29,0)
 D COLHDR,SETREC G END
"RTN","SCRPPRAH",30,0)
 ;
"RTN","SCRPPRAH",31,0)
SETREC  ;$O through preceptor assignment history file
"RTN","SCRPPRAH",32,0)
    S PREAHIEN=0
"RTN","SCRPPRAH",33,0)
 F  S PREAHIEN=$O(^SCTM(404.53,PREAHIEN)) Q:PREAHIEN=""!(PREAHIEN'?.N)  D
"RTN","SCRPPRAH",34,0)
 .K SCDATA
"RTN","SCRPPRAH",35,0)
 .S SCIENS=+$G(PREAHIEN)_","
"RTN","SCRPPRAH",36,0)
 .D GETS^DIQ(404.53,SCIENS,".01;.02;.04;.05;.06;.07;.08;200","IE","SCDATA","")
"RTN","SCRPPRAH",37,0)
 .S TPIEN=$G(SCDATA(404.53,SCIENS,.01,"I"))
"RTN","SCRPPRAH",38,0)
 .S TMPOS=$G(SCDATA(404.53,SCIENS,.01,"E"))
"RTN","SCRPPRAH",39,0)
 .S EFFDT=$G(SCDATA(404.53,SCIENS,.02,"E"))
"RTN","SCRPPRAH",40,0)
 .S STATUS=$G(SCDATA(404.53,SCIENS,.04,"E"))
"RTN","SCRPPRAH",41,0)
 .S STATRSN=$G(SCDATA(404.53,SCIENS,.05,"E"))
"RTN","SCRPPRAH",42,0)
 .S PRCTPIEN=$G(SCDATA(404.53,SCIENS,.06,"I"))
"RTN","SCRPPRAH",43,0)
 .S PRETMPOS=$G(SCDATA(404.53,SCIENS,.06,"E"))
"RTN","SCRPPRAH",44,0)
 .S DATEENT=$G(SCDATA(404.53,SCIENS,.08,"E"))
"RTN","SCRPPRAH",45,0)
 .S PRECPTNM=$G(SCDATA(404.53,SCIENS,200,"E"))
"RTN","SCRPPRAH",46,0)
 .W STANUM_"|"_PREAHIEN_"|"_TPIEN_"|"_TMPOS_"|"_EFFDT_"|"_STATUS_"|"_STATRSN_"|"_PRCTPIEN_"|"_PRETMPOS_"|"_DATEENT_"|"_PRECPTNM,!
"RTN","SCRPPRAH",47,0)
 Q
"RTN","SCRPPRAH",48,0)
 ;
"RTN","SCRPPRAH",49,0)
COLHDR ;Create column header for Preceptor Assignment History extract file
"RTN","SCRPPRAH",50,0)
 W "Station #|Prec. Assign. Hist. IEN|Team Position IEN|Team Position|Effective Date|Status|Status Reason|Preceptor Team Position IEN|Preceptor Team Position|Date Entered|Preceptor Name",!
"RTN","SCRPPRAH",51,0)
 Q
"RTN","SCRPPRAH",52,0)
 ;
"RTN","SCRPPRAH",53,0)
END D HFSCLOSE("SCMCRP",SCMCHFS)
"RTN","SCRPPRAH",54,0)
 N I
"RTN","SCRPPRAH",55,0)
 I '+SCMCERR D  Q  ;Create pipe delimited output if no errors
"RTN","SCRPPRAH",56,0)
 .S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPPRAH",57,0)
 ;Replace "##FFFF##" with Form Feeds - code needed for LINUX environments
"RTN","SCRPPRAH",58,0)
 S I=0 F  S I=$O(^TMP("SCMC",$J,1,I)) Q:'I  D
"RTN","SCRPPRAH",59,0)
 .S:^TMP("SCMC",$J,1,I)["##FFFF##" ^TMP("SCMC",$J,1,I)=$P(^TMP("SCMC",$J,1,I),"##FFFF##")_$C(13,12)_$P(^TMP("SCMC",$J,1,I),"##FFFF##",2)
"RTN","SCRPPRAH",60,0)
 .S ^TMP("SCMC",$J,1,I)=^TMP("SCMC",$J,1,I)_$C(13)
"RTN","SCRPPRAH",61,0)
 .S:^TMP("SCMC",$J,1,I)["$END" ^TMP("SCMC",$J,1,I)=""
"RTN","SCRPPRAH",62,0)
 S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPPRAH",63,0)
 Q
"RTN","SCRPPRAH",64,0)
 ;
"RTN","SCRPPRAH",65,0)
HFSOPEN(HANDLE,SCMCPATH,SCMCHFS,SCMCMODE) ; Open File
"RTN","SCRPPRAH",66,0)
 N POP
"RTN","SCRPPRAH",67,0)
 D OPEN^%ZISH(HANDLE,SCMCPATH,SCMCHFS,$G(SCMCMODE,"W")) D:POP  Q:POP
"RTN","SCRPPRAH",68,0)
 .S SCMCERR=1,^TMP("SCMC",$J,1)="0^Unable to open file "
"RTN","SCRPPRAH",69,0)
 S IOF="$$IOF^SCRPPRAH"   ;resets screen position and adds page break flag - added to deal with Linux environments.
"RTN","SCRPPRAH",70,0)
 Q
"RTN","SCRPPRAH",71,0)
 ;
"RTN","SCRPPRAH",72,0)
HFSCLOSE(HANDLE,SCMHFS) ;Close HFS and unload data
"RTN","SCRPPRAH",73,0)
 D CLOSE^%ZISH(HANDLE)
"RTN","SCRPPRAH",74,0)
 Q
"RTN","SCRPPRAH",75,0)
 ;
"RTN","SCRPPRAH",76,0)
IOF() ;used to reset position and insert page break flag when @IOF is executed.
"RTN","SCRPPRAH",77,0)
 S $X=0,$Y=0
"RTN","SCRPPRAH",78,0)
 Q "##FFFF##"_$C(13,10)
"RTN","SCRPPRAH",79,0)
 ;
"RTN","SCRPPTA")
0^5^B18005623^n/a
"RTN","SCRPPTA",1,0)
SCRPPTA ;ALB/DJS - Patient Team Assignment Extract for PCMMR Data Validation; 04/03/14
"RTN","SCRPPTA",2,0)
 ;;5.3;Scheduling;**620**;AUG 13, 1993;Build 11
"RTN","SCRPPTA",3,0)
 ;
"RTN","SCRPPTA",4,0)
ENTER ; Entry point
"RTN","SCRPPTA",5,0)
 ; 
"RTN","SCRPPTA",6,0)
 ; Extract file will be a delimited text file (.TXT) that will provide information for PCMM data validation
"RTN","SCRPPTA",7,0)
 ; Delimiter is a pipe ("|") character
"RTN","SCRPPTA",8,0)
 ;
"RTN","SCRPPTA",9,0)
 ; FILE OUTPUT:
"RTN","SCRPPTA",10,0)
 ;
"RTN","SCRPPTA",11,0)
 ; STANUM - Station #
"RTN","SCRPPTA",12,0)
 ; PTAIEN - IEN of Patient Team Assigment
"RTN","SCRPPTA",13,0)
 ; PTIEN - IEN of Patient
"RTN","SCRPPTA",14,0)
 ; PTNAME - Patient Name
"RTN","SCRPPTA",15,0)
 ; PTDOB - Patient Date of Birth
"RTN","SCRPPTA",16,0)
 ; PTSSN - Patient SSN
"RTN","SCRPPTA",17,0)
 ; PTDOD - Patient Date of Death
"RTN","SCRPPTA",18,0)
 ; PTICN - Patient ICN
"RTN","SCRPPTA",19,0)
 ; ICNCHKSM - ICN Checksum
"RTN","SCRPPTA",20,0)
 ; LOCALICN - Locally Assigned ICN
"RTN","SCRPPTA",21,0)
 ; TMASGDT - Team Assigned Date
"RTN","SCRPPTA",22,0)
 ; TIEN - IEN of Team
"RTN","SCRPPTA",23,0)
 ; TANAME - Team  Assignment Name
"RTN","SCRPPTA",24,0)
 ; ASGNTYPE - IEN of Assignment Type
"RTN","SCRPPTA",25,0)
 ; DISCHDT - Team Discharge Date
"RTN","SCRPPTA",26,0)
 ; STATUS - Status
"RTN","SCRPPTA",27,0)
 ;
"RTN","SCRPPTA",28,0)
 N SCMCPATH,SCMCHFS,SCMCERR,SCMCMODE,MSG,IOF,SITE
"RTN","SCRPPTA",29,0)
 N SCDATA,SCIENS,PTDATA,PTIENS,STANUM,PTAIEN,PTIEN,PTNAME,PTDOB,PTSSN
"RTN","SCRPPTA",30,0)
 N PTDOD,PTICN,ICNCHKSM,LOCALICN,TMASGDT,TIEN,TANAME,ASGNTYPE,DISCHDT,STATUS
"RTN","SCRPPTA",31,0)
 S SITE=$$SITE^VASITE,STANUM=$P(SITE,"^",3)
"RTN","SCRPPTA",32,0)
 S SCMCPATH=$$DEFDIR^%ZISH(),SCMCHFS=STANUM_"_PCMMPATIENTTEAMASSIGNMENT.TXT",SCMCERR=0 U 0 W !!,SCMCPATH
"RTN","SCRPPTA",33,0)
 D HFSOPEN("SCMCRP",SCMCPATH,SCMCHFS,"W") I SCMCERR G END
"RTN","SCRPPTA",34,0)
 U IO
"RTN","SCRPPTA",35,0)
 D COLHDR,SETREC G END
"RTN","SCRPPTA",36,0)
 ;
"RTN","SCRPPTA",37,0)
SETREC  ;$O through the patient team assignment file
"RTN","SCRPPTA",38,0)
 S PTAIEN=0
"RTN","SCRPPTA",39,0)
 F  S PTAIEN=$O(^SCPT(404.42,PTAIEN)) Q:PTAIEN=""!(PTAIEN'?.N)  D
"RTN","SCRPPTA",40,0)
 .K SCDATA,PTDATA
"RTN","SCRPPTA",41,0)
 .S SCIENS=+$G(PTAIEN)_","
"RTN","SCRPPTA",42,0)
 .D GETS^DIQ(404.42,SCIENS,".01;.02;.03;.08;.09;.12;.14;.15","IE","SCDATA","")
"RTN","SCRPPTA",43,0)
 .S PTIEN=$G(SCDATA(404.42,SCIENS,.01,"I")) Q:PTIEN=""
"RTN","SCRPPTA",44,0)
 .S PTNAME=$G(SCDATA(404.42,SCIENS,.01,"E"))
"RTN","SCRPPTA",45,0)
 .S TMASGDT=$$FMTE^XLFDT($G(SCDATA(404.42,SCIENS,.02,"I"),"5D"))
"RTN","SCRPPTA",46,0)
 .S TIEN=$G(SCDATA(404.42,SCIENS,.03,"I"))
"RTN","SCRPPTA",47,0)
 .S TANAME=$G(SCDATA(404.42,SCIENS,.03,"E"))
"RTN","SCRPPTA",48,0)
 .S ASGNTYPE=$G(SCDATA(404.42,SCIENS,.08,"I"))
"RTN","SCRPPTA",49,0)
 .S DISCHDT=$$FMTE^XLFDT($G(SCDATA(404.42,SCIENS,.09,"I"),"5D"))
"RTN","SCRPPTA",50,0)
 .S STATUS=$G(SCDATA(404.42,SCIENS,.15,"E"))
"RTN","SCRPPTA",51,0)
 .S PTIENS=+$G(PTIEN)_","
"RTN","SCRPPTA",52,0)
 .D GETS^DIQ(2,PTIENS,".03;.09;.351;991.01;991.02;991.04","IE","PTDATA")
"RTN","SCRPPTA",53,0)
 .S PTDOB=$G(PTDATA(2,PTIENS,.03,"E"))
"RTN","SCRPPTA",54,0)
 .S PTSSN=$G(PTDATA(2,PTIENS,.09,"E"))
"RTN","SCRPPTA",55,0)
 .S PTDOD=$$FMTE^XLFDT($G(PTDATA(2,PTIENS,.351,"I"),"5D"))
"RTN","SCRPPTA",56,0)
 .S PTICN=$G(PTDATA(2,PTIENS,991.01,"E"))
"RTN","SCRPPTA",57,0)
 .S ICNCHKSM=$G(PTDATA(2,PTIENS,991.02,"E"))
"RTN","SCRPPTA",58,0)
 .S LOCALICN=$G(PTDATA(2,PTIENS,991.04,"E"))
"RTN","SCRPPTA",59,0)
 .W STANUM_"|"_PTAIEN_"|"_PTIEN_"|"_PTNAME_"|"_PTDOB_"|"_PTSSN_"|"_PTDOD_"|"_PTICN_"|"_ICNCHKSM_"|"_LOCALICN_"|"_TMASGDT_"|"_TIEN_"|"_TANAME_"|"_ASGNTYPE_"|"_DISCHDT_"|"_STATUS,!
"RTN","SCRPPTA",60,0)
 Q
"RTN","SCRPPTA",61,0)
 ;
"RTN","SCRPPTA",62,0)
COLHDR ;Create column header for Patient Team Assignment extract file
"RTN","SCRPPTA",63,0)
 W "Station #|Pt. Team Assign IEN|Patient IEN|Patient Name|Date of Birth|SSN|Date of Death|ICN|ICN Checksum|Locally Assigned ICN|Team Assigned Date|Team IEN|Team Assignment|Assignment Type|Team Discharge Date|Status",!
"RTN","SCRPPTA",64,0)
 Q
"RTN","SCRPPTA",65,0)
 ;
"RTN","SCRPPTA",66,0)
END D HFSCLOSE("SCMCRP",SCMCHFS)
"RTN","SCRPPTA",67,0)
 N I
"RTN","SCRPPTA",68,0)
 I '+SCMCERR D  Q  ;Create pipe delimited output if no errors
"RTN","SCRPPTA",69,0)
 .S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPPTA",70,0)
 ;Replace "##FFFF##" with Form Feeds - code needed for LINUX environments
"RTN","SCRPPTA",71,0)
 S I=0 F  S I=$O(^TMP("SCMC",$J,1,I)) Q:'I  D
"RTN","SCRPPTA",72,0)
 .S:^TMP("SCMC",$J,1,I)["##FFFF##" ^TMP("SCMC",$J,1,I)=$P(^TMP("SCMC",$J,1,I),"##FFFF##")_$C(13,12)_$P(^TMP("SCMC",$J,1,I),"##FFFF##",2)
"RTN","SCRPPTA",73,0)
 .S ^TMP("SCMC",$J,1,I)=^TMP("SCMC",$J,1,I)_$C(13)
"RTN","SCRPPTA",74,0)
 .S:^TMP("SCMC",$J,1,I)["$END" ^TMP("SCMC",$J,1,I)=""
"RTN","SCRPPTA",75,0)
 S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPPTA",76,0)
 Q
"RTN","SCRPPTA",77,0)
 ;
"RTN","SCRPPTA",78,0)
HFSOPEN(HANDLE,SCMCPATH,SCMCHFS,SCMCMODE) ; Open File
"RTN","SCRPPTA",79,0)
 N POP
"RTN","SCRPPTA",80,0)
 D OPEN^%ZISH(HANDLE,SCMCPATH,SCMCHFS,$G(SCMCMODE,"W")) D:POP  Q:POP
"RTN","SCRPPTA",81,0)
 .S SCMCERR=1,^TMP("SCMC",$J,1)="0^Unable to open file "
"RTN","SCRPPTA",82,0)
 S IOF="$$IOF^SCRPPTA"   ;resets screen position and adds page break flag - added to deal with Linux environments.
"RTN","SCRPPTA",83,0)
 Q
"RTN","SCRPPTA",84,0)
 ;
"RTN","SCRPPTA",85,0)
HFSCLOSE(HANDLE,SCMHFS) ;Close HFS and unload data
"RTN","SCRPPTA",86,0)
 D CLOSE^%ZISH(HANDLE)
"RTN","SCRPPTA",87,0)
 Q
"RTN","SCRPPTA",88,0)
 ;
"RTN","SCRPPTA",89,0)
IOF() ;used to reset position and insert page break flag when @IOF is executed.
"RTN","SCRPPTA",90,0)
 S $X=0,$Y=0
"RTN","SCRPPTA",91,0)
 Q "##FFFF##"_$C(13,10)
"RTN","SCRPPTA",92,0)
 ;
"RTN","SCRPPTPA")
0^6^B20107233^n/a
"RTN","SCRPPTPA",1,0)
SCRPPTPA ;ALB/DJS - Patient Team Position Assignment Extract for PCMMR Data Validation; 04/11/14
"RTN","SCRPPTPA",2,0)
 ;;5.3;Scheduling;**620**;AUG 13, 1993;Build 11
"RTN","SCRPPTPA",3,0)
 ;
"RTN","SCRPPTPA",4,0)
ENTER ; Entry point
"RTN","SCRPPTPA",5,0)
 ; 
"RTN","SCRPPTPA",6,0)
 ; Extract file will be a delimited text file (.TXT) that will provide information for PCMM data validation
"RTN","SCRPPTPA",7,0)
 ; Delimiter is a pipe ("|") character
"RTN","SCRPPTPA",8,0)
 ;
"RTN","SCRPPTPA",9,0)
 ; FILE OUTPUT:
"RTN","SCRPPTPA",10,0)
 ;
"RTN","SCRPPTPA",11,0)
 ; STANUM - Station #
"RTN","SCRPPTPA",12,0)
 ; PTPAIEN - IEN of Patient Team Position Assignment
"RTN","SCRPPTPA",13,0)
 ; PTASGIEN - IEN of Patient Team Assignment
"RTN","SCRPPTPA",14,0)
 ; PTASGN - Patient Team Assignment
"RTN","SCRPPTPA",15,0)
 ; TMPOSIEN - IEN of Team Position
"RTN","SCRPPTPA",16,0)
 ; TMPOS - Team Position
"RTN","SCRPPTPA",17,0)
 ; POSASDT - Position Assigned Date
"RTN","SCRPPTPA",18,0)
 ; POUNADT - Position Unassigned Date
"RTN","SCRPPTPA",19,0)
 ; PCROLE - PC Role
"RTN","SCRPPTPA",20,0)
 ; STATUS - Status
"RTN","SCRPPTPA",21,0)
 ; EXTAUINA - Extend Automatic Inactivation
"RTN","SCRPPTPA",22,0)
 ; EXTCMMNT - Extension Comment
"RTN","SCRPPTPA",23,0)
 ; DT4INACT - Date Flagged for Inactivation
"RTN","SCRPPTPA",24,0)
 ; SCHINADT - Scheduled Inactivation Date
"RTN","SCRPPTPA",25,0)
 ; EXTBYIEN - IEN of Extended By value (ptr. to New Person file #200)
"RTN","SCRPPTPA",26,0)
 ; EXTENDBY - Extended By
"RTN","SCRPPTPA",27,0)
 ; DTDISINA - Date Disinactivated
"RTN","SCRPPTPA",28,0)
 ;
"RTN","SCRPPTPA",29,0)
 N SCMCPATH,SCMCHFS,SCMCERR,SCMCMODE,MSG,IOF,SITE
"RTN","SCRPPTPA",30,0)
 N SCDATA,SCIENS,STANUM,PTPAIEN,PTASGIEN,PTASGN,TMPOSIEN,TMPOS,POSASDT,POUNADT
"RTN","SCRPPTPA",31,0)
 N PCROLE,STATUS,EXTAUINA,EXTCMMNT,DT4INACT,SCHINADT,EXTBYIEN,EXTENDBY,DTDISINA
"RTN","SCRPPTPA",32,0)
 S SITE=$$SITE^VASITE,STANUM=$P(SITE,"^",3)
"RTN","SCRPPTPA",33,0)
 S SCMCPATH=$$DEFDIR^%ZISH(),SCMCHFS=STANUM_"_PCMMPATIENTTEAMPOSITIONASSIGNMENT.TXT",SCMCERR=0 U 0 W !!,SCMCPATH
"RTN","SCRPPTPA",34,0)
 D HFSOPEN("SCMCRP",SCMCPATH,SCMCHFS,"W") I SCMCERR G END
"RTN","SCRPPTPA",35,0)
 U IO
"RTN","SCRPPTPA",36,0)
 D COLHDR,SETREC G END
"RTN","SCRPPTPA",37,0)
 ;
"RTN","SCRPPTPA",38,0)
SETREC  ;$O through patient team position assignment file
"RTN","SCRPPTPA",39,0)
    S PTPAIEN=0
"RTN","SCRPPTPA",40,0)
 F  S PTPAIEN=$O(^SCPT(404.43,PTPAIEN)) Q:PTPAIEN=""!(PTPAIEN'?.N)  D
"RTN","SCRPPTPA",41,0)
 .K SCDATA
"RTN","SCRPPTPA",42,0)
 .S SCIENS=+$G(PTPAIEN)_","
"RTN","SCRPPTPA",43,0)
 .D GETS^DIQ(404.43,SCIENS,".01;.02;.03;.04;.05;.12;.13;.14;.15;.159;.16;.17","IE","SCDATA","")
"RTN","SCRPPTPA",44,0)
 .S PTASGIEN=$G(SCDATA(404.43,SCIENS,.01,"I"))
"RTN","SCRPPTPA",45,0)
 .S PTASGN=$G(SCDATA(404.43,SCIENS,.01,"E"))
"RTN","SCRPPTPA",46,0)
 .S TMPOSIEN=$G(SCDATA(404.43,SCIENS,.02,"I"))
"RTN","SCRPPTPA",47,0)
 .S TMPOS=$G(SCDATA(404.43,SCIENS,.02,"E"))
"RTN","SCRPPTPA",48,0)
 .S POSASDT=$G(SCDATA(404.43,SCIENS,.03,"E"))
"RTN","SCRPPTPA",49,0)
 .S POUNADT=$G(SCDATA(404.43,SCIENS,.04,"E"))
"RTN","SCRPPTPA",50,0)
 .S PCROLE=$G(SCDATA(404.43,SCIENS,.05,"E"))
"RTN","SCRPPTPA",51,0)
 .S STATUS=$G(SCDATA(404.43,SCIENS,.12,"E"))
"RTN","SCRPPTPA",52,0)
 .S EXTAUINA=$G(SCDATA(404.43,SCIENS,.13,"E"))
"RTN","SCRPPTPA",53,0)
 .S EXTCMMNT=$G(SCDATA(404.43,SCIENS,.14,"E"))
"RTN","SCRPPTPA",54,0)
 .S DT4INACT=$G(SCDATA(404.43,SCIENS,.15,"E"))
"RTN","SCRPPTPA",55,0)
 .S SCHINADT=$G(SCDATA(404.43,SCIENS,.159,"E"))
"RTN","SCRPPTPA",56,0)
 .S EXTBYIEN=$G(SCDATA(404.43,SCIENS,.16,"I"))
"RTN","SCRPPTPA",57,0)
 .S EXTENDBY=$G(SCDATA(404.43,SCIENS,.16,"E"))
"RTN","SCRPPTPA",58,0)
 .S DTDISINA=$G(SCDATA(404.43,SCIENS,.17,"E"))
"RTN","SCRPPTPA",59,0)
 .W STANUM_"|"_PTPAIEN_"|"_PTASGIEN_"|"_PTASGN_"|"_TMPOSIEN_"|"_TMPOS_"|"_POSASDT_"|"_POUNADT_"|"_PCROLE_"|"_STATUS_"|"_EXTAUINA_"|"_EXTCMMNT_"|"_DT4INACT_"|"_SCHINADT_"|"_EXTBYIEN_"|"_EXTENDBY_"|"_DTDISINA,!
"RTN","SCRPPTPA",60,0)
 Q
"RTN","SCRPPTPA",61,0)
 ;
"RTN","SCRPPTPA",62,0)
COLHDR ;Create column header for Patient Team Position Assignment extract file
"RTN","SCRPPTPA",63,0)
 W "Station #|Pt. Team Pos. Assign. IEN|Patient Team Assignment IEN|Patient Team Assignment|Team Position IEN|Team Position|Position Assigned Date|Position Unassigned Date|PC Role|"
"RTN","SCRPPTPA",64,0)
 W "Status|Extend Automatic Inactivation|Extension Comment|Date Flagged for Inactivation|Scheduled Inactivation Date|Extended By IEN|Extended By|Date Disinactivated",!
"RTN","SCRPPTPA",65,0)
 Q
"RTN","SCRPPTPA",66,0)
 ;
"RTN","SCRPPTPA",67,0)
END D HFSCLOSE("SCMCRP",SCMCHFS)
"RTN","SCRPPTPA",68,0)
 N I
"RTN","SCRPPTPA",69,0)
 I '+SCMCERR D  Q  ;Create pipe delimited output if no errors
"RTN","SCRPPTPA",70,0)
 .S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPPTPA",71,0)
 ;Replace "##FFFF##" with Form Feeds - code needed for LINUX environments
"RTN","SCRPPTPA",72,0)
 S I=0 F  S I=$O(^TMP("SCMC",$J,1,I)) Q:'I  D
"RTN","SCRPPTPA",73,0)
 .S:^TMP("SCMC",$J,1,I)["##FFFF##" ^TMP("SCMC",$J,1,I)=$P(^TMP("SCMC",$J,1,I),"##FFFF##")_$C(13,12)_$P(^TMP("SCMC",$J,1,I),"##FFFF##",2)
"RTN","SCRPPTPA",74,0)
 .S ^TMP("SCMC",$J,1,I)=^TMP("SCMC",$J,1,I)_$C(13)
"RTN","SCRPPTPA",75,0)
 .S:^TMP("SCMC",$J,1,I)["$END" ^TMP("SCMC",$J,1,I)=""
"RTN","SCRPPTPA",76,0)
 S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPPTPA",77,0)
 Q
"RTN","SCRPPTPA",78,0)
 ;
"RTN","SCRPPTPA",79,0)
HFSOPEN(HANDLE,SCMCPATH,SCMCHFS,SCMCMODE) ; Open File
"RTN","SCRPPTPA",80,0)
 N POP
"RTN","SCRPPTPA",81,0)
 D OPEN^%ZISH(HANDLE,SCMCPATH,SCMCHFS,$G(SCMCMODE,"W")) D:POP  Q:POP
"RTN","SCRPPTPA",82,0)
 .S SCMCERR=1,^TMP("SCMC",$J,1)="0^Unable to open file "
"RTN","SCRPPTPA",83,0)
 S IOF="$$IOF^SCRPPTPA"   ;resets screen position and adds page break flag - added to deal with Linux environments.
"RTN","SCRPPTPA",84,0)
 Q
"RTN","SCRPPTPA",85,0)
 ;
"RTN","SCRPPTPA",86,0)
HFSCLOSE(HANDLE,SCMHFS) ;Close HFS and unload data
"RTN","SCRPPTPA",87,0)
 D CLOSE^%ZISH(HANDLE)
"RTN","SCRPPTPA",88,0)
 Q
"RTN","SCRPPTPA",89,0)
 ;
"RTN","SCRPPTPA",90,0)
IOF() ;used to reset position and insert page break flag when @IOF is executed.
"RTN","SCRPPTPA",91,0)
 S $X=0,$Y=0
"RTN","SCRPPTPA",92,0)
 Q "##FFFF##"_$C(13,10)
"RTN","SCRPPTPA",93,0)
 ;
"RTN","SCRPTEAM")
0^1^B15183519^n/a
"RTN","SCRPTEAM",1,0)
SCRPTEAM ;ALB/DJS - Team Listing Extract for PCMMR Data Validation; 04/03/14
"RTN","SCRPTEAM",2,0)
 ;;5.3;Scheduling;**620**;AUG 13, 1993;Build 11
"RTN","SCRPTEAM",3,0)
 ;
"RTN","SCRPTEAM",4,0)
ENTER ; Entry point
"RTN","SCRPTEAM",5,0)
 ; 
"RTN","SCRPTEAM",6,0)
 ; Extract file will be a delimited text file (.TXT) that will provide information for PCMM data validation
"RTN","SCRPTEAM",7,0)
 ; Delimiter is a pipe ("|") character
"RTN","SCRPTEAM",8,0)
 ;
"RTN","SCRPTEAM",9,0)
 ; FILE OUTPUT:
"RTN","SCRPTEAM",10,0)
 ;
"RTN","SCRPTEAM",11,0)
 ; STANUM - Station #
"RTN","SCRPTEAM",12,0)
 ; TIEN - IEN of team
"RTN","SCRPTEAM",13,0)
 ; TNAME - Name of Team
"RTN","SCRPTEAM",14,0)
 ; TPURPIEN - Team Purpose IEN  POINTER TO TEAM PURPOSE FILE (#403.47)
"RTN","SCRPTEAM",15,0)
 ; TPURP - Team Purpose 
"RTN","SCRPTEAM",16,0)
 ; ACTASPC - Can Act as a PC Team == 0 or 1
"RTN","SCRPTEAM",17,0)
 ; TINST - Institution Name
"RTN","SCRPTEAM",18,0)
 ; STANUM - Station #  POINTER TO INSTITUTION FILE (#4)
"RTN","SCRPTEAM",19,0)
 ; MAXPT - Max # of Patients
"RTN","SCRPTEAM",20,0)
 ; CLS2ASGN - Close to Further Assignment == 0 or 1
"RTN","SCRPTEAM",21,0)
 ; CURPTS - Current # of Patients
"RTN","SCRPTEAM",22,0)
 ; CURSTAT - Current Status == Active or Inactive
"RTN","SCRPTEAM",23,0)
 ; CUREFFDT - Current Effective Date
"RTN","SCRPTEAM",24,0)
 ; CURACTDT - Current Activation Date
"RTN","SCRPTEAM",25,0)
 ; CURINADT - Current Inactivation Date
"RTN","SCRPTEAM",26,0)
 ;
"RTN","SCRPTEAM",27,0)
 N SCMCPATH,SCMCHFS,SCMCERR,MSG,SCMCMODE,IOF,SCIENS,SITE,STANUM
"RTN","SCRPTEAM",28,0)
 N SCDATA,TIEN,TNAME,TPURPIEN,TPURP,ACTASPC,TINST,MAXPT,CLS2ASGN,CURPTS,CURSTAT,CUREFFDT,CURACTDT,CURINADT
"RTN","SCRPTEAM",29,0)
 S SITE=$$SITE^VASITE,STANUM=$P(SITE,"^",3)
"RTN","SCRPTEAM",30,0)
 S SCMCPATH=$$DEFDIR^%ZISH(),SCMCHFS=STANUM_"_PCMMTEAM.TXT",SCMCERR=0 U 0 W !!,SCMCPATH
"RTN","SCRPTEAM",31,0)
 D HFSOPEN("SCMCRP",SCMCPATH,SCMCHFS,"W") I SCMCERR G END
"RTN","SCRPTEAM",32,0)
 U IO
"RTN","SCRPTEAM",33,0)
 D COLHDR,SETREC G END
"RTN","SCRPTEAM",34,0)
 ;
"RTN","SCRPTEAM",35,0)
SETREC  ;$O through team file and find all teams
"RTN","SCRPTEAM",36,0)
    S TIEN=0
"RTN","SCRPTEAM",37,0)
 F  S TIEN=$O(^SCTM(404.51,TIEN)) Q:TIEN=""!(TIEN'?.N)  D
"RTN","SCRPTEAM",38,0)
 .K SCDATA
"RTN","SCRPTEAM",39,0)
 .S SCIENS=+$G(TIEN)_","
"RTN","SCRPTEAM",40,0)
 .D GETS^DIQ(404.51,SCIENS,".01;.02;.03;.05;.06;.07;.08;.09;.1;201;202;203;204;205","IE","SCDATA","")
"RTN","SCRPTEAM",41,0)
 .S TNAME=$G(SCDATA(404.51,SCIENS,.01,"E"))
"RTN","SCRPTEAM",42,0)
 .S TPURPIEN=$G(SCDATA(404.51,SCIENS,.03,"I"))
"RTN","SCRPTEAM",43,0)
 .S TPURP=$G(SCDATA(404.51,SCIENS,.03,"E"))
"RTN","SCRPTEAM",44,0)
 .S ACTASPC=$G(SCDATA(404.51,SCIENS,.05,"E"))
"RTN","SCRPTEAM",45,0)
 .S TINST=$G(SCDATA(404.51,SCIENS,.07,"E"))
"RTN","SCRPTEAM",46,0)
 .S MAXPT=$G(SCDATA(404.51,SCIENS,.08,"E"))
"RTN","SCRPTEAM",47,0)
 .S CLS2ASGN=$G(SCDATA(404.51,SCIENS,.1,"E"))
"RTN","SCRPTEAM",48,0)
 .S CURPTS=$G(SCDATA(404.51,SCIENS,201,"E"))
"RTN","SCRPTEAM",49,0)
 .S CURSTAT=$G(SCDATA(404.51,SCIENS,202,"E"))
"RTN","SCRPTEAM",50,0)
 .S CUREFFDT=$G(SCDATA(404.51,SCIENS,203,"E"))
"RTN","SCRPTEAM",51,0)
 .S CURACTDT=$G(SCDATA(404.51,SCIENS,204,"E"))
"RTN","SCRPTEAM",52,0)
 .S CURINADT=$G(SCDATA(404.51,SCIENS,205,"E"))
"RTN","SCRPTEAM",53,0)
 .W STANUM_"|"_TIEN_"|"_TNAME_"|"_TPURPIEN_"|"_TPURP_"|"_ACTASPC_"|"_TINST_"|"_MAXPT_"|"_CLS2ASGN_"|"_CURPTS_"|"_CURSTAT_"|"_CUREFFDT_"|"_CURACTDT_"|"_CURINADT,!
"RTN","SCRPTEAM",54,0)
 Q
"RTN","SCRPTEAM",55,0)
 ;
"RTN","SCRPTEAM",56,0)
COLHDR ;Create column header for Team extract file
"RTN","SCRPTEAM",57,0)
 W "Station #|Team IEN|Team Name|Team Purpose IEN|Team Purpose|Act as a PC Team?|Institution|Max # Patients|Close to Assignment|"
"RTN","SCRPTEAM",58,0)
 W "Current # Patients|Current Status|Current Effective Date|Current Activation Date|Current Inactivation Date",!
"RTN","SCRPTEAM",59,0)
 Q
"RTN","SCRPTEAM",60,0)
 ;
"RTN","SCRPTEAM",61,0)
END D HFSCLOSE("SCMCRP",SCMCHFS)
"RTN","SCRPTEAM",62,0)
 N I
"RTN","SCRPTEAM",63,0)
 I '+SCMCERR D  Q  ;Create pipe delimited output if no errors
"RTN","SCRPTEAM",64,0)
 .S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPTEAM",65,0)
 ;Replace "##FFFF##" with Form Feeds - code needed for LINUX environments
"RTN","SCRPTEAM",66,0)
 S I=0 F  S I=$O(^TMP("SCMC",$J,1,I)) Q:'I  D
"RTN","SCRPTEAM",67,0)
 .S:^TMP("SCMC",$J,1,I)["##FFFF##" ^TMP("SCMC",$J,1,I)=$P(^TMP("SCMC",$J,1,I),"##FFFF##")_$C(13,12)_$P(^TMP("SCMC",$J,1,I),"##FFFF##",2)
"RTN","SCRPTEAM",68,0)
 .S ^TMP("SCMC",$J,1,I)=^TMP("SCMC",$J,1,I)_$C(13)
"RTN","SCRPTEAM",69,0)
 .S:^TMP("SCMC",$J,1,I)["$END" ^TMP("SCMC",$J,1,I)=""
"RTN","SCRPTEAM",70,0)
 S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPTEAM",71,0)
 Q
"RTN","SCRPTEAM",72,0)
 ;
"RTN","SCRPTEAM",73,0)
HFSOPEN(HANDLE,SCMCPATH,SCMCHFS,SCMCMODE) ; Open File
"RTN","SCRPTEAM",74,0)
 N POP
"RTN","SCRPTEAM",75,0)
 D OPEN^%ZISH(HANDLE,SCMCPATH,SCMCHFS,$G(SCMCMODE,"W")) D:POP  Q:POP
"RTN","SCRPTEAM",76,0)
 .S SCMCERR=1,^TMP("SCMC",$J,1)="0^Unable to open file "
"RTN","SCRPTEAM",77,0)
 S IOF="$$IOF^SCRPTEAM"   ;resets screen position and adds page break flag - added to deal with Linux environments.
"RTN","SCRPTEAM",78,0)
 Q
"RTN","SCRPTEAM",79,0)
 ;
"RTN","SCRPTEAM",80,0)
HFSCLOSE(HANDLE,SCMHFS) ;Close HFS and unload data
"RTN","SCRPTEAM",81,0)
 D CLOSE^%ZISH(HANDLE)
"RTN","SCRPTEAM",82,0)
 Q
"RTN","SCRPTEAM",83,0)
 ;
"RTN","SCRPTEAM",84,0)
IOF() ;used to reset position and insert page break flag when @IOF is executed.
"RTN","SCRPTEAM",85,0)
 S $X=0,$Y=0
"RTN","SCRPTEAM",86,0)
 Q "##FFFF##"_$C(13,10)
"RTN","SCRPTEAM",87,0)
 ;
"RTN","SCRPTHST")
0^2^B8383528^n/a
"RTN","SCRPTHST",1,0)
SCRPTHST ;ALB/DJS - Team History Extract for PCMMR Data Validation; 04/10/14
"RTN","SCRPTHST",2,0)
 ;;5.3;Scheduling;**620**;AUG 13, 1993;Build 11
"RTN","SCRPTHST",3,0)
 ;
"RTN","SCRPTHST",4,0)
ENTER ; Entry point
"RTN","SCRPTHST",5,0)
 ; 
"RTN","SCRPTHST",6,0)
 ; Extract file will be a delimited text file (.TXT) that will provide information for PCMM data validation
"RTN","SCRPTHST",7,0)
 ; Delimiter is a pipe ("|") character
"RTN","SCRPTHST",8,0)
 ;
"RTN","SCRPTHST",9,0)
 ; FILE OUTPUT:
"RTN","SCRPTHST",10,0)
 ;
"RTN","SCRPTHST",11,0)
 ; STANUM - Station #
"RTN","SCRPTHST",12,0)
 ; TIEN - IEN of Team
"RTN","SCRPTHST",13,0)
 ; TNAME - Name of Team
"RTN","SCRPTHST",14,0)
 ; EFFDT - Effective Date
"RTN","SCRPTHST",15,0)
 ; STATUS - Status
"RTN","SCRPTHST",16,0)
 ; STATRSN - Status Reason
"RTN","SCRPTHST",17,0)
 ;
"RTN","SCRPTHST",18,0)
 N SCMCPATH,SCMCHFS,SCMCERR,MSG,SCMCMODE,IOF,SITE
"RTN","SCRPTHST",19,0)
 N SCDATA,SCIENS,STANUM,TIEN,TNAME,EFFDT,STATUS,STATRSN
"RTN","SCRPTHST",20,0)
 S SITE=$$SITE^VASITE,STANUM=$P(SITE,"^",3)
"RTN","SCRPTHST",21,0)
 S SCMCPATH=$$DEFDIR^%ZISH(),SCMCHFS=STANUM_"_PCMMTEAMHISTORY.TXT",SCMCERR=0 U 0 W !!,SCMCPATH
"RTN","SCRPTHST",22,0)
 D HFSOPEN("SCMCRP",SCMCPATH,SCMCHFS,"W") I SCMCERR G END
"RTN","SCRPTHST",23,0)
 U IO
"RTN","SCRPTHST",24,0)
 D COLHDR,SETREC G END
"RTN","SCRPTHST",25,0)
 ;
"RTN","SCRPTHST",26,0)
SETREC  ;$O through Team History file and find history for all teams
"RTN","SCRPTHST",27,0)
    S TIEN=0
"RTN","SCRPTHST",28,0)
 F  S TIEN=$O(^SCTM(404.58,TIEN)) Q:TIEN=""!(TIEN'?.N)  D
"RTN","SCRPTHST",29,0)
 .K SCDATA
"RTN","SCRPTHST",30,0)
 .S SCIENS=+$G(TIEN)_","
"RTN","SCRPTHST",31,0)
 .D GETS^DIQ(404.58,SCIENS,".01;.02;.03;.04","IE","SCDATA","")
"RTN","SCRPTHST",32,0)
 .S TNAME=$G(SCDATA(404.58,SCIENS,.01,"E"))
"RTN","SCRPTHST",33,0)
 .S EFFDT=$G(SCDATA(404.58,SCIENS,.02,"E"))
"RTN","SCRPTHST",34,0)
 .S STATUS=$G(SCDATA(404.58,SCIENS,.03,"E"))
"RTN","SCRPTHST",35,0)
 .S STATRSN=$G(SCDATA(404.58,SCIENS,.04,"E"))
"RTN","SCRPTHST",36,0)
 .W STANUM_"|"_TIEN_"|"_TNAME_"|"_EFFDT_"|"_STATUS_"|"_STATRSN,!
"RTN","SCRPTHST",37,0)
 Q
"RTN","SCRPTHST",38,0)
 ;
"RTN","SCRPTHST",39,0)
COLHDR ;Create column header for Team History extract file
"RTN","SCRPTHST",40,0)
 W "Station #|Team History IEN|Team Name|Effective Date|Status|Status Reason",!
"RTN","SCRPTHST",41,0)
 Q
"RTN","SCRPTHST",42,0)
 ;
"RTN","SCRPTHST",43,0)
END D HFSCLOSE("SCMCRP",SCMCHFS)
"RTN","SCRPTHST",44,0)
 N I
"RTN","SCRPTHST",45,0)
 I '+SCMCERR D  Q  ;Create pipe delimited output if no errors
"RTN","SCRPTHST",46,0)
 .S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPTHST",47,0)
 ;Replace "##FFFF##" with Form Feeds - code needed for LINUX environments
"RTN","SCRPTHST",48,0)
 S I=0 F  S I=$O(^TMP("SCMC",$J,1,I)) Q:'I  D
"RTN","SCRPTHST",49,0)
 .S:^TMP("SCMC",$J,1,I)["##FFFF##" ^TMP("SCMC",$J,1,I)=$P(^TMP("SCMC",$J,1,I),"##FFFF##")_$C(13,12)_$P(^TMP("SCMC",$J,1,I),"##FFFF##",2)
"RTN","SCRPTHST",50,0)
 .S ^TMP("SCMC",$J,1,I)=^TMP("SCMC",$J,1,I)_$C(13)
"RTN","SCRPTHST",51,0)
 .S:^TMP("SCMC",$J,1,I)["$END" ^TMP("SCMC",$J,1,I)=""
"RTN","SCRPTHST",52,0)
 S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPTHST",53,0)
 Q
"RTN","SCRPTHST",54,0)
 ;
"RTN","SCRPTHST",55,0)
HFSOPEN(HANDLE,SCMCPATH,SCMCHFS,SCMCMODE) ; Open File
"RTN","SCRPTHST",56,0)
 N POP
"RTN","SCRPTHST",57,0)
 D OPEN^%ZISH(HANDLE,SCMCPATH,SCMCHFS,$G(SCMCMODE,"W")) D:POP  Q:POP
"RTN","SCRPTHST",58,0)
 .S SCMCERR=1,^TMP("SCMC",$J,1)="0^Unable to open file "
"RTN","SCRPTHST",59,0)
 S IOF="$$IOF^SCRPTHST"   ;resets screen position and adds page break flag - added to deal with Linux environments.
"RTN","SCRPTHST",60,0)
 Q
"RTN","SCRPTHST",61,0)
 ;
"RTN","SCRPTHST",62,0)
HFSCLOSE(HANDLE,SCMHFS) ;Close HFS and unload data
"RTN","SCRPTHST",63,0)
 D CLOSE^%ZISH(HANDLE)
"RTN","SCRPTHST",64,0)
 Q
"RTN","SCRPTHST",65,0)
 ;
"RTN","SCRPTHST",66,0)
IOF() ;used to reset position and insert page break flag when @IOF is executed.
"RTN","SCRPTHST",67,0)
 S $X=0,$Y=0
"RTN","SCRPTHST",68,0)
 Q "##FFFF##"_$C(13,10)
"RTN","SCRPTHST",69,0)
 ;
"RTN","SCRPTPHS")
0^4^B9381464^n/a
"RTN","SCRPTPHS",1,0)
SCRPTPHS ;ALB/DJS - Team Position History Extract for PCMMR Data Validation; 04/10/14
"RTN","SCRPTPHS",2,0)
 ;;5.3;Scheduling;**620**;AUG 13, 1993;Build 11
"RTN","SCRPTPHS",3,0)
 ;
"RTN","SCRPTPHS",4,0)
ENTER ; Entry point
"RTN","SCRPTPHS",5,0)
 ; 
"RTN","SCRPTPHS",6,0)
 ; Extract file will be a delimited text file (.TXT) that will provide information for PCMM data validation
"RTN","SCRPTPHS",7,0)
 ; Delimiter is a pipe ("|") character
"RTN","SCRPTPHS",8,0)
 ;
"RTN","SCRPTPHS",9,0)
 ; FILE OUTPUT:
"RTN","SCRPTPHS",10,0)
 ;
"RTN","SCRPTPHS",11,0)
 ; STANUM - Station #
"RTN","SCRPTPHS",12,0)
 ; TPHIEN - IEN of Team Position History file
"RTN","SCRPTPHS",13,0)
 ; TPIEN - IEN of Team Position
"RTN","SCRPTPHS",14,0)
 ; TPOS - Name of Team Position
"RTN","SCRPTPHS",15,0)
 ; EFFDT - Effective Date
"RTN","SCRPTPHS",16,0)
 ; STATUS - Status
"RTN","SCRPTPHS",17,0)
 ; STATRSN - Status Reason
"RTN","SCRPTPHS",18,0)
 ;
"RTN","SCRPTPHS",19,0)
 N SCMCPATH,SCMCHFS,SCMCERR,SCMCMODE,MSG,IOF,SITE
"RTN","SCRPTPHS",20,0)
 N SCDATA,SCIENS,STANUM,TPHIEN,TPIEN,TPOS,EFFDT,STATUS,STATRSN
"RTN","SCRPTPHS",21,0)
 S SITE=$$SITE^VASITE,STANUM=$P(SITE,"^",3)
"RTN","SCRPTPHS",22,0)
 S SCMCPATH=$$DEFDIR^%ZISH(),SCMCHFS=STANUM_"_PCMMTEAMPOSITIONHISTORY.TXT",SCMCERR=0 U 0 W !!,SCMCPATH
"RTN","SCRPTPHS",23,0)
 D HFSOPEN("SCMCRP",SCMCPATH,SCMCHFS,"W") I SCMCERR G END
"RTN","SCRPTPHS",24,0)
 U IO
"RTN","SCRPTPHS",25,0)
 D COLHDR,SETREC G END
"RTN","SCRPTPHS",26,0)
 ;
"RTN","SCRPTPHS",27,0)
SETREC  ;$O through Team Position History file and find all team positions
"RTN","SCRPTPHS",28,0)
    S TPHIEN=0
"RTN","SCRPTPHS",29,0)
 F  S TPHIEN=$O(^SCTM(404.59,TPHIEN)) Q:TPHIEN=""!(TPHIEN'?.N)  D
"RTN","SCRPTPHS",30,0)
 .K SCDATA
"RTN","SCRPTPHS",31,0)
 .S SCIENS=+$G(TPHIEN)_","
"RTN","SCRPTPHS",32,0)
 .D GETS^DIQ(404.59,SCIENS,".01;.02;.03;.04","IE","SCDATA","")
"RTN","SCRPTPHS",33,0)
 .S TPIEN=$G(SCDATA(404.59,SCIENS,.01,"I"))
"RTN","SCRPTPHS",34,0)
 .S TPOS=$G(SCDATA(404.59,SCIENS,.01,"E"))
"RTN","SCRPTPHS",35,0)
 .S EFFDT=$G(SCDATA(404.59,SCIENS,.02,"E"))
"RTN","SCRPTPHS",36,0)
 .S STATUS=$G(SCDATA(404.59,SCIENS,.03,"E"))
"RTN","SCRPTPHS",37,0)
 .S STATRSN=$G(SCDATA(404.59,SCIENS,.04,"E"))
"RTN","SCRPTPHS",38,0)
 .W STANUM_"|"_TPHIEN_"|"_TPIEN_"|"_TPOS_"|"_EFFDT_"|"_STATUS_"|"_STATRSN,!
"RTN","SCRPTPHS",39,0)
 Q
"RTN","SCRPTPHS",40,0)
 ;
"RTN","SCRPTPHS",41,0)
COLHDR ;Create column header for Team Position History extract file
"RTN","SCRPTPHS",42,0)
 W "Station #|Team Position History IEN|Team Position IEN|Team Name|Effective Date|Status|Status Reason",!
"RTN","SCRPTPHS",43,0)
 Q
"RTN","SCRPTPHS",44,0)
 ;
"RTN","SCRPTPHS",45,0)
END D HFSCLOSE("SCMCRP",SCMCHFS)
"RTN","SCRPTPHS",46,0)
 N I
"RTN","SCRPTPHS",47,0)
 I '+SCMCERR D  Q  ;Create pipe delimited output if no errors
"RTN","SCRPTPHS",48,0)
 .S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPTPHS",49,0)
 ;Replace "##FFFF##" with Form Feeds - code needed for LINUX environments
"RTN","SCRPTPHS",50,0)
 S I=0 F  S I=$O(^TMP("SCMC",$J,1,I)) Q:'I  D
"RTN","SCRPTPHS",51,0)
 .S:^TMP("SCMC",$J,1,I)["##FFFF##" ^TMP("SCMC",$J,1,I)=$P(^TMP("SCMC",$J,1,I),"##FFFF##")_$C(13,12)_$P(^TMP("SCMC",$J,1,I),"##FFFF##",2)
"RTN","SCRPTPHS",52,0)
 .S ^TMP("SCMC",$J,1,I)=^TMP("SCMC",$J,1,I)_$C(13)
"RTN","SCRPTPHS",53,0)
 .S:^TMP("SCMC",$J,1,I)["$END" ^TMP("SCMC",$J,1,I)=""
"RTN","SCRPTPHS",54,0)
 S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPTPHS",55,0)
 Q
"RTN","SCRPTPHS",56,0)
 ;
"RTN","SCRPTPHS",57,0)
HFSOPEN(HANDLE,SCMCPATH,SCMCHFS,SCMCMODE) ; Open File
"RTN","SCRPTPHS",58,0)
 N POP
"RTN","SCRPTPHS",59,0)
 D OPEN^%ZISH(HANDLE,SCMCPATH,SCMCHFS,$G(SCMCMODE,"W")) D:POP  Q:POP
"RTN","SCRPTPHS",60,0)
 .S SCMCERR=1,^TMP("SCMC",$J,1)="0^Unable to open file "
"RTN","SCRPTPHS",61,0)
 S IOF="$$IOF^SCRPTPHS"   ;resets screen position and adds page break flag - added to deal with Linux environments.
"RTN","SCRPTPHS",62,0)
 Q
"RTN","SCRPTPHS",63,0)
 ;
"RTN","SCRPTPHS",64,0)
HFSCLOSE(HANDLE,SCMHFS) ;Close HFS and unload data
"RTN","SCRPTPHS",65,0)
 D CLOSE^%ZISH(HANDLE)
"RTN","SCRPTPHS",66,0)
 Q
"RTN","SCRPTPHS",67,0)
 ;
"RTN","SCRPTPHS",68,0)
IOF() ;used to reset position and insert page break flag when @IOF is executed.
"RTN","SCRPTPHS",69,0)
 S $X=0,$Y=0
"RTN","SCRPTPHS",70,0)
 Q "##FFFF##"_$C(13,10)
"RTN","SCRPTPHS",71,0)
 ;
"RTN","SCRPTPOS")
0^3^B35911981^n/a
"RTN","SCRPTPOS",1,0)
SCRPTPOS ;ALB/DJS - Team Position Extract for PCMMR Data Validation; 04/08/14
"RTN","SCRPTPOS",2,0)
 ;;5.3;Scheduling;**620**;AUG 13, 1993;Build 11
"RTN","SCRPTPOS",3,0)
 ;
"RTN","SCRPTPOS",4,0)
ENTER ; Entry point
"RTN","SCRPTPOS",5,0)
 ; 
"RTN","SCRPTPOS",6,0)
 ; Extract file will be a delimited text file (.TXT) that will provide information for PCMM data validation
"RTN","SCRPTPOS",7,0)
 ; Delimiter is a pipe ("|") character
"RTN","SCRPTPOS",8,0)
 ;
"RTN","SCRPTPOS",9,0)
 ; FILE OUTPUT:
"RTN","SCRPTPOS",10,0)
 ;
"RTN","SCRPTPOS",11,0)
 ; STANUM - Station #
"RTN","SCRPTPOS",12,0)
 ; TPIEN - IEN of Team Position
"RTN","SCRPTPOS",13,0)
 ; TPOS - Name of Team Position
"RTN","SCRPTPOS",14,0)
 ; TIEN - IEN pointer to Team file #404.51
"RTN","SCRPTPOS",15,0)
 ; TNAME - Team Name
"RTN","SCRPTPOS",16,0)
 ; ROLEIEN - IEN of Standard Role
"RTN","SCRPTPOS",17,0)
 ; ROLE - Standard Role Name
"RTN","SCRPTPOS",18,0)
 ; POSSPP - Possible Primary Practitioner
"RTN","SCRPTPOS",19,0)
 ; MAXPT - Max # of Patients
"RTN","SCRPTPOS",20,0)
 ; PRECPOS - Preceptor Position
"RTN","SCRPTPOS",21,0)
 ; ACTASPRE - Can act as a Preceptor?
"RTN","SCRPTPOS",22,0)
 ; PDESC - Position Description
"RTN","SCRPTPOS",23,0)
 ; DEATHMSG - Death Message 
"RTN","SCRPTPOS",24,0)
 ; INPTMSG - Inpatient Message
"RTN","SCRPTPOS",25,0)
 ; TEAMMSG - Team Message
"RTN","SCRPTPOS",26,0)
 ; PREDTHMS - Preceptor Death Message
"RTN","SCRPTPOS",27,0)
 ; PREINPMS - Preceptor Inpatient Message
"RTN","SCRPTPOS",28,0)
 ; PRETMMSG - Preceptor Team Message
"RTN","SCRPTPOS",29,0)
 ; AUINAMSG - Automatic Inactivation Message
"RTN","SCRPTPOS",30,0)
 ; PRAINMSG - Preceptor Automatic Inactivation Message
"RTN","SCRPTPOS",31,0)
 ; CURPCPT - Current # of PC Patients
"RTN","SCRPTPOS",32,0)
 ; CURPTS - Current # of Patients
"RTN","SCRPTPOS",33,0)
 ; CURSTAT - Current Status == Active or Inactive
"RTN","SCRPTPOS",34,0)
 ; CUREFFDT - Current Effective Date
"RTN","SCRPTPOS",35,0)
 ; CURACTDT - Current Activation Date
"RTN","SCRPTPOS",36,0)
 ; CURINADT - Current Inactivation Date
"RTN","SCRPTPOS",37,0)
 ; CURPRAC - Current Practitioner
"RTN","SCRPTPOS",38,0)
 ; CURPRCPS - Current Preceptor Position
"RTN","SCRPTPOS",39,0)
 ; CURPREC - Current Preceptor
"RTN","SCRPTPOS",40,0)
 ; ACTPREC - Active Precepts
"RTN","SCRPTPOS",41,0)
 ;
"RTN","SCRPTPOS",42,0)
 N SCMCPATH,SCMCHFS,SCMCERR,SCMCMODE,MSG,IOF
"RTN","SCRPTPOS",43,0)
 N SITE,SCDATA,SCIENS,STANUM,TPIEN,TPOS,TIEN,TNAME,ROLEIEN,ROLE,POSSPP,MAXPT,PRECPOS,ACTASPRE,PDESC,DEATHMSG,INPTMSG,TEAMMSG,PREDTHMS
"RTN","SCRPTPOS",44,0)
 N PREINPMS,PRETMMSG,AUINAMSG,PRAINMSG,CURPCPT,CURPTS,CURSTAT,CUREFFDT,CURACTDT,CURINADT,CURPRAC,CURPRCPS,CURPREC,ACTPREC
"RTN","SCRPTPOS",45,0)
 S SITE=$$SITE^VASITE,STANUM=$P(SITE,"^",3)
"RTN","SCRPTPOS",46,0)
 S SCMCPATH=$$DEFDIR^%ZISH(),SCMCHFS=STANUM_"_PCMMTEAMPOSITION.TXT",SCMCERR=0 U 0 W !!,SCMCPATH
"RTN","SCRPTPOS",47,0)
 D HFSOPEN("SCMCRP",SCMCPATH,SCMCHFS,"W") I SCMCERR G END
"RTN","SCRPTPOS",48,0)
 U IO
"RTN","SCRPTPOS",49,0)
 D COLHDR,SETREC G END
"RTN","SCRPTPOS",50,0)
 ;
"RTN","SCRPTPOS",51,0)
SETREC  ;$O through Team Position file and find all team positions
"RTN","SCRPTPOS",52,0)
    S TPIEN=0
"RTN","SCRPTPOS",53,0)
 F  S TPIEN=$O(^SCTM(404.57,TPIEN)) Q:TPIEN=""!(TPIEN'?.N)  D
"RTN","SCRPTPOS",54,0)
 .K SCDATA
"RTN","SCRPTPOS",55,0)
 .S SCIENS=+$G(TPIEN)_","
"RTN","SCRPTPOS",56,0)
 .D GETS^DIQ(404.57,SCIENS,".01;.02;.03;.04;.08;.1;.12;1;2.01;2.02;2.03;2.05;2.06;2.07;2.09;2.10;200;201;300;301;302;303;304;305;306;307","IE","SCDATA","")
"RTN","SCRPTPOS",57,0)
 .S TPOS=$G(SCDATA(404.57,SCIENS,.01,"E"))
"RTN","SCRPTPOS",58,0)
 .S TIEN=$G(SCDATA(404.57,SCIENS,.02,"I"))
"RTN","SCRPTPOS",59,0)
 .S TNAME=$G(SCDATA(404.57,SCIENS,.02,"E"))
"RTN","SCRPTPOS",60,0)
 .S ROLEIEN=$G(SCDATA(404.57,SCIENS,.03,"I"))
"RTN","SCRPTPOS",61,0)
 .S ROLE=$G(SCDATA(404.57,SCIENS,.03,"E"))
"RTN","SCRPTPOS",62,0)
 .S POSSPP=$G(SCDATA(404.57,SCIENS,.04,"E"))
"RTN","SCRPTPOS",63,0)
 .S MAXPT=$G(SCDATA(404.57,SCIENS,.08,"E"))
"RTN","SCRPTPOS",64,0)
 .S PRECPOS=$G(SCDATA(404.57,SCIENS,.1,"E"))
"RTN","SCRPTPOS",65,0)
 .S ACTASPRE=$G(SCDATA(404.57,SCIENS,.12,"E"))
"RTN","SCRPTPOS",66,0)
 .S PDESC=$G(^SCTM(404.57,TPIEN,1,1,0))
"RTN","SCRPTPOS",67,0)
 .S DEATHMSG=$G(SCDATA(404.57,SCIENS,2.01,"E"))
"RTN","SCRPTPOS",68,0)
 .S INPTMSG=$G(SCDATA(404.57,SCIENS,2.02,"E"))
"RTN","SCRPTPOS",69,0)
 .S TEAMMSG=$G(SCDATA(404.57,SCIENS,2.03,"E"))
"RTN","SCRPTPOS",70,0)
 .S PREDTHMS=$G(SCDATA(404.57,SCIENS,2.05,"E"))
"RTN","SCRPTPOS",71,0)
 .S PREINPMS=$G(SCDATA(404.57,SCIENS,2.06,"E"))
"RTN","SCRPTPOS",72,0)
 .S PRETMMSG=$G(SCDATA(404.57,SCIENS,2.07,"E"))
"RTN","SCRPTPOS",73,0)
 .S AUINAMSG=$G(SCDATA(404.57,SCIENS,2.09,"E"))
"RTN","SCRPTPOS",74,0)
 .S PRAINMSG=$G(SCDATA(404.57,SCIENS,2.10,"E"))
"RTN","SCRPTPOS",75,0)
 .S CURPCPT=$G(SCDATA(404.57,SCIENS,200,"E"))
"RTN","SCRPTPOS",76,0)
 .S CURPTS=$G(SCDATA(404.57,SCIENS,201,"E"))
"RTN","SCRPTPOS",77,0)
 .S CURSTAT=$G(SCDATA(404.57,SCIENS,300,"E"))
"RTN","SCRPTPOS",78,0)
 .S CUREFFDT=$G(SCDATA(404.57,SCIENS,301,"E"))
"RTN","SCRPTPOS",79,0)
 .S CURACTDT=$G(SCDATA(404.57,SCIENS,302,"E"))
"RTN","SCRPTPOS",80,0)
 .S CURINADT=$G(SCDATA(404.57,SCIENS,303,"E"))
"RTN","SCRPTPOS",81,0)
 .S CURPRAC=$G(SCDATA(404.57,SCIENS,304,"E"))
"RTN","SCRPTPOS",82,0)
 .S CURPRCPS=$G(SCDATA(404.57,SCIENS,305,"E"))
"RTN","SCRPTPOS",83,0)
 .S CURPREC=$G(SCDATA(404.57,SCIENS,306,"E"))
"RTN","SCRPTPOS",84,0)
 .S ACTPREC=$G(SCDATA(404.57,SCIENS,307,"E"))
"RTN","SCRPTPOS",85,0)
 .W STANUM_"|"_TPIEN_"|"_TPOS_"|"_TIEN_"|"_TNAME_"|"_ROLEIEN_"|"_ROLE_"|"_POSSPP_"|"_MAXPT_"|"_PRECPOS_"|"_ACTASPRE_"|"_PDESC_"|"_DEATHMSG_"|"_INPTMSG_"|"_TEAMMSG_"|"_PREDTHMS_"|"
"RTN","SCRPTPOS",86,0)
 .W PREINPMS_"|"_PRETMMSG_"|"_AUINAMSG_"|"_PRAINMSG_"|"_CURPCPT_"|"_CURPTS_"|"_CURSTAT_"|"_CUREFFDT_"|"_CURACTDT_"|"_CURINADT_"|"_CURPRAC_"|"_CURPRCPS_"|"_CURPREC_"|"_ACTPREC,!
"RTN","SCRPTPOS",87,0)
 Q
"RTN","SCRPTPOS",88,0)
 ;
"RTN","SCRPTPOS",89,0)
COLHDR ;Create column header for Team Position extract file
"RTN","SCRPTPOS",90,0)
 W "Station #|Position IEN|Position Name|Team IEN|Team Name|Standard Role IEN|Standard Role Name|Possible Primary Practitioner|Max # Patients|Preceptor Position|Can Act as Preceptor|Position Description|"
"RTN","SCRPTPOS",91,0)
 W "Death Message|Inpatient Message|Team Message|Preceptor Death Message|Preceptor Inpatient Message|Preceptor Team Message|Auto Inactivation Message|Prec Auto Inactivation Message|Current # PC Patients|"
"RTN","SCRPTPOS",92,0)
 W "Current # Patients|Current Status|Current Effective Date|Current Activation Date|Current Inactivation Date|Current Practitioner|Current Preceptor Position|Current Preceptor|Active Precepts",!
"RTN","SCRPTPOS",93,0)
 Q
"RTN","SCRPTPOS",94,0)
 ;
"RTN","SCRPTPOS",95,0)
END D HFSCLOSE("SCMCRP",SCMCHFS)
"RTN","SCRPTPOS",96,0)
 N I
"RTN","SCRPTPOS",97,0)
 I '+SCMCERR D  Q  ;Create pipe delimited output if no errors
"RTN","SCRPTPOS",98,0)
 .S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPTPOS",99,0)
 ;Replace "##FFFF##" with Form Feeds - code needed for LINUX environments
"RTN","SCRPTPOS",100,0)
 S I=0 F  S I=$O(^TMP("SCMC",$J,1,I)) Q:'I  D
"RTN","SCRPTPOS",101,0)
 .S:^TMP("SCMC",$J,1,I)["##FFFF##" ^TMP("SCMC",$J,1,I)=$P(^TMP("SCMC",$J,1,I),"##FFFF##")_$C(13,12)_$P(^TMP("SCMC",$J,1,I),"##FFFF##",2)
"RTN","SCRPTPOS",102,0)
 .S ^TMP("SCMC",$J,1,I)=^TMP("SCMC",$J,1,I)_$C(13)
"RTN","SCRPTPOS",103,0)
 .S:^TMP("SCMC",$J,1,I)["$END" ^TMP("SCMC",$J,1,I)=""
"RTN","SCRPTPOS",104,0)
 S MSG=$NA(^TMP("SCMC",$J))
"RTN","SCRPTPOS",105,0)
 Q
"RTN","SCRPTPOS",106,0)
 ;
"RTN","SCRPTPOS",107,0)
HFSOPEN(HANDLE,SCMCPATH,SCMCHFS,SCMCMODE) ; Open File
"RTN","SCRPTPOS",108,0)
 N POP
"RTN","SCRPTPOS",109,0)
 D OPEN^%ZISH(HANDLE,SCMCPATH,SCMCHFS,$G(SCMCMODE,"W")) D:POP  Q:POP
"RTN","SCRPTPOS",110,0)
 .S SCMCERR=1,^TMP("SCMC",$J,1)="0^Unable to open file "
"RTN","SCRPTPOS",111,0)
 S IOF="$$IOF^SCRPTPOS"   ;resets screen position and adds page break flag - added to deal with Linux environments.
"RTN","SCRPTPOS",112,0)
 Q
"RTN","SCRPTPOS",113,0)
 ;
"RTN","SCRPTPOS",114,0)
HFSCLOSE(HANDLE,SCMHFS) ;Close HFS and unload data
"RTN","SCRPTPOS",115,0)
 D CLOSE^%ZISH(HANDLE)
"RTN","SCRPTPOS",116,0)
 Q
"RTN","SCRPTPOS",117,0)
 ;
"RTN","SCRPTPOS",118,0)
IOF() ;used to reset position and insert page break flag when @IOF is executed.
"RTN","SCRPTPOS",119,0)
 S $X=0,$Y=0
"RTN","SCRPTPOS",120,0)
 Q "##FFFF##"_$C(13,10)
"RTN","SCRPTPOS",121,0)
 ;
"VER")
8.0^22.0
"BLD",9010,6)
^518
**END**
**END**

