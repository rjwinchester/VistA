Released VIAA*1*1 SEQ #2
Extracted from mail message
**KIDS**:VIAA*1.0*1^

**INSTALL NAME**
VIAA*1.0*1
"BLD",9265,0)
VIAA*1.0*1^REAL TIME LOCATION SYSTEM^0^3160907^y
"BLD",9265,1,0)
^^8^8^3160506^
"BLD",9265,1,1,0)
This Real Time Location System (RTLS) patch provides the foundation
"BLD",9265,1,2,0)
for the interface between WaveMark and legacy VistA packages by creating
"BLD",9265,1,3,0)
an application proxy user and a common menu that will contain
"BLD",9265,1,4,0)
future Remote Procedure Calls (RPC) for multiple packages and files in
"BLD",9265,1,5,0)
VistA. The menu option will be assigned as secondary menu to the
"BLD",9265,1,6,0)
application proxy user created. The RPC menu exported by this patch may be
"BLD",9265,1,7,0)
expanded in future patches with other new RPC lists for other VistA 
"BLD",9265,1,8,0)
packages.
"BLD",9265,4,0)
^9.64PA^^0
"BLD",9265,6.3)
44
"BLD",9265,"ABPKG")
n
"BLD",9265,"INI")
PRE^VIAA01P1
"BLD",9265,"INID")
^y^n
"BLD",9265,"INIT")
POST^VIAA01P1
"BLD",9265,"KRN",0)
^9.67PA^779.2^20
"BLD",9265,"KRN",.4,0)
.4
"BLD",9265,"KRN",.401,0)
.401
"BLD",9265,"KRN",.402,0)
.402
"BLD",9265,"KRN",.403,0)
.403
"BLD",9265,"KRN",.5,0)
.5
"BLD",9265,"KRN",.84,0)
.84
"BLD",9265,"KRN",3.6,0)
3.6
"BLD",9265,"KRN",3.8,0)
3.8
"BLD",9265,"KRN",9.2,0)
9.2
"BLD",9265,"KRN",9.8,0)
9.8
"BLD",9265,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9265,"KRN",9.8,"NM",1,0)
VIAA01P1^^0^B15325647
"BLD",9265,"KRN",9.8,"NM","B","VIAA01P1",1)

"BLD",9265,"KRN",19,0)
19
"BLD",9265,"KRN",19,"NM",0)
^9.68A^2^1
"BLD",9265,"KRN",19,"NM",2,0)
VIAA01 RTLS RPC MENU^^0
"BLD",9265,"KRN",19,"NM","B","VIAA01 RTLS RPC MENU",2)

"BLD",9265,"KRN",19.1,0)
19.1
"BLD",9265,"KRN",101,0)
101
"BLD",9265,"KRN",409.61,0)
409.61
"BLD",9265,"KRN",771,0)
771
"BLD",9265,"KRN",779.2,0)
779.2
"BLD",9265,"KRN",870,0)
870
"BLD",9265,"KRN",8989.51,0)
8989.51
"BLD",9265,"KRN",8989.52,0)
8989.52
"BLD",9265,"KRN",8994,0)
8994
"BLD",9265,"KRN",8994,"NM",0)
^9.68A^^0
"BLD",9265,"KRN","B",.4,.4)

"BLD",9265,"KRN","B",.401,.401)

"BLD",9265,"KRN","B",.402,.402)

"BLD",9265,"KRN","B",.403,.403)

"BLD",9265,"KRN","B",.5,.5)

"BLD",9265,"KRN","B",.84,.84)

"BLD",9265,"KRN","B",3.6,3.6)

"BLD",9265,"KRN","B",3.8,3.8)

"BLD",9265,"KRN","B",9.2,9.2)

"BLD",9265,"KRN","B",9.8,9.8)

"BLD",9265,"KRN","B",19,19)

"BLD",9265,"KRN","B",19.1,19.1)

"BLD",9265,"KRN","B",101,101)

"BLD",9265,"KRN","B",409.61,409.61)

"BLD",9265,"KRN","B",771,771)

"BLD",9265,"KRN","B",779.2,779.2)

"BLD",9265,"KRN","B",870,870)

"BLD",9265,"KRN","B",8989.51,8989.51)

"BLD",9265,"KRN","B",8989.52,8989.52)

"BLD",9265,"KRN","B",8994,8994)

"BLD",9265,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",9265,"QUES",0)
^9.62^^
"BLD",9265,"REQB",0)
^9.611^^
"INI")
PRE^VIAA01P1
"INIT")
POST^VIAA01P1
"KRN",19,11523,-1)
0^2
"KRN",19,11523,0)
VIAA01 RTLS RPC MENU^RTLS Interface Menu^^B^^^^^^^^REAL TIME LOCATION SYSTEM
"KRN",19,11523,1,0)
^19.06^2^2^3160525^^^^
"KRN",19,11523,1,1,0)
This is the RTLS interface menu which includes Remote Procedure Calls for
"KRN",19,11523,1,2,0)
multiple packages in VistA.
"KRN",19,11523,99.1)
64035,67665
"KRN",19,11523,"RPC",0)
^19.05P^^0
"KRN",19,11523,"U")
RTLS INTERFACE MENU
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",223,-1)
1^1
"PKG",223,0)
REAL TIME LOCATION SYSTEM^VIAA^REAL TIME LOCATION SYSTEM
"PKG",223,20,0)
^9.402P^^
"PKG",223,22,0)
^9.49I^1^1
"PKG",223,22,1,0)
1.0
"PKG",223,22,1,"PAH",1,0)
1^3160907^66475
"PKG",223,22,1,"PAH",1,1,0)
^^8^8^3160907
"PKG",223,22,1,"PAH",1,1,1,0)
This Real Time Location System (RTLS) patch provides the foundation
"PKG",223,22,1,"PAH",1,1,2,0)
for the interface between WaveMark and legacy VistA packages by creating
"PKG",223,22,1,"PAH",1,1,3,0)
an application proxy user and a common menu that will contain
"PKG",223,22,1,"PAH",1,1,4,0)
future Remote Procedure Calls (RPC) for multiple packages and files in
"PKG",223,22,1,"PAH",1,1,5,0)
VistA. The menu option will be assigned as secondary menu to the
"PKG",223,22,1,"PAH",1,1,6,0)
application proxy user created. The RPC menu exported by this patch may be
"PKG",223,22,1,"PAH",1,1,7,0)
expanded in future patches with other new RPC lists for other VistA 
"PKG",223,22,1,"PAH",1,1,8,0)
packages.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","VIAA01P1")
0^1^B15325647^n/a
"RTN","VIAA01P1",1,0)
VIAA01P1 ;ALB/CR - PATCH 1 POST INSTALL ;4/21/16 11:28 am
"RTN","VIAA01P1",2,0)
 ;;1.0;RTLS;**1**;April 22, 2013;Build 44
"RTN","VIAA01P1",3,0)
 ;
"RTN","VIAA01P1",4,0)
 Q
"RTN","VIAA01P1",5,0)
 ; Reference to ^VA(200 supported by ICR #10060
"RTN","VIAA01P1",6,0)
 ; application proxy creation supported by ICR #4677
"RTN","VIAA01P1",7,0)
 ;
"RTN","VIAA01P1",8,0)
PRE ; checks for the connector proxy that the site created with the option
"RTN","VIAA01P1",9,0)
 ; 'Enter/Edit Connector Proxy User' under the 'Foundations Management' menu
"RTN","VIAA01P1",10,0)
 ; of Vistalink
"RTN","VIAA01P1",11,0)
 N X,NAME,NAME1
"RTN","VIAA01P1",12,0)
 S NAME="VIAASERVICE,RTLS CONNECTOR PROXY"
"RTN","VIAA01P1",13,0)
 S NAME1=$E(NAME,1,30) ; B x-ref keeps 30 chars only
"RTN","VIAA01P1",14,0)
 S X=$$FIND1^DIC(200,,"M",NAME1)
"RTN","VIAA01P1",15,0)
 D BMES^XPDUTL("PRE-INIT CHECKS: looking for the '"_NAME_"' user...")
"RTN","VIAA01P1",16,0)
 I 'X D BMES^XPDUTL("...User '"_NAME_"' not found. Please create it soon.") Q
"RTN","VIAA01P1",17,0)
 ;
"RTN","VIAA01P1",18,0)
 I X>0 D
"RTN","VIAA01P1",19,0)
 . D BMES^XPDUTL("...'"_NAME_"' already exists...")
"RTN","VIAA01P1",20,0)
 . D BMES^XPDUTL("...checking required fields...")
"RTN","VIAA01P1",21,0)
 . I $P($G(^VA(200,X,0)),U,3)'=""&($P($G(^VA(200,X,.1)),U,2)'="") D BMES^XPDUTL("...Access/verify codes appear to be in place...")
"RTN","VIAA01P1",22,0)
 . I '$D(^VA(200,X,203,1,0))&('$D(^VA(200,X,201))) D BMES^XPDUTL("...No illegal primary/secondary menus found...")
"RTN","VIAA01P1",23,0)
 . I $D(^VA(200,X,203,1,0))!($D(^VA(200,X,201))) D BMES^XPDUTL("...Illegal menu options found...")
"RTN","VIAA01P1",24,0)
 . I $P($G(^VA(200,X,"USC3",1,0)),U,1,2)["5^1" D BMES^XPDUTL("...User Class looks fine...")
"RTN","VIAA01P1",25,0)
 . I $P($G(^VA(200,X,"USC3",1,0)),U,1,2)'["5^1" D BMES^XPDUTL("...Wrong User Class...")
"RTN","VIAA01P1",26,0)
 . I $P($G(^VA(200,X,200)),U,4)=1 D BMES^XPDUTL("...Multiple sign-on is allowed...")
"RTN","VIAA01P1",27,0)
 . I $P($G(^VA(200,X,200)),U,4)'=1 D BMES^XPDUTL("...Multiple sign-on is not allowed...")
"RTN","VIAA01P1",28,0)
 . D BMES^XPDUTL("PRE-INIT CHECKS FINISHED.")
"RTN","VIAA01P1",29,0)
 ;
"RTN","VIAA01P1",30,0)
 E  D BMES^XPDUTL("...No connector proxy user found - it needs to be created manually.")
"RTN","VIAA01P1",31,0)
 Q
"RTN","VIAA01P1",32,0)
 ;
"RTN","VIAA01P1",33,0)
POST ; create an application proxy for the RTLS RPC menu option
"RTN","VIAA01P1",34,0)
 ; and attach it as a secondary menu
"RTN","VIAA01P1",35,0)
 N USER,USER1,USERIEN,OPT,OPTNAME,R
"RTN","VIAA01P1",36,0)
 S USER="VIAASERVICE,RTLS APPLICATION PROXY"
"RTN","VIAA01P1",37,0)
 S USER1=$E(USER,1,30) ; B x-ref keeps only 30 chars
"RTN","VIAA01P1",38,0)
 S OPTNAME="VIAA01 RTLS RPC MENU"
"RTN","VIAA01P1",39,0)
 S USERIEN=$$FIND1^DIC(200,,"M",USER1) ; get user's IEN
"RTN","VIAA01P1",40,0)
 D BMES^XPDUTL("")
"RTN","VIAA01P1",41,0)
 D BMES^XPDUTL("POST-INIT CHECKS: looking for the '"_USER_"' user...")
"RTN","VIAA01P1",42,0)
 ;
"RTN","VIAA01P1",43,0)
 I USERIEN>0 D  Q
"RTN","VIAA01P1",44,0)
 . D BMES^XPDUTL("...'"_USER_"' already exists...")
"RTN","VIAA01P1",45,0)
 . D BMES^XPDUTL("...checking required fields...")
"RTN","VIAA01P1",46,0)
 . S OPT=$$FIND1^DIC(19,,"M",OPTNAME) I 'OPT D BMES^XPDUTL("...'"_OPTNAME_"' not found...") Q
"RTN","VIAA01P1",47,0)
 . I $P($G(^VA(200,USERIEN,0)),U,3)=""&('$D(^VA(200,USERIEN,.1))) D BMES^XPDUTL("...No illegal access/verify codes found...")
"RTN","VIAA01P1",48,0)
 . I $P($G(^VA(200,USERIEN,0)),U,3)'=""&($D(^VA(200,USERIEN,.1))) D BMES^XPDUTL("...Illegal access/verify codes found...")
"RTN","VIAA01P1",49,0)
 . I $P($G(^VA(200,USERIEN,203,1,0)),U)=OPT D BMES^XPDUTL("...Secondary menu looks fine...")
"RTN","VIAA01P1",50,0)
 . I $P($G(^VA(200,USERIEN,203,1,0)),U)'=OPT D BMES^XPDUTL("...Missing '"_OPTNAME_"'...")
"RTN","VIAA01P1",51,0)
 . I $P($G(^VA(200,USERIEN,"USC3",1,0)),U,1,2)["1^1" D BMES^XPDUTL("...User Class looks fine...")
"RTN","VIAA01P1",52,0)
 . I $P($G(^VA(200,USERIEN,"USC3",1,0)),U,1,2)'["1^1" D BMES^XPDUTL("...Wrong User Class found. Checks finished...")
"RTN","VIAA01P1",53,0)
 . D BMES^XPDUTL("POST-INIT CHECKS FINISHED.")
"RTN","VIAA01P1",54,0)
 ;
"RTN","VIAA01P1",55,0)
 E  D BMES^XPDUTL("POST-INIT INSTALL: No application proxy user found - creating one...stand by...")
"RTN","VIAA01P1",56,0)
 ; set up the application proxy then
"RTN","VIAA01P1",57,0)
 S R=$$CREATE^XUSAP(USER,"",OPTNAME)
"RTN","VIAA01P1",58,0)
 D BMES^XPDUTL("...'"_USER_"'"_$S(R=-1:" creation failed",R=0:" already exists.",1:" user added."))
"RTN","VIAA01P1",59,0)
 D BMES^XPDUTL("POST-INIT INSTALL FINISHED.")
"RTN","VIAA01P1",60,0)
 Q
"VER")
8.0^22.0
"BLD",9265,6)
^2
**END**
**END**

