KIDS Distribution saved on Mar 20, 2018@13:22:40
VistA Imaging V3 - Patch 188 - MUSE Viewer Issues.
**KIDS**:MAG*3.0*188^

**INSTALL NAME**
MAG*3.0*188
"BLD",8364,0)
MAG*3.0*188^IMAGING^0^3180320^y
"BLD",8364,1,0)
^9.61A^15^15^3180320^^^^
"BLD",8364,1,1,0)
MAG*3.0*188
"BLD",8364,1,2,0)
This patch will resolve the following issues for Clinical Display:
"BLD",8364,1,3,0)
The ability to Show or Hide the Grid on the EKG Display and 
"BLD",8364,1,4,0)
while printing.
"BLD",8364,1,5,0)
The ability to select multiple EKG's for display and printing.
"BLD",8364,1,6,0)
The ability for a site to change the Format ID that is used
"BLD",8364,1,7,0)
to generate the EKG Image.
"BLD",8364,1,8,0)
CT scrolling issue in the Radiology Viewer.
"BLD",8364,1,9,0)
This will check the routines from a BUILD file.
"BLD",8364,1,10,0)
Select BUILD NAME:    MAG*3.0*188     IMAGING
"BLD",8364,1,11,0)
MAGGTSYS  value = 27028795
"BLD",8364,1,12,0)
MAGGTU4D  value = 5740596
"BLD",8364,1,13,0)
MAGGTU4M  value = 22884338
"BLD",8364,1,14,0)
MAGIP188  value = 4692901
"BLD",8364,1,15,0)
done
"BLD",8364,4,0)
^9.64PA^2006.172^2
"BLD",8364,4,2006.171,0)
2006.171
"BLD",8364,4,2006.171,222)
y^y^f^^n^^y^o^n
"BLD",8364,4,2006.172,0)
2006.172
"BLD",8364,4,2006.172,222)
y^y^f^^^^n
"BLD",8364,4,"B",2006.171,2006.171)

"BLD",8364,4,"B",2006.172,2006.172)

"BLD",8364,6.3)
61
"BLD",8364,"ABNS",0)
^9.66A^^0
"BLD",8364,"ABPKG")
n^n^G.IMAGING DEVELOPMENT TEAM@AADOMAIN.EXT
"BLD",8364,"INI")
PRE^MAGIP188
"BLD",8364,"INID")
n^y^n
"BLD",8364,"INIT")
POS^MAGIP188
"BLD",8364,"KRN",0)
^9.67PA^779.2^20
"BLD",8364,"KRN",.4,0)
.4
"BLD",8364,"KRN",.4,"NM",0)
^9.68A^^
"BLD",8364,"KRN",.401,0)
.401
"BLD",8364,"KRN",.402,0)
.402
"BLD",8364,"KRN",.403,0)
.403
"BLD",8364,"KRN",.5,0)
.5
"BLD",8364,"KRN",.84,0)
.84
"BLD",8364,"KRN",3.6,0)
3.6
"BLD",8364,"KRN",3.8,0)
3.8
"BLD",8364,"KRN",9.2,0)
9.2
"BLD",8364,"KRN",9.8,0)
9.8
"BLD",8364,"KRN",9.8,"NM",0)
^9.68A^5^4
"BLD",8364,"KRN",9.8,"NM",2,0)
MAGGTU4D^^0^B5740596
"BLD",8364,"KRN",9.8,"NM",3,0)
MAGIP188^^0^B4692901
"BLD",8364,"KRN",9.8,"NM",4,0)
MAGGTU4M^^0^B22884338
"BLD",8364,"KRN",9.8,"NM",5,0)
MAGGTSYS^^0^B27028795
"BLD",8364,"KRN",9.8,"NM","B","MAGGTSYS",5)

"BLD",8364,"KRN",9.8,"NM","B","MAGGTU4D",2)

"BLD",8364,"KRN",9.8,"NM","B","MAGGTU4M",4)

"BLD",8364,"KRN",9.8,"NM","B","MAGIP188",3)

"BLD",8364,"KRN",19,0)
19
"BLD",8364,"KRN",19,"NM",0)
^9.68A^^
"BLD",8364,"KRN",19.1,0)
19.1
"BLD",8364,"KRN",101,0)
101
"BLD",8364,"KRN",409.61,0)
409.61
"BLD",8364,"KRN",771,0)
771
"BLD",8364,"KRN",779.2,0)
779.2
"BLD",8364,"KRN",870,0)
870
"BLD",8364,"KRN",8989.51,0)
8989.51
"BLD",8364,"KRN",8989.52,0)
8989.52
"BLD",8364,"KRN",8994,0)
8994
"BLD",8364,"KRN",8994,"NM",0)
^9.68A^2^2
"BLD",8364,"KRN",8994,"NM",1,0)
MAG5 GET MUSE TABLE^^0
"BLD",8364,"KRN",8994,"NM",2,0)
MAG5 GET NETLOC INFO^^0
"BLD",8364,"KRN",8994,"NM","B","MAG5 GET MUSE TABLE",1)

"BLD",8364,"KRN",8994,"NM","B","MAG5 GET NETLOC INFO",2)

"BLD",8364,"KRN","B",.4,.4)

"BLD",8364,"KRN","B",.401,.401)

"BLD",8364,"KRN","B",.402,.402)

"BLD",8364,"KRN","B",.403,.403)

"BLD",8364,"KRN","B",.5,.5)

"BLD",8364,"KRN","B",.84,.84)

"BLD",8364,"KRN","B",3.6,3.6)

"BLD",8364,"KRN","B",3.8,3.8)

"BLD",8364,"KRN","B",9.2,9.2)

"BLD",8364,"KRN","B",9.8,9.8)

"BLD",8364,"KRN","B",19,19)

"BLD",8364,"KRN","B",19.1,19.1)

"BLD",8364,"KRN","B",101,101)

"BLD",8364,"KRN","B",409.61,409.61)

"BLD",8364,"KRN","B",771,771)

"BLD",8364,"KRN","B",779.2,779.2)

"BLD",8364,"KRN","B",870,870)

"BLD",8364,"KRN","B",8989.51,8989.51)

"BLD",8364,"KRN","B",8989.52,8989.52)

"BLD",8364,"KRN","B",8994,8994)

"BLD",8364,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8364,"QUES",0)
^9.62^^
"BLD",8364,"REQB",0)
^9.611^2^2
"BLD",8364,"REQB",1,0)
MAG*3.0*191^2
"BLD",8364,"REQB",2,0)
MAG*3.0*185^2
"BLD",8364,"REQB","B","MAG*3.0*185",2)

"BLD",8364,"REQB","B","MAG*3.0*191",1)

"DATA",2006.171,1,0)
RestingECG
"DATA",2006.171,2,0)
Stress
"DATA",2006.171,3,0)
HiRes
"DATA",2006.171,4,0)
Holter
"DATA",2006.171,5,0)
ZIO
"FIA",2006.171)
MUSE TEST TYPES
"FIA",2006.171,0)
^MAG(2006.171,
"FIA",2006.171,0,0)
2006.171
"FIA",2006.171,0,1)
y^y^f^^n^^y^o^n
"FIA",2006.171,0,10)

"FIA",2006.171,0,11)

"FIA",2006.171,0,"RLRO")

"FIA",2006.171,0,"VR")
3.0^MAG
"FIA",2006.171,2006.171)
0
"FIA",2006.172)
MUSE FORMAT TABLE
"FIA",2006.172,0)
^MAG(2006.172,
"FIA",2006.172,0,0)
2006.172
"FIA",2006.172,0,1)
y^y^f^^^^n
"FIA",2006.172,0,10)

"FIA",2006.172,0,11)

"FIA",2006.172,0,"RLRO")

"FIA",2006.172,0,"VR")
3.0^MAG
"FIA",2006.172,2006.172)
0
"INI")
PRE^MAGIP188
"INIT")
POS^MAGIP188
"KRN",8994,3430,-1)
0^1
"KRN",8994,3430,0)
MAG5 GET MUSE TABLE^TABLE^MAGGTU4M^2^R^^^1
"KRN",8994,3430,1,0)
^8994.01^1^1^3180113^^^^
"KRN",8994,3430,1,1,0)
This RPC will return entries from the MUSE FORMAT TABLE
"KRN",8994,3430,2,0)
^8994.02A^1^1
"KRN",8994,3430,2,1,0)
IEN^1^30^1^1
"KRN",8994,3430,2,1,1,0)
^8994.021^8^8^3180113^^^^
"KRN",8994,3430,2,1,1,1,0)
IEN=nnn, or IEN='SITE'  or IEN='ALL'
"KRN",8994,3430,2,1,1,2,0)
 nnn is the IEN from NETWORK LOCATION File for the MUSE System.
"KRN",8994,3430,2,1,1,3,0)
  If IEN=nnn then all entries in the MUSE FORMAT TABLE for
"KRN",8994,3430,2,1,1,4,0)
that MUSE System will be returned.
"KRN",8994,3430,2,1,1,5,0)
  If IEN='SITE', then all entries in the  MUSE FORMAT TABLE
"KRN",8994,3430,2,1,1,6,0)
 File will be returned.
"KRN",8994,3430,2,1,1,7,0)
  If IEN='ALL' then all entries in the MUSE FORMAT TABLE
"KRN",8994,3430,2,1,1,8,0)
 File will be returned. Including the Default Format IDs.
"KRN",8994,3430,2,"B","IEN",1)

"KRN",8994,3430,2,"PARAMSEQ",1,1)

"KRN",8994,3430,3,0)
^8994.03^7^7^3180113^^^^
"KRN",8994,3430,3,1,0)
Array of entries in the MUSE FORMAT TABLE.
"KRN",8994,3430,3,2,0)
Format of each entry in the Array is : 
"KRN",8994,3430,3,3,0)
  Piece 1: NETWORK LOCATION Name
"KRN",8994,3430,3,4,0)
  Piece 2: NETWORK LOCATION IEN
"KRN",8994,3430,3,5,0)
  Piece 3: TEST TYPE
"KRN",8994,3430,3,6,0)
  Piece 4: YES/NO if a Grid is displayed
"KRN",8994,3430,3,7,0)
  Piece 5: Format ID Number
"KRN",8994,3431,-1)
0^2
"KRN",8994,3431,0)
MAG5 GET NETLOC INFO^NETLOC^MAGGTU4M^1^R
"KRN",8994,3431,1,0)
^8994.01^3^3^3180105^^
"KRN",8994,3431,1,1,0)
Returns a string of information from NETWORK LOCATION File.
"KRN",8994,3431,1,2,0)
Information includes:
"KRN",8994,3431,1,3,0)
Description (.01), Physical Refernece (1), Operational Status (5)
"KRN",8994,3431,2,0)
^8994.02A^1^1
"KRN",8994,3431,2,1,0)
IEN^1^20^1^1
"KRN",8994,3431,2,1,1,0)
^8994.021^1^1^3180105^^
"KRN",8994,3431,2,1,1,1,0)
Internal Entry number for NETWORK LOCATION FILE.
"KRN",8994,3431,2,"B","IEN",1)

"KRN",8994,3431,2,"PARAMSEQ",1,1)

"KRN",8994,3431,3,0)
^8994.03^4^4^3180105^^
"KRN",8994,3431,3,1,0)
String returned in format : 
"KRN",8994,3431,3,2,0)
Description ^ Physical Reference ^ Operational Status.
"KRN",8994,3431,3,3,0)
 example :
"KRN",8994,3431,3,4,0)
  MUSE-9  ^    \\Server\Vol000\  ^         OnLine
"MBREQ")
0
"ORD",16,8994)
8994;16;1;;;;;;;RPCDEL^XPDIA1
"ORD",16,8994,0)
REMOTE PROCEDURE
"PKG",454,-1)
1^1
"PKG",454,0)
IMAGING^MAG^Imaging-V1 to release 
"PKG",454,20,0)
^9.402P^^
"PKG",454,22,0)
^9.49I^1^1
"PKG",454,22,1,0)
3.0^3020319^3020517^126
"PKG",454,22,1,"PAH",1,0)
188^3180320^126
"PKG",454,22,1,"PAH",1,1,0)
^^15^15^3180320
"PKG",454,22,1,"PAH",1,1,1,0)
MAG*3.0*188
"PKG",454,22,1,"PAH",1,1,2,0)
This patch will resolve the following issues for Clinical Display:
"PKG",454,22,1,"PAH",1,1,3,0)
The ability to Show or Hide the Grid on the EKG Display and 
"PKG",454,22,1,"PAH",1,1,4,0)
while printing.
"PKG",454,22,1,"PAH",1,1,5,0)
The ability to select multiple EKG's for display and printing.
"PKG",454,22,1,"PAH",1,1,6,0)
The ability for a site to change the Format ID that is used
"PKG",454,22,1,"PAH",1,1,7,0)
to generate the EKG Image.
"PKG",454,22,1,"PAH",1,1,8,0)
CT scrolling issue in the Radiology Viewer.
"PKG",454,22,1,"PAH",1,1,9,0)
This will check the routines from a BUILD file.
"PKG",454,22,1,"PAH",1,1,10,0)
Select BUILD NAME:    MAG*3.0*188     IMAGING
"PKG",454,22,1,"PAH",1,1,11,0)
MAGGTSYS  value = 27028795
"PKG",454,22,1,"PAH",1,1,12,0)
MAGGTU4D  value = 5740596
"PKG",454,22,1,"PAH",1,1,13,0)
MAGGTU4M  value = 22884338
"PKG",454,22,1,"PAH",1,1,14,0)
MAGIP188  value = 4692901
"PKG",454,22,1,"PAH",1,1,15,0)
done
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","MAGGTSYS")
0^5^B27028795
"RTN","MAGGTSYS",1,0)
MAGGTSYS ;WOIFO/GEK/NST - Calls from Imaging windows for System Manager ; 22 Dec 2010 10:51 AM
"RTN","MAGGTSYS",2,0)
 ;;3.0;IMAGING;**59,93,117,185,188**;Mar 19, 2002;Build 61;Mar 18, 2018
"RTN","MAGGTSYS",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGGTSYS",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTSYS",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGTSYS",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGTSYS",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGTSYS",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGTSYS",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGTSYS",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGTSYS",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGTSYS",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGTSYS",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGTSYS",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGTSYS",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGTSYS",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTSYS",17,0)
 ;;
"RTN","MAGGTSYS",18,0)
 Q
"RTN","MAGGTSYS",19,0)
 ; GETS
"RTN","MAGGTSYS",20,0)
 ; Called from Image Information Advanced in Clinical Display
"RTN","MAGGTSYS",21,0)
 ; NODE:    integer  or "" or  integer^integer  or  "N"_integer
"RTN","MAGGTSYS",22,0)
 ; if Integer -  this is IMAGE IEN, we display IMAGE entry for IEN
"RTN","MAGGTSYS",23,0)
 ; if ""      - we defalut to Last entry in IMAGE File.
"RTN","MAGGTSYS",24,0)
 ; if int^int -  this is FILE^IEN, we display FM Files for FILE IEN
"RTN","MAGGTSYS",25,0)
 ; if "N"_int -  this is Patch 185 Call. 
"RTN","MAGGTSYS",26,0)
 ;
"RTN","MAGGTSYS",27,0)
GETS(MAGRY,NODE,FLAGS) ; USE GETS^DIQ TO GET FIELD VALUES.   
"RTN","MAGGTSYS",28,0)
 N MAGWIN,I,CT,Y,NC,MAGOUT,MAGERR,TNC,ZZ,MAGIEN,MAGFILE
"RTN","MAGGTSYS",29,0)
 N N0
"RTN","MAGGTSYS",30,0)
 S MAGRY=$NA(^TMP("MAGNODE",$J))
"RTN","MAGGTSYS",31,0)
 K @MAGRY
"RTN","MAGGTSYS",32,0)
 I $L(NODE,"^")>1 D OTH Q  ;
"RTN","MAGGTSYS",33,0)
 I NODE'?.1"N"1.N S @MAGRY@(0)="Node IEN "_NODE_" invalid"
"RTN","MAGGTSYS",34,0)
 I NODE?1"N"1.N D  Q
"RTN","MAGGTSYS",35,0)
 . N MAGVIEN
"RTN","MAGGTSYS",36,0)
 . S MAGVIEN=$E(NODE,2,999)
"RTN","MAGGTSYS",37,0)
 . D IMGINFO^MAGNVQ03(MAGRY,MAGVIEN)  ; Get P34 report
"RTN","MAGGTSYS",38,0)
 . I $G(@MAGRY@(0)) S @MAGRY@(0)="******    Fields for Image IEN: "_MAGVIEN_"    ******" Q
"RTN","MAGGTSYS",39,0)
 . Q
"RTN","MAGGTSYS",40,0)
 S NODE=+$G(NODE)
"RTN","MAGGTSYS",41,0)
 I 'NODE S NODE=$P(^MAG(2005,0),U,3)
"RTN","MAGGTSYS",42,0)
 S MAGIEN=NODE
"RTN","MAGGTSYS",43,0)
 S MAGFILE=$$FILE^MAGGI11(NODE)
"RTN","MAGGTSYS",44,0)
 S MAGWIN=$$BROKER^XWBLIB
"RTN","MAGGTSYS",45,0)
 I 'MAGWIN W !,"MAGIEN","  ",MAGIEN
"RTN","MAGGTSYS",46,0)
 K @MAGRY
"RTN","MAGGTSYS",47,0)
 S @MAGRY@(0)="******    Fields for "_$S(MAGFILE=2005.1:"DELETED ",1:"")_"Image IEN: "_MAGIEN_"    ******"
"RTN","MAGGTSYS",48,0)
 S I=0,CT=0
"RTN","MAGGTSYS",49,0)
 S FLAGS=$S($L($G(FLAGS)):FLAGS,1:"IERN")
"RTN","MAGGTSYS",50,0)
 I MAGFILE'>0 Q  ; problem getting file number
"RTN","MAGGTSYS",51,0)
 D GETS^DIQ(MAGFILE,MAGIEN,"*",FLAGS,"MAGOUT","MAGERR")
"RTN","MAGGTSYS",52,0)
 D LOAD
"RTN","MAGGTSYS",53,0)
 I 'MAGWIN W !,"AFTER LOAD","MAGIEN= ",MAGIEN
"RTN","MAGGTSYS",54,0)
 S N0=$G(^MAG(2005,MAGIEN,0))
"RTN","MAGGTSYS",55,0)
 S MAGIEN=$P(N0,"^",3) I MAGIEN]"" D  ;
"RTN","MAGGTSYS",56,0)
 . S MAGFILE="2005.2"
"RTN","MAGGTSYS",57,0)
 . S CT=CT+1,@MAGRY@(CT)=" ====== FULL File(Tier1):  NETWORK LOCATION  "_MAGIEN_"  ======================"
"RTN","MAGGTSYS",58,0)
 . D GETS^DIQ(MAGFILE,MAGIEN,"*",FLAGS,"MAGOUT","MAGERR")
"RTN","MAGGTSYS",59,0)
 . D LOAD
"RTN","MAGGTSYS",60,0)
 S MAGIEN=$P(N0,"^",4) I MAGIEN]"" D  ;
"RTN","MAGGTSYS",61,0)
 . S MAGFILE="2005.2"
"RTN","MAGGTSYS",62,0)
 . S CT=CT+1,@MAGRY@(CT)=" ====== Abstract(Tier1): NETWORK LOCATION  "_MAGIEN_" ======================"
"RTN","MAGGTSYS",63,0)
 . D GETS^DIQ(MAGFILE,MAGIEN,"*",FLAGS,"MAGOUT","MAGERR")
"RTN","MAGGTSYS",64,0)
 . D LOAD
"RTN","MAGGTSYS",65,0)
 S MAGIEN=$P(N0,"^",5) I MAGIEN]"" D  ;
"RTN","MAGGTSYS",66,0)
 . S MAGFILE="2005.2"
"RTN","MAGGTSYS",67,0)
 . S CT=CT+1,@MAGRY@(CT)=" ====== JukeBox(Tier2): NETWORK LOCATION  "_MAGIEN_" ======================"
"RTN","MAGGTSYS",68,0)
 . D GETS^DIQ(MAGFILE,MAGIEN,"*",FLAGS,"MAGOUT","MAGERR")
"RTN","MAGGTSYS",69,0)
 . D LOAD
"RTN","MAGGTSYS",70,0)
 Q 
"RTN","MAGGTSYS",71,0)
 ;
"RTN","MAGGTSYS",72,0)
LOAD ; p188 T3
"RTN","MAGGTSYS",73,0)
 S NC=MAGIEN_","
"RTN","MAGGTSYS",74,0)
 S I="" F  S I=$O(MAGOUT(MAGFILE,NC,I)) Q:I=""  D
"RTN","MAGGTSYS",75,0)
 . S CT=CT+1
"RTN","MAGGTSYS",76,0)
 . I $G(MAGOUT(MAGFILE,NC,I,"I"))=$G(MAGOUT(MAGFILE,NC,I,"E")) D  Q
"RTN","MAGGTSYS",77,0)
 . . S ZZ=I,$E(ZZ,45,999)=" = "_$G(MAGOUT(MAGFILE,NC,I,"E"))
"RTN","MAGGTSYS",78,0)
 . . S @MAGRY@(CT)=ZZ
"RTN","MAGGTSYS",79,0)
 . . Q
"RTN","MAGGTSYS",80,0)
 . ;
"RTN","MAGGTSYS",81,0)
 . S ZZ=I,$E(ZZ,25,999)=" = ("_$G(MAGOUT(MAGFILE,NC,I,"I"))_") "
"RTN","MAGGTSYS",82,0)
 . I ($L(ZZ)>44) S ZZ=ZZ_" = "_$G(MAGOUT(MAGFILE,NC,I,"E")) S @MAGRY@(CT)=ZZ Q
"RTN","MAGGTSYS",83,0)
 . I ($L(ZZ)<45) S $E(ZZ,45,999)=" = "_$G(MAGOUT(MAGFILE,NC,I,"E")) S @MAGRY@(CT)=ZZ Q
"RTN","MAGGTSYS",84,0)
 . Q
"RTN","MAGGTSYS",85,0)
 I $P($G(^MAG(MAGFILE,MAGIEN,2)),"^",6)=8925 D
"RTN","MAGGTSYS",86,0)
 . K MAGOUT,MAGERR
"RTN","MAGGTSYS",87,0)
 . S CT=CT+1,@MAGRY@(CT)="   ***************   TIU    *************** "
"RTN","MAGGTSYS",88,0)
 . S CT=CT+1,@MAGRY@(CT)="   **** Field Values for TIUDA: "_$P(^MAG(MAGFILE,MAGIEN,2),"^",7)_"  ****"
"RTN","MAGGTSYS",89,0)
 . D GETS^DIQ(8925,$P(^MAG(MAGFILE,MAGIEN,2),"^",7),"*",FLAGS,"MAGOUT","MAGERR")
"RTN","MAGGTSYS",90,0)
 . S NC=$P(^MAG(MAGFILE,MAGIEN,2),"^",7)_","
"RTN","MAGGTSYS",91,0)
 . S I="" F  S I=$O(MAGOUT(8925,NC,I)) Q:I=""  D
"RTN","MAGGTSYS",92,0)
 . . S CT=CT+1
"RTN","MAGGTSYS",93,0)
 . . I $G(MAGOUT(8925,NC,I,"I"))=$G(MAGOUT(8925,NC,I,"E")) D  Q
"RTN","MAGGTSYS",94,0)
 . . . S ZZ=I,$E(ZZ,45,999)=" = "_$G(MAGOUT(8925,NC,I,"E"))
"RTN","MAGGTSYS",95,0)
 . . . S @MAGRY@(CT)=ZZ
"RTN","MAGGTSYS",96,0)
 . . . Q
"RTN","MAGGTSYS",97,0)
 . . ;
"RTN","MAGGTSYS",98,0)
 . . S ZZ=I,$E(ZZ,25,999)=" = ("_$G(MAGOUT(8925,NC,I,"I"))_") "
"RTN","MAGGTSYS",99,0)
 . . I ($L(ZZ)>44) S ZZ=ZZ_" = "_$G(MAGOUT(8925,NC,I,"E")) S @MAGRY@(CT)=ZZ Q
"RTN","MAGGTSYS",100,0)
 . . I ($L(ZZ)<45) S $E(ZZ,45,999)=" = "_$G(MAGOUT(8925,NC,I,"E")) S @MAGRY@(CT)=ZZ Q
"RTN","MAGGTSYS",101,0)
 . . Q
"RTN","MAGGTSYS",102,0)
 . Q
"RTN","MAGGTSYS",103,0)
 Q
"RTN","MAGGTSYS",104,0)
OTH ; Called internally
"RTN","MAGGTSYS",105,0)
 ; p188 T3 added extra functionality for the Imaging Info Advanced window.
"RTN","MAGGTSYS",106,0)
 N MAGFDA,MAGGLB
"RTN","MAGGTSYS",107,0)
 K @MAGRY
"RTN","MAGGTSYS",108,0)
 W !,"NODE  ",NODE
"RTN","MAGGTSYS",109,0)
 S I=0,CT=0
"RTN","MAGGTSYS",110,0)
 S FLAGS=$S($L($G(FLAGS)):FLAGS,1:"IERN")
"RTN","MAGGTSYS",111,0)
 S MAGFILE=$P(NODE,"^",1),MAGIEN=$P(NODE,"^",2)
"RTN","MAGGTSYS",112,0)
 I MAGIEN="ALL" D  Q  ;
"RTN","MAGGTSYS",113,0)
 . S MAGGLB=^DIC(MAGFILE,0,"GL")
"RTN","MAGGTSYS",114,0)
 . S MAGGLB=$E(MAGGLB,1,$L(MAGGLB)-1)_")"
"RTN","MAGGTSYS",115,0)
 . S CT=CT+1 S @MAGRY@(CT)=" MAGGLB "_MAGGLB
"RTN","MAGGTSYS",116,0)
 . S MAGFDA=0 F  S MAGFDA=$O(@MAGGLB@(MAGFDA)) Q:'MAGFDA  D  ;
"RTN","MAGGTSYS",117,0)
 . . S MAGIEN=MAGFDA
"RTN","MAGGTSYS",118,0)
 . . S CT=CT+1
"RTN","MAGGTSYS",119,0)
 . . S @MAGRY@(CT)=" ====== IEN  "_MAGIEN_"  ======================"
"RTN","MAGGTSYS",120,0)
 . . D GETS^DIQ(MAGFILE,MAGIEN,"*",FLAGS,"MAGOUT","MAGERR")
"RTN","MAGGTSYS",121,0)
 . . D LOAD
"RTN","MAGGTSYS",122,0)
 . Q
"RTN","MAGGTSYS",123,0)
 I MAGIEN="" D  ;
"RTN","MAGGTSYS",124,0)
 . I MAGFILE="2006.1" S MAGIEN=$$DUZ2PLC^MAGBAPIP
"RTN","MAGGTSYS",125,0)
 . I MAGFILE="2005.2" S MAGIEN=$O(^MAG(2005.2,0))
"RTN","MAGGTSYS",126,0)
 S FLAGS=$S($L($G(FLAGS)):FLAGS,1:"IERN")
"RTN","MAGGTSYS",127,0)
 S @MAGRY@(0)="******    Fields for FILE : "_MAGFILE
"RTN","MAGGTSYS",128,0)
 D GETS^DIQ(MAGFILE,MAGIEN,"*",FLAGS,"MAGOUT","MAGERR")
"RTN","MAGGTSYS",129,0)
 D LOAD
"RTN","MAGGTSYS",130,0)
 ;
"RTN","MAGGTSYS",131,0)
 Q 
"RTN","MAGGTU4D")
0^2^B5740596
"RTN","MAGGTU4D",1,0)
MAGGTU4D ;WOIFO/SG/NST/JSL/GEK - VERSION CONTROL (CLINICAL DISPLAY) ; 25 May 2014  2:24 PM
"RTN","MAGGTU4D",2,0)
 ;;3.0;IMAGING;**93,94,106,117,122,131,149,138,156,161,167,181,191,188**;Mar 19, 2002;Build 61;Mar 18, 2018
"RTN","MAGGTU4D",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGGTU4D",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4D",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGTU4D",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGTU4D",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGTU4D",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGTU4D",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGTU4D",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGTU4D",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGTU4D",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGTU4D",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGTU4D",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGTU4D",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGTU4D",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4D",17,0)
 ;;
"RTN","MAGGTU4D",18,0)
 ; This routine contains the version control code and data specific
"RTN","MAGGTU4D",19,0)
 ; to the Clinical Display application. DO NOT ADD ANYTHING ELSE!
"RTN","MAGGTU4D",20,0)
 Q
"RTN","MAGGTU4D",21,0)
 ;
"RTN","MAGGTU4D",22,0)
CLVERCT ;***** VERSION CONTROL TABLE FOR THE CLINICAL DISPLAY CLIENTS
"RTN","MAGGTU4D",23,0)
 ;;==================================================================
"RTN","MAGGTU4D",24,0)
 ;;| Version |Build|Seq #|                Comment                   |
"RTN","MAGGTU4D",25,0)
 ;;|---------+-----+------------------------------------------------|
"RTN","MAGGTU4D",26,0)
 ;;| 3.0.188 |   6 |  89 | Mar 2018                                 |
"RTN","MAGGTU4D",27,0)
 ;;| 3.0.191 |   2 |  88 | Aug 2017                                 |
"RTN","MAGGTU4D",28,0)
 ;;| 3.0.181 |   3 |  87 | Jun 2017                                 |
"RTN","MAGGTU4D",29,0)
 ;;| 3.0.167 |   8 |  86 | Jan 2017                                 |
"RTN","MAGGTU4D",30,0)
 ;;| 3.0.161 |   2 |  85 | May 2015                                 |
"RTN","MAGGTU4D",31,0)
 ;;| 3.0.149 |   4 |  75 | Sep 2014                                 |
"RTN","MAGGTU4D",32,0)
 ;;| 3.0.130 |  18 |  70 | Aug 2013                                 |
"RTN","MAGGTU4D",33,0)
 ;;==================================================================
"RTN","MAGGTU4D",34,0)
 ;
"RTN","MAGGTU4D",35,0)
 ; Each row of the version control table contains the version and
"RTN","MAGGTU4D",36,0)
 ; build number of a supported client. Released patches must also
"RTN","MAGGTU4D",37,0)
 ; indicate the sequential numbers.
"RTN","MAGGTU4D",38,0)
 ;
"RTN","MAGGTU4D",39,0)
 ; Sort order of the rows does not matter. However, the reversed
"RTN","MAGGTU4D",40,0)
 ; order of patch sequential numbers is recommended.
"RTN","MAGGTU4D",41,0)
 ; NOTE:
"RTN","MAGGTU4D",42,0)
 ;  Patch 188 Did not remove support for any Clients
"RTN","MAGGTU4D",43,0)
 ; 
"RTN","MAGGTU4D",44,0)
 ;  Patch 191 Emergency Patch did not remove support for any clients
"RTN","MAGGTU4D",45,0)
 ;  Patch 181 removed support for
"RTN","MAGGTU4D",46,0)
 ;        - Patch 131  
"RTN","MAGGTU4D",47,0)
 ;  Patch 167 removed support for
"RTN","MAGGTU4D",48,0)
 ;        - Patch 122
"RTN","MAGGTU4D",49,0)
 ;  Patch 149 removed support for 
"RTN","MAGGTU4D",50,0)
 ;        - Patch 117
"RTN","MAGGTU4D",51,0)
 ;        - Patch 106 
"RTN","MAGGTU4D",52,0)
 ;        - Patch  94
"RTN","MAGGTU4D",53,0)
 Q
"RTN","MAGGTU4D",54,0)
 ;
"RTN","MAGGTU4D",55,0)
 ;***** ADDS A CLIENT-SPECIFIC WARNING (IF NECESSARY)
"RTN","MAGGTU4D",56,0)
 ;
"RTN","MAGGTU4D",57,0)
 ; .MAGBUF       Reference to a local array that the warning text
"RTN","MAGGTU4D",58,0)
 ;               is returned to. It is appended to the RPC result
"RTN","MAGGTU4D",59,0)
 ;               array by the caller (WARNING^MAGGTU41).
"RTN","MAGGTU4D",60,0)
 ;
"RTN","MAGGTU4D",61,0)
 ;               Text must be stored at nodes with positive numbers
"RTN","MAGGTU4D",62,0)
 ;               or at the 0-node descendent from those nodes.
"RTN","MAGGTU4D",63,0)
 ;
"RTN","MAGGTU4D",64,0)
 ; CLVER         Client application version (Major.Minor.Patch.Build)
"RTN","MAGGTU4D",65,0)
 ;
"RTN","MAGGTU4D",66,0)
 ; CVRC          Version check code returned by the $$CHKVER1^MAGGTU41
"RTN","MAGGTU4D",67,0)
 ;
"RTN","MAGGTU4D",68,0)
 ; Notes
"RTN","MAGGTU4D",69,0)
 ; =====
"RTN","MAGGTU4D",70,0)
 ;
"RTN","MAGGTU4D",71,0)
 ; If the RPC result array already contains an error message that
"RTN","MAGGTU4D",72,0)
 ; will terminate the client, application, this procedure is not
"RTN","MAGGTU4D",73,0)
 ; called.
"RTN","MAGGTU4D",74,0)
 ;
"RTN","MAGGTU4D",75,0)
WARNING(MAGBUF,CLVER,CVRC) ;
"RTN","MAGGTU4D",76,0)
 Q
"RTN","MAGGTU4M")
0^4^B22884338
"RTN","MAGGTU4M",1,0)
MAGGTU4M ;WOIFO/GEK - MUSE3 VIEWER UTILITIES
"RTN","MAGGTU4M",2,0)
 ;;3.0;IMAGING;**188**;Mar 19, 2002;Build 61;Mar 18, 2018
"RTN","MAGGTU4M",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGGTU4M",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4M",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGGTU4M",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGGTU4M",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGGTU4M",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGGTU4M",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGGTU4M",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGGTU4M",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGGTU4M",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGGTU4M",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGGTU4M",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGGTU4M",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGGTU4M",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGGTU4M",17,0)
 ;;
"RTN","MAGGTU4M",18,0)
 ; This routine contains Utilities for the MUSE FORMAT TABLE
"RTN","MAGGTU4M",19,0)
 ;
"RTN","MAGGTU4M",20,0)
 Q
"RTN","MAGGTU4M",21,0)
 ;
"RTN","MAGGTU4M",22,0)
 ;  The default Format ID's listed below are used to generate the
"RTN","MAGGTU4M",23,0)
 ;  MUSE Test for the specified Test Type.
"RTN","MAGGTU4M",24,0)
 ;  If Site Specific Format ID's have been entered into the 
"RTN","MAGGTU4M",25,0)
 ;  MUSE FORMAT TABLE, those Format ID's will override the defaults
"RTN","MAGGTU4M",26,0)
 ; 
"RTN","MAGGTU4M",27,0)
 ; ***** DEFAULTS for Test Type -> Format ID mapping 
"RTN","MAGGTU4M",28,0)
 ;;===============================================================
"RTN","MAGGTU4M",29,0)
 ; Test Type    Grid    Format ID
"RTN","MAGGTU4M",30,0)
 ; RestingECG     Y        6
"RTN","MAGGTU4M",31,0)
 ; Stress         Y        7
"RTN","MAGGTU4M",32,0)
 ; Holter         Y        8
"RTN","MAGGTU4M",33,0)
 ; HiRes          Y        9
"RTN","MAGGTU4M",34,0)
 ; RestingECG     N        12
"RTN","MAGGTU4M",35,0)
 ; HiRes          N        13
"RTN","MAGGTU4M",36,0)
 ; Stress         N        14
"RTN","MAGGTU4M",37,0)
 ; Holter         N        15
"RTN","MAGGTU4M",38,0)
 ;;===============================================================
"RTN","MAGGTU4M",39,0)
 ;
"RTN","MAGGTU4M",40,0)
NETLOC(MAGRY,IEN) ;RPC [MAG4 GET NETLOC INFO]
"RTN","MAGGTU4M",41,0)
 ; Gets info from Network Location file.
"RTN","MAGGTU4M",42,0)
 ; IEN is the Internal Entry Number in the NETWORK LOCATION File
"RTN","MAGGTU4M",43,0)
 ;
"RTN","MAGGTU4M",44,0)
 ; The Return String is in the format :
"RTN","MAGGTU4M",45,0)
 ; .01 Description  ^  Physical Reference ^ Operational Status  (OnLine/OffLine)
"RTN","MAGGTU4M",46,0)
 N IC,FNUM,MAGZZ,MAGERR
"RTN","MAGGTU4M",47,0)
 N $ETRAP,$ESTACK S $ETRAP="D ERR^MAGGTERR"
"RTN","MAGGTU4M",48,0)
 S FNUM="2005.2"
"RTN","MAGGTU4M",49,0)
 K MAGRY
"RTN","MAGGTU4M",50,0)
 I '$G(IEN) D  Q  ;
"RTN","MAGGTU4M",51,0)
 . S MAGRY="0^INVALID Input: "_IEN
"RTN","MAGGTU4M",52,0)
 . Q
"RTN","MAGGTU4M",53,0)
 I '$D(^MAG(2005.2,IEN,0)) D  Q  ;
"RTN","MAGGTU4M",54,0)
 . S MAGRY="0^INVALID NETWORK LOCATION Entry: "_IEN
"RTN","MAGGTU4M",55,0)
 . Q
"RTN","MAGGTU4M",56,0)
 K MAGZZ,MAGERR
"RTN","MAGGTU4M",57,0)
 D GETS^DIQ(FNUM,IEN,".01;1;5","EI","MAGZZ","MAGERR")
"RTN","MAGGTU4M",58,0)
 S IC=IEN_","
"RTN","MAGGTU4M",59,0)
 S MAGRY="1^"_MAGZZ(FNUM,IC,".01","E")_"^"_IEN_"^"_MAGZZ(FNUM,IC,"1","E")_"^"_MAGZZ(FNUM,IC,"5","E")
"RTN","MAGGTU4M",60,0)
 Q
"RTN","MAGGTU4M",61,0)
TABLE(MAGRY,IEN) ;RPC [MAG4 GET MUSE TABLE]
"RTN","MAGGTU4M",62,0)
 ;  IEN is the Internal Entry Number in the NETWORK LOCATION File.
"RTN","MAGGTU4M",63,0)
 ;  This will return all MUSE FORMAT TABLE entries for the IEN.
"RTN","MAGGTU4M",64,0)
 ;    or
"RTN","MAGGTU4M",65,0)
 ;  IEN = 'SITE'
"RTN","MAGGTU4M",66,0)
 ;  This will return MUSE FORMAT TABLE entries that are defined for
"RTN","MAGGTU4M",67,0)
 ;  MUSE Sites.
"RTN","MAGGTU4M",68,0)
 ;    or
"RTN","MAGGTU4M",69,0)
 ;  IEN = 'ALL'
"RTN","MAGGTU4M",70,0)
 ;  This will return an Array, including the Default Format mapping
"RTN","MAGGTU4M",71,0)
 ;  in a format that can be shown to the user.
"RTN","MAGGTU4M",72,0)
 ;
"RTN","MAGGTU4M",73,0)
 N I,CT,NETLOC,IC,FNUM,MAGZZ,MAGERR
"RTN","MAGGTU4M",74,0)
 N $ETRAP,$ESTACK S $ETRAP="D ERRA^MAGGTERR"
"RTN","MAGGTU4M",75,0)
 S FNUM="2006.172"
"RTN","MAGGTU4M",76,0)
 S CT=0
"RTN","MAGGTU4M",77,0)
 K MAGRY
"RTN","MAGGTU4M",78,0)
 I IEN="ALL" D ALL Q  ;
"RTN","MAGGTU4M",79,0)
 I IEN="SITE" D SITE Q  ;
"RTN","MAGGTU4M",80,0)
 I '$G(IEN) D  Q  ;
"RTN","MAGGTU4M",81,0)
 . S MAGRY(0)="0^INVALID Input: "_IEN
"RTN","MAGGTU4M",82,0)
 . Q
"RTN","MAGGTU4M",83,0)
 I '$D(^MAG(2005.2,IEN,0)) D  Q  ;
"RTN","MAGGTU4M",84,0)
 . S MAGRY(0)="0^INVALID NETWORK LOCATION Entry: "_IEN
"RTN","MAGGTU4M",85,0)
 . Q
"RTN","MAGGTU4M",86,0)
 S NETLOC=$P(^MAG(2005.2,IEN,0),"^",1)
"RTN","MAGGTU4M",87,0)
 I '$D(^MAG(2006.172,"C",IEN)) D  Q  ;
"RTN","MAGGTU4M",88,0)
 . S MAGRY(0)="0^There are no MUSE FORMAT TABLE entries for: "_NETLOC_" ("_IEN_")"
"RTN","MAGGTU4M",89,0)
 . Q
"RTN","MAGGTU4M",90,0)
 S I="" F  S I=$O(^MAG(2006.172,"C",IEN,I)) Q:'I  D  ;
"RTN","MAGGTU4M",91,0)
 . K MAGZZ,MAGERR
"RTN","MAGGTU4M",92,0)
 . D GETS^DIQ(FNUM,I,".01;1;2;3;4","EI","MAGZZ","MAGERR")
"RTN","MAGGTU4M",93,0)
 . S CT=CT+1
"RTN","MAGGTU4M",94,0)
 . S IC=I_","
"RTN","MAGGTU4M",95,0)
 . S MAGRY(CT)=MAGZZ(FNUM,IC,1,"E")_"^"_IEN_"^"_MAGZZ(FNUM,IC,2,"E")
"RTN","MAGGTU4M",96,0)
 . S MAGRY(CT)=MAGRY(CT)_"^"_MAGZZ(FNUM,IC,3,"E")_"^"_MAGZZ(FNUM,IC,4,"E")
"RTN","MAGGTU4M",97,0)
 . Q
"RTN","MAGGTU4M",98,0)
 I CT=0 S MAGRY(0)="0^0 Entries in MUSE FORMAT TABLE for: "_MAGZZ(FNUM,IC,1,"E")_" ("_IEN_")"
"RTN","MAGGTU4M",99,0)
 I CT>0 S MAGRY(0)="1^"_CT_" MUSE FORMAT TABLE Entries for: "_MAGZZ(FNUM,IC,1,"E")_" ("_IEN_")"
"RTN","MAGGTU4M",100,0)
 Q
"RTN","MAGGTU4M",101,0)
SITE ;called internally
"RTN","MAGGTU4M",102,0)
 ; We get here if user wants ALL MUSE FORMAT TABLE Entered at this VistA Site.
"RTN","MAGGTU4M",103,0)
 S MAGRY(0)="1^Returning All entries in MUSE FORMAT TABLE"
"RTN","MAGGTU4M",104,0)
 N J
"RTN","MAGGTU4M",105,0)
 S J=0
"RTN","MAGGTU4M",106,0)
 F  S J=$O(^MAG(2006.172,J)) Q:'J  D  ;
"RTN","MAGGTU4M",107,0)
 . K MAGZZ,MAGERR
"RTN","MAGGTU4M",108,0)
 . D GETS^DIQ(FNUM,J,".01;1;2;3;4","EI","MAGZZ","MAGERR")
"RTN","MAGGTU4M",109,0)
 . S CT=CT+1
"RTN","MAGGTU4M",110,0)
 . S IC=J_","
"RTN","MAGGTU4M",111,0)
 . S MAGRY(CT)=MAGZZ(FNUM,IC,1,"E")_"^"_MAGZZ(FNUM,IC,1,"I")_"^"_MAGZZ(FNUM,IC,2,"E")
"RTN","MAGGTU4M",112,0)
 . S MAGRY(CT)=MAGRY(CT)_"^"_MAGZZ(FNUM,IC,3,"E")_"^"_MAGZZ(FNUM,IC,4,"E")
"RTN","MAGGTU4M",113,0)
 . Q
"RTN","MAGGTU4M",114,0)
 I CT=0 S MAGRY(0)="0^0 Entries in MUSE FORMAT TABLE."
"RTN","MAGGTU4M",115,0)
 I CT>0 S MAGRY(0)="1^"_CT_" MUSE FORMAT TABLE Entries."
"RTN","MAGGTU4M",116,0)
 Q
"RTN","MAGGTU4M",117,0)
ALL ;called internally
"RTN","MAGGTU4M",118,0)
 ; This function will return an array of MUSE FORMAT TABLE entries for Display
"RTN","MAGGTU4M",119,0)
 ; to the user.
"RTN","MAGGTU4M",120,0)
 ; This Array will include the 'Default' values that are used, and any 
"RTN","MAGGTU4M",121,0)
 ; Site Specific entries in the MUSE FORMAT TABLE File.
"RTN","MAGGTU4M",122,0)
 ;
"RTN","MAGGTU4M",123,0)
 S MAGRY(1)="Site^IEN^Test Type^Grid^Format ID"
"RTN","MAGGTU4M",124,0)
 S MAGRY(2)="All Sites^0^RestingECG^Yes^6"
"RTN","MAGGTU4M",125,0)
 S MAGRY(3)="All Sites^0^Stress^Yes^7"
"RTN","MAGGTU4M",126,0)
 S MAGRY(4)="All Sites^0^Holter^Yes^8"
"RTN","MAGGTU4M",127,0)
 S MAGRY(5)="All Sites^0^HiRes^Yes^9"
"RTN","MAGGTU4M",128,0)
 ;
"RTN","MAGGTU4M",129,0)
 S MAGRY(6)="All Sites^0^RestingECG^No^12"
"RTN","MAGGTU4M",130,0)
 S MAGRY(7)="All Sites^0^HiRes^No^13"
"RTN","MAGGTU4M",131,0)
 S MAGRY(8)="All Sites^0^Stress^No^14"
"RTN","MAGGTU4M",132,0)
 S MAGRY(9)="All Sites^0^Holter^No^15"
"RTN","MAGGTU4M",133,0)
 S CT=9
"RTN","MAGGTU4M",134,0)
 D SITE
"RTN","MAGGTU4M",135,0)
 S MAGRY(0)="1^All Format Table entries, including the Default Format IDs."
"RTN","MAGGTU4M",136,0)
 Q
"RTN","MAGIP188")
0^3^B4692901
"RTN","MAGIP188",1,0)
MAGIP188 ;WOIFO/GEK - INSTALL CODE FOR MAG*3.0*188 MUSE Issues ;
"RTN","MAGIP188",2,0)
 ;;3.0;IMAGING;**188**;Mar 19, 2002;Build 61;Mar 18, 2018
"RTN","MAGIP188",3,0)
 ;; Per VHA Directive 2004-038, this routine should not be modified.
"RTN","MAGIP188",4,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGIP188",5,0)
 ;; | Property of the US Government.                                |
"RTN","MAGIP188",6,0)
 ;; | No permission to copy or redistribute this software is given. |
"RTN","MAGIP188",7,0)
 ;; | Use of unreleased versions of this software requires the user |
"RTN","MAGIP188",8,0)
 ;; | to execute a written test agreement with the VistA Imaging    |
"RTN","MAGIP188",9,0)
 ;; | Development Office of the Department of Veterans Affairs,     |
"RTN","MAGIP188",10,0)
 ;; | telephone (301) 734-0100.                                     |
"RTN","MAGIP188",11,0)
 ;; | The Food and Drug Administration classifies this software as  |
"RTN","MAGIP188",12,0)
 ;; | a medical device.  As such, it may not be changed in any way. |
"RTN","MAGIP188",13,0)
 ;; | Modifications to this software may result in an adulterated   |
"RTN","MAGIP188",14,0)
 ;; | medical device under 21CFR820, the use of which is considered |
"RTN","MAGIP188",15,0)
 ;; | to be a violation of US Federal Statutes.                     |
"RTN","MAGIP188",16,0)
 ;; +---------------------------------------------------------------+
"RTN","MAGIP188",17,0)
 ;;
"RTN","MAGIP188",18,0)
 ; There are no environment checks here but the MAGIP188 has to be
"RTN","MAGIP188",19,0)
 ; referenced by the "Environment Check Routine" field of the KIDS
"RTN","MAGIP188",20,0)
 ; build so that entry points of the routine are available to the
"RTN","MAGIP188",21,0)
 ; KIDS during all installation phases.
"RTN","MAGIP188",22,0)
 ;
"RTN","MAGIP188",23,0)
 Q
"RTN","MAGIP188",24,0)
 ;
"RTN","MAGIP188",25,0)
 ;+++++ INSTALLATION ERROR HANDLING
"RTN","MAGIP188",26,0)
ERROR ;
"RTN","MAGIP188",27,0)
 S:$D(XPDNM) XPDABORT=1
"RTN","MAGIP188",28,0)
 ;--- Display the messages and store them to the INSTALL file
"RTN","MAGIP188",29,0)
 D DUMP^MAGUERR1(),ABTMSG^MAGKIDS()
"RTN","MAGIP188",30,0)
 Q
"RTN","MAGIP188",31,0)
 ;
"RTN","MAGIP188",32,0)
 ;***** POST-INSTALL CODE
"RTN","MAGIP188",33,0)
POS ;
"RTN","MAGIP188",34,0)
 N CALLBACK
"RTN","MAGIP188",35,0)
 D CLEAR^MAGUERR(1)
"RTN","MAGIP188",36,0)
 ;
"RTN","MAGIP188",37,0)
 ;--- Link new remote procedures to the Broker context option
"RTN","MAGIP188",38,0)
 ;*** 2 new RPC's  for 188 **
"RTN","MAGIP188",39,0)
 D ADDRPC^MAGQBUT4("MAG5 GET MUSE TABLE","MAG WINDOWS")
"RTN","MAGIP188",40,0)
 D ADDRPC^MAGQBUT4("MAG5 GET NETLOC INFO","MAG WINDOWS")
"RTN","MAGIP188",41,0)
 ;
"RTN","MAGIP188",42,0)
 ;--- Misc Updates
"RTN","MAGIP188",43,0)
 ;*** None for 188 **
"RTN","MAGIP188",44,0)
 ;I $$CP^MAGKIDS("MAG 188 MISC UPDATES ","$$UPDATE^"_$T(+0))<0 D ERROR Q
"RTN","MAGIP188",45,0)
 ; 
"RTN","MAGIP188",46,0)
 ;--- Send the notification e-mail
"RTN","MAGIP188",47,0)
 D BMES^XPDUTL("Post Install Mail Message: "_$$FMTE^XLFDT($$NOW^XLFDT))
"RTN","MAGIP188",48,0)
 D INS^MAGQBUT4(XPDNM,DUZ,$$NOW^XLFDT,XPDA)
"RTN","MAGIP188",49,0)
 ;
"RTN","MAGIP188",50,0)
 Q
"RTN","MAGIP188",51,0)
 ;
"RTN","MAGIP188",52,0)
 ;***** PRE-INSTALL CODE
"RTN","MAGIP188",53,0)
PRE ;
"RTN","MAGIP188",54,0)
 ;
"RTN","MAGIP188",55,0)
 Q
"SEC","^DIC",2006.171,2006.171,0,"AUDIT")
@
"SEC","^DIC",2006.171,2006.171,0,"DD")
@
"SEC","^DIC",2006.171,2006.171,0,"DEL")
@
"SEC","^DIC",2006.171,2006.171,0,"LAYGO")
@
"SEC","^DIC",2006.171,2006.171,0,"RD")
@
"SEC","^DIC",2006.171,2006.171,0,"WR")
@
"SEC","^DIC",2006.172,2006.172,0,"AUDIT")
@
"SEC","^DIC",2006.172,2006.172,0,"DD")
@
"SEC","^DIC",2006.172,2006.172,0,"DEL")
@
"SEC","^DIC",2006.172,2006.172,0,"LAYGO")
@
"SEC","^DIC",2006.172,2006.172,0,"RD")
@
"SEC","^DIC",2006.172,2006.172,0,"WR")
@
"VER")
8.0^22.2
"^DD",2006.171,2006.171,0)
FIELD^^.01^1
"^DD",2006.171,2006.171,0,"DT")
3180105
"^DD",2006.171,2006.171,0,"IX","B",2006.171,.01)

"^DD",2006.171,2006.171,0,"NM","MUSE TEST TYPES")

"^DD",2006.171,2006.171,0,"PT",2006.172,2)

"^DD",2006.171,2006.171,0,"VRPK")
MAG
"^DD",2006.171,2006.171,.01,0)
TEST TYPE^RFJ30^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",2006.171,2006.171,.01,1,0)
^.1
"^DD",2006.171,2006.171,.01,1,1,0)
2006.171^B
"^DD",2006.171,2006.171,.01,1,1,1)
S ^MAG(2006.171,"B",$E(X,1,30),DA)=""
"^DD",2006.171,2006.171,.01,1,1,2)
K ^MAG(2006.171,"B",$E(X,1,30),DA)
"^DD",2006.171,2006.171,.01,3)
Enter the MUSE Test Type, 3 to 30 characters in length.
"^DD",2006.171,2006.171,.01,21,0)
^.001^2^2^3180105^^
"^DD",2006.171,2006.171,.01,21,1,0)
The TEXT of the Test Type that is entered into this field
"^DD",2006.171,2006.171,.01,21,2,0)
must EXACTLY Match the TEXT of the Test Type on the MUSE System
"^DD",2006.171,2006.171,.01,"DT")
3180105
"^DD",2006.172,2006.172,0)
FIELD^^4^5
"^DD",2006.172,2006.172,0,"DT")
3180105
"^DD",2006.172,2006.172,0,"IX","B",2006.172,.01)

"^DD",2006.172,2006.172,0,"IX","C",2006.172,1)

"^DD",2006.172,2006.172,0,"NM","MUSE FORMAT TABLE")

"^DD",2006.172,2006.172,0,"VRPK")
MAG
"^DD",2006.172,2006.172,.01,0)
DESCRIPTION^RFJ30^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",2006.172,2006.172,.01,1,0)
^.1
"^DD",2006.172,2006.172,.01,1,1,0)
2006.172^B
"^DD",2006.172,2006.172,.01,1,1,1)
S ^MAG(2006.172,"B",$E(X,1,30),DA)=""
"^DD",2006.172,2006.172,.01,1,1,2)
K ^MAG(2006.172,"B",$E(X,1,30),DA)
"^DD",2006.172,2006.172,.01,3)
Answer must be 3-30 characters in length.
"^DD",2006.172,2006.172,.01,21,0)
^.001^1^1^3180105^^^
"^DD",2006.172,2006.172,.01,21,1,0)
Enter a description of the mapping. Example 'Kansas Stress with Grid'
"^DD",2006.172,2006.172,.01,"DT")
3171226
"^DD",2006.172,2006.172,1,0)
NETWORK LOCATION^RP2005.2'^MAG(2005.2,^0;2^Q
"^DD",2006.172,2006.172,1,1,0)
^.1
"^DD",2006.172,2006.172,1,1,1,0)
2006.172^C
"^DD",2006.172,2006.172,1,1,1,1)
S ^MAG(2006.172,"C",$E(X,1,30),DA)=""
"^DD",2006.172,2006.172,1,1,1,2)
K ^MAG(2006.172,"C",$E(X,1,30),DA)
"^DD",2006.172,2006.172,1,1,1,"%D",0)
^^2^2^3171226^
"^DD",2006.172,2006.172,1,1,1,"%D",1,0)
Cross reference by the NETWORK LOCATION IEN.  For easy lookup from 
"^DD",2006.172,2006.172,1,1,1,"%D",2,0)
the MUSE Viewer GUI
"^DD",2006.172,2006.172,1,1,1,"DT")
3171226
"^DD",2006.172,2006.172,1,3)
Enter the NETWORK LOCATION Entry for the MUSE System.
"^DD",2006.172,2006.172,1,21,0)
^.001^1^1^3180105^^
"^DD",2006.172,2006.172,1,21,1,0)
This is the MUSE System from the NETWORK LOCATION File.
"^DD",2006.172,2006.172,1,"DT")
3180105
"^DD",2006.172,2006.172,2,0)
TEST TYPE^RP2006.171'^MAG(2006.171,^0;3^Q
"^DD",2006.172,2006.172,2,3)
Enter the MUSE TEST TYPE to be mapped.
"^DD",2006.172,2006.172,2,21,0)
^.001^2^2^3180105^^
"^DD",2006.172,2006.172,2,21,1,0)
Enter the MUSE TEST TYPE that will be mapped to a MUSE Format ID 
"^DD",2006.172,2006.172,2,21,2,0)
number.
"^DD",2006.172,2006.172,2,"DT")
3180105
"^DD",2006.172,2006.172,3,0)
GRID^RS^Y:YES;N:NO;^0;4^Q
"^DD",2006.172,2006.172,3,3)
Enter YES if this Format has the Grid displayed.
"^DD",2006.172,2006.172,3,21,0)
^.001^2^2^3180105^^
"^DD",2006.172,2006.172,3,21,1,0)
Enter YES if this Format has the Grid displayed.
"^DD",2006.172,2006.172,3,21,2,0)
Enter NO if this Format does not have the Grid displayed.
"^DD",2006.172,2006.172,3,"DT")
3171226
"^DD",2006.172,2006.172,4,0)
FORMAT ID NUMBER^RNJ3,0^^0;5^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
"^DD",2006.172,2006.172,4,3)
Enter the Format ID Number for the TEST TYPE, a number between 1 and 999, 0 decimal digits.
"^DD",2006.172,2006.172,4,21,0)
^.001^2^2^3180105^^^
"^DD",2006.172,2006.172,4,21,1,0)
This field holds the Format ID Number that is defined on the MUSE System.
"^DD",2006.172,2006.172,4,21,2,0)
The Format ID Number must exist on the MUSE System.
"^DD",2006.172,2006.172,4,"DT")
3180105
"^DIC",2006.171,2006.171,0)
MUSE TEST TYPES^2006.171
"^DIC",2006.171,2006.171,0,"GL")
^MAG(2006.171,
"^DIC",2006.171,2006.171,"%D",0)
^1.001^7^7^3180113^^^^
"^DIC",2006.171,2006.171,"%D",1,0)
This file holds the list of MUSE Test Types that are used
"^DIC",2006.171,2006.171,"%D",2,0)
by the MUSE FORMAT TABLE File to map a Test Type to a 
"^DIC",2006.171,2006.171,"%D",3,0)
MUSE Format ID number.
"^DIC",2006.171,2006.171,"%D",4,0)
Sites can add new Test Types to this file if needed.
"^DIC",2006.171,2006.171,"%D",5,0)
IMPORTANT:
"^DIC",2006.171,2006.171,"%D",6,0)
The TEXT of the Test Type that is entered into this file
"^DIC",2006.171,2006.171,"%D",7,0)
must EXACTLY Match the TEXT of the Test Type on the MUSE System.
"^DIC",2006.171,"B","MUSE TEST TYPES",2006.171)

"^DIC",2006.172,2006.172,0)
MUSE FORMAT TABLE^2006.172
"^DIC",2006.172,2006.172,0,"GL")
^MAG(2006.172,
"^DIC",2006.172,2006.172,"%D",0)
^1.001^21^21^3180113^^^^
"^DIC",2006.172,2006.172,"%D",1,0)
This File is a mapping of MUSE Test Types to the MUSE Format ID number
"^DIC",2006.172,2006.172,"%D",2,0)
for a specified MUSE System.
"^DIC",2006.172,2006.172,"%D",3,0)
The default Format IDs listed below are used by the MUSE System
"^DIC",2006.172,2006.172,"%D",4,0)
to compile the MUSE Test data, for the specified Test Type, into
"^DIC",2006.172,2006.172,"%D",5,0)
a PDF File for viewing.
"^DIC",2006.172,2006.172,"%D",6,0)
The deafult Format IDs cannot be modified.
"^DIC",2006.172,2006.172,"%D",7,0)
Sites can add entries to this file if any of the Default mappings
"^DIC",2006.172,2006.172,"%D",8,0)
of MUSE Test Types to MUSE Format IDs is not correct for a certain
"^DIC",2006.172,2006.172,"%D",9,0)
MUSE System.
"^DIC",2006.172,2006.172,"%D",10,0)
If Site Specific Format ID's have been entered into the 
"^DIC",2006.172,2006.172,"%D",11,0)
MUSE FORMAT TABLE, those Format ID's will override the defaults.
"^DIC",2006.172,2006.172,"%D",12,0)
---------- Default mapping ----------------------
"^DIC",2006.172,2006.172,"%D",13,0)
Test Type    Grid    Format ID
"^DIC",2006.172,2006.172,"%D",14,0)
RestingECG     Y        6
"^DIC",2006.172,2006.172,"%D",15,0)
Stress         Y        7
"^DIC",2006.172,2006.172,"%D",16,0)
Holter         Y        8
"^DIC",2006.172,2006.172,"%D",17,0)
HiRes          Y        9
"^DIC",2006.172,2006.172,"%D",18,0)
RestingECG     N        12
"^DIC",2006.172,2006.172,"%D",19,0)
HiRes          N        13
"^DIC",2006.172,2006.172,"%D",20,0)
Stress         N        14
"^DIC",2006.172,2006.172,"%D",21,0)
Holter         N        15
"^DIC",2006.172,"B","MUSE FORMAT TABLE",2006.172)

**END**
**END**
