Released MMRS*1*6 SEQ #6
Extracted from mail message
**KIDS**:MMRS*1.0*6^

**INSTALL NAME**
MMRS*1.0*6
"BLD",10776,0)
MMRS*1.0*6^MDRO INITIATIVE REPORTS^0^3171219^y
"BLD",10776,1,0)
^^7^7^3171219^
"BLD",10776,1,1,0)
The patch addresses one (1) issues:
"BLD",10776,1,2,0)
 
"BLD",10776,1,3,0)
1.   Many facilities report that the MDRO Tool CDI Report is 
"BLD",10776,1,4,0)
     running very slowly.  This is occurring because the report
"BLD",10776,1,5,0)
     is examining a large set of microbiology results for every 
"BLD",10776,1,6,0)
     patient including those that fall outside of the date range
"BLD",10776,1,7,0)
     specified at report run time.
"BLD",10776,4,0)
^9.64PA^^
"BLD",10776,6.3)
1
"BLD",10776,"KRN",0)
^9.67PA^779.2^20
"BLD",10776,"KRN",.4,0)
.4
"BLD",10776,"KRN",.401,0)
.401
"BLD",10776,"KRN",.402,0)
.402
"BLD",10776,"KRN",.403,0)
.403
"BLD",10776,"KRN",.5,0)
.5
"BLD",10776,"KRN",.84,0)
.84
"BLD",10776,"KRN",3.6,0)
3.6
"BLD",10776,"KRN",3.8,0)
3.8
"BLD",10776,"KRN",9.2,0)
9.2
"BLD",10776,"KRN",9.8,0)
9.8
"BLD",10776,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10776,"KRN",9.8,"NM",1,0)
MMRSCDI1^^0^B42850422
"BLD",10776,"KRN",9.8,"NM","B","MMRSCDI1",1)

"BLD",10776,"KRN",19,0)
19
"BLD",10776,"KRN",19.1,0)
19.1
"BLD",10776,"KRN",101,0)
101
"BLD",10776,"KRN",409.61,0)
409.61
"BLD",10776,"KRN",771,0)
771
"BLD",10776,"KRN",779.2,0)
779.2
"BLD",10776,"KRN",870,0)
870
"BLD",10776,"KRN",8989.51,0)
8989.51
"BLD",10776,"KRN",8989.52,0)
8989.52
"BLD",10776,"KRN",8994,0)
8994
"BLD",10776,"KRN","B",.4,.4)

"BLD",10776,"KRN","B",.401,.401)

"BLD",10776,"KRN","B",.402,.402)

"BLD",10776,"KRN","B",.403,.403)

"BLD",10776,"KRN","B",.5,.5)

"BLD",10776,"KRN","B",.84,.84)

"BLD",10776,"KRN","B",3.6,3.6)

"BLD",10776,"KRN","B",3.8,3.8)

"BLD",10776,"KRN","B",9.2,9.2)

"BLD",10776,"KRN","B",9.8,9.8)

"BLD",10776,"KRN","B",19,19)

"BLD",10776,"KRN","B",19.1,19.1)

"BLD",10776,"KRN","B",101,101)

"BLD",10776,"KRN","B",409.61,409.61)

"BLD",10776,"KRN","B",771,771)

"BLD",10776,"KRN","B",779.2,779.2)

"BLD",10776,"KRN","B",870,870)

"BLD",10776,"KRN","B",8989.51,8989.51)

"BLD",10776,"KRN","B",8989.52,8989.52)

"BLD",10776,"KRN","B",8994,8994)

"BLD",10776,"QUES",0)
^9.62^^
"BLD",10776,"REQB",0)
^9.611^1^1
"BLD",10776,"REQB",1,0)
MMRS*1.0*5^2
"BLD",10776,"REQB","B","MMRS*1.0*5",1)

"MBREQ")
0
"PKG",585,-1)
1^1
"PKG",585,0)
MDRO INITIATIVE REPORTS^MMRS^MRSA PREVENTION INITIATIVE
"PKG",585,20,0)
^9.402P^^
"PKG",585,22,0)
^9.49I^1^1
"PKG",585,22,1,0)
1.0^3091030^3101019^66481
"PKG",585,22,1,"PAH",1,0)
6^3171219
"PKG",585,22,1,"PAH",1,1,0)
^^7^7^3171219
"PKG",585,22,1,"PAH",1,1,1,0)
The patch addresses one (1) issues:
"PKG",585,22,1,"PAH",1,1,2,0)
 
"PKG",585,22,1,"PAH",1,1,3,0)
1.   Many facilities report that the MDRO Tool CDI Report is 
"PKG",585,22,1,"PAH",1,1,4,0)
     running very slowly.  This is occurring because the report
"PKG",585,22,1,"PAH",1,1,5,0)
     is examining a large set of microbiology results for every 
"PKG",585,22,1,"PAH",1,1,6,0)
     patient including those that fall outside of the date range
"PKG",585,22,1,"PAH",1,1,7,0)
     specified at report run time.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","MMRSCDI1")
0^1^B42850422^B42768912
"RTN","MMRSCDI1",1,0)
MMRSCDI1 ;LEIDOS/TCK - Print CDI Report Cont. (Contains functions to collect patient labs and swabbing rate) ; 3/8/17 11:39am
"RTN","MMRSCDI1",2,0)
 ;;1.0;MDRO TOOLS REPORTS MENU;**4,5,6**;Mar 22, 2009;Build 1
"RTN","MMRSCDI1",3,0)
 ;
"RTN","MMRSCDI1",4,0)
GETLAB(DFN,MRSA,LRMDRO,LREND,LRDTTYP) ;RETURN YES/NO^RESULT
"RTN","MMRSCDI1",5,0)
 N LRRSLT,LRTST,TMPRSLT,NUMB,TSTRSLT
"RTN","MMRSCDI1",6,0)
 S LRRSLT="^",NUMB=0
"RTN","MMRSCDI1",7,0)
 I $G(DFN)=""!($G(LRMDRO)="")!($G(LREND)="") Q LRRSLT
"RTN","MMRSCDI1",8,0)
 ;CHECK FOR MI RSULTS
"RTN","MMRSCDI1",9,0)
 I MDROETIO D
"RTN","MMRSCDI1",10,0)
 .D GETMI(DFN,LRMDRO,LREND,LRDTTYP,.MRSA)
"RTN","MMRSCDI1",11,0)
 .Q:'$D(MRSA)
"RTN","MMRSCDI1",12,0)
 ;CHECK FOR CH RESULTS
"RTN","MMRSCDI1",13,0)
 I TSTSTP D
"RTN","MMRSCDI1",14,0)
 .S LRRSLT="^"
"RTN","MMRSCDI1",15,0)
 .S LRTST=0 F  S LRTST=$O(^TMP($J,"MMRSCD","T",LRMDRO,LRTST)) Q:'LRTST  D
"RTN","MMRSCDI1",16,0)
 ..S SUBS=$$GET1^DIQ(60,+LRTST,4,"I")
"RTN","MMRSCDI1",17,0)
 ..I SUBS="CH" D GETCH(DFN,LRMDRO,+LRTST,LREND,LRDTTYP,.MRSA)
"RTN","MMRSCDI1",18,0)
 Q
"RTN","MMRSCDI1",19,0)
 ;
"RTN","MMRSCDI1",20,0)
GETCH(DFN,LRMDRO,LRTST,LREND,LRDTTYP,MRSA) ;RETURN YES^RESULT
"RTN","MMRSCDI1",21,0)
 N LIENS,LOC,LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD
"RTN","MMRSCDI1",22,0)
 S LRRSLT="^",CDIVT=""
"RTN","MMRSCDI1",23,0)
 S LRDATE=""
"RTN","MMRSCDI1",24,0)
 I LRDTTYP="RAD" S LRDATE=0,LRRADEND=LREND,LREND=9999999
"RTN","MMRSCDI1",25,0)
 Q:'$D(^PXRMINDX(63,"PI",DFN,+LRTST))
"RTN","MMRSCDI1",26,0)
 F  S LRDATE=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE)) Q:'LRDATE  D
"RTN","MMRSCDI1",27,0)
 .Q:LRDATE>ENDDT
"RTN","MMRSCDI1",28,0)
 .Q:LRDATE<DFLTDT
"RTN","MMRSCDI1",29,0)
 .S DAS=0 F  S DAS=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE,DAS)) Q:'DAS  D
"RTN","MMRSCDI1",30,0)
 ..S LRDFN=$P(DAS,";")
"RTN","MMRSCDI1",31,0)
 ..Q:'$D(^LR(LRDFN,"CH"))
"RTN","MMRSCDI1",32,0)
 ..S LRIDT=$P(DAS,";",3)
"RTN","MMRSCDI1",33,0)
 ..I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3) I LRRAD<STRTDT!(LRRAD>LRRADEND) Q
"RTN","MMRSCDI1",34,0)
 ..Q:LRDATE<DFLTDT
"RTN","MMRSCDI1",35,0)
 ..Q:LRDATE>ENDDT
"RTN","MMRSCDI1",36,0)
 ..Q:$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3)=""
"RTN","MMRSCDI1",37,0)
 ..S LIEN=LRIDT_","_LRDFN_","
"RTN","MMRSCDI1",38,0)
 ..S CDIVT=$$GET1^DIQ(63.04,LIEN,.01,"I")
"RTN","MMRSCDI1",39,0)
 ..S LOC=+$$GET1^DIQ(63.04,LIEN,.111,"I")
"RTN","MMRSCDI1",40,0)
 ..S LRLOC=$G(LOC)
"RTN","MMRSCDI1",41,0)
 ..S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSCDI1",42,0)
 ..S TSTRSLT=$$CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST)
"RTN","MMRSCDI1",43,0)
 ..I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSCDI1",44,0)
 ...S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";CH")
"RTN","MMRSCDI1",45,0)
 ...S LRRSLT=LRRSLT_"^"_LOC
"RTN","MMRSCDI1",46,0)
 ...S MRSA(CDIVT)=LRRSLT,LRRSLT="^"
"RTN","MMRSCDI1",47,0)
 Q
"RTN","MMRSCDI1",48,0)
 ;
"RTN","MMRSCDI1",49,0)
GETMI(DFN,LRMDRO,LREND,LRDTTYP,MRSA) ;RETURN YES^RESULT
"RTN","MMRSCDI1",50,0)
 N LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD,RSARY
"RTN","MMRSCDI1",51,0)
 S LRRSLT="^"
"RTN","MMRSCDI1",52,0)
 I '$D(^TMP($J,"MMRSCD","BACT",LRMDRO,"INC_REMARK")),'$D(^TMP($J,"MMRSCD","ETIOL",LRMDRO)) Q LRRSLT
"RTN","MMRSCDI1",53,0)
 S LRDFN=$$LRDFN^LR7OR1(DFN)
"RTN","MMRSCDI1",54,0)
 Q:'LRDFN LRRSLT
"RTN","MMRSCDI1",55,0)
 Q:'$D(^LR(LRDFN,"MI"))
"RTN","MMRSCDI1",56,0)
 S LRIDT=(9999999-LREND)-.0000001,COUNT=0
"RTN","MMRSCDI1",57,0)
 I LRDTTYP="RAD" S LRIDT=0,LREND=99999999
"RTN","MMRSCDI1",58,0)
 F  S LRIDT=$O(^LR(LRDFN,"MI",LRIDT)) Q:'LRIDT!(LRIDT>(9999999-STRTDT))  D
"RTN","MMRSCDI1",59,0)
 .I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,3) I LRRAD<STRTDT!(LRRAD>LREND) Q
"RTN","MMRSCDI1",60,0)
 .;CHECK FOR PRELIM
"RTN","MMRSCDI1",61,0)
 .S LIEN=LRIDT_","_LRDFN_","
"RTN","MMRSCDI1",62,0)
 .Q:$$GET1^DIQ(63.05,LIEN,11.5,"I")="P"
"RTN","MMRSCDI1",63,0)
 .;GET LOCATION AND COLLECTION DATE/TIME FROM 63
"RTN","MMRSCDI1",64,0)
 .S LOC=+$$GET1^DIQ(63.05,LIEN,.111,"I")
"RTN","MMRSCDI1",65,0)
 .S CDIVT=$$GET1^DIQ(63.05,LIEN,.01,"I")
"RTN","MMRSCDI1",66,0)
 .Q:$G(CDIVT)<DFLTDT
"RTN","MMRSCDI1",67,0)
 .Q:$G(CDIVT)>ENDDT
"RTN","MMRSCDI1",68,0)
 .S LRSITE=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,5)
"RTN","MMRSCDI1",69,0)
 .S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSCDI1",70,0)
 .S TSTRSLT=$$MIRSLT(LRDFN,LRIDT,LRMDRO)
"RTN","MMRSCDI1",71,0)
 .I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSCDI1",72,0)
 ..S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";MI")
"RTN","MMRSCDI1",73,0)
 ..S LRRSLT=LRRSLT_"^"_LOC
"RTN","MMRSCDI1",74,0)
 ..S MRSA(CDIVT)=LRRSLT,LRRSLT="^"
"RTN","MMRSCDI1",75,0)
 Q
"RTN","MMRSCDI1",76,0)
 ;
"RTN","MMRSCDI1",77,0)
CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSCDI1",78,0)
 N RESULT,LRLOC,LRND,LRPC,LRRES,LRIND,LRINDVAL,LRSPEC,LRLOW,LRHIG
"RTN","MMRSCDI1",79,0)
 S RESULT=""
"RTN","MMRSCDI1",80,0)
 S LRLOC=$P($G(^LAB(60,+LRTST,0)),U,5)
"RTN","MMRSCDI1",81,0)
 S LRND=$P(LRLOC,";",2) Q:+LRND'>0 RESULT
"RTN","MMRSCDI1",82,0)
 S LRPC=$P(LRLOC,";",3) Q:+LRPC'>0 RESULT
"RTN","MMRSCDI1",83,0)
 S LRRES=$P($G(^LR(LRDFN,"CH",LRIDT,LRND)),U,LRPC) Q:LRRES="" RESULT
"RTN","MMRSCDI1",84,0)
 S LRIND=$P($G(^TMP($J,"MMRSCD","T",LRMDRO,LRTST,0)),U,1)
"RTN","MMRSCDI1",85,0)
 S LRINDVAL=$P($G(^TMP($J,"MMRSCD","T",LRMDRO,LRTST,0)),U,2)
"RTN","MMRSCDI1",86,0)
 Q:LRIND="" RESULT
"RTN","MMRSCDI1",87,0)
 I LRIND=1 D  Q RESULT
"RTN","MMRSCDI1",88,0)
 .Q:'LRRES
"RTN","MMRSCDI1",89,0)
 .S LRSPEC=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,5) Q:LRSPEC=""
"RTN","MMRSCDI1",90,0)
 .Q:'$D(^LAB(60,LRTST,1,LRSPEC,0))
"RTN","MMRSCDI1",91,0)
 .S LRLOW=$P(^LAB(60,LRTST,1,LRSPEC,0),U,2),LRHIG=$P(^LAB(60,LRTST,1,LRSPEC,0),U,3)
"RTN","MMRSCDI1",92,0)
 .Q:'LRLOW!('LRHIG)
"RTN","MMRSCDI1",93,0)
 .I LRRES<LRLOW!(LRRES>LRHIG) S RESULT="POS" Q
"RTN","MMRSCDI1",94,0)
 I LRINDVAL="" Q RESULT
"RTN","MMRSCDI1",95,0)
 S LRRES=$$UP^XLFSTR(LRRES),LRINDVAL=$$UP^XLFSTR(LRINDVAL)
"RTN","MMRSCDI1",96,0)
 I LRIND=2,(LRRES[LRINDVAL) Q "POS"
"RTN","MMRSCDI1",97,0)
 I LRIND=3,(LRRES>LRINDVAL) Q "POS"
"RTN","MMRSCDI1",98,0)
 I LRIND=4,(LRRES<LRINDVAL) Q "POS"
"RTN","MMRSCDI1",99,0)
 I LRIND=5,(LRRES=LRINDVAL) Q "POS"
"RTN","MMRSCDI1",100,0)
 Q RESULT
"RTN","MMRSCDI1",101,0)
 ;
"RTN","MMRSCDI1",102,0)
MIRSLT(LRDFN,LRIDT,LRMDRO) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSCDI1",103,0)
 N RESULT,LRETND,LRETI,LRANTI,LRANTIND,LRANTINV,LRAND,LRRES,BACTRPT,RPTRMRK
"RTN","MMRSCDI1",104,0)
 S RESULT=""
"RTN","MMRSCDI1",105,0)
 ;Check Etiology
"RTN","MMRSCDI1",106,0)
 I $D(^TMP($J,"MMRSCD","ETIOL",LRMDRO)) D  Q:RESULT="POS" RESULT
"RTN","MMRSCDI1",107,0)
 .S LRETND=0 F  S LRETND=$O(^LR(LRDFN,"MI",LRIDT,3,LRETND)) Q:'LRETND!(RESULT="POS")  D
"RTN","MMRSCDI1",108,0)
 ..S LRETI=$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,0)),U)
"RTN","MMRSCDI1",109,0)
 ..Q:+LRETI'>0
"RTN","MMRSCDI1",110,0)
 ..I ('$O(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI,0))) D  Q
"RTN","MMRSCDI1",111,0)
 ...I $D(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI)) S RESULT="POS"
"RTN","MMRSCDI1",112,0)
 ..S LRANTI=0 F  S LRANTI=$O(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI,LRANTI)) Q:'LRANTI  D
"RTN","MMRSCDI1",113,0)
 ...S LRANTIND=$P(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI,LRANTI),U,1)
"RTN","MMRSCDI1",114,0)
 ...S LRANTINV=$P(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI,LRANTI),U,2)
"RTN","MMRSCDI1",115,0)
 ...;S LRAND=$P($G(^LAB(62.06,LRANTI,0)),U,2) Q:LRAND=""
"RTN","MMRSCDI1",116,0)
 ...Q:$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2)=""
"RTN","MMRSCDI1",117,0)
 ...Q:$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2),1,1))="S"
"RTN","MMRSCDI1",118,0)
 ...I LRANTIND=""!(LRANTINV="") Q
"RTN","MMRSCDI1",119,0)
 ...S LRRES=$$UP^XLFSTR($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2))
"RTN","MMRSCDI1",120,0)
 ...S LRANTINV=$$UP^XLFSTR(LRANTINV)
"RTN","MMRSCDI1",121,0)
 ...S LRANTIND=$$UP^XLFSTR(LRANTIND)
"RTN","MMRSCDI1",122,0)
 ...I LRANTIND=1,(LRRES[LRANTINV) S RESULT="POS" Q
"RTN","MMRSCDI1",123,0)
 ...I LRANTIND=2,(LRRES>LRANTINV) S RESULT="POS" Q
"RTN","MMRSCDI1",124,0)
 ...I LRANTIND=3,(LRRES<LRANTINV) S RESULT="POS" Q
"RTN","MMRSCDI1",125,0)
 ...I LRANTIND=4,(LRRES=LRANTINV) S RESULT="POS" Q
"RTN","MMRSCDI1",126,0)
 Q:RESULT="POS" "POS"
"RTN","MMRSCDI1",127,0)
 ;Check Bacteriology Report Remarks
"RTN","MMRSCDI1",128,0)
 I '$D(^TMP($J,"MMRSCD","BACT",LRMDRO,"INC_REMARK")) Q RESULT
"RTN","MMRSCDI1",129,0)
 S BACTRPT=0 F  S BACTRPT=$O(^LR(LRDFN,"MI",LRIDT,4,BACTRPT)) Q:'BACTRPT!(RESULT="POS")  D
"RTN","MMRSCDI1",130,0)
 .S RPTRMRK=$P($G(^LR(LRDFN,"MI",LRIDT,4,BACTRPT,0)),U,1)
"RTN","MMRSCDI1",131,0)
 .Q:RPTRMRK=""
"RTN","MMRSCDI1",132,0)
 .I $$BACTRPT(LRMDRO,"INC_REMARK",RPTRMRK)&('$$BACTRPT(LRMDRO,"EXC_REMARK",RPTRMRK)) S RESULT="POS"
"RTN","MMRSCDI1",133,0)
 Q RESULT
"RTN","MMRSCDI1",134,0)
 ;
"RTN","MMRSCDI1",135,0)
SCRNTOP(LRSITE,LRMDRO) ;CHECK TO SEE IF SCREEN ON SITE
"RTN","MMRSCDI1",136,0)
 Q:+LRSITE'>0 0
"RTN","MMRSCDI1",137,0)
 I $D(^TMP($J,"MMRSCD","TOP",LRMDRO,"INC_TOP"))&$D(^TMP($J,"MMRSCD","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSCDI1",138,0)
 I '$D(^TMP($J,"MMRSCD","TOP",LRMDRO,"INC_TOP"))&'$D(^TMP($J,"MMRSCD","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSCDI1",139,0)
 I ($D(^TMP($J,"MMRSCD","TOP",LRMDRO,"INC_TOP")))&($D(^TMP($J,"MMRSCD","TOP",LRMDRO,"INC_TOP",LRSITE))) Q 0
"RTN","MMRSCDI1",140,0)
 I ($D(^TMP($J,"MMRSCD","TOP",LRMDRO,"EXC_TOP")))&('$D(^TMP($J,"MMRSCD","TOP",LRMDRO,"EXC_TOP",LRSITE))) Q 0
"RTN","MMRSCDI1",141,0)
 Q 1
"RTN","MMRSCDI1",142,0)
 ;
"RTN","MMRSCDI1",143,0)
BACTRPT(LRMDRO,RPTTYPE,RPTRMRK) ;Is this comment contained in the parameters
"RTN","MMRSCDI1",144,0)
 N RESULT,MMRSI,LRINDVAL
"RTN","MMRSCDI1",145,0)
 S RESULT=0
"RTN","MMRSCDI1",146,0)
 S MMRSI=0 F  S MMRSI=$O(^TMP($J,"MMRSCD","BACT",LRMDRO,RPTTYPE,MMRSI)) Q:'MMRSI!(RESULT=1)  D
"RTN","MMRSCDI1",147,0)
 .S LRINDVAL=$G(^TMP($J,"MMRSCD","BACT",LRMDRO,RPTTYPE,MMRSI))
"RTN","MMRSCDI1",148,0)
 .I ($$UP^XLFSTR(RPTRMRK))[($$UP^XLFSTR(LRINDVAL)) S RESULT=1
"RTN","MMRSCDI1",149,0)
 Q RESULT
"RTN","MMRSCDI1",150,0)
 ;
"RTN","MMRSCDI1",151,0)
END ;
"RTN","MMRSCDI1",152,0)
 K CDIVT,COUNT,DFLTDT,ENDDT,LIEN,STRTDT,SUBS,TSTSTP,MDROETIO
"RTN","MMRSCDI1",153,0)
 Q
"VER")
8.0^22.2
"BLD",10776,6)
^6
**END**
**END**

