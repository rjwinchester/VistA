Released MMRS*1*4 SEQ #4
Extracted from mail message
**KIDS**:MMRS*1.0*4^

**INSTALL NAME**
MMRS*1.0*4
"BLD",9421,0)
MMRS*1.0*4^MDRO INITIATIVE REPORTS^0^3161220^y
"BLD",9421,4,0)
^9.64PA^104^4
"BLD",9421,4,104,0)
104
"BLD",9421,4,104,222)
y^y^f^^n^^y^o^n
"BLD",9421,4,104.1,0)
104.1
"BLD",9421,4,104.1,222)
y^y^f^^^^n
"BLD",9421,4,104.2,0)
104.2
"BLD",9421,4,104.2,222)
y^y^f^^n^^y^o^n
"BLD",9421,4,104.3,0)
104.3
"BLD",9421,4,104.3,222)
y^y^f^^^^n
"BLD",9421,4,"B",104,104)

"BLD",9421,4,"B",104.1,104.1)

"BLD",9421,4,"B",104.2,104.2)

"BLD",9421,4,"B",104.3,104.3)

"BLD",9421,6.3)
130
"BLD",9421,"ABPKG")
n
"BLD",9421,"INIT")
EN^MMRSP4
"BLD",9421,"KRN",0)
^9.67PA^779.2^20
"BLD",9421,"KRN",.4,0)
.4
"BLD",9421,"KRN",.4,"NM",0)
^9.68A^^
"BLD",9421,"KRN",.401,0)
.401
"BLD",9421,"KRN",.402,0)
.402
"BLD",9421,"KRN",.403,0)
.403
"BLD",9421,"KRN",.403,"NM",0)
^9.68A^3^2
"BLD",9421,"KRN",.403,"NM",2,0)
MMRSLABPARAM    FILE #104.1^104.1^0
"BLD",9421,"KRN",.403,"NM",3,0)
MMRSISLTORD    FILE #104^104^0
"BLD",9421,"KRN",.403,"NM","B","MMRSISLTORD    FILE #104",3)

"BLD",9421,"KRN",.403,"NM","B","MMRSLABPARAM    FILE #104.1",2)

"BLD",9421,"KRN",.5,0)
.5
"BLD",9421,"KRN",.84,0)
.84
"BLD",9421,"KRN",3.6,0)
3.6
"BLD",9421,"KRN",3.8,0)
3.8
"BLD",9421,"KRN",9.2,0)
9.2
"BLD",9421,"KRN",9.8,0)
9.8
"BLD",9421,"KRN",9.8,"NM",0)
^9.68A^17^9
"BLD",9421,"KRN",9.8,"NM",1,0)
MMRSCDI^^0^B219284495
"BLD",9421,"KRN",9.8,"NM",2,0)
MMRSCDI1^^0^B47343212
"BLD",9421,"KRN",9.8,"NM",11,0)
MMRSP4^^0^B634304
"BLD",9421,"KRN",9.8,"NM",12,0)
MMRSCRE^^0^B90369826
"BLD",9421,"KRN",9.8,"NM",13,0)
MMRSCRE2^^0^B12793206
"BLD",9421,"KRN",9.8,"NM",14,0)
MMRSCRE3^^0^B160454267
"BLD",9421,"KRN",9.8,"NM",15,0)
MMRSCRE4^^0^B34859922
"BLD",9421,"KRN",9.8,"NM",16,0)
MMRSIPCP^^0^B45727414
"BLD",9421,"KRN",9.8,"NM",17,0)
MMRSCDI2^^0^B162714137
"BLD",9421,"KRN",9.8,"NM","B","MMRSCDI",1)

"BLD",9421,"KRN",9.8,"NM","B","MMRSCDI1",2)

"BLD",9421,"KRN",9.8,"NM","B","MMRSCDI2",17)

"BLD",9421,"KRN",9.8,"NM","B","MMRSCRE",12)

"BLD",9421,"KRN",9.8,"NM","B","MMRSCRE2",13)

"BLD",9421,"KRN",9.8,"NM","B","MMRSCRE3",14)

"BLD",9421,"KRN",9.8,"NM","B","MMRSCRE4",15)

"BLD",9421,"KRN",9.8,"NM","B","MMRSIPCP",16)

"BLD",9421,"KRN",9.8,"NM","B","MMRSP4",11)

"BLD",9421,"KRN",19,0)
19
"BLD",9421,"KRN",19,"NM",0)
^9.68A^39^21
"BLD",9421,"KRN",19,"NM",3,0)
MMRS MDRO HIST DAYS EDIT^^0
"BLD",9421,"KRN",19,"NM",4,0)
MMRS MDRO LAB PARAMETER SETUP^^0
"BLD",9421,"KRN",19,"NM",7,0)
MMRS MDRO TOOLS SETUP MENU^^0
"BLD",9421,"KRN",19,"NM",8,0)
MMRS MDRO WARD MAPPING SETUP^^1^
"BLD",9421,"KRN",19,"NM",13,0)
MMRS MRSA WARD MAPPING SETUP^^0^
"BLD",9421,"KRN",19,"NM",14,0)
MMRS MRSA TOOLS SETUP MENU^^1^
"BLD",9421,"KRN",19,"NM",16,0)
MMRS CDI REPORT^^0
"BLD",9421,"KRN",19,"NM",20,0)
MMRS MRSA HIST DAYS EDIT^^1^
"BLD",9421,"KRN",19,"NM",23,0)
MMRS ISOLATION REPORT^^0
"BLD",9421,"KRN",19,"NM",27,0)
MMRS REPORTS MENU^^0
"BLD",9421,"KRN",19,"NM",28,0)
MMRS MDRO SITE PARAMETER SETUP^^1^
"BLD",9421,"KRN",19,"NM",29,0)
MMRS CRE REPORT^^0
"BLD",9421,"KRN",19,"NM",31,0)
MMRS CRE SITE PARAMETER SETUP^^0
"BLD",9421,"KRN",19,"NM",32,0)
MMRS MRSA SITE PARAMETER SETUP^^0
"BLD",9421,"KRN",19,"NM",33,0)
MMRS CDI REPORT (TASKED)^^0
"BLD",9421,"KRN",19,"NM",34,0)
MMRS MRSA LAB PARAMETER SETUP^^1^
"BLD",9421,"KRN",19,"NM",35,0)
MMRS MRSA MDRO HIST DAYS EDIT^^1^
"BLD",9421,"KRN",19,"NM",36,0)
MMRS MRSA IPEC REPORT^^0
"BLD",9421,"KRN",19,"NM",37,0)
MMRS NARES SWAB LIST^^0
"BLD",9421,"KRN",19,"NM",38,0)
MMRS MRSA PARAMETER SETUP^^1^
"BLD",9421,"KRN",19,"NM",39,0)
MMRS ISLT ORD EDIT^^0
"BLD",9421,"KRN",19,"NM","B","MMRS CDI REPORT",16)

"BLD",9421,"KRN",19,"NM","B","MMRS CDI REPORT (TASKED)",33)

"BLD",9421,"KRN",19,"NM","B","MMRS CRE REPORT",29)

"BLD",9421,"KRN",19,"NM","B","MMRS CRE SITE PARAMETER SETUP",31)

"BLD",9421,"KRN",19,"NM","B","MMRS ISLT ORD EDIT",39)

"BLD",9421,"KRN",19,"NM","B","MMRS ISOLATION REPORT",23)

"BLD",9421,"KRN",19,"NM","B","MMRS MDRO HIST DAYS EDIT",3)

"BLD",9421,"KRN",19,"NM","B","MMRS MDRO LAB PARAMETER SETUP",4)

"BLD",9421,"KRN",19,"NM","B","MMRS MDRO SITE PARAMETER SETUP",28)

"BLD",9421,"KRN",19,"NM","B","MMRS MDRO TOOLS SETUP MENU",7)

"BLD",9421,"KRN",19,"NM","B","MMRS MDRO WARD MAPPING SETUP",8)

"BLD",9421,"KRN",19,"NM","B","MMRS MRSA HIST DAYS EDIT",20)

"BLD",9421,"KRN",19,"NM","B","MMRS MRSA IPEC REPORT",36)

"BLD",9421,"KRN",19,"NM","B","MMRS MRSA LAB PARAMETER SETUP",34)

"BLD",9421,"KRN",19,"NM","B","MMRS MRSA MDRO HIST DAYS EDIT",35)

"BLD",9421,"KRN",19,"NM","B","MMRS MRSA PARAMETER SETUP",38)

"BLD",9421,"KRN",19,"NM","B","MMRS MRSA SITE PARAMETER SETUP",32)

"BLD",9421,"KRN",19,"NM","B","MMRS MRSA TOOLS SETUP MENU",14)

"BLD",9421,"KRN",19,"NM","B","MMRS MRSA WARD MAPPING SETUP",13)

"BLD",9421,"KRN",19,"NM","B","MMRS NARES SWAB LIST",37)

"BLD",9421,"KRN",19,"NM","B","MMRS REPORTS MENU",27)

"BLD",9421,"KRN",19.1,0)
19.1
"BLD",9421,"KRN",19.1,"NM",0)
^9.68A^1^1
"BLD",9421,"KRN",19.1,"NM",1,0)
MMRS SETUP^^0
"BLD",9421,"KRN",19.1,"NM","B","MMRS SETUP",1)

"BLD",9421,"KRN",101,0)
101
"BLD",9421,"KRN",101,"NM",0)
^9.68A^^
"BLD",9421,"KRN",409.61,0)
409.61
"BLD",9421,"KRN",771,0)
771
"BLD",9421,"KRN",779.2,0)
779.2
"BLD",9421,"KRN",870,0)
870
"BLD",9421,"KRN",8989.51,0)
8989.51
"BLD",9421,"KRN",8989.52,0)
8989.52
"BLD",9421,"KRN",8994,0)
8994
"BLD",9421,"KRN","B",.4,.4)

"BLD",9421,"KRN","B",.401,.401)

"BLD",9421,"KRN","B",.402,.402)

"BLD",9421,"KRN","B",.403,.403)

"BLD",9421,"KRN","B",.5,.5)

"BLD",9421,"KRN","B",.84,.84)

"BLD",9421,"KRN","B",3.6,3.6)

"BLD",9421,"KRN","B",3.8,3.8)

"BLD",9421,"KRN","B",9.2,9.2)

"BLD",9421,"KRN","B",9.8,9.8)

"BLD",9421,"KRN","B",19,19)

"BLD",9421,"KRN","B",19.1,19.1)

"BLD",9421,"KRN","B",101,101)

"BLD",9421,"KRN","B",409.61,409.61)

"BLD",9421,"KRN","B",771,771)

"BLD",9421,"KRN","B",779.2,779.2)

"BLD",9421,"KRN","B",870,870)

"BLD",9421,"KRN","B",8989.51,8989.51)

"BLD",9421,"KRN","B",8989.52,8989.52)

"BLD",9421,"KRN","B",8994,8994)

"BLD",9421,"QDEF")
^^^^NO^^^^YES^^NO
"BLD",9421,"QUES",0)
^9.62^^
"BLD",9421,"REQB",0)
^9.611^4^3
"BLD",9421,"REQB",2,0)
LR*5.2*463^2
"BLD",9421,"REQB",4,0)
MMRS*1.0*3^2
"BLD",9421,"REQB","B","LR*5.2*463",2)

"BLD",9421,"REQB","B","MMRS*1.0*3",4)

"DATA",104,1,0)
1^0^1^1^1
"DATA",104,1,1,0)
^104.05PA^1^1
"DATA",104,1,1,1,0)
6010
"DATA",104,1,61,0)
^104.0216061P^1^1
"DATA",104,1,61,1,0)
315
"DATA",104,2,0)
2^0^0^0^0
"DATA",104,2,1,0)
^104.05PA^1^1
"DATA",104,2,1,1,0)
6010
"DATA",104,2,61,0)
^104.0216061P^1^1
"DATA",104,2,61,1,0)
315
"DATA",104,3,0)
6^0^0^0^0
"DATA",104,3,61,0)
^104.0216061P^^0
"DATA",104,4,0)
3^0^0^0^0
"DATA",104,4,61,0)
^104.0216061P^1^1
"DATA",104,4,61,1,0)
315
"DATA",104,5,0)
5^0^0^0^0
"DATA",104,5,61,0)
^104.0216061P^1^1
"DATA",104,5,61,1,0)
315
"DATA",104.2,2,0)
CRB-R^Carbapenem-resistance
"DATA",104.2,2,1,0)
^104.22PA^3^3
"DATA",104.2,2,1,1,0)
1^1
"DATA",104.2,2,1,2,0)
4
"DATA",104.2,2,1,3,0)
5
"DATA",104.2,2,2,0)
^^17^17^3161028^
"DATA",104.2,2,2,1,0)
Carbapenems are a class of beta-lactam antibiotics with a broad spectrum 
"DATA",104.2,2,2,2,0)
of antibacterial activity. These agents have the broadest antibacterial 
"DATA",104.2,2,2,3,0)
spectrum compared to other beta-lactam classes. They are active against 
"DATA",104.2,2,2,4,0)
both Gram positive and Gram negative bacteria, and can be used to treat 
"DATA",104.2,2,2,5,0)
nosocomial and mixed bacterial infections. Resistance to carbapenems is of
"DATA",104.2,2,2,6,0)
importance because it limits therapeutic options.
"DATA",104.2,2,2,7,0)
 
"DATA",104.2,2,2,8,0)
NOTE: The purpose of adding carbapenem-resistant enterobacteriaceae (CRE) 
"DATA",104.2,2,2,9,0)
etiologies to the MDRO Tools Lab Parameter Setup is to identify a 
"DATA",104.2,2,2,10,0)
patient's current or prior history of CRE based on laboratory reporting 
"DATA",104.2,2,2,11,0)
and the time frames that are entered to search for the patient's status. 
"DATA",104.2,2,2,12,0)
The result must occur as a CRE bacterial etiology and any result 
"DATA",104.2,2,2,13,0)
contained in a "Free-Text" section will not allow incorporation of the 
"DATA",104.2,2,2,14,0)
CRE into the MDRO Program Tools software.  Refer to the  "VistA Lab 
"DATA",104.2,2,2,15,0)
Enhancements (VLE) - Microbiology User Guide" for instructions to 
"DATA",104.2,2,2,16,0)
configure the MDRO Tools Lab Parameter Setup to properly run the CRE 
"DATA",104.2,2,2,17,0)
Report.
"DATA",104.2,3,0)
VRE^Vancomycin-Resistant Enterococcus
"DATA",104.2,3,1,0)
^104.22PA^2^2
"DATA",104.2,3,1,1,0)
1^1
"DATA",104.2,3,1,2,0)
4
"DATA",104.2,3,2,0)
^^23^23^3161028^
"DATA",104.2,3,2,1,0)
Vancomycin-resistant Enterococcus (VRE) is a pathogen of increasing 
"DATA",104.2,3,2,2,0)
importance for healthcare facilities. Enterococcus is a bacterium that 
"DATA",104.2,3,2,3,0)
lives in the intestinal tract and in the female genital tract. Vancomycin
"DATA",104.2,3,2,4,0)
is an antibiotic that is often used to treat infections caused by
"DATA",104.2,3,2,5,0)
enterococci, and recently enterococci have become resistant to this drug.
"DATA",104.2,3,2,6,0)
Most VRE infections occur in the hospital.  
"DATA",104.2,3,2,7,0)
 
"DATA",104.2,3,2,8,0)
NOTE: Adding Vancomycin-resistant Enterococcus to the MDRO Tools Lab 
"DATA",104.2,3,2,9,0)
Parameter Setup is optional. The purpose of adding this pathogen to the 
"DATA",104.2,3,2,10,0)
parameter set-up is to identify a patient's current or prior history of 
"DATA",104.2,3,2,11,0)
VRE based on laboratory reporting and the time frames that are entered to 
"DATA",104.2,3,2,12,0)
search for the patient's status. This information can optionally be 
"DATA",104.2,3,2,13,0)
displayed on the Isolation Report. This includes cultures positive for 
"DATA",104.2,3,2,14,0)
prevalence and surveillance review, including specimens of stool and 
"DATA",104.2,3,2,15,0)
rectal swabs. It is important to search for all vancomycin resistant 
"DATA",104.2,3,2,16,0)
enterococci, whether speciated or not. It is important to be sure to list
"DATA",104.2,3,2,17,0)
all the places in the Microbiology Laboratory package where Enterococcus
"DATA",104.2,3,2,18,0)
are found, either as Enterococcus, E. (sp.), Group D-Streptococcus, E.
"DATA",104.2,3,2,19,0)
faecalis, E. faecium, E. durans, E. gallinarum, E. casseliflavus, etc.  
"DATA",104.2,3,2,20,0)
The laboratory parameter setup for the MDRO Program Tools should match the
"DATA",104.2,3,2,21,0)
same parameter setup for the EPI (Emerging Pathogens Initiative). If
"DATA",104.2,3,2,22,0)
changes are made to how Vancomycin-resistant Enterococcus is reported it
"DATA",104.2,3,2,23,0)
should also be changed in EPI parameter setup.
"DATA",104.2,4,0)
C. diff^Clostridium difficile
"DATA",104.2,4,1,0)
^104.22PA^4^1
"DATA",104.2,4,1,4,0)
4
"DATA",104.2,4,2,0)
^104.23^34^34^3161121^^^^
"DATA",104.2,4,2,1,0)
Clostridium difficile is a species of gram-positive bacteria. The disease
"DATA",104.2,4,2,2,0)
is associated with the presence of Clostridium difficile enterotoxin,
"DATA",104.2,4,2,3,0)
which can cause significant morbidity, as well as mortality. It is of
"DATA",104.2,4,2,4,0)
importance, as its predominant acquisition appears to occur nosocomially
"DATA",104.2,4,2,5,0)
and is the most serious cause of antibiotic-associated diarrhea. Presence
"DATA",104.2,4,2,6,0)
of clostridial toxin (either enterotoxin or cytotoxin L) by assay (whether
"DATA",104.2,4,2,7,0)
it be EIA, latex agglutination, cytotoxicity of cell culture
"DATA",104.2,4,2,8,0)
+neutralization, or culture of organism with subsequent colony testing) is
"DATA",104.2,4,2,9,0)
the best indicator that an inflammatory diarrheal disease is due to
"DATA",104.2,4,2,10,0)
presence of Clostridium difficile.
"DATA",104.2,4,2,11,0)
 
"DATA",104.2,4,2,12,0)
Laboratory services are quite varied as to how they identify the presence 
"DATA",104.2,4,2,13,0)
of Clostridium difficile. Some labs are set up to identify C. difficile as
"DATA",104.2,4,2,14,0)
the final microbiological (bacterial) etiology of a culture, even if a 
"DATA",104.2,4,2,15,0)
culture method was not used. Other labs use a final etiology of "see 
"DATA",104.2,4,2,16,0)
comment" and then enter the results in a free text format. Still others 
"DATA",104.2,4,2,17,0)
enter the text under a hematology or chemistry format where a reference 
"DATA",104.2,4,2,18,0)
range and "positive" and "negative" result values can be entered.  
"DATA",104.2,4,2,19,0)
Wherever the VHA Laboratory Service places the results, which are used to 
"DATA",104.2,4,2,20,0)
demonstrate the presence of toxin-producing C. difficile, should be 
"DATA",104.2,4,2,21,0)
accessible as a standardized field in order to allow the MDRO Programs 
"DATA",104.2,4,2,22,0)
Tool software to capture its presence.  
"DATA",104.2,4,2,23,0)
 
"DATA",104.2,4,2,24,0)
NOTE:  The purpose of adding Clostridium difficile to the MDRO Tools Lab 
"DATA",104.2,4,2,25,0)
Parameter Setup is to identify a patient's current or prior history of 
"DATA",104.2,4,2,26,0)
Clostridium difficile based on laboratory reporting and the time frames 
"DATA",104.2,4,2,27,0)
that are entered to search for the patient's status.  The result must 
"DATA",104.2,4,2,28,0)
occur as a Clostridium difficile (a bacterial etiology) or as a 
"DATA",104.2,4,2,29,0)
retrievable "positive" result for a chemistry/serology laboratory test. 
"DATA",104.2,4,2,30,0)
Any results contained in a "Free-Text" section will not allow 
"DATA",104.2,4,2,31,0)
incorporation of Clostridium difficile into the MDRO Program Tools 
"DATA",104.2,4,2,32,0)
software CDI Report format.  Refer to the "VistA Lab Enhancements (VLE) - 
"DATA",104.2,4,2,33,0)
Microbiology User Guide" for instructions to configure the MDRO Tools Lab 
"DATA",104.2,4,2,34,0)
Parameter Setup to properly run the CDI Report.
"DATA",104.2,5,0)
ESBL^Extended-spectrum beta-lactamase
"DATA",104.2,5,1,0)
^104.22PA^2^2
"DATA",104.2,5,1,1,0)
1^1
"DATA",104.2,5,1,2,0)
4
"DATA",104.2,5,2,0)
^^28^28^3161028^
"DATA",104.2,5,2,1,0)
Extended-Spectrum Beta-Lactamases (ESBLs) are enzymes that mediate 
"DATA",104.2,5,2,2,0)
resistance to extended-spectrum (third generation) cephalosporins (e.g., 
"DATA",104.2,5,2,3,0)
ceftazidime, cefotaxime, and ceftriaxone) and monobactams (e.g, aztreonam)
"DATA",104.2,5,2,4,0)
but do not affect cephamycins (e.g., cefoxitin and cefotetan) or
"DATA",104.2,5,2,5,0)
carbapenems (e.g., imipenem or meropenem).  
"DATA",104.2,5,2,6,0)
 
"DATA",104.2,5,2,7,0)
ESBLs can be difficult to detect because they have different levels of 
"DATA",104.2,5,2,8,0)
activity against various cephalosporins. It is critical to test the 
"DATA",104.2,5,2,9,0)
appropriate antimicrobial agent. An appropriate Committee on Laboratory 
"DATA",104.2,5,2,10,0)
Standards Institute (CLSI) testing schema should be used. If an isolate is
"DATA",104.2,5,2,11,0)
confirmed as an ESBL-producer by the CLSI-recommended phenotypic 
"DATA",104.2,5,2,12,0)
confirmatory test procedure, then all penicillins, cephalosporins and 
"DATA",104.2,5,2,13,0)
aztreonams should be reported as resistant. Cephamycins should be reported
"DATA",104.2,5,2,14,0)
according to their routine test results.  
"DATA",104.2,5,2,15,0)
 
"DATA",104.2,5,2,16,0)
NOTE: Adding Extended-Spectrum Beta Lactamase to the MDRO Tools Lab 
"DATA",104.2,5,2,17,0)
Parameter Setup is optional. The purpose of adding pathogens containing 
"DATA",104.2,5,2,18,0)
this form of antimicrobial resistance to the parameter set-up is to 
"DATA",104.2,5,2,19,0)
identify a patient's current or prior history of ESBL based on laboratory 
"DATA",104.2,5,2,20,0)
reporting and the time frames that are entered to search for the patient's
"DATA",104.2,5,2,21,0)
status. This information can optionally be displayed on the Isolation
"DATA",104.2,5,2,22,0)
Report. If you would like to incorporate ESBL into the Isolation report,
"DATA",104.2,5,2,23,0)
the result must occur as a retrievable result as a "bacterial etiology" or
"DATA",104.2,5,2,24,0)
in the "BACT RPT REMARK" field. It is appropriate to used Canned Comments
"DATA",104.2,5,2,25,0)
versus Free Text to retrieve results. If free-text is used, it is likely
"DATA",104.2,5,2,26,0)
the report will not display accurate information. Any results contained in
"DATA",104.2,5,2,27,0)
the "Comments" section will not allow incorporation of ESBL into the MDRO
"DATA",104.2,5,2,28,0)
Program Tools software Isolation Report format.
"DATA",104.2,6,0)
MRSA^Methicillin-resistant Staphylococcus aureus
"DATA",104.2,6,1,0)
^104.22PA^2^2
"DATA",104.2,6,1,1,0)
1^365
"DATA",104.2,6,1,2,0)
4
"DATA",104.2,6,2,0)
^^41^41^3161028^
"DATA",104.2,6,2,1,0)
Methicillin (or oxacillin)-resistant Staphylococcus aureus (MRSA) is a 
"DATA",104.2,6,2,2,0)
pathogen of continuing importance for healthcare facilities. It is a 
"DATA",104.2,6,2,3,0)
Gram-positive coccus that can be resistant to multiple antibiotics, causes
"DATA",104.2,6,2,4,0)
serious disease, and is often difficult to treat. It is the cause of
"DATA",104.2,6,2,5,0)
healthcare-associated infections (HAIs), and is an emerging pathogen from
"DATA",104.2,6,2,6,0)
community-associate sources. MRSA can be cultured from the nares and other
"DATA",104.2,6,2,7,0)
sites in patients who are colonized or infected with the organism. It is
"DATA",104.2,6,2,8,0)
transmitted, in general, by contact, with the hands of patients or health
"DATA",104.2,6,2,9,0)
care workers or inanimate objects contaminated with MRSA. Such
"DATA",104.2,6,2,10,0)
transmission amplifies the number of patients who may become colonized and
"DATA",104.2,6,2,11,0)
who are then at risk for clinical infection.
"DATA",104.2,6,2,12,0)
 
"DATA",104.2,6,2,13,0)
It is important to capture all positive tests for MRSA, both clinical 
"DATA",104.2,6,2,14,0)
cultures and surveillance screening tests (e.g., nares screens). Any 
"DATA",104.2,6,2,15,0)
Staphylococcus aureus isolate that is resistant to Methicillin (or 
"DATA",104.2,6,2,16,0)
oxacillin) should be captured for this. VHA Laboratory Service must record
"DATA",104.2,6,2,17,0)
results of MRSA tests performed using the following methodology:
"DATA",104.2,6,2,18,0)
 
"DATA",104.2,6,2,19,0)
   1. MI-subscripted tests will be used for clinical cultures (C&S)       
"DATA",104.2,6,2,20,0)
only. STAPHYLOCOCCUS AUREUS METHICILLIN RESISTANT (MRSA) is the only
"DATA",104.2,6,2,21,0)
      etiology that will be used to report positive clinical cultures.  
"DATA",104.2,6,2,22,0)
 
"DATA",104.2,6,2,23,0)
   2. CH-subscripted tests will be used for MRSA nares screens or MRSA
"DATA",104.2,6,2,24,0)
      surveillance cultures. Laboratory is required to use the following
"DATA",104.2,6,2,25,0)
      test names: MRSA SURVL NARES DNA, MRSAL SURVL OTHER DNA, MRSA SURVL
"DATA",104.2,6,2,26,0)
      NARES AGAR, MRSA SURVL OTHER AGAR.
"DATA",104.2,6,2,27,0)
 
"DATA",104.2,6,2,28,0)
Please refer to the "Laboratory Reporting of MRSA Test" for information on
"DATA",104.2,6,2,29,0)
how to setup the standardized test names and etiology.
"DATA",104.2,6,2,30,0)
 
"DATA",104.2,6,2,31,0)
NOTE: Adding Methicillin-resistant Staphylococcus aureus to the MDRO Tools
"DATA",104.2,6,2,32,0)
Lab Parameter Setup is mandatory. The above standards for MRSA laboratory
"DATA",104.2,6,2,33,0)
reporting (clinical cultures and screening tests) have been hard coded
"DATA",104.2,6,2,34,0)
into the MDRO Program Tools software, and does not need to be entered into
"DATA",104.2,6,2,35,0)
the MDRO lab parameters setup. Only historical methods of reporting, that
"DATA",104.2,6,2,36,0)
were different from the national standards need to be entered. The purpose
"DATA",104.2,6,2,37,0)
of adding this pathogen to the parameter set-up is to identify prior
"DATA",104.2,6,2,38,0)
history of MRSA (either by clinical culture or nares screen) based on
"DATA",104.2,6,2,39,0)
laboratory reporting. If the facility fails to use the laboratory
"DATA",104.2,6,2,40,0)
standards set forth, the program will be unable to generate accurate
"DATA",104.2,6,2,41,0)
reports for data reporting.
"FIA",104)
MDRO SITE PARAMETERS
"FIA",104,0)
^MMRS(104,
"FIA",104,0,0)
104P
"FIA",104,0,1)
y^y^f^^n^^y^o^n
"FIA",104,0,10)

"FIA",104,0,11)

"FIA",104,0,"RLRO")

"FIA",104,0,"VR")
1.0^MMRS
"FIA",104,104)
0
"FIA",104,104.0216061)
0
"FIA",104,104.05)
0
"FIA",104.1)
MDRO TOOLS LAB SEARCH/EXTRACT
"FIA",104.1,0)
^MMRS(104.1,
"FIA",104.1,0,0)
104.1IP
"FIA",104.1,0,1)
y^y^f^^^^n
"FIA",104.1,0,10)

"FIA",104.1,0,11)

"FIA",104.1,0,"RLRO")

"FIA",104.1,0,"VR")
1.0^MMRS
"FIA",104.1,104.1)
0
"FIA",104.1,104.103)
0
"FIA",104.1,104.104)
0
"FIA",104.1,104.107)
0
"FIA",104.1,104.108)
0
"FIA",104.1,104.109)
0
"FIA",104.1,104.15)
0
"FIA",104.1,104.191)
0
"FIA",104.2)
MDRO TYPES
"FIA",104.2,0)
^MMRS(104.2,
"FIA",104.2,0,0)
104.2I
"FIA",104.2,0,1)
y^y^f^^n^^y^o^n
"FIA",104.2,0,10)

"FIA",104.2,0,11)

"FIA",104.2,0,"RLRO")

"FIA",104.2,0,"VR")
1.0^MMRS
"FIA",104.2,104.2)
0
"FIA",104.2,104.22)
0
"FIA",104.2,104.23)
0
"FIA",104.3)
MDRO WARD MAPPINGS
"FIA",104.3,0)
^MMRS(104.3,
"FIA",104.3,0,0)
104.3I
"FIA",104.3,0,1)
y^y^f^^^^n
"FIA",104.3,0,10)

"FIA",104.3,0,11)

"FIA",104.3,0,"RLRO")

"FIA",104.3,0,"VR")
1.0^MMRS
"FIA",104.3,104.3)
0
"FIA",104.3,104.302)
0
"INIT")
EN^MMRSP4
"IX",104.1,104.1,"C",0)
104.1^C^This cross reference is used to look up records by Division and MDRO.^R^^R^IR^I^104.1^^^^^LS
"IX",104.1,104.1,"C",1)
S ^MMRS(104.1,"C",$E(X(1),1,30),$E(X(2),1,30),DA)=""
"IX",104.1,104.1,"C",2)
K ^MMRS(104.1,"C",$E(X(1),1,30),$E(X(2),1,30),DA)
"IX",104.1,104.1,"C",2.5)
K ^MMRS(104.1,"C")
"IX",104.1,104.1,"C",11.1,0)
^.114IA^2^2
"IX",104.1,104.1,"C",11.1,1,0)
1^F^104.1^1^30^1^F
"IX",104.1,104.1,"C",11.1,1,3)

"IX",104.1,104.1,"C",11.1,2,0)
2^F^104.1^.01^30^2^F
"IX",104.1,104.1,"C",11.1,2,3)

"KRN",.403,138,-1)
0^2
"KRN",.403,138,0)
MMRSLABPARAM^@^@^^3090226.1926^^^104.1^0^0^1
"KRN",.403,138,40,0)
^.4031I^3^3
"KRN",.403,138,40,1,0)
1^^1,1^2^2
"KRN",.403,138,40,1,1)
Page 1
"KRN",.403,138,40,1,40,0)
^.4032IP^519^5
"KRN",.403,138,40,1,40,507,0)
MMRSPARAMHEAD^1^1,1^e
"KRN",.403,138,40,1,40,508,0)
MMRSPARAM2ET^4^12,1^e
"KRN",.403,138,40,1,40,509,0)
MMRSPARAM2ET2^5^14,1^e
"KRN",.403,138,40,1,40,509,2)
4
"KRN",.403,138,40,1,40,518,0)
MMRSLABHDR^2^7,2^d
"KRN",.403,138,40,1,40,519,0)
MMRSCHLABTESTS^3^8,1^e
"KRN",.403,138,40,1,40,519,2)
4
"KRN",.403,138,40,2,0)
1.5^^9,5^^^1^17,69
"KRN",.403,138,40,2,1)
Page 1.5^1,MMRSPARAM2ET2,1
"KRN",.403,138,40,2,40,0)
^.4032IP^511^2
"KRN",.403,138,40,2,40,510,0)
MMRSPARAM2AS^1^2,2^e
"KRN",.403,138,40,2,40,511,0)
MMRSPARAM2AS2^2^3,2^e
"KRN",.403,138,40,2,40,511,2)
4
"KRN",.403,138,40,3,0)
2^^1,1^1^1
"KRN",.403,138,40,3,1)
Page 2
"KRN",.403,138,40,3,40,0)
^.4032IP^514^4
"KRN",.403,138,40,3,40,507,0)
MMRSPARAMHEAD^1^1,1^e
"KRN",.403,138,40,3,40,512,0)
MMRSPARAM2BRH^2^7,1^e
"KRN",.403,138,40,3,40,513,0)
MMRSPARAM2BRI^3^10,1^e
"KRN",.403,138,40,3,40,513,2)
5
"KRN",.403,138,40,3,40,514,0)
MMRSPARAM2BRE^4^10,38^e
"KRN",.403,138,40,3,40,514,2)
5
"KRN",.403,139,-1)
0^3
"KRN",.403,139,0)
MMRSISLTORD^@^@^^3090302.1109^^^104^0^0^1
"KRN",.403,139,40,0)
^.4031I^1^1
"KRN",.403,139,40,1,0)
1^^1,1
"KRN",.403,139,40,1,1)
Page 1
"KRN",.403,139,40,1,40,0)
^.4032IP^522^3
"KRN",.403,139,40,1,40,520,0)
MMRSISLTORDHDR^1^1,1^d
"KRN",.403,139,40,1,40,521,0)
MMRSISLTORDEDITHDR^2^6,1^d
"KRN",.403,139,40,1,40,522,0)
MMRSISLTORDEDIT2^3^8,1^e
"KRN",.403,139,40,1,40,522,2)
10
"KRN",.404,507,0)
MMRSPARAMHEAD^104.1^
"KRN",.404,507,40,0)
^.4044I^8^6
"KRN",.404,507,40,1,0)
1^MDRO TOOLS LAB SEARCH/EXTRACT PARAMETERS SETUP^1
"KRN",.404,507,40,1,2)
^^2,17
"KRN",.404,507,40,3,0)
3^DIVISION^3
"KRN",.404,507,40,3,1)
1
"KRN",.404,507,40,3,2)
4,11^35^4,1
"KRN",.404,507,40,3,4)
^^^1
"KRN",.404,507,40,4,0)
4^MDRO^3
"KRN",.404,507,40,4,1)
.01
"KRN",.404,507,40,4,2)
4,57^23^4,51
"KRN",.404,507,40,4,4)
^^^1
"KRN",.404,507,40,6,0)
6^________________________________________^1
"KRN",.404,507,40,6,2)
^^5,1
"KRN",.404,507,40,7,0)
7^________________________________________^1
"KRN",.404,507,40,7,2)
^^5,41
"KRN",.404,507,40,8,0)
8^!M^1
"KRN",.404,507,40,8,.1)
S Y="Page "_$S(DDSPG=1:1,DDSPG=3:2,1:"")_" of 2"
"KRN",.404,507,40,8,2)
^^2,67
"KRN",.404,508,0)
MMRSPARAM2ET^104.1
"KRN",.404,508,40,0)
^.4044I^1^1
"KRN",.404,508,40,1,0)
1^Selected Etiology^1
"KRN",.404,508,40,1,2)
^^2,1
"KRN",.404,509,0)
MMRSPARAM2ET2^104.109
"KRN",.404,509,40,0)
^.4044I^1^1
"KRN",.404,509,40,1,0)
1^^3
"KRN",.404,509,40,1,1)
.01
"KRN",.404,509,40,1,2)
1,1^69
"KRN",.404,510,0)
MMRSPARAM2AS^104.1^
"KRN",.404,510,40,0)
^.4044I^3^3
"KRN",.404,510,40,1,0)
1^ANTIMICROBIAL SUSCEPTIBILITY^1
"KRN",.404,510,40,1,2)
^^1,2
"KRN",.404,510,40,2,0)
2^INDICATOR^1
"KRN",.404,510,40,2,2)
^^1,34
"KRN",.404,510,40,3,0)
3^INDICATED VALUE^1
"KRN",.404,510,40,3,2)
^^1,46
"KRN",.404,511,0)
MMRSPARAM2AS2^104.191
"KRN",.404,511,40,0)
^.4044I^3^3
"KRN",.404,511,40,1,0)
1^^3
"KRN",.404,511,40,1,1)
.01
"KRN",.404,511,40,1,2)
1,2^30
"KRN",.404,511,40,2,0)
2^^3
"KRN",.404,511,40,2,1)
1
"KRN",.404,511,40,2,2)
1,34^9
"KRN",.404,511,40,3,0)
3^^3
"KRN",.404,511,40,3,1)
2
"KRN",.404,511,40,3,2)
1,46^17
"KRN",.404,512,0)
MMRSPARAM2BRH^104.1^
"KRN",.404,512,40,0)
^.4044I^3^3
"KRN",.404,512,40,1,0)
1^BACTERIOLOGY REPORT REMARKS^1
"KRN",.404,512,40,1,2)
^^1,25
"KRN",.404,512,40,2,0)
2^Include^1
"KRN",.404,512,40,2,2)
^^3,1
"KRN",.404,512,40,3,0)
3^Exclude^1
"KRN",.404,512,40,3,2)
^^3,38
"KRN",.404,513,0)
MMRSPARAM2BRI^104.107
"KRN",.404,513,40,0)
^.4044I^1^1
"KRN",.404,513,40,1,0)
1^^3
"KRN",.404,513,40,1,1)
.01
"KRN",.404,513,40,1,2)
1,1^30
"KRN",.404,514,0)
MMRSPARAM2BRE^104.108
"KRN",.404,514,40,0)
^.4044I^1^1
"KRN",.404,514,40,1,0)
1^^3
"KRN",.404,514,40,1,1)
.01
"KRN",.404,514,40,1,2)
1,1^30
"KRN",.404,518,0)
MMRSLABHDR^104.1^
"KRN",.404,518,40,0)
^.4044I^3^3
"KRN",.404,518,40,1,0)
1^Laboratory Test(s)^1
"KRN",.404,518,40,1,2)
^^1,1
"KRN",.404,518,40,2,0)
2^Indicator^1
"KRN",.404,518,40,2,2)
^^1,34
"KRN",.404,518,40,3,0)
3^Value^1
"KRN",.404,518,40,3,2)
^^1,60
"KRN",.404,519,0)
MMRSCHLABTESTS^104.15
"KRN",.404,519,40,0)
^.4044I^3^3
"KRN",.404,519,40,1,0)
1^^3
"KRN",.404,519,40,1,1)
.01
"KRN",.404,519,40,1,2)
1,2^30
"KRN",.404,519,40,2,0)
2^^3
"KRN",.404,519,40,2,1)
1
"KRN",.404,519,40,2,2)
1,35^20
"KRN",.404,519,40,3,0)
3^^3
"KRN",.404,519,40,3,1)
2
"KRN",.404,519,40,3,2)
1,61^15
"KRN",.404,520,0)
MMRSISLTORDHDR^104^
"KRN",.404,520,40,0)
^.4044I^4^4
"KRN",.404,520,40,1,0)
1^MDRO TOOLS ISOLATION ORDERS SETUP^1
"KRN",.404,520,40,1,2)
^^2,23
"KRN",.404,520,40,2,0)
2^DIVISION^3
"KRN",.404,520,40,2,1)
.01
"KRN",.404,520,40,2,2)
4,11^35^4,1
"KRN",.404,520,40,3,0)
3^________________________________________^1
"KRN",.404,520,40,3,2)
^^5,1
"KRN",.404,520,40,4,0)
4^________________________________________^1
"KRN",.404,520,40,4,2)
^^5,41
"KRN",.404,521,0)
MMRSISLTORDEDITHDR^104^
"KRN",.404,521,40,0)
^.4044I^2^2
"KRN",.404,521,40,1,0)
1^Isolation Orders^1
"KRN",.404,521,40,1,2)
^^2,2
"KRN",.404,521,40,2,0)
2^Expanded Precaution Type^1
"KRN",.404,521,40,2,2)
^^2,41
"KRN",.404,522,0)
MMRSISLTORDEDIT2^104.05
"KRN",.404,522,40,0)
^.4044I^2^2
"KRN",.404,522,40,1,0)
1^^3
"KRN",.404,522,40,1,1)
.01
"KRN",.404,522,40,1,2)
1,2^36
"KRN",.404,522,40,2,0)
2^^3
"KRN",.404,522,40,2,1)
1
"KRN",.404,522,40,2,2)
1,41^35
"KRN",19,2921188,-1)
0^32
"KRN",19,2921188,0)
MMRS MRSA SITE PARAMETER SETUP^MRSA Tools Site Parameter Setup^^R^^MMRS SETUP^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921188,1,0)
^^3^3^3161031^
"KRN",19,2921188,1,1,0)
This option is used to add/edit the parameters which will modify the 
"KRN",19,2921188,1,2,0)
operation of the MRSA Program Tools application. This option defines the 
"KRN",19,2921188,1,3,0)
division(s) and business rules for MRSA nares screening.
"KRN",19,2921188,25)
DIV^MMRSIPCP
"KRN",19,2921188,99.1)
61572,33678
"KRN",19,2921188,"U")
MRSA TOOLS SITE PARAMETER SETU
"KRN",19,2921189,-1)
0^4
"KRN",19,2921189,0)
MMRS MDRO LAB PARAMETER SETUP^MDRO Tools Lab Parameter Setup^^R^^MMRS SETUP^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921189,1,0)
^19.06^4^4^3161031^^^^
"KRN",19,2921189,1,1,0)
This option allows the user to define parameters for the multi-drug 
"KRN",19,2921189,1,2,0)
resistant organism (MDRO) that is to be searched for.  This information 
"KRN",19,2921189,1,3,0)
is used to obtain prior history of MDRO and to display precaution 
"KRN",19,2921189,1,4,0)
measures for the selected organism(s).
"KRN",19,2921189,25)
LAB^MMRSIPCP
"KRN",19,2921189,99.1)
61781,59955
"KRN",19,2921189,"U")
MDRO TOOLS LAB PARAMETER SETUP
"KRN",19,2921190,-1)
0^7
"KRN",19,2921190,0)
MMRS MDRO TOOLS SETUP MENU^MDRO Tools Setup Menu^^M^^MMRS SETUP^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921190,10,0)
^19.01IP^6^6
"KRN",19,2921190,10,1,0)
2921188^1^1
"KRN",19,2921190,10,1,"^")
MMRS MRSA SITE PARAMETER SETUP
"KRN",19,2921190,10,2,0)
2921189^2^2
"KRN",19,2921190,10,2,"^")
MMRS MDRO LAB PARAMETER SETUP
"KRN",19,2921190,10,3,0)
2921191^3^3
"KRN",19,2921190,10,3,"^")
MMRS MRSA WARD MAPPING SETUP
"KRN",19,2921190,10,4,0)
2921192^4^4
"KRN",19,2921190,10,4,"^")
MMRS MDRO HIST DAYS EDIT
"KRN",19,2921190,10,5,0)
2921698^5^5
"KRN",19,2921190,10,5,"^")
MMRS CRE SITE PARAMETER SETUP
"KRN",19,2921190,10,6,0)
2921193^6^6
"KRN",19,2921190,10,6,"^")
MMRS ISLT ORD EDIT
"KRN",19,2921190,99)
64258,52690
"KRN",19,2921190,99.1)
64250,72571
"KRN",19,2921190,"U")
MDRO TOOLS SETUP MENU
"KRN",19,2921191,-1)
0^13
"KRN",19,2921191,0)
MMRS MRSA WARD MAPPING SETUP^MRSA Tools Ward Mapping Setup^^R^^MMRS SETUP^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921191,1,0)
^19.06^2^2^3160804^^^^
"KRN",19,2921191,1,1,0)
This option allows the user to define geographical units for the 
"KRN",19,2921191,1,2,0)
division(s). It will allow the user to map units together.
"KRN",19,2921191,25)
WARDMAP^MMRSIPCP
"KRN",19,2921191,"U")
MRSA TOOLS WARD MAPPING SETUP
"KRN",19,2921192,-1)
0^3
"KRN",19,2921192,0)
MMRS MDRO HIST DAYS EDIT^MDRO Historical Days Edit^^R^^MMRS SETUP^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921192,1,0)
^^2^2^3160723^
"KRN",19,2921192,1,1,0)
This option allows the user to define the timeframe to search the history 
"KRN",19,2921192,1,2,0)
of the selected MDRO for the MDRO Tools Isolation Report.
"KRN",19,2921192,25)
HISTDAY^MMRSIPCP
"KRN",19,2921192,"U")
MDRO HISTORICAL DAYS EDIT
"KRN",19,2921193,-1)
0^39
"KRN",19,2921193,0)
MMRS ISLT ORD EDIT^Isolation Orders Add/Edit^^R^^MMRS SETUP^^^^^^
"KRN",19,2921193,1,0)
^19.06^3^3^3161206^^^^
"KRN",19,2921193,1,1,0)
This option will allow you to enter the orders at your site that are used 
"KRN",19,2921193,1,2,0)
for isolation purposes. This will be used to populate the MRSA Tools 
"KRN",19,2921193,1,3,0)
Isolation Report.
"KRN",19,2921193,25)
ISLTORD^MMRSIPCP
"KRN",19,2921193,"U")
ISOLATION ORDERS ADD/EDIT
"KRN",19,2921195,-1)
0^23
"KRN",19,2921195,0)
MMRS ISOLATION REPORT^Print Isolation Report^^R^^^^^^^^
"KRN",19,2921195,1,0)
^19.06^4^4^3160806^^
"KRN",19,2921195,1,1,0)
This option allows the user to print the Isolation Report for each unit.  
"KRN",19,2921195,1,2,0)
The report includes MDROs selected in the initial setup and the historical
"KRN",19,2921195,1,3,0)
timeframe to search for the last positive result.  Isolation Orders will
"KRN",19,2921195,1,4,0)
print on the report, if they are utilized by the site.
"KRN",19,2921195,25)
MMRSISL
"KRN",19,2921195,99.1)
61663,44348
"KRN",19,2921195,"U")
PRINT ISOLATION REPORT
"KRN",19,2921196,-1)
0^37
"KRN",19,2921196,0)
MMRS NARES SWAB LIST^Print Nares Screen Compliance List^^R^^^^^^^^
"KRN",19,2921196,1,0)
^19.06^3^3^3161024^^
"KRN",19,2921196,1,1,0)
This option allows the user to print a report to capture the patient on a 
"KRN",19,2921196,1,2,0)
unit at a given time and if a nares screen was ordered upon admission to 
"KRN",19,2921196,1,3,0)
the unit.  This report prints real-time patient information for the unit.
"KRN",19,2921196,25)
MMRSORD
"KRN",19,2921196,"U")
PRINT NARES SCREEN COMPLIANCE 
"KRN",19,2921674,-1)
0^16
"KRN",19,2921674,0)
MMRS CDI REPORT^Print CDI Report^^R^^^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921674,25)
MAIN^MMRSCDI
"KRN",19,2921674,"U")
PRINT CDI REPORT
"KRN",19,2921683,-1)
0^36
"KRN",19,2921683,0)
MMRS MRSA IPEC REPORT^Print MRSA IPEC Report^^R^^^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921683,1,0)
^^3^3^3161028^
"KRN",19,2921683,1,1,0)
This option allows the user to print the MRSA IPEC report. The report can 
"KRN",19,2921683,1,2,0)
be run for the division or for a specific unit(s).  It allows you to 
"KRN",19,2921683,1,3,0)
select either the Admission Report or the Discharge/Transmission report.
"KRN",19,2921683,25)
MMRSIPC
"KRN",19,2921683,"U")
PRINT MRSA IPEC REPORT
"KRN",19,2921695,-1)
0^29
"KRN",19,2921695,0)
MMRS CRE REPORT^Print CRE Report^^R^^^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921695,25)
MMRSCRE
"KRN",19,2921695,"U")
PRINT CRE REPORT
"KRN",19,2921696,-1)
0^27
"KRN",19,2921696,0)
MMRS REPORTS MENU^MDRO Tools Reports Menu^^M^^^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921696,10,0)
^19.01IP^5^5
"KRN",19,2921696,10,1,0)
2921683^1^1
"KRN",19,2921696,10,1,"^")
MMRS MRSA IPEC REPORT
"KRN",19,2921696,10,2,0)
2921195^2^2
"KRN",19,2921696,10,2,"^")
MMRS ISOLATION REPORT
"KRN",19,2921696,10,3,0)
2921196^3^3
"KRN",19,2921696,10,3,"^")
MMRS NARES SWAB LIST
"KRN",19,2921696,10,4,0)
2921674^4^4
"KRN",19,2921696,10,4,"^")
MMRS CDI REPORT
"KRN",19,2921696,10,5,0)
2921695^5^5
"KRN",19,2921696,10,5,"^")
MMRS CRE REPORT
"KRN",19,2921696,99)
64250,72567
"KRN",19,2921696,"U")
MDRO TOOLS REPORTS MENU
"KRN",19,2921697,-1)
0^33
"KRN",19,2921697,0)
MMRS CDI REPORT (TASKED)^Print CDI Report (Tasked)^^R^^^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921697,1,0)
^19.06^7^7^3161206^^^
"KRN",19,2921697,1,1,0)
This option should not be run interactively - it should only be
"KRN",19,2921697,1,2,0)
tasked to run via Taskman. This option will print the Facility CDI Report 
"KRN",19,2921697,1,3,0)
and will use a one month default date range.
"KRN",19,2921697,1,4,0)
 
"KRN",19,2921697,1,5,0)
In order for this report to run successfully, the option will have to be 
"KRN",19,2921697,1,6,0)
scheduled in TaskMan.  When configuring this option, it will be necessary 
"KRN",19,2921697,1,7,0)
to set a default device and interval run time.
"KRN",19,2921697,25)
MAIN^MMRSCDI2
"KRN",19,2921697,200.9)
y
"KRN",19,2921697,"U")
PRINT CDI REPORT (TASKED)
"KRN",19,2921698,-1)
0^31
"KRN",19,2921698,0)
MMRS CRE SITE PARAMETER SETUP^CRE Tools Site Parameter Setup^^R^^MMRS SETUP^^^^^^MDRO INITIATIVE REPORTS
"KRN",19,2921698,1,0)
^^3^3^3161031^
"KRN",19,2921698,1,1,0)
This option is used to add Specimen(s) that will be used for 
"KRN",19,2921698,1,2,0)
surveillance screens.  This field will only be used when running the CRE 
"KRN",19,2921698,1,3,0)
report.
"KRN",19,2921698,25)
FLESPC^MMRSIPCP
"KRN",19,2921698,"U")
CRE TOOLS SITE PARAMETER SETUP
"KRN",19,2921699,-1)
1^8
"KRN",19,2921699,0)
MMRS MDRO WARD MAPPING SETUP
"KRN",19,2921700,-1)
1^14
"KRN",19,2921700,0)
MMRS MRSA TOOLS SETUP MENU
"KRN",19,2921701,-1)
1^20
"KRN",19,2921701,0)
MMRS MRSA HIST DAYS EDIT
"KRN",19,2921702,-1)
1^28
"KRN",19,2921702,0)
MMRS MDRO SITE PARAMETER SETUP
"KRN",19,2921703,-1)
1^34
"KRN",19,2921703,0)
MMRS MRSA LAB PARAMETER SETUP
"KRN",19,2921704,-1)
1^35
"KRN",19,2921704,0)
MMRS MRSA MDRO HIST DAYS EDIT
"KRN",19,2921705,-1)
1^38
"KRN",19,2921705,0)
MMRS MRSA PARAMETER SETUP
"KRN",19.1,789,-1)
0^1
"KRN",19.1,789,0)
MMRS SETUP^MRSA Tools Setup
"KRN",19.1,789,1,0)
^^2^2^3090302^
"KRN",19.1,789,1,1,0)
If a user has this key they are allowed to run the MRSA Tools Parameter 
"KRN",19.1,789,1,2,0)
Setup Menus and setup/change the system parameters.
"MBREQ")
0
"ORD",3,19.1)
19.1;3;;;KEY^XPDTA1;KEYF1^XPDIA1;KEYE1^XPDIA1;KEYF2^XPDIA1;;KEYDEL^XPDIA1
"ORD",3,19.1,0)
SECURITY KEY
"ORD",8,.403)
.403;8;;;EDEOUT^DIFROMSO(.403,DA,"",XPDA);FPRE^DIFROMSI(.403,"",XPDA);EPRE^DIFROMSI(.403,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.403,DA,"",XPDA);DEL^DIFROMSK(.403,"",%)
"ORD",8,.403,0)
FORM
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",656,-1)
1^1
"PKG",656,0)
MDRO INITIATIVE REPORTS^MMRS^MRSA PREVENTION INITIATIVE
"PKG",656,20,0)
^9.402P^^
"PKG",656,22,0)
^9.49I^1^1
"PKG",656,22,1,0)
1.0^3160720^3100224^520736433
"PKG",656,22,1,"PAH",1,0)
4^3161220^520736433
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","MMRSCDI")
0^1^B219284495^n/a
"RTN","MMRSCDI",1,0)
MMRSCDI ;LEIDOS/TCK - Print CDI report ; 12/15/16 6:50pm
"RTN","MMRSCDI",2,0)
 ;;1.0;MRSA TOOLS REPORTS MENU;**4**;Mar 22, 2009;Build 130
"RTN","MMRSCDI",3,0)
 ;
"RTN","MMRSCDI",4,0)
MAIN ;
"RTN","MMRSCDI",5,0)
 N EXTFLG,MMRSDIV,MMRSLOC
"RTN","MMRSCDI",6,0)
 ;check if parameters are setup.
"RTN","MMRSCDI",7,0)
 D CLEAN
"RTN","MMRSCDI",8,0)
 D CHECK^MMRSIPC Q:$D(EXTFLG)
"RTN","MMRSCDI",9,0)
 S NUMDIV=1
"RTN","MMRSCDI",10,0)
 D CHECK Q:$D(EXTFLG)
"RTN","MMRSCDI",11,0)
 D PROMPT
"RTN","MMRSCDI",12,0)
 I $D(EXTFLG) D CLEAN K MMRSSUM,DIVARY,DVSN,MDIV Q
"RTN","MMRSCDI",13,0)
 Q:'CHK
"RTN","MMRSCDI",14,0)
 K EXTFLG
"RTN","MMRSCDI",15,0)
 Q:'CHK
"RTN","MMRSCDI",16,0)
 D ASKDVC Q:$D(EXTFLG)
"RTN","MMRSCDI",17,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSCDI",18,0)
 D CLEAN
"RTN","MMRSCDI",19,0)
 D QUIT
"RTN","MMRSCDI",20,0)
 Q
"RTN","MMRSCDI",21,0)
 ;
"RTN","MMRSCDI",22,0)
PROMPT ;Prompt for division
"RTN","MMRSCDI",23,0)
 N STID,STNM,SIEN
"RTN","MMRSCDI",24,0)
 S (STP,ALL)=0
"RTN","MMRSCDI",25,0)
 I $G(MDROETIO)'>0 S MDROETIO=""
"RTN","MMRSCDI",26,0)
 S MMRSMDRO="",MMRSMDRO=$O(^MMRS(104.2,"B","C. diff",0))
"RTN","MMRSCDI",27,0)
 W !
"RTN","MMRSCDI",28,0)
 S DIR(0)="YA",DIR("A")="Do you want to select all divisions: ",DIR("B")="NO"
"RTN","MMRSCDI",29,0)
 D ^DIR K DIR
"RTN","MMRSCDI",30,0)
 I $D(DIRUT) S EXTFLG=1 Q
"RTN","MMRSCDI",31,0)
 I Y=1 S ALL=1 D  Q:'CHK
"RTN","MMRSCDI",32,0)
 .S CHK=1
"RTN","MMRSCDI",33,0)
 .S DIV=0 F  S DIV=$O(^MMRS(104,DIV)) Q:DIV'>0  D  Q:STP!('CHK)
"RTN","MMRSCDI",34,0)
 ..S WR=$$GET1^DIQ(104,+DIV,.01,"I")
"RTN","MMRSCDI",35,0)
 ..S IEN="",IEN=$O(^MMRS(104.1,"C",+DIV,MMRSMDRO,IEN))
"RTN","MMRSCDI",36,0)
 ..Q:$G(IEN)'>0
"RTN","MMRSCDI",37,0)
 ..S ORGP=$$GET1^DIQ(104.1,IEN,.01,"I")
"RTN","MMRSCDI",38,0)
 ..D CHKPAR(ORGP,+DIV,.CHK)
"RTN","MMRSCDI",39,0)
 ..I 'CHK S (MDROETIO,TSTSTP)=0 D ERROR  Q
"RTN","MMRSCDI",40,0)
 ..S FID=$$GET1^DIQ(40.8,WR,1,"E"),STID=$$GET1^DIQ(40.8,WR,.01,"E")
"RTN","MMRSCDI",41,0)
 ..S MMRSLOC(FID)=STID,DIVARY(STID)=+DIV
"RTN","MMRSCDI",42,0)
 ..I $G(NUMDIV)'>0 S STP=1 Q
"RTN","MMRSCDI",43,0)
 ..;I $G(SPCM)'>0 S STP=1 Q
"RTN","MMRSCDI",44,0)
 Q:STP
"RTN","MMRSCDI",45,0)
 I 'Y D  Q:'CHK
"RTN","MMRSCDI",46,0)
 .N DLAYGO,DTOUT,DUOUT
"RTN","MMRSCDI",47,0)
 .S CHK=1
"RTN","MMRSCDI",48,0)
 .W !
"RTN","MMRSCDI",49,0)
 .S DIC("A")="Select Division: "
"RTN","MMRSCDI",50,0)
 .S DIC="^MMRS(104,",DIC(0)="QEAM" D ^DIC
"RTN","MMRSCDI",51,0)
 .I (Y=-1)!($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSCDI",52,0)
 .S IEN="",IEN=$O(^MMRS(104.1,"C",+Y,MMRSMDRO,IEN))
"RTN","MMRSCDI",53,0)
 .Q:$G(IEN)'>0
"RTN","MMRSCDI",54,0)
 .S ORGP=$$GET1^DIQ(104.1,IEN,.01,"I")
"RTN","MMRSCDI",55,0)
 .D CHKPAR(ORGP,+Y,.CHK)
"RTN","MMRSCDI",56,0)
 .I 'CHK S (MDROETIO,TSTSTP)=0 D ERROR  Q
"RTN","MMRSCDI",57,0)
 .S STID=$$GET1^DIQ(104,+Y,.01,"E"),FID=$$GET1^DIQ(104,+Y,1,"E")
"RTN","MMRSCDI",58,0)
 .S MMRSLOC(FID)=STID,DIVARY(STID)=+Y
"RTN","MMRSCDI",59,0)
 .S CHK=1
"RTN","MMRSCDI",60,0)
 .S Y=""
"RTN","MMRSCDI",61,0)
 .S DIC("A")="Select another Division: " F  D ^DIC Q:Y=-1  D  Q:'CHK
"RTN","MMRSCDI",62,0)
 ..S IEN="",IEN=$O(^MMRS(104.1,"C",+Y,MMRSMDRO,IEN))
"RTN","MMRSCDI",63,0)
 ..Q:$G(IEN)'>0
"RTN","MMRSCDI",64,0)
 ..S ORGP=$$GET1^DIQ(104.1,IEN,.01,"I")
"RTN","MMRSCDI",65,0)
 ..D CHKPAR(ORGP,Y,.CHK)
"RTN","MMRSCDI",66,0)
 ..I 'CHK S (MDROETIO,TSTSTP)=0 D ERROR  Q
"RTN","MMRSCDI",67,0)
 ..S STID=$$GET1^DIQ(104,+Y,.01,"E")
"RTN","MMRSCDI",68,0)
 ..S FID=$$GET1^DIQ(104,+Y,1,"E"),MMRSLOC(FID)=STID,DIVARY(STID)=+Y
"RTN","MMRSCDI",69,0)
 ..I $G(NUMDIV)'>0 S STP=1 Q
"RTN","MMRSCDI",70,0)
 .I ($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSCDI",71,0)
 K DIC
"RTN","MMRSCDI",72,0)
 Q:$G(NUMDIV)'>0
"RTN","MMRSCDI",73,0)
 ;Q:$G(SPCM)'>0
"RTN","MMRSCDI",74,0)
 Q:$D(EXTFLG)
"RTN","MMRSCDI",75,0)
 I ($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSCDI",76,0)
DATE ;
"RTN","MMRSCDI",77,0)
 N DATE,%DT
"RTN","MMRSCDI",78,0)
 S DATE=$$FMADD^XLFDT(DT,-364),%DT("B")=$$FMTE^XLFDT(DATE,"L")
"RTN","MMRSCDI",79,0)
 W ! S %DT="AEPX",%DT("A")="Beginning POS CDI Lab ID Event (Collection) Date: " D ^%DT
"RTN","MMRSCDI",80,0)
 I Y<0 S EXTFLG=1 Q
"RTN","MMRSCDI",81,0)
 S STRTDT=Y
"RTN","MMRSCDI",82,0)
 I STRTDT<DATE W !!,"The start date of the range cannot be greater than one year from today." G DATE
"RTN","MMRSCDI",83,0)
 S DFLTDT=$$FMADD^XLFDT(STRTDT,-56)
"RTN","MMRSCDI",84,0)
DATE1 ;
"RTN","MMRSCDI",85,0)
 S %DT("A")="Ending POS CDI Lab ID Event (Collection) Date: " K %DT("B") D ^%DT
"RTN","MMRSCDI",86,0)
 I Y<0 S EXTFLG=1 Q
"RTN","MMRSCDI",87,0)
 S ENDDT=Y
"RTN","MMRSCDI",88,0)
 I '$P(ENDDT,".",2) S ENDDT=Y+.24
"RTN","MMRSCDI",89,0)
 I ENDDT<STRTDT W !!,"The end date of the range must be later than the starting date." G DATE1
"RTN","MMRSCDI",90,0)
 Q
"RTN","MMRSCDI",91,0)
 ;
"RTN","MMRSCDI",92,0)
CHKPAR(ORG,Y,CHK) ;
"RTN","MMRSCDI",93,0)
 ;
"RTN","MMRSCDI",94,0)
 N I,TST,ETI
"RTN","MMRSCDI",95,0)
 S (TSTSPT,MDROETIO)=0
"RTN","MMRSCDI",96,0)
 I '$D(^MMRS(104.1,"C",+Y,ORG)) S CHK=0 Q
"RTN","MMRSCDI",97,0)
 S I="",I=$O(^MMRS(104.1,"C",+Y,ORG,I))
"RTN","MMRSCDI",98,0)
 S LIEN=1_","_I_","
"RTN","MMRSCDI",99,0)
 S TST=$$GET1^DIQ(104.15,LIEN,.01,"I")
"RTN","MMRSCDI",100,0)
 I $G(TST)>0 S TSTSTP=1 Q
"RTN","MMRSCDI",101,0)
 S ETI=$$GET1^DIQ(104.109,LIEN,.01,"I")
"RTN","MMRSCDI",102,0)
 I $G(ETI)>0 S MDROETIO=1 Q
"RTN","MMRSCDI",103,0)
 S CHK=0
"RTN","MMRSCDI",104,0)
 Q
"RTN","MMRSCDI",105,0)
 ;
"RTN","MMRSCDI",106,0)
CHECK ; Check if lab tests and etiologies are setup
"RTN","MMRSCDI",107,0)
 N II,XX,TST,MRSASTAP,ORG,ETIONAME,MMRSET,MMRSI
"RTN","MMRSCDI",108,0)
 S (MDROETIO,TSTSTP)=0
"RTN","MMRSCDI",109,0)
 I $D(^MMRS(104.1)) D
"RTN","MMRSCDI",110,0)
 .S II=0 F  S II=$O(^MMRS(104.1,II)) Q:II'>0  D  Q:MDROETIO!(TSTSTP)
"RTN","MMRSCDI",111,0)
 ..Q:'$D(^MMRS(104.1,II,0))
"RTN","MMRSCDI",112,0)
 ..S ORGP=$P(^MMRS(104.1,II,0),"^")
"RTN","MMRSCDI",113,0)
 ..Q:$G(ORGP)'>0
"RTN","MMRSCDI",114,0)
 ..S ETIO=$$GET1^DIQ(104.2,ORGP,.01,"E")
"RTN","MMRSCDI",115,0)
 ..S ETIO=$$UPPER^DGUTL(ETIO)
"RTN","MMRSCDI",116,0)
 ..Q:ETIO'["DIFF"
"RTN","MMRSCDI",117,0)
 ..S IX=0
"RTN","MMRSCDI",118,0)
 ..F  S IX=$O(^MMRS(104.1,II,3,IX)) Q:IX'>0  D  Q:TSTSTP
"RTN","MMRSCDI",119,0)
 ...I $G(IX)>0 D
"RTN","MMRSCDI",120,0)
 ....Q:'$D(^MMRS(104.1,II,3,IX,0))
"RTN","MMRSCDI",121,0)
 ....S III=IX_","_II_","
"RTN","MMRSCDI",122,0)
 ....Q:III=""
"RTN","MMRSCDI",123,0)
 ....S TST=$$GET1^DIQ(104.15,III,.01,"E")
"RTN","MMRSCDI",124,0)
 ....;I $G(TST)'=""&(TST["DIFF") S TSTSTP=1
"RTN","MMRSCDI",125,0)
 ....I $G(TST)'="" S TSTSTP=1
"RTN","MMRSCDI",126,0)
 ....;Q:$G(TST)'["DIFF"
"RTN","MMRSCDI",127,0)
 ....;S TSTSTP=1
"RTN","MMRSCDI",128,0)
 ...I $D(^MMRS(104.1,II,6)) D
"RTN","MMRSCDI",129,0)
 ....S IXI=0 F  S IXI=$O(^MMRS(104.1,II,6,IXI)) Q:IXI'>0  D  Q:MDROETIO
"RTN","MMRSCDI",130,0)
 .....Q:IXI=""
"RTN","MMRSCDI",131,0)
 .....Q:'IXI
"RTN","MMRSCDI",132,0)
 .....S III=IXI_","_II_","
"RTN","MMRSCDI",133,0)
 .....S XX=$$GET1^DIQ(104.109,III,.01,"E")
"RTN","MMRSCDI",134,0)
 .....Q:XX'["CLOSTRIDIUM"
"RTN","MMRSCDI",135,0)
 .....S ETIONAME=XX,ORG=II,MDROETIO=ORG
"RTN","MMRSCDI",136,0)
 Q
"RTN","MMRSCDI",137,0)
 ;
"RTN","MMRSCDI",138,0)
ERROR ;
"RTN","MMRSCDI",139,0)
 I 'TSTSTP&'MDROETIO D
"RTN","MMRSCDI",140,0)
 .S EXTFLG=1
"RTN","MMRSCDI",141,0)
 .W !!,"   >>>The report cannot be run because the Laboratory Test(s) or"
"RTN","MMRSCDI",142,0)
 .W !,"       the Etiology is not configured in the MDRO TOOLS LAB "
"RTN","MMRSCDI",143,0)
 .W !,"       SEARCH/EXTRACT file, (104.1).  Use the MDRO Tools "
"RTN","MMRSCDI",144,0)
 .W !,"       Lab Parameter Setup option to configure."
"RTN","MMRSCDI",145,0)
 Q
"RTN","MMRSCDI",146,0)
 ;
"RTN","MMRSCDI",147,0)
MAIN2 ;
"RTN","MMRSCDI",148,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSCDI",149,0)
 D GETPARAM ; Load parameters in temp global
"RTN","MMRSCDI",150,0)
 D PRT
"RTN","MMRSCDI",151,0)
 Q
"RTN","MMRSCDI",152,0)
CLEAN ;
"RTN","MMRSCDI",153,0)
 K ^TMP($J,"MMRSCDI")
"RTN","MMRSCDI",154,0)
 K ^TMP($J,"MMRS")
"RTN","MMRSCDI",155,0)
 K ^TMP($J,"MMRSCD"),DIVARY,DVSN
"RTN","MMRSCDI",156,0)
 Q
"RTN","MMRSCDI",157,0)
 ;
"RTN","MMRSCDI",158,0)
GETPARAM ; Loads lab search/extract parameters from file 104.1
"RTN","MMRSCDI",159,0)
 N TSTNM,TST,TEST,IEN,TIEN,ITOP,TOP,ETOP,IBACT,BACT,EBACT
"RTN","MMRSCDI",160,0)
 N ETIOL,ETIOLOGY,ANTI,ANTIM,INC,MRSASTAP,ETIONAME,MMRSI,MMRSET,ORG
"RTN","MMRSCDI",161,0)
 N MDRO
"RTN","MMRSCDI",162,0)
 Q:'$D(DIVARY)
"RTN","MMRSCDI",163,0)
 S (TSTSTP,MMRSETIO,MMRSDIV)=0,DIVSN=""
"RTN","MMRSCDI",164,0)
 S MMRSMDRO=$O(^MMRS(104.2,"B","C. diff",0))
"RTN","MMRSCDI",165,0)
 F  S DIVSN=$O(DIVARY(DIVSN)) Q:DIVSN=""  D
"RTN","MMRSCDI",166,0)
 .K ^TMP($J,"MMRSCD")
"RTN","MMRSCDI",167,0)
 .S Y=DIVARY(DIVSN)
"RTN","MMRSCDI",168,0)
 .S IEN="",IEN=$O(^MMRS(104.1,"C",Y,MMRSMDRO,IEN))
"RTN","MMRSCDI",169,0)
 .Q:$G(IEN)'>0
"RTN","MMRSCDI",170,0)
 .S (FND,TST,INC)=0
"RTN","MMRSCDI",171,0)
 .;I $G(TSTSTP)'>0 S TSTSTP=1
"RTN","MMRSCDI",172,0)
 .;I TSTSTP D
"RTN","MMRSCDI",173,0)
 .S MDRO=MMRSMDRO
"RTN","MMRSCDI",174,0)
 .S TIEN=0 F  S TIEN=$O(^MMRS(104.1,IEN,3,TIEN)) Q:'TIEN  D
"RTN","MMRSCDI",175,0)
 ..S TEST=$P($G(^MMRS(104.1,IEN,3,TIEN,0)),U,1)
"RTN","MMRSCDI",176,0)
 ..Q:'TEST
"RTN","MMRSCDI",177,0)
 ..S INC=INC+1
"RTN","MMRSCDI",178,0)
 ..S TSTSTP=1
"RTN","MMRSCDI",179,0)
 ..S ^TMP($J,"MMRSCD","T",MDRO,TEST,0)=$P($G(^MMRS(104.1,IEN,3,TIEN,0)),U,2,3)
"RTN","MMRSCDI",180,0)
 .S IBACT=0 F  S IBACT=$O(^MMRS(104.1,IEN,4,IBACT)) Q:'IBACT  D
"RTN","MMRSCDI",181,0)
 ..S BACT=$G(^MMRS(104.1,IEN,4,IBACT,0))
"RTN","MMRSCDI",182,0)
 ..I BACT'="" S ^TMP($J,"MMRSCD","BACT",MDRO,"INC_REMARK",IBACT)=BACT
"RTN","MMRSCDI",183,0)
 .S EBACT=0 F  S EBACT=$O(^MMRS(104.1,IEN,5,EBACT)) Q:'EBACT  D
"RTN","MMRSCDI",184,0)
 ..S BACT=$G(^MMRS(104.1,MMRSMDRO,5,EBACT,0))
"RTN","MMRSCDI",185,0)
 ..I BACT'="" S ^TMP($J,"MMRSCD","BACT",MDRO,"EXC_REMARK",EBACT)=BACT
"RTN","MMRSCDI",186,0)
 .S ETIOL=0 F  S ETIOL=$O(^MMRS(104.1,IEN,6,ETIOL)) Q:'ETIOL  D
"RTN","MMRSCDI",187,0)
 ..S ETIOLOGY=$G(^MMRS(104.1,IEN,6,ETIOL,0))
"RTN","MMRSCDI",188,0)
 ..Q:'ETIOLOGY
"RTN","MMRSCDI",189,0)
 ..S ^TMP($J,"MMRSCD","ETIOL",MDRO,+ETIOLOGY)=""
"RTN","MMRSCDI",190,0)
 ..S ANTI=0 F  S ANTI=$O(^MMRS(104.1,IEN,6,ETIOL,1,ANTI)) Q:'ANTI  D
"RTN","MMRSCDI",191,0)
 ...S ANTIM=$P($G(^MMRS(104.1,IEN,6,ETIOL,1,ANTI,0)),U)
"RTN","MMRSCDI",192,0)
 ...I ANTIM S ^TMP($J,"MMRSCD","ETIOL",MDRO,ETIOLOGY,ANTI)=$G(^MMRS(104.1,IEN,6,ETIOL,1,ANTI,0))
"RTN","MMRSCDI",193,0)
 ..I $G(ETIOLOGY)'="" D
"RTN","MMRSCDI",194,0)
 ...D FIND^DIC(61.2,,".01E;@","PM","CLOSTRIDIUM DIFFICILE",,"B",,,"MMRSET")
"RTN","MMRSCDI",195,0)
 .S MMRSI="" F  S MMRSI=$O(MMRSET("DILIST",MMRSI)) Q:MMRSI=""  I +MMRSI>0  D
"RTN","MMRSCDI",196,0)
 ..S ETIONAME=$P($G(MMRSET("DILIST",MMRSI,0)),U,2)
"RTN","MMRSCDI",197,0)
 ..S ORG=$P($G(MMRSET("DILIST",MMRSI,0)),U,1)
"RTN","MMRSCDI",198,0)
 ..I ETIONAME'["CLOSTRIDIUM DIFFICILE" Q
"RTN","MMRSCDI",199,0)
 ..K ^TMP($J,"MMRSCD","ETIOL",MMRSMDRO,ORG)
"RTN","MMRSCDI",200,0)
 ..S ^TMP($J,"MMRSCD","ETIOL",MMRSMDRO,ORG)="",MDROETIO=1
"RTN","MMRSCDI",201,0)
 .K MMRSET
"RTN","MMRSCDI",202,0)
 .D SETDATA
"RTN","MMRSCDI",203,0)
 Q
"RTN","MMRSCDI",204,0)
 ;
"RTN","MMRSCDI",205,0)
SETDATA ;
"RTN","MMRSCDI",206,0)
 N LOCATION,LOCNAME,DFN,LOCTYPE,MMRSI,SDRESULT,Y,WLOC,WARD,WARDNAME,VAIP,WRDNME
"RTN","MMRSCDI",207,0)
 S DFN=0 F  S DFN=$O(^DPT(DFN)) Q:'DFN  D
"RTN","MMRSCDI",208,0)
 .Q:'$D(^PXRMINDX(63,"PI",DFN))
"RTN","MMRSCDI",209,0)
 .Q:$G(DFN)'>0
"RTN","MMRSCDI",210,0)
 .D SETDATA2(DFN)
"RTN","MMRSCDI",211,0)
 Q
"RTN","MMRSCDI",212,0)
 ;
"RTN","MMRSCDI",213,0)
SETDATA2(DFN) ;
"RTN","MMRSCDI",214,0)
 N INTT,IEN,INDATE,INIFN,MRSA,MRSACULT,LABORDER,TSTNM,LABTEST,ORDITM,ORDTEMP,PATNM,VADM,DCDATE
"RTN","MMRSCDI",215,0)
 S LOC=""
"RTN","MMRSCDI",216,0)
 S (CDIVT,PCD)=""
"RTN","MMRSCDI",217,0)
 ;Get MRSA history
"RTN","MMRSCDI",218,0)
 D GETLAB^MMRSCDI1(DFN,.MRSA,MMRSMDRO,MMRSNOW,"CD")
"RTN","MMRSCDI",219,0)
 Q:'$D(MRSA)
"RTN","MMRSCDI",220,0)
 S I="" F  S I=$O(MRSA(I)) Q:I=""  D
"RTN","MMRSCDI",221,0)
 .Q:I=""
"RTN","MMRSCDI",222,0)
 .S CDIVT=I
"RTN","MMRSCDI",223,0)
 .S MRSA=$P(MRSA(I),"^",1,2)
"RTN","MMRSCDI",224,0)
 .S LOC=+$P(MRSA(I),"^",3)
"RTN","MMRSCDI",225,0)
 .S DVSN=$$GET1^DIQ(44,+LOC,3.5,"E")
"RTN","MMRSCDI",226,0)
 .Q:DVSN'=DIVSN
"RTN","MMRSCDI",227,0)
 .Q:'$D(DIVARY(DVSN))
"RTN","MMRSCDI",228,0)
 .S WARDNAME=$$GET1^DIQ(44,+LOC,.01,"E")
"RTN","MMRSCDI",229,0)
 .;Get Order info
"RTN","MMRSCDI",230,0)
 .S LABORDER="^^"
"RTN","MMRSCDI",231,0)
 .Q:'CDIVT
"RTN","MMRSCDI",232,0)
 .S MRSA=$P(MRSA(I),"^",2)
"RTN","MMRSCDI",233,0)
 .S LRFILE=44
"RTN","MMRSCDI",234,0)
 .S STPCD=$$GET1^DIQ(LRFILE,+LOC,8,"I")
"RTN","MMRSCDI",235,0)
 .S TYPE=$$GET1^DIQ(LRFILE,+LOC,2,"E")
"RTN","MMRSCDI",236,0)
 .S SERV=$$GET1^DIQ(LRFILE,+LOC,9,"E")
"RTN","MMRSCDI",237,0)
 .D GTDATE(DFN,CDIVT,.INDATE,.DCDATE)
"RTN","MMRSCDI",238,0)
 .I $G(TYPE)'="",TYPE'="WARD" S INDATE=""
"RTN","MMRSCDI",239,0)
 .I $D(^TMP($J,"MMRSCD","T")) D
"RTN","MMRSCDI",240,0)
 ..S MDRO="" F  S MDRO=$O(^TMP($J,"MMRSCD","T",MDRO)) Q:MDRO=""  D
"RTN","MMRSCDI",241,0)
 ...Q:$G(MDRO)'>0
"RTN","MMRSCDI",242,0)
 ...S TST="" F  S TST=$O(^TMP($J,"MMRSCD","T",MDRO,TST)) Q:TST=""  D
"RTN","MMRSCDI",243,0)
 ....N TESTS D GORDITM(TST,.LABORDER,.TESTS) ;MIA/LMT - Added with patch MMRS*1*1
"RTN","MMRSCDI",244,0)
 .S PCD="",PATNM=$$GET1^DIQ(2,DFN,.01,"E")
"RTN","MMRSCDI",245,0)
 .Q:$D(^TMP($J,"MMRSCDI",DVSN,WARDNAME,PATNM,DFN,CDIVT))
"RTN","MMRSCDI",246,0)
 .I $D(^TMP($J,"MMRSCDI",DVSN,WARDNAME,PATNM,DFN)) D
"RTN","MMRSCDI",247,0)
 ..S PCD=999999999999999
"RTN","MMRSCDI",248,0)
 ..S PCD=$O(^TMP($J,"MMRSCDI",DVSN,WARDNAME,PATNM,DFN,PCD),-1)
"RTN","MMRSCDI",249,0)
 .S CD=CDIVT,CD=$O(MRSA(CD),-1)
"RTN","MMRSCDI",250,0)
 .I $G(CD)>0,CD<CDIVT S PCD=CD
"RTN","MMRSCDI",251,0)
 .Q:CDIVT<STRTDT
"RTN","MMRSCDI",252,0)
 .S ^TMP($J,"MMRSCDI",DVSN,WARDNAME,PATNM,DFN,CDIVT)=$G(TYPE)_U_$G(SERV)_U_$G(STPCD)_U_$G(CDIVT)_U_$G(INDATE)_U_$G(DCDATE)_U_$G(MRSA)_U_$G(PCD),PCD=""
"RTN","MMRSCDI",253,0)
 K MRSA
"RTN","MMRSCDI",254,0)
 Q
"RTN","MMRSCDI",255,0)
 ;
"RTN","MMRSCDI",256,0)
GTDATE(DFN,CDIVT,IND,DCDT) ;
"RTN","MMRSCDI",257,0)
 N DATE,IEN
"RTN","MMRSCDI",258,0)
 S (IND,DCDT)="",FND=0
"RTN","MMRSCDI",259,0)
 Q:$G(CDIVT)=""
"RTN","MMRSCDI",260,0)
 Q:'$D(^DGPM("APTT1",DFN))
"RTN","MMRSCDI",261,0)
 S DATE=9999999999,TT=1
"RTN","MMRSCDI",262,0)
 F  S DATE=$O(^DGPM("APTT"_TT,DFN,DATE),-1) Q:DATE=""  D  Q:FND
"RTN","MMRSCDI",263,0)
 .Q:DATE=""
"RTN","MMRSCDI",264,0)
 .I CDIVT<DATE Q
"RTN","MMRSCDI",265,0)
 .S IEN="",IEN=$O(^DGPM("APTT"_TT,DFN,DATE,IEN))
"RTN","MMRSCDI",266,0)
 .Q:$G(IEN)'>0
"RTN","MMRSCDI",267,0)
 .I $G(IEN)>0 D
"RTN","MMRSCDI",268,0)
 ..S IND=$$GET1^DIQ(405,IEN,.01,"I")
"RTN","MMRSCDI",269,0)
 ..S WRD=$$GET1^DIQ(405,IEN,.06,"E")
"RTN","MMRSCDI",270,0)
 ..S LOCNME="",LOCNME=$$GET1^DIQ(44,LOC,.01,"E")
"RTN","MMRSCDI",271,0)
 .Q:WRD'=LOCNME
"RTN","MMRSCDI",272,0)
 .I WRD=LOCNME S FND=1
"RTN","MMRSCDI",273,0)
 .S NXDT=$O(^DGPM("APTT"_TT,DFN,DATE),-1)
"RTN","MMRSCDI",274,0)
 .I $G(NXDT)'>0 K NXDT S FND=1
"RTN","MMRSCDI",275,0)
 .I $G(NXDT)>0 S DATE=NXDT,NXDT=""
"RTN","MMRSCDI",276,0)
 .Q:$G(DATE)'>0
"RTN","MMRSCDI",277,0)
 .S IEN="",IEN=$O(^DGPM("APTT"_TT,DFN,DATE,IEN))
"RTN","MMRSCDI",278,0)
 .S TIEN=$$GET1^DIQ(405,IEN,.17,"I")
"RTN","MMRSCDI",279,0)
 .I $G(TIEN)'>0 Q
"RTN","MMRSCDI",280,0)
 .S DCDT=$$GET1^DIQ(405,TIEN,.01,"I")
"RTN","MMRSCDI",281,0)
 .I DCDT>CDIVT S FND=1,DCDT="" Q
"RTN","MMRSCDI",282,0)
 .I DCDT'="" S FND=1 Q
"RTN","MMRSCDI",283,0)
 Q
"RTN","MMRSCDI",284,0)
 ;
"RTN","MMRSCDI",285,0)
GORDITM(LABTEST,LABORDER,TESTS) ;MIA/LMT - Added with patch MMRS*1*1 - Include panels in search
"RTN","MMRSCDI",286,0)
 N ORDITM,ORDTEMP,LABPANEL
"RTN","MMRSCDI",287,0)
 I $D(TESTS(LABTEST)) Q  ;prevent infinite recursion; if site has Panel A within Panel B, and Panel B within Panel A
"RTN","MMRSCDI",288,0)
 S TESTS(LABTEST)=1 ;mark that we have searched this test (to prevent infinite recursion)
"RTN","MMRSCDI",289,0)
 S ORDITM=0 F  S ORDITM=$O(^ORD(101.43,"ID",LABTEST_";99LRT",ORDITM)) Q:'ORDITM  D
"RTN","MMRSCDI",290,0)
 .S ORDTEMP=$$GETORD(DFN,ORDITM,INDATE)
"RTN","MMRSCDI",291,0)
 .I $P(LABORDER,U,1)'="YES"!(($P(LABORDER,U,3)'="YES")&($P(ORDTEMP,U,3)="YES")) S LABORDER=ORDTEMP
"RTN","MMRSCDI",292,0)
 S LABPANEL=0 F  S LABPANEL=$O(^LAB(60,"AB",LABTEST,LABPANEL)) Q:'LABPANEL  D
"RTN","MMRSCDI",293,0)
 .D GORDITM(LABPANEL,.LABORDER,.TESTS) ;Recursive call to check for tests within panels
"RTN","MMRSCDI",294,0)
 Q
"RTN","MMRSCDI",295,0)
GETORD(DFN,ORDITM,INDATE) ;
"RTN","MMRSCDI",296,0)
 N RESULT,START,STOP,DAS,STATUS,ORUPCHUK,LABREC
"RTN","MMRSCDI",297,0)
 S RESULT="^^"
"RTN","MMRSCDI",298,0)
 S START=$$FMADD^XLFDT(INDATE,-1)-.0000001
"RTN","MMRSCDI",299,0)
 F  S START=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START)) Q:'START  D
"RTN","MMRSCDI",300,0)
 .S STOP="" F  S STOP=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START,STOP)) Q:STOP=""  D
"RTN","MMRSCDI",301,0)
 ..S DAS="" F  S DAS=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START,STOP,DAS)) Q:DAS=""  D
"RTN","MMRSCDI",302,0)
 ...D EN^ORX8(+DAS)
"RTN","MMRSCDI",303,0)
 ...S STATUS=$P(ORUPCHUK("ORSTS"),U,1)
"RTN","MMRSCDI",304,0)
 ...I STATUS'=2,STATUS'=5,STATUS'=6 Q
"RTN","MMRSCDI",305,0)
 ...S LABREC="NO"
"RTN","MMRSCDI",306,0)
 ...I STATUS=6!(STATUS=2) S LABREC="YES"
"RTN","MMRSCDI",307,0)
 ...I $P(RESULT,U,3)'="YES" S RESULT="YES^"_START_U_LABREC
"RTN","MMRSCDI",308,0)
 Q RESULT
"RTN","MMRSCDI",309,0)
PRT ;
"RTN","MMRSCDI",310,0)
 N LN,PG,LOCNAME,PATNM,DFN,NODE,LAST4,INTT,ADT,ORDDATE,VADM,QUIT,COUNT,DOB,PRVCDI
"RTN","MMRSCDI",311,0)
 K ^TMP($J,"MMRSCDI","T")
"RTN","MMRSCDI",312,0)
 K ^TMP($J,"MMRSCDI","ETIOL")
"RTN","MMRSCDI",313,0)
 S $P(LN,"-",160)=""
"RTN","MMRSCDI",314,0)
 S PG=1,QUIT=0
"RTN","MMRSCDI",315,0)
 S DVS=""
"RTN","MMRSCDI",316,0)
 F  S DVS=$O(DIVARY(DVS)) Q:DVS=""  D
"RTN","MMRSCDI",317,0)
 .I '$D(^TMP($J,"MMRSCDI",DVS)) D  Q
"RTN","MMRSCDI",318,0)
 ..S WARDNAME=""
"RTN","MMRSCDI",319,0)
 ..D PRTHDRS
"RTN","MMRSCDI",320,0)
 ..W !!!,"NO RECORDS FOUND FOR REPORTING PERIOD."
"RTN","MMRSCDI",321,0)
 .S WARDNAME="" F  S WARDNAME=$O(^TMP($J,"MMRSCDI",DVS,WARDNAME)) Q:WARDNAME=""  D  Q:QUIT
"RTN","MMRSCDI",322,0)
 ..I WARDNAME="" S QUIT=1 Q
"RTN","MMRSCDI",323,0)
 ..Q:'$D(^TMP($J,"MMRSCDI",DVS,WARDNAME))
"RTN","MMRSCDI",324,0)
 ..D PRTHDRS
"RTN","MMRSCDI",325,0)
 ..S PATNM="" F  S PATNM=$O(^TMP($J,"MMRSCDI",DVS,WARDNAME,PATNM)) Q:PATNM=""  D
"RTN","MMRSCDI",326,0)
 ...I PATNM?.N K ^TMP($J,"MMRSCDI",DVS,WARDNAME,PATNM) Q
"RTN","MMRSCDI",327,0)
 ...S DFN=0 F  S DFN=$O(^TMP($J,"MMRSCDI",DVS,WARDNAME,PATNM,DFN)) Q:'DFN  D  Q:'DFN
"RTN","MMRSCDI",328,0)
 ....S CD=0 F  S CD=$O(^TMP($J,"MMRSCDI",DVS,WARDNAME,PATNM,DFN,CD)) Q:'CD  D
"RTN","MMRSCDI",329,0)
 .....S NODE=$G(^TMP($J,"MMRSCDI",DVS,WARDNAME,PATNM,DFN,CD))
"RTN","MMRSCDI",330,0)
 .....S TYPE=$P(NODE,"^")
"RTN","MMRSCDI",331,0)
 .....S SERV=$P(NODE,"^",2)
"RTN","MMRSCDI",332,0)
 .....S STPCD=$P(NODE,"^",3)
"RTN","MMRSCDI",333,0)
 .....S CDIVT=$P(NODE,"^",4) I $G(CDIVT)>0 D
"RTN","MMRSCDI",334,0)
 ......S CDIVT=$$FMTE^XLFDT(CDIVT,2)
"RTN","MMRSCDI",335,0)
 ......I CDIVT["@" S CDIVT=$TR(CDIVT,"@"," ")
"RTN","MMRSCDI",336,0)
 .....S INDATE=$P(NODE,"^",5) I $G(INDATE)>0 D
"RTN","MMRSCDI",337,0)
 ......S INDATE=$$FMTE^XLFDT(INDATE,2)
"RTN","MMRSCDI",338,0)
 ......I INDATE["@" S INDATE=$TR(INDATE,"@"," ")
"RTN","MMRSCDI",339,0)
 .....S DCDT=$P(NODE,U,6) I $G(DCDT)>0 D
"RTN","MMRSCDI",340,0)
 ......S DCDT=$$FMTE^XLFDT(DCDT,2)
"RTN","MMRSCDI",341,0)
 ......I DCDT["@" S DCDT=$TR(DCDT,"@"," ")
"RTN","MMRSCDI",342,0)
 .....S PRVCDI=$P(NODE,U,8) I $G(PRVCDI)>0 D
"RTN","MMRSCDI",343,0)
 ......S PRVCDI=$$FMTE^XLFDT(PRVCDI,2)
"RTN","MMRSCDI",344,0)
 ......I PRVCDI["@" S PRVCDI=$TR(PRVCDI,"@"," ")
"RTN","MMRSCDI",345,0)
 .....D KVA^VADPT
"RTN","MMRSCDI",346,0)
 .....D DEM^VADPT
"RTN","MMRSCDI",347,0)
 .....S LAST4=$E($P(VADM(2),U),6,9)
"RTN","MMRSCDI",348,0)
 .....D KVA^VADPT
"RTN","MMRSCDI",349,0)
 .....S ORDDATE=$P(NODE,"^",5)
"RTN","MMRSCDI",350,0)
 .....I ORDDATE S ORDDATE=$$FMTE^XLFDT(ORDDATE,"2M")
"RTN","MMRSCDI",351,0)
 .....S DOB=$$GET1^DIQ(2,DFN,.03,"E")
"RTN","MMRSCDI",352,0)
 .....W !,$E(PATNM,1,30),?25,LAST4,?30,DOB,?42,$G(CDIVT),?70,$G(INDATE),?90,$G(WARDNAME),?106,$G(DCDT),?130,$G(PRVCDI)
"RTN","MMRSCDI",353,0)
 .....S COUNT=$G(COUNT)+1
"RTN","MMRSCDI",354,0)
 .....S DL="^"
"RTN","MMRSCDI",355,0)
 .....S ^TMP($J,"MMRS",COUNT)=PATNM_DL_LAST4_DL_DOB_DL_$G(CDIVT)_DL_$G(INDATE)_DL_$G(WARDNAME)_DL_$G(TYPE)_DL_$G(SERV)_DL_$G(STPCD)_DL_$G(DCDT)_DL_$G(PRVCDI)
"RTN","MMRSCDI",356,0)
 ....S PRVCDI=""
"RTN","MMRSCDI",357,0)
 I '$D(ZTSK)&($G(ION)'["P-MESS") D
"RTN","MMRSCDI",358,0)
 .D PRINTCDI
"RTN","MMRSCDI",359,0)
 W !!,"END OF REPORT."
"RTN","MMRSCDI",360,0)
 Q
"RTN","MMRSCDI",361,0)
 ;
"RTN","MMRSCDI",362,0)
PRINTCDI ;
"RTN","MMRSCDI",363,0)
 W !!
"RTN","MMRSCDI",364,0)
 I '$D(^TMP($J,"MMRS")) W !!!,"No CDI cases found during specified date range" Q
"RTN","MMRSCDI",365,0)
 N DIR,DUOUT,DTOUT,DIRUT,Y
"RTN","MMRSCDI",366,0)
 S PRINT=0
"RTN","MMRSCDI",367,0)
 S DIR("A")="Print a delimited report to the screen? (Y/N): "
"RTN","MMRSCDI",368,0)
 S DIR(0)="YA" D ^DIR
"RTN","MMRSCDI",369,0)
 I $D(DIRUT)!($D(DUOUT)!$D(DTOUT)) S PRINT=0
"RTN","MMRSCDI",370,0)
 I Y>0 S PRINT=1
"RTN","MMRSCDI",371,0)
 S CDI=1
"RTN","MMRSCDI",372,0)
 Q:'PRINT
"RTN","MMRSCDI",373,0)
 W !!,"Delimited Report will now be printed to the screen..." H 3
"RTN","MMRSCDI",374,0)
 D ^%ZIS
"RTN","MMRSCDI",375,0)
 W @IOF
"RTN","MMRSCDI",376,0)
 N C,I,DL
"RTN","MMRSCDI",377,0)
 S (C,I)="",DL="^",CNT=0
"RTN","MMRSCDI",378,0)
 F  S C=$O(^TMP($J,"MMRS",C)) Q:C=""  D
"RTN","MMRSCDI",379,0)
 .S X1=$P(^TMP($J,"MMRS",C),DL)
"RTN","MMRSCDI",380,0)
 .S X2=$P(^TMP($J,"MMRS",C),DL,2)
"RTN","MMRSCDI",381,0)
 .S X3=$P(^TMP($J,"MMRS",C),DL,3)
"RTN","MMRSCDI",382,0)
 .S X4=$P(^TMP($J,"MMRS",C),DL,4)
"RTN","MMRSCDI",383,0)
 .S X5=$P(^TMP($J,"MMRS",C),DL,5)
"RTN","MMRSCDI",384,0)
 .S X6=$P(^TMP($J,"MMRS",C),DL,6)
"RTN","MMRSCDI",385,0)
 .S X7=$P(^TMP($J,"MMRS",C),DL,7)
"RTN","MMRSCDI",386,0)
 .S X8=$P(^TMP($J,"MMRS",C),DL,8)
"RTN","MMRSCDI",387,0)
 .S X9=$P(^TMP($J,"MMRS",C),DL,9)
"RTN","MMRSCDI",388,0)
 .S X10=""
"RTN","MMRSCDI",389,0)
 .S X11=$P(^TMP($J,"MMRS",C),DL,10)
"RTN","MMRSCDI",390,0)
 .S X12=$P(^TMP($J,"MMRS",C),DL,11)
"RTN","MMRSCDI",391,0)
 .W !,X1_DL_X2_DL_X3_DL_X4_DL_X5_DL_X6_DL_X7_DL_X8_DL_X9_DL_X10_DL_X11_DL_X12
"RTN","MMRSCDI",392,0)
 Q
"RTN","MMRSCDI",393,0)
 ;
"RTN","MMRSCDI",394,0)
PRTHDRS ; Helper Function for PRT - Prints report headers
"RTN","MMRSCDI",395,0)
 W @IOF
"RTN","MMRSCDI",396,0)
 W ?13,"FACILITY CDI CASES REPORT"
"RTN","MMRSCDI",397,0)
 W !,?13,"Division: ",DVS
"RTN","MMRSCDI",398,0)
 W !,?13,"Geographical Location: ",WARDNAME
"RTN","MMRSCDI",399,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?75,"PAGE: ",PG
"RTN","MMRSCDI",400,0)
 W !,"PATIENT",?25,"SSN",?30,"DOB",?42,"CDI Event D/T",?70,"ADM D/T",?90,"LOCATION",?105,"DC D/T",?130,"PREV CDI Event D/T"
"RTN","MMRSCDI",401,0)
 W !,LN
"RTN","MMRSCDI",402,0)
 S PG=PG+1
"RTN","MMRSCDI",403,0)
 Q
"RTN","MMRSCDI",404,0)
ASKDVC ;Prompts user for device of output (allows queuing)
"RTN","MMRSCDI",405,0)
 W !!
"RTN","MMRSCDI",406,0)
 N MMRSVAR
"RTN","MMRSCDI",407,0)
 W !!!,"This report is designed for a 132 column format (compressed).",!
"RTN","MMRSCDI",408,0)
 S MMRSVAR("MMRSLOC")="",MMRS("MMRSLOC(")="",MMRSVAR("MMRSDIV")="",MMRSVAR("STRTDT")=""
"RTN","MMRSCDI",409,0)
 S MMRSVAR("ENDDT")="",MMRSVAR("TSTSTP")="",MMRSVAR("MDROETIO")="",MMRSVAR("DFLTDT")="",MMRSVAR("DIVARY")="",MMRSVAR("DIVARY(")=""
"RTN","MMRSCDI",410,0)
 D EN^XUTMDEVQ("MAIN2^MMRSCDI","Print CDI report (MMRSCDI)",.MMRSVAR,"QM",1)
"RTN","MMRSCDI",411,0)
 W:$D(ZTSK) !,"Report Queued to Print ("_ZTSK_").",!
"RTN","MMRSCDI",412,0)
 Q
"RTN","MMRSCDI",413,0)
 ;
"RTN","MMRSCDI",414,0)
QUIT ;
"RTN","MMRSCDI",415,0)
 K ENDDT,FND,CDI,LCPTR,LRFILE,MMRSMDRO,PCDIVT,PRINT,PCDIVT,SERV
"RTN","MMRSCDI",416,0)
 K STPCD,STRTDT,TYPE,WPTR,WRDPTR,X2,X10,X12,X2,X3,X4,X5,X6,X7,X8,X9
"RTN","MMRSCDI",417,0)
 K X1,X11,MRSA,^TMP($J),ORGP,MDROETIO,CNT,PCD,CD,ETIO,III,IX,I
"RTN","MMRSCDI",418,0)
 K LOC,MMRSNOW,PTR,TSTSTP,ZTSK,DVSN,DIVARY
"RTN","MMRSCDI",419,0)
 Q
"RTN","MMRSCDI",420,0)
 ;
"RTN","MMRSCDI1")
0^2^B47343212^n/a
"RTN","MMRSCDI1",1,0)
MMRSCDI1 ;LEIDOS/TCK - Print CDI Report Cont. (Contains functions to collect patient labs and swabbing rate) ; 11/26/16 8:30am
"RTN","MMRSCDI1",2,0)
 ;;1.0;MDRO TOOLS REPORTS MENU;**4**;Mar 22, 2009;Build 130
"RTN","MMRSCDI1",3,0)
 ;
"RTN","MMRSCDI1",4,0)
GETLAB(DFN,MRSA,LRMDRO,LREND,LRDTTYP) ;RETURN YES/NO^RESULT
"RTN","MMRSCDI1",5,0)
 N LRRSLT,LRTST,TMPRSLT,NUMB,TSTRSLT
"RTN","MMRSCDI1",6,0)
 S LRRSLT="^",NUMB=0
"RTN","MMRSCDI1",7,0)
 I $G(DFN)=""!($G(LRMDRO)="")!($G(LREND)="") Q LRRSLT
"RTN","MMRSCDI1",8,0)
 ;CHECK FOR MI RSULTS
"RTN","MMRSCDI1",9,0)
 I MDROETIO D
"RTN","MMRSCDI1",10,0)
 .D GETMI(DFN,LRMDRO,LREND,LRDTTYP,.MRSA)
"RTN","MMRSCDI1",11,0)
 .Q:'$D(MRSA)
"RTN","MMRSCDI1",12,0)
 ;CHECK FOR CH RESULTS
"RTN","MMRSCDI1",13,0)
 I TSTSTP D
"RTN","MMRSCDI1",14,0)
 .S LRRSLT="^"
"RTN","MMRSCDI1",15,0)
 .S LRTST=0 F  S LRTST=$O(^TMP($J,"MMRSCD","T",LRMDRO,LRTST)) Q:'LRTST  D
"RTN","MMRSCDI1",16,0)
 ..S SUBS=$$GET1^DIQ(60,+LRTST,4,"I")
"RTN","MMRSCDI1",17,0)
 ..I SUBS="CH" D GETCH(DFN,LRMDRO,+LRTST,LREND,LRDTTYP,.MRSA)
"RTN","MMRSCDI1",18,0)
 Q
"RTN","MMRSCDI1",19,0)
 ;
"RTN","MMRSCDI1",20,0)
GETCH(DFN,LRMDRO,LRTST,LREND,LRDTTYP,MRSA) ;RETURN YES^RESULT
"RTN","MMRSCDI1",21,0)
 N LIENS,LOC,LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD
"RTN","MMRSCDI1",22,0)
 S LRRSLT="^",CDIVT=""
"RTN","MMRSCDI1",23,0)
 S LRDATE=""
"RTN","MMRSCDI1",24,0)
 I LRDTTYP="RAD" S LRDATE=0,LRRADEND=LREND,LREND=9999999
"RTN","MMRSCDI1",25,0)
 Q:'$D(^PXRMINDX(63,"PI",DFN,+LRTST))
"RTN","MMRSCDI1",26,0)
 F  S LRDATE=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE)) Q:'LRDATE  D
"RTN","MMRSCDI1",27,0)
 .Q:LRDATE>ENDDT
"RTN","MMRSCDI1",28,0)
 .Q:LRDATE<DFLTDT
"RTN","MMRSCDI1",29,0)
 .S DAS=0 F  S DAS=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE,DAS)) Q:'DAS  D
"RTN","MMRSCDI1",30,0)
 ..S LRDFN=$P(DAS,";")
"RTN","MMRSCDI1",31,0)
 ..S LRIDT=$P(DAS,";",3)
"RTN","MMRSCDI1",32,0)
 ..I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3) I LRRAD<STRTDT!(LRRAD>LRRADEND) Q
"RTN","MMRSCDI1",33,0)
 ..Q:LRDATE<DFLTDT
"RTN","MMRSCDI1",34,0)
 ..Q:LRDATE>ENDDT
"RTN","MMRSCDI1",35,0)
 ..Q:$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3)=""
"RTN","MMRSCDI1",36,0)
 ..;GET ORDER NUMBER FROM ORUT NODE
"RTN","MMRSCDI1",37,0)
 ..Q:'$D(^LR(LRDFN,"CH",LRIDT,"ORUT"))
"RTN","MMRSCDI1",38,0)
 ..I $D(^LR(LRDFN,"CH",LRIDT,"ORUT")) D
"RTN","MMRSCDI1",39,0)
 ...S LIENS=1_","_LRIDT_","_LRDFN_","
"RTN","MMRSCDI1",40,0)
 ...S ORN=$$GET1^DIQ(63.07,LIENS,3,"E")
"RTN","MMRSCDI1",41,0)
 ..I $G(ORN)>0 D  Q:'CDIVT
"RTN","MMRSCDI1",42,0)
 ...I $D(^OR(100,ORN,4)),$P(^OR(100,ORN,4),";")="" S CDIVT=0 Q
"RTN","MMRSCDI1",43,0)
 ...S LOC=+$$GET1^DIQ(100,ORN,6,"I")
"RTN","MMRSCDI1",44,0)
 ...S CDIVT=$$GET1^DIQ(100,ORN,21,"I")
"RTN","MMRSCDI1",45,0)
 ..S LRLOC=$G(LOC)
"RTN","MMRSCDI1",46,0)
 ..S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSCDI1",47,0)
 ..S TSTRSLT=$$CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST)
"RTN","MMRSCDI1",48,0)
 ..I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSCDI1",49,0)
 ...S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";CH")
"RTN","MMRSCDI1",50,0)
 ...S LRRSLT=LRRSLT_"^"_LOC
"RTN","MMRSCDI1",51,0)
 ...S MRSA(CDIVT)=LRRSLT,LRRSLT="^"
"RTN","MMRSCDI1",52,0)
 Q
"RTN","MMRSCDI1",53,0)
 ;
"RTN","MMRSCDI1",54,0)
GETMI(DFN,LRMDRO,LREND,LRDTTYP,MRSA) ;RETURN YES^RESULT
"RTN","MMRSCDI1",55,0)
 N LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD,RSARY
"RTN","MMRSCDI1",56,0)
 S LRRSLT="^"
"RTN","MMRSCDI1",57,0)
 I '$D(^TMP($J,"MMRSCD","BACT",LRMDRO,"INC_REMARK")),'$D(^TMP($J,"MMRSCD","ETIOL",LRMDRO)) Q LRRSLT
"RTN","MMRSCDI1",58,0)
 S LRDFN=$$LRDFN^LR7OR1(DFN)
"RTN","MMRSCDI1",59,0)
 Q:'LRDFN LRRSLT
"RTN","MMRSCDI1",60,0)
 S LRIDT=(9999999-LREND)-.0000001,COUNT=0
"RTN","MMRSCDI1",61,0)
 I LRDTTYP="RAD" S LRIDT=0,LREND=99999999
"RTN","MMRSCDI1",62,0)
 F  S LRIDT=$O(^LR(LRDFN,"MI",LRIDT)) Q:'LRIDT!(LRIDT<LREND)  D
"RTN","MMRSCDI1",63,0)
 .I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,3) I LRRAD<STRTDT!(LRRAD>LREND) Q
"RTN","MMRSCDI1",64,0)
 .;CHECK FOR PRELIM
"RTN","MMRSCDI1",65,0)
 .S LIEN=LRIDT_","_LRDFN_","
"RTN","MMRSCDI1",66,0)
 .Q:$$GET1^DIQ(63.05,LIEN,11.5,"I")="P"
"RTN","MMRSCDI1",67,0)
 .;GET ORDER NUMBER FROM ORUT NODE
"RTN","MMRSCDI1",68,0)
 .Q:'$D(^LR(LRDFN,"MI",LRIDT,"ORUT"))
"RTN","MMRSCDI1",69,0)
 .S LIEN=LRIDT_","_LRDFN_","
"RTN","MMRSCDI1",70,0)
 .Q:$$GET1^DIQ(63.05,LIEN,.01,"I")<DFLTDT
"RTN","MMRSCDI1",71,0)
 .I $D(^LR(LRDFN,"MI",LRIDT,"ORUT")) D
"RTN","MMRSCDI1",72,0)
 ..S LIENS=1_","_LRIDT_","_LRDFN_","
"RTN","MMRSCDI1",73,0)
 ..S ORN=$$GET1^DIQ(63.5,LIENS,3,"E")
"RTN","MMRSCDI1",74,0)
 ..I $G(ORN)>0 D  Q:CDIVT
"RTN","MMRSCDI1",75,0)
 ...I $D(^OR(100,ORN,4)),$P(^OR(100,ORN,4),";")="" S CDIVT=0 Q
"RTN","MMRSCDI1",76,0)
 ...S LOC=+$$GET1^DIQ(100,ORN,6,"I")
"RTN","MMRSCDI1",77,0)
 ...S CDIVT=$$GET1^DIQ(100,ORN,21,"I")
"RTN","MMRSCDI1",78,0)
 .Q:$G(CDIVT)<DFLTDT
"RTN","MMRSCDI1",79,0)
 .Q:$G(CDIVT)>ENDDT
"RTN","MMRSCDI1",80,0)
 .S LRSITE=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,5)
"RTN","MMRSCDI1",81,0)
 .S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSCDI1",82,0)
 .S TSTRSLT=$$MIRSLT(LRDFN,LRIDT,LRMDRO)
"RTN","MMRSCDI1",83,0)
 .I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSCDI1",84,0)
 ..S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";MI")
"RTN","MMRSCDI1",85,0)
 ..S LRRSLT=LRRSLT_"^"_LOC
"RTN","MMRSCDI1",86,0)
 ..S MRSA(CDIVT)=LRRSLT,LRRSLT="^"
"RTN","MMRSCDI1",87,0)
 Q
"RTN","MMRSCDI1",88,0)
 ;
"RTN","MMRSCDI1",89,0)
CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSCDI1",90,0)
 N RESULT,LRLOC,LRND,LRPC,LRRES,LRIND,LRINDVAL,LRSPEC,LRLOW,LRHIG
"RTN","MMRSCDI1",91,0)
 S RESULT=""
"RTN","MMRSCDI1",92,0)
 S LRLOC=$P($G(^LAB(60,+LRTST,0)),U,5)
"RTN","MMRSCDI1",93,0)
 S LRND=$P(LRLOC,";",2) Q:+LRND'>0 RESULT
"RTN","MMRSCDI1",94,0)
 S LRPC=$P(LRLOC,";",3) Q:+LRPC'>0 RESULT
"RTN","MMRSCDI1",95,0)
 S LRRES=$P($G(^LR(LRDFN,"CH",LRIDT,LRND)),U,LRPC) Q:LRRES="" RESULT
"RTN","MMRSCDI1",96,0)
 S LRIND=$P($G(^TMP($J,"MMRSCD","T",LRMDRO,LRTST,0)),U,1)
"RTN","MMRSCDI1",97,0)
 S LRINDVAL=$P($G(^TMP($J,"MMRSCD","T",LRMDRO,LRTST,0)),U,2)
"RTN","MMRSCDI1",98,0)
 Q:LRIND="" RESULT
"RTN","MMRSCDI1",99,0)
 I LRIND=1 D  Q RESULT
"RTN","MMRSCDI1",100,0)
 .Q:'LRRES
"RTN","MMRSCDI1",101,0)
 .S LRSPEC=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,5) Q:LRSPEC=""
"RTN","MMRSCDI1",102,0)
 .Q:'$D(^LAB(60,LRTST,1,LRSPEC,0))
"RTN","MMRSCDI1",103,0)
 .S LRLOW=$P(^LAB(60,LRTST,1,LRSPEC,0),U,2),LRHIG=$P(^LAB(60,LRTST,1,LRSPEC,0),U,3)
"RTN","MMRSCDI1",104,0)
 .Q:'LRLOW!('LRHIG)
"RTN","MMRSCDI1",105,0)
 .I LRRES<LRLOW!(LRRES>LRHIG) S RESULT="POS" Q
"RTN","MMRSCDI1",106,0)
 I LRINDVAL="" Q RESULT
"RTN","MMRSCDI1",107,0)
 S LRRES=$$UP^XLFSTR(LRRES),LRINDVAL=$$UP^XLFSTR(LRINDVAL)
"RTN","MMRSCDI1",108,0)
 I LRIND=2,(LRRES[LRINDVAL) Q "POS"
"RTN","MMRSCDI1",109,0)
 I LRIND=3,(LRRES>LRINDVAL) Q "POS"
"RTN","MMRSCDI1",110,0)
 I LRIND=4,(LRRES<LRINDVAL) Q "POS"
"RTN","MMRSCDI1",111,0)
 I LRIND=5,(LRRES=LRINDVAL) Q "POS"
"RTN","MMRSCDI1",112,0)
 Q RESULT
"RTN","MMRSCDI1",113,0)
 ;
"RTN","MMRSCDI1",114,0)
MIRSLT(LRDFN,LRIDT,LRMDRO) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSCDI1",115,0)
 N RESULT,LRETND,LRETI,LRANTI,LRANTIND,LRANTINV,LRAND,LRRES,BACTRPT,RPTRMRK
"RTN","MMRSCDI1",116,0)
 S RESULT=""
"RTN","MMRSCDI1",117,0)
 ;Check Etiology
"RTN","MMRSCDI1",118,0)
 I $D(^TMP($J,"MMRSCD","ETIOL",LRMDRO)) D  Q:RESULT="POS" RESULT
"RTN","MMRSCDI1",119,0)
 .S LRETND=0 F  S LRETND=$O(^LR(LRDFN,"MI",LRIDT,3,LRETND)) Q:'LRETND!(RESULT="POS")  D
"RTN","MMRSCDI1",120,0)
 ..S LRETI=$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,0)),U)
"RTN","MMRSCDI1",121,0)
 ..Q:+LRETI'>0
"RTN","MMRSCDI1",122,0)
 ..I ('$O(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI,0))) D  Q
"RTN","MMRSCDI1",123,0)
 ...I $D(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI)) S RESULT="POS"
"RTN","MMRSCDI1",124,0)
 ..S LRANTI=0 F  S LRANTI=$O(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI,LRANTI)) Q:'LRANTI  D
"RTN","MMRSCDI1",125,0)
 ...S LRANTIND=$P(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI,LRANTI),U,1)
"RTN","MMRSCDI1",126,0)
 ...S LRANTINV=$P(^TMP($J,"MMRSCD","ETIOL",LRMDRO,LRETI,LRANTI),U,2)
"RTN","MMRSCDI1",127,0)
 ...;S LRAND=$P($G(^LAB(62.06,LRANTI,0)),U,2) Q:LRAND=""
"RTN","MMRSCDI1",128,0)
 ...Q:$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2)=""
"RTN","MMRSCDI1",129,0)
 ...Q:$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2),1,1))="S"
"RTN","MMRSCDI1",130,0)
 ...I LRANTIND=""!(LRANTINV="") Q
"RTN","MMRSCDI1",131,0)
 ...S LRRES=$$UP^XLFSTR($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2))
"RTN","MMRSCDI1",132,0)
 ...S LRANTINV=$$UP^XLFSTR(LRANTINV)
"RTN","MMRSCDI1",133,0)
 ...S LRANTIND=$$UP^XLFSTR(LRANTIND)
"RTN","MMRSCDI1",134,0)
 ...I LRANTIND=1,(LRRES[LRANTINV) S RESULT="POS" Q
"RTN","MMRSCDI1",135,0)
 ...I LRANTIND=2,(LRRES>LRANTINV) S RESULT="POS" Q
"RTN","MMRSCDI1",136,0)
 ...I LRANTIND=3,(LRRES<LRANTINV) S RESULT="POS" Q
"RTN","MMRSCDI1",137,0)
 ...I LRANTIND=4,(LRRES=LRANTINV) S RESULT="POS" Q
"RTN","MMRSCDI1",138,0)
 Q:RESULT="POS" "POS"
"RTN","MMRSCDI1",139,0)
 ;Check Bacteriology Report Remarks
"RTN","MMRSCDI1",140,0)
 I '$D(^TMP($J,"MMRSCD","BACT",LRMDRO,"INC_REMARK")) Q RESULT
"RTN","MMRSCDI1",141,0)
 S BACTRPT=0 F  S BACTRPT=$O(^LR(LRDFN,"MI",LRIDT,4,BACTRPT)) Q:'BACTRPT!(RESULT="POS")  D
"RTN","MMRSCDI1",142,0)
 .S RPTRMRK=$P($G(^LR(LRDFN,"MI",LRIDT,4,BACTRPT,0)),U,1)
"RTN","MMRSCDI1",143,0)
 .Q:RPTRMRK=""
"RTN","MMRSCDI1",144,0)
 .I $$BACTRPT(LRMDRO,"INC_REMARK",RPTRMRK)&('$$BACTRPT(LRMDRO,"EXC_REMARK",RPTRMRK)) S RESULT="POS"
"RTN","MMRSCDI1",145,0)
 Q RESULT
"RTN","MMRSCDI1",146,0)
 ;
"RTN","MMRSCDI1",147,0)
SCRNTOP(LRSITE,LRMDRO) ;CHECK TO SEE IF SCREEN ON SITE
"RTN","MMRSCDI1",148,0)
 Q:+LRSITE'>0 0
"RTN","MMRSCDI1",149,0)
 I $D(^TMP($J,"MMRSCD","TOP",LRMDRO,"INC_TOP"))&$D(^TMP($J,"MMRSCD","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSCDI1",150,0)
 I '$D(^TMP($J,"MMRSCD","TOP",LRMDRO,"INC_TOP"))&'$D(^TMP($J,"MMRSCD","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSCDI1",151,0)
 I ($D(^TMP($J,"MMRSCD","TOP",LRMDRO,"INC_TOP")))&($D(^TMP($J,"MMRSCD","TOP",LRMDRO,"INC_TOP",LRSITE))) Q 0
"RTN","MMRSCDI1",152,0)
 I ($D(^TMP($J,"MMRSCD","TOP",LRMDRO,"EXC_TOP")))&('$D(^TMP($J,"MMRSCD","TOP",LRMDRO,"EXC_TOP",LRSITE))) Q 0
"RTN","MMRSCDI1",153,0)
 Q 1
"RTN","MMRSCDI1",154,0)
 ;
"RTN","MMRSCDI1",155,0)
BACTRPT(LRMDRO,RPTTYPE,RPTRMRK) ;Is this comment contained in the parameters
"RTN","MMRSCDI1",156,0)
 N RESULT,MMRSI,LRINDVAL
"RTN","MMRSCDI1",157,0)
 S RESULT=0
"RTN","MMRSCDI1",158,0)
 S MMRSI=0 F  S MMRSI=$O(^TMP($J,"MMRSCD","BACT",LRMDRO,RPTTYPE,MMRSI)) Q:'MMRSI!(RESULT=1)  D
"RTN","MMRSCDI1",159,0)
 .S LRINDVAL=$G(^TMP($J,"MMRSCD","BACT",LRMDRO,RPTTYPE,MMRSI))
"RTN","MMRSCDI1",160,0)
 .I ($$UP^XLFSTR(RPTRMRK))[($$UP^XLFSTR(LRINDVAL)) S RESULT=1
"RTN","MMRSCDI1",161,0)
 Q RESULT
"RTN","MMRSCDI1",162,0)
 ;
"RTN","MMRSCDI2")
0^17^B162714137^n/a
"RTN","MMRSCDI2",1,0)
MMRSCDI2 ;LEIDOS/TCK - Print CDI report ; 12/7/16 7:14am
"RTN","MMRSCDI2",2,0)
 ;;1.0;MRSA TOOLS REPORTS MENU;**4**;Mar 22, 2009;Build 130
"RTN","MMRSCDI2",3,0)
 ;
"RTN","MMRSCDI2",4,0)
MAIN ;
"RTN","MMRSCDI2",5,0)
 N EXTFLG,MMRSLOC
"RTN","MMRSCDI2",6,0)
 S NOCONF=0
"RTN","MMRSCDI2",7,0)
 ;check if parameters are setup.
"RTN","MMRSCDI2",8,0)
 I '$D(ZTQUEUED) D  Q
"RTN","MMRSCDI2",9,0)
 .W !!,"This option can only be run via TaskMan"
"RTN","MMRSCDI2",10,0)
 .W !
"RTN","MMRSCDI2",11,0)
 D CLEAN
"RTN","MMRSCDI2",12,0)
 D CHECK^MMRSIPC
"RTN","MMRSCDI2",13,0)
 D CHECK
"RTN","MMRSCDI2",14,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSCDI2",15,0)
 S NOW=$$NOW^XLFDT(),MMRSNOW=NOW
"RTN","MMRSCDI2",16,0)
 S FIRST=$E(NOW,1,5)_"01"
"RTN","MMRSCDI2",17,0)
 S ENDDT=$$FMADD^XLFDT(FIRST,-1,0,0,0)_".24"
"RTN","MMRSCDI2",18,0)
 S STRTDT=$E(ENDDT,1,5)_"01",DFLTDT=STRTDT
"RTN","MMRSCDI2",19,0)
 S DFLTDT=STRTDT
"RTN","MMRSCDI2",20,0)
 K EXTFLG
"RTN","MMRSCDI2",21,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSCDI2",22,0)
 D MAIN2
"RTN","MMRSCDI2",23,0)
 D QUIT
"RTN","MMRSCDI2",24,0)
 Q
"RTN","MMRSCDI2",25,0)
 ;
"RTN","MMRSCDI2",26,0)
CHECK ; Check if lab tests and etiologies are setup
"RTN","MMRSCDI2",27,0)
 N II,XX,TST,MRSASTAP,ORG,ETIONAME,MMRSET,MMRSI
"RTN","MMRSCDI2",28,0)
 S (MDROETIO,TSTSTP)=0
"RTN","MMRSCDI2",29,0)
 I $D(^MMRS(104.1)) D
"RTN","MMRSCDI2",30,0)
 .S II=0 F  S II=$O(^MMRS(104.1,II)) Q:II'>0  D  Q:MDROETIO!(TSTSTP)
"RTN","MMRSCDI2",31,0)
 ..Q:'$D(^MMRS(104.1,II,0))
"RTN","MMRSCDI2",32,0)
 ..S ORGP=$P(^MMRS(104.1,II,0),"^")
"RTN","MMRSCDI2",33,0)
 ..Q:$G(ORGP)'>0
"RTN","MMRSCDI2",34,0)
 ..S ETIO=$$GET1^DIQ(104.2,ORGP,.01,"E")
"RTN","MMRSCDI2",35,0)
 ..S ETIO=$$UPPER^DGUTL(ETIO)
"RTN","MMRSCDI2",36,0)
 ..Q:ETIO'["DIFF"
"RTN","MMRSCDI2",37,0)
 ..S IX=0
"RTN","MMRSCDI2",38,0)
 ..F  S IX=$O(^MMRS(104.1,II,3,IX)) Q:IX'>0  D  Q:TSTSTP
"RTN","MMRSCDI2",39,0)
 ...I $G(IX)>0 D
"RTN","MMRSCDI2",40,0)
 ....Q:'$D(^MMRS(104.1,II,3,IX,0))
"RTN","MMRSCDI2",41,0)
 ....S III=IX_","_II_","
"RTN","MMRSCDI2",42,0)
 ....Q:III=""
"RTN","MMRSCDI2",43,0)
 ....S TST=$$GET1^DIQ(104.15,III,.01,"E")
"RTN","MMRSCDI2",44,0)
 ....I $G(TST)'=""&(TST["DIFF") S TSTSTP=1
"RTN","MMRSCDI2",45,0)
 ....Q:$G(TST)'["DIFF"
"RTN","MMRSCDI2",46,0)
 ....S TSTSTP=1
"RTN","MMRSCDI2",47,0)
 ..I $D(^MMRS(104.1,II,6)) D
"RTN","MMRSCDI2",48,0)
 ...S IXI=0 F  S IXI=$O(^MMRS(104.1,II,6,IXI)) Q:IXI'>0  D  Q:MDROETIO
"RTN","MMRSCDI2",49,0)
 ....Q:IXI=""
"RTN","MMRSCDI2",50,0)
 ....Q:'IXI
"RTN","MMRSCDI2",51,0)
 ....S III=IXI_","_II_","
"RTN","MMRSCDI2",52,0)
 ....S XX=$$GET1^DIQ(104.109,III,.01,"E")
"RTN","MMRSCDI2",53,0)
 ....Q:XX'["CLOSTRIDIUM"
"RTN","MMRSCDI2",54,0)
 ....S ETIONAME=XX,ORG=II,MDROETIO=ORG
"RTN","MMRSCDI2",55,0)
 ;
"RTN","MMRSCDI2",56,0)
ERROR ;
"RTN","MMRSCDI2",57,0)
 I 'TSTSTP&'MDROETIO D
"RTN","MMRSCDI2",58,0)
 .S EXTFLG=1
"RTN","MMRSCDI2",59,0)
 .W !!,"   >>>The report cannot be run because either the Laboratory Test(s) "
"RTN","MMRSCDI2",60,0)
 .W !,"       or the 'CLOSTRIDIUM DIFFICLE' Etiology are not setup "
"RTN","MMRSCDI2",61,0)
 .W !,"       in the LAB SEARCH/EXTRACT parameters file, (104.1)."
"RTN","MMRSCDI2",62,0)
 Q
"RTN","MMRSCDI2",63,0)
 ;
"RTN","MMRSCDI2",64,0)
MAIN2 ; Entry for queuing
"RTN","MMRSCDI2",65,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSCDI2",66,0)
 I '$D(MMRSDIV) D PRT  Q
"RTN","MMRSCDI2",67,0)
 D GETPARAM ; Load parameters in temp global
"RTN","MMRSCDI2",68,0)
 D PRT
"RTN","MMRSCDI2",69,0)
 Q
"RTN","MMRSCDI2",70,0)
 ;
"RTN","MMRSCDI2",71,0)
GTDIV(MMRSDIV) ;
"RTN","MMRSCDI2",72,0)
 N I,TST,ETI,DPTR,STAID,DIV,DPTR
"RTN","MMRSCDI2",73,0)
 S I=0
"RTN","MMRSCDI2",74,0)
 F  S I=$O(^MMRS(104.1,I)) Q:$G(I)'>0  D  Q:$G(I)'>0
"RTN","MMRSCDI2",75,0)
 .I $P(^MMRS(104.1,I,3,0),"^",3)>0 D
"RTN","MMRSCDI2",76,0)
 ..S LIEN=1_","_I_","
"RTN","MMRSCDI2",77,0)
 ..S TST=$$GET1^DIQ(104.15,LIEN,.01,"I")
"RTN","MMRSCDI2",78,0)
 .I $P(^MMRS(104.1,I,6,0),"^",3)>0 D
"RTN","MMRSCDI2",79,0)
 ..S LIEN=1_","_I_","
"RTN","MMRSCDI2",80,0)
 ..S ETI=$$GET1^DIQ(104.109,LIEN,.01,"I")
"RTN","MMRSCDI2",81,0)
 .I $G(TST)'>0&($G(ETI)'>0) K LIEN Q
"RTN","MMRSCDI2",82,0)
 .S DPTR=$$GET1^DIQ(104.1,I,1,"I") Q:DPTR=""
"RTN","MMRSCDI2",83,0)
 .S DIV=$$GET1^DIQ(104,DPTR,.01,"I") Q:DIV=""
"RTN","MMRSCDI2",84,0)
 .S STAID=$$GET1^DIQ(40.8,DIV,.01,"E") Q:STAID=""
"RTN","MMRSCDI2",85,0)
 .S MMRSDIV(STAID)=DIV
"RTN","MMRSCDI2",86,0)
 .S (STAID,DIV,DPTR)=""
"RTN","MMRSCDI2",87,0)
 Q
"RTN","MMRSCDI2",88,0)
 ;
"RTN","MMRSCDI2",89,0)
CLEAN ;
"RTN","MMRSCDI2",90,0)
 K ^TMP($J,"MMRSCDI")
"RTN","MMRSCDI2",91,0)
 K ^TMP($J,"MMRS")
"RTN","MMRSCDI2",92,0)
 K ^TMP($J,"MMRSCD")
"RTN","MMRSCDI2",93,0)
 Q
"RTN","MMRSCDI2",94,0)
 ;
"RTN","MMRSCDI2",95,0)
GETPARAM ; Loads lab search/extract parameters from file 104.1
"RTN","MMRSCDI2",96,0)
 N TSTNM,TST,TEST,IEN,TIEN,ITOP,TOP,ETOP,IBACT,BACT,EBACT
"RTN","MMRSCDI2",97,0)
 N ETIOL,ETIOLOGY,ANTI,ANTIM,INC,MRSASTAP,ETIONAME,MMRSI,MMRSET,ORG
"RTN","MMRSCDI2",98,0)
 N MDRO
"RTN","MMRSCDI2",99,0)
 Q:'$D(MMRSDIV)
"RTN","MMRSCDI2",100,0)
 S DIVN="",CHK=1,NOCONF=0
"RTN","MMRSCDI2",101,0)
 S MMRSMDRO=$O(^MMRS(104.2,"B","C. diff",0))
"RTN","MMRSCDI2",102,0)
 I $G(MMRSDIV)="ALL" D GETDIV(.MMRSDIV)
"RTN","MMRSCDI2",103,0)
 F  S DIVN=$O(MMRSDIV(DIVN)) Q:DIVN'?.N  D  Q:NOCONF
"RTN","MMRSCDI2",104,0)
 .Q:DIVN=""
"RTN","MMRSCDI2",105,0)
 .S PTR=$$GET1^DIQ(104,DIVN,.01,"I")
"RTN","MMRSCDI2",106,0)
 .S DIVSN=$$GET1^DIQ(40.8,PTR,.01,"E")
"RTN","MMRSCDI2",107,0)
 .I $G(DIVSN)="" S NOCONF=1 Q
"RTN","MMRSCDI2",108,0)
 .K MMRSDIV(DIVN)
"RTN","MMRSCDI2",109,0)
 .S MMRSDIV(DIVSN)=DIVN
"RTN","MMRSCDI2",110,0)
 S DIVSN=""
"RTN","MMRSCDI2",111,0)
 F  S DIVSN=$O(MMRSDIV(DIVSN)) Q:DIVSN=""!(NOCONF)  D  Q:NOCONF
"RTN","MMRSCDI2",112,0)
 .K ^TMP($J,"MMRSCD")
"RTN","MMRSCDI2",113,0)
 .S MDRO=MMRSMDRO
"RTN","MMRSCDI2",114,0)
 .S DIVN=MMRSDIV(DIVSN)
"RTN","MMRSCDI2",115,0)
 .I $G(DIVN)'>0 S DIVSN="" S NOCONF=1 Q
"RTN","MMRSCDI2",116,0)
 .S IEN="",IEN=$O(^MMRS(104.1,"C",DIVN,MMRSMDRO,IEN))
"RTN","MMRSCDI2",117,0)
 .Q:$G(IEN)'>0
"RTN","MMRSCDI2",118,0)
 .S ORGP=$$GET1^DIQ(104.1,IEN,.01,"I")
"RTN","MMRSCDI2",119,0)
 .D CHKPAR^MMRSCDI(ORGP,DIVN,.CHK)
"RTN","MMRSCDI2",120,0)
 .I 'CHK S NOCONF=1 Q
"RTN","MMRSCDI2",121,0)
 .S (FND,TST,INC)=0
"RTN","MMRSCDI2",122,0)
 .I TSTSTP D
"RTN","MMRSCDI2",123,0)
 ..S TIEN=0 F  S TIEN=$O(^MMRS(104.1,IEN,3,TIEN)) Q:'TIEN  D
"RTN","MMRSCDI2",124,0)
 ...S TEST=$P($G(^MMRS(104.1,IEN,3,TIEN,0)),U,1)
"RTN","MMRSCDI2",125,0)
 ...Q:'TEST
"RTN","MMRSCDI2",126,0)
 ...S INC=INC+1
"RTN","MMRSCDI2",127,0)
 ...S ^TMP($J,"MMRSCD","T",MDRO,TEST,0)=$P($G(^MMRS(104.1,IEN,3,TIEN,0)),U,2,3)
"RTN","MMRSCDI2",128,0)
 .I MDROETIO D
"RTN","MMRSCDI2",129,0)
 ..S IBACT=0 F  S IBACT=$O(^MMRS(104.1,MMRSMDRO,4,IBACT)) Q:'IBACT  D
"RTN","MMRSCDI2",130,0)
 ...S BACT=$G(^MMRS(104.1,MMRSMDRO,4,IBACT,0))
"RTN","MMRSCDI2",131,0)
 ...I BACT'="" S ^TMP($J,"MMRSCD","BACT",MDRO,"INC_REMARK",IBACT)=BACT
"RTN","MMRSCDI2",132,0)
 ..S EBACT=0 F  S EBACT=$O(^MMRS(104.1,MMRSMDRO,5,EBACT)) Q:'EBACT  D
"RTN","MMRSCDI2",133,0)
 ...S BACT=$G(^MMRS(104.1,MMRSMDRO,5,EBACT,0))
"RTN","MMRSCDI2",134,0)
 ...I BACT'="" S ^TMP($J,"MMRSCD","BACT",MDRO,"EXC_REMARK",EBACT)=BACT
"RTN","MMRSCDI2",135,0)
 ..S ETIOL=0 F  S ETIOL=$O(^MMRS(104.1,IEN,6,ETIOL)) Q:'ETIOL  D
"RTN","MMRSCDI2",136,0)
 ...S ETIOLOGY=$G(^MMRS(104.1,IEN,6,ETIOL,0))
"RTN","MMRSCDI2",137,0)
 ...I 'ETIOLOGY K ^TMP($J,"MMRSCD","ETIOL")
"RTN","MMRSCDI2",138,0)
 ...S ^TMP($J,"MMRSCD","ETIOL",MDRO,+ETIOLOGY)=""
"RTN","MMRSCDI2",139,0)
 ...S ANTI=0 F  S ANTI=$O(^MMRS(104.1,MMRSMDRO,6,ETIOL,1,ANTI)) Q:'ANTI  D
"RTN","MMRSCDI2",140,0)
 ....S ANTIM=$P($G(^MMRS(104.1,MMRSMDRO,6,ETIOL,1,ANTI,0)),U)
"RTN","MMRSCDI2",141,0)
 ....I ANTIM S ^TMP($J,"MMRSCD","ETIOL",MDRO,ETIOLOGY,ANTI)=$G(^MMRS(104.1,IEN,6,ETIOL,1,ANTI,0))
"RTN","MMRSCDI2",142,0)
 ...I $G(ETIOLOGY)'="" D
"RTN","MMRSCDI2",143,0)
 ....D FIND^DIC(61.2,,".01E;@","PM","CLOSTRIDIUM DIFFICILE",,"B",,,"MMRSET")
"RTN","MMRSCDI2",144,0)
 ..S MMRSI="" F  S MMRSI=$O(MMRSET("DILIST",MMRSI)) Q:MMRSI=""  I +MMRSI>0  D
"RTN","MMRSCDI2",145,0)
 ...S ETIONAME=$P($G(MMRSET("DILIST",MMRSI,0)),U,2)
"RTN","MMRSCDI2",146,0)
 ...S ORG=$P($G(MMRSET("DILIST",MMRSI,0)),U,1)
"RTN","MMRSCDI2",147,0)
 ...I ETIONAME'["CLOSTRIDIUM DIFFICILE" Q
"RTN","MMRSCDI2",148,0)
 ...K ^TMP($J,"MMRSCD","ETIOL",MMRSMDRO,ORG)
"RTN","MMRSCDI2",149,0)
 ...S ^TMP($J,"MMRSCD","ETIOL",MMRSMDRO,ORG)=""
"RTN","MMRSCDI2",150,0)
 .D SETDATA
"RTN","MMRSCDI2",151,0)
 Q
"RTN","MMRSCDI2",152,0)
 ;
"RTN","MMRSCDI2",153,0)
GETDIV(MMRSDIV) ;
"RTN","MMRSCDI2",154,0)
 N I,TST,ETI,DPTR,STAID,DIV,DPTR
"RTN","MMRSCDI2",155,0)
 S I=0
"RTN","MMRSCDI2",156,0)
 F  S I=$O(^MMRS(104,I)) Q:$G(I)'>0  D  Q:$G(I)'>0
"RTN","MMRSCDI2",157,0)
 .S MMRSDIV(I)=""
"RTN","MMRSCDI2",158,0)
 Q
"RTN","MMRSCDI2",159,0)
 ;
"RTN","MMRSCDI2",160,0)
SETDATA ;
"RTN","MMRSCDI2",161,0)
 N LOCATION,LOCNAME,DFN,LOCTYPE,MMRSI,SDRESULT,Y,WLOC,WARD,WARDNAME,VAIP,WRDNME
"RTN","MMRSCDI2",162,0)
 S DFN=0 F  S DFN=$O(^DPT(DFN)) Q:'DFN  D
"RTN","MMRSCDI2",163,0)
 .Q:'$D(^PXRMINDX(63,"PI",DFN))
"RTN","MMRSCDI2",164,0)
 .Q:$G(DFN)'>0
"RTN","MMRSCDI2",165,0)
 .D SETDATA2(DFN)
"RTN","MMRSCDI2",166,0)
 Q
"RTN","MMRSCDI2",167,0)
 ;
"RTN","MMRSCDI2",168,0)
SETDATA2(DFN) ;
"RTN","MMRSCDI2",169,0)
 N INTT,IEN,INDATE,INIFN,MRSA,MRSACULT,LABORDER,TSTNM,LABTEST,ORDITM,ORDTEMP,PATNM,VADM,DCDATE
"RTN","MMRSCDI2",170,0)
 S LOC=""
"RTN","MMRSCDI2",171,0)
 S (CDIVT,PCD)=""
"RTN","MMRSCDI2",172,0)
 ;Get MRSA history
"RTN","MMRSCDI2",173,0)
 D GETLAB^MMRSCDI1(DFN,.MRSA,MMRSMDRO,MMRSNOW,"CD")
"RTN","MMRSCDI2",174,0)
 Q:'$D(MRSA)
"RTN","MMRSCDI2",175,0)
 S I="" F  S I=$O(MRSA(I)) Q:I=""  D
"RTN","MMRSCDI2",176,0)
 .Q:I=""
"RTN","MMRSCDI2",177,0)
 .S CDIVT=I
"RTN","MMRSCDI2",178,0)
 .S MRSA=$P(MRSA(I),"^",1,2)
"RTN","MMRSCDI2",179,0)
 .S LOC=+$P(MRSA(I),"^",3)
"RTN","MMRSCDI2",180,0)
 .S DVSN=$$GET1^DIQ(44,+LOC,3.5,"E")
"RTN","MMRSCDI2",181,0)
 .Q:DVSN'=DIVSN
"RTN","MMRSCDI2",182,0)
 .S WARDNAME=$$GET1^DIQ(44,+LOC,.01,"E")
"RTN","MMRSCDI2",183,0)
 .;Get Order info
"RTN","MMRSCDI2",184,0)
 .S LABORDER="^^"
"RTN","MMRSCDI2",185,0)
 .Q:'CDIVT
"RTN","MMRSCDI2",186,0)
 .S MRSA=$P(MRSA(I),"^",2)
"RTN","MMRSCDI2",187,0)
 .S LRFILE=44
"RTN","MMRSCDI2",188,0)
 .S STPCD=$$GET1^DIQ(LRFILE,+LOC,8,"I")
"RTN","MMRSCDI2",189,0)
 .S TYPE=$$GET1^DIQ(LRFILE,+LOC,2,"E")
"RTN","MMRSCDI2",190,0)
 .S SERV=$$GET1^DIQ(LRFILE,+LOC,9,"E")
"RTN","MMRSCDI2",191,0)
 .D GTDATE(DFN,CDIVT,.INDATE,.DCDATE)
"RTN","MMRSCDI2",192,0)
 .I $G(TYPE)'="",TYPE'="WARD" S INDATE=""
"RTN","MMRSCDI2",193,0)
 .I $D(^TMP($J,"MMRSCD","T")) D
"RTN","MMRSCDI2",194,0)
 ..S MDRO="" F  S MDRO=$O(^TMP($J,"MMRSCD","T",MDRO)) Q:MDRO=""  D
"RTN","MMRSCDI2",195,0)
 ...Q:$G(MDRO)'>0
"RTN","MMRSCDI2",196,0)
 ...S TST="" F  S TST=$O(^TMP($J,"MMRSCD","T",MDRO,TST)) Q:TST=""  D
"RTN","MMRSCDI2",197,0)
 ....N TESTS D GORDITM(TST,.LABORDER,.TESTS) ;MIA/LMT - Added with patch MMRS*1*1
"RTN","MMRSCDI2",198,0)
 .S PCD="",PATNM=$$GET1^DIQ(2,DFN,.01,"E")
"RTN","MMRSCDI2",199,0)
 .Q:$D(^TMP($J,"MMRSCDI",WARDNAME,PATNM,DFN,CDIVT))
"RTN","MMRSCDI2",200,0)
 .I $D(^TMP($J,"MMRSCDI",WARDNAME,PATNM,DFN)) D
"RTN","MMRSCDI2",201,0)
 ..S PCD=999999999999999
"RTN","MMRSCDI2",202,0)
 ..S PCD=$O(^TMP($J,"MMRSCDI",WARDNAME,PATNM,DFN,PCD),-1)
"RTN","MMRSCDI2",203,0)
 .S CD=CDIVT,CD=$O(MRSA(CD),-1)
"RTN","MMRSCDI2",204,0)
 .I $G(CD)>0,CD<CDIVT S PCD=CD
"RTN","MMRSCDI2",205,0)
 .Q:CDIVT<STRTDT
"RTN","MMRSCDI2",206,0)
 .S ^TMP($J,"MMRSCDI",DIVSN,WARDNAME,PATNM,DFN,CDIVT)=$G(TYPE)_U_$G(SERV)_U_$G(STPCD)_U_$G(CDIVT)_U_$G(INDATE)_U_$G(DCDATE)_U_$G(MRSA)_U_$G(PCD),PCD=""
"RTN","MMRSCDI2",207,0)
 K MRSA
"RTN","MMRSCDI2",208,0)
 Q
"RTN","MMRSCDI2",209,0)
 ;
"RTN","MMRSCDI2",210,0)
GTDATE(DFN,CDIVT,IND,DCDT) ;
"RTN","MMRSCDI2",211,0)
 N DATE,IEN
"RTN","MMRSCDI2",212,0)
 S (IND,DCDT)="",FND=0
"RTN","MMRSCDI2",213,0)
 Q:$G(CDIVT)=""
"RTN","MMRSCDI2",214,0)
 Q:'$D(^DGPM("APTT1",DFN))
"RTN","MMRSCDI2",215,0)
 S DATE=9999999999,TT=1
"RTN","MMRSCDI2",216,0)
 F  S DATE=$O(^DGPM("APTT"_TT,DFN,DATE),-1) Q:DATE=""  D  Q:FND
"RTN","MMRSCDI2",217,0)
 .Q:DATE=""
"RTN","MMRSCDI2",218,0)
 .I CDIVT<DATE Q
"RTN","MMRSCDI2",219,0)
 .S IEN="",IEN=$O(^DGPM("APTT"_TT,DFN,DATE,IEN))
"RTN","MMRSCDI2",220,0)
 .Q:$G(IEN)'>0
"RTN","MMRSCDI2",221,0)
 .I $G(IEN)>0 D
"RTN","MMRSCDI2",222,0)
 ..S IND=$$GET1^DIQ(405,IEN,.01,"I")
"RTN","MMRSCDI2",223,0)
 ..S WRD=$$GET1^DIQ(405,IEN,.06,"E")
"RTN","MMRSCDI2",224,0)
 ..S LOCNME="",LOCNME=$$GET1^DIQ(44,LOC,.01,"E")
"RTN","MMRSCDI2",225,0)
 .Q:WRD'=LOCNME
"RTN","MMRSCDI2",226,0)
 .I WRD=LOCNME S FND=1
"RTN","MMRSCDI2",227,0)
 .S NXDT=$O(^DGPM("APTT"_TT,DFN,DATE),-1)
"RTN","MMRSCDI2",228,0)
 .I $G(NXDT)'>0 K NXDT S FND=1
"RTN","MMRSCDI2",229,0)
 .I $G(NXDT)>0 S DATE=NXDT,NXDT=""
"RTN","MMRSCDI2",230,0)
 .Q:$G(DATE)'>0
"RTN","MMRSCDI2",231,0)
 .S IEN="",IEN=$O(^DGPM("APTT"_TT,DFN,DATE,IEN))
"RTN","MMRSCDI2",232,0)
 .S TIEN=$$GET1^DIQ(405,IEN,.17,"I")
"RTN","MMRSCDI2",233,0)
 .I $G(TIEN)'>0 Q
"RTN","MMRSCDI2",234,0)
 .S DCDT=$$GET1^DIQ(405,TIEN,.01,"I")
"RTN","MMRSCDI2",235,0)
 .I DCDT>CDIVT S FND=1,DCDT="" Q
"RTN","MMRSCDI2",236,0)
 .I DCDT'="" S FND=1 Q
"RTN","MMRSCDI2",237,0)
 Q
"RTN","MMRSCDI2",238,0)
 ;
"RTN","MMRSCDI2",239,0)
GORDITM(LABTEST,LABORDER,TESTS) ;MIA/LMT - Added with patch MMRS*1*1 - Include panels in search
"RTN","MMRSCDI2",240,0)
 N ORDITM,ORDTEMP,LABPANEL
"RTN","MMRSCDI2",241,0)
 I $D(TESTS(LABTEST)) Q  ;prevent infinite recursion; if site has Panel A within Panel B, and Panel B within Panel A
"RTN","MMRSCDI2",242,0)
 S TESTS(LABTEST)=1 ;mark that we have searched this test (to prevent infinite recursion)
"RTN","MMRSCDI2",243,0)
 S ORDITM=0 F  S ORDITM=$O(^ORD(101.43,"ID",LABTEST_";99LRT",ORDITM)) Q:'ORDITM  D
"RTN","MMRSCDI2",244,0)
 .S ORDTEMP=$$GETORD(DFN,ORDITM,INDATE)
"RTN","MMRSCDI2",245,0)
 .I $P(LABORDER,U,1)'="YES"!(($P(LABORDER,U,3)'="YES")&($P(ORDTEMP,U,3)="YES")) S LABORDER=ORDTEMP
"RTN","MMRSCDI2",246,0)
 S LABPANEL=0 F  S LABPANEL=$O(^LAB(60,"AB",LABTEST,LABPANEL)) Q:'LABPANEL  D
"RTN","MMRSCDI2",247,0)
 .D GORDITM(LABPANEL,.LABORDER,.TESTS) ;Recursive call to check for tests within panels
"RTN","MMRSCDI2",248,0)
 Q
"RTN","MMRSCDI2",249,0)
GETORD(DFN,ORDITM,INDATE) ;
"RTN","MMRSCDI2",250,0)
 N RESULT,START,STOP,DAS,STATUS,ORUPCHUK,LABREC
"RTN","MMRSCDI2",251,0)
 S RESULT="^^"
"RTN","MMRSCDI2",252,0)
 S START=$$FMADD^XLFDT(INDATE,-1)-.0000001
"RTN","MMRSCDI2",253,0)
 F  S START=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START)) Q:'START  D
"RTN","MMRSCDI2",254,0)
 .S STOP="" F  S STOP=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START,STOP)) Q:STOP=""  D
"RTN","MMRSCDI2",255,0)
 ..S DAS="" F  S DAS=$O(^PXRMINDX(100,"PI",DFN,ORDITM,START,STOP,DAS)) Q:DAS=""  D
"RTN","MMRSCDI2",256,0)
 ...D EN^ORX8(+DAS)
"RTN","MMRSCDI2",257,0)
 ...S STATUS=$P(ORUPCHUK("ORSTS"),U,1)
"RTN","MMRSCDI2",258,0)
 ...I STATUS'=2,STATUS'=5,STATUS'=6 Q
"RTN","MMRSCDI2",259,0)
 ...S LABREC="NO"
"RTN","MMRSCDI2",260,0)
 ...I STATUS=6!(STATUS=2) S LABREC="YES"
"RTN","MMRSCDI2",261,0)
 ...I $P(RESULT,U,3)'="YES" S RESULT="YES^"_START_U_LABREC
"RTN","MMRSCDI2",262,0)
 Q RESULT
"RTN","MMRSCDI2",263,0)
PRT ;
"RTN","MMRSCDI2",264,0)
 I '$D(MMRSDIV) D  Q
"RTN","MMRSCDI2",265,0)
 .W !!,"    >>>Divisions are not setup in Taskman. You must configure the"
"RTN","MMRSCDI2",266,0)
 .W !,"        the Divsions for this report in TaskMan in order for the "
"RTN","MMRSCDI2",267,0)
 .W !,"        report to run."
"RTN","MMRSCDI2",268,0)
 .W !!
"RTN","MMRSCDI2",269,0)
 I NOCONF D  Q
"RTN","MMRSCDI2",270,0)
 .W !!,"   >>>The report cannot be run because either the Laboratory Tests "
"RTN","MMRSCDI2",271,0)
 .W !,"       or the 'CLOSTRIDIUM DIFFICLE' Etiology are not setup "
"RTN","MMRSCDI2",272,0)
 .W !,"       in the LAB SEARCH/EXTRACT parameters file, (104.1)."
"RTN","MMRSCDI2",273,0)
 .W !!
"RTN","MMRSCDI2",274,0)
 N LN,PG,LOCNAME,PATNM,DFN,NODE,LAST4,INTT,ADT,ORDDATE,VADM,QUIT,COUNT,DOB,PRVCDI
"RTN","MMRSCDI2",275,0)
 K ^TMP($J,"MMRSCDI","T")
"RTN","MMRSCDI2",276,0)
 K ^TMP($J,"MMRSCDI","ETIOL")
"RTN","MMRSCDI2",277,0)
 S $P(LN,"-",160)=""
"RTN","MMRSCDI2",278,0)
 S PG=1,QUIT=0,DVS=""
"RTN","MMRSCDI2",279,0)
 F  S DVS=$O(MMRSDIV(DVS)) Q:DVS=""  D
"RTN","MMRSCDI2",280,0)
 .S DIVSN=DVS
"RTN","MMRSCDI2",281,0)
 .I '$D(^TMP($J,"MMRSCDI",DIVSN)) D  Q
"RTN","MMRSCDI2",282,0)
 ..S WARDNAME=""
"RTN","MMRSCDI2",283,0)
 ..D PRTHDRS
"RTN","MMRSCDI2",284,0)
 ..W !!,"NO RECORDS FOUND FOR REPORTING PERIOD."
"RTN","MMRSCDI2",285,0)
 .S WARDNAME="" F  S WARDNAME=$O(^TMP($J,"MMRSCDI",DIVSN,WARDNAME)) Q:WARDNAME=""  D  Q:QUIT
"RTN","MMRSCDI2",286,0)
 ..I WARDNAME="" S QUIT=1 Q
"RTN","MMRSCDI2",287,0)
 ..Q:'$D(^TMP($J,"MMRSCDI",DIVSN,WARDNAME))
"RTN","MMRSCDI2",288,0)
 ..D PRTHDRS
"RTN","MMRSCDI2",289,0)
 ..S PATNM="" F  S PATNM=$O(^TMP($J,"MMRSCDI",DIVSN,WARDNAME,PATNM)) Q:PATNM=""  D
"RTN","MMRSCDI2",290,0)
 ...I PATNM?.N K ^TMP($J,"MMRSCDI",DIVSN,WARDNAME,PATNM) Q
"RTN","MMRSCDI2",291,0)
 ...S DFN=0 F  S DFN=$O(^TMP($J,"MMRSCDI",DIVSN,WARDNAME,PATNM,DFN)) Q:'DFN  D  Q:'DFN
"RTN","MMRSCDI2",292,0)
 ....S CD=0 F  S CD=$O(^TMP($J,"MMRSCDI",DIVSN,WARDNAME,PATNM,DFN,CD)) Q:'CD  D
"RTN","MMRSCDI2",293,0)
 .....S NODE=$G(^TMP($J,"MMRSCDI",DIVSN,WARDNAME,PATNM,DFN,CD))
"RTN","MMRSCDI2",294,0)
 .....S TYPE=$P(NODE,"^")
"RTN","MMRSCDI2",295,0)
 .....S SERV=$P(NODE,"^",2)
"RTN","MMRSCDI2",296,0)
 .....S STPCD=$P(NODE,"^",3)
"RTN","MMRSCDI2",297,0)
 .....S CDIVT=$P(NODE,"^",4) I $G(CDIVT)>0 D
"RTN","MMRSCDI2",298,0)
 ......S CDIVT=$$FMTE^XLFDT(CDIVT,2)
"RTN","MMRSCDI2",299,0)
 ......I CDIVT["@" S CDIVT=$TR(CDIVT,"@"," ")
"RTN","MMRSCDI2",300,0)
 .....S INDATE=$P(NODE,"^",5) I $G(INDATE)>0 D
"RTN","MMRSCDI2",301,0)
 ......S INDATE=$$FMTE^XLFDT(INDATE,2)
"RTN","MMRSCDI2",302,0)
 ......I INDATE["@" S INDATE=$TR(INDATE,"@"," ")
"RTN","MMRSCDI2",303,0)
 .....S DCDT=$P(NODE,U,6) I $G(DCDT)>0 D
"RTN","MMRSCDI2",304,0)
 ......S DCDT=$$FMTE^XLFDT(DCDT,2)
"RTN","MMRSCDI2",305,0)
 ......I DCDT["@" S DCDT=$TR(DCDT,"@"," ")
"RTN","MMRSCDI2",306,0)
 .....S PRVCDI=$P(NODE,U,8) I $G(PRVCDI)>0 D
"RTN","MMRSCDI2",307,0)
 ......S PRVCDI=$$FMTE^XLFDT(PRVCDI,2)
"RTN","MMRSCDI2",308,0)
 ......I PRVCDI["@" S PRVCDI=$TR(PRVCDI,"@"," ")
"RTN","MMRSCDI2",309,0)
 .....D KVA^VADPT
"RTN","MMRSCDI2",310,0)
 .....D DEM^VADPT
"RTN","MMRSCDI2",311,0)
 .....S LAST4=$E($P(VADM(2),U),6,9)
"RTN","MMRSCDI2",312,0)
 .....D KVA^VADPT
"RTN","MMRSCDI2",313,0)
 .....S ORDDATE=$P(NODE,"^",5)
"RTN","MMRSCDI2",314,0)
 .....I ORDDATE S ORDDATE=$$FMTE^XLFDT(ORDDATE,"2M")
"RTN","MMRSCDI2",315,0)
 .....S DOB=$$GET1^DIQ(2,DFN,.03,"E")
"RTN","MMRSCDI2",316,0)
 .....W !,$E(PATNM,1,30),?25,LAST4,?30,DOB,?42,$G(CDIVT),?70,$G(INDATE),?90,$G(WARDNAME),?106,$G(DCDT),?130,$G(PRVCDI)
"RTN","MMRSCDI2",317,0)
 .....S COUNT=$G(COUNT)+1
"RTN","MMRSCDI2",318,0)
 .....S DL="^"
"RTN","MMRSCDI2",319,0)
 ....S PRVCDI=""
"RTN","MMRSCDI2",320,0)
 ....I $Y+2>IOSL D PRTHDRS
"RTN","MMRSCDI2",321,0)
 W !!,"END OF REPORT"
"RTN","MMRSCDI2",322,0)
 Q
"RTN","MMRSCDI2",323,0)
 ;
"RTN","MMRSCDI2",324,0)
PRTHDRS ; Helper Function for PRT - Prints report headers
"RTN","MMRSCDI2",325,0)
 W @IOF
"RTN","MMRSCDI2",326,0)
 W ?13,"FACILITY CDI CASES REPORT"
"RTN","MMRSCDI2",327,0)
 W !,?13,"Division: ",DIVSN
"RTN","MMRSCDI2",328,0)
 W !,?13,"Geographical Location: ",WARDNAME
"RTN","MMRSCDI2",329,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSCDI2",330,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?75,"PAGE: ",PG
"RTN","MMRSCDI2",331,0)
 W !,"PATIENT",?25,"SSN",?30,"DOB",?42,"CDI Event D/T",?70,"ADM D/T",?90,"LOCATION",?105,"DC D/T",?130,"PREV CDI Event D/T"
"RTN","MMRSCDI2",332,0)
 W !,LN
"RTN","MMRSCDI2",333,0)
 S PG=PG+1
"RTN","MMRSCDI2",334,0)
 Q
"RTN","MMRSCDI2",335,0)
ASKDVC ;Prompts user for device of output (allows queuing)
"RTN","MMRSCDI2",336,0)
 W !!
"RTN","MMRSCDI2",337,0)
 N MMRSVAR,ZTSK
"RTN","MMRSCDI2",338,0)
 W !!!,"This report is designed for a 132 column format (compressed).",!
"RTN","MMRSCDI2",339,0)
 S MMRSVAR("STRTDT")="",MMRSVAR("DFLTDT")="",MMRSVAR("ENDDT")=""
"RTN","MMRSCDI2",340,0)
 S MMRSVAR("MMRSNOW")="",MMRSVAR("TSTSTP")="",MMRSVAR("MDROETIO")=""
"RTN","MMRSCDI2",341,0)
 S MMRSVAR("MMRSDIV")="",MMRSVAR("MMRSDIV(")=""
"RTN","MMRSCDI2",342,0)
 D EN^XUTMDEVQ("MAIN2^MMRSCDI2","Print CDI report (MMRSCDI2)",.MMRSVAR,"QM",1)
"RTN","MMRSCDI2",343,0)
 W:$D(ZTSK) !,"Report Queued to Print ("_ZTSK_").",!
"RTN","MMRSCDI2",344,0)
 Q
"RTN","MMRSCDI2",345,0)
 ;
"RTN","MMRSCDI2",346,0)
QUIT ;
"RTN","MMRSCDI2",347,0)
 K ENDDT,FND,CDI,LCPTR,LRFILE,MMRSMDRO,PCDIVT,PRINT,PCDIVT,SERV
"RTN","MMRSCDI2",348,0)
 K STPCD,STRTDT,TYPE,WPTR,WRDPTR,X2,X10,X12,X2,X3,X4,X5,X6,X7,X8,X9
"RTN","MMRSCDI2",349,0)
 K X1,X11,MRSA,^TMP($J),ORGP,MDROETIO,CNT,PCD,CD,ETIO,III,IX,I
"RTN","MMRSCDI2",350,0)
 K LOC,MMRSNOW,PTR,TSTSTP,MMRSDIV,NOCONF
"RTN","MMRSCDI2",351,0)
 Q
"RTN","MMRSCDI2",352,0)
 ;
"RTN","MMRSCRE")
0^12^B90369826^n/a
"RTN","MMRSCRE",1,0)
MMRSCRE ;TCK - Print CRE Acute Care IPEC Report ; 12/6/16 11:24am
"RTN","MMRSCRE",2,0)
 ;;1.0;MDRO PROGRAM TOOLS;**4**;June 01, 2016;Build 130
"RTN","MMRSCRE",3,0)
 ;
"RTN","MMRSCRE",4,0)
 ;This is the main routine to print the CRE Acute Care IPEC Report.
"RTN","MMRSCRE",5,0)
 ;This routine uses functions contained in MMRSCRE2, MMRSCRE3, and MMRSCRE4.
"RTN","MMRSCRE",6,0)
MAIN ;
"RTN","MMRSCRE",7,0)
 N NUMDIV,MMRSDIV,MMRSLOC,EXTFLG,STRTDT,ENDDT,PRTSUM,BYADM
"RTN","MMRSCRE",8,0)
 D CLEAN
"RTN","MMRSCRE",9,0)
 D CHECK2
"RTN","MMRSCRE",10,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSCRE",11,0)
 W !
"RTN","MMRSCRE",12,0)
 D CHECK3
"RTN","MMRSCRE",13,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSCRE",14,0)
 D PROMPT
"RTN","MMRSCRE",15,0)
 I $D(EXTFLG) D CLEAN K MMRSSUM,DIVARY,DVSN,MDIV Q
"RTN","MMRSCRE",16,0)
 D ASKDVC Q:$D(EXTFLG)
"RTN","MMRSCRE",17,0)
 D CLEAN
"RTN","MMRSCRE",18,0)
 K MMRSSUM,DIVARY,DVSN,MDIV
"RTN","MMRSCRE",19,0)
 Q
"RTN","MMRSCRE",20,0)
CHKPAR(ORG,Y,CHK) ;
"RTN","MMRSCRE",21,0)
 N I,TST,ETI
"RTN","MMRSCRE",22,0)
 I '$D(^MMRS(104.1,"C",+Y,ORG)) S CHK=0 Q
"RTN","MMRSCRE",23,0)
 S I="",I=$O(^MMRS(104.1,"C",+Y,ORG,I))
"RTN","MMRSCRE",24,0)
 S LIEN=1_","_I_","
"RTN","MMRSCRE",25,0)
 S TST=$$GET1^DIQ(104.15,LIEN,.01,"I")
"RTN","MMRSCRE",26,0)
 I $G(TST)>0 Q
"RTN","MMRSCRE",27,0)
 S ETI=$$GET1^DIQ(104.109,LIEN,.01,"I")
"RTN","MMRSCRE",28,0)
 I $G(ETI)>0 Q
"RTN","MMRSCRE",29,0)
 S CHK=0
"RTN","MMRSCRE",30,0)
 Q
"RTN","MMRSCRE",31,0)
 ;
"RTN","MMRSCRE",32,0)
CHECK(L) ;Check if parameters are setup
"RTN","MMRSCRE",33,0)
 Q:$G(L)'>0
"RTN","MMRSCRE",34,0)
 N DVSN
"RTN","MMRSCRE",35,0)
 S (SPCM,NUMDIV)=0
"RTN","MMRSCRE",36,0)
 S MMRSDIV=0 F  S MMRSDIV=$O(^MMRS(104,MMRSDIV)) Q:'MMRSDIV  D  Q:NUMDIV
"RTN","MMRSCRE",37,0)
 .I $D(^MMRS(104,MMRSDIV,0)) S NUMDIV=NUMDIV+1 Q
"RTN","MMRSCRE",38,0)
 I NUMDIV D
"RTN","MMRSCRE",39,0)
 .Q:'$D(^MMRS(104,"B",L))
"RTN","MMRSCRE",40,0)
 .S DVSN="",DVSN=$O(^MMRS(104,"B",L,DVSN))
"RTN","MMRSCRE",41,0)
 .Q:$G(DVSN)'>0
"RTN","MMRSCRE",42,0)
 .Q:'$D(^MMRS(104,DVSN,61))
"RTN","MMRSCRE",43,0)
 .Q:'$P(^MMRS(104,DVSN,61,0),"^",3)
"RTN","MMRSCRE",44,0)
 .S SPCM=1
"RTN","MMRSCRE",45,0)
 I 'NUMDIV!('SPCM) D
"RTN","MMRSCRE",46,0)
 .W !!,"   >>>Make sure a division and/or a Surveillance specimen has been "
"RTN","MMRSCRE",47,0)
 .W !,"         setup using the option: 'CRE Tools Site Parameter Setup'"
"RTN","MMRSCRE",48,0)
 .S EXTFLG=1
"RTN","MMRSCRE",49,0)
 Q
"RTN","MMRSCRE",50,0)
CHECK2 ;Check if lab tests and etiologies are setup
"RTN","MMRSCRE",51,0)
 N TST,MRSASTAP,MMRSET,MMRSI
"RTN","MMRSCRE",52,0)
 S (MDROETIO,TSTSTP)=0
"RTN","MMRSCRE",53,0)
 I $D(^MMRS(104.1)) D
"RTN","MMRSCRE",54,0)
 .S II=0 F  S II=$O(^MMRS(104.1,II)) Q:II'>0  D  Q:MDROETIO!(TSTSTP)
"RTN","MMRSCRE",55,0)
 ..Q:'$D(^MMRS(104.1,II,0))
"RTN","MMRSCRE",56,0)
 ..S ORGP=$P(^MMRS(104.1,II,0),"^")
"RTN","MMRSCRE",57,0)
 ..Q:$G(ORGP)'>0
"RTN","MMRSCRE",58,0)
 ..S ETIO=$$GET1^DIQ(104.2,ORGP,.01,"E")
"RTN","MMRSCRE",59,0)
 ..S ETIO=$$UPPER^DGUTL(ETIO)
"RTN","MMRSCRE",60,0)
 ..Q:ETIO'["CRB"
"RTN","MMRSCRE",61,0)
 ..S IX=0
"RTN","MMRSCRE",62,0)
 ..F  S IX=$O(^MMRS(104.1,II,3,IX)) Q:IX'>0  D  Q:TSTSTP
"RTN","MMRSCRE",63,0)
 ...I $G(IX)>0 D
"RTN","MMRSCRE",64,0)
 ....Q:'$D(^MMRS(104.1,II,3,IX,0))
"RTN","MMRSCRE",65,0)
 ....S III=IX_","_II_","
"RTN","MMRSCRE",66,0)
 ....Q:III=""
"RTN","MMRSCRE",67,0)
 ....S TST=$$GET1^DIQ(104.15,III,.01,"E")
"RTN","MMRSCRE",68,0)
 ....S TSTSTP=1
"RTN","MMRSCRE",69,0)
 ..I $D(^MMRS(104.1,II,6)) D
"RTN","MMRSCRE",70,0)
 ...S IXI=0 F  S IXI=$O(^MMRS(104.1,II,6,IXI)) Q:IXI'>0  D  Q:MDROETIO
"RTN","MMRSCRE",71,0)
 ....Q:IXI=""
"RTN","MMRSCRE",72,0)
 ....Q:'IXI
"RTN","MMRSCRE",73,0)
 ....S III=IXI_","_II_","
"RTN","MMRSCRE",74,0)
 ....S XX=$$GET1^DIQ(104.109,III,.01,"E")
"RTN","MMRSCRE",75,0)
 ....Q:XX=""
"RTN","MMRSCRE",76,0)
 ....S ETIONAME=XX,ORG=II,MDROETIO=ORG
"RTN","MMRSCRE",77,0)
ERROR ;
"RTN","MMRSCRE",78,0)
 I 'TSTSTP&'MDROETIO D
"RTN","MMRSCRE",79,0)
 .S EXTFLG=1
"RTN","MMRSCRE",80,0)
 .W !!,"    >>>The report cannot be run because the Etiology has not been "
"RTN","MMRSCRE",81,0)
 .W !,"        configured in the MDRO TOOLS LAB SEARCH/EXTRACT file, "
"RTN","MMRSCRE",82,0)
 .W !,"        (#104.1).  Use the MDRO Tools Lab Parameter Setup "
"RTN","MMRSCRE",83,0)
 .W !,"        option to configure."
"RTN","MMRSCRE",84,0)
 Q
"RTN","MMRSCRE",85,0)
 ;
"RTN","MMRSCRE",86,0)
CHECK3 ;Check if Ward Mappings have been setup for this division
"RTN","MMRSCRE",87,0)
 N NUMLOC,MMRSLOC,MMRSDIV
"RTN","MMRSCRE",88,0)
 S NUMLOC=0
"RTN","MMRSCRE",89,0)
 S MMRSDIV=0 F  S MMRSDIV=$O(^MMRS(104.3,MMRSDIV)) Q:'MMRSDIV  D
"RTN","MMRSCRE",90,0)
 .I $G(MMRSDIV) S NUMLOC=NUMLOC+1
"RTN","MMRSCRE",91,0)
 I NUMLOC=0 W !!,"   >>> Make sure the Ward Mappings for each Geographical Unit has been setup.",!! S EXTFLG=1
"RTN","MMRSCRE",92,0)
 Q
"RTN","MMRSCRE",93,0)
 ;
"RTN","MMRSCRE",94,0)
MAIN2 ; Entry for queuing
"RTN","MMRSCRE",95,0)
 ;D CLEAN ;Kill Temp Global
"RTN","MMRSCRE",96,0)
 D GETPARAM ; Load parameters in temp global
"RTN","MMRSCRE",97,0)
 D CLEAN ;Kill Temp Global
"RTN","MMRSCRE",98,0)
 Q
"RTN","MMRSCRE",99,0)
CLEAN ;
"RTN","MMRSCRE",100,0)
 K DFN,INDT,LIENS,LIEN,IN,ADMTDT,COLDT,LRIDT
"RTN","MMRSCRE",101,0)
 K ^TMP($J,"MMRSCRE"),TOTAL,DATA,DATA1,DIVARY,MDIV,DVSN
"RTN","MMRSCRE",102,0)
 K ^TMP($J,"MMRSCREPD"),TMPDATA
"RTN","MMRSCRE",103,0)
 Q
"RTN","MMRSCRE",104,0)
 ;
"RTN","MMRSCRE",105,0)
GETDIV() ;Prompt user to select Division
"RTN","MMRSCRE",106,0)
 N MMRSDIV,COUNT,DIV,DIC,Y,DLAYGO,X,DTOUT,DUOUT
"RTN","MMRSCRE",107,0)
 S MMRSDIV=""
"RTN","MMRSCRE",108,0)
 S COUNT=0,DIV=0 F  S DIV=$O(^MMRS(104,DIV)) Q:'DIV  S COUNT=COUNT+1
"RTN","MMRSCRE",109,0)
 I COUNT=1 S MMRSDIV=$O(^MMRS(104,0)) Q MMRSDIV
"RTN","MMRSCRE",110,0)
 S DIC="^DG(40.8,"
"RTN","MMRSCRE",111,0)
 S DIC(0)="AEMQ"
"RTN","MMRSCRE",112,0)
 S DIC("A")="Select the Division/Station: "
"RTN","MMRSCRE",113,0)
 S DIC("S")="I $D(^MMRS(104,""B"",Y))"
"RTN","MMRSCRE",114,0)
 D ^DIC K DIC
"RTN","MMRSCRE",115,0)
 I $D(DTOUT)!($D(DUOUT))!(Y=-1) S EXTFLG=1 Q ""
"RTN","MMRSCRE",116,0)
 S MMRSDIV=+Y
"RTN","MMRSCRE",117,0)
 S MMRSDIV=$O(^MMRS(104,"B",MMRSDIV,0))
"RTN","MMRSCRE",118,0)
 Q MMRSDIV
"RTN","MMRSCRE",119,0)
 ;
"RTN","MMRSCRE",120,0)
PROMPT ;Prompts user for start date, end date, locations, and if user wants to only print the Summary Report.
"RTN","MMRSCRE",121,0)
 S BYADM=1,PRMPTTXT="facility admission"
"RTN","MMRSCRE",122,0)
 ;
"RTN","MMRSCRE",123,0)
LOC ;Prompts user for division
"RTN","MMRSCRE",124,0)
 N STID,STNM,SIEN
"RTN","MMRSCRE",125,0)
 S (STP,ALL)=0
"RTN","MMRSCRE",126,0)
 W !
"RTN","MMRSCRE",127,0)
 S DIR(0)="YA",DIR("A")="Do you want to select all divisions: ",DIR("B")="NO"
"RTN","MMRSCRE",128,0)
 D ^DIR K DIR
"RTN","MMRSCRE",129,0)
 I $D(DIRUT) S EXTFLG=1 Q
"RTN","MMRSCRE",130,0)
 I Y=1 S ALL=1 D  Q:'CHK
"RTN","MMRSCRE",131,0)
 .S CHK=1
"RTN","MMRSCRE",132,0)
 .S DIV=0 F  S DIV=$O(^MMRS(104,DIV)) Q:DIV'>0  D  Q:STP!('CHK)
"RTN","MMRSCRE",133,0)
 ..S WR=$$GET1^DIQ(40.8,DIV,.01,"I")
"RTN","MMRSCRE",134,0)
 ..D CHKPAR(ORGP,DIV,.CHK)
"RTN","MMRSCRE",135,0)
 ..I 'CHK S (MDROETIO,TSTSTP)=0 D ERROR  Q
"RTN","MMRSCRE",136,0)
 ..S FID=$$GET1^DIQ(40.8,DIV,1,"E"),STID=$$GET1^DIQ(40.8,DIV,.01,"E")
"RTN","MMRSCRE",137,0)
 ..S MMRSLOC(FID)=STID,DIVARY(STID)=+DIV
"RTN","MMRSCRE",138,0)
 ..D CHECK(DIV)
"RTN","MMRSCRE",139,0)
 ..I $G(NUMDIV)'>0 S STP=1 Q
"RTN","MMRSCRE",140,0)
 ..I $G(SPCM)'>0 S STP=1 Q
"RTN","MMRSCRE",141,0)
 Q:STP
"RTN","MMRSCRE",142,0)
 ;PROMPT FOR WARDS
"RTN","MMRSCRE",143,0)
 I 'Y D  Q:'CHK
"RTN","MMRSCRE",144,0)
 .S CHK=1
"RTN","MMRSCRE",145,0)
 .N DIC,DLAYGO,DTOUT,DUOUT
"RTN","MMRSCRE",146,0)
 .W !
"RTN","MMRSCRE",147,0)
 .S DIC("A")="Select Division: "
"RTN","MMRSCRE",148,0)
 .S DIC="^MMRS(104,",DIC(0)="QEAM" D ^DIC
"RTN","MMRSCRE",149,0)
 .I (Y=-1)!($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSCRE",150,0)
 .D CHKPAR(ORGP,Y,.CHK)
"RTN","MMRSCRE",151,0)
 .I 'CHK S (MDROETIO,TSTSTP)=0 D ERROR  Q
"RTN","MMRSCRE",152,0)
 .S DPT=$P(Y,"^",2)
"RTN","MMRSCRE",153,0)
 .S STID=$$GET1^DIQ(40.8,DPT,.01,"E"),FID=$$GET1^DIQ(40.8,DPT,1,"E")
"RTN","MMRSCRE",154,0)
 .S WR=+Y
"RTN","MMRSCRE",155,0)
 .S MMRSLOC(FID)=STID,DIVARY(STID)=+Y
"RTN","MMRSCRE",156,0)
 .I $G(Y)>0 D CHECK(WR)
"RTN","MMRSCRE",157,0)
 .;S NUMDIV=1
"RTN","MMRSCRE",158,0)
 .Q:$G(NUMDIV)'>0
"RTN","MMRSCRE",159,0)
 .Q:$G(SPCM)'>0
"RTN","MMRSCRE",160,0)
 .S CHK=1
"RTN","MMRSCRE",161,0)
 .S DIC("A")="Select another Division: " F  D ^DIC Q:Y=-1  D  Q:'CHK
"RTN","MMRSCRE",162,0)
 ..D CHKPAR(ORGP,Y,.CHK)
"RTN","MMRSCRE",163,0)
 ..I 'CHK S (MDROETIO,TSTSTP)=0 D ERROR  Q
"RTN","MMRSCRE",164,0)
 ..S STID=$$GET1^DIQ(104,+Y,.01,"E"),WR=$$GET1^DIQ(104,+Y,.01,"I")
"RTN","MMRSCRE",165,0)
 ..S FID=$$GET1^DIQ(40.8,+Y,1,"E"),MMRSLOC(FID)=STID,DIVARY(STID)=+Y
"RTN","MMRSCRE",166,0)
 ..I $G(Y)>0 D CHECK(WR)
"RTN","MMRSCRE",167,0)
 ..I $G(NUMDIV)'>0 S STP=1 Q
"RTN","MMRSCRE",168,0)
 ..I $G(SPCM)'>0 S STP=1 Q
"RTN","MMRSCRE",169,0)
 ..;K DIC
"RTN","MMRSCRE",170,0)
 .I ($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSCRE",171,0)
 K DIC
"RTN","MMRSCRE",172,0)
 ;I $G(Y)<0 S CHK=0,EXTFLG=1 Q
"RTN","MMRSCRE",173,0)
 Q:$G(NUMDIV)'>0
"RTN","MMRSCRE",174,0)
 Q:$G(SPCM)'>0
"RTN","MMRSCRE",175,0)
 Q:$D(EXTFLG)
"RTN","MMRSCRE",176,0)
 I ($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSCRE",177,0)
 ;
"RTN","MMRSCRE",178,0)
DATE ;Prompts user for date range
"RTN","MMRSCRE",179,0)
 N %DT,X
"RTN","MMRSCRE",180,0)
 K Y
"RTN","MMRSCRE",181,0)
 W ! S %DT="AEPX",%DT("A")="Begin with "_PRMPTTXT_" date: " D ^%DT
"RTN","MMRSCRE",182,0)
 I Y<0 S EXTFLG=1 Q
"RTN","MMRSCRE",183,0)
 S STRTDT=Y
"RTN","MMRSCRE",184,0)
 S %DT("A")="End with "_PRMPTTXT_" date: " D ^%DT
"RTN","MMRSCRE",185,0)
 I Y<0 S EXTFLG=1 Q
"RTN","MMRSCRE",186,0)
 S ENDDT=Y
"RTN","MMRSCRE",187,0)
 I '$P(ENDDT,".",2) S ENDDT=Y+.24
"RTN","MMRSCRE",188,0)
 I ENDDT<STRTDT W !!,"The ending date of the range must be later than the starting date." G DATE
"RTN","MMRSCRE",189,0)
 ;
"RTN","MMRSCRE",190,0)
SUMRPT ;Prompt user if should only run the summary report.
"RTN","MMRSCRE",191,0)
 I $G(MMRSSUM) S PRTSUM=1 Q  ; IF OPTION IS ONLY FOR SUMMARY REPORT...
"RTN","MMRSCRE",192,0)
 W !
"RTN","MMRSCRE",193,0)
 S DIR(0)="Y"
"RTN","MMRSCRE",194,0)
 S DIR("A")="Do you want to only print the summary report"
"RTN","MMRSCRE",195,0)
 S DIR("B")="NO"
"RTN","MMRSCRE",196,0)
 D ^DIR K DIR
"RTN","MMRSCRE",197,0)
 I $D(DIRUT) S EXTFLG=1 Q
"RTN","MMRSCRE",198,0)
 S PRTSUM=Y
"RTN","MMRSCRE",199,0)
 Q
"RTN","MMRSCRE",200,0)
ASKDVC ;Prompts user for device of output (allows queuing)
"RTN","MMRSCRE",201,0)
 N MMRSVAR,ZTSK
"RTN","MMRSCRE",202,0)
 W !! W:'PRTSUM !,"This report is designed for a 176 column format (landscape).",!
"RTN","MMRSCRE",203,0)
 S MMRSVAR("STRTDT")="",MMRSVAR("ENDDT")="",MMRSVAR("MMRSLOC(")=""
"RTN","MMRSCRE",204,0)
 S MMRSVAR("PRTSUM")="",MMRSVAR("BYADM")="",MMRSVAR("MMRSDIV")=""
"RTN","MMRSCRE",205,0)
 S MMRSVAR("DFLTDT")="",MMRSVAR("TSTSTP")="",MMRSVAR("MDROETIO")=""
"RTN","MMRSCRE",206,0)
 S MMRSVAR("ORG")="",MMRSVAR("DIVARY")="",MMRSVAR("DIVARY(")=""
"RTN","MMRSCRE",207,0)
 D EN^XUTMDEVQ("MAIN2^MMRSCRE","PRINT CRE Acute Care IPEC REPORT",.MMRSVAR,"QM",1)
"RTN","MMRSCRE",208,0)
 W:$D(ZTSK) !,"Report Queued to Print ("_ZTSK_").",!
"RTN","MMRSCRE",209,0)
 Q
"RTN","MMRSCRE",210,0)
GETPARAM ;(MDRO) ; Loads lab search/extract parameters from file 104.1
"RTN","MMRSCRE",211,0)
 N TSTNM,TST,MDRO,TEST,IEN,TIEN,ITOP,TOP,ETOP,IBACT,BACT,EBACT
"RTN","MMRSCRE",212,0)
 N ETIOL,ETIOLOGY,ANTI,ANTIM,INC,MRSASTAP,ETIONAME,MMRSI,MMRSET
"RTN","MMRSCRE",213,0)
 N MDRO
"RTN","MMRSCRE",214,0)
 S MMRSDIV=0,DIVSN="",LOC=""
"RTN","MMRSCRE",215,0)
 S MMRSMDRO=$O(^MMRS(104.2,"B","CRB-R",0))
"RTN","MMRSCRE",216,0)
 F  S LOC=$O(DIVARY(LOC)) Q:LOC=""  D
"RTN","MMRSCRE",217,0)
 .K ^TMP($J,"MMRSCRE","T")
"RTN","MMRSCRE",218,0)
 .K ^TMP($J,"MMRSCRE","ETIOL")
"RTN","MMRSCRE",219,0)
 .S Y=DIVARY(LOC)
"RTN","MMRSCRE",220,0)
 .S IEN="",IEN=$O(^MMRS(104.1,"C",+Y,MMRSMDRO,IEN))
"RTN","MMRSCRE",221,0)
 .Q:$G(IEN)'>0
"RTN","MMRSCRE",222,0)
 .;S MDROETIO=IEN
"RTN","MMRSCRE",223,0)
 .S MDRO=MMRSMDRO
"RTN","MMRSCRE",224,0)
 .S (FND,SUB,INC)=0
"RTN","MMRSCRE",225,0)
 .I $G(TSTSTP)'>0 S TSTSTP=1
"RTN","MMRSCRE",226,0)
 .I TSTSTP D
"RTN","MMRSCRE",227,0)
 ..S TIEN=0 F  S TIEN=$O(^MMRS(104.1,IEN,3,TIEN)) Q:'TIEN  D
"RTN","MMRSCRE",228,0)
 ...S LRIEN=TIEN_","_MDRO_","
"RTN","MMRSCRE",229,0)
 ...S TEST=$$GET1^DIQ(104.15,LRIEN,.01,"I")
"RTN","MMRSCRE",230,0)
 ...Q:'TEST
"RTN","MMRSCRE",231,0)
 ...S INC=INC+1
"RTN","MMRSCRE",232,0)
 ...S ^TMP($J,"MMRSCRE","T",MDRO,TEST_"_"_INC,0)=$P($G(^MMRS(104.1,MDRO,3,TIEN,0)),U,2,3)
"RTN","MMRSCRE",233,0)
 .I MDROETIO D
"RTN","MMRSCRE",234,0)
 ..S IBACT=0 F  S IBACT=$O(^MMRS(104.1,MDROETIO,4,IBACT)) Q:'IBACT  D
"RTN","MMRSCRE",235,0)
 ...S BACT=$G(^MMRS(104.1,MDROETIO,4,IBACT,0))
"RTN","MMRSCRE",236,0)
 ...I BACT'="" S ^TMP($J,"MMRSCD","BACT",MDROETIO,"INC_REMARK",IBACT)=BACT
"RTN","MMRSCRE",237,0)
 ..S EBACT=0 F  S EBACT=$O(^MMRS(104.1,MDROETIO,5,EBACT)) Q:'EBACT  D
"RTN","MMRSCRE",238,0)
 ...S BACT=$G(^MMRS(104.1,MDROETIO,5,EBACT,0))
"RTN","MMRSCRE",239,0)
 ..S ETIOL=0 F  S ETIOL=$O(^MMRS(104.1,MDROETIO,6,ETIOL)) Q:'ETIOL  D
"RTN","MMRSCRE",240,0)
 ...S ETIOLOGY=$G(^MMRS(104.1,MDROETIO,6,ETIOL,0))
"RTN","MMRSCRE",241,0)
 ...Q:'ETIOLOGY
"RTN","MMRSCRE",242,0)
 ...S ^TMP($J,"MMRSCRE","ETIOL",MDROETIO,+ETIOLOGY)=""
"RTN","MMRSCRE",243,0)
 .D GETMOVE^MMRSCRE2
"RTN","MMRSCRE",244,0)
 .D GETLABS^MMRSCRE3
"RTN","MMRSCRE",245,0)
 .D PRINT^MMRSCRE4
"RTN","MMRSCRE",246,0)
 Q
"RTN","MMRSCRE",247,0)
 ;
"RTN","MMRSCRE",248,0)
PATDAYS ;Gets 'PATIENT DAYS OF CARE'.
"RTN","MMRSCRE",249,0)
 N TTLRSLT,SDT,EDT,LOC,RSLT,WLOC,WARD,PATDAYS,LOCNAME,RTOT
"RTN","MMRSCRE",250,0)
 S (FND,TTLRSLT,RTOT,TOTAL("PAT"))=0
"RTN","MMRSCRE",251,0)
 S SDT=$P(STRTDT,".")
"RTN","MMRSCRE",252,0)
 S EDT=$P(ENDDT,".")
"RTN","MMRSCRE",253,0)
 Q:'$D(WRDLOC)
"RTN","MMRSCRE",254,0)
 S WARD="" F  S WARD=$O(WRDLOC(WARD)) Q:$G(WARD)'>0  D
"RTN","MMRSCRE",255,0)
 .S RSLT=0
"RTN","MMRSCRE",256,0)
 .S DIV=$$GET1^DIQ(42,WARD,.015,"I"),DIV=$$GET1^DIQ(40.8,DIV,1,"I")
"RTN","MMRSCRE",257,0)
 .;I '$D(MMRSLOC(DIV)) K WRDLOC(WARD) Q
"RTN","MMRSCRE",258,0)
 .S PATDAYS=$$GETPATDY(WARD,SDT,EDT)
"RTN","MMRSCRE",259,0)
 .S RSLT=RSLT+PATDAYS,TTLRSLT=TTLRSLT+PATDAYS
"RTN","MMRSCRE",260,0)
 .S LOCNAME=$$GET1^DIQ(42,WARD,.015,"E")
"RTN","MMRSCRE",261,0)
 .S $P(^TMP($J,"MMRSCREPD","DSUM",LOCNAME),U,1)=RSLT
"RTN","MMRSCRE",262,0)
 S $P(^TMP($J,"MMRSCREPD","DSUM"),U,1)=TTLRSLT
"RTN","MMRSCRE",263,0)
 S TOTAL("PAT")=TTLRSLT
"RTN","MMRSCRE",264,0)
 ;S PATDAYS=""
"RTN","MMRSCRE",265,0)
 Q
"RTN","MMRSCRE",266,0)
GETPATDY(WARD,SDT,EDT) ;Helper function for PATDAYS() - Gets Patient Days of care for specific ward
"RTN","MMRSCRE",267,0)
 N CENSUS,SCUMPD,ECUMPD
"RTN","MMRSCRE",268,0)
 I SDT>EDT Q 0
"RTN","MMRSCRE",269,0)
 I SDT<($$FY(EDT)_"1001") Q ($$GETPATDY(WARD,SDT,($$FY(EDT)_"0930"))+$$GETPATDY(WARD,($$FY(EDT)_"1001"),EDT))
"RTN","MMRSCRE",270,0)
 S CENSUS=$O(^DG(41.9,"B",WARD,0)) I 'CENSUS Q 0
"RTN","MMRSCRE",271,0)
 S SDT=$$FMADD^XLFDT(SDT,-1,0,0,0)
"RTN","MMRSCRE",272,0)
 S SCUMPD=$P($G(^DG(41.9,CENSUS,"C",SDT,0)),U,3)
"RTN","MMRSCRE",273,0)
 I EDT=$$DT^XLFDT S EDT=$$FMADD^XLFDT(EDT,-1,0,0,0)
"RTN","MMRSCRE",274,0)
 S ECUMPD=$P($G(^DG(41.9,CENSUS,"C",EDT,0)),U,3)
"RTN","MMRSCRE",275,0)
 I $E(SDT,4,7)="0930" S SCUMPD=0 ; IF LAST DAY OF FY
"RTN","MMRSCRE",276,0)
 I ECUMPD<SCUMPD Q 0
"RTN","MMRSCRE",277,0)
 Q ECUMPD-SCUMPD
"RTN","MMRSCRE",278,0)
FY(DATE) ;Helper function for GETPATDY - Gets fiscal year for the specified date
"RTN","MMRSCRE",279,0)
 I $E(DATE,4,7)>("1000"),$E(DATE,4,7)<("1232") Q $E(DATE,1,3)
"RTN","MMRSCRE",280,0)
 Q ($E(DATE,1,3)-1)
"RTN","MMRSCRE2")
0^13^B12793206^n/a
"RTN","MMRSCRE2",1,0)
MMRSCRE2 ;TCK - Print CRE Report Cont. (Contains functions to collect patient movements) ; 11/29/16 3:48am
"RTN","MMRSCRE2",2,0)
 ;;1.0;MDRO PROGRAM TOOLS;**4**;Jun 01, 2016;Build 130
"RTN","MMRSCRE2",3,0)
 ;
"RTN","MMRSCRE2",4,0)
GETMOVE ;Collects ward movements for patients that were admitted or discharged in date range.
"RTN","MMRSCRE2",5,0)
 N DUPLOC,MMRSLOC2
"RTN","MMRSCRE2",6,0)
 D GETADM(LOC)
"RTN","MMRSCRE2",7,0)
 ;
"RTN","MMRSCRE2",8,0)
GETADM(LOC) ;
"RTN","MMRSCRE2",9,0)
 N TT,MOVDT,MOVIFN,TRANTYPE,INWARD,INDATE,INIFN,INTT,OUTDATE,OUTIFN,OUTTT,NEXTIEN,LOCNAME,VAIP,INLOC
"RTN","MMRSCRE2",10,0)
 F TT=1,2 S MOVDT=STRTDT-.0000001 F  S MOVDT=$O(^DGPM("ATT"_TT,MOVDT)) Q:(MOVDT>ENDDT)!('MOVDT)  D
"RTN","MMRSCRE2",11,0)
 .S MOVIFN="" F  S MOVIFN=$O(^DGPM("ATT"_TT,MOVDT,MOVIFN)) Q:'MOVIFN  D
"RTN","MMRSCRE2",12,0)
 ..D KVA^VADPT S DFN=$P($G(^DGPM(MOVIFN,0)),"^",3),VAIP("E")=MOVIFN D IN5^VADPT
"RTN","MMRSCRE2",13,0)
 ..S TRANTYPE=$$TRANTYPE(+VAIP(4),+VAIP(2))
"RTN","MMRSCRE2",14,0)
 ..I TRANTYPE<1!(TRANTYPE=3) Q
"RTN","MMRSCRE2",15,0)
 ..S INWARD=+VAIP(5),WARD=$$GET1^DIQ(42,INWARD,.01,"E")
"RTN","MMRSCRE2",16,0)
 ..I $G(INWARD)>0 D
"RTN","MMRSCRE2",17,0)
 ...S HSPLC=$$GET1^DIQ(42,INWARD,44,"I")
"RTN","MMRSCRE2",18,0)
 ...S DIV=$$GET1^DIQ(44,HSPLC,3.5,"E")
"RTN","MMRSCRE2",19,0)
 ...S DIVS=$$GET1^DIQ(44,HSPLC,3.5,"I")
"RTN","MMRSCRE2",20,0)
 ...S DIVID=$$GET1^DIQ(40.8,DIVS,1,"I"),LOC=$$GET1^DIQ(40.8,DIVS,.01,"I")
"RTN","MMRSCRE2",21,0)
 ..;IS THIS WARD EXCLUDED FROM THIS REPORT
"RTN","MMRSCRE2",22,0)
 ..Q:DIV'=LOC
"RTN","MMRSCRE2",23,0)
 ..S LOCNAME=LOC
"RTN","MMRSCRE2",24,0)
 ..S WRDLOC(INWARD)=""
"RTN","MMRSCRE2",25,0)
 ..I TRANTYPE=2,'$$CNGWARD(LOC,+VAIP(15,4),INWARD) Q
"RTN","MMRSCRE2",26,0)
 ..;SET GLOBAL
"RTN","MMRSCRE2",27,0)
 ..S INDATE=+VAIP(3)
"RTN","MMRSCRE2",28,0)
 ..S INIFN=MOVIFN
"RTN","MMRSCRE2",29,0)
 ..S INTT=TRANTYPE
"RTN","MMRSCRE2",30,0)
 ..S ADT=$$GET1^DIQ(405,MOVIFN,.04,"E")
"RTN","MMRSCRE2",31,0)
 ..S (OUTDATE,OUTIFN,OUTTT)=" "
"RTN","MMRSCRE2",32,0)
 ..F  Q:(VAIP(16)="")!(OUTIFN)  D
"RTN","MMRSCRE2",33,0)
 ...I $$TRANTYPE(+VAIP(16,3),+VAIP(16,2))=3 S OUTDATE=+VAIP(16,1),OUTIFN=VAIP(16),OUTTT=3
"RTN","MMRSCRE2",34,0)
 ...I $$TRANTYPE(+VAIP(16,3),+VAIP(16,2))=2,$$CNGWARD(LOC,INWARD,+VAIP(16,4)) S OUTDATE=+VAIP(16,1),OUTIFN=VAIP(16),OUTTT=2
"RTN","MMRSCRE2",35,0)
 ...Q:OUTIFN
"RTN","MMRSCRE2",36,0)
 ...S NEXTIEN=VAIP(16)
"RTN","MMRSCRE2",37,0)
 ...D KVA^VADPT
"RTN","MMRSCRE2",38,0)
 ...S VAIP("E")=NEXTIEN
"RTN","MMRSCRE2",39,0)
 ...D IN5^VADPT
"RTN","MMRSCRE2",40,0)
 ..S INLOC=$G(INWARD)
"RTN","MMRSCRE2",41,0)
 ..S PATNM=$$GET1^DIQ(2,DFN,.01,"E")
"RTN","MMRSCRE2",42,0)
 ..S SSN=$$GET1^DIQ(2,DFN,.09,"E"),LAST4=$E(SSN,6,9)
"RTN","MMRSCRE2",43,0)
 ..S MASMOV=$$GET1^DIQ(405.1,TRANTYPE,.04,"E")
"RTN","MMRSCRE2",44,0)
 ..S ^TMP($J,"MMRSCRE","D",LOCNAME,DFN,INDATE)=INLOC_U_DFN_U_INDATE_U_INIFN_U_INTT_U_WARD_U_PATNM_U_LAST4_U_INDATE_U_ADT_U_MASMOV
"RTN","MMRSCRE2",45,0)
 ..;S ^TMP($J,"MMRSCRE","DETAIL",LOCNAME,INDATE)=WARD_U_PATNM_U_LAST4_U_INDATE_U_ADT_U_MASMOV
"RTN","MMRSCRE2",46,0)
 D KVA^VADPT
"RTN","MMRSCRE2",47,0)
 Q
"RTN","MMRSCRE2",48,0)
CNGWARD(LOC,WARD1,WARD2) ;Did patient change wards?
"RTN","MMRSCRE2",49,0)
 I +$G(LOC)=0 S LOC=$$GETLOC(WARD1,.MMRSLOC2)
"RTN","MMRSCRE2",50,0)
 I $D(^MMRS(104.3,LOC,1,"B",WARD1)),$D(^MMRS(104.3,LOC,1,"B",WARD2)) Q 0
"RTN","MMRSCRE2",51,0)
 Q 1
"RTN","MMRSCRE2",52,0)
EXCWARD(LOC,WARD) ;Is this ward excluded from the reports?
"RTN","MMRSCRE2",53,0)
 I +$G(LOC)=0 S LOC=$$GETLOC(WARD,.MMRSLOC2)
"RTN","MMRSCRE2",54,0)
 I LOC=0 Q 1
"RTN","MMRSCRE2",55,0)
 I $D(^MMRS(104.3,LOC,1,"B",WARD)) Q 0
"RTN","MMRSCRE2",56,0)
 Q 1
"RTN","MMRSCRE2",57,0)
DUPLOC(LOC,LCTNS) ;
"RTN","MMRSCRE2",58,0)
 N RSLT,WARD,LOC2
"RTN","MMRSCRE2",59,0)
 S RSLT=0
"RTN","MMRSCRE2",60,0)
 S WARD=0 F  S WARD=$O(^MMRS(104.3,LOC,1,"B",WARD)) Q:'WARD  D
"RTN","MMRSCRE2",61,0)
 .S LOC2=0 F  S LOC2=$O(LCTNS(LOC2)) Q:'LOC2  D
"RTN","MMRSCRE2",62,0)
 ..Q:LOC2=LOC
"RTN","MMRSCRE2",63,0)
 ..I $D(^MMRS(104.3,LOC2,1,"B",WARD)) S RSLT=1
"RTN","MMRSCRE2",64,0)
 Q RSLT
"RTN","MMRSCRE2",65,0)
GETLOC(WARD,LCTNS) ;
"RTN","MMRSCRE2",66,0)
 N RSLT,LOC
"RTN","MMRSCRE2",67,0)
 S RSLT=0
"RTN","MMRSCRE2",68,0)
 S LOC=0 F  S LOC=$O(LCTNS(LOC)) Q:'LOC!(RSLT)  D
"RTN","MMRSCRE2",69,0)
 .I $D(^MMRS(104.3,LOC,1,"B",WARD)) S RSLT=LOC
"RTN","MMRSCRE2",70,0)
 Q RSLT
"RTN","MMRSCRE2",71,0)
TRANTYPE(MOVTYPE,TRANTYPE) ;
"RTN","MMRSCRE2",72,0)
 I MOVTYPE=46!(MOVTYPE=5)!(MOVTYPE=6)!(MOVTYPE=7)!(MOVTYPE=47)!(MOVTYPE=27)!(MOVTYPE=33)!(MOVTYPE=3)!(MOVTYPE=22) Q -1 ;MIA/LMT - Removed MOVTYPE 29 ;4/15/10
"RTN","MMRSCRE2",73,0)
 I MOVTYPE=42!(MOVTYPE=20)!(MOVTYPE=1)!(MOVTYPE=45)!(MOVTYPE=23)!(MOVTYPE=25)!(MOVTYPE=26) Q -1
"RTN","MMRSCRE2",74,0)
 I MOVTYPE=2!(MOVTYPE=43)!(MOVTYPE=13) Q 3
"RTN","MMRSCRE2",75,0)
 I MOVTYPE=14!(MOVTYPE=24)!(MOVTYPE=44) Q 1
"RTN","MMRSCRE2",76,0)
 Q TRANTYPE
"RTN","MMRSCRE3")
0^14^B160454267^n/a
"RTN","MMRSCRE3",1,0)
MMRSCRE3 ;LEIDOS/TCK - Print CRE Report Cont. (Contains functions to collect patient labs and swabbing rate) ; 11/29/16 3:02am
"RTN","MMRSCRE3",2,0)
 ;;1.0;MDRO PROGRAM TOOLS;**4**;Jun 01, 2016;Build 130
"RTN","MMRSCRE3",3,0)
 ;
"RTN","MMRSCRE3",4,0)
GETLABS ;Gets all lab data for the report.
"RTN","MMRSCRE3",5,0)
 N LRMDRO,LOC,INDT,DFN,OUTDT,NARES24,NARES48,SURV48,CULT48,MRSA365,CULT365,KNOWMRSA,KNOWCULT,NARES24A,NARES48ASURV48A,NARES48A
"RTN","MMRSCRE3",6,0)
 N MRSAFR,MRSATO,MRSA365A,CULT365A,SURV48A,NARES24D,NARES48D,SURV48D,MRSACPRD,TRANS,MMRSNOW
"RTN","MMRSCRE3",7,0)
 N CNTR
"RTN","MMRSCRE3",8,0)
 S CNTR=0
"RTN","MMRSCRE3",9,0)
 S MMRSNOW=$$NOW^XLFDT(),LREND=MMRSNOW
"RTN","MMRSCRE3",10,0)
 S LRMDRO="",LRMDRO=$O(^MMRS(104.2,"B","CRB-R",LRMDRO))
"RTN","MMRSCRE3",11,0)
 S ^TMP($J,"MMRSCRE","DSUM")="0^0^0^0^0^0^0^0^0"
"RTN","MMRSCRE3",12,0)
 S LOC="" F  S LOC=$O(^TMP($J,"MMRSCRE","D",LOC)) Q:LOC=""  D
"RTN","MMRSCRE3",13,0)
 .S ^TMP($J,"MMRSCRE","DSUM",LOC)="0^0^0^0^0^0^0^0^0"
"RTN","MMRSCRE3",14,0)
 .S DFN=0 F  S DFN=$O(^TMP($J,"MMRSCRE","D",LOC,DFN)) Q:'DFN  D
"RTN","MMRSCRE3",15,0)
 ..S INDT="" F  S INDT=$O(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT)) Q:'INDT  D
"RTN","MMRSCRE3",16,0)
 ...S DIV="",DIV=$O(^DG(40.8,"B",LOC,DIV))
"RTN","MMRSCRE3",17,0)
 ...I DIV'="" S MDIV="",MDIV=$O(^MMRS(104,"B",DIV,MDIV))
"RTN","MMRSCRE3",18,0)
 ...S (CR,MRSA)=""
"RTN","MMRSCRE3",19,0)
 ...S LOCSUM=$G(^TMP($J,"MMRSCRE","DSUM",LOC))
"RTN","MMRSCRE3",20,0)
 ...S SUM=$G(^TMP($J,"MMRSCRE","DSUM"))
"RTN","MMRSCRE3",21,0)
 ...S DATA=$G(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT))
"RTN","MMRSCRE3",22,0)
 ...S ORDLOC=$P(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT),"^")
"RTN","MMRSCRE3",23,0)
 ...I $G(ORDLOC)'="" S ORDLOC=$$GET1^DIQ(42,ORDLOC,.01,"E")
"RTN","MMRSCRE3",24,0)
 ...I $P(DATA,U,5)=1 D
"RTN","MMRSCRE3",25,0)
 ....S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,1)=$P(LOCSUM,U,1)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,1)=$P(SUM,U,1)+1
"RTN","MMRSCRE3",26,0)
 ...S MRSA=$$GETLAB(DFN,INDT,LRMDRO,LREND,"CD")
"RTN","MMRSCRE3",27,0)
 ...S (CR,I,COLDT)="",DONE=0
"RTN","MMRSCRE3",28,0)
 ...Q:MRSA=""
"RTN","MMRSCRE3",29,0)
 ...S CR=$P($P(MRSA,"^",2),";") I CR="" S CR="NEG"
"RTN","MMRSCRE3",30,0)
 ...Q:CR=""
"RTN","MMRSCRE3",31,0)
 ...S SRCE=$P(MRSA,"^",3)
"RTN","MMRSCRE3",32,0)
 ...Q:SRCE=""
"RTN","MMRSCRE3",33,0)
 ...S SVC="N",CC="Y"
"RTN","MMRSCRE3",34,0)
 ...S DATA=$G(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT))
"RTN","MMRSCRE3",35,0)
 ...Q:DATA=""
"RTN","MMRSCRE3",36,0)
 ...S ADMDT=$P(DATA,"^",3),MOVMENT=$P(DATA,"^",4)
"RTN","MMRSCRE3",37,0)
 ...I $G(MOVMENT)>0 D
"RTN","MMRSCRE3",38,0)
 ....S TRNACT=$$GET1^DIQ(405,MOVMENT,.02,"E")
"RTN","MMRSCRE3",39,0)
 ....I TRNACT'="ADMISSION" S DONE=1 Q
"RTN","MMRSCRE3",40,0)
 ....S DSCHRGE=$$GET1^DIQ(405,MOVMENT,.17,"I")
"RTN","MMRSCRE3",41,0)
 ....S DSCHRGE=$$GET1^DIQ(405,DSCHRGE,.01,"I")
"RTN","MMRSCRE3",42,0)
 ....I $G(DSCHRGE)'="" D
"RTN","MMRSCRE3",43,0)
 .....S DTA=$P(MRSA,"^",2),LRD=$P(DTA,";",2),LRDT=$P(DTA,";",3),LRSS=$P(DTA,";",4),NEG=$P(DTA,";")
"RTN","MMRSCRE3",44,0)
 .....Q:$G(DTA)=""
"RTN","MMRSCRE3",45,0)
 .....S LIENS=LRDT_","_LRD_","
"RTN","MMRSCRE3",46,0)
 .....S COLDT=$$GET1^DIQ(63.05,LIENS,.01,"I")
"RTN","MMRSCRE3",47,0)
 .....I DSCHRGE<COLDT D
"RTN","MMRSCRE3",48,0)
 ......K ^TMP($J,"MMRSCRE","D",LOC,DFN,INDT)
"RTN","MMRSCRE3",49,0)
 ......K ^TMP($J,"MMRSCRE","DETAIL",LOC,INDT)
"RTN","MMRSCRE3",50,0)
 ......K LIENS S DONE=1
"RTN","MMRSCRE3",51,0)
 ...Q:DONE
"RTN","MMRSCRE3",52,0)
 ...I $D(^MMRS(104,MDIV,61,"B",SRCE)) S SVC="Y",CC="N"
"RTN","MMRSCRE3",53,0)
 ...I $D(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT)) D
"RTN","MMRSCRE3",54,0)
 ....S DATA=$G(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT))
"RTN","MMRSCRE3",55,0)
 ....S ACT=$P(DATA,"^",5)
"RTN","MMRSCRE3",56,0)
 ....Q:$P(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT),"^",13)=""
"RTN","MMRSCRE3",57,0)
 ....S DTA=$P(MRSA,"^",2),LRD=$P(DTA,";",2),LRDT=$P(DTA,";",3),LRSS=$P(DTA,";",4),NEG=$P(DTA,";")
"RTN","MMRSCRE3",58,0)
 ....Q:$G(DTA)=""
"RTN","MMRSCRE3",59,0)
 ....S LIENS=LRDT_","_LRD_","
"RTN","MMRSCRE3",60,0)
 ....S COLDT=$$GET1^DIQ(63.05,LIENS,.01,"I")
"RTN","MMRSCRE3",61,0)
 ....S X=$$FMDIFF^XLFDT(COLDT,INDT,3),X=$P(X," ")
"RTN","MMRSCRE3",62,0)
 ....I X>2!('CR) D  Q
"RTN","MMRSCRE3",63,0)
 .....K MRSA
"RTN","MMRSCRE3",64,0)
 .....I $D(^TMP($J,"MMRSCRE","DETAIL",LOC,INDT)) K ^TMP($J,"MMRSCRE","DETAIL",LOC,INDT)
"RTN","MMRSCRE3",65,0)
 ....S SURV=$P(^TMP($J,"MMRSCRE","D",LOC,INDT,DFN),"^",13)
"RTN","MMRSCRE3",66,0)
 ....I SURV=SVC K MRSA(I) Q
"RTN","MMRSCRE3",67,0)
 ....I SURV'=SVC S $P(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT),"^",13)="N",$P(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT),"^",14)="Y" K MRSA(I)
"RTN","MMRSCRE3",68,0)
 ...Q:$G(MRSA)=""
"RTN","MMRSCRE3",69,0)
 ...I CR["POS",'PFLG D
"RTN","MMRSCRE3",70,0)
 ....Q:$D(^TMP($J,"MMRSCRE","DETAIL",LOC,INDT))
"RTN","MMRSCRE3",71,0)
 ....S ^TMP($J,"MMRSCRE","DETAIL",LOC,INDT)=$P(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT),U,6,11)
"RTN","MMRSCRE3",72,0)
 ...I CR["POS",$D(^TMP($J,"MMRSCRE","DETAIL",LOC,INDT)),$P(^TMP($J,"MMRSCRE","DETAIL",LOC,INDT),U,13)="",'PFLG S ^TMP($J,"MMRSCRE","DETAIL",LOC,INDT)=^TMP($J,"MMRSCRE","DETAIL",LOC,INDT)_U_SRCE_U_SVC_U_CC_U_CR
"RTN","MMRSCRE3",73,0)
 ...S MRSAFR=(INDT-10000) I STRTDT>INDT S MRSAFR=(STRTDT-10000) ;(ADM - 1 year) or  (START DT - 1 year) - whichever is later
"RTN","MMRSCRE3",74,0)
 ...D PREV ;Calculate prevalence measures
"RTN","MMRSCRE3",75,0)
 S X=""
"RTN","MMRSCRE3",76,0)
 Q
"RTN","MMRSCRE3",77,0)
 ;
"RTN","MMRSCRE3",78,0)
PREV ;Calculate prevalence measures (summary report)
"RTN","MMRSCRE3",79,0)
 N LOCSUM,SUM,DATA,IND
"RTN","MMRSCRE3",80,0)
 S LOCSUM=$G(^TMP($J,"MMRSCRE","DSUM",LOC))
"RTN","MMRSCRE3",81,0)
 S SUM=$G(^TMP($J,"MMRSCRE","DSUM"))
"RTN","MMRSCRE3",82,0)
 S DATA=$G(^TMP($J,"MMRSCRE","D",LOC,DFN,INDT))
"RTN","MMRSCRE3",83,0)
 I $P(DATA,U,5)'>2 D
"RTN","MMRSCRE3",84,0)
 .Q:MRSA'[";"
"RTN","MMRSCRE3",85,0)
 .S DTA=$P(MRSA,"^",2),LRD=$P(DTA,";",2),LRDT=$P(DTA,";",3),LRSS=$P(DTA,";",4),NEG=$P(DTA,";")
"RTN","MMRSCRE3",86,0)
 .Q:$G(DTA)=""
"RTN","MMRSCRE3",87,0)
 .S LIENS=LRDT_","_LRD_","
"RTN","MMRSCRE3",88,0)
 .S COLDT=$$GET1^DIQ(63.05,LIENS,.01,"I")
"RTN","MMRSCRE3",89,0)
 .Q:COLDT>ENDDT
"RTN","MMRSCRE3",90,0)
 .Q:COLDT<INDT
"RTN","MMRSCRE3",91,0)
 .S X=$$FMDIFF^XLFDT(COLDT,INDT,3),X=$P(X," ")
"RTN","MMRSCRE3",92,0)
 .I X<3 D
"RTN","MMRSCRE3",93,0)
 ..I SVC="Y" D
"RTN","MMRSCRE3",94,0)
 ...S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,2)=$P(LOCSUM,U,2)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,2)=$P(SUM,U,2)+1
"RTN","MMRSCRE3",95,0)
 ...I NEG="POS",'PFLG D
"RTN","MMRSCRE3",96,0)
 ....S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,3)=$P(LOCSUM,U,3)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,3)=$P(SUM,U,3)+1
"RTN","MMRSCRE3",97,0)
 ....S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,8)=$P(LOCSUM,U,8)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,8)=$P(SUM,U,8)+1
"RTN","MMRSCRE3",98,0)
 ..I SVC="N",NEG="POS",'PFLG D
"RTN","MMRSCRE3",99,0)
 ...S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,4)=$P(LOCSUM,U,4)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,4)=$P(SUM,U,4)+1
"RTN","MMRSCRE3",100,0)
 ...S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,8)=$P(LOCSUM,U,8)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,8)=$P(SUM,U,8)+1
"RTN","MMRSCRE3",101,0)
 .I X>2 D
"RTN","MMRSCRE3",102,0)
 ..I SVC="Y" D
"RTN","MMRSCRE3",103,0)
 ...S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,5)=$P(LOCSUM,U,5)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,5)=$P(SUM,U,5)+1
"RTN","MMRSCRE3",104,0)
 ...I NEG["POS",'PFLG D
"RTN","MMRSCRE3",105,0)
 ....S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,6)=$P(LOCSUM,U,6)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,6)=$P(SUM,U,6)+1
"RTN","MMRSCRE3",106,0)
 ....S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,8)=$P(LOCSUM,U,8)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,8)=$P(SUM,U,8)+1
"RTN","MMRSCRE3",107,0)
 ..I SVC="N",NEG["POS",'PFLG D
"RTN","MMRSCRE3",108,0)
 ...S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,7)=$P(LOCSUM,U,7)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,7)=$P(SUM,U,7)+1
"RTN","MMRSCRE3",109,0)
 ...S $P(^TMP($J,"MMRSCRE","DSUM",LOC),U,8)=$P(LOCSUM,U,8)+1,$P(^TMP($J,"MMRSCRE","DSUM"),U,8)=$P(SUM,U,8)+1
"RTN","MMRSCRE3",110,0)
 K MRSA
"RTN","MMRSCRE3",111,0)
 Q
"RTN","MMRSCRE3",112,0)
 ;
"RTN","MMRSCRE3",113,0)
CLNARY(LOC,DFN,MRSA) ;
"RTN","MMRSCRE3",114,0)
 N D,ST,VAL,XX
"RTN","MMRSCRE3",115,0)
 ;Q:'$D(MRSA(1)
"RTN","MMRSCRE3",116,0)
 S XX=9999,XX=$O(MRSA(XX),-1)
"RTN","MMRSCRE3",117,0)
 S D="" F  S D=$O(MRSA(D)) Q:D=""  D
"RTN","MMRSCRE3",118,0)
 .S IND=$P(MRSA(D),"^",4)
"RTN","MMRSCRE3",119,0)
 .S RES=$P($P(MRSA(D),"^",2),";")
"RTN","MMRSCRE3",120,0)
 .I RES=""!(RES["NEG") K MRSA(D) Q
"RTN","MMRSCRE3",121,0)
 .Q:'$D(^TMP($J,"MMRSCRE","D",LOC,IND,DFN))
"RTN","MMRSCRE3",122,0)
 .K ^TMP($J,"MMRSCRE","D",LOC,IND,DFN),MRSA(D)
"RTN","MMRSCRE3",123,0)
 .S DTA=MRSA(D)
"RTN","MMRSCRE3",124,0)
 .Q:DTA=""
"RTN","MMRSCRE3",125,0)
 .S LRD=$P(DTA,";",2),LRDT=$P(DTA,";",3)
"RTN","MMRSCRE3",126,0)
 .S DATA=$G(^TMP($J,"MMRSCRE","D",LOC,IND,DFN))
"RTN","MMRSCRE3",127,0)
 .S ADMDT=$P(DATA,"^",3),MOVMENT=$P(DATA,"^",4)
"RTN","MMRSCRE3",128,0)
 .S DSCHRG=$$GET1^DIQ(405,MOVMENT,.17,"I")
"RTN","MMRSCRE3",129,0)
 .I $G(DSCHRG)>0 S DSCHRG=$$GET1^DIQ(405,MOVMENT,.01,"I")
"RTN","MMRSCRE3",130,0)
 .I DSCHRG'="" D  Q
"RTN","MMRSCRE3",131,0)
 ..S LIENS=LRDT_","_LRD_","
"RTN","MMRSCRE3",132,0)
 ..S COLDT=$$GET1^DIQ(63.05,LIENS,.01,"I")
"RTN","MMRSCRE3",133,0)
 ..I DSCHRG<COLDT K ^TMP($J,"MMRSCRE","D",LOC,IND,DFN),MRSA(D) S DONE=1 Q
"RTN","MMRSCRE3",134,0)
 .S A=D-1 I $D(MRSA(A)) K MRSA(D) Q
"RTN","MMRSCRE3",135,0)
 Q
"RTN","MMRSCRE3",136,0)
GETLAB(DFN,LRSTART,LRMDRO,LREND,LRDTTYP) ;RETURN YES/NO^RESULT
"RTN","MMRSCRE3",137,0)
 N LRRSLT,LRTST,TMPRSLT
"RTN","MMRSCRE3",138,0)
 S LRRSLT="^",TMPRSLT=""
"RTN","MMRSCRE3",139,0)
 I $G(DFN)=""!($G(LRMDRO)="")!($G(LRSTART)="")!($G(LREND)="") Q LRRSLT
"RTN","MMRSCRE3",140,0)
 ;GET CH RSLTS
"RTN","MMRSCRE3",141,0)
 I MDROETIO D
"RTN","MMRSCRE3",142,0)
 .S TMPRSLT=$$GETMI(DFN,LRMDRO,LRSTART,LREND,LRDTTYP)
"RTN","MMRSCRE3",143,0)
 I TSTSTP D
"RTN","MMRSCRE3",144,0)
 .S LRTST=0 F  S LRTST=$O(^TMP($J,"MMRSCRE","T",LRMDRO,LRTST)) Q:'LRTST  D
"RTN","MMRSCRE3",145,0)
 .S SUBS=$$GET1^DIQ(60,+LRTST,4,"I")
"RTN","MMRSCRE3",146,0)
 .I SUBS="CH" S TMPRSLT=$$GETCH(DFN,LRMDRO,LRTST,LRSTART,LREND,LRDTTYP)
"RTN","MMRSCRE3",147,0)
 Q TMPRSLT
"RTN","MMRSCRE3",148,0)
 ;
"RTN","MMRSCRE3",149,0)
GETCH(DFN,LRMDRO,LRTST,LRSTART,LREND,LRDTTYP,MRSA) ;RETURN YES^RESULT
"RTN","MMRSCRE3",150,0)
 N LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD
"RTN","MMRSCRE3",151,0)
 S LRRSLT="^"
"RTN","MMRSCRE3",152,0)
 S LRDFN=$$LRDFN^LR7OR1(DFN)
"RTN","MMRSCRE3",153,0)
 Q:'LRDFN LRRSLT
"RTN","MMRSCRE3",154,0)
 S LRDATE=LRSTART-.0000001
"RTN","MMRSCRE3",155,0)
 I LRDTTYP="RAD" S LRDATE=0,LRRADEND=LREND,LREND=9999999
"RTN","MMRSCRE3",156,0)
 F  S LRDATE=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE)) Q:'LRDATE!(LRDATE>LREND)  D
"RTN","MMRSCRE3",157,0)
 .Q:LRDATE>ENDDT
"RTN","MMRSCRE3",158,0)
 .Q:LRDATE<STRTDT
"RTN","MMRSCRE3",159,0)
 .S DAS=0 F  S DAS=$O(^PXRMINDX(63,"PI",DFN,+LRTST,LRDATE,DAS)) Q:'DAS  D
"RTN","MMRSCRE3",160,0)
 ..S LRIDT=$P(DAS,";",3)
"RTN","MMRSCRE3",161,0)
 ..I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3) I LRRAD<LRSTART!(LRRAD>LRRADEND) Q
"RTN","MMRSCRE3",162,0)
 ..Q:LRDATE<STRTDT
"RTN","MMRSCRE3",163,0)
 ..Q:LRDATE>ENDDT
"RTN","MMRSCRE3",164,0)
 ..Q:$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,3)=""
"RTN","MMRSCRE3",165,0)
 ..;GET ORDER NUMBER FROM ORUT MODE
"RTN","MMRSCRE3",166,0)
 ..S LRSITE=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,5)
"RTN","MMRSCRE3",167,0)
 ..;Q:$$SCRNTOP(LRSITE,LRMDRO)
"RTN","MMRSCRE3",168,0)
 ..;I $D(^LR(LRDFN,"CH",LRIDT,0)),$P(^LR(LRDFN,"CH",LRIDT,0),U,3) D
"RTN","MMRSCRE3",169,0)
 ..S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSCRE3",170,0)
 ..S TSTRSLT=$$CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST)
"RTN","MMRSCRE3",171,0)
 ..I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSCRE3",172,0)
 ..I ($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT) D
"RTN","MMRSCRE3",173,0)
 ...S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";CH")
"RTN","MMRSCRE3",174,0)
 ...S LIEN=LRIDT_","_LRDFN_","
"RTN","MMRSCRE3",175,0)
 ...S SRCE=$$GET1^DIQ(63.04,LIEN,.05,"E")
"RTN","MMRSCRE3",176,0)
 ...S LRRSLT=LRRSLT_"^"_$G(SRCE)
"RTN","MMRSCRE3",177,0)
 Q LRRSLT
"RTN","MMRSCRE3",178,0)
 ;
"RTN","MMRSCRE3",179,0)
GETMI(DFN,LRMDRO,LRSTART,LREND,LRDTTYP) ;RETURN YES^RESULT
"RTN","MMRSCRE3",180,0)
 N LRRSLT,LRDFN,LRDATE,LRRADEND,DAS,LRIDT,LRSITE,TSTRSLT,LRRAD,LRIEND,CNTR
"RTN","MMRSCRE3",181,0)
 S LRRSLT="^",CNTR=0
"RTN","MMRSCRE3",182,0)
 I '$D(^TMP($J,"MMRSCRE","BACT",ORG,"INC_REMARK")),'$D(^TMP($J,"MMRSCRE","ETIOL",ORG)) Q LRRSLT
"RTN","MMRSCRE3",183,0)
 S LRDFN=$$LRDFN^LR7OR1(DFN)
"RTN","MMRSCRE3",184,0)
 Q:'LRDFN LRRSLT
"RTN","MMRSCRE3",185,0)
 S LRIDT=(9999999-LREND)-.0000001
"RTN","MMRSCRE3",186,0)
 S LRIEND=9999999-STRTDT
"RTN","MMRSCRE3",187,0)
 I LRDTTYP="RAD" S LRIDT=0,LRIEND=99999999
"RTN","MMRSCRE3",188,0)
 S (PFLG,DONE)=0
"RTN","MMRSCRE3",189,0)
 F  S LRIDT=$O(^LR(LRDFN,"MI",LRIDT)) Q:'LRIDT!(LRIDT>LRIEND)  D  Q:DONE
"RTN","MMRSCRE3",190,0)
 .I LRDTTYP="RAD" S LRRAD=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,3) I LRRAD<LRSTART!(LRRAD>LREND) Q
"RTN","MMRSCRE3",191,0)
 .S LRSITE=$P($G(^LR(LRDFN,"MI",LRIDT,0)),U,5)
"RTN","MMRSCRE3",192,0)
 .S $P(LRRSLT,"^",1)="Y"
"RTN","MMRSCRE3",193,0)
 .S TSTRSLT=$$MIRSLT(LRDFN,LRIDT,ORG)
"RTN","MMRSCRE3",194,0)
 .I $P($G(^LR(LRDFN,"MI",LRIDT,1)),U,2)="P" S PFLG=1
"RTN","MMRSCRE3",195,0)
 .I TSTRSLT="",$P(LRRSLT,"^")="Y" D
"RTN","MMRSCRE3",196,0)
 ..S LIEN=LRIDT_","_LRDFN_","
"RTN","MMRSCRE3",197,0)
 ..S SRCE=$$GET1^DIQ(63.05,LIEN,.05,"I")
"RTN","MMRSCRE3",198,0)
 ..S TSTRSLT="NEG",$P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";MI")
"RTN","MMRSCRE3",199,0)
 ..S LRRSLT=LRRSLT_"^"_$G(SRCE)_"^"_LRSTART,DONE=1 Q
"RTN","MMRSCRE3",200,0)
 .I TSTRSLT["POS",(($P(LRRSLT,"^",2)="")!($P($P(LRRSLT,"^",2),";",3)>LRIDT)) D
"RTN","MMRSCRE3",201,0)
 ..S $P(LRRSLT,"^",2)=(TSTRSLT_";"_LRDFN_";"_LRIDT_";MI")
"RTN","MMRSCRE3",202,0)
 ..I $G(DATA)'="" S MOVMENT=$P(DATA,U,4)
"RTN","MMRSCRE3",203,0)
 ..S DSCHMOV=$$GET1^DIQ(405,MOVMENT,.17,"I")
"RTN","MMRSCRE3",204,0)
 ..S DSCHRGE=$$GET1^DIQ(405,DSCHMOV,.01,"I")
"RTN","MMRSCRE3",205,0)
 ..S LIEN=LRIDT_","_LRDFN_","
"RTN","MMRSCRE3",206,0)
 ..S SRCE=$$GET1^DIQ(63.05,LIEN,.05,"I")
"RTN","MMRSCRE3",207,0)
 ..S COLDT=$$GET1^DIQ(63.05,LIEN,.01,"I")
"RTN","MMRSCRE3",208,0)
 ..I DSCHRGE>INDT,COLDT>DSCHRGE S LRRSLT="^" Q
"RTN","MMRSCRE3",209,0)
 ..S LRRSLT=LRRSLT_"^"_$G(SRCE)_"^"_LRSTART
"RTN","MMRSCRE3",210,0)
 ..I COLDT<LRSTART!(COLDT>ENDDT) S LRRSLT="^",TSTRSLT=LRRSLT Q
"RTN","MMRSCRE3",211,0)
 ..S CNTR=$G(CNTR)+1
"RTN","MMRSCRE3",212,0)
 ..S STOP=0
"RTN","MMRSCRE3",213,0)
 ..S RLOC=$$GET1^DIQ(63.05,LIEN,.111,"I")
"RTN","MMRSCRE3",214,0)
 ..S DIVLOC=$$GET1^DIQ(44,+RLOC,3.5,"E")
"RTN","MMRSCRE3",215,0)
 ..;Q:DIVLOC'=LOC
"RTN","MMRSCRE3",216,0)
 ..;S RLOC=$$GET1^DIQ(44,+RLOC,.01,"E")
"RTN","MMRSCRE3",217,0)
 ..S RLOC=$$GET1^DIQ(63.05,LIEN,.111,"I"),RLOC=+RLOC,RLOC=$$GET1^DIQ(44,RLOC,.01,"E")
"RTN","MMRSCRE3",218,0)
 ..I $G(RLOC)=ORDLOC,$G(CNTR)'>1,'$D(^MMRS(104,MDIV,61,"B",SRCE)) S DONE=1,STOP=1 Q
"RTN","MMRSCRE3",219,0)
 ..I $G(RLOC)=ORDLOC,$G(CNTR)'>1 M TMPDATA(DFN)=LRRSLT S LRRSLT="^" Q
"RTN","MMRSCRE3",220,0)
 ..I $G(RLOC)=ORDLOC,$G(CNTR)>1,'$D(^MMRS(104,MDIV,61,"B",SRCE)) D  Q
"RTN","MMRSCRE3",221,0)
 ...K TMPDATA S DONE=1 Q
"RTN","MMRSCRE3",222,0)
 ..Q:STOP
"RTN","MMRSCRE3",223,0)
 ..Q:DONE
"RTN","MMRSCRE3",224,0)
 ..I $G(RLOC)'=ORDLOC S MOVMENT=$P(DATA,"^",4)
"RTN","MMRSCRE3",225,0)
 ..I $G(MOVMENT)>0 D
"RTN","MMRSCRE3",226,0)
 ...S WRDLOC=$$GET1^DIQ(405,MOVMENT,.06,"E")
"RTN","MMRSCRE3",227,0)
 ...I WRDLOC=ORDLOC,$G(CNTR)'>1,'$D(^MMRS(104,MDIV,61,"B",SRCE)) S DONE=1 Q
"RTN","MMRSCRE3",228,0)
 ...I WRDLOC=ORDLOC,$G(CNTR)'>1 M TMPDATA(DFN)=LRRSLT S LRRSLT="^"
"RTN","MMRSCRE3",229,0)
 ...I WRDLOC=ORDLOC,$G(CNTR)>1,'$D(^MMRS(104,MDIV,61,"B",SRCE)) D
"RTN","MMRSCRE3",230,0)
 ....K TMPDATA S DONE=1 Q
"RTN","MMRSCRE3",231,0)
 ...I WRDLOC'=ORDLOC S (TSTRSLT,LRRSLT)="^"
"RTN","MMRSCRE3",232,0)
 I $D(TMPDATA(DFN)) M LRRSLT=TMPDATA(DFN)
"RTN","MMRSCRE3",233,0)
 Q LRRSLT
"RTN","MMRSCRE3",234,0)
 ;
"RTN","MMRSCRE3",235,0)
CHRSLT(LRDFN,LRIDT,LRMDRO,LRTST) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSCRE3",236,0)
 N RESULT,LRLOC,LRND,LRPC,LRRES,LRIND,LRINDVAL,LRSPEC,LRLOW,LRHIG
"RTN","MMRSCRE3",237,0)
 S RESULT=""
"RTN","MMRSCRE3",238,0)
 S LRLOC=$P($G(^LAB(60,+LRTST,0)),U,5)
"RTN","MMRSCRE3",239,0)
 S LRND=$P(LRLOC,";",2) Q:+LRND'>0 RESULT
"RTN","MMRSCRE3",240,0)
 S LRPC=$P(LRLOC,";",3) Q:+LRPC'>0 RESULT
"RTN","MMRSCRE3",241,0)
 S LRRES=$P($G(^LR(LRDFN,"CH",LRIDT,LRND)),U,LRPC) Q:LRRES="" RESULT
"RTN","MMRSCRE3",242,0)
 S LRIND=$P($G(^TMP($J,"MMRSCRE","T",LRMDRO,LRTST,0)),U,1)
"RTN","MMRSCRE3",243,0)
 S LRINDVAL=$P($G(^TMP($J,"MMRSCRE","T",LRMDRO,LRTST,0)),U,2)
"RTN","MMRSCRE3",244,0)
 Q:LRIND="" RESULT
"RTN","MMRSCRE3",245,0)
 I LRIND=1 D  Q RESULT
"RTN","MMRSCRE3",246,0)
 .Q:'LRRES
"RTN","MMRSCRE3",247,0)
 .S LRSPEC=$P($G(^LR(LRDFN,"CH",LRIDT,0)),U,5) Q:LRSPEC=""
"RTN","MMRSCRE3",248,0)
 .Q:'$D(^LAB(60,LRTST,1,LRSPEC,0))
"RTN","MMRSCRE3",249,0)
 .S LRLOW=$P(^LAB(60,LRTST,1,LRSPEC,0),U,2),LRHIG=$P(^LAB(60,LRTST,1,LRSPEC,0),U,3)
"RTN","MMRSCRE3",250,0)
 .Q:'LRLOW!('LRHIG)
"RTN","MMRSCRE3",251,0)
 .I LRRES<LRLOW!(LRRES>LRHIG) S RESULT="POS" Q
"RTN","MMRSCRE3",252,0)
 I LRINDVAL="" Q RESULT
"RTN","MMRSCRE3",253,0)
 S LRRES=$$UP^XLFSTR(LRRES),LRINDVAL=$$UP^XLFSTR(LRINDVAL)
"RTN","MMRSCRE3",254,0)
 I LRIND=2,(LRRES[LRINDVAL) Q "POS"
"RTN","MMRSCRE3",255,0)
 I LRIND=3,(LRRES>LRINDVAL) Q "POS"
"RTN","MMRSCRE3",256,0)
 I LRIND=4,(LRRES<LRINDVAL) Q "POS"
"RTN","MMRSCRE3",257,0)
 I LRIND=5,(LRRES=LRINDVAL) Q "POS"
"RTN","MMRSCRE3",258,0)
 Q RESULT
"RTN","MMRSCRE3",259,0)
MIRSLT(LRDFN,LRIDT,LRMDRO) ;RETURNS 'POS' OR NULL STRING (IF NOT POSITIVE)
"RTN","MMRSCRE3",260,0)
 N RESULT,LRETND,LRETI,LRANTI,LRANTIND,LRANTINV,LRAND,LRRES,BACTRPT,RPTRMRK,LRANTIEN
"RTN","MMRSCRE3",261,0)
 S RESULT=""
"RTN","MMRSCRE3",262,0)
 ;Check Etiology
"RTN","MMRSCRE3",263,0)
 I $D(^TMP($J,"MMRSCRE","ETIOL",LRMDRO)) D  Q:RESULT="POS" RESULT
"RTN","MMRSCRE3",264,0)
 .S LRETND=0 F  S LRETND=$O(^LR(LRDFN,"MI",LRIDT,3,LRETND)) Q:'LRETND!(RESULT="POS")  D
"RTN","MMRSCRE3",265,0)
 ..S LRETI=$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,0)),U)
"RTN","MMRSCRE3",266,0)
 ..Q:+LRETI'>0
"RTN","MMRSCRE3",267,0)
 ..I ('$O(^TMP($J,"MMRSCRE","ETIOL",LRMDRO,LRETI,0))) D  Q
"RTN","MMRSCRE3",268,0)
 ...I $D(^TMP($J,"MMRSCRE","ETIOL",LRMDRO,LRETI)) S RESULT="POS"
"RTN","MMRSCRE3",269,0)
 ..S LRANTI=0 F  S LRANTI=$O(^TMP($J,"MMRSCRE","ETIOL",LRMDRO,LRETI,LRANTI)) Q:'LRANTI  D
"RTN","MMRSCRE3",270,0)
 ...S LRANTIEN=$P(^TMP($J,"MMRSCRE","ETIOL",LRMDRO,LRETI,LRANTI),U,1)
"RTN","MMRSCRE3",271,0)
 ...S LRANTIND=$P(^TMP($J,"MMRSCRE","ETIOL",LRMDRO,LRETI,LRANTI),U,2)
"RTN","MMRSCRE3",272,0)
 ...S LRANTINV=$P(^TMP($J,"MMRSCRE","ETIOL",LRMDRO,LRETI,LRANTI),U,3)
"RTN","MMRSCRE3",273,0)
 ...;S LRAND=$P($G(^LAB(62.06,LRANTI,0)),U,2) Q:LRAND=""
"RTN","MMRSCRE3",274,0)
 ...S LRAND=$$ABDN^LRPXAPIU(LRANTIEN) Q:'LRAND
"RTN","MMRSCRE3",275,0)
 ...Q:$P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2)=""
"RTN","MMRSCRE3",276,0)
 ...Q:$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2),1,1))="S"
"RTN","MMRSCRE3",277,0)
 ...I LRANTIND=""!(LRANTINV="") Q
"RTN","MMRSCRE3",278,0)
 ...;S LRRES=$$UP^XLFSTR($E($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2),1,1))
"RTN","MMRSCRE3",279,0)
 ...S LRRES=$$UP^XLFSTR($P($G(^LR(LRDFN,"MI",LRIDT,3,LRETND,LRAND)),U,2))
"RTN","MMRSCRE3",280,0)
 ...S LRANTINV=$$UP^XLFSTR(LRANTINV)
"RTN","MMRSCRE3",281,0)
 ...S LRANTIND=$$UP^XLFSTR(LRANTIND)
"RTN","MMRSCRE3",282,0)
 ...I LRANTIND=1,(LRRES[LRANTINV) S RESULT="POS" Q
"RTN","MMRSCRE3",283,0)
 ...I LRANTIND=2,(LRRES>LRANTINV) S RESULT="POS" Q
"RTN","MMRSCRE3",284,0)
 ...I LRANTIND=3,(LRRES<LRANTINV) S RESULT="POS" Q
"RTN","MMRSCRE3",285,0)
 ...I LRANTIND=4,(LRRES=LRANTINV) S RESULT="POS" Q
"RTN","MMRSCRE3",286,0)
 Q:RESULT="POS" "POS"
"RTN","MMRSCRE3",287,0)
 ;Check Bacteriology Report Remarks
"RTN","MMRSCRE3",288,0)
 I '$D(^TMP($J,"MMRSCRE","BACT",LRMDRO,"INC_REMARK")) Q RESULT
"RTN","MMRSCRE3",289,0)
 S BACTRPT=0 F  S BACTRPT=$O(^LR(LRDFN,"MI",LRIDT,4,BACTRPT)) Q:'BACTRPT!(RESULT="POS")  D
"RTN","MMRSCRE3",290,0)
 .S RPTRMRK=$P($G(^LR(LRDFN,"MI",LRIDT,4,BACTRPT,0)),U,1)
"RTN","MMRSCRE3",291,0)
 .Q:RPTRMRK=""
"RTN","MMRSCRE3",292,0)
 .I $$BACTRPT(LRMDRO,"INC_REMARK",RPTRMRK)&('$$BACTRPT(LRMDRO,"EXC_REMARK",RPTRMRK)) S RESULT="POS"
"RTN","MMRSCRE3",293,0)
 Q RESULT
"RTN","MMRSCRE3",294,0)
 ;
"RTN","MMRSCRE3",295,0)
SCRNTOP(LRSITE,LRMDRO) ;CHECK TO SEE IF SCREEN ON SITE
"RTN","MMRSCRE3",296,0)
 Q:+LRSITE'>0 0
"RTN","MMRSCRE3",297,0)
 I $D(^TMP($J,"MMRSCRE","TOP",LRMDRO,"INC_TOP"))&$D(^TMP($J,"MMRSCRE","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSCRE3",298,0)
 I '$D(^TMP($J,"MMRSCRE","TOP",LRMDRO,"INC_TOP"))&'$D(^TMP($J,"MMRSCRE","TOP",LRMDRO,"EXC_TOP")) Q 0
"RTN","MMRSCRE3",299,0)
 I ($D(^TMP($J,"MMRSCRE","TOP",LRMDRO,"INC_TOP")))&($D(^TMP($J,"MMRSCRE","TOP",LRMDRO,"INC_TOP",LRSITE))) Q 0
"RTN","MMRSCRE3",300,0)
 I ($D(^TMP($J,"MMRSCRE","TOP",LRMDRO,"EXC_TOP")))&('$D(^TMP($J,"MMRSCRE","TOP",LRMDRO,"EXC_TOP",LRSITE))) Q 0
"RTN","MMRSCRE3",301,0)
 Q 1
"RTN","MMRSCRE3",302,0)
BACTRPT(LRMDRO,RPTTYPE,RPTRMRK) ;Is this comment contained in the parameters
"RTN","MMRSCRE3",303,0)
 N RESULT,MMRSI,LRINDVAL
"RTN","MMRSCRE3",304,0)
 S RESULT=0
"RTN","MMRSCRE3",305,0)
 S MMRSI=0 F  S MMRSI=$O(^TMP($J,"MMRSCRE","BACT",LRMDRO,RPTTYPE,MMRSI)) Q:'MMRSI!(RESULT=1)  D
"RTN","MMRSCRE3",306,0)
 .S LRINDVAL=$G(^TMP($J,"MMRSCRE","BACT",LRMDRO,RPTTYPE,MMRSI))
"RTN","MMRSCRE3",307,0)
 .I ($$UP^XLFSTR(RPTRMRK))[($$UP^XLFSTR(LRINDVAL)) S RESULT=1
"RTN","MMRSCRE3",308,0)
 Q RESULT
"RTN","MMRSCRE4")
0^15^B34859922^n/a
"RTN","MMRSCRE4",1,0)
MMRSCRE4 ;TCK/LEIDOS - Print CRE Report Cont. (Contains functions to print report) ; 11/29/16 1:33pm
"RTN","MMRSCRE4",2,0)
 ;;1.0;MDRO PROGRAM TOOLS;**4**;JUN 01, 2016;Build 130
"RTN","MMRSCRE4",3,0)
 ;
"RTN","MMRSCRE4",4,0)
PRINT ;Prints report data
"RTN","MMRSCRE4",5,0)
 N PG,MMRSNOW,NUMLOCS,LOCNAME,LN,PREVLOC,INDATE,DFN,OUTDATE,DATA
"RTN","MMRSCRE4",6,0)
 S PG=0
"RTN","MMRSCRE4",7,0)
 S MMRSNOW=$$NOW^XLFDT()
"RTN","MMRSCRE4",8,0)
 S NUMLOCS=0
"RTN","MMRSCRE4",9,0)
 S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSCRE","D",LOCNAME)) Q:LOCNAME=""  S NUMLOCS=NUMLOCS+1
"RTN","MMRSCRE4",10,0)
 I PRTSUM S RPTYP="SUMMARY"
"RTN","MMRSCRE4",11,0)
 I 'PRTSUM S RPTYP="DETAILED"
"RTN","MMRSCRE4",12,0)
 S LOCNAME="" F  S LOCNAME=$O(^TMP($J,"MMRSCRE","D",LOCNAME)) Q:LOCNAME=""  D
"RTN","MMRSCRE4",13,0)
 .I '$D(DIVARY(LOCNAME)) K DIVARY(LOCNAME) Q
"RTN","MMRSCRE4",14,0)
 .I $D(DIVARY(LOCNAME)) K DIVARY(LOCNAME)
"RTN","MMRSCRE4",15,0)
 .Q:$G(LOCNAME)=""
"RTN","MMRSCRE4",16,0)
 .D PATDAYS^MMRSCRE
"RTN","MMRSCRE4",17,0)
 .D PRTSUMA(LOCNAME)
"RTN","MMRSCRE4",18,0)
 S $P(LN,"-",165)=""
"RTN","MMRSCRE4",19,0)
 Q:'$D(DIVARY)
"RTN","MMRSCRE4",20,0)
 S DVSN="" F  S DVSN=$O(DIVARY(DVSN)) Q:DVSN=""  D
"RTN","MMRSCRE4",21,0)
 .Q:$G(DVSN)=""
"RTN","MMRSCRE4",22,0)
 .S LOC=DVSN
"RTN","MMRSCRE4",23,0)
 .D PRTHDRD
"RTN","MMRSCRE4",24,0)
 .W !!!,"NO RECORDS FOUND FOR REPORTING PERIOD."
"RTN","MMRSCRE4",25,0)
 .W !!!
"RTN","MMRSCRE4",26,0)
 W !!,"END OF REPORT"
"RTN","MMRSCRE4",27,0)
 Q
"RTN","MMRSCRE4",28,0)
PRINTADM(LOC) ; Print cont.
"RTN","MMRSCRE4",29,0)
 S $P(LN,"-",165)=""
"RTN","MMRSCRE4",30,0)
 D PRTHDRD
"RTN","MMRSCRE4",31,0)
 N NODE,IN,WRD,PTN,L4,IND,ADT,MMV,SRC,SC,CC,VAL,INC
"RTN","MMRSCRE4",32,0)
 S IN=""
"RTN","MMRSCRE4",33,0)
 Q:LOC=""
"RTN","MMRSCRE4",34,0)
 I '$D(^TMP($J,"MMRSCRE","DETAIL",LOC)) D  Q
"RTN","MMRSCRE4",35,0)
 .W !!!,"NO RECORDS FOUND FOR REPORTING PERIOD."
"RTN","MMRSCRE4",36,0)
 F  S IN=$O(^TMP($J,"MMRSCRE","DETAIL",LOC,IN)) Q:IN=""  D
"RTN","MMRSCRE4",37,0)
 .S NODE=^TMP($J,"MMRSCRE","DETAIL",LOC,IN)
"RTN","MMRSCRE4",38,0)
 .S WRD=$P(NODE,"^"),PTN=$P(NODE,"^",2),L4=$P(NODE,"^",3)
"RTN","MMRSCRE4",39,0)
 .S IND=$P(NODE,"^",4),ADT=$P(NODE,"^",5),MMV=$P(NODE,"^",6)
"RTN","MMRSCRE4",40,0)
 .S SRC=$P(NODE,"^",7),SRC=$$GET1^DIQ(61,SRC,.01,"E")
"RTN","MMRSCRE4",41,0)
 .S SC=$P(NODE,"^",8),CC=$P(NODE,"^",9)
"RTN","MMRSCRE4",42,0)
 .S VAL=$P(NODE,"^",10) I VAL="Y" S VAL="POS"
"RTN","MMRSCRE4",43,0)
 .S DTTE=$P(IND,"."),TIM=$P(IND,".",2),TIM=$E(TIM,1,4)
"RTN","MMRSCRE4",44,0)
 .S IND=DTTE_"."_TIM,IND=$$FMTE^XLFDT(IND)
"RTN","MMRSCRE4",45,0)
 .S WD="",WD=$O(^DIC(42,"B",WRD,WD))
"RTN","MMRSCRE4",46,0)
 .I $G(WD)'="" S SPCTY=$$GET1^DIQ(42,WD,.017,"E")
"RTN","MMRSCRE4",47,0)
 .Q:$G(VAL)=""
"RTN","MMRSCRE4",48,0)
 .W !,WRD,?21,$G(SPCTY),?46,PTN,?70,L4,?77,IND,?97,ADT,?109,MMV,?122,SRC,?131,SC,?145,CC,?157,VAL
"RTN","MMRSCRE4",49,0)
 .I $Y+1>IOSL,LOC'="" D PRTHDRD
"RTN","MMRSCRE4",50,0)
 Q
"RTN","MMRSCRE4",51,0)
PRTHDRD ;
"RTN","MMRSCRE4",52,0)
 S PG=PG+1
"RTN","MMRSCRE4",53,0)
 W @IOF
"RTN","MMRSCRE4",54,0)
 S $P(LN,"-",165)=""
"RTN","MMRSCRE4",55,0)
 W ?13,"CRE ACUTE CARE IPEC REPORT - "_RPTYP
"RTN","MMRSCRE4",56,0)
 W !,?13,"Division: ",LOC
"RTN","MMRSCRE4",57,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSCRE4",58,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSCRE4",59,0)
 W !!
"RTN","MMRSCRE4",60,0)
 Q:PRTSUM
"RTN","MMRSCRE4",61,0)
 W ?77,"DATE",?111,"MAS MOVE",?131,"SURVEILLANCE",?145,"CLINICAL",?157,"CULTURE"
"RTN","MMRSCRE4",62,0)
 W !,"WARD",?21,"SERVICE",?46,"PATIENT",?70,"LAST4",?77,"ENTERED WARD",?97,"ADT",?111,"TYPE",?122,"SOURCE",?131,"CULTURE",?145,"CULTURE",?157,"RESULT"
"RTN","MMRSCRE4",63,0)
 W !,LN
"RTN","MMRSCRE4",64,0)
 ;S PG=PG+1
"RTN","MMRSCRE4",65,0)
 Q
"RTN","MMRSCRE4",66,0)
PRTSUMA(LOC) ;
"RTN","MMRSCRE4",67,0)
 N II,L
"RTN","MMRSCRE4",68,0)
 W @IOF
"RTN","MMRSCRE4",69,0)
 S PG=$G(PG)+1
"RTN","MMRSCRE4",70,0)
 W ?13,"CRE ACUTE CARE IPEC REPORT - "_RPTYP
"RTN","MMRSCRE4",71,0)
 I $G(LOC)'="" W !,?13,"Division: ",LOC
"RTN","MMRSCRE4",72,0)
 I $G(LOC)="" W !,?13,"Divisions: " D  Q
"RTN","MMRSCRE4",73,0)
 .S II=1 S L="" F  S L=$O(^TMP($J,"MMRSCRE","DSUM",L)) Q:L=""  W:II>1&($X>37) ", " W L_"," S II=II+1 I $X>110 W !,?37
"RTN","MMRSCRE4",74,0)
 W !,?13,"Report period: ",$$FMTE^XLFDT(STRTDT)," to ",$$FMTE^XLFDT(ENDDT)
"RTN","MMRSCRE4",75,0)
 W !,?13,"Report printed on: ",$$FMTE^XLFDT(MMRSNOW),?70,"PAGE: ",PG
"RTN","MMRSCRE4",76,0)
 I $G(LOC)'="" S DATA=$G(^TMP($J,"MMRSCRE","DSUM",LOC))
"RTN","MMRSCRE4",77,0)
 I $G(LOC)="" S DATA=$G(^TMP($J,"MMRSCRE","DSUM"))
"RTN","MMRSCRE4",78,0)
 I $G(LOC)'="" S DATA1=$G(^TMP($J,"MMRSCREPD","DSUM",LOC))
"RTN","MMRSCRE4",79,0)
 I $G(LOC)="" S DATA1=$G(^TMP($J,"MMRSCREPD","DSUM"))
"RTN","MMRSCRE4",80,0)
 W !!,"Basic Measures and Device Days of Care"
"RTN","MMRSCRE4",81,0)
 W !,?3,"01 Total # of admissions to the acute care inpatient facility for the period: ",$P(DATA,"^")
"RTN","MMRSCRE4",82,0)
 W !,?3,"02 Total # of bed days of care for acute care for the period: ",DATA1
"RTN","MMRSCRE4",83,0)
 W !!,"Admission Prevalence Measures (Facility/Division Wide)"
"RTN","MMRSCRE4",84,0)
 W !,?3,"07 # of (01) with surveillance screens for CRE/CPE collected upon admission: ",$P(DATA,U,2)
"RTN","MMRSCRE4",85,0)
 W !,?3,"08 # of (07) that were positive for CRE/CPE based on surveillance screen: ",$P(DATA,U,3)
"RTN","MMRSCRE4",86,0)
 W !,?3,"09 # of (01) that were positive for CRE/CPE based on clinical cultures: ",$P(DATA,"^",4)
"RTN","MMRSCRE4",87,0)
 S (POS,CC,SC,SCPCT,CCPCT)=0
"RTN","MMRSCRE4",88,0)
 S TOTAL=$P(DATA,"^")
"RTN","MMRSCRE4",89,0)
 S TSC=$P(DATA,"^",2)
"RTN","MMRSCRE4",90,0)
 S SCPOS=$P(DATA,"^",3)
"RTN","MMRSCRE4",91,0)
 S CC=$P(DATA,"^",4)
"RTN","MMRSCRE4",92,0)
 I SCPOS=0 S SCPCT=0
"RTN","MMRSCRE4",93,0)
 I SCPOS>0 D
"RTN","MMRSCRE4",94,0)
 .I SCPOS=TSC S SCPCT=100 Q
"RTN","MMRSCRE4",95,0)
 .I SCPOS<TOTAL S SCPCT=(SCPOS/TSC)*100
"RTN","MMRSCRE4",96,0)
 .I SCPCT>0 D
"RTN","MMRSCRE4",97,0)
 ..I SCPCT["." D
"RTN","MMRSCRE4",98,0)
 ...S SPCT=$P(SCPCT,"."),SCDEC=$P(SCPCT,".",2),SCDEC=$E(SCDEC,1,2)
"RTN","MMRSCRE4",99,0)
 ...S SCPCT=SPCT_"."_SCDEC
"RTN","MMRSCRE4",100,0)
 ;I CC<TOTAL S CCPCT=(CC/TOTAL)*100
"RTN","MMRSCRE4",101,0)
 I CC=0 S CCPCT=0
"RTN","MMRSCRE4",102,0)
 I CC>0 D
"RTN","MMRSCRE4",103,0)
 .I CC=TOTAL S CCPCT=100 Q
"RTN","MMRSCRE4",104,0)
 .I CC<TOTAL S CCPCT=(CC/TOTAL)*100
"RTN","MMRSCRE4",105,0)
 .I CCPCT["." D
"RTN","MMRSCRE4",106,0)
 ..S PCT=$P(CCPCT,"."),CCDEC=$P(CCPCT,".",2),CCDEC=$E(CCDEC,1,2)
"RTN","MMRSCRE4",107,0)
 ..S CCPCT=PCT_"."_CCDEC
"RTN","MMRSCRE4",108,0)
 W !,?3,"10 % of (01) that were positive for CRE/CPE based on surveillance screening: ",$G(SCPCT)_"%"
"RTN","MMRSCRE4",109,0)
 W !,?3,"11 % of (01) that were positive for CRE/CPE based on clinical cultures: ",$G(CCPCT)_"%"
"RTN","MMRSCRE4",110,0)
 W !!,"Incidence Measures: Healthcare-Associated Colonized Cases"
"RTN","MMRSCRE4",111,0)
 W !,?3,"12 # of patients with screens for CRE/CPE collected 3 or more days after admission: ",$P(DATA,U,5)
"RTN","MMRSCRE4",112,0)
 W !,?3,"13 # of (12) that were positive for CRE/CPE based on surveillance screen collected 3 or more days after admission: ",$P(DATA,U,6)
"RTN","MMRSCRE4",113,0)
 W !,?3,"14 # of patients with clinical cultures positive for CRE/CPE 3 or more days after admission: ",$P(DATA,U,7)
"RTN","MMRSCRE4",114,0)
 S RATE=0
"RTN","MMRSCRE4",115,0)
 I DATA1>0 D
"RTN","MMRSCRE4",116,0)
 .S T=$P(DATA,U,6)+$P(DATA,U,7)
"RTN","MMRSCRE4",117,0)
 .I T>0 S RATE=(T/DATA1)*1000
"RTN","MMRSCRE4",118,0)
 .I RATE>0&(RATE[".") D
"RTN","MMRSCRE4",119,0)
 ..S RTE=$P(RATE,"."),RTDEC=$P(RATE,".",2),RTDEC=$E(RTDEC,1,2)
"RTN","MMRSCRE4",120,0)
 ..S RATE=RTE_"."_RTDEC
"RTN","MMRSCRE4",121,0)
 ;I $L(RATE)=1 S RA
"RTN","MMRSCRE4",122,0)
 W !,?3,"15 Rate of healthcare-associated colonized cases: ",$G(RATE)
"RTN","MMRSCRE4",123,0)
 W !!,"Infection Prevention and Control Measures"
"RTN","MMRSCRE4",124,0)
 W !,?3,"33 # of cases with CRE/CPE for the period: ",$P(DATA,U,8)
"RTN","MMRSCRE4",125,0)
 ;I PRTSUM W !!!,"END OF REPORT." Q
"RTN","MMRSCRE4",126,0)
 I 'PRTSUM D PRINTADM(LOCNAME)
"RTN","MMRSCRE4",127,0)
 I '$D(DIVARY) W !!!,"END OF REPORT"
"RTN","MMRSCRE4",128,0)
 Q
"RTN","MMRSCRE4",129,0)
 ;
"RTN","MMRSIPCP")
0^16^B45727414^B27513898
"RTN","MMRSIPCP",1,0)
MMRSIPCP ;MIA/LMT/TCK - SETUP MDRO TOOLS SOFTWARE PARAMETERS ; 10/27/16 1:45pm
"RTN","MMRSIPCP",2,0)
 ;;1.0;MRSA PROGRAM TOOLS;**1,3,4**;Mar 22, 2009;Build 130
"RTN","MMRSIPCP",3,0)
 ;
"RTN","MMRSIPCP",4,0)
DIV ;Add a division and setup business rules
"RTN","MMRSIPCP",5,0)
 N DIC,X,DINUM,DLAYGO,MMRSDIV,DIR,DIE,DA,DR,DIDEL,Y
"RTN","MMRSIPCP",6,0)
 S DIC="^MMRS(104,"
"RTN","MMRSIPCP",7,0)
 S DIC(0)="AELMQ"
"RTN","MMRSIPCP",8,0)
 S DIC("A")="Select MRSA Site Parameters Division: "
"RTN","MMRSIPCP",9,0)
 S DLAYGO=104
"RTN","MMRSIPCP",10,0)
 D ^DIC
"RTN","MMRSIPCP",11,0)
 K DLAYGO
"RTN","MMRSIPCP",12,0)
 I $D(DTOUT)!($D(DUOUT))!(Y=-1) S EXTFLG=1 Q
"RTN","MMRSIPCP",13,0)
 S MMRSDIV=+Y
"RTN","MMRSIPCP",14,0)
 W !!
"RTN","MMRSIPCP",15,0)
 ;RECEIVING UNIT SCREEN
"RTN","MMRSIPCP",16,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",17,0)
 S DIR("A")="1. Receiving unit screen on unit-to-unit transfers"
"RTN","MMRSIPCP",18,0)
 S DIR(0)="104,1"
"RTN","MMRSIPCP",19,0)
 D ^DIR
"RTN","MMRSIPCP",20,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",21,0)
 S DIE="^MMRS(104,"
"RTN","MMRSIPCP",22,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",23,0)
 S Y=+$P(Y,U,1)
"RTN","MMRSIPCP",24,0)
 S DR="1////"_Y
"RTN","MMRSIPCP",25,0)
 I Y=1!(Y=0) D ^DIE
"RTN","MMRSIPCP",26,0)
 ;DISCHARGING UNIT SCREEN
"RTN","MMRSIPCP",27,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",28,0)
 S DIR("A")="2. Discharging unit screen on unit-to-unit transfers"
"RTN","MMRSIPCP",29,0)
 S DIR(0)="104,2"
"RTN","MMRSIPCP",30,0)
 D ^DIR
"RTN","MMRSIPCP",31,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",32,0)
 S DIE="^MMRS(104,"
"RTN","MMRSIPCP",33,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",34,0)
 S Y=+$P(Y,U,1)
"RTN","MMRSIPCP",35,0)
 S DR="2////"_Y
"RTN","MMRSIPCP",36,0)
 I Y=1!(Y=0) D ^DIE
"RTN","MMRSIPCP",37,0)
 ;SCREEN POS ON TRANSFER IN
"RTN","MMRSIPCP",38,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",39,0)
 S DIR("A")="3. Screen patients with MRSA history on transfer-in"
"RTN","MMRSIPCP",40,0)
 S DIR(0)="104,3"
"RTN","MMRSIPCP",41,0)
 D ^DIR
"RTN","MMRSIPCP",42,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",43,0)
 S DIE="^MMRS(104,"
"RTN","MMRSIPCP",44,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",45,0)
 S Y=+$P(Y,U,1)
"RTN","MMRSIPCP",46,0)
 S DR="3////"_Y
"RTN","MMRSIPCP",47,0)
 I Y=1!(Y=0) D ^DIE
"RTN","MMRSIPCP",48,0)
 ;SCREEN POS ON DISCHARGE
"RTN","MMRSIPCP",49,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",50,0)
 S DIR("A")="4. Screen patients with MRSA history on discharge/death/transfer-out"
"RTN","MMRSIPCP",51,0)
 S DIR(0)="104,4"
"RTN","MMRSIPCP",52,0)
 D ^DIR
"RTN","MMRSIPCP",53,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",54,0)
 S DIE="^MMRS(104,"
"RTN","MMRSIPCP",55,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",56,0)
 S Y=+$P(Y,U,1)
"RTN","MMRSIPCP",57,0)
 S DR="4////"_Y
"RTN","MMRSIPCP",58,0)
 I Y=1!(Y=0) D ^DIE
"RTN","MMRSIPCP",59,0)
 Q
"RTN","MMRSIPCP",60,0)
 ;
"RTN","MMRSIPCP",61,0)
FLESPC ;
"RTN","MMRSIPCP",62,0)
 ;Add a division and setup business rules
"RTN","MMRSIPCP",63,0)
 N DIC,X,DINUM,DLAYGO,MMRSDIV,DIR,DIE,DA,DR,DIDEL,Y
"RTN","MMRSIPCP",64,0)
 S DIC="^MMRS(104,"
"RTN","MMRSIPCP",65,0)
 S DIC(0)="AELMQ"
"RTN","MMRSIPCP",66,0)
 S DIC("A")="Select CRE Site Parameters Division: "
"RTN","MMRSIPCP",67,0)
 S DLAYGO=104
"RTN","MMRSIPCP",68,0)
 D ^DIC
"RTN","MMRSIPCP",69,0)
 K DLAYGO
"RTN","MMRSIPCP",70,0)
 I $D(DTOUT)!($D(DUOUT))!(Y=-1) S EXTFLG=1 Q
"RTN","MMRSIPCP",71,0)
 S MMRSDIV=+Y
"RTN","MMRSIPCP",72,0)
 W !!
"RTN","MMRSIPCP",73,0)
 ;ADD SURVEILLANCE SCREEN SPECIMENS
"RTN","MMRSIPCP",74,0)
 N STID,STNM,SIEN
"RTN","MMRSIPCP",75,0)
 S DIR(0)="YA",DIR("A")="Do you want to Add or Edit specimen(s) for CRE Surveillance Screens"
"RTN","MMRSIPCP",76,0)
 S DIR(0)="S^A:ADD;E:EDIT"
"RTN","MMRSIPCP",77,0)
 S DIR("B")="E"
"RTN","MMRSIPCP",78,0)
 D ^DIR
"RTN","MMRSIPCP",79,0)
 Q:X=""!($D(DIRUT))!($D(DIROUT))
"RTN","MMRSIPCP",80,0)
 ;I $D(DIRUT) S EXTFLG=1 Q
"RTN","MMRSIPCP",81,0)
 I Y Q
"RTN","MMRSIPCP",82,0)
 S STOP=0
"RTN","MMRSIPCP",83,0)
 N DIC,DLAYGO,DTOUT,DUOUT,EXTFLG
"RTN","MMRSIPCP",84,0)
 S EXTFLG=0
"RTN","MMRSIPCP",85,0)
 G:Y="A" ADD
"RTN","MMRSIPCP",86,0)
 ;
"RTN","MMRSIPCP",87,0)
DEL ;
"RTN","MMRSIPCP",88,0)
 S EXTFLG=0
"RTN","MMRSIPCP",89,0)
 W !
"RTN","MMRSIPCP",90,0)
 S DA(1)=MMRSDIV
"RTN","MMRSIPCP",91,0)
 K DIR S DIR("A")="Select Specimen to delete"
"RTN","MMRSIPCP",92,0)
 S DIR("?")="Enter the specimen you want to edit"
"RTN","MMRSIPCP",93,0)
 S DIR(0)="PO^MMRS(104,DA(1),61,:QEMO"
"RTN","MMRSIPCP",94,0)
 D ^DIR
"RTN","MMRSIPCP",95,0)
 I Y["^" D
"RTN","MMRSIPCP",96,0)
 .S DA(1)=MMRSDIV
"RTN","MMRSIPCP",97,0)
 .S DA=$P(Y,"^")
"RTN","MMRSIPCP",98,0)
 .S DIK="^MMRS(104,"_DA(1)_",61,"
"RTN","MMRSIPCP",99,0)
 .D ^DIK
"RTN","MMRSIPCP",100,0)
 I $P(Y,"^",2)'="" G DEL
"RTN","MMRSIPCP",101,0)
 K DIK,DA
"RTN","MMRSIPCP",102,0)
 Q
"RTN","MMRSIPCP",103,0)
 ;
"RTN","MMRSIPCP",104,0)
ADD ;
"RTN","MMRSIPCP",105,0)
 K DIR S DIR("A")="Select Specimen"
"RTN","MMRSIPCP",106,0)
 S DIR(0)="P^61:QEM"
"RTN","MMRSIPCP",107,0)
 S DA(1)=MMRSDIV
"RTN","MMRSIPCP",108,0)
 D ^DIR
"RTN","MMRSIPCP",109,0)
 I (Y=-1)!($D(DTOUT))!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",110,0)
 S X=$P(Y,"^"),VAL=X
"RTN","MMRSIPCP",111,0)
 I $D(^MMRS(104,"AC",DA(1),X)) D  G FLESPC
"RTN","MMRSIPCP",112,0)
 .W !!!!,$P(Y,"^",2)_" already exists." H 1 Q
"RTN","MMRSIPCP",113,0)
 S IEN="?+1,"_DA(1)_","
"RTN","MMRSIPCP",114,0)
 S LRFDA(61,104.0216061,IEN,.01)=VAL
"RTN","MMRSIPCP",115,0)
 D UPDATE^DIE("","LRFDA(61)","","LRMSG")
"RTN","MMRSIPCP",116,0)
 I 'EXTFLG G FLESPC
"RTN","MMRSIPCP",117,0)
 Q
"RTN","MMRSIPCP",118,0)
 ;
"RTN","MMRSIPCP",119,0)
 ;
"RTN","MMRSIPCP",120,0)
LAB ;Entry to setup the Lab Search/Extract Parameters
"RTN","MMRSIPCP",121,0)
 N EXTFLG,MMRSDIV,MDRO,DA,DO,DIC,DINUM,X,Y,DDSFILE,DR,DDSPAGE,DDSPARAM,DIR
"RTN","MMRSIPCP",122,0)
 D CHECK^MMRSIPC
"RTN","MMRSIPCP",123,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPCP",124,0)
 W !
"RTN","MMRSIPCP",125,0)
 S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSIPCP",126,0)
 W !
"RTN","MMRSIPCP",127,0)
 S MDRO=$$GETMDRO Q:$D(EXTFLG)
"RTN","MMRSIPCP",128,0)
 W !
"RTN","MMRSIPCP",129,0)
 S DIR(0)="Y",DIR("B")="YES",DIR("A")="Do you want to see a description for "_$$GET1^DIQ(104.2,MDRO,.01)
"RTN","MMRSIPCP",130,0)
 D ^DIR
"RTN","MMRSIPCP",131,0)
 I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",132,0)
 I Y=1 D
"RTN","MMRSIPCP",133,0)
 .N DIC,DA,DR,DIQ,DIR
"RTN","MMRSIPCP",134,0)
 .W @IOF
"RTN","MMRSIPCP",135,0)
 .S DIC="^MMRS(104.2,"
"RTN","MMRSIPCP",136,0)
 .S DA=MDRO
"RTN","MMRSIPCP",137,0)
 .S DR=2
"RTN","MMRSIPCP",138,0)
 .D EN^DIQ
"RTN","MMRSIPCP",139,0)
 .S DIR(0)="E",DIR("A")="Enter RETURN to continue" D ^DIR
"RTN","MMRSIPCP",140,0)
 W !
"RTN","MMRSIPCP",141,0)
 S DA=$O(^MMRS(104.1,"C",MMRSDIV,MDRO,0))
"RTN","MMRSIPCP",142,0)
 I 'DA D  Q:$D(EXTFLG)!('DA)
"RTN","MMRSIPCP",143,0)
 .K DA
"RTN","MMRSIPCP",144,0)
 .S DIC="^MMRS(104.1,"
"RTN","MMRSIPCP",145,0)
 .S DIC(0)="F"
"RTN","MMRSIPCP",146,0)
 .S X=MDRO
"RTN","MMRSIPCP",147,0)
 .S DIC("DR")="1////"_MMRSDIV
"RTN","MMRSIPCP",148,0)
 .D FILE^DICN
"RTN","MMRSIPCP",149,0)
 .I Y=-1 S EXTFLG=1 Q
"RTN","MMRSIPCP",150,0)
 .S DA=+Y
"RTN","MMRSIPCP",151,0)
 S DDSFILE="^MMRS(104.1,"
"RTN","MMRSIPCP",152,0)
 S DR="[MMRSLABPARAM]"
"RTN","MMRSIPCP",153,0)
 D ^DDS
"RTN","MMRSIPCP",154,0)
 Q
"RTN","MMRSIPCP",155,0)
GETMDRO() ;
"RTN","MMRSIPCP",156,0)
 N MDRO,DIC,DLAYGO,DINUM,Y,DLAYGO,X,DTOUT,DUOUT
"RTN","MMRSIPCP",157,0)
 S MDRO=""
"RTN","MMRSIPCP",158,0)
 S DIC="^MMRS(104.2,"
"RTN","MMRSIPCP",159,0)
 S DIC(0)="AEMNQ"
"RTN","MMRSIPCP",160,0)
 S DIC("A")="Select the MDRO: "
"RTN","MMRSIPCP",161,0)
 D ^DIC K DIC
"RTN","MMRSIPCP",162,0)
 I $D(DTOUT)!($D(DUOUT))!(Y=-1) S EXTFLG=1 Q ""
"RTN","MMRSIPCP",163,0)
 S MDRO=+Y
"RTN","MMRSIPCP",164,0)
 Q MDRO
"RTN","MMRSIPCP",165,0)
WARDMAP ;Entry to setup the Ward Mappings
"RTN","MMRSIPCP",166,0)
 N MMRSDIV,DIC,Y,DLAYGO,DINUM,X,DTOUT,DUOUT,DDSFILE,DR,DA,DDSPAGE,DDSPARAM,EXTFLG,DIE,DIDEL,MMRSDA
"RTN","MMRSIPCP",167,0)
 D CHECK^MMRSIPC
"RTN","MMRSIPCP",168,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPCP",169,0)
 W !
"RTN","MMRSIPCP",170,0)
 S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSIPCP",171,0)
 F  Q:$D(EXTFLG)  D
"RTN","MMRSIPCP",172,0)
 .S DIC="^MMRS(104.3,"
"RTN","MMRSIPCP",173,0)
 .S DIC(0)="AELMQ"
"RTN","MMRSIPCP",174,0)
 .S DIC("A")="Select Geographical Unit: "
"RTN","MMRSIPCP",175,0)
 .S DIC("DR")="1////"_MMRSDIV_";3;4"
"RTN","MMRSIPCP",176,0)
 .S DLAYGO=104.3
"RTN","MMRSIPCP",177,0)
 .W !! D ^DIC
"RTN","MMRSIPCP",178,0)
 .K DLAYGO
"RTN","MMRSIPCP",179,0)
 .I $D(DTOUT)!($D(DUOUT))!(Y=-1) S EXTFLG=1 Q
"RTN","MMRSIPCP",180,0)
 .S MMRSDA=+Y
"RTN","MMRSIPCP",181,0)
 .I '$P(Y,U,3) D
"RTN","MMRSIPCP",182,0)
 ..S DIE="^MMRS(104.3,"
"RTN","MMRSIPCP",183,0)
 ..S DA=MMRSDA
"RTN","MMRSIPCP",184,0)
 ..S DR=".01;3;4"
"RTN","MMRSIPCP",185,0)
 ..S DIDEL=104.3
"RTN","MMRSIPCP",186,0)
 ..W !
"RTN","MMRSIPCP",187,0)
 ..D ^DIE
"RTN","MMRSIPCP",188,0)
 ..I $D(DTOUT)!('$D(DA)) S EXTFLG=1 Q
"RTN","MMRSIPCP",189,0)
 .Q:$D(EXTFLG)
"RTN","MMRSIPCP",190,0)
 .S DDSFILE="^MMRS(104.3,"
"RTN","MMRSIPCP",191,0)
 .S DR="[MMRSMRSA WARD MAP]"
"RTN","MMRSIPCP",192,0)
 .S DA=MMRSDA
"RTN","MMRSIPCP",193,0)
 .D ^DDS
"RTN","MMRSIPCP",194,0)
 .W @IOF
"RTN","MMRSIPCP",195,0)
 Q
"RTN","MMRSIPCP",196,0)
HISTDAY ;Historical Days Edit
"RTN","MMRSIPCP",197,0)
 N EXTFLG,MMRSDIV,MDRO,DA,DO,DIC,DINUM,X,Y,DIR,NUMDAY,MMRSX,DIE,DR,DIDEL,DIRUT,DTOUT,DUOUT
"RTN","MMRSIPCP",198,0)
 D CHECK^MMRSIPC
"RTN","MMRSIPCP",199,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPCP",200,0)
 W ! S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSIPCP",201,0)
 W !
"RTN","MMRSIPCP",202,0)
 S MDRO=0 F  S MDRO=$O(^MMRS(104.2,MDRO)) Q:'MDRO  D  Q:$D(EXTFLG)
"RTN","MMRSIPCP",203,0)
 .S DA=$O(^MMRS(104.2,MDRO,1,"B",MMRSDIV,0))
"RTN","MMRSIPCP",204,0)
 .I 'DA D  Q:$D(EXTFLG)!('DA)
"RTN","MMRSIPCP",205,0)
 ..K DA
"RTN","MMRSIPCP",206,0)
 ..S DIC="^MMRS(104.2,"_MDRO_",1,"
"RTN","MMRSIPCP",207,0)
 ..S DIC(0)="F"
"RTN","MMRSIPCP",208,0)
 ..S DA(1)=MDRO
"RTN","MMRSIPCP",209,0)
 ..S X=MMRSDIV
"RTN","MMRSIPCP",210,0)
 ..D FILE^DICN
"RTN","MMRSIPCP",211,0)
 ..I Y=-1 S EXTFLG=1 Q
"RTN","MMRSIPCP",212,0)
 ..S DA=+Y
"RTN","MMRSIPCP",213,0)
 .S DA(1)=MDRO
"RTN","MMRSIPCP",214,0)
 .S DIR(0)="104.22,1^AO"
"RTN","MMRSIPCP",215,0)
 .S DIR("PRE")="I X=""@"" S X=9876 S MMRSX=9876"
"RTN","MMRSIPCP",216,0)
 .S DIR("A")="Enter the number of days to search for "_$P($G(^MMRS(104.2,MDRO,0)),U,1)
"RTN","MMRSIPCP",217,0)
 .D ^DIR
"RTN","MMRSIPCP",218,0)
 .I $D(DTOUT)!($D(DUOUT)) S EXTFLG=1 Q
"RTN","MMRSIPCP",219,0)
 .I Y D
"RTN","MMRSIPCP",220,0)
 ..S DIE="^MMRS(104.2,"_MDRO_",1,"
"RTN","MMRSIPCP",221,0)
 ..I $G(MMRSX)'=9876 S DR="1////"_+Y
"RTN","MMRSIPCP",222,0)
 ..I Y=9876,($G(MMRSX)=9876) S DR="1////@"
"RTN","MMRSIPCP",223,0)
 ..K MMRSX
"RTN","MMRSIPCP",224,0)
 ..D ^DIE
"RTN","MMRSIPCP",225,0)
 W !
"RTN","MMRSIPCP",226,0)
 Q
"RTN","MMRSIPCP",227,0)
ISLTORD ;Entry to setup the Isolation Orders Parameters
"RTN","MMRSIPCP",228,0)
 N EXTFLG,MMRSDIV,DA,DDSFILE,DR,DDSPAGE,DDSPARAM
"RTN","MMRSIPCP",229,0)
 D CHECK^MMRSIPC
"RTN","MMRSIPCP",230,0)
 I $D(EXTFLG) W ! H 2 Q
"RTN","MMRSIPCP",231,0)
 W !
"RTN","MMRSIPCP",232,0)
 S MMRSDIV=$$GETDIV^MMRSIPC Q:$D(EXTFLG)!(MMRSDIV="")
"RTN","MMRSIPCP",233,0)
 W !
"RTN","MMRSIPCP",234,0)
 S DA=MMRSDIV
"RTN","MMRSIPCP",235,0)
 S DDSFILE="^MMRS(104,"
"RTN","MMRSIPCP",236,0)
 S DR="[MMRSISLTORD]"
"RTN","MMRSIPCP",237,0)
 D ^DDS
"RTN","MMRSIPCP",238,0)
 Q
"RTN","MMRSP4")
0^11^B634304^n/a
"RTN","MMRSP4",1,0)
MMRSP4 ;LEIDOS/TCK - Post install to change 9.4 ; 7/22/16 9:05am
"RTN","MMRSP4",2,0)
 ;;1.0;MDRO TOOLS REPORTS MENU;**4**;Mar 22, 2009;Build 130
"RTN","MMRSP4",3,0)
 ;
"RTN","MMRSP4",4,0)
 Q
"RTN","MMRSP4",5,0)
 ;
"RTN","MMRSP4",6,0)
EN ;
"RTN","MMRSP4",7,0)
 N FDA,SB
"RTN","MMRSP4",8,0)
 I '$D(^DIC(9.4,"B","MRSA INITIATIVE REPORTS")) Q
"RTN","MMRSP4",9,0)
 I $D(^DIC(9.4,"B","MRSA INITIATIVE REPORTS")) D
"RTN","MMRSP4",10,0)
 .S SB="",SB=$O(^DIC(9.4,"B","MRSA INITIATIVE REPORTS",SB))
"RTN","MMRSP4",11,0)
 .I $G(SB)>0 S SB=SB_",",FDA(1,9.4,SB,.01)="MDRO INITIATIVE REPORTS"
"RTN","MMRSP4",12,0)
 .D UPDATE^DIE("","FDA(1)","SB","LRMSG")
"RTN","MMRSP4",13,0)
 Q
"SEC","^DIC",104,104,0,"AUDIT")
@
"SEC","^DIC",104,104,0,"DD")
@
"SEC","^DIC",104,104,0,"DEL")
@
"SEC","^DIC",104,104,0,"LAYGO")
@
"SEC","^DIC",104,104,0,"RD")
@
"SEC","^DIC",104,104,0,"WR")
@
"SEC","^DIC",104.1,104.1,0,"AUDIT")

"SEC","^DIC",104.1,104.1,0,"DD")

"SEC","^DIC",104.1,104.1,0,"DEL")

"SEC","^DIC",104.1,104.1,0,"LAYGO")

"SEC","^DIC",104.1,104.1,0,"RD")

"SEC","^DIC",104.1,104.1,0,"WR")

"SEC","^DIC",104.2,104.2,0,"AUDIT")
@
"SEC","^DIC",104.2,104.2,0,"DD")
@
"SEC","^DIC",104.2,104.2,0,"DEL")
@
"SEC","^DIC",104.2,104.2,0,"LAYGO")
@
"SEC","^DIC",104.2,104.2,0,"RD")
@
"SEC","^DIC",104.2,104.2,0,"WR")
@
"SEC","^DIC",104.3,104.3,0,"AUDIT")

"SEC","^DIC",104.3,104.3,0,"DD")

"SEC","^DIC",104.3,104.3,0,"DEL")

"SEC","^DIC",104.3,104.3,0,"LAYGO")

"SEC","^DIC",104.3,104.3,0,"RD")

"SEC","^DIC",104.3,104.3,0,"WR")

"VER")
8.0^22.0
"^DD",104,104,0)
FIELD^^216061^7
"^DD",104,104,0,"DDA")
N
"^DD",104,104,0,"DT")
3160825
"^DD",104,104,0,"IX","AB",104.0216061,.01)

"^DD",104,104,0,"IX","AC",104.0216061,.01)

"^DD",104,104,0,"IX","B",104,.01)

"^DD",104,104,0,"NM","MDRO SITE PARAMETERS")

"^DD",104,104,0,"PT",104.1,1)

"^DD",104,104,0,"PT",104.22,.01)

"^DD",104,104,0,"PT",104.3,1)

"^DD",104,104,0,"VRPK")
MMRS
"^DD",104,104,.01,0)
DIVISION^RP40.8'^DG(40.8,^0;1^Q
"^DD",104,104,.01,1,0)
^.1
"^DD",104,104,.01,1,1,0)
104^B
"^DD",104,104,.01,1,1,1)
S ^MMRS(104,"B",$E(X,1,30),DA)=""
"^DD",104,104,.01,1,1,2)
K ^MMRS(104,"B",$E(X,1,30),DA)
"^DD",104,104,.01,3)
Enter the division the parameters are for.
"^DD",104,104,.01,21,0)
^^1^1^3081028^
"^DD",104,104,.01,21,1,0)
This field contains the division the parameters are defined for.
"^DD",104,104,.01,"DT")
3081028
"^DD",104,104,1,0)
RECEIVING UNIT SCREEN^S^0:NO;1:YES;^0;2^Q
"^DD",104,104,1,3)
Enter 'Yes' if at your site the admitting (or receiving) unit screens patients on unit-to-unit transfers.
"^DD",104,104,1,21,0)
^^2^2^3090304^
"^DD",104,104,1,21,1,0)
This field should be set to 'Yes' if at your site the admitting (or 
"^DD",104,104,1,21,2,0)
receiving) unit screens patients on unit-to-unit transfers.
"^DD",104,104,1,"DT")
3090304
"^DD",104,104,2,0)
DISCHARGING UNIT SCREEN^S^0:NO;1:YES;^0;3^Q
"^DD",104,104,2,3)
Enter 'Yes' if at your site the discharging unit screens patients on unit-to-unit transfers.
"^DD",104,104,2,21,0)
^^2^2^3081028^
"^DD",104,104,2,21,1,0)
This field should be set to 'Yes' if at your site the discharging unit 
"^DD",104,104,2,21,2,0)
screens patients on unit-to-unit transfers.
"^DD",104,104,2,"DT")
3081028
"^DD",104,104,3,0)
SCREEN POS ON TRANSFER IN^S^0:NO;1:YES;^0;4^Q
"^DD",104,104,3,3)
Enter 'Yes' if at your site you are screening all patients on transfers into the unit, regardless of MRSA status.
"^DD",104,104,3,21,0)
^^4^4^3090304^
"^DD",104,104,3,21,1,0)
This field should be set to 'Yes' if at your site you are screening all 
"^DD",104,104,3,21,2,0)
patients on transfers into the unit, regardless of MRSA status. This field
"^DD",104,104,3,21,3,0)
should be set to 'No' if you only screen patients not known to be infected
"^DD",104,104,3,21,4,0)
and/or colonized with MRSA on transfers into the unit.
"^DD",104,104,3,"DT")
3090304
"^DD",104,104,4,0)
SCREEN POS ON DISCHARGE^S^0:NO;1:YES;^0;5^Q
"^DD",104,104,4,3)
Enter 'Yes' if at your site you are screening patients on discharge, death, or transfer out from the unit, regardless of MRSA status.
"^DD",104,104,4,21,0)
^^7^7^3090316^
"^DD",104,104,4,21,1,0)
This field should be set to 'Yes' if at your site you are screening 
"^DD",104,104,4,21,2,0)
patients on discharge, death, or transfer out from the unit, regardless of
"^DD",104,104,4,21,3,0)
MRSA status.
"^DD",104,104,4,21,4,0)
 
"^DD",104,104,4,21,5,0)
This field should be set to 'No' if you only screen patients not known to
"^DD",104,104,4,21,6,0)
be infected and/or colonized with MRSA on discharge, death, or transfer
"^DD",104,104,4,21,7,0)
out from the unit.
"^DD",104,104,4,"DT")
3090316
"^DD",104,104,5,0)
ISOLATION ORDERS^104.05PA^^1;0
"^DD",104,104,216061,0)
SPECIMEN^104.0216061P^^61;0
"^DD",104,104,216061,21,0)
^^1^1^3161116^
"^DD",104,104,216061,21,1,0)
This subfile contains specimen(s) for each division.
"^DD",104,104.0216061,0)
SPECIMEN SUB-FIELD^^.01^1
"^DD",104,104.0216061,0,"DT")
3160825
"^DD",104,104.0216061,0,"IX","B",104.0216061,.01)

"^DD",104,104.0216061,0,"NM","SPECIMEN")

"^DD",104,104.0216061,0,"UP")
104
"^DD",104,104.0216061,.01,0)
SPECIMEN^MP61'^LAB(61,^0;1^Q
"^DD",104,104.0216061,.01,1,0)
^.1
"^DD",104,104.0216061,.01,1,1,0)
104.0216061^B
"^DD",104,104.0216061,.01,1,1,1)
S ^MMRS(104,DA(1),61,"B",$E(X,1,30),DA)=""
"^DD",104,104.0216061,.01,1,1,2)
K ^MMRS(104,DA(1),61,"B",$E(X,1,30),DA)
"^DD",104,104.0216061,.01,1,2,0)
104^AB
"^DD",104,104.0216061,.01,1,2,1)
S ^MMRS(104,"AB",$E(X,1,30),DA(1),DA)=""
"^DD",104,104.0216061,.01,1,2,2)
K ^MMRS(104,"AB",$E(X,1,30),DA(1),DA)
"^DD",104,104.0216061,.01,1,2,"%D",0)
^^1^1^3161117^
"^DD",104,104.0216061,.01,1,2,"%D",1,0)
This cross reference is on the entire file by specimen - division
"^DD",104,104.0216061,.01,1,2,"DT")
3160825
"^DD",104,104.0216061,.01,1,3,0)
104^AC^MUMPS
"^DD",104,104.0216061,.01,1,3,1)
S ^MMRS(104,"AC",DA(1),$E(X,1,30),DA)=""
"^DD",104,104.0216061,.01,1,3,2)
K ^MMRS(104,"AC",DA(1),$E(X,1,30),DA)
"^DD",104,104.0216061,.01,1,3,"%D",0)
^^2^2^3161117^
"^DD",104,104.0216061,.01,1,3,"%D",1,0)
This cross reference is on the entire file sorted by division, specimen, 
"^DD",104,104.0216061,.01,1,3,"%D",2,0)
IEN.
"^DD",104,104.0216061,.01,1,3,"DT")
3160825
"^DD",104,104.0216061,.01,3)
Select the specimen to be associated with this division.
"^DD",104,104.0216061,.01,21,0)
^.001^1^1^3161116^^
"^DD",104,104.0216061,.01,21,1,0)
 This field contains the specimens mapped to this particular institution.
"^DD",104,104.0216061,.01,"DT")
3160825
"^DD",104,104.05,0)
ISOLATION ORDERS SUB-FIELD^^1^2
"^DD",104,104.05,0,"DT")
3090817
"^DD",104,104.05,0,"IX","B",104.05,.01)

"^DD",104,104.05,0,"NM","ISOLATION ORDERS")

"^DD",104,104.05,0,"UP")
104
"^DD",104,104.05,.01,0)
ISOLATION ORDER^MRP101.43'^ORD(101.43,^0;1^Q
"^DD",104,104.05,.01,1,0)
^.1
"^DD",104,104.05,.01,1,1,0)
104.05^B
"^DD",104,104.05,.01,1,1,1)
S ^MMRS(104,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104,104.05,.01,1,1,2)
K ^MMRS(104,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104,104.05,.01,3)
Enter the isolation orderable item.
"^DD",104,104.05,.01,21,0)
^^1^1^3090304^
"^DD",104,104.05,.01,21,1,0)
The orderable item that is used at your facility for isolation purposes.
"^DD",104,104.05,.01,"DT")
3090304
"^DD",104,104.05,1,0)
EXPANDED PRECAUTION TYPE^S^1:CONTACT PRECAUTIONS;2:CONTACT PRECAUTIONS SPECIAL;3:AIRBORNE INFECTION;4:DROPLET;5:PROTECTIVE ENVIRONMENT;6:ISOLATION ORDER;^0;2^Q
"^DD",104,104.05,1,3)
Enter the expanded precaution type this order is used for.
"^DD",104,104.05,1,21,0)
^.001^1^1^3090302^^^
"^DD",104,104.05,1,21,1,0)
The expanded precaution type this order is used for.
"^DD",104,104.05,1,"DT")
3090817
"^DD",104.1,104.1,0)
FIELD^^5^8
"^DD",104.1,104.1,0,"DDA")
N
"^DD",104.1,104.1,0,"DT")
3160817
"^DD",104.1,104.1,0,"ID",1)
S %I=Y,Y=$S('$D(^(0)):"",$D(^MMRS(104,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(104,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",104.1,104.1,0,"IX","B",104.1,.01)

"^DD",104.1,104.1,0,"IX","D",104.1,1)

"^DD",104.1,104.1,0,"NM","MDRO TOOLS LAB SEARCH/EXTRACT")

"^DD",104.1,104.1,0,"VRPK")
MMRS
"^DD",104.1,104.1,.01,0)
MDRO^RP104.2'^MMRS(104.2,^0;1^Q
"^DD",104.1,104.1,.01,1,0)
^.1
"^DD",104.1,104.1,.01,1,1,0)
104.1^B
"^DD",104.1,104.1,.01,1,1,1)
S ^MMRS(104.1,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.1,.01,1,1,2)
K ^MMRS(104.1,"B",$E(X,1,30),DA)
"^DD",104.1,104.1,.01,3)
Enter the MDRO for the parameters you are defining.
"^DD",104.1,104.1,.01,21,0)
^^2^2^3090226^
"^DD",104.1,104.1,.01,21,1,0)
This is the multi-drug resistant organism (MDRO) for the parameters you 
"^DD",104.1,104.1,.01,21,2,0)
are defining.
"^DD",104.1,104.1,.01,"DT")
3090226
"^DD",104.1,104.1,1,0)
DIVISION^P104'^MMRS(104,^0;2^Q
"^DD",104.1,104.1,1,1,0)
^.1
"^DD",104.1,104.1,1,1,1,0)
104.1^D
"^DD",104.1,104.1,1,1,1,1)
S ^MMRS(104.1,"D",$E(X,1,30),DA)=""
"^DD",104.1,104.1,1,1,1,2)
K ^MMRS(104.1,"D",$E(X,1,30),DA)
"^DD",104.1,104.1,1,1,1,"DT")
3090226
"^DD",104.1,104.1,1,3)
Enter the site that this lab test is defined for.
"^DD",104.1,104.1,1,21,0)
^^1^1^3081028^
"^DD",104.1,104.1,1,21,1,0)
This is the site that this lab test is defined for.
"^DD",104.1,104.1,1,"DT")
3090226
"^DD",104.1,104.1,3,0)
INCLUDED SITES^104.103PA^^1;0
"^DD",104.1,104.1,4,0)
EXCLUDED SITES^104.104PA^^2;0
"^DD",104.1,104.1,5,0)
LAB TEST^104.15PA^^3;0
"^DD",104.1,104.1,7,0)
INCLUDED BACT RPT REMARKS^104.107A^^4;0
"^DD",104.1,104.1,8,0)
EXCLUDED BACT RPT REMARKS^104.108A^^5;0
"^DD",104.1,104.1,9,0)
ETIOLOGY^104.109PA^^6;0
"^DD",104.1,104.103,0)
INCLUDED SITES SUB-FIELD^^.01^1
"^DD",104.1,104.103,0,"DT")
3081028
"^DD",104.1,104.103,0,"IX","B",104.103,.01)

"^DD",104.1,104.103,0,"NM","INCLUDED SITES")

"^DD",104.1,104.103,0,"UP")
104.1
"^DD",104.1,104.103,.01,0)
INCLUDED TOPOGRAPHY^MP61'^LAB(61,^0;1^Q
"^DD",104.1,104.103,.01,1,0)
^.1
"^DD",104.1,104.103,.01,1,1,0)
104.103^B
"^DD",104.1,104.103,.01,1,1,1)
S ^MMRS(104.1,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.103,.01,1,1,2)
K ^MMRS(104.1,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104.1,104.103,.01,3)
Selection of a Topography screens all others out except the ones selected. For "ALL" leave blank. Not to be used in conjunction with the exclude Topography selection.
"^DD",104.1,104.103,.01,21,0)
^.001^2^2^3090227^^
"^DD",104.1,104.103,.01,21,1,0)
This determines what Topography to screen for. Select the appropriate 
"^DD",104.1,104.103,.01,21,2,0)
Topography to include in the extract.
"^DD",104.1,104.103,.01,"DT")
3081124
"^DD",104.1,104.104,0)
EXCLUDED SITES SUB-FIELD^^.01^1
"^DD",104.1,104.104,0,"DT")
3081028
"^DD",104.1,104.104,0,"IX","B",104.104,.01)

"^DD",104.1,104.104,0,"NM","EXCLUDED SITES")

"^DD",104.1,104.104,0,"UP")
104.1
"^DD",104.1,104.104,.01,0)
EXCLUDED TOPOGRAPHY^MP61'^LAB(61,^0;1^Q
"^DD",104.1,104.104,.01,1,0)
^.1
"^DD",104.1,104.104,.01,1,1,0)
104.104^B
"^DD",104.1,104.104,.01,1,1,1)
S ^MMRS(104.1,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.104,.01,1,1,2)
K ^MMRS(104.1,DA(1),2,"B",$E(X,1,30),DA)
"^DD",104.1,104.104,.01,3)
Select the Topography to screen out. Not to be used in conjunction with the Include Topography selection.
"^DD",104.1,104.104,.01,21,0)
^.001^2^2^3090227^^
"^DD",104.1,104.104,.01,21,1,0)
This determines what Topography to screen out. Select the appropriate 
"^DD",104.1,104.104,.01,21,2,0)
Topography to be excluded from the extract.
"^DD",104.1,104.104,.01,"DT")
3081124
"^DD",104.1,104.107,0)
INCLUDED BACT RPT REMARKS SUB-FIELD^^.01^1
"^DD",104.1,104.107,0,"DT")
3090813
"^DD",104.1,104.107,0,"IX","B",104.107,.01)

"^DD",104.1,104.107,0,"NM","INCLUDED BACT RPT REMARKS")

"^DD",104.1,104.107,0,"UP")
104.1
"^DD",104.1,104.107,.01,0)
INCLUDED BACT RPT REMARK^MF^^0;1^K:$L(X)>68!($L(X)<1) X
"^DD",104.1,104.107,.01,1,0)
^.1
"^DD",104.1,104.107,.01,1,1,0)
104.107^B
"^DD",104.1,104.107,.01,1,1,1)
S ^MMRS(104.1,DA(1),4,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.107,.01,1,1,2)
K ^MMRS(104.1,DA(1),4,"B",$E(X,1,30),DA)
"^DD",104.1,104.107,.01,3)
For MI-subscripted tests, enter the text that would denote a positive result, if contained in the Bact Rpt Remarks. Answer must be 1-68 characters in length.
"^DD",104.1,104.107,.01,21,0)
^.001^2^2^3090813^^
"^DD",104.1,104.107,.01,21,1,0)
For MI-subscripted tests, this will be used to determine the criteria that
"^DD",104.1,104.107,.01,21,2,0)
must be contained in the report remarks.
"^DD",104.1,104.107,.01,"DT")
3090813
"^DD",104.1,104.108,0)
EXCLUDED BACT RPT REMARKS SUB-FIELD^^.01^1
"^DD",104.1,104.108,0,"DT")
3090813
"^DD",104.1,104.108,0,"IX","B",104.108,.01)

"^DD",104.1,104.108,0,"NM","EXCLUDED BACT RPT REMARKS")

"^DD",104.1,104.108,0,"UP")
104.1
"^DD",104.1,104.108,.01,0)
EXCLUDED BACT RPT REMARK^MF^^0;1^K:$L(X)>68!($L(X)<1) X
"^DD",104.1,104.108,.01,1,0)
^.1
"^DD",104.1,104.108,.01,1,1,0)
104.108^B
"^DD",104.1,104.108,.01,1,1,1)
S ^MMRS(104.1,DA(1),5,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.108,.01,1,1,2)
K ^MMRS(104.1,DA(1),5,"B",$E(X,1,30),DA)
"^DD",104.1,104.108,.01,3)
For MI-subscripted tests, select the comments that must not be contained in the report remarks. Answer must be 1-68 characters in length.
"^DD",104.1,104.108,.01,21,0)
^^9^9^3090304^
"^DD",104.1,104.108,.01,21,1,0)
For MI-subscripted tests, this determines what comments must not be
"^DD",104.1,104.108,.01,21,2,0)
contained in the report remarks.
"^DD",104.1,104.108,.01,21,3,0)
 
"^DD",104.1,104.108,.01,21,4,0)
This field only needs to be used in cases where the comments used to 
"^DD",104.1,104.108,.01,21,5,0)
denote a positive are also contained in the comments used to denote a 
"^DD",104.1,104.108,.01,21,6,0)
negative. For example, if your site uses 'No MRSA DNA detected' to denote 
"^DD",104.1,104.108,.01,21,7,0)
a MRSA negative, and 'MRSA DNA detected' to denote a MRSA positive. You 
"^DD",104.1,104.108,.01,21,8,0)
would enter 'MRSA DNA detected' in the field Included Bact rpt remark, and
"^DD",104.1,104.108,.01,21,9,0)
'No MRSA DNA detected' in this field.
"^DD",104.1,104.108,.01,"DT")
3090813
"^DD",104.1,104.109,0)
ETIOLOGY SUB-FIELD^^1^2
"^DD",104.1,104.109,0,"DT")
3090108
"^DD",104.1,104.109,0,"IX","B",104.109,.01)

"^DD",104.1,104.109,0,"NM","ETIOLOGY")

"^DD",104.1,104.109,0,"UP")
104.1
"^DD",104.1,104.109,.01,0)
ETIOLOGY^MP61.2'^LAB(61.2,^0;1^Q
"^DD",104.1,104.109,.01,1,0)
^.1
"^DD",104.1,104.109,.01,1,1,0)
104.109^B
"^DD",104.1,104.109,.01,1,1,1)
S ^MMRS(104.1,DA(1),6,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.109,.01,1,1,2)
K ^MMRS(104.1,DA(1),6,"B",$E(X,1,30),DA)
"^DD",104.1,104.109,.01,3)
For MI-subscripted tests, select the Etiology to search for.
"^DD",104.1,104.109,.01,21,0)
^^1^1^3090304^
"^DD",104.1,104.109,.01,21,1,0)
For MI-subscripted tests, this defines the Etiology to search for.
"^DD",104.1,104.109,.01,"DT")
3090304
"^DD",104.1,104.109,1,0)
ANTIMICROBIAL SUSCEPTIBILITY^104.191PA^^1;0
"^DD",104.1,104.15,0)
LAB TEST SUB-FIELD^^2^3
"^DD",104.1,104.15,0,"DT")
3160817
"^DD",104.1,104.15,0,"IX","B",104.15,.01)

"^DD",104.1,104.15,0,"NM","LAB TEST")

"^DD",104.1,104.15,0,"UP")
104.1
"^DD",104.1,104.15,.01,0)
LAB TEST^MR*P60'^LAB(60,^0;1^S DIC("S")="I $P($G(^(0)),U,4)=""CH""" D ^DIC K DIC S DIC=$G(DIE),X=+Y K:Y<0 X
"^DD",104.1,104.15,.01,1,0)
^.1
"^DD",104.1,104.15,.01,1,1,0)
104.15^B
"^DD",104.1,104.15,.01,1,1,1)
S ^MMRS(104.1,DA(1),3,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.15,.01,1,1,2)
K ^MMRS(104.1,DA(1),3,"B",$E(X,1,30),DA)
"^DD",104.1,104.15,.01,3)
Enter the lab test that is to be searched for and retrieved. Only CH subscripted tests should be selected.
"^DD",104.1,104.15,.01,12)
CH subscripts only are selectable.
"^DD",104.1,104.15,.01,12.1)
S DIC("S")="I $P($G(^(0)),U,4)=""CH"""
"^DD",104.1,104.15,.01,"DT")
3160817
"^DD",104.1,104.15,1,0)
INDICATOR^RS^1:Use Reference Ranges;2:Contains;3:Greater Than;4:Less Than;5:Equal To;^0;2^Q
"^DD",104.1,104.15,1,3)
For CH tests, select the code that will determine how to match lab results.
"^DD",104.1,104.15,1,21,0)
^^1^1^3090226^
"^DD",104.1,104.15,1,21,1,0)
For CH tests, this will determine how to match lab results.
"^DD",104.1,104.15,1,"DT")
3090226
"^DD",104.1,104.15,2,0)
INDICATOR VALUE^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",104.1,104.15,2,3)
For CH tests, enter the data to be compared using the INDICATOR field. Answer must be 1-30 characters in length.
"^DD",104.1,104.15,2,21,0)
^^1^1^3090226^
"^DD",104.1,104.15,2,21,1,0)
For CH tests, if the search is conditional this defines the criteria.
"^DD",104.1,104.15,2,"DT")
3090226
"^DD",104.1,104.191,0)
ANTIMICROBIAL SUSCEPTIBILITY SUB-FIELD^^2^3
"^DD",104.1,104.191,0,"DT")
3090108
"^DD",104.1,104.191,0,"IX","B",104.191,.01)

"^DD",104.1,104.191,0,"NM","ANTIMICROBIAL SUSCEPTIBILITY")

"^DD",104.1,104.191,0,"UP")
104.109
"^DD",104.1,104.191,.01,0)
ANTIMICROBIAL SUSCEPTIBILITY^MP62.06'^LAB(62.06,^0;1^Q
"^DD",104.1,104.191,.01,1,0)
^.1
"^DD",104.1,104.191,.01,1,1,0)
104.191^B
"^DD",104.1,104.191,.01,1,1,1)
S ^MMRS(104.1,DA(2),6,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104.1,104.191,.01,1,1,2)
K ^MMRS(104.1,DA(2),6,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104.1,104.191,.01,3)
For MI-subscripted tests, enter the Antimicrobial that will be used in screening out sensitive Etiologies.
"^DD",104.1,104.191,.01,21,0)
^^5^5^3090304^
"^DD",104.1,104.191,.01,21,1,0)
This defines which antimicrobials will be searched for to see if the
"^DD",104.1,104.191,.01,21,2,0)
etiology is resistant to them. If no antimicrobials are specified, then
"^DD",104.1,104.191,.01,21,3,0)
the program will just search for the presence of the etiology, without  
"^DD",104.1,104.191,.01,21,4,0)
searching to see if the etiology is resistant to any of the 
"^DD",104.1,104.191,.01,21,5,0)
antimicrobials.
"^DD",104.1,104.191,.01,"DT")
3090304
"^DD",104.1,104.191,1,0)
INDICATOR^S^1:Contains;2:Greater Than;3:Less Than;4:Equal To;^0;2^Q
"^DD",104.1,104.191,1,3)
Select the code that will determine how to match lab results.
"^DD",104.1,104.191,1,21,0)
^^1^1^3090108^
"^DD",104.1,104.191,1,21,1,0)
This will determine how to match lab results.
"^DD",104.1,104.191,1,"DT")
3090108
"^DD",104.1,104.191,2,0)
INDICATED VALUE^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",104.1,104.191,2,3)
Enter the data to be compared using the INDICATOR field. Answer must be 1-30 characters in length.
"^DD",104.1,104.191,2,21,0)
^^1^1^3090108^
"^DD",104.1,104.191,2,21,1,0)
If the search is conditional this defines the criteria.
"^DD",104.1,104.191,2,"DT")
3090108
"^DD",104.2,104.2,0)
FIELD^^3^4
"^DD",104.2,104.2,0,"DDA")
N
"^DD",104.2,104.2,0,"DT")
3090814
"^DD",104.2,104.2,0,"ID",1)
W "   ",$P(^(0),U,2)
"^DD",104.2,104.2,0,"IX","B",104.2,.01)

"^DD",104.2,104.2,0,"NM","MDRO TYPES")

"^DD",104.2,104.2,0,"PT",104.1,.01)

"^DD",104.2,104.2,0,"VRPK")
MMRS
"^DD",104.2,104.2,.01,0)
ABBREVIATION^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",104.2,104.2,.01,1,0)
^.1
"^DD",104.2,104.2,.01,1,1,0)
104.2^B
"^DD",104.2,104.2,.01,1,1,1)
S ^MMRS(104.2,"B",$E(X,1,30),DA)=""
"^DD",104.2,104.2,.01,1,1,2)
K ^MMRS(104.2,"B",$E(X,1,30),DA)
"^DD",104.2,104.2,.01,3)
Enter the abbreviation for this multi-drug resistant organism. Entries In this file should not be edited. This file will be maintained by the support team. Answer must be 3-30 characters in length.
"^DD",104.2,104.2,.01,21,0)
^^1^1^3081028^
"^DD",104.2,104.2,.01,21,1,0)
This is the abbreviation for the MDRO.
"^DD",104.2,104.2,.01,"DT")
3081028
"^DD",104.2,104.2,1,0)
NAME^F^^0;2^K:$L(X)>80!($L(X)<3) X
"^DD",104.2,104.2,1,3)
Enter the full name of the multi-drug resistant organism. Answer must be 3-80 characters in length.
"^DD",104.2,104.2,1,21,0)
^^1^1^3081028^
"^DD",104.2,104.2,1,21,1,0)
This is the full name of the MDRO.
"^DD",104.2,104.2,1,"DT")
3081028
"^DD",104.2,104.2,2,0)
DIVISION^104.22PA^^1;0
"^DD",104.2,104.2,3,0)
DESCRIPTION^104.23^^2;0
"^DD",104.2,104.22,0)
DIVISION SUB-FIELD^^1^2
"^DD",104.2,104.22,0,"DT")
3090227
"^DD",104.2,104.22,0,"IX","B",104.22,.01)

"^DD",104.2,104.22,0,"NM","DIVISION")

"^DD",104.2,104.22,0,"UP")
104.2
"^DD",104.2,104.22,.01,0)
DIVISION^RP104'^MMRS(104,^0;1^Q
"^DD",104.2,104.22,.01,1,0)
^.1
"^DD",104.2,104.22,.01,1,1,0)
104.22^B
"^DD",104.2,104.22,.01,1,1,1)
S ^MMRS(104.2,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104.2,104.22,.01,1,1,2)
K ^MMRS(104.2,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104.2,104.22,.01,3)
Enter the site that these parameters are defined for.
"^DD",104.2,104.22,.01,21,0)
^.001^1^1^3090227^^^^
"^DD",104.2,104.22,.01,21,1,0)
This is the site the parameters are defined for.
"^DD",104.2,104.22,.01,"DT")
3090227
"^DD",104.2,104.22,1,0)
HISTORICAL DAYS^NJ5,0^^0;2^K:+X'=X!(X>10000)!(X<1)!(X?.E1"."1N.N) X
"^DD",104.2,104.22,1,3)
Enter the number of historical days to display on the isolation report. Type a Number between 1 and 10000, 0 Decimal Digits.
"^DD",104.2,104.22,1,21,0)
^^2^2^3090304^
"^DD",104.2,104.22,1,21,1,0)
The number of historical days to display on the isolation report. Answer 
"^DD",104.2,104.22,1,21,2,0)
must be in days (365 = 12 mos or 1 year; 28 = 4 weeks; 90 = quarter).
"^DD",104.2,104.22,1,"DT")
3090304
"^DD",104.2,104.23,0)
DESCRIPTION SUB-FIELD^^.01^1
"^DD",104.2,104.23,0,"DT")
3090814
"^DD",104.2,104.23,0,"NM","DESCRIPTION")

"^DD",104.2,104.23,0,"UP")
104.2
"^DD",104.2,104.23,.01,0)
DESCRIPTION^Wx^^0;1
"^DD",104.2,104.23,.01,3)
Enter the general description for this MDRO.
"^DD",104.2,104.23,.01,21,0)
^^1^1^3090831^
"^DD",104.2,104.23,.01,21,1,0)
This is the general description for this MDRO.
"^DD",104.2,104.23,.01,"DT")
3090831
"^DD",104.3,104.3,0)
FIELD^^4^5
"^DD",104.3,104.3,0,"DDA")
N
"^DD",104.3,104.3,0,"DT")
3090831
"^DD",104.3,104.3,0,"ID",1)
S %I=Y,Y=$S('$D(^(0)):"",$D(^MMRS(104,+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(104,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",104.3,104.3,0,"ID",3)
W "   ",@("$P($P($C(59)_$S($D(^DD(104.3,3,0)):$P(^(0),U,3),1:0)_$E("_DIC_"Y,0),0),$C(59)_$P(^(0),U,3)_"":"",2),$C(59),1)")
"^DD",104.3,104.3,0,"IX","B",104.3,.01)

"^DD",104.3,104.3,0,"NM","MDRO WARD MAPPINGS")

"^DD",104.3,104.3,0,"VRPK")
MMRS
"^DD",104.3,104.3,.01,0)
NAME^RF^^0;1^K:$L(X)>30!($L(X)<2)!'(X'?1P.E) X
"^DD",104.3,104.3,.01,1,0)
^.1
"^DD",104.3,104.3,.01,1,1,0)
104.3^B
"^DD",104.3,104.3,.01,1,1,1)
S ^MMRS(104.3,"B",$E(X,1,30),DA)=""
"^DD",104.3,104.3,.01,1,1,2)
K ^MMRS(104.3,"B",$E(X,1,30),DA)
"^DD",104.3,104.3,.01,3)
Enter the name of the Geographical Unit you would like to create. Answer must be 2-30 characters in length.
"^DD",104.3,104.3,.01,21,0)
^^2^2^3090304^
"^DD",104.3,104.3,.01,21,1,0)
This is the name of the Geographical Unit. This name will be displayed on 
"^DD",104.3,104.3,.01,21,2,0)
all reports that are run.
"^DD",104.3,104.3,.01,"DT")
3090304
"^DD",104.3,104.3,1,0)
DIVISION^P104'^MMRS(104,^0;2^Q
"^DD",104.3,104.3,1,3)
Enter the site that this mapping is defined for.
"^DD",104.3,104.3,1,21,0)
^^1^1^3081028^
"^DD",104.3,104.3,1,21,1,0)
This is the site that this mapping is defined for.
"^DD",104.3,104.3,1,"DT")
3081028
"^DD",104.3,104.3,2,0)
WARD LOCATIONS^104.302PA^^1;0
"^DD",104.3,104.3,3,0)
TYPE^RS^AC:ACUTE CARE;CLC:CLC;OBS:OBS;OT:OTHER;^0;3^Q
"^DD",104.3,104.3,3,3)
Enter the type of care provided to patients on this unit.
"^DD",104.3,104.3,3,21,0)
^^1^1^3090831^
"^DD",104.3,104.3,3,21,1,0)
This is the type of care provided to patients on this unit.
"^DD",104.3,104.3,3,"DT")
3090831
"^DD",104.3,104.3,4,0)
IPEC UNIT ID^NJ7,0^^0;4^K:+X'=X!(X>1000000)!(X<1)!(X?.E1"."1.N) X
"^DD",104.3,104.3,4,3)
Enter the ID number that identifies this unit in IPEC. This is only for Acute Care and CLC units reported to IPEC. Do NOT assign a Unit ID to any unit that is considered OBS or Other.
"^DD",104.3,104.3,4,21,0)
^^3^3^3090831^
"^DD",104.3,104.3,4,21,1,0)
This is the ID number that identifies this unit in IPEC.  This is only for
"^DD",104.3,104.3,4,21,2,0)
Acute Care and CLC units reported to IPEC. Do NOT assign a Unit ID to any
"^DD",104.3,104.3,4,21,3,0)
unit that is considered OBS or Other.
"^DD",104.3,104.3,4,"DT")
3090831
"^DD",104.3,104.302,0)
WARD LOCATIONS SUB-FIELD^^.01^1
"^DD",104.3,104.302,0,"DT")
3090302
"^DD",104.3,104.302,0,"IX","B",104.302,.01)

"^DD",104.3,104.302,0,"NM","WARD LOCATIONS")

"^DD",104.3,104.302,0,"UP")
104.3
"^DD",104.3,104.302,.01,0)
WARD LOCATION^MRP42'^DIC(42,^0;1^Q
"^DD",104.3,104.302,.01,1,0)
^.1
"^DD",104.3,104.302,.01,1,1,0)
104.302^B
"^DD",104.3,104.302,.01,1,1,1)
S ^MMRS(104.3,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",104.3,104.302,.01,1,1,2)
K ^MMRS(104.3,DA(1),1,"B",$E(X,1,30),DA)
"^DD",104.3,104.302,.01,3)
Enter the ward to be added to this geographical location.
"^DD",104.3,104.302,.01,21,0)
^.001^1^1^3090302^^
"^DD",104.3,104.302,.01,21,1,0)
This is the ward that belongs to this geographical location.
"^DD",104.3,104.302,.01,"DT")
3090302
"^DIC",104,104,0)
MDRO SITE PARAMETERS^104
"^DIC",104,104,0,"GL")
^MMRS(104,
"^DIC",104,104,"%",0)
^1.005^^0
"^DIC",104,104,"%D",0)
^1.001^3^3^3161116^^^^
"^DIC",104,104,"%D",1,0)
This file holds the set of parameters which modify the operation of the 
"^DIC",104,104,"%D",2,0)
MRSA Program Tools to suit the needs of your site. For multi-divisional 
"^DIC",104,104,"%D",3,0)
facilities, each division should have a separate entry in this file.
"^DIC",104,"B","MDRO SITE PARAMETERS",104)

"^DIC",104.1,104.1,0)
MDRO TOOLS LAB SEARCH/EXTRACT^104.1
"^DIC",104.1,104.1,0,"GL")
^MMRS(104.1,
"^DIC",104.1,104.1,"%",0)
^1.005^^0
"^DIC",104.1,104.1,"%D",0)
^1.001^3^3^3160720^^^
"^DIC",104.1,104.1,"%D",1,0)
This file contains search criteria used by the MRSA Program Tools 
"^DIC",104.1,104.1,"%D",2,0)
software. This file should only be edited using the MRSA Tools Lab 
"^DIC",104.1,104.1,"%D",3,0)
Parameter Setup option provided with this software.
"^DIC",104.1,"B","MDRO TOOLS LAB SEARCH/EXTRACT",104.1)

"^DIC",104.2,104.2,0)
MDRO TYPES^104.2
"^DIC",104.2,104.2,0,"GL")
^MMRS(104.2,
"^DIC",104.2,104.2,"%",0)
^1.005^^0
"^DIC",104.2,104.2,"%D",0)
^^3^3^3090304^
"^DIC",104.2,104.2,"%D",1,0)
This file contains the different multi-drug resistant organisms (MDROs)
"^DIC",104.2,104.2,"%D",2,0)
that are needed for the MRSA Program Tools software. Entries in this file
"^DIC",104.2,104.2,"%D",3,0)
should not be edited. This file will be maintained by the support team.
"^DIC",104.2,"B","MDRO TYPES",104.2)

"^DIC",104.3,104.3,0)
MDRO WARD MAPPINGS^104.3
"^DIC",104.3,104.3,0,"GL")
^MMRS(104.3,
"^DIC",104.3,104.3,"%",0)
^1.005^^0
"^DIC",104.3,104.3,"%D",0)
^^6^6^3160720^
"^DIC",104.3,104.3,"%D",1,0)
This file contains the Ward Mappings for the MDRO Program Tools software. 
"^DIC",104.3,104.3,"%D",2,0)
Here you will create 'Geographical Units' which consist of one or more 
"^DIC",104.3,104.3,"%D",3,0)
Ward Locations (from file 42). For purposes of the MDRO Program Tools 
"^DIC",104.3,104.3,"%D",4,0)
software all Ward Locations belonging to the same Geographical unit are 
"^DIC",104.3,104.3,"%D",5,0)
one - and any interward transfers between wards belonging to the same 
"^DIC",104.3,104.3,"%D",6,0)
geographical unit will be ignored.
"^DIC",104.3,"B","MDRO WARD MAPPINGS",104.3)

"BLD",9421,6)
^4
**END**
**END**

