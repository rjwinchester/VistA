Released QAO*3*9 SEQ #8
Extracted from mail message
**KIDS**:QAO*3.0*9^

**INSTALL NAME**
QAO*3.0*9
"BLD",9725,0)
QAO*3.0*9^OCCURRENCE SCREEN^0^3140806^y
"BLD",9725,1,0)
^^8^8^3140806^^
"BLD",9725,1,1,0)
Patch QAO*3*9 addresses 3 issues:
"BLD",9725,1,2,0)
      
"BLD",9725,1,3,0)
       1.  QAOS 107 screen requires VDL documentation change (MAJOR 
"BLD",9725,1,4,0)
           surgery)
"BLD",9725,1,5,0)
       2.  QAOS 101.1 screen not reporting unscheduled 10 day re-
"BLD",9725,1,6,0)
           admissions when scheduled admission occurs on same day
"BLD",9725,1,7,0)
       3.  QAOS 109 screen reporting duplicate death entries, due to
"BLD",9725,1,8,0)
           time of death change
"BLD",9725,4,0)
^9.64PA^^
"BLD",9725,6.3)
4
"BLD",9725,"ABPKG")
n
"BLD",9725,"KRN",0)
^9.67PA^779.2^20
"BLD",9725,"KRN",.4,0)
.4
"BLD",9725,"KRN",.401,0)
.401
"BLD",9725,"KRN",.402,0)
.402
"BLD",9725,"KRN",.403,0)
.403
"BLD",9725,"KRN",.5,0)
.5
"BLD",9725,"KRN",.84,0)
.84
"BLD",9725,"KRN",3.6,0)
3.6
"BLD",9725,"KRN",3.8,0)
3.8
"BLD",9725,"KRN",9.2,0)
9.2
"BLD",9725,"KRN",9.8,0)
9.8
"BLD",9725,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",9725,"KRN",9.8,"NM",1,0)
QAOC0^^0^B6465447
"BLD",9725,"KRN",9.8,"NM",2,0)
QAOC1011^^0^B6114916
"BLD",9725,"KRN",9.8,"NM",3,0)
QAOC109^^0^B4106951
"BLD",9725,"KRN",9.8,"NM","B","QAOC0",1)

"BLD",9725,"KRN",9.8,"NM","B","QAOC1011",2)

"BLD",9725,"KRN",9.8,"NM","B","QAOC109",3)

"BLD",9725,"KRN",19,0)
19
"BLD",9725,"KRN",19,"NM",0)
^9.68A^^
"BLD",9725,"KRN",19.1,0)
19.1
"BLD",9725,"KRN",101,0)
101
"BLD",9725,"KRN",409.61,0)
409.61
"BLD",9725,"KRN",771,0)
771
"BLD",9725,"KRN",779.2,0)
779.2
"BLD",9725,"KRN",870,0)
870
"BLD",9725,"KRN",8989.51,0)
8989.51
"BLD",9725,"KRN",8989.52,0)
8989.52
"BLD",9725,"KRN",8994,0)
8994
"BLD",9725,"KRN","B",.4,.4)

"BLD",9725,"KRN","B",.401,.401)

"BLD",9725,"KRN","B",.402,.402)

"BLD",9725,"KRN","B",.403,.403)

"BLD",9725,"KRN","B",.5,.5)

"BLD",9725,"KRN","B",.84,.84)

"BLD",9725,"KRN","B",3.6,3.6)

"BLD",9725,"KRN","B",3.8,3.8)

"BLD",9725,"KRN","B",9.2,9.2)

"BLD",9725,"KRN","B",9.8,9.8)

"BLD",9725,"KRN","B",19,19)

"BLD",9725,"KRN","B",19.1,19.1)

"BLD",9725,"KRN","B",101,101)

"BLD",9725,"KRN","B",409.61,409.61)

"BLD",9725,"KRN","B",771,771)

"BLD",9725,"KRN","B",779.2,779.2)

"BLD",9725,"KRN","B",870,870)

"BLD",9725,"KRN","B",8989.51,8989.51)

"BLD",9725,"KRN","B",8989.52,8989.52)

"BLD",9725,"KRN","B",8994,8994)

"BLD",9725,"QDEF")
^^^^NO^^^^NO^^YES
"BLD",9725,"QUES",0)
^9.62^^
"BLD",9725,"REQB",0)
^9.611^1^1
"BLD",9725,"REQB",1,0)
QAO*3.0*8^2
"BLD",9725,"REQB","B","QAO*3.0*8",1)

"MBREQ")
0
"PKG",379,-1)
1^1
"PKG",379,0)
OCCURRENCE SCREEN^QAO^OCCURRENCE SCREENING VERSION 3.0
"PKG",379,20,0)
^9.402P^^
"PKG",379,22,0)
^9.49I^1^1
"PKG",379,22,1,0)
3.0^2930914^3040224
"PKG",379,22,1,"PAH",1,0)
9^3140806
"PKG",379,22,1,"PAH",1,1,0)
^^8^8^3140806
"PKG",379,22,1,"PAH",1,1,1,0)
Patch QAO*3*9 addresses 3 issues:
"PKG",379,22,1,"PAH",1,1,2,0)
      
"PKG",379,22,1,"PAH",1,1,3,0)
       1.  QAOS 107 screen requires VDL documentation change (MAJOR 
"PKG",379,22,1,"PAH",1,1,4,0)
           surgery)
"PKG",379,22,1,"PAH",1,1,5,0)
       2.  QAOS 101.1 screen not reporting unscheduled 10 day re-
"PKG",379,22,1,"PAH",1,1,6,0)
           admissions when scheduled admission occurs on same day
"PKG",379,22,1,"PAH",1,1,7,0)
       3.  QAOS 109 screen reporting duplicate death entries, due to
"PKG",379,22,1,"PAH",1,1,8,0)
           time of death change
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","QAOC0")
0^1^B6465447^B3072340
"RTN","QAOC0",1,0)
QAOC0 ;HISC/DAD-OCCURRENCE SCREEN AUTO ENROLLMENT ; 6/11/14 10:16am
"RTN","QAOC0",2,0)
 ;;3.0;Occurrence Screen;**9**;09/14/1993;Build 4
"RTN","QAOC0",3,0)
 ;AUTO ENROLL UTILITIES
"RTN","QAOC0",4,0)
 ;
"RTN","QAOC0",5,0)
TXSP(CARETYPE,TXSP) ; Is TXSP of type CARETYPE ?
"RTN","QAOC0",6,0)
 ; Returns: -1 = No,  >0 = Yes
"RTN","QAOC0",7,0)
 ; TXSP     = A facility treating specialty file (#45.7) IEN
"RTN","QAOC0",8,0)
 ; CARETYPE = $S(A:Acute, S:Special, I:Intermediate, N:NHCU, P:Psych)
"RTN","QAOC0",9,0)
 N Y S Y=1
"RTN","QAOC0",10,0)
 I (TXSP'>0)!(CARETYPE="") S Y=-1 Q Y
"RTN","QAOC0",11,0)
 I $D(^DIC(45.7,TXSP,0))["0" S Y=-1 Q Y
"RTN","QAOC0",12,0)
 S TXSP=$O(^QA(741.9,"B",TXSP,0)) I TXSP'>0 S Y=-1 Q Y
"RTN","QAOC0",13,0)
 S CARETYPE(0)=$P($G(^QA(741.9,TXSP,0)),"^",2)
"RTN","QAOC0",14,0)
 I CARETYPE(0)="" S Y=-1 Q Y
"RTN","QAOC0",15,0)
 S:CARETYPE'[CARETYPE(0) Y=-1
"RTN","QAOC0",16,0)
 Q Y
"RTN","QAOC0",17,0)
 ;
"RTN","QAOC0",18,0)
SCHED(DFN,DATE) ; Is DATE a scheduled admission for DFN ?
"RTN","QAOC0",19,0)
 ; Returns: 1 = Yes,  0 = No
"RTN","QAOC0",20,0)
 ; DFN  = Patient file (#2) IEN
"RTN","QAOC0",21,0)
 ; DATE = A date in internal FM form
"RTN","QAOC0",22,0)
 N S0,SCHED,X S SCHED=0,DATE=DATE\1
"RTN","QAOC0",23,0)
 F S0=0:0 S S0=$O(^DGS(41.1,"B",DFN,S0)) Q:S0'>0  S X=$G(^DGS(41.1,S0,0)) I $P(X,"^",2)\1=DATE,+$P(X,"^",13)=0 S SCHED=1 Q
"RTN","QAOC0",24,0)
 Q:SCHED SCHED
"RTN","QAOC0",25,0)
 F S0=DATE-.0000001:0 S S0=$O(^DPT(DFN,"S",S0)) Q:$S(S0'>0:1,S0>(DATE+.24):1,S0\1'?7N:1,1:0)  S X=$G(^DPT(DFN,"S",S0,0)) I "I"[$P(X,"^",2),$P(X,"^",7)=3,$O(^QA(740,1,"OS1","B",+$P(X,"^"),0)) S SCHED=1 Q
"RTN","QAOC0",26,0)
 Q SCHED
"RTN","QAOC0",27,0)
 ;
"RTN","QAOC0",28,0)
SCHED2(DFN,DATE) ; Is DATE a scheduled admission for DFN ? DATE includes TIME (QAO*3*9)
"RTN","QAOC0",29,0)
 ; Returns: 1 = Yes,  0 = No
"RTN","QAOC0",30,0)
 ; DFN  = Patient file (#2) IEN
"RTN","QAOC0",31,0)
 ; DATE = A date in internal FM form
"RTN","QAOC0",32,0)
 N QAOS0,QAOSCHED,QAOX S QAOSCHED=0
"RTN","QAOC0",33,0)
 F QAOS0=0:0 S QAOS0=$O(^DGS(41.1,"B",DFN,QAOS0)) Q:QAOS0'>0  S QAOX=$G(^DGS(41.1,QAOS0,0)) I $P(QAOX,"^",2)=DATE,+$P(QAOX,"^",13)=0 S QAOSCHED=1 Q
"RTN","QAOC0",34,0)
 Q:QAOSCHED QAOSCHED
"RTN","QAOC0",35,0)
 F QAOS0=DATE-.0000001:0 S QAOS0=$O(^DPT(DFN,"S",QAOS0)) Q:$S(QAOS0'>0:1,QAOS0>(DATE+.24):1,QAOS0\1'?7N:1,1:0)  S QAOX=$G(^DPT(DFN,"S",QAOS0,0)) I "I"[$P(QAOX,"^",2),$P(QAOX,"^",7)=3,$O(^QA(740,1,"OS1","B",+$P(QAOX,"^"),0)) S QAOSCHED=1 Q
"RTN","QAOC0",36,0)
 Q QAOSCHED
"RTN","QAOC0",37,0)
 ;
"RTN","QAOC0",38,0)
INACTIVE(SCRN) ; Is SCRN national, local, or inactive ?
"RTN","QAOC0",39,0)
 ; Returns: $S(N:National, L:Local, 1:Inactive)
"RTN","QAOC0",40,0)
 ; SCRN = Screen file (#741.1) IEN
"RTN","QAOC0",41,0)
 S SCRN=$O(^QA(741.1,"B",SCRN,0))
"RTN","QAOC0",42,0)
 Q $P($G(^QA(741.1,+SCRN,0)),"^",4)
"RTN","QAOC0",43,0)
 ;
"RTN","QAOC0",44,0)
VADPT(DFN,IEN405) ; For DFN get movement number IEN405 data
"RTN","QAOC0",45,0)
 ; DFN    = Patient file (#2) IEN
"RTN","QAOC0",46,0)
 ; IEN405 = Patient movement file (#405) IEN
"RTN","QAOC0",47,0)
 D KVAR^VADPT S VAIP("E")=IEN405 D IN5^VADPT
"RTN","QAOC0",48,0)
 Q
"RTN","QAOC1011")
0^2^B6114916^B5950767
"RTN","QAOC1011",1,0)
QAOC1011 ;HISC/DAD-OCCURRENCE SCREEN AUTO ENROLLMENT ; 6/9/14 1:13pm
"RTN","QAOC1011",2,0)
 ;;3.0;Occurrence Screen;**9**;09/14/1993;Build 4
"RTN","QAOC1011",3,0)
 ;SCREEN 101.1 -- READMISSION WITHIN 10 DAYS
"RTN","QAOC1011",4,0)
 Q:$$INACTIVE^QAOC0(101.1)
"RTN","QAOC1011",5,0)
 F QAOSDT=(QAMTODAY-.0000001):0 S QAOSDT=$O(^DGPM("AMV1",QAOSDT)) Q:QAOSDT'>0!(QAOSDT>(QAMTODAY+.24))!(QAOSDT\1'?7N)  F QAOSDFN=0:0 S QAOSDFN=$O(^DGPM("AMV1",QAOSDT,QAOSDFN)) Q:QAOSDFN'>0  D
"RTN","QAOC1011",6,0)
 . F QAOSD0=0:0 S QAOSD0=$O(^DGPM("AMV1",QAOSDT,QAOSDFN,QAOSD0)) Q:QAOSD0'>0  S QAOSZERO=$G(^DGPM(QAOSD0,0)) I QAOSZERO]"" D MAIN
"RTN","QAOC1011",7,0)
 . Q
"RTN","QAOC1011",8,0)
 Q
"RTN","QAOC1011",9,0)
MAIN ;
"RTN","QAOC1011",10,0)
 ;Q:$$SCHED^QAOC0(QAOSDFN,QAOSDT)
"RTN","QAOC1011",11,0)
 ; Check date and time to see if scheduled or unscheduled admit (QAO*3*9)
"RTN","QAOC1011",12,0)
 Q:$$SCHED2^QAOC0(QAOSDFN,QAOSDT)
"RTN","QAOC1011",13,0)
 S INTYP(0)=$P(QAOSZERO,"^",18)
"RTN","QAOC1011",14,0)
 S INTYP=$S(INTYP(0)'>0:"",$D(^DG(405.2,INTYP(0),0))#2:^(0),1:"")
"RTN","QAOC1011",15,0)
 S SPECDT=+$O(^DGPM("APTT6",QAOSDFN,+QAOSZERO-.0000001))
"RTN","QAOC1011",16,0)
 S SPECD0=$O(^DGPM("APTT6",QAOSDFN,SPECDT,0))
"RTN","QAOC1011",17,0)
 S TXSP=$S(SPECD0'>0:"",$D(^DGPM(SPECD0,0))#2:$P(^(0),"^",9),1:"")
"RTN","QAOC1011",18,0)
 S Y=$$TXSP^QAOC0("ASP",TXSP)
"RTN","QAOC1011",19,0)
 Q:$S(+Y=-1:1,$P(INTYP,"^",2)'=1:1,INTYP(0)'>0:1,1:0)
"RTN","QAOC1011",20,0)
 S QAOSDTP=9999999.9999999-QAOSDT
"RTN","QAOC1011",21,0)
AGAIN ;
"RTN","QAOC1011",22,0)
 S QAOSDTP=$O(^DGPM("ATID3",QAOSDFN,QAOSDTP))
"RTN","QAOC1011",23,0)
 Q:QAOSDTP'>0!(QAOSDTP\1'?7N)
"RTN","QAOC1011",24,0)
 S QAOSD1P=$O(^DGPM("ATID3",QAOSDFN,QAOSDTP,0))
"RTN","QAOC1011",25,0)
 S QAOSZERO(0)=$S(QAOSD1P'>0:"",$D(^DGPM(QAOSD1P,0))#2:^(0),1:"")
"RTN","QAOC1011",26,0)
 G:QAOSZERO(0)="" AGAIN
"RTN","QAOC1011",27,0)
 S OUTIMP=+QAOSZERO(0),OUTYPP=$P(QAOSZERO(0),"^",18)
"RTN","QAOC1011",28,0)
 S X1=$P(QAOSZERO,"^")\1,X2=OUTIMP\1 D ^%DTC Q:X>10
"RTN","QAOC1011",29,0)
 I OUTYPP>0,$D(^DG(405.2,OUTYPP,0))#2,$P(^(0),"^",8)=4 G AGAIN
"RTN","QAOC1011",30,0)
 D VADPT^QAOC0(QAOSDFN,QAOSD1P)
"RTN","QAOC1011",31,0)
 S ^UTILITY($J,"QAM CONDITION",QAMD1,QAOSDFN,QAMTODAY)=""
"RTN","QAOC1011",32,0)
 S WARDCLIN=+VAIP(5)_"^"
"RTN","QAOC1011",33,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAMTODAY,"WARD")=WARDCLIN
"RTN","QAOC1011",34,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAMTODAY,"TXSP")=+VAIP(8)
"RTN","QAOC1011",35,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAMTODAY,"MVDT")=OUTIMP
"RTN","QAOC1011",36,0)
 D VADPT^QAOC0(QAOSDFN,QAOSD0)
"RTN","QAOC1011",37,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAMTODAY,"DIAG")=VAIP(9)
"RTN","QAOC1011",38,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAMTODAY,"AADM")=VAIP(13)
"RTN","QAOC1011",39,0)
 Q
"RTN","QAOC109")
0^3^B4106951^B3427444
"RTN","QAOC109",1,0)
QAOC109 ;HISC/DAD-OCCURRENCE SCREEN AUTO ENROLLMENT ; 6/9/14 12:57pm
"RTN","QAOC109",2,0)
 ;;3.0;Occurrence Screen;**8,9**;09/14/1993;Build 4
"RTN","QAOC109",3,0)
 ;SCREEN 109 -- DEATH
"RTN","QAOC109",4,0)
 Q:$$INACTIVE^QAOC0(109)
"RTN","QAOC109",5,0)
 N QAO109,QAO109F
"RTN","QAOC109",6,0)
 F QAOSDOD=(QAMTODAY-1.0000001):0 S QAOSDOD=$O(^DGPM("ATT3",QAOSDOD)) Q:(QAOSDOD'>0)!(QAOSDOD>(QAMTODAY+.24))!(QAOSDOD\1'?7N)  F QAOSD0=0:0 S QAOSD0=$O(^DGPM("ATT3",QAOSDOD,QAOSD0)) Q:QAOSD0'>0  D LOOP1
"RTN","QAOC109",7,0)
 Q
"RTN","QAOC109",8,0)
LOOP1 ;
"RTN","QAOC109",9,0)
 S QAOSZERO=$G(^DGPM(QAOSD0,0)) Q:QAOSZERO=""
"RTN","QAOC109",10,0)
 S QAOSDFN=$P(QAOSZERO,"^",3),OUTYPE=$P(QAOSZERO,"^",18)
"RTN","QAOC109",11,0)
 D LOOP2
"RTN","QAOC109",12,0)
 Q:$G(QAO109F(QAOSDFN))
"RTN","QAOC109",13,0)
 S OUTYPE=$P($G(^DG(405.2,+OUTYPE,0)),"^",8) Q:OUTYPE<6
"RTN","QAOC109",14,0)
 N QAOENT
"RTN","QAOC109",15,0)
 S QAOENT=$G(^QA(741,"AA",109,QAOSDOD,QAOSDFN))  Q:QAOENT'=""
"RTN","QAOC109",16,0)
 D VADPT^QAOC0(QAOSDFN,QAOSD0)
"RTN","QAOC109",17,0)
 S QAOVISIT=$P($G(^DGPM(+VAIP(13),0)),"^")
"RTN","QAOC109",18,0)
 S ^UTILITY($J,"QAM CONDITION",QAMD1,QAOSDFN,QAOSDOD)=""
"RTN","QAOC109",19,0)
 S WARDCLIN=+VAIP(5)_"^"
"RTN","QAOC109",20,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAOSDOD,"WARD")=WARDCLIN
"RTN","QAOC109",21,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAOSDOD,"TXSP")=+VAIP(8)
"RTN","QAOC109",22,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAOSDOD,"MVDT")=QAOVISIT
"RTN","QAOC109",23,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAOSDOD,"DIAG")=VAIP(9)
"RTN","QAOC109",24,0)
 S ^UTILITY($J,"QAM FALL OUT",QAMD0,QAOSDFN,QAOSDOD,"AADM")=VAIP(13)
"RTN","QAOC109",25,0)
 Q
"RTN","QAOC109",26,0)
LOOP2 ; Check if death was previously reported (QAO*3*9)
"RTN","QAOC109",27,0)
 Q:$G(QAO109F(QAOSDFN))
"RTN","QAOC109",28,0)
 S QAO109=""
"RTN","QAOC109",29,0)
 F  S QAO109=$O(^QA(741,"B",QAOSDFN,QAO109)) Q:QAO109=""  D
"RTN","QAOC109",30,0)
 . I $G(^QA(741,QAO109,"SCRN"))=109 S QAO109F(QAOSDFN)=1
"RTN","QAOC109",31,0)
 Q
"VER")
8.0^22.0
"BLD",9725,6)
^8
**END**
**END**

