Released GMRC*3*107 SEQ #94
Extracted from mail message
**KIDS**:GMRC*3.0*107^

**INSTALL NAME**
GMRC*3.0*107
"BLD",11000,0)
GMRC*3.0*107^CONSULT/REQUEST TRACKING^0^3180813^y
"BLD",11000,1,0)
^^6^6^3180705^
"BLD",11000,1,1,0)
This report is sorted by a From Date and a To Date.  The report is then 
"BLD",11000,1,2,0)
displayed by Consult to Service/Specialty headers along with a list of 
"BLD",11000,1,3,0)
the Releasing Person as a sub-header to the above header group.  The 
"BLD",11000,1,4,0)
sub-header has a total field which represents the number of consults
"BLD",11000,1,5,0)
released by policy for each Releasing Person.  The header contains a
"BLD",11000,1,6,0)
grand total of all the sub-totals.
"BLD",11000,4,0)
^9.64PA^^
"BLD",11000,6)
5^
"BLD",11000,6.3)
27
"BLD",11000,"ABPKG")
n
"BLD",11000,"KRN",0)
^9.67PA^779.2^20
"BLD",11000,"KRN",.4,0)
.4
"BLD",11000,"KRN",.401,0)
.401
"BLD",11000,"KRN",.402,0)
.402
"BLD",11000,"KRN",.402,"NM",0)
^9.68A^^
"BLD",11000,"KRN",.403,0)
.403
"BLD",11000,"KRN",.5,0)
.5
"BLD",11000,"KRN",.84,0)
.84
"BLD",11000,"KRN",3.6,0)
3.6
"BLD",11000,"KRN",3.8,0)
3.8
"BLD",11000,"KRN",9.2,0)
9.2
"BLD",11000,"KRN",9.8,0)
9.8
"BLD",11000,"KRN",9.8,"NM",0)
^9.68A^7^3
"BLD",11000,"KRN",9.8,"NM",1,0)
GMRCAD^^0^B15478590
"BLD",11000,"KRN",9.8,"NM",5,0)
GMRCADG^^0^B21404529
"BLD",11000,"KRN",9.8,"NM",7,0)
GMRCADU^^0^B15875640
"BLD",11000,"KRN",9.8,"NM","B","GMRCAD",1)

"BLD",11000,"KRN",9.8,"NM","B","GMRCADG",5)

"BLD",11000,"KRN",9.8,"NM","B","GMRCADU",7)

"BLD",11000,"KRN",19,0)
19
"BLD",11000,"KRN",19,"NM",0)
^9.68A^4^4
"BLD",11000,"KRN",19,"NM",1,0)
GMRC RPT ADMIN RELEASE CONSULT^^0
"BLD",11000,"KRN",19,"NM",2,0)
GMRC RPT ADMIN REL CONS USER^^0
"BLD",11000,"KRN",19,"NM",3,0)
GMRC RPT ADMIN REL CONS GROUPR^^0
"BLD",11000,"KRN",19,"NM",4,0)
GMRC REPORTS^^2
"BLD",11000,"KRN",19,"NM","B","GMRC REPORTS",4)

"BLD",11000,"KRN",19,"NM","B","GMRC RPT ADMIN REL CONS GROUPR",3)

"BLD",11000,"KRN",19,"NM","B","GMRC RPT ADMIN REL CONS USER",2)

"BLD",11000,"KRN",19,"NM","B","GMRC RPT ADMIN RELEASE CONSULT",1)

"BLD",11000,"KRN",19.1,0)
19.1
"BLD",11000,"KRN",101,0)
101
"BLD",11000,"KRN",101,"NM",0)
^9.68A^1^1
"BLD",11000,"KRN",101,"NM",1,0)
GMRC PRINT LIST^^0
"BLD",11000,"KRN",101,"NM","B","GMRC PRINT LIST",1)

"BLD",11000,"KRN",409.61,0)
409.61
"BLD",11000,"KRN",409.61,"NM",0)
^9.68A^3^3
"BLD",11000,"KRN",409.61,"NM",1,0)
GMRC RPT ADMIN RELEASE CONSULT^^0
"BLD",11000,"KRN",409.61,"NM",2,0)
GMRC RPT ADMIN REL CONS USER^^0
"BLD",11000,"KRN",409.61,"NM",3,0)
GMRC RPT ADMIN REL CONS GROUPR^^0
"BLD",11000,"KRN",409.61,"NM","B","GMRC RPT ADMIN REL CONS GROUPR",3)

"BLD",11000,"KRN",409.61,"NM","B","GMRC RPT ADMIN REL CONS USER",2)

"BLD",11000,"KRN",409.61,"NM","B","GMRC RPT ADMIN RELEASE CONSULT",1)

"BLD",11000,"KRN",771,0)
771
"BLD",11000,"KRN",771,"NM",0)
^9.68A^^
"BLD",11000,"KRN",779.2,0)
779.2
"BLD",11000,"KRN",870,0)
870
"BLD",11000,"KRN",8989.51,0)
8989.51
"BLD",11000,"KRN",8989.52,0)
8989.52
"BLD",11000,"KRN",8994,0)
8994
"BLD",11000,"KRN","B",.4,.4)

"BLD",11000,"KRN","B",.401,.401)

"BLD",11000,"KRN","B",.402,.402)

"BLD",11000,"KRN","B",.403,.403)

"BLD",11000,"KRN","B",.5,.5)

"BLD",11000,"KRN","B",.84,.84)

"BLD",11000,"KRN","B",3.6,3.6)

"BLD",11000,"KRN","B",3.8,3.8)

"BLD",11000,"KRN","B",9.2,9.2)

"BLD",11000,"KRN","B",9.8,9.8)

"BLD",11000,"KRN","B",19,19)

"BLD",11000,"KRN","B",19.1,19.1)

"BLD",11000,"KRN","B",101,101)

"BLD",11000,"KRN","B",409.61,409.61)

"BLD",11000,"KRN","B",771,771)

"BLD",11000,"KRN","B",779.2,779.2)

"BLD",11000,"KRN","B",870,870)

"BLD",11000,"KRN","B",8989.51,8989.51)

"BLD",11000,"KRN","B",8989.52,8989.52)

"BLD",11000,"KRN","B",8994,8994)

"BLD",11000,"QDEF")
^^^^NO^^^^YES^^NO
"BLD",11000,"QUES",0)
^9.62^^
"BLD",11000,"REQB",0)
^9.611^1^1
"BLD",11000,"REQB",1,0)
OR*3.0*490^2
"BLD",11000,"REQB","B","OR*3.0*490",1)

"KRN",19,2913591,-1)
2^4
"KRN",19,2913591,0)
GMRC REPORTS^Consult Tracking Reports^^M^568^^^^^^^
"KRN",19,2913591,10,0)
^19.01IP^22^22
"KRN",19,2913591,10,20,0)
2922531^TI^1
"KRN",19,2913591,10,20,"^")
GMRC RPT ADMIN RELEASE CONSULT
"KRN",19,2913591,10,21,0)
2922539^GR^2
"KRN",19,2913591,10,21,"^")
GMRC RPT ADMIN REL CONS GROUPR
"KRN",19,2913591,10,22,0)
2922538^US^3
"KRN",19,2913591,10,22,"^")
GMRC RPT ADMIN REL CONS USER
"KRN",19,2913591,"U")
CONSULT TRACKING REPORTS
"KRN",19,2922531,-1)
0^1
"KRN",19,2922531,0)
GMRC RPT ADMIN RELEASE CONSULT^Administratively Released Consults by Title^^R^^^^^^^n^CONSULT/REQUEST TRACKING^^^^^1
"KRN",19,2922531,10.1)
Admin Released Consult
"KRN",19,2922531,25)
EN^GMRCAD
"KRN",19,2922531,26)
D HDR^GMRCAD
"KRN",19,2922531,"U")
ADMINISTRATIVELY RELEASED CONS
"KRN",19,2922538,-1)
0^2
"KRN",19,2922538,0)
GMRC RPT ADMIN REL CONS USER^Administratively Released Consults by User^^R^^^^^^^n^CONSULT/REQUEST TRACKING^^^1^^1
"KRN",19,2922538,10.1)
Admin Rel Consult by User
"KRN",19,2922538,15)
D EXIT^GMRCADU
"KRN",19,2922538,20)

"KRN",19,2922538,25)
EN^GMRCADU
"KRN",19,2922538,26)
D HDR^GMRCADU
"KRN",19,2922538,99)
64838,40926
"KRN",19,2922538,"U")
ADMINISTRATIVELY RELEASED CONS
"KRN",19,2922539,-1)
0^3
"KRN",19,2922539,0)
GMRC RPT ADMIN REL CONS GROUPR^Administratively Released Consults by Group^^R^^^^^^^n^CONSULT/REQUEST TRACKING^^^1^^1
"KRN",19,2922539,10.1)
Admin Rel Consult by Grouper
"KRN",19,2922539,15)
D EXIT^GMRCADG
"KRN",19,2922539,20)

"KRN",19,2922539,25)
EN^GMRCADG
"KRN",19,2922539,26)
D HDR^GMRCADG
"KRN",19,2922539,"U")
ADMINISTRATIVELY RELEASED CONS
"KRN",101,8404,-1)
0^1
"KRN",101,8404,0)
GMRC PRINT LIST^^^M^^^^^^^^CONSULT/REQUEST TRACKING
"KRN",101,8404,4)

"KRN",101,8404,10,0)
^101.01PA^1^1
"KRN",101,8404,26)
D SHOW^VALM
"KRN",101,8404,99)
64828,51772
"KRN",409.61,801,-1)
0^1
"KRN",409.61,801,0)
GMRC RPT ADMIN RELEASE CONSULT^2^^80^6^20^1^1^^^Admin Released Consults-Title^1^^1
"KRN",409.61,801,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,801,"ARRAY")

"KRN",409.61,801,"COL",0)
^409.621^2^2
"KRN",409.61,801,"COL",1,0)
USER^2^52^Releasing Person
"KRN",409.61,801,"COL",2,0)
NUM^56^10^Number
"KRN",409.61,801,"COL","B","NUM",2)

"KRN",409.61,801,"COL","B","USER",1)

"KRN",409.61,801,"FNL")

"KRN",409.61,801,"HDR")
D HDR^GMRCAD
"KRN",409.61,801,"HLP")
D HELP^GMRCAD
"KRN",409.61,801,"INIT")
D INIT^GMRCAD
"KRN",409.61,808,-1)
0^2
"KRN",409.61,808,0)
GMRC RPT ADMIN REL CONS USER^2^^80^6^20^0^1^^GMRC PRINT LIST^Admin Released Consults-User^1^^1
"KRN",409.61,808,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,808,"COL",0)
^409.621^2^2
"KRN",409.61,808,"COL",1,0)
ORDITEM^2^52^Orderable Item
"KRN",409.61,808,"COL",2,0)
NUM^56^10^Number
"KRN",409.61,808,"COL","B","NUM",2)

"KRN",409.61,808,"COL","B","ORDITEM",1)

"KRN",409.61,808,"FNL")
D EXIT^GMRCADU
"KRN",409.61,808,"HDR")
D HDR^GMRCADU
"KRN",409.61,808,"HLP")
D HELP^GMRCADU
"KRN",409.61,808,"INIT")
D INIT^GMRCADU
"KRN",409.61,809,-1)
0^3
"KRN",409.61,809,0)
GMRC RPT ADMIN REL CONS GROUPR^2^^80^6^20^0^1^^GMRC PRINT LIST^Admin Released Consults-Group^1^^1
"KRN",409.61,809,1)
^VALM HIDDEN ACTIONS
"KRN",409.61,809,"COL",0)
^409.621^3^2
"KRN",409.61,809,"COL",1,0)
ADMIN/DS^2^52^Admin & DS
"KRN",409.61,809,"COL",3,0)
NUM^56^10^Number
"KRN",409.61,809,"COL","B","ADMIN/DS",1)

"KRN",409.61,809,"COL","B","NUM",3)

"KRN",409.61,809,"FNL")
D EXIT^GMRCADG
"KRN",409.61,809,"HDR")
D HDR^GMRCADG
"KRN",409.61,809,"HLP")
D HELP^GMRCADG
"KRN",409.61,809,"INIT")
D INIT^GMRCADG
"MBREQ")
0
"ORD",15,101)
101;15;;;PRO^XPDTA;PROF1^XPDIA;PROE1^XPDIA;PROF2^XPDIA;;PRODEL^XPDIA
"ORD",15,101,0)
PROTOCOL
"ORD",17,409.61)
409.61;17;1;;;;LME1^XPDIA1;;;LMDEL^XPDIA1
"ORD",17,409.61,0)
LIST TEMPLATE
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",406,-1)
1^1
"PKG",406,0)
CONSULT/REQUEST TRACKING^GMRC^CONSULTS/REQUESTS
"PKG",406,20,0)
^9.402P^^
"PKG",406,22,0)
^9.49I^1^1
"PKG",406,22,1,0)
3.0^2980101^2981113^1
"PKG",406,22,1,"PAH",1,0)
107^3180813^520824649
"PKG",406,22,1,"PAH",1,1,0)
^^6^6^3180813
"PKG",406,22,1,"PAH",1,1,1,0)
This report is sorted by a From Date and a To Date.  The report is then 
"PKG",406,22,1,"PAH",1,1,2,0)
displayed by Consult to Service/Specialty headers along with a list of 
"PKG",406,22,1,"PAH",1,1,3,0)
the Releasing Person as a sub-header to the above header group.  The 
"PKG",406,22,1,"PAH",1,1,4,0)
sub-header has a total field which represents the number of consults
"PKG",406,22,1,"PAH",1,1,5,0)
released by policy for each Releasing Person.  The header contains a
"PKG",406,22,1,"PAH",1,1,6,0)
grand total of all the sub-totals.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","GMRCAD")
0^1^B15478590^n/a
"RTN","GMRCAD",1,0)
GMRCAD ;ABV/PIJ - Consults Report by Released by Policy. Patch GMRC*3.0*107 ;7/5/18 07:36
"RTN","GMRCAD",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**107**;DEC 27, 1997;Build 27
"RTN","GMRCAD",3,0)
 ;
"RTN","GMRCAD",4,0)
 ; LOCAL VISTA REPORT BY CONSULT
"RTN","GMRCAD",5,0)
 ;
"RTN","GMRCAD",6,0)
 ; Screen Title: Admin Released Consults-Title
"RTN","GMRCAD",7,0)
 ;
"RTN","GMRCAD",8,0)
EN ; -- main entry point for GMRC RPT ADMIN RELEASE CONSULT
"RTN","GMRCAD",9,0)
 ;
"RTN","GMRCAD",10,0)
 N GMRCDT1,GMRCDT2,GMRCEDT1,GMRCEDT2
"RTN","GMRCAD",11,0)
 ;
"RTN","GMRCAD",12,0)
 D EN^VALM("GMRC RPT ADMIN RELEASE CONSULT")
"RTN","GMRCAD",13,0)
 Q
"RTN","GMRCAD",14,0)
 ;
"RTN","GMRCAD",15,0)
EN1 ;Ask for date range
"RTN","GMRCAD",16,0)
 ;
"RTN","GMRCAD",17,0)
 S DIR(0)="DA",DIR("A")="Enter Consult Released Starting Date: "
"RTN","GMRCAD",18,0)
 D ^DIR
"RTN","GMRCAD",19,0)
 I $D(DUOUT)!($D(DTOUT)) S GMRCQUT=1 Q
"RTN","GMRCAD",20,0)
 S GMRCDT1=+Y I 'GMRCDT1 G EN1
"RTN","GMRCAD",21,0)
 W "  (",$$FMTE^XLFDT(GMRCDT1)_")"
"RTN","GMRCAD",22,0)
 ;
"RTN","GMRCAD",23,0)
 K DIR
"RTN","GMRCAD",24,0)
 S DIR(0)="DA",DIR("A")="Enter Consult Released Ending Date: "
"RTN","GMRCAD",25,0)
 D ^DIR
"RTN","GMRCAD",26,0)
 I $D(DTOUT)!($D(DUOUT)) K GMRCDT1 S GMRCQUT=1 G EXIT
"RTN","GMRCAD",27,0)
 I +Y<GMRCDT1 W !!,$C(7),"Ending Date Can Not Be Before Starting Date.",! G EN1
"RTN","GMRCAD",28,0)
 I $G(GMRCDT2)="" S GMRCDT2=+Y
"RTN","GMRCAD",29,0)
 W "  (",$$FMTE^XLFDT(GMRCDT2)_")"
"RTN","GMRCAD",30,0)
 ;
"RTN","GMRCAD",31,0)
 ; Retrieve External Date
"RTN","GMRCAD",32,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,GMRCDT2,.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCAD",33,0)
 ;
"RTN","GMRCAD",34,0)
 Q
"RTN","GMRCAD",35,0)
 ;
"RTN","GMRCAD",36,0)
HDR ; -- header code
"RTN","GMRCAD",37,0)
 N GMRCSITE
"RTN","GMRCAD",38,0)
 S GMRCSITE=$P($$SITE^VASITE(),U,2)
"RTN","GMRCAD",39,0)
 S VALMHDR(1)="VAMC: "_GMRCSITE
"RTN","GMRCAD",40,0)
 S VALMHDR(2)="From: "_$G(GMRCEDT1)_"   To: "_$G(GMRCEDT2)
"RTN","GMRCAD",41,0)
 Q
"RTN","GMRCAD",42,0)
 ;
"RTN","GMRCAD",43,0)
BLDLIST ; -- init variables and list array
"RTN","GMRCAD",44,0)
 N I,IENS,LINE,ORDITEM,ORIEN,RELBY
"RTN","GMRCAD",45,0)
 N FMRELDT
"RTN","GMRCAD",46,0)
 ;
"RTN","GMRCAD",47,0)
 S (FMRELDT,ORIEN,LINEVAR)=""
"RTN","GMRCAD",48,0)
 S LINECNT=0
"RTN","GMRCAD",49,0)
 ;
"RTN","GMRCAD",50,0)
 K ^TMP("GMRCAD",$J)
"RTN","GMRCAD",51,0)
 ;
"RTN","GMRCAD",52,0)
 F  S FMRELDT=$O(^OR(100,"AADMINKEY",FMRELDT)) Q:FMRELDT=""  D
"RTN","GMRCAD",53,0)
 . F I=GMRCDT1:1:GMRCDT2 I $P(I,".",1)=$P(FMRELDT,".",1) D
"RTN","GMRCAD",54,0)
 .. ;
"RTN","GMRCAD",55,0)
 .. F  S ORIEN=$O(^OR(100,"AADMINKEY",FMRELDT,"Y",ORIEN)) Q:ORIEN=""  D
"RTN","GMRCAD",56,0)
 ... S IENS="1,"_ORIEN
"RTN","GMRCAD",57,0)
 ... S ORDITEM=$$GET1^DIQ(100.001,IENS,.01) ; Orderable Item
"RTN","GMRCAD",58,0)
 ... I '$D(^TMP("GMRCAD",$J,ORDITEM)) S ^TMP("GMRCAD",$J,ORDITEM)=0
"RTN","GMRCAD",59,0)
 ... S ^TMP("GMRCAD",$J,ORDITEM)=^TMP("GMRCAD",$J,ORDITEM)+1
"RTN","GMRCAD",60,0)
 ... ;
"RTN","GMRCAD",61,0)
 ... S RELBY=$$GET1^DIQ(100.008,IENS,17)    ; Released by
"RTN","GMRCAD",62,0)
 ... I '$D(^TMP("GMRCAD",$J,ORDITEM,RELBY)) S ^TMP("GMRCAD",$J,ORDITEM,RELBY)=0
"RTN","GMRCAD",63,0)
 ... S ^TMP("GMRCAD",$J,ORDITEM,RELBY)=^TMP("GMRCAD",$J,ORDITEM,RELBY)+1
"RTN","GMRCAD",64,0)
 Q
"RTN","GMRCAD",65,0)
 ;
"RTN","GMRCAD",66,0)
INIT ;
"RTN","GMRCAD",67,0)
 K ^TMP("VALMAR",$J)
"RTN","GMRCAD",68,0)
 N DTOUT,DIR,DUOUT,DIRUT,GMRCQUT,X,Y,TOTAL
"RTN","GMRCAD",69,0)
 ;
"RTN","GMRCAD",70,0)
 S (GMRCDT1,GMRCDT2,GMRCEDT1,GMRCEDT2,GMRCQUT)=""
"RTN","GMRCAD",71,0)
 S (LINECNT,TOTAL,VALMCNT)=0
"RTN","GMRCAD",72,0)
 ;
"RTN","GMRCAD",73,0)
 D EN1
"RTN","GMRCAD",74,0)
 I GMRCQUT S VALMQUIT="",VALMBCK="Q" Q
"RTN","GMRCAD",75,0)
 ;
"RTN","GMRCAD",76,0)
 D BLDLIST ;build the list for List Manager
"RTN","GMRCAD",77,0)
 N NUM,ORDITEM,RELBY
"RTN","GMRCAD",78,0)
 S ORDITEM=""
"RTN","GMRCAD",79,0)
 S (LINE,LINECNT,NUM)=0
"RTN","GMRCAD",80,0)
 ;
"RTN","GMRCAD",81,0)
 S LINEVAR=""
"RTN","GMRCAD",82,0)
 ;
"RTN","GMRCAD",83,0)
 F  S ORDITEM=$O(^TMP("GMRCAD",$J,ORDITEM)) Q:ORDITEM=""  D
"RTN","GMRCAD",84,0)
 . S LINECNT=LINECNT+1
"RTN","GMRCAD",85,0)
 . S LINEVAR=$$SETFLD^VALM1(ORDITEM,LINEVAR,"USER")
"RTN","GMRCAD",86,0)
 . ;
"RTN","GMRCAD",87,0)
 . S NUM=^TMP("GMRCAD",$J,ORDITEM)
"RTN","GMRCAD",88,0)
 . S TOTAL=TOTAL+NUM
"RTN","GMRCAD",89,0)
 . S LINEVAR=$$SETFLD^VALM1(NUM,LINEVAR,"NUM")
"RTN","GMRCAD",90,0)
 . D VALM10(LINEVAR)  ; Print first group
"RTN","GMRCAD",91,0)
 . ;
"RTN","GMRCAD",92,0)
 . S RELBY=""
"RTN","GMRCAD",93,0)
 . F  S RELBY=$O(^TMP("GMRCAD",$J,ORDITEM,RELBY)) D:RELBY="" VALM10("") Q:RELBY=""  D
"RTN","GMRCAD",94,0)
 .. S LINEVAR=$$SETFLD^VALM1("  "_RELBY,LINEVAR,"USER")
"RTN","GMRCAD",95,0)
 .. ;
"RTN","GMRCAD",96,0)
 .. S NUM=^TMP("GMRCAD",$J,ORDITEM,RELBY)
"RTN","GMRCAD",97,0)
 .. S LINEVAR=$$SETFLD^VALM1(NUM,LINEVAR,"NUM")
"RTN","GMRCAD",98,0)
 .. ;
"RTN","GMRCAD",99,0)
 .. D VALM10(LINEVAR)
"RTN","GMRCAD",100,0)
 ;
"RTN","GMRCAD",101,0)
 D VALM10("") ; Enter blank line
"RTN","GMRCAD",102,0)
 S LINEVAR="GRAND TOTAL "_TOTAL
"RTN","GMRCAD",103,0)
 D SET^VALM10(LINE,LINEVAR)
"RTN","GMRCAD",104,0)
 ;
"RTN","GMRCAD",105,0)
 S VALMBCK="R"
"RTN","GMRCAD",106,0)
 ;
"RTN","GMRCAD",107,0)
 K ^TMP("GMRCAD",$J)
"RTN","GMRCAD",108,0)
 K LINECNT
"RTN","GMRCAD",109,0)
 Q
"RTN","GMRCAD",110,0)
 ;
"RTN","GMRCAD",111,0)
VALM10(LINEVAR) ;
"RTN","GMRCAD",112,0)
 S LINE=LINE+1
"RTN","GMRCAD",113,0)
 D SET^VALM10(LINE,LINEVAR)
"RTN","GMRCAD",114,0)
 S VALMCNT=LINE
"RTN","GMRCAD",115,0)
 Q
"RTN","GMRCAD",116,0)
 ;
"RTN","GMRCAD",117,0)
HELP ; -- help code
"RTN","GMRCAD",118,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","GMRCAD",119,0)
 Q
"RTN","GMRCAD",120,0)
 ;
"RTN","GMRCAD",121,0)
EXIT ; -- exit code
"RTN","GMRCAD",122,0)
 K ^TMP("VALMAR",$J)
"RTN","GMRCAD",123,0)
 Q
"RTN","GMRCAD",124,0)
 ;
"RTN","GMRCAD",125,0)
EXPND ; -- expand code
"RTN","GMRCAD",126,0)
 Q
"RTN","GMRCAD",127,0)
 ;
"RTN","GMRCAD",128,0)
DTRES ;Restore old date in case user '^' out.
"RTN","GMRCAD",129,0)
 I $D(GMRCDTS1) S GMRCDT1=GMRCDTS1
"RTN","GMRCAD",130,0)
 I $D(GMRCDTS2) S GMRCDT2=GMRCDTS2
"RTN","GMRCAD",131,0)
 K GMRCDTS1,GMRCDTS2
"RTN","GMRCAD",132,0)
 Q
"RTN","GMRCADG")
0^5^B21404529^n/a
"RTN","GMRCADG",1,0)
GMRCADG ;ABV/PIJ - Consults Report by Released by Policy. Patch GMRC*3.0*107 ;7/5/18 07:36
"RTN","GMRCADG",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**107**;DEC 27, 1997;Build 27
"RTN","GMRCADG",3,0)
 ;
"RTN","GMRCADG",4,0)
 ; LOCAL VISTA REPORT BY GROUPER
"RTN","GMRCADG",5,0)
 ;
"RTN","GMRCADG",6,0)
 ; Screen Title: Admin Released Consults-Group
"RTN","GMRCADG",7,0)
 ;
"RTN","GMRCADG",8,0)
EN ; -- main entry point for GMRC RPT ADMIN RELEASE CONSULT GROUPER
"RTN","GMRCADG",9,0)
 ;
"RTN","GMRCADG",10,0)
 N GMRCEDT1,GMRCEDT2
"RTN","GMRCADG",11,0)
 ;
"RTN","GMRCADG",12,0)
 D EN^VALM("GMRC RPT ADMIN REL CONS GROUPR")
"RTN","GMRCADG",13,0)
 Q
"RTN","GMRCADG",14,0)
 ;
"RTN","GMRCADG",15,0)
EN1 ;Ask for date range
"RTN","GMRCADG",16,0)
 ;
"RTN","GMRCADG",17,0)
 S DIR(0)="DA",DIR("A")="Enter Consult Released Starting Date: "
"RTN","GMRCADG",18,0)
 D ^DIR
"RTN","GMRCADG",19,0)
 I $D(DUOUT)!($D(DTOUT)) S GMRCQUT=1 Q
"RTN","GMRCADG",20,0)
 S GMRCDT1=+Y I 'GMRCDT1 G EN1
"RTN","GMRCADG",21,0)
 W "  (",$$FMTE^XLFDT(GMRCDT1)_")"
"RTN","GMRCADG",22,0)
 ;
"RTN","GMRCADG",23,0)
 K DIR
"RTN","GMRCADG",24,0)
 S DIR(0)="DA",DIR("A")="Enter Consult Released Ending Date: "
"RTN","GMRCADG",25,0)
 D ^DIR
"RTN","GMRCADG",26,0)
 I $D(DTOUT)!($D(DUOUT)) K GMRCDT1 S GMRCQUT=1 G EXIT
"RTN","GMRCADG",27,0)
 I +Y<GMRCDT1 W !!,$C(7),"Ending Date Can Not Be Before Starting Date.",! G EN1
"RTN","GMRCADG",28,0)
 I $G(GMRCDT2)="" S GMRCDT2=+Y
"RTN","GMRCADG",29,0)
 W "  (",$$FMTE^XLFDT(GMRCDT2)_")"
"RTN","GMRCADG",30,0)
 ;
"RTN","GMRCADG",31,0)
 ; Retrieve External Date
"RTN","GMRCADG",32,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,GMRCDT2,.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCADG",33,0)
 ;
"RTN","GMRCADG",34,0)
 Q
"RTN","GMRCADG",35,0)
 ;
"RTN","GMRCADG",36,0)
HDR ; -- header code
"RTN","GMRCADG",37,0)
 N GMRCSITE
"RTN","GMRCADG",38,0)
 S GMRCSITE=$P($$SITE^VASITE(),U,2)
"RTN","GMRCADG",39,0)
 S VALMHDR(1)="VAMC: "_GMRCSITE
"RTN","GMRCADG",40,0)
 S VALMHDR(2)="From: "_$G(GMRCEDT1)_"   To: "_$G(GMRCEDT2)
"RTN","GMRCADG",41,0)
 Q
"RTN","GMRCADG",42,0)
 ;
"RTN","GMRCADG",43,0)
BLDLIST ; -- init variables and list array
"RTN","GMRCADG",44,0)
 N FMRELDT,I,IENS,LINE,ORDITEM,ORIEN,RELBY,X
"RTN","GMRCADG",45,0)
 S (FMRELDT,ORIEN,LINEVAR,X)=""
"RTN","GMRCADG",46,0)
 S LINECNT=0
"RTN","GMRCADG",47,0)
 ;
"RTN","GMRCADG",48,0)
 K ^TMP("GMRCADG",$J)
"RTN","GMRCADG",49,0)
 ;
"RTN","GMRCADG",50,0)
 F  S FMRELDT=$O(^OR(100,"AADMINKEY",FMRELDT)) Q:FMRELDT=""  D
"RTN","GMRCADG",51,0)
 . F I=GMRCDT1:1:GMRCDT2 I $P(I,".",1)=$P(FMRELDT,".",1) D
"RTN","GMRCADG",52,0)
 .. ;  Orderable Item
"RTN","GMRCADG",53,0)
 .. F  S ORIEN=$O(^OR(100,"AADMINKEY",FMRELDT,"Y",ORIEN)) Q:ORIEN=""  D
"RTN","GMRCADG",54,0)
 ... S IENS="1,"_ORIEN
"RTN","GMRCADG",55,0)
 ... ;
"RTN","GMRCADG",56,0)
 ... S ORDITEM=$$GET1^DIQ(100.001,IENS,.01) ; Orderable Item
"RTN","GMRCADG",57,0)
 ... ;
"RTN","GMRCADG",58,0)
 ... I ORDITEM["-ADMIN" S X="ADMIN"
"RTN","GMRCADG",59,0)
 ... I ORDITEM["-DS" S X="DS"
"RTN","GMRCADG",60,0)
 ... ;
"RTN","GMRCADG",61,0)
 ... ; Admin or DS
"RTN","GMRCADG",62,0)
 ... I '$D(^TMP("GMRCADG",$J,X)) S ^TMP("GMRCADG",$J,X)=0
"RTN","GMRCADG",63,0)
 ... S ^TMP("GMRCADG",$J,X)=^TMP("GMRCADG",$J,X)+1
"RTN","GMRCADG",64,0)
 ... ;
"RTN","GMRCADG",65,0)
 ... ; Orderable Item
"RTN","GMRCADG",66,0)
 ... I '$D(^TMP("GMRCADG",$J,X,ORDITEM)) S ^TMP("GMRCADG",$J,X,ORDITEM)=0
"RTN","GMRCADG",67,0)
 ... S ^TMP("GMRCADG",$J,X,ORDITEM)=^TMP("GMRCADG",$J,X,ORDITEM)+1
"RTN","GMRCADG",68,0)
 ... ;
"RTN","GMRCADG",69,0)
 ... ; Released By
"RTN","GMRCADG",70,0)
 ... S RELBY=$$GET1^DIQ(100.008,IENS,17)    ; Released by
"RTN","GMRCADG",71,0)
 ... I '$D(^TMP("GMRCADG",$J,X,ORDITEM,RELBY)) S ^TMP("GMRCADG",$J,X,ORDITEM,RELBY)=0
"RTN","GMRCADG",72,0)
 ... S ^TMP("GMRCADG",$J,X,ORDITEM,RELBY)=^TMP("GMRCADG",$J,X,ORDITEM,RELBY)+1
"RTN","GMRCADG",73,0)
 ... ;
"RTN","GMRCADG",74,0)
 Q
"RTN","GMRCADG",75,0)
 ;
"RTN","GMRCADG",76,0)
INIT ;
"RTN","GMRCADG",77,0)
 K ^TMP("VALMAR",$J)
"RTN","GMRCADG",78,0)
 N DTOUT,DIR,DUOUT,DIRUT,GMRCQUT,X,Y,TOTAL
"RTN","GMRCADG",79,0)
 N GMRCDT1,GMRCDT2,LINECNT
"RTN","GMRCADG",80,0)
 ;
"RTN","GMRCADG",81,0)
 S (GMRCDT1,GMRCDT2,GMRCEDT1,GMRCEDT2,GMRCQUT)=""
"RTN","GMRCADG",82,0)
 S (LINECNT,TOTAL,VALMCNT)=0
"RTN","GMRCADG",83,0)
 ;
"RTN","GMRCADG",84,0)
 ; Ask Questions
"RTN","GMRCADG",85,0)
 D EN1
"RTN","GMRCADG",86,0)
 I GMRCQUT S VALMQUIT=1,VALMBCK="Q" Q
"RTN","GMRCADG",87,0)
 ;
"RTN","GMRCADG",88,0)
 ; ;Build the list for List Manager
"RTN","GMRCADG",89,0)
 D BLDLIST
"RTN","GMRCADG",90,0)
 N ADMINDS,NUM,ORDITEM,RELBY
"RTN","GMRCADG",91,0)
 S (LINE,LINECNT,NUM)=0
"RTN","GMRCADG",92,0)
 ;
"RTN","GMRCADG",93,0)
 S (ADMINDS,LINEVAR)=""
"RTN","GMRCADG",94,0)
 ;
"RTN","GMRCADG",95,0)
 S ADMINDS=""
"RTN","GMRCADG",96,0)
 F  S ADMINDS=$O(^TMP("GMRCADG",$J,ADMINDS)) Q:ADMINDS=""  D
"RTN","GMRCADG",97,0)
 . S LINECNT=LINECNT+1
"RTN","GMRCADG",98,0)
 . S LINEVAR=$$SETFLD^VALM1(ADMINDS,LINEVAR,"ADMIN/DS")
"RTN","GMRCADG",99,0)
 . ;
"RTN","GMRCADG",100,0)
 . S NUM=^TMP("GMRCADG",$J,ADMINDS)
"RTN","GMRCADG",101,0)
 . S TOTAL=TOTAL+NUM
"RTN","GMRCADG",102,0)
 . S LINEVAR=$$SETFLD^VALM1(NUM,LINEVAR,"NUM")
"RTN","GMRCADG",103,0)
 . D VALM10(LINEVAR)  ; Print first group
"RTN","GMRCADG",104,0)
 . ;
"RTN","GMRCADG",105,0)
 . S ORDITEM=""
"RTN","GMRCADG",106,0)
 . F  S ORDITEM=$O(^TMP("GMRCADG",$J,ADMINDS,ORDITEM)) D:ORDITEM="" VALM10("") Q:ORDITEM=""  D
"RTN","GMRCADG",107,0)
 .. S LINEVAR=$$SETFLD^VALM1("  "_ORDITEM,LINEVAR,"ADMIN/DS")
"RTN","GMRCADG",108,0)
 .. ;
"RTN","GMRCADG",109,0)
 .. S NUM=^TMP("GMRCADG",$J,ADMINDS,ORDITEM)
"RTN","GMRCADG",110,0)
 .. S LINEVAR=$$SETFLD^VALM1(NUM,LINEVAR,"NUM")
"RTN","GMRCADG",111,0)
 .. ;
"RTN","GMRCADG",112,0)
 .. D VALM10(LINEVAR)
"RTN","GMRCADG",113,0)
 .. ;
"RTN","GMRCADG",114,0)
 .. S RELBY=""
"RTN","GMRCADG",115,0)
 .. F  S RELBY=$O(^TMP("GMRCADG",$J,ADMINDS,ORDITEM,RELBY)) D:RELBY="" VALM10("") Q:RELBY=""  D
"RTN","GMRCADG",116,0)
 ... S LINEVAR=$$SETFLD^VALM1("     "_RELBY,LINEVAR,"ADMIN/DS")
"RTN","GMRCADG",117,0)
 ... ;
"RTN","GMRCADG",118,0)
 ... S NUM=^TMP("GMRCADG",$J,ADMINDS,ORDITEM,RELBY)
"RTN","GMRCADG",119,0)
 ... S LINEVAR=$$SETFLD^VALM1(NUM,LINEVAR,"NUM")
"RTN","GMRCADG",120,0)
 ... ;
"RTN","GMRCADG",121,0)
 ... D VALM10(LINEVAR)
"RTN","GMRCADG",122,0)
 ;
"RTN","GMRCADG",123,0)
 D VALM10("") ; Enter blank line
"RTN","GMRCADG",124,0)
 S LINEVAR="GRAND TOTAL "_TOTAL
"RTN","GMRCADG",125,0)
 D SET^VALM10(LINE,LINEVAR)
"RTN","GMRCADG",126,0)
 ;
"RTN","GMRCADG",127,0)
 S VALMBCK="R"
"RTN","GMRCADG",128,0)
 ;
"RTN","GMRCADG",129,0)
 K ^TMP("GMRCADG",$J)
"RTN","GMRCADG",130,0)
 ;
"RTN","GMRCADG",131,0)
 Q
"RTN","GMRCADG",132,0)
 ;
"RTN","GMRCADG",133,0)
VALM10(LINEVAR) ;
"RTN","GMRCADG",134,0)
 S LINE=LINE+1
"RTN","GMRCADG",135,0)
 D SET^VALM10(LINE,LINEVAR)
"RTN","GMRCADG",136,0)
 S VALMCNT=LINE
"RTN","GMRCADG",137,0)
 Q
"RTN","GMRCADG",138,0)
 ;
"RTN","GMRCADG",139,0)
HELP ; -- help code
"RTN","GMRCADG",140,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","GMRCADG",141,0)
 Q
"RTN","GMRCADG",142,0)
 ;
"RTN","GMRCADG",143,0)
EXIT ; -- exit code
"RTN","GMRCADG",144,0)
 K ^TMP("VALMAR",$J)
"RTN","GMRCADG",145,0)
 Q
"RTN","GMRCADG",146,0)
 ;
"RTN","GMRCADG",147,0)
EXPND ; -- expand code
"RTN","GMRCADG",148,0)
 Q
"RTN","GMRCADG",149,0)
 ;
"RTN","GMRCADG",150,0)
DTRES ;Restore old date in case user '^' out.
"RTN","GMRCADG",151,0)
 I $D(GMRCDTS1) S GMRCDT1=GMRCDTS1
"RTN","GMRCADG",152,0)
 I $D(GMRCDTS2) S GMRCDT2=GMRCDTS2
"RTN","GMRCADG",153,0)
 K GMRCDTS1,GMRCDTS2
"RTN","GMRCADG",154,0)
 Q
"RTN","GMRCADU")
0^7^B15875640^n/a
"RTN","GMRCADU",1,0)
GMRCADU ;ABV/PIJ - Consults Report by Released by Policy. Patch GMRC*3.0*107 ;7/5/18 07:36
"RTN","GMRCADU",2,0)
 ;;3.0;CONSULT/REQUEST TRACKING;**107**;DEC 27, 1997;Build 27
"RTN","GMRCADU",3,0)
 ;
"RTN","GMRCADU",4,0)
 ; LOCAL VISTA REPORT BY USER
"RTN","GMRCADU",5,0)
 ;
"RTN","GMRCADU",6,0)
 ; Screen Title: Admin Released Consults-User
"RTN","GMRCADU",7,0)
 ;
"RTN","GMRCADU",8,0)
EN ; -- main entry point for GMRC RPT ADMIN RELEASE CONSULT
"RTN","GMRCADU",9,0)
 ;
"RTN","GMRCADU",10,0)
 N GMRCEDT1,GMRCEDT2
"RTN","GMRCADU",11,0)
 ;
"RTN","GMRCADU",12,0)
 D EN^VALM("GMRC RPT ADMIN REL CONS USER")
"RTN","GMRCADU",13,0)
 Q
"RTN","GMRCADU",14,0)
 ;
"RTN","GMRCADU",15,0)
EN1 ;Ask for date range
"RTN","GMRCADU",16,0)
 ;
"RTN","GMRCADU",17,0)
 S DIR(0)="DA",DIR("A")="Enter Consult Released Starting Date: "
"RTN","GMRCADU",18,0)
 D ^DIR
"RTN","GMRCADU",19,0)
 I $D(DUOUT)!($D(DTOUT)) S GMRCQUT=1 Q
"RTN","GMRCADU",20,0)
 S GMRCDT1=+Y I 'GMRCDT1 G EN1
"RTN","GMRCADU",21,0)
 W "  (",$$FMTE^XLFDT(GMRCDT1)_")"
"RTN","GMRCADU",22,0)
 ;
"RTN","GMRCADU",23,0)
 K DIR
"RTN","GMRCADU",24,0)
 S DIR(0)="DA",DIR("A")="Enter Consult Released Ending Date: "
"RTN","GMRCADU",25,0)
 D ^DIR
"RTN","GMRCADU",26,0)
 I $D(DTOUT)!($D(DUOUT)) K GMRCDT1 S GMRCQUT=1 G EXIT
"RTN","GMRCADU",27,0)
 I +Y<GMRCDT1 W !!,$C(7),"Ending Date Can Not Be Before Starting Date.",! G EN1
"RTN","GMRCADU",28,0)
 I $G(GMRCDT2)="" S GMRCDT2=+Y
"RTN","GMRCADU",29,0)
 W "  (",$$FMTE^XLFDT(GMRCDT2)_")"
"RTN","GMRCADU",30,0)
 ;
"RTN","GMRCADU",31,0)
 ; Retrieve External Date
"RTN","GMRCADU",32,0)
 D LISTDATE^GMRCSTU1(GMRCDT1,GMRCDT2,.GMRCEDT1,.GMRCEDT2)
"RTN","GMRCADU",33,0)
 ;
"RTN","GMRCADU",34,0)
 Q
"RTN","GMRCADU",35,0)
 ;
"RTN","GMRCADU",36,0)
HDR ; -- header code
"RTN","GMRCADU",37,0)
 N GMRCSITE
"RTN","GMRCADU",38,0)
 S GMRCSITE=$P($$SITE^VASITE(),U,2)
"RTN","GMRCADU",39,0)
 S VALMHDR(1)="VAMC: "_GMRCSITE
"RTN","GMRCADU",40,0)
 S VALMHDR(2)="From: "_$G(GMRCEDT1)_"   To: "_$G(GMRCEDT2)
"RTN","GMRCADU",41,0)
 Q
"RTN","GMRCADU",42,0)
 ;
"RTN","GMRCADU",43,0)
BLDLIST ; -- init variables and list array
"RTN","GMRCADU",44,0)
 N FMRELDT,I,IENS,LINE,ORDITEM,ORIEN,RELBY
"RTN","GMRCADU",45,0)
 S (FMRELDT,ORIEN,LINEVAR)=""
"RTN","GMRCADU",46,0)
 S LINECNT=0
"RTN","GMRCADU",47,0)
 ;
"RTN","GMRCADU",48,0)
 K ^TMP("GMRCADU",$J)
"RTN","GMRCADU",49,0)
 ;
"RTN","GMRCADU",50,0)
 F  S FMRELDT=$O(^OR(100,"AADMINKEY",FMRELDT)) Q:FMRELDT=""  D
"RTN","GMRCADU",51,0)
 . F I=GMRCDT1:1:GMRCDT2 I $P(I,".",1)=$P(FMRELDT,".",1) D
"RTN","GMRCADU",52,0)
 .. ;  Orderable Item
"RTN","GMRCADU",53,0)
 .. F  S ORIEN=$O(^OR(100,"AADMINKEY",FMRELDT,"Y",ORIEN)) Q:ORIEN=""  D
"RTN","GMRCADU",54,0)
 ... S IENS="1,"_ORIEN
"RTN","GMRCADU",55,0)
 ... ;
"RTN","GMRCADU",56,0)
 ... ; Released By
"RTN","GMRCADU",57,0)
 ... S RELBY=$$GET1^DIQ(100.008,IENS,17)    ; Released by
"RTN","GMRCADU",58,0)
 ... I '$D(^TMP("GMRCADU",$J,RELBY)) S ^TMP("GMRCADU",$J,RELBY)=0
"RTN","GMRCADU",59,0)
 ... S ^TMP("GMRCADU",$J,RELBY)=^TMP("GMRCADU",$J,RELBY)+1
"RTN","GMRCADU",60,0)
 ... ;
"RTN","GMRCADU",61,0)
 ... S ORDITEM=$$GET1^DIQ(100.001,IENS,.01) ; Orderable Item
"RTN","GMRCADU",62,0)
 ... I '$D(^TMP("GMRCADU",$J,RELBY,ORDITEM)) S ^TMP("GMRCADU",$J,RELBY,ORDITEM)=0
"RTN","GMRCADU",63,0)
 ... S ^TMP("GMRCADU",$J,RELBY,ORDITEM)=^TMP("GMRCADU",$J,RELBY,ORDITEM)+1
"RTN","GMRCADU",64,0)
 Q
"RTN","GMRCADU",65,0)
 ;
"RTN","GMRCADU",66,0)
INIT ;
"RTN","GMRCADU",67,0)
 K ^TMP("VALMAR",$J)
"RTN","GMRCADU",68,0)
 N DTOUT,DIR,DUOUT,DIRUT,GMRCQUT,X,Y,TOTAL
"RTN","GMRCADU",69,0)
 N GMRCDT1,GMRCDT2,LINECNT
"RTN","GMRCADU",70,0)
 ;
"RTN","GMRCADU",71,0)
 S (GMRCDT1,GMRCDT2,GMRCEDT1,GMRCEDT2,GMRCQUT)=""
"RTN","GMRCADU",72,0)
 S (LINECNT,TOTAL,VALMCNT)=0
"RTN","GMRCADU",73,0)
 ;
"RTN","GMRCADU",74,0)
 D EN1
"RTN","GMRCADU",75,0)
 I GMRCQUT S VALMQUIT="",VALMBCK="Q" Q
"RTN","GMRCADU",76,0)
 ;
"RTN","GMRCADU",77,0)
 D BLDLIST ;build the list for List Manager
"RTN","GMRCADU",78,0)
 N NUM,ORDITEM,RELBY
"RTN","GMRCADU",79,0)
 S (LINE,LINECNT,NUM)=0
"RTN","GMRCADU",80,0)
 ;
"RTN","GMRCADU",81,0)
 S LINEVAR=""
"RTN","GMRCADU",82,0)
 ;
"RTN","GMRCADU",83,0)
 S RELBY=""
"RTN","GMRCADU",84,0)
 F  S RELBY=$O(^TMP("GMRCADU",$J,RELBY)) Q:RELBY=""  D
"RTN","GMRCADU",85,0)
 . S LINECNT=LINECNT+1
"RTN","GMRCADU",86,0)
 . S LINEVAR=$$SETFLD^VALM1(RELBY,LINEVAR,"ORDITEM")
"RTN","GMRCADU",87,0)
 . ;
"RTN","GMRCADU",88,0)
 . S NUM=^TMP("GMRCADU",$J,RELBY)
"RTN","GMRCADU",89,0)
 . S TOTAL=TOTAL+NUM
"RTN","GMRCADU",90,0)
 . S LINEVAR=$$SETFLD^VALM1(NUM,LINEVAR,"NUM")
"RTN","GMRCADU",91,0)
 . D VALM10(LINEVAR)  ; Print first group
"RTN","GMRCADU",92,0)
 . ;
"RTN","GMRCADU",93,0)
 . S ORDITEM=""
"RTN","GMRCADU",94,0)
 . F  S ORDITEM=$O(^TMP("GMRCADU",$J,RELBY,ORDITEM)) D:ORDITEM="" VALM10("") Q:ORDITEM=""  D
"RTN","GMRCADU",95,0)
 .. S LINEVAR=$$SETFLD^VALM1("  "_ORDITEM,LINEVAR,"ORDITEM")
"RTN","GMRCADU",96,0)
 .. ;
"RTN","GMRCADU",97,0)
 .. S NUM=^TMP("GMRCADU",$J,RELBY,ORDITEM)
"RTN","GMRCADU",98,0)
 .. S LINEVAR=$$SETFLD^VALM1(NUM,LINEVAR,"NUM")
"RTN","GMRCADU",99,0)
 .. ;
"RTN","GMRCADU",100,0)
 .. D VALM10(LINEVAR)
"RTN","GMRCADU",101,0)
 ;
"RTN","GMRCADU",102,0)
 D VALM10("") ; Enter blank line
"RTN","GMRCADU",103,0)
 S LINEVAR="GRAND TOTAL "_TOTAL
"RTN","GMRCADU",104,0)
 D SET^VALM10(LINE,LINEVAR)
"RTN","GMRCADU",105,0)
 ;
"RTN","GMRCADU",106,0)
 S VALMBCK="R"
"RTN","GMRCADU",107,0)
 ;
"RTN","GMRCADU",108,0)
 K ^TMP("GMRCADU",$J)
"RTN","GMRCADU",109,0)
 Q
"RTN","GMRCADU",110,0)
 ;
"RTN","GMRCADU",111,0)
VALM10(LINEVAR) ;
"RTN","GMRCADU",112,0)
 S LINE=LINE+1
"RTN","GMRCADU",113,0)
 D SET^VALM10(LINE,LINEVAR)
"RTN","GMRCADU",114,0)
 S VALMCNT=LINE
"RTN","GMRCADU",115,0)
 Q
"RTN","GMRCADU",116,0)
 ;
"RTN","GMRCADU",117,0)
HELP ; -- help code
"RTN","GMRCADU",118,0)
 S X="?" D DISP^XQORM1 W !!
"RTN","GMRCADU",119,0)
 Q
"RTN","GMRCADU",120,0)
 ;
"RTN","GMRCADU",121,0)
EXIT ; -- exit code
"RTN","GMRCADU",122,0)
 K ^TMP("VALMAR",$J)
"RTN","GMRCADU",123,0)
 Q
"RTN","GMRCADU",124,0)
 ;
"RTN","GMRCADU",125,0)
EXPND ; -- expand code
"RTN","GMRCADU",126,0)
 Q
"RTN","GMRCADU",127,0)
 ;
"RTN","GMRCADU",128,0)
DTRES ;Restore old date in case user '^' out.
"RTN","GMRCADU",129,0)
 I $D(GMRCDTS1) S GMRCDT1=GMRCDTS1
"RTN","GMRCADU",130,0)
 I $D(GMRCDTS2) S GMRCDT2=GMRCDTS2
"RTN","GMRCADU",131,0)
 K GMRCDTS1,GMRCDTS2
"RTN","GMRCADU",132,0)
 Q
"VER")
8.0^22.2
"BLD",11000,6)
^94
**END**
**END**

