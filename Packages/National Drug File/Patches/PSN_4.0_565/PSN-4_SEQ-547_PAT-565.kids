Released PSN*4*565 SEQ #547
Extracted from mail message
**KIDS**:PSN*4.0*565^

**INSTALL NAME**
PSN*4.0*565
"BLD",10750,0)
PSN*4.0*565^NATIONAL DRUG FILE^0^3180823^y
"BLD",10750,1,0)
^^2^2^3180725^
"BLD",10750,1,1,0)
The description of this build can be found in the National Patch Module 
"BLD",10750,1,2,0)
under PSN*4*565.
"BLD",10750,4,0)
^9.64PA^^
"BLD",10750,6.3)
16
"BLD",10750,"INID")
^y
"BLD",10750,"INIT")
POST^PSN565PO
"BLD",10750,"KRN",0)
^9.67PA^779.2^20
"BLD",10750,"KRN",.4,0)
.4
"BLD",10750,"KRN",.401,0)
.401
"BLD",10750,"KRN",.402,0)
.402
"BLD",10750,"KRN",.403,0)
.403
"BLD",10750,"KRN",.5,0)
.5
"BLD",10750,"KRN",.84,0)
.84
"BLD",10750,"KRN",3.6,0)
3.6
"BLD",10750,"KRN",3.8,0)
3.8
"BLD",10750,"KRN",9.2,0)
9.2
"BLD",10750,"KRN",9.8,0)
9.8
"BLD",10750,"KRN",9.8,"NM",0)
^9.68A^5^5
"BLD",10750,"KRN",9.8,"NM",1,0)
PSNPPSNV^^0^B185469053
"BLD",10750,"KRN",9.8,"NM",2,0)
PSNPPSMG^^0^B90569826
"BLD",10750,"KRN",9.8,"NM",3,0)
PSNPPSCL^^0^B48603605
"BLD",10750,"KRN",9.8,"NM",4,0)
PSN565P1^^0^B168859524
"BLD",10750,"KRN",9.8,"NM",5,0)
PSNPPSI3^^0^B49256931
"BLD",10750,"KRN",9.8,"NM","B","PSN565P1",4)

"BLD",10750,"KRN",9.8,"NM","B","PSNPPSCL",3)

"BLD",10750,"KRN",9.8,"NM","B","PSNPPSI3",5)

"BLD",10750,"KRN",9.8,"NM","B","PSNPPSMG",2)

"BLD",10750,"KRN",9.8,"NM","B","PSNPPSNV",1)

"BLD",10750,"KRN",19,0)
19
"BLD",10750,"KRN",19.1,0)
19.1
"BLD",10750,"KRN",101,0)
101
"BLD",10750,"KRN",409.61,0)
409.61
"BLD",10750,"KRN",771,0)
771
"BLD",10750,"KRN",779.2,0)
779.2
"BLD",10750,"KRN",870,0)
870
"BLD",10750,"KRN",8989.51,0)
8989.51
"BLD",10750,"KRN",8989.52,0)
8989.52
"BLD",10750,"KRN",8994,0)
8994
"BLD",10750,"KRN","B",.4,.4)

"BLD",10750,"KRN","B",.401,.401)

"BLD",10750,"KRN","B",.402,.402)

"BLD",10750,"KRN","B",.403,.403)

"BLD",10750,"KRN","B",.5,.5)

"BLD",10750,"KRN","B",.84,.84)

"BLD",10750,"KRN","B",3.6,3.6)

"BLD",10750,"KRN","B",3.8,3.8)

"BLD",10750,"KRN","B",9.2,9.2)

"BLD",10750,"KRN","B",9.8,9.8)

"BLD",10750,"KRN","B",19,19)

"BLD",10750,"KRN","B",19.1,19.1)

"BLD",10750,"KRN","B",101,101)

"BLD",10750,"KRN","B",409.61,409.61)

"BLD",10750,"KRN","B",771,771)

"BLD",10750,"KRN","B",779.2,779.2)

"BLD",10750,"KRN","B",870,870)

"BLD",10750,"KRN","B",8989.51,8989.51)

"BLD",10750,"KRN","B",8989.52,8989.52)

"BLD",10750,"KRN","B",8994,8994)

"BLD",10750,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",10750,"QUES",0)
^9.62^^
"BLD",10750,"REQB",0)
^9.611^1^1
"BLD",10750,"REQB",1,0)
PSN*4.0*563^2
"BLD",10750,"REQB","B","PSN*4.0*563",1)

"INIT")
POST^PSN565PO
"MBREQ")
0
"PKG",163,-1)
1^1
"PKG",163,0)
NATIONAL DRUG FILE^PSN^This is the National Drug File Package V 3.14
"PKG",163,22,0)
^9.49I^1^1
"PKG",163,22,1,0)
4.0^2981030^2981221^1
"PKG",163,22,1,"PAH",1,0)
565^3180823
"PKG",163,22,1,"PAH",1,1,0)
^^2^2^3180823
"PKG",163,22,1,"PAH",1,1,1,0)
The description of this build can be found in the National Patch Module 
"PKG",163,22,1,"PAH",1,1,2,0)
under PSN*4*565.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
6
"RTN","PSN565P1")
0^4^B168859524^n/a
"RTN","PSN565P1",1,0)
PSN565P1 ;BIR/SJA-Post install routine for patch PSN*4*565 (continued) ; 02 Aug 2018  2:00 PM
"RTN","PSN565P1",2,0)
 ;;4.0;NATIONAL DRUG FILE;**565**; 30 Oct 98;Build 16
"RTN","PSN565P1",3,0)
 ;
"RTN","PSN565P1",4,0)
 Q
"RTN","PSN565P1",5,0)
EN ; entry point
"RTN","PSN565P1",6,0)
 N DATA,II,NAME,NODE1,PSNDA,X
"RTN","PSN565P1",7,0)
 F II=1:1 S DATA=$P($T(@("LIST+"_II_"^PSN565P1")),";;",2) Q:DATA=""  D
"RTN","PSN565P1",8,0)
 . S PSNDA=+DATA,NAME=$E($P($G(^PSNDF(50.68,PSNDA,0)),"^"),1,40),NODE1=$G(^PSNDF(50.68,PSNDA,1))
"RTN","PSN565P1",9,0)
 . I $D(^PSNDF(50.68,PSNDA,0)),'$P(NODE1,"^",5) S $P(^PSNDF(50.68,PSNDA,1),"^",5)=$E(1000000+$P(DATA,",",2),2,7) D
"RTN","PSN565P1",10,0)
 . . S CNT=CNT+1,^TMP("PSN",$J,CNT)=PSNDA_$J("",15-$L(PSNDA))_NAME_$J("",50-$L(NAME))_$E(1000000+$P(DATA,",",2),2,7)
"RTN","PSN565P1",11,0)
 Q
"RTN","PSN565P1",12,0)
 ;
"RTN","PSN565P1",13,0)
LIST ; VA PRODUCT entries missing GCNSEQNO field
"RTN","PSN565P1",14,0)
 ;;17001,48784
"RTN","PSN565P1",15,0)
 ;;17003,53730
"RTN","PSN565P1",16,0)
 ;;17032,54628
"RTN","PSN565P1",17,0)
 ;;17037,46527
"RTN","PSN565P1",18,0)
 ;;17095,52830
"RTN","PSN565P1",19,0)
 ;;17098,51803
"RTN","PSN565P1",20,0)
 ;;17164,42966
"RTN","PSN565P1",21,0)
 ;;17167,60312
"RTN","PSN565P1",22,0)
 ;;17191,52080
"RTN","PSN565P1",23,0)
 ;;17236,42917
"RTN","PSN565P1",24,0)
 ;;17243,21282
"RTN","PSN565P1",25,0)
 ;;17244,16570
"RTN","PSN565P1",26,0)
 ;;17245,16571
"RTN","PSN565P1",27,0)
 ;;17246,16572
"RTN","PSN565P1",28,0)
 ;;17263,59298
"RTN","PSN565P1",29,0)
 ;;17329,53984
"RTN","PSN565P1",30,0)
 ;;17330,50692
"RTN","PSN565P1",31,0)
 ;;17344,52078
"RTN","PSN565P1",32,0)
 ;;17352,51801
"RTN","PSN565P1",33,0)
 ;;17365,66041
"RTN","PSN565P1",34,0)
 ;;17378,44073
"RTN","PSN565P1",35,0)
 ;;17386,17616
"RTN","PSN565P1",36,0)
 ;;17426,21900
"RTN","PSN565P1",37,0)
 ;;17455,58489
"RTN","PSN565P1",38,0)
 ;;17457,42966
"RTN","PSN565P1",39,0)
 ;;17475,45972
"RTN","PSN565P1",40,0)
 ;;17479,42991
"RTN","PSN565P1",41,0)
 ;;17487,6293
"RTN","PSN565P1",42,0)
 ;;17489,60364
"RTN","PSN565P1",43,0)
 ;;17513,53974
"RTN","PSN565P1",44,0)
 ;;17523,33515
"RTN","PSN565P1",45,0)
 ;;17537,58323
"RTN","PSN565P1",46,0)
 ;;17545,42600
"RTN","PSN565P1",47,0)
 ;;17586,60225
"RTN","PSN565P1",48,0)
 ;;17588,57439
"RTN","PSN565P1",49,0)
 ;;17599,51806
"RTN","PSN565P1",50,0)
 ;;17600,51802
"RTN","PSN565P1",51,0)
 ;;17601,51804
"RTN","PSN565P1",52,0)
 ;;17602,51805
"RTN","PSN565P1",53,0)
 ;;17603,59215
"RTN","PSN565P1",54,0)
 ;;17616,266
"RTN","PSN565P1",55,0)
 ;;17647,3309
"RTN","PSN565P1",56,0)
 ;;17654,3297
"RTN","PSN565P1",57,0)
 ;;17669,60337
"RTN","PSN565P1",58,0)
 ;;17691,60969
"RTN","PSN565P1",59,0)
 ;;17692,60970
"RTN","PSN565P1",60,0)
 ;;17696,64745
"RTN","PSN565P1",61,0)
 ;;17709,60218
"RTN","PSN565P1",62,0)
 ;;17728,59712
"RTN","PSN565P1",63,0)
 ;;17779,47525
"RTN","PSN565P1",64,0)
 ;;17789,43136
"RTN","PSN565P1",65,0)
 ;;17814,63627
"RTN","PSN565P1",66,0)
 ;;17816,5349
"RTN","PSN565P1",67,0)
 ;;17824,60546
"RTN","PSN565P1",68,0)
 ;;17825,61119
"RTN","PSN565P1",69,0)
 ;;17834,70397
"RTN","PSN565P1",70,0)
 ;;17836,70398
"RTN","PSN565P1",71,0)
 ;;17838,70399
"RTN","PSN565P1",72,0)
 ;;17858,18470
"RTN","PSN565P1",73,0)
 ;;17878,60581
"RTN","PSN565P1",74,0)
 ;;17879,60579
"RTN","PSN565P1",75,0)
 ;;17880,60580
"RTN","PSN565P1",76,0)
 ;;17881,60578
"RTN","PSN565P1",77,0)
 ;;17893,60469
"RTN","PSN565P1",78,0)
 ;;17900,45967
"RTN","PSN565P1",79,0)
 ;;17901,51614
"RTN","PSN565P1",80,0)
 ;;17912,54018
"RTN","PSN565P1",81,0)
 ;;17918,16242
"RTN","PSN565P1",82,0)
 ;;17925,60106
"RTN","PSN565P1",83,0)
 ;;17926,60105
"RTN","PSN565P1",84,0)
 ;;17927,60104
"RTN","PSN565P1",85,0)
 ;;18003,49858
"RTN","PSN565P1",86,0)
 ;;18013,60935
"RTN","PSN565P1",87,0)
 ;;18019,61680
"RTN","PSN565P1",88,0)
 ;;18035,93
"RTN","PSN565P1",89,0)
 ;;18067,53058
"RTN","PSN565P1",90,0)
 ;;18071,22707
"RTN","PSN565P1",91,0)
 ;;18084,23786
"RTN","PSN565P1",92,0)
 ;;18092,60547
"RTN","PSN565P1",93,0)
 ;;18105,1913
"RTN","PSN565P1",94,0)
 ;;18106,42601
"RTN","PSN565P1",95,0)
 ;;18113,1913
"RTN","PSN565P1",96,0)
 ;;18114,1913
"RTN","PSN565P1",97,0)
 ;;18115,1913
"RTN","PSN565P1",98,0)
 ;;18123,1913
"RTN","PSN565P1",99,0)
 ;;18125,1913
"RTN","PSN565P1",100,0)
 ;;18126,13755
"RTN","PSN565P1",101,0)
 ;;18127,75004
"RTN","PSN565P1",102,0)
 ;;18128,13755
"RTN","PSN565P1",103,0)
 ;;18129,59393
"RTN","PSN565P1",104,0)
 ;;18138,1933
"RTN","PSN565P1",105,0)
 ;;18165,61013
"RTN","PSN565P1",106,0)
 ;;18167,61015
"RTN","PSN565P1",107,0)
 ;;18168,61014
"RTN","PSN565P1",108,0)
 ;;18169,61911
"RTN","PSN565P1",109,0)
 ;;18209,62289
"RTN","PSN565P1",110,0)
 ;;18211,62288
"RTN","PSN565P1",111,0)
 ;;18212,40966
"RTN","PSN565P1",112,0)
 ;;18230,62463
"RTN","PSN565P1",113,0)
 ;;18286,53056
"RTN","PSN565P1",114,0)
 ;;18287,60545
"RTN","PSN565P1",115,0)
 ;;18298,63939
"RTN","PSN565P1",116,0)
 ;;18299,63939
"RTN","PSN565P1",117,0)
 ;;18333,16242
"RTN","PSN565P1",118,0)
 ;;18334,16242
"RTN","PSN565P1",119,0)
 ;;18337,62658
"RTN","PSN565P1",120,0)
 ;;18376,33364
"RTN","PSN565P1",121,0)
 ;;18377,33365
"RTN","PSN565P1",122,0)
 ;;18378,33366
"RTN","PSN565P1",123,0)
 ;;18389,61375
"RTN","PSN565P1",124,0)
 ;;18415,30006
"RTN","PSN565P1",125,0)
 ;;18422,21144
"RTN","PSN565P1",126,0)
 ;;18438,53741
"RTN","PSN565P1",127,0)
 ;;18470,62734
"RTN","PSN565P1",128,0)
 ;;18591,49601
"RTN","PSN565P1",129,0)
 ;;18648,10241
"RTN","PSN565P1",130,0)
 ;;18649,10241
"RTN","PSN565P1",131,0)
 ;;18656,43028
"RTN","PSN565P1",132,0)
 ;;18661,43027
"RTN","PSN565P1",133,0)
 ;;18671,40223
"RTN","PSN565P1",134,0)
 ;;18672,40224
"RTN","PSN565P1",135,0)
 ;;18786,54021
"RTN","PSN565P1",136,0)
 ;;18787,58286
"RTN","PSN565P1",137,0)
 ;;18823,1913
"RTN","PSN565P1",138,0)
 ;;18867,60267
"RTN","PSN565P1",139,0)
 ;;19108,62618
"RTN","PSN565P1",140,0)
 ;;19129,10241
"RTN","PSN565P1",141,0)
 ;;19162,45266
"RTN","PSN565P1",142,0)
 ;;19208,10238
"RTN","PSN565P1",143,0)
 ;;19233,63340
"RTN","PSN565P1",144,0)
 ;;19238,54018
"RTN","PSN565P1",145,0)
 ;;19288,63511
"RTN","PSN565P1",146,0)
 ;;19321,58668
"RTN","PSN565P1",147,0)
 ;;19322,58667
"RTN","PSN565P1",148,0)
 ;;19343,53916
"RTN","PSN565P1",149,0)
 ;;19374,49599
"RTN","PSN565P1",150,0)
 ;;19383,58669
"RTN","PSN565P1",151,0)
 ;;19385,63683
"RTN","PSN565P1",152,0)
 ;;19386,63684
"RTN","PSN565P1",153,0)
 ;;19387,63685
"RTN","PSN565P1",154,0)
 ;;19399,54623
"RTN","PSN565P1",155,0)
 ;;19421,63736
"RTN","PSN565P1",156,0)
 ;;19422,63737
"RTN","PSN565P1",157,0)
 ;;19423,63736
"RTN","PSN565P1",158,0)
 ;;19424,63737
"RTN","PSN565P1",159,0)
 ;;19460,60321
"RTN","PSN565P1",160,0)
 ;;19463,2743
"RTN","PSN565P1",161,0)
 ;;19483,60541
"RTN","PSN565P1",162,0)
 ;;19484,60541
"RTN","PSN565P1",163,0)
 ;;19485,60541
"RTN","PSN565P1",164,0)
 ;;19505,63796
"RTN","PSN565P1",165,0)
 ;;19510,61104
"RTN","PSN565P1",166,0)
 ;;19524,58288
"RTN","PSN565P1",167,0)
 ;;19526,49598
"RTN","PSN565P1",168,0)
 ;;19527,49600
"RTN","PSN565P1",169,0)
 ;;19599,63102
"RTN","PSN565P1",170,0)
 ;;19601,1912
"RTN","PSN565P1",171,0)
 ;;19602,1912
"RTN","PSN565P1",172,0)
 ;;19603,1912
"RTN","PSN565P1",173,0)
 ;;19607,64045
"RTN","PSN565P1",174,0)
 ;;19620,24515
"RTN","PSN565P1",175,0)
 ;;19625,60258
"RTN","PSN565P1",176,0)
 ;;19743,65741
"RTN","PSN565P1",177,0)
 ;;19748,3699
"RTN","PSN565P1",178,0)
 ;;19788,49720
"RTN","PSN565P1",179,0)
 ;;19795,3422
"RTN","PSN565P1",180,0)
 ;;19811,62084
"RTN","PSN565P1",181,0)
 ;;19812,62084
"RTN","PSN565P1",182,0)
 ;;19816,6298
"RTN","PSN565P1",183,0)
 ;;19822,16242
"RTN","PSN565P1",184,0)
 ;;19874,63599
"RTN","PSN565P1",185,0)
 ;;19875,21444
"RTN","PSN565P1",186,0)
 ;;19940,16242
"RTN","PSN565P1",187,0)
 ;;19942,62175
"RTN","PSN565P1",188,0)
 ;;19984,4204
"RTN","PSN565P1",189,0)
 ;;20025,7076
"RTN","PSN565P1",190,0)
 ;;20069,64532
"RTN","PSN565P1",191,0)
 ;;20138,72463
"RTN","PSN565P1",192,0)
 ;;20178,64275
"RTN","PSN565P1",193,0)
 ;;20179,64276
"RTN","PSN565P1",194,0)
 ;;20180,13477
"RTN","PSN565P1",195,0)
 ;;20205,63720
"RTN","PSN565P1",196,0)
 ;;20224,70261
"RTN","PSN565P1",197,0)
 ;;20324,6981
"RTN","PSN565P1",198,0)
 ;;20335,43402
"RTN","PSN565P1",199,0)
 ;;20377,69334
"RTN","PSN565P1",200,0)
 ;;20378,68719
"RTN","PSN565P1",201,0)
 ;;20384,475
"RTN","PSN565P1",202,0)
 ;;20386,475
"RTN","PSN565P1",203,0)
 ;;20411,62976
"RTN","PSN565P1",204,0)
 ;;20471,61218
"RTN","PSN565P1",205,0)
 ;;20472,21282
"RTN","PSN565P1",206,0)
 ;;20473,24537
"RTN","PSN565P1",207,0)
 ;;20474,16571
"RTN","PSN565P1",208,0)
 ;;20476,16572
"RTN","PSN565P1",209,0)
 ;;20540,48553
"RTN","PSN565P1",210,0)
 ;;20636,65687
"RTN","PSN565P1",211,0)
 ;;20651,23144
"RTN","PSN565P1",212,0)
 ;;20702,16242
"RTN","PSN565P1",213,0)
 ;;20734,65956
"RTN","PSN565P1",214,0)
 ;;20735,65956
"RTN","PSN565P1",215,0)
 ;;20745,65461
"RTN","PSN565P1",216,0)
 ;;20800,65233
"RTN","PSN565P1",217,0)
 ;;20801,65232
"RTN","PSN565P1",218,0)
 ;;20852,59760
"RTN","PSN565P1",219,0)
 ;;20869,62692
"RTN","PSN565P1",220,0)
 ;;20905,63975
"RTN","PSN565P1",221,0)
 ;;20914,65538
"RTN","PSN565P1",222,0)
 ;;20918,63636
"RTN","PSN565P1",223,0)
 ;;20934,65537
"RTN","PSN565P1",224,0)
 ;;20977,65556
"RTN","PSN565P1",225,0)
 ;;20978,65555
"RTN","PSN565P1",226,0)
 ;;20979,65554
"RTN","PSN565P1",227,0)
 ;;20980,65553
"RTN","PSN565P1",228,0)
 ;;20981,65552
"RTN","PSN565P1",229,0)
 ;;21009,58755
"RTN","PSN565P1",230,0)
 ;;21015,66313
"RTN","PSN565P1",231,0)
 ;;21044,65700
"RTN","PSN565P1",232,0)
 ;;21045,65701
"RTN","PSN565P1",233,0)
 ;;21046,65702
"RTN","PSN565P1",234,0)
 ;;21047,65703
"RTN","PSN565P1",235,0)
 ;;21157,58193
"RTN","PSN565P1",236,0)
 ;;21173,9793
"RTN","PSN565P1",237,0)
 ;;21187,44627
"RTN","PSN565P1",238,0)
 ;;21194,64967
"RTN","PSN565P1",239,0)
 ;;21195,65994
"RTN","PSN565P1",240,0)
 ;;21202,52746
"RTN","PSN565P1",241,0)
 ;;21243,53055
"RTN","PSN565P1",242,0)
 ;;21264,65626
"RTN","PSN565P1",243,0)
 ;;21265,65625
"RTN","PSN565P1",244,0)
 ;;21274,65713
"RTN","PSN565P1",245,0)
 ;;21310,66351
"RTN","PSN565P1",246,0)
 ;;21311,66350
"RTN","PSN565P1",247,0)
 ;;21312,66349
"RTN","PSN565P1",248,0)
 ;;21324,65733
"RTN","PSN565P1",249,0)
 ;;21422,65956
"RTN","PSN565P1",250,0)
 ;;21424,63002
"RTN","PSN565P1",251,0)
 ;;21441,66927
"RTN","PSN565P1",252,0)
 ;;21468,45216
"RTN","PSN565P1",253,0)
 ;;21470,61294
"RTN","PSN565P1",254,0)
 ;;21471,45215
"RTN","PSN565P1",255,0)
 ;;21517,10362
"RTN","PSN565P1",256,0)
 ;;21531,65344
"RTN","PSN565P1",257,0)
 ;;21553,43935
"RTN","PSN565P1",258,0)
 ;;21555,26490
"RTN","PSN565P1",259,0)
 ;;21578,46668
"RTN","PSN565P1",260,0)
 ;;21614,66433
"RTN","PSN565P1",261,0)
 ;;21615,66432
"RTN","PSN565P1",262,0)
 ;;21616,66434
"RTN","PSN565P1",263,0)
 ;;21617,66435
"RTN","PSN565P1",264,0)
 ;;21635,65540
"RTN","PSN565P1",265,0)
 ;;21655,16242
"RTN","PSN565P1",266,0)
 ;;21721,16242
"RTN","PSN565P1",267,0)
 ;;21749,16270
"RTN","PSN565P1",268,0)
 ;;21750,16270
"RTN","PSN565P1",269,0)
 ;;21751,16270
"RTN","PSN565P1",270,0)
 ;;21759,9657
"RTN","PSN565P1",271,0)
 ;;21762,3300
"RTN","PSN565P1",272,0)
 ;;21765,73764
"RTN","PSN565P1",273,0)
 ;;21864,11998
"RTN","PSN565P1",274,0)
 ;;21866,66537
"RTN","PSN565P1",275,0)
 ;;21867,66536
"RTN","PSN565P1",276,0)
 ;;21873,66591
"RTN","PSN565P1",277,0)
 ;;21875,66592
"RTN","PSN565P1",278,0)
 ;;21878,66328
"RTN","PSN565P1",279,0)
 ;;21927,64613
"RTN","PSN565P1",280,0)
 ;;21936,66652
"RTN","PSN565P1",281,0)
 ;;21938,66651
"RTN","PSN565P1",282,0)
 ;;21940,66650
"RTN","PSN565P1",283,0)
 ;;21942,66649
"RTN","PSN565P1",284,0)
 ;;21954,39494
"RTN","PSN565P1",285,0)
 ;;21963,60662
"RTN","PSN565P1",286,0)
 ;;22002,65956
"RTN","PSN565P1",287,0)
 ;;22003,66300
"RTN","PSN565P1",288,0)
 ;;22053,16849
"RTN","PSN565P1",289,0)
 ;;22054,16850
"RTN","PSN565P1",290,0)
 ;;22069,64467
"RTN","PSN565P1",291,0)
 ;;22070,64469
"RTN","PSN565P1",292,0)
 ;;22081,61992
"RTN","PSN565P1",293,0)
 ;;22089,65956
"RTN","PSN565P1",294,0)
 ;;22165,66440
"RTN","PSN565P1",295,0)
 ;;22166,66436
"RTN","PSN565P1",296,0)
 ;;22187,40223
"RTN","PSN565P1",297,0)
 ;;22188,40224
"RTN","PSN565P1",298,0)
 ;;22199,69018
"RTN","PSN565P1",299,0)
 ;;22210,16242
"RTN","PSN565P1",300,0)
 ;;22220,66960
"RTN","PSN565P1",301,0)
 ;;22222,66961
"RTN","PSN565P1",302,0)
 ;;22223,61867
"RTN","PSN565P1",303,0)
 ;;22224,66959
"RTN","PSN565P1",304,0)
 ;;22225,66958
"RTN","PSN565P1",305,0)
 ;;22226,66957
"RTN","PSN565P1",306,0)
 ;;22228,46699
"RTN","PSN565P1",307,0)
 ;;22229,46698
"RTN","PSN565P1",308,0)
 ;;22237,67685
"RTN","PSN565P1",309,0)
 ;;22238,67685
"RTN","PSN565P1",310,0)
 ;;22239,67686
"RTN","PSN565P1",311,0)
 ;;22240,67686
"RTN","PSN565P1",312,0)
 ;;22327,32174
"RTN","PSN565P1",313,0)
 ;;22328,52830
"RTN","PSN565P1",314,0)
 ;;22329,40366
"RTN","PSN565P1",315,0)
 ;;22356,34604
"RTN","PSN565P1",316,0)
 ;;22385,67283
"RTN","PSN565P1",317,0)
 ;;22386,67285
"RTN","PSN565P1",318,0)
 ;;22387,67284
"RTN","PSN565P1",319,0)
 ;;22408,64831
"RTN","PSN565P1",320,0)
 ;;22412,64466
"RTN","PSN565P1",321,0)
 ;;22437,67394
"RTN","PSN565P1",322,0)
 ;;22499,58415
"RTN","PSN565P1",323,0)
 ;;22506,64563
"RTN","PSN565P1",324,0)
 ;;22508,63497
"RTN","PSN565P1",325,0)
 ;;22565,47576
"RTN","PSN565P1",326,0)
 ;;22576,67452
"RTN","PSN565P1",327,0)
 ;;22577,67454
"RTN","PSN565P1",328,0)
 ;;22578,67455
"RTN","PSN565P1",329,0)
 ;;22598,3301
"RTN","PSN565P1",330,0)
 ;;22599,24539
"RTN","PSN565P1",331,0)
 ;;22600,24536
"RTN","PSN565P1",332,0)
 ;;22601,24537
"RTN","PSN565P1",333,0)
 ;;22602,24538
"RTN","PSN565P1",334,0)
 ;;22603,24478
"RTN","PSN565P1",335,0)
 ;;22613,46907
"RTN","PSN565P1",336,0)
 ;;22632,66872
"RTN","PSN565P1",337,0)
 ;;22638,1781
"RTN","PSN565P1",338,0)
 ;;22647,67456
"RTN","PSN565P1",339,0)
 ;;22656,47107
"RTN","PSN565P1",340,0)
 ;;22659,67414
"RTN","PSN565P1",341,0)
 ;;22685,68335
"RTN","PSN565P1",342,0)
 ;;22696,65287
"RTN","PSN565P1",343,0)
 ;;22714,67938
"RTN","PSN565P1",344,0)
 ;;22723,61391
"RTN","PSN565P1",345,0)
 ;;22731,67988
"RTN","PSN565P1",346,0)
 ;;22732,67987
"RTN","PSN565P1",347,0)
 ;;22733,67986
"RTN","PSN565P1",348,0)
 ;;22737,64056
"RTN","PSN565P1",349,0)
 ;;22770,27400
"RTN","PSN565P1",350,0)
 ;;22799,66738
"RTN","PSN565P1",351,0)
 ;;22800,66374
"RTN","PSN565P1",352,0)
 ;;22826,66377
"RTN","PSN565P1",353,0)
 ;;22855,7076
"RTN","PSN565P1",354,0)
 ;;22865,63391
"RTN","PSN565P1",355,0)
 ;;22889,36747
"RTN","PSN565P1",356,0)
 ;;22942,68365
"RTN","PSN565P1",357,0)
 ;;22949,64529
"RTN","PSN565P1",358,0)
 ;;22950,68329
"RTN","PSN565P1",359,0)
 ;;23051,68873
"RTN","PSN565P1",360,0)
 ;;23053,68873
"RTN","PSN565P1",361,0)
 ;;23094,48783
"RTN","PSN565P1",362,0)
 ;;23100,60898
"RTN","PSN565P1",363,0)
 ;;23107,67945
"RTN","PSN565P1",364,0)
 ;;23154,68022
"RTN","PSN565P1",365,0)
 ;;23161,53152
"RTN","PSN565P1",366,0)
 ;;23178,69618
"RTN","PSN565P1",367,0)
 ;;23188,53059
"RTN","PSN565P1",368,0)
 ;;23189,53061
"RTN","PSN565P1",369,0)
 ;;23190,53060
"RTN","PSN565P1",370,0)
 ;;23266,52831
"RTN","PSN565P1",371,0)
 ;;23275,61767
"RTN","PSN565P1",372,0)
 ;;23282,21687
"RTN","PSN565P1",373,0)
 ;;23283,66127
"RTN","PSN565P1",374,0)
 ;;23287,68718
"RTN","PSN565P1",375,0)
 ;;23304,69900
"RTN","PSN565P1",376,0)
 ;;23305,69901
"RTN","PSN565P1",377,0)
 ;;23306,69903
"RTN","PSN565P1",378,0)
 ;;23316,26491
"RTN","PSN565P1",379,0)
 ;;23321,70168
"RTN","PSN565P1",380,0)
 ;;23332,70166
"RTN","PSN565P1",381,0)
 ;;23333,70167
"RTN","PSN565P1",382,0)
 ;;23338,16571
"RTN","PSN565P1",383,0)
 ;;23341,16572
"RTN","PSN565P1",384,0)
 ;;23348,21282
"RTN","PSN565P1",385,0)
 ;;23349,16570
"RTN","PSN565P1",386,0)
 ;;23350,69630
"RTN","PSN565P1",387,0)
 ;;23351,69631
"RTN","PSN565P1",388,0)
 ;;23356,69631
"RTN","PSN565P1",389,0)
 ;;23357,69630
"RTN","PSN565P1",390,0)
 ;;23395,65744
"RTN","PSN565P1",391,0)
 ;;23425,27050
"RTN","PSN565P1",392,0)
 ;;23507,1913
"RTN","PSN565P1",393,0)
 ;;23508,1913
"RTN","PSN565P1",394,0)
 ;;23548,70123
"RTN","PSN565P1",395,0)
 ;;23559,70174
"RTN","PSN565P1",396,0)
 ;;23602,48593
"RTN","PSN565P1",397,0)
 ;;23645,26508
"RTN","PSN565P1",398,0)
 ;;23646,26508
"RTN","PSN565P1",399,0)
 ;;23647,26508
"RTN","PSN565P1",400,0)
 ;;23649,70383
"RTN","PSN565P1",401,0)
 ;;23656,61716
"RTN","PSN565P1",402,0)
 ;;23660,3293
"RTN","PSN565P1",403,0)
 ;;23664,70490
"RTN","PSN565P1",404,0)
 ;;23683,26491
"RTN","PSN565P1",405,0)
 ;;23695,70563
"RTN","PSN565P1",406,0)
 ;;23696,70565
"RTN","PSN565P1",407,0)
 ;;23701,51991
"RTN","PSN565P1",408,0)
 ;;23725,48963
"RTN","PSN565P1",409,0)
 ;;23729,70618
"RTN","PSN565P1",410,0)
 ;;23738,70669
"RTN","PSN565P1",411,0)
 ;;23739,70670
"RTN","PSN565P1",412,0)
 ;;23760,60035
"RTN","PSN565P1",413,0)
 ;;23769,70744
"RTN","PSN565P1",414,0)
 ;;23785,70585
"RTN","PSN565P1",415,0)
 ;;23806,70793
"RTN","PSN565P1",416,0)
 ;;23812,11186
"RTN","PSN565P1",417,0)
 ;;23844,70705
"RTN","PSN565P1",418,0)
 ;;23848,3305
"RTN","PSN565P1",419,0)
 ;;23851,70870
"RTN","PSN565P1",420,0)
 ;;23854,70868
"RTN","PSN565P1",421,0)
 ;;23858,70938
"RTN","PSN565P1",422,0)
 ;;23859,70936
"RTN","PSN565P1",423,0)
 ;;23860,70937
"RTN","PSN565P1",424,0)
 ;;23864,70935
"RTN","PSN565P1",425,0)
 ;;23886,66131
"RTN","PSN565P1",426,0)
 ;;23904,67043
"RTN","PSN565P1",427,0)
 ;;23916,47690
"RTN","PSN565P1",428,0)
 ;;23937,63974
"RTN","PSN565P1",429,0)
 ;;23938,72622
"RTN","PSN565P1",430,0)
 ;;23945,70321
"RTN","PSN565P1",431,0)
 ;;23946,70320
"RTN","PSN565P1",432,0)
 ;;23954,65955
"RTN","PSN565P1",433,0)
 ;;23956,66474
"RTN","PSN565P1",434,0)
 ;;23960,66873
"RTN","PSN565P1",435,0)
 ;;23962,10488
"RTN","PSN565P1",436,0)
 ;;23965,77280
"RTN","PSN565P1",437,0)
 ;;23973,71025
"RTN","PSN565P1",438,0)
 ;;23974,69984
"RTN","PSN565P1",439,0)
 ;;23978,66872
"RTN","PSN565P1",440,0)
 ;;24013,40223
"RTN","PSN565P1",441,0)
 ;;24014,40224
"RTN","PSN565P1",442,0)
 ;;24035,66105
"RTN","PSN565P1",443,0)
 ;;24049,3304
"RTN","PSN565P1",444,0)
 ;;24054,71214
"RTN","PSN565P1",445,0)
 ;;24055,78412
"RTN","PSN565P1",446,0)
 ;;24056,71219
"RTN","PSN565P1",447,0)
 ;;24058,71220
"RTN","PSN565P1",448,0)
 ;;24061,72512
"RTN","PSN565P1",449,0)
 ;;24070,66372
"RTN","PSN565P1",450,0)
 ;;24081,78409
"RTN","PSN565P1",451,0)
 ;;24082,61375
"RTN","PSN565P1",452,0)
 ;;24099,66133
"RTN","PSN565P1",453,0)
 ;;24125,70978
"RTN","PSN565P1",454,0)
 ;;24126,71320
"RTN","PSN565P1",455,0)
 ;;24127,71321
"RTN","PSN565P1",456,0)
 ;;24128,71343
"RTN","PSN565P1",457,0)
 ;;24129,71344
"RTN","PSN565P1",458,0)
 ;;24130,71346
"RTN","PSN565P1",459,0)
 ;;24131,71347
"RTN","PSN565P1",460,0)
 ;;24147,70082
"RTN","PSN565P1",461,0)
 ;;24148,71337
"RTN","PSN565P1",462,0)
 ;;24152,71290
"RTN","PSN565P1",463,0)
 ;;24172,69036
"RTN","PSN565P1",464,0)
 ;;24188,70013
"RTN","PSN565P1",465,0)
 ;;24189,65779
"RTN","PSN565P1",466,0)
 ;;24193,62136
"RTN","PSN565P1",467,0)
 ;;24203,70839
"RTN","PSN565P1",468,0)
 ;;24241,47652
"RTN","PSN565P1",469,0)
 ;;24302,51668
"RTN","PSN565P1",470,0)
 ;;24337,71709
"RTN","PSN565P1",471,0)
 ;;24342,71708
"RTN","PSN565P1",472,0)
 ;;24373,68393
"RTN","PSN565P1",473,0)
 ;;24374,68394
"RTN","PSN565P1",474,0)
 ;;24375,68395
"RTN","PSN565P1",475,0)
 ;;24380,71756
"RTN","PSN565P1",476,0)
 ;;24409,66439
"RTN","PSN565P1",477,0)
 ;;24443,70255
"RTN","PSN565P1",478,0)
 ;;24514,60484
"RTN","PSN565P1",479,0)
 ;;24521,44162
"RTN","PSN565P1",480,0)
 ;;24545,16266
"RTN","PSN565P1",481,0)
 ;;24546,60469
"RTN","PSN565P1",482,0)
 ;;24561,1932
"RTN","PSN565P1",483,0)
 ;;24569,61864
"RTN","PSN565P1",484,0)
 ;;24570,62715
"RTN","PSN565P1",485,0)
 ;;24589,72134
"RTN","PSN565P1",486,0)
 ;;24593,68484
"RTN","PSN565P1",487,0)
 ;;24605,71809
"RTN","PSN565P1",488,0)
 ;;24611,6373
"RTN","PSN565P1",489,0)
 ;;24616,10474
"RTN","PSN565P1",490,0)
 ;;24627,1602
"RTN","PSN565P1",491,0)
 ;;24628,51756
"RTN","PSN565P1",492,0)
 ;;24644,72215
"RTN","PSN565P1",493,0)
 ;;24659,62496
"RTN","PSN565P1",494,0)
 ;;24684,61488
"RTN","PSN565P1",495,0)
 ;;24708,68300
"RTN","PSN565P1",496,0)
 ;;24712,72336
"RTN","PSN565P1",497,0)
 ;;24723,58044
"RTN","PSN565P1",498,0)
 ;;24725,58637
"RTN","PSN565P1",499,0)
 ;;24726,61373
"RTN","PSN565P1",500,0)
 ;;24727,18195
"RTN","PSN565P1",501,0)
 ;;24744,49828
"RTN","PSN565P1",502,0)
 ;;24840,58487
"RTN","PSN565P1",503,0)
 ;;24842,58487
"RTN","PSN565P1",504,0)
 ;;24845,58487
"RTN","PSN565P1",505,0)
 ;;24847,58489
"RTN","PSN565P1",506,0)
 ;;24851,58489
"RTN","PSN565P1",507,0)
 ;;24854,58488
"RTN","PSN565P1",508,0)
 ;;24857,58488
"RTN","PSN565P1",509,0)
 ;;24858,58488
"RTN","PSN565P1",510,0)
 ;;24878,72535
"RTN","PSN565P1",511,0)
 ;;24886,72533
"RTN","PSN565P1",512,0)
 ;;24888,59963
"RTN","PSN565P1",513,0)
 ;;24889,63058
"RTN","PSN565P1",514,0)
 ;;24896,39790
"RTN","PSN565P1",515,0)
 ;;24917,10474
"RTN","PSN565P1",516,0)
 ;;24918,72612
"RTN","PSN565P1",517,0)
 ;;24919,27481
"RTN","PSN565P1",518,0)
 ;;24926,72633
"RTN","PSN565P1",519,0)
 ;;24927,72634
"RTN","PSN565P1",520,0)
 ;;24931,72625
"RTN","PSN565P1",521,0)
 ;;24932,72624
"RTN","PSN565P1",522,0)
 ;;24934,72621
"RTN","PSN565P1",523,0)
 ;;24939,571
"RTN","PSN565P1",524,0)
 ;;24940,572
"RTN","PSN565P1",525,0)
 ;;24941,570
"RTN","PSN565P1",526,0)
 ;;24942,72414
"RTN","PSN565P1",527,0)
 ;;24952,72685
"RTN","PSN565P1",528,0)
 ;;24960,72671
"RTN","PSN565P1",529,0)
 ;;24980,72077
"RTN","PSN565P1",530,0)
 ;;24981,72077
"RTN","PSN565P1",531,0)
 ;;24982,72077
"RTN","PSN565P1",532,0)
 ;;25012,72584
"RTN","PSN565P1",533,0)
 ;;25044,72802
"RTN","PSN565P1",534,0)
 ;;25050,72740
"RTN","PSN565P1",535,0)
 ;;25078,62680
"RTN","PSN565P1",536,0)
 ;;25079,62680
"RTN","PSN565P1",537,0)
 ;;25080,72077
"RTN","PSN565P1",538,0)
 ;;25130,72767
"RTN","PSN565P1",539,0)
 ;;25139,72957
"RTN","PSN565P1",540,0)
 ;;25140,10472
"RTN","PSN565P1",541,0)
 ;;25145,11310
"RTN","PSN565P1",542,0)
 ;;25146,11299
"RTN","PSN565P1",543,0)
 ;;25149,72990
"RTN","PSN565P1",544,0)
 ;;25150,72991
"RTN","PSN565P1",545,0)
 ;;25159,63164
"RTN","PSN565P1",546,0)
 ;;25182,64189
"RTN","PSN565P1",547,0)
 ;;25200,73089
"RTN","PSN565P1",548,0)
 ;;25214,72957
"RTN","PSN565P1",549,0)
 ;;25215,72957
"RTN","PSN565P1",550,0)
 ;;25259,62504
"RTN","PSN565P1",551,0)
 ;;25294,73217
"RTN","PSN565P1",552,0)
 ;;25297,73186
"RTN","PSN565P1",553,0)
 ;;25298,73202
"RTN","PSN565P1",554,0)
 ;;25305,73143
"RTN","PSN565P1",555,0)
 ;;25306,73190
"RTN","PSN565P1",556,0)
 ;;25307,67826
"RTN","PSN565P1",557,0)
 ;;25312,73145
"RTN","PSN565P1",558,0)
 ;;25313,62064
"RTN","PSN565P1",559,0)
 ;;25330,73242
"RTN","PSN565P1",560,0)
 ;;25335,73245
"RTN","PSN565P1",561,0)
 ;;25359,73283
"RTN","PSN565P1",562,0)
 ;;25387,53106
"RTN","PSN565P1",563,0)
 ;;25398,73296
"RTN","PSN565P1",564,0)
 ;;25405,73327
"RTN","PSN565P1",565,0)
 ;;25420,73145
"RTN","PSN565P1",566,0)
 ;;25431,73339
"RTN","PSN565P1",567,0)
 ;;25432,60469
"RTN","PSN565P1",568,0)
 ;;25446,69995
"RTN","PSN565P1",569,0)
 ;;25451,71822
"RTN","PSN565P1",570,0)
 ;;25452,71821
"RTN","PSN565P1",571,0)
 ;;25454,73413
"RTN","PSN565P1",572,0)
 ;;25524,73486
"RTN","PSN565P1",573,0)
 ;;25525,73486
"RTN","PSN565P1",574,0)
 ;;25526,73487
"RTN","PSN565P1",575,0)
 ;;25527,73487
"RTN","PSN565P1",576,0)
 ;;25561,52831
"RTN","PSN565P1",577,0)
 ;;25570,68684
"RTN","PSN565P1",578,0)
 ;;25616,73231
"RTN","PSN565P1",579,0)
 ;;25622,73580
"RTN","PSN565P1",580,0)
 ;;25701,73883
"RTN","PSN565P1",581,0)
 ;;25737,52031
"RTN","PSN565P1",582,0)
 ;;25761,74166
"RTN","PSN565P1",583,0)
 ;;25763,60913
"RTN","PSN565P1",584,0)
 ;;25770,74186
"RTN","PSN565P1",585,0)
 ;;25797,40125
"RTN","PSN565P1",586,0)
 ;;25813,74310
"RTN","PSN565P1",587,0)
 ;;25827,72092
"RTN","PSN565P1",588,0)
 ;;25863,73369
"RTN","PSN565P1",589,0)
 ;;25865,73371
"RTN","PSN565P1",590,0)
 ;;25867,73368
"RTN","PSN565P1",591,0)
 ;;25897,74480
"RTN","PSN565P1",592,0)
 ;;25914,74510
"RTN","PSN565P1",593,0)
 ;;25916,74512
"RTN","PSN565P1",594,0)
 ;;25937,73265
"RTN","PSN565P1",595,0)
 ;;25938,73444
"RTN","PSN565P1",596,0)
 ;;25966,74113
"RTN","PSN565P1",597,0)
 ;;26013,70479
"RTN","PSN565P1",598,0)
 ;;26017,69871
"RTN","PSN565P1",599,0)
 ;;26038,74684
"RTN","PSN565P1",600,0)
 ;;26042,74468
"RTN","PSN565P1",601,0)
 ;;26043,74469
"RTN","PSN565P1",602,0)
 ;;26044,74467
"RTN","PSN565P1",603,0)
 ;;26049,36266
"RTN","PSN565P1",604,0)
 ;;26052,74709
"RTN","PSN565P1",605,0)
 ;;26067,26491
"RTN","PSN565P1",606,0)
 ;;26068,75796
"RTN","PSN565P1",607,0)
 ;;26084,74656
"RTN","PSN565P1",608,0)
 ;;26098,74821
"RTN","PSN565P1",609,0)
 ;;26099,74822
"RTN","PSN565P1",610,0)
 ;;26114,74888
"RTN","PSN565P1",611,0)
 ;;26121,74967
"RTN","PSN565P1",612,0)
 ;;26134,64797
"RTN","PSN565P1",613,0)
 ;;26135,66468
"RTN","PSN565P1",614,0)
 ;;26156,60988
"RTN","PSN565P1",615,0)
 ;;26196,5000
"RTN","PSN565P1",616,0)
 ;;26266,75118
"RTN","PSN565P1",617,0)
 ;;26285,45981
"RTN","PSN565P1",618,0)
 ;;26289,50172
"RTN","PSN565P1",619,0)
 ;;26303,45982
"RTN","PSN565P1",620,0)
 ;;26304,47318
"RTN","PSN565P1",621,0)
 ;;26305,24665
"RTN","PSN565P1",622,0)
 ;;26310,67685
"RTN","PSN565P1",623,0)
 ;;26311,67686
"RTN","PSN565P1",624,0)
 ;;26327,75151
"RTN","PSN565P1",625,0)
 ;;26360,1913
"RTN","PSN565P1",626,0)
 ;;26390,62137
"RTN","PSN565P1",627,0)
 ;;26391,62135
"RTN","PSN565P1",628,0)
 ;;26392,62136
"RTN","PSN565P1",629,0)
 ;;26398,74468
"RTN","PSN565P1",630,0)
 ;;26399,74469
"RTN","PSN565P1",631,0)
 ;;26400,74467
"RTN","PSN565P1",632,0)
 ;;26422,64721
"RTN","PSN565P1",633,0)
 ;;26426,1933
"RTN","PSN565P1",634,0)
 ;;26427,1933
"RTN","PSN565P1",635,0)
 ;;26446,69995
"RTN","PSN565P1",636,0)
 ;;26505,1913
"RTN","PSN565P1",637,0)
 ;;26513,66745
"RTN","PSN565P1",638,0)
 ;;26514,66745
"RTN","PSN565P1",639,0)
 ;;26522,66745
"RTN","PSN565P1",640,0)
 ;;26524,75265
"RTN","PSN565P1",641,0)
 ;;26533,75264
"RTN","PSN565P1",642,0)
 ;;26584,75467
"RTN","PSN565P1",643,0)
 ;;26585,75468
"RTN","PSN565P1",644,0)
 ;;26586,3699
"RTN","PSN565P1",645,0)
 ;;26846,75942
"RTN","PSN565P1",646,0)
 ;;26865,76023
"RTN","PSN565P1",647,0)
 ;;26902,5001
"RTN","PSN565P1",648,0)
 ;;26903,34359
"RTN","PSN565P1",649,0)
 ;;26913,76110
"RTN","PSN565P1",650,0)
 ;;26914,76111
"RTN","PSN565P1",651,0)
 ;;26915,76112
"RTN","PSN565P1",652,0)
 ;;26916,76113
"RTN","PSN565P1",653,0)
 ;;26917,76114
"RTN","PSN565P1",654,0)
 ;;26929,16643
"RTN","PSN565P1",655,0)
 ;;26937,4999
"RTN","PSN565P1",656,0)
 ;;27018,76315
"RTN","PSN565P1",657,0)
 ;;27048,76353
"RTN","PSN565P1",658,0)
 ;;27073,16963
"RTN","PSN565P1",659,0)
 ;;27165,6373
"RTN","PSN565P1",660,0)
 ;;27290,76295
"RTN","PSN565P1",661,0)
 ;;27295,76809
"RTN","PSN565P1",662,0)
 ;;27306,76823
"RTN","PSN565P1",663,0)
 ;;27436,4261
"RTN","PSN565P1",664,0)
 ;;27511,73506
"RTN","PSN565P1",665,0)
 ;;27546,77133
"RTN","PSN565P1",666,0)
 ;;27547,77132
"RTN","PSN565P1",667,0)
 ;;27553,4261
"RTN","PSN565P1",668,0)
 ;;27565,77202
"RTN","PSN565P1",669,0)
 ;;27572,77183
"RTN","PSN565P1",670,0)
 ;;27573,77184
"RTN","PSN565P1",671,0)
 ;;27574,77185
"RTN","PSN565P1",672,0)
 ;;27667,3293
"RTN","PSN565P1",673,0)
 ;;27725,77103
"RTN","PSN565P1",674,0)
 ;;27784,67327
"RTN","PSN565P1",675,0)
 ;;27803,67327
"RTN","PSN565P1",676,0)
 ;;27848,23885
"RTN","PSN565P1",677,0)
 ;;28034,67149
"RTN","PSN565P1",678,0)
 ;;28393,78438
"RTN","PSN565P1",679,0)
 ;
"RTN","PSN565PO")
0^^B185112151^n/a
"RTN","PSN565PO",1,0)
PSN565PO ;BIR/SJA-Post install routine for patch PSN*4*565 ; 02 Aug 2018  2:00 PM
"RTN","PSN565PO",2,0)
 ;;4.0;NATIONAL DRUG FILE;**565**; 30 Oct 98;Build 16
"RTN","PSN565PO",3,0)
 ;
"RTN","PSN565PO",4,0)
 Q
"RTN","PSN565PO",5,0)
POST ; entry point
"RTN","PSN565PO",6,0)
 N CNT,DATA,II,NAME,NODE1,PSNDA
"RTN","PSN565PO",7,0)
 S CNT=4 K ^TMP("PSN",$J)
"RTN","PSN565PO",8,0)
 D BMES^XPDUTL("  Starting post-install for PSN*4*565")
"RTN","PSN565PO",9,0)
 D BMES^XPDUTL("  Restore GCNSEQNO field for specific VA Products....")
"RTN","PSN565PO",10,0)
 F II=1:1 S DATA=$P($T(@("LIST+"_II_"^PSN565PO")),";;",2) Q:DATA=""  D
"RTN","PSN565PO",11,0)
 . S PSNDA=+DATA,NAME=$E($P($G(^PSNDF(50.68,PSNDA,0)),"^"),1,40),NODE1=$G(^PSNDF(50.68,PSNDA,1))
"RTN","PSN565PO",12,0)
 . I $D(^PSNDF(50.68,PSNDA,0)),'$P(NODE1,"^",5) S $P(^PSNDF(50.68,PSNDA,1),"^",5)=$E(1000000+$P(DATA,",",2),2,7) D
"RTN","PSN565PO",13,0)
 . . S CNT=CNT+1,^TMP("PSN",$J,CNT)=PSNDA_$J("",15-$L(PSNDA))_NAME_$J("",50-$L(NAME))_$E(1000000+$P(DATA,",",2),2,7)
"RTN","PSN565PO",14,0)
 D EN^PSN565P1
"RTN","PSN565PO",15,0)
 D MSG K ^TMP("PSN",$J)
"RTN","PSN565PO",16,0)
 ; delete routine PSN565P1
"RTN","PSN565PO",17,0)
 S X="PSN565P1" X ^%ZOSF("TEST") I $T D MES^XPDUTL("  Deleting routine "_X_"...") X ^%ZOSF("DEL")
"RTN","PSN565PO",18,0)
 D BMES^XPDUTL("  Finished post-install for PSN*4*565")
"RTN","PSN565PO",19,0)
 Q
"RTN","PSN565PO",20,0)
 ;
"RTN","PSN565PO",21,0)
MSG ; Sends Mailman message about updates
"RTN","PSN565PO",22,0)
 N XMX,XMSUB,XMDUZ,XMTEXT
"RTN","PSN565PO",23,0)
 S II=0 F  S II=$O(^XUSEC("PSNMGR",II)) Q:'II  S XMY(II)=""
"RTN","PSN565PO",24,0)
 S XMY(DUZ)="",XMSUB="PSN*4*565 - GCNSEQNO field Update"
"RTN","PSN565PO",25,0)
 S ^TMP("PSN",$J,1)="The post-install routine restored the GCNSEQNO field value for the following VA PRODUCT entries:"
"RTN","PSN565PO",26,0)
 S ^TMP("PSN",$J,2)=""
"RTN","PSN565PO",27,0)
 S ^TMP("PSN",$J,3)="VA Product #   Product Name                                      GCNSEQNO   "
"RTN","PSN565PO",28,0)
 S ^TMP("PSN",$J,4)="------------   ----------------------------------------          --------"
"RTN","PSN565PO",29,0)
 S:'$D(^TMP("PSN",$J,5)) ^TMP("PSN",$J,5)="No updates performed."
"RTN","PSN565PO",30,0)
 S XMDUZ=.5,XMTEXT="^TMP(""PSN"",$J," N DIFROM D ^XMD
"RTN","PSN565PO",31,0)
 Q
"RTN","PSN565PO",32,0)
LIST ; VA PRODUCT entries missing GCNSEQNO field
"RTN","PSN565PO",33,0)
 ;;1,4826
"RTN","PSN565PO",34,0)
 ;;30,4175
"RTN","PSN565PO",35,0)
 ;;38,4174
"RTN","PSN565PO",36,0)
 ;;61,224
"RTN","PSN565PO",37,0)
 ;;108,3577
"RTN","PSN565PO",38,0)
 ;;111,3586
"RTN","PSN565PO",39,0)
 ;;196,8873
"RTN","PSN565PO",40,0)
 ;;211,43349
"RTN","PSN565PO",41,0)
 ;;230,16065
"RTN","PSN565PO",42,0)
 ;;252,22345
"RTN","PSN565PO",43,0)
 ;;256,22345
"RTN","PSN565PO",44,0)
 ;;288,3262
"RTN","PSN565PO",45,0)
 ;;311,8809
"RTN","PSN565PO",46,0)
 ;;329,5053
"RTN","PSN565PO",47,0)
 ;;426,2142
"RTN","PSN565PO",48,0)
 ;;429,2118
"RTN","PSN565PO",49,0)
 ;;459,1220
"RTN","PSN565PO",50,0)
 ;;498,8084
"RTN","PSN565PO",51,0)
 ;;521,3147
"RTN","PSN565PO",52,0)
 ;;532,24137
"RTN","PSN565PO",53,0)
 ;;560,3603
"RTN","PSN565PO",54,0)
 ;;569,9283
"RTN","PSN565PO",55,0)
 ;;585,327
"RTN","PSN565PO",56,0)
 ;;586,326
"RTN","PSN565PO",57,0)
 ;;597,4278
"RTN","PSN565PO",58,0)
 ;;598,2549
"RTN","PSN565PO",59,0)
 ;;610,7480
"RTN","PSN565PO",60,0)
 ;;611,4647
"RTN","PSN565PO",61,0)
 ;;648,64586
"RTN","PSN565PO",62,0)
 ;;662,4261
"RTN","PSN565PO",63,0)
 ;;706,64537
"RTN","PSN565PO",64,0)
 ;;707,64539
"RTN","PSN565PO",65,0)
 ;;815,15536
"RTN","PSN565PO",66,0)
 ;;816,15537
"RTN","PSN565PO",67,0)
 ;;894,6997
"RTN","PSN565PO",68,0)
 ;;943,8295
"RTN","PSN565PO",69,0)
 ;;970,21205
"RTN","PSN565PO",70,0)
 ;;985,7682
"RTN","PSN565PO",71,0)
 ;;991,7679
"RTN","PSN565PO",72,0)
 ;;1027,26869
"RTN","PSN565PO",73,0)
 ;;1029,26869
"RTN","PSN565PO",74,0)
 ;;1073,3202
"RTN","PSN565PO",75,0)
 ;;1075,3203
"RTN","PSN565PO",76,0)
 ;;1079,3117
"RTN","PSN565PO",77,0)
 ;;1144,2492
"RTN","PSN565PO",78,0)
 ;;1145,48094
"RTN","PSN565PO",79,0)
 ;;1158,2251
"RTN","PSN565PO",80,0)
 ;;1164,63385
"RTN","PSN565PO",81,0)
 ;;1170,1386
"RTN","PSN565PO",82,0)
 ;;1177,39753
"RTN","PSN565PO",83,0)
 ;;1178,2511
"RTN","PSN565PO",84,0)
 ;;1196,39742
"RTN","PSN565PO",85,0)
 ;;1209,67478
"RTN","PSN565PO",86,0)
 ;;1210,2477
"RTN","PSN565PO",87,0)
 ;;1231,15466
"RTN","PSN565PO",88,0)
 ;;1260,2510
"RTN","PSN565PO",89,0)
 ;;1272,2477
"RTN","PSN565PO",90,0)
 ;;1283,42926
"RTN","PSN565PO",91,0)
 ;;1303,3167
"RTN","PSN565PO",92,0)
 ;;1327,3648
"RTN","PSN565PO",93,0)
 ;;1328,3656
"RTN","PSN565PO",94,0)
 ;;1341,4675
"RTN","PSN565PO",95,0)
 ;;1357,9218
"RTN","PSN565PO",96,0)
 ;;1358,9223
"RTN","PSN565PO",97,0)
 ;;1359,9219
"RTN","PSN565PO",98,0)
 ;;1365,15943
"RTN","PSN565PO",99,0)
 ;;1366,16815
"RTN","PSN565PO",100,0)
 ;;1404,63829
"RTN","PSN565PO",101,0)
 ;;1457,62033
"RTN","PSN565PO",102,0)
 ;;1461,2523
"RTN","PSN565PO",103,0)
 ;;1472,59703
"RTN","PSN565PO",104,0)
 ;;1475,2532
"RTN","PSN565PO",105,0)
 ;;1478,2470
"RTN","PSN565PO",106,0)
 ;;1480,2470
"RTN","PSN565PO",107,0)
 ;;1484,2475
"RTN","PSN565PO",108,0)
 ;;1488,2532
"RTN","PSN565PO",109,0)
 ;;1500,2522
"RTN","PSN565PO",110,0)
 ;;1501,2470
"RTN","PSN565PO",111,0)
 ;;1502,2523
"RTN","PSN565PO",112,0)
 ;;1514,2530
"RTN","PSN565PO",113,0)
 ;;1520,2532
"RTN","PSN565PO",114,0)
 ;;1522,2482
"RTN","PSN565PO",115,0)
 ;;1530,6440
"RTN","PSN565PO",116,0)
 ;;1534,6435
"RTN","PSN565PO",117,0)
 ;;1535,2470
"RTN","PSN565PO",118,0)
 ;;1541,2524
"RTN","PSN565PO",119,0)
 ;;1579,4755
"RTN","PSN565PO",120,0)
 ;;1631,59782
"RTN","PSN565PO",121,0)
 ;;1639,36045
"RTN","PSN565PO",122,0)
 ;;1640,36047
"RTN","PSN565PO",123,0)
 ;;1641,36046
"RTN","PSN565PO",124,0)
 ;;1651,66719
"RTN","PSN565PO",125,0)
 ;;1688,4767
"RTN","PSN565PO",126,0)
 ;;1715,48548
"RTN","PSN565PO",127,0)
 ;;1725,516
"RTN","PSN565PO",128,0)
 ;;1727,517
"RTN","PSN565PO",129,0)
 ;;1842,4167
"RTN","PSN565PO",130,0)
 ;;1855,4734
"RTN","PSN565PO",131,0)
 ;;1914,4521
"RTN","PSN565PO",132,0)
 ;;1921,4521
"RTN","PSN565PO",133,0)
 ;;1978,43762
"RTN","PSN565PO",134,0)
 ;;2168,45266
"RTN","PSN565PO",135,0)
 ;;2169,45266
"RTN","PSN565PO",136,0)
 ;;2173,5230
"RTN","PSN565PO",137,0)
 ;;2184,6503
"RTN","PSN565PO",138,0)
 ;;2317,66111
"RTN","PSN565PO",139,0)
 ;;2394,8366
"RTN","PSN565PO",140,0)
 ;;2409,8259
"RTN","PSN565PO",141,0)
 ;;2439,62665
"RTN","PSN565PO",142,0)
 ;;2486,4220
"RTN","PSN565PO",143,0)
 ;;2487,4222
"RTN","PSN565PO",144,0)
 ;;2488,4221
"RTN","PSN565PO",145,0)
 ;;2490,4223
"RTN","PSN565PO",146,0)
 ;;2590,3310
"RTN","PSN565PO",147,0)
 ;;2618,3314
"RTN","PSN565PO",148,0)
 ;;2621,3314
"RTN","PSN565PO",149,0)
 ;;2625,3314
"RTN","PSN565PO",150,0)
 ;;2770,6551
"RTN","PSN565PO",151,0)
 ;;2802,4515
"RTN","PSN565PO",152,0)
 ;;2803,4513
"RTN","PSN565PO",153,0)
 ;;2821,4217
"RTN","PSN565PO",154,0)
 ;;2833,17240
"RTN","PSN565PO",155,0)
 ;;2835,62407
"RTN","PSN565PO",156,0)
 ;;2884,65025
"RTN","PSN565PO",157,0)
 ;;2885,65028
"RTN","PSN565PO",158,0)
 ;;2963,23796
"RTN","PSN565PO",159,0)
 ;;2966,31755
"RTN","PSN565PO",160,0)
 ;;2971,48544
"RTN","PSN565PO",161,0)
 ;;2981,8818
"RTN","PSN565PO",162,0)
 ;;2984,8817
"RTN","PSN565PO",163,0)
 ;;2992,61483
"RTN","PSN565PO",164,0)
 ;;3004,4746
"RTN","PSN565PO",165,0)
 ;;3005,1272
"RTN","PSN565PO",166,0)
 ;;3070,25697
"RTN","PSN565PO",167,0)
 ;;3071,25698
"RTN","PSN565PO",168,0)
 ;;3094,93
"RTN","PSN565PO",169,0)
 ;;3200,8821
"RTN","PSN565PO",170,0)
 ;;3207,4024
"RTN","PSN565PO",171,0)
 ;;3225,64635
"RTN","PSN565PO",172,0)
 ;;3251,9278
"RTN","PSN565PO",173,0)
 ;;3286,8910
"RTN","PSN565PO",174,0)
 ;;3415,64266
"RTN","PSN565PO",175,0)
 ;;3465,65849
"RTN","PSN565PO",176,0)
 ;;3472,7650
"RTN","PSN565PO",177,0)
 ;;3484,7414
"RTN","PSN565PO",178,0)
 ;;3485,7415
"RTN","PSN565PO",179,0)
 ;;3506,4029
"RTN","PSN565PO",180,0)
 ;;3521,41745
"RTN","PSN565PO",181,0)
 ;;3551,7818
"RTN","PSN565PO",182,0)
 ;;3568,62018
"RTN","PSN565PO",183,0)
 ;;3569,62014
"RTN","PSN565PO",184,0)
 ;;3599,6209
"RTN","PSN565PO",185,0)
 ;;3603,75213
"RTN","PSN565PO",186,0)
 ;;3659,70911
"RTN","PSN565PO",187,0)
 ;;3725,4760
"RTN","PSN565PO",188,0)
 ;;3791,4291
"RTN","PSN565PO",189,0)
 ;;3825,60678
"RTN","PSN565PO",190,0)
 ;;3849,7409
"RTN","PSN565PO",191,0)
 ;;3857,38861
"RTN","PSN565PO",192,0)
 ;;3858,38861
"RTN","PSN565PO",193,0)
 ;;3859,38861
"RTN","PSN565PO",194,0)
 ;;4045,17179
"RTN","PSN565PO",195,0)
 ;;4069,63153
"RTN","PSN565PO",196,0)
 ;;4092,3237
"RTN","PSN565PO",197,0)
 ;;4147,15353
"RTN","PSN565PO",198,0)
 ;;4168,45669
"RTN","PSN565PO",199,0)
 ;;4173,59297
"RTN","PSN565PO",200,0)
 ;;4189,59216
"RTN","PSN565PO",201,0)
 ;;4216,7522
"RTN","PSN565PO",202,0)
 ;;4219,47096
"RTN","PSN565PO",203,0)
 ;;4236,3613
"RTN","PSN565PO",204,0)
 ;;4239,3617
"RTN","PSN565PO",205,0)
 ;;4256,130
"RTN","PSN565PO",206,0)
 ;;4257,132
"RTN","PSN565PO",207,0)
 ;;4259,133
"RTN","PSN565PO",208,0)
 ;;4265,170
"RTN","PSN565PO",209,0)
 ;;4266,48478
"RTN","PSN565PO",210,0)
 ;;4305,64271
"RTN","PSN565PO",211,0)
 ;;4357,59738
"RTN","PSN565PO",212,0)
 ;;4372,16025
"RTN","PSN565PO",213,0)
 ;;4376,2623
"RTN","PSN565PO",214,0)
 ;;4392,66497
"RTN","PSN565PO",215,0)
 ;;4410,4204
"RTN","PSN565PO",216,0)
 ;;4411,4199
"RTN","PSN565PO",217,0)
 ;;4412,4206
"RTN","PSN565PO",218,0)
 ;;4417,4207
"RTN","PSN565PO",219,0)
 ;;4418,4202
"RTN","PSN565PO",220,0)
 ;;4419,4205
"RTN","PSN565PO",221,0)
 ;;4420,16899
"RTN","PSN565PO",222,0)
 ;;4423,26439
"RTN","PSN565PO",223,0)
 ;;4529,3998
"RTN","PSN565PO",224,0)
 ;;4546,4503
"RTN","PSN565PO",225,0)
 ;;4560,6599
"RTN","PSN565PO",226,0)
 ;;4565,1707
"RTN","PSN565PO",227,0)
 ;;4638,3990
"RTN","PSN565PO",228,0)
 ;;4639,3987
"RTN","PSN565PO",229,0)
 ;;4640,3989
"RTN","PSN565PO",230,0)
 ;;4641,3991
"RTN","PSN565PO",231,0)
 ;;4644,4518
"RTN","PSN565PO",232,0)
 ;;4658,23446
"RTN","PSN565PO",233,0)
 ;;4687,3290
"RTN","PSN565PO",234,0)
 ;;4692,3294
"RTN","PSN565PO",235,0)
 ;;4693,3295
"RTN","PSN565PO",236,0)
 ;;4724,3295
"RTN","PSN565PO",237,0)
 ;;4733,7006
"RTN","PSN565PO",238,0)
 ;;4753,5810
"RTN","PSN565PO",239,0)
 ;;4754,5813
"RTN","PSN565PO",240,0)
 ;;4780,2348
"RTN","PSN565PO",241,0)
 ;;4848,910
"RTN","PSN565PO",242,0)
 ;;4867,749
"RTN","PSN565PO",243,0)
 ;;4928,652
"RTN","PSN565PO",244,0)
 ;;4933,66240
"RTN","PSN565PO",245,0)
 ;;4953,7806
"RTN","PSN565PO",246,0)
 ;;4982,7869
"RTN","PSN565PO",247,0)
 ;;4986,4836
"RTN","PSN565PO",248,0)
 ;;5067,4777
"RTN","PSN565PO",249,0)
 ;;5091,4901
"RTN","PSN565PO",250,0)
 ;;5093,45003
"RTN","PSN565PO",251,0)
 ;;5103,30255
"RTN","PSN565PO",252,0)
 ;;5112,29054
"RTN","PSN565PO",253,0)
 ;;5190,4385
"RTN","PSN565PO",254,0)
 ;;5266,6762
"RTN","PSN565PO",255,0)
 ;;5313,5763
"RTN","PSN565PO",256,0)
 ;;5317,5792
"RTN","PSN565PO",257,0)
 ;;5335,63556
"RTN","PSN565PO",258,0)
 ;;5338,63564
"RTN","PSN565PO",259,0)
 ;;5374,1242
"RTN","PSN565PO",260,0)
 ;;5388,62013
"RTN","PSN565PO",261,0)
 ;;5393,62014
"RTN","PSN565PO",262,0)
 ;;5394,62015
"RTN","PSN565PO",263,0)
 ;;5404,2018
"RTN","PSN565PO",264,0)
 ;;5405,48631
"RTN","PSN565PO",265,0)
 ;;5452,1965
"RTN","PSN565PO",266,0)
 ;;5518,1189
"RTN","PSN565PO",267,0)
 ;;5547,6364
"RTN","PSN565PO",268,0)
 ;;5599,48620
"RTN","PSN565PO",269,0)
 ;;5646,63537
"RTN","PSN565PO",270,0)
 ;;5647,1814
"RTN","PSN565PO",271,0)
 ;;5659,3376
"RTN","PSN565PO",272,0)
 ;;5662,1285
"RTN","PSN565PO",273,0)
 ;;5671,4535
"RTN","PSN565PO",274,0)
 ;;5672,4535
"RTN","PSN565PO",275,0)
 ;;5687,2013
"RTN","PSN565PO",276,0)
 ;;5699,2015
"RTN","PSN565PO",277,0)
 ;;5705,2012
"RTN","PSN565PO",278,0)
 ;;5767,1233
"RTN","PSN565PO",279,0)
 ;;5768,1233
"RTN","PSN565PO",280,0)
 ;;5776,20614
"RTN","PSN565PO",281,0)
 ;;5792,11990
"RTN","PSN565PO",282,0)
 ;;5817,996
"RTN","PSN565PO",283,0)
 ;;5819,16967
"RTN","PSN565PO",284,0)
 ;;5848,2380
"RTN","PSN565PO",285,0)
 ;;5897,53015
"RTN","PSN565PO",286,0)
 ;;5911,27826
"RTN","PSN565PO",287,0)
 ;;5913,13047
"RTN","PSN565PO",288,0)
 ;;6034,11644
"RTN","PSN565PO",289,0)
 ;;6039,8078
"RTN","PSN565PO",290,0)
 ;;6095,4458
"RTN","PSN565PO",291,0)
 ;;6114,62885
"RTN","PSN565PO",292,0)
 ;;6119,13675
"RTN","PSN565PO",293,0)
 ;;6130,1240
"RTN","PSN565PO",294,0)
 ;;6148,570
"RTN","PSN565PO",295,0)
 ;;6151,16849
"RTN","PSN565PO",296,0)
 ;;6152,16850
"RTN","PSN565PO",297,0)
 ;;6153,16572
"RTN","PSN565PO",298,0)
 ;;6155,16570
"RTN","PSN565PO",299,0)
 ;;6156,16571
"RTN","PSN565PO",300,0)
 ;;6157,17205
"RTN","PSN565PO",301,0)
 ;;6158,21282
"RTN","PSN565PO",302,0)
 ;;6159,24536
"RTN","PSN565PO",303,0)
 ;;6160,24537
"RTN","PSN565PO",304,0)
 ;;6161,24538
"RTN","PSN565PO",305,0)
 ;;6162,24539
"RTN","PSN565PO",306,0)
 ;;6163,24478
"RTN","PSN565PO",307,0)
 ;;6164,571
"RTN","PSN565PO",308,0)
 ;;6165,572
"RTN","PSN565PO",309,0)
 ;;6166,21282
"RTN","PSN565PO",310,0)
 ;;6180,4311
"RTN","PSN565PO",311,0)
 ;;6181,4312
"RTN","PSN565PO",312,0)
 ;;6225,2400
"RTN","PSN565PO",313,0)
 ;;6232,5000
"RTN","PSN565PO",314,0)
 ;;6234,47133
"RTN","PSN565PO",315,0)
 ;;6236,5001
"RTN","PSN565PO",316,0)
 ;;6273,1154
"RTN","PSN565PO",317,0)
 ;;6300,11663
"RTN","PSN565PO",318,0)
 ;;6402,1711
"RTN","PSN565PO",319,0)
 ;;6464,61353
"RTN","PSN565PO",320,0)
 ;;6484,6315
"RTN","PSN565PO",321,0)
 ;;6486,33862
"RTN","PSN565PO",322,0)
 ;;6489,6303
"RTN","PSN565PO",323,0)
 ;;6490,47875
"RTN","PSN565PO",324,0)
 ;;6543,8250
"RTN","PSN565PO",325,0)
 ;;6545,17000
"RTN","PSN565PO",326,0)
 ;;6562,25061
"RTN","PSN565PO",327,0)
 ;;6606,8893
"RTN","PSN565PO",328,0)
 ;;6607,8887
"RTN","PSN565PO",329,0)
 ;;6608,8889
"RTN","PSN565PO",330,0)
 ;;6609,8888
"RTN","PSN565PO",331,0)
 ;;6637,1515
"RTN","PSN565PO",332,0)
 ;;6640,4491
"RTN","PSN565PO",333,0)
 ;;6858,1688
"RTN","PSN565PO",334,0)
 ;;6871,45242
"RTN","PSN565PO",335,0)
 ;;6908,53698
"RTN","PSN565PO",336,0)
 ;;6980,48556
"RTN","PSN565PO",337,0)
 ;;7017,644
"RTN","PSN565PO",338,0)
 ;;7031,45243
"RTN","PSN565PO",339,0)
 ;;7032,45244
"RTN","PSN565PO",340,0)
 ;;7033,45243
"RTN","PSN565PO",341,0)
 ;;7046,1718
"RTN","PSN565PO",342,0)
 ;;7054,7601
"RTN","PSN565PO",343,0)
 ;;7077,2082
"RTN","PSN565PO",344,0)
 ;;7080,9582
"RTN","PSN565PO",345,0)
 ;;7081,9583
"RTN","PSN565PO",346,0)
 ;;7091,5737
"RTN","PSN565PO",347,0)
 ;;7094,5738
"RTN","PSN565PO",348,0)
 ;;7140,4114
"RTN","PSN565PO",349,0)
 ;;7175,16653
"RTN","PSN565PO",350,0)
 ;;7291,9676
"RTN","PSN565PO",351,0)
 ;;7309,3542
"RTN","PSN565PO",352,0)
 ;;7354,13021
"RTN","PSN565PO",353,0)
 ;;7380,48555
"RTN","PSN565PO",354,0)
 ;;7448,12076
"RTN","PSN565PO",355,0)
 ;;7474,48395
"RTN","PSN565PO",356,0)
 ;;7588,1340
"RTN","PSN565PO",357,0)
 ;;7644,19923
"RTN","PSN565PO",358,0)
 ;;7648,4747
"RTN","PSN565PO",359,0)
 ;;7673,7209
"RTN","PSN565PO",360,0)
 ;;7674,7216
"RTN","PSN565PO",361,0)
 ;;7685,13673
"RTN","PSN565PO",362,0)
 ;;7700,15762
"RTN","PSN565PO",363,0)
 ;;7761,61935
"RTN","PSN565PO",364,0)
 ;;7782,31427
"RTN","PSN565PO",365,0)
 ;;7819,9813
"RTN","PSN565PO",366,0)
 ;;7842,16879
"RTN","PSN565PO",367,0)
 ;;7878,8322
"RTN","PSN565PO",368,0)
 ;;7880,8321
"RTN","PSN565PO",369,0)
 ;;7882,5637
"RTN","PSN565PO",370,0)
 ;;7884,14291
"RTN","PSN565PO",371,0)
 ;;7894,15953
"RTN","PSN565PO",372,0)
 ;;7898,2701
"RTN","PSN565PO",373,0)
 ;;7916,5352
"RTN","PSN565PO",374,0)
 ;;7917,5350
"RTN","PSN565PO",375,0)
 ;;7918,64363
"RTN","PSN565PO",376,0)
 ;;7920,8515
"RTN","PSN565PO",377,0)
 ;;7921,5349
"RTN","PSN565PO",378,0)
 ;;7931,60636
"RTN","PSN565PO",379,0)
 ;;7946,65585
"RTN","PSN565PO",380,0)
 ;;7967,2948
"RTN","PSN565PO",381,0)
 ;;7980,16811
"RTN","PSN565PO",382,0)
 ;;7981,16812
"RTN","PSN565PO",383,0)
 ;;7982,16813
"RTN","PSN565PO",384,0)
 ;;7991,2984
"RTN","PSN565PO",385,0)
 ;;7992,2983
"RTN","PSN565PO",386,0)
 ;;8002,61709
"RTN","PSN565PO",387,0)
 ;;8051,64530
"RTN","PSN565PO",388,0)
 ;;8054,3046
"RTN","PSN565PO",389,0)
 ;;8061,35527
"RTN","PSN565PO",390,0)
 ;;8077,14134
"RTN","PSN565PO",391,0)
 ;;8078,63178
"RTN","PSN565PO",392,0)
 ;;8079,7993
"RTN","PSN565PO",393,0)
 ;;8080,14134
"RTN","PSN565PO",394,0)
 ;;8094,1602
"RTN","PSN565PO",395,0)
 ;;8096,63050
"RTN","PSN565PO",396,0)
 ;;8129,65583
"RTN","PSN565PO",397,0)
 ;;8156,9183
"RTN","PSN565PO",398,0)
 ;;8170,61254
"RTN","PSN565PO",399,0)
 ;;8225,7513
"RTN","PSN565PO",400,0)
 ;;8226,7546
"RTN","PSN565PO",401,0)
 ;;8241,48754
"RTN","PSN565PO",402,0)
 ;;8242,48754
"RTN","PSN565PO",403,0)
 ;;8281,1628
"RTN","PSN565PO",404,0)
 ;;8304,71662
"RTN","PSN565PO",405,0)
 ;;8319,33530
"RTN","PSN565PO",406,0)
 ;;8320,43136
"RTN","PSN565PO",407,0)
 ;;8434,25696
"RTN","PSN565PO",408,0)
 ;;8459,2681
"RTN","PSN565PO",409,0)
 ;;8469,7772
"RTN","PSN565PO",410,0)
 ;;8473,7785
"RTN","PSN565PO",411,0)
 ;;8490,2819
"RTN","PSN565PO",412,0)
 ;;8508,23759
"RTN","PSN565PO",413,0)
 ;;8527,46237
"RTN","PSN565PO",414,0)
 ;;8528,31439
"RTN","PSN565PO",415,0)
 ;;8577,2860
"RTN","PSN565PO",416,0)
 ;;8686,52108
"RTN","PSN565PO",417,0)
 ;;8694,2551
"RTN","PSN565PO",418,0)
 ;;8703,8640
"RTN","PSN565PO",419,0)
 ;;8738,8323
"RTN","PSN565PO",420,0)
 ;;8750,23473
"RTN","PSN565PO",421,0)
 ;;8754,3027
"RTN","PSN565PO",422,0)
 ;;8755,3027
"RTN","PSN565PO",423,0)
 ;;8767,3030
"RTN","PSN565PO",424,0)
 ;;8813,29260
"RTN","PSN565PO",425,0)
 ;;8826,15872
"RTN","PSN565PO",426,0)
 ;;8834,23187
"RTN","PSN565PO",427,0)
 ;;8870,14972
"RTN","PSN565PO",428,0)
 ;;8882,63623
"RTN","PSN565PO",429,0)
 ;;8890,22061
"RTN","PSN565PO",430,0)
 ;;8911,63178
"RTN","PSN565PO",431,0)
 ;;8912,63178
"RTN","PSN565PO",432,0)
 ;;8913,7993
"RTN","PSN565PO",433,0)
 ;;8939,5338
"RTN","PSN565PO",434,0)
 ;;8961,46293
"RTN","PSN565PO",435,0)
 ;;9049,5610
"RTN","PSN565PO",436,0)
 ;;9067,24168
"RTN","PSN565PO",437,0)
 ;;9089,16014
"RTN","PSN565PO",438,0)
 ;;9091,38335
"RTN","PSN565PO",439,0)
 ;;9134,70603
"RTN","PSN565PO",440,0)
 ;;9135,58644
"RTN","PSN565PO",441,0)
 ;;9269,5291
"RTN","PSN565PO",442,0)
 ;;9295,15906
"RTN","PSN565PO",443,0)
 ;;9375,7166
"RTN","PSN565PO",444,0)
 ;;9379,60663
"RTN","PSN565PO",445,0)
 ;;9406,8480
"RTN","PSN565PO",446,0)
 ;;9412,5352
"RTN","PSN565PO",447,0)
 ;;9461,1933
"RTN","PSN565PO",448,0)
 ;;9462,1933
"RTN","PSN565PO",449,0)
 ;;9464,1933
"RTN","PSN565PO",450,0)
 ;;9465,1913
"RTN","PSN565PO",451,0)
 ;;9466,1913
"RTN","PSN565PO",452,0)
 ;;9478,65369
"RTN","PSN565PO",453,0)
 ;;9492,13755
"RTN","PSN565PO",454,0)
 ;;9564,7233
"RTN","PSN565PO",455,0)
 ;;9616,8522
"RTN","PSN565PO",456,0)
 ;;9632,6042
"RTN","PSN565PO",457,0)
 ;;9639,23952
"RTN","PSN565PO",458,0)
 ;;9641,21704
"RTN","PSN565PO",459,0)
 ;;9726,47040
"RTN","PSN565PO",460,0)
 ;;9731,18368
"RTN","PSN565PO",461,0)
 ;;9745,16280
"RTN","PSN565PO",462,0)
 ;;9771,60113
"RTN","PSN565PO",463,0)
 ;;9847,74302
"RTN","PSN565PO",464,0)
 ;;9848,2849
"RTN","PSN565PO",465,0)
 ;;9879,14282
"RTN","PSN565PO",466,0)
 ;;9908,17206
"RTN","PSN565PO",467,0)
 ;;9962,7188
"RTN","PSN565PO",468,0)
 ;;9966,6939
"RTN","PSN565PO",469,0)
 ;;10017,5579
"RTN","PSN565PO",470,0)
 ;;10064,8522
"RTN","PSN565PO",471,0)
 ;;10132,48223
"RTN","PSN565PO",472,0)
 ;;10147,7284
"RTN","PSN565PO",473,0)
 ;;10183,11514
"RTN","PSN565PO",474,0)
 ;;11299,10468
"RTN","PSN565PO",475,0)
 ;;11574,61638
"RTN","PSN565PO",476,0)
 ;;11723,63927
"RTN","PSN565PO",477,0)
 ;;11750,8318
"RTN","PSN565PO",478,0)
 ;;11815,46403
"RTN","PSN565PO",479,0)
 ;;11930,66298
"RTN","PSN565PO",480,0)
 ;;11935,66299
"RTN","PSN565PO",481,0)
 ;;12147,21905
"RTN","PSN565PO",482,0)
 ;;12235,11483
"RTN","PSN565PO",483,0)
 ;;12253,22503
"RTN","PSN565PO",484,0)
 ;;12359,24055
"RTN","PSN565PO",485,0)
 ;;12404,5579
"RTN","PSN565PO",486,0)
 ;;12504,5527
"RTN","PSN565PO",487,0)
 ;;12505,5527
"RTN","PSN565PO",488,0)
 ;;12520,17608
"RTN","PSN565PO",489,0)
 ;;12521,24472
"RTN","PSN565PO",490,0)
 ;;12611,27905
"RTN","PSN565PO",491,0)
 ;;12613,26488
"RTN","PSN565PO",492,0)
 ;;12615,26489
"RTN","PSN565PO",493,0)
 ;;12625,30367
"RTN","PSN565PO",494,0)
 ;;12639,28218
"RTN","PSN565PO",495,0)
 ;;12654,63690
"RTN","PSN565PO",496,0)
 ;;12674,29123
"RTN","PSN565PO",497,0)
 ;;12675,1913
"RTN","PSN565PO",498,0)
 ;;12730,27547
"RTN","PSN565PO",499,0)
 ;;12758,64645
"RTN","PSN565PO",500,0)
 ;;12759,64644
"RTN","PSN565PO",501,0)
 ;;12771,41445
"RTN","PSN565PO",502,0)
 ;;12772,41650
"RTN","PSN565PO",503,0)
 ;;12787,45742
"RTN","PSN565PO",504,0)
 ;;12789,45740
"RTN","PSN565PO",505,0)
 ;;12812,37038
"RTN","PSN565PO",506,0)
 ;;12813,37039
"RTN","PSN565PO",507,0)
 ;;12829,39548
"RTN","PSN565PO",508,0)
 ;;12843,39138
"RTN","PSN565PO",509,0)
 ;;12877,30931
"RTN","PSN565PO",510,0)
 ;;12880,46239
"RTN","PSN565PO",511,0)
 ;;12881,46238
"RTN","PSN565PO",512,0)
 ;;12902,37919
"RTN","PSN565PO",513,0)
 ;;12903,37919
"RTN","PSN565PO",514,0)
 ;;12952,4999
"RTN","PSN565PO",515,0)
 ;;12964,19398
"RTN","PSN565PO",516,0)
 ;;12973,3971
"RTN","PSN565PO",517,0)
 ;;12975,44968
"RTN","PSN565PO",518,0)
 ;;12977,40901
"RTN","PSN565PO",519,0)
 ;;12997,58487
"RTN","PSN565PO",520,0)
 ;;12998,58488
"RTN","PSN565PO",521,0)
 ;;13002,40966
"RTN","PSN565PO",522,0)
 ;;13058,24537
"RTN","PSN565PO",523,0)
 ;;13059,24538
"RTN","PSN565PO",524,0)
 ;;13060,24539
"RTN","PSN565PO",525,0)
 ;;13061,24478
"RTN","PSN565PO",526,0)
 ;;13069,11186
"RTN","PSN565PO",527,0)
 ;;13070,16242
"RTN","PSN565PO",528,0)
 ;;13078,23472
"RTN","PSN565PO",529,0)
 ;;13079,40366
"RTN","PSN565PO",530,0)
 ;;13080,23471
"RTN","PSN565PO",531,0)
 ;;13081,3202
"RTN","PSN565PO",532,0)
 ;;13082,3203
"RTN","PSN565PO",533,0)
 ;;13144,65779
"RTN","PSN565PO",534,0)
 ;;13150,23127
"RTN","PSN565PO",535,0)
 ;;13241,71695
"RTN","PSN565PO",536,0)
 ;;13257,23023
"RTN","PSN565PO",537,0)
 ;;13287,16242
"RTN","PSN565PO",538,0)
 ;;13288,16242
"RTN","PSN565PO",539,0)
 ;;13307,41644
"RTN","PSN565PO",540,0)
 ;;13310,24168
"RTN","PSN565PO",541,0)
 ;;13314,22914
"RTN","PSN565PO",542,0)
 ;;13353,34731
"RTN","PSN565PO",543,0)
 ;;13455,27548
"RTN","PSN565PO",544,0)
 ;;13456,27550
"RTN","PSN565PO",545,0)
 ;;13465,22914
"RTN","PSN565PO",546,0)
 ;;13472,63533
"RTN","PSN565PO",547,0)
 ;;13509,42663
"RTN","PSN565PO",548,0)
 ;;13563,21282
"RTN","PSN565PO",549,0)
 ;;13564,16570
"RTN","PSN565PO",550,0)
 ;;13565,16571
"RTN","PSN565PO",551,0)
 ;;13568,41700
"RTN","PSN565PO",552,0)
 ;;13613,2482
"RTN","PSN565PO",553,0)
 ;;13688,266
"RTN","PSN565PO",554,0)
 ;;13692,7225
"RTN","PSN565PO",555,0)
 ;;13721,23129
"RTN","PSN565PO",556,0)
 ;;13729,41698
"RTN","PSN565PO",557,0)
 ;;13751,11186
"RTN","PSN565PO",558,0)
 ;;13782,4439
"RTN","PSN565PO",559,0)
 ;;13790,10458
"RTN","PSN565PO",560,0)
 ;;13795,5633
"RTN","PSN565PO",561,0)
 ;;13813,68636
"RTN","PSN565PO",562,0)
 ;;13822,9846
"RTN","PSN565PO",563,0)
 ;;13858,26490
"RTN","PSN565PO",564,0)
 ;;13870,63717
"RTN","PSN565PO",565,0)
 ;;13876,42800
"RTN","PSN565PO",566,0)
 ;;13879,43879
"RTN","PSN565PO",567,0)
 ;;13961,38264
"RTN","PSN565PO",568,0)
 ;;13977,5125
"RTN","PSN565PO",569,0)
 ;;14038,32174
"RTN","PSN565PO",570,0)
 ;;14039,32600
"RTN","PSN565PO",571,0)
 ;;14067,59459
"RTN","PSN565PO",572,0)
 ;;14200,1933
"RTN","PSN565PO",573,0)
 ;;14201,63940
"RTN","PSN565PO",574,0)
 ;;14214,73689
"RTN","PSN565PO",575,0)
 ;;14282,37029
"RTN","PSN565PO",576,0)
 ;;14293,43761
"RTN","PSN565PO",577,0)
 ;;14294,43760
"RTN","PSN565PO",578,0)
 ;;14331,49375
"RTN","PSN565PO",579,0)
 ;;14389,47608
"RTN","PSN565PO",580,0)
 ;;14477,50836
"RTN","PSN565PO",581,0)
 ;;14483,42966
"RTN","PSN565PO",582,0)
 ;;14484,34359
"RTN","PSN565PO",583,0)
 ;;14544,23882
"RTN","PSN565PO",584,0)
 ;;14545,23881
"RTN","PSN565PO",585,0)
 ;;14579,30007
"RTN","PSN565PO",586,0)
 ;;14580,1913
"RTN","PSN565PO",587,0)
 ;;14581,44337
"RTN","PSN565PO",588,0)
 ;;14590,7663
"RTN","PSN565PO",589,0)
 ;;14600,46484
"RTN","PSN565PO",590,0)
 ;;14603,46698
"RTN","PSN565PO",591,0)
 ;;14619,46942
"RTN","PSN565PO",592,0)
 ;;14620,46754
"RTN","PSN565PO",593,0)
 ;;14625,63189
"RTN","PSN565PO",594,0)
 ;;14626,47021
"RTN","PSN565PO",595,0)
 ;;14708,46295
"RTN","PSN565PO",596,0)
 ;;14722,8111
"RTN","PSN565PO",597,0)
 ;;14769,3590
"RTN","PSN565PO",598,0)
 ;;14896,23881
"RTN","PSN565PO",599,0)
 ;;14899,3656
"RTN","PSN565PO",600,0)
 ;;14900,47429
"RTN","PSN565PO",601,0)
 ;;14916,3295
"RTN","PSN565PO",602,0)
 ;;14919,24441
"RTN","PSN565PO",603,0)
 ;;14963,42081
"RTN","PSN565PO",604,0)
 ;;14964,42082
"RTN","PSN565PO",605,0)
 ;;14965,44853
"RTN","PSN565PO",606,0)
 ;;15022,47323
"RTN","PSN565PO",607,0)
 ;;15055,3313
"RTN","PSN565PO",608,0)
 ;;15071,47318
"RTN","PSN565PO",609,0)
 ;;15072,45981
"RTN","PSN565PO",610,0)
 ;;15073,45982
"RTN","PSN565PO",611,0)
 ;;15075,47525
"RTN","PSN565PO",612,0)
 ;;15077,47526
"RTN","PSN565PO",613,0)
 ;;15099,37754
"RTN","PSN565PO",614,0)
 ;;15102,53036
"RTN","PSN565PO",615,0)
 ;;15132,25621
"RTN","PSN565PO",616,0)
 ;;15162,40224
"RTN","PSN565PO",617,0)
 ;;15163,40223
"RTN","PSN565PO",618,0)
 ;;15165,48077
"RTN","PSN565PO",619,0)
 ;;15181,62817
"RTN","PSN565PO",620,0)
 ;;15183,43899
"RTN","PSN565PO",621,0)
 ;;15198,2582
"RTN","PSN565PO",622,0)
 ;;15199,3290
"RTN","PSN565PO",623,0)
 ;;15254,572
"RTN","PSN565PO",624,0)
 ;;15333,47452
"RTN","PSN565PO",625,0)
 ;;15363,571
"RTN","PSN565PO",626,0)
 ;;15370,13648
"RTN","PSN565PO",627,0)
 ;;15371,13649
"RTN","PSN565PO",628,0)
 ;;15425,1913
"RTN","PSN565PO",629,0)
 ;;15426,1913
"RTN","PSN565PO",630,0)
 ;;15427,1913
"RTN","PSN565PO",631,0)
 ;;15453,48456
"RTN","PSN565PO",632,0)
 ;;15454,48456
"RTN","PSN565PO",633,0)
 ;;15456,48978
"RTN","PSN565PO",634,0)
 ;;15476,47763
"RTN","PSN565PO",635,0)
 ;;15479,49828
"RTN","PSN565PO",636,0)
 ;;15508,31376
"RTN","PSN565PO",637,0)
 ;;15519,51202
"RTN","PSN565PO",638,0)
 ;;15561,44226
"RTN","PSN565PO",639,0)
 ;;15575,19
"RTN","PSN565PO",640,0)
 ;;15595,26491
"RTN","PSN565PO",641,0)
 ;;15613,2797
"RTN","PSN565PO",642,0)
 ;;15657,65981
"RTN","PSN565PO",643,0)
 ;;15695,1913
"RTN","PSN565PO",644,0)
 ;;15696,1913
"RTN","PSN565PO",645,0)
 ;;15697,1913
"RTN","PSN565PO",646,0)
 ;;15731,16242
"RTN","PSN565PO",647,0)
 ;;15772,64875
"RTN","PSN565PO",648,0)
 ;;15897,50172
"RTN","PSN565PO",649,0)
 ;;15923,47132
"RTN","PSN565PO",650,0)
 ;;15924,50327
"RTN","PSN565PO",651,0)
 ;;15931,22925
"RTN","PSN565PO",652,0)
 ;;15933,47965
"RTN","PSN565PO",653,0)
 ;;15957,43763
"RTN","PSN565PO",654,0)
 ;;16090,53057
"RTN","PSN565PO",655,0)
 ;;16091,53059
"RTN","PSN565PO",656,0)
 ;;16092,53060
"RTN","PSN565PO",657,0)
 ;;16093,53061
"RTN","PSN565PO",658,0)
 ;;16198,50805
"RTN","PSN565PO",659,0)
 ;;16237,30763
"RTN","PSN565PO",660,0)
 ;;16252,51916
"RTN","PSN565PO",661,0)
 ;;16260,50496
"RTN","PSN565PO",662,0)
 ;;16266,16242
"RTN","PSN565PO",663,0)
 ;;16267,16242
"RTN","PSN565PO",664,0)
 ;;16268,50102
"RTN","PSN565PO",665,0)
 ;;16327,52746
"RTN","PSN565PO",666,0)
 ;;16349,1933
"RTN","PSN565PO",667,0)
 ;;16353,5577
"RTN","PSN565PO",668,0)
 ;;16358,49718
"RTN","PSN565PO",669,0)
 ;;16359,52890
"RTN","PSN565PO",670,0)
 ;;16360,52892
"RTN","PSN565PO",671,0)
 ;;16361,52891
"RTN","PSN565PO",672,0)
 ;;16377,65513
"RTN","PSN565PO",673,0)
 ;;16384,51883
"RTN","PSN565PO",674,0)
 ;;16416,10959
"RTN","PSN565PO",675,0)
 ;;16445,52050
"RTN","PSN565PO",676,0)
 ;;16455,64331
"RTN","PSN565PO",677,0)
 ;;16458,53006
"RTN","PSN565PO",678,0)
 ;;16459,53007
"RTN","PSN565PO",679,0)
 ;;16468,24555
"RTN","PSN565PO",680,0)
 ;;16469,3202
"RTN","PSN565PO",681,0)
 ;;16470,23270
"RTN","PSN565PO",682,0)
 ;;16471,3203
"RTN","PSN565PO",683,0)
 ;;16472,16767
"RTN","PSN565PO",684,0)
 ;;16476,24536
"RTN","PSN565PO",685,0)
 ;;16477,24537
"RTN","PSN565PO",686,0)
 ;;16478,24538
"RTN","PSN565PO",687,0)
 ;;16479,24539
"RTN","PSN565PO",688,0)
 ;;16480,24478
"RTN","PSN565PO",689,0)
 ;;16484,13657
"RTN","PSN565PO",690,0)
 ;;16509,21742
"RTN","PSN565PO",691,0)
 ;;16556,50220
"RTN","PSN565PO",692,0)
 ;;16557,50219
"RTN","PSN565PO",693,0)
 ;;16569,45877
"RTN","PSN565PO",694,0)
 ;;16570,58878
"RTN","PSN565PO",695,0)
 ;;16571,58877
"RTN","PSN565PO",696,0)
 ;;16572,58880
"RTN","PSN565PO",697,0)
 ;;16627,48738
"RTN","PSN565PO",698,0)
 ;;16686,16399
"RTN","PSN565PO",699,0)
 ;;16704,2940
"RTN","PSN565PO",700,0)
 ;;16721,45878
"RTN","PSN565PO",701,0)
 ;;16722,58877
"RTN","PSN565PO",702,0)
 ;;16723,48815
"RTN","PSN565PO",703,0)
 ;;16747,49607
"RTN","PSN565PO",704,0)
 ;;16774,51990
"RTN","PSN565PO",705,0)
 ;;16781,52831
"RTN","PSN565PO",706,0)
 ;;16823,60306
"RTN","PSN565PO",707,0)
 ;;16839,27549
"RTN","PSN565PO",708,0)
 ;;16853,57893
"RTN","PSN565PO",709,0)
 ;;16878,57859
"RTN","PSN565PO",710,0)
 ;;16882,57865
"RTN","PSN565PO",711,0)
 ;;16884,57864
"RTN","PSN565PO",712,0)
 ;;16885,57863
"RTN","PSN565PO",713,0)
 ;;16892,38375
"RTN","PSN565PO",714,0)
 ;;16909,58345
"RTN","PSN565PO",715,0)
 ;;16914,49261
"RTN","PSN565PO",716,0)
 ;;16961,49742
"RTN","PSN565PO",717,0)
 ;;16963,27592
"RTN","PSN565PO",718,0)
 ;;16968,39790
"RTN","PSN565PO",719,0)
 ;;16971,40224
"RTN","PSN565PO",720,0)
 ;;16972,40223
"RTN","PSN565PO",721,0)
 ;;16979,23471
"RTN","PSN565PO",722,0)
 ;;16980,23472
"RTN","PSN565PO",723,0)
 ;;16986,60005
"RTN","PSN565PO",724,0)
 ;
"RTN","PSNPPSCL")
0^3^B48603605^B48571285
"RTN","PSNPPSCL",1,0)
PSNPPSCL ;BIR/DMA-clean up ingredients and interactions ; 19 Aug 2008  9:42 AM
"RTN","PSNPPSCL",2,0)
 ;;4.0;NATIONAL DRUG FILE;**513,565**;  30 Oct 98;Build 16
"RTN","PSNPPSCL",3,0)
 ;Reference to ^GMR(120.8 supported by DBIA #2545
"RTN","PSNPPSCL",4,0)
 ;Reference to ^PS(59.7 supported by DBIA #2613
"RTN","PSNPPSCL",5,0)
 ;
"RTN","PSNPPSCL",6,0)
 N DA,DIE,DIK,DR,J,LINE,NA,NEWDA,PSN,PSNDA,PSNI,PSNI1,PSNI1N,PSNI1P,PSNI2,PSNI2N,PSNI2P,PSNN,PSNK,PSNPAT,PSNX,X,XMDUZ,XMSUB,XMTEXT,XMY,PSNLEG
"RTN","PSNPPSCL",7,0)
 K ^TMP($J),^TMP("PSN",$J)
"RTN","PSNPPSCL",8,0)
INTER ;CHECK FOR NON-PRIMARIES
"RTN","PSNPPSCL",9,0)
 S LINE=1
"RTN","PSNPPSCL",10,0)
 I $G(PSNHLD)'="" S ^TMP("PSN",$J,LINE,0)="PPS-N Update File: "_$P(PSNHLD,";",1),LINE=LINE+1,^TMP("PSN",$J,LINE,0)=""   ;add filename to top of file
"RTN","PSNPPSCL",11,0)
 D ENABLE^PSNPPSMS ;enable menu options - PBM decided this is where they want this to happen.
"RTN","PSNPPSCL",12,0)
 I $G(PSNSITET)'="" D CTRKDL^PSNPPSMS("Processing Interactions")
"RTN","PSNPPSCL",13,0)
 W:'$G(PSNSCJOB) !,"Processing Interactions...",!
"RTN","PSNPPSCL",14,0)
 S (PSNI1N,PSNI2N)="",DA=0 F  S DA=$O(^PS(56,DA)) Q:'DA  S X=^(DA,0),PSNI1=$P(X,"^",2),PSNI2=$P(X,"^",3),PSNI1N=$P(^PS(50.416,PSNI1,0),"^",2) D
"RTN","PSNPPSCL",15,0)
 .I 'PSNI1N,'PSNI2N Q
"RTN","PSNPPSCL",16,0)
 .S PSNI2N=$P(^PS(50.416,PSNI2,0),"^",2)
"RTN","PSNPPSCL",17,0)
 .S PSNI1P=$S('PSNI1N:PSNI1,1:PSNI1N),PSNI2P=$S('PSNI2N:PSNI2,1:PSNI2N)
"RTN","PSNPPSCL",18,0)
 .I '$D(^PS(56,"AE",PSNI1P,PSNI2P)) D  Q
"RTN","PSNPPSCL",19,0)
 ..;NO PRE-EXISTING INTERACTION - RENAME AND QUIT
"RTN","PSNPPSCL",20,0)
 ..K PSN,PSNN S PSN($P(^PS(50.416,PSNI1P,0),"^"))="",PSN($P(^PS(50.416,PSNI2P,0),"^"))="",PSNN=$O(PSN(""))_"/"_$O(PSN($O(PSN("")))),^TMP($J,"RENAM",$P(X,"^")_"^"_PSNN)="",DIE="^PS(56,",DR=".01////"_PSNN D ^DIE
"RTN","PSNPPSCL",21,0)
 ..K ^PS(56,"AI1",PSNI1,DA),^PS(56,"AI2",PSNI2,DA),^PS(56,"AE",PSNI1,PSNI2,DA),^PS(56,"AE",PSNI2,PSNI1,DA) S (^PS(56,"AI1",PSNI1P,DA),^PS(56,"AI2",PSNI2P,DA),^PS(56,"AE",PSNI1P,PSNI2P,DA),^PS(56,"AE",PSNI2P,PSNI1P,DA))=""
"RTN","PSNPPSCL",22,0)
 ..S $P(^PS(56,DA,0),"^",2,3)=PSNI1P_"^"_PSNI2P
"RTN","PSNPPSCL",23,0)
 .;PRE-EXISTING INTERACTIONS - LOG TO DELETE
"RTN","PSNPPSCL",24,0)
 .S NEWDA=$QS($Q(^PS(56,"AE",PSNI1P,PSNI2P)),5) D
"RTN","PSNPPSCL",25,0)
 ..S ^TMP($J,"DEL",$P(X,"^"))="",^TMP($J,"DELIEN",DA)=NEWDA
"RTN","PSNPPSCL",26,0)
 ;NOW DELETE AND REPOINT
"RTN","PSNPPSCL",27,0)
 S PSN=0 F  S PSN=$O(^TMP($J,"DELIEN",PSN)) Q:'PSN  S X=^PS(56,PSN,0),PSNI1=$P(X,"^",2),PSNI2=$P(X,"^",3),$P(^PS(56,PSN,0),"^",2,7)="" K ^PS(56,"AI1",PSNI1,PSN),^PS(56,"AI2",PSNI2,PSN),^PS(56,"AE",PSNI1,PSNI2,PSN),^PS(56,"AE",PSNI2,PSNI1,PSN)
"RTN","PSNPPSCL",28,0)
 ;NOW THE APD
"RTN","PSNPPSCL",29,0)
 S X="^PS(56,""APD"")" F  S X=$Q(@X) Q:$QS(X,2)'="APD"  I $D(^TMP($J,"DELIEN",$QS(X,5))) S NEWDA=^($QS(X,5)) K @X,^PS(56,"APD",$QS(X,4),$QS(X,3),$QS(X,5)) S (^PS(56,"APD",$QS(X,3),$QS(X,4),NEWDA),^PS(56,"APD",$QS(X,4),$QS(X,3),NEWDA))=""
"RTN","PSNPPSCL",30,0)
 ;NOW THE 0 NODE
"RTN","PSNPPSCL",31,0)
 S PSN=0 F  S PSN=$O(^TMP($J,"DELIEN",PSN)) Q:'PSN  S DIK="^PS(56,",DA=PSN D ^DIK
"RTN","PSNPPSCL",32,0)
 ;
"RTN","PSNPPSCL",33,0)
 I '$D(^TMP($J,"DEL")),'$D(^("RENAM")) D  G ALLER
"RTN","PSNPPSCL",34,0)
 .F J=1:1 S X=$P($T(TEXT4+J),";",3,300) Q:X=""  S LINE=LINE+1,^TMP("PSN",$J,LINE,0)=X
"RTN","PSNPPSCL",35,0)
 F J=1:1 S X=$P($T(TEXT+J),";",3,300) Q:X=""  S LINE=LINE+1,^TMP("PSN",$J,LINE,0)=X
"RTN","PSNPPSCL",36,0)
 I '$D(^TMP($J,"RENAM")) S ^TMP("PSN",$J,LINE,0)=" ",^TMP("PSN",$J,LINE+1,0)="none found",LINE=LINE+2
"RTN","PSNPPSCL",37,0)
 S NA="" F  S NA=$O(^TMP($J,"RENAM",NA)) Q:NA=""  S ^TMP("PSN",$J,LINE,0)=$P(NA,"^")_" was changed to",^TMP("PSN",$J,LINE+1,0)="   "_$P(NA,"^",2),^TMP("PSN",$J,LINE+2,0)=" ",LINE=LINE+3
"RTN","PSNPPSCL",38,0)
 F J=1:1 S X=$P($T(TEXT2+J),";",3,300) Q:X=""  S ^TMP("PSN",$J,LINE,0)=X,LINE=LINE+1
"RTN","PSNPPSCL",39,0)
 I '$D(^TMP($J,"DEL")) S ^TMP("PSN",$J,LINE,0)="none found",LINE=LINE+1
"RTN","PSNPPSCL",40,0)
 S NA="" F  S NA=$O(^TMP($J,"DEL",NA)) Q:NA=""  S ^TMP("PSN",$J,LINE,0)=NA,LINE=LINE+1
"RTN","PSNPPSCL",41,0)
ALLER ;now the allergies
"RTN","PSNPPSCL",42,0)
 I $G(PSNSITET)'="" D CTRKDL^PSNPPSMS("Processing allergies")
"RTN","PSNPPSCL",43,0)
 W:'$G(PSNSCJOB) !,"Processing allergies...",!
"RTN","PSNPPSCL",44,0)
 I ^XMB("NETNAME")["CMOP" G SENDIT
"RTN","PSNPPSCL",45,0)
 ;skip allergies for CMOPs
"RTN","PSNPPSCL",46,0)
 K ^TMP($J)
"RTN","PSNPPSCL",47,0)
 S PSNDA=0 F  S PSNDA=$O(^GMR(120.8,PSNDA)) Q:'PSNDA  I $D(^(PSNDA,0)) S PSNPAT=+^(0) I $D(^DPT(PSNPAT,0)) S PSNPAT=$P(^(0),"^"),PSNI=$P(^GMR(120.8,PSNDA,0),"^",3) D
"RTN","PSNPPSCL",48,0)
 .I PSNI["PS(50.416",$D(^PS(50.416,+PSNI,0)),$P(^(0),"^",2) S PSNI=$P(^(0),"^",2)_";PS(50.416,",$P(^GMR(120.8,PSNDA,0),"^",3)=PSNI
"RTN","PSNPPSCL",49,0)
 .S PSNK=0 F  S PSNK=$O(^GMR(120.8,PSNDA,2,PSNK)) Q:'PSNK  S PSNI=^(PSNK,0) D
"RTN","PSNPPSCL",50,0)
 ..S PSNX=$P(^PS(50.416,PSNI,0),"^",2) I PSNX S DA(1)=PSNDA,DA=PSNK,DIE="^GMR(120.8,DA(1),2,",DR=".01////"_$S($D(^GMR(120.8,DA(1),2,"B",PSNX)):"@",1:PSNX) D ^DIE S ^TMP($J,1,PSNPAT,$P(^PS(50.416,PSNI,0),"^")_"^"_$P(^PS(50.416,PSNX,0),"^"))=""
"RTN","PSNPPSCL",51,0)
 ;
"RTN","PSNPPSCL",52,0)
 I '$D(^TMP($J,1)) D  G SENDIT
"RTN","PSNPPSCL",53,0)
 .F J=1:1 S X=$P($T(TEXT5+J),";",3,300) Q:X=""  S ^TMP("PSN",$J,LINE,0)=X,LINE=LINE+1
"RTN","PSNPPSCL",54,0)
 F J=1:1 S X=$P($T(TEXT3+J),";",3,300) Q:X=""  S ^TMP("PSN",$J,LINE,0)=X,LINE=LINE+1
"RTN","PSNPPSCL",55,0)
 I '$D(^TMP($J,1)) S ^TMP("PSN",$J,LINE,0)="none found",LINE=LINE+1
"RTN","PSNPPSCL",56,0)
 S NA="" F  S NA=$O(^TMP($J,1,NA)) Q:NA=""  S X="" F  S X=$O(^TMP($J,1,NA,X)) Q:X=""  S ^TMP("PSN",$J,LINE,0)="Patient: "_NA,LINE=LINE+1,^TMP("PSN",$J,LINE,0)="Non-primary ingredient "_$P(X,"^"),LINE=LINE+1 D
"RTN","PSNPPSCL",57,0)
 .S ^TMP("PSN",$J,LINE,0)="was replaced with primary ingredient "_$P(X,"^",2),LINE=LINE+1,^TMP("PSN",$J,LINE,0)=" ",LINE=LINE+1
"RTN","PSNPPSCL",58,0)
 ;
"RTN","PSNPPSCL",59,0)
SENDIT ;
"RTN","PSNPPSCL",60,0)
 ;
"RTN","PSNPPSCL",61,0)
 I $G(PSNSITET)'="" D CTRKDL^PSNPPSMS("Sending Interactions and allergies email")
"RTN","PSNPPSCL",62,0)
 ;SETUP PRODUCTION OR SQA
"RTN","PSNPPSCL",63,0)
 N PSNPS,PSGRP
"RTN","PSNPPSCL",64,0)
 S PSNPS=$P($G(^PS(59.7,1,10)),"^",12)
"RTN","PSNPPSCL",65,0)
 S XMSUB="INTERACTIONS AND ALLERGIES UPDATED"
"RTN","PSNPPSCL",66,0)
 ;S XMDUZ="NDF_MANAGER"
"RTN","PSNPPSCL",67,0)
 S XMDUZ="noreply@domain.ext"
"RTN","PSNPPSCL",68,0)
 S XMTEXT="^TMP(""PSN"",$J,"
"RTN","PSNPPSCL",69,0)
 K XMY
"RTN","PSNPPSCL",70,0)
 S XMY(DUZ)="",DA=0 F  S DA=$O(^XUSEC("PSNMGR",DA)) Q:'DA  S XMY(DA)=""
"RTN","PSNPPSCL",71,0)
 S PSNLEG="" S PSNLEG=$$GET1^DIQ(57.23,1,45)   ;legacy update
"RTN","PSNPPSCL",72,0)
 N DIFROM D ^XMD
"RTN","PSNPPSCL",73,0)
 ;
"RTN","PSNPPSCL",74,0)
QUIT K DA,DIE,DIK,DR,J,LINE,NA,NEWDA,PSN,PSNDA,PSNI,PSNI1,PSNI1N,PSNI1P,PSNI2,PSNI2N,PSNI2P,PSNN,PSNK,PSNPAT,PSNX,X,XMDUZ,XMSUB,XMTEXT,XMY,^TMP($J),^TMP("PSN",$J)
"RTN","PSNPPSCL",75,0)
PRO K ^TMP("PSN",$J) ;M ^TMP("PSN",$J)=^TMP("PSN PPSN PARSED",$J,"CLASS")
"RTN","PSNPPSCL",76,0)
 N II,VAGEN,VADC,DATA,NDFKPR,NDFKD
"RTN","PSNPPSCL",77,0)
 S II=0 F  S II=$O(^TMP("PSN PPSN PARSED",$J,"CLASS",II)) Q:II=""  D
"RTN","PSNPPSCL",78,0)
 .S NDFKPR=II
"RTN","PSNPPSCL",79,0)
 .Q:'$D(^PSNDF(50.68,NDFKPR))
"RTN","PSNPPSCL",80,0)
 .S NDFKD=$G(^TMP("PSN PPSN PARSED",$J,"PRODS CHANGED CLASSES",NDFKPR))
"RTN","PSNPPSCL",81,0)
 .S $P(DATA,"^")=NDFKPR,$P(DATA,"^",2)=$P(NDFKD,"^",1)  ;OLD DRUG CLASS IEN
"RTN","PSNPPSCL",82,0)
 .S $P(DATA,"^",3)=$P(NDFKD,"^",2)  ;NEW DRUG CLASS IEN
"RTN","PSNPPSCL",83,0)
 .S $P(DATA,"^",4)=$P(NDFKD,"^",3)  ;VA GENERIC IEN
"RTN","PSNPPSCL",84,0)
 .Q:$P(DATA,"^",2)=""!($P(DATA,"^",3)="")!($P(DATA,"^",4)="")
"RTN","PSNPPSCL",85,0)
 .S ^TMP("PSN",$J,NDFKPR,0)=DATA
"RTN","PSNPPSCL",86,0)
 ;decision was made to not send the drug class emails, but we need to update the allergy files
"RTN","PSNPPSCL",87,0)
 I $D(^TMP("PSN",$J)) S ZTSAVE("^TMP(""PSN"",$J,")="",ZTIO="",ZTDTH=$H,ZTRTN="PROTO^PSNPPSCL" D ^%ZTLOAD K ZTSAVE,ZTIO,ZTDTH,ZTRTN Q
"RTN","PSNPPSCL",88,0)
 Q
"RTN","PSNPPSCL",89,0)
 ;
"RTN","PSNPPSCL",90,0)
PROTO S X="PSN NEW CLASS",DIC=101 D EN^XQOR K X,DIC Q
"RTN","PSNPPSCL",91,0)
 Q
"RTN","PSNPPSCL",92,0)
TEXT3 ; 
"RTN","PSNPPSCL",93,0)
 ;;  
"RTN","PSNPPSCL",94,0)
 ;;=========================================================================
"RTN","PSNPPSCL",95,0)
 ;;Allergy information for the following patients has been changed.
"RTN","PSNPPSCL",96,0)
 ;; 
"RTN","PSNPPSCL",97,0)
 ;;The allergy for the listed patients was created with a non-primary
"RTN","PSNPPSCL",98,0)
 ;;ingredient.  These have been updated to replace the non-primary
"RTN","PSNPPSCL",99,0)
 ;;ingredient with the proper primary ingredient.
"RTN","PSNPPSCL",100,0)
 ;;  
"RTN","PSNPPSCL",101,0)
 ;
"RTN","PSNPPSCL",102,0)
TEXT ;
"RTN","PSNPPSCL",103,0)
 ;; 
"RTN","PSNPPSCL",104,0)
 ;;The following interactions have been edited because they
"RTN","PSNPPSCL",105,0)
 ;;involved ingredients that are not primary ingredients.
"RTN","PSNPPSCL",106,0)
 ;; 
"RTN","PSNPPSCL",107,0)
 ;
"RTN","PSNPPSCL",108,0)
TEXT2 ; 
"RTN","PSNPPSCL",109,0)
 ;; 
"RTN","PSNPPSCL",110,0)
 ;;The following interactions have been deleted because
"RTN","PSNPPSCL",111,0)
 ;;Primary Ingredient/Other Ingredient combination already
"RTN","PSNPPSCL",112,0)
 ;;exists in the DRUG INGREDIENTS file involved ingredients
"RTN","PSNPPSCL",113,0)
 ;;that are not primary ingredients. 
"RTN","PSNPPSCL",114,0)
 ;; 
"RTN","PSNPPSCL",115,0)
 ;
"RTN","PSNPPSCL",116,0)
TEXT4 ;
"RTN","PSNPPSCL",117,0)
 ;; 
"RTN","PSNPPSCL",118,0)
 ;;No DRUG INTERACTIONS were updated due to Primary Ingredients being
"RTN","PSNPPSCL",119,0)
 ;;changed to Non-Primary ingredients in the Data Update.
"RTN","PSNPPSCL",120,0)
 ;; 
"RTN","PSNPPSCL",121,0)
 ;
"RTN","PSNPPSCL",122,0)
TEXT5 ;
"RTN","PSNPPSCL",123,0)
 ;; 
"RTN","PSNPPSCL",124,0)
 ;;No PATIENT ALLERGIES were updated due to Primary Ingredients being
"RTN","PSNPPSCL",125,0)
 ;;changed to Non-Primary ingredients during the Data Update.
"RTN","PSNPPSCL",126,0)
 ;; 
"RTN","PSNPPSI3")
0^5^B49256931^B48818890
"RTN","PSNPPSI3",1,0)
PSNPPSI3 ;HP/MJE-PPSN update NDF data for parsing DATAO records ; 05 Mar 2014  1:20 PM
"RTN","PSNPPSI3",2,0)
 ;;4.0;NATIONAL DRUG FILE;**513,565**; 30 Oct 98;Build 16
"RTN","PSNPPSI3",3,0)
 ;Reference to ^DD supported by DBIA #1258
"RTN","PSNPPSI3",4,0)
 ;
"RTN","PSNPPSI3",5,0)
 Q
"RTN","PSNPPSI3",6,0)
 ;
"RTN","PSNPPSI3",7,0)
 ;This routine parses DATAO records which are edits to existing file entries
"RTN","PSNPPSI3",8,0)
DATAO ;
"RTN","PSNPPSI3",9,0)
 K XFILE,XFLDS
"RTN","PSNPPSI3",10,0)
 K FDA
"RTN","PSNPPSI3",11,0)
 S FDA(57.231,CTRLXIEN_","_CTRLIEN_",",6)="DATAO",PSNTMPN="DATAO"
"RTN","PSNPPSI3",12,0)
 D UPDATE^DIE("","FDA","CTRLIEN")
"RTN","PSNPPSI3",13,0)
 K FDA
"RTN","PSNPPSI3",14,0)
 D CTRLFILE^PSNPPSMS(0)
"RTN","PSNPPSI3",15,0)
 D CTRLSS^PSNPPSMS(0)
"RTN","PSNPPSI3",16,0)
 D CTRLIEN^PSNPPSMS(0)
"RTN","PSNPPSI3",17,0)
 S (OJJ,FILE)=0,GROOT=$NA(^TMP("PSN PPSN PARSED",$J,"DATAO"))
"RTN","PSNPPSI3",18,0)
 ;now load the rest of the data
"RTN","PSNPPSI3",19,0)
 F  S FILE=$O(@GROOT@(FILE)) Q:'FILE  D CTRLFILE^PSNPPSMS(FILE) S ROOT=$$ROOT^DILFD(FILE) I ROOT]"" S GROOT1=$NA(@GROOT@(FILE)) F JJ=1:2 Q:'$D(@GROOT1@(JJ))  D
"RTN","PSNPPSI3",20,0)
 .S (DIA,NEW)=""
"RTN","PSNPPSI3",21,0)
 .S DIA=@GROOT1@(JJ) I $G(@GROOT1@(JJ+1))]"" S NEW=@GROOT1@(JJ+1)
"RTN","PSNPPSI3",22,0)
 .S ^TMP("PSN PPSN PARSED",$J,"AE_PRODUCTS",+DIA)=""
"RTN","PSNPPSI3",23,0)
 .D CTRLSS^PSNPPSMS($TR(GROOT1,"^")_","_JJ)
"RTN","PSNPPSI3",24,0)
 .;
"RTN","PSNPPSI3",25,0)
 .I $G(PSNMULTI) D
"RTN","PSNPPSI3",26,0)
 ..S (MIENS,MFLDS)="",MIENS=$P(DIA,"^")_",",MFLDS=$P(DIA,"^",3)
"RTN","PSNPPSI3",27,0)
 ..I MFLDS'=""&($P(NEW,"^")'=MIENS) S PSNMULTI=0,^TMP("PSN PPSN.WPXRF",$J,FILE,OIENS,OFLDS)=""
"RTN","PSNPPSI3",28,0)
 .S IENS=$P(DIA,"^")_",",FLDS=$P(DIA,"^",3),ROOT=FILE K FDA,IEN
"RTN","PSNPPSI3",29,0)
 .;
"RTN","PSNPPSI3",30,0)
 .I FILE=50.68 D UNMATCH^PSNPPSI2
"RTN","PSNPPSI3",31,0)
 .;
"RTN","PSNPPSI3",32,0)
 .K RES1
"RTN","PSNPPSI3",33,0)
 .I '$G(PSNMULTI) D FIELD^DID(FILE,FLDS,"","TYPE","RES1")
"RTN","PSNPPSI3",34,0)
 .I $G(RES1("TYPE"))="WORD-PROCESSING"!$G(PSNMULTI) D  Q
"RTN","PSNPPSI3",35,0)
 ..I '$G(PSNMULTI) D
"RTN","PSNPPSI3",36,0)
 ...S MJJ=JJ,OIENS=IENS,OFLDS=FLDS
"RTN","PSNPPSI3",37,0)
 ...I $D(^TMP("PSN PPSN.WPXRF",$J,FILE,IENS,FLDS)) K ^TMP("PSN PPSN.WP",$J,FILE,OIENS,OFLDS),^TMP("PSN PPSN.WPXRF",$J,FILE,IENS,FLDS)
"RTN","PSNPPSI3",38,0)
 ...;Set 5000 file for word processing fields
"RTN","PSNPPSI3",39,0)
 ...S PSNWP=$$GET1^DID(FILE,"","","GLOBAL NAME")_$P(DIA,"^")_","  ;"PSNDF(FILE,"_IENS_",1)"
"RTN","PSNPPSI3",40,0)
 ...D FIELD^DID(FILE,FLDS,"Z","GLOBAL SUBSCRIPT LOCATION","RES2")
"RTN","PSNPPSI3",41,0)
 ...S RES3="",RES3=$P(RES2("GLOBAL SUBSCRIPT LOCATION"),";")
"RTN","PSNPPSI3",42,0)
 ...S PSNWP=PSNWP_$S(RES3?1AN.AN:""""_RES3_"""",1:RES3)_")"
"RTN","PSNPPSI3",43,0)
 ...I PSNPS="N",'$D(^NDFK(5000,1,4,"B",PSNWP)) S X=$O(^NDFK(5000,1,4," "),-1)+1,^(X,0)=PSNWP,^NDFK(5000,1,4,"B",PSNWP,X)=""
"RTN","PSNPPSI3",44,0)
 ..;
"RTN","PSNPPSI3",45,0)
 ..I '$P(DIA,"^",3) S ^TMP("PSN PPSN.WP",$J,FILE,OIENS,OFLDS,MJJ)=$$STRIP^PSNPPSNU(DIA),MJJ=MJJ+1
"RTN","PSNPPSI3",46,0)
 ..I '$P(NEW,"^",3) S ^TMP("PSN PPSN.WP",$J,FILE,OIENS,OFLDS,MJJ)=$$STRIP^PSNPPSNU(NEW),PSNMULTI=1,MJJ=MJJ+1
"RTN","PSNPPSI3",47,0)
 ..I $P(NEW,"^",3)'="" S JJ=JJ-1
"RTN","PSNPPSI3",48,0)
 .;
"RTN","PSNPPSI3",49,0)
 .S XFILE=FILE
"RTN","PSNPPSI3",50,0)
 .I FLDS["," D
"RTN","PSNPPSI3",51,0)
 ..I FILE=50.68,$P($P(DIA,"^",3),",")=43 D MULTIPLE^PSNPPSI2 Q  ;new generic multiple .01 field code
"RTN","PSNPPSI3",52,0)
 ..S LI=$P(DIA,"^",3) F J=1:1:$L(LI,",")-1 S ROOT=+$P(^DD(ROOT,+$P(LI,",",J),0),"^",2)
"RTN","PSNPPSI3",53,0)
 ..S LI=$P(DIA,"^"),IENS="" F J=$L(LI,","):-1:1 S IENS=IENS_$P(LI,",",J)_"," S ^TMP("PSN PPSN PARSED",$J,"AE_PRODUCTS",$P(LI,",",J))=""
"RTN","PSNPPSI3",54,0)
 ..S XFLDS=$P(FLDS,",",$L(FLDS,",")-1) I $G(XFLDS)'="" S XFILE=+$P(^DD(FILE,XFLDS,0),"^",2) S:$G(XFILE)="" XFILE=FILE
"RTN","PSNPPSI3",55,0)
 ..S FLDS=$P(FLDS,",",$L(FLDS,","))
"RTN","PSNPPSI3",56,0)
 .S DA=+IENS
"RTN","PSNPPSI3",57,0)
 .D CTRLIEN^PSNPPSMS(IENS)
"RTN","PSNPPSI3",58,0)
 .I FILE=50.68,$P($P(DIA,"^",3),",")=43 Q
"RTN","PSNPPSI3",59,0)
 .;
"RTN","PSNPPSI3",60,0)
 .I PSNPS="N",FILE=50.68 D
"RTN","PSNPPSI3",61,0)
 ..D NDFK^PSNPPSNK
"RTN","PSNPPSI3",62,0)
 ..I FLDS=31 D
"RTN","PSNPPSI3",63,0)
 ...K ORDP,ORDN,ERROR
"RTN","PSNPPSI3",64,0)
 ...S ORDP=$$GET1^DIQ(50.68,+IENS_",",31,"I","ERROR")
"RTN","PSNPPSI3",65,0)
 ...S ORDN=NEW
"RTN","PSNPPSI3",66,0)
 ...S ^TMP("PSN PPSN PARSED",$J,"POST_RUN",5000.608,FILE,+IENS,FLDS)=ORDP_"^"_ORDN
"RTN","PSNPPSI3",67,0)
 ..I $P(DIA,"^",3)="14,.01" S ^TMP("PSN PPSN PARSED",$J,"POST_RUN",5000.509,FILE,IENS,FLDS)=NEW
"RTN","PSNPPSI3",68,0)
 .;
"RTN","PSNPPSI3",69,0)
 .D CLASS:FILE=50.68
"RTN","PSNPPSI3",70,0)
 .;new generic multiple .01 field code
"RTN","PSNPPSI3",71,0)
 .I FILE=50.68,$P($P(DIA,"^",3),",")=43 Q
"RTN","PSNPPSI3",72,0)
 .;
"RTN","PSNPPSI3",73,0)
 .I FILE=50.68,$P(DIA,"^",3)="21" D  K FDA
"RTN","PSNPPSI3",74,0)
 ..K FDA,ERROR
"RTN","PSNPPSI3",75,0)
 ..D NOW^%DTC
"RTN","PSNPPSI3",76,0)
 ..S FDA(50.6899,"+1,"_IENS,.01)=$S(NEW="":$P(%,"."),1:NEW),FDA(50.6899,"+1,"_IENS,.02)=$S(NEW="":1,1:0)
"RTN","PSNPPSI3",77,0)
 ..D UPDATE^DIE("","FDA","","ERROR") D ERROR^PSNPPSNU:$D(ERROR("DIERR")) K FDA
"RTN","PSNPPSI3",78,0)
 .I PSNPS="N" D
"RTN","PSNPPSI3",79,0)
 ..I FILE=50.416 D INGRED^PSNPPSNK
"RTN","PSNPPSI3",80,0)
 ..I FILE=56 D 56^PSNPPSMS(FILE,DIA,NEW,PSNTMPN)
"RTN","PSNPPSI3",81,0)
 .I PSNPS="N",FILE=50.67&($P(DIA,"^",3)=1) D 
"RTN","PSNPPSI3",82,0)
 .. S ^TMP("PSN PPSN PARSED",$J,"POST_RUN",50.628,FILE,+DIA,1)=NEW
"RTN","PSNPPSI3",83,0)
 .;****************************************************** 47
"RTN","PSNPPSI3",84,0)
 .I FILE[50.68,$P(DIA,"^",3)="45,1"!($P(DIA,"^",3)="45,2") K DIE D  Q  ;**COPAY TIERS
"RTN","PSNPPSI3",85,0)
 ..K FDA,ERROR
"RTN","PSNPPSI3",86,0)
 ..S DA=$P($P(DIA,"^"),",",2),FDA(50.6845,IENS,$P($P(DIA,"^",3),",",2))=NEW D FILE^DIE("","FDA","ERROR") D ERROR^PSNPPSNU:$D(ERROR("DIERR"))
"RTN","PSNPPSI3",87,0)
 ..K FDA
"RTN","PSNPPSI3",88,0)
 .;50.606 DOSAGE FORM UNITS
"RTN","PSNPPSI3",89,0)
 .I FILE[50.606,$P(DIA,"^",3)="8,1" K DIE D  Q
"RTN","PSNPPSI3",90,0)
 ..K FDA,ERROR
"RTN","PSNPPSI3",91,0)
 ..S DA=$P($P(DIA,"^"),",",2),FDA(50.6068,IENS,$P($P(DIA,"^",3),",",2))=NEW D FILE^DIE("","FDA","ERROR") D ERROR^PSNPPSNU:$D(ERROR("DIERR"))
"RTN","PSNPPSI3",92,0)
 ..K FDA
"RTN","PSNPPSI3",93,0)
 .;50.606 DISPENSE UNITS PER DOSE
"RTN","PSNPPSI3",94,0)
 .I FILE[50.606,$P(DIA,"^",3)="9,1" K DIE D  Q
"RTN","PSNPPSI3",95,0)
 ..K FDA,ERROR
"RTN","PSNPPSI3",96,0)
 ..S DA=$P($P(DIA,"^"),",",2),FDA(50.6069,IENS,$P($P(DIA,"^",3),",",2))=NEW D FILE^DIE("","FDA","ERROR") D ERROR^PSNPPSNU:$D(ERROR("DIERR"))
"RTN","PSNPPSI3",97,0)
 ..K FDA
"RTN","PSNPPSI3",98,0)
 .;50
"RTN","PSNPPSI3",99,0)
 .I $P(DIA,"^",3)="99.991,.01" D  K FDA Q
"RTN","PSNPPSI3",100,0)
 ..K FDA,ERROR
"RTN","PSNPPSI3",101,0)
 ..S FDA(ROOT,"+"_IENS,FLDS)=NEW D UPDATE^DIE("","FDA","","ERROR") D ERROR K FDA
"RTN","PSNPPSI3",102,0)
 .;
"RTN","PSNPPSI3",103,0)
 .I $P(DIA,"^",3)="99.991,.02" D  K FDA Q
"RTN","PSNPPSI3",104,0)
 ..K FDA,ERROR
"RTN","PSNPPSI3",105,0)
 ..S DA=999999999999 S DA=$O(^PS(FILE,$P(DIA,"^"),"TERMSTATUS",DA),-1) S:DA="" DA=1
"RTN","PSNPPSI3",106,0)
 ..I FILE=50.6!(FILE=50.68) S DA=999999999999 S DA=$O(^PSNDF(FILE,+$P(DIA,"^"),"TERMSTATUS",DA),-1)
"RTN","PSNPPSI3",107,0)
 ..S $P(IENS,",",1)=DA,FDA(ROOT,IENS,.02)=NEW D UPDATE^DIE("","FDA","IEN","ERROR") D ERROR K FDA
"RTN","PSNPPSI3",108,0)
 .;
"RTN","PSNPPSI3",109,0)
 .;delete sub-field entries if NEW="", means it was removed from the product in PPS-N
"RTN","PSNPPSI3",110,0)
 .I FILE=50.68&($P(DIA,"^",3)="14,.01")&(NEW="") D  Q
"RTN","PSNPPSI3",111,0)
 ..N DA,DIK,DIAU
"RTN","PSNPPSI3",112,0)
 ..S DA(1)=$P($P(DIA,"^"),","),ROOT3="^PSNDF(50.68,DA(1),2," ;,ROOT3="^"_XPATH_DA(1)_",2,"
"RTN","PSNPPSI3",113,0)
 ..S DIK=ROOT3,DA=$P($P(DIA,"^"),",",2) D ^DIK K DIK,DIAU
"RTN","PSNPPSI3",114,0)
 .;set fields 14,1 and 14,2
"RTN","PSNPPSI3",115,0)
 .I FILE=50.68&($P(DIA,"^",3)["14,") D  Q
"RTN","PSNPPSI3",116,0)
 ..S DA(1)=$P($P(DIA,"^"),","),XPATH=$P(^DD(ROOT,.01,0),"^",3),ROOT3="^"_XPATH_DA(1)_",2,"
"RTN","PSNPPSI3",117,0)
 ..K FDA,ERROR S FDA(ROOT,IENS,FLDS)=NEW D UPDATE^DIE("","FDA",DA,"ERROR") D ERROR
"RTN","PSNPPSI3",118,0)
 .;
"RTN","PSNPPSI3",119,0)
 .;HAZARDOUS TO DISPOSE FIELD 102 = ZERO; KILL FIELDS 103,104,105
"RTN","PSNPPSI3",120,0)
 .I FILE=50.68&($P(DIA,"^",3)=102),NEW=0 D
"RTN","PSNPPSI3",121,0)
 ..S DA=+$P(DIA,"^"),$P(^PSNDF(50.68,DA,"HAZTODIS"),"^",2)="",$P(^PSNDF(50.68,DA,"HAZTODIS"),"^",3)=""
"RTN","PSNPPSI3",122,0)
 ..K ^PSNDF(50.68,DA,"HAZTODIS2")
"RTN","PSNPPSI3",123,0)
 .;
"RTN","PSNPPSI3",124,0)
 .I IENS["," K FDA,ERROR S FDA(ROOT,IENS,FLDS)=NEW D FILE^DIE("","FDA","ERROR") D ERROR K FDA,ERROR Q
"RTN","PSNPPSI3",125,0)
 .K FDA,ERROR S FDA(FILE,IENS,FLDS)=NEW D FILE^DIE("","FDA","ERROR") D ERROR
"RTN","PSNPPSI3",126,0)
 .K FDA,ERROR
"RTN","PSNPPSI3",127,0)
 K XFILE,XFLDS
"RTN","PSNPPSI3",128,0)
 ;
"RTN","PSNPPSI3",129,0)
DATAO2 ;
"RTN","PSNPPSI3",130,0)
 S JJ=0 F  S JJ=$O(^TMP("PSNN",$J,JJ)) Q:'JJ  S DA=$P(JJ,",",2),DA(1)=+JJ D
"RTN","PSNPPSI3",131,0)
 . I '$D(^PSNDF(50.68,DA(1),0)) D ERROR2^PSNPPSNU(PSNTMPN,ROOT,IENS,DA(1),"VA PRODUCT entry does not exist.") Q
"RTN","PSNPPSI3",132,0)
 . D ING^PSNXREF
"RTN","PSNPPSI3",133,0)
 S FILE="" F  S FILE=$O(^TMP("PSN PPSN.WP",$J,FILE)) Q:FILE=""  D
"RTN","PSNPPSI3",134,0)
 . S IENS="" F  S IENS=$O(^TMP("PSN PPSN.WP",$J,FILE,IENS)) Q:IENS=""  D
"RTN","PSNPPSI3",135,0)
 .. S FLDS="" F  S FLDS=$O(^TMP("PSN PPSN.WP",$J,FILE,IENS,FLDS)) Q:FLDS=""  D
"RTN","PSNPPSI3",136,0)
 ... K TMP,ERR
"RTN","PSNPPSI3",137,0)
 ... S JJ=0 F  S JJ=$O(^TMP("PSN PPSN.WP",$J,FILE,IENS,FLDS,JJ)) Q:'JJ  D
"RTN","PSNPPSI3",138,0)
 .... S TMP(JJ)=^TMP("PSN PPSN.WP",$J,FILE,IENS,FLDS,JJ)
"RTN","PSNPPSI3",139,0)
 ... D WP^DIE(FILE,IENS,FLDS,"","TMP","ERR")
"RTN","PSNPPSI3",140,0)
 K ^TMP("PSN PPSN.WP",$J)
"RTN","PSNPPSI3",141,0)
 Q
"RTN","PSNPPSI3",142,0)
 ;
"RTN","PSNPPSI3",143,0)
ERROR ;
"RTN","PSNPPSI3",144,0)
 D ERROR^PSNPPSNU:$D(ERROR("DIERR"))
"RTN","PSNPPSI3",145,0)
 Q
"RTN","PSNPPSI3",146,0)
 ;
"RTN","PSNPPSI3",147,0)
CLASS ;
"RTN","PSNPPSI3",148,0)
 I $P(DIA,"^",3)=15 D
"RTN","PSNPPSI3",149,0)
 .S OLDV=$$GET1^DIQ(50.68,$P(DIA,"^"),15,"I"),VAGEN=$$GET1^DIQ(50.68,$P(DIA,"^"),.05,"I")
"RTN","PSNPPSI3",150,0)
 .S VAGENN=$$GET1^DIQ(50.68,$P(DIA,"^"),.05,"E")
"RTN","PSNPPSI3",151,0)
 .;Does not record class/edits on new VA Products same as NDFRR3 & PSSMIGRR routine
"RTN","PSNPPSI3",152,0)
 .I OLDV'="",(OLDV'=NEW) S ^TMP("PSN PPSN PARSED",$J,"PRODS CHANGED CLASSES",$P(DIA,"^"))=OLDV_"^"_NEW_"^"_VAGEN_"^"_VAGENN
"RTN","PSNPPSI3",153,0)
 Q
"RTN","PSNPPSMG")
0^2^B90569826^B90560472
"RTN","PSNPPSMG",1,0)
PSNPPSMG ;HP/MJE-PPSN update NDF data ; 05 Mar 2014  1:20 PM
"RTN","PSNPPSMG",2,0)
 ;;4.0;NATIONAL DRUG FILE;**513,565**; 30 Oct 98;Build 16
"RTN","PSNPPSMG",3,0)
 ;Reference to ^PSDRUG supported by DBIA #2352,#221
"RTN","PSNPPSMG",4,0)
 ;
"RTN","PSNPPSMG",5,0)
MESSAGE ;
"RTN","PSNPPSMG",6,0)
 D CTRKDL^PSNPPSMS("Sending DATA UPDATE FOR NDF email")
"RTN","PSNPPSMG",7,0)
 W:'$G(PSNSCJOB) !,"Sending mail messages...",!
"RTN","PSNPPSMG",8,0)
 K FDA
"RTN","PSNPPSMG",9,0)
 S FDA(57.231,CTRLXIEN_","_CTRLIEN_",",6)="MESSAGE"
"RTN","PSNPPSMG",10,0)
 D UPDATE^DIE("","FDA","CTRLIEN")
"RTN","PSNPPSMG",11,0)
 K FDA
"RTN","PSNPPSMG",12,0)
 S FILE=0,GROOT=$NA(^TMP("PSN PPSN PARSED",$J,"DATAO"))
"RTN","PSNPPSMG",13,0)
 ;
"RTN","PSNPPSMG",14,0)
 S PSNPS=$P($G(^PS(59.7,1,10)),"^",12) I PSNPS'="N" G G1
"RTN","PSNPPSMG",15,0)
 N MESSC S MESSC=""
"RTN","PSNPPSMG",16,0)
 F  S MESSC=$O(^TMP("PSN PPSN PARSED",$J,"MESSAGE",MESSC)) Q:MESSC=""  D
"RTN","PSNPPSMG",17,0)
 .I MESSC=0 S ^NDFK(5000,1,2,0)=^TMP("PSN PPSN PARSED",$J,"MESSAGE",MESSC) Q
"RTN","PSNPPSMG",18,0)
 .S ^NDFK(5000,1,2,MESSC,0)=^TMP("PSN PPSN PARSED",$J,"MESSAGE",MESSC)
"RTN","PSNPPSMG",19,0)
 S MESSC=""
"RTN","PSNPPSMG",20,0)
 F  S MESSC=$O(^TMP("PSN PPSN PARSED",$J,"MESSAGE2",MESSC)) Q:MESSC=""  D
"RTN","PSNPPSMG",21,0)
 .I MESSC=0 S ^NDFK(5000,1,3,0)=^TMP("PSN PPSN PARSED",$J,"MESSAGE2",MESSC) Q
"RTN","PSNPPSMG",22,0)
 .S ^NDFK(5000,1,3,MESSC,0)=^TMP("PSN PPSN PARSED",$J,"MESSAGE2",MESSC)
"RTN","PSNPPSMG",23,0)
 ;
"RTN","PSNPPSMG",24,0)
G1 K ^TMP($J) M ^TMP($J)=^TMP("PSN PPSN PARSED",$J,"MESSAGE") K ^TMP($J,0)
"RTN","PSNPPSMG",25,0)
 ;
"RTN","PSNPPSMG",26,0)
GROUP K XMY S X=$G(^TMP("PSN PPSN PARSED",$J,"GROUP")) I X]"" S XMY("G."_X_"@"_^XMB("NETNAME"))=""
"RTN","PSNPPSMG",27,0)
 S PSNPS=$P($G(^PS(59.7,1,10)),"^",12)
"RTN","PSNPPSMG",28,0)
 D XMY
"RTN","PSNPPSMG",29,0)
 S XMSUB="DATA UPDATE FOR NDF"
"RTN","PSNPPSMG",30,0)
 S XMDUZ="noreply@domain.ext"
"RTN","PSNPPSMG",31,0)
 S XMTEXT="^TMP($J," N DIFROM D ^XMD
"RTN","PSNPPSMG",32,0)
 D CTRKDL^PSNPPSMS("Sent email for DATA UPDATE FOR NDF.")
"RTN","PSNPPSMG",33,0)
 K FDA
"RTN","PSNPPSMG",34,0)
 S FDA(57.231,CTRLXIEN_","_CTRLIEN_",",6)="MESSAGE2"
"RTN","PSNPPSMG",35,0)
 D UPDATE^DIE("","FDA","CTRLIEN")
"RTN","PSNPPSMG",36,0)
 K FDA
"RTN","PSNPPSMG",37,0)
 K ^TMP($J) M ^TMP($J)=^TMP("PSN PPSN PARSED",$J,"MESSAGE2") K ^TMP($J,0)
"RTN","PSNPPSMG",38,0)
 K XMY S X=$G(^TMP("PSN PPSN PARSED",$J,"GROUP")) I X]"" S XMY("G."_X_"@"_^XMB("NETNAME"))=""
"RTN","PSNPPSMG",39,0)
 ;
"RTN","PSNPPSMG",40,0)
 D XMY
"RTN","PSNPPSMG",41,0)
 D CTRKDL^PSNPPSMS("Sending UPDATED INTERACTIONS and FDA MED GUIDE message")
"RTN","PSNPPSMG",42,0)
 S XMSUB="UPDATED INTERACTIONS AND FDA MED GUIDE"
"RTN","PSNPPSMG",43,0)
 S XMDUZ="noreply@domain.ext"
"RTN","PSNPPSMG",44,0)
 S XMTEXT="^TMP($J," N DIFROM D ^XMD
"RTN","PSNPPSMG",45,0)
 D CTRKDL^PSNPPSMS("Sent email for UPDATED INTERACTIONS and FDA MED GUIDE.")
"RTN","PSNPPSMG",46,0)
 K DA
"RTN","PSNPPSMG",47,0)
 Q
"RTN","PSNPPSMG",48,0)
 ;
"RTN","PSNPPSMG",49,0)
COMMSG ;Send error message that comm link with PPSN is not available
"RTN","PSNPPSMG",50,0)
 K ^TMP("PSN PPSN PARSED",$J,"COMMSG")
"RTN","PSNPPSMG",51,0)
 N PSNPS,PSMSGTXT,XMY,X,XMSUB,XMTEXT,PSGRP,LNCNT,FIRST,I3,I4,I5,I6,I7,III
"RTN","PSNPPSMG",52,0)
 S LNCNT=1,FIRST=0,(I3,I4,I5,I6,I7)="",PSNPS=$P($G(^PS(59.7,1,10)),"^",12)
"RTN","PSNPPSMG",53,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",1)="*************************************************************************"
"RTN","PSNPPSMG",54,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",3)="*************************************************************************"
"RTN","PSNPPSMG",55,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",4)="The following file completed installation with error(s)"_$S(PSNPS="Q":" for QA",1:"")_":"
"RTN","PSNPPSMG",56,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",5)=""
"RTN","PSNPPSMG",57,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",6)="      Update file Name"
"RTN","PSNPPSMG",58,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",7)="      -------------------"
"RTN","PSNPPSMG",59,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",8)="      "_$P(PSNHLD,";")
"RTN","PSNPPSMG",60,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",9)=""
"RTN","PSNPPSMG",61,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",10)=""
"RTN","PSNPPSMG",62,0)
 S LNCNT=10
"RTN","PSNPPSMG",63,0)
 G:'$D(^TMP("PSN PPSN ERR",$J)) LZ S LNCNT=11 F  S I3=$O(^TMP("PSN PPSN ERR",$J,I3)) Q:I3=""  D
"RTN","PSNPPSMG",64,0)
 .F  S I4=$O(^TMP("PSN PPSN ERR",$J,I3,I4)) Q:'I4  D
"RTN","PSNPPSMG",65,0)
 ..F  S I5=$O(^TMP("PSN PPSN ERR",$J,I3,I4,I5)) Q:I5=""  D
"RTN","PSNPPSMG",66,0)
 ...F  S I6=$O(^TMP("PSN PPSN ERR",$J,I3,I4,I5,I6)) Q:I6=""  D
"RTN","PSNPPSMG",67,0)
 ....F  S I7=$O(^TMP("PSN PPSN ERR",$J,I3,I4,I5,I6,I7)) Q:'I7  D
"RTN","PSNPPSMG",68,0)
 .....S III=$G(^TMP("PSN PPSN ERR",$J,I3,I4,I5,I6,I7)) D
"RTN","PSNPPSMG",69,0)
 ......I FIRST=0 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",LNCNT)="Error Message: " S LNCNT=LNCNT+1,FIRST=1
"RTN","PSNPPSMG",70,0)
 ......S ^TMP("PSN PPSN PARSED",$J,"COMMSG",LNCNT)=$$TRNS(I4,I5,I6) S LNCNT=LNCNT+1
"RTN","PSNPPSMG",71,0)
 ......S ^TMP("PSN PPSN PARSED",$J,"COMMSG",LNCNT)="      "_$P(III,"^")
"RTN","PSNPPSMG",72,0)
 ......S LNCNT=LNCNT+1
"RTN","PSNPPSMG",73,0)
LZ I '$D(^TMP("PSN PPSN ERR",$J)) S ^TMP("PSN PPSN PARSED",$J,"COMMSG",LNCNT+1)="Error Message: "_$P(COMM,"^",2)
"RTN","PSNPPSMG",74,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",LNCNT+2)="               The update file completed installation but the completion"
"RTN","PSNPPSMG",75,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",LNCNT+3)="               message was not accepted by PPS-N."
"RTN","PSNPPSMG",76,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",LNCNT+4)=""
"RTN","PSNPPSMG",77,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",LNCNT+5)="Contact the National Help Desk or enter a ticket."
"RTN","PSNPPSMG",78,0)
 S ^TMP("PSN PPSN PARSED",$J,"COMMSG",LNCNT+6)=""
"RTN","PSNPPSMG",79,0)
 S X=$G(^TMP("PSN PPSN PARSED",$J,"GROUP")) I X]"" S XMY("G."_X_"@"_^XMB("NETNAME"))=""
"RTN","PSNPPSMG",80,0)
 D XMY
"RTN","PSNPPSMG",81,0)
 S XMDUZ="noreply@domain.ext"
"RTN","PSNPPSMG",82,0)
 S XMSUB="ERROR: PPS-N/NDF File "_$P(PSNHLD,";",1)_" INSTALL"
"RTN","PSNPPSMG",83,0)
 I PSNPS'="" I PSNPS="Q" S XMSUB="ERROR: PPS-N/NDF File "_$P(PSNHLD,";",1)_" INSTALL FOR QA"
"RTN","PSNPPSMG",84,0)
 S XMTEXT="^TMP(""PSN PPSN PARSED"",$J,""COMMSG"","
"RTN","PSNPPSMG",85,0)
 N DIFROM D ^XMD
"RTN","PSNPPSMG",86,0)
 D CTRKDL^PSNPPSMS("Error email sent (COMMSG).")
"RTN","PSNPPSMG",87,0)
 Q
"RTN","PSNPPSMG",88,0)
 ;
"RTN","PSNPPSMG",89,0)
IERRMSG ;Send error message that comm link with PPSN is not available
"RTN","PSNPPSMG",90,0)
 K ^TMP("PSN PPSN PARSED",$J,"IERRMSG")
"RTN","PSNPPSMG",91,0)
 Q:INSTIEN=""
"RTN","PSNPPSMG",92,0)
 Q:'$D(^PS(57.23,1,5,INSTIEN,2,1))
"RTN","PSNPPSMG",93,0)
 N PSNEDATA,PSNPS,PSMSGTXT,XMY,X,XMSUB,XMTEXT,PSGRP,LNCNT,FIRST,I3,I4,I5,I6,I7,III
"RTN","PSNPPSMG",94,0)
 S LNCNT=1,FIRST=0,I3="",PSNPS=$P($G(^PS(59.7,1,10)),"^",12)
"RTN","PSNPPSMG",95,0)
 S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",1)="*************************************************************************"
"RTN","PSNPPSMG",96,0)
 S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",2)="  Error(s) occurred during the install of "_$P(PSNHLD,";")_$S(PSNPS="Q":" for QA",1:"")_":"
"RTN","PSNPPSMG",97,0)
 S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",3)="*************************************************************************"
"RTN","PSNPPSMG",98,0)
 S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",4)=""
"RTN","PSNPPSMG",99,0)
 S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",5)="The "_$P(PSNHLD,";")_"NDF Update file completed installation with error(s)."
"RTN","PSNPPSMG",100,0)
 S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",6)="Contact the National Help Desk or enter a ticket."
"RTN","PSNPPSMG",101,0)
 S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",7)=""
"RTN","PSNPPSMG",102,0)
 S LNCNT=7
"RTN","PSNPPSMG",103,0)
 G:'$D(^PS(57.23,1,5,INSTIEN,2)) LZ2
"RTN","PSNPPSMG",104,0)
 S LNCNT=11,I3=0 F  S I3=$O(^PS(57.23,1,5,INSTIEN,2,I3)) Q:I3=""  I $D(^PS(57.23,1,5,INSTIEN,2,I3,0)) D
"RTN","PSNPPSMG",105,0)
 .I FIRST=0 S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",LNCNT)="Error Message(s): " S LNCNT=LNCNT+1,FIRST=1
"RTN","PSNPPSMG",106,0)
 .S PSNEDATA="",PSNEDATA=^PS(57.23,1,5,INSTIEN,2,I3,0)
"RTN","PSNPPSMG",107,0)
 .S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",LNCNT)="   File: "_$$LJ^XLFSTR($P(PSNEDATA,"^",2),13," ")_"   IEN: "_$$LJ^XLFSTR($P(PSNEDATA,"^",3),13," ")_"   Record Type: "_$$LJ^XLFSTR($P(PSNEDATA,"^",4),13," ") S LNCNT=LNCNT+1
"RTN","PSNPPSMG",108,0)
 .S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",LNCNT)="       Last Record: "_$P(PSNEDATA,"|",2,3) S LNCNT=LNCNT+1
"RTN","PSNPPSMG",109,0)
 .S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",LNCNT)="       Message: "_$P(PSNEDATA,"^",5) S LNCNT=LNCNT+1
"RTN","PSNPPSMG",110,0)
 .S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",LNCNT)="  " S LNCNT=LNCNT+1
"RTN","PSNPPSMG",111,0)
 ;
"RTN","PSNPPSMG",112,0)
LZ2 ;
"RTN","PSNPPSMG",113,0)
 S ^TMP("PSN PPSN PARSED",$J,"IERRMSG",LNCNT)="",XMSUB="ERROR: PPS-N/NDF File "_$P(PSNHLD,";",1)_" INSTALL"
"RTN","PSNPPSMG",114,0)
 S X=$G(^TMP("PSN PPSN PARSED",$J,"GROUP")) I X]"" S XMY("G."_X_"@"_^XMB("NETNAME"))=""
"RTN","PSNPPSMG",115,0)
 I PSNPS'="",PSNPS="Q" S XMSUB="ERROR: PPS-N/NDF File "_$P(PSNHLD,";",1)_" INSTALL FOR QA"
"RTN","PSNPPSMG",116,0)
 K XMY S X=$G(^TMP("PSN PPSN PARSED",$J,"GROUP")) I X]"" S XMY("G."_X_"@"_^XMB("NETNAME"))=""
"RTN","PSNPPSMG",117,0)
 D XMY
"RTN","PSNPPSMG",118,0)
 S XMDUZ="noreply@domain.ext"
"RTN","PSNPPSMG",119,0)
 S XMTEXT="^TMP(""PSN PPSN PARSED"",$J,""IERRMSG"","
"RTN","PSNPPSMG",120,0)
 N DIFROM D ^XMD
"RTN","PSNPPSMG",121,0)
 D CTRKDL^PSNPPSMS("Install completed with errors and email with errors was sent (IERRMSG).")
"RTN","PSNPPSMG",122,0)
 Q
"RTN","PSNPPSMG",123,0)
 ;
"RTN","PSNPPSMG",124,0)
SMSG ;Send install successful message
"RTN","PSNPPSMG",125,0)
 K XMY
"RTN","PSNPPSMG",126,0)
 N PSNPS
"RTN","PSNPPSMG",127,0)
 ;SETUP PRODUCTION OR SQA
"RTN","PSNPPSMG",128,0)
 K ^TMP("PSN PPSN PARSED",$J,"MSG2")
"RTN","PSNPPSMG",129,0)
 N PSGRP,PSNFSIZE,PSSIZE,PSFILE,PSWRKDIR,PSOS
"RTN","PSNPPSMG",130,0)
 S PSWRKDIR=$$GETD^PSNFTP()
"RTN","PSNPPSMG",131,0)
 S PSNFSIZE=1,PSSIZE=""
"RTN","PSNPPSMG",132,0)
 S PSOS=$$GETOS^PSNFTP
"RTN","PSNPPSMG",133,0)
 I +PSOS=3 D UXFSIZE(PSWRKDIR,PSNHLD,.PSSIZE)
"RTN","PSNPPSMG",134,0)
 I +PSOS'=3 D FILSIZE^PSNFTP2(PSWRKDIR,PSNHLD,.PSSIZE,1)
"RTN","PSNPPSMG",135,0)
 ;
"RTN","PSNPPSMG",136,0)
 S PSNPS=$P($G(^PS(59.7,1,10)),"^",12)
"RTN","PSNPPSMG",137,0)
 ;
"RTN","PSNPPSMG",138,0)
 S XMSUB="PPS-N/NDF File "_$P(PSNHLD,";",1)_" INSTALLED"
"RTN","PSNPPSMG",139,0)
 I PSNPS'="" I PSNPS="Q" S XMSUB=XMSUB_" FOR QA"
"RTN","PSNPPSMG",140,0)
 S ^TMP("PSN PPSN PARSED",$J,"MSG2",1)="PPS-N/NDF File "_$P(PSNHLD,";",1)_" (Size "_PSSIZE_$S(+PSOS=1:"",+PSOS=3:" bytes",1:"")_")"
"RTN","PSNPPSMG",141,0)
 S ^TMP("PSN PPSN PARSED",$J,"MSG2",2)="INSTALLED successfully."
"RTN","PSNPPSMG",142,0)
 D XMY
"RTN","PSNPPSMG",143,0)
 S XMTEXT="^TMP(""PSN PPSN PARSED"",$J,""MSG2""," N DIFROM D ^XMD
"RTN","PSNPPSMG",144,0)
 K ^TMP("PSN PPSN PARSED",$J,"MSG2")
"RTN","PSNPPSMG",145,0)
 K ^TMP($J)
"RTN","PSNPPSMG",146,0)
 K XMSUB,XMDUZ,XMTEXT
"RTN","PSNPPSMG",147,0)
 Q
"RTN","PSNPPSMG",148,0)
 ;
"RTN","PSNPPSMG",149,0)
DRGMSG ;
"RTN","PSNPPSMG",150,0)
 W:'$G(PSNSCJOB) !,"Generating mail messages for unmatched/re-matched drugs...",!
"RTN","PSNPPSMG",151,0)
 D REPORT^PSNPPSNW ;        ********************
"RTN","PSNPPSMG",152,0)
 ;
"RTN","PSNPPSMG",153,0)
 N INDX,LINE,XMZ,PSNPS K ^TMP("PSN",$J) S LINE=1
"RTN","PSNPPSMG",154,0)
 S ^TMP("PSN",$J,LINE,0)="PPS-N Update File: "_$P(PSNHLD,";",1),LINE=LINE+1,^TMP("PSN",$J,LINE,0)="",LINE=LINE+1
"RTN","PSNPPSMG",155,0)
 F INDX="A","X","I" D LOAD1^PSNPPSMS
"RTN","PSNPPSMG",156,0)
 ;S XMDUZ="NDF_MANAGER"
"RTN","PSNPPSMG",157,0)
 S XMDUZ="noreply@domain.ext"
"RTN","PSNPPSMG",158,0)
 ;
"RTN","PSNPPSMG",159,0)
 S XMSUB="DRUGS UNMATCHED FROM NATIONAL DRUG FILE"
"RTN","PSNPPSMG",160,0)
 ;
"RTN","PSNPPSMG",161,0)
 S XMTEXT="^TMP(""PSN"",$J,"
"RTN","PSNPPSMG",162,0)
 K XMY S X=$G(^TMP("PSN PPSN PARSED",$J,"GROUP")) I X]"" S XMY("G."_X_"@"_^XMB("NETNAME"))=""
"RTN","PSNPPSMG",163,0)
 S PSGRP="",PSGRP=$$GET1^DIQ(57.23,1,5) ;get PPS-N UPDATE CONTROL:LOCAL EMAIL GROUP NAME (57.23:5)
"RTN","PSNPPSMG",164,0)
 S:PSGRP'="" XMY(PSGRP)=""
"RTN","PSNPPSMG",165,0)
 ;
"RTN","PSNPPSMG",166,0)
 S PSNPS=$P($G(^PS(59.7,1,10)),"^",12)
"RTN","PSNPPSMG",167,0)
 D XMY
"RTN","PSNPPSMG",168,0)
 N DIFROM D ^XMD I $D(XMZ) S DA=XMZ,DIE=3.9,DR="1.7///P;" D ^DIE
"RTN","PSNPPSMG",169,0)
 ;
"RTN","PSNPPSMG",170,0)
 S FDA(57.231,CTRLXIEN_","_CTRLIEN_",",10)="MESSAGE3"
"RTN","PSNPPSMG",171,0)
 D UPDATE^DIE("","FDA","CTRLIEN")
"RTN","PSNPPSMG",172,0)
 K FDA
"RTN","PSNPPSMG",173,0)
 K ^TMP($J) M ^TMP($J)=^TMP("PSN PPSN PARSED",$J,"MESSAGE3") K ^TMP($J,0)
"RTN","PSNPPSMG",174,0)
 K XMY S X=$G(^TMP("PSN PPSN PARSED",$J,"GROUP")) I X]"" S XMY("G."_X_"@"_^XMB("NETNAME"))=""
"RTN","PSNPPSMG",175,0)
 S PSNPS=$P($G(^PS(59.7,1,10)),"^",12)
"RTN","PSNPPSMG",176,0)
 D XMY
"RTN","PSNPPSMG",177,0)
 S XMSUB="LOCAL DRUGS REMATCHED TO NDF"
"RTN","PSNPPSMG",178,0)
 S XMDUZ="noreply@domain.ext"
"RTN","PSNPPSMG",179,0)
 S XMTEXT="^TMP($J," N DIFROM
"RTN","PSNPPSMG",180,0)
 D ^XMD
"RTN","PSNPPSMG",181,0)
 K DIE,DR
"RTN","PSNPPSMG",182,0)
 Q
"RTN","PSNPPSMG",183,0)
UXFSIZE(PSWRKDIR,PSNHLD,PSSIZE) ; get linux file size
"RTN","PSNPPSMG",184,0)
 N XPV,PSXLOG,PV S PSSIZE=""
"RTN","PSNPPSMG",185,0)
 S:'$D(PSWRKDIR) PSWRKDIR=$$GETD^PSNFTP()
"RTN","PSNPPSMG",186,0)
 S XPV="S PV=$ZF(-1,""stat -c%s "_PSWRKDIR_PSNHLD_">"_PSWRKDIR_"PSNSIZE.DAT"")"
"RTN","PSNPPSMG",187,0)
 X XPV
"RTN","PSNPPSMG",188,0)
 S PSXLOG="",PSXLOG=$$FTG^%ZISH(PSWRKDIR,"PSNSIZE.DAT",$NA(^TMP("PSNFSIZELOG",$J,1)),3)
"RTN","PSNPPSMG",189,0)
 I $D(^TMP("PSNFSIZELOG",$J,1)) S PSSIZE=$G(^TMP("PSNFSIZELOG",$J,1)) K ^TMP("PSNFSIZELOG",$J)
"RTN","PSNPPSMG",190,0)
 D LINUXDEL^PSNFTP(1,PSWRKDIR,"PSNSIZE.DAT")
"RTN","PSNPPSMG",191,0)
 Q
"RTN","PSNPPSMG",192,0)
TRNS(PSNFILE,IEN,PSNFIELD) ; get the label of file/field
"RTN","PSNPPSMG",193,0)
 N PSNF,FILE,FILENM,FIELD,PSNARR,FLD,FIELDX
"RTN","PSNPPSMG",194,0)
 S (FIELD,FILE,FILENM,PSNARR,FLD,PSNF)=""
"RTN","PSNPPSMG",195,0)
 S FILE=PSNFILE,(FIELD,FIELDX)=PSNFIELD
"RTN","PSNPPSMG",196,0)
 S PSNF=$S($D(^DIC(FILE,0)):$P($G(^DIC(FILE,0)),U),1:"**Wrong file number**")
"RTN","PSNPPSMG",197,0)
 I FIELD["," S FILENM=$P($G(^DD(FILE,+FIELD,0)),"^"),FILE=+$P($G(^DD(FILE,$P(FIELD,","),0)),"^",2) S:FILE FIELD=$P(FIELD,",",2)
"RTN","PSNPPSMG",198,0)
 K PSNARR D FIELD^DID(FILE,FIELD,"","LABEL","PSNARR") S FLD=$S(FIELDX[",":FILENM_" >>> ",1:"")_$G(PSNARR("LABEL"))
"RTN","PSNPPSMG",199,0)
 Q "   File: "_$$LJ^XLFSTR(PSNF,13," ")_"   IEN#: "_$$LJ^XLFSTR(IEN,13," ")_"   Field: "_$$LJ^XLFSTR(FLD,13," ")
"RTN","PSNPPSMG",200,0)
 ;
"RTN","PSNPPSMG",201,0)
XMY ;set XMY for mail message
"RTN","PSNPPSMG",202,0)
 S XMDUZ="noreply@domain.ext"
"RTN","PSNPPSMG",203,0)
 S DA=0 F  S DA=$O(^XUSEC("PSNMGR",DA)) Q:'DA  S XMY(DA)=""
"RTN","PSNPPSMG",204,0)
 I $D(DUZ) S XMY(DUZ)=""
"RTN","PSNPPSMG",205,0)
 S PSGRP="",PSGRP=$$GET1^DIQ(57.23,1,5) S:PSGRP'="" XMY($$MG(PSGRP))="" ;PRIMARY PPS-N MAIL GROUP
"RTN","PSNPPSMG",206,0)
 S PSGRP="",PSGRP=$$GET1^DIQ(57.23,1,6) S:PSGRP'="" XMY($$MG(PSGRP))="" ;SECONDARY MAIL GROUP
"RTN","PSNPPSMG",207,0)
 Q
"RTN","PSNPPSMG",208,0)
 ;
"RTN","PSNPPSMG",209,0)
MG(PSNGG) ; look for Mail Group
"RTN","PSNPPSMG",210,0)
 I $E(PSNGG,1,2)="G." Q:$O(^XMB(3.8,"B",$E(PSNGG,3,99),0)) PSNGG
"RTN","PSNPPSMG",211,0)
 Q:$O(^XMB(3.8,"B",PSNGG,0)) "G."_PSNGG
"RTN","PSNPPSMG",212,0)
 Q PSNGG
"RTN","PSNPPSNV")
0^1^B185469053^B182428423
"RTN","PSNPPSNV",1,0)
PSNPPSNV ;HP/MJE-PPSN update NDF data additional update code ; 05 Mar 2014  1:20 PM
"RTN","PSNPPSNV",2,0)
 ;;4.0;NATIONAL DRUG FILE;**513,563,565**; 30 Oct 98;Build 16
"RTN","PSNPPSNV",3,0)
 ;Reference to ^PS(59.7 supported by DBIA #2613
"RTN","PSNPPSNV",4,0)
 ;
"RTN","PSNPPSNV",5,0)
 Q
"RTN","PSNPPSNV",6,0)
DATA ;Process DATA transactions
"RTN","PSNPPSNV",7,0)
 K FDA
"RTN","PSNPPSNV",8,0)
 S FDA(57.231,CTRLXIEN_","_CTRLIEN_",",6)="DATA"
"RTN","PSNPPSNV",9,0)
 D UPDATE^DIE("","FDA","CTRLIEN")
"RTN","PSNPPSNV",10,0)
 K FDA
"RTN","PSNPPSNV",11,0)
 I '$D(^TMP("PSN PPSN PARSED",$J,"DATA")) Q
"RTN","PSNPPSNV",12,0)
 N DA,I,J,K,LINE,PSN,ROOT,X
"RTN","PSNPPSNV",13,0)
 S ROOT=$NA(^TMP("PSN PPSN PARSED",$J,"DATA")),J=0
"RTN","PSNPPSNV",14,0)
 F  S J=$O(@ROOT@(J)) Q:'J  S LINE=^(J),K=$L(LINE,"|")-1 F I=1:1:K S X=$P(LINE,"|",I),^TMP($J,$P(X,"^"))=$P(X,"^",2,4)
"RTN","PSNPPSNV",15,0)
 ; Updating GCNSEQNO, PREVIOUS GCNSEQNO and NDC LINK TO GCNSEQNO fields
"RTN","PSNPPSNV",16,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  D
"RTN","PSNPPSNV",17,0)
 . I $D(^TMP($J,DA)) S $P(^PSNDF(50.68,DA,1),"^",5,7)=$P(^TMP($J,DA),"^",1,3)
"RTN","PSNPPSNV",18,0)
 K ^TMP($J)
"RTN","PSNPPSNV",19,0)
 K DA,I,J,K,LINE,PSN,ROOT,X
"RTN","PSNPPSNV",20,0)
 Q
"RTN","PSNPPSNV",21,0)
 ;
"RTN","PSNPPSNV",22,0)
PMIUPDT ;Get PMI data and completly replace all globals 50.621-627
"RTN","PSNPPSNV",23,0)
 N FDA,DA,I,J,K,LINE,PSN,ROOT,X
"RTN","PSNPPSNV",24,0)
 S FDA(57.231,CTRLXIEN_","_CTRLIEN_",",6)="PMIDATA"
"RTN","PSNPPSNV",25,0)
 D UPDATE^DIE("","FDA","CTRLIEN")
"RTN","PSNPPSNV",26,0)
 N FDA,DA,I,J,K,LINE,PSN,X
"RTN","PSNPPSNV",27,0)
 I $D(^TMP("PSN PPSN PARSED",$J,"PMIDATA")) F PSN=50.621:.001:50.627 K ^PS(PSN)
"RTN","PSNPPSNV",28,0)
 S ROOT=$NA(^TMP("PSN PPSN PARSED",$J,"DATA")),J=0
"RTN","PSNPPSNV",29,0)
 K ^TMP($J)
"RTN","PSNPPSNV",30,0)
 F  S J=$O(@ROOT@(J)) Q:'J  S LINE=^(J),K=$L(LINE,"|")-1 F I=1:1:K S X=$P(LINE,"|",I),^TMP($J,$P(X,"^"))=$P(X,"^",2,4)
"RTN","PSNPPSNV",31,0)
 ; Updating GCNSEQNO, PREVIOUS GCNSEQNO and NDC LINK TO GCNSEQNO fields
"RTN","PSNPPSNV",32,0)
 S DA=0 F  S DA=$O(^PSNDF(50.68,DA)) Q:'DA  D
"RTN","PSNPPSNV",33,0)
 . I $D(^TMP($J,DA)) S $P(^PSNDF(50.68,DA,1),"^",5,7)=$P(^TMP($J,DA),"^",1,3)
"RTN","PSNPPSNV",34,0)
 K ^TMP($J)
"RTN","PSNPPSNV",35,0)
 I $D(^TMP("PSN PPSN PARSED",$J,"PMIDATA")) F PSN=50.621:.001:50.627 M ^PS(PSN)=^TMP("PSN PPSN PARSED",$J,"PMIDATA",PSN)
"RTN","PSNPPSNV",36,0)
 K DA,I,J,K,LINE,PSN,ROOT,X
"RTN","PSNPPSNV",37,0)
 Q
"RTN","PSNPPSNV",38,0)
 ;
"RTN","PSNPPSNV",39,0)
TASKIT(FREQ,START) ; create/update PSNTUPDT option start time and frequency
"RTN","PSNPPSNV",40,0)
 ; Input:
"RTN","PSNPPSNV",41,0)
 ;   FREQ  - Optional
"RTN","PSNPPSNV",42,0)
 ;  START  - Optional
"RTN","PSNPPSNV",43,0)
 ;
"RTN","PSNPPSNV",44,0)
 K PSERROR
"RTN","PSNPPSNV",45,0)
 D NOW^%DTC S %DT(0)=%,%DT="EFATX",%DT("A")="Enter date/time: " D ^%DT
"RTN","PSNPPSNV",46,0)
 I (Y<0)!($D(DTOUT)) W !!,"No action taken!" D ENTER W @IOF Q
"RTN","PSNPPSNV",47,0)
 S START=$$FMADD^XLFDT(Y,0,0,5)
"RTN","PSNPPSNV",48,0)
 ;
"RTN","PSNPPSNV",49,0)
 K DIRUT,DUOUT,DIR,X,Y S DIR(0)="Y",DIR("?")="Please enter Y or N."
"RTN","PSNPPSNV",50,0)
 S DIR("A")="Should this NDF update install be re-scheduled at the same time weekly" W !!
"RTN","PSNPPSNV",51,0)
 S DIR("B")="NO" D ^DIR I Y S FREQ="7D" G END
"RTN","PSNPPSNV",52,0)
 I $D(DIRUT) W !!,"No action taken!" D ENTER W @IOF Q
"RTN","PSNPPSNV",53,0)
 ;
"RTN","PSNPPSNV",54,0)
 K DIRUT,DUOUT,DIR,X,Y S DIR(0)="Y",DIR("?")="Please enter Y or N."
"RTN","PSNPPSNV",55,0)
 S DIR("A")="Should this NDF update install be re-scheduled at the same time daily" W !!
"RTN","PSNPPSNV",56,0)
 S DIR("B")="NO" D ^DIR I Y S FREQ="1D" G END
"RTN","PSNPPSNV",57,0)
 I $D(DIRUT) W !!,"No action taken!" D ENTER W @IOF Q
"RTN","PSNPPSNV",58,0)
 I 'Y S FREQ="" W !!,"Warning! The download you have scheduled will occur only once."
"RTN","PSNPPSNV",59,0)
 ;
"RTN","PSNPPSNV",60,0)
END ;
"RTN","PSNPPSNV",61,0)
 I FREQ="" D RESCH^XUTMOPT("PSN TASK SCHEDULED INSTALL","@","","@")
"RTN","PSNPPSNV",62,0)
 W !,"Your start time is:"
"RTN","PSNPPSNV",63,0)
 D RESCH^XUTMOPT("PSN TASK SCHEDULED INSTALL",START,"",FREQ,"L",.PSERROR)
"RTN","PSNPPSNV",64,0)
 I +FREQ=1 W !!,"The NDF update install will automatically be re-scheduled Daily",!
"RTN","PSNPPSNV",65,0)
 I +FREQ=7 W !!,"The NDF update install will automatically be re-scheduled Weekly",!
"RTN","PSNPPSNV",66,0)
 I FREQ="" W !!,"The NDF update install will NOT automatically be re-scheduled",!
"RTN","PSNPPSNV",67,0)
 D ENTER W @IOF
"RTN","PSNPPSNV",68,0)
 Q
"RTN","PSNPPSNV",69,0)
 ;
"RTN","PSNPPSNV",70,0)
SCHDOPT ; edit option PSNTUPDT/PSN TASK SCHEDULE INSTALL to create and/or edit the scheduling date/time
"RTN","PSNPPSNV",71,0)
 ; Called from "PSN PPS SCHEDULE INSTALL" option to create and/or edit the scheduling
"RTN","PSNPPSNV",72,0)
 N PSNLEGF
"RTN","PSNPPSNV",73,0)
 I '$D(^XUSEC("PSN PPS ADMIN",DUZ)) D
"RTN","PSNPPSNV",74,0)
 .W !!,"You do not have the appropriate security key to use this option"
"RTN","PSNPPSNV",75,0)
 .W !,"please contact your ADPAC to resolve this issue.",!
"RTN","PSNPPSNV",76,0)
 .S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",77,0)
 I '$D(^XUSEC("PSN PPS ADMIN",DUZ)) Q
"RTN","PSNPPSNV",78,0)
 S PSNLEGF="",PSNLEGF=$$LEGACY^PSNPPSDL() I PSNLEGF Q
"RTN","PSNPPSNV",79,0)
 W !!!,"This option allows you to schedule a recurring TaskMan job to perform the NDF"
"RTN","PSNPPSNV",80,0)
 W !,"update installation from PPS-N."
"RTN","PSNPPSNV",81,0)
 W !!,"Warning! This NDF update install should be scheduled during non-peak hours."
"RTN","PSNPPSNV",82,0)
 W !!,"You will need to select a date/time and how often this update should reoccur."
"RTN","PSNPPSNV",83,0)
 ;
"RTN","PSNPPSNV",84,0)
 D SCHCK^PSNPPSDL("PSN TASK SCHEDULED INSTALL","I") ; print scheduled tasks
"RTN","PSNPPSNV",85,0)
 ;
"RTN","PSNPPSNV",86,0)
 K DIRUT,DUOUT,DIR,X,Y S DIR(0)="Y",DIR("?")="Please enter Y or N."
"RTN","PSNPPSNV",87,0)
 S DIR("A")="Do you want to schedule an automatic NDF update install in TaskMan" W !!
"RTN","PSNPPSNV",88,0)
 S DIR("B")="NO"
"RTN","PSNPPSNV",89,0)
 D ^DIR
"RTN","PSNPPSNV",90,0)
 I 'Y Q 
"RTN","PSNPPSNV",91,0)
 N PSSROOT
"RTN","PSNPPSNV",92,0)
 D TASKIT(15)
"RTN","PSNPPSNV",93,0)
 Q
"RTN","PSNPPSNV",94,0)
 ;
"RTN","PSNPPSNV",95,0)
PROMPT ;
"RTN","PSNPPSNV",96,0)
 W @IOF I '$D(^XUSEC("PSN PPS ADMIN",DUZ)) D
"RTN","PSNPPSNV",97,0)
 .W !!,"You do not have the appropriate security key to use this option"
"RTN","PSNPPSNV",98,0)
 .W !,"please contact your ADPAC to resolve this issue.",!
"RTN","PSNPPSNV",99,0)
 .S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",100,0)
 I '$D(^XUSEC("PSN PPS ADMIN",DUZ)) Q
"RTN","PSNPPSNV",101,0)
 W !!,"This option allows a user to setup the following PPS-N configuration settings:"
"RTN","PSNPPSNV",102,0)
 W !!,"1) The Cache host disk directory path that will be used for location of the"
"RTN","PSNPPSNV",103,0)
 W !,"   PPS-N weekly NDF update file/s."
"RTN","PSNPPSNV",104,0)
 W !!,"2) The last successful INSTALL version number of the PPS-N update file."
"RTN","PSNPPSNV",105,0)
 W !,"   This is the UPDT option version number."
"RTN","PSNPPSNV",106,0)
 W !!,"3) The last successful DOWNLOAD version number of the PPS-N update file."
"RTN","PSNPPSNV",107,0)
 W !,"   This is the DNLD option version number."
"RTN","PSNPPSNV",108,0)
 W !!,"4) The Exchange email Group or Individual email address that the PPS-N national"
"RTN","PSNPPSNV",109,0)
 W !,"   and locally generated reports will be sent to."
"RTN","PSNPPSNV",110,0)
 W !!,"5) The PPS-N mail group for the PPSN NATIONAL TEST SQA email status."
"RTN","PSNPPSNV",111,0)
 W !!,"6) The Scheduled Options, Menu Options, and Protocols that should be paused"
"RTN","PSNPPSNV",112,0)
 W !,"   while the PPS-n update file is processed."
"RTN","PSNPPSNV",113,0)
 W !!,"7) The PPS-N NATIONAL SQA ACCOUNT (Q)A, (P)roduction, Product (S)upport"
"RTN","PSNPPSNV",114,0)
 W !,"    or (T)est."
"RTN","PSNPPSNV",115,0)
 W !
"RTN","PSNPPSNV",116,0)
 W ! K DIR S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",117,0)
 Q:Y="^"!(Y=0)
"RTN","PSNPPSNV",118,0)
 W @IOF,!!
"RTN","PSNPPSNV",119,0)
 W !,"At the prompt please enter the specific VMS or Linux directory path name"
"RTN","PSNPPSNV",120,0)
 W !,"where the PPS-N update file/s will be located. If you are not familiar with"
"RTN","PSNPPSNV",121,0)
 W !,"the required information please consult your ADPAC."
"RTN","PSNPPSNV",122,0)
 K DIRUT,DUOUT,DIR,X,Y S DIR(0)="Y",DIR("?")="Please enter Y or N."
"RTN","PSNPPSNV",123,0)
 S DIR("A")="Do you want to change the disk directory path for PPS-N Update files" W !
"RTN","PSNPPSNV",124,0)
 S DIR("B")="NO"
"RTN","PSNPPSNV",125,0)
 D ^DIR
"RTN","PSNPPSNV",126,0)
 Q:Y="^"
"RTN","PSNPPSNV",127,0)
 I Y D PATH
"RTN","PSNPPSNV",128,0)
 ;
"RTN","PSNPPSNV",129,0)
UPDT ;
"RTN","PSNPPSNV",130,0)
 W @IOF,!!!,"At the prompt you can change the last successful update version number"
"RTN","PSNPPSNV",131,0)
 W !,"of the PPS-N update file.  This is for the UPDT option."
"RTN","PSNPPSNV",132,0)
 K DIRUT,DUOUT,DIR,X,Y S DIR(0)="Y",DIR("?")="Please enter Y or N."
"RTN","PSNPPSNV",133,0)
 S DIR("A")="Do you want to change the version number of the PPS-N Update files" W !
"RTN","PSNPPSNV",134,0)
 S DIR("B")="NO"
"RTN","PSNPPSNV",135,0)
 D ^DIR
"RTN","PSNPPSNV",136,0)
 Q:Y="^"
"RTN","PSNPPSNV",137,0)
 I Y D INSTV
"RTN","PSNPPSNV",138,0)
 K DIRUT,DUOUT,DIR,X,Y
"RTN","PSNPPSNV",139,0)
DNLD ;
"RTN","PSNPPSNV",140,0)
 W @IOF,!!!,"At the prompt you can change the last successful DOWNLOAD version number"
"RTN","PSNPPSNV",141,0)
 W !,"of the PPS-N update file.  This is for the DNLD option."
"RTN","PSNPPSNV",142,0)
 K DIRUT,DUOUT,DIR,X,Y S DIR(0)="Y",DIR("?")="Please enter Y or N."
"RTN","PSNPPSNV",143,0)
 S DIR("A")="Do you want to change the DOWNLOAD version number of the PPS-N files" W !
"RTN","PSNPPSNV",144,0)
 S DIR("B")="NO"
"RTN","PSNPPSNV",145,0)
 D ^DIR
"RTN","PSNPPSNV",146,0)
 Q:Y="^"
"RTN","PSNPPSNV",147,0)
 I Y D DNLDV
"RTN","PSNPPSNV",148,0)
 K DIRUT,DUOUT,DIR,X,Y
"RTN","PSNPPSNV",149,0)
DEMAIL ;
"RTN","PSNPPSNV",150,0)
 W @IOF,!!!,"At the prompt you can change the Exchange email Group or Individual"
"RTN","PSNPPSNV",151,0)
 W !,"email address that the PPS-N national and locally generated reports"
"RTN","PSNPPSNV",152,0)
 W !,"will be sent to."
"RTN","PSNPPSNV",153,0)
 K DIRUT,DUOUT,DIR,X,Y S DIR(0)="Y",DIR("?")="Please enter Y or N."
"RTN","PSNPPSNV",154,0)
 S DIR("A")="Do you want to change the email address for the PPS-N update reports" W !
"RTN","PSNPPSNV",155,0)
 S DIR("B")="NO"
"RTN","PSNPPSNV",156,0)
 D ^DIR
"RTN","PSNPPSNV",157,0)
 Q:Y="^"
"RTN","PSNPPSNV",158,0)
 I Y D EMAIL
"RTN","PSNPPSNV",159,0)
 K DIRUT,DUOUT,DIR,X,Y
"RTN","PSNPPSNV",160,0)
 ;
"RTN","PSNPPSNV",161,0)
 W @IOF,!!!,"At the prompt you can change the Exchange email Group or Individual"
"RTN","PSNPPSNV",162,0)
 W !,"email address that the PPS-N PPSN NATIONAL TEST SQA emails will be sent to."
"RTN","PSNPPSNV",163,0)
 K DIRUT,DUOUT,DIR,X,Y S DIR(0)="Y",DIR("?")="Please enter Y or N."
"RTN","PSNPPSNV",164,0)
 S DIR("A")="Change the email address for the PPS-N PPSN NATIONAL TEST SQA emails" W !
"RTN","PSNPPSNV",165,0)
 S DIR("B")="NO"
"RTN","PSNPPSNV",166,0)
 D ^DIR
"RTN","PSNPPSNV",167,0)
 Q:Y="^"
"RTN","PSNPPSNV",168,0)
 I Y D SQAMAIL
"RTN","PSNPPSNV",169,0)
 K DIRUT,DUOUT,DIR,X,Y
"RTN","PSNPPSNV",170,0)
 ;
"RTN","PSNPPSNV",171,0)
 D DISOPTS^PSNPPSNR
"RTN","PSNPPSNV",172,0)
 K DIRUT,DUOUT,DIR,X,Y
"RTN","PSNPPSNV",173,0)
TYPE ;
"RTN","PSNPPSNV",174,0)
 W @IOF,!!!,"At the prompt you can change the PPS-N NATIONAL SQA ACCOUNT"
"RTN","PSNPPSNV",175,0)
 K DIRUT,DUOUT,DTOUT,DIR,X,Y S DIR(0)="Y",DIR("?")="Please enter Y or N."
"RTN","PSNPPSNV",176,0)
 S DIR("A")="Do you want to change the PPS-N PPSN NATIONAL TEST SQA" W !
"RTN","PSNPPSNV",177,0)
 S DIR("B")="NO"
"RTN","PSNPPSNV",178,0)
 D ^DIR
"RTN","PSNPPSNV",179,0)
 Q:Y="^"!('Y)
"RTN","PSNPPSNV",180,0)
TYPE2 ;
"RTN","PSNPPSNV",181,0)
 N TYPE
"RTN","PSNPPSNV",182,0)
 S TYPE="",TYPE=$P($G(^PS(59.7,1,10)),"^",12)
"RTN","PSNPPSNV",183,0)
 W !!,"Your current PPS-N NATIONAL SQA ACCOUNT is set to: " W TYPE_" "_$S(TYPE="Q":"for National SQA Testing",TYPE="P":"for Production",TYPE="T":"for Test Account",TYPE="S":"for Product Support",1:"")
"RTN","PSNPPSNV",184,0)
 ;W !!,"Please enter PPS-N NATIONAL SQA ACCOUNT"
"RTN","PSNPPSNV",185,0)
TYPE3 ;
"RTN","PSNPPSNV",186,0)
 W !,"P = Production",?40,"T = Test Account"
"RTN","PSNPPSNV",187,0)
 W !,"S = Product Support",?40,"Q = QA National Testing"
"RTN","PSNPPSNV",188,0)
 W !,"N = QA NDFMS",!
"RTN","PSNPPSNV",189,0)
 R !,"Enter selection: ",X:$S($D(DTIME):DTIME,1:300) I '$T S DTOUT=1
"RTN","PSNPPSNV",190,0)
 I X["?" D  G TYPE2
"RTN","PSNPPSNV",191,0)
 .W !!?5,"This parameter determines if the system is SQA National Testing site,"
"RTN","PSNPPSNV",192,0)
 .W !?5,"Testing Account, Product Support or a Production site. Enter P for"
"RTN","PSNPPSNV",193,0)
 .W !,?5,"Production, T for Test Account, S for Product Support, Q for SQA"
"RTN","PSNPPSNV",194,0)
 .W !,?5,"National Testing or N for QA NDFMS account.",!
"RTN","PSNPPSNV",195,0)
 .W !!?5,"Local sites should define this parameter as P for Production or T for"
"RTN","PSNPPSNV",196,0)
 .W !?5,"their Test Account. Product support should use S. SQA National Testing"
"RTN","PSNPPSNV",197,0)
 .W !?5,"should team should have one account defined Q for QA, a different"
"RTN","PSNPPSNV",198,0)
 .w !?5,"account for P for Production, and another for N for QA NDFMS."
"RTN","PSNPPSNV",199,0)
 Q:X="^"
"RTN","PSNPPSNV",200,0)
 I ",S,Q,T,P,N,"'[(","_X_",") W !!,"You must enter P, T, S, Q or N",! G TYPE2
"RTN","PSNPPSNV",201,0)
 I X'=""&(X'="^")&($L(X)'=0) D
"RTN","PSNPPSNV",202,0)
 .S $P(^PS(59.7,1,10),"^",12)=X
"RTN","PSNPPSNV",203,0)
 .W !!,"You changed the PPS-N NATIONAL SQA ACCOUNT to: " W X
"RTN","PSNPPSNV",204,0)
 .W ! K DIR S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",205,0)
 K DIRUT,DUOUT,DIR,X,Y
"RTN","PSNPPSNV",206,0)
 Q
"RTN","PSNPPSNV",207,0)
 ;
"RTN","PSNPPSNV",208,0)
PATH ;
"RTN","PSNPPSNV",209,0)
 W !!,"Your current update file path is set to: ",$$GETD^PSNFTP()
"RTN","PSNPPSNV",210,0)
 W !!,"Please enter the complete directory path: " R X:$S($D(DTIME):DTIME,1:300) I '$T S DTOUT=1
"RTN","PSNPPSNV",211,0)
 I X["?" D  G PATH
"RTN","PSNPPSNV",212,0)
 .W !!?5,"Enter the operating system full directory path where the PPS-N Update",!?5,"file(s) will be stored."
"RTN","PSNPPSNV",213,0)
 .W "  Refer to the NDF Technical manual and/or",!?5,"contact your IRM for more information."
"RTN","PSNPPSNV",214,0)
 .W !?10,"Example:  ABC$:[USER.PPSN]"
"RTN","PSNPPSNV",215,0)
 I X'=""&(X'="^")&(X'="?") D
"RTN","PSNPPSNV",216,0)
 .D SETD(X)
"RTN","PSNPPSNV",217,0)
 .W !!,"You changed the directory path to: " W X
"RTN","PSNPPSNV",218,0)
 .W ! K DIR S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",219,0)
 Q
"RTN","PSNPPSNV",220,0)
 ;
"RTN","PSNPPSNV",221,0)
INSTV ;
"RTN","PSNPPSNV",222,0)
 W !!,"Your current PPS-N INSTALL file version number is set to: " W:$D(^PS(57.23,1,0)) $P(^PS(57.23,1,0),"^",3) W !
"RTN","PSNPPSNV",223,0)
 W !,"Please enter the current PPS-N update file version number: " R X:$S($D(DTIME):DTIME,1:300) I '$T S DTOUT=1
"RTN","PSNPPSNV",224,0)
 I X["?" D  G INSTV
"RTN","PSNPPSNV",225,0)
 .W !!?5,"Enter the last file version installed on the system. If the last file"
"RTN","PSNPPSNV",226,0)
 .W !?5,"name installed was PPS_15PRV_16NEW.DAT, the last file version would be 16."
"RTN","PSNPPSNV",227,0)
 I X'=""&(X'="^")&($L(X)'=0)&(X'="?") D
"RTN","PSNPPSNV",228,0)
 .S $P(^PS(57.23,1,0),"^",3)=X
"RTN","PSNPPSNV",229,0)
 .W !!,"You changed the INSTALL file version number to: " W X
"RTN","PSNPPSNV",230,0)
 .W ! K DIR S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",231,0)
 Q
"RTN","PSNPPSNV",232,0)
 ;
"RTN","PSNPPSNV",233,0)
DNLDV ;
"RTN","PSNPPSNV",234,0)
 W !!,"Your current PPS-N DOWNLOAD file version number is set to: " W:$D(^PS(57.23,1,0)) $P(^PS(57.23,1,0),"^",7) W !
"RTN","PSNPPSNV",235,0)
 W !,"Please enter the current PPS-N DOWNLOAD file version number: " R X:$S($D(DTIME):DTIME,1:300) I '$T S DTOUT=1
"RTN","PSNPPSNV",236,0)
 I X["?" D  G DNLDV
"RTN","PSNPPSNV",237,0)
 .W !!?5,"Enter the last file version downloaded to the system. If the last file"
"RTN","PSNPPSNV",238,0)
 .W !?5,"name downloaded was PPS_15PRV_16NEW.DAT, the last file version would be 16."
"RTN","PSNPPSNV",239,0)
 I X'=""&(X'="^")&($L(X)'=0)&(X'="?") D
"RTN","PSNPPSNV",240,0)
 .S $P(^PS(57.23,1,0),"^",7)=X
"RTN","PSNPPSNV",241,0)
 .W !!,"You changed the DOWNLOAD file version number to: " W X
"RTN","PSNPPSNV",242,0)
 .W ! K DIR S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",243,0)
 Q
"RTN","PSNPPSNV",244,0)
 ;
"RTN","PSNPPSNV",245,0)
EMAIL ;
"RTN","PSNPPSNV",246,0)
 W !!,"Your current email address is set to: " W:$D(^PS(57.23,1,0)) $P($G(^PS(57.23,1,0)),"^",6) W !
"RTN","PSNPPSNV",247,0)
 W !,"Please enter the email address: " R X:$S($D(DTIME):DTIME,1:300) I '$T S DTOUT=1
"RTN","PSNPPSNV",248,0)
 I X["?" D  G EMAIL
"RTN","PSNPPSNV",249,0)
 .W !!?5,"Enter an email address for receiving PPS-N download, install and error"
"RTN","PSNPPSNV",250,0)
 .W !?5,"messages.  This is typically an MS Outlook email address since holders "
"RTN","PSNPPSNV",251,0)
 .W !?5,"of the PSN PPS ADMIN key will continue to receive the NDF update messages."
"RTN","PSNPPSNV",252,0)
 .W !?5,"These messages include success, completion, error, and the report"
"RTN","PSNPPSNV",253,0)
 .W !?5,"messages like DATA UPDATE FROM NDF, etc."
"RTN","PSNPPSNV",254,0)
 I X'=""&(X'="^")&($L(X)'=0)&(X'="?") D
"RTN","PSNPPSNV",255,0)
 .S $P(^PS(57.23,1,0),"^",6)=X
"RTN","PSNPPSNV",256,0)
 .W !!,"You changed the email address to: " W X
"RTN","PSNPPSNV",257,0)
 .W ! K DIR S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",258,0)
 Q
"RTN","PSNPPSNV",259,0)
 ;
"RTN","PSNPPSNV",260,0)
SQAMAIL ;
"RTN","PSNPPSNV",261,0)
 W !!,"Your current email address is set to: " W:$D(^PS(57.23,1,1)) $P($G(^PS(57.23,1,1)),"^",1) W !
"RTN","PSNPPSNV",262,0)
 W !,"Please enter the email address: " R X:$S($D(DTIME):DTIME,1:300) I '$T S DTOUT=1
"RTN","PSNPPSNV",263,0)
 I X["?" D  G SQAMAIL
"RTN","PSNPPSNV",264,0)
 .W !!?5,"Enter an email address for receiving PPS-N download, install and error"
"RTN","PSNPPSNV",265,0)
 .W !?5,"messages.  This is used by SQA for a secondary email group if needed."
"RTN","PSNPPSNV",266,0)
 .W !?5,"Typically an MS Outlook email address is defined since holders of the"
"RTN","PSNPPSNV",267,0)
 .W !?5,"PSN PPS ADMIN key will continue to receive the NDF update messages.  These"
"RTN","PSNPPSNV",268,0)
 .W !?5,"messages include success, completion, error, and the report messages like"
"RTN","PSNPPSNV",269,0)
 .W !?5," DATA UPDATE FROM NDF, etc."
"RTN","PSNPPSNV",270,0)
 I X'=""&(X'="^")&($L(X)'=0)&(X'="?") D
"RTN","PSNPPSNV",271,0)
 .S $P(^PS(57.23,1,1),"^",1)=X
"RTN","PSNPPSNV",272,0)
 .W !!,"You changed the email address to: " W X
"RTN","PSNPPSNV",273,0)
 .W ! K DIR S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",274,0)
 Q
"RTN","PSNPPSNV",275,0)
 ;
"RTN","PSNPPSNV",276,0)
LOAD ;GET DOSE STUFF
"RTN","PSNPPSNV",277,0)
 N DA1
"RTN","PSNPPSNV",278,0)
 S J=2,X=$G(^PSDRUG(DA,"DOS")) I $P(X,"^"),$D(^PS(50.607,+$P(X,"^",2),0)) S ^TMP($J,INDX,NA_"^"_DA_"^"_IN,J)="    STRENGTH: "_+X_"UNITS: "_$P(^PS(50.607,+$P(X,"^",2),0),"^"),J=J+1
"RTN","PSNPPSNV",279,0)
 I $O(^PSDRUG(DA,"DOS1",0)) S ^TMP($J,INDX,NA_"^"_DA_"^"_IN,J)="    POSSIBLE DOSES",^(J+1)="    DISP UNITS/DOSE     DOSE    PACKAGE   BCMA UNITS/DOSE",DA1=0,J=J+2 D
"RTN","PSNPPSNV",280,0)
 .F  S DA1=$O(^PSDRUG(DA,"DOS1",DA1)) Q:'DA1  S X=^(DA1,0),^TMP($J,INDX,NA_"^"_DA_"^"_IN,J)="    "_$J($P(X,"^"),4),$E(^(J),25)=$J($P(X,"^",2),4),$E(^(J),35)=$P(X,"^",3),$E(^(J),43)=$P(X,"^",4),J=J+1
"RTN","PSNPPSNV",281,0)
 I $O(^PSDRUG(DA,"DOS2",0)) S ^TMP($J,INDX,NA_"^"_DA_"^"_IN,J)="    LOCAL POSSIBLE DOSES",^(J+1)="    DOSE                                            PACKAGE   BCMA UNITS/DOSE",DA1=0,J=J+2 D
"RTN","PSNPPSNV",282,0)
 .F  S DA1=$O(^PSDRUG(DA,"DOS2",DA1)) Q:'DA1  S X=^(DA1,0),^TMP($J,INDX,NA_"^"_DA_"^"_IN,J)="    "_$P(X,"^"),$E(^(J),55)=$P(X,"^",2),$E(^(J),71)=$P(X,"^",3),J=J+1
"RTN","PSNPPSNV",283,0)
 Q
"RTN","PSNPPSNV",284,0)
 ;
"RTN","PSNPPSNV",285,0)
SETD(X) ;
"RTN","PSNPPSNV",286,0)
 N PSOSX
"RTN","PSNPPSNV",287,0)
 S PSOSX=$$GETOS^PSNFTP()
"RTN","PSNPPSNV",288,0)
 I PSOSX["VMS" S $P(^PS(57.23,1,0),U,2)=X Q
"RTN","PSNPPSNV",289,0)
 I PSOSX["LINUX" S $P(^PS(57.23,1,0),U,4)=X Q
"RTN","PSNPPSNV",290,0)
 Q
"RTN","PSNPPSNV",291,0)
 ;
"RTN","PSNPPSNV",292,0)
ENTER ; press enter key
"RTN","PSNPPSNV",293,0)
 K DIR
"RTN","PSNPPSNV",294,0)
 W ! S DIR(0)="E",DIR("A")=" Press ENTER to Continue" D ^DIR K DIR
"RTN","PSNPPSNV",295,0)
 Q
"VER")
8.0^22.2
"BLD",10750,6)
^547
**END**
**END**

