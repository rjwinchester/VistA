$TXT Created by                  FLDCACHE.FO-BIRM.DOMAIN.EXT  (KIDS) on Friday, 12/15/17 at 16:55
=============================================================================
Run Date: JAN 31, 2018                     Designation: PSN*4*513
Package : PSN - NATIONAL DRUG FILE            Priority: Mandatory
Version : 4       SEQ #531                      Status: Released
                  Compliance Date: FEB 28, 2018
=============================================================================

Associated patches: (v)PSN*4*176   <<= must be installed BEFORE `PSN*4*513'
                    (v)PSN*4*396   <<= must be installed BEFORE `PSN*4*513'

Subject: PPS-N 3.0

Category: 
  - Routine
  - Data Dictionary
  - Enhancement (Mandatory)
  - Other

Description:
============

 This patch contains VistA enhancements of the Pharmacy Product 
 System-National (PPS-N) project and provides functionalities that are 
 needed to replace the current National Drug File Management System 
 (NDFMS). The monthly update via KIDS patches will be replaced with an 
 automated download and install of a .DAT file. The .DAT file will contain 
 the NDF data updates and will be generated by the PPS-N Web-based 
 application once the data updates are made. 
  
 The new menu called PPS-N Menu [PSN PPS MENU] can be found under the 
 National Drug File Menu [PSNMGR] menu option. The following functionality 
 enhancements will be delivered by this patch:
  
 1. PPS-N Site Parameters (Enter/Edit) [PSN PPS PARAM] option
    ---------------------------------------------------------
    This option is used to create or update site parameters for the 
    Pharmacy Product System - National (PPS-N). 
  
    The option is intended to be used by the Pharmacy ADPAC to correctly 
    enter the PPS-N Site parameters used for the communication with the
    PPS-N server for downloading and installing National Drug file data.
  
    This option requires the 'PSN PPS ADMIN' Security Key for editing the
    parameters. An '*' (asterisk) before the field indicates that an
    additional security key, 'PSN PPS COORD', is required.
  
 2. Schedule download of NDF update file [PSN PPS SCHEDULE DOWNLOAD] option
    -----------------------------------------------------------------------
    This option allows you to schedule download for the Pharmacy Product 
    System - National (PPS-N) NDF Update files. The scheduled background
    job can be created to run weekly or daily at a specific time.
  
    Before scheduling a download, the PPS-N Site Parameters and the Secure 
    Shell (SSH) keys must be defined.
  
    There can only be one scheduled job to download the PPS-N Update files.
    When you select this option and change the schedule, the old job will
    be deleted and a new one will be created. The scheduled job name is  
    TaskMan scheduled download of NDF updates [PSN TASK SCHEDULED 
    DOWNLOAD].
  
    If a job is scheduled, it will be displayed under "Scheduled downloads.
    If there isn't a scheduled job, nothing will display.
  
    The process of downloading an update file does not impact users
    currently using VistA and can be done at any time.
  
 3. Schedule Install of NDF Update file [PSN PPS SCHEDULE INSTALL] option
    ---------------------------------------------------------------------
    This option allows you to schedule install for the Pharmacy Product 
    System - National (PPS-N) NDF Update files. The scheduled background
    job can be created to run weekly or daily at a specific time.
  
    Before scheduling an install, the PPS-N Site Parameters and the Secure 
    Shell (SSH) keys must be defined. In addition, the scheduled install 
    will need to be scheduled an hour after the scheduled download. This 
    gives time for the download to finish.
    
    There can only be one scheduled job to install the PPS-N Update files.
    When you select this option and change the schedule, the old job will
    be deleted and a new one will be created. The scheduled job name is  
    TaskMan scheduled update of NDF data from PPS-N [PSN TASK SCHEDULED
    INSTALL].
  
    If a job is scheduled, it will be displayed under "Scheduled installs"
    section. If there isn't a scheduled job, nothing will display.
  
    Scheduling an install will impact users currently using the Pharmacy 
    VistA applications and will need to be schedule during off peak hours.
  
 4. Manual Download of NDF Update file [PSN PPS MANUAL DOWNLOAD] option
    -------------------------------------------------------------------
    This option will start the download of any new NDF update files from 
    PPS-N.  
  
    Example:
    ========
    Warning: This download should only be done during off peak hours!
    Are you sure you want to immediately start an NDF update download? NO//
    YES.
    Please stand-by NDF update download may take up to 30 minutes...
  
    Beginning download for Update file name: PPS_30PRV_31NEW.DAT
    Server ping successful 3-LINUX rc=1
  
    This  U.S. Government system is intended for official  and  
    authorized use only by authorized users with no reasonable  
    expectation of privacy.
    The system may include records protected by various Federal  
    statutes including the Privacy Act (5 U.S.C.' 552a) and 38 U.S.C.''
    5701 and 7332. Access to data is on a need-to-know basis only.  
    All use of this system constitutes user understanding of  
    unconditional consent to review and action including (but not limited
    to) monitoring, recording, copying, auditing, inspecting, 
    investigating, restricting access, blocking, tracking, disclosing to
    authorized personnel, or any other authorized actions by all authorized
    VA and law enforcement personnel. Unauthorized access to or misuse of
    this system is strictly prohibited may result in criminal, civil, or
    administrative penalties.
  
    file transfer successful 3-LINUX rc=1
  
    Completed download for: PPS_30PRV_31NEW.DAT
  
  
    Continuing with the next file sequence. Attempting download
    for: PPS_32PRV_33NEW.DAT
  
    Server ping successful 3-LINUX rc=1
  
    This  U.S. Government system is intended for official  and  
    authorized use only by authorized users with no reasonable  
    expectation of privacy.
    The system may include records protected by various Federal  
    statutes including the Privacy Act (5 U.S.C.' 552a) and 38 U.S.C.''
    5701 and 7332. Access to data is on a need-to-know basis only.  
    All use of this system constitutes user understanding of  
    unconditional consent to review and action including (but not limited
    to) monitoring, recording, copying, auditing, inspecting, 
    investigating, restricting access, blocking, tracking, disclosing to
    authorized personnel, or any other authorized actions by all authorized
    VA and law enforcement personnel. Unauthorized access to or misuse of
    this system is strictly prohibited may result in criminal, civil, or
    administrative penalties.
  
    Couldn't stat remote file: No such file or directory
    File "/u02/pps-n/dev/app82/approved/PPS_32PRV_33NEW.DAT" not found.
  
 5. Manual Install of NDF Update file [PSN PPS MANUAL INSTALL] option
    -----------------------------------------------------------------
    Using this option, you can immediately begin the process that checks 
    for any PPS-N update files that are available and, if valid, update
    your VistA NDF files. Normally, this process should be executed during
    off-peak hours to ensure that users are not using the Pharmacy VistA 
    applications. Please refer to User manual for related examples. 
  
 6. Reject/Complete of NDF Update file [PSN PPS REJECT FILE] option
    ---------------------------------------------------------------
    This option should only be used to identify installation problems in 
    the National VistA account. Local VistA users will only have access to 
    send completion message for the compliance report in PPS-N. 
  
 7. Vista Comparison Report [PSN PPS VISTA COMPARISON RP] option
    ------------------------------------------------------------
    This option allows the user to view or print a report of the NDF 
    changes for a date range. This report is meant for National SQA use
    but if a site wants to utilize this report they will need to turn
    auditing on for the NDF files. This was not done programmatically so
    as to leave the decision up to the site if they want to turn auditing
    for all fields as doing so would increase disk space usage. The files
    utilized for NDF are:
  
      - 50.416   DRUG INGREDIENTS
      - 50.6     VA GENERIC
      - 50.605   VA DRUG CLASS
      - 50.606   DOSAGE FORM
      - 50.607   DRUG UNITS
      - 50.608   PACKAGE TYPE
      - 50.609   PACKAGE SIZE
      - 50.64    VA DISPENSE UNIT
      - 50.67    NDC/UPN
      - 50.68    VA PRODUCT
      - 55.95    DRUG MANUFACTURER
      - 56       DRUG INTERACTION
   
   Auditing might be turned on for some of the files however for full 
   utilization of the new option, you would need to turn auditing on for
   all fields.
  
  
 8. Download/Install Status Report [PSN PPS DNLD/INST STATUS REP] option
    --------------------------------------------------------------------
    This option is used to display information regarding the status of 
    DOWNLOAD or INSTALL of files found in the PPS-N UPDATE CONTROL file 
    (#57.23).
  
    Example:
    ========
    Select PPS-N Menu <TEST ACCOUNT> Option: DIS  Download/Install Status 
    Report Select (D)ownload Detail, (I)nstall Detail or (Q)uit: DOWNLOAD
  
    Enter Start Date: T-3  (DEC 08, 2017)
  
    Enter End Date: T  (DEC 11, 2017)
  
  
    DOWNLOAD FILE NAME              DOWNLOAD BEGIN DT/TM   COMPLETION DT/TM
    Dec 08, 2017 to Dec 11, 2017                            PAGE: 1
    -----------------------------------------------------------------------
    (1) PPS_50PRV_51NEW.DAT         DEC 08, 2017@15:56:35  DEC 08,
       2017@15:56:41 
    (2) PPS_51PRV_52NEW.DAT         DEC 10, 2017@15:15:44  DEC 10,
       2017@15:15:50
    (3) PPS_52PRV_53NEW.DAT         DEC 10, 2017@15:33:06  DEC 10, 
       2017@15:33:12
  
    Select a Download File for greater detail. Choose 1-3 or '^' to Quit: 3
  
  
    DOWNLOAD INFORMATION FOR FILE PPS_52PRV_53NEW.DAT               PAGE: 1
    -----------------------------------------------------------------------
    Download File Name:              PPS_52PRV_53NEW.DAT
    Download Begin Date/Time:        Dec 10, 2017@15:33:06
    Download Complete Date/Time:     Dec 10, 2017@15:33:12
    Download File Size:              4884321
    Download Error Message:          
  
    Press Return to Continue: 
  
  
 9. Manage Secure Shell (SSH) Keys [PSN PPS SSH KEY MANAGEMENT] option
    ------------------------------------------------------------------
    This new option was created to automate the management of SSH 
    encryption keys and to improve the security regarding their content.
    This new option will allow sites to view the public SSH key, create a
    new SSH key pair and also to delete an existing SSH key pair. In
    addition, this new option will provide an extensive help text on how
    the SSH keys are used in the transmission process, which is shown
    below:
    
      Select one of the following:
  
           V         View Public SSH Key
           C         Create New SSH Key Pair
           D         Delete SSH Key Pair
           H         Help with SSH Keys
  
      Action: V// H  Help with SSH Keys
  
   
    Secure SHell (SSH) Encryption Keys are used to allow data file
    download.
    Follow the steps below to successfully setup data file download from 
    Austin server to VistA sites:
  
    Step 1: Select the 'C' (Create New SSH Key Pair) Action and follow the 
         prompts to create a new pair of SSH keys. If you already have an
         existing SSH Key Pair you can skip this step.
         You can check whether you already have an existing SSH Key Pair
         through the 'V' (View Public SSH Key) Action.
  
         Encryption Type: RSA or DSA?
         ----------------------------
         The Rivest, Shamir & Adleman (RSA) and Digital Signature Algorithm
         (DSA) are two of the most common encryption algorithms used in IT 
         industry for securely sharing data.
  
    Press Return to continue: 
  
    Step 2: Share the Public SSH Key content with the PPS-N SFTP server 
         (Austin).
         In order to successfully establish the data download files, the 
         SFTP server at Austin needs to install/configure the new SSH Key
         created in step 1 for the user id they assigned to your site. Use
         the 'V' (View Public SSH Key) Action to retrieve the content of
         the Public SSH key.
         The Public SSH Key should not contain line-feed characters, 
         therefore after you copy & paste it from the terminal emulator
         into an email or text editor make sure it contains only one line
         of text (no wrapping).
  
 Files & Fields Associated:
 --------------------------
  
 File Name (Number)   Field Name (Number)              New/Modified/Delete
 ------------------   ----------------------           -------------------
 PPS-N UPDATE CONTROL (#57.23)                            New
                      NAME (#.01)                         New
                      OPEN VMS LOCAL DIRECTORY (#1)       New
                      INSTALL VERSION (#2)                New
                      UNIX/LINUX LOCAL DIRECTORY (#3)     New
                      PRIMARY PPS-N MAIL GROUP (#5)       New
                      SECONDARY MAIL GROUP (#6)           New
                      DOWNLOAD VERSION (#8)               New
                      DOWNLOAD STATUS (#9)                New
                      INSTALL STATUS (#10)                New
                      REMOTE SERVER ADDRESS (#20)         New
                      REMOTE DIRECTORY ACCESS (#21)       New
                      REMOTE SFTP USER ID (#22)           New
                      SCHEDULED OPTION (#30)              New
                      MENU OPTIONS (#31)                  New
                      PROTOCOLS (#32)                     New
                      SFTP PRIVATE KEY TEXT (#33)         New
                      SFTP PUBLIC KEY TEXT (#34)          New
                      SFTP SSH KEY FORMAT (#39)           New
                      SFTP SSH KEY ENCRYPTION (#41)       New
                      LEGACY UPDATE PROCESSING (#45)      New
                      DOWNLOAD HISTORY (#50)              New
                      REJECT HISTORY (#70)                New
                      INSTALL HISTORY (#100)              New
  
  
   SCHEDULED OPTION (sub-file) (#57.24)                   New
                      SCHEDULE OPTIONS (#.01)
   MENU OPTIONS (sub-file) (#57.2331)                     New
                      MENU OPTIONS (#.01)
   PROTOCOLS (sub-file) (#57.2332)                        New
                      PROTOCOLS (#.01)
   SFTP PRIVATE KEY TEXT (sub-file) (#57.2333)            New
                      SFTP PRIVATE KEY TEXT (#.01)
   SFTP PUBLIC KEY TEXT (sub-file) (#57.2334)             New
                      SFTP PUBLIC KEY TEXT (#.01)
   DOWNLOAD HISTORY (sub-file) (#57.234)                  New
                      DOWNLOAD FILE NAME (#.01)
                      DOWNLOAD BEGIN DATE/TIME (#1)
                      DOWNLOAD COMPLETE DATE/TIME (#2)
                      FILE SIZE (#3)
                      DOWNLOAD ERROR MESSAGE (#4)
   INSTALL HISTORY (sub-file) (#57.231)                   New
                      UPDATE FILE NAME (#.01)
                      INSTALL BEGIN DATE/TIME (#1)
                      INSTALL COMPLETION DATE/TIME (#2)
                      LAST VISTA FILE PROCESSED (#3)
                      LAST FILE IEN PROCESSED (#4)
                      LAST TMP FILE SUBSCRIPT (#5)
                      LAST UPDATE FILE SECTION (#6)
                      DISPLAYED LAST (#7)
       INSTALL ERRORS (sub-file) (#57.233)                New
                      ERROR DATE/TIME (#.01)
                      FILE (#1)
                      INTERNAL ENTRY NUMBER (#2)
                      TMP FILE SUBSCRIPT (#3)
                      ERROR MESSAGE (#4)
                       
   REJECT HISTORY (sub-file) (#57.236)                    New
                      REJECT FILE NAME (#.01)
                      REJECT BEGIN DATE/TIME (#1)
                      REJECTED BY (#2)
  
 PHARMACY SYSTEM (#59.7)                                  Modified
                      PPS-N ACCOUNT TYPE (#17)            New
  
  
  
 Forms Associated:
 -----------------
 N/A
  
  
 Mail Groups Associated:
  
  Mail Group Name          New/Modified/Deleted
  ---------------          -------------------- 
  N/A
  
  
 Options Associated: 
  
  Option Name                    Type              New/Modified/Deleted
  ---------------                -----------       --------------------
  PSN PPS INSTALL VERIFY         run routine       New
  PSN PPS MENU                   menu              New
  PSN PPS SCHEDULE DOWNLOAD      run routine       New
  PSN PPS SCHEDULE INSTALL       run routine       New
  PSN PPS MANUAL DOWNLOAD        run routine       New
  PSN PPS MANUAL INSTALL         run routine       New
  PSN PPS REJECT FILE            run routine       New
  PSN PPS PARAM                  run routine       New
  PSN PPS VISTA COMPARISON RPT   run routine       New
  PSN PPS DNLD/INST STATUS REP   run routine       New
  PSN PPS SSH KEY MANAGEMENT     action            New
  PSN TASK SCHEDULED DOWNLOAD    run routine       New
  PSN TASK SCHEDULED INSTALL     run routine       New
  PSNMGR                         menu              Modified
  
  
  
 Protocols Associated:
 ---------------------
  
  Protocol Name                            New/Modified/Deleted
  -------------                            -------------------- 
  N/A 
  
  
 Security Keys Associated:
 -------------------------
  
  Security Key Name              New/Modified/Deleted
  -----------------              --------------------
  PSN PPS ADMIN                  New
  PSN PPS COORD                  New
  
  
 Templates Associated:
 ---------------------
  
  Template Name     Type        File Name (Number)  New/Modified/Deleted
  -------------     ----        ------------------  --------------------
  N/A
  
  
 Additional Information:
 -----------------------
 N/A
  
  
 New Service Requests (NSRs)
 ---------------------------
 N/A
  
  
 Patient Safety Issues (PSIs)
 ----------------------------
 N/A
  
  
 Defect Tracking System Ticket(s) & Overview:
 --------------------------------------------
 N/A
  
 Test Sites:
 -----------
 CENTRAL PLAINS HCS
 SHREVEPORT, LA
  
  
 Documentation Retrieval Instructions:
 -------------------------------------
 Software being released as a host file and/or documentation describing 
 the new functionality introduced by these patches are available.
  
 The preferred method is to retrieve files from download.vista.domain.ext.
 This transmits the files from the first available server. Sites may 
 also elect to retrieve files directly from a specific server. 
  
 Sites may retrieve the software and/or documentation directly using 
 Secure File Transfer Protocol (SFTP) from the ANONYMOUS.SOFTWARE 
 directory at the following OI Field Offices:
  
 Hines:                 domain.ext  
 Salt Lake City:        domain.ext
  
 Documentation can also be found on the VA Software Documentation Library 
 at: http://www4.domain.ext/vdl/
                            
 Title                                 File Name                FTP Mode
 ------------------------------------------------------------------------
 National Drug File User Manual        psn_4_p513_um.pdf        BINARY
 National Drug File Technical Manual   psn_4_p513_tm.pdf        BINARY
  
 PPS-N Deployment, Installation,       psn_4_p513_ig.pdf        BINARY
 Back-Out, and Rollback Guide 
  
 Patch Installation:
  
 Pre/Post Installation Overview:
 -------------------------------
 This patch contains both pre and post install instructions. During 
 installation of this patch the PPS-N Update process will be set to OFF.  
 Until you are notified by the implementation team, do not make changes 
 other than the ones described in the pre and post installation 
 instructions. Upon activation of PPS-N functionality, you will be given 
 the server information and other configuration changes to be made.
  
  
 Pre-Installation Instructions:
 ------------------------------
 N/A
  
  
 Installation Instructions:
 --------------------------
 This patch may be installed with users on the system although it should be
 installed during non-peak hours to minimize potential disruption to
 users. This patch should take less than 5 minutes to install.
  
 1. Use the INSTALL/CHECK MESSAGE option on the PackMan menu.
  
 2. From the Kernel Installation & Distribution System (KIDS) menu,
    select the Installation menu.
  
 3. From this menu, you may choose to use the option Verify Checksums in 
    Transport Global. When prompted, select PSN*4.0*513.
  
     NOTE:  The following are OPTIONAL - (When prompted for the INSTALL
            NAME, enter PSN*4.0*513):
       
    a.  Backup a Transport Global - This option will create a backup
        message of any routines exported with this patch. It will not
         backup any other changes such as DD's or templates.
    b.  Compare Transport Global to Current System - This option will
        allow you to view all changes that will be made when this patch
        is installed. It compares all components of this patch
        (routines, DD's, templates, etc.).
    c.  Verify Checksums in Transport Global - This option will allow
        you to ensure the integrity of the routines that are in the
        transport global.
  
 4. From the Installation Menu, select the Install Package(s) option 
    and choose PSN*4.0*513.
  
 5. When prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
    Install? NO//', respond NO.
  
 6. When prompted 'Want KIDS to INHIBIT LOGONs during the install? 
    NO//'  answer NO
  
 7. When prompted 'Want to DISABLE Scheduled Options, Menu Options, 
    and Protocols? NO//'  answer NO
  
 8. If prompted 'Delay Install (Minutes):  (0 - 60): 0//' respond 0.
  
  
 Post-Installation Instructions:
 -------------------------------
 See the "PPS-N Deployment, Installation, Back-Out, and Rollback Guide" for
 detailed information on how to configure the new process for automatically
 downloading and installing NDF Updates.
  
  
 Back-Out Plan:
 --------------
 See the "PPS-N Deployment, Installation, Back-Out, and Rollback Guide" for
 uninstalling the patch.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;4.0;NATIONAL DRUG FILE;**[Patch List]**; 30 Oct 98;Build 53

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: PSN513PO
    Before:       n/a   After: B71890628  **513**
Routine Name: PSNCFINQ
    Before:       n/a   After: B51923740  **513**
Routine Name: PSNCLEAN
    Before: B38230094   After: B38230094  **117,176,513**
Routine Name: PSNFTP
    Before:       n/a   After:B220445770  **513**
Routine Name: PSNFTP2
    Before:       n/a   After:B136877012  **513**
Routine Name: PSNFTP3
    Before:       n/a   After:  B8030989  **513**
Routine Name: PSNOSKEY
    Before:       n/a   After: B85865292  **513**
Routine Name: PSNPARM
    Before:       n/a   After: B55605893  **513**
Routine Name: PSNPPSCL
    Before:       n/a   After: B48571285  **513**
Routine Name: PSNPPSDL
    Before:       n/a   After: B29912980  **513**
Routine Name: PSNPPSI1
    Before:       n/a   After:  B5027313  **513**
Routine Name: PSNPPSI2
    Before:       n/a   After:B117398131  **513**
Routine Name: PSNPPSI3
    Before:       n/a   After: B48818890  **513**
Routine Name: PSNPPSMG
    Before:       n/a   After: B90560472  **513**
Routine Name: PSNPPSMS
    Before:       n/a   After:B168622866  **513**
Routine Name: PSNPPSNC
    Before:       n/a   After: B14201170  **513**
Routine Name: PSNPPSNF
    Before:       n/a   After: B92527436  **513**
Routine Name: PSNPPSNK
    Before:       n/a   After: B45231905  **513**
Routine Name: PSNPPSNP
    Before:       n/a   After:B105233579  **513**
Routine Name: PSNPPSNR
    Before:       n/a   After: B98892215  **513**
Routine Name: PSNPPSNU
    Before:       n/a   After: B51690215  **513**
Routine Name: PSNPPSNV
    Before:       n/a   After:B179018356  **513**
Routine Name: PSNPPSNW
    Before:       n/a   After: B35107109  **513**
Routine Name: PSNVCR
    Before:       n/a   After:B169194760  **513**
Routine Name: PSNVCR1
    Before:       n/a   After:B106479512  **513**
Routine Name: PSNVCR2
    Before:       n/a   After:B207861885  **513**
 
Routine list of preceding patches: 176

=============================================================================
User Information:
Entered By  :                               Date Entered  : JAN 11, 2017
Completed By:                               Date Completed: JAN 31, 2018
Released By :                               Date Released : JAN 31, 2018
=============================================================================


Packman Mail Message:
=====================

$END TXT
