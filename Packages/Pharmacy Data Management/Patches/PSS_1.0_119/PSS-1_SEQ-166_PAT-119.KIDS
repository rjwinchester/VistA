Released PSS*1*119 SEQ #166
Extracted from mail message
**KIDS**:PSS*1.0*119^

**INSTALL NAME**
PSS*1.0*119
"BLD",7076,0)
PSS*1.0*119^PHARMACY DATA MANAGEMENT^0^3150220^y
"BLD",7076,1,0)
^^19^19^3140822^
"BLD",7076,1,1,0)
This patch will correct the issue reported:
"BLD",7076,1,2,0)
 
"BLD",7076,1,3,0)
 
"BLD",7076,1,4,0)
1) INC0000149525 - Problems placing PRN orders with multiple spaces/words
"BLD",7076,1,5,0)
 
"BLD",7076,1,6,0)
 
"BLD",7076,1,7,0)
*********************************************************************
"BLD",7076,1,8,0)
*                              WARNING                              *
"BLD",7076,1,9,0)
*                                                                   *
"BLD",7076,1,10,0)
*  This patch contains an environment check and will only install   *
"BLD",7076,1,11,0)
*           if one of the following conditions is met.              *
"BLD",7076,1,12,0)
*                                                                   *
"BLD",7076,1,13,0)
*  1)  If the site is a CMOP site this patch will be installed.     *
"BLD",7076,1,14,0)
*                                                                   *
"BLD",7076,1,15,0)
*  2)  If you are NOT a CMOP site and patches PSJ*5.0*194 and       *
"BLD",7076,1,16,0)
*      PSO*7.0*282 are installed.                                   *
"BLD",7076,1,17,0)
*                                                                   *
"BLD",7076,1,18,0)
*                                                                   *
"BLD",7076,1,19,0)
*********************************************************************
"BLD",7076,4,0)
^9.64PA^51.1^3
"BLD",7076,4,50,0)
50
"BLD",7076,4,50,2,0)
^9.641^50^1
"BLD",7076,4,50,2,50,0)
DRUG  (File-top level)
"BLD",7076,4,50,2,50,1,0)
^9.6411^62.04^1
"BLD",7076,4,50,2,50,1,62.04,0)
UNIT DOSE SCHEDULE
"BLD",7076,4,50,222)
y^y^p^^^^n^^n
"BLD",7076,4,50,224)

"BLD",7076,4,51,0)
51
"BLD",7076,4,51,2,0)
^9.641^51^1
"BLD",7076,4,51,2,51,0)
MEDICATION INSTRUCTION  (File-top level)
"BLD",7076,4,51,2,51,1,0)
^9.6411^3^1
"BLD",7076,4,51,2,51,1,3,0)
SCHEDULE
"BLD",7076,4,51,222)
y^y^p^^^^n^^n
"BLD",7076,4,51,224)

"BLD",7076,4,51.1,0)
51.1
"BLD",7076,4,51.1,2,0)
^9.641^51.1^1
"BLD",7076,4,51.1,2,51.1,0)
ADMINISTRATION SCHEDULE  (File-top level)
"BLD",7076,4,51.1,2,51.1,1,0)
^9.6411^.01^1
"BLD",7076,4,51.1,2,51.1,1,.01,0)
NAME
"BLD",7076,4,51.1,222)
y^y^p^^^^n^^n
"BLD",7076,4,51.1,224)

"BLD",7076,4,"APDD",50,50)

"BLD",7076,4,"APDD",50,50,62.04)

"BLD",7076,4,"APDD",51,51)

"BLD",7076,4,"APDD",51,51,3)

"BLD",7076,4,"APDD",51.1,51.1)

"BLD",7076,4,"APDD",51.1,51.1,.01)

"BLD",7076,4,"B",50,50)

"BLD",7076,4,"B",51,51)

"BLD",7076,4,"B",51.1,51.1)

"BLD",7076,6)
9^
"BLD",7076,6.3)
9
"BLD",7076,"ABPKG")
n
"BLD",7076,"KRN",0)
^9.67PA^8989.52^19
"BLD",7076,"KRN",.4,0)
.4
"BLD",7076,"KRN",.401,0)
.401
"BLD",7076,"KRN",.402,0)
.402
"BLD",7076,"KRN",.403,0)
.403
"BLD",7076,"KRN",.5,0)
.5
"BLD",7076,"KRN",.84,0)
.84
"BLD",7076,"KRN",3.6,0)
3.6
"BLD",7076,"KRN",3.8,0)
3.8
"BLD",7076,"KRN",9.2,0)
9.2
"BLD",7076,"KRN",9.8,0)
9.8
"BLD",7076,"KRN",9.8,"NM",0)
^9.68A^5^4
"BLD",7076,"KRN",9.8,"NM",2,0)
PSSGSGUI^^0^B24878551
"BLD",7076,"KRN",9.8,"NM",3,0)
PSSDDUT^^0^B42845395
"BLD",7076,"KRN",9.8,"NM",4,0)
PSSGS0^^0^B15355256
"BLD",7076,"KRN",9.8,"NM",5,0)
PSSEC119^^0^B3517488
"BLD",7076,"KRN",9.8,"NM","B","PSSDDUT",3)

"BLD",7076,"KRN",9.8,"NM","B","PSSEC119",5)

"BLD",7076,"KRN",9.8,"NM","B","PSSGS0",4)

"BLD",7076,"KRN",9.8,"NM","B","PSSGSGUI",2)

"BLD",7076,"KRN",19,0)
19
"BLD",7076,"KRN",19,"NM",0)
^9.68A^^
"BLD",7076,"KRN",19.1,0)
19.1
"BLD",7076,"KRN",101,0)
101
"BLD",7076,"KRN",409.61,0)
409.61
"BLD",7076,"KRN",771,0)
771
"BLD",7076,"KRN",870,0)
870
"BLD",7076,"KRN",8989.51,0)
8989.51
"BLD",7076,"KRN",8989.52,0)
8989.52
"BLD",7076,"KRN",8994,0)
8994
"BLD",7076,"KRN","B",.4,.4)

"BLD",7076,"KRN","B",.401,.401)

"BLD",7076,"KRN","B",.402,.402)

"BLD",7076,"KRN","B",.403,.403)

"BLD",7076,"KRN","B",.5,.5)

"BLD",7076,"KRN","B",.84,.84)

"BLD",7076,"KRN","B",3.6,3.6)

"BLD",7076,"KRN","B",3.8,3.8)

"BLD",7076,"KRN","B",9.2,9.2)

"BLD",7076,"KRN","B",9.8,9.8)

"BLD",7076,"KRN","B",19,19)

"BLD",7076,"KRN","B",19.1,19.1)

"BLD",7076,"KRN","B",101,101)

"BLD",7076,"KRN","B",409.61,409.61)

"BLD",7076,"KRN","B",771,771)

"BLD",7076,"KRN","B",870,870)

"BLD",7076,"KRN","B",8989.51,8989.51)

"BLD",7076,"KRN","B",8989.52,8989.52)

"BLD",7076,"KRN","B",8994,8994)

"BLD",7076,"QDEF")
^^^^NO^^^^^^NO
"BLD",7076,"QUES",0)
^9.62^^
"BLD",7076,"REQB",0)
^9.611^2^2
"BLD",7076,"REQB",1,0)
PSS*1.0*94^2
"BLD",7076,"REQB",2,0)
PSS*1.0*143^2
"BLD",7076,"REQB","B","PSS*1.0*143",2)

"BLD",7076,"REQB","B","PSS*1.0*94",1)

"FIA",50)
DRUG
"FIA",50,0)
^PSDRUG(
"FIA",50,0,0)
50I
"FIA",50,0,1)
y^y^p^^^^n^^n
"FIA",50,0,10)

"FIA",50,0,11)

"FIA",50,0,"RLRO")

"FIA",50,0,"VR")
1.0^PSS
"FIA",50,50)
1
"FIA",50,50,62.04)

"FIA",51)
MEDICATION INSTRUCTION
"FIA",51,0)
^PS(51,
"FIA",51,0,0)
51I
"FIA",51,0,1)
y^y^p^^^^n^^n
"FIA",51,0,10)

"FIA",51,0,11)

"FIA",51,0,"RLRO")

"FIA",51,0,"VR")
1.0^PSS
"FIA",51,51)
1
"FIA",51,51,3)

"FIA",51.1)
ADMINISTRATION SCHEDULE
"FIA",51.1,0)
^PS(51.1,
"FIA",51.1,0,0)
51.1I
"FIA",51.1,0,1)
y^y^p^^^^n^^n
"FIA",51.1,0,10)

"FIA",51.1,0,11)

"FIA",51.1,0,"RLRO")

"FIA",51.1,0,"VR")
1.0^PSS
"FIA",51.1,51.1)
1
"FIA",51.1,51.1,.01)

"MBREQ")
0
"PKG",488,-1)
1^1
"PKG",488,0)
PHARMACY DATA MANAGEMENT^PSS^Maintenance of Pharmacy files.
"PKG",488,20,0)
^9.402P^^
"PKG",488,22,0)
^9.49I^1^1
"PKG",488,22,1,0)
1.0^2970930^3000316^66481
"PKG",488,22,1,"PAH",1,0)
119^3150220^1231
"PKG",488,22,1,"PAH",1,1,0)
^^19^19^3150220
"PKG",488,22,1,"PAH",1,1,1,0)
This patch will correct the issue reported:
"PKG",488,22,1,"PAH",1,1,2,0)
 
"PKG",488,22,1,"PAH",1,1,3,0)
 
"PKG",488,22,1,"PAH",1,1,4,0)
1) INC0000149525 - Problems placing PRN orders with multiple spaces/words
"PKG",488,22,1,"PAH",1,1,5,0)
 
"PKG",488,22,1,"PAH",1,1,6,0)
 
"PKG",488,22,1,"PAH",1,1,7,0)
*********************************************************************
"PKG",488,22,1,"PAH",1,1,8,0)
*                              WARNING                              *
"PKG",488,22,1,"PAH",1,1,9,0)
*                                                                   *
"PKG",488,22,1,"PAH",1,1,10,0)
*  This patch contains an environment check and will only install   *
"PKG",488,22,1,"PAH",1,1,11,0)
*           if one of the following conditions is met.              *
"PKG",488,22,1,"PAH",1,1,12,0)
*                                                                   *
"PKG",488,22,1,"PAH",1,1,13,0)
*  1)  If the site is a CMOP site this patch will be installed.     *
"PKG",488,22,1,"PAH",1,1,14,0)
*                                                                   *
"PKG",488,22,1,"PAH",1,1,15,0)
*  2)  If you are NOT a CMOP site and patches PSJ*5.0*194 and       *
"PKG",488,22,1,"PAH",1,1,16,0)
*      PSO*7.0*282 are installed.                                   *
"PKG",488,22,1,"PAH",1,1,17,0)
*                                                                   *
"PKG",488,22,1,"PAH",1,1,18,0)
*                                                                   *
"PKG",488,22,1,"PAH",1,1,19,0)
*********************************************************************
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PSSDDUT")
0^3^B42845395^B42335863
"RTN","PSSDDUT",1,0)
PSSDDUT ;BIR/LDT-Pharmacy Data Management DD Utility ;09/15/97
"RTN","PSSDDUT",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**13,18,19,38,56,119**;9/30/97;Build 9
"RTN","PSSDDUT",3,0)
 ;
"RTN","PSSDDUT",4,0)
SCH ;Called from DRUG file (50), Unit Dose Schedule field 62.04
"RTN","PSSDDUT",5,0)
 ;(Replaces EN^PSGS0)
"RTN","PSSDDUT",6,0)
 ;*119 Allow multi-word schedules
"RTN","PSSDDUT",7,0)
 I X[""""!($A(X)=45)!(X?.E1C.E)!($L(X," ")>$S(X["PRN":4,1:3))!($L(X)>70)!($L(X)<1)!(X["P RN")!(X["PR N") K X Q
"RTN","PSSDDUT",8,0)
 I X?.E1L.E S X=$$ENLU^PSSGMI(X) I '$D(PSGOES) D EN^DDIOL("  ("_X_")","","?0")
"RTN","PSSDDUT",9,0)
 I X["Q0" K X Q
"RTN","PSSDDUT",10,0)
 ;
"RTN","PSSDDUT",11,0)
ENOS ; order set entry
"RTN","PSSDDUT",12,0)
 S (PSGS0XT,PSGS0Y,XT,Y)="" I X["PRN"!(X="ON CALL")!(X="ONCALL")!(X="ON-CALL") G Q
"RTN","PSSDDUT",13,0)
 S X0=X I X,X'["X",(X?2.4N1"-".E!(X?2.4N)) D ENCHK^PSSGS0 S:$D(X) Y=X G Q
"RTN","PSSDDUT",14,0)
 I $S($D(^PS(51.1,"AC","PSJ",X)):1,1:$E($O(^(X)),1,$L(X))=X) D DIC^PSSGS0 I $G(XT)]"" G Q
"RTN","PSSDDUT",15,0)
 I X["@" D DW^PSSGS0 S:$D(X) Y=$P(X,"@",2) G Q
"RTN","PSSDDUT",16,0)
 I Y'>0,$S(X="NOW":1,X="ONCE":1,X="STAT":1,X="ONE TIME":1,X="ONETIME":1,X="1TIME":1,X="1 TIME":1,X="1-TIME":1,1:X="ONE-TIME") D:'$D(PSGOES) EN^DDIOL("  (ONCE ONLY)","","?0") S Y="",XT="O" G Q
"RTN","PSSDDUT",17,0)
 I $G(PSGSCH)=X S PSGS0Y=$G(PSGAT) Q
"RTN","PSSDDUT",18,0)
 ;
"RTN","PSSDDUT",19,0)
NS I Y'>0 D:'$D(PSGOES) EN^DDIOL("  (Nonstandard schedule)","","?0") S X=X0,Y=""
"RTN","PSSDDUT",20,0)
 I $E(X,1,2)="AD" K X G Q
"RTN","PSSDDUT",21,0)
 I $E(X,1,3)="BID"!($E(X,1,3)="TID")!($E(X,1,3)="QID") S XT=1440/$F("BTQ",$E(X)) G Q
"RTN","PSSDDUT",22,0)
 S:$E(X)="Q" X=$E(X,2,99) S:'X X="1"_X S X1=+X,X=$P(X,+X,2),X2=0 S:X1<0 X1=-X1 S:$E(X)="X" X2=1,X=$E(X,2,99)
"RTN","PSSDDUT",23,0)
 S XT=$S(X["'":1,(X["D"&(X'["AD"))!(X["AM")!(X["PM")!(X["HS"&(X'["THS")):1440,X["H"&(X'["TH"):60,X["AC"!(X["PC"):480,X["W":10080,X["M":40320,1:-1) I XT<0,Y'>0 K X G Q
"RTN","PSSDDUT",24,0)
 S X=X0 I XT S:X2 XT=XT\X1 I 'X2 S:$E(X,1,2)="QO" XT=XT*2 S XT=XT*X1
"RTN","PSSDDUT",25,0)
 ;
"RTN","PSSDDUT",26,0)
Q ;
"RTN","PSSDDUT",27,0)
 S PSGS0XT=$S(XT]"":XT,1:""),PSGS0Y=$S(Y:Y,1:"") K QX,SDW,SWD,X0,XT,Z Q
"RTN","PSSDDUT",28,0)
 ;
"RTN","PSSDDUT",29,0)
ENSH5 ; from ^DD(55.06,26,4)
"RTN","PSSDDUT",30,0)
 S:'$D(PSGST) PSGST=$P($G(^PS(55,DA(1),5,DA,0)),"^",7),PSGDDFLG=1 G ENSH
"RTN","PSSDDUT",31,0)
 ;
"RTN","PSSDDUT",32,0)
ENSH ;Called from MEDICATION INSTRUCTION file (51), field 5 Executable Help
"RTN","PSSDDUT",33,0)
 ;(Replaces ENSH^PSSGSH)
"RTN","PSSDDUT",34,0)
 N D,DA,DIC,DIE,DZ,Y
"RTN","PSSDDUT",35,0)
 D EN^DDIOL("'STAT', 'ONCE', 'NOW', and 'DAILY' are acceptable schedules.","","?0") I X?1"???".E F Q=1:1 Q:$P($T(HT+Q),";",3)=""  S PSSHLP(Q)=$P($T(HT+Q),";",3)
"RTN","PSSDDUT",36,0)
 I X?1"???".E D EN^DDIOL(.PSSHLP) K PSSHLP
"RTN","PSSDDUT",37,0)
 I X?1"???".E R !,"(Press RETURN to continue.) ",Q:DTIME D:'$T EN^DDIOL("","","$C(7)") S:'$T Q="^" I Q="^" K:$D(PSGDDFLG) PSGDDFLG,PSGST Q
"RTN","PSSDDUT",38,0)
 K DIC S DIC="^PS(51.1,",DIC(0)="E",D="APPSJ",DIC("W")="W ""  ""," I $D(PSJPWD),PSJPWD S DIC("W")=DIC("W")_"$S($D(^PS(51.1,+Y,1,PSJPWD,0)):$P(^(0),""^"",2),1:$P(^PS(51.1,+Y,0),""^"",2))"
"RTN","PSSDDUT",39,0)
 E  S DIC("W")=DIC("W")_"$P(^(0),""^"",2)"
"RTN","PSSDDUT",40,0)
 I $D(PSGST) S DIC("S")="I $P(^(0),""^"",5)"_$E("'",PSGST'="O")_"=""O"""
"RTN","PSSDDUT",41,0)
 D IX^DIC K DIC K:$D(PSGDDFLG) PSGDDFLG,PSGST Q
"RTN","PSSDDUT",42,0)
 ;
"RTN","PSSDDUT",43,0)
HT ;
"RTN","PSSDDUT",44,0)
 ;;  This is the frequency (ONLY) with which the doses are to be
"RTN","PSSDDUT",45,0)
 ;;administered.  Several forms of entry are acceptable, such as
"RTN","PSSDDUT",46,0)
 ;;Q6H, 09-12-15, STAT, QOD, and MO-WE-FR@AD (where MO-WE-FR are
"RTN","PSSDDUT",47,0)
 ;;days of the week, and AD is the admin times).  The schedule
"RTN","PSSDDUT",48,0)
 ;;will show on the MAR, labels, etc.  No more than ONE space
"RTN","PSSDDUT",49,0)
 ;;(Q3H 4 or Q4H PRN) in the schedule is acceptable.  If the
"RTN","PSSDDUT",50,0)
 ;;letters PRN ;;are found as part of the schedule, no admin
"RTN","PSSDDUT",51,0)
 ;;times will print on the MAR or labels, and the PICK LIST will
"RTN","PSSDDUT",52,0)
 ;;always show a count of zero (0).
"RTN","PSSDDUT",53,0)
 ;;Avoid using notation such as W/F (with food) or WM (with meals)
"RTN","PSSDDUT",54,0)
 ;;in the schedule as it may cause erroneous calculations.  That
"RTN","PSSDDUT",55,0)
 ;;information should be entered into the SPECIAL INSTRUCTIONS.
"RTN","PSSDDUT",56,0)
 ;;  When using the MO-WE-FR@AD schedule, please remember that
"RTN","PSSDDUT",57,0)
 ;;this type of schedule will not work properly without the "@"
"RTN","PSSDDUT",58,0)
 ;;character and at least one admin time, and that at least the
"RTN","PSSDDUT",59,0)
 ;;first two letters of each weekday entered is needed.
"RTN","PSSDDUT",60,0)
 ;
"RTN","PSSDDUT",61,0)
 ;
"RTN","PSSDDUT",62,0)
ENDLP ;Called from Pharmacy System file (59.7), field 60.1 BAXTER ATC
"RTN","PSSDDUT",63,0)
 ;212 DEVICE (Replaces ENDLP^PSGSET)
"RTN","PSSDDUT",64,0)
 S PSGION=$S($D(ION):ION,1:"HOME") K %ZIS S %ZIS="QN",IOP=X D ^%ZIS I POP S IOP=PSGION D ^%ZIS K %ZIS,IOP,PSGION S X="" Q
"RTN","PSSDDUT",65,0)
 D EN^DDIOL($S(X=$E(ION,1,$L(X)):$E(ION,$L(X)+1,$L(ION)),1:"  "_ION),"","?0") S X=ION D ^%ZISC K %ZIS,PSGION,IOP Q
"RTN","PSSDDUT",66,0)
 ;
"RTN","PSSDDUT",67,0)
ENSTH ;Executable help for type of schedule. (Replaces ENSTH^PSJSV0)
"RTN","PSSDDUT",68,0)
 N PSSX S PSSX=1
"RTN","PSSDDUT",69,0)
 S PSSHLP(PSSX)="The TYPE OF SCHEDULE determines how the schedule will be processed."
"RTN","PSSDDUT",70,0)
 S PSSHLP(PSSX,"F")="!!?2",PSSX=PSSX+1
"RTN","PSSDDUT",71,0)
 S PSSHLP(PSSX)="A CONTINUOUS schedule is one in which an action is to take place on a"
"RTN","PSSDDUT",72,0)
 S PSSHLP(PSSX,"F")="!!?2",PSSX=PSSX+1
"RTN","PSSDDUT",73,0)
 S PSSHLP(PSSX)="regular basis, such as 'three times a day' or 'once every two days'."
"RTN","PSSDDUT",74,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",75,0)
 S PSSHLP(PSSX)="A DAY OF THE WEEK schedule is one in which the action is to take"
"RTN","PSSDDUT",76,0)
 S PSSHLP(PSSX,"F")="!?2",PSSX=PSSX+1
"RTN","PSSDDUT",77,0)
 S PSSHLP(PSSX)="place only on specific days of the week.  This type of schedule"
"RTN","PSSDDUT",78,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",79,0)
 S PSSHLP(PSSX)="should have admin times entered with it.  If not, the start time of"
"RTN","PSSDDUT",80,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",81,0)
 S PSSHLP(PSSX)="the order is used as the admin time.  Whenever this type is chosen,"
"RTN","PSSDDUT",82,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",83,0)
 S PSSHLP(PSSX)="the name of the schedule must be in the form of 'MO-WE-FR'."
"RTN","PSSDDUT",84,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",85,0)
 G:$S('$D(PSJPP):1,PSJPP="":1,1:PSJPP="PSJ") HOT
"RTN","PSSDDUT",86,0)
 S PSSHLP(PSSX)="A DAY OF THE WEEK-RANGE schedule is one in which the action to take"
"RTN","PSSDDUT",87,0)
 S PSSHLP(PSSX,"F")="!?2",PSSX=PSSX+1
"RTN","PSSDDUT",88,0)
 S PSSHLP(PSSX)="place only on specific days of the week, but at no specific time of"
"RTN","PSSDDUT",89,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",90,0)
 S PSSHLP(PSSX)="day (no admin times).  Whenever this type is chosen, the name of the"
"RTN","PSSDDUT",91,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",92,0)
 S PSSHLP(PSSX)="schedule must be in the form of 'MO-WE-FR'."
"RTN","PSSDDUT",93,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",94,0)
HOT S PSSHLP(PSSX)="A ONE-TIME schedule is one in which the action is to take place once"
"RTN","PSSDDUT",95,0)
 S PSSHLP(PSSX,"F")="!?2",PSSX=PSSX+1
"RTN","PSSDDUT",96,0)
 S PSSHLP(PSSX)="only at a specific date and time."
"RTN","PSSDDUT",97,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",98,0)
 I $S('$D(PSJPP):1,PSJPP="":1,1:PSJPP="PSJ") D WRITE Q
"RTN","PSSDDUT",99,0)
 S PSSHLP(PSSX)="A RANGE schedule is one in which the action will take place within a"
"RTN","PSSDDUT",100,0)
 S PSSHLP(PSSX,"F")="!?2",PSSX=PSSX+1
"RTN","PSSDDUT",101,0)
 S PSSHLP(PSSX)="given date range."
"RTN","PSSDDUT",102,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",103,0)
 S PSSHLP(PSSX)="A SHIFT schedule is one in which the action will take place within a"
"RTN","PSSDDUT",104,0)
 S PSSHLP(PSSX,"F")="!?2",PSSX=PSSX+1
"RTN","PSSDDUT",105,0)
 S PSSHLP(PSSX)="given range of times of day."
"RTN","PSSDDUT",106,0)
 S PSSHLP(PSSX,"F")="!",PSSX=PSSX+1
"RTN","PSSDDUT",107,0)
 D WRITE
"RTN","PSSDDUT",108,0)
 Q
"RTN","PSSDDUT",109,0)
WRITE ;Calls EN^DDIOL to write text
"RTN","PSSDDUT",110,0)
 D EN^DDIOL(.PSSHLP) K PSSHLP
"RTN","PSSDDUT",111,0)
 Q
"RTN","PSSDDUT",112,0)
PSS13 ;Screen for CLINIC field - PDM patch PSS*1*13
"RTN","PSSDDUT",113,0)
 N X,PSSDT
"RTN","PSSDDUT",114,0)
 S X1=DT,X2=-7 D C^%DTC S PSSDT=X
"RTN","PSSDDUT",115,0)
 I $P($G(^(0)),U,3)="C",$S('$P($G(^("I")),U):1,($P($G(^("I")),U)>PSSDT):1,(($P($G(^("I")),U)<PSSDT)&($P($G(^("I")),U,2)]"")&(DT>$P($G(^("I")),U,2))):1,1:0)
"RTN","PSSDDUT",116,0)
 Q
"RTN","PSSDDUT",117,0)
PSS19 ;Delete DRUG GROUP/INTERACTION field #7 - PDM patch PSS*1*19
"RTN","PSSDDUT",118,0)
 S DIK="^DD(50,",DA=7,DA(1)=50 D ^DIK
"RTN","PSSDDUT",119,0)
 ;
"RTN","PSSDDUT",120,0)
 ;In File #50, delete "I" node if it is null.
"RTN","PSSDDUT",121,0)
 N PSSIEN
"RTN","PSSDDUT",122,0)
 F PSSIEN=0:0 S PSSIEN=$O(^PSDRUG(PSSIEN)) Q:'PSSIEN  I $D(^PSDRUG(PSSIEN,"I")),$P(^PSDRUG(PSSIEN,"I"),"^")="" K ^PSDRUG(PSSIEN,"I")
"RTN","PSSDDUT",123,0)
 Q
"RTN","PSSEC119")
0^5^B3517488^n/a
"RTN","PSSEC119",1,0)
PSSEC119 ;RJS-Environment check routine for PSS*1*119 ; 05/30/07
"RTN","PSSEC119",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**119**;9/30/97;Build 9
"RTN","PSSEC119",3,0)
 N PSSFL1,PSSFL2
"RTN","PSSEC119",4,0)
 S PSSFL1="",PSSFL2=""
"RTN","PSSEC119",5,0)
 I $O(^PSX(550,"C",0))!(^XMB("NETNAME")?1"CMOP-".E) W !!,?10,"Consolidated Mail Outpatient Pharmacy Install.",!! S XPDQUIT=1 Q
"RTN","PSSEC119",6,0)
 ; Not a CMOP site.  Check for required patches.
"RTN","PSSEC119",7,0)
 ; Required patches are PSJ*5.0*194 and PSO*7.0*282
"RTN","PSSEC119",8,0)
 I '$$PATCH^XPDUTL("PSJ*5.0*194") S PSSFL1=1 ; Required patch
"RTN","PSSEC119",9,0)
 I '$$PATCH^XPDUTL("PSO*7.0*282") S PSSFL2=1 ; Required patch
"RTN","PSSEC119",10,0)
 I PSSFL1=1!(PSSFL2=1) D
"RTN","PSSEC119",11,0)
 . ; Logic to notify the IRM
"RTN","PSSEC119",12,0)
 .W !!,"****************************************************************************"
"RTN","PSSEC119",13,0)
 .W !,"*",?34,"WARNING",?75,"*",!,"*",?75,"*"
"RTN","PSSEC119",14,0)
 .I PSSFL1=1 W !,"*",?14,"Required patch PSJ*5.0*194 is not installed.",?75,"*"
"RTN","PSSEC119",15,0)
 .I PSSFL2=1 W !,"*",?14,"Required patch PSO*7.0*282 is not installed.",?75,"*",!,"*",?75,"*"
"RTN","PSSEC119",16,0)
 .W !,"*",?10,"Please install the above mentioned required patch(es).",?75,"*"
"RTN","PSSEC119",17,0)
 .W !,"*Once the required patch(es) are installed, you can reinstall(PSS*1.0*119).*"
"RTN","PSSEC119",18,0)
 .W !,"****************************************************************************"
"RTN","PSSEC119",19,0)
 .S XPDQUIT=1 ; This will cause the install to quit and delete the transport global.
"RTN","PSSEC119",20,0)
 Q
"RTN","PSSGS0")
0^4^B15355256^B14901038
"RTN","PSSGS0",1,0)
PSSGS0 ;BIR/CML3-SCHEDULE PROCESSOR ;06/01/98
"RTN","PSSGS0",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**12,27,38,44,56,69,59,143,119**;9/30/97;Build 9
"RTN","PSSGS0",3,0)
 ;Reference to $$TRIM^XLFSTR supported by DBIA #10104
"RTN","PSSGS0",4,0)
 ;Reference to ^PS(53.1 supported by DBIA #2140
"RTN","PSSGS0",5,0)
 ;
"RTN","PSSGS0",6,0)
ENA ; entry point for train option
"RTN","PSSGS0",7,0)
 ;N X S X="PSGSETU" X ^%ZOSF("TEST") I  D ENCV^PSGSETU Q:$D(XQUIT)
"RTN","PSSGS0",8,0)
 ;F  S (PSGS0Y,PSGS0XT)="" R !!,"Select STANDARD SCHEDULE: ",X:DTIME W:'$T $C(7) S:'$T X="^" Q:"^"[X  D:X?1."?" ENQ^PSSGSH I X'?1."?" D EN W:$D(X)[0 $C(7),"  ??" I $D(X)#2,'PSGS0Y,PSGS0XT W "  Every ",PSGS0XT," minutes"
"RTN","PSSGS0",9,0)
 ;K DIC,DIE,PSGS0XT,PSGS0Y,Q,X,Y,PSGDT Q
"RTN","PSSGS0",10,0)
 Q
"RTN","PSSGS0",11,0)
 ;
"RTN","PSSGS0",12,0)
EN3 ;
"RTN","PSSGS0",13,0)
 S PSGST=$P($G(^PS(53.1,DA,0)),"^",7) G EN
"RTN","PSSGS0",14,0)
 ;
"RTN","PSSGS0",15,0)
EN5 ;
"RTN","PSSGS0",16,0)
 S PSGST=$P($G(^PS(55,DA(1),5,DA,0)),"^",7)
"RTN","PSSGS0",17,0)
 ;
"RTN","PSSGS0",18,0)
EN(X,PSSLSTPK) ; validate
"RTN","PSSGS0",19,0)
 ;I X[""""!($A(X)=45)!(X?.E1C.E)!($L(X," ")>2)!($L(X)>70)!($L(X)<1)!(X["P RN")!(X["PR N")!($E(X,1)=" ") K X Q
"RTN","PSSGS0",20,0)
 I $G(PSSLSTPK)="O"!(PSSLSTPK="X") Q:$G(X)=""  G ENOP
"RTN","PSSGS0",21,0)
 ;*119 Allow multi-word schedules
"RTN","PSSGS0",22,0)
 I X[""""!($A(X)=45)!(X?.E1C.E)!($L(X," ")>$S(X["PRN":4,1:3))!($L(X)>70)!($L(X)<1) K X Q
"RTN","PSSGS0",23,0)
 S X=$$TRIM^XLFSTR(X,"R"," ")
"RTN","PSSGS0",24,0)
 I X?.E1L.E S X=$$ENLU^PSSGMI(X)
"RTN","PSSGS0",25,0)
 ;
"RTN","PSSGS0",26,0)
ENOS ; order set entry
"RTN","PSSGS0",27,0)
 S (PSGS0XT,PSGS0Y,XT,Y)=""
"RTN","PSSGS0",28,0)
 I X="OTHER" G Q
"RTN","PSSGS0",29,0)
 I X["PRN",$$PRNOK(X) G Q
"RTN","PSSGS0",30,0)
 I X["@" D DW S:$D(X) Y=$P(X,"@",2) G Q
"RTN","PSSGS0",31,0)
 S X0=X I X,X'["X",(X?2.4N1"-".E!(X?2.4N)) D ENCHK S:$D(X) Y=X G Q
"RTN","PSSGS0",32,0)
 I $S($D(^PS(51.1,"AC","PSJ",X)):1,1:$E($O(^(X)),1,$L(X))=X) D DIC I XT]"" G Q
"RTN","PSSGS0",33,0)
 I $G(PSGSCH)=X S PSGS0Y=$G(PSGAT) Q
"RTN","PSSGS0",34,0)
 K X Q
"RTN","PSSGS0",35,0)
 ;
"RTN","PSSGS0",36,0)
NS I (X="^")!(X="") K X Q
"RTN","PSSGS0",37,0)
 I Y'>0 S X=X0,Y=""
"RTN","PSSGS0",38,0)
Q ;
"RTN","PSSGS0",39,0)
 S PSGS0XT=$S(XT]"":XT,1:""),PSGS0Y=$S(Y:Y,1:"") K QX,SDW,SWD,X0,XT,Z Q
"RTN","PSSGS0",40,0)
 ;
"RTN","PSSGS0",41,0)
ENCHK ;Ward times
"RTN","PSSGS0",42,0)
 I $S($L($P(X,"-"))>4:1,$L(X)>119:1,$L(X)<2:1,X'>0:1,1:X'?.ANP) K X Q
"RTN","PSSGS0",43,0)
 S X(1)=$P(X,"-") I X(1)'?2N,X(1)'?4N K X Q
"RTN","PSSGS0",44,0)
 S X(1)=$L(X(1)) I X'["-",X>$E(2400,1,X(1)) K X Q
"RTN","PSSGS0",45,0)
 F X(2)=2:1:$L(X,"-") S X(3)=$P(X,"-",X(2)) I $S($L(X(3))'=X(1):1,X(3)>$E(2400,1,X(1)):1,1:X(3)'>$P(X,"-",X(2)-1)) K X Q
"RTN","PSSGS0",46,0)
 K:$D(X) X(1),X(2),X(3)
"RTN","PSSGS0",47,0)
 Q
"RTN","PSSGS0",48,0)
 ;
"RTN","PSSGS0",49,0)
ENOP ;
"RTN","PSSGS0",50,0)
 ;*119 Allow multi-word schedules
"RTN","PSSGS0",51,0)
 I X[""""!($A(X)=45)!(X?.E1C.E)!($L(X," ")>$S(X["PRN":4,1:3))!($L(X)>20)!($L(X)<1) K X Q
"RTN","PSSGS0",52,0)
 N PSSUPPER S X=$$UPPER(X)
"RTN","PSSGS0",53,0)
 K Y,DIC S DIC="^PS(51.1,",DIC(0)="E",D="APPSJ",DIC("W")="D DICW^PSSGS0" D IX^DIC I Y>0 S X=$P(Y,"^",2) Q
"RTN","PSSGS0",54,0)
 K Y,DIC S DIC=51,DIC(0)="ME" D ^DIC I Y>0 S X=$P(Y,"^",2)
"RTN","PSSGS0",55,0)
 Q
"RTN","PSSGS0",56,0)
 ;
"RTN","PSSGS0",57,0)
DIC ;
"RTN","PSSGS0",58,0)
 K DIC S DIC="^PS(51.1,",DIC(0)=$E("E",'$D(PSGOES))_"ISZ",DIC("W")="W ""  "","_$S('$D(PSJPWD):"$P(^(0),""^"",2)",'PSJPWD:"$P(^(0),""^"",2)",1:"$S($D(^PS(51.1,+Y,1,+PSJPWD,0)):$P(^(0),""^"",2),1:$P(^PS(51.1,+Y,0),""^"",2))"),D="APPSJ"
"RTN","PSSGS0",59,0)
 S DIC("W")=""
"RTN","PSSGS0",60,0)
 I $D(PSGST) S DIC("S")="I $P(^(0),""^"",5)"_$E("'",PSGST'="O")_"=""O"""
"RTN","PSSGS0",61,0)
 D IX^DIC K DIC S:$D(DIE)#2 DIC=DIE Q:Y'>0
"RTN","PSSGS0",62,0)
 S XT=$S("C"[$P(Y(0),"^",5):$P(Y(0),"^",3),1:$P(Y(0),"^",5)),X=+Y,Y="" I $D(PSJPWD),$D(^PS(51.1,X,1,+PSJPWD,0)) S Y=$P(^(0),"^",2)
"RTN","PSSGS0",63,0)
 S (X,X0)=Y(0,0) S:Y="" Y=$P(Y(0),"^",2) Q
"RTN","PSSGS0",64,0)
 ;
"RTN","PSSGS0",65,0)
DW ;
"RTN","PSSGS0",66,0)
 S SWD="SUNDAYS^MONDAYS^TUESDAYS^WEDNESDAYS^THURSDAYS^FRIDAYS^SATURDAYS",SDW=X,X=$P(X,"@",2) D ENCHK Q:'$D(X)  S X=$P(SDW,"@"),X(1)="-" I X?.E1P.E,X'["-" F QX=1:1:$L(X) I $E(X,QX)?1P S X(1)=$E(X,QX) Q
"RTN","PSSGS0",67,0)
 F Q=1:1:$L(X,X(1)) K:SWD="" X Q:SWD=""  S Z=$P(X,X(1),Q) D DWC Q:'$D(X)
"RTN","PSSGS0",68,0)
 K X(1) S:$D(X) X=SDW Q
"RTN","PSSGS0",69,0)
 ;
"RTN","PSSGS0",70,0)
DWC I $L(Z)<2 K X Q
"RTN","PSSGS0",71,0)
 F QX=1:1:$L(SWD,"^") S Y=$P(SWD,"^",QX) I $P(Y,Z)="" S SWD=$P(SWD,Y,2) S:$L(SWD) SWD=$E(SWD,2,50) Q
"RTN","PSSGS0",72,0)
 E  K X
"RTN","PSSGS0",73,0)
 Q
"RTN","PSSGS0",74,0)
 ;
"RTN","PSSGS0",75,0)
UPPER(PSSUPPER) ;
"RTN","PSSGS0",76,0)
 Q $TR(PSSUPPER,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","PSSGS0",77,0)
 ;
"RTN","PSSGS0",78,0)
DICW ; 
"RTN","PSSGS0",79,0)
 S Z=^PS(51.1,+Y,0) W $P(Z,"^",8) Q
"RTN","PSSGS0",80,0)
 ;
"RTN","PSSGS0",81,0)
PRNOK(PSCH) ;
"RTN","PSSGS0",82,0)
 Q:PSCH'["PRN" 0
"RTN","PSSGS0",83,0)
 I $TR(PSCH," ")="PRN" Q 1
"RTN","PSSGS0",84,0)
 N BASE,I,OK S OK=0 S I=$P(PSCH," PRN") I I]"",$D(^PS(51.1,"AC","PSJ",I)) S OK=1
"RTN","PSSGS0",85,0)
 I 'OK D
"RTN","PSSGS0",86,0)
 .I PSCH["@" I $D(^PS(51.1,"AC","PSJ",$P(PSCH,"@")))!$$DOW^PSIVUTL($P(PSCH,"@")) S OK=1 Q
"RTN","PSSGS0",87,0)
 .I $$DOW^PSIVUTL($TR(PSCH," PRN")) S OK=1
"RTN","PSSGS0",88,0)
 Q OK
"RTN","PSSGSGUI")
0^2^B24878551^B24433132
"RTN","PSSGSGUI",1,0)
PSSGSGUI ;BIR/CML3-SCHEDULE PROCESSOR FOR GUI ONLY ;05/29/98
"RTN","PSSGSGUI",2,0)
 ;;1.0;PHARMACY DATA MANAGEMENT;**12,27,38,44,56,59,94,119**;9/30/97;Build 9
"RTN","PSSGSGUI",3,0)
 ;
"RTN","PSSGSGUI",4,0)
 ; Reference to ^PS(53.1 supported by DBIA #2140
"RTN","PSSGSGUI",5,0)
 ; Reference to ^PSIVUTL supported by DBIA #4580
"RTN","PSSGSGUI",6,0)
 ; Reference to ^PS(59.6 supported by DBIA #2110
"RTN","PSSGSGUI",7,0)
 ; Reference to ^DIC(42 is supported by DBIA# 10039
"RTN","PSSGSGUI",8,0)
 ;
"RTN","PSSGSGUI",9,0)
ENA ; entry point for train option
"RTN","PSSGSGUI",10,0)
 ;N X S X="PSGSETU" X ^%ZOSF("TEST") I  D ENCV^PSGSETU Q:$D(XQUIT)
"RTN","PSSGSGUI",11,0)
 ;F  S (PSGS0Y,PSGS0XT)="" R !!,"Select STANDARD SCHEDULE: ",X:DTIME W:'$T $C(7) S:'$T X="^" Q:"^"[X  D:X?1."?" ENQ^PSSGSH I X'?1."?" D EN W:$D(X)[0 $C(7),"  ??" I $D(X)#2,'PSGS0Y,PSGS0XT W "  Every ",PSGS0XT," minutes"
"RTN","PSSGSGUI",12,0)
 ;K DIC,DIE,PSGS0XT,PSGS0Y,Q,X,Y,PSGDT Q
"RTN","PSSGSGUI",13,0)
 Q
"RTN","PSSGSGUI",14,0)
 ;
"RTN","PSSGSGUI",15,0)
EN3 ;
"RTN","PSSGSGUI",16,0)
 S PSGST=$P($G(^PS(53.1,DA,0)),"^",7) G EN
"RTN","PSSGSGUI",17,0)
 ;
"RTN","PSSGSGUI",18,0)
EN5 ;
"RTN","PSSGSGUI",19,0)
 S PSGST=$P($G(^PS(55,DA(1),5,DA,0)),"^",7)
"RTN","PSSGSGUI",20,0)
 ;
"RTN","PSSGSGUI",21,0)
EN(X,PSSGUIPK) ; validate
"RTN","PSSGSGUI",22,0)
 ;I X[""""!($A(X)=45)!(X?.E1C.E)!($L(X," ")>2)!($L(X)>70)!($L(X)<1)!(X["P RN")!(X["PR N")!($E(X,1)=" ") K X Q
"RTN","PSSGSGUI",23,0)
 I $G(PSSGUIPK)="O" D  Q
"RTN","PSSGSGUI",24,0)
 .Q:$G(X)=""
"RTN","PSSGSGUI",25,0)
 .;*119 Allow multi-word schedules
"RTN","PSSGSGUI",26,0)
 .I X[""""!($A(X)=45)!(X?.E1C.E)!($L(X," ")>$S(X["PRN":4,1:3))!(X["^")!($L(X)>20)!($L(X)<1) K X Q
"RTN","PSSGSGUI",27,0)
 .N PSSUPGUI S X=$$UPPER(X)
"RTN","PSSGSGUI",28,0)
 ;I X[""""!($A(X)=45)!(X?.E1C.E)!($L(X," ")>3)!($L(X)>70)!($L(X)<1)!(X["P RN")!(X["PR N")!($E(X,1)=" ") K X Q
"RTN","PSSGSGUI",29,0)
 I $TR(X," ")="PRN" S X="PRN"
"RTN","PSSGSGUI",30,0)
 S X=$$TRIM^XLFSTR(X,"R"," ")
"RTN","PSSGSGUI",31,0)
 I X?.E1L.E S X=$$ENLU^PSSGMI(X)
"RTN","PSSGSGUI",32,0)
 ;I X["Q0" K X Q
"RTN","PSSGSGUI",33,0)
 ;
"RTN","PSSGSGUI",34,0)
ENOS ; order set entry
"RTN","PSSGSGUI",35,0)
 ; NSS
"RTN","PSSGSGUI",36,0)
 ; * GUI 27 CHANGES * Check for admin times to be derived from 'base' schedule
"RTN","PSSGSGUI",37,0)
 N TMPAT I X["@" S TMPAT=$P(X,"@",2) I TMPAT]"" D
"RTN","PSSGSGUI",38,0)
 .I '$D(^PS(51.1,"AC","PSJ",TMPAT)) K TMPAT Q
"RTN","PSSGSGUI",39,0)
 .N II I '$$DOW^PSIVUTL($P(X,"@")) K TMPAT Q
"RTN","PSSGSGUI",40,0)
 .N WARD I $G(DFN) S WARD=$G(^DPT(DFN,.1)) I WARD]"" D
"RTN","PSSGSGUI",41,0)
 ..N DIC,X,Y S DIC="^DIC(42,",DIC(0)="BOXZ",X=WARD D ^DIC S WARD=+Y Q:WARD=0
"RTN","PSSGSGUI",42,0)
 ..S WARD=$O(^PS(59.6,"B",WARD,0))
"RTN","PSSGSGUI",43,0)
 .N TMPIEN S TMPIEN=$O(^PS(51.1,"AC","PSJ",TMPAT,0)),TMPAT=$P($G(^PS(51.1,+TMPIEN,0)),"^",2) D
"RTN","PSSGSGUI",44,0)
 ..I $G(WARD) I $P($G(^PS(51.1,+TMPIEN,1,WARD,0)),"^",2) S TMPAT=$P($G(^(0)),"^",2)
"RTN","PSSGSGUI",45,0)
 I $G(TMPAT) S (PSGS0Y,$P(X,"@",2))=TMPAT,PSGS0XT="D"
"RTN","PSSGSGUI",46,0)
 ; * GUI 27 CHANGES END *
"RTN","PSSGSGUI",47,0)
 S (PSGS0XT,PSGS0Y,XT,Y)="" ;I X["PRN"!(X="ON CALL")!(X="ONCALL")!(X="ON-CALL")!($D(^PS(51.1,"APPSJ",X))) G Q
"RTN","PSSGSGUI",48,0)
 I $L(X)>63!(X?.E1C.E) S OK=0 G Q
"RTN","PSSGSGUI",49,0)
 I X["PRN",$$PRNOK^PSSGS0(X) G Q
"RTN","PSSGSGUI",50,0)
 I $D(^PS(51.1,"APPSJ",X)) S OK=1 G Q
"RTN","PSSGSGUI",51,0)
 I X="PRN" S OK=1 G Q
"RTN","PSSGSGUI",52,0)
 I X["PRN" D  I OK G Q
"RTN","PSSGSGUI",53,0)
 . S OK=0 F I=1:1:2 S A=$P($TR(X," "),"PRN",I) Q:A]""
"RTN","PSSGSGUI",54,0)
 . Q:A=""  N X S X=A
"RTN","PSSGSGUI",55,0)
 . I $D(^PS(51.1,"APPSJ",X)) S OK=1 Q
"RTN","PSSGSGUI",56,0)
 . I X?2.4N1"-".E!(X?2.4N) D ENCHK I $D(X) S OK=1 Q
"RTN","PSSGSGUI",57,0)
 . D DW I $D(X) S OK=1
"RTN","PSSGSGUI",58,0)
 S X0=X I X,X'["X",(X?2.4N1"-".E!(X?2.4N)) D ENCHK S:$D(X) Y=X G Q
"RTN","PSSGSGUI",59,0)
 I $S($D(^PS(51.1,"AC","PSJ",X)):1,1:$E($O(^(X)),1,$L(X))=X) D DIC I XT]"" G Q
"RTN","PSSGSGUI",60,0)
 I X?2.4N1"-".E!(X?2.4N) D ENCHK S:$D(X) Y=X G Q
"RTN","PSSGSGUI",61,0)
 ;D DW G Q
"RTN","PSSGSGUI",62,0)
 N TMPSCHX S TMPSCHX=X S TMPX=X D DW I $G(X)]"" K PSJNSS S PSGSCH=X S:'$D(^PS(51.1,"AC","PSJ",$P(TMPSCHX,"@"))) (PSGS0XT,XT)="D" S Y=$P(TMPSCHX,"@",2) G Q
"RTN","PSSGSGUI",63,0)
 ;I Y'>0,$S(X="NOW":1,X="ONCE":1,X="STAT":1,X="ONE TIME":1,X="ONETIME":1,X="1TIME":1,X="1 TIME":1,X="1-TIME":1,1:X="ONE-TIME") W:'$D(PSGOES) "  (ONCE ONLY)" S Y="",XT="O" G Q
"RTN","PSSGSGUI",64,0)
 ;I $G(PSGSCH)=X S PSGS0Y=$G(PSGAT) Q
"RTN","PSSGSGUI",65,0)
 K X Q
"RTN","PSSGSGUI",66,0)
 ;
"RTN","PSSGSGUI",67,0)
NS I (X="^")!(X="") K X Q
"RTN","PSSGSGUI",68,0)
 I Y'>0 S X=X0,Y=""
"RTN","PSSGSGUI",69,0)
 I $E(X,1,2)="AD" K X G Q
"RTN","PSSGSGUI",70,0)
 I $E(X,1,3)="BID"!($E(X,1,3)="TID")!($E(X,1,3)="QID") S XT=1440/$F("BTQ",$E(X)) G Q
"RTN","PSSGSGUI",71,0)
 S:$E(X)="Q" X=$E(X,2,99) S:'X X="1"_X S X1=+X,X=$P(X,+X,2),X2=0 S:X1<0 X1=-X1 S:$E(X)="X" X2=1,X=$E(X,2,99)
"RTN","PSSGSGUI",72,0)
 S XT=$S(X["'":1,(X["D"&(X'["AD"))!(X["AM")!(X["PM")!(X["HS"&(X'["THS")):1440,X["H"&(X'["TH"):60,X["AC"!(X["PC"):480,X["W":10080,X["M":40320,1:-1) I XT<0,Y'>0 K X G Q
"RTN","PSSGSGUI",73,0)
 S X=X0 I XT S:X2 XT=XT\X1 I 'X2 S:$E(X,1,2)="QO" XT=XT*2 S XT=XT*X1
"RTN","PSSGSGUI",74,0)
 ;
"RTN","PSSGSGUI",75,0)
Q ;
"RTN","PSSGSGUI",76,0)
 S PSGS0XT=$S(XT]"":XT,1:""),PSGS0Y=$S(Y:Y,1:"") K QX,SDW,SWD,X0,XT,Z Q
"RTN","PSSGSGUI",77,0)
 ;
"RTN","PSSGSGUI",78,0)
ENCHK ;
"RTN","PSSGSGUI",79,0)
 I $S($L($P(X,"-"))>4:1,$L(X)>119:1,$L(X)<2:1,X'>0:1,1:X'?.ANP) K X Q
"RTN","PSSGSGUI",80,0)
 S X(1)=$P(X,"-") I X(1)'?2N,X(1)'?4N K X Q
"RTN","PSSGSGUI",81,0)
 S X(1)=$L(X(1)) I X'["-",X>$E(2400,1,X(1)) K X Q
"RTN","PSSGSGUI",82,0)
 F X(2)=2:1:$L(X,"-") S X(3)=$P(X,"-",X(2)) I $S($L(X(3))'=X(1):1,X(3)>$E(2400,1,X(1)):1,1:X(3)'>$P(X,"-",X(2)-1)) K X Q
"RTN","PSSGSGUI",83,0)
 K:$D(X) X(1),X(2),X(3) Q
"RTN","PSSGSGUI",84,0)
 ;
"RTN","PSSGSGUI",85,0)
DIC ;
"RTN","PSSGSGUI",86,0)
 K DIC S DIC="^PS(51.1,",DIC(0)=$E("E",'$D(PSGOES))_"ISZ"_"X",DIC("W")="W ""  "","_$S('$D(PSJPWD):"$P(^(0),""^"",2)",'PSJPWD:"$P(^(0),""^"",2)",1:"$S($D(^PS(51.1,+Y,1,+PSJPWD,0)):$P(^(0),""^"",2),1:$P(^PS(51.1,+Y,0),""^"",2))"),D="APPSJ"
"RTN","PSSGSGUI",87,0)
 S DIC("W")=""
"RTN","PSSGSGUI",88,0)
 ; Naked reference below refers to global reference ^PS(51.1 stored in variable DIC. 
"RTN","PSSGSGUI",89,0)
 I $D(PSGST) S DIC("S")="I $P(^(0),""^"",5)"_$E("'",PSGST'="O")_"=""O"""
"RTN","PSSGSGUI",90,0)
 D IX^DIC K DIC S:$D(DIE)#2 DIC=DIE Q:Y'>0
"RTN","PSSGSGUI",91,0)
 S XT=$S("C"[$P(Y(0),"^",5):$P(Y(0),"^",3),1:$P(Y(0),"^",5)),X=+Y,Y="" I $D(PSJPWD),$D(^PS(51.1,X,1,+PSJPWD,0)) S Y=$P(^(0),"^",2)
"RTN","PSSGSGUI",92,0)
 S (X,X0)=Y(0,0) S:Y="" Y=$P(Y(0),"^",2) Q
"RTN","PSSGSGUI",93,0)
 ;DW     ;
"RTN","PSSGSGUI",94,0)
 ;S SWD="SUNDAYS^MONDAYS^TUESDAYS^WEDNESDAYS^THURSDAYS^FRIDAYS^SATURDAYS",SDW=X,X=$P(X,"@",2)
"RTN","PSSGSGUI",95,0)
 ;I X]"" D ENCHK Q:'$D(X)
"RTN","PSSGSGUI",96,0)
 ;S X=$P(SDW,"@"),X(1)="-" I X?.E1P.E,X'["-" F QX=1:1:$L(X) I $E(X,QX)?1P S X(1)=$E(X,QX) Q
"RTN","PSSGSGUI",97,0)
 ;F Q=1:1:$L(X,X(1)) K:SWD="" X Q:SWD=""  S Z=$P(X,X(1),Q) D DWC Q:'$D(X)
"RTN","PSSGSGUI",98,0)
 ;K X(1) S:$D(X) X=SDW Q
"RTN","PSSGSGUI",99,0)
 ;DWC    I $L(Z)<2 K X Q
"RTN","PSSGSGUI",100,0)
 ;F QX=1:1:$L(SWD,"^") S Y=$P(SWD,"^",QX) I $P(Y,Z)="" S SWD=$P(SWD,Y,2) S:$L(SWD) SWD=$E(SWD,2,50) Q
"RTN","PSSGSGUI",101,0)
 ;E  K X
"RTN","PSSGSGUI",102,0)
 ;Q
"RTN","PSSGSGUI",103,0)
 ;
"RTN","PSSGSGUI",104,0)
DW ;
"RTN","PSSGSGUI",105,0)
 S SWD="SUNDAYS^MONDAYS^TUESDAYS^WEDNESDAYS^THURSDAYS^FRIDAYS^SATURDAYS",SDW=X,X=$P(X,"@",2) N XABB S XABB=""
"RTN","PSSGSGUI",106,0)
 I X]"" D ENCHK Q:'$D(X)
"RTN","PSSGSGUI",107,0)
 S X=$P(SDW,"@"),X(1)="-"  ;I X?.E1P.E,X'["-" F QX=1:1:$L(X) I $E(X,QX)?1P S X(1)=$E(X,QX) Q
"RTN","PSSGSGUI",108,0)
 F Q=1:1:$L(X,X(1)) K:SWD="" X Q:SWD=""  S Z=$P(X,X(1),Q) D DWC Q:'$D(X)
"RTN","PSSGSGUI",109,0)
 I $D(X) F II=1:1:$L(X,X(1)) S XABB=$G(XABB)_$E($P(X,X(1),II),1,2)_"-"
"RTN","PSSGSGUI",110,0)
 K X(1) S:$D(X) X=SDW I $G(X)]"" I $TR(XABB,"-")]"" S X=$E($G(XABB),1,$L(XABB)-1)
"RTN","PSSGSGUI",111,0)
 Q
"RTN","PSSGSGUI",112,0)
DWC I $L(Z)<2 K X Q
"RTN","PSSGSGUI",113,0)
 F QX=1:1:$L(SWD,"^") S Y=$P(SWD,"^",QX) I $P(Y,Z)="" S SWD=$P(SWD,Y,2) S:$L(SWD) SWD=$E(SWD,2,50) Q
"RTN","PSSGSGUI",114,0)
 E  K X
"RTN","PSSGSGUI",115,0)
 Q
"RTN","PSSGSGUI",116,0)
 ;
"RTN","PSSGSGUI",117,0)
UPPER(PSSUPGUI) ;
"RTN","PSSGSGUI",118,0)
 Q $TR(PSSUPGUI,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"VER")
8.0^22.0
"^DD",50,50,62.04,0)
UNIT DOSE SCHEDULE^FX^^8;4^K:X[""""!($A(X)=45)!($L(X," ")>$S(X["PRN":4,1:3))!($L(X)>70)!($L(X)<1) X D:$D(X)#2 SCH^PSSDDUT I $D(X)#2,'PSGS0Y,PSGS0XT D EN^DDIOL("  Every "_PSGS0XT_" minutes","","?0")
"^DD",50,50,62.04,.1)
STANDARD UNIT DOSE SCHEDULE
"^DD",50,50,62.04,3)
Enter the most common SCHEDULE associated with this medication.
"^DD",50,50,62.04,20,0)
^.3LA^1^1
"^DD",50,50,62.04,20,1,0)
PSJU
"^DD",50,50,62.04,21,0)
^^3^3^2910305^^^^
"^DD",50,50,62.04,21,1,0)
  If a schedule is found here when this medication is selected for a
"^DD",50,50,62.04,21,2,0)
UNIT DOSE order, that schedule will be used as a default value for the
"^DD",50,50,62.04,21,3,0)
SCHEDULE prompt in order entry.
"^DD",50,50,62.04,"DT")
3140818
"^DD",51,51,3,0)
SCHEDULE^FX^^0;6^K:X[""""!($A(X)=45) X I $D(X) K:$L(X," ")>$S(X["PRN":4,1:3)!($L(X)>20)!($L(X)<2) X
"^DD",51,51,3,3)
Enter the appropriate schedule to associate with this Medication Instruction.
"^DD",51,51,3,4)
D ENSH^PSSDDUT
"^DD",51,51,3,21,0)
^^6^6^3010501^
"^DD",51,51,3,21,1,0)
This is the Schedule that is associated with the Medication Instruction.
"^DD",51,51,3,21,2,0)
Prior to the Pharmacy Ordering Enhancements project, this field was used
"^DD",51,51,3,21,3,0)
to associate schedules with Outpatient prescriptions, by running each word
"^DD",51,51,3,21,4,0)
of the Sig through the Medication Instruction file to look for an
"^DD",51,51,3,21,5,0)
associated Schedule. The field is currently not being used by the Pharmacy
"^DD",51,51,3,21,6,0)
software.
"^DD",51,51,3,"DT")
3150220
"^DD",51.1,51.1,.01,0)
NAME^RFX^^0;1^D ENPSJ^PSSJSV Q:'$D(X)  K:X[""""!($A(X)=45) X I $D(X) K:$L(X," ")>$S(X["PRN":4,1:3)!($L(X)>20)!($L(X)<2) X
"^DD",51.1,51.1,.01,1,0)
^.1
"^DD",51.1,51.1,.01,1,1,0)
51.1^B
"^DD",51.1,51.1,.01,1,1,1)
S ^PS(51.1,"B",$E(X,1,30),DA)=""
"^DD",51.1,51.1,.01,1,1,2)
K ^PS(51.1,"B",$E(X,1,30),DA)
"^DD",51.1,51.1,.01,1,2,0)
51.1^AUWD^MUMPS
"^DD",51.1,51.1,.01,1,2,1)
S ^PS(51.1,"AUWD")=$S($D(^PS(59.7,1,20)):$P(^(20),"^"),1:"")
"^DD",51.1,51.1,.01,1,2,2)
Q
"^DD",51.1,51.1,.01,1,2,"%D",0)
^^3^3^2970926^^^
"^DD",51.1,51.1,.01,1,2,"%D",1,0)
Used by the Unit Dose inits to determine if a conversion process needs to
"^DD",51.1,51.1,.01,1,2,"%D",2,0)
be run on this file.
"^DD",51.1,51.1,.01,1,2,"%D",3,0)
In the form of: ^PS(51.1,"AUWD")
"^DD",51.1,51.1,.01,1,3,0)
51.1^ACC^MUMPS
"^DD",51.1,51.1,.01,1,3,1)
I $D(^PS(51.1,DA,0)),$P(^(0),"^",4)]"" S ^PS(51.1,"AC",$P(^(0),"^",4),X,DA)=""
"^DD",51.1,51.1,.01,1,3,2)
I $D(^PS(51.1,DA,0)),$P(^(0),"^",4)]"" K ^PS(51.1,"AC",$P(^(0),"^",4),X,DA)
"^DD",51.1,51.1,.01,1,3,3)
USED BY SCHEDULE PROCESSOR
"^DD",51.1,51.1,.01,1,3,"%D",0)
^^2^2^2970926^^
"^DD",51.1,51.1,.01,1,3,"%D",1,0)
Used by the Schedule Processor to do package specific look-ups.
"^DD",51.1,51.1,.01,1,3,"%D",2,0)
In the form of: ^PS(51.1,"AC",$P(^(0),"^",4),X,DA)
"^DD",51.1,51.1,.01,1,4,0)
51.1^APP^MUMPS
"^DD",51.1,51.1,.01,1,4,1)
I $D(^PS(51.1,DA,0)),$P(^(0),"^",4)]"" S ^PS(51.1,"AP"_$P(^(0),"^",4),X,DA)=""
"^DD",51.1,51.1,.01,1,4,2)
I $D(^PS(51.1,DA,0)),$P(^(0),"^",4)]"" K ^PS(51.1,"AP"_$P(^(0),"^",4),X,DA)
"^DD",51.1,51.1,.01,1,4,3)
USED BY SCHEDULE PROCESSOR
"^DD",51.1,51.1,.01,1,4,"%D",0)
^^2^2^2970926^^
"^DD",51.1,51.1,.01,1,4,"%D",1,0)
Used by the schedule processor to do package specific look-ups.
"^DD",51.1,51.1,.01,1,4,"%D",2,0)
In the form of: ^PS(51.1,"AP"_$P(^(0),"^",4),X,DA)
"^DD",51.1,51.1,.01,1,5,0)
51.1^ADHL^MUMPS
"^DD",51.1,51.1,.01,1,5,1)
S PSJHLDA(+DA)="MUP"
"^DD",51.1,51.1,.01,1,5,2)
S PSJHLDA(+DA)="MDL"
"^DD",51.1,51.1,.01,1,5,"%D",0)
^^2^2^2970926^^^
"^DD",51.1,51.1,.01,1,5,"%D",1,0)
Use to update Administration Schedule to OE/RR Schedule file.
"^DD",51.1,51.1,.01,1,5,"%D",2,0)
In the form of: PSJHLDA(+DA)
"^DD",51.1,51.1,.01,1,5,"DT")
2950224
"^DD",51.1,51.1,.01,1,6,0)
^^TRIGGER^51.1^5
"^DD",51.1,51.1,.01,1,6,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X S X=Y(0)["PRN" I X S X=DIV S Y(1)=$S($D(^PS(51.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y S X=DIV S X="P" X ^DD(51.1,.01,1,6,1.4)
"^DD",51.1,51.1,.01,1,6,1.4)
S DIH=$G(^PS(51.1,DIV(0),0)),DIV=X S $P(^(0),U,5)=DIV,DIH=51.1,DIG=5 D ^DICR
"^DD",51.1,51.1,.01,1,6,2)
Q
"^DD",51.1,51.1,.01,1,6,"CREATE CONDITION")
NAME["PRN"
"^DD",51.1,51.1,.01,1,6,"CREATE VALUE")
"P"
"^DD",51.1,51.1,.01,1,6,"DELETE VALUE")
NO EFFECT
"^DD",51.1,51.1,.01,1,6,"DT")
3070108
"^DD",51.1,51.1,.01,1,6,"FIELD")
TYPE
"^DD",51.1,51.1,.01,1,7,0)
^^TRIGGER^51.1^5
"^DD",51.1,51.1,.01,1,7,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(0)=X X ^DD(51.1,.01,1,7,69.2) S X=X["P",Y=X,X=Y(1),X=X&Y I X S X=DIV S Y(1)=$S($D(^PS(51.1,D0,0)):^(0),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y S X="" X ^DD(51.1,.01,1,7,1.4)
"^DD",51.1,51.1,.01,1,7,1.4)
S DIH=$G(^PS(51.1,DIV(0),0)),DIV=X S $P(^(0),U,5)=DIV,DIH=51.1,DIG=5 D ^DICR
"^DD",51.1,51.1,.01,1,7,2)
Q
"^DD",51.1,51.1,.01,1,7,69.2)
S Y(3)=$C(59)_$P($G(^DD(51.1,5,0)),U,3),Y(2)=$S($D(^PS(51.1,D0,0)):^(0),1:"") S X=Y(0)'["PRN",Y(1)=$G(X) S X=$P($P(Y(3),$C(59)_$P(Y(2),U,5)_":",2),$C(59))
"^DD",51.1,51.1,.01,1,7,"CREATE CONDITION")
NAME'["PRN"&(TYPE["P")
"^DD",51.1,51.1,.01,1,7,"CREATE VALUE")
""
"^DD",51.1,51.1,.01,1,7,"DELETE VALUE")
NO EFFECT
"^DD",51.1,51.1,.01,1,7,"DT")
3070108
"^DD",51.1,51.1,.01,1,7,"FIELD")
TYPE
"^DD",51.1,51.1,.01,3)
Answer must be 2-20 characters in length.
"^DD",51.1,51.1,.01,20,0)
^.3LA^1^1
"^DD",51.1,51.1,.01,20,1,0)
PSJ
"^DD",51.1,51.1,.01,21,0)
^.001^3^3^3060330^^^^
"^DD",51.1,51.1,.01,21,1,0)
  This a common abbreviation for a schedule.  A schedule is the frequency
"^DD",51.1,51.1,.01,21,2,0)
for which an action is to take place, such as every eight hours ('Q8H') or
"^DD",51.1,51.1,.01,21,3,0)
every other day ('QOD').
"^DD",51.1,51.1,.01,"DT")
3140818
"BLD",7076,6)
^166
**END**
**END**

