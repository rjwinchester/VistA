Released MD*1*45 SEQ #32
Extracted from mail message
**KIDS**:MD*1.0*45^

**INSTALL NAME**
MD*1.0*45
"BLD",10068,0)
MD*1.0*45^CLINICAL PROCEDURES^0^3151119^y
"BLD",10068,1,0)
^^1^1^3151119^
"BLD",10068,1,1,0)
CORRECTION FOR AUTO CHECK-IN SETUP
"BLD",10068,4,0)
^9.64PA^^
"BLD",10068,6.3)
1
"BLD",10068,"ABPKG")
n
"BLD",10068,"KRN",0)
^9.67PA^779.2^20
"BLD",10068,"KRN",.4,0)
.4
"BLD",10068,"KRN",.401,0)
.401
"BLD",10068,"KRN",.402,0)
.402
"BLD",10068,"KRN",.403,0)
.403
"BLD",10068,"KRN",.5,0)
.5
"BLD",10068,"KRN",.84,0)
.84
"BLD",10068,"KRN",3.6,0)
3.6
"BLD",10068,"KRN",3.8,0)
3.8
"BLD",10068,"KRN",9.2,0)
9.2
"BLD",10068,"KRN",9.8,0)
9.8
"BLD",10068,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10068,"KRN",9.8,"NM",1,0)
MDWSETUP^^0^B71583488
"BLD",10068,"KRN",9.8,"NM","B","MDWSETUP",1)

"BLD",10068,"KRN",19,0)
19
"BLD",10068,"KRN",19,"NM",0)
^9.68A^^
"BLD",10068,"KRN",19.1,0)
19.1
"BLD",10068,"KRN",101,0)
101
"BLD",10068,"KRN",409.61,0)
409.61
"BLD",10068,"KRN",771,0)
771
"BLD",10068,"KRN",779.2,0)
779.2
"BLD",10068,"KRN",870,0)
870
"BLD",10068,"KRN",8989.51,0)
8989.51
"BLD",10068,"KRN",8989.52,0)
8989.52
"BLD",10068,"KRN",8994,0)
8994
"BLD",10068,"KRN","B",.4,.4)

"BLD",10068,"KRN","B",.401,.401)

"BLD",10068,"KRN","B",.402,.402)

"BLD",10068,"KRN","B",.403,.403)

"BLD",10068,"KRN","B",.5,.5)

"BLD",10068,"KRN","B",.84,.84)

"BLD",10068,"KRN","B",3.6,3.6)

"BLD",10068,"KRN","B",3.8,3.8)

"BLD",10068,"KRN","B",9.2,9.2)

"BLD",10068,"KRN","B",9.8,9.8)

"BLD",10068,"KRN","B",19,19)

"BLD",10068,"KRN","B",19.1,19.1)

"BLD",10068,"KRN","B",101,101)

"BLD",10068,"KRN","B",409.61,409.61)

"BLD",10068,"KRN","B",771,771)

"BLD",10068,"KRN","B",779.2,779.2)

"BLD",10068,"KRN","B",870,870)

"BLD",10068,"KRN","B",8989.51,8989.51)

"BLD",10068,"KRN","B",8989.52,8989.52)

"BLD",10068,"KRN","B",8994,8994)

"BLD",10068,"QUES",0)
^9.62^^
"BLD",10068,"REQB",0)
^9.611^1^1
"BLD",10068,"REQB",1,0)
MD*1.0*37^2
"BLD",10068,"REQB","B","MD*1.0*37",1)

"MBREQ")
0
"PKG",569,-1)
1^1
"PKG",569,0)
CLINICAL PROCEDURES^MD^Clinical Procedures
"PKG",569,20,0)
^9.402P^^
"PKG",569,22,0)
^9.49I^1^1
"PKG",569,22,1,0)
1.0^3040521^3040615^1017
"PKG",569,22,1,"PAH",1,0)
45^3151119
"PKG",569,22,1,"PAH",1,1,0)
^^1^1^3151119
"PKG",569,22,1,"PAH",1,1,1,0)
CORRECTION FOR AUTO CHECK-IN SETUP
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","MDWSETUP")
0^1^B71583488^B68509741
"RTN","MDWSETUP",1,0)
MDWSETUP ; HOIFO/NCA - Auto Study Check-In Setup ;3/18/08  14:14
"RTN","MDWSETUP",2,0)
 ;;1.0;CLINICAL PROCEDURES;**14,11,37,45**;Apr 01, 2004;Build 1
"RTN","MDWSETUP",3,0)
EN1 ; [Procedure]
"RTN","MDWSETUP",4,0)
 ; This post conversion routine will place the Medicine Enter/Edit 
"RTN","MDWSETUP",5,0)
 ; options out of order
"RTN","MDWSETUP",6,0)
 ; Reference IA # 2263 [Supported] XPAR parameter calls
"RTN","MDWSETUP",7,0)
 ;               10040 [Supported] Accessing Hospital Location file (#44)
"RTN","MDWSETUP",8,0)
 ;               10103 [Supported] XLFDT call
"RTN","MDWSETUP",9,0)
 ; 06/04/2014 KAM MD*1*37 Rem Ticket1007464 Clinical Proc Auto Check-in
"RTN","MDWSETUP",10,0)
 ; 09/21/2015 KAM MD*1*45 CA/SDM Ticket I5605614FY15 clinic editing 
"RTN","MDWSETUP",11,0)
 ;
"RTN","MDWSETUP",12,0)
 N MDANS,MDAPT,MDAR,MDCL,MDCNOD,MDCP,MDCT,MDCTR,MDDEF,MDDFLT,MDERR,MDFLAG,MDFRST,MDLP,MDLAST,MDLST,MDLST1,MDLST2,MDNODE,MDNXT
"RTN","MDWSETUP",13,0)
 N MDPREC,MDS,MDSAP,MDSED,MDSEL,MDX,MDX1,MDX2,MDX3,MDY,MDY1 K ^TMP("MDOLD",$J)
"RTN","MDWSETUP",14,0)
 D GETLST^XPAR(.MDLST1,"SYS","MD CLINIC ASSOCIATION") I '+$G(MDLST1) D GET
"RTN","MDWSETUP",15,0)
 S MDDEF=$$GET^XPAR("SYS","MD USE APPT WITH PROCEDURE",1),MDDEF=$S(+MDDEF:"YES",1:"NO")
"RTN","MDWSETUP",16,0)
 K DIR S DIR(0)="YA",DIR("A")="Use Appointment with procedure? ",DIR("B")=MDDEF,DIR("?")="Enter either 'Y' or 'N'."
"RTN","MDWSETUP",17,0)
 S DIR("?",1)="Default should be 'N' as most sites do not schedule procedures"
"RTN","MDWSETUP",18,0)
 S DIR("?",2)="before the order is entered.  Select 'Y' if the procedure appointment"
"RTN","MDWSETUP",19,0)
 S DIR("?",3)="is scheduled before the order is entered and the ordering provider"
"RTN","MDWSETUP",20,0)
 S DIR("?",4)="selects the appointment for the procedure."
"RTN","MDWSETUP",21,0)
 D ^DIR K DIR Q:$D(DIRUT)!$D(DIROUT)!(Y<0)
"RTN","MDWSETUP",22,0)
 ;D DEL^XPAR("SYS","MD USE APPT WITH PROCEDURE",1)
"RTN","MDWSETUP",23,0)
 D EN^XPAR("SYS","MD USE APPT WITH PROCEDURE",1,0)
"RTN","MDWSETUP",24,0)
 D GETLST^XPAR(.MDLST,"SYS","MD CHECK-IN PROCEDURE LIST")
"RTN","MDWSETUP",25,0)
 D GETLST^XPAR(.MDLST1,"SYS","MD CLINIC ASSOCIATION")
"RTN","MDWSETUP",26,0)
 K ^TMP("MDPROC",$J),^TMP("MDPARAM",$J) S (MDCT,MDCTR,MDLAST)=0
"RTN","MDWSETUP",27,0)
 ; Get procedure parameter list
"RTN","MDWSETUP",28,0)
 F MDLP=0:0 S MDLP=$O(MDLST(MDLP)) Q:MDLP<1  I +$G(MDLST(MDLP)) S MDX=$P($G(^MDS(702.01,+$G(MDLST(MDLP)),0)),"^",1) D
"RTN","MDWSETUP",29,0)
 . Q:MDX=""  S MDY=+$P($G(MDLST(MDLP)),"^",2)
"RTN","MDWSETUP",30,0)
 . S ^TMP("MDPROC",$J,MDX,+$G(MDLST(MDLP)))=MDY_"^"_$S(MDY=1:"Outpatient",MDY=2:"Inpatient",MDY=3:"Both",1:"None")
"RTN","MDWSETUP",31,0)
 ; Get Clinic Quick List
"RTN","MDWSETUP",32,0)
 F MDLP=0:0 S MDLP=$O(MDLST1(MDLP)) Q:MDLP<1  S MDX3=+$G(MDLST1(MDLP)),MDX2=$P($G(MDLST1(MDLP)),"^",2),MDX1=+$P(MDX2,";",2) I +MDX1 D
"RTN","MDWSETUP",33,0)
 . S MDX=$P($G(^MDS(702.01,MDX1,0)),"^",1) Q:MDX=""
"RTN","MDWSETUP",34,0)
 . S MDY=+$P(MDX2,";",1) Q:'MDY
"RTN","MDWSETUP",35,0)
 . S MDCNOD=$G(^TMP("MDPROC",$J,MDX,MDX1)) Q:MDCNOD=""
"RTN","MDWSETUP",36,0)
 . S MDY1=$$GET1^DIQ(44,MDY_",",.01),MDCTR=MDCTR+1
"RTN","MDWSETUP",37,0)
 . S:$G(MDCTR(MDY))="" MDCTR(MDY)=0 S MDCTR(MDY)=MDCTR(MDY)+1
"RTN","MDWSETUP",38,0)
 . S ^TMP("MDPARAM",$J,MDX,MDY1)=MDX1_"^"_MDY_"^"_MDCNOD_"^"_MDX3,MDLAST=MDX3
"RTN","MDWSETUP",39,0)
 S MDPREC=$NA(^TMP("MDPROC",$J)) K MDLST,MDLST1
"RTN","MDWSETUP",40,0)
 F  S MDPREC=$Q(@MDPREC) Q:MDPREC=""  Q:$QS(MDPREC,1)'="MDPROC"  D
"RTN","MDWSETUP",41,0)
 . I '$D(^TMP("MDPARAM",$J,$QS(MDPREC,3))) S MDCTR=MDCTR+1,^TMP("MDPARAM",$J,$QS(MDPREC,3),"None")=$QS(MDPREC,4)_"^^"_@MDPREC
"RTN","MDWSETUP",42,0)
QURY ; Query the procedure parameter list
"RTN","MDWSETUP",43,0)
 I MDCTR<1 G A1
"RTN","MDWSETUP",44,0)
 N MDN S MDPREC=$NA(^TMP("MDPARAM",$J)),(MDANS,MDN)="" D HDR
"RTN","MDWSETUP",45,0)
 F  S MDPREC=$Q(@MDPREC) Q:MDPREC=""  Q:$QS(MDPREC,1)'="MDPARAM"  D
"RTN","MDWSETUP",46,0)
 . Q:MDANS="^"
"RTN","MDWSETUP",47,0)
 . S MDAPT=@MDPREC,MDAPT=$P(MDAPT,"^",4)
"RTN","MDWSETUP",48,0)
 . I $Y>(IOSL-2) K DIR S DIR(0)="E" D ^DIR K DIR D:Y HDR I $D(DIRUT)!$D(DIROUT)!(Y<0) S MDANS="^" Q
"RTN","MDWSETUP",49,0)
 . I MDN'=$QS(MDPREC,3) W !,$E($QS(MDPREC,3),1,25),?27,MDAPT,?55,$E($QS(MDPREC,4),1,25) S MDN=$QS(MDPREC,3) Q
"RTN","MDWSETUP",50,0)
 . W !?55,$E($QS(MDPREC,4),1,25)
"RTN","MDWSETUP",51,0)
A1 ; Ask for procedure parameter
"RTN","MDWSETUP",52,0)
 W !!,"Procedure: " R X:DTIME G:'$T!("^"[X) KIL
"RTN","MDWSETUP",53,0)
 I X["?" D PHELP^MDWCHK
"RTN","MDWSETUP",54,0)
 K DIC S DIC="^MDS(702.01,",DIC(0)="EQMZ",DIC("S")="I +$P(^(0),U,9)>0"
"RTN","MDWSETUP",55,0)
 D ^DIC K DIC G A1:"^"[X!$D(DTOUT),A1:Y<1
"RTN","MDWSETUP",56,0)
 S MDSEL=Y,MDCP=+MDSEL
"RTN","MDWSETUP",57,0)
 G:'$D(^TMP("MDPARAM",$J,Y(0,0))) A2
"RTN","MDWSETUP",58,0)
 S MDFRST=$O(^TMP("MDPARAM",$J,Y(0,0),"")) G:MDFRST="" A2
"RTN","MDWSETUP",59,0)
 S MDX1=$P($G(^TMP("MDPARAM",$J,Y(0,0),MDFRST)),"^",3)
"RTN","MDWSETUP",60,0)
 S MDNXT=$O(^TMP("MDPARAM",$J,Y(0,0),MDFRST)),MDDFLT="",MDFLAG=0
"RTN","MDWSETUP",61,0)
 I MDNXT="" S MDDFLT=$G(^TMP("MDPARAM",$J,Y(0,0),MDFRST)),MDNODE=MDFRST G E1
"RTN","MDWSETUP",62,0)
 I MDNXT'="" D  Q:+MDFLAG
"RTN","MDWSETUP",63,0)
 . W ! S MDLP="",MDCT=0 F  S MDLP=$O(^TMP("MDPARAM",$J,Y(0,0),MDLP)) Q:MDLP=""  D
"RTN","MDWSETUP",64,0)
 . . S MDCT=MDCT+1 W !,MDCT_") ",Y(0,0),"  ",MDLP S MDAR(MDCT)=MDLP
"RTN","MDWSETUP",65,0)
 . W ! K DIR S DIR(0)="NAO^1:"_MDCT,DIR("A")="Select 1-"_MDCT_": ",DIR("?")="Select from 1-"_MDCT D ^DIR
"RTN","MDWSETUP",66,0)
 . I X="" S MDSED=MDSEL,MDSAP=MDX1,MDFLAG=1 Q
"RTN","MDWSETUP",67,0)
 . ;
"RTN","MDWSETUP",68,0)
 . ;06/04/2014 KAM MD*1*37 Rem Ticket1007464
"RTN","MDWSETUP",69,0)
 . ;modified the next line to better handle "^"
"RTN","MDWSETUP",70,0)
 . ;
"RTN","MDWSETUP",71,0)
 . ;K DIR G:$D(DIRUT)!$D(DIROUT)!(Y<1) KIL S MDS=Y
"RTN","MDWSETUP",72,0)
 . ;
"RTN","MDWSETUP",73,0)
 . ;09/21/2015 KAM MD*1*45 CA/SDM Ticket I5605614FY15
"RTN","MDWSETUP",74,0)
 . ;modified next line to correct clinic editing issue
"RTN","MDWSETUP",75,0)
 . ;K DIR D:$D(DIRUT)!$D(DIROUT)!(Y<1) KIL S MDFLAG=1 Q  
"RTN","MDWSETUP",76,0)
 . K DIR S MDS=Y I $D(DIRUT)!$D(DIROUT)!(Y<1) D KIL S MDFLAG=1 Q
"RTN","MDWSETUP",77,0)
 . ;
"RTN","MDWSETUP",78,0)
 . S MDNODE=$G(MDAR(MDS))
"RTN","MDWSETUP",79,0)
 . S MDDFLT=$G(^TMP("MDPARAM",$J,$P(MDSEL,"^",2),MDNODE))
"RTN","MDWSETUP",80,0)
E1 ; Edit the procedure
"RTN","MDWSETUP",81,0)
 W !!,"Procedure: ",$P(MDSEL,"^",2)_"// " R X:DTIME G:'$T!(X=U) KIL
"RTN","MDWSETUP",82,0)
 I X["?"!(X'="")&(X'="@") W !,"Hit Return to accept the procedure",!,"Enter ""@"" to delete the procedure.",!,"Enter a ""^"" will exit completely." G E1
"RTN","MDWSETUP",83,0)
 I X="@" D  G A1
"RTN","MDWSETUP",84,0)
 . I MDNXT="" D EN^XPAR("SYS","MD CHECK-IN PROCEDURE LIST",$P(MDSEL,"^",2),"@")
"RTN","MDWSETUP",85,0)
 . D EN^XPAR("SYS","MD CLINIC ASSOCIATION",+$P(MDDFLT,"^",5),"@")
"RTN","MDWSETUP",86,0)
 . K ^TMP("MDPARAM",$J,$P(MDSEL,"^",2),MDNODE)
"RTN","MDWSETUP",87,0)
 . S:+$P(MDDFLT,"^",2) MDCTR(+$P(MDDFLT,"^",2))=MDCTR(+$P(MDDFLT,"^",2))-1
"RTN","MDWSETUP",88,0)
 . W " ..Procedure deleted"
"RTN","MDWSETUP",89,0)
 S MDSED=MDSEL
"RTN","MDWSETUP",90,0)
E2 ; Ask whether appointment scheduled
"RTN","MDWSETUP",91,0)
 K DIR S DIR(0)="SA^0:None;1:Outpatient;2:Inpatient;3:Both",DIR("A")="Schedule Appointment?: ",DIR("B")=+$P(MDDFLT,"^",3)
"RTN","MDWSETUP",92,0)
 S DIR("?")="^D CHELP^MDWCHK"
"RTN","MDWSETUP",93,0)
 D ^DIR K DIR
"RTN","MDWSETUP",94,0)
 G:$D(DIRUT)!$D(DIROUT)!(Y<0) KIL S MDSAP=Y
"RTN","MDWSETUP",95,0)
 I $G(MDDFLT)'="" D EN^XPAR("SYS","MD CHECK-IN PROCEDURE LIST",$P(MDSEL,"^",2),"@")
"RTN","MDWSETUP",96,0)
 D EN^XPAR("SYS","MD CHECK-IN PROCEDURE LIST","`"_+MDSED,+MDSAP)
"RTN","MDWSETUP",97,0)
 I MDSAP'=+$P(MDDFLT,"^",3) S MDLP="" F  S MDLP=$O(^TMP("MDPARAM",$J,$P(MDSED,"^",2),MDLP)) Q:MDLP=""  S MDX=$G(^(MDLP)) I $P(MDX,"^",3)'=+MDSAP D
"RTN","MDWSETUP",98,0)
 . S $P(MDX,"^",3,4)=+MDSAP_"^"_$S(MDSAP=1:"Outpatient",MDSAP=2:"Inpatient",MDSAP=3:"Both",1:"None")
"RTN","MDWSETUP",99,0)
 . S ^TMP("MDPARAM",$J,$P(MDSED,"^",2),MDLP)=MDX
"RTN","MDWSETUP",100,0)
 I MDNODE["None" G A3
"RTN","MDWSETUP",101,0)
E3 ; Edit the location
"RTN","MDWSETUP",102,0)
 W !,"Clinic: ",MDNODE_"// " R X:DTIME G:'$T!(X=U) KIL
"RTN","MDWSETUP",103,0)
 I X["?"!(X'="")&(X'="@") W !,"Hit Return to accept the clinic",!,"Enter ""@"" to delete the clinic from the procedure.",!,"Enter a ""^"" will exit completely." G E3
"RTN","MDWSETUP",104,0)
 I X="" G A4
"RTN","MDWSETUP",105,0)
 I X="@" D  G A4
"RTN","MDWSETUP",106,0)
 . D:+$P(MDDFLT,"^",5) EN^XPAR("SYS","MD CLINIC ASSOCIATION",+$P(MDDFLT,"^",5),"@")
"RTN","MDWSETUP",107,0)
 . S:+$P(MDDFLT,"^",2) MDCTR(+$P(MDDFLT,"^",2))=MDCTR(+$P(MDDFLT,"^",2))-1
"RTN","MDWSETUP",108,0)
 . K ^TMP("MDPARAM",$J,$P(MDSEL,"^",2),MDNODE)
"RTN","MDWSETUP",109,0)
 . I $G(MDNXT)="" S $P(MDDFLT,"^",2)="",^TMP("MDPARAM",$J,$P(MDSEL,"^",2),"None")=MDDFLT
"RTN","MDWSETUP",110,0)
 . W " ..Value deleted"
"RTN","MDWSETUP",111,0)
 S MDCL=+$P(MDDFLT,"^",2)_"^"_MDNODE
"RTN","MDWSETUP",112,0)
 K MDCL,MDSEL
"RTN","MDWSETUP",113,0)
 G A4
"RTN","MDWSETUP",114,0)
A2 ; Ask if site schedule appointments
"RTN","MDWSETUP",115,0)
 K DIR S DIR(0)="SA^0:None;1:Outpatient;2:Inpatient;3:Both",DIR("A")="Schedule Appointment?: ",DIR("?")="^D CHELP^MDWCHK"
"RTN","MDWSETUP",116,0)
 D ^DIR K DIR
"RTN","MDWSETUP",117,0)
 I $D(DIRUT)!$D(DIROUT)!(Y<0) W "...Procedure removed" G KIL
"RTN","MDWSETUP",118,0)
 S MDSAP=Y
"RTN","MDWSETUP",119,0)
 D EN^XPAR("SYS","MD CHECK-IN PROCEDURE LIST","`"_+MDSEL,+MDSAP)
"RTN","MDWSETUP",120,0)
 S ^TMP("MDPARAM",$J,$P(MDSEL,"^",2),"None")=+MDSEL_"^^"_MDSAP_"^"_$S(MDSAP=1:"Outpatient",MDSAP=2:"Inpatient",MDSAP=3:"Both",1:"None")
"RTN","MDWSETUP",121,0)
 I 'MDSAP S MDCL="" D TASK G A1
"RTN","MDWSETUP",122,0)
A3 ; Ask for clinic value
"RTN","MDWSETUP",123,0)
 W !,"Clinic: " R X:DTIME G:'$T!(X=U) KIL
"RTN","MDWSETUP",124,0)
 I X["?" D CLHELP
"RTN","MDWSETUP",125,0)
 I X="" S MDCL="" D:'+MDSAP TASK G A1
"RTN","MDWSETUP",126,0)
 K DIC S DIC="^SC(",DIC(0)="EQMZ"
"RTN","MDWSETUP",127,0)
 D ^DIC K DIC G A3:"^"[X!$D(DTOUT),A3:Y<1
"RTN","MDWSETUP",128,0)
 S MDCL=Y D TASK
"RTN","MDWSETUP",129,0)
 K ^TMP("MDPARAM",$J,$P(MDSEL,"^",2),"None")
"RTN","MDWSETUP",130,0)
 S ^TMP("MDPARAM",$J,$P(MDSEL,"^",2),$P(MDCL,"^",2))=+MDSEL_"^"_+MDCL_"^"_MDSAP_"^"_$S(MDSAP=1:"Outpatient",MDSAP=2:"Inpatient",MDSAP=3:"Both",1:"None")
"RTN","MDWSETUP",131,0)
 S:$G(MDCTR(+MDCL))="" MDCTR(+MDCL)=0 S MDCTR(+MDCL)=MDCTR(+MDCL)+1,MDLAST=MDLAST+1
"RTN","MDWSETUP",132,0)
 D EN^XPAR("SYS","MD CLINIC ASSOCIATION",MDLAST,+MDCL_";"_+MDSEL)
"RTN","MDWSETUP",133,0)
A4 ; Ask for another Clinic
"RTN","MDWSETUP",134,0)
 K DIR W ! S DIR(0)="YA",DIR("A")="Enter another clinic for the same procedure? ",DIR("B")="NO",DIR("?")="Enter either 'Y' or 'N', if you want to assign more than one clinic."
"RTN","MDWSETUP",135,0)
 D ^DIR K DIR G:$D(DIRUT)!$D(DIROUT)!(Y<0) A4
"RTN","MDWSETUP",136,0)
 I +Y G A3
"RTN","MDWSETUP",137,0)
 G A1
"RTN","MDWSETUP",138,0)
KIL ; Clean Up TMP global arrays and exit
"RTN","MDWSETUP",139,0)
 K DIROUT,DIRUT,MDCL,MDSEL,X,Y
"RTN","MDWSETUP",140,0)
 K ^TMP("MDPROC",$J),^TMP("MDPARAM",$J)
"RTN","MDWSETUP",141,0)
 Q
"RTN","MDWSETUP",142,0)
TASK ; Queue a task to process previous requests
"RTN","MDWSETUP",143,0)
 K IO("Q"),ZTUCI,ZTDTH,ZTIO,ZTSAVE S ZTRTN="START^MDWCHK",ZTREQ="@",ZTSAVE("ZTREQ")="",ZTIO="",ZTDTH=$$NOW^XLFDT()
"RTN","MDWSETUP",144,0)
 S ZTDESC="Check-In Studies for "_$P($G(^MDS(702.01,+MDCP,0)),"^",1)
"RTN","MDWSETUP",145,0)
 S ZTSAVE("MDCP")="",ZTSAVE("MDCL")="",MDUSR=DUZ,ZTSAVE("MDUSR")="",ZTSAVE("MDSAP")=""
"RTN","MDWSETUP",146,0)
 D ^%ZTLOAD K ZTSK
"RTN","MDWSETUP",147,0)
 Q
"RTN","MDWSETUP",148,0)
GET ; Get existing parameter
"RTN","MDWSETUP",149,0)
 N MDPAR,MDVAL
"RTN","MDWSETUP",150,0)
 D GETLST^XPAR(.MDLST1,"SYS","MD CLINIC QUICK LIST")
"RTN","MDWSETUP",151,0)
 D GETLST^XPAR(.MDLST2,"SYS","MD CLINICS WITH MULT PROC")
"RTN","MDWSETUP",152,0)
 ; Get Clinic Quick List
"RTN","MDWSETUP",153,0)
 F MDLP=0:0 S MDLP=$O(MDLST1(MDLP)) Q:MDLP<1  S MDX1=+$P($G(MDLST1(MDLP)),"^",2) I +MDX1 D
"RTN","MDWSETUP",154,0)
 . S MDX=$P($G(^MDS(702.01,MDX1,0)),"^",1) Q:MDX=""
"RTN","MDWSETUP",155,0)
 . S MDY=+$G(MDLST1(MDLP)) Q:'MDY
"RTN","MDWSETUP",156,0)
 . S MDY1=$$GET1^DIQ(44,MDY_",",.01)
"RTN","MDWSETUP",157,0)
 . S ^TMP("MDOLD",$J,MDX,MDY1)=MDY_"^"_MDX1
"RTN","MDWSETUP",158,0)
 ; Get clinic with multiple procedures
"RTN","MDWSETUP",159,0)
 F MDLP=0:0 S MDLP=$O(MDLST2(MDLP)) Q:MDLP<1  I +$G(MDLST2(MDLP)) S MDX=$P($G(^MDS(702.01,+$G(MDLST2(MDLP)),0)),"^",1) D
"RTN","MDWSETUP",160,0)
 . S MDY=+$P($G(MDLST2(MDLP)),"^",2),MDY1=$$GET1^DIQ(44,MDY_",",.01)
"RTN","MDWSETUP",161,0)
 . Q:$G(^TMP("MDOLD",$J,MDX,MDY1))'=""
"RTN","MDWSETUP",162,0)
 . S ^TMP("MDOLD",$J,MDX,MDY1)=MDY_"^"_+$G(MDLST2(MDLP))
"RTN","MDWSETUP",163,0)
 S MDPAR=$NA(^TMP("MDOLD",$J)),MDCTR=0 F  S MDPAR=$Q(@MDPAR) Q:MDPAR=""  Q:$QS(MDPAR,1)'="MDOLD"  D
"RTN","MDWSETUP",164,0)
 . S MDCTR=MDCTR+1,MDVAL=@MDPAR,MDVAL=$TR(MDVAL,"^",";")
"RTN","MDWSETUP",165,0)
 . D EN^XPAR("SYS","MD CLINIC ASSOCIATION",MDCTR,MDVAL)
"RTN","MDWSETUP",166,0)
 K ^TMP("MDOLD",$J)
"RTN","MDWSETUP",167,0)
 Q
"RTN","MDWSETUP",168,0)
CLHELP ; Help Message for Clinic prompt
"RTN","MDWSETUP",169,0)
 W !,"Only required, if appointments are scheduled for the procedure."
"RTN","MDWSETUP",170,0)
 W !,"Enter the clinic used for scheduling the procedure."
"RTN","MDWSETUP",171,0)
 I +MDCP,$D(^TMP("MDPARAM",$J)) D
"RTN","MDWSETUP",172,0)
 .W ! S MDLP="" F  S MDLP=$O(^TMP("MDPARAM",$J,$P($G(^MDS(702.01,+MDCP,0)),"^",1),MDLP)) Q:MDLP=""  I MDLP'["None" W !,MDLP
"RTN","MDWSETUP",173,0)
 W !
"RTN","MDWSETUP",174,0)
 Q
"RTN","MDWSETUP",175,0)
HDR ; Parameter List Header
"RTN","MDWSETUP",176,0)
 W @IOF,!!,"Procedure",?27,"Schedule Appt.",?55,"Clinic"
"RTN","MDWSETUP",177,0)
 W !,"---------",?27,"--------------",?55,"------"
"RTN","MDWSETUP",178,0)
 Q
"VER")
8.0^22.0
"BLD",10068,6)
^32
**END**
**END**

