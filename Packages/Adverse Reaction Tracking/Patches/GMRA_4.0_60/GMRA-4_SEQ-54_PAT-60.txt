$TXT Created by                  at CLN1G2.AAC.DOMAIN.EXT  (KIDS) on Friday, 09/06/19 at 16:28
=============================================================================
Run Date: OCT 01, 2019                     Designation: GMRA*4*60
Package : GMRA - ADVERSE REACTION TRACKING    Priority: Mandatory
Version : 4        SEQ #54                      Status: Released
                  Compliance Date: NOV 01, 2019
=============================================================================

Associated patches: (v)GMRA*4*54   <<= must be installed BEFORE `GMRA*4*60'

Subject: IEN MISMATCH ISSUE FOR FILE #120.86

Category: 
  - Routine

Description:
============

 This patch will resolve the following issue in the Adverse Reaction 
 Tracking (GMRA) package:
       
 1. INC2498395 - R4 - ALLERGIES NOT UPDATING
       
 Defect Tracking System Ticket(s) & Overview:
 --------------------------------------------
 1. INC2498395 - R4 - ALLERGIES NOT UPDATING
       
 Problem:
 --------
 When entering an allergy assessment using the "EA" prompt inside of 
 the Patient Prescription Processing [PSO LM BACKDOOR] option. The code
 checks for the existence of an entry in the ADVERSE REACTION 
 ASSESSMENT (#120.86) file prior to reading the users input. If another
 record is created during the read, the wrong subsection of code gets used,
 and it creates a second record with the IEN/NAME (#.01) field mismatch.
       
 Resolution:
 -----------
 Routine GMRANKA was modified to check for the existence of a record again 
 after the read, allowing it to enter the correct section of code...even 
 if something changed.
       
 A post-install routine (GMRA60P) is included with this patch.  This 
 post-install routine will read through the ADVERSE REACTION 
 ASSESSMENT (#120.86) file to search for any existing IEN/NAME (#.01) field
 mismatches.  An email will be sent to the installer and anyone holding the
 GMRA-ALLERGY VERIFY and/or GMRA-SUPERVISOR keys for informational
 purposes.
  
 See Post-Installation section below for email example and cleanup 
 instructions.
  
 Test Sites:
 -----------
 Oklahoma City HCS
 Martinsburg VAMC
       
 Patch Installation:
 -------------------
       
 Pre-Installation Instructions:
 ------------------------------
 This patch may be installed with users on the system although it is 
 recommended that it be installed during non-peak hours to minimize
 potential disruption to users.  This patch should take less than 5 
 minutes to install.
       
 Installation Instructions:
 --------------------------
 1. Choose the PackMan message containing this patch.
       
 2. Choose the INSTALL/CHECK MESSAGE PackMan option. 
       
 3. From the Kernel Installation and Distribution System Menu, select 
    the Installation Menu.  From this menu, use the following option(s).
    When prompted for the INSTALL NAME enter the patch #(GMRA*4.0*60):
   a. Backup a Transport Global - (Mandatory) This option will create a
      backup message of any routines exported with this patch. It will not 
      backup any other changes such as DDs or templates.
   b. Compare Transport Global to Current System - (Optional) This 
      option will (allow you to view all changes that will be made when
      this patch  is installed.  It compares all components of this patch
      routines, DDs, templates, etc.).
   c. Verify Checksums in Transport Global - (Optional) This option 
      will allow you to ensure the integrity of the routines that are in
      the transport global.
       
 4. From the Installation Menu, select the Install Package(s) option 
    and choose the patch to install.
       
 5. When prompted 'Want KIDS to INHIBIT LOGONs during the install? NO//',
    Enter "No".
       
 6. When prompted 'Want to DISABLE Scheduled Options, Menu Options, and
    Protocols? NO//', Enter "No".
       
 7. If prompted 'Delay Install (Minutes):  (0 - 60): 0//', respond 0.
       
 Post-Installation Instructions:
 -------------------------------
 Example of post install email:
  
 Subj: GMRA*4.0*60 - ADVERSE REACTION ASSESSMENT file Mismatch Check  
 [#58770]
 08/27/19@09:32  17 lines
 From: PATCH GMRA*4.0*60  In 'IN' basket.   Page 1  *New*
 --------------------------------------------------------------------------
 -----
 This email has been generated by a post-
 install routine from patch GMRA*4.0*60
 for the purpose of alerting the installer to
 mismatches between the IEN and the NAME (#.01) field
 in the ADVERSE REACTION ASSESSMENT (#120.86) file.
      
 This email is also being delivered to holders of
 the GMRA-ALLERGY VERIFY and GMRA-SUPERVISOR keys
 for informational purposes only.
      
 These records need to be reviewed for deletion via FileMan.
 Please review the Patch Description for GMRA*4.0*60 for additional 
 details.
      
 Record Number (IEN)        NAME(#.01) field
      
      67890                12345
  
 <end of email example>
  
 Cleanup Instructions:
 The email report provides a list of records from the ADVERSE REACTION 
 ASSESSMENT (#120.86) file where the NAME (#.01) field in that file does 
 not match the record number.  In a correct entry, both the record 
 number and the NAME (#.01) field are the same, and the REACTION 
 ASSESSMENT (#1) field reflects the correct assessment for the
 patient.
  
 For each pair that are identified in the email, check the PATIENT
 ALLERGIES (#120.8) file for active adverse reactions and check the ADVERSE
 REACTION ASSESSMENT (#120.86) file for adverse reactions assessment.  If 
 an erroneous record in the ADVERSE REACTION ASSESSMENT (#120.86) file is 
 found, delete it.
  
 Bad records can be deleted via FileMan as follows:
      -Go to FileMan and select Enter/Edit
      -Enter "120.86" at the "Input to what File:" prompt
      -Enter the bad record number using the grave accent (`) followed by 
       the Record Number from the left-hand column
      -At the NAME (#.01) field prompt enter "@" to delete the record
  
 This is an example of how to delete a bad record via FileMan:
 Select OPTION: ENTER OR EDIT FILE ENTRIES  
  
 Input to what File: // 120.86  ADVERSE REACTION 
 ASSESSMENT
                                           (30792 entries)
 EDIT WHICH FIELD: ALL// 
  
 Select ADVERSE REACTION ASSESSMENT NAME: `67890  PATIENTNM,TEST
 NAME: PATIENTNM,TEST// @
    SURE YOU WANT TO DELETE THE ENTIRE ADVERSE REACTION ASSESSMENT? Y  
 (Yes)
  
 After all records in the email are cleared, use the Assessment clean up
 utility [GMRA ASSESSMENT UTILITY] option.  This should bring up any 
 records where there is a discrepancy between the PATIENT ALLERGIES
 (#120.8) and ADVERSE REACTION ASSESSMENT (#120.86) files.  Review the 
 records and fix with the help of this utility.  Please see the Adverse 
 Reaction Tracking (ART) User Manual for instruction on using this option.
  
    
 Back-out/Rollback Strategy:
 ---------------------------
 In the event of a catastrophic failure, the Facility CIO may make the 
 decision to back-out the patch.
       
 It is imperative that you have performed a backup of the routines included
 in this patch prior to installation.
       
 The back-out plan is to restore the routines from the backup created.
       
 No data was modified by this patch installation and, therefore, no 
 rollback strategy is required.
       
 To verify the back-out completed successfully, ensure the checksum 
 matches the pre-patch checksum from the patch descriptions.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;4.0;Adverse Reaction Tracking;**[Patch List]**;Mar 29, 1996;Build 13

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: GMRA60P
    Before:       n/a   After:  B9945950  **60**
Routine Name: GMRANKA
    Before: B15183005   After: B15740763  **2,21,36,48,54,60**
 
Routine list of preceding patches: 54

=============================================================================
User Information:
Entered By  :                               Date Entered  : JUN 11, 2019
Completed By:                               Date Completed: SEP 30, 2019
Released By :                               Date Released : OCT 01, 2019
=============================================================================


Packman Mail Message:
=====================

$END TXT
