Released PRC*5.1*185 SEQ #159
Extracted from mail message
**KIDS**:PRC*5.1*185^

**INSTALL NAME**
PRC*5.1*185
"BLD",7551,0)
PRC*5.1*185^IFCAP^0^3140121^y
"BLD",7551,1,0)
^^5^5^3140117^
"BLD",7551,1,1,0)
1. Non Supply Personnel able to enter/sign off on P.O.
"BLD",7551,1,2,0)
 
"BLD",7551,1,3,0)
2. Cannot access Inventory Point using Abbreviated Name
"BLD",7551,1,4,0)
 
"BLD",7551,1,5,0)
3. Full Purchase Card number appears under two display options
"BLD",7551,4,0)
^9.64PA^442^3
"BLD",7551,4,410,0)
410
"BLD",7551,4,410,2,0)
^9.641^410^1
"BLD",7551,4,410,2,410,0)
CONTROL POINT ACTIVITY  (File-top level)
"BLD",7551,4,410,2,410,1,0)
^9.6411^451^1
"BLD",7551,4,410,2,410,1,451,0)
PURCHASE CARD RECORD
"BLD",7551,4,410,222)
y^n^p^^^^n^^n
"BLD",7551,4,410,224)

"BLD",7551,4,442,0)
442
"BLD",7551,4,442,2,0)
^9.641^442^1
"BLD",7551,4,442,2,442,0)
PROCUREMENT & ACCOUNTING TRANSACTIONS  (File-top level)
"BLD",7551,4,442,2,442,1,0)
^9.6411^55^2
"BLD",7551,4,442,2,442,1,46,0)
PURCHASE CARD NUMBER
"BLD",7551,4,442,2,442,1,55,0)
PURCHASE CARD EXT. NO.
"BLD",7551,4,442,222)
y^n^p^^^^n^^n
"BLD",7551,4,442,224)

"BLD",7551,4,445,0)
445
"BLD",7551,4,445,2,0)
^9.641^445^1
"BLD",7551,4,445,2,445,0)
GENERIC INVENTORY  (File-top level)
"BLD",7551,4,445,2,445,1,0)
^9.6411^.8^1
"BLD",7551,4,445,2,445,1,.8,0)
ABBREVIATED NAME
"BLD",7551,4,445,222)
y^y^p^^^^n^^n
"BLD",7551,4,445,224)

"BLD",7551,4,"APDD",410,410)

"BLD",7551,4,"APDD",410,410,451)

"BLD",7551,4,"APDD",442,442)

"BLD",7551,4,"APDD",442,442,46)

"BLD",7551,4,"APDD",442,442,55)

"BLD",7551,4,"APDD",445,445)

"BLD",7551,4,"APDD",445,445,.8)

"BLD",7551,4,"B",410,410)

"BLD",7551,4,"B",442,442)

"BLD",7551,4,"B",445,445)

"BLD",7551,6.3)
3
"BLD",7551,"ABPKG")
n
"BLD",7551,"INID")
^y
"BLD",7551,"INIT")
START^PRCP185P
"BLD",7551,"KRN",0)
^9.67PA^779.2^20
"BLD",7551,"KRN",.4,0)
.4
"BLD",7551,"KRN",.4,"NM",0)
^9.68A^^
"BLD",7551,"KRN",.401,0)
.401
"BLD",7551,"KRN",.402,0)
.402
"BLD",7551,"KRN",.402,"NM",0)
^9.68A^1^1
"BLD",7551,"KRN",.402,"NM",1,0)
PRCH2138    FILE #442^442^0
"BLD",7551,"KRN",.402,"NM","B","PRCH2138    FILE #442",1)

"BLD",7551,"KRN",.403,0)
.403
"BLD",7551,"KRN",.5,0)
.5
"BLD",7551,"KRN",.5,"NM",0)
^9.68A^^
"BLD",7551,"KRN",.84,0)
.84
"BLD",7551,"KRN",3.6,0)
3.6
"BLD",7551,"KRN",3.8,0)
3.8
"BLD",7551,"KRN",9.2,0)
9.2
"BLD",7551,"KRN",9.8,0)
9.8
"BLD",7551,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",7551,"KRN",9.8,"NM",1,0)
PRCPUSEL^^0^B27623658
"BLD",7551,"KRN",9.8,"NM",2,0)
PRCFINQ^^0^B4473282
"BLD",7551,"KRN",9.8,"NM",3,0)
PRCP185P^^0^B1690448
"BLD",7551,"KRN",9.8,"NM","B","PRCFINQ",2)

"BLD",7551,"KRN",9.8,"NM","B","PRCP185P",3)

"BLD",7551,"KRN",9.8,"NM","B","PRCPUSEL",1)

"BLD",7551,"KRN",19,0)
19
"BLD",7551,"KRN",19.1,0)
19.1
"BLD",7551,"KRN",101,0)
101
"BLD",7551,"KRN",409.61,0)
409.61
"BLD",7551,"KRN",771,0)
771
"BLD",7551,"KRN",779.2,0)
779.2
"BLD",7551,"KRN",870,0)
870
"BLD",7551,"KRN",8989.51,0)
8989.51
"BLD",7551,"KRN",8989.52,0)
8989.52
"BLD",7551,"KRN",8994,0)
8994
"BLD",7551,"KRN","B",.4,.4)

"BLD",7551,"KRN","B",.401,.401)

"BLD",7551,"KRN","B",.402,.402)

"BLD",7551,"KRN","B",.403,.403)

"BLD",7551,"KRN","B",.5,.5)

"BLD",7551,"KRN","B",.84,.84)

"BLD",7551,"KRN","B",3.6,3.6)

"BLD",7551,"KRN","B",3.8,3.8)

"BLD",7551,"KRN","B",9.2,9.2)

"BLD",7551,"KRN","B",9.8,9.8)

"BLD",7551,"KRN","B",19,19)

"BLD",7551,"KRN","B",19.1,19.1)

"BLD",7551,"KRN","B",101,101)

"BLD",7551,"KRN","B",409.61,409.61)

"BLD",7551,"KRN","B",771,771)

"BLD",7551,"KRN","B",779.2,779.2)

"BLD",7551,"KRN","B",870,870)

"BLD",7551,"KRN","B",8989.51,8989.51)

"BLD",7551,"KRN","B",8989.52,8989.52)

"BLD",7551,"KRN","B",8994,8994)

"BLD",7551,"QDEF")
^^^^NO^^^^NO^^YES
"BLD",7551,"QUES",0)
^9.62^^
"BLD",7551,"REQB",0)
^9.611^1^1
"BLD",7551,"REQB",1,0)
PRC*5.1*118^2
"BLD",7551,"REQB","B","PRC*5.1*118",1)

"FIA",410)
CONTROL POINT ACTIVITY
"FIA",410,0)
^PRCS(410,
"FIA",410,0,0)
410I
"FIA",410,0,1)
y^n^p^^^^n^^n
"FIA",410,0,10)

"FIA",410,0,11)

"FIA",410,0,"RLRO")

"FIA",410,0,"VR")
5.1^PRC
"FIA",410,410)
1
"FIA",410,410,451)

"FIA",442)
PROCUREMENT & ACCOUNTING TRANSACTIONS
"FIA",442,0)
^PRC(442,
"FIA",442,0,0)
442I
"FIA",442,0,1)
y^n^p^^^^n^^n
"FIA",442,0,10)

"FIA",442,0,11)

"FIA",442,0,"RLRO")

"FIA",442,0,"VR")
5.1^PRC
"FIA",442,442)
1
"FIA",442,442,46)

"FIA",442,442,55)

"FIA",445)
GENERIC INVENTORY
"FIA",445,0)
^PRCP(445,
"FIA",445,0,0)
445I
"FIA",445,0,1)
y^y^p^^^^n^^n
"FIA",445,0,10)

"FIA",445,0,11)

"FIA",445,0,"RLRO")

"FIA",445,0,"VR")
5.1^PRC
"FIA",445,445)
1
"FIA",445,445,.8)

"INIT")
START^PRCP185P
"KRN",.402,2456,-1)
0^1
"KRN",.402,2456,0)
PRCH2138^3140117.1419^^442^^^3140117
"KRN",.402,2456,"DIAB",1,0,442,11)
VENDOR:
"KRN",.402,2456,"DIAB",1,1,442.01,23)
PURCHASE ORDER NUMBER:DELIVERY SCHEDULE (ORDER):
"KRN",.402,2456,"DIAB",1,1,442.12,0)
ALL
"KRN",.402,2456,"DIAB",2,0,442,4)
SUBSTATION;REQ
"KRN",.402,2456,"DIAB",7,1,442.01,9)
FEDERAL SUPPLY CLASSIFICATION;T
"KRN",.402,2456,"DR",1,442)
Q:'$D(PRC("SITE"));S (PRCHN("SVC"),PRCHN("CC"),PRCHN("SC"),PRCHN("INV"))="";S PRCHN("SFC")=+$P(^PRC(442,DA,0),U,19);S PRCHN("FOB")=$S($D(^(1)):$P(^(1),U,6),1:"");S PRCHN(12)=$S($D(^PRC(442,DA,12)):^(12),1:"");
"KRN",.402,2456,"DR",1,442,1)
S PRCHNVF="",PRCHPONO=$P(^PRC(442,DA,0),U,1),PRCHSTN=$P(PRCHPONO,"-") S PRCHIEN=DA;S PRCX=$O(^PRC(411,PRC("SITE"),1,0)) S:$G(PRCX)]"" PRCY=$P($G(^PRC(411,PRC("SITE"),1,PRCX,0)),U) K PRCX;D EN2^PRCHNPO6;
"KRN",.402,2456,"DR",1,442,2)
S PRCHDUZ=$P(^VA(200,DUZ,0),U,1);S PRCHN("MP")=$S($D(^PRCD(442.5,+$P(^PRC(442,DA,0),U,2),0)):$P(^(0),U,3),1:"");S PRCHN("INV")=$S(PRCHN("MP")=2:"FISCAL",PRCHN("MP")=12:"",PRCHN("INV")'="":PRCHN("INV"),1:"VA FSC");
"KRN",.402,2456,"DR",1,442,3)
S PRCHCTPO=$S(PRCHN("MP")=2:"Y",1:"N");S X=$P($G(^PRC(442,DA,1)),U) I X>0,$P($G(^PRC(440,X,3)),U,2)="Y" S PRCHEDI="";I '$D(^PRC(411,"UP",PRC("SITE"))) S Y=.1;S OSUB=$P($G(^PRC(442,DA,23)),U,7);
"KRN",.402,2456,"DR",1,442,4)
I $D(^PRCS(410,+$P(^PRC(442,DA,0),"^",12),0)) S X=$P($G(^(0)),U,10) I +X=OSUB W !,"SUBSTATION: ",$P(^PRC(411,$P(^PRC(442,DA,23),U,7),0),U) S Y=.1;31R~;
"KRN",.402,2456,"DR",1,442,5)
I $D(^PRCS(410,+$P(^PRC(442,DA,0),"^",12),0)),X'=OSUB W !,?5,"Sub-station cannot be changed because the attached 2237",!,?5,"would then have a different sub-station.",!;
"KRN",.402,2456,"DR",1,442,6)
S PRCX=$O(^PRC(411,X,1,0)) S:$G(PRCX)]"" PRCY=$P($G(^PRC(411,X,1,PRCX,0)),U) K PRCX;Q;Q;Q;Q;.1//TODAY;.02//^S X="INVOICE/RECEIVING REPORT";
"KRN",.402,2456,"DR",1,442,7)
S PRCHN("MP")=$S($D(^PRCD(442.5,+X,0)):$P(^(0),U,3),1:""),PRCHN("INV")=$S(PRCHN("MP")=2:"FISCAL",PRCHN("MP")=12:"",PRCHN("INV")]"":PRCHN("INV"),1:"VA FSC");S:PRCHN("MP")'=25 Y=.08;D LOOK^PRCSPC;I (X="")!(X["^") S ERRFLG=38,Y=0;
"KRN",.402,2456,"DR",1,442,8)
I $G(PRCHXXX)="" S ERRFLG=38,Y=0;46////^S X=$G(PRCHXXX);56////^S X=DUZ;I PRCHXXX]"" S PRCPO=^PRC(440.5,PRCHXXX,0),PRCHHLDR=$P(PRCPO,U,8);61////^S X=PRCHHLDR;K PRCPO,PRCHHLDR,PRCHXXX;
"KRN",.402,2456,"DR",1,442,9)
.08//^S X=$S(PRCHN("MP")=2:"Y",PRCHN("MP")=12:"Y",1:"N");.04//^S X=PRCHN("INV");5;I $P(PRCHNVF,"^",3)=1 S Y="@20";S PRCHOV3=$G(^PRC(440,+^PRC(442,D0,1),3)) S:$P(PRCHOV3,"^",12)="P" Y="@20";S:$P(PRCHOV3,"^",6)="N" Y="@20";
"KRN",.402,2456,"DR",1,442,10)
S FLAG=0 I $P(PRCHOV3,"^",4)]""!(($P(PRCHOV3,"^",9)]"")&($P(PRCHOV3,"^",8)]"")) S FLAG=1;D EN9^PRCHNPO7;W:0 "The jump Y=@20 is set in routine EN9^PRCHNPO7";
"KRN",.402,2456,"DR",1,442,11)
^440^PRC(440,^^S I(0,0)=D0 S Y(1)=$S($D(^PRC(442,D0,1)):^(1),1:"") S X=$P(Y(1),U,1),X=X  S D(0)=+X S X=$S(D(0)>0:D(0),1:"");@20;I '$D(PRCHEDI) S:$D(^PRC(442,DA,12)) $P(^(12),U,13,14)="^" S Y="@10";18.6//^S X="N";
"KRN",.402,2456,"DR",1,442,12)
I X'="Y" S:$D(^PRC(442,DA,12)) $P(^(12),U,14)="" S Y="@10";18.7;@10;8//^S X=PRCHN("SC");I "29"'[X K:0 DIC("DR") D ^PRCHNPO3 S Y="@1";.25;D ^PRCHNPO3;@1;
"KRN",.402,2456,"DR",1,442,13)
I $D(^PRCS(410,+$P(^PRC(442,DA,0),"^",12),0)) S X=$P($P(^(0),U,1),"-",4) I +X=+$P(^PRC(442,DA,0),U,3) W !,"FCP: ",$P(^(0),U,3) S Y="@2";1;S PRCHN("SFC")=$P(^PRC(442,DA,0),U,19);@2;
"KRN",.402,2456,"DR",1,442,14)
I $G(PRC("BBFY"))="" S PRC("BBFY")=$$BBFY^PRCSUT(PRC("SITE"),PRC("FY"),$P(^PRC(442,DA,0),U,3));26///^S X=PRC("BBFY");D EN2^PRCHNPO3;2//^S X=PRCHN("CC");@88;5.2//^S X=PRCHN("SVC");I $P(^PRC(442,DA,0),U,2)=25 S Y="@89";S Y="@90";@89;
"KRN",.402,2456,"DR",1,442,15)
54;@90;S:PRCHN("MP")=2 Y="@3" I $D(^PRC(442,DA,1)),$P(^(1),U,18)]"" S Y="@3";.3//^S X="E";@3;S:PRCHN("MP")=4 Y=5.3;
"KRN",.402,2456,"DR",1,442,16)
I '$P(^PRC(442,DA,0),U,19)&(PRCHN("MP")'=2) W !,"Enter the word 'PATIENT' in the 'DELIVERY LOCATION' field for a direct delivery",!,"to a patient.";5.6;
"KRN",.402,2456,"DR",1,442,17)
I X="PATIENT",$P(^PRC(442,DA,0),U,19) I $P(^(0),U,19)!(PRCHN("MP")=2) W *7,!,"  PATIENT DELIVERY not valid for this type of order!" S Y=5.6;I X="PATIENT" W "   Direct Delivery to Patient" S Y=5.3;5.4//^S X=$G(PRCY);
"KRN",.402,2456,"DR",1,442,18)
I $P(^PRC(442,DA,1),U,12)'="" W *7,!,"Delete the Direct Delivery patient name if you wish the 'Ship to' address",!,"to print on the P.O.",!;S:(PRCHN("MP")'=4)&($P(^(1),U,12)="") Y=6;5.3;K DIC("DR");6//NO;S:X'="Y" Y=6.4;6.2;
"KRN",.402,2456,"DR",1,442,19)
6.4//DESTINATION;S PRCHN("FOB")=X;Q;Q;Q;Q;I $P(^PRC(442,PRCHPO,1),U,10)=DUZ S $P(^PRC(442,PRCHPO,1),U,10)="";7//TODAY+10;8.2//^S X="N/A";8.3;13;S PRCHSHP=+X;S:X']"" Y="@99";I $P(^PRC(442,DA,0),U,19)'=2 S Y="@98";
"KRN",.402,2456,"DR",1,442,20)
S PRCHSBOC=$P($G(^PRCD(420.2,2299,0)),U);13.05////^S X=PRCHSBOC;S Y="@100";@98;13.05;@100;S:'$D(PRCHSHP) PRCHSHP=$P(^PRC(442,DA,0),U,13) I '(PRCHN("FOB")="O"&((PRCHSHP>250)!(PRCHSHP=0))) S Y="@99";13.2;13.4;13.3;@99;97//^S X="A";
"KRN",.402,2456,"DR",1,442,21)
16//^S X=$S($D(PRCHDUZ):PRCHDUZ,1:"");S PRCHDUZ1=X I $P(^PRC(442,DA,0),U,2)=25,'$D(^PRC(440.5,"H",X)) W *7,!,"This user is not a purchase card user." S Y=16;K PRCHDUZ,PRCHDUZ1;40;24;20;501//^S X=$G(PRCHCTPO);
"KRN",.402,2456,"DR",1,442,22)
K PRCHANS,PRCHTPO,PRCHSEEN,PRCHMORE,PRCHQTY,PRCSAVE;
"KRN",.402,2456,"DR",2,440)
I FLAG S Y=17.3;38;I X]"" S Y=39;W !!,"This VENDOR needs a TAX IDENTIFICATION NUMBER or a SOCIAL SECURITY NUMBER.",!,"Please enter one if you have it or get one from the VENDOR.",!;39;I X]"" S Y=17.3;
"KRN",.402,2456,"DR",2,440,1)
W !!,"Please tell me whether the TAX ID/SSN field is a TAX NUMBER or a SSN NUMBER.",!;17.3;17.4;17.7;17.8;17.9;I $P(PRCHOV3,U,11)]"" S Y="@10";41;@10;I $P(PRCHOV3,U,14)]"" S Y="@11";44;@11;I $P(PRCHOV3,U,13)]"" S Y="";
"KRN",.402,2456,"DR",2,442.01)
S PRCHREC=DA,PRCHQUAN="",Z="",PRCHTOT=0;S PRCHINUM=DA;.01;K PRCSAVE;S PRCHOLD=$P($G(^PRC(442,PRCHIEN,2,PRCHINUM,0)),U,2);1.5;I X=""&($L($P($G(^PRC(442,DA(1),2,DA,2)),U,3))=4) S PRCSAVE="G",Y="@101";
"KRN",.402,2456,"DR",2,442.01,1)
I X=""&($L($P($G(^PRC(442,DA(1),2,DA,2)),U,3))=5) S PRCSAVE="S",Y="@101";I X=""&($G(PRCSAVE)="") D ^PRCHAAC4 I $D(PRCHANS) S PRCSAVE=PRCHANS;@101;I $G(PRCSAVE)="^" K PRCHANS,PRCSAVE S Y=0;1;
"KRN",.402,2456,"DR",2,442.01,2)
I '$D(^PRC(442,DA(1),2,DA,1)) W $C(7),!,"Description is Required!!" S Y=1;I $D(^PRC(442,DA(1),1)) S Z=$S($D(^PRC(441,+$P(^PRC(442,DA(1),2,DA,0),U,5),2,+^PRC(442,DA(1),1),0)):^(0),1:"");
"KRN",.402,2456,"DR",2,442.01,3)
I Z'="" W:$P(Z,U,12)'="" !,"    Minimum Order Qty.: ",$P(Z,U,12) W:$P(Z,U,9) !,"    Maximum Order Qty.: ",$P(Z,U,9) W:$P(Z,U,11) !,"    Required Order Multiple: ",$P(Z,U,11) S PRCHQUAN=Z K Z;
"KRN",.402,2456,"DR",2,442.01,4)
2//^S X=$S($P(PRCHQUAN,U,12)'="":$P(PRCHQUAN,U,12),$P(PRCHQUAN,U,11)'="":$P(PRCHQUAN,U,11),1:"");I X<PRCHOLD N I F I=0:0 S I=$O(^PRC(442.8,"AC",PRCHPONO,PRCHINUM,I)) Q:'I  S PRCHTOT=PRCHTOT+$P($G(^PRC(442.8,I,0)),U,5);
"KRN",.402,2456,"DR",2,442.01,5)
I $G(PRCHTOT)>X W !!!!!,$C(7),"****Delivery schedule total for this item (",PRCHTOT,") EXCEEDS order quantity (",X,").",!,"Edit delivery schedule(s).",!! S PRCHFLG=1,PRCHQTY=X S Y="@16";@44;
"KRN",.402,2456,"DR",2,442.01,6)
I $P(PRCHQUAN,U,12)'="" I X<$P(PRCHQUAN,U,12) W !,"QUANTITY is less than the Minimum Order Quantity of ",$P(PRCHQUAN,U,12),$C(7) S Y=2;
"KRN",.402,2456,"DR",2,442.01,7)
I $P(PRCHQUAN,U,9)'="" I X>$P(PRCHQUAN,U,9) W !,"QUANTITY is more than the Maximum Order Quantity of ",$P(PRCHQUAN,U,9),$C(7) S Y=2;
"KRN",.402,2456,"DR",2,442.01,8)
I $P(PRCHQUAN,U,11)'="" I X#$P(PRCHQUAN,U,11)'=0 W !,"QUANTITY is not a Required Order Multiple value of ",$P(PRCHQUAN,U,11),$C(7) S Y=2;3;5;I $D(^PRC(442,DA(1),1)),$P(^(1),U,20)="Y" S Y="@6";D TSTREQ1^PRCHNPO9;3.1;9.4;S:X']"" Y=9;
"KRN",.402,2456,"DR",2,442.01,9)
S DIE("NO^")="A";9.7;K DIE("NO^");9;9.5;@6;8T~;I $G(PRCSAVE)'="^" D EN10^PRCHNPO7;
"KRN",.402,2456,"DR",2,442.01,10)
S PRCHFCP=+$P(^PRC(442,DA(1),0),U,3),PRCHN("COM")=$S($D(^PRC(441.2,+X,0)):$P(^(0),U,4),1:"") S:$E($P($G(^PRC(420,PRCHSTN,1,PRCHFCP,0)),U,18),1,2)=11 Y=41 S:(PRCHN("COM")'=1)&($E($P($G(^(0)),U,18),1,2)'=11) Y="@4";
"KRN",.402,2456,"DR",2,442.01,11)
S:PRCHN("MP")=2 Y="@4";9.3;D TSTREQ2^PRCHNPO9;40;S Y="@4";41//^S Z=$S($D(^PRC(441,+$P(^PRC(442,DA(1),2,DA,0),U,5),3)):^(3),1:""),X=$P(Z,U,7);42;@4;S DIE("NO^")="OUTOK";4;K DIE("NO^");
"KRN",.402,2456,"DR",2,442.01,12)
I PRCHN("SFC")=2 S $P(^PRC(442,DA(1),2,DA,0),U,4)=$$SUPBOC^PRCHNPO7(-1) S Y="@87";3.5//^S X=$$SUPBOC^PRCHNPO7(-1);@87;S:'$D(PRCHEDI) Y="@5";36.3;36.6;@5;
"KRN",.402,2456,"DR",2,442.01,13)
S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(442.8,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(442.8,PRCHSCN,0),U,2)=DA S PRCHTOT=PRCHTOT+$P(^(0),U,5);S PRCHQTY=$P(^PRC(442,DA(1),2,DA,0),U,2);
"KRN",.402,2456,"DR",2,442.01,14)
I PRCHTOT>PRCHQTY S PRCHDA1=DA(1),PRCHDA=DA,PRCHLINO=$P(^PRC(442,DA(1),2,PRCHREC,0),U) W !,"Line Item # = ",PRCHLINO,!,"Quantity Ordered: "_$P(^PRC(442,DA(1),2,PRCHREC,0),U,2),! S Y="@555";
"KRN",.402,2456,"DR",2,442.01,15)
W !!,"Enter/Edit Delivery Schedule for this Item?  NO// " R X:DTIME S:'$T X="^" S:X="" X="N" S:X["?" Y="@5" S:"Yy?"'[$E(X) Y="@56" W "  "_$S("Yy"[$E(X):"(YES)","Nn"[$E(X):"(NO)",1:"");@16;
"KRN",.402,2456,"DR",2,442.01,16)
S PRCHDA1=DA(1),PRCHDA=DA,PRCHLINO=$P(^PRC(442,DA(1),2,PRCHREC,0),U) W !,"Line Item #=",PRCHLINO,!,"Quantity Ordered: "_$P(^PRC(442,DA(1),2,PRCHREC,0),U,2),!;
"KRN",.402,2456,"DR",2,442.01,17)
I PRCHTOT=PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," equals order quantity of ",PRCHQTY,".",!,"You may edit delivery schedule(s), but cannot add a new schedule.",!;@555;
"KRN",.402,2456,"DR",2,442.01,18)
I PRCHTOT>PRCHQTY W !,"Delivery schedule quantity of ",PRCHTOT," EXCEEDS order quantity of ",PRCHQTY,".  You must edit",!,"one or more schedules so that the total equals no more than ",PRCHQTY,".",!! S Y="@55";
"KRN",.402,2456,"DR",2,442.01,19)
S:$D(PRCHSEEN) Y="@55";S PRCHSEEN=1,DLAYGO=442.8 W !!,"To delete a schedule, zero out the quantity to be delivered. To add a new",!,"delivery schedule do the following:",!!;
"KRN",.402,2456,"DR",2,442.01,20)
W "a. If there is no delivery schedule already in file answer 'Yes' when asked if     you are adding a new delivery schedule.";
"KRN",.402,2456,"DR",2,442.01,21)
W !,"b. If there is only one delivery schedule already in the file you will see         'OK? YES//' answer 'No' and then answer 'Yes' when asked if you are adding a    new delivery schedule.";
"KRN",.402,2456,"DR",2,442.01,22)
W !,"c. If there is more than one delivery schedule in the file, hit <return> key at    'CHOOSE' prompt and answer 'Yes' when asked if you are adding a new delivery    schedule.",!!;@55;
"KRN",.402,2456,"DR",2,442.01,23)
^442.8^PRC(442.8,^^X DR(99,1,9.3) S X=$P(Y(101),U,1),Y(102)=$G(X) S X=$P(Y(101),U,1) S D0=I(0,0) S D1=I(1,0) S X=$S(D(0)>0:D(0),1:"");S:$G(PRCHDA) PRCHINUM=PRCHDA S PRCHQTY=$P(^PRC(442,PRCHIEN,2,PRCHINUM,0),U,2);
"KRN",.402,2456,"DR",2,442.01,24)
I $G(PRCHFLG),PRCHTOT>PRCHQTY W !!,"Delivery schedule total of ",PRCHTOT," EXCEEDS ordered quantity.",!,"of ",PRCHQTY,".  Adjust delivery schedule(s).",!! S Y="@16";
"KRN",.402,2456,"DR",2,442.01,25)
I $G(PRCHFLG) S PRCHFLG=0 W !!!!,"****Returning to Item Multiple edit session.",!! S Y="@44";I PRCHTOT>PRCHQTY S Y="@555";
"KRN",.402,2456,"DR",2,442.01,26)
W !!,"Enter/Edit Another Delivery Schedule for this Item? NO// " R X:DTIME S:'$T X="^" S:X="" X="N" S:X["?" Y="@5" S:"Yy?"[$E(X) Y="@16";@56;K DIE("NO^"),PRCHTOT,PRCHSCN,PRCHSEEN;
"KRN",.402,2456,"DR",2,442.12)
.01
"KRN",.402,2456,"DR",2,442.15)
.01;
"KRN",.402,2456,"DR",3,442.8)
1///^S X=PRCHDA;S DIE("NO^")="";2;3;@6;4;K DIE("NO^");S PRCHTOT=0,PRCHSCN="" F I=0:0 S PRCHSCN=$O(^PRC(442.8,"B",PRCHPONO,PRCHSCN)) Q:PRCHSCN=""  I $P(^PRC(442.8,PRCHSCN,0),U,2)=PRCHDA S PRCHTOT=PRCHTOT+$P(^(0),U,5);
"KRN",.402,2456,"DR",3,442.8,1)
S PRCHQTY=$P(^PRC(442,PRCHIEN,2,PRCHDA,0),U,2);S PRCHMORE=$P(^PRC(442.8,DA,0),U,5),PRCHMOR2=(PRCHQTY-PRCHTOT+PRCHMORE);
"KRN",.402,2456,"DR",3,442.8,2)
I PRCHTOT>PRCHQTY I PRCHMORE'=0 W *7,!,"Del. sched. total of ",PRCHTOT," for item ",PRCHDA," EXCEEDS the purchase",!,"order quantity of ",PRCHQTY,".",!,"Max. quantity here is ",$S(PRCHMOR2>0:PRCHMOR2,1:0),".",!! S Y="@6";
"KRN",.402,2456,"DR",3,442.8,3)
I PRCHTOT<PRCHQTY W !,"Delivery schedule total of ",PRCHTOT," for item ",PRCHDA," is less than purchase",!,"order quantity.",!!;I X>0 S Y="@445";W *7,!,"Delivery Schedule DELETED",!;.01////@;@445;
"KRN",.402,2456,"DR",99,1,9.2)
N DIC S DIC=X N X S X=DIC,DIC="^PRC(442.8,",DIC(0)="MFLE" D ^DIC
"KRN",.402,2456,"DR",99,1,9.3)
S I(1,0)=$G(D1),I(0,0)=$G(D0),Y(1)=$S($D(^PRC(442,D0,0)):^(0),1:"") S X=$P(Y(1),U,1) X DR(99,1,9.2) S (D,D0,D(0))=+Y S Y(101)=$S($D(^PRC(442.8,D0,0)):^(0),1:"")
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
185^3140121
"PKG",455,22,1,"PAH",1,1,0)
^^5^5^3140121
"PKG",455,22,1,"PAH",1,1,1,0)
1. Non Supply Personnel able to enter/sign off on P.O.
"PKG",455,22,1,"PAH",1,1,2,0)
 
"PKG",455,22,1,"PAH",1,1,3,0)
2. Cannot access Inventory Point using Abbreviated Name
"PKG",455,22,1,"PAH",1,1,4,0)
 
"PKG",455,22,1,"PAH",1,1,5,0)
3. Full Purchase Card number appears under two display options
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PRCFINQ")
0^2^B4473282^B3496954
"RTN","PRCFINQ",1,0)
PRCFINQ ;WISC/CLH,LEM-AUDIT REPORTS ;3/18/93  9:01 AM
"RTN","PRCFINQ",2,0)
V ;;5.1;IFCAP;**185**;Oct 20, 2000;Build 3
"RTN","PRCFINQ",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCFINQ",4,0)
 ;
"RTN","PRCFINQ",5,0)
 ;PRC*5.1*185 Add switch PRCPRTTF to inquiry EN1 & EN3 to prevent
"RTN","PRCFINQ",6,0)
 ;            the full PCARD number from displaying.  Modified files
"RTN","PRCFINQ",7,0)
 ;            410 & 442 PCARD number field to display last 4 digits
"RTN","PRCFINQ",8,0)
 ;            of PCARD number when switch set to on.
"RTN","PRCFINQ",9,0)
 ;
"RTN","PRCFINQ",10,0)
 ;FULL INQUIRE TO FILE 410
"RTN","PRCFINQ",11,0)
EN1 S PRCPRTTF=1,DIC=410,DIC(0)="AEMQ",DIC("A")="Select CONTROL POINT ACTIVITY NUMBER: " D ^DIC G Q:+Y<0 W:$D(IOF) @IOF W !!,"Processing History for:",!!,$C(7) S DA=+Y,DIQ(0)="AC" D EN^DIQ G EN1     ;PRC*5.1*185
"RTN","PRCFINQ",12,0)
 ;FULL INQUIRE TO FILE 430
"RTN","PRCFINQ",13,0)
EN2 I '$D(^DIC(430)) S X="No Accounts Receivable information available in File 430 on this system.*" D MSG^PRCFQ G Q
"RTN","PRCFINQ",14,0)
 S DIC=430,DIC(0)="AEMQ",DIC("A")="Select ACCOUNTS RECEIVABLE NUMBER: " D ^DIC G Q:+Y<0 W:$D(IOF) @IOF W !!,"Processing History for:",!!,$C(7) S DA=+Y,DIQ(0)="AC" D EN^DIQ G EN2
"RTN","PRCFINQ",15,0)
 ;FULL INQUIRE TO FILE 442
"RTN","PRCFINQ",16,0)
EN3 S PRCPRTTF=1,DIC=442,DIC(0)="AEMQ" D ^DIC G Q:+Y<0 W:$D(IOF) @IOF W !!,"Processing History for:",!!,$C(7) S DA=+Y,DIQ(0)="AC" D EN^DIQ G EN3     ;PRC*5.1*185
"RTN","PRCFINQ",17,0)
Q K PRCPRTTF,DIC,X,Y,DA,DIQ Q    ;PRC*5.1*185
"RTN","PRCP185P")
0^3^B1690448^n/a
"RTN","PRCP185P",1,0)
PRCP185P ;RB-PRE INSTALL PRC*185 TO RE-INDEX FILE 445, FIELD .8 ;4-26-94/3:45 PM
"RTN","PRCP185P",2,0)
V ;;5.1;IFCAP;**185**;Oct 20, 2000;Build 3
"RTN","PRCP185P",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCP185P",4,0)
 Q
"RTN","PRCP185P",5,0)
START ;PRC*5.1*185 Process to re-index file 445, field .8 [ABBREVIATED NAME]
"RTN","PRCP185P",6,0)
 ;            due to adding new CROSS REFERENCE ('CAB') to field.
"RTN","PRCP185P",7,0)
 ;
"RTN","PRCP185P",8,0)
 K ^XTMP("PRCP185P")
"RTN","PRCP185P",9,0)
 D NOW^%DTC S RMSTART=%
"RTN","PRCP185P",10,0)
 S ^XTMP("PRCP185P","START COMPILE")=RMSTART
"RTN","PRCP185P",11,0)
 S ^XTMP("PRCP185P","END COMPILE")="RUNNING"
"RTN","PRCP185P",12,0)
 S ^XTMP("PRCP185P",0)=$$FMADD^XLFDT(RMSTART,180)_"^"_RMSTART
"RTN","PRCP185P",13,0)
 S PRCIEN=0
"RTN","PRCP185P",14,0)
BB F  S PRCIEN=$O(^PRCP(445,PRCIEN)) Q:'PRCIEN  D
"RTN","PRCP185P",15,0)
 . Q:'$D(^PRCP(445,PRCIEN,0))  S DA=PRCIEN
"RTN","PRCP185P",16,0)
 . S PRCPR0=^PRCP(445,PRCIEN,0) S PRCABRV=$P(PRCPR0,"^",5) Q:PRCABRV=""
"RTN","PRCP185P",17,0)
 . S ^XTMP("PRCP185P",DA,PRCABRV)="" K DIC
"RTN","PRCP185P",18,0)
 . S DIK="^PRCP(445,",DIK(1)=".8^2" D EN^DIK K DIK
"RTN","PRCP185P",19,0)
 . S ^XTMP("PRCP185P",DA,PRCABRV,"CAB")=$S('$D(^PRCP(445,"CAB",PRCABRV,DA)):0,1:1)
"RTN","PRCP185P",20,0)
 D NOW^%DTC S RMEND=%
"RTN","PRCP185P",21,0)
 S ^XTMP("PRCP185P","END REINDEX")=RMEND
"RTN","PRCP185P",22,0)
 K %,RMSTART,RMEND,PRCIEN,PRCABRV,DA,PRCPR0
"RTN","PRCP185P",23,0)
 Q
"RTN","PRCPUSEL")
0^1^B27623658^B26262666
"RTN","PRCPUSEL",1,0)
PRCPUSEL ;WISC/RFJ/DAP-utilities: setup inventory variables ;14 Feb 91
"RTN","PRCPUSEL",2,0)
V ;;5.1;IFCAP;**1,83,110,118,185**;Oct 20, 2000;Build 3
"RTN","PRCPUSEL",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCPUSEL",4,0)
 ;  enter distribution point--input variables:
"RTN","PRCPUSEL",5,0)
 ;  prcp("dptype")=distribution point type code [W,P,S]
"RTN","PRCPUSEL",6,0)
 ;  returns the following variables:
"RTN","PRCPUSEL",7,0)
 ;  prcp("in")=name of inv pt (no station #),
"RTN","PRCPUSEL",8,0)
 ;  prcp("inv")=keep perpetual inventory flag
"RTN","PRCPUSEL",9,0)
 ;  prcp("his")=keep detailed history flag,
"RTN","PRCPUSEL",10,0)
 ;  prcp("i")=da of inv pt
"RTN","PRCPUSEL",11,0)
 ;
"RTN","PRCPUSEL",12,0)
 ;PRC*5.1*185 Modified look up parameters for Inventory Point from
"RTN","PRCPUSEL",13,0)
 ;            'AEQMOZ' to 'AEQMZ' to show matches for both Inventory
"RTN","PRCPUSEL",14,0)
 ;            Point name and abbreviation.
"RTN","PRCPUSEL",15,0)
 ;
"RTN","PRCPUSEL",16,0)
 ;*83 Routine PRCPLO1 associated with PRC*5.1*83 is a modified copy of
"RTN","PRCPUSEL",17,0)
 ;this routine and any changes made to this routine should also be
"RTN","PRCPUSEL",18,0)
 ;considered for that routine as well.
"RTN","PRCPUSEL",19,0)
 ;
"RTN","PRCPUSEL",20,0)
 N %,C,DISYS,I,J,PRCF,PRCPFLAG,X,Y
"RTN","PRCPUSEL",21,0)
 I +$G(DUZ)<1 W !,"YOU ARE NOT SETUP AS A USER!" K PRC,PRCP Q
"RTN","PRCPUSEL",22,0)
 ;
"RTN","PRCPUSEL",23,0)
 S %=0 F I="FY","PARAM","PER","QTR","SITE" I '+$G(PRC(I)) S %=1 Q
"RTN","PRCPUSEL",24,0)
 I % S PRCF("X")="S" D ^PRCFSITE I '+$G(PRC("SITE")) K PRC,PRCP Q
"RTN","PRCPUSEL",25,0)
 ;
"RTN","PRCPUSEL",26,0)
 S %=0 F I="DPTYPE","HIS","I","IN","INV" I $G(PRCP(I))="" S %=1 Q
"RTN","PRCPUSEL",27,0)
 I '% D DISPLAY Q
"RTN","PRCPUSEL",28,0)
 ;
"RTN","PRCPUSEL",29,0)
 ;  allow adding new whse if not one for station
"RTN","PRCPUSEL",30,0)
 I $G(PRCP("DPTYPE"))="W" D  Q:$G(PRCPFLAG)
"RTN","PRCPUSEL",31,0)
 .   K PRCPFLAG
"RTN","PRCPUSEL",32,0)
 .   S %=0 F  S %=$O(^PRCP(445,"AC","W",%)) Q:'%  I $P($P($G(^PRCP(445,%,0)),"^"),"-")=PRC("SITE") S PRCPFLAG=1 Q
"RTN","PRCPUSEL",33,0)
 .   I $G(PRCPFLAG) K PRCPFLAG Q
"RTN","PRCPUSEL",34,0)
 .   S PRCP("I")=$$INVPT^PRCPUINV(PRC("SITE"),"W",1,1,"")
"RTN","PRCPUSEL",35,0)
 .   I 'PRCP("I") S PRCPFLAG=1 K PRC,PRCP
"RTN","PRCPUSEL",36,0)
 ;
"RTN","PRCPUSEL",37,0)
 S %=$S($D(PRCP("DPTYPE")):PRCP("DPTYPE"),1:"^")
"RTN","PRCPUSEL",38,0)
 S (I,J)=0
"RTN","PRCPUSEL",39,0)
 F  S I=$O(^PRCP(445,"AD",DUZ,I)) Q:'I  I $D(^PRCP(445,I,0)) D  I J>1 Q
"RTN","PRCPUSEL",40,0)
 .   S:%="^"!(%[$P(^PRCP(445,I,0),"^",3)) Y(0)=^(0),J=J+1,Y=I
"RTN","PRCPUSEL",41,0)
 I J=1 D  Q:$G(PRCPFLAG)  S PRC("SITE")=+Y(0) D V1 Q
"RTN","PRCPUSEL",42,0)
 .   I '$D(^PRC(411,+Y(0),0)) D  K PRC,PRCP S PRCPFLAG=1
"RTN","PRCPUSEL",43,0)
 .   .   W !,"ERROR - SITE PARAMETERS IN FILE 411 FOR SITE "
"RTN","PRCPUSEL",44,0)
 .   .   W +Y(0)," ARE MISSING."
"RTN","PRCPUSEL",45,0)
 I $G(PRCHAUTH) Q:'$G(PRCP("I"))  D  G V1
"RTN","PRCPUSEL",46,0)
 .   S Y=PRCP("I")_"^"_$P($G(^PRCP(445,PRCP("I"),0)),U)
"RTN","PRCPUSEL",47,0)
 ;
"RTN","PRCPUSEL",48,0)
 S DIC="^PRCP(445,",DIC(0)="AEQMZ"   ;PRC*5.1*185 Modified look up parameters
"RTN","PRCPUSEL",49,0)
 S DIC("S")="I +^(0)=PRC(""SITE""),$P(^(0),U,2)=""Y"",$D(^PRCP(445,+Y,4,DUZ,0))"
"RTN","PRCPUSEL",50,0)
 I $D(PRCP("DPTYPE")) S DIC("S")=DIC("S")_",PRCP(""DPTYPE"")[$P(^PRCP(445,+Y,0),U,3)"
"RTN","PRCPUSEL",51,0)
 S DIC("A")="Select "_$S('$D(PRCP("DPTYPE")):"",PRCP("DPTYPE")="W":"Supply Warehouse ",PRCP("DPTYPE")="P":"Primary ",PRCP("DPTYPE")="S":"Secondary ",1:"")_"Inventory Point: "
"RTN","PRCPUSEL",52,0)
 S D="C",PRCPPRIV=1
"RTN","PRCPUSEL",53,0)
 D IX^DIC
"RTN","PRCPUSEL",54,0)
 K PRCPPRIV,DIC
"RTN","PRCPUSEL",55,0)
 I Y<0 K PRC,PRCP Q
"RTN","PRCPUSEL",56,0)
 ;
"RTN","PRCPUSEL",57,0)
V1 ;  internal program jump
"RTN","PRCPUSEL",58,0)
 D PARAM(+Y)
"RTN","PRCPUSEL",59,0)
 ;
"RTN","PRCPUSEL",60,0)
DISPLAY ;  display top of page header
"RTN","PRCPUSEL",61,0)
 I '$G(PRCP("I")) G PRCPUSEL
"RTN","PRCPUSEL",62,0)
 S %=0 F I="RV1","RV0","XY" I '$D(PRCP(I)) S %=1 Q
"RTN","PRCPUSEL",63,0)
 I % D TERM
"RTN","PRCPUSEL",64,0)
 ;
"RTN","PRCPUSEL",65,0)
 S %="",$P(%," ",81)=""
"RTN","PRCPUSEL",66,0)
 S X="I N V E N T O R Y  version "_$P($T(PRCPUSEL+1),";",3)
"RTN","PRCPUSEL",67,0)
 S Y=80-$L(X)\2
"RTN","PRCPUSEL",68,0)
 S X=$E(%,1,Y)_X_%
"RTN","PRCPUSEL",69,0)
 W @IOF,PRCP("RV1"),$E(X,1,40)
"RTN","PRCPUSEL",70,0)
 X PRCP("XY")
"RTN","PRCPUSEL",71,0)
 W $E(X,41,80),PRCP("RV0")
"RTN","PRCPUSEL",72,0)
 S PRCP("PAR")=^PRCP(445,PRCP("I"),0)
"RTN","PRCPUSEL",73,0)
 S X=$S(+$G(PRC("SITE")):"("_PRC("SITE")_") ",1:"")
"RTN","PRCPUSEL",74,0)
 S X=X_$S(PRCP("DPTYPE")="W":"Warehouse ",PRCP("DPTYPE")="P":"Primary ",PRCP("DPTYPE")="S":"Secondary ",1:"")
"RTN","PRCPUSEL",75,0)
 S X=X_"Inventory Point: "_PRCP("IN")
"RTN","PRCPUSEL",76,0)
 W !,X,?(80-$L($P($G(PRC("PER")),"^",2))),$P($G(PRC("PER")),"^",2)
"RTN","PRCPUSEL",77,0)
 I PRCP("DPTYPE")="P" S Y=$P(PRCP("PAR"),"^",12) I Y,Y'>DT D
"RTN","PRCPUSEL",78,0)
 .   D DD^%DT
"RTN","PRCPUSEL",79,0)
 .   W !,?6,"--> NEXT REQUEST FOR WAREHOUSE ISSUES IS DUE IN SUPPLY ON ",Y,"."
"RTN","PRCPUSEL",80,0)
 I $P(PRCP("PAR"),"^",9)="Y" D
"RTN","PRCPUSEL",81,0)
 .   W !?6,"--> THERE ARE ITEMS AT OR BELOW THE EMERGENCY STOCK LEVEL."
"RTN","PRCPUSEL",82,0)
 I $E($P(PRCP("PAR"),"^",14),1,5)'=$E(DT,1,5) D
"RTN","PRCPUSEL",83,0)
 .   W !?6,"--> USAGE/DISTRIBUTION TOTALS NEEDS TO BE PURGED."
"RTN","PRCPUSEL",84,0)
 I $E($P(PRCP("PAR"),"^",17),1,5)'=$E(DT,1,5) D
"RTN","PRCPUSEL",85,0)
 .   W !?6,"--> RECEIPTS HISTORY BY ITEM NEEDS TO BE PURGED."
"RTN","PRCPUSEL",86,0)
 I PRCP("DPTYPE")'="S",$E($P(PRCP("PAR"),"^",19),1,5)'=$E(DT,1,5) D
"RTN","PRCPUSEL",87,0)
 .   W !?6,"--> DISTRIBUTION HISTORY NEEDS TO BE PURGED."
"RTN","PRCPUSEL",88,0)
 I $E($P(PRCP("PAR"),"^",18),1,5)'=$E(DT,1,5) D
"RTN","PRCPUSEL",89,0)
 .   W !?6,"--> TRANSACTION REGISTER NEEDS TO BE PURGED."
"RTN","PRCPUSEL",90,0)
 I $P(PRCP("PAR"),"^",6)="Y",$E($P(PRCP("PAR"),"^",22),1,5)'=$E(DT,1,5) D
"RTN","PRCPUSEL",91,0)
 .   W !?6,"--> OPENING MONTHLY INVENTORY BALANCES NEED TO BE SET."
"RTN","PRCPUSEL",92,0)
 I PRCP("DPTYPE")="S",$P($G(^PRCP(445,PRCP("I"),5)),"^",1)]"" D SSMSG
"RTN","PRCPUSEL",93,0)
 I $O(^PRCP(447.1,"C",+PRCP("PAR"),PRCP("I"),"")) D
"RTN","PRCPUSEL",94,0)
 .   W !?6,"--> THERE ARE UNPROCESSED SUPPLY STATION TRANSACTIONS."
"RTN","PRCPUSEL",95,0)
 ;
"RTN","PRCPUSEL",96,0)
 W !,PRCP("RV1"),$E(%,1,40) X PRCP("XY") W $E(%,41,80),PRCP("RV0")
"RTN","PRCPUSEL",97,0)
 Q
"RTN","PRCPUSEL",98,0)
 ;
"RTN","PRCPUSEL",99,0)
 ;
"RTN","PRCPUSEL",100,0)
NOMENU ;  user did not select a valid inventory point, do not allow access
"RTN","PRCPUSEL",101,0)
 ;  to the menu (called from option file)
"RTN","PRCPUSEL",102,0)
 N X
"RTN","PRCPUSEL",103,0)
 S X(1)="YOU MUST SELECT A VALID INVENTORY POINT BEFORE ACCESSING THIS MENU" D DISPLAY^PRCPUX2(1,79,.X)
"RTN","PRCPUSEL",104,0)
 Q
"RTN","PRCPUSEL",105,0)
 ;
"RTN","PRCPUSEL",106,0)
 ;
"RTN","PRCPUSEL",107,0)
PARAM(INVPT) ;  set up parameters for inventory point
"RTN","PRCPUSEL",108,0)
 K PRCP
"RTN","PRCPUSEL",109,0)
 N DATA
"RTN","PRCPUSEL",110,0)
 S DATA=$G(^PRCP(445,INVPT,0)) I DATA="" Q
"RTN","PRCPUSEL",111,0)
 S PRCP("I")=INVPT,PRCP("IN")=$P($P(DATA,"^"),"-",2,99),PRCP("INV")=$P(DATA,"^",2),PRCP("HIS")=$P(DATA,"^",6),PRCP("DPTYPE")=$P(DATA,"^",3)
"RTN","PRCPUSEL",112,0)
 D TERM
"RTN","PRCPUSEL",113,0)
 Q
"RTN","PRCPUSEL",114,0)
 ;
"RTN","PRCPUSEL",115,0)
 ;
"RTN","PRCPUSEL",116,0)
TERM ;  get terminal attributes
"RTN","PRCPUSEL",117,0)
 N X
"RTN","PRCPUSEL",118,0)
 I '$D(IOF)!('$G(IOST(0))) S IOP="HOME" D ^%ZIS K IOP
"RTN","PRCPUSEL",119,0)
 S X="IORVON;IORVOFF" D ENDR^%ZISS
"RTN","PRCPUSEL",120,0)
 S PRCP("RV1")=$G(IORVON),PRCP("RV0")=$G(IORVOFF)
"RTN","PRCPUSEL",121,0)
 S PRCP("XY")="N DX,DY S (DX,DY)=0 "_$G(^%ZOSF("XY"))
"RTN","PRCPUSEL",122,0)
 Q
"RTN","PRCPUSEL",123,0)
 ;
"RTN","PRCPUSEL",124,0)
SSMSG ; check supply station secondaries, give message of qty mismatch
"RTN","PRCPUSEL",125,0)
 N GIPCNT,INVPT,ITEM,PRCPFLAG,SSCNT
"RTN","PRCPUSEL",126,0)
 S INVPT=PRCP("I")
"RTN","PRCPUSEL",127,0)
 S ITEM=0
"RTN","PRCPUSEL",128,0)
 F  S ITEM=$O(^PRCP(445,INVPT,1,ITEM)) Q:'+ITEM  D  I $D(PRCPFLAG) Q
"RTN","PRCPUSEL",129,0)
 .  I $P($G(^PRCP(445,INVPT,1,ITEM,0)),"^",9)<1 Q  ; not a SS item
"RTN","PRCPUSEL",130,0)
 .  S GIPCNT=$P($G(^PRCP(445,INVPT,1,ITEM,0)),"^",7)
"RTN","PRCPUSEL",131,0)
 .  S SSCNT=$P($G(^PRCP(445,INVPT,1,ITEM,9)),"^",1)
"RTN","PRCPUSEL",132,0)
 .  I 'GIPCNT,'SSCNT Q
"RTN","PRCPUSEL",133,0)
 .  I GIPCNT=SSCNT Q
"RTN","PRCPUSEL",134,0)
 .  W !,?6,"--> QUANTITY DISCREPANCIES EXIST WITH THE SUPPLY STATION."
"RTN","PRCPUSEL",135,0)
 . S PRCPFLAG=1
"VER")
8.0^22.0
"^DD",410,410,451,0)
PURCHASE CARD RECORD^P440.5'O^PRC(440.5,^1;2^Q
"^DD",410,410,451,2)
S Y(0)=Y I Y S:$G(PRCPRTTF)=1 Y="XXXXXXXXXXXX"_$E($P($G(^PRC(440.5,Y,0)),U),13,16) S:$G(PRCPRTTF)'=1 Y=$P($G(^PRC(440.5,Y,0)),U)
"^DD",410,410,451,2.1)
I Y S:$G(PRCPRTTF)=1 Y="XXXXXXXXXXXX"_$E($P($G(^PRC(440.5,Y,0)),U),13,16) S:$G(PRCPRTTF)'=1 Y=$P($G(^PRC(440.5,Y,0)),U)
"^DD",410,410,451,3)
Select the purchase card.
"^DD",410,410,451,21,0)
^^2^2^3131210^
"^DD",410,410,451,21,1,0)
This field is populated with the Purchase Card number when the 2237
"^DD",410,410,451,21,2,0)
associated with a purchase card order is created.
"^DD",410,410,451,23,0)
^.001^4^4^3131210^^^
"^DD",410,410,451,23,1,0)
The Output Transform was created to insure regular IFCAP users are not 
"^DD",410,410,451,23,2,0)
able to see Purchase Card (credit card) number via options PRCF INQ 410 
"^DD",410,410,451,23,3,0)
or PRCF INQ 442, but, IT users and high level Fileman users are able to 
"^DD",410,410,451,23,4,0)
see the full associated card number.
"^DD",410,410,451,"DT")
3131211
"^DD",442,442,46,0)
PURCHASE CARD NUMBER^R*P440.5'XO^PRC(440.5,^23;8^S DIC("S")="I $D(^PRC(440.5,""C"",DUZ,Y))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",442,442,46,1,0)
^.1^^-1
"^DD",442,442,46,1,2,0)
442^AM
"^DD",442,442,46,1,2,1)
S ^PRC(442,"AM",$E(X,1,30),DA)=""
"^DD",442,442,46,1,2,2)
K ^PRC(442,"AM",$E(X,1,30),DA)
"^DD",442,442,46,1,2,"%D",0)
^^1^1^2970306^
"^DD",442,442,46,1,2,"%D",1,0)
Cross reference for purchase card numbers.
"^DD",442,442,46,1,2,"DT")
2970306
"^DD",442,442,46,2)
S Y(0)=Y I Y S:$G(PRCPRTTF)=1 Y="XXXXXXXXXXXX"_$E($P($G(^PRC(440.5,Y,0)),U),13,16) S:$G(PRCPRTTF)'=1 Y=$P($G(^PRC(440.5,Y,0)),U)
"^DD",442,442,46,2.1)
I Y S:$G(PRCPRTTF)=1 Y="XXXXXXXXXXXX"_$E($P($G(^PRC(440.5,Y,0)),U),13,16) S:$G(PRCPRTTF)'=1 Y=$P($G(^PRC(440.5,Y,0)),U)
"^DD",442,442,46,3)
Enter the purchase card.
"^DD",442,442,46,12)
Enter "?" to see your own purchase card number(s).
"^DD",442,442,46,12.1)
S DIC("S")="I $D(^PRC(440.5,""C"",DUZ,Y))"
"^DD",442,442,46,21,0)
^^1^1^3131210^
"^DD",442,442,46,21,1,0)
This is the purchase card number assigned to the purchase card order.
"^DD",442,442,46,23,0)
^.001^4^4^3131210^^^
"^DD",442,442,46,23,1,0)
The Output Transform was created to insure regular IFCAP users are not 
"^DD",442,442,46,23,2,0)
able to see Purchase Card (credit card) number via options PRCF INQ 410 
"^DD",442,442,46,23,3,0)
or PRCF INQ 442, but, IT users and high level Fileman users are able to 
"^DD",442,442,46,23,4,0)
see the full associated card number.
"^DD",442,442,46,"DT")
3131210
"^DD",442,442,55,0)
PURCHASE CARD EXT. NO.^FO^^23;16^K:$L(X)>16!($L(X)<16) X
"^DD",442,442,55,2)
S Y(0)=Y S:$G(PRCPRTTF)=1 Y="XXXXXXXXXXXX"_$E(Y,13,16)
"^DD",442,442,55,2.1)
S:$G(PRCPRTTF)=1 Y="XXXXXXXXXXXX"_$E(Y,13,16)
"^DD",442,442,55,3)
Answer must be 16 characters in length.
"^DD",442,442,55,21,0)
^^1^1^3131210^
"^DD",442,442,55,21,1,0)
This is the purchase card number assigned to the purchase card order.
"^DD",442,442,55,23,0)
^.001^4^4^3131210^^
"^DD",442,442,55,23,1,0)
The Output Transform was created to insure regular IFCAP users are not 
"^DD",442,442,55,23,2,0)
able to see Purchase Card (credit card) number via options PRCF INQ 410 
"^DD",442,442,55,23,3,0)
or PRCF INQ 442, but, IT users and high level Fileman users are able to 
"^DD",442,442,55,23,4,0)
see the full associated card number.
"^DD",442,442,55,"DT")
3131210
"^DD",445,445,.8,0)
ABBREVIATED NAME^RFX^^0;5^K:X[""""!($A(X)=45) X I $D(X) K:$L(X)>6!($L(X)<1)!'(X?1U.E) X I $D(X) K:$O(^PRCP(445,"AF",+^PRCP(445,DA,0),X,0)) X
"^DD",445,445,.8,1,0)
^.1
"^DD",445,445,.8,1,1,0)
445^AF^MUMPS
"^DD",445,445,.8,1,1,1)
S ^PRCP(445,"AF",+^PRCP(445,DA,0),$E(X,1,30),DA)=""
"^DD",445,445,.8,1,1,2)
K ^PRCP(445,"AF",+^PRCP(445,DA,0),$E(X,1,30),DA)
"^DD",445,445,.8,1,1,"%D",0)
^^2^2^2930503^
"^DD",445,445,.8,1,1,"%D",1,0)
This cross reference is used to store the abbreviated name (in X) by
"^DD",445,445,.8,1,1,"%D",2,0)
the station number (+^PRCP(445,DA,0)).
"^DD",445,445,.8,1,2,0)
445^CAB
"^DD",445,445,.8,1,2,1)
S ^PRCP(445,"CAB",$E(X,1,30),DA)=""
"^DD",445,445,.8,1,2,2)
K ^PRCP(445,"CAB",$E(X,1,30),DA)
"^DD",445,445,.8,1,2,"%D",0)
^^2^2^3140121^
"^DD",445,445,.8,1,2,"%D",1,0)
This index is to allow the Inventory Point lookup to search index 'CAB'
"^DD",445,445,.8,1,2,"%D",2,0)
for abbreviated name only (no attached site).
"^DD",445,445,.8,1,2,"DT")
3131031
"^DD",445,445,.8,3)
*MUST BE UNIQUE*  ANSWER MUST BE 1-6 CHARACTERS IN LENGTH.  (First character must be an upper-case alphabetic).  This field is used to Identify the Requesting Location for Nonrecurring Item Requests.
"^DD",445,445,.8,21,0)
^^3^3^2940715^^
"^DD",445,445,.8,21,1,0)
This is the abbreviated name of the inventory point.  The abbreviated name can
"^DD",445,445,.8,21,2,0)
be used when selecting an inventory point.  The name must be unique for the
"^DD",445,445,.8,21,3,0)
inventory point (two inventory points cannot have the same abbreviated name).
"^DD",445,445,.8,"DT")
3131031
"BLD",7551,6)
^159
**END**
**END**

