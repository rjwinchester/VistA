Released PRC*5.1*209 SEQ #185
Extracted from mail message
**KIDS**:PRC*5.1*209^

**INSTALL NAME**
PRC*5.1*209
"BLD",11329,0)
PRC*5.1*209^IFCAP^0^3190612^y
"BLD",11329,1,0)
^^6^6^3190110^
"BLD",11329,1,1,0)
1) If there is not a unique Appropriation Code for a Fund Control Point 
"BLD",11329,1,2,0)
(FCP) an error will be prompted warning that it is not unique. 
"BLD",11329,1,3,0)
 
"BLD",11329,1,4,0)
2) When an appropriation in a no-year fund has the incorrect value for 
"BLD",11329,1,5,0)
the Fiscal Year, it will prompt the user with an error saying it is the 
"BLD",11329,1,6,0)
wrong fiscal year.  
"BLD",11329,4,0)
^9.64PA^^
"BLD",11329,6.3)
3
"BLD",11329,"ABPKG")
n
"BLD",11329,"KRN",0)
^9.67PA^1.61^23
"BLD",11329,"KRN",.4,0)
.4
"BLD",11329,"KRN",.401,0)
.401
"BLD",11329,"KRN",.402,0)
.402
"BLD",11329,"KRN",.403,0)
.403
"BLD",11329,"KRN",.5,0)
.5
"BLD",11329,"KRN",.84,0)
.84
"BLD",11329,"KRN",1.6,0)
1.6
"BLD",11329,"KRN",1.61,0)
1.61
"BLD",11329,"KRN",1.62,0)
1.62
"BLD",11329,"KRN",3.6,0)
3.6
"BLD",11329,"KRN",3.8,0)
3.8
"BLD",11329,"KRN",9.2,0)
9.2
"BLD",11329,"KRN",9.8,0)
9.8
"BLD",11329,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",11329,"KRN",9.8,"NM",1,0)
PRCB1A^^0^B15962708
"BLD",11329,"KRN",9.8,"NM",2,0)
PRCSEB^^0^B32470054
"BLD",11329,"KRN",9.8,"NM",3,0)
PRCEN^^0^B60422957
"BLD",11329,"KRN",9.8,"NM","B","PRCB1A",1)

"BLD",11329,"KRN",9.8,"NM","B","PRCEN",3)

"BLD",11329,"KRN",9.8,"NM","B","PRCSEB",2)

"BLD",11329,"KRN",19,0)
19
"BLD",11329,"KRN",19.1,0)
19.1
"BLD",11329,"KRN",101,0)
101
"BLD",11329,"KRN",409.61,0)
409.61
"BLD",11329,"KRN",771,0)
771
"BLD",11329,"KRN",779.2,0)
779.2
"BLD",11329,"KRN",870,0)
870
"BLD",11329,"KRN",8989.51,0)
8989.51
"BLD",11329,"KRN",8989.52,0)
8989.52
"BLD",11329,"KRN",8994,0)
8994
"BLD",11329,"KRN","B",.4,.4)

"BLD",11329,"KRN","B",.401,.401)

"BLD",11329,"KRN","B",.402,.402)

"BLD",11329,"KRN","B",.403,.403)

"BLD",11329,"KRN","B",.5,.5)

"BLD",11329,"KRN","B",.84,.84)

"BLD",11329,"KRN","B",1.6,1.6)

"BLD",11329,"KRN","B",1.61,1.61)

"BLD",11329,"KRN","B",1.62,1.62)

"BLD",11329,"KRN","B",3.6,3.6)

"BLD",11329,"KRN","B",3.8,3.8)

"BLD",11329,"KRN","B",9.2,9.2)

"BLD",11329,"KRN","B",9.8,9.8)

"BLD",11329,"KRN","B",19,19)

"BLD",11329,"KRN","B",19.1,19.1)

"BLD",11329,"KRN","B",101,101)

"BLD",11329,"KRN","B",409.61,409.61)

"BLD",11329,"KRN","B",771,771)

"BLD",11329,"KRN","B",779.2,779.2)

"BLD",11329,"KRN","B",870,870)

"BLD",11329,"KRN","B",8989.51,8989.51)

"BLD",11329,"KRN","B",8989.52,8989.52)

"BLD",11329,"KRN","B",8994,8994)

"BLD",11329,"QDEF")
^^^^^^^^^^YES
"BLD",11329,"QUES",0)
^9.62^^
"BLD",11329,"REQB",0)
^9.611^1^1
"BLD",11329,"REQB",1,0)
PRC*5.1*204^1
"BLD",11329,"REQB","B","PRC*5.1*204",1)

"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1
"PKG",455,22,1,"PAH",1,0)
209^3190612
"PKG",455,22,1,"PAH",1,1,0)
^^6^6^3190612
"PKG",455,22,1,"PAH",1,1,1,0)
1) If there is not a unique Appropriation Code for a Fund Control Point 
"PKG",455,22,1,"PAH",1,1,2,0)
(FCP) an error will be prompted warning that it is not unique. 
"PKG",455,22,1,"PAH",1,1,3,0)
 
"PKG",455,22,1,"PAH",1,1,4,0)
2) When an appropriation in a no-year fund has the incorrect value for 
"PKG",455,22,1,"PAH",1,1,5,0)
the Fiscal Year, it will prompt the user with an error saying it is the 
"PKG",455,22,1,"PAH",1,1,6,0)
wrong fiscal year.  
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
3
"RTN","PRCB1A")
0^1^B15962708^B16038245
"RTN","PRCB1A",1,0)
PRCB1A ;WISC/PLT - CONTROL POINT ENTER/EDIT;12/10/97  1600
"RTN","PRCB1A",2,0)
V ;;5.1;IFCAP;**209**;Oct 20, 2000;Build 3
"RTN","PRCB1A",3,0)
 ;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCB1A",4,0)
 QUIT  ;invalid entry
"RTN","PRCB1A",5,0)
 ;
"RTN","PRCB1A",6,0)
EN N PRC,PRCDD,PRCDR,PRCDI,PRCRI,PRCPR,PRCAED,PRCQT,PRCU S PRCU="^"
"RTN","PRCB1A",7,0)
 N PRCK,PRCLOCK,PRCNO,PRCST,PRCUNQ
"RTN","PRCB1A",8,0)
 N DA,A,B,X,Y
"RTN","PRCB1A",9,0)
 N PRCUQ,PRCK1,PRCK26,PRCK28,PRCK29,PRCK25,PRCK25D5,PRCK27
"RTN","PRCB1A",10,0)
 N PRCF,PRCFA,PRCFUND,PRCBBFY,PRCRQ
"RTN","PRCB1A",11,0)
 S PRCF("X")="AS" D ^PRCFSITE G:$G(PRC("SITE"))="" EXIT
"RTN","PRCB1A",12,0)
 I '$D(^PRC(420,PRC("SITE"))) K X S X=PRC("SITE"),Y=""="" D ADD^PRC0B1(.X,.Y,"420;^PRC(420,",X) G:Y<0 EXIT
"RTN","PRCB1A",13,0)
 S PRCDD=420,PRCRI(420)=PRC("SITE"),PRCFA("ALL")=""
"RTN","PRCB1A",14,0)
 S PRCLOCK=$$DICGL^PRC0B1(PRCDD)_PRCRI(PRCDD)_",",Y=3 D ICLOCK^PRC0B(PRCLOCK,.Y)
"RTN","PRCB1A",15,0)
 I 'Y D EN^DDIOL("The station/fund control point data is in use, edit station data is not allowed.") G FCP
"RTN","PRCB1A",16,0)
 S PRCDR="2;3;10;11;3.1"
"RTN","PRCB1A",17,0)
 D EDIT^PRC0B(.X,PRCDD_";;"_PRCRI(PRCDD),PRCDR)
"RTN","PRCB1A",18,0)
 D DCLOCK^PRC0B(PRCLOCK)
"RTN","PRCB1A",19,0)
FCP F  D EN^DDIOL($TR($J("",78)," ","-")) D  Q:PRCQT=1
"RTN","PRCB1A",20,0)
 . N PRCDD,PRCAED,PRCDI,PRCLOCK1
"RTN","PRCB1A",21,0)
 . S PRCDD=420.01,PRCQT=""
"RTN","PRCB1A",22,0)
 . S X("S")="I ^(0)-9999"
"RTN","PRCB1A",23,0)
 . D LKUP Q:PRCQT
"RTN","PRCB1A",24,0)
 . S PRCLOCK1=PRCLOCK_"1,"_PRCRI(PRCDD)_",",Y=3 D ICLOCK^PRC0B(PRCLOCK1,.Y)
"RTN","PRCB1A",25,0)
 . I 'Y D EN^DDIOL("The station/selected fund control point data is in use, please try later!") QUIT
"RTN","PRCB1A",26,0)
 . S Y=$$NODE^PRC0B("^PRC(420,PRCRI(420),1,PRCRI(420.01),",0)
"RTN","PRCB1A",27,0)
 . S PRCST=$P(Y,PRCU,19),PRCNM=$P(Y,PRCU),PRCNO=$P(PRCNM," "),PRCNM=$P(PRCNM," ",2,999)
"RTN","PRCB1A",28,0)
 . D KEY1
"RTN","PRCB1A",29,0)
 . D REQ1^PRCB1A1
"RTN","PRCB1A",30,0)
 . D EDIT
"RTN","PRCB1A",31,0)
 . D TUSER^PRCSEB1(PRCRI(PRCDD))
"RTN","PRCB1A",32,0)
 . D DCLOCK^PRC0B(PRCLOCK1)
"RTN","PRCB1A",33,0)
 . QUIT
"RTN","PRCB1A",34,0)
EXIT QUIT
"RTN","PRCB1A",35,0)
 ;
"RTN","PRCB1A",36,0)
LKUP ;lookup prcdd=420.01
"RTN","PRCB1A",37,0)
 S PRCDI="420;^PRC(420,;"_PRCRI(420)_";1~420.01;^PRC(420,"_PRCRI(420)_",1,"
"RTN","PRCB1A",38,0)
 D LOOKUP^PRC0B(.X,.Y,PRCDI,"AEOQLS","Select Fund Control Point: ")
"RTN","PRCB1A",39,0)
 I Y<0!(X="") S PRCQT=1 K X QUIT
"RTN","PRCB1A",40,0)
 K X S PRCRI(PRCDD)=+Y,PRCAED=$P(Y,"^",3)
"RTN","PRCB1A",41,0)
 S PRCDI="420;^PRC(420,;"_PRCRI(420)_"~420.01;^PRC(420,"_PRCRI(420)_",1,;"_PRCRI(420.01)
"RTN","PRCB1A",42,0)
 QUIT
"RTN","PRCB1A",43,0)
 ;
"RTN","PRCB1A",44,0)
EDIT ;edit prcdd=420.01
"RTN","PRCB1A",45,0)
 I PRCST=1 D  Q:PRCQT
"RTN","PRCB1A",46,0)
 . D EDIT^PRC0B(.X,PRCDI,"20Active/Inactive Control Point","") I X=0 S PRCQT=2
"RTN","PRCB1A",47,0)
 . K A D PIECE^PRC0B(PRCDI,"1~20","I","A")
"RTN","PRCB1A",48,0)
 . S X=$G(A(PRCDD,PRCRI(PRCDD),20,"I")) K A
"RTN","PRCB1A",49,0)
 . S X=$S(X=1:"23////^S X=DUZ;24///NOW",1:"23///^S X=""@"";24///^S X=""@""")
"RTN","PRCB1A",50,0)
 . D EDIT^PRC0B(.X,PRCDI,X)
"RTN","PRCB1A",51,0)
 D FT^PRC0A(.X,.Y,"Control Point Name","^1:25^K:X'?1AN.ANP X",PRCNM)
"RTN","PRCB1A",52,0)
 I X?1"^".E S:PRCAED'=1 PRCQT=99 D:PRCAED=1 DELQ^PRCB1A1 Q:PRCQT  G EDIT
"RTN","PRCB1A",53,0)
 I X]"",X'=PRCNM S PRCNM=X,X=".01///"_PRCNO_" "_PRCNM D EDIT^PRC0B(.X,PRCDI,X)
"RTN","PRCB1A",54,0)
 S C=""
"RTN","PRCB1A",55,0)
 G ED0^PRCB1A1
"RTN","PRCB1A",56,0)
 ;
"RTN","PRCB1A",57,0)
KEY ;initial key values/func code/bbfy
"RTN","PRCB1A",58,0)
 S:$D(DA(1)) PRCRI(420)=DA(1) S:$D(DA) PRCRI(420.01)=DA
"RTN","PRCB1A",59,0)
KEY1 F I=1,26,27,28,29 S @("PRCK"_I_"=""""")
"RTN","PRCB1A",60,0)
 S PRCK25D5=""
"RTN","PRCB1A",61,0)
 QUIT:'PRCRI(420)!'PRCRI(420.01)
"RTN","PRCB1A",62,0)
 S A=$G(^PRC(420,PRCRI(420),1,PRCRI(420.01),0)),PRCK1=$P(A,"^",2)
"RTN","PRCB1A",63,0)
 S A=$G(^PRC(420,PRCRI(420),1,PRCRI(420.01),5))
"RTN","PRCB1A",64,0)
 S PRCK25D5=$P(A,"^",5),PRCK26=$P(A,"^",2),PRCK27=$P(A,"^",3)
"RTN","PRCB1A",65,0)
 S PRCK28=$P(A,"^",4),PRCK29=$P(A,"^",6)
"RTN","PRCB1A",66,0)
 F I=26,27,28,29 I @("PRCK"_I_"=""""") S @("PRCK"_I_"="" """)
"RTN","PRCB1A",67,0)
 S:PRCK25D5="" PRCK25D5=" "
"RTN","PRCB1A",68,0)
 QUIT
"RTN","PRCB1A",69,0)
 ;
"RTN","PRCB1A",70,0)
UNQCHK(PRCK1,PRCK25D5,PRCK26,PRCK27,PRCK28,PRCK29) ;check uniqueness - modified in PRC*5.1*209 to check for multiple uniqueness
"RTN","PRCB1A",71,0)
 S PRCUNQ="",PRCUQ=0
"RTN","PRCB1A",72,0)
 F  S PRCUQ=$O(^PRC(420,PRCRI(420),1,"UNQ",$G(PRCK1),$G(PRCK25D5),$G(PRCK26),$G(PRCK27),$G(PRCK28),$G(PRCK29),PRCUQ)) I (PRCUQ-PRCRI(420.01)=0)!(PRCUQ="") Q
"RTN","PRCB1A",73,0)
 I PRCUQ="" S PRCUQ=PRCRI(420.01) D UNQMES^PRCB1A1
"RTN","PRCB1A",74,0)
 QUIT
"RTN","PRCB1A",75,0)
 ;
"RTN","PRCB1A",76,0)
UNQCRS ;set unique cross reference
"RTN","PRCB1A",77,0)
 S PRCK=","_$G(PRCK1)_","""_$G(PRCK25D5)_""","""_$G(PRCK26)_""","""_$G(PRCK27)_""","""_$G(PRCK28)_""","""_$G(PRCK29)_""","
"RTN","PRCB1A",78,0)
 I PRCK'[",," S @("^PRC(420,PRCRI(420),1,""UNQ"""_PRCK_"DA)=""""")
"RTN","PRCB1A",79,0)
 QUIT
"RTN","PRCB1A",80,0)
 ;
"RTN","PRCB1A",81,0)
UNQCRK ;kill unique cross reference
"RTN","PRCB1A",82,0)
 S PRCK=","_$G(PRCK1)_","""_$G(PRCK25D5)_""","""_$G(PRCK26)_""","""_$G(PRCK27)_""","""_$G(PRCK28)_""","""_$G(PRCK29)_""","
"RTN","PRCB1A",83,0)
 I PRCK'[",," K @("^PRC(420,PRCRI(420),1,""UNQ"""_PRCK_"DA)")
"RTN","PRCB1A",84,0)
 QUIT
"RTN","PRCB1A",85,0)
 ;
"RTN","PRCB1A",86,0)
DINU ;call from ^dd(420.01,.01)
"RTN","PRCB1A",87,0)
 S DINUM=+X
"RTN","PRCB1A",88,0)
 QUIT
"RTN","PRCB1A",89,0)
 ;
"RTN","PRCEN")
0^3^B60422957^B58083507
"RTN","PRCEN",1,0)
PRCEN ;WISC/CLH - ENTER/EDIT 1358 ;9/2/2010
"RTN","PRCEN",2,0)
V ;;5.1;IFCAP;**23,148,150,196,204,209**;Oct 20, 2000;Build 3
"RTN","PRCEN",3,0)
 ;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCEN",4,0)
 ;
"RTN","PRCEN",5,0)
 ;PRC*5.1*150 RGB 4/23/12  Control the node 0 counter for file 410
"RTN","PRCEN",6,0)
 ;kill call since DIK call does not handle descending file logic
"RTN","PRCEN",7,0)
 ;
"RTN","PRCEN",8,0)
 ;PRC*5.1*196 Check Committed Date for 1358 against FY requested
"RTN","PRCEN",9,0)
 ;            to insure date is within the FY range.
"RTN","PRCEN",10,0)
 ;
"RTN","PRCEN",11,0)
EN ;new 1358 request
"RTN","PRCEN",12,0)
 N PRC,X,X1,DIC,DIE,DR,PRCS2,PRCSL,PRCSIP,DIR,DIRUT,PRCS,PRCSCP,PRCSN
"RTN","PRCEN",13,0)
 N PRCST,PRCST1,PRCSTT,PRC410,PRCUA,PRCAUTH,PRCAUTHS,PRCQ,PRCVEN,PRCONT
"RTN","PRCEN",14,0)
EN0 K PRC,X,X1,DIC,DIE,DR,PRCS2,PRCSL,PRCSIP,DIR,DIRUT,PRCS,PRCSCP,PRCSN
"RTN","PRCEN",15,0)
 K PRCST,PRCST1,PRCSTT,PRCAED,PRC410,PRCUA,PRCAUTHS
"RTN","PRCEN",16,0)
 D EN^PRCSUT I '$D(PRC("SITE")) W !!,"You are not an authorized control point user.",!,"Contact your control point official." H 3 Q
"RTN","PRCEN",17,0)
 Q:'$D(PRC("QTR"))!(Y<0)
"RTN","PRCEN",18,0)
 ;
"RTN","PRCEN",19,0)
 ; warn CP official, allow to quit
"RTN","PRCEN",20,0)
 Q:$$Q1358(PRC("SITE"),PRC("CP"))
"RTN","PRCEN",21,0)
 ;
"RTN","PRCEN",22,0)
 ; ask for 1358 Authority (need to preserve variables)
"RTN","PRCEN",23,0)
 S PRCQ=0 D
"RTN","PRCEN",24,0)
 . N X,Y,DTOUT,DUOUT,DIC
"RTN","PRCEN",25,0)
 . S DIC="^PRCS(410.9,",DIC(0)="AEMQ",DIC("S")="I Y<100,('$P(^(0),U,4)!($P(^(0),U,4)>DT))",DIC("A")="Select AUTHORITY OF REQUEST: " D ^DIC S PRCAUTH=+Y I Y<1 S PRCQ=1 Q
"RTN","PRCEN",26,0)
 . I $D(^PRCS(410.9,"AC",PRCAUTH)) S DIC("S")="I $P(^(0),U,3)=PRCAUTH,('$P(^(0),U,4)!($P(^(0),U,4)>DT))",DIC("A")="Select SUB-AUTHORITY OF REQUEST: " D ^DIC S PRCAUTHS=+Y I Y<1 S PRCQ=1
"RTN","PRCEN",27,0)
 Q:PRCQ
"RTN","PRCEN",28,0)
 D EN1^PRCSUT3 Q:'X
"RTN","PRCEN",29,0)
 S X1=X D EN2^PRCSUT3 Q:'$D(X1)  S X=X1 W !!,"This transaction is assigned Transaction number: ",X
"RTN","PRCEN",30,0)
 S PRC410=DA
"RTN","PRCEN",31,0)
 D  G:'$D(DA) EN0
"RTN","PRCEN",32,0)
 . L +^PRCS(410,DA):$S($D(DILOCKTM):DILOCKTM,1:3)
"RTN","PRCEN",33,0)
 . E  D EN^DDIOL("Transaction is being accessed by another user!") K DA
"RTN","PRCEN",34,0)
 . Q
"RTN","PRCEN",35,0)
 I $D(^PRC(420,PRC("SITE"),1,+PRC("CP"),0)) S:$P(^(0),"^",11)="Y" PRCS2=1
"RTN","PRCEN",36,0)
 S DIC(0)="AEMQ",DIE=DIC,DR="3///1"_$S($D(PRCSIP):";4////"_PRCSIP,1:"")_";19////^S X=PRCAUTH"_$S($G(PRCAUTHS):";19.1////^S X=PRCAUTHS",1:""),X4=1 D ^DIE
"RTN","PRCEN",37,0)
 S PRCAED=1,PRCUA=""
"RTN","PRCEN",38,0)
 ; define if fields need to be required or not
"RTN","PRCEN",39,0)
 S PRCVEN=^PRCS(410.9,$S($G(PRCAUTHS):PRCAUTHS,1:PRCAUTH),0),PRCONT=$P(PRCVEN,"^",6),PRCVEN=$P(PRCVEN,"^",5)
"RTN","PRCEN",40,0)
 S DR="[PRCE NEW 1358]" D ^DIE
"RTN","PRCEN",41,0)
 I $D(Y)#10 S PRCUA=1 D YN^PRC0A(.X,.Y,"Delete this NEW entry","","No") I Y=1 D
"RTN","PRCEN",42,0)
 . S PRCIENCT=$P(^PRCS(410,0),"^",3)+1      ;PRC*5.1*150
"RTN","PRCEN",43,0)
 . D DELETE^PRC0B1(.X,"410;^PRCS(410,;"_DA) S:X=1 PRCAED=-1
"RTN","PRCEN",44,0)
 . I X=1 S $P(^PRCS(410,0),"^",3)=PRCIENCT     ;PRC*5.1*150
"RTN","PRCEN",45,0)
 . K PRCIENCT     ;PRC*5.1*150
"RTN","PRCEN",46,0)
 . D EN^DDIOL(" **** NEW ENTRY IS "_$S(X=1:"",1:"NOT ")_"DELETED ****")
"RTN","PRCEN",47,0)
 . QUIT
"RTN","PRCEN",48,0)
 I PRCAED'=-1 D
"RTN","PRCEN",49,0)
 . D:$O(^PRCS(410,DA,12,0)) SCPC0^PRCSED
"RTN","PRCEN",50,0)
 . K PRCSF
"RTN","PRCEN",51,0)
 . D W1^PRCSEB
"RTN","PRCEN",52,0)
 . I $D(PRCS2),+^PRCS(410,DA,0),'PRCUA,$$CHECK(PRC410) D
"RTN","PRCEN",53,0)
 .. D W6^PRCSEB
"RTN","PRCEN",54,0)
 .. Q
"RTN","PRCEN",55,0)
 . Q
"RTN","PRCEN",56,0)
 L -^PRCS(410,PRC410)
"RTN","PRCEN",57,0)
 S DIR("B")="NO",DIR(0)="Y",DIR("A")="Do you want to enter another NEW request" D ^DIR Q:'Y!($D(DIRUT))
"RTN","PRCEN",58,0)
 W !! K PRCS2 G EN0
"RTN","PRCEN",59,0)
 Q
"RTN","PRCEN",60,0)
ED ;edit 1358
"RTN","PRCEN",61,0)
 N PRC410,PRC442,PRCHQ,PRCSDR,PRCSN,PRCST,PRCST1,Y,PRC,PRCS,TT,DIE,DA,DIC
"RTN","PRCEN",62,0)
 N DR,DIR,PRCSY,PRCSL,X,X1,T,T1,Z,PRCSDA,DTOUT,PRCVEN,PRCONT
"RTN","PRCEN",63,0)
ED0 K PRCHQ,PRCSDR,PRCSN,PRCST,PRCST1,Y,PRC,PRCS,TT,DIE,DA,DIC,DR,DIR,PRCSY
"RTN","PRCEN",64,0)
 K PRCSL,X,X1,T,T1,Z,PRCSDA
"RTN","PRCEN",65,0)
 D EN3^PRCSUT I '$D(PRC("SITE")) W !!,"You are not an authorized control point user.",!,"Contact your control point official." H 3 Q
"RTN","PRCEN",66,0)
 Q:Y<0
"RTN","PRCEN",67,0)
 S DIC="^PRCS(410,",DIE=DIC,DIC(0)="AEQM",DIC("S")="I $P(^(0),U,4)=1,+$P(^(0),U)'=0,$D(^(3)),+^(3)=+PRC(""CP""),$P(^(0),""^"",5)=PRC(""SITE"") I $D(^PRC(420,""A"",DUZ,PRC(""SITE""),+PRC(""CP""),1))!($D(^(2)))"
"RTN","PRCEN",68,0)
 D ^PRCSDIC Q:Y<0  K DIC("S") S (DA,PRCSY,PRCSDA)=+Y ;D LOCK^PRCSUT G ED0:PRCSL=0
"RTN","PRCEN",69,0)
 D  G:'$D(DA) ED0
"RTN","PRCEN",70,0)
 . L +^PRCS(410,DA):$S($D(DILOCKTM):DILOCKTM,1:3)
"RTN","PRCEN",71,0)
 . E  D EN^DDIOL("Another user is editing this transaction! Try Later") K DA
"RTN","PRCEN",72,0)
 . Q
"RTN","PRCEN",73,0)
 D NODE^PRCS58OB(DA,.TRNODE) S PRC410=DA
"RTN","PRCEN",74,0)
 S X=^PRCS(410,DA,0) S:+X PRC("FY")=$P(X,"-",2),PRC("QTR")=+$P(X,"-",3),TT=$P(X,"^",2)
"RTN","PRCEN",75,0)
 D EN2B^PRCSUT3
"RTN","PRCEN",76,0)
 I $D(^PRCS(410,DA,7)),$P(^(7),U,6)]"" D SCPE G OUT ;if obligated
"RTN","PRCEN",77,0)
ED1 I TT="CA" S DR="[PRCSENCT]",DIE=DIC D ^DIE S DA=PRCSY L -^PRCS(410,PRCSY) G ED0
"RTN","PRCEN",78,0)
 ; warn CP offical and allow to quit
"RTN","PRCEN",79,0)
 I $$Q1358(PRC("SITE"),PRC("CP"),$G(TT),$G(DA)) L -^PRCS(410,PRCSY) G ED0
"RTN","PRCEN",80,0)
 ;
"RTN","PRCEN",81,0)
 ;  patch 23, fix problem of not able to exit with "^"
"RTN","PRCEN",82,0)
 I TT'="O" S DR="[PRCSENA 1358]" S DIE=DIC D ^DIE L:$D(Y)>9 -^PRCS(410,PRCSY) G:$D(Y)>9 ED0 S DA=PRCSY
"RTN","PRCEN",83,0)
 I TT="A" S PRC442=$P($G(^PRCS(410,PRC410,10)),U,3) I PRC442 G:$$EN1^PRCE0A(PRC410,PRC442,1) ED1
"RTN","PRCEN",84,0)
 I TT="A",$P(^PRCS(410,DA,0),U,4)=1 S X=$P(^(4),U,6),X1=$P(^(3),U,7) I $J(X,0,2)'=$J(X1,0,2)!('X)!('X1) W $C(7),!,"Adj $ Amt does not equal the total of BOC $ Amts.",!,"Please correct the error.",! K DR G ED1
"RTN","PRCEN",85,0)
 D:TT="A"&($O(^PRCS(410,PRCSY,12,0))) SCPC0^PRCSED
"RTN","PRCEN",86,0)
 I TT="A" D REV D:$$CHECK(PRC410) W6^PRCSEB G OUT
"RTN","PRCEN",87,0)
 ;
"RTN","PRCEN",88,0)
 S DR="[PRCE NEW 1358]" D ^DIE,REV D:$$CHECK(PRC410) W6^PRCSEB
"RTN","PRCEN",89,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Do you want to edit another request" D ^DIR G OUT:'Y!($D(DIRUT))
"RTN","PRCEN",90,0)
 L -^PRCS(410,PRCSDA)
"RTN","PRCEN",91,0)
 G ED0
"RTN","PRCEN",92,0)
SCPE ;sub control point edit
"RTN","PRCEN",93,0)
 S DR="[PRCSEDS]" D ^DIE
"RTN","PRCEN",94,0)
REV W !!,"Would you like to review this request" S %=2 D YN^DICN G REV:%=0 Q:%'=1  S (N,PRCSZ)=DA,PRCSF=1 D PRF1^PRCSP1 S DA=PRCSZ K X,PRCSF,PRCSZ Q
"RTN","PRCEN",95,0)
OUT L -^PRCS(410,PRCSDA) Q
"RTN","PRCEN",96,0)
 ;
"RTN","PRCEN",97,0)
CHECK(PRC410) ; - Check out a 1358 410 entry for required fields
"RTN","PRCEN",98,0)
 N PRCX,PRC0,PRC11,PRCER,PRC3,PRC1
"RTN","PRCEN",99,0)
 Q:'$G(PRC410) -1
"RTN","PRCEN",100,0)
 ;
"RTN","PRCEN",101,0)
 ; get data
"RTN","PRCEN",102,0)
 F PRCX=0,1,3,11 S @("PRC"_PRCX)=$G(^PRCS(410,PRC410,PRCX))
"RTN","PRCEN",103,0)
 S PRCX=$G(^PRCS(410.9,$S(+$P(PRC11,"^",5):+$P(PRC11,"^",5),1:+$P(PRC11,"^",4)),0))
"RTN","PRCEN",104,0)
 S PRCER=0
"RTN","PRCEN",105,0)
 ;
"RTN","PRCEN",106,0)
 ; make sure I have a 1358
"RTN","PRCEN",107,0)
 I $P(PRC0,"^",4)'=1 Q 1
"RTN","PRCEN",108,0)
 ;
"RTN","PRCEN",109,0)
 ; start checking out data
"RTN","PRCEN",110,0)
 I '$D(^PRCS(410,PRC410,8,1,0)) D CKER("PURPOSE is Missing")
"RTN","PRCEN",111,0)
 ;
"RTN","PRCEN",112,0)
 ; done checking if not an obligation
"RTN","PRCEN",113,0)
 I $P(PRC0,"^",2)'="O" G CKEX
"RTN","PRCEN",114,0)
 ;
"RTN","PRCEN",115,0)
 ; continue checking
"RTN","PRCEN",116,0)
 I '$P(PRC11,"^",4) D CKER("AUTHORITY is Missing")
"RTN","PRCEN",117,0)
 I $P(PRC11,"^",5),'$D(^PRCS(410.9,"AC",$P(PRC11,"^",4),$P(PRC11,"^",5))) D CKER("SUB-AUTHORITY does not correspond to AUTHORITY")
"RTN","PRCEN",118,0)
 I '$P(PRC11,"^",5),$O(^PRCS(410.9,"AC",+$P(PRC11,"^",4),0)) D CKER("SUB-AUTHORITY is Missing")
"RTN","PRCEN",119,0)
 I $P(PRCX,"^",5),'$P(PRC3,"^",4) D CKER("VENDOR is Missing")
"RTN","PRCEN",120,0)
 I $P(PRCX,"^",6),'$L($P(PRC3,"^",10)) D CKER("CONTRACT is Missing")
"RTN","PRCEN",121,0)
 I '$P(PRC1,"^",6) D CKER("Service Start Date is Missing")
"RTN","PRCEN",122,0)
 I '$P(PRC1,"^",7) D CKER("Service End Date is Missing")
"RTN","PRCEN",123,0)
 ;
"RTN","PRCEN",124,0)
CKEX I PRCER S PRCER=0 F  S PRCER=$O(PRCER(PRCER)) Q:'PRCER  W !?5,PRCER(PRCER),"!!!"
"RTN","PRCEN",125,0)
 Q $S($O(PRCER(0)):0,1:1)
"RTN","PRCEN",126,0)
 ;
"RTN","PRCEN",127,0)
CKER(X) ;
"RTN","PRCEN",128,0)
 S PRCER=PRCER+1
"RTN","PRCEN",129,0)
 S PRCER(PRCER)=X
"RTN","PRCEN",130,0)
 Q
"RTN","PRCEN",131,0)
 ;
"RTN","PRCEN",132,0)
Q1358(PRCSTA,PRCFCP,PRCTT,PRCDA) ; Quit 1358 Process
"RTN","PRCEN",133,0)
 ; This API warns a control point offical that they will be set as
"RTN","PRCEN",134,0)
 ; the requestor on the 1358 and thus cannot also approve it.
"RTN","PRCEN",135,0)
 ; The API will return 1 (true) if the user decided to quit the
"RTN","PRCEN",136,0)
 ; current process before being set as the requestor.
"RTN","PRCEN",137,0)
 ;
"RTN","PRCEN",138,0)
 ; inputs
"RTN","PRCEN",139,0)
 ;   PRCSTA - station number
"RTN","PRCEN",140,0)
 ;   PRCFCP - fund control point
"RTN","PRCEN",141,0)
 ;   PRCTT  - (optional) transaction type, pass "A" for adjustment
"RTN","PRCEN",142,0)
 ;   PRCDA  - (optional) file 410 ien of 1358 when editing 1358
"RTN","PRCEN",143,0)
 ; returns boolean value (0 or 1)
"RTN","PRCEN",144,0)
 ;   = 0 to proceed with process
"RTN","PRCEN",145,0)
 ;   = 1 to quit process
"RTN","PRCEN",146,0)
 ;
"RTN","PRCEN",147,0)
 N RET
"RTN","PRCEN",148,0)
 S RET=0 ; init value to return
"RTN","PRCEN",149,0)
 ;
"RTN","PRCEN",150,0)
 ; if user is control point official for input station and FCP
"RTN","PRCEN",151,0)
 I $G(PRCSTA)]"",$G(PRCFCP)]"",$D(^PRC(420,"A",DUZ,PRCSTA,+PRCFCP,1)) D
"RTN","PRCEN",152,0)
 . N DA,DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","PRCEN",153,0)
 . ;
"RTN","PRCEN",154,0)
 . ; don't warn when editing a 1358 if user is already the requestor
"RTN","PRCEN",155,0)
 . I $G(PRCDA),$P($G(^PRCS(410,PRCDA,7)),"^")=DUZ Q
"RTN","PRCEN",156,0)
 . ;
"RTN","PRCEN",157,0)
 . I $G(PRCTT)'="A" D
"RTN","PRCEN",158,0)
 . . W !,"WARNING: The system will assign you as the CP Clerk (Requestor) of this 1358."
"RTN","PRCEN",159,0)
 . . W !,"You will be unable to approve a 1358 on which you are the REQUESTOR due to"
"RTN","PRCEN",160,0)
 . . W !,"segregation of duties."
"RTN","PRCEN",161,0)
 . I $G(PRCTT)="A" D
"RTN","PRCEN",162,0)
 . . W !,"WARNING: The system will assign you as the CP Clerk (Requestor) of this 1358"
"RTN","PRCEN",163,0)
 . . W !,"Adjustment.  You will be unable to approve a 1358 Adjustment on which you"
"RTN","PRCEN",164,0)
 . . W !,"are the REQUESTOR due to segregation of duties."
"RTN","PRCEN",165,0)
 . ;
"RTN","PRCEN",166,0)
 . S DIR(0)="Y",DIR("A")="Do you want to proceed (Y/N)",DIR("B")="NO"
"RTN","PRCEN",167,0)
 . D ^DIR K DIR I $D(DIRUT)!'Y S RET=1
"RTN","PRCEN",168,0)
 . W !
"RTN","PRCEN",169,0)
 ;
"RTN","PRCEN",170,0)
 Q RET
"RTN","PRCEN",171,0)
COMCHK ;Check Committed Date to insure it is within the FY/FQ range during option entry for 'NEW 1358'    ;PRC*5.1*196
"RTN","PRCEN",172,0)
 N PRCDT,PRCDT1,PRCTAPPR
"RTN","PRCEN",173,0)
 S PRCTAPPR=$P($G(^PRC(420,PRC("SITE"),1,+PRC("CP"),4,+PRC("FY"),2)),"^",9) ;PRC*5.1*209 use appropriation code from node 4, check both X and x
"RTN","PRCEN",174,0)
 I $G(PRCBBMY) S PRCCKERR=0 Q
"RTN","PRCEN",175,0)
 I '$D(PRC("BBFY"))!(+$P(^PRC(420,PRC("SITE"),1,+PRC("CP"),0),"^",12)>0)!(PRCTAPPR["X")!(PRCTAPPR["x") S PRC("BBFY")=PRC("FY")+2000
"RTN","PRCEN",176,0)
 S PRCCKERR=0,PRCDT=(PRC("BBFY")-1701)_$P("10:01:04:07",":",PRC("QTR"))_"01",PRCDT1=(PRC("BBFY")-1700)_"0930"
"RTN","PRCEN",177,0)
 I PRCCOMDT<PRCDT!(PRCCOMDT>PRCDT1) D
"RTN","PRCEN",178,0)
 . S PRCCKERR=1
"RTN","PRCEN",179,0)
 . W !!," ** Date Committed must be specified for time **",!," ** period covered by fiscal year ",PRC("BBFY"),"        **",!
"RTN","PRCEN",180,0)
 Q
"RTN","PRCSEB")
0^2^B32470054^B30999928
"RTN","PRCSEB",1,0)
PRCSEB ;SF-ISC/LJP/SAW/DXH/DAP - CPA EDITS CON'T ;7.26.99
"RTN","PRCSEB",2,0)
V ;;5.1;IFCAP;**81,174,184,196,204,209**;Oct 20, 2000;Build 3
"RTN","PRCSEB",3,0)
 ;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCSEB",4,0)
 ;
"RTN","PRCSEB",5,0)
 ;PRC*5.1*184  Check for error message indicating no 2237 seq nos.
"RTN","PRCSEB",6,0)
 ;             remaining to be used out of the max 9999 available
"RTN","PRCSEB",7,0)
 ;             for FCP FY-FQ.
"RTN","PRCSEB",8,0)
 ;
"RTN","PRCSEB",9,0)
 ;PRC*5.1*196  Check to move Date Required to Committed Date (MOP= 2,3 or 4)
"RTN","PRCSEB",10,0)
 ;             to insure a later date is used for FMS document. Also,
"RTN","PRCSEB",11,0)
 ;             added date check called from templates PRCSENR&NR1,
"RTN","PRCSEB",12,0)
 ;             PRCSEN2237B & PRCSENPR to insure dates are in same 
"RTN","PRCSEB",13,0)
 ;             FY/FQ defined.
"RTN","PRCSEB",14,0)
 ;
"RTN","PRCSEB",15,0)
ENRB ;ENTER CP CLERK REQUEST FROM OPTION PRCSENRB
"RTN","PRCSEB",16,0)
 K PRCBBMY
"RTN","PRCSEB",17,0)
 D ENF^PRCSUT(1) G W2:'$D(PRC("SITE")) G EXIT:'$D(PRC("QTR"))!(Y<0)
"RTN","PRCSEB",18,0)
 S MSG="" D EN1^PRCSUT3 Q:'X  I MSG'="" W !!,MSG,! S DIR(0)="EAO",DIR("A")="Press <Enter> to exit processing..." D ^DIR K DIR,MSG Q      ;PRC*5.1*184
"RTN","PRCSEB",19,0)
 K MSG        ;PRC*5.1*184
"RTN","PRCSEB",20,0)
 S PRCSX1=X D EN2^PRCSUT3 Q:'$D(PRCSX1)  S X=PRCSX1,T1=DA  D W L +^PRCS(410,DA):15 G ENRB:$T=0 I $D(^PRC(420,PRC("SITE"),1,+PRC("CP"),0)) S:$P(^(0),"^",11)="Y" PRCS2=1
"RTN","PRCSEB",21,0)
 ;
"RTN","PRCSEB",22,0)
 ;*81 Check site parameter to see if issue books should be allowed
"RTN","PRCSEB",23,0)
 D CKPRM
"RTN","PRCSEB",24,0)
 W !!,PRCVY,!!
"RTN","PRCSEB",25,0)
TYPE ;
"RTN","PRCSEB",26,0)
 S PRCDAA=DA,DIC="^PRCS(410.5,",DIC(0)="AEQZ",DIC("A")="FORM TYPE: ",DIC("S")=PRCVX D ^DIC S TYPE=+Y,DA=PRCDAA
"RTN","PRCSEB",27,0)
 I TYPE<2 W "??    EXIT NOT ALLOWED" G TYPE
"RTN","PRCSEB",28,0)
 K PRCVX,PRCVY
"RTN","PRCSEB",29,0)
 S $P(^PRCS(410,DA,0),"^",4)=TYPE S:$G(PRCSIP) $P(^PRCS(410,DA,0),"^",6)=PRCSIP S (DIE,DIC)="^PRCS(410,",X=TYPE
"RTN","PRCSEB",30,0)
 ;NOTE THAT THE FOLLOWING LINE OVERWRITES THE USER'S SELECTION OF FORM
"RTN","PRCSEB",31,0)
 ;TYPE IF THE FUND CONTROL POINT IS NOT 'AUTOMATED'
"RTN","PRCSEB",32,0)
 S:'$D(PRCS2)&(X>2) $P(^PRCS(410,DA,0),"^",4)=2,X=2
"RTN","PRCSEB",33,0)
 S PRCSTYP=X     ;PRC*5.1*196
"RTN","PRCSEB",34,0)
 S (PRCSDR,DR)="["_$S(X=2:"PRCSEN2237B",X=3:"PRCSENPR",X=4:"PRCSENR&NR",1:"PRCSENIB")_"]"
"RTN","PRCSEB",35,0)
EN1 K DTOUT,DUOUT,Y S PRCSDAA=DA D ^DIE I $D(Y)!($D(DTOUT)) S DA=PRCSDAA L -^PRCS(410,DA) G EXIT
"RTN","PRCSEB",36,0)
 S DA=PRCSDAA D RL^PRCSUT1
"RTN","PRCSEB",37,0)
COMDT I PRCSTYP>1,PRCSTYP<5,$P($G(^PRCS(410,DA,4)),U,2)="" D          ;PRC*5.1*196, PRC*5.1*204 protect global with $G
"RTN","PRCSEB",38,0)
 . S PRCOMDT=$S($P(^PRCS(410,DA,1),U,4)'=DT:$P(^PRCS(410,DA,1),U,4),1:DT)
"RTN","PRCSEB",39,0)
 . S DR="21///^S X=PRCOMDT",DIE="^PRCS(410," D ^DIE
"RTN","PRCSEB",40,0)
 . S DR=$G(PRCSDR) ;reset DR to template value, PRC*5.1*204
"RTN","PRCSEB",41,0)
 D ^PRCSCK I $D(PRCSERR),PRCSERR G EN1
"RTN","PRCSEB",42,0)
 K PRCSERR
"RTN","PRCSEB",43,0)
 I PRCSDR="[PRCSENCOD]" D W7^PRCSEB0 D:$D(PRCSOB) ENOD1^PRCSEB1 K PRCSOB
"RTN","PRCSEB",44,0)
 S:$P($G(^PRCS(410,DA,7)),"^")="" $P(^PRCS(410,DA,7),"^")=DUZ
"RTN","PRCSEB",45,0)
 D:PRCSDR'="[PRCSENCOD]" W1 I $D(PRCS2),+^PRCS(410,DA,0) D W6
"RTN","PRCSEB",46,0)
 S DA=PRCSDAA L -^PRCS(410,DA) D W3 G EXIT:%'=1 W !! K PRCS,PRCS2
"RTN","PRCSEB",47,0)
 G ENRB
"RTN","PRCSEB",48,0)
W W !!,"This transaction is assigned transaction number: ",X Q
"RTN","PRCSEB",49,0)
W1 W !!,"Would you like to review this request" S %=2 D YN^DICN G W1:%=0 Q:%'=1  S (N,PRCSZ)=DA,PRCSF=1 D PRF1^PRCSP1 S DA=PRCSZ K X,PRCSF,PRCSZ Q
"RTN","PRCSEB",50,0)
W2 W !!,"You are not an authorized control point user.",!,"Contact your control point official." R X:5 G EXIT
"RTN","PRCSEB",51,0)
W3 W !!,"Would you like to enter another request" S %=1 D YN^DICN G W3:%=0 Q
"RTN","PRCSEB",52,0)
W5 S:'$D(^PRCS(410,DA,11)) ^(11)="" S $P(^(11),U,3)="" K ^PRCS(410,"F",PRC("SITE")_"-"_+PRC("CP")_"-"_$P($P(^PRCS(410,DA,0),U),"-",5),DA),^PRCS(410,"F1",$P($P(^PRCS(410,DA,0),U),"-",5)_"-"_PRC("SITE")_"-"_+PRC("CP"),DA),^PRCS(410,"AQ",1,DA) Q
"RTN","PRCSEB",53,0)
W51 S:'$D(^PRCS(410,DA,11)) ^(11)="" S $P(^(11),U,3)=1,(^PRCS(410,"F",PRC("SITE")_"-"_+PRC("CP")_"-"_$P($P(^PRCS(410,DA,0),U),"-",5),DA),^PRCS(410,"F1",$P($P(^PRCS(410,DA,0),U),"-",5)_"-"_PRC("SITE")_"-"_+PRC("CP"),DA),^PRCS(410,"AQ",1,DA))="" Q
"RTN","PRCSEB",54,0)
W6 N JUMP,SKIPRNT,OK,TEST,TEST1,CURQTR,CURQTR1
"RTN","PRCSEB",55,0)
W61 ;
"RTN","PRCSEB",56,0)
 N REPORT2 I $P($G(^PRC(420,PRC("SITE"),1,+PRC("CP"),1,DUZ,0)),"^",2)'=1 S REPORT2=1 D T1^PRCSAPP1
"RTN","PRCSEB",57,0)
 ;*****PRC*5.1*174 start*****
"RTN","PRCSEB",58,0)
 ;if Level of Access is not Control Point Official DO block
"RTN","PRCSEB",59,0)
 I $P($G(^PRC(420,PRC("SITE"),1,+PRC("CP"),1,DUZ,0)),"^",2)'=1 D  Q
"RTN","PRCSEB",60,0)
 . N PRCFTYPE S PRCFTYPE=+$$GET1^DIQ(410,$G(DA)_",",3,"I") ;Form Type
"RTN","PRCSEB",61,0)
 . S %=1
"RTN","PRCSEB",62,0)
 . ;if request is a 2237 (Form Type IEN 2,3, or 4)
"RTN","PRCSEB",63,0)
 . I $G(PRCFTYPE)>1&($G(PRCFTYPE)<5) D
"RTN","PRCSEB",64,0)
 . . ;don't allow approval of 2237 if Requesting Service OR any line item description is missing
"RTN","PRCSEB",65,0)
 . . I '$$REQCHECK^PRCHJUTL($G(DA),,1) S %=2
"RTN","PRCSEB",66,0)
 . I $G(%)'=2 S %=1 W !,"Is this request ready for approval" D YN^DICN
"RTN","PRCSEB",67,0)
 . D:%=1 W51
"RTN","PRCSEB",68,0)
 . D:%=0 W61
"RTN","PRCSEB",69,0)
 . D:%=2 W5
"RTN","PRCSEB",70,0)
 ;*****PRC*5.1*174 end******
"RTN","PRCSEB",71,0)
 S PRCSN=^PRCS(410,DA,0),PRCHQ=$P(PRCSN,"^",4),PRC("FY")=$P(PRCSN,"-",2),PRC("QTR")=$P(PRCSN,"-",3)
"RTN","PRCSEB",72,0)
 S (CURQTR,CURQTR1)=PRC("QTR"),(JUMP,TEST,TEST1,OK)=0
"RTN","PRCSEB",73,0)
 D T1^PRCSAPP1 I OK=1 S SKIPRNT=1 D FINAL^PRCSAPP2
"RTN","PRCSEB",74,0)
 Q
"RTN","PRCSEB",75,0)
 ;*81 Site Parameter Check
"RTN","PRCSEB",76,0)
CKPRM I $$GET^XPAR("SYS","PRCV COTS INVENTORY",1,"Q")=1 S PRCVX="I Y>1&(Y<5)",PRCVY="The form types 1358, Issue Book, and NO FORM are no longer used within this option."
"RTN","PRCSEB",77,0)
 I $$GET^XPAR("SYS","PRCV COTS INVENTORY",1,"Q")'=1 S PRCVX="I Y>1",PRCVY="The form types 1358 and NO FORM are no longer used within this option"
"RTN","PRCSEB",78,0)
 Q
"RTN","PRCSEB",79,0)
 ;
"RTN","PRCSEB",80,0)
CHKREQ ;Check Date to insure it is within the FY/FQ range during option entry for 'NEW 2237'    ;PRC*5.1*196
"RTN","PRCSEB",81,0)
 N PRCDT,PRCDT1,PRCTAPPR
"RTN","PRCSEB",82,0)
 S PRCTAPPR=$P($G(^PRC(420,PRC("SITE"),1,+PRC("CP"),4,+PRC("FY"),2)),"^",9) ;PRC*5.1*209 use appropriation code from node 4, check both X and x
"RTN","PRCSEB",83,0)
 I $D(PRCBBMY) S PRCCKERR=0 Q
"RTN","PRCSEB",84,0)
 S PRCDTT=1700+$E(DT,1,3)
"RTN","PRCSEB",85,0)
 I '$D(PRC("BBFY"))!(+$P(^PRC(420,PRC("SITE"),1,+PRC("CP"),0),"^",12)>0)!(PRCTAPPR["X")!(PRCTAPPR["x") S PRC("BBFY")=PRC("FY")+2000
"RTN","PRCSEB",86,0)
 S PRCCKERR=0,PRCDT=(PRC("BBFY")-$S(PRC("QTR")=1:1701,1:1700))_$P("10:01:04:07",":",PRC("QTR"))_"01",PRCDT1=(PRC("BBFY")-1700)_"0930"
"RTN","PRCSEB",87,0)
 I PRCSTDT<PRCDT!(PRCSTDT>PRCDT1) D
"RTN","PRCSEB",88,0)
 . S PRCCKERR=1
"RTN","PRCSEB",89,0)
 . W !!," ** Date must be specified for time **",!," ** period covered by fiscal year ",PRC("BBFY"),"       **",!
"RTN","PRCSEB",90,0)
 Q
"RTN","PRCSEB",91,0)
EXIT K %,C,D,DA,DIC,DIE,DQ,DR,PRCS,PRCS2,PRCSDAA,PRCSDR,PRCSERR,PRCSL,PRCSTT,I,N,T,T1,T2,X,X1,PRCSX3,Y,Z,PRCOMDT,PRCCKERR,PRCSTYP Q     ;PRC*5.1*196
"VER")
8.0^22.2
"BLD",11329,6)
^185
**END**
**END**

