Released PRC*5.1*183 SEQ #161
Extracted from mail message
**KIDS**:PRC*5.1*183^

**INSTALL NAME**
PRC*5.1*183
"BLD",7361,0)
PRC*5.1*183^IFCAP^0^3140519^y
"BLD",7361,1,0)
^^3^3^3140519^
"BLD",7361,1,1,0)
1. Amendment error - undefined PCT+2^PRCHSF3
"BLD",7361,1,2,0)
 
"BLD",7361,1,3,0)
2. Inquire Purchase Card surrogate add error
"BLD",7361,4,0)
^9.64PA^^0
"BLD",7361,6.3)
4
"BLD",7361,"ABPKG")
n
"BLD",7361,"KRN",0)
^9.67PA^779.2^20
"BLD",7361,"KRN",.4,0)
.4
"BLD",7361,"KRN",.401,0)
.401
"BLD",7361,"KRN",.402,0)
.402
"BLD",7361,"KRN",.403,0)
.403
"BLD",7361,"KRN",.5,0)
.5
"BLD",7361,"KRN",.84,0)
.84
"BLD",7361,"KRN",3.6,0)
3.6
"BLD",7361,"KRN",3.8,0)
3.8
"BLD",7361,"KRN",9.2,0)
9.2
"BLD",7361,"KRN",9.8,0)
9.8
"BLD",7361,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",7361,"KRN",9.8,"NM",1,0)
PRCHINQ^^0^B14819307
"BLD",7361,"KRN",9.8,"NM",2,0)
PRCHMA^^0^B121179874
"BLD",7361,"KRN",9.8,"NM","B","PRCHINQ",1)

"BLD",7361,"KRN",9.8,"NM","B","PRCHMA",2)

"BLD",7361,"KRN",19,0)
19
"BLD",7361,"KRN",19.1,0)
19.1
"BLD",7361,"KRN",101,0)
101
"BLD",7361,"KRN",409.61,0)
409.61
"BLD",7361,"KRN",771,0)
771
"BLD",7361,"KRN",779.2,0)
779.2
"BLD",7361,"KRN",870,0)
870
"BLD",7361,"KRN",8989.51,0)
8989.51
"BLD",7361,"KRN",8989.52,0)
8989.52
"BLD",7361,"KRN",8994,0)
8994
"BLD",7361,"KRN","B",.4,.4)

"BLD",7361,"KRN","B",.401,.401)

"BLD",7361,"KRN","B",.402,.402)

"BLD",7361,"KRN","B",.403,.403)

"BLD",7361,"KRN","B",.5,.5)

"BLD",7361,"KRN","B",.84,.84)

"BLD",7361,"KRN","B",3.6,3.6)

"BLD",7361,"KRN","B",3.8,3.8)

"BLD",7361,"KRN","B",9.2,9.2)

"BLD",7361,"KRN","B",9.8,9.8)

"BLD",7361,"KRN","B",19,19)

"BLD",7361,"KRN","B",19.1,19.1)

"BLD",7361,"KRN","B",101,101)

"BLD",7361,"KRN","B",409.61,409.61)

"BLD",7361,"KRN","B",771,771)

"BLD",7361,"KRN","B",779.2,779.2)

"BLD",7361,"KRN","B",870,870)

"BLD",7361,"KRN","B",8989.51,8989.51)

"BLD",7361,"KRN","B",8989.52,8989.52)

"BLD",7361,"KRN","B",8994,8994)

"BLD",7361,"QDEF")
^^^^^^^^^^YES
"BLD",7361,"QUES",0)
^9.62^^
"BLD",7361,"REQB",0)
^9.611^1^1
"BLD",7361,"REQB",1,0)
PRC*5.1*157^2
"BLD",7361,"REQB","B","PRC*5.1*157",1)

"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
183^3140519
"PKG",455,22,1,"PAH",1,1,0)
^^3^3^3140519
"PKG",455,22,1,"PAH",1,1,1,0)
1. Amendment error - undefined PCT+2^PRCHSF3
"PKG",455,22,1,"PAH",1,1,2,0)
 
"PKG",455,22,1,"PAH",1,1,3,0)
2. Inquire Purchase Card surrogate add error
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PRCHINQ")
0^1^B14819307^B10133496
"RTN","PRCHINQ",1,0)
PRCHINQ ;WISC/AKS-Add/Edit Surrogate Users and inquire Card Info ;6/8/96  13:38
"RTN","PRCHINQ",2,0)
 ;;5.1;IFCAP;**18,117,126,157,183**;Oct 20, 2000;Build 4
"RTN","PRCHINQ",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCHINQ",4,0)
 ;
"RTN","PRCHINQ",5,0)
 ;PRC*5.1*183 Text added to inform user that surrogates lookup/add will
"RTN","PRCHINQ",6,0)
 ;            only show those having access to FCP linked to PCard.
"RTN","PRCHINQ",7,0)
 ;
"RTN","PRCHINQ",8,0)
 QUIT
"RTN","PRCHINQ",9,0)
 ;
"RTN","PRCHINQ",10,0)
INQ ;Display purchase card information and allow add/editting of users
"RTN","PRCHINQ",11,0)
 ;
"RTN","PRCHINQ",12,0)
 N PRCHDA
"RTN","PRCHINQ",13,0)
 S PRCF("X")="S" D ^PRCFSITE Q:'$D(PRC("SITE"))!($G(X)="^")   ;PRC*5.1*183  SITE setup
"RTN","PRCHINQ",14,0)
 S DIC="^PRC(440.5,",DIC(0)="AEQM"
"RTN","PRCHINQ",15,0)
 S DIC("S")="I $P(^PRC(440.5,+Y,0),U,8)=DUZ"
"RTN","PRCHINQ",16,0)
 D ^DIC W !
"RTN","PRCHINQ",17,0)
 S (PRCHDA,DA)=+Y,DR="0:49" D EN^DIQ,EN^DDIOL("REPLACEMENT CHARGE CARD NUMBER: "_$P($G(^PRC(440.5,DA,50)),"^")):$P($G(^PRC(440.5,DA,50)),"^")]"" G:Y=-1 EXIT
"RTN","PRCHINQ",18,0)
 S %A="Would you like to add/delete a surrogate",%B="",%=2
"RTN","PRCHINQ",19,0)
 D ^PRCFYN G:%<1!(%=2) EXIT
"RTN","PRCHINQ",20,0)
 ;PRC*5.1*183
"RTN","PRCHINQ",21,0)
 W !!,?25,"*** ATTENTION ***"
"RTN","PRCHINQ",22,0)
 W !,?5,"Adding a new surrogate will now check surrogate name entered"
"RTN","PRCHINQ",23,0)
 W !,?5,"for valid access to the Fund Control Point linked to the PCard."
"RTN","PRCHINQ",24,0)
 W !,?5,"It will be possible to enter a name search and not find any"
"RTN","PRCHINQ",25,0)
 W !,?5,"due to an invalid name entry or user name with no access to"
"RTN","PRCHINQ",26,0)
 W !,?5,"Purchase Card FCP.",!
"RTN","PRCHINQ",27,0)
 ;
"RTN","PRCHINQ",28,0)
MORE ;PRC*5.1*183  New surrogate logic
"RTN","PRCHINQ",29,0)
 S DA(1)=PRCHDA,DIC="^PRC(440.5,"_DA(1)_",1,",DIC(0)="AEQL"
"RTN","PRCHINQ",30,0)
 S DIC("S")="I +Y'=$P(^PRC(440.5,DA(1),0),U,8)"
"RTN","PRCHINQ",31,0)
 D ^DIC K DIC
"RTN","PRCHINQ",32,0)
 G:$D(DUOUT)!$D(DTOUT) EXIT G EXIT:Y'>0  S DA=+Y
"RTN","PRCHINQ",33,0)
 I $P(Y,U,3)'=1 D
"RTN","PRCHINQ",34,0)
 . W !!?5,"Would you like to delete this surrogate user" S %=2 D YN^DICN
"RTN","PRCHINQ",35,0)
 . Q:%<1!(%=2)
"RTN","PRCHINQ",36,0)
 . S DA=+Y,DIK="^PRC(440.5,"_DA(1)_",1,"
"RTN","PRCHINQ",37,0)
 . D ^DIK K Y,DA,DIK
"RTN","PRCHINQ",38,0)
Q S %A="Would you like to add/delete another surrogate",%B="",%=2
"RTN","PRCHINQ",39,0)
 D ^PRCFYN G:%<1!(%=2) EXIT G MORE
"RTN","PRCHINQ",40,0)
 ;
"RTN","PRCHINQ",41,0)
STAT ;Amendment/Adjustment statuses from the dd, called from field #50, sub-
"RTN","PRCHINQ",42,0)
 ;field #9 of file #443.6
"RTN","PRCHINQ",43,0)
 N MOPPC S MOPPC=0
"RTN","PRCHINQ",44,0)
 I $P($G(^PRC(443.6,PRCHPO,0)),U,2)=25 S MOPPC=1
"RTN","PRCHINQ",45,0)
 S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=41:1,Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",46,0)
 S:MOPPC DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",47,0)
 ;I $G(PRCHAUTH)=1 S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=41:1,Z1=44:1,Z1=47:1,Z1=49:1,Z1=51:1,1:0)"
"RTN","PRCHINQ",48,0)
 I $G(PRCHAUTH)=1 D
"RTN","PRCHINQ",49,0)
 . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=23:1,Z1=26:1,Z1=31:1,1:0)"
"RTN","PRCHINQ",50,0)
 . S PRCHOLD=$P($G(^PRC(443.6,PRCHPO,7)),U)
"RTN","PRCHINQ",51,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Paid " D
"RTN","PRCHINQ",52,0)
 . . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=29:1,Z1=34:1,Z1=38:1,1:0)"
"RTN","PRCHINQ",53,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Partial Payment " D
"RTN","PRCHINQ",54,0)
 . . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",55,0)
 D ^DIC K DIC,PRCHOLD,MOPPC S DIC=DIE,X=+Y K:Y<0 X
"RTN","PRCHINQ",56,0)
 QUIT
"RTN","PRCHINQ",57,0)
EXIT ;Kill variables and quit
"RTN","PRCHINQ",58,0)
 K Y,%A,%B,%,DIC
"RTN","PRCHINQ",59,0)
 QUIT
"RTN","PRCHINQ",60,0)
STAT1 ;Called from field #50, subfield #9, file #443.6
"RTN","PRCHINQ",61,0)
 N MOPPC S MOPPC=0
"RTN","PRCHINQ",62,0)
 I $P($G(^PRC(443.6,PRCHPO,0)),U,2)=25 S MOPPC=1
"RTN","PRCHINQ",63,0)
 S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=41:1,Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",64,0)
 S:MOPPC DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",65,0)
 ;I $G(PRCHAUTH)=1 S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=21:1,Z1=23:1,Z1=26:1,Z1=29:1,Z1=31:1,Z1=34:1,Z1=41:1,Z1=44:1,Z1=47:1,Z1=49:1,Z1=51:1,1:0)"
"RTN","PRCHINQ",66,0)
 I $G(PRCHAUTH)=1 D
"RTN","PRCHINQ",67,0)
 . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=23:1,Z1=26:1,Z1=31:1,1:0)"
"RTN","PRCHINQ",68,0)
 . S PRCHOLD=$P($G(^PRC(443.6,PRCHPO,7)),U)
"RTN","PRCHINQ",69,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Paid " D
"RTN","PRCHINQ",70,0)
 . . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=29:1,Z1=34:1,Z1=38:1,1:0)"
"RTN","PRCHINQ",71,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Partial Payment " D
"RTN","PRCHINQ",72,0)
 . . S DIC("S")="S Z1=$P(^(0),U,2) I $S(Z1=44:1,Z1=47:1,Z1=49:1,1:0)"
"RTN","PRCHINQ",73,0)
 K PRCHOLD,MOPPC
"RTN","PRCHINQ",74,0)
 QUIT
"RTN","PRCHINQ",75,0)
PAID ;To check if there is any payment made for this PO
"RTN","PRCHINQ",76,0)
 ;PRC*5.1*157 in addition to "Paid" status check, check added to insure there are no reconciliation charges linked to order that should prevent PO cancelling.
"RTN","PRCHINQ",77,0)
 I $G(PRCHAUTH)=1!($P(^PRC(442,PRCHPO,0),U,2)=25) D
"RTN","PRCHINQ",78,0)
 . S PRCHOLD=$P($G(^PRC(443.6,PRCHPO,7)),U)
"RTN","PRCHINQ",79,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Paid " S PAID=1
"RTN","PRCHINQ",80,0)
 . I $P($G(^PRCD(442.3,PRCHOLD,0)),"(")="Partial Payment " S PAID=1
"RTN","PRCHINQ",81,0)
 . I $G(PAID)'=1,$O(^PRCH(440.6,"PO",PRCHPO,0)) S PAID=1
"RTN","PRCHINQ",82,0)
 QUIT
"RTN","PRCHMA")
0^2^B121179874^B77711518
"RTN","PRCHMA",1,0)
PRCHMA ;WISC/AKS-Amend to PO, req ;6/10/96  14:07
"RTN","PRCHMA",2,0)
 ;;5.1;IFCAP;**21,79,100,113,157,183**;Oct 20, 2000;Build 4
"RTN","PRCHMA",3,0)
 ;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","PRCHMA",4,0)
 ;
"RTN","PRCHMA",5,0)
 ;PRC*5.1*183 Audit all discount nodes in order to insure the item 
"RTN","PRCHMA",6,0)
 ;            referred to is still defined.  Also, check each item
"RTN","PRCHMA",7,0)
 ;            array defined in the discounts nodes (piece 1) to  
"RTN","PRCHMA",8,0)
 ;            determine if each item still has the same contract  
"RTN","PRCHMA",9,0)
 ;            if contract noted in the discount info.
"RTN","PRCHMA",10,0)
 ;
"RTN","PRCHMA",11,0)
REQ N PRCHREQ
"RTN","PRCHMA",12,0)
 S PRCHREQ=1
"RTN","PRCHMA",13,0)
PO N PRCF,RETURN,PRCHAM,PRCHPO,PRCHNEW,OUT,CAN,PRCHAU,PRCHER,PRCHON,A,B,ER,FL,FIS,DELIVER,PRCHAMDA,PRCHAV,PRCHL1,PRCHLN,PRCHRET,LCNT
"RTN","PRCHMA",14,0)
 N PRCHL2,ROU,DIC,I,PRCHAMT,PRCHAREC,PRCHEDI,X,Y,PRCHN,PRCHO,SFUND,PRCHX,PRCHIMP,PRCHNRQ,PRCHP,REPO,PRCHNORE,%,%A,%B,D0,D1,J
"RTN","PRCHMA",15,0)
 N PRCFL,MSG,PRCDCERR         ;PRC*5.1*183
"RTN","PRCHMA",16,0)
LOOP D KILL^PRCHMA1 S PRCHNEW="",PRCHNORE=1,CAN=0
"RTN","PRCHMA",17,0)
 ; See routine PRCHAMXA for information on variable PRCHNORE and undefined DIK, var PRCHPO is the basic premise of locks applied to amendments
"RTN","PRCHMA",18,0)
 S PRCF("X")="S" D ^PRCFSITE Q:'$D(PRC("SITE"))
"RTN","PRCHMA",19,0)
 ; Lock simultaneous entry of users in amend. module for the same record.  Var Y is saved in PRCHPO at the end of GETPO subrtn, when we start
"RTN","PRCHMA",20,0)
 ; the process(AMENDNO) of amending the record we must have var PRCHPO.
"RTN","PRCHMA",21,0)
 S PRCFL=0
"RTN","PRCHMA",22,0)
 W !! D GETPO^PRCHAMU
"RTN","PRCHMA",23,0)
 ; If no record is selected or time-out or up-arrow out then exit without unlocking a record.
"RTN","PRCHMA",24,0)
 I $D(DTOUT)!$D(DUOUT)!$G(OUT)=1 G EXIT1
"RTN","PRCHMA",25,0)
 I PRCFL=1 G LOOP
"RTN","PRCHMA",26,0)
 I '$G(PRCHPO)!$D(FIS) G EXIT
"RTN","PRCHMA",27,0)
 I '$$VERIFY^PRCHES5(PRCHPO) W !!,?5,"This purchase order has been tampered with.",!,?5,"Please notify IFCAP APPLICATION COORDINATOR.",! G EXIT
"RTN","PRCHMA",28,0)
 D AMENDNO^PRCHAMU G:'$G(PRCHAM) EXIT
"RTN","PRCHMA",29,0)
 S PRCHAMT=0,FL=0
"RTN","PRCHMA",30,0)
 D INFO^PRCHAMU G:$D(PRCHAV)!ER EXIT
"RTN","PRCHMA",31,0)
 S X=$P($G(^PRC(443.6,PRCHPO,0)),U,16) D EN2^PRCHAMXB
"RTN","PRCHMA",32,0)
 I PRCHNEW="" S DA(1)=PRCHPO,DA=PRCHAM,PRCHX=X,X=0,PRCHAMDA=34 D EN8^PRCHAMXB S X=PRCHX
"RTN","PRCHMA",33,0)
 I $P(^PRC(443.6,PRCHPO,6,PRCHAM,0),U,4)=5!($P(^(0),U,4)=15) S CAN=1
"RTN","PRCHMA",34,0)
 I PRCHNEW=111&($G(CAN)=0) D REV
"RTN","PRCHMA",35,0)
 I $G(CAN)>0 D ENC G:ER EXIT I $G(NOCAN)=0 S DA(1)=PRCHPO,DA=PRCHAM,PRCHAMDA=34,PRCHX=X,X=0 D EN8^PRCHAMXB S X=PRCHX G CAN1
"RTN","PRCHMA",36,0)
ASK K NOCAN,DTOUT,DUOUT,REPONUM D ASK^PRCHAMU
"RTN","PRCHMA",37,0)
 G:$D(REPONUM)=1 CAN1
"RTN","PRCHMA",38,0)
 I ER=0 D  G:'$D(REPO)&($G(CAN)=0) ASK
"RTN","PRCHMA",39,0)
 . D @ROU
"RTN","PRCHMA",40,0)
 . I $G(PRCHAMDA)=31 D MSG^PRCHAMU Q
"RTN","PRCHMA",41,0)
 . I $G(PRCHAMDA)=24,$G(X)=2 D MSG1^PRCHAMU S SCE=1 Q
"RTN","PRCHMA",42,0)
 I $P(^PRC(443.6,PRCHPO,6,PRCHAM,0),U,4)=5!($P(^(0),U,4)=15) S CAN=1
"RTN","PRCHMA",43,0)
 I $D(DTOUT)!($D(DUOUT)) G EXIT
"RTN","PRCHMA",44,0)
 I $G(NOCAN)=1 G ASK
"RTN","PRCHMA",45,0)
 G:$P($G(^PRC(443.6,PRCHPO,6,PRCHAM,3,0)),U,4)'>1 EXIT
"RTN","PRCHMA",46,0)
CAN1 S BFLAG=0
"RTN","PRCHMA",47,0)
 S:$P($G(^PRC(443.6,PRCHPO,1)),U,7)'=6 BFLAG=1
"RTN","PRCHMA",48,0)
 I $P($G(^PRC(443.6,PRCHPO,1)),U,7)=6  D
"RTN","PRCHMA",49,0)
 .S THISHLD=0
"RTN","PRCHMA",50,0)
 .F  S THISHLD=$O(^PRC(443.6,PRCHPO,2,THISHLD)) Q:'THISHLD!(BFLAG=1)  D
"RTN","PRCHMA",51,0)
 ..S:$P($G(^PRC(443.6,PRCHPO,2,THISHLD,2)),U,2)'="" BFLAG=1
"RTN","PRCHMA",52,0)
 .Q:BFLAG=1
"RTN","PRCHMA",53,0)
 .S THISHLD=0
"RTN","PRCHMA",54,0)
 .F  S THISHLD=$O(^PRC(442,PRCHPO,2,THISHLD)) Q:'THISHLD!(BFLAG=1)  D
"RTN","PRCHMA",55,0)
 ..S:$P($G(^PRC(442,PRCHPO,2,THISHLD,2)),U,2)'="" BFLAG=1
"RTN","PRCHMA",56,0)
 W:BFLAG=0 !,"This is now a contract order.  You must add a contract to this orders item(s)",!,"before approving the amendment.",!
"RTN","PRCHMA",57,0)
 G:BFLAG=0 EXIT
"RTN","PRCHMA",58,0)
 S PRCDCERR=0 D CHKDISC G:PRCDCERR ASK    ;PRC*5.1*183
"RTN","PRCHMA",59,0)
 D:BFLAG=1 UPDATE^PRCHAMU G:$D(Y) EXIT
"RTN","PRCHMA",60,0)
CHK I '$$VERIFY^PRCHES5(PRCHPO) W !!,?5,"This purchase order has been tampered with.",!,?5,"Please notify IFCAP APPLICATION COORDINATOR." G EXIT
"RTN","PRCHMA",61,0)
 I $P($G(^PRC(443.6,PRCHPO,6,PRCHAM,1)),U,4)']"" W !!,?5,"There is no Amendment Status." D
"RTN","PRCHMA",62,0)
 .S POSTAT=+$G(^PRC(443.6,PRCHPO,7))
"RTN","PRCHMA",63,0)
 .S AMSTAT=$S(POSTAT=25:26,POSTAT=30:31,POSTAT=40:71,POSTAT=6:83,POSTAT=84:85,POSTAT=86:87,POSTAT=90:91,POSTAT=92:93,POSTAT=94:95,POSTAT=96:97,POSTAT=45:45,1:POSTAT)
"RTN","PRCHMA",64,0)
 .S AMSTAT=$P(^PRCD(442.3,AMSTAT,0),U)
"RTN","PRCHMA",65,0)
 .S DIE="^PRC(443.6,PRCHPO,6,",DA(1)=PRCHPO,DA=PRCHAM,DR="9//^S X=AMSTAT"
"RTN","PRCHMA",66,0)
 .D ^DIE K DIE,AMSTAT,POSTAT
"RTN","PRCHMA",67,0)
 K PRCHER S LCNT=1 I $P($G(^PRC(443.6,PRCHPO,6,PRCHAM,1)),U,4)']"" W !!,?5,"There is no Amendment Status.",! S PRCHER=""
"RTN","PRCHMA",68,0)
 I $P($G(^PRC(443.6,PRCHPO,2,0)),U,4)>0 D  G:$D(PRCHER) ERR
"RTN","PRCHMA",69,0)
 .N END S END=IOSL-3
"RTN","PRCHMA",70,0)
 .S PRCH=0 F  S PRCH=$O(^PRC(443.6,PRCHPO,2,PRCH)) Q:PRCH=""!(PRCH'>0)  D
"RTN","PRCHMA",71,0)
 ..S PRCHLN=$G(^PRC(443.6,PRCHPO,2,PRCH,0)) D  Q
"RTN","PRCHMA",72,0)
 ...I $P(PRCHLN,U,4)="" D:LCNT>END TOP W !!,?5,"Line item ",+$P(PRCHLN,U)," is missing BOC !",$C(7) S PRCHER="",LCNT=LCNT+2
"RTN","PRCHMA",73,0)
 ...I $G(PRCHAUTH)'=1,$G(PRCHREQ) I $P(PRCHLN,U,13)="" D:LCNT>END TOP W !!,?5,"Line item ",+$P(PRCHLN,U)," is missing NSN!",$C(7) S PRCHER="",LCNT=LCNT+2
"RTN","PRCHMA",74,0)
 ...S J=0 S J=$O(^PRC(443.6,PRCHPO,2,PRCH,1,J)) I J'>0 D:LCNT>END TOP W !!,?5,"Line item ",+$P(PRCHLN,U)," is missing its description!",$C(7) S PRCHER="",LCNT=LCNT+2
"RTN","PRCHMA",75,0)
 ...I $P($G(^PRC(442,PRCHPO,23)),U,11)="D",$P($G(^PRC(443.6,PRCHPO,2,PRCH,2)),U,2)="" D:LCNT>END TOP W !!,?5,"Line item ",+$P(PRCHLN,U)," is missing contract number.",$C(7) S PRCHER="",LCNT=LCNT+2
"RTN","PRCHMA",76,0)
 ...; PRC*5.1*79 - Check line items of PC orders with source code=6 to make sure that a contract number is entered
"RTN","PRCHMA",77,0)
 ...D PCD^PRCHMA1
"RTN","PRCHMA",78,0)
 ...Q
"RTN","PRCHMA",79,0)
 ..Q
"RTN","PRCHMA",80,0)
 .I $D(PRCHER) I LCNT>END N DIR S DIR(0)="E" D ^DIR S LCNT=1
"RTN","PRCHMA",81,0)
 .Q
"RTN","PRCHMA",82,0)
 D EN106^PRCHNPO7 I $G(ERROR)=1 G EXIT
"RTN","PRCHMA",83,0)
 I $P($G(^PRC(443.6,PRCHPO,0)),U,13)>0 I $P($G(^PRC(443.6,PRCHPO,23)),U)="" W !!,?5,"This amendment has Est. Shipping and/or Handling charges without any",!,?5,"Est. Shipping BOC." S PRCHER=""
"RTN","PRCHMA",84,0)
 I $P($G(^PRC(443.6,PRCHPO,6,PRCHAM,0)),U,4)=5!($P($G(^(0)),U,4)=15) S CAN=1
"RTN","PRCHMA",85,0)
 I $G(CAN)'=1 D CHECK^PRCHAMDF(PRCHPO,PRCHAM,.PRCHER)
"RTN","PRCHMA",86,0)
 I $G(PRCHAUTH)=1!($P($G(^PRC(443.6,PRCHPO,0)),U,2)=25) S FILE=443.6 D  I $G(ERROR) S PRCHER="" K ERROR,FILE
"RTN","PRCHMA",87,0)
 .D ^PRCHSF3
"RTN","PRCHMA",88,0)
 .D ADJ1^PRCHCD0
"RTN","PRCHMA",89,0)
 .D LIMIT^PRCHCD0
"RTN","PRCHMA",90,0)
 ;
"RTN","PRCHMA",91,0)
ERR I $D(PRCHER) W !!,?5,"This amendment needs to be re-edited before it can be signed.",!,"**REMINDER** Unsigned amendments are deleted from the system after 7 days." D:LCNT>20  G EXIT
"RTN","PRCHMA",92,0)
 .N DIR S DIR(0)="E" D ^DIR
"RTN","PRCHMA",93,0)
 .Q
"RTN","PRCHMA",94,0)
 D REV:'$G(PRCPROST),APP G:%'=1 EXIT
"RTN","PRCHMA",95,0)
 S PRCHRET=$$ASK^PRCHAM8(PRCHPO,PRCHAM) G:PRCHRET'=1 EXIT
"RTN","PRCHMA",96,0)
 S RETURN="" D COMMIT^PRCHAM8(PRCHPO,PRCHAM,.RETURN)
"RTN","PRCHMA",97,0)
 G:RETURN'=1 EXIT
"RTN","PRCHMA",98,0)
 S DIE="^PRC(443.6,"_PRCHPO_",6,",DA=PRCHAM,DR="15///TODAY+4" D ^DIE
"RTN","PRCHMA",99,0)
 D ^PRCHSF3
"RTN","PRCHMA",100,0)
 I $P(^PRC(443.6,PRCHPO,0),U,2)'=25 S PRCHQ="^PRCHPAM8",PRCHQ("DEST")="F",D0=PRCHPO,D1=PRCHAM D ^PRCHQUE
"RTN","PRCHMA",101,0)
 I '($P(^PRC(443.6,PRCHPO,0),U,2)=25!($P(^PRC(443.6,PRCHPO,0),U,19)=2)) D
"RTN","PRCHMA",102,0)
 . W !?3,"SEND TO SUPPLY " S PRCHQ="^PRCHPAM8",D0=PRCHPO,D1=PRCHAM D ^PRCHQUE
"RTN","PRCHMA",103,0)
 . S FILE=443.6 D:$D(PRCHPO) CHECK^PRCHSWCH
"RTN","PRCHMA",104,0)
 . I $G(PRCHOBL)=1 D SUPP^PRCFFM2M K FILE Q
"RTN","PRCHMA",105,0)
 . I $G(PRCHOBL)=2 S PRCOPODA=PRCHPO D ^PRCOEDI K FILE,PRCOPODA Q
"RTN","PRCHMA",106,0)
 I $P($G(^PRC(443.6,PRCHPO,0)),U,2)=25 D  S:$G(PRCPROST) PRCPROST=PRCPROST+0.9 G EXIT
"RTN","PRCHMA",107,0)
 .S MTOPDA=1
"RTN","PRCHMA",108,0)
 .D SUPP^PRCFFM2M ;I $P($G(^PRC(442,PRCHPO,23)),"^",11)="P" W !!,"...now generating the PHA transaction..." S PRCOPODA=PRCHPO D NEW^PRCOEDI K PRCOPODA W !!
"RTN","PRCHMA",109,0)
 .S PPTEMP=0,PP410=$P($G(^PRC(442,PRCHPO,0)),"^",12),PPAMT=$P($G(^PRC(442,PRCHPO,0)),"^",16) I PP410'="" S PPTEMP=$P($G(^PRCS(410,PP410,4)),"^",8),PPTEMP=-(PPAMT-PPTEMP)
"RTN","PRCHMA",110,0)
 .I $P($G(^PRC(442,PRCHPO,7)),"^",2)=45 S PPTEMP=PPAMT,PPAMT=0
"RTN","PRCHMA",111,0)
 .I PP410'="" S $P(^PRCS(410,PP410,4),"^",3)=0
"RTN","PRCHMA",112,0)
 .I PP410'="" S $P(^PRCS(410,PP410,4),"^",8)=PPAMT
"RTN","PRCHMA",113,0)
 .S A=$$DATE^PRC0C($P(PRCOAMT,"^",3),"I"),$P(PRCOAMT,"^",3,4)=$E(A,3,4)_"^"_$P(A,"^",2),$P(PRCOAMT,"^",5)=PPTEMP D EBAL^PRCSEZ(PRCOAMT,"O")
"RTN","PRCHMA",114,0)
 .I PP410'="",$P($G(^PRC(442,PRCHPO,7)),"^",2)=45 S $P(^PRCS(410,PP410,0),"^",2)="CA" D ERS410^PRC0G(PP410_"^C")
"RTN","PRCHMA",115,0)
 .D REMOVE^PRCSC2(PP410),ENCODE^PRCSC2(PP410,DUZ,.MESSAGE) K MESSAGE
"RTN","PRCHMA",116,0)
 .I '$G(PRCPROST) W !?3,"SEND TO SUPPLY " S PRCHQ="^PRCHPAM",D0=PRCHPO,D1=PRCHAM D ^PRCHQUE
"RTN","PRCHMA",117,0)
 .; Update file #440.5 after amendment has been approved. Consider orders created and amended in the same month and year and the user either
"RTN","PRCHMA",118,0)
 .; cancels the order or enters other type of amendment that changes the final amount of the order. No credit is given for orders from a
"RTN","PRCHMA",119,0)
 .; previous month and year. DT is the current date, system-supplied.
"RTN","PRCHMA",120,0)
 .S PRCHCD=$P($G(^PRC(442,PRCHPO,23)),U,8)
"RTN","PRCHMA",121,0)
 .S PRCNODE=$G(^PRC(442,PRCHPO,6,0)),PRCAMD=$P(PRCNODE,U,3)
"RTN","PRCHMA",122,0)
 .S PRCCHG=$P($G(^PRC(442,PRCHPO,6,PRCAMD,0)),U,3)
"RTN","PRCHMA",123,0)
 .S POSTAT=$P($G(^PRC(442,PRCHPO,7)),"^",2)
"RTN","PRCHMA",124,0)
 .I $E($P(^PRC(442,PRCHPO,1),U,15),1,5)=$E(DT,1,5),POSTAT'=45 D
"RTN","PRCHMA",125,0)
 ..I $G(PPAMT)<0 Q
"RTN","PRCHMA",126,0)
 ..S $P(^PRC(440.5,PRCHCD,2),U)=$P($G(^PRC(440.5,PRCHCD,2)),U)+$G(PRCCHG)
"RTN","PRCHMA",127,0)
 ..I $P($G(^PRC(440.5,PRCHCD,2)),U)<0 S $P(^PRC(440.5,PRCHCD,2),U)=0
"RTN","PRCHMA",128,0)
 .;
"RTN","PRCHMA",129,0)
 .I $E($P(^PRC(442,PRCHPO,1),U,15),1,5)=$E(DT,1,5),POSTAT=45 D
"RTN","PRCHMA",130,0)
 ..I $G(PPTEMP)<0 Q
"RTN","PRCHMA",131,0)
 ..S $P(^PRC(440.5,PRCHCD,2),U)=$P($G(^PRC(440.5,PRCHCD,2)),U)-$G(PPTEMP)
"RTN","PRCHMA",132,0)
 ..I $P($G(^PRC(440.5,PRCHCD,2)),U)<0 S $P(^PRC(440.5,PRCHCD,2),U)=0
"RTN","PRCHMA",133,0)
 .;
"RTN","PRCHMA",134,0)
 .; Update file #440.5 only if the amendment is for non-cancellation
"RTN","PRCHMA",135,0)
 .; of an order from a previous month regardless of the year.
"RTN","PRCHMA",136,0)
 .I $E($P(^PRC(442,PRCHPO,1),U,15),1,5)'=$E(DT,1,5),POSTAT'=45 D
"RTN","PRCHMA",137,0)
 ..I $G(PPAMT)<0 Q
"RTN","PRCHMA",138,0)
 ..S $P(^PRC(440.5,PRCHCD,2),U)=$P($G(^PRC(440.5,PRCHCD,2)),U)+$G(PPAMT)
"RTN","PRCHMA",139,0)
 .K DA,MTOPDA,PRCAMD,PRCHCD,PRCCHG,PRCNODE,POSTAT,PPTEMP,PPAMT,PP410
"RTN","PRCHMA",140,0)
 S SFUND="" I $P($G(^PRC(443.6,PRCHPO,0)),U,19)=2 D SUPP^PRCFFM2M S SFUND=1
"RTN","PRCHMA",141,0)
 I SFUND=1 W !?3,"SEND TO SUPPLY " S PRCHQ="^PRCHPAM",D0=PRCHPO,D1=PRCHAM D ^PRCHQUE
"RTN","PRCHMA",142,0)
 D SOURCE^PRCHAMU:$G(SCE)
"RTN","PRCHMA",143,0)
 G EXIT
"RTN","PRCHMA",144,0)
ENC S ER=0
"RTN","PRCHMA",145,0)
 D CAN^PRCHMA3
"RTN","PRCHMA",146,0)
 ;PRC*5.1*157   insures that if the user does not use Amendment to Purchase Card option
"RTN","PRCHMA",147,0)
 ;              an order using a credit card (MOP=25) will also be checked for any recon charges 
"RTN","PRCHMA",148,0)
 ;              still attached to order attempting to be cancelled
"RTN","PRCHMA",149,0)
 I $G(NOCAN)=1 W !?5,$S($D(PRCHREQ):"REQUISITION",1:"PURCHASE ORDER")_" HAS BEEN RECEIVED, CANNOT CANCEL !",$C(7) S ER=1 Q
"RTN","PRCHMA",150,0)
 I $G(PRCHAUTH)=1!($P(^PRC(442,PRCHPO,0),U,2)=25) D PAID^PRCHINQ I $G(PAID)=1 D  S ER=1 K PAID Q
"RTN","PRCHMA",151,0)
 . W !,?5,"THERE HAS BEEN PAYMENT MADE FOR THIS PURCHASE CARD ORDER, CANNOT CANCEL !",$C(7)
"RTN","PRCHMA",152,0)
 S %="",%A="     SURE YOU WANT TO CANCEL THIS ORDER ",%B="" D ^PRCFYN
"RTN","PRCHMA",153,0)
 I %'=1 W ?40,"    <NOTHING CANCELLED>" D  Q
"RTN","PRCHMA",154,0)
 .I $D(PRCHAU) D
"RTN","PRCHMA",155,0)
 ..S $P(^PRC(443.6,PRCHPO,6,PRCHAM,0),U,4)=PRCHAU
"RTN","PRCHMA",156,0)
 ..S $P(^PRC(443.6,PRCHPO,6,PRCHAM,1),U,4)=""
"RTN","PRCHMA",157,0)
 .S NOCAN=1
"RTN","PRCHMA",158,0)
 S DA(1)=PRCHPO,DIE="^PRC(443.6,"_DA(1)_",6,",DA=PRCHAM,DR="9////^S X=$O(^PRCD(442.3,""C"",45,0))"
"RTN","PRCHMA",159,0)
 D ^DIE K DIE,DA,DR S CAN=1
"RTN","PRCHMA",160,0)
 S PRCHAMT=-$P(^PRC(443.6,PRCHPO,0),U,15) W !
"RTN","PRCHMA",161,0)
 QUIT
"RTN","PRCHMA",162,0)
APP S %A="   Approve Amendment number "_PRCHAM_": ",%B="",%=$S($G(PRCPROST):1,1:2) D ^PRCFYN
"RTN","PRCHMA",163,0)
 Q
"RTN","PRCHMA",164,0)
REV N PRCH
"RTN","PRCHMA",165,0)
 S PRCDCERR=0 D CHKDISC Q:PRCDCERR       ;** PRC*5.1*183 Skip disc calc call to prevent item/disc sync errors due to erroneous previous amendment 
"RTN","PRCHMA",166,0)
 S %=1,%B="",%A="   Review Amendment " D ^PRCHSF3 W ! D ^PRCFYN
"RTN","PRCHMA",167,0)
 I %=1 S D0=PRCHPO,D1=PRCHAM,PRCH="^PRC(443.6," D ^PRCHDAM
"RTN","PRCHMA",168,0)
 Q
"RTN","PRCHMA",169,0)
EXIT L -^PRC(442,PRCENTRY)
"RTN","PRCHMA",170,0)
EXIT1 K ERROR,FIS,REPO,DEL
"RTN","PRCHMA",171,0)
 QUIT:$G(PRCPROST)
"RTN","PRCHMA",172,0)
 I $G(OUT)'=1 G LOOP
"RTN","PRCHMA",173,0)
 QUIT
"RTN","PRCHMA",174,0)
FLAG I $G(FLAG)=1 K FLAG Q
"RTN","PRCHMA",175,0)
 Q
"RTN","PRCHMA",176,0)
NOSIGN S $P(^PRC(443.6,PRCHPO,6,PRCHAM,0),U,4)=PRCHAU
"RTN","PRCHMA",177,0)
NOSIGN1 S DA(1)=PRCHPO,DIE="^PRC(443.6,"_DA(1)_",6,",DA=PRCHAM,DR="9///@"
"RTN","PRCHMA",178,0)
 D ^DIE K DIE,DA,DR
"RTN","PRCHMA",179,0)
 Q
"RTN","PRCHMA",180,0)
TOP ;PAUSE AT BOTTOM OF SCREEN
"RTN","PRCHMA",181,0)
 N DIR S DIR(0)="E"
"RTN","PRCHMA",182,0)
 D ^DIR
"RTN","PRCHMA",183,0)
 S LCNT=1
"RTN","PRCHMA",184,0)
 Q
"RTN","PRCHMA",185,0)
CHKDISC ;CHECK DISCOUNTS MATCH ITEMS        ;PRC*5.1*183
"RTN","PRCHMA",186,0)
 N PRCHDSC,PRCRDIS,PRCRITEM,PRCRCONT,PRCDERRS,PRCTT,PRCRERR,PRCRTYP,PRCRITM,PRCITEM,PRCIT,PRCII,PRCJJ
"RTN","PRCHMA",187,0)
 S PRCHDSC=0,PRCTT=0
"RTN","PRCHMA",188,0)
D1 F  S PRCHDSC=$O(^PRC(443.6,PRCHPO,3,PRCHDSC)) Q:'PRCHDSC  D
"RTN","PRCHMA",189,0)
 . S PRCRDIS=$G(^PRC(443.6,PRCHPO,3,PRCHDSC,0)) Q:PRCRDIS=""
"RTN","PRCHMA",190,0)
 . S PRCRITEM=$P(PRCRDIS,U),PRCRCONT=$P(PRCRDIS,U,5)
"RTN","PRCHMA",191,0)
 . I PRCRITEM[":" D
"RTN","PRCHMA",192,0)
 .. F PRCII=$P(PRCRITEM,":"):1:$P(PRCRITEM,":",2) D
"RTN","PRCHMA",193,0)
 ... S PRCIT=0 I $D(^PRC(443.6,PRCHPO,2,"B",PRCII)) S PRCIT=$O(^PRC(443.6,PRCHPO,2,"B",PRCII,0))
"RTN","PRCHMA",194,0)
 ... I 'PRCIT S PRCTT=PRCTT+1,PRCDERRS(PRCHDSC,PRCII,PRCTT)=PRCIT_";UNDF;"_PRCRDIS Q
"RTN","PRCHMA",195,0)
 ... I $P(^PRC(443.6,PRCHPO,2,PRCIT,2),U,2)'=$P(PRCRDIS,U,5) S PRCTT=PRCTT+1,PRCDERRS(PRCHDSC,PRCII,PRCTT)=PRCIT_";CONT;"_PRCRDIS
"RTN","PRCHMA",196,0)
 . I PRCRITEM'[":" D
"RTN","PRCHMA",197,0)
 .. F PRCJJ=1:1 S PRCII=$P(PRCRITEM,",",PRCJJ) Q:'PRCII  D
"RTN","PRCHMA",198,0)
 ... S PRCIT=0 I $D(^PRC(443.6,PRCHPO,2,"B",PRCII)) S PRCIT=$O(^PRC(443.6,PRCHPO,2,"B",PRCII,0))
"RTN","PRCHMA",199,0)
 ... I 'PRCIT S PRCTT=PRCTT+1,PRCDERRS(PRCHDSC,PRCII,PRCTT)=PRCIT_";UNDF;"_PRCRDIS Q
"RTN","PRCHMA",200,0)
 ... I $P(^PRC(443.6,PRCHPO,2,PRCIT,2),U,2)'=$P(PRCRDIS,U,5) S PRCTT=PRCTT+1,PRCDERRS(PRCHDSC,PRCII,PRCTT)=PRCIT_";CONT;"_PRCRDIS
"RTN","PRCHMA",201,0)
 . Q
"RTN","PRCHMA",202,0)
 ;
"RTN","PRCHMA",203,0)
D2 ;LIST ANY DISCOUNT ERRORS FOUND IN RELATION TO ITEMS
"RTN","PRCHMA",204,0)
 Q:PRCTT=0  S PRCDCERR=1
"RTN","PRCHMA",205,0)
 W !!,"Discounts/Items discrepancies found... MUST fix either item or discount listed"
"RTN","PRCHMA",206,0)
 W !!,"DC-IT ITEM(s) %/AMT DISC/ITEM CONTRACT#     REASON",!
"RTN","PRCHMA",207,0)
 S PRCHDSC=0
"RTN","PRCHMA",208,0)
 F  S PRCHDSC=$O(PRCDERRS(PRCHDSC)) Q:'PRCHDSC  D
"RTN","PRCHMA",209,0)
 . S PRCRITM=0
"RTN","PRCHMA",210,0)
 . F  S PRCRITM=$O(PRCDERRS(PRCHDSC,PRCRITM)) Q:'PRCRITM  D
"RTN","PRCHMA",211,0)
 .. S PRCRERR=0
"RTN","PRCHMA",212,0)
 .. F  S PRCRERR=$O(PRCDERRS(PRCHDSC,PRCRITM,PRCRERR)) Q:'PRCRERR  D
"RTN","PRCHMA",213,0)
 ... S PRCRITEM=PRCDERRS(PRCHDSC,PRCRITM,PRCRERR),PRCIT=$P(PRCRITEM,";"),PRCRTYP=$P(PRCRITEM,";",2),PRCRITEM=$P(PRCRITEM,";",3)
"RTN","PRCHMA",214,0)
 ... S PRCITEM=$G(^PRC(443.6,PRCHPO,2,PRCIT,2))
"RTN","PRCHMA",215,0)
 ... W !,PRCHDSC,"-",PRCRITM,?6,$P(PRCRITEM,U),?15,$P(PRCRITEM,U,2),?20,$S($P(PRCRITEM,U,5)'="":$P(PRCRITEM,U,5),1:"NONE"),"/",$S($P(PRCITEM,U,2)'="":$P(PRCITEM,U,2),1:"NONE")
"RTN","PRCHMA",216,0)
 ... W ?44,$S(PRCRTYP="UNDF":"Tampering, item has been removed",PRCRTYP="CONT":"Item/Disc contract numbers mismatch",1:"")
"RTN","PRCHMA",217,0)
 ... Q
"RTN","PRCHMA",218,0)
 ;
"RTN","PRCHMA",219,0)
 W !!,"Error(s) MUST be fixed to approve/review the amendment.....",! S DIR(0)="EAO",DIR("A")="Press <Enter> to return to Amendment Processing..." D ^DIR K DIR
"RTN","PRCHMA",220,0)
 Q
"VER")
8.0^22.0
"BLD",7361,6)
^161
**END**
**END**

