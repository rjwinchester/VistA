Released PRC*5.1*188 SEQ #163
Extracted from mail message
**KIDS**:PRC*5.1*188^

**INSTALL NAME**
PRC*5.1*188
"BLD",7574,0)
PRC*5.1*188^IFCAP^0^3140722^y
"BLD",7574,1,0)
^^5^5^3140721^
"BLD",7574,1,1,0)
1. Remove 8243 from Control Point Listing w/Cost Center Exceptions
"BLD",7574,1,2,0)
 
"BLD",7574,1,3,0)
2. Site references need to be removed from IFCAP Technical Manual
"BLD",7574,1,4,0)
 
"BLD",7574,1,5,0)
3. Prevent fractional quantities being entered on inventory item receipts
"BLD",7574,4,0)
^9.64PA^^
"BLD",7574,6.3)
1
"BLD",7574,"ABPKG")
n
"BLD",7574,"KRN",0)
^9.67PA^779.2^20
"BLD",7574,"KRN",.4,0)
.4
"BLD",7574,"KRN",.4,"NM",0)
^9.68A^^
"BLD",7574,"KRN",.401,0)
.401
"BLD",7574,"KRN",.402,0)
.402
"BLD",7574,"KRN",.403,0)
.403
"BLD",7574,"KRN",.5,0)
.5
"BLD",7574,"KRN",.84,0)
.84
"BLD",7574,"KRN",3.6,0)
3.6
"BLD",7574,"KRN",3.8,0)
3.8
"BLD",7574,"KRN",9.2,0)
9.2
"BLD",7574,"KRN",9.8,0)
9.8
"BLD",7574,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",7574,"KRN",9.8,"NM",1,0)
PRCHREC1^^0^B24270850
"BLD",7574,"KRN",9.8,"NM",2,0)
PRCB1A3^^0^B19454352
"BLD",7574,"KRN",9.8,"NM","B","PRCB1A3",2)

"BLD",7574,"KRN",9.8,"NM","B","PRCHREC1",1)

"BLD",7574,"KRN",19,0)
19
"BLD",7574,"KRN",19.1,0)
19.1
"BLD",7574,"KRN",101,0)
101
"BLD",7574,"KRN",409.61,0)
409.61
"BLD",7574,"KRN",771,0)
771
"BLD",7574,"KRN",779.2,0)
779.2
"BLD",7574,"KRN",870,0)
870
"BLD",7574,"KRN",8989.51,0)
8989.51
"BLD",7574,"KRN",8989.52,0)
8989.52
"BLD",7574,"KRN",8994,0)
8994
"BLD",7574,"KRN","B",.4,.4)

"BLD",7574,"KRN","B",.401,.401)

"BLD",7574,"KRN","B",.402,.402)

"BLD",7574,"KRN","B",.403,.403)

"BLD",7574,"KRN","B",.5,.5)

"BLD",7574,"KRN","B",.84,.84)

"BLD",7574,"KRN","B",3.6,3.6)

"BLD",7574,"KRN","B",3.8,3.8)

"BLD",7574,"KRN","B",9.2,9.2)

"BLD",7574,"KRN","B",9.8,9.8)

"BLD",7574,"KRN","B",19,19)

"BLD",7574,"KRN","B",19.1,19.1)

"BLD",7574,"KRN","B",101,101)

"BLD",7574,"KRN","B",409.61,409.61)

"BLD",7574,"KRN","B",771,771)

"BLD",7574,"KRN","B",779.2,779.2)

"BLD",7574,"KRN","B",870,870)

"BLD",7574,"KRN","B",8989.51,8989.51)

"BLD",7574,"KRN","B",8989.52,8989.52)

"BLD",7574,"KRN","B",8994,8994)

"BLD",7574,"QDEF")
^^^^^^^^^^YES
"BLD",7574,"QUES",0)
^9.62^^
"BLD",7574,"REQB",0)
^9.611^2^2
"BLD",7574,"REQB",1,0)
PRC*5.1*170^2
"BLD",7574,"REQB",2,0)
PRC*5.1*74^2
"BLD",7574,"REQB","B","PRC*5.1*170",1)

"BLD",7574,"REQB","B","PRC*5.1*74",2)

"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1^3001012^3001019^68
"PKG",455,22,1,"PAH",1,0)
188^3140722
"PKG",455,22,1,"PAH",1,1,0)
^^5^5^3140722
"PKG",455,22,1,"PAH",1,1,1,0)
1. Remove 8243 from Control Point Listing w/Cost Center Exceptions
"PKG",455,22,1,"PAH",1,1,2,0)
 
"PKG",455,22,1,"PAH",1,1,3,0)
2. Site references need to be removed from IFCAP Technical Manual
"PKG",455,22,1,"PAH",1,1,4,0)
 
"PKG",455,22,1,"PAH",1,1,5,0)
3. Prevent fractional quantities being entered on inventory item receipts
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","PRCB1A3")
0^2^B19454352^B19207496
"RTN","PRCB1A3",1,0)
PRCB1A3 ;WIOFO/DWA - CONTROL POINT LISTING W/COST CENTERS ;3/3/04 03:04 AM
"RTN","PRCB1A3",2,0)
 ;;5.1;IFCAP;**76,74,188**;Oct 20, 2000;Build 1
"RTN","PRCB1A3",3,0)
 ;Per VHA Directive 6402, this routine should not be modified.
"RTN","PRCB1A3",4,0)
 Q  ;invalid entry
"RTN","PRCB1A3",5,0)
 ;
"RTN","PRCB1A3",6,0)
 ;PRC*5.1*188 Removed exception check for FUND=0160, CC=824300
"RTN","PRCB1A3",7,0)
 ;
"RTN","PRCB1A3",8,0)
EN1 ; entry point for CONTROL POINT LISTING W/COST CENTERS
"RTN","PRCB1A3",9,0)
 N L,DIC,FLDS,BY,DHD
"RTN","PRCB1A3",10,0)
 S L=0,DIC="^PRC(420,",FLDS="[PRCB CTRLPT]",BY=".01,1,1"
"RTN","PRCB1A3",11,0)
 ;S DIS(0)="I $P(^PRC(420,D0,1,D1,0),""^"",19)'=1"
"RTN","PRCB1A3",12,0)
 S DHD="CONTROL POINT LISTING W/ COST CENTERS          PRINTED BY: "_$$USER^PRCPUREP(DUZ)
"RTN","PRCB1A3",13,0)
 D EN1^DIP
"RTN","PRCB1A3",14,0)
 Q
"RTN","PRCB1A3",15,0)
 ;
"RTN","PRCB1A3",16,0)
EN2 ; entry point for CONTROL POINT LISTING W/COST CENTER EXCEPTIONS
"RTN","PRCB1A3",17,0)
 N STN,CP,CC,ACC,ACT,FUND,CPNAME,I,PAGE,LNCT,TODAY,EXC,CNT,RECORD
"RTN","PRCB1A3",18,0)
 N CP1,CP2,FUND1,L,LN,LN1,SCREEN,DEV,ABORT,FLG,STN1,%ZIS,ZTDESC
"RTN","PRCB1A3",19,0)
 N ZTRTN,ZTSAVE,X,Y,PAGE1
"RTN","PRCB1A3",20,0)
 D NOW^%DTC S Y=% D DD^%DT S TODAY=Y KILL ^XTMP($J)
"RTN","PRCB1A3",21,0)
 S (STN,CP,CC,ACC,ACT,FUND)=0,DEV=$J
"RTN","PRCB1A3",22,0)
 F  S STN=$O(^PRC(420,STN)) Q:'STN  D
"RTN","PRCB1A3",23,0)
 . S CP=0 F  S CP=$O(^PRC(420,STN,1,CP)) Q:'CP!(CP=9999)  D
"RTN","PRCB1A3",24,0)
 . . S RECORD=$G(^PRC(420,STN,1,CP,0)) I RECORD="" Q
"RTN","PRCB1A3",25,0)
 . . S FUND=$P(RECORD,"^",2) I 'FUND Q
"RTN","PRCB1A3",26,0)
 . . S FUND=$P($G(^PRCD(420.3,FUND,0)),"^")
"RTN","PRCB1A3",27,0)
 . . I (".0160.0162.0152.")'[("."_$E(FUND,1,4)_".") Q
"RTN","PRCB1A3",28,0)
 . . S CPNAME=$P(RECORD,"^")                ; format, nnn(n) xxxxx xxxx
"RTN","PRCB1A3",29,0)
 . . S ACT=$P(RECORD,"^",19)                ; 1=inactive
"RTN","PRCB1A3",30,0)
 . . S ACC=$P($G(^PRC(420,STN,1,CP,5)),"^",3)   ; pointer to ^PRCD(420.131,
"RTN","PRCB1A3",31,0)
 . . S:'ACC ACC="NONE" D
"RTN","PRCB1A3",32,0)
 . . . S:ACC'="NONE" ACC=$P($G(^PRCD(420.131,ACC,0)),"^")
"RTN","PRCB1A3",33,0)
 . . . Q
"RTN","PRCB1A3",34,0)
 . . S (CC,I)=0 F  S CC=$O(^PRC(420,STN,1,CP,2,CC)) Q:'CC  D
"RTN","PRCB1A3",35,0)
 . . . D PROCESS
"RTN","PRCB1A3",36,0)
 . . . I 'EXC Q
"RTN","PRCB1A3",37,0)
 . . . S I=$G(I)+1
"RTN","PRCB1A3",38,0)
 . . . S ^XTMP($J,"PRCCPE",STN,FUND,CP,I)=ACT_"^"_CPNAME_"^"_CC_"^"_ACC
"RTN","PRCB1A3",39,0)
 . . . Q
"RTN","PRCB1A3",40,0)
 . . Q
"RTN","PRCB1A3",41,0)
 . Q
"RTN","PRCB1A3",42,0)
 ;
"RTN","PRCB1A3",43,0)
 S %ZIS="Q"
"RTN","PRCB1A3",44,0)
 D ^%ZIS Q:POP
"RTN","PRCB1A3",45,0)
 I $D(IO("Q")) D  Q
"RTN","PRCB1A3",46,0)
 . S ZTRTN="QUEUE^PRCB1A3"
"RTN","PRCB1A3",47,0)
 . S ZTDESC="CONTROL POINT LISTING W/EXCEPTIONS"
"RTN","PRCB1A3",48,0)
 . S ZTSAVE("TODAY")=""
"RTN","PRCB1A3",49,0)
 . S ZTSAVE("DUZ")=""
"RTN","PRCB1A3",50,0)
 . S ZTSAVE("DEV")=""
"RTN","PRCB1A3",51,0)
 . D ^%ZTLOAD
"RTN","PRCB1A3",52,0)
 . D HOME^%ZIS
"RTN","PRCB1A3",53,0)
 . KILL ZTST,IO("Q")
"RTN","PRCB1A3",54,0)
 ;
"RTN","PRCB1A3",55,0)
QUEUE U IO
"RTN","PRCB1A3",56,0)
 S (ABORT,PAGE,PAGE1,SCREEN)=0,LN1=45
"RTN","PRCB1A3",57,0)
 I $E(IOST,1,2)="C-" S SCREEN=1
"RTN","PRCB1A3",58,0)
 I SCREEN S LN1=17
"RTN","PRCB1A3",59,0)
 D HDR
"RTN","PRCB1A3",60,0)
 I SCREEN,IOSL>24 S PAGE1=1
"RTN","PRCB1A3",61,0)
 ;
"RTN","PRCB1A3",62,0)
 S (STN,STN1,CP,CC,ACC,ACT,FUND,FLG)=0
"RTN","PRCB1A3",63,0)
 S (CP1,CP2,FUND1)=""
"RTN","PRCB1A3",64,0)
 F  S STN=$O(^XTMP(DEV,"PRCCPE",STN)) Q:'STN  Q:ABORT  D
"RTN","PRCB1A3",65,0)
 . S FUND=0
"RTN","PRCB1A3",66,0)
 . F  S FUND=$O(^XTMP(DEV,"PRCCPE",STN,FUND)) Q:'FUND  Q:ABORT  D
"RTN","PRCB1A3",67,0)
 . . S CP=0
"RTN","PRCB1A3",68,0)
 . . F  S CP=$O(^XTMP(DEV,"PRCCPE",STN,FUND,CP)) Q:'CP  Q:ABORT  D
"RTN","PRCB1A3",69,0)
 . . . S CNT=0
"RTN","PRCB1A3",70,0)
 . . . F  S CNT=$O(^XTMP(DEV,"PRCCPE",STN,FUND,CP,CNT)) Q:'CNT  Q:ABORT  D
"RTN","PRCB1A3",71,0)
 . . . . S RECORD=^XTMP(DEV,"PRCCPE",STN,FUND,CP,CNT)
"RTN","PRCB1A3",72,0)
 . . . . S STATUS=$P(RECORD,U)
"RTN","PRCB1A3",73,0)
 . . . . I STATUS=0 S STATUS="(ACTIVE)"
"RTN","PRCB1A3",74,0)
 . . . . I STATUS=1 S STATUS="(INACTIVE)"
"RTN","PRCB1A3",75,0)
 . . . . S CP1=$E($P(RECORD,U,2),1,20)
"RTN","PRCB1A3",76,0)
 . . . . S CC=$P(RECORD,U,3)
"RTN","PRCB1A3",77,0)
 . . . . S CC=$G(^PRCD(420.1,CC,0))
"RTN","PRCB1A3",78,0)
 . . . . S CC=$E($P(CC,U),1,45)
"RTN","PRCB1A3",79,0)
 . . . . S ACC=$P(RECORD,U,4)
"RTN","PRCB1A3",80,0)
 . . . . I STN'=STN1 S FUND1=FUND W !!,STN,?6,FUND S LN=LN+1
"RTN","PRCB1A3",81,0)
 . . . . I FUND'=FUND1 S CP2=CP1 W !!,?7,FUND,!,?9,CP1," ",STATUS S LN=LN+1
"RTN","PRCB1A3",82,0)
 . . . . I CP1'=CP2 W !!,?9,CP1," ",STATUS S LN=LN+1
"RTN","PRCB1A3",83,0)
 . . . . W !,?13,CC,?60,ACC S LN=LN+1
"RTN","PRCB1A3",84,0)
 . . . . I STN'=STN1 S STN1=STN
"RTN","PRCB1A3",85,0)
 . . . . I FUND'=FUND1 S FUND1=FUND
"RTN","PRCB1A3",86,0)
 . . . . I CP1'=CP2 S CP2=CP1
"RTN","PRCB1A3",87,0)
 . . . . I LN>LN1 D HDR:'PAGE1 Q:ABORT 
"RTN","PRCB1A3",88,0)
 ;
"RTN","PRCB1A3",89,0)
 I 'ABORT W !!,"<End of Report>" R:SCREEN X:100
"RTN","PRCB1A3",90,0)
 D ^%ZISC
"RTN","PRCB1A3",91,0)
 Q
"RTN","PRCB1A3",92,0)
 ;
"RTN","PRCB1A3",93,0)
 ;--------------------------------------------------------------------
"RTN","PRCB1A3",94,0)
PROCESS ; determine if exception exists
"RTN","PRCB1A3",95,0)
 S EXC=0
"RTN","PRCB1A3",96,0)
 ;
"RTN","PRCB1A3",97,0)
 I $E(FUND,1,4)="0160" D
"RTN","PRCB1A3",98,0)
 . I CC<820100 S EXC=1
"RTN","PRCB1A3",99,0)
 . I CC>836400,CC<860100 S EXC=1
"RTN","PRCB1A3",100,0)
 . I CC>860300,CC<875000 S EXC=1
"RTN","PRCB1A3",101,0)
 . I CC>875200,CC<895900 S EXC=1
"RTN","PRCB1A3",102,0)
 . I CC>895900,CC<899100 S EXC=1
"RTN","PRCB1A3",103,0)
 . I CC>899600 S EXC=1
"RTN","PRCB1A3",104,0)
 . Q
"RTN","PRCB1A3",105,0)
 ;
"RTN","PRCB1A3",106,0)
 I $E(FUND,1,4)="0152" D
"RTN","PRCB1A3",107,0)
 . I CC<800100 S EXC=1
"RTN","PRCB1A3",108,0)
 . I CC>808300,CC<840100 S EXC=1
"RTN","PRCB1A3",109,0)
 . I CC>847000,CC<860500 S EXC=1
"RTN","PRCB1A3",110,0)
 . I CC>861700,CC<864900 S EXC=1
"RTN","PRCB1A3",111,0)
 . I CC>866000,CC<895000 S EXC=1
"RTN","PRCB1A3",112,0)
 . I CC>895900 S EXC=1
"RTN","PRCB1A3",113,0)
 . I CC=863100 S EXC=0
"RTN","PRCB1A3",114,0)
 . Q
"RTN","PRCB1A3",115,0)
 ;
"RTN","PRCB1A3",116,0)
 I $E(FUND,1,4)="0162" D
"RTN","PRCB1A3",117,0)
 . I CC<850100 S EXC=1
"RTN","PRCB1A3",118,0)
 . I CC>857500,CC<860400 S EXC=1
"RTN","PRCB1A3",119,0)
 . I CC>860400,CC<862100 S EXC=1
"RTN","PRCB1A3",120,0)
 . I CC>862300 S EXC=1
"RTN","PRCB1A3",121,0)
 . I CC=824300 S EXC=0
"RTN","PRCB1A3",122,0)
 . Q
"RTN","PRCB1A3",123,0)
 ;
"RTN","PRCB1A3",124,0)
 Q
"RTN","PRCB1A3",125,0)
 ;
"RTN","PRCB1A3",126,0)
 ;--------------------------------------------------------------
"RTN","PRCB1A3",127,0)
HDR ;PRINT THE HEADER
"RTN","PRCB1A3",128,0)
 I SCREEN,PAGE R !!,"Hit <RETURN> to continue, '^' to Exit ",X:100
"RTN","PRCB1A3",129,0)
 ;
"RTN","PRCB1A3",130,0)
 I SCREEN,X["^" S ABORT=1 Q
"RTN","PRCB1A3",131,0)
 ;
"RTN","PRCB1A3",132,0)
 S PAGE=$G(PAGE)+1
"RTN","PRCB1A3",133,0)
 W #
"RTN","PRCB1A3",134,0)
 W "CONTROL POINT LISTING W/EXCEPTIONS          "
"RTN","PRCB1A3",135,0)
 W "PRINTED BY: "_$$USER^PRCPUREP(DUZ)
"RTN","PRCB1A3",136,0)
 W !,"                                            "_TODAY
"RTN","PRCB1A3",137,0)
 W "     PAGE ",PAGE
"RTN","PRCB1A3",138,0)
 W !!,"STA#  FUND"
"RTN","PRCB1A3",139,0)
 W !,"         CONTROL POINT                                      ACC"
"RTN","PRCB1A3",140,0)
 W !,"             COST CENTER"
"RTN","PRCB1A3",141,0)
 W ! F L=1:1:80 W "-"
"RTN","PRCB1A3",142,0)
 S LN=8
"RTN","PRCB1A3",143,0)
 Q
"RTN","PRCHREC1")
0^1^B24270850^B23986631
"RTN","PRCHREC1",1,0)
PRCHREC1 ;ID/RSD,SF/TKW/RHD-CONT. OF RECEIVING ;2/9/93  14:53
"RTN","PRCHREC1",2,0)
V ;;5.1;IFCAP;**133,170,188**;Oct 20, 2000;Build 1
"RTN","PRCHREC1",3,0)
 ;Per VHA Directive 6402, this routine should not be modified.
"RTN","PRCHREC1",4,0)
 ;
"RTN","PRCHREC1",5,0)
 ;PRC*5.1*170 For receipt processing to insure the user is returned to 
"RTN","PRCHREC1",6,0)
 ;            the quantity query after any erroneous quantity entry.
"RTN","PRCHREC1",7,0)
 ;
"RTN","PRCHREC1",8,0)
 ;PRC*5.1*188 Remove the check for fractional quantity entered that
"RTN","PRCHREC1",9,0)
 ;            the fractional warning message will not appear if the
"RTN","PRCHREC1",10,0)
 ;            item has an item multiple or conversion factor that
"RTN","PRCHREC1",11,0)
 ;            would infer a non fractional entry, BUT will not be
"RTN","PRCHREC1",12,0)
 ;            allowed to be received into inventory because the 
"RTN","PRCHREC1",13,0)
 ;            quantity is still fractional.
"RTN","PRCHREC1",14,0)
 ;
"RTN","PRCHREC1",15,0)
EN1 S PRCHRQ3="",DA=PRCHPO,D="C",DIC="^PRC(442,DA,2,",DIC(0)="QZXE" W !!?3,"Item: ",X D IX^DIC Q:Y<0
"RTN","PRCHREC1",16,0)
 S PRCHRDY=+$O(^PRC(442,DA,2,"AB",PRCHRD,+Y,0)) S:'$D(^PRC(442,DA,2,+Y,3,PRCHRDY,0)) PRCHRDY=0 S:PRCHRDY PRCHRQ3=$P(^(0),U,2),$P(^(0),U,2)=0,$P(^(0),U,3)=0   ;PRC*5.1*170
"RTN","PRCHREC1",17,0)
 S PRCHRIT=Y,PRCHRQ1=$P(Y(0),U,2),$P(^PRC(442,DA,2,+Y,2),U,8)=$P(^PRC(442,DA,2,+Y,2),U,8)-PRCHRQ3,PRCHRQ2=$P(^(2),U,8),PRCHRAM=$P(^(2),U,1),PRCHRDA=+$P(^(2),U,6) D WP^PRCHREC2
"RTN","PRCHREC1",18,0)
 W !,"UNIT OF PRCH: ",$P($G(^PRCD(420.5,+$P(Y(0),U,3),0)),U,1),"        QTY ORDERED: ",PRCHRQ1,"        PREVIOUSLY RECEIVED: ",PRCHRQ2,!
"RTN","PRCHREC1",19,0)
 I $D(^TMP("PRCHREC4",$J)) W !
"RTN","PRCHREC1",20,0)
 F I=0:0 S I=$O(^TMP("PRCHREC4",$J,+$P(^PRC(442,DA,2,+PRCHRIT,0),U,1),I)) Q:'I  S X=^(I) W ?10,"Delv.Location: ",$P($G(^PRCS(410.8,+X,0)),U,1),?56,"Delv.Qty.:"_$J(+$P(X,U,2),4),!
"RTN","PRCHREC1",21,0)
 N PRCCKER,PRCHITIN,PRCHITRQ      ;PRC*5.1*188
"RTN","PRCHREC1",22,0)
 S PRCHITRQ=$P(^PRC(442,DA,2,+PRCHRIT,0),U,11) I PRCHITRQ'="" S PRCHITIN=$P($G(^PRCS(410,PRCHITRQ,0)),U,6)
"RTN","PRCHREC1",23,0)
ENQTY W !?3,"QTY BEING RECEIVED: ",PRCHRQ3 W:PRCHRQ3]"" "// "
"RTN","PRCHREC1",24,0)
 S PRCHRTP=0,PRCCKER=0 R PRCHRQ:DTIME I PRCHRDY G DEL1^PRCHREC2:PRCHRQ="@" S:PRCHRQ3&((PRCHRQ="")!(PRCHRQ["^")) PRCHRQ=PRCHRQ3
"RTN","PRCHREC1",25,0)
 I PRCHRQ=""!(PRCHRQ["^") Q   ;PRC*5.1*170
"RTN","PRCHREC1",26,0)
 I PRCHRQ'=+PRCHRQ!(PRCHRQ<0)!(PRCHRQ?.E1"."3N.N) G HLP    ;PRC*5.1*170
"RTN","PRCHREC1",27,0)
 I $P(PRCHRQ,".",2)>0 D
"RTN","PRCHREC1",28,0)
 . W !,"This appears to be an inventory item that will have PURCHASE ORDER RECEIVING TO"
"RTN","PRCHREC1",29,0)
 . W !,"INVENTORY. You CANNOT enter a fractional quantity as it WILL NOT be allowed to"
"RTN","PRCHREC1",30,0)
 . W !,"be received into Inventory.  Please OK the fractional amount is for a non"
"RTN","PRCHREC1",31,0)
 . W !,"inventory receipt.",!
"RTN","PRCHREC1",32,0)
 . W $C(7) S %A="Receiving a fractional quantity, is this a non-inventory item receipt",%B="",%=2 D ^PRCFYN I %'=1 S PRCCKER=1
"RTN","PRCHREC1",33,0)
 I PRCCKER=1 G ENQTY  ;PRC*5.1*170
"RTN","PRCHREC1",34,0)
 I PRCHRQ>(PRCHRQ1-PRCHRQ2) W $C(7) S %A="  You are receiving an overage, do you want to continue",%B="",%=2 D ^PRCFYN G ENQTY:%'=1  S PRCHROV=""   ;PRC*5.1*170
"RTN","PRCHREC1",35,0)
 ;
"RTN","PRCHREC1",36,0)
EN3 I PRCHRQ'=PRCHRQ1 S PRCHRAM=$P(^PRC(442,PRCHPO,2,+PRCHRIT,0),U,9),PRCHRAM=$J(PRCHRAM*PRCHRQ,0,2),PRCHRDA=PRCHRDA/PRCHRQ1*PRCHRQ
"RTN","PRCHREC1",37,0)
 K DIC I 'PRCHRDY S DA(2)=PRCHPO,DA(1)=+PRCHRIT,DIC="^PRC(442,DA(2),2,DA(1),3,",DIC(0)="LX",DLAYGO=442,X=PRCHRD S:'$D(@(DIC_"0)")) ^(0)="^442.08DA^^0" D ^DIC K DIC,DA,DLAYGO Q:Y<0  S PRCHRDY=+Y
"RTN","PRCHREC1",38,0)
 S $P(^(2),U,8)=$P(^PRC(442,PRCHPO,2,+PRCHRIT,2),U,8)+PRCHRQ,$P(^PRC(442,PRCHPO,2,+PRCHRIT,3,PRCHRDY,0),U,2,3)=PRCHRQ_U_+PRCHRAM,$P(^(0),U,5)=PRCHRDA
"RTN","PRCHREC1",39,0)
 W:'PRCHRTP ?35,"AMOUNT: ",PRCHRAM
"RTN","PRCHREC1",40,0)
 D:$P(PRC("PARAM"),U,7)=2 ^PRCHREC7 Q
"RTN","PRCHREC1",41,0)
 ;
"RTN","PRCHREC1",42,0)
LI R !!!,"LINE ITEM: ",X:DTIME G 2^PRCHREC:X=""!(X["^"),HLP1:$E(X)="?",LI1:"Aa"[$E(X),COM:"Cc"[$E(X)
"RTN","PRCHREC1",43,0)
 S X1="" F I=1:1 S Y=$P(X,",",I) Q:Y=""  S:Y'[":"&(Y?1N.N) X1=X1_Y_",",Y="" I Y]"" K:Y'[":"!($P(Y,":",1)'?1N.N)!($P(Y,":",2)'?1N.N) X Q:'$D(X)  S X1=X1_+Y_":1:"_$P(Y,":",2)_","
"RTN","PRCHREC1",44,0)
 G:'$D(X) 2^PRCHREC S X=$E(X1,1,$L(X1)-1) X "F PRCHX="_X_" S X=PRCHX D EN1"
"RTN","PRCHREC1",45,0)
 G LI
"RTN","PRCHREC1",46,0)
 ;
"RTN","PRCHREC1",47,0)
LI1 S PRCHX=0 F I=0:0 S PRCHX=$O(^PRC(442,PRCHPO,2,"C",PRCHX)) Q:PRCHX=""!(PRCHX'>0)  S X=PRCHX D EN1
"RTN","PRCHREC1",48,0)
 G LI
"RTN","PRCHREC1",49,0)
 ;
"RTN","PRCHREC1",50,0)
COM S %A="   Complete P.O. as is",%B="",%=1 D ^PRCFYN G:$D(PRCHIMP)&(%'=1) 2^PRCHREC G:%'=1 LI
"RTN","PRCHREC1",51,0)
 ;
"RTN","PRCHREC1",52,0)
COM1 ;ENTRY POINT FOR AUTOMATIC GENERATION OF PROOF OF ORDER FOR GUARANTEED DELIVERY P.O.S
"RTN","PRCHREC1",53,0)
 S I=0 F  S I=$O(^PRC(442,PRCHPO,2,"C",I)) Q:I=""!(I'>0)  S PRCHRIT=+$O(^(I,0))_"^"_I,PRCHRQ1=$P(^PRC(442,PRCHPO,2,+PRCHRIT,0),U,2),PRCHRQ2=$P(^(2),U,8),PRCHRAM=$P(^(2),U,1),PRCHRDA=$P(^(2),U,6) D COM2
"RTN","PRCHREC1",54,0)
 G 2^PRCHREC
"RTN","PRCHREC1",55,0)
 ;
"RTN","PRCHREC1",56,0)
COM2 Q:$O(^PRC(442,PRCHPO,2,"AB",PRCHRD,+PRCHRIT,0))&($D(^PRC(442,PRCHPO,2,+PRCHRIT,3,+$O(^(0)),0)))  S PRCHRTP=1,PRCHRQ=PRCHRQ1-PRCHRQ2,PRCHRDY=0 S:PRCHRQ<0 PRCHRQ=0 D EN3
"RTN","PRCHREC1",57,0)
 Q
"RTN","PRCHREC1",58,0)
 ;
"RTN","PRCHREC1",59,0)
HLP W !?3,"Enter a number between .01 and 99999" W:PRCHRDY " or '@' to delete" W "."
"RTN","PRCHREC1",60,0)
 G ENQTY   ;PRC*5.1*170
"RTN","PRCHREC1",61,0)
 ;
"RTN","PRCHREC1",62,0)
HLP1 W !?3,"Enter a Line Item number in the following format: 1,2,3,4 or 1:4 .",!?3,"You may also enter 'C' to complete P.O. as is, or 'A' to see all items."
"RTN","PRCHREC1",63,0)
 S X="??",D="C",DA=PRCHPO,DIC="^PRC(442,DA,2,",DIC(0)="QEM",DIC("S")="I '$D(^PRC(442,DA,2,""AB"",+Y))" D IX^DIC K DIC
"RTN","PRCHREC1",64,0)
 G LI
"VER")
8.0^22.0
"BLD",7574,6)
^163
**END**
**END**

