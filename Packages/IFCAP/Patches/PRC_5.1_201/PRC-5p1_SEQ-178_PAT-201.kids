Released PRC*5.1*201 SEQ #178
Extracted from mail message
**KIDS**:PRC*5.1*201^

**INSTALL NAME**
PRC*5.1*201
"BLD",10764,0)
PRC*5.1*201^IFCAP^0^3171117^y
"BLD",10764,1,0)
^^3^3^3171117^
"BLD",10764,1,1,0)
When the user enters a "^^" into Copy Control Point User and Profiles
"BLD",10764,1,2,0)
[PRCB FCP USER COPY] option to exit out and then enters a "^" it receives 
"BLD",10764,1,3,0)
and error.
"BLD",10764,4,0)
^9.64PA^^
"BLD",10764,6.3)
1
"BLD",10764,"ABPKG")
n
"BLD",10764,"INID")
n^n^n
"BLD",10764,"KRN",0)
^9.67PA^779.2^20
"BLD",10764,"KRN",.4,0)
.4
"BLD",10764,"KRN",.401,0)
.401
"BLD",10764,"KRN",.402,0)
.402
"BLD",10764,"KRN",.403,0)
.403
"BLD",10764,"KRN",.5,0)
.5
"BLD",10764,"KRN",.84,0)
.84
"BLD",10764,"KRN",3.6,0)
3.6
"BLD",10764,"KRN",3.8,0)
3.8
"BLD",10764,"KRN",9.2,0)
9.2
"BLD",10764,"KRN",9.8,0)
9.8
"BLD",10764,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10764,"KRN",9.8,"NM",1,0)
PRCB1A4^^0^B18983576
"BLD",10764,"KRN",9.8,"NM","B","PRCB1A4",1)

"BLD",10764,"KRN",19,0)
19
"BLD",10764,"KRN",19,"NM",0)
^9.68A^^0
"BLD",10764,"KRN",19.1,0)
19.1
"BLD",10764,"KRN",101,0)
101
"BLD",10764,"KRN",409.61,0)
409.61
"BLD",10764,"KRN",771,0)
771
"BLD",10764,"KRN",779.2,0)
779.2
"BLD",10764,"KRN",870,0)
870
"BLD",10764,"KRN",8989.51,0)
8989.51
"BLD",10764,"KRN",8989.52,0)
8989.52
"BLD",10764,"KRN",8994,0)
8994
"BLD",10764,"KRN","B",.4,.4)

"BLD",10764,"KRN","B",.401,.401)

"BLD",10764,"KRN","B",.402,.402)

"BLD",10764,"KRN","B",.403,.403)

"BLD",10764,"KRN","B",.5,.5)

"BLD",10764,"KRN","B",.84,.84)

"BLD",10764,"KRN","B",3.6,3.6)

"BLD",10764,"KRN","B",3.8,3.8)

"BLD",10764,"KRN","B",9.2,9.2)

"BLD",10764,"KRN","B",9.8,9.8)

"BLD",10764,"KRN","B",19,19)

"BLD",10764,"KRN","B",19.1,19.1)

"BLD",10764,"KRN","B",101,101)

"BLD",10764,"KRN","B",409.61,409.61)

"BLD",10764,"KRN","B",771,771)

"BLD",10764,"KRN","B",779.2,779.2)

"BLD",10764,"KRN","B",870,870)

"BLD",10764,"KRN","B",8989.51,8989.51)

"BLD",10764,"KRN","B",8989.52,8989.52)

"BLD",10764,"KRN","B",8994,8994)

"BLD",10764,"QDEF")
^^^^^^^^^^YES
"BLD",10764,"QUES",0)
^9.62^^
"BLD",10764,"REQB",0)
^9.611^1^1
"BLD",10764,"REQB",1,0)
PRC*5.1*76^2
"BLD",10764,"REQB","B","PRC*5.1*76",1)

"MBREQ")
0
"PKG",455,-1)
1^1
"PKG",455,0)
IFCAP^PRC^IFCAP System Files
"PKG",455,20,0)
^9.402P^^
"PKG",455,22,0)
^9.49I^1^1
"PKG",455,22,1,0)
5.1
"PKG",455,22,1,"PAH",1,0)
201^3171117
"PKG",455,22,1,"PAH",1,1,0)
^^3^3^3171117
"PKG",455,22,1,"PAH",1,1,1,0)
When the user enters a "^^" into Copy Control Point User and Profiles
"PKG",455,22,1,"PAH",1,1,2,0)
[PRCB FCP USER COPY] option to exit out and then enters a "^" it receives 
"PKG",455,22,1,"PAH",1,1,3,0)
and error.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PRCB1A4")
0^1^B18983576^B18973292
"RTN","PRCB1A4",1,0)
PRCB1A4 ;WOIFO/DWA-COPY FCP USERS TO NEW FCP ;3/8/04 2:22 PM
"RTN","PRCB1A4",2,0)
 ;;5.1;IFCAP;**76,201**;Oct 20, 2000;Build 1
"RTN","PRCB1A4",3,0)
 ;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCB1A4",4,0)
 ;
"RTN","PRCB1A4",5,0)
V ; invalid entry
"RTN","PRCB1A4",6,0)
 Q
"RTN","PRCB1A4",7,0)
 ;
"RTN","PRCB1A4",8,0)
 ; this routine will copy users from an existing Fund Control Point
"RTN","PRCB1A4",9,0)
 ; to an empty Fund Control Point.
"RTN","PRCB1A4",10,0)
 ; 
"RTN","PRCB1A4",11,0)
EN ;
"RTN","PRCB1A4",12,0)
 S PRCF("X")="AS" D ^PRCFSITE I '$G(PRC("SITE")) Q
"RTN","PRCB1A4",13,0)
 S SITE=PRC("SITE")
"RTN","PRCB1A4",14,0)
 ;
"RTN","PRCB1A4",15,0)
 ;
"RTN","PRCB1A4",16,0)
 N FCP1,FCP2,PRFL,DIC,DIR,I,X,Y,FLDS,BY,TO,FR,IOP,L,B,PRCNT,PRCLAST
"RTN","PRCB1A4",17,0)
 ;
"RTN","PRCB1A4",18,0)
FROM ; prompt for FCP to copy FROM
"RTN","PRCB1A4",19,0)
 S DIR(0)="NA^1:9999^I 'X!('$D(^PRC(420,SITE,1,Y))) K X",DIR("A")="Select FCP to copy FROM: ",DIR("?")="Answer must be a valid 1-4 digit Fund Control Point number." D ^DIR K DIR
"RTN","PRCB1A4",20,0)
 I $G(DIRUT) G QUIT
"RTN","PRCB1A4",21,0)
 I 'Y G FROM
"RTN","PRCB1A4",22,0)
 S FCP1=Y K X,Y
"RTN","PRCB1A4",23,0)
 ;
"RTN","PRCB1A4",24,0)
DISPLAY ; display the user profiles for the chosen FCP
"RTN","PRCB1A4",25,0)
 W !!
"RTN","PRCB1A4",26,0)
 S L=0,DIC="^PRC(420,SITE,1,FCP1,1,",FLDS=".01;L20,1;L23,2;C51,3;C68",IOP=IO,BY=".01",FR=",",TO="",DHD="Control Point Users List "_FCP1 D EN1^DIP K DIC
"RTN","PRCB1A4",27,0)
 I '$D(^PRC(420,SITE,1,FCP1,1)) W !,?15,"*** NO USERS FOUND ***",!! G FROM
"RTN","PRCB1A4",28,0)
 I $P($G(^PRC(420,SITE,1,FCP1,1,0)),"^",3)="" W ! G FROM
"RTN","PRCB1A4",29,0)
 I '$$CONFRM(FCP1,.X)
"RTN","PRCB1A4",30,0)
 I X=1 G FROM
"RTN","PRCB1A4",31,0)
 I X=0 G QUIT
"RTN","PRCB1A4",32,0)
 I X=2 D
"RTN","PRCB1A4",33,0)
 . S X="^PRC(420,SITE,1,FCP1,1,",B=3
"RTN","PRCB1A4",34,0)
 . D ICLOCK^PRC0B(X,.B)
"RTN","PRCB1A4",35,0)
 . I 'B W !,"Someone else is using that FCP, please try later."
"RTN","PRCB1A4",36,0)
 . Q
"RTN","PRCB1A4",37,0)
 I 'B G FROM
"RTN","PRCB1A4",38,0)
 ;
"RTN","PRCB1A4",39,0)
GETFCP ; get the FCP to copy TO
"RTN","PRCB1A4",40,0)
 S DIR(0)="NA^1:9999^K:'$D(^PRC(420,SITE,1,Y))!('X) X",DIR("A")="Select FCP to copy TO: ",DIR("?")="Answer must be a valid 1-4 digit Fund Control Point number." D ^DIR K DIR
"RTN","PRCB1A4",41,0)
 I X="^" D DCLOCK^PRC0B("^PRC(420,SITE,1,FCP1,1,") G QUIT
"RTN","PRCB1A4",42,0)
 S FCP2=Y K X,Y
"RTN","PRCB1A4",43,0)
 I '$$CONFRM2(FCP2,.X) D DCLOCK^PRC0B("^PRC(420,SITE,1,FCP1,1,") G QUIT
"RTN","PRCB1A4",44,0)
 I X=1 G GETFCP
"RTN","PRCB1A4",45,0)
 I $P($G(^PRC(420,SITE,1,FCP2,1,0)),"^",3)'="" D  G QUIT
"RTN","PRCB1A4",46,0)
 . W !!,"I cannot complete the copy, FCP ==> "_FCP2_" is not empty."
"RTN","PRCB1A4",47,0)
 ;
"RTN","PRCB1A4",48,0)
 I X=2 S X="^PRC(420,SITE,1,FCP2,1,",B=3
"RTN","PRCB1A4",49,0)
 D ICLOCK^PRC0B(X,.B)
"RTN","PRCB1A4",50,0)
 I 'B W !,"Someone else is using that FCP, please try later." G GETFCP
"RTN","PRCB1A4",51,0)
 ;
"RTN","PRCB1A4",52,0)
XTRCT ;
"RTN","PRCB1A4",53,0)
 S PRCNT=0,PRCLAST=0
"RTN","PRCB1A4",54,0)
 S PRFL=0 F  S PRFL=$O(^PRC(420,SITE,1,FCP1,1,PRFL)) Q:'PRFL  D
"RTN","PRCB1A4",55,0)
 . S DIC="^PRC(420,SITE,1,FCP1,1,",DIC(0)="V,Z",X=PRFL
"RTN","PRCB1A4",56,0)
 . D ^DIC S PRFL(X)=Y(0,0)_"^"_Y(0)
"RTN","PRCB1A4",57,0)
 . S PRCNT=$G(PRCNT)+1,PRCLAST=$P(PRFL(X),"^",2)
"RTN","PRCB1A4",58,0)
 . Q
"RTN","PRCB1A4",59,0)
 ;
"RTN","PRCB1A4",60,0)
COPY ; copy records to new FCP, setup cross references as needed
"RTN","PRCB1A4",61,0)
 S X=0 F  S X=$O(PRFL(X)) Q:'X  D
"RTN","PRCB1A4",62,0)
 . S ^PRC(420,SITE,1,FCP2,1,X,0)=^PRC(420,SITE,1,FCP1,1,X,0)
"RTN","PRCB1A4",63,0)
 . S:$D(^PRC(420,SITE,1,FCP1,1,X,2)) ^PRC(420,SITE,1,FCP2,1,X,2)=^PRC(420,SITE,1,FCP1,1,X,2)
"RTN","PRCB1A4",64,0)
 . I $P(PRFL(X),"^",3)]"" D
"RTN","PRCB1A4",65,0)
 . . S ^PRC(420,"A",X,SITE,FCP2,$P(PRFL(X),"^",3))=""
"RTN","PRCB1A4",66,0)
 . S ^PRC(420,"C",X,SITE,FCP2,X)=""
"RTN","PRCB1A4",67,0)
 S $P(^PRC(420,SITE,1,FCP2,1,0),"^",2)="420.02IPA" ; define subfile
"RTN","PRCB1A4",68,0)
 S $P(^PRC(420,SITE,1,FCP2,1,0),"^",4)=PRCNT  ; keep users counted
"RTN","PRCB1A4",69,0)
 S $P(^PRC(420,SITE,1,FCP2,1,0),"^",3)=PRCLAST ; last user added
"RTN","PRCB1A4",70,0)
 W !!,"The FCP copy has been completed.",!
"RTN","PRCB1A4",71,0)
 Q
"RTN","PRCB1A4",72,0)
 ;
"RTN","PRCB1A4",73,0)
UNLCK ; unlock
"RTN","PRCB1A4",74,0)
 ;Q:'$G(FCP1)
"RTN","PRCB1A4",75,0)
 D DCLOCK^PRC0B("^PRC(420,SITE,1,FCP1,1,")
"RTN","PRCB1A4",76,0)
 D DCLOCK^PRC0B("^PRC(420,SITE,1,FCP2,1,")
"RTN","PRCB1A4",77,0)
 ;
"RTN","PRCB1A4",78,0)
QUIT ;
"RTN","PRCB1A4",79,0)
 K DLAYGO,DIC,X,Y,FCP1,FCP2,PRC,DIR,PRFL,PRCF,PRCNT,PRCLAST,SITE
"RTN","PRCB1A4",80,0)
 Q
"RTN","PRCB1A4",81,0)
 ;
"RTN","PRCB1A4",82,0)
CONFRM(FCP,X) ; ask if these are the records that user wishes to copy
"RTN","PRCB1A4",83,0)
 W !!,?10,"PLEASE NOTE: THE FCP 'TO COPY TO' MUST BE EMPTY."
"RTN","PRCB1A4",84,0)
 W !!,"If you choose to use this option you must copy all users and their profiles."
"RTN","PRCB1A4",85,0)
 W !!,"Are these the correct users to copy?"
"RTN","PRCB1A4",86,0)
 S DIR(0)="Y",DIR("B")="YES",DIR("?")="Answer YES if these are the correct users to copy, NO to choose a different FCP, or ""^"" to QUIT."
"RTN","PRCB1A4",87,0)
 D ^DIR K DIR
"RTN","PRCB1A4",88,0)
 I 'Y S X=1
"RTN","PRCB1A4",89,0)
 I Y="^" S X=0
"RTN","PRCB1A4",90,0)
 I Y S X=2
"RTN","PRCB1A4",91,0)
 Q X
"RTN","PRCB1A4",92,0)
 ;
"RTN","PRCB1A4",93,0)
CONFRM2(FCP,X) ; confirm that the TO FCP is correct
"RTN","PRCB1A4",94,0)
 W !!,"Copy users from "_FCP1_" to "_FCP_"?"
"RTN","PRCB1A4",95,0)
 S DIR(0)="Y",DIR("B")="YES",DIR("?")="Answer YES to copy, NO to choose a different FCP, or ""^"" to QUIT."
"RTN","PRCB1A4",96,0)
 D ^DIR K DIR
"RTN","PRCB1A4",97,0)
 I 'Y S X=1
"RTN","PRCB1A4",98,0)
 I Y="^" S X=0
"RTN","PRCB1A4",99,0)
 I Y S X=2
"RTN","PRCB1A4",100,0)
 Q X
"VER")
8.0^22.2
"BLD",10764,6)
^178
**END**
**END**

