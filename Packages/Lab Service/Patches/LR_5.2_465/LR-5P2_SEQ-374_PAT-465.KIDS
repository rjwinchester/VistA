Released LR*5.2*465 SEQ #374
Extracted from mail message
**KIDS**:LR*5.2*465^

**INSTALL NAME**
LR*5.2*465
"BLD",9805,0)
LR*5.2*465^LAB SERVICE^0^3160922^y
"BLD",9805,4,0)
^9.64PA^60^1
"BLD",9805,4,60,0)
60
"BLD",9805,4,60,2,0)
^9.641^60.15^1
"BLD",9805,4,60,2,60.15,0)
INSTITUTION EXTRA LABELS  (sub-file)
"BLD",9805,4,60,2,60.15,1,0)
^9.6411^^0
"BLD",9805,4,60,222)
y^n^p^^^^n^^n
"BLD",9805,4,60,224)

"BLD",9805,4,"APDD",60,60.15)

"BLD",9805,4,"B",60,60)

"BLD",9805,6.3)
25
"BLD",9805,"ABPKG")
n
"BLD",9805,"KRN",0)
^9.67PA^779.2^20
"BLD",9805,"KRN",.4,0)
.4
"BLD",9805,"KRN",.401,0)
.401
"BLD",9805,"KRN",.402,0)
.402
"BLD",9805,"KRN",.402,"NM",0)
^9.68A^2^2
"BLD",9805,"KRN",.402,"NM",1,0)
LR ATOMIC TESTS    FILE #60^60^0
"BLD",9805,"KRN",.402,"NM",2,0)
LR COSMIC TESTS    FILE #60^60^0
"BLD",9805,"KRN",.402,"NM","B","LR ATOMIC TESTS    FILE #60",1)

"BLD",9805,"KRN",.402,"NM","B","LR COSMIC TESTS    FILE #60",2)

"BLD",9805,"KRN",.403,0)
.403
"BLD",9805,"KRN",.5,0)
.5
"BLD",9805,"KRN",.84,0)
.84
"BLD",9805,"KRN",3.6,0)
3.6
"BLD",9805,"KRN",3.8,0)
3.8
"BLD",9805,"KRN",9.2,0)
9.2
"BLD",9805,"KRN",9.8,0)
9.8
"BLD",9805,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9805,"KRN",9.8,"NM",1,0)
LRLABLD^^0^B35119838
"BLD",9805,"KRN",9.8,"NM","B","LRLABLD",1)

"BLD",9805,"KRN",19,0)
19
"BLD",9805,"KRN",19.1,0)
19.1
"BLD",9805,"KRN",101,0)
101
"BLD",9805,"KRN",409.61,0)
409.61
"BLD",9805,"KRN",771,0)
771
"BLD",9805,"KRN",779.2,0)
779.2
"BLD",9805,"KRN",870,0)
870
"BLD",9805,"KRN",8989.51,0)
8989.51
"BLD",9805,"KRN",8989.52,0)
8989.52
"BLD",9805,"KRN",8994,0)
8994
"BLD",9805,"KRN","B",.4,.4)

"BLD",9805,"KRN","B",.401,.401)

"BLD",9805,"KRN","B",.402,.402)

"BLD",9805,"KRN","B",.403,.403)

"BLD",9805,"KRN","B",.5,.5)

"BLD",9805,"KRN","B",.84,.84)

"BLD",9805,"KRN","B",3.6,3.6)

"BLD",9805,"KRN","B",3.8,3.8)

"BLD",9805,"KRN","B",9.2,9.2)

"BLD",9805,"KRN","B",9.8,9.8)

"BLD",9805,"KRN","B",19,19)

"BLD",9805,"KRN","B",19.1,19.1)

"BLD",9805,"KRN","B",101,101)

"BLD",9805,"KRN","B",409.61,409.61)

"BLD",9805,"KRN","B",771,771)

"BLD",9805,"KRN","B",779.2,779.2)

"BLD",9805,"KRN","B",870,870)

"BLD",9805,"KRN","B",8989.51,8989.51)

"BLD",9805,"KRN","B",8989.52,8989.52)

"BLD",9805,"KRN","B",8994,8994)

"BLD",9805,"QDEF")
^^^^NO^^^^NO^^YES
"BLD",9805,"QUES",0)
^9.62^^
"BLD",9805,"REQB",0)
^9.611^1^1
"BLD",9805,"REQB",1,0)
LR*5.2*218^1
"BLD",9805,"REQB","B","LR*5.2*218",1)

"FIA",60)
LABORATORY TEST
"FIA",60,0)
^LAB(60,
"FIA",60,0,0)
60I
"FIA",60,0,1)
y^n^p^^^^n^^n
"FIA",60,0,10)

"FIA",60,0,11)

"FIA",60,0,"RLRO")

"FIA",60,0,"VR")
5.2^LR
"FIA",60,60)
1
"FIA",60,60,16.1)

"FIA",60,60.15)
0
"KRN",.402,60,-1)
0^1
"KRN",.402,60,0)
LR ATOMIC TESTS^3160419.1449^^60^^^3160901
"KRN",.402,60,"DIAB",1,1,60.1,0)
ALL
"KRN",.402,60,"DIAB",1,1,60.12,0)
ALL
"KRN",.402,60,"DIAB",1,1,60.13,0)
ALL
"KRN",.402,60,"DIAB",1,1,60.15,0)
ALL
"KRN",.402,60,"DR",1,60)
.01;2;3;4;400;100;500.1;500;16.1;
"KRN",.402,60,"DR",2,60.01)
.01:9;13;
"KRN",.402,60,"DR",2,60.1)
.01
"KRN",.402,60,"DR",2,60.12)
.01:3
"KRN",.402,60,"DR",2,60.13)
.01;2
"KRN",.402,60,"DR",2,60.15)
.01:1
"KRN",.402,60,"DR",3,60.07)
.01
"KRN",.402,61,-1)
0^2
"KRN",.402,61,0)
LR COSMIC TESTS^3160419.1457^^60^^^3160902
"KRN",.402,61,"DIAB",1,1,60.02,0)
ALL
"KRN",.402,61,"DIAB",1,1,60.1,0)
ALL
"KRN",.402,61,"DIAB",1,1,60.11,0)
ALL
"KRN",.402,61,"DIAB",1,1,60.12,0)
ALL
"KRN",.402,61,"DIAB",1,1,60.15,0)
ALL
"KRN",.402,61,"DR",1,60)
2;3;6;7;8;9;200;300;500;16.1;
"KRN",.402,61,"DR",2,60.02)
.01:.02
"KRN",.402,61,"DR",2,60.03)
.01:1;3:5;
"KRN",.402,61,"DR",2,60.1)
.01
"KRN",.402,61,"DR",2,60.11)
.01:1
"KRN",.402,61,"DR",2,60.12)
.01:3
"KRN",.402,61,"DR",2,60.15)
.01:1
"KRN",.402,61,"DR",3,60.04)
.01
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",6,-1)
1^1
"PKG",6,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",6,20,0)
^9.402P^1^1
"PKG",6,20,1,0)
2^^LRXDRPT
"PKG",6,20,1,1)

"PKG",6,20,"B",2,1)

"PKG",6,22,0)
^9.49I^1^1
"PKG",6,22,1,0)
5.2^2940927^2941103
"PKG",6,22,1,"PAH",1,0)
465^3160922^4780
"PKG",6,22,1,"PAH",1,1,0)
^^1^1^3160901
"PKG",6,22,1,"PAH",1,1,1,0)
Please see forum for a complete description of patch LR*5.2*465
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","LRLABLD")
0^1^B35119838^B26400973
"RTN","LRLABLD",1,0)
LRLABLD ;DALOI/TGA/JMC - LABELS ON DEMAND ; 08/29/16@12:21pm
"RTN","LRLABLD",2,0)
 ;;5.2;LAB SERVICE;**65,161,218,465**;Sep 27, 1994;Build 25
"RTN","LRLABLD",3,0)
 ;CHY/RTW/JAH added LR*5.2*465 institution extra labels selection
"RTN","LRLABLD",4,0)
ENT ;
"RTN","LRLABLD",5,0)
 ; Called by LROE
"RTN","LRLABLD",6,0)
 S U="^"
"RTN","LRLABLD",7,0)
 D PSET
"RTN","LRLABLD",8,0)
 S LRLABLIO=IO
"RTN","LRLABLD",9,0)
 S LRAA=0
"RTN","LRLABLD",10,0)
 F  S LRAA=$O(LRLBL(LRAA)) Q:LRAA<1  D EN2
"RTN","LRLABLD",11,0)
 K LRBAR,LRBAR1,LRBAR0,LRBARID,LREND,LRI,LRN,LROK,LRURG,LRURG0,LRURGA
"RTN","LRLABLD",12,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","LRLABLD",13,0)
 E  D PKILL^%ZISP
"RTN","LRLABLD",14,0)
 Q
"RTN","LRLABLD",15,0)
 ;
"RTN","LRLABLD",16,0)
EN2 ;
"RTN","LRLABLD",17,0)
 D LBLTYP
"RTN","LRLABLD",18,0)
 D LRBAR
"RTN","LRLABLD",19,0)
 S LRAN=0
"RTN","LRLABLD",20,0)
 F  S LRAN=$O(LRLBL(LRAA,LRAN)) Q:LRAN<1  D
"RTN","LRLABLD",21,0)
 . N LRRB,LRLLOC
"RTN","LRLABLD",22,0)
 . S X=LRLBL(LRAA,LRAN),LRSN=+X,LRAD=$P(X,U,2),LRODT=$P(X,U,3),LRRB=$P(X,U,4),LRLLOC=$P(X,U,5),LRACC=$P(X,U,6),LRCE=$P(X,U,7)
"RTN","LRLABLD",23,0)
 . D GO
"RTN","LRLABLD",24,0)
 Q
"RTN","LRLABLD",25,0)
 ;
"RTN","LRLABLD",26,0)
GO ; From above, LRLABXT, LRPHLIS1
"RTN","LRLABLD",27,0)
 Q:'$D(^LRO(68,LRAA,1,LRAD,1,LRAN,3))
"RTN","LRLABLD",28,0)
 S LRDAT=$TR($$FMTE^XLFDT($P(^LRO(68,LRAA,1,LRAD,1,LRAN,3),U),"2MZ"),"@"," ") ; Date/time with "@" --> " "
"RTN","LRLABLD",29,0)
 S LRTJ=$P($G(^LRO(69,LRODT,1,LRSN,0)),U,3)
"RTN","LRLABLD",30,0)
 S LRTJDATA=$G(^LAB(62,+LRTJ,0))
"RTN","LRLABLD",31,0)
 S LRTOP=$P(LRTJDATA,U,3),S1=$P(LRTJDATA,U,4),S2=$P(LRTJDATA,U,5)
"RTN","LRLABLD",32,0)
 I LRTOP="" D
"RTN","LRLABLD",33,0)
 . S LRTOP=$G(^LRO(68,LRAA,1,LRAD,1,LRAN,5,1,0))
"RTN","LRLABLD",34,0)
 . I LRTOP>0 D
"RTN","LRLABLD",35,0)
 . . S T=$P($G(^LAB(62,+$P(LRTOP,U,2),0)),U,1)
"RTN","LRLABLD",36,0)
 . . S LRTOP=$P($G(^LAB(61,+LRTOP,0)),U,1),LRTOP=T_$S(LRTOP'=T:"  "_LRTOP,1:"")
"RTN","LRLABLD",37,0)
 . . S LRTJDATA=$G(^LAB(62,+LRTJ,0)),S1=$P(LRTJDATA,U,4),S2=$P(LRTJDATA,U,5)
"RTN","LRLABLD",38,0)
 S LRDFN=+$G(^LRO(68,LRAA,1,LRAD,1,LRAN,0))
"RTN","LRLABLD",39,0)
 S DFN=$P(^LR(LRDFN,0),U,3),LRDPF=$P(^(0),U,2),LRINFW=$P($G(^LR(LRDFN,.091)),U,1)
"RTN","LRLABLD",40,0)
 D PT^LRX Q:LREND
"RTN","LRLABLD",41,0)
 D UID,BARID
"RTN","LRLABLD",42,0)
 K LRTS,LRURG
"RTN","LRLABLD",43,0)
 ;
"RTN","LRLABLD",44,0)
 ; LRXL--use extra labels for the test but if the user is signed into
"RTN","LRLABLD",45,0)
 ; a division where extra labels are defined for that test by Institution
"RTN","LRLABLD",46,0)
 ; then use the Institution Extra Labels instead.  If there are multiple
"RTN","LRLABLD",47,0)
 ; test for this accession then accumulate the Extra Labels/Institution
"RTN","LRLABLD",48,0)
 ; Extra Labels for each test.
"RTN","LRLABLD",49,0)
 ;
"RTN","LRLABLD",50,0)
 S LRTVOL=0,LRURG0=9,LRXL=0
"RTN","LRLABLD",51,0)
 S T=0
"RTN","LRLABLD",52,0)
 F  S T=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,T)) Q:T<1  D
"RTN","LRLABLD",53,0)
 . S LRTV=$G(^LRO(68,LRAA,1,LRAD,1,LRAN,4,T,0))
"RTN","LRLABLD",54,0)
 . I LRTV,$P(LRTV,U,2)<49 D
"RTN","LRLABLD",55,0)
 . . S LRVOL=0
"RTN","LRLABLD",56,0)
 . . S:$P(LRTV,U,2)=1 LRURG=1
"RTN","LRLABLD",57,0)
 . . I $P(LRTV,U,2),$P(LRTV,U,2)<LRURG0 S LRURG0=$P(LRTV,U,2)
"RTN","LRLABLD",58,0)
 . . F LRSSP=0:0 S LRSSP=$O(^LAB(60,+LRTV,3,LRSSP)) Q:LRSSP<1  I LRTJ=+^(LRSSP,0) S LRVOL=$P(^(0),U,4),LRTVOL=LRTVOL+LRVOL
"RTN","LRLABLD",59,0)
 . . S LRTS(T)=$P($G(^LAB(60,+LRTV,.1)),U,1)
"RTN","LRLABLD",60,0)
 . . ;
"RTN","LRLABLD",61,0)
 . . ; save off extra labels for this lab test but only use if nothing
"RTN","LRLABLD",62,0)
 . . ; at the institution extra labels
"RTN","LRLABLD",63,0)
 . . N UPDTTEST,LRXLTST
"RTN","LRLABLD",64,0)
 . . S UPDTTEST=1,LRXLTST=0
"RTN","LRLABLD",65,0)
 . . S LRXLTST=+$P($G(^LAB(60,+LRTV,0)),U,15)
"RTN","LRLABLD",66,0)
 . . ; if there is extra labels specified for this user's division and it isn't null
"RTN","LRLABLD",67,0)
 . . ; then overide the VistA instance value for extra labels
"RTN","LRLABLD",68,0)
 . . I $D(^LAB(60,+LRTV,13,"B",DUZ(2))) D
"RTN","LRLABLD",69,0)
 . . . N LRK,LRIXK
"RTN","LRLABLD",70,0)
 . . . S LRK=$O(^LAB(60,+LRTV,13,"B",DUZ(2),0))
"RTN","LRLABLD",71,0)
 . . . I LRK>0 S LRIXK=$P($G(^LAB(60,+LRTV,13,LRK,0)),"^",2)
"RTN","LRLABLD",72,0)
 . . . I LRIXK'="" D
"RTN","LRLABLD",73,0)
 . . . .  S LRXL=LRXL+LRIXK
"RTN","LRLABLD",74,0)
 . . . .  S UPDTTEST=0
"RTN","LRLABLD",75,0)
 . .; update extra labels with Extra Labels for test if nothing was found for the institution.
"RTN","LRLABLD",76,0)
 . . I UPDTTEST S LRXL=LRXL+LRXLTST
"RTN","LRLABLD",77,0)
 ;
"RTN","LRLABLD",78,0)
 S LRN=$S(+S1=0:1,1:LRTVOL\S1+$S(LRTVOL#S1:1,LRTVOL=0:1,1:0))+LRXL
"RTN","LRLABLD",79,0)
 Q:LRN<1
"RTN","LRLABLD",80,0)
 S LRURGA=$$URGA(LRURG0)
"RTN","LRLABLD",81,0)
 F LRI=1:1:LRN D
"RTN","LRLABLD",82,0)
 . S I=LRI,N=LRN ; Label routines use "I" and  "N"
"RTN","LRLABLD",83,0)
 . N LRI,LRN
"RTN","LRLABLD",84,0)
 . S LRPREF=$S(S2="":"",LRTVOL>S2:"LARGE ",1:"SMALL "),LRTVOL=LRTVOL-S1
"RTN","LRLABLD",85,0)
 . D @LRLABEL
"RTN","LRLABLD",86,0)
 D KVA^VADPT
"RTN","LRLABLD",87,0)
 Q
"RTN","LRLABLD",88,0)
 ;
"RTN","LRLABLD",89,0)
UID ; Set up variables for unique id.
"RTN","LRLABLD",90,0)
 ; Called by above, LRLABLD0, LRPHLIS1
"RTN","LRLABLD",91,0)
 ;  LRUID = unique id number of accession
"RTN","LRLABLD",92,0)
 I $G(LRAA),$G(LRAD),$G(LRAN) S LRUID=$P($G(^LRO(68,LRAA,1,LRAD,1,LRAN,.3)),"^") ;Get unique identifier
"RTN","LRLABLD",93,0)
 E  S LRUID=""
"RTN","LRLABLD",94,0)
 Q
"RTN","LRLABLD",95,0)
 ;
"RTN","LRLABLD",96,0)
BARID ; Set up variables for barcoding
"RTN","LRLABLD",97,0)
 ; LRBARID = number to be barcoded on label, based on accession area setup in file #68.
"RTN","LRLABLD",98,0)
 ; If no accession # or UID - sets LRBARID=""
"RTN","LRLABLD",99,0)
 ; Called by LRLABLD0, LRPHLIS1
"RTN","LRLABLD",100,0)
 N LRX
"RTN","LRLABLD",101,0)
 S LRX=$G(^LRO(68,+$G(LRAA),.4)) ; Barcode info from accession file.
"RTN","LRLABLD",102,0)
 S LRBARID=""
"RTN","LRLABLD",103,0)
 I $L($G(LRUID)),$P(LRX,"^",2)="L" S LRBARID=LRUID Q  ; Barcode UID
"RTN","LRLABLD",104,0)
 I $G(LRAN)>0,LRBARID="" D
"RTN","LRLABLD",105,0)
 . S LRBARID=LRAN ; Barcode accession number
"RTN","LRLABLD",106,0)
 . I $P(LRX,"^",3) S LRBARID=$$RJ^XLFSTR(LRBARID,$P(LRX,"^",3),"0") ; Pad barcode number
"RTN","LRLABLD",107,0)
 Q
"RTN","LRLABLD",108,0)
 ;
"RTN","LRLABLD",109,0)
LBLTYP ; Determine label routine to use.
"RTN","LRLABLD",110,0)
 ; Sets LRLABEL to label print routine (label^routine).
"RTN","LRLABLD",111,0)
 ; Called by above, LRLABLD0, LRLABLIO, LRLABXOL, LRLABXT, LRPHLIS1
"RTN","LRLABLD",112,0)
 ;
"RTN","LRLABLD",113,0)
 N LRLBLDEV
"RTN","LRLABLD",114,0)
 ;
"RTN","LRLABLD",115,0)
 ; Default label routine
"RTN","LRLABLD",116,0)
 S LRLABEL="^LRLABEL"_$P($G(^LAB(69.9,1,3)),U,3)
"RTN","LRLABLD",117,0)
 S LRLBLDEV=$O(^LAB(69.9,1,3.6,"B",+$G(IOS),0))
"RTN","LRLABLD",118,0)
 I LRLBLDEV D
"RTN","LRLABLD",119,0)
 . S LRLBLDEV(0)=$G(^LAB(69.9,1,3.6,LRLBLDEV,0))
"RTN","LRLABLD",120,0)
 . ; default accession area for characteristics.
"RTN","LRLABLD",121,0)
 . I '$G(LRAA),$P(LRLBLDEV(0),"^",6) S LRAA=$P(LRLBLDEV(0),"^",6)
"RTN","LRLABLD",122,0)
 ;
"RTN","LRLABLD",123,0)
 ; Site's local accession area label routine.
"RTN","LRLABLD",124,0)
 I $G(LRAA)>0,$L($P(^LRO(68,LRAA,.4),"^",5)) D  Q
"RTN","LRLABLD",125,0)
 . S LRLABEL=$P(^LRO(68,LRAA,.4),"^",4,5)
"RTN","LRLABLD",126,0)
 ;
"RTN","LRLABLD",127,0)
 ; This device not defined in file #69.9.
"RTN","LRLABLD",128,0)
 I LRLBLDEV<1 Q
"RTN","LRLABLD",129,0)
 ;
"RTN","LRLABLD",130,0)
 ; Site's designated local label routine.
"RTN","LRLABLD",131,0)
 I $L($P(LRLBLDEV(0),"^",5)) D  Q
"RTN","LRLABLD",132,0)
 . S LRLABEL=$P(LRLBLDEV(0),"^",4,5)
"RTN","LRLABLD",133,0)
 ;
"RTN","LRLABLD",134,0)
 ; Intermec 3000/4000 printer
"RTN","LRLABLD",135,0)
 I $P(LRLBLDEV(0),"^",2)=1 D
"RTN","LRLABLD",136,0)
 . I $P(LRLBLDEV(0),"^",3)=1 S LRLABEL="^LRLABELC" Q  ; 1x3 label
"RTN","LRLABLD",137,0)
 . I $P(LRLBLDEV(0),"^",3)=2 S LRLABEL="^LRLABELA" Q  ; 1x2 label
"RTN","LRLABLD",138,0)
 . I $P(LRLBLDEV(0),"^",3)=3 S LRLABEL="^LRLABELB" Q  ; 10 part label
"RTN","LRLABLD",139,0)
 ;
"RTN","LRLABLD",140,0)
 ; Zebra ZPL II compatible printer
"RTN","LRLABLD",141,0)
 I $P(LRLBLDEV(0),"^",2)=2 D
"RTN","LRLABLD",142,0)
 . I $P(LRLBLDEV(0),"^",3)=1 S LRLABEL="^LRLABELG" Q  ; 1x3 label
"RTN","LRLABLD",143,0)
 . I $P(LRLBLDEV(0),"^",3)=2 S LRLABEL="^LRLABELD" Q  ; 1x2 label
"RTN","LRLABLD",144,0)
 . I $P(LRLBLDEV(0),"^",3)=3 S LRLABEL="^LRLABELE" Q  ; 10 part label
"RTN","LRLABLD",145,0)
 ;
"RTN","LRLABLD",146,0)
 Q
"RTN","LRLABLD",147,0)
 ;
"RTN","LRLABLD",148,0)
 ;
"RTN","LRLABLD",149,0)
PSET ; Setup special printer variables - barcode on/barcode off
"RTN","LRLABLD",150,0)
 ; Called by above, LRLABXOL, LRLABXT, LRPHLIS1
"RTN","LRLABLD",151,0)
 ;
"RTN","LRLABLD",152,0)
 ; Cleanup first
"RTN","LRLABLD",153,0)
 D PKILL^%ZISP
"RTN","LRLABLD",154,0)
 ;
"RTN","LRLABLD",155,0)
 ; Set variables
"RTN","LRLABLD",156,0)
 I IOST(0) D PSET^%ZISP
"RTN","LRLABLD",157,0)
 ;
"RTN","LRLABLD",158,0)
 S LRBAR0=$G(IOBAROFF)
"RTN","LRLABLD",159,0)
 S LRBAR1=$G(IOBARON)
"RTN","LRLABLD",160,0)
 ;
"RTN","LRLABLD",161,0)
 Q
"RTN","LRLABLD",162,0)
 ;
"RTN","LRLABLD",163,0)
 ;
"RTN","LRLABLD",164,0)
URGA(X) ; Determine urgency abbreviation to print on label
"RTN","LRLABLD",165,0)
 ; Input X = pointer to Urgency #62.05 file
"RTN","LRLABLD",166,0)
 ; Returns Y = urgency abbreviation^display type if turned on
"RTN","LRLABLD",167,0)
 ; Called by above, LRLABELF, LRLABLD0, LRLABLIO, LRPHLIS1
"RTN","LRLABLD",168,0)
 N Y
"RTN","LRLABLD",169,0)
 S Y=""
"RTN","LRLABLD",170,0)
 I '$G(X) Q Y
"RTN","LRLABLD",171,0)
 S X(0)=$G(^LAB(62.05,X,0))
"RTN","LRLABLD",172,0)
 S Y=$P(X(0),"^",7)_"^"_$P(X(0),"^",6)
"RTN","LRLABLD",173,0)
 Q Y
"RTN","LRLABLD",174,0)
 ;
"RTN","LRLABLD",175,0)
LRTXT(LRTLST,LRLEN) ; Parse test list to print on label.
"RTN","LRLABLD",176,0)
 ; Builds a string of test names concatentated using ";" to the maximum
"RTN","LRLABLD",177,0)
 ; length (LRLEN) specified. Terminates list with "..." if exceeds length
"RTN","LRLABLD",178,0)
 ; specified.
"RTN","LRLABLD",179,0)
 ; Call with
"RTN","LRLABLD",180,0)
 ;         LRTLST = array containing name of test to parse
"RTN","LRLABLD",181,0)
 ;         LRLEN  = length of test string to return (default=35)
"RTN","LRLABLD",182,0)
 ;
"RTN","LRLABLD",183,0)
 ; Returns LRTXT  = variable containing concatenated test list.
"RTN","LRLABLD",184,0)
 ;
"RTN","LRLABLD",185,0)
 ; Called from LRLABEL, LRLABEL1, LRLABEL2, LRLABEL3, LRLABEL5, LRLABEL6,
"RTN","LRLABLD",186,0)
 ;             LRLABELA, LRLABELB, LRLABELC, LRLABELD, LRLABELE
"RTN","LRLABLD",187,0)
 ;
"RTN","LRLABLD",188,0)
 N I,J,LRTXT,X,Y
"RTN","LRLABLD",189,0)
 I '$G(LRLEN) S LRLEN=35
"RTN","LRLABLD",190,0)
 S J=0,LRTXT=""
"RTN","LRLABLD",191,0)
 F  S J=$O(LRTLST(J)) Q:J<1!($L(LRTXT)>LRLEN)  D
"RTN","LRLABLD",192,0)
 . S X=LRTLST(J)_$S($O(LRTLST(J)):";",1:"") ; Add ";" if more tests
"RTN","LRLABLD",193,0)
 . S LRTXT=LRTXT_X
"RTN","LRLABLD",194,0)
 I $L(LRTXT)>LRLEN D
"RTN","LRLABLD",195,0)
 . S Y=$L(LRTXT,";")
"RTN","LRLABLD",196,0)
 . F I=Y:-1:1 S X=$P(LRTXT,";",1,I) I $L(X)<(LRLEN-2) Q
"RTN","LRLABLD",197,0)
 . S LRTXT=$E(X,1,(LRLEN-3))_"..."
"RTN","LRLABLD",198,0)
 Q LRTXT
"RTN","LRLABLD",199,0)
 ;
"RTN","LRLABLD",200,0)
LRBAR ; Setup LRBAR array if barcodes for this accession area
"RTN","LRLABLD",201,0)
 ; Called by above, LRLABLD0, LRLABLIO, LRLABXT, LRPHIS1
"RTN","LRLABLD",202,0)
 I $G(LRAA)<1 Q  ; Pointer not valid.
"RTN","LRLABLD",203,0)
 I $P($G(^LRO(68,LRAA,0)),U,15) S LRBAR(LRAA)=+$P($G(^LRO(68,LRAA,0)),U,15)
"RTN","LRLABLD",204,0)
 Q
"UP",60,60.15,-1)
60^13
"UP",60,60.15,0)
60.15
"VER")
8.0^22.0
"^DD",60,60,16.1,0)
INSTITUTION EXTRA LABELS^60.15P^^13;0
"^DD",60,60,16.1,21,0)
^^2^2^3160902^
"^DD",60,60,16.1,21,1,0)
This field allows selection of a division in order to set the number of
"^DD",60,60,16.1,21,2,0)
If present, this value is used for any user signed into this division.
"^DD",60,60.15,0)
INSTITUTION EXTRA LABELS SUB-FIELD^^1^2
"^DD",60,60.15,0,"DT")
3160901
"^DD",60,60.15,0,"IX","B",60.15,.01)

"^DD",60,60.15,0,"NM","INSTITUTION EXTRA LABELS")

"^DD",60,60.15,0,"UP")
60
"^DD",60,60.15,.01,0)
INSTITUTION EXTRA LABELS^MP4'^DIC(4,^0;1^Q
"^DD",60,60.15,.01,1,0)
^.1
"^DD",60,60.15,.01,1,1,0)
60.15^B
"^DD",60,60.15,.01,1,1,1)
S ^LAB(60,DA(1),13,"B",$E(X,1,30),DA)=""
"^DD",60,60.15,.01,1,1,2)
K ^LAB(60,DA(1),13,"B",$E(X,1,30),DA)
"^DD",60,60.15,.01,21,0)
^^2^2^3160902^
"^DD",60,60.15,.01,21,1,0)
This field allows selection of a division in order to set the number of
"^DD",60,60.15,.01,21,2,0)
labels for a given test for the selected division.
"^DD",60,60.15,.01,"DT")
3160902
"^DD",60,60.15,1,0)
NUMBER OF LABELS^NJ3,0^^0;2^K:+X'=X!(X>999)!(X<0)!(X?.E1"."1N.N) X
"^DD",60,60.15,1,3)
Type a number between 0 and 999, 0 decimal digits.
"^DD",60,60.15,1,21,0)
^^5^5^3160901^
"^DD",60,60.15,1,21,1,0)
Enter the desired number of extra labels for the test for the current
"^DD",60,60.15,1,21,2,0)
division. If omitted, the number of labels in the Extra Labels field (#16)
"^DD",60,60.15,1,21,3,0)
for the test will be used.  If no value is present in either field (16 or
"^DD",60,60.15,1,21,4,0)
this Institution Extra Labels field), then the computed default number of
"^DD",60,60.15,1,21,5,0)
labels for this test will print.
"^DD",60,60.15,1,"DT")
3160901
"BLD",9805,6)
^374
**END**
**END**

