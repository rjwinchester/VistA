Released LR*5.2*473 SEQ #373
Extracted from mail message
**KIDS**:LR*5.2*473^

**INSTALL NAME**
LR*5.2*473
"BLD",10256,0)
LR*5.2*473^LAB SERVICE^0^3160709^y
"BLD",10256,1,0)
^^7^7^3160709^^
"BLD",10256,1,1,0)
This is a general maintenance patch for the laboratory
"BLD",10256,1,2,0)
package by the Vista Maintenance team that addresses
"BLD",10256,1,3,0)
issues with an incomplete audit log-in and with batch result
"BLD",10256,1,4,0)
entry of microbiology results:
"BLD",10256,1,5,0)
 
"BLD",10256,1,6,0)
1.      I8246369FY16 -  Incomplete audit log-in
"BLD",10256,1,7,0)
2.      I6575449FY16 -  <UNDEFINED> error in micro results entry (batch) 
"BLD",10256,4,0)
^9.64PA^^
"BLD",10256,6.3)
1
"BLD",10256,"ABPKG")
n
"BLD",10256,"KRN",0)
^9.67PA^779.2^20
"BLD",10256,"KRN",.4,0)
.4
"BLD",10256,"KRN",.401,0)
.401
"BLD",10256,"KRN",.402,0)
.402
"BLD",10256,"KRN",.403,0)
.403
"BLD",10256,"KRN",.5,0)
.5
"BLD",10256,"KRN",.84,0)
.84
"BLD",10256,"KRN",3.6,0)
3.6
"BLD",10256,"KRN",3.8,0)
3.8
"BLD",10256,"KRN",9.2,0)
9.2
"BLD",10256,"KRN",9.8,0)
9.8
"BLD",10256,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",10256,"KRN",9.8,"NM",1,0)
LRAUAW^^0^B5220417
"BLD",10256,"KRN",9.8,"NM",2,0)
LRMISTF1^^0^B41522345
"BLD",10256,"KRN",9.8,"NM","B","LRAUAW",1)

"BLD",10256,"KRN",9.8,"NM","B","LRMISTF1",2)

"BLD",10256,"KRN",19,0)
19
"BLD",10256,"KRN",19,"NM",0)
^9.68A^^
"BLD",10256,"KRN",19.1,0)
19.1
"BLD",10256,"KRN",101,0)
101
"BLD",10256,"KRN",409.61,0)
409.61
"BLD",10256,"KRN",771,0)
771
"BLD",10256,"KRN",779.2,0)
779.2
"BLD",10256,"KRN",870,0)
870
"BLD",10256,"KRN",8989.51,0)
8989.51
"BLD",10256,"KRN",8989.52,0)
8989.52
"BLD",10256,"KRN",8994,0)
8994
"BLD",10256,"KRN","B",.4,.4)

"BLD",10256,"KRN","B",.401,.401)

"BLD",10256,"KRN","B",.402,.402)

"BLD",10256,"KRN","B",.403,.403)

"BLD",10256,"KRN","B",.5,.5)

"BLD",10256,"KRN","B",.84,.84)

"BLD",10256,"KRN","B",3.6,3.6)

"BLD",10256,"KRN","B",3.8,3.8)

"BLD",10256,"KRN","B",9.2,9.2)

"BLD",10256,"KRN","B",9.8,9.8)

"BLD",10256,"KRN","B",19,19)

"BLD",10256,"KRN","B",19.1,19.1)

"BLD",10256,"KRN","B",101,101)

"BLD",10256,"KRN","B",409.61,409.61)

"BLD",10256,"KRN","B",771,771)

"BLD",10256,"KRN","B",779.2,779.2)

"BLD",10256,"KRN","B",870,870)

"BLD",10256,"KRN","B",8989.51,8989.51)

"BLD",10256,"KRN","B",8989.52,8989.52)

"BLD",10256,"KRN","B",8994,8994)

"BLD",10256,"QUES",0)
^9.62^^
"BLD",10256,"REQB",0)
^9.611^2^2
"BLD",10256,"REQB",1,0)
LR*5.2*309^2
"BLD",10256,"REQB",2,0)
LR*5.2*427^2
"BLD",10256,"REQB","B","LR*5.2*309",1)

"BLD",10256,"REQB","B","LR*5.2*427",2)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2950304
"PKG",26,22,1,"PAH",1,0)
473^3160709
"PKG",26,22,1,"PAH",1,1,0)
^^7^7^3160709
"PKG",26,22,1,"PAH",1,1,1,0)
This is a general maintenance patch for the laboratory
"PKG",26,22,1,"PAH",1,1,2,0)
package by the Vista Maintenance team that addresses
"PKG",26,22,1,"PAH",1,1,3,0)
issues with an incomplete audit log-in and with batch result
"PKG",26,22,1,"PAH",1,1,4,0)
entry of microbiology results:
"PKG",26,22,1,"PAH",1,1,5,0)
 
"PKG",26,22,1,"PAH",1,1,6,0)
1.      I8246369FY16 -  Incomplete audit log-in
"PKG",26,22,1,"PAH",1,1,7,0)
2.      I6575449FY16 -  <UNDEFINED> error in micro results entry (batch) 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","LRAUAW")
0^1^B5220417^B5111264
"RTN","LRAUAW",1,0)
LRAUAW ;AVAMC/REG/CKA - AUTOPSY DATA ENTRY ; 7/9/16 10:56pm
"RTN","LRAUAW",2,0)
 ;;5.2;LAB SERVICE;**72,115,121,309,473**;Sep 27, 1994;Build 1
"RTN","LRAUAW",3,0)
 ;Reference to DIC supported by IA #916
"RTN","LRAUAW",4,0)
 S:'$D(LRMD) LRMD=""
"RTN","LRAUAW",5,0)
 W !!,"Enter Weights & Measurements "
"RTN","LRAUAW",6,0)
 S %=2
"RTN","LRAUAW",7,0)
 D YN^LRU
"RTN","LRAUAW",8,0)
 I %<0 D END^LRAPLG1 Q
"RTN","LRAUAW",9,0)
 S DA=LRDFN,DIE="^LR(",LRSD=LREXP
"RTN","LRAUAW",10,0)
 S DR="11;S LRRC=X;14///"_LRAC_";14.1;S LRLLOC=X;14.5;14.6;S LRSVC=X;12.1;S LRMD=X;13.5:13.8"
"RTN","LRAUAW",11,0)
 I %=1 D SET
"RTN","LRAUAW",12,0)
DIE W !
"RTN","LRAUAW",13,0)
 D ^DIE
"RTN","LRAUAW",14,0)
 I $D(Y) W $C(7),!!,"All Prompts were not answered  <ENTRY DELETED>" K ^LR(LRDFN,"AU"),^("AX") D X^LRAPLG1,END^LRAPLG1 Q
"RTN","LRAUAW",15,0)
 I $D(@(LRPF_DFN_",0)")),$P(^(0),"^",3) S X2=$P(^(0),"^",3),X1=LRSD D ^%DTC S AGE=$S(X>365.24:X\365.25,X>7:X\7_"w",X>0:X_"d",1:""),DR="12.5///"_AGE D ^DIE
"RTN","LRAUAW",16,0)
 S (LRCS,LRC(5))="",LRI=9999999-$P(LRSD,".")
"RTN","LRAUAW",17,0)
 D ^LRUWLF
"RTN","LRAUAW",18,0)
 D:LRCAPA ^LRAPSWK
"RTN","LRAUAW",19,0)
 D OERR^LR7OB63D
"RTN","LRAUAW",20,0)
 Q
"RTN","LRAUAW",21,0)
DEL ;from LRUDEL
"RTN","LRAUAW",22,0)
 W !,"DATE DIED ",Y
"RTN","LRAUAW",23,0)
 I $D(^LR(LRDFN,"AU")),$P(^("AU"),"^",3) W $C(7),"  Cannot delete a completed autopsy." Q
"RTN","LRAUAW",24,0)
 L +^LR(LRDFN,"AU"):1
"RTN","LRAUAW",25,0)
 I '$T W !!?10,"Someone else is editing this entry ",!,$C(7) L -^LR(LRDFN,"AU") Q
"RTN","LRAUAW",26,0)
 W "  OK to DELETE "
"RTN","LRAUAW",27,0)
 S %=2
"RTN","LRAUAW",28,0)
 D YN^LRU
"RTN","LRAUAW",29,0)
 Q:%'=1
"RTN","LRAUAW",30,0)
 D ACC^LR7OB1(LRAA,LRAD,LRAN,"OC") ;Cancel order
"RTN","LRAUAW",31,0)
 K ^LR(LRDFN,"AU"),^("AV"),^("AW"),^("AY"),^(33),^(80),^(81),^(82)
"RTN","LRAUAW",32,0)
 F A=0:0 S A=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,A)) Q:'A  K ^LRO(68,"AA",LRAA_"|"_LRAD_"|"_LRAN_"|"_A)
"RTN","LRAUAW",33,0)
 K ^LRO(68,LRAA,1,LRAD,1,LRAN),^LRO(68,LRAA,1,"AC",DUZ(2),LRAD,LRAN)
"RTN","LRAUAW",34,0)
 K ^LRO(68,LRAA,1,LRAD,1,"E",+LRRC,LRAN)
"RTN","LRAUAW",35,0)
 D X^LRAPLG1
"RTN","LRAUAW",36,0)
 Q
"RTN","LRAUAW",37,0)
SET S DR=DR_";16:24;26:31;25;31.1:31.4;25.1:25.9"
"RTN","LRAUAW",38,0)
 Q
"RTN","LRAUAW",39,0)
D ;get date died- called by DD(63,11,0),LRAPED,LRAPBK,LRAPS2,LRAPT2,
"RTN","LRAUAW",40,0)
 ;    LRAPAUSR,LRAPPF1,LRAPAUL,LRAPLG2
"RTN","LRAUAW",41,0)
 S A=^LR(DA,0),B=+$P(A,U,2),C=+$P(A,U,3),A=^DIC(B,0,"GL")
"RTN","LRAUAW",42,0)
 S LR(63,12)=$S($D(@(A_C_",.35)")):+^(.35),1:"")
"RTN","LRAUAW",43,0)
 S LR(63,.02)=$P(^DIC(B,0),U)
"RTN","LRAUAW",44,0)
 Q
"RTN","LRMISTF1")
0^2^B41522345^B41353920
"RTN","LRMISTF1",1,0)
LRMISTF1 ;DALOI/STAFF - MASS DATA ENTRY INTO FILE 63.05 ; 7/9/16 10:57pm
"RTN","LRMISTF1",2,0)
 ;;5.2;LAB SERVICE;**121,128,202,263,264,295,350,427,473**;Sep 27, 1994;Build 1
"RTN","LRMISTF1",3,0)
 ;
"RTN","LRMISTF1",4,0)
 ; from LRMISTF
"RTN","LRMISTF1",5,0)
 ;
"RTN","LRMISTF1",6,0)
ASK ;
"RTN","LRMISTF1",7,0)
 N LRAUTO,LRDUZ,LRIEN,LRPLREF
"RTN","LRMISTF1",8,0)
 ;
"RTN","LRMISTF1",9,0)
 F  D GET Q:LREND=99  D:'LREND ACC S:LREND LREND=0 D MORE Q:LREND  K LRAUTO
"RTN","LRMISTF1",10,0)
 Q
"RTN","LRMISTF1",11,0)
 ;
"RTN","LRMISTF1",12,0)
 ;
"RTN","LRMISTF1",13,0)
GET ;
"RTN","LRMISTF1",14,0)
 N DIR,DIRUT,DTOUT,DUOUT,LRSTUFF,X,Y
"RTN","LRMISTF1",15,0)
 ;
"RTN","LRMISTF1",16,0)
 S X1="",LREND=0
"RTN","LRMISTF1",17,0)
 I LRMODE<3 D
"RTN","LRMISTF1",18,0)
 . F  R !,"What do you want entered?: ",X1:DTIME Q:'$T!(X1[U)!(X1="")  D  I $L(X1),$E(X1)'="?" S LREND=0 Q
"RTN","LRMISTF1",19,0)
 . . I $S(X1[":":1,X1[";":1,1:0) S X1="?" D INFO Q
"RTN","LRMISTF1",20,0)
 . . S X=X1 S:X[";" X="?" D @$S($G(H9)=11.57:"PN^LRNUM",$G(H9)=24:"AFS^LRNUM",1:"^LRMIXPD") S:'$D(X) X1="?" Q:X1'="?"  D INFO
"RTN","LRMISTF1",21,0)
 I X1[U S LREND=99 Q
"RTN","LRMISTF1",22,0)
 ;
"RTN","LRMISTF1",23,0)
 S:LRMODE<3 LRSTUFF=X1
"RTN","LRMISTF1",24,0)
 W !,"I will ",$S(LRMODE=1:"automatically stuff ",1:"prompt "),LRMF W:$D(LRSTUFF) !,"with ",LRSTUFF
"RTN","LRMISTF1",25,0)
 F  W !,"   ...OK" S %=1 D YN^DICN Q:%  W !,"Answer 'Y'es or 'N'o"
"RTN","LRMISTF1",26,0)
 I %'=1 S LREND=1 Q
"RTN","LRMISTF1",27,0)
 ;
"RTN","LRMISTF1",28,0)
 I LRPF="P" S DR="S:$S($D(^LR(LRDFN,""MI"",LRIDT,"_LRSB_")):$P(^("_LRSB_"),U,2),1:"""")=""F"" Y="_$S(LRSB=1:11.55,LRSB=5:15.5,LRSB=8:19.5,LRSB=11:25.5,LRSB=16:35)_";"
"RTN","LRMISTF1",29,0)
 I LRPF="F" S DR=""
"RTN","LRMISTF1",30,0)
 S DR=DR_$S(LRSB=1:"11.5///"_LRPF_";11.55",LRSB=5:"15///"_LRPF_";15.5",LRSB=8:"19///"_LRPF_";19.5",LRSB=11:"23///"_LRPF_";25.5",1:"34///"_LRPF_";35")
"RTN","LRMISTF1",31,0)
 S DR=DR_"////"_DUZ_";"_H9_$S(LRMODE=1:"///"_LRSTUFF,LRMODE=2:"//"_LRSTUFF,1:"")
"RTN","LRMISTF1",32,0)
 ;
"RTN","LRMISTF1",33,0)
 K DIR
"RTN","LRMISTF1",34,0)
 S DIR(0)="YO",DIR("A")="Verify all work automatically",DIR("B")="Yes"
"RTN","LRMISTF1",35,0)
 D ^DIR
"RTN","LRMISTF1",36,0)
 I $D(DIRUT) S LREND=1 Q
"RTN","LRMISTF1",37,0)
 I Y=1 S DR=DR_";"_$S(LRSB=1:11,LRSB=5:14,LRSB=8:18,LRSB=11:22,1:33)_"///NOW",LRAUTO=""
"RTN","LRMISTF1",38,0)
 ;
"RTN","LRMISTF1",39,0)
 ;
"RTN","LRMISTF1",40,0)
 K DIR
"RTN","LRMISTF1",41,0)
 S DIR(0)="YO",DIR("A")="Designate the individual test as complete",DIR("B")="No"
"RTN","LRMISTF1",42,0)
 D ^DIR
"RTN","LRMISTF1",43,0)
 I $D(DIRUT) S LREND=1 Q
"RTN","LRMISTF1",44,0)
 S LRCO=+Y
"RTN","LRMISTF1",45,0)
 ;
"RTN","LRMISTF1",46,0)
 ;
"RTN","LRMISTF1",47,0)
 ; Ask for performing lab if automatically verifying.
"RTN","LRMISTF1",48,0)
 ; Setup array of fields to performing lab reference
"RTN","LRMISTF1",49,0)
 K LRDUZ,LRPLREF
"RTN","LRMISTF1",50,0)
 ;
"RTN","LRMISTF1",51,0)
 S LRPLREF(11.57)="1:6"
"RTN","LRMISTF1",52,0)
 S LRPLREF(11.58)="1;5"
"RTN","LRMISTF1",53,0)
 S LRPLREF(11.6)="2,0"
"RTN","LRMISTF1",54,0)
 S LRPLREF(13)="4,0"
"RTN","LRMISTF1",55,0)
 S LRPLREF(15.51)="24,0"
"RTN","LRMISTF1",56,0)
 S LRPLREF(17)="7,0"
"RTN","LRMISTF1",57,0)
 S LRPLREF(19.6)="15,0"
"RTN","LRMISTF1",58,0)
 S LRPLREF(21)="10,0"
"RTN","LRMISTF1",59,0)
 S LRPLREF(24)="11;3"
"RTN","LRMISTF1",60,0)
 S LRPLREF(27)="13,0"
"RTN","LRMISTF1",61,0)
 S LRPLREF(37)="18,0"
"RTN","LRMISTF1",62,0)
 ;
"RTN","LRMISTF1",63,0)
 I $D(LRAUTO) D
"RTN","LRMISTF1",64,0)
 . N DIR,DIRUT,DTOUT,DUOUT,LRDPL,X,Y
"RTN","LRMISTF1",65,0)
 . S LRDPL=$$GET^XPAR("USR","LR VER DEFAULT PERFORMING LAB",1,"Q")
"RTN","LRMISTF1",66,0)
 . I LRDPL<1 S LRDPL=DUZ(2)
"RTN","LRMISTF1",67,0)
 . ;
"RTN","LRMISTF1",68,0)
 . I '($$GET^XPAR("ALL","LR ASK PERFORMING LAB MICRO",1,"Q")) D  Q
"RTN","LRMISTF1",69,0)
 . . I LRDPL'=DUZ(2) S LRDUZ(2)=LRDPL
"RTN","LRMISTF1",70,0)
 . . S $P(LRPLREF(H9),"^")="0"
"RTN","LRMISTF1",71,0)
 . ;
"RTN","LRMISTF1",72,0)
 . S X=$$SELPL^LRVERA(LRDPL)
"RTN","LRMISTF1",73,0)
 . I X<1 S LREND=1 Q
"RTN","LRMISTF1",74,0)
 . I X'=DUZ(2) S LRDUZ(2)=X
"RTN","LRMISTF1",75,0)
 . S DIR(0)="S^1:Entire report;2:"_LRMF_" section of report"
"RTN","LRMISTF1",76,0)
 . S DIR("A")="Designate performing laboratory for"
"RTN","LRMISTF1",77,0)
 . S DIR("?")="Enter a code from the list or '^' to exit."
"RTN","LRMISTF1",78,0)
 . D ^DIR
"RTN","LRMISTF1",79,0)
 . I $D(DIRUT) S LREND=1 Q
"RTN","LRMISTF1",80,0)
 . I Y=1 S $P(LRPLREF(H9),"^")="0"
"RTN","LRMISTF1",81,0)
 Q
"RTN","LRMISTF1",82,0)
 ;
"RTN","LRMISTF1",83,0)
 ;
"RTN","LRMISTF1",84,0)
INFO ;
"RTN","LRMISTF1",85,0)
 W !,$$CJ^XLFSTR("What you enter will go through the input transform to be stored in the.",IOM)
"RTN","LRMISTF1",86,0)
 W !,$$CJ^XLFSTR("Result field of the test",IOM)
"RTN","LRMISTF1",87,0)
 W !,$$CJ^XLFSTR("The punctuations of ';' or ':'  are not allowed in Batch Data Entry.",IOM),!
"RTN","LRMISTF1",88,0)
 Q
"RTN","LRMISTF1",89,0)
 ;
"RTN","LRMISTF1",90,0)
 ;
"RTN","LRMISTF1",91,0)
ACC ;
"RTN","LRMISTF1",92,0)
 N DIC,DIR,DIRUT,DTOUT,DUOUT
"RTN","LRMISTF1",93,0)
 W !,"Enter the accessions you wish to edit." D LRAN^LRMIUT
"RTN","LRMISTF1",94,0)
 I +$O(LRAN(0))>0 W !,"Editing the following:" S (J,LRAN)=0 F  S LRAN=+$O(LRAN(LRAN)) Q:LRAN<1  W !,LRAN S J=J+1 I J#(IOSL-2)=0 R !,"Press return to continue or '^' to escape ",X:DTIME I X[U S LREND=1 Q
"RTN","LRMISTF1",95,0)
 Q:LREND
"RTN","LRMISTF1",96,0)
 ;
"RTN","LRMISTF1",97,0)
 S DIR(0)="YO",DIR("A")="Everything OK",DIR("B")="NO"
"RTN","LRMISTF1",98,0)
 D ^DIR
"RTN","LRMISTF1",99,0)
 I Y<1 Q
"RTN","LRMISTF1",100,0)
 ;
"RTN","LRMISTF1",101,0)
 S LRAN=0
"RTN","LRMISTF1",102,0)
 F  S LRAN=+$O(LRAN(LRAN)) Q:LRAN<1  D STUFF Q:LREND
"RTN","LRMISTF1",103,0)
 Q
"RTN","LRMISTF1",104,0)
 ;
"RTN","LRMISTF1",105,0)
 ;
"RTN","LRMISTF1",106,0)
STUFF ;
"RTN","LRMISTF1",107,0)
 N LREND
"RTN","LRMISTF1",108,0)
 ;
"RTN","LRMISTF1",109,0)
 I '$D(^LRO(68,LRAA,1,LRAD,1,LRAN,0))!'$D(^(3)) W !,"Acc: ",LRAN," not set up." Q
"RTN","LRMISTF1",110,0)
 I $P(^LRO(68,LRAA,1,LRAD,1,LRAN,3),U,4) W !,"Acc: ",LRAN," has been previously verified by a microbiology supervisor." Q
"RTN","LRMISTF1",111,0)
 ;
"RTN","LRMISTF1",112,0)
 S LRNOP=1,J=0 F  S J=+$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,J)) Q:J<1  I LRTEST=+^(J,0) S LRNOP=$P(^(0),U,5) Q
"RTN","LRMISTF1",113,0)
 I LRNOP=1 W !,"Acc: ",LRAN," doesn't have the test required." Q
"RTN","LRMISTF1",114,0)
 I LRNOP>1 W !,"Acc: ",LRAN," has been completed for the selected test." Q
"RTN","LRMISTF1",115,0)
 ;
"RTN","LRMISTF1",116,0)
 I H9=11.57!(H9=11.58) S LROK=0 D @$S(H9=11.57:"UR",1:"SPUT") I 'LROK W !,"Acc: ",LRAN," doesn't have the specimen required." Q
"RTN","LRMISTF1",117,0)
 ;
"RTN","LRMISTF1",118,0)
 W !,"Acc: ",LRAN
"RTN","LRMISTF1",119,0)
 S LRDFN=+^LRO(68,LRAA,1,LRAD,1,LRAN,0),LRLLOC=$P(^(0),U,7),LRODT=$S($P(^(0),U,4):$P(^(0),U,4),1:$P(^(0),U,3)),LRSN=$P(^(0),U,5)
"RTN","LRMISTF1",120,0)
 S LRDPF=$P(^LR(LRDFN,0),U,2),DFN=$P(^(0),U,3)
"RTN","LRMISTF1",121,0)
 D PT^LRX
"RTN","LRMISTF1",122,0)
 W ?15,PNM,?45,SSN,?65,LRWRD,!
"RTN","LRMISTF1",123,0)
 ;
"RTN","LRMISTF1",124,0)
 S LRCDT=+^LRO(68,LRAA,1,LRAD,1,LRAN,3),LRIDT=+$P(^(3),U,5),DIE="^LR("_LRDFN_",""MI"",",DA=LRIDT,DA(1)=LRDFN
"RTN","LRMISTF1",125,0)
 D ^DIE,UPDATE^LRPXRM(LRDFN,"MI",LRIDT)
"RTN","LRMISTF1",126,0)
 I $D(Y) S LREND=1 Q
"RTN","LRMISTF1",127,0)
 ;
"RTN","LRMISTF1",128,0)
 I LRCO D
"RTN","LRMISTF1",129,0)
 . S X=$P(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRTEST,0),U,5)
"RTN","LRMISTF1",130,0)
 . I X K ^LRO(68,LRAA,1,LRAD,1,"AD",$P(X,"."),LRAN),^LRO(68,LRAA,1,LRAD,1,"AC",X,LRAN)
"RTN","LRMISTF1",131,0)
 . S $P(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRTEST,0),U,4)=DUZ,$P(^(0),U,8)=$G(LRCDEF)
"RTN","LRMISTF1",132,0)
 . S Y=$$NOW^XLFDT
"RTN","LRMISTF1",133,0)
 . S $P(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRTEST,0),U,5)=Y
"RTN","LRMISTF1",134,0)
 . S ^LRO(68,LRAA,1,LRAD,1,"AD",$P(Y,"."),LRAN)="",^LRO(68,LRAA,1,LRAD,1,"AC",Y,LRAN)=""
"RTN","LRMISTF1",135,0)
 . N CORRECT S:$G(LRCORECT) CORRECT=1 D NEW^LR7OB1(LRODT,LRSN,"RE")
"RTN","LRMISTF1",136,0)
 ;
"RTN","LRMISTF1",137,0)
 I $D(LRAUTO) D PL,STF^LRMIUT,LEDI^LRVR0
"RTN","LRMISTF1",138,0)
 ;
"RTN","LRMISTF1",139,0)
 Q
"RTN","LRMISTF1",140,0)
 ;
"RTN","LRMISTF1",141,0)
 ;
"RTN","LRMISTF1",142,0)
MORE ;
"RTN","LRMISTF1",143,0)
 S LREND=1
"RTN","LRMISTF1",144,0)
 F  W !,"Do you wish to make a new entry for the ",LRMF," field" S %=2 D YN^DICN Q:%  W !,"Answer 'Y'es or 'N'o"
"RTN","LRMISTF1",145,0)
 I %=1 S LREND=0
"RTN","LRMISTF1",146,0)
 Q
"RTN","LRMISTF1",147,0)
 ;
"RTN","LRMISTF1",148,0)
 ;
"RTN","LRMISTF1",149,0)
UR ;
"RTN","LRMISTF1",150,0)
 S J=0
"RTN","LRMISTF1",151,0)
 F  S J=+$O(^LRO(68,LRAA,1,LRAD,1,LRAN,5,J)) Q:J<1  I LRURINE=+^(J,0) S LROK=1 Q
"RTN","LRMISTF1",152,0)
 Q
"RTN","LRMISTF1",153,0)
 ;
"RTN","LRMISTF1",154,0)
 ;
"RTN","LRMISTF1",155,0)
SPUT ;
"RTN","LRMISTF1",156,0)
 S J=0
"RTN","LRMISTF1",157,0)
 F  S J=+$O(^LRO(68,LRAA,1,LRAD,1,LRAN,5,J)) Q:J<1  I 360=+^(J,0) S LROK=1 Q
"RTN","LRMISTF1",158,0)
 Q
"RTN","LRMISTF1",159,0)
 ;
"RTN","LRMISTF1",160,0)
 ;
"RTN","LRMISTF1",161,0)
PL ; Store performing lab on automatic verification
"RTN","LRMISTF1",162,0)
 ;
"RTN","LRMISTF1",163,0)
 N LRPL,LRREF,LRX,LRY
"RTN","LRMISTF1",164,0)
 ;
"RTN","LRMISTF1",165,0)
 S LRY=$G(LRPLREF(H9))
"RTN","LRMISTF1",166,0)
 I LRY="" Q
"RTN","LRMISTF1",167,0)
 S LRREF=LRDFN_",MI,"_LRIDT_","_LRY
"RTN","LRMISTF1",168,0)
 S LRPL=$S($G(LRDUZ(2)):LRDUZ(2),1:DUZ(2))
"RTN","LRMISTF1",169,0)
 ;
"RTN","LRMISTF1",170,0)
 S LRX=$O(^LR(LRDFN,"PL","B",LRREF,0))
"RTN","LRMISTF1",171,0)
 I 'LRX D CNE^LRRPLU(LRDFN,LRREF,LRPL) Q
"RTN","LRMISTF1",172,0)
 I $P(^LR(LRDFN,"PL",LRX,0),"^",2)'=LRPL D UEE^LRRPLU(LRDFN,LRREF,LRPL)
"RTN","LRMISTF1",173,0)
 ;
"RTN","LRMISTF1",174,0)
 Q
"VER")
8.0^22
"BLD",10256,6)
^373
**END**
**END**

