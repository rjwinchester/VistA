Released LR*5.2*483 SEQ #387
Extracted from mail message
**KIDS**:LR*5.2*483^

**INSTALL NAME**
LR*5.2*483
"BLD",9903,0)
LR*5.2*483^LAB SERVICE^0^3170316^y
"BLD",9903,1,0)
^^133^133^3170316^
"BLD",9903,1,1,0)
 
"BLD",9903,1,2,0)
This patch contains only a correction to the second line of the routine 
"BLD",9903,1,3,0)
LRAPKOE.  The second line erroneously listed patch LR*5.2*469 when it was 
"BLD",9903,1,4,0)
released with LR*5.2*479. This reference to LR*5.2*469 will be removed as
"BLD",9903,1,5,0)
LRAPKOE was NOT released as part of LR*5.2*469. There are no other changes
"BLD",9903,1,6,0)
to the functionality in LRAPKOE.
"BLD",9903,1,7,0)
 
"BLD",9903,1,8,0)
Patch LR*5.2*479 should be installed on schedule.
"BLD",9903,1,9,0)
 
"BLD",9903,1,10,0)
Blood Bank Review:
"BLD",9903,1,11,0)
==================
"BLD",9903,1,12,0)
 
"BLD",9903,1,13,0)
 EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*483 does not 
"BLD",9903,1,14,0)
 contain any changes to the VISTA BLOOD BANK Software as defined by 
"BLD",9903,1,15,0)
 ProPath standard titled: BBM Team Review of VistA Patches.
"BLD",9903,1,16,0)
 
"BLD",9903,1,17,0)
 RISK ANALYSIS: Changes made by patch LR*5.2*483 have no effect on Blood 
"BLD",9903,1,18,0)
 Bank software functionality, therefore RISK is none.
"BLD",9903,1,19,0)
 
"BLD",9903,1,20,0)
 VALIDATION REQUIREMENTS BY OPTION: Because of the nature of the changes 
"BLD",9903,1,21,0)
 made, no specific validation requirements exist as a result of 
"BLD",9903,1,22,0)
 installation of this patch.
"BLD",9903,1,23,0)
 
"BLD",9903,1,24,0)
Patch Components:
"BLD",9903,1,25,0)
--------------------------
"BLD",9903,1,26,0)
 
"BLD",9903,1,27,0)
Files & Fields Associated:
"BLD",9903,1,28,0)
 
"BLD",9903,1,29,0)
File Name (Number)      Field Name (Number)        New/Modified/Deleted
"BLD",9903,1,30,0)
------------------      -------------------        --------------------
"BLD",9903,1,31,0)
N/A
"BLD",9903,1,32,0)
                        
"BLD",9903,1,33,0)
  
"BLD",9903,1,34,0)
Forms Associated:
"BLD",9903,1,35,0)
 
"BLD",9903,1,36,0)
Form Name               File #          New/Modified/Deleted
"BLD",9903,1,37,0)
---------               ------          --------------------
"BLD",9903,1,38,0)
N/A
"BLD",9903,1,39,0)
 
"BLD",9903,1,40,0)
 
"BLD",9903,1,41,0)
Mail Groups Associated:
"BLD",9903,1,42,0)
 
"BLD",9903,1,43,0)
Mail Group Name          New/Modified/Deleted
"BLD",9903,1,44,0)
---------------          --------------------
"BLD",9903,1,45,0)
N/A
"BLD",9903,1,46,0)
 
"BLD",9903,1,47,0)
 
"BLD",9903,1,48,0)
Options Associated:
"BLD",9903,1,49,0)
 
"BLD",9903,1,50,0)
Option Name         Type         New/Modified/Deleted
"BLD",9903,1,51,0)
----------          -----        --------------------
"BLD",9903,1,52,0)
N/A
"BLD",9903,1,53,0)
 
"BLD",9903,1,54,0)
  
"BLD",9903,1,55,0)
Protocols Associated:
"BLD",9903,1,56,0)
 
"BLD",9903,1,57,0)
Protocol Name       New/Modified/Deleted
"BLD",9903,1,58,0)
-------------       -------------------- 
"BLD",9903,1,59,0)
N/A
"BLD",9903,1,60,0)
 
"BLD",9903,1,61,0)
 
"BLD",9903,1,62,0)
Security Keys Associated:
"BLD",9903,1,63,0)
 
"BLD",9903,1,64,0)
Security Key Name
"BLD",9903,1,65,0)
-----------------
"BLD",9903,1,66,0)
N/A
"BLD",9903,1,67,0)
 
"BLD",9903,1,68,0)
 
"BLD",9903,1,69,0)
Templates Associated:
"BLD",9903,1,70,0)
 
"BLD",9903,1,71,0)
Template Name      Type      File Name (Number)  New/Modified/Deleted 
"BLD",9903,1,72,0)
-------------      -----     ------------------  --------------------
"BLD",9903,1,73,0)
N/A
"BLD",9903,1,74,0)
 
"BLD",9903,1,75,0)
 
"BLD",9903,1,76,0)
Additional Information:
"BLD",9903,1,77,0)
 
"BLD",9903,1,78,0)
N/A 
"BLD",9903,1,79,0)
 
"BLD",9903,1,80,0)
 
"BLD",9903,1,81,0)
New Service Requests (NSRs):
"BLD",9903,1,82,0)
--------------------------------------------   
"BLD",9903,1,83,0)
N/A
"BLD",9903,1,84,0)
 
"BLD",9903,1,85,0)
Patient Safety Issues (PSIs):
"BLD",9903,1,86,0)
---------------------------------------
"BLD",9903,1,87,0)
N/A
"BLD",9903,1,88,0)
 
"BLD",9903,1,89,0)
 
"BLD",9903,1,90,0)
CA SDM Ticket(s) & Overview:
"BLD",9903,1,91,0)
--------------------------------------------
"BLD",9903,1,92,0)
 
"BLD",9903,1,93,0)
N/A
"BLD",9903,1,94,0)
 
"BLD",9903,1,95,0)
 
"BLD",9903,1,96,0)
Test Sites:
"BLD",9903,1,97,0)
---------------
"BLD",9903,1,98,0)
N/A 
"BLD",9903,1,99,0)
 
"BLD",9903,1,100,0)
Problem:
"BLD",9903,1,101,0)
--------
"BLD",9903,1,102,0)
 With the release of patch LR*5.2*479 the second line of the routine
"BLD",9903,1,103,0)
 LRAPKOE mistakenly contained a reference to patch LR*5.2*469.
"BLD",9903,1,104,0)
 
"BLD",9903,1,105,0)
Resolution:
"BLD",9903,1,106,0)
-----------
"BLD",9903,1,107,0)
 This patch will correct the second line of the routine as follows:
"BLD",9903,1,108,0)
 Second line as released with LR*5.2*479:
"BLD",9903,1,109,0)
     ;;5.2;LAB SERVICE;**462,469,479**;Sep 27, 1994;Build 8
"BLD",9903,1,110,0)
 
"BLD",9903,1,111,0)
 Second line after the install of LR*5.2*483:
"BLD",9903,1,112,0)
     ;;5.2;LAB SERVICE;**462,479,483**;Sep 27, 1994;
"BLD",9903,1,113,0)
 
"BLD",9903,1,114,0)
        Routine: LRAPKOE
"BLD",9903,1,115,0)
 
"BLD",9903,1,116,0)
 Software Retrieval Instructions:
"BLD",9903,1,117,0)
 ------------------------------------- 
"BLD",9903,1,118,0)
 Software will be released via a PackMan message. 
"BLD",9903,1,119,0)
  
"BLD",9903,1,120,0)
 
"BLD",9903,1,121,0)
Patch Installation:
"BLD",9903,1,122,0)
  
"BLD",9903,1,123,0)
  
"BLD",9903,1,124,0)
 Pre/Post Installation Overview:
"BLD",9903,1,125,0)
 -------------------------------
"BLD",9903,1,126,0)
 N/A 
"BLD",9903,1,127,0)
  
"BLD",9903,1,128,0)
 Pre-Installation Instructions:
"BLD",9903,1,129,0)
 ------------------------------
"BLD",9903,1,130,0)
 N/A
"BLD",9903,1,131,0)
  
"BLD",9903,1,132,0)
 Installation Instructions:
"BLD",9903,1,133,0)
 --------------------------
"BLD",9903,4,0)
^9.64PA^^
"BLD",9903,6.3)
1
"BLD",9903,"ABPKG")
n
"BLD",9903,"KRN",0)
^9.67PA^779.2^20
"BLD",9903,"KRN",.4,0)
.4
"BLD",9903,"KRN",.401,0)
.401
"BLD",9903,"KRN",.402,0)
.402
"BLD",9903,"KRN",.403,0)
.403
"BLD",9903,"KRN",.5,0)
.5
"BLD",9903,"KRN",.84,0)
.84
"BLD",9903,"KRN",3.6,0)
3.6
"BLD",9903,"KRN",3.8,0)
3.8
"BLD",9903,"KRN",9.2,0)
9.2
"BLD",9903,"KRN",9.8,0)
9.8
"BLD",9903,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9903,"KRN",9.8,"NM",1,0)
LRAPKOE^^0^B175040482
"BLD",9903,"KRN",9.8,"NM","B","LRAPKOE",1)

"BLD",9903,"KRN",19,0)
19
"BLD",9903,"KRN",19.1,0)
19.1
"BLD",9903,"KRN",101,0)
101
"BLD",9903,"KRN",409.61,0)
409.61
"BLD",9903,"KRN",771,0)
771
"BLD",9903,"KRN",779.2,0)
779.2
"BLD",9903,"KRN",870,0)
870
"BLD",9903,"KRN",8989.51,0)
8989.51
"BLD",9903,"KRN",8989.52,0)
8989.52
"BLD",9903,"KRN",8994,0)
8994
"BLD",9903,"KRN","B",.4,.4)

"BLD",9903,"KRN","B",.401,.401)

"BLD",9903,"KRN","B",.402,.402)

"BLD",9903,"KRN","B",.403,.403)

"BLD",9903,"KRN","B",.5,.5)

"BLD",9903,"KRN","B",.84,.84)

"BLD",9903,"KRN","B",3.6,3.6)

"BLD",9903,"KRN","B",3.8,3.8)

"BLD",9903,"KRN","B",9.2,9.2)

"BLD",9903,"KRN","B",9.8,9.8)

"BLD",9903,"KRN","B",19,19)

"BLD",9903,"KRN","B",19.1,19.1)

"BLD",9903,"KRN","B",101,101)

"BLD",9903,"KRN","B",409.61,409.61)

"BLD",9903,"KRN","B",771,771)

"BLD",9903,"KRN","B",779.2,779.2)

"BLD",9903,"KRN","B",870,870)

"BLD",9903,"KRN","B",8989.51,8989.51)

"BLD",9903,"KRN","B",8989.52,8989.52)

"BLD",9903,"KRN","B",8994,8994)

"BLD",9903,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",9903,"QUES",0)
^9.62^^
"BLD",9903,"REQB",0)
^9.611^1^1
"BLD",9903,"REQB",1,0)
LR*5.2*479^2
"BLD",9903,"REQB","B","LR*5.2*479",1)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2941128
"PKG",26,22,1,"PAH",1,0)
483^3170316
"PKG",26,22,1,"PAH",1,1,0)
^^133^133^3170316
"PKG",26,22,1,"PAH",1,1,1,0)
 
"PKG",26,22,1,"PAH",1,1,2,0)
This patch contains only a correction to the second line of the routine 
"PKG",26,22,1,"PAH",1,1,3,0)
LRAPKOE.  The second line erroneously listed patch LR*5.2*469 when it was 
"PKG",26,22,1,"PAH",1,1,4,0)
released with LR*5.2*479. This reference to LR*5.2*469 will be removed as
"PKG",26,22,1,"PAH",1,1,5,0)
LRAPKOE was NOT released as part of LR*5.2*469. There are no other changes
"PKG",26,22,1,"PAH",1,1,6,0)
to the functionality in LRAPKOE.
"PKG",26,22,1,"PAH",1,1,7,0)
 
"PKG",26,22,1,"PAH",1,1,8,0)
Patch LR*5.2*479 should be installed on schedule.
"PKG",26,22,1,"PAH",1,1,9,0)
 
"PKG",26,22,1,"PAH",1,1,10,0)
Blood Bank Review:
"PKG",26,22,1,"PAH",1,1,11,0)
==================
"PKG",26,22,1,"PAH",1,1,12,0)
 
"PKG",26,22,1,"PAH",1,1,13,0)
 EFFECT ON BLOOD BANK FUNCTIONAL REQUIREMENTS: Patch LR*5.2*483 does not 
"PKG",26,22,1,"PAH",1,1,14,0)
 contain any changes to the VISTA BLOOD BANK Software as defined by 
"PKG",26,22,1,"PAH",1,1,15,0)
 ProPath standard titled: BBM Team Review of VistA Patches.
"PKG",26,22,1,"PAH",1,1,16,0)
 
"PKG",26,22,1,"PAH",1,1,17,0)
 RISK ANALYSIS: Changes made by patch LR*5.2*483 have no effect on Blood 
"PKG",26,22,1,"PAH",1,1,18,0)
 Bank software functionality, therefore RISK is none.
"PKG",26,22,1,"PAH",1,1,19,0)
 
"PKG",26,22,1,"PAH",1,1,20,0)
 VALIDATION REQUIREMENTS BY OPTION: Because of the nature of the changes 
"PKG",26,22,1,"PAH",1,1,21,0)
 made, no specific validation requirements exist as a result of 
"PKG",26,22,1,"PAH",1,1,22,0)
 installation of this patch.
"PKG",26,22,1,"PAH",1,1,23,0)
 
"PKG",26,22,1,"PAH",1,1,24,0)
Patch Components:
"PKG",26,22,1,"PAH",1,1,25,0)
--------------------------
"PKG",26,22,1,"PAH",1,1,26,0)
 
"PKG",26,22,1,"PAH",1,1,27,0)
Files & Fields Associated:
"PKG",26,22,1,"PAH",1,1,28,0)
 
"PKG",26,22,1,"PAH",1,1,29,0)
File Name (Number)      Field Name (Number)        New/Modified/Deleted
"PKG",26,22,1,"PAH",1,1,30,0)
------------------      -------------------        --------------------
"PKG",26,22,1,"PAH",1,1,31,0)
N/A
"PKG",26,22,1,"PAH",1,1,32,0)
                        
"PKG",26,22,1,"PAH",1,1,33,0)
  
"PKG",26,22,1,"PAH",1,1,34,0)
Forms Associated:
"PKG",26,22,1,"PAH",1,1,35,0)
 
"PKG",26,22,1,"PAH",1,1,36,0)
Form Name               File #          New/Modified/Deleted
"PKG",26,22,1,"PAH",1,1,37,0)
---------               ------          --------------------
"PKG",26,22,1,"PAH",1,1,38,0)
N/A
"PKG",26,22,1,"PAH",1,1,39,0)
 
"PKG",26,22,1,"PAH",1,1,40,0)
 
"PKG",26,22,1,"PAH",1,1,41,0)
Mail Groups Associated:
"PKG",26,22,1,"PAH",1,1,42,0)
 
"PKG",26,22,1,"PAH",1,1,43,0)
Mail Group Name          New/Modified/Deleted
"PKG",26,22,1,"PAH",1,1,44,0)
---------------          --------------------
"PKG",26,22,1,"PAH",1,1,45,0)
N/A
"PKG",26,22,1,"PAH",1,1,46,0)
 
"PKG",26,22,1,"PAH",1,1,47,0)
 
"PKG",26,22,1,"PAH",1,1,48,0)
Options Associated:
"PKG",26,22,1,"PAH",1,1,49,0)
 
"PKG",26,22,1,"PAH",1,1,50,0)
Option Name         Type         New/Modified/Deleted
"PKG",26,22,1,"PAH",1,1,51,0)
----------          -----        --------------------
"PKG",26,22,1,"PAH",1,1,52,0)
N/A
"PKG",26,22,1,"PAH",1,1,53,0)
 
"PKG",26,22,1,"PAH",1,1,54,0)
  
"PKG",26,22,1,"PAH",1,1,55,0)
Protocols Associated:
"PKG",26,22,1,"PAH",1,1,56,0)
 
"PKG",26,22,1,"PAH",1,1,57,0)
Protocol Name       New/Modified/Deleted
"PKG",26,22,1,"PAH",1,1,58,0)
-------------       -------------------- 
"PKG",26,22,1,"PAH",1,1,59,0)
N/A
"PKG",26,22,1,"PAH",1,1,60,0)
 
"PKG",26,22,1,"PAH",1,1,61,0)
 
"PKG",26,22,1,"PAH",1,1,62,0)
Security Keys Associated:
"PKG",26,22,1,"PAH",1,1,63,0)
 
"PKG",26,22,1,"PAH",1,1,64,0)
Security Key Name
"PKG",26,22,1,"PAH",1,1,65,0)
-----------------
"PKG",26,22,1,"PAH",1,1,66,0)
N/A
"PKG",26,22,1,"PAH",1,1,67,0)
 
"PKG",26,22,1,"PAH",1,1,68,0)
 
"PKG",26,22,1,"PAH",1,1,69,0)
Templates Associated:
"PKG",26,22,1,"PAH",1,1,70,0)
 
"PKG",26,22,1,"PAH",1,1,71,0)
Template Name      Type      File Name (Number)  New/Modified/Deleted 
"PKG",26,22,1,"PAH",1,1,72,0)
-------------      -----     ------------------  --------------------
"PKG",26,22,1,"PAH",1,1,73,0)
N/A
"PKG",26,22,1,"PAH",1,1,74,0)
 
"PKG",26,22,1,"PAH",1,1,75,0)
 
"PKG",26,22,1,"PAH",1,1,76,0)
Additional Information:
"PKG",26,22,1,"PAH",1,1,77,0)
 
"PKG",26,22,1,"PAH",1,1,78,0)
N/A 
"PKG",26,22,1,"PAH",1,1,79,0)
 
"PKG",26,22,1,"PAH",1,1,80,0)
 
"PKG",26,22,1,"PAH",1,1,81,0)
New Service Requests (NSRs):
"PKG",26,22,1,"PAH",1,1,82,0)
--------------------------------------------   
"PKG",26,22,1,"PAH",1,1,83,0)
N/A
"PKG",26,22,1,"PAH",1,1,84,0)
 
"PKG",26,22,1,"PAH",1,1,85,0)
Patient Safety Issues (PSIs):
"PKG",26,22,1,"PAH",1,1,86,0)
---------------------------------------
"PKG",26,22,1,"PAH",1,1,87,0)
N/A
"PKG",26,22,1,"PAH",1,1,88,0)
 
"PKG",26,22,1,"PAH",1,1,89,0)
 
"PKG",26,22,1,"PAH",1,1,90,0)
CA SDM Ticket(s) & Overview:
"PKG",26,22,1,"PAH",1,1,91,0)
--------------------------------------------
"PKG",26,22,1,"PAH",1,1,92,0)
 
"PKG",26,22,1,"PAH",1,1,93,0)
N/A
"PKG",26,22,1,"PAH",1,1,94,0)
 
"PKG",26,22,1,"PAH",1,1,95,0)
 
"PKG",26,22,1,"PAH",1,1,96,0)
Test Sites:
"PKG",26,22,1,"PAH",1,1,97,0)
---------------
"PKG",26,22,1,"PAH",1,1,98,0)
N/A 
"PKG",26,22,1,"PAH",1,1,99,0)
 
"PKG",26,22,1,"PAH",1,1,100,0)
Problem:
"PKG",26,22,1,"PAH",1,1,101,0)
--------
"PKG",26,22,1,"PAH",1,1,102,0)
 With the release of patch LR*5.2*479 the second line of the routine
"PKG",26,22,1,"PAH",1,1,103,0)
 LRAPKOE mistakenly contained a reference to patch LR*5.2*469.
"PKG",26,22,1,"PAH",1,1,104,0)
 
"PKG",26,22,1,"PAH",1,1,105,0)
Resolution:
"PKG",26,22,1,"PAH",1,1,106,0)
-----------
"PKG",26,22,1,"PAH",1,1,107,0)
 This patch will correct the second line of the routine as follows:
"PKG",26,22,1,"PAH",1,1,108,0)
 Second line as released with LR*5.2*479:
"PKG",26,22,1,"PAH",1,1,109,0)
     ;;5.2;LAB SERVICE;**462,469,479**;Sep 27, 1994;Build 8
"PKG",26,22,1,"PAH",1,1,110,0)
 
"PKG",26,22,1,"PAH",1,1,111,0)
 Second line after the install of LR*5.2*483:
"PKG",26,22,1,"PAH",1,1,112,0)
     ;;5.2;LAB SERVICE;**462,479,483**;Sep 27, 1994;
"PKG",26,22,1,"PAH",1,1,113,0)
 
"PKG",26,22,1,"PAH",1,1,114,0)
        Routine: LRAPKOE
"PKG",26,22,1,"PAH",1,1,115,0)
 
"PKG",26,22,1,"PAH",1,1,116,0)
 Software Retrieval Instructions:
"PKG",26,22,1,"PAH",1,1,117,0)
 ------------------------------------- 
"PKG",26,22,1,"PAH",1,1,118,0)
 Software will be released via a PackMan message. 
"PKG",26,22,1,"PAH",1,1,119,0)
  
"PKG",26,22,1,"PAH",1,1,120,0)
 
"PKG",26,22,1,"PAH",1,1,121,0)
Patch Installation:
"PKG",26,22,1,"PAH",1,1,122,0)
  
"PKG",26,22,1,"PAH",1,1,123,0)
  
"PKG",26,22,1,"PAH",1,1,124,0)
 Pre/Post Installation Overview:
"PKG",26,22,1,"PAH",1,1,125,0)
 -------------------------------
"PKG",26,22,1,"PAH",1,1,126,0)
 N/A 
"PKG",26,22,1,"PAH",1,1,127,0)
  
"PKG",26,22,1,"PAH",1,1,128,0)
 Pre-Installation Instructions:
"PKG",26,22,1,"PAH",1,1,129,0)
 ------------------------------
"PKG",26,22,1,"PAH",1,1,130,0)
 N/A
"PKG",26,22,1,"PAH",1,1,131,0)
  
"PKG",26,22,1,"PAH",1,1,132,0)
 Installation Instructions:
"PKG",26,22,1,"PAH",1,1,133,0)
 --------------------------
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","LRAPKOE")
0^1^B175040482^B175040482
"RTN","LRAPKOE",1,0)
LRAPKOE ;DSS/FHS - CRPS AP LAB ORDER ENTRY AND ACCESSION ;03/15/17  10:30
"RTN","LRAPKOE",2,0)
 ;;5.2;LAB SERVICE;**462,479,483**;Sep 27, 1994;Build 1
"RTN","LRAPKOE",3,0)
 ; Supported calls AI #, 5286,103,3615
"RTN","LRAPKOE",4,0)
EN1 ;
"RTN","LRAPKOE",5,0)
 ; Called from EN^LRAPLG
"RTN","LRAPKOE",6,0)
 ; Process CPRS AP Orders
"RTN","LRAPKOE",7,0)
 N ANS,ANSY,CNT,CONTROL,DA,DIC,DIERR,DIR,DIRUT,DOD,DR
"RTN","LRAPKOE",8,0)
 N DTOUT,DUOUT,ERR,FDA,FDAIEN,FIL,FLD,GOT,IEN,IENX,II
"RTN","LRAPKOE",9,0)
 N LR,LRAA,LRACN,LRACN0,LRAP690,LRAPNT,LRAPSPEC
"RTN","LRAPKOE",10,0)
 N LRAPTST,LRC,LRCAPA,LRCAPLOC,LRCHK
"RTN","LRAPKOE",11,0)
 N LRCOL,LRCOM,LRC5,LRDFN,LRDISC,LRDIE,LRDOC,LRDPF,LREND,LRFDA
"RTN","LRAPKOE",12,0)
 N LRFDAIEN,LRI,LRIDT,LRIEN,LRJ,LRLL,LRLLOC,LRLWC,LRMD,LRMSG
"RTN","LRAPKOE",13,0)
 N LRNATURE,LRNLT,LRNODE69,LRNONE,LROD0,LROD1,LROD3,LRODT,LRODT0
"RTN","LRAPKOE",14,0)
 N LROESTAT,LROLLOC,LRORD,LRORDRR,LROOS,LRORD,LRORDRR
"RTN","LRAPKOE",15,0)
 N LRORIFN,LRORNUM,LRORPOV,LRORTYP,LROS,LROSD,LRPRAC,LRPANEL,LRPHY,LRPL
"RTN","LRAPKOE",16,0)
 N LRPROVL,LRRC,LRROD,LRSAMP,LRSD,LRSIT,LRSN,LRSND
"RTN","LRAPKOE",17,0)
 N LRSP,LRSPCOM,LRSPEC,LRSS,LRSTATUS,LRSUBBY,LRSUBMIT
"RTN","LRAPKOE",18,0)
 N LRSVSN,LRT,LRTM7,LRTSORU,LRTST,LRTSTS,LRUID,LRURG,LRVAL,LRWKCD
"RTN","LRAPKOE",19,0)
 N LRWARD,LRWRDS,LRX,LRXX,LRYI,LRZX,M9,NODE,ODT,ORD
"RTN","LRAPKOE",20,0)
 N PNM,RET,S,SN,SSN,TMPDIAL,VA,VADM,VAIN
"RTN","LRAPKOE",21,0)
 N LREND,LRVAL,LRORPROV,LRSUBBY,X,X3,X4,Y
"RTN","LRAPKOE",22,0)
 ;
"RTN","LRAPKOE",23,0)
 N COBR,COBX,IFN,IFN1,LRA,LRACD,LRANC0,LRAU,LRCS,LRD,LRFIRST
"RTN","LRAPKOE",24,0)
 N LRO,LRP,LRSEL,LRSF,LRSOP,LRSTATI,LRSVC,LRTNAM
"RTN","LRAPKOE",25,0)
 N LRU,LRWARDS,ORBMSG,ORCMSG,SRTN,X10,X5,X6,X7,X9,Z1
"RTN","LRAPKOE",26,0)
 S LREND=0
"RTN","LRAPKOE",27,0)
 D CK^LRAP I Y<0 Q
"RTN","LRAPKOE",28,0)
 N X,Y
"RTN","LRAPKOE",29,0)
 ;;*
"RTN","LRAPKOE",30,0)
 S LRLWC="WC"
"RTN","LRAPKOE",31,0)
 ;;;*
"RTN","LRAPKOE",32,0)
 ; Select peforming laboratory
"RTN","LRAPKOE",33,0)
 I '$G(LRPL) S LRPL=DUZ(2) S LRVAL=$$SELPL^LRVERA(DUZ(2)) D END:LRVAL<1 Q:LRVAL<1  S LRPL=$S(LRVAL'=DUZ(2):LRVAL,1:DUZ(2))
"RTN","LRAPKOE",34,0)
L5 ;
"RTN","LRAPKOE",35,0)
 Q:$G(LREND)
"RTN","LRAPKOE",36,0)
NEXT ;from LROE1
"RTN","LRAPKOE",37,0)
 K DIR,LRYI,LRAPTST,GOT,LRAPDIAL,LRNODE69,LRSUBMIT,LRPHY,LRAD,LRAA,LRLLOC,LROLLOC,LRSUBBY,LRORPROV D KVAR^LRX
"RTN","LRAPKOE",38,0)
 I $D(LROESTAT) D:$P(LRPARAM,U,14) ^LRCAPV I $G(LREND) K LRLONG,LRPANEL Q
"RTN","LRAPKOE",39,0)
 S (LRODT,X,DT)=$$DT^XLFDT(),LRODT0=$$FMTE^XLFDT(DT,5)
"RTN","LRAPKOE",40,0)
 I '$D(^LRO(69,DT,1,0)) S ^LRO(69,DT,0)=DT,^LRO(69,DT,1,0)="^69.01PA^^",^LRO(69,"B",DT,DT)=""
"RTN","LRAPKOE",41,0)
 I $D(^LAB(69.9,1,"RO")),+$H'=+$P(^("RO"),U) D
"RTN","LRAPKOE",42,0)
 . W $C(7),!,"ROLLOVER ",$S($P(^("RO"),U,2):"IS RUNNING.",1:"HAS NOT RUN.")," ACCESSIONING SHOULDN'T BE DONE NOW.",$C(7),!
"RTN","LRAPKOE",43,0)
 . S DIR("A")="  Are you sure you want to continue",DIR(0)="Y",DIR("B")="No"
"RTN","LRAPKOE",44,0)
 I $T D ^DIR D END:$D(DIRUT) I Y'=1 W !,"OK, try later." D EN1
"RTN","LRAPKOE",45,0)
 S X="T-7",%DT="" D ^%DT S LRTM7=+Y
"RTN","LRAPKOE",46,0)
 K DIC,LRSND,LRSN,LRAPDIAL
"RTN","LRAPKOE",47,0)
 W !!,"Select Order number: " R LRORD:DTIME I LRORD["."!($D(LRLONG)&(LRORD="")) W !,"Wrong format" G EN1
"RTN","LRAPKOE",48,0)
 W @IOF S M9=0 G END:LRORD="^"  I LRORD="" W !?5,"No Order Number entered use standard Specimen Log-in process",! Q
"RTN","LRAPKOE",49,0)
 I $L(LRORD)>8 W !,"The order number entered is too long." H 1 G EN1
"RTN","LRAPKOE",50,0)
 S:LRORD?.N LRORD=+LRORD IF LRORD'?.N D QMSG G EN1
"RTN","LRAPKOE",51,0)
 I '$D(^LRO(69,"C",LRORD)) W !!?10,LRORD_" Does not exist, select another ",$C(7),! G EN1
"RTN","LRAPKOE",52,0)
 L +^LRO(69,"C",LRORD):$G(DILOCKTM,3)
"RTN","LRAPKOE",53,0)
 I '$T W !?5,"Someone else is editing this Order",!!,$C(7) G EN1
"RTN","LRAPKOE",54,0)
 S (LRCHK,LRNONE)=1,(M9,LRODT)=0
"RTN","LRAPKOE",55,0)
 F  S LRODT=+$O(^LRO(69,"C",LRORD,LRODT)) Q:LRODT<1  D
"RTN","LRAPKOE",56,0)
 . S DA=0 F  S DA=$O(^LRO(69,"C",LRORD,LRODT,DA)) Q:DA<1  S LRCHK=LRCHK-1 S:LRNONE'=2 LRNONE=0 D LROE2
"RTN","LRAPKOE",57,0)
 G:$G(LREND) EN1
"RTN","LRAPKOE",58,0)
 I DOD'="" S Y=DOD D DD^LRX W !,!,?5,@LRVIDO,"Patient ",PNM," died on: ",Y,@LRVIDOF W !
"RTN","LRAPKOE",59,0)
 D  I Y=0!($D(DIRUT)) K DIRUT,DTOUT,DUOUT,Y D KVAR^LRX G EN1
"RTN","LRAPKOE",60,0)
 . K Y
"RTN","LRAPKOE",61,0)
 . S DIR(0)="Y"
"RTN","LRAPKOE",62,0)
 . S DIR("A")="Do you wish to continue with this accession [Yes/No]"
"RTN","LRAPKOE",63,0)
 . S DIR("T")=120
"RTN","LRAPKOE",64,0)
 . D ^DIR K DIR
"RTN","LRAPKOE",65,0)
 I LRNONE=2,LRCHK<1 W !,"The order has already been partially accessioned." H 1
"RTN","LRAPKOE",66,0)
 I LRNONE=2,LRCHK>0 W !,"The order has already been accessioned." H 1 G NEXT
"RTN","LRAPKOE",67,0)
 I LRNONE=1 W !,"No order exists with that number." H 1 G NEXT
"RTN","LRAPKOE",68,0)
 I '$$GOT(LRORD) W !!,"All tests for this order have been canceled.",! G NEXT
"RTN","LRAPKOE",69,0)
 S LRODT=$O(^LRO(69,"C",LRORD,0)),LRSN=$O(^LRO(69,"C",LRORD,LRODT,0))
"RTN","LRAPKOE",70,0)
 I $P($G(^LRO(69,LRODT,1,LRSN,1)),U,4)'="" W !?5,"Specimen already processed" D END G EN1
"RTN","LRAPKOE",71,0)
 K LRPHY D DOC(.LRPHY,"PATHOLOGIST") I $G(LRPHY)<1 W !,"No Pathologist selected" D END G EN1
"RTN","LRAPKOE",72,0)
 S (LRPROVL,X)=+LRPHY D D^LRUA S LRPRAC(1)=X
"RTN","LRAPKOE",73,0)
 D DATE(.LRCDT,"COLLECTION DATE/TIME") I $G(LRCDT)<1 D END G EN1
"RTN","LRAPKOE",74,0)
 S LRURG=9,LRAD=DT
"RTN","LRAPKOE",75,0)
 S LRNODE69=^LRO(69,LRODT,1,LRSN,0)
"RTN","LRAPKOE",76,0)
 S LRSUBBY="" I $D(^LRO(69,LRODT,1,LRSN,12))#2 S LRSUBBY=^(12) ;SUBMITTED BY
"RTN","LRAPKOE",77,0)
 S LRORNUM=$G(^LRO(69,LRODT,1,LRSN,.1))
"RTN","LRAPKOE",78,0)
 S LRSUBMIT=$P(LRNODE69,U,2),LRSUBMIT=$P(^VA(200,LRSUBMIT,0),U)_U_LRSUBMIT
"RTN","LRAPKOE",79,0)
 S LRORIFN=$P(LRNODE69,U,11),LRORTYP=$P(LRNODE69,U,4)
"RTN","LRAPKOE",80,0)
 S LRORPROV=+$P($G(^LRO(69,LRODT,1,LRSN,11)),U,3) ;Ordering Provider Optional
"RTN","LRAPKOE",81,0)
NEXT2 ;
"RTN","LRAPKOE",82,0)
 S LRAPSPEC="",LRI=0
"RTN","LRAPKOE",83,0)
 F  S LRI=$O(^LRO(69,LRODT,1,LRSN,4,1,1,LRI)) Q:LRI<1  S LRAPSPEC(LRI)=^(LRI,0)
"RTN","LRAPKOE",84,0)
 S LRLLOC=$P(LRNODE69,U,7),LROLLOC=$P(LRNODE69,U,9) S:LRLLOC="" LRLLOC="NO ABRV"
"RTN","LRAPKOE",85,0)
 K LRCOM S LRCOM=""
"RTN","LRAPKOE",86,0)
 N LRYI S LRYI=0 F  S LRYI=$O(^LRO(69,LRODT,1,LRSN,2,1,1,LRYI)) Q:LRYI<1  D
"RTN","LRAPKOE",87,0)
 . S LRCOM(LRYI)=(^(LRYI,0))
"RTN","LRAPKOE",88,0)
 K LRYI K LRAPDIAL
"RTN","LRAPKOE",89,0)
 F LRYI=13,14,15,16 M LRAPDIAL(".0"_LRYI)=^LRO(69,LRODT,1,LRSN,LRYI) K LRAPDIAL(".0"_LRYI,0)
"RTN","LRAPKOE",90,0)
 K LRYI,LRAPTST,LRTST
"RTN","LRAPKOE",91,0)
 S (LRAA,LRSS)=""
"RTN","LRAPKOE",92,0)
 S LRYI=0 F  S LRYI=$O(^LRO(69,LRODT,1,LRSN,2,"B",LRYI)) Q:LRYI<1  S (LRTSORU,LRTST)=LRYI,LRAPTST(LRYI)="" D
"RTN","LRAPKOE",93,0)
 . S LRWKCD=+$G(^LAB(60,+LRTST,64)),LRNLT=$P($G(^LAM(LRWKCD,0)),"^",2),II=1
"RTN","LRAPKOE",94,0)
 . ;Get accession area for institution
"RTN","LRAPKOE",95,0)
 . S LRAA=+$P($G(^LAB(60,LRTST,8,+$G(LRPL),0)),U,2)
"RTN","LRAPKOE",96,0)
 . I 'LRAA D  Q
"RTN","LRAPKOE",97,0)
 . . S LRERR="[ "_$P($G(^LAB(60,LRTST,0)),U)_"]  DOES NOT HAVE AN APPROPRIATE ACCESSION AREA DEFINED"
"RTN","LRAPKOE",98,0)
 . . W !!,$$CJ^XLFSTR(LRERR,IOM)
"RTN","LRAPKOE",99,0)
 . . W !,$$CJ^XLFSTR("Log-in Aborted",IOM),!
"RTN","LRAPKOE",100,0)
 . . S LREND=1
"RTN","LRAPKOE",101,0)
 . I LRAA S LRSS=$P(^LAB(60,LRTST,0),U,4)
"RTN","LRAPKOE",102,0)
 . N LRI
"RTN","LRAPKOE",103,0)
 . S LRI=$O(^LRO(69,LRODT,1,LRSN,2,"B",LRYI,0))
"RTN","LRAPKOE",104,0)
 . S LRAPTST(LRYI)=$P(^LRO(69,LRODT,1,LRSN,2,LRI,0),U,7)
"RTN","LRAPKOE",105,0)
 ;;;*
"RTN","LRAPKOE",106,0)
 I $G(LREND) K LRERR,LREND D END G EN1
"RTN","LRAPKOE",107,0)
 K LRDPF D PT^LRX
"RTN","LRAPKOE",108,0)
 K LRYI D KVA^VADPT
"RTN","LRAPKOE",109,0)
 S LRAPDIAL=1,LRAP690=$G(LROD0),LRSTATUS="C"
"RTN","LRAPKOE",110,0)
 ;;*
"RTN","LRAPKOE",111,0)
 S LROUTINE=9
"RTN","LRAPKOE",112,0)
 S X=$P(^LRO(68,LRAA,0),U) D ^LRUTL
"RTN","LRAPKOE",113,0)
 S (Y,LRAD)=DT D LRAD^LRU
"RTN","LRAPKOE",114,0)
 ;;;*
"RTN","LRAPKOE",115,0)
 D CHECK68^LRWLST1(LRAA,LRAD)
"RTN","LRAPKOE",116,0)
 S:'$D(^LRO(68,LRAA,1,LRAD,1,0)) ^LRO(68,LRAA,1,LRAD,1,0)="^68.02PA^"
"RTN","LRAPKOE",117,0)
 S LRAN=+$P(^LRO(68,LRAA,1,LRAD,1,0),U,3)
"RTN","LRAPKOE",118,0)
 F  Q:'$D(^LRO(68,LRAA,1,LRAD,1,LRAN))  S LRAN=LRAN+1
"RTN","LRAPKOE",119,0)
 S LRAC=$P(^LRO(68,LRAA,0),U,11)_" "_$S(LRAD["0000":$E(LRAD,2,3),1:$E(LRAD,4,7))_" "_LRAN
"RTN","LRAPKOE",120,0)
 D CRE863^LRAPLG1
"RTN","LRAPKOE",121,0)
 K LRXX S LRXX(LRTST)="" D ORDTST
"RTN","LRAPKOE",122,0)
 D MOVE(LRDFN,LRSS,LRIDT)
"RTN","LRAPKOE",123,0)
 ;
"RTN","LRAPKOE",124,0)
SET68 ;Setup ^LRO(68,LRAA,1,LRAD,1,LRAN
"RTN","LRAPKOE",125,0)
 I LRSS'="AU" D
"RTN","LRAPKOE",126,0)
 .  K LRDIE D CRE868^LRAPLG1
"RTN","LRAPKOE",127,0)
 . S X=^LR(LRDFN,LRSS,LRI,0),LRIDT=LRI,LRCAPLOC=""
"RTN","LRAPKOE",128,0)
 . S LRSD=$P(X,U),LRRC=$P(X,U,10),LRACC=$P(X,U,6),LRMD(1)=$P(X,U,7),LRSIT=$P(X,U,5),LRCS=$P(X,U,11),LRLLOC=$P(X,U,8),LRC(5)=""
"RTN","LRAPKOE",129,0)
 . K LRDIE D EN^LRUWLF
"RTN","LRAPKOE",130,0)
 D UPD68
"RTN","LRAPKOE",131,0)
 L
"RTN","LRAPKOE",132,0)
 Q
"RTN","LRAPKOE",133,0)
 ;
"RTN","LRAPKOE",134,0)
MOVE(LRDFN,LRSS,LRI) ;Move CPRS AP Dialog to ^LR(LRDFN,LRSS,LRI)
"RTN","LRAPKOE",135,0)
 ;Check to see if Surgery Package Dialog is available
"RTN","LRAPKOE",136,0)
 D ^LRAPKLG
"RTN","LRAPKOE",137,0)
 ;
"RTN","LRAPKOE",138,0)
 N ANS,X,Y,ERR,IEN,FDA,FIL,LRX
"RTN","LRAPKOE",139,0)
 S FIL=63.08,FLD=.013
"RTN","LRAPKOE",140,0)
 S IEN=LRI_","_LRDFN_","
"RTN","LRAPKOE",141,0)
 S:LRSS="SP" FIL=63.08
"RTN","LRAPKOE",142,0)
 S:LRSS="CY" FIL=63.09
"RTN","LRAPKOE",143,0)
 S:LRSS="EM" FIL=63.02
"RTN","LRAPKOE",144,0)
 S LRX=0 F  S LRX=$O(LRAPDIAL(LRX)) Q:LRX=""  D
"RTN","LRAPKOE",145,0)
 . K ERR D WP^DIE(FIL,IEN,LRX,"A","LRAPDIAL("_LRX_")","ERR")
"RTN","LRAPKOE",146,0)
 Q
"RTN","LRAPKOE",147,0)
 ;
"RTN","LRAPKOE",148,0)
ORDTST ; Ordered test
"RTN","LRAPKOE",149,0)
 N XX
"RTN","LRAPKOE",150,0)
 S LRWKCD=+$G(^LAB(60,+$G(LRTST),64)),LRNLT=$P($G(^LAM(LRWKCD,0)),"^",2),II=1
"RTN","LRAPKOE",151,0)
 S XX=0
"RTN","LRAPKOE",152,0)
 F  S XX=$O(LRXX(XX)) Q:'XX  S $P(LRXX(XX),"^",2)=LRNLT_"^"_+LRTST
"RTN","LRAPKOE",153,0)
 Q
"RTN","LRAPKOE",154,0)
 ;
"RTN","LRAPKOE",155,0)
LROE2 ;
"RTN","LRAPKOE",156,0)
 S LREND=0 I '$D(^LRO(69,LRODT,1,DA,0)) Q
"RTN","LRAPKOE",157,0)
 N IEN,FLD,FIL,ANS
"RTN","LRAPKOE",158,0)
 S FIL=69.01,FLD=13,IEN=DA_","_LRODT_","
"RTN","LRAPKOE",159,0)
 S ANS=$$GET1^DIQ(FIL,IEN,13,,"ANS","ERR")
"RTN","LRAPKOE",160,0)
 I $L(ANS) D  Q
"RTN","LRAPKOE",161,0)
 . W !,$$CJ^XLFSTR("The order# "_LRORD_" has been "_ANS,IOM),!
"RTN","LRAPKOE",162,0)
 . W $$CJ^XLFSTR("Select another order",IOM),!
"RTN","LRAPKOE",163,0)
 . S LREND=1
"RTN","LRAPKOE",164,0)
 I $D(^LRO(69,LRODT,1,DA,1)) D
"RTN","LRAPKOE",165,0)
 . I $P(^LRO(69,LRODT,1,DA,1),U,4)="C" S LRNONE=2,LRCHK=LRCHK+1 Q
"RTN","LRAPKOE",166,0)
 . I $P(^LRO(69,LRODT,1,DA,0),U,4)="LC",$P(^LRO(69,LRODT,1,DA,1),U,4)="" S LRNONE=2,LRCHK=LRCHK+1
"RTN","LRAPKOE",167,0)
 ;
"RTN","LRAPKOE",168,0)
 K LRSN
"RTN","LRAPKOE",169,0)
 S (LRSN,LRSN(DA))=+DA,LREND=0
"RTN","LRAPKOE",170,0)
 I '$D(^LRO(69,LRODT,1,LRSN,0)) Q
"RTN","LRAPKOE",171,0)
 I '$O(^LRO(69,LRODT,1,LRSN,13,0)) W !?5,"No AP Dialog for this order" S LREND=1 Q
"RTN","LRAPKOE",172,0)
 S M9=$G(M9)+1,LRZX=^LRO(69,LRODT,1,LRSN,0),LRDFN=+LRZX,LRDPF=$P(^LR(LRDFN,0),U,2),DFN=$P(^(0),U,3)
"RTN","LRAPKOE",173,0)
 D PT^LRX
"RTN","LRAPKOE",174,0)
 I $G(VA("MRN"))]"" D
"RTN","LRAPKOE",175,0)
 .W !,PNM,?30,$G(VA("MRN",0))_": "_SSN
"RTN","LRAPKOE",176,0)
 .W !,?30,"DOB: "_$P($G(VADM(3)),U,2) S LRWRDS=LRWRD
"RTN","LRAPKOE",177,0)
 E  W !,PNM,?30,SSN S LRWRDS=LRWRD
"RTN","LRAPKOE",178,0)
 W ?45,"Requesting location: ",$P(LRZX,U,7) S Y=$P(LRZX,U,5) D DD^LRX W !,"Date/Time Ordered: ",Y,?45,"By: ",$S($D(^VA(200,+$P(LRZX,U,2),0)):$P(^(0),U),1:"")
"RTN","LRAPKOE",179,0)
 S LRSVSN=LRSN D ORDER^LROS S LRSN=LRSVSN
"RTN","LRAPKOE",180,0)
 Q
"RTN","LRAPKOE",181,0)
 ;
"RTN","LRAPKOE",182,0)
 ;
"RTN","LRAPKOE",183,0)
QMSG W !,"Enter the order entry number assigned when the test was ordered."
"RTN","LRAPKOE",184,0)
 W:'$D(LRLONG) !,"If the test has not been ordered, type the RETURN key to exit."
"RTN","LRAPKOE",185,0)
 W !,"To exit, type the ""^"" key and RETURN key."
"RTN","LRAPKOE",186,0)
 Q
"RTN","LRAPKOE",187,0)
 ;
"RTN","LRAPKOE",188,0)
 ;
"RTN","LRAPKOE",189,0)
END K DIR,DIRUT,GOT
"RTN","LRAPKOE",190,0)
 D ^LRORDK,LROEND^LRORDK,STOP^LRCAPV,CLEAN D KVAR^LRX
"RTN","LRAPKOE",191,0)
 S LREND=1
"RTN","LRAPKOE",192,0)
 Q
"RTN","LRAPKOE",193,0)
 ;
"RTN","LRAPKOE",194,0)
 ;
"RTN","LRAPKOE",195,0)
GOT(ORD) ;See if all tests have been canceled
"RTN","LRAPKOE",196,0)
 N I,SN,ODT
"RTN","LRAPKOE",197,0)
 S (GOT,ODT,SN)=0
"RTN","LRAPKOE",198,0)
 F  S ODT=$O(^LRO(69,"C",ORD,ODT)) Q:ODT<1  D
"RTN","LRAPKOE",199,0)
 . S SN=0 F  S SN=$O(^LRO(69,"C",ORD,ODT,SN)) Q:SN<1!(GOT)  D
"RTN","LRAPKOE",200,0)
 . . Q:'$D(^LRO(69,ODT,1,SN,0))
"RTN","LRAPKOE",201,0)
 . . S I=0 F  S I=$O(^LRO(69,ODT,1,SN,2,I)) Q:I<1  I $D(^(I,0)),'$P(^(0),"^",11) S GOT=1 Q
"RTN","LRAPKOE",202,0)
 Q GOT
"RTN","LRAPKOE",203,0)
 ;
"RTN","LRAPKOE",204,0)
UPD68 ; Update #68 with required test data
"RTN","LRAPKOE",205,0)
 N LRFILE,ERR,IEN,LRI,LRIEN,LRCNT
"RTN","LRAPKOE",206,0)
 S LRFILE=68.04,IEN(1)=LRTST
"RTN","LRAPKOE",207,0)
 S LRIEN="?+1,"_LRAN_","_LRAD_","_LRAA_","
"RTN","LRAPKOE",208,0)
 S FDA(3,LRFILE,LRIEN,.01)=LRTST
"RTN","LRAPKOE",209,0)
 S FDA(3,LRFILE,LRIEN,1)=LROUTINE
"RTN","LRAPKOE",210,0)
 S FDA(3,LRFILE,LRIEN,8.1)=LRTST
"RTN","LRAPKOE",211,0)
 D UPDATE^DIE("","FDA(3)","IEN","ERR(3)")
"RTN","LRAPKOE",212,0)
 ;
"RTN","LRAPKOE",213,0)
 ;
"RTN","LRAPKOE",214,0)
SPEC68 ; Update #68 with specimen data
"RTN","LRAPKOE",215,0)
 S (LRI,LRCNT)=0 F  S LRI=$O(LRAPSPEC(LRI)) Q:LRI<1  D
"RTN","LRAPKOE",216,0)
 .  K LRFILE,FDAIEN,IEN
"RTN","LRAPKOE",217,0)
 .  S LRFILE=68.05,LRCNT=LRCNT+1
"RTN","LRAPKOE",218,0)
 .  S LRSPEC=$P(LRAPSPEC(LRI),U,6)
"RTN","LRAPKOE",219,0)
 .  S LRSAMP=$P(LRAPSPEC(LRI),U,7)
"RTN","LRAPKOE",220,0)
 .  S FDAIEN="?+"_LRCNT_","_LRAN_","_LRAD_","_LRAA_","
"RTN","LRAPKOE",221,0)
 .  S FDA(31,LRFILE,FDAIEN,.01)=LRSPEC
"RTN","LRAPKOE",222,0)
 .  S FDA(31,LRFILE,FDAIEN,1)=LRSAMP
"RTN","LRAPKOE",223,0)
 .  D UPDATE^DIE("","FDA(31)","IEN","LRERR(31)")
"RTN","LRAPKOE",224,0)
 ;
"RTN","LRAPKOE",225,0)
 S LRCAPA=$P(^LAB(69.9,1,0),"^",14)&($P(^LRO(68,LRAA,0),"^",16))
"RTN","LRAPKOE",226,0)
 I $G(LRCAPA) D WKLD ; Stuff workload data into accession.
"RTN","LRAPKOE",227,0)
 ;
"RTN","LRAPKOE",228,0)
 D LR7OB1 ;;Update CPRS to active status
"RTN","LRAPKOE",229,0)
 ;
"RTN","LRAPKOE",230,0)
 D LR7OFAO ;Update ^LRO(69 with accession data.
"RTN","LRAPKOE",231,0)
 ;
"RTN","LRAPKOE",232,0)
 D SPEC63(LRDFN,LRSS,LRIDT,.LRAPSPEC) ;Load AP Specimens into ^LR(
"RTN","LRAPKOE",233,0)
 ;
"RTN","LRAPKOE",234,0)
 D LRCOM(LRDFN,LRSS,LRIDT,.LRCOM) ; Store comments into ^LR(
"RTN","LRAPKOE",235,0)
 ;
"RTN","LRAPKOE",236,0)
 D ORUT^LRWLST11 ;Populate the ^LR(LRDFN,LRSS,LRIDT,"ORUT" with test data
"RTN","LRAPKOE",237,0)
 ;
"RTN","LRAPKOE",238,0)
 D DIS63(LRDFN,LRSS,LRIDT) ; Display ^LR(LRDFN,LRSS,LRIDT) data.
"RTN","LRAPKOE",239,0)
 ;
"RTN","LRAPKOE",240,0)
 W !,$$CJ^XLFSTR("****  Enter Next Order ****",IOM),!
"RTN","LRAPKOE",241,0)
 Q
"RTN","LRAPKOE",242,0)
DOC(RET,LABEL) ; Return provider
"RTN","LRAPKOE",243,0)
 ;IN = RET by reference
"RTN","LRAPKOE",244,0)
 ;     Label is the prompt the user will see
"RTN","LRAPKOE",245,0)
 ;OUT = LREND=1 if user fails to answer the prompt correctly
"RTN","LRAPKOE",246,0)
 ;      RET = +y
"RTN","LRAPKOE",247,0)
 ;      RET(0) = IEN^.01 FIELD
"RTN","LRAPKOE",248,0)
 N DIR,X,Y,DIRUT,DTOUT,DUOUT
"RTN","LRAPKOE",249,0)
 S DIR(0)="P^200:EQMF",LREND=0
"RTN","LRAPKOE",250,0)
 S DIR("S")="I $D(^VA(200,""AK.PROVIDER"",$P(^(0),U)))"
"RTN","LRAPKOE",251,0)
 S DIR("A")=LABEL
"RTN","LRAPKOE",252,0)
 D ^DIR
"RTN","LRAPKOE",253,0)
 I Y<1 S LREND=1 Q
"RTN","LRAPKOE",254,0)
 S RET=+Y,RET(0)=Y
"RTN","LRAPKOE",255,0)
 Q
"RTN","LRAPKOE",256,0)
DATE(RET,LABEL) ;
"RTN","LRAPKOE",257,0)
 ;
"RTN","LRAPKOE",258,0)
 ;IN = RET by reference
"RTN","LRAPKOE",259,0)
 ;     Label is the prompt the user will see
"RTN","LRAPKOE",260,0)
 ;OUT = LREND=1 if user fails to answer the prompt correctly
"RTN","LRAPKOE",261,0)
 ;      RET = Y
"RTN","LRAPKOE",262,0)
 N DIR,X,Y,DIRUT,DTOUT,DUOUT
"RTN","LRAPKOE",263,0)
 S LREND=0,DIR("A")=LABEL,DIR("?")="Date can not be in the future"
"RTN","LRAPKOE",264,0)
 S DIR(0)="D^:-NOW:EXT"
"RTN","LRAPKOE",265,0)
 D ^DIR
"RTN","LRAPKOE",266,0)
 I Y<1 S LREND=1
"RTN","LRAPKOE",267,0)
 S RET=Y
"RTN","LRAPKOE",268,0)
 Q
"RTN","LRAPKOE",269,0)
DA(Y) ; Returns date in eye-readable month format
"RTN","LRAPKOE",270,0)
 Q $$FMTE^XLFDT(Y,"M")
"RTN","LRAPKOE",271,0)
 Q
"RTN","LRAPKOE",272,0)
LR7OB1 ;Update CPRS to active status
"RTN","LRAPKOE",273,0)
 K DIERR,IEN,LRFDA,ERR
"RTN","LRAPKOE",274,0)
 K ERR
"RTN","LRAPKOE",275,0)
 S LRORD=+$G(^LRO(69,LRODT,1,LRSN,.1))
"RTN","LRAPKOE",276,0)
 S IEN=LRSN_","_LRODT_","
"RTN","LRAPKOE",277,0)
 I '$G(^LRO(69,LRODT,1,LRSN,1)) D
"RTN","LRAPKOE",278,0)
 . S LRFDA(1,69.01,IEN,10)=+$G(LRCDT,$$NOW^XLFDT)
"RTN","LRAPKOE",279,0)
 . S LRFDA(1,69.01,IEN,12)=DUZ
"RTN","LRAPKOE",280,0)
 . S LRFDA(1,69.01,IEN,13)="C"
"RTN","LRAPKOE",281,0)
 . I $G(LRPL) S LRFDA(1,69.01,IEN,25)=+$G(LRPL)
"RTN","LRAPKOE",282,0)
 . S LRFDA(1,69.01,IEN,20)=LRNT
"RTN","LRAPKOE",283,0)
 . D UPDATE^DIE("KS","LRFDA(1)","IEN","ERR")
"RTN","LRAPKOE",284,0)
 K ^LRO(69,"AA",LRODT_"|"_LRSN) ;DD 69.01,13 is incorrect
"RTN","LRAPKOE",285,0)
 S ^LRO(69,"AA",LRORD,LRODT_"|"_LRSN)=""
"RTN","LRAPKOE",286,0)
 ;Update status in OR(100,
"RTN","LRAPKOE",287,0)
 S LRORIFN=+$P($G(^LRO(69,LRODT,1,LRSN,2,1,0)),"^",7) D
"RTN","LRAPKOE",288,0)
 . S CONTROL=$S($G(LRORIFN):"SC",1:"SN")
"RTN","LRAPKOE",289,0)
 . D NEW^LR7OB1(LRODT,LRSN,CONTROL,,,6)
"RTN","LRAPKOE",290,0)
 Q
"RTN","LRAPKOE",291,0)
LR7OFAO ;Update ^LRO(69 with accession data.
"RTN","LRAPKOE",292,0)
   ;
"RTN","LRAPKOE",293,0)
 K IEN,LRFDA,LRFDAIEN,LRMSG,DIERR
"RTN","LRAPKOE",294,0)
 S IEN="?+1,"_LRSN_","_LRODT_","
"RTN","LRAPKOE",295,0)
 S LRFDA(6,69.03,IEN,.01)=LRTST
"RTN","LRAPKOE",296,0)
 I $G(LROUTINE) S LRFDA(6,69.03,IEN,1)=LROUTINE
"RTN","LRAPKOE",297,0)
 S LRFDA(6,69.03,IEN,2)=LRAD
"RTN","LRAPKOE",298,0)
 S LRFDA(6,69.03,IEN,3)=LRAA
"RTN","LRAPKOE",299,0)
 S LRFDA(6,69.03,IEN,4)=LRAN
"RTN","LRAPKOE",300,0)
 S LRFDA(6,69.03,IEN,13)=LRUID
"RTN","LRAPKOE",301,0)
 S LRFDA(6,69.03,IEN,8)="IP"
"RTN","LRAPKOE",302,0)
 S LRFDA(6,69.03,IEN,9)="L"
"RTN","LRAPKOE",303,0)
 D UPDATE^DIE("","LRFDA(6)","LRFDAIEN","LRMSG")
"RTN","LRAPKOE",304,0)
 Q
"RTN","LRAPKOE",305,0)
DIS63(LRDFN,LRSS,LRIDT) ;Display ^LR(LRDFN,LRSS,LRIDT data
"RTN","LRAPKOE",306,0)
 Q:'$G(^LR(LRDFN,LRSS,LRIDT,0))
"RTN","LRAPKOE",307,0)
 W @IOF,!!,$$CJ^XLFSTR("-------------------------------------",IOM),!
"RTN","LRAPKOE",308,0)
 W $$CJ^XLFSTR("Display of CPRS data in LAB DATA file",IOM),!
"RTN","LRAPKOE",309,0)
 N ANS,DIC,DA,DR,ERR,CNT,ID,IEN,LREND,LRFILE,LRPAGE,S
"RTN","LRAPKOE",310,0)
 S DA=LRIDT,DA(1)=LRDFN,LREND=0
"RTN","LRAPKOE",311,0)
 S DIC="^LR("_LRDFN_","_""""_LRSS_""""_",",DR=0,S=1
"RTN","LRAPKOE",312,0)
 D EN^DIQ S LRPAGE=S
"RTN","LRAPKOE",313,0)
 S LRFILE=$S(LRSS="SP":63.08,LRSS="CY":63.09,LRSS="EM":63.02,1:0)
"RTN","LRAPKOE",314,0)
 S IEN=DA_","_DA(1)_","
"RTN","LRAPKOE",315,0)
 D GETS^DIQ(LRFILE,IEN,".01:16","ERRZ","ANS","ERR")
"RTN","LRAPKOE",316,0)
 F ID="BRIEF CLINICAL HISTORY","PREOPERATIVE DIAGNOSIS","OPERATIVE FINDINGS","POSTOPERATIVE DIAGNOSIS" Q:$G(LREND)  D
"RTN","LRAPKOE",317,0)
 . I $O(ANS(LRFILE,IEN,ID,0)) W !?5,ID_":" D PAGE Q:$G(LREND)  D
"RTN","LRAPKOE",318,0)
 . . S CNT=0 F  S CNT=$O(ANS(LRFILE,IEN,ID,CNT)) Q:CNT<1!($G(LREND))  D
"RTN","LRAPKOE",319,0)
 . . . W !,ANS(LRFILE,IEN,ID,CNT,0) D PAGE
"RTN","LRAPKOE",320,0)
 W:'$G(LREND) !!,$$CJ^XLFSTR("--- End of CPRS data in LAB DATA file ---",IOM),!
"RTN","LRAPKOE",321,0)
 Q
"RTN","LRAPKOE",322,0)
 ;
"RTN","LRAPKOE",323,0)
SPEC63(LRDFN,LRSS,LRIDT,LRAPSPEC) ;Load AP Specimens into ^LR(
"RTN","LRAPKOE",324,0)
    ; INPUT  LRAPSPEC(1)="CERVICAL CYTOLOGIC MATERIAL,Thin Prep^^^^^6242^55"
"RTN","LRAPKOE",325,0)
 ;
"RTN","LRAPKOE",326,0)
 K LRFDA,IEN,IENX,ERR,ERR2,WPIEN68,NODE,ANS,ANSY,LRSP,LRCOL
"RTN","LRAPKOE",327,0)
 K LRJ,NODE,LRFILE,LRSPCOM,LRSPEC,LRSAMP
"RTN","LRAPKOE",328,0)
 ;
"RTN","LRAPKOE",329,0)
 Q:LRSS="AU"!(LRSS="BB")
"RTN","LRAPKOE",330,0)
 S LRFILE=$S(LRSS="SP":63.812,LRSS="CY":63.902,LRSS="EM":63.202,1:0)
"RTN","LRAPKOE",331,0)
 S IEN="+1,"_LRIDT_","_LRDFN_","
"RTN","LRAPKOE",332,0)
 S:'$G(IENX) IENX=0 F  S IENX=$O(LRAPSPEC(IENX)) Q:IENX<1  D
"RTN","LRAPKOE",333,0)
 . S NODE=LRAPSPEC(IENX),LRSPCOM=$P(NODE,U),LRSPEC=+$P(NODE,U,6),LRSAMP=$P(NODE,U,7)
"RTN","LRAPKOE",334,0)
 . Q:$S('LRSPEC:1,'LRSAMP:1,1:0)
"RTN","LRAPKOE",335,0)
 . K LRFDA,ERR,ANSY
"RTN","LRAPKOE",336,0)
 . S LRFDA(2,LRFILE,IEN,.01)=LRSPCOM ;Specimen Description
"RTN","LRAPKOE",337,0)
 . S LRFDA(2,LRFILE,IEN,.06)=LRSPEC ;Specimen  ^LAB(61,LRSP
"RTN","LRAPKOE",338,0)
 . S LRFDA(2,LRFILE,IEN,.07)=LRSAMP ; Collection Sample ^LAB(62,LRCOL
"RTN","LRAPKOE",339,0)
 . D UPDATE^DIE("KS","LRFDA(2)","ANSY(1)","ERR")
"RTN","LRAPKOE",340,0)
 Q
"RTN","LRAPKOE",341,0)
LRCOM(LRDFN,LRSS,LRIDT,LRCOM) ;Store Comments into ^LR(
"RTN","LRAPKOE",342,0)
 ;IN   LRCOM(1)="~For Test: GYNECOLOGY"
"RTN","LRAPKOE",343,0)
 K LRFILE,LRFDA,IEN,CNT
"RTN","LRAPKOE",344,0)
 S LRFILE=$S(LRSS="CH":63.041,LRSS="MI":63.05,LRSS="SP":63.98,LRSS="CY":63.908,LRSS="EM":63.208,1:"")
"RTN","LRAPKOE",345,0)
 Q:'LRFILE
"RTN","LRAPKOE",346,0)
 S IEN="+1,"_LRIDT_","_LRDFN_",",CNT=0
"RTN","LRAPKOE",347,0)
 F  S CNT=$O(LRCOM(CNT)) Q:CNT<1  D
"RTN","LRAPKOE",348,0)
 . K LRFDA,ERR
"RTN","LRAPKOE",349,0)
 . S LRFDA(9,LRFILE,IEN,.01)=LRCOM(CNT)
"RTN","LRAPKOE",350,0)
 . D UPDATE^DIE("KS","LRFDA(9)","","ERR")
"RTN","LRAPKOE",351,0)
 Q
"RTN","LRAPKOE",352,0)
CLEAN ;Kill variable
"RTN","LRAPKOE",353,0)
 Q
"RTN","LRAPKOE",354,0)
WKLD ;Setup workload info
"RTN","LRAPKOE",355,0)
 ;
"RTN","LRAPKOE",356,0)
 N LR,LRI,LRK,LRRC,LRT,LRW
"RTN","LRAPKOE",357,0)
 S LRI=LRIDT
"RTN","LRAPKOE",358,0)
 S LRRC=$S($G(LRCDT):LRCDT,1:$$NOW^XLFDT)
"RTN","LRAPKOE",359,0)
 S LRCAPA=$P(^LAB(69.9,1,0),"^",14)&($P(^LRO(68,LRAA,0),"^",16))
"RTN","LRAPKOE",360,0)
 ;
"RTN","LRAPKOE",361,0)
 S LR("L")=LRSS_"^LRAP" I LRCAPA,"AUSP"[LRSS S X=$S(LRSS="SP":"H & E STAIN",1:"AUTOPSY H & E") D X^LRUWK I $D(X) S LRW("H&E")=LRT D ^LRAPSWK
"RTN","LRAPKOE",362,0)
 ;
"RTN","LRAPKOE",363,0)
 I LRCAPA,LRSS="EM" S X="THICK SECTION EM" D X^LRUWK I $D(X) S X=11 D SET1 S LRW("SS")=LRT_U_X S X="GRID EM" D X^LRUWK I $D(X) S X=12 D SET1 S LRW("G")=LRT_U_X D ^LRAPSWK
"RTN","LRAPKOE",364,0)
 ;
"RTN","LRAPKOE",365,0)
 I LRCAPA D
"RTN","LRAPKOE",366,0)
 . K LRT S LRT=0 F  S LRT=$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRT)) Q:LRT<1  D
"RTN","LRAPKOE",367,0)
 . . Q:$P(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRT,0),U,2)>49
"RTN","LRAPKOE",368,0)
 . . I LRSS="CY" D ^LRAPCWK
"RTN","LRAPKOE",369,0)
 . . I LRSS?1(1"SP",1"EM") D ^LRAPSWK,^LRSPGD
"RTN","LRAPKOE",370,0)
 ;
"RTN","LRAPKOE",371,0)
 Q
"RTN","LRAPKOE",372,0)
SET1 S X=$P($G(^LRO(69.2,LRAA,0)),"^",X) S:'X X=1
"RTN","LRAPKOE",373,0)
 Q
"RTN","LRAPKOE",374,0)
PAGE ;Page Prompt
"RTN","LRAPKOE",375,0)
 Q:$E(IOST,1)'="C"
"RTN","LRAPKOE",376,0)
 S LRPAGE=$G(LRPAGE)+1,LREND=0 Q:LRPAGE<(IOSL-2)
"RTN","LRAPKOE",377,0)
 S DIR(0)="E" D ^DIR K DIR I $G(Y)=0 S LREND=1 Q
"RTN","LRAPKOE",378,0)
 S LRPAGE=2 W @IOF
"RTN","LRAPKOE",379,0)
 Q
"VER")
8.0^22.2
"BLD",9903,6)
^387
**END**
**END**

