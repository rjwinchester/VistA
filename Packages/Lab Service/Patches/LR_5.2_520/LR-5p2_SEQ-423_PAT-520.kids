Released LR*5.2*520 SEQ #423
Extracted from mail message
**KIDS**:LR*5.2*520^

**INSTALL NAME**
LR*5.2*520
"BLD",11421,0)
LR*5.2*520^LAB SERVICE^0^3190307^y
"BLD",11421,1,0)
^^1^1^3190301^
"BLD",11421,1,1,0)
CANCELED LAB TEST PROBLEM
"BLD",11421,4,0)
^9.64PA^^
"BLD",11421,6.3)
3
"BLD",11421,"ABPKG")
n
"BLD",11421,"KRN",0)
^9.67PA^1.5^24
"BLD",11421,"KRN",.4,0)
.4
"BLD",11421,"KRN",.401,0)
.401
"BLD",11421,"KRN",.402,0)
.402
"BLD",11421,"KRN",.403,0)
.403
"BLD",11421,"KRN",.5,0)
.5
"BLD",11421,"KRN",.84,0)
.84
"BLD",11421,"KRN",1.5,0)
1.5
"BLD",11421,"KRN",1.6,0)
1.6
"BLD",11421,"KRN",1.61,0)
1.61
"BLD",11421,"KRN",1.62,0)
1.62
"BLD",11421,"KRN",3.6,0)
3.6
"BLD",11421,"KRN",3.8,0)
3.8
"BLD",11421,"KRN",9.2,0)
9.2
"BLD",11421,"KRN",9.8,0)
9.8
"BLD",11421,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",11421,"KRN",9.8,"NM",1,0)
LR7OSMZ1^^0^B18324120
"BLD",11421,"KRN",9.8,"NM",2,0)
LRMIPSZ1^^0^B50337425
"BLD",11421,"KRN",9.8,"NM","B","LR7OSMZ1",1)

"BLD",11421,"KRN",9.8,"NM","B","LRMIPSZ1",2)

"BLD",11421,"KRN",19,0)
19
"BLD",11421,"KRN",19.1,0)
19.1
"BLD",11421,"KRN",101,0)
101
"BLD",11421,"KRN",409.61,0)
409.61
"BLD",11421,"KRN",771,0)
771
"BLD",11421,"KRN",779.2,0)
779.2
"BLD",11421,"KRN",870,0)
870
"BLD",11421,"KRN",8989.51,0)
8989.51
"BLD",11421,"KRN",8989.52,0)
8989.52
"BLD",11421,"KRN",8994,0)
8994
"BLD",11421,"KRN","B",.4,.4)

"BLD",11421,"KRN","B",.401,.401)

"BLD",11421,"KRN","B",.402,.402)

"BLD",11421,"KRN","B",.403,.403)

"BLD",11421,"KRN","B",.5,.5)

"BLD",11421,"KRN","B",.84,.84)

"BLD",11421,"KRN","B",1.5,1.5)

"BLD",11421,"KRN","B",1.6,1.6)

"BLD",11421,"KRN","B",1.61,1.61)

"BLD",11421,"KRN","B",1.62,1.62)

"BLD",11421,"KRN","B",3.6,3.6)

"BLD",11421,"KRN","B",3.8,3.8)

"BLD",11421,"KRN","B",9.2,9.2)

"BLD",11421,"KRN","B",9.8,9.8)

"BLD",11421,"KRN","B",19,19)

"BLD",11421,"KRN","B",19.1,19.1)

"BLD",11421,"KRN","B",101,101)

"BLD",11421,"KRN","B",409.61,409.61)

"BLD",11421,"KRN","B",771,771)

"BLD",11421,"KRN","B",779.2,779.2)

"BLD",11421,"KRN","B",870,870)

"BLD",11421,"KRN","B",8989.51,8989.51)

"BLD",11421,"KRN","B",8989.52,8989.52)

"BLD",11421,"KRN","B",8994,8994)

"BLD",11421,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",11421,"QUES",0)
^9.62^^
"BLD",11421,"REQB",0)
^9.611^1^1
"BLD",11421,"REQB",1,0)
LR*5.2*350^2
"BLD",11421,"REQB","B","LR*5.2*350",1)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2981028^66481
"PKG",26,22,1,"PAH",1,0)
520^3190307
"PKG",26,22,1,"PAH",1,1,0)
^^1^1^3190307
"PKG",26,22,1,"PAH",1,1,1,0)
CANCELED LAB TEST PROBLEM
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","LR7OSMZ1")
0^1^B18324120^B17671319
"RTN","LR7OSMZ1",1,0)
LR7OSMZ1 ;DALOI/JMC - Silent Micro rpt Cont. ;Mar 05, 2019@13:04:42
"RTN","LR7OSMZ1",2,0)
 ;;5.2;LAB SERVICE;**121,244,350,520**;Sep 27, 1994;Build 3
"RTN","LR7OSMZ1",3,0)
 ;
"RTN","LR7OSMZ1",4,0)
EN ; from LRMINEW2, LRMIPC, LRMIPLOG, LR7OSMZ, LRMIVER1
"RTN","LR7OSMZ1",5,0)
 S LRSPEC=$P(LRLLT,U,5)
"RTN","LR7OSMZ1",6,0)
 I LRONESPC'="",LRSPEC'=LRONESPC Q
"RTN","LR7OSMZ1",7,0)
 ;
"RTN","LR7OSMZ1",8,0)
 N GIOM
"RTN","LR7OSMZ1",9,0)
 S GIOM=$G(LRGIOM)
"RTN","LR7OSMZ1",10,0)
 I GIOM="" D
"RTN","LR7OSMZ1",11,0)
 . S GIOM=$$GET^XPAR("USR^DIV^PKG","LR MI GUI REPORT RIGHT MARGIN",1,"Q")
"RTN","LR7OSMZ1",12,0)
 . I GIOM="" S GIOM=80
"RTN","LR7OSMZ1",13,0)
 ;
"RTN","LR7OSMZ1",14,0)
 D RPT
"RTN","LR7OSMZ1",15,0)
 K %,A8,A,AB,B,B1,B2,B3,C,IA,LR1PASS,LR2ORMOR,LRABCNT,LRACNT,LRAO,LRADM,LRADX,LRAFS,LRAMT,LRAX,LRBN,LRBRR,LRBUG,LRCOMTAB,LRCS,LRDCOM,LRDOC,LRDRTM1,LRDRTM2,LREF,LRFMT,LRGRM,LRIFN,LRINT,LRPATLOC,LRMYC,LRNS,LRNUM
"RTN","LR7OSMZ1",16,0)
 K LRORG,LRPAR,LRPC,LRPRE,LRPRINT,LRQU,LRRC,LRRES,LRSBC1,LRSBC2,LRSET,LRSIC1,LRSIC2,LRSPEC,LRSSD,LRST,LRTA,LRTB,LRTBA,LRTBC,LRTBS,LRTK,LRTS,LRTSTS,LRTUS,LRUS,LRWRD,N
"RTN","LR7OSMZ1",17,0)
 Q
"RTN","LR7OSMZ1",18,0)
 ;
"RTN","LR7OSMZ1",19,0)
 ;
"RTN","LR7OSMZ1",20,0)
RPT ;
"RTN","LR7OSMZ1",21,0)
 ;
"RTN","LR7OSMZ1",22,0)
 N J,LRTSTS,LRTS,LRTESTCOMPLE,LRX,LRY,LRDISP
"RTN","LR7OSMZ1",23,0)
 ;
"RTN","LR7OSMZ1",24,0)
 S:'$D(LRSB) LRSB=0
"RTN","LR7OSMZ1",25,0)
 S LRPRINT=$S($D(^LRO(68,LRAA,1,LRAD,1,LRAN,4)):"",1:1),LRPATLOC=$P(LRLLT,U,8)
"RTN","LR7OSMZ1",26,0)
 S LRCS=$S($D(^LAB(62,+$P(LRLLT,U,11),0)):$P(^(0),U),1:"")
"RTN","LR7OSMZ1",27,0)
 S LRTK=$P(LRLLT,U),LRRC=$P(LRLLT,U,10),LRST=$S(LRSPEC:$P(^LAB(61,LRSPEC,0),U),1:""),Y=LRTK
"RTN","LR7OSMZ1",28,0)
 D D^LRU
"RTN","LR7OSMZ1",29,0)
 S LRTK=Y,Y=LRRC
"RTN","LR7OSMZ1",30,0)
 D D^LRU
"RTN","LR7OSMZ1",31,0)
 S LRRC=Y,X=$P(LRLLT,U,7)
"RTN","LR7OSMZ1",32,0)
 D DOC^LRX
"RTN","LR7OSMZ1",33,0)
 ;
"RTN","LR7OSMZ1",34,0)
 K ^TMP("LR",$J,"T"),LRTSTS
"RTN","LR7OSMZ1",35,0)
 ;
"RTN","LR7OSMZ1",36,0)
 S (LRBRR,LRTESTCOMPLE)=0
"RTN","LR7OSMZ1",37,0)
 F  S LRBRR=+$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRBRR)) Q:LRBRR<1  D EN1
"RTN","LR7OSMZ1",38,0)
 I 'LRPRINT,LRONETST Q
"RTN","LR7OSMZ1",39,0)
 S LRPG=0
"RTN","LR7OSMZ1",40,0)
 D HDR^LR7OSMZU
"RTN","LR7OSMZ1",41,0)
 Q:LREND
"RTN","LR7OSMZ1",42,0)
 ;
"RTN","LR7OSMZ1",43,0)
 I $D(^TMP("LR",$J,"T")) D
"RTN","LR7OSMZ1",44,0)
 . D LINE^LR7OSUM4,LN
"RTN","LR7OSMZ1",45,0)
 . S ^TMP("LRC",$J,GCNT,0)=$$S^LR7OS(2,CCNT,"Test(s) ordered:")
"RTN","LR7OSMZ1",46,0)
 . S J=""
"RTN","LR7OSMZ1",47,0)
 . F  S J=$O(^TMP("LR",$J,"T",J)) Q:J=""  S X=^(J) D
"RTN","LR7OSMZ1",48,0)
 . . S LRX=$P(X,"^")
"RTN","LR7OSMZ1",49,0)
 . . I LRTESTCOMPLE S LRX=$$LJ^XLFSTR(LRX,30,".")
"RTN","LR7OSMZ1",50,0)
 . . S ^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(19,CCNT,LRX)
"RTN","LR7OSMZ1",51,0)
 . . S:'$D(^TMP("LRT",$J,$P(X,"^"))) ^($P(X,"^"))="MICROBIOLOGY"_"^"_GCNT
"RTN","LR7OSMZ1",52,0)
 . . I '$P(X,U,2) D LN S ^TMP("LRC",$J,GCNT,0)="" Q
"RTN","LR7OSMZ1",53,0)
 . . S Y=$P(X,U,2)
"RTN","LR7OSMZ1",54,0)
 . . ; LR*5.2*520
"RTN","LR7OSMZ1",55,0)
 . . D D^LRU S LRY=$S(LRDISP["Not Performed":"canceled: ",1:"completed: ")_Y
"RTN","LR7OSMZ1",56,0)
 . . I (19+$L(LRX)+$L(LRY))>GIOM D LN S ^TMP("LRC",$J,GCNT,0)=""
"RTN","LR7OSMZ1",57,0)
 . . S ^(0)=^TMP("LRC",$J,GCNT,0)_$$S^LR7OS(50,CCNT,LRY)
"RTN","LR7OSMZ1",58,0)
 . . D LN S ^TMP("LRC",$J,GCNT,0)=""
"RTN","LR7OSMZ1",59,0)
 ;
"RTN","LR7OSMZ1",60,0)
 K ^TMP("LR",$J,"T"),LRTSTS
"RTN","LR7OSMZ1",61,0)
 ;
"RTN","LR7OSMZ1",62,0)
 I $D(^LR(LRDFN,"MI",LRIDT,14)) D ANTI^LR7OSMZ2,LINE^LR7OSUM4
"RTN","LR7OSMZ1",63,0)
 I $D(^LR(LRDFN,"MI",LRIDT,1)) D BACT^LR7OSMZ2,REFS^LR7OSMZU,LINE^LR7OSUM4
"RTN","LR7OSMZ1",64,0)
 I $D(^LR(LRDFN,"MI",LRIDT,31)) D STER^LR7OSMZ3,LINE^LR7OSUM4
"RTN","LR7OSMZ1",65,0)
 I $D(^LR(LRDFN,"MI",LRIDT,5)) D PARA^LR7OSMZ3,REFS^LR7OSMZU,LINE^LR7OSUM4
"RTN","LR7OSMZ1",66,0)
 I $D(^LR(LRDFN,"MI",LRIDT,16)) D VIR^LR7OSMZ3,REFS^LR7OSMZU,LINE^LR7OSUM4
"RTN","LR7OSMZ1",67,0)
 I $D(^LR(LRDFN,"MI",LRIDT,11)) D TB^LR7OSMZ4,REFS^LR7OSMZU,LINE^LR7OSUM4
"RTN","LR7OSMZ1",68,0)
 I $D(^LR(LRDFN,"MI",LRIDT,8)) D FUNG^LR7OSMZ4,REFS^LR7OSMZU,LINE^LR7OSUM4
"RTN","LR7OSMZ1",69,0)
 ;
"RTN","LR7OSMZ1",70,0)
 ; List performing labs
"RTN","LR7OSMZ1",71,0)
 D PPL(LRDFN,"MI",LRIDT)
"RTN","LR7OSMZ1",72,0)
 ;
"RTN","LR7OSMZ1",73,0)
 Q
"RTN","LR7OSMZ1",74,0)
 ;
"RTN","LR7OSMZ1",75,0)
 ;
"RTN","LR7OSMZ1",76,0)
EN1 ;
"RTN","LR7OSMZ1",77,0)
 ; LR*5.2*520 Set disposition to LRDISP
"RTN","LR7OSMZ1",78,0)
 S LRTS=+^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRBRR,0),LRTS(1)=$P(^(0),U,5),LRDISP=$P(^(0),U,6)
"RTN","LR7OSMZ1",79,0)
 Q:'$L($P($G(^LAB(60,LRTS,0)),U,3))
"RTN","LR7OSMZ1",80,0)
 I '$D(LRLABKY),"BO"'[$P($G(^LAB(60,LRTS,0)),U,3) Q
"RTN","LR7OSMZ1",81,0)
 ;
"RTN","LR7OSMZ1",82,0)
 ; Set flag that at least one test is completed
"RTN","LR7OSMZ1",83,0)
 I LRTS(1) S LRTESTCOMPLE=1
"RTN","LR7OSMZ1",84,0)
 ;
"RTN","LR7OSMZ1",85,0)
 S:LRTS=LRONETST LRPRINT=1
"RTN","LR7OSMZ1",86,0)
 S LRTSTS=$S($D(^LAB(60,LRTS,0)):$P(^(0),U),1:"deleted test"),^TMP("LR",$J,"T",$S($D(^LAB(60,LRTS,.1)):$P(^(.1),U,6),1:"")_","_LRBRR)=LRTSTS_U_LRTS(1)
"RTN","LR7OSMZ1",87,0)
 Q
"RTN","LR7OSMZ1",88,0)
 ;
"RTN","LR7OSMZ1",89,0)
 ;
"RTN","LR7OSMZ1",90,0)
LN ;Increment counter
"RTN","LR7OSMZ1",91,0)
 S GCNT=GCNT+1,CCNT=1
"RTN","LR7OSMZ1",92,0)
 Q
"RTN","LR7OSMZ1",93,0)
 ;
"RTN","LR7OSMZ1",94,0)
 ;
"RTN","LR7OSMZ1",95,0)
PPL(LRDFN,LRSS,LRIDT) ; Print any performing laboratories
"RTN","LR7OSMZ1",96,0)
 ; Call with LRDFN = file #63 IEN
"RTN","LR7OSMZ1",97,0)
 ;            LRSS = File #63 subscript
"RTN","LR7OSMZ1",98,0)
 ;           LRIDT = file #63 specimen inverse date/time
"RTN","LR7OSMZ1",99,0)
 ;
"RTN","LR7OSMZ1",100,0)
 N LRPL,LRI,LRX
"RTN","LR7OSMZ1",101,0)
 ;
"RTN","LR7OSMZ1",102,0)
 D RETLST^LRRPL(.LRPL,LRDFN,LRSS,LRIDT,0)
"RTN","LR7OSMZ1",103,0)
 I $G(LRPL)<1 Q
"RTN","LR7OSMZ1",104,0)
 ;
"RTN","LR7OSMZ1",105,0)
 D LN S LRX="=--",^TMP("LRC",$J,GCNT,0)=$$REPEAT^XLFSTR(LRX,GIOM/$L(LRX))
"RTN","LR7OSMZ1",106,0)
 D LN S ^TMP("LRC",$J,GCNT,0)="Performing Laboratory:"
"RTN","LR7OSMZ1",107,0)
 ;
"RTN","LR7OSMZ1",108,0)
 S LRI=0
"RTN","LR7OSMZ1",109,0)
 F  S LRI=$O(LRPL(LRI)) Q:'LRI  D LN S ^TMP("LRC",$J,GCNT,0)=LRPL(LRI)
"RTN","LR7OSMZ1",110,0)
 D LN S ^TMP("LRC",$J,GCNT,0)=""
"RTN","LR7OSMZ1",111,0)
 ;
"RTN","LR7OSMZ1",112,0)
 Q
"RTN","LRMIPSZ1")
0^2^B50337425^B49126027
"RTN","LRMIPSZ1",1,0)
LRMIPSZ1 ;DALOI/STAFF - MICRO PATIENT REPORT ;09/02/10  22:20
"RTN","LRMIPSZ1",2,0)
 ;;5.2;LAB SERVICE;**283,350,520**;Sep 27, 1994;Build 3
"RTN","LRMIPSZ1",3,0)
 ;
"RTN","LRMIPSZ1",4,0)
 ;
"RTN","LRMIPSZ1",5,0)
DQ ;tasked from LRTASK from IMMEDIATE INTERIM REPORTING thru LRTP
"RTN","LRMIPSZ1",6,0)
 ;
"RTN","LRMIPSZ1",7,0)
 S LRPATLOC=$G(LRLLOC),LRIDT=$G(LRIDT,0),LRSS="MI",LRONETST="",LRONESPC="",LREND=0
"RTN","LRMIPSZ1",8,0)
 D EN^LRPARAM
"RTN","LRMIPSZ1",9,0)
 S LRLLT=^LR(LRDFN,"MI",LRIDT,0),LRACC=$P(LRLLT,U,6),LRAD=$E(LRLLT)_$P(LRACC," ",2)_"0000"
"RTN","LRMIPSZ1",10,0)
 S X=$P(LRACC," "),DIC=68,DIC(0)="M"
"RTN","LRMIPSZ1",11,0)
 I X'="" D ^DIC S LRAA=+Y,LRAN=+$P(LRACC," ",3)
"RTN","LRMIPSZ1",12,0)
 ;
"RTN","LRMIPSZ1",13,0)
 ; ^TMP("LRMI",$J,LRDFN,"MI",LRIDT) will already exist if this is a LEDI result being processed (rtn LRVRMI1)
"RTN","LRMIPSZ1",14,0)
 I '$D(^TMP("LRMI",$J,LRDFN,"MI",LRIDT)) D
"RTN","LRMIPSZ1",15,0)
 . M ^TMP("LRMI",$J,LRDFN,"MI",LRIDT)=^LR(LRDFN,"MI",LRIDT)
"RTN","LRMIPSZ1",16,0)
 . K ^TMP("LRMI",$J,LRDFN,"MI",LRIDT,32)
"RTN","LRMIPSZ1",17,0)
 ;
"RTN","LRMIPSZ1",18,0)
 S LRCMNT=$G(^TMP("LRMI",$J,LRDFN,"MI",LRIDT,99))
"RTN","LRMIPSZ1",19,0)
 S LRPG=0
"RTN","LRMIPSZ1",20,0)
 D EN
"RTN","LRMIPSZ1",21,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","LRMIPSZ1",22,0)
 Q
"RTN","LRMIPSZ1",23,0)
 ;
"RTN","LRMIPSZ1",24,0)
 ;
"RTN","LRMIPSZ1",25,0)
EN ;
"RTN","LRMIPSZ1",26,0)
 ; from LRMINEW2, LRMIPC, LRMIPLOG, LRMIPSZ, LRMIVER1
"RTN","LRMIPSZ1",27,0)
 ; ^TMP("LRMI",$J,LRDFN,"MI",LRIDT) will already exist if this is a LEDI result being processed (rtn LRVRMI1)
"RTN","LRMIPSZ1",28,0)
 I '$D(^TMP("LRMI",$J,LRDFN,"MI",LRIDT)) D  ;
"RTN","LRMIPSZ1",29,0)
 . M ^TMP("LRMI",$J,LRDFN,"MI",LRIDT)=^LR(LRDFN,"MI",LRIDT)
"RTN","LRMIPSZ1",30,0)
 . K ^TMP("LRMI",$J,LRDFN,"MI",LRIDT,32)
"RTN","LRMIPSZ1",31,0)
 ;
"RTN","LRMIPSZ1",32,0)
 S LRUID=$P($G(^LR(LRDFN,"MI",LRIDT,"ORU")),U)
"RTN","LRMIPSZ1",33,0)
 I '$D(LRONESPC) S LRONESPC="",DIC="^LAB(61,",DIC("A")="Select SPECIMEN/SOURCE: ANY//",DIC(0)="AEMOQ" D ^DIC S:Y>0 LRONESPC=+Y K DIC("A")
"RTN","LRMIPSZ1",34,0)
 I '$D(LRONETST) S LRONETST="",DIC="^LAB(60,",DIC(0)="AEOQ",DIC("S")="I $P(^(0),U,4)=""MI"")"_$S('$D(LRLABKY):",""BO""[$P(^(0),U,3)",1:""),D="E" D IX^DIC Q:Y<1  I Y>0 S LRONETST=+Y
"RTN","LRMIPSZ1",35,0)
 S LRSPEC=$P(LRLLT,U,5) I LRONESPC'="",LRSPEC'=LRONESPC Q
"RTN","LRMIPSZ1",36,0)
 D RPT
"RTN","LRMIPSZ1",37,0)
 I '$G(EAMODE) K ^TMP("LRMI",$J,LRDFN,"MI",LRIDT)
"RTN","LRMIPSZ1",38,0)
 K %,A8,A,AB,B,B1,B2,B3,C,IA,LR1PASS,LR2ORMOR,LRABCNT,LRACNT,LRADM,LRADX,LRAFS,LRAMT,LRAX,LRBN,LRBRR,LRBUG,LRCOMTAB,LRCS,LRDCOM,LRDOC,LRDRTM1,LRDRTM2,LREF,LRFLIP,LRFMT,LRGRM,LRHC,LRIFN,LRINT,LRPATLOC,LRMYC,LRNS,LRNUM
"RTN","LRMIPSZ1",39,0)
 K LRORG,LRPAR,LRPC,LRPRE,LRPRINT,LRQU,LRRC,LRRES,LRSBC1,LRSBC2,LRSET,LRSIC1,LRSIC2,LRSPEC,LRSSD,LRST,LRTA,LRTB,LRTBA,LRTBC,LRTBS,LRTK,LRTS,LRTSTS,LRTUS,LRUS,LRWRD,N
"RTN","LRMIPSZ1",40,0)
 Q
"RTN","LRMIPSZ1",41,0)
 ;
"RTN","LRMIPSZ1",42,0)
 ;
"RTN","LRMIPSZ1",43,0)
RPT ;
"RTN","LRMIPSZ1",44,0)
 ;
"RTN","LRMIPSZ1",45,0)
 N LRABORT,LRPGDATA,LRPRNTED,LRDISP
"RTN","LRMIPSZ1",46,0)
 ;
"RTN","LRMIPSZ1",47,0)
 ; If called by another process, i.e. interim reports, then don't reset current page number
"RTN","LRMIPSZ1",48,0)
 S LRPG=$G(LRPG,0)
"RTN","LRMIPSZ1",49,0)
 ;
"RTN","LRMIPSZ1",50,0)
 S LRPGDATA("HDR")="D HDR2^LRMIPSU(.LRPRNTED,.LRABORT,.LRPGDATA)"
"RTN","LRMIPSZ1",51,0)
 S LRPGDATA("BM")=8
"RTN","LRMIPSZ1",52,0)
 S LRPGDATA("FTR")="D FOOT2^LRMIPSU"
"RTN","LRMIPSZ1",53,0)
 ; Dont print the footer when console device
"RTN","LRMIPSZ1",54,0)
 I $E($G(IOST),1,2)="C-" D  ;
"RTN","LRMIPSZ1",55,0)
 . S LRPGDATA("BM")=0
"RTN","LRMIPSZ1",56,0)
 . S LRPGDATA("FTR")=""
"RTN","LRMIPSZ1",57,0)
 S LRPGDATA("PROMPTX")="S X=$$PROMPT^LRMIPSU()"
"RTN","LRMIPSZ1",58,0)
 S LRPGDATA("ERASE")=1
"RTN","LRMIPSZ1",59,0)
 S LRPGDATA("PGNUM")=0
"RTN","LRMIPSZ1",60,0)
 S LRABORT=0
"RTN","LRMIPSZ1",61,0)
 ;
"RTN","LRMIPSZ1",62,0)
 S:'$D(LRSB) LRSB=0
"RTN","LRMIPSZ1",63,0)
 S LRPRINT=$S($D(^LRO(68,LRAA,1,LRAD,1,LRAN,4)):"",1:1),LRHC=$S($E(IOST,1,2)'="C-":1,1:0),LRFLIP=$S(LRHC:11,1:6)
"RTN","LRMIPSZ1",64,0)
 ;
"RTN","LRMIPSZ1",65,0)
 K DIC
"RTN","LRMIPSZ1",66,0)
 D DT^LRX
"RTN","LRMIPSZ1",67,0)
 S LRDPF=$P(^LR(LRDFN,0),U,2),DFN=$P(^(0),U,3)
"RTN","LRMIPSZ1",68,0)
 D PT^LRX
"RTN","LRMIPSZ1",69,0)
 S:$G(VAIN(3)) DOB=$P(VADM(3),U) S LRPATLOC=$P(LRLLT,U,8)
"RTN","LRMIPSZ1",70,0)
 S (LRADM,LRADX)=""
"RTN","LRMIPSZ1",71,0)
 I +$G(LRDPF)=2,'$G(VAERR) S LRADM=$P(VAIN(7),U,2),LRADX=VAIN(9)
"RTN","LRMIPSZ1",72,0)
 S LRCS=$S($D(^LAB(62,+$P(LRLLT,U,11),0)):$P(^(0),U),1:"")
"RTN","LRMIPSZ1",73,0)
 S LRTK=$P(LRLLT,U),LRRC=$P(LRLLT,U,10),LRST=$S(LRSPEC:$P(^LAB(61,LRSPEC,0),U),1:"")
"RTN","LRMIPSZ1",74,0)
 S Y=LRTK D D^LRU S LRTK=Y
"RTN","LRMIPSZ1",75,0)
 S Y=LRRC D D^LRU S LRRC=Y
"RTN","LRMIPSZ1",76,0)
 S X=$P(LRLLT,U,7) D DOC^LRX
"RTN","LRMIPSZ1",77,0)
 ;
"RTN","LRMIPSZ1",78,0)
 K ^TMP("LR",$J,"T"),LRTSTS
"RTN","LRMIPSZ1",79,0)
 ;
"RTN","LRMIPSZ1",80,0)
 S (LRBRR,LRTESTCOMPLE)=0
"RTN","LRMIPSZ1",81,0)
 F  S LRBRR=+$O(^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRBRR)) Q:LRBRR<1  D EN1
"RTN","LRMIPSZ1",82,0)
 I 'LRPRINT,LRONETST Q
"RTN","LRMIPSZ1",83,0)
 ;
"RTN","LRMIPSZ1",84,0)
 ;
"RTN","LRMIPSZ1",85,0)
 D HDR2^LRMIPSU(.LRPRNTED,.LRABORT,.LRPGDATA)
"RTN","LRMIPSZ1",86,0)
 S LREND=LRABORT
"RTN","LRMIPSZ1",87,0)
 Q:LRABORT
"RTN","LRMIPSZ1",88,0)
 ; display audit log
"RTN","LRMIPSZ1",89,0)
 D BANNER^LRMIAU2(.LRABORT,.LRPGDATA)
"RTN","LRMIPSZ1",90,0)
 S LREND=LRABORT
"RTN","LRMIPSZ1",91,0)
 Q:LRABORT
"RTN","LRMIPSZ1",92,0)
 ;
"RTN","LRMIPSZ1",93,0)
 I $D(^TMP("LR",$J,"T")) D  Q:LRABORT
"RTN","LRMIPSZ1",94,0)
 . N J,LRX,LRY,X,Y
"RTN","LRMIPSZ1",95,0)
 . W !?2,"Test(s) ordered:"
"RTN","LRMIPSZ1",96,0)
 . S J=0
"RTN","LRMIPSZ1",97,0)
 . F  S J=$O(^TMP("LR",$J,"T",J)) Q:J=""  D  Q:LRABORT
"RTN","LRMIPSZ1",98,0)
 . . S X=^TMP("LR",$J,"T",J)
"RTN","LRMIPSZ1",99,0)
 . . S LRX=$P(X,"^")
"RTN","LRMIPSZ1",100,0)
 . . I LRTESTCOMPLE S LRX=$$LJ^XLFSTR(LRX,30,".")
"RTN","LRMIPSZ1",101,0)
 . . W ?19,LRX
"RTN","LRMIPSZ1",102,0)
 . . I '$P(X,U,2) W ! D NP Q
"RTN","LRMIPSZ1",103,0)
 . . S Y=$P(X,U,2)
"RTN","LRMIPSZ1",104,0)
  . . ; LR*5.2*520
"RTN","LRMIPSZ1",105,0)
 . . D D^LRU S LRY=$S(LRDISP["Not Performed":"canceled: ",1:"completed: ")_Y
"RTN","LRMIPSZ1",106,0)
 . . I (19+$L(LRX)+$L(LRY))>IOM W !
"RTN","LRMIPSZ1",107,0)
 . . W ?50,LRY,! D NP
"RTN","LRMIPSZ1",108,0)
 ;
"RTN","LRMIPSZ1",109,0)
 K ^TMP("LR",$J,"T"),LRTSTS W:LRHC !
"RTN","LRMIPSZ1",110,0)
 I $D(^TMP("LRMI",$J,LRDFN,"MI",LRIDT,14)) D  Q:LRABORT  ;
"RTN","LRMIPSZ1",111,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",112,0)
 . D ANTI^LRMIPSZ2
"RTN","LRMIPSZ1",113,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",114,0)
 ;
"RTN","LRMIPSZ1",115,0)
 I $D(^TMP("LRMI",$J,LRDFN,"MI",LRIDT,1)) D  Q:LRABORT  ;
"RTN","LRMIPSZ1",116,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",117,0)
 . D BACT^LRMIPSZ2 Q:LREND
"RTN","LRMIPSZ1",118,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",119,0)
 . D REFS^LRMIPSU Q:LREND
"RTN","LRMIPSZ1",120,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",121,0)
 ;
"RTN","LRMIPSZ1",122,0)
 I $D(^TMP("LRMI",$J,LRDFN,"MI",LRIDT,31)) D  Q:LRABORT  ;
"RTN","LRMIPSZ1",123,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",124,0)
 . D STER^LRMIPSZ3
"RTN","LRMIPSZ1",125,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",126,0)
 ;
"RTN","LRMIPSZ1",127,0)
 I $D(^TMP("LRMI",$J,LRDFN,"MI",LRIDT,5)) D  Q:LRABORT  Q:LREND  ;
"RTN","LRMIPSZ1",128,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",129,0)
 . D PARA^LRMIPSZ3
"RTN","LRMIPSZ1",130,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",131,0)
 . D REFS^LRMIPSU
"RTN","LRMIPSZ1",132,0)
 . Q:LREND
"RTN","LRMIPSZ1",133,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",134,0)
 ;
"RTN","LRMIPSZ1",135,0)
 I $D(^TMP("LRMI",$J,LRDFN,"MI",LRIDT,16)) D  Q:LREND  Q:LRABORT  ;
"RTN","LRMIPSZ1",136,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",137,0)
 . D VIR^LRMIPSZ3
"RTN","LRMIPSZ1",138,0)
 . D REFS^LRMIPSU Q:LREND  Q:LRABORT  ;
"RTN","LRMIPSZ1",139,0)
 ;
"RTN","LRMIPSZ1",140,0)
 I $D(^TMP("LRMI",$J,LRDFN,"MI",LRIDT,11)) D  Q:LREND  Q:LRABORT  ;
"RTN","LRMIPSZ1",141,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",142,0)
 . D TB^LRMIPSZ4
"RTN","LRMIPSZ1",143,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",144,0)
 . D REFS^LRMIPSU
"RTN","LRMIPSZ1",145,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",146,0)
 ;
"RTN","LRMIPSZ1",147,0)
 I $D(^TMP("LRMI",$J,LRDFN,"MI",LRIDT,8)) D  Q:LREND  Q:LRABORT  ;
"RTN","LRMIPSZ1",148,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",149,0)
 . D FUNG^LRMIPSZ4
"RTN","LRMIPSZ1",150,0)
 . D NP Q:LRABORT
"RTN","LRMIPSZ1",151,0)
 . D REFS^LRMIPSU
"RTN","LRMIPSZ1",152,0)
 . Q:LREND  Q:LRABORT
"RTN","LRMIPSZ1",153,0)
 ;
"RTN","LRMIPSZ1",154,0)
 Q:LRABORT
"RTN","LRMIPSZ1",155,0)
 ;
"RTN","LRMIPSZ1",156,0)
 ; Print any performing labs listing
"RTN","LRMIPSZ1",157,0)
 I $G(LRMODE)'="LDSI" D PPL
"RTN","LRMIPSZ1",158,0)
 ;
"RTN","LRMIPSZ1",159,0)
 ; Write last footer if needed
"RTN","LRMIPSZ1",160,0)
 I 'LRABORT,'$G(LRPGDATA("WFTR")) D  ;
"RTN","LRMIPSZ1",161,0)
 . I $G(LRPGDATA("FTR"))="" Q
"RTN","LRMIPSZ1",162,0)
 . I $E($G(IOST),1,2)'="C-" D  ;
"RTN","LRMIPSZ1",163,0)
 . . N I,BM
"RTN","LRMIPSZ1",164,0)
 . . S BM=$G(LRPGDATA("BM"))
"RTN","LRMIPSZ1",165,0)
 . . F I=$Y+1:1:($G(IOSL,60)-BM-1) W !
"RTN","LRMIPSZ1",166,0)
 . X LRPGDATA("FTR")
"RTN","LRMIPSZ1",167,0)
 ;
"RTN","LRMIPSZ1",168,0)
 I 'LRABORT D  ;
"RTN","LRMIPSZ1",169,0)
 . N PAD,STR,I,II
"RTN","LRMIPSZ1",170,0)
 . S X="  End of Report  ",PAD="+ ",STR=""
"RTN","LRMIPSZ1",171,0)
 . S I=IOM-($L(X)*3),I=I/4/$L(PAD)
"RTN","LRMIPSZ1",172,0)
 . F II=1:1:3 S STR=STR_$$REPEAT^XLFSTR(PAD,I)_X
"RTN","LRMIPSZ1",173,0)
 . S STR=STR_$$REPEAT^XLFSTR(PAD,I)
"RTN","LRMIPSZ1",174,0)
 . W !,$$CJ^XLFSTR(STR,IOM)
"RTN","LRMIPSZ1",175,0)
 . F I=$Y+1:1:($G(IOSL,60)-$G(LRPGDATA("BM"))-1) W !
"RTN","LRMIPSZ1",176,0)
 . S (LRABORT,LREND)=$$MORE^LRUTIL($$PROMPT^LRMIPSU(),0)
"RTN","LRMIPSZ1",177,0)
 . ; LRMLTRPT indicates multi report (set in SENDUP^LRMIPLOG)
"RTN","LRMIPSZ1",178,0)
 . I $G(LRMLTRPT),$E($G(IOST),1,2)="P-",$G(IOF)'="" W @IOF
"RTN","LRMIPSZ1",179,0)
 ;
"RTN","LRMIPSZ1",180,0)
 Q
"RTN","LRMIPSZ1",181,0)
 ;
"RTN","LRMIPSZ1",182,0)
 ;
"RTN","LRMIPSZ1",183,0)
EN1 ;
"RTN","LRMIPSZ1",184,0)
 ; LR*5.2*520 Set disposition to LRDISP
"RTN","LRMIPSZ1",185,0)
 S LRTS=+^LRO(68,LRAA,1,LRAD,1,LRAN,4,LRBRR,0),LRTS(1)=$P(^(0),U,5),LRDISP=$P(^(0),U,6)
"RTN","LRMIPSZ1",186,0)
 Q:'$L($P($G(^LAB(60,LRTS,0)),U,3))
"RTN","LRMIPSZ1",187,0)
 I '$D(LRLABKY),"BO"'[$P($G(^LAB(60,LRTS,0)),U,3) Q
"RTN","LRMIPSZ1",188,0)
 ;
"RTN","LRMIPSZ1",189,0)
 ; Set flag that at least one test is completed
"RTN","LRMIPSZ1",190,0)
 I LRTS(1) S LRTESTCOMPLE=1
"RTN","LRMIPSZ1",191,0)
 ;
"RTN","LRMIPSZ1",192,0)
 S:LRTS=LRONETST LRPRINT=1
"RTN","LRMIPSZ1",193,0)
 S LRTSTS=$S($D(^LAB(60,LRTS,0)):$P(^(0),U),1:"deleted test"),^TMP("LR",$J,"T",$S($D(^LAB(60,LRTS,.1)):$P(^(.1),U,6),1:"")_","_LRBRR)=LRTSTS_U_LRTS(1)
"RTN","LRMIPSZ1",194,0)
 Q
"RTN","LRMIPSZ1",195,0)
 ;
"RTN","LRMIPSZ1",196,0)
 ;
"RTN","LRMIPSZ1",197,0)
NP ;
"RTN","LRMIPSZ1",198,0)
 ; Convenience method
"RTN","LRMIPSZ1",199,0)
 ; Some methods in these report routines may be called by a different parent so need to handle this if needed.
"RTN","LRMIPSZ1",200,0)
 I '$D(LRABORT) S LRABORT=0
"RTN","LRMIPSZ1",201,0)
 Q:'$D(LRPGDATA)
"RTN","LRMIPSZ1",202,0)
 D NP^LRUTIL(.LRABORT,.LRPGDATA)
"RTN","LRMIPSZ1",203,0)
 S LRPG=$G(LRPGDATA("PGNUM"),1)
"RTN","LRMIPSZ1",204,0)
 ;
"RTN","LRMIPSZ1",205,0)
 ; backward compatability (for SENDUP^LRMIPLOG)
"RTN","LRMIPSZ1",206,0)
 S LREND=LRABORT
"RTN","LRMIPSZ1",207,0)
 Q
"RTN","LRMIPSZ1",208,0)
 ;
"RTN","LRMIPSZ1",209,0)
 ;
"RTN","LRMIPSZ1",210,0)
PPL ; Print any performing laboratories
"RTN","LRMIPSZ1",211,0)
 ;
"RTN","LRMIPSZ1",212,0)
 N LRPL,LRI,LRX,LRY
"RTN","LRMIPSZ1",213,0)
 ;
"RTN","LRMIPSZ1",214,0)
 D RETLST^LRRPL(.LRPL,LRDFN,"MI",LRIDT,0)
"RTN","LRMIPSZ1",215,0)
 I $G(LRPL)<1 Q
"RTN","LRMIPSZ1",216,0)
 ;
"RTN","LRMIPSZ1",217,0)
 ; Start new page if space on existing page too small to display a significant portion of labs
"RTN","LRMIPSZ1",218,0)
 S LRY=IOSL-$Y S:LRY<1 LRY=1
"RTN","LRMIPSZ1",219,0)
 I (LRPL/LRY)>1 D
"RTN","LRMIPSZ1",220,0)
 . F LRI=$Y+1:1:($G(IOSL,60)-$G(LRPGDATA("BM"))-1) W !
"RTN","LRMIPSZ1",221,0)
 . D NP
"RTN","LRMIPSZ1",222,0)
 E  S LRX="=--" W !!,$$REPEAT^XLFSTR(LRX,IOM/$L(LRX))
"RTN","LRMIPSZ1",223,0)
 ;
"RTN","LRMIPSZ1",224,0)
 W !,"Performing Laboratory:",!
"RTN","LRMIPSZ1",225,0)
 S LRI=0
"RTN","LRMIPSZ1",226,0)
 F  S LRI=$O(LRPL(LRI)) Q:'LRI  D  Q:LRABORT
"RTN","LRMIPSZ1",227,0)
 . W !,LRPL(LRI)
"RTN","LRMIPSZ1",228,0)
 . D NP
"RTN","LRMIPSZ1",229,0)
 . I 'LRABORT,LRPGDATA("NP") W !,"Performing Laboratory (cont'd):",!
"RTN","LRMIPSZ1",230,0)
 ;
"RTN","LRMIPSZ1",231,0)
 I 'LRABORT W !
"RTN","LRMIPSZ1",232,0)
 ;
"RTN","LRMIPSZ1",233,0)
 Q
"VER")
8.0^22.2
"BLD",11421,6)
^423
**END**
**END**

