Released LR*5.2*491 SEQ #394
Extracted from mail message
**KIDS**:LR*5.2*491^

**INSTALL NAME**
LR*5.2*491
"BLD",10576,0)
LR*5.2*491^LAB SERVICE^0^3170527^y
"BLD",10576,1,0)
^^5^5^3170526^
"BLD",10576,1,1,0)
This patch addresses two (2) VistA Laboratory issues related to the 
"BLD",10576,1,2,0)
deletion of Howdy duplicate test orders:
"BLD",10576,1,3,0)
 
"BLD",10576,1,4,0)
1.  Duplicate test is deleted in VistA but active in CPRS
"BLD",10576,1,5,0)
2.  Error occurs when orders have more than one duplicate test
"BLD",10576,4,0)
^9.64PA^^
"BLD",10576,6.3)
2
"BLD",10576,"ABPKG")
n
"BLD",10576,"KRN",0)
^9.67PA^779.2^20
"BLD",10576,"KRN",.4,0)
.4
"BLD",10576,"KRN",.401,0)
.401
"BLD",10576,"KRN",.402,0)
.402
"BLD",10576,"KRN",.403,0)
.403
"BLD",10576,"KRN",.5,0)
.5
"BLD",10576,"KRN",.84,0)
.84
"BLD",10576,"KRN",3.6,0)
3.6
"BLD",10576,"KRN",3.8,0)
3.8
"BLD",10576,"KRN",9.2,0)
9.2
"BLD",10576,"KRN",9.8,0)
9.8
"BLD",10576,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",10576,"KRN",9.8,"NM",1,0)
LRHYB^^0^B41457137
"BLD",10576,"KRN",9.8,"NM",2,0)
LRHYPH2^^0^B12061848
"BLD",10576,"KRN",9.8,"NM","B","LRHYB",1)

"BLD",10576,"KRN",9.8,"NM","B","LRHYPH2",2)

"BLD",10576,"KRN",19,0)
19
"BLD",10576,"KRN",19.1,0)
19.1
"BLD",10576,"KRN",101,0)
101
"BLD",10576,"KRN",409.61,0)
409.61
"BLD",10576,"KRN",771,0)
771
"BLD",10576,"KRN",779.2,0)
779.2
"BLD",10576,"KRN",870,0)
870
"BLD",10576,"KRN",8989.51,0)
8989.51
"BLD",10576,"KRN",8989.52,0)
8989.52
"BLD",10576,"KRN",8994,0)
8994
"BLD",10576,"KRN","B",.4,.4)

"BLD",10576,"KRN","B",.401,.401)

"BLD",10576,"KRN","B",.402,.402)

"BLD",10576,"KRN","B",.403,.403)

"BLD",10576,"KRN","B",.5,.5)

"BLD",10576,"KRN","B",.84,.84)

"BLD",10576,"KRN","B",3.6,3.6)

"BLD",10576,"KRN","B",3.8,3.8)

"BLD",10576,"KRN","B",9.2,9.2)

"BLD",10576,"KRN","B",9.8,9.8)

"BLD",10576,"KRN","B",19,19)

"BLD",10576,"KRN","B",19.1,19.1)

"BLD",10576,"KRN","B",101,101)

"BLD",10576,"KRN","B",409.61,409.61)

"BLD",10576,"KRN","B",771,771)

"BLD",10576,"KRN","B",779.2,779.2)

"BLD",10576,"KRN","B",870,870)

"BLD",10576,"KRN","B",8989.51,8989.51)

"BLD",10576,"KRN","B",8989.52,8989.52)

"BLD",10576,"KRN","B",8994,8994)

"BLD",10576,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",10576,"QUES",0)
^9.62^^
"BLD",10576,"REQB",0)
^9.611^2^2
"BLD",10576,"REQB",1,0)
LR*5.2*450^1
"BLD",10576,"REQB",2,0)
LR*5.2*467^1
"BLD",10576,"REQB","B","LR*5.2*450",1)

"BLD",10576,"REQB","B","LR*5.2*467",2)

"MBREQ")
0
"PKG",26,-1)
1^1
"PKG",26,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",26,20,0)
^9.402P^1^1
"PKG",26,20,1,0)
2^^LRXDRPT
"PKG",26,20,1,1)

"PKG",26,20,"B",2,1)

"PKG",26,22,0)
^9.49I^1^1
"PKG",26,22,1,0)
5.2^2940927^2981028^66481
"PKG",26,22,1,"PAH",1,0)
491^3170527
"PKG",26,22,1,"PAH",1,1,0)
^^5^5^3170527
"PKG",26,22,1,"PAH",1,1,1,0)
This patch addresses two (2) VistA Laboratory issues related to the 
"PKG",26,22,1,"PAH",1,1,2,0)
deletion of Howdy duplicate test orders:
"PKG",26,22,1,"PAH",1,1,3,0)
 
"PKG",26,22,1,"PAH",1,1,4,0)
1.  Duplicate test is deleted in VistA but active in CPRS
"PKG",26,22,1,"PAH",1,1,5,0)
2.  Error occurs when orders have more than one duplicate test
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","LRHYB")
0^1^B41457137^B41352929
"RTN","LRHYB",1,0)
LRHYB ;DALOI/HOAK - HOWDY B DRIVER ;9/16/2000
"RTN","LRHYB",2,0)
 ;;5.2;LAB SERVICE;**405,417,446,457,467,491**;Sep 27, 1994;Build 2
"RTN","LRHYB",3,0)
 ;
"RTN","LRHYB",4,0)
TEST ;
"RTN","LRHYB",5,0)
 S DIC=2 S DIC(0)="AEMQZ" D ^DIC
"RTN","LRHYB",6,0)
 Q:Y=-1
"RTN","LRHYB",7,0)
 S LRDFN=$G(^DPT(+Y,"LR"))
"RTN","LRHYB",8,0)
 ;
"RTN","LRHYB",9,0)
 ;
"RTN","LRHYB",10,0)
 ;
"RTN","LRHYB",11,0)
ORDCHK ; Here is where the search for an order number starts
"RTN","LRHYB",12,0)
 K LRHYT654
"RTN","LRHYB",13,0)
 ; The Howdy site file will help determine which orders the site
"RTN","LRHYB",14,0)
 ; will accept. Once an order has been selected it is handed off
"RTN","LRHYB",15,0)
 ; to LRORDST to start the accessioning process.
"RTN","LRHYB",16,0)
 ;
"RTN","LRHYB",17,0)
 K LRWCZZZ,LRDTF
"RTN","LRHYB",18,0)
 K LRHYCS33
"RTN","LRHYB",19,0)
 K ^TMP("LRHYDY",$J,"KILL")
"RTN","LRHYB",20,0)
 ;
"RTN","LRHYB",21,0)
 ;
"RTN","LRHYB",22,0)
 K ^TMP("LRHYDY",$J,"MULTD")
"RTN","LRHYB",23,0)
 K ^TMP("LRHYDY",$J,"DUPTEST")
"RTN","LRHYB",24,0)
 K LRHYCS
"RTN","LRHYB",25,0)
 K ^TMP("LRHYDY",$J,"MT")
"RTN","LRHYB",26,0)
 S LRHOWDY=1
"RTN","LRHYB",27,0)
 S LREND=0
"RTN","LRHYB",28,0)
 S LRORD=""
"RTN","LRHYB",29,0)
 Q:'LRDFN
"RTN","LRHYB",30,0)
 ;
"RTN","LRHYB",31,0)
 K ^TMP("LRHYDY",$J,"LRSN"),LRNPZZX
"RTN","LRHYB",32,0)
 S LRHYOK=0
"RTN","LRHYB",33,0)
 ;
"RTN","LRHYB",34,0)
 ;  18 days ahead
"RTN","LRHYB",35,0)
 ;  20 days back
"RTN","LRHYB",36,0)
 ;
"RTN","LRHYB",37,0)
 S X2=0 K LRNPZZX
"RTN","LRHYB",38,0)
 S LRAHEAD=$G(^LRHY(69.86,LRHYSITE,18))
"RTN","LRHYB",39,0)
 S LRPAST=$G(^LRHY(69.86,LRHYSITE,20))
"RTN","LRHYB",40,0)
 K LRWCZZZ,LREXORD
"RTN","LRHYB",41,0)
 S LRLOCS=0 ; flag for non-EXLOC and EXLOC on same specimen number
"RTN","LRHYB",42,0)
 F LRI=-LRPAST:1:LRAHEAD D  Q:$G(LRLOCS)  ;Search window set by site file.
"RTN","LRHYB",43,0)
 .  S X1=DT S X2=LRI D C^%DTC S LR3DTN=X
"RTN","LRHYB",44,0)
 .  I $D(^LRO(69,LR3DTN,1,"AA",LRDFN)) S LRHYOK=1 D
"RTN","LRHYB",45,0)
 ..  S LR3SN=0
"RTN","LRHYB",46,0)
 ..  F  S LR3SN=$O(^LRO(69,LR3DTN,1,"AA",LRDFN,LR3SN)) Q:+LR3SN'>0  D  Q:$G(LRLOCS)
"RTN","LRHYB",47,0)
 ...  Q:$P($G(^LRO(69,LR3DTN,1,LR3SN,1)),U,4)="C"  ;collected
"RTN","LRHYB",48,0)
 ...  K LRWCZZZ
"RTN","LRHYB",49,0)
 ...  ;
"RTN","LRHYB",50,0)
 ...  K LRCOL99 S LRCOL99=$P(^LRO(69,LR3DTN,1,LR3SN,0),U,3)
"RTN","LRHYB",51,0)
 ...  K LRCSTAT S LRCSTAT=$P(^LRO(69,LR3DTN,1,LR3SN,0),U,4)
"RTN","LRHYB",52,0)
 ...  D CSTATUS^LRHYA Q:LRHYHOK  ;Check collection status
"RTN","LRHYB",53,0)
 ...  ;
"RTN","LRHYB",54,0)
 ...  D OLT^LRHYA  ;print order label tests
"RTN","LRHYB",55,0)
 ...  Q:LRHYHOK
"RTN","LRHYB",56,0)
 ...  ;
"RTN","LRHYB",57,0)
 ...  ;
"RTN","LRHYB",58,0)
 ...  K LRNOTST
"RTN","LRHYB",59,0)
 ...  S LRNODUP=0 D LTE^LRHYA Q:LRHYHOK  ;check for excluded lab tests
"RTN","LRHYB",60,0)
 ...  ;
"RTN","LRHYB",61,0)
 ...  S LRORD=^LRO(69,LR3DTN,1,LR3SN,.1)
"RTN","LRHYB",62,0)
 ...  S LRLLOC66=$P(^LRO(69,LR3DTN,1,LR3SN,0),U,9)
"RTN","LRHYB",63,0)
 ...  D EXLOC^LRHYA Q:LRHYHOK  ;check for locations to exclude
"RTN","LRHYB",64,0)
 ...  ;
"RTN","LRHYB",65,0)
 ...  S LRLLOC=$G(LRLLOC66)
"RTN","LRHYB",66,0)
 ...  S LRORD24=0
"RTN","LRHYB",67,0)
 ...  D OLT^LRHYA Q:LRHYHOK  ;print order label tests
"RTN","LRHYB",68,0)
 ...  ;
"RTN","LRHYB",69,0)
 ...  D URG^LRHYA Q:LRHYHOK  ;;  CHECK URGENCY
"RTN","LRHYB",70,0)
 ...  K LRCOL99 S LRCOL99=$P(^LRO(69,LR3DTN,1,LR3SN,0),U,3)
"RTN","LRHYB",71,0)
 ...  D CSE^LRHYA Q:LRHYHOK  ;check for excluded collection samples
"RTN","LRHYB",72,0)
 ...  ;
"RTN","LRHYB",73,0)
 ...  I $O(^TMP("LRHYDY",$J,"EXLOC",LRORD,0))=$G(LRLLOC66) I $O(^LRO(69,"C",LRORD,0))'=DT QUIT
"RTN","LRHYB",74,0)
 ...  ;  CHECK URGENCY
"RTN","LRHYB",75,0)
 ...  S LRTST6=0 ; micro test
"RTN","LRHYB",76,0)
 ...  F  S LRTST6=$O(^LRO(69,LR3DTN,1,LR3SN,2,"B",LRTST6)) Q:+LRTST6'>0  D
"RTN","LRHYB",77,0)
 ....  S LRTSTZ99(LRTST6)=""
"RTN","LRHYB",78,0)
 ....  I LRTST6 S LRSUB1=$P(^LAB(60,LRTST6,0),U,4) ; subscript
"RTN","LRHYB",79,0)
 ....  Q:$D(LRNPZZX(^LRO(69,LR3DTN,1,LR3SN,.1),LR3SN,LRTST6))
"RTN","LRHYB",80,0)
 ....  S LRORD=$G(^LRO(69,LR3DTN,1,LR3SN,.1))
"RTN","LRHYB",81,0)
 ....  I $G(LRORD) I $D(^TMP("LRHYDY",$J,"STATUS",LRORD)) QUIT
"RTN","LRHYB",82,0)
 ....  I $D(LRNOTST) I $D(LRNOTST(LRTST6)) K LRORD QUIT
"RTN","LRHYB",83,0)
 ....  S ^TMP("LRHYDY",$J,"LRSN",LR3DTN,^LRO(69,LR3DTN,1,LR3SN,.1))=""
"RTN","LRHYB",84,0)
 ....  S LRDTX=""
"RTN","LRHYB",85,0)
 ....  S LRDTX=$O(^LRO(69,"C",^LRO(69,LR3DTN,1,LR3SN,.1),0))
"RTN","LRHYB",86,0)
 ....  I $D(^LRHY(69.86,LRHYSITE,16,"B",LRLLOC66)),LR3DTN=DT,$G(LRDTX) S ^TMP("LRHYDY",$J,"MT",LRDTX)=""
"RTN","LRHYB",87,0)
 ....  I '$D(^LRHY(69.86,LRHYSITE,16,"B",LRLLOC66)) I $G(LRDTX) S ^TMP("LRHYDY",$J,"MT",LRDTX)=""
"RTN","LRHYB",88,0)
 ;
"RTN","LRHYB",89,0)
 ;
"RTN","LRHYB",90,0)
 K LRMULT
"RTN","LRHYB",91,0)
 I $G(LRWCMULT) W !!!!,"Multple Orders Present" S LRMULT=1 D LOG1^LRHY0 K LRWCMULT QUIT
"RTN","LRHYB",92,0)
 ; per Libba 1/14/2002
"RTN","LRHYB",93,0)
 I $D(^TMP("LRHYDY",$J,"LRSN",DT)) S LR3DTN=DT ; I prefer today's orders but...
"RTN","LRHYB",94,0)
 E  S LR3DTN=$O(^TMP("LRHYDY",$J,"LRSN",0)) ; I'll take whatever ya got
"RTN","LRHYB",95,0)
 I 'LR3DTN K LRORD QUIT
"RTN","LRHYB",96,0)
 ;
"RTN","LRHYB",97,0)
 I '$D(^LRHY(69.86,LRHYSITE,16,"B",LRLLOC66)) I $O(^TMP("LRHYDY",$J,"LRSN",LR3DTN)) W !,"MULTIPLE DAYS WITH ORDERS" S LRMULT=1 D LOG1^LRHY0 QUIT
"RTN","LRHYB",98,0)
 ;
"RTN","LRHYB",99,0)
 S LRTIC=0
"RTN","LRHYB",100,0)
 S LRMULT=0
"RTN","LRHYB",101,0)
 ;
"RTN","LRHYB",102,0)
 F  S LRTIC=$O(^TMP("LRHYDY",$J,"LRSN",LRTIC)) Q:+LRTIC'>0  S LRMULT=LRMULT+1
"RTN","LRHYB",103,0)
 I '$D(^LRHY(69.86,LRHYSITE,16,"B",LRLLOC66)) I LRMULT>1 W !,"MULTIPLE DAYS WITH ORDERS" S LRMULT=0 D LOG1^LRHY0 QUIT
"RTN","LRHYB",104,0)
 ;MODIFIED BY HOAK to flag when wc and sp are on same visit
"RTN","LRHYB",105,0)
 ;
"RTN","LRHYB",106,0)
 ;
"RTN","LRHYB",107,0)
MOVE ;
"RTN","LRHYB",108,0)
 I $D(LRNOTST) I $G(LRHYT654) I $D(LRNOTST(LRHYT654)) K LRORD QUIT
"RTN","LRHYB",109,0)
 I $G(LRORD),$D(LREXORD(LRORD)) K LRORD QUIT
"RTN","LRHYB",110,0)
 S LRHY3SN3=0
"RTN","LRHYB",111,0)
 S LRHY3DT3=0
"RTN","LRHYB",112,0)
 I $G(LRORD),$D(^TMP("LRHYDY",$J,"URG",LRORD)) K LRORD QUIT
"RTN","LRHYB",113,0)
 I $D(^LRHY(69.86,LRHYSITE,30,"B",LRURGZ19)) K LRORD QUIT
"RTN","LRHYB",114,0)
 S LRTIC=0
"RTN","LRHYB",115,0)
 S LRMULT=0
"RTN","LRHYB",116,0)
 F  S LRTIC=$O(^TMP("LRHYDY",$J,"MT",LRTIC)) Q:+LRTIC'>0  S LRMULT=LRMULT+1
"RTN","LRHYB",117,0)
 S LR3MULT=LRMULT
"RTN","LRHYB",118,0)
 I LRMULT>1 W !,"MULTIPLE DAYS WITH ORDERS" S LRORD=0 QUIT
"RTN","LRHYB",119,0)
 E  S LRMULT=0
"RTN","LRHYB",120,0)
 ; may be accessioned.
"RTN","LRHYB",121,0)
 ; Setting up task to continue based on the specimen.
"RTN","LRHYB",122,0)
 K LR3ZTST
"RTN","LRHYB",123,0)
MOVE1 ;
"RTN","LRHYB",124,0)
 S LRORD=0
"RTN","LRHYB",125,0)
 F  S LRORD=$O(^TMP("LRHYDY",$J,"LRSN",LR3DTN,LRORD)) Q:+LRORD'>0  D
"RTN","LRHYB",126,0)
 .  S:'$G(LR3ORD) LR3ORD=LRORD
"RTN","LRHYB",127,0)
 .  I $D(^TMP("LRHYDY",$J,"URG",LRORD)) QUIT
"RTN","LRHYB",128,0)
 .  S LRHYORDZ=LRORD
"RTN","LRHYB",129,0)
 .  ;
"RTN","LRHYB",130,0)
 .  S ZTSAVE("^TMP(""LRHYDY"",$J,")=""
"RTN","LRHYB",131,0)
 .  S ZTRTN="PAST^LRHYPH0",ZTSAVE("L*")="",ZTDTH=$H,ZTDESC="HOWDY"
"RTN","LRHYB",132,0)
 .  S ZTIO="NULL"
"RTN","LRHYB",133,0)
 .  S ZTSAVE("L*")=""
"RTN","LRHYB",134,0)
 .  S:$D(ZTQUEUED) ZTREQ="@" D ^%ZTLOAD
"RTN","LRHYB",135,0)
 .  S LRGOTIT=1
"RTN","LRHYB",136,0)
 .  S LRORD=LRHYORDZ
"RTN","LRHYB",137,0)
 .  K LRSTOPZ(LRORD)
"RTN","LRHYB",138,0)
 K ^TMP("LRHYDY",$J,"MULTD")
"RTN","LRHYB",139,0)
 S LRORD=$G(LR3ORD) K LR3ORD
"RTN","LRHYB",140,0)
 K LRHOWDY,LR3SN24,LR3DTN24,LR3ZTST,LROLT1
"RTN","LRHYB",141,0)
 I $G(LRORD) I $D(LRSTOPZ(LRORD)) K LRORD,LRSTOPZ QUIT
"RTN","LRHYB",142,0)
 ;
"RTN","LRHYB",143,0)
 QUIT
"RTN","LRHYB",144,0)
 ;
"RTN","LRHYB",145,0)
MMM ;
"RTN","LRHYB",146,0)
 N LRI S LRI=0
"RTN","LRHYB",147,0)
 N LR3DTN,LR3SN,LRIENZZ,LRTSTX
"RTN","LRHYB",148,0)
 K LRHYMORD
"RTN","LRHYB",149,0)
 K LRHYMULT
"RTN","LRHYB",150,0)
 F LRI=-LRPAST:1:LRAHEAD D
"RTN","LRHYB",151,0)
 .  S X1=DT S X2=LRI D C^%DTC S LR3DTN=X
"RTN","LRHYB",152,0)
 .  ;
"RTN","LRHYB",153,0)
 .  I $D(^LRO(69,LR3DTN,1,"AA",LRDFN)) D
"RTN","LRHYB",154,0)
 ..  S LR3SN=0
"RTN","LRHYB",155,0)
 ..  F  S LR3SN=$O(^LRO(69,LR3DTN,1,"AA",LRDFN,LR3SN)) Q:+LR3SN'>0  D
"RTN","LRHYB",156,0)
 ...  ;
"RTN","LRHYB",157,0)
 ...  Q:$P($G(^LRO(69,LR3DTN,1,LR3SN,1)),U,4)="C"  ;collected
"RTN","LRHYB",158,0)
 ...  S LRTSTX=0
"RTN","LRHYB",159,0)
 ...  F  S LRTSTX=$O(^LRO(69,LR3DTN,1,LR3SN,2,"B",LRTSTX)) Q:+LRTSTX'>0  D
"RTN","LRHYB",160,0)
 ....  S LRIENZZ=$O(^LRO(69,LR3DTN,1,LR3SN,2,"B",LRTSTX,0))
"RTN","LRHYB",161,0)
 ....  ;
"RTN","LRHYB",162,0)
 ....  Q:$G(^LRO(69,LR3DTN,1,LR3SN,2,LRIENZZ,1.1,1,0))'=""
"RTN","LRHYB",163,0)
 ....  K LRCOL99 S LRCOL99=$P(^LRO(69,LR3DTN,1,LR3SN,0),U,3)
"RTN","LRHYB",164,0)
 ....  S LRHYHOK=0 D CSE^LRHYA Q:LRHYHOK
"RTN","LRHYB",165,0)
 ....  S LRCSTAT=$P(^LRO(69,LR3DTN,1,LR3SN,0),U,4)
"RTN","LRHYB",166,0)
 ....  S LRHYHOK=0 D CSTATUS^LRHYA Q:LRHYHOK
"RTN","LRHYB",167,0)
 ....  S LRLLOC66=$P(^LRO(69,LR3DTN,1,LR3SN,0),U,9)
"RTN","LRHYB",168,0)
 ....  S LRHYHOK=0 D EXLOC^LRHYA Q:LRHYHOK
"RTN","LRHYB",169,0)
 ....  S LRHYMULT(LR3DTN,LR3SN,LRIENZZ)=LRTSTX
"RTN","LRHYB",170,0)
 N CNT
"RTN","LRHYB",171,0)
 S CNT=0
"RTN","LRHYB",172,0)
 S LR3DTN=0
"RTN","LRHYB",173,0)
 F  S LR3DTN=$O(LRHYMULT(LR3DTN)) Q:+LR3DTN'>0  S CNT=CNT+1
"RTN","LRHYB",174,0)
 I CNT>1 S LRHYMORD=1
"RTN","LRHYPH2")
0^2^B12061848^B12456317
"RTN","LRHYPH2",1,0)
LRHYPH2 ;DALOI/HOAK - HOWDY ORDER NUMBER SELECTION ;12/10/10 6:00pm
"RTN","LRHYPH2",2,0)
 ;;5.2;LAB SERVICE;**405,444,450,491**;Sep 27, 1994;Build 2
"RTN","LRHYPH2",3,0)
 ;
"RTN","LRHYPH2",4,0)
 ; Reference to ^ORCSAVE2 supported by DBIA #2747.
"RTN","LRHYPH2",5,0)
 ;
"RTN","LRHYPH2",6,0)
 ;
"RTN","LRHYPH2",7,0)
Q15 ;
"RTN","LRHYPH2",8,0)
 ;
"RTN","LRHYPH2",9,0)
 I $G(LRBUTZ) K LRBUTZ G BUT
"RTN","LRHYPH2",10,0)
 Q:$D(LRSTOPZ(LRORD))
"RTN","LRHYPH2",11,0)
 ;
"RTN","LRHYPH2",12,0)
BUT ;
"RTN","LRHYPH2",13,0)
 I $D(^TMP("LRHYDY",$J,"KILL",LRODT,LRSN,1)) S LRSTOPZ(LRORD)="" D LOG^LRHY0 QUIT
"RTN","LRHYPH2",14,0)
 ;
"RTN","LRHYPH2",15,0)
 Q:'$D(^LRO(69,LRODT,1,LRSN,0))
"RTN","LRHYPH2",16,0)
 I M9>1 D LRSPEC^LROE1 S S1=$S($D(^LAB(61,+LRSPEC,0)):$P(^(0),U),1:"") D
"RTN","LRHYPH2",17,0)
 .  S S2=$P(^LAB(62,LRSAMP,0),U),S4=$P(^(0),U,3)
"RTN","LRHYPH2",18,0)
 .  S S3=S1_$S(S1'=S2:"  "_S2,1:"")
"RTN","LRHYPH2",19,0)
 .  K S1,S2,S3,S4 S %=2
"RTN","LRHYPH2",20,0)
 S DA=DT,LRDFN=+^LRO(69,LRODT,1,LRSN,0),LRDPF=+$P(^LR(LRDFN,0),U,2)
"RTN","LRHYPH2",21,0)
 ; MODIFIED FOR VERSION 8 10/31
"RTN","LRHYPH2",22,0)
 I $D(LRSND),$P(^LRO(69,LRODT,1,LRSN,0),U,4)="LC",$D(^(1)) S LRLLOC=$P(^(0),U,7),LROLLOC=$P(^(0),U,9),LRNT=$S($D(LRNT):LRNT,$D(LRTIM):LRTIM,$D(LRCDT):+LRCDT,1:"") D P15^LRPHITEM G PH
"RTN","LRHYPH2",23,0)
 I $D(LRSND) N LRHYCOMB S LRHYCOMB=$P($G(^LRO(69,LRODT,1,LRSN,1)),U,7) D
"RTN","LRHYPH2",24,0)
 .  S DIE="^LRO(69,"_LRODT_",1,",DA(1)=LRODT,DA=LRSN,DR="10////"_LRTIM D ^DIE
"RTN","LRHYPH2",25,0)
 .  S DIE="^LRO(69,"_LRODT_",1,",DA(1)=LRODT,DA=LRSN,DR="12////"_DUZ D ^DIE
"RTN","LRHYPH2",26,0)
 .  S DIE="^LRO(69,"_LRODT_",1,",DA(1)=LRODT,DA=LRSN,DR="13////"_LRSTATUS D ^DIE
"RTN","LRHYPH2",27,0)
 .  S DIE="^LRO(69,"_LRODT_",1,",DA(1)=LRODT,DA=LRSN,DR="25////"_DUZ(2) D ^DIE
"RTN","LRHYPH2",28,0)
PH G Q16:LRORD D ORDER^LROW2 G Q16A
"RTN","LRHYPH2",29,0)
Q16 S J=0 D CHECK^LROW2 I J D BAD^LROW2
"RTN","LRHYPH2",30,0)
Q16A I $D(LRLONG),$D(LRSND) S LRSN=LRSND,^TMP("LRHYDY",$J,"LROE",$J,"LRORD")=LRORD_U_LRODT_U_LRTIM_U_PNM_U_SSN
"RTN","LRHYPH2",31,0)
 K DR S LRTSTS=0
"RTN","LRHYPH2",32,0)
 S LRSN=0 F  S LRSN=$O(LRSN(LRSN)) Q:'LRSN  D Q17
"RTN","LRHYPH2",33,0)
 I $D(LRLONG),$D(LRSND) S LRSN=LRSND D LROE^LRFAST S X=^TMP("LRHYDY",$J,"LROE",$J,"LRORD"),LRORD=+X,LRODT=$P(X,"^",2),LRTIM=$P(X,"^",3),LRLONG="",PNM=$P(X,"^",4),SSN=$P(X,"^",5)
"RTN","LRHYPH2",34,0)
 Q
"RTN","LRHYPH2",35,0)
Q17 ;
"RTN","LRHYPH2",36,0)
 I $D(LRHYCS33(LRODT,LRSN)) I $D(^LRHY(69.86,LRHYSITE,4,"B",LRHYCS33(LRODT,LRSN))) K LRHYCS33(LRODT,LRSN) QUIT
"RTN","LRHYPH2",37,0)
 S LRHYDJOB=$O(^TMP("LRHYDY",0))
"RTN","LRHYPH2",38,0)
 S I=$O(^LRO(69,LRODT,1,LRSN,6,0)),J=$O(^(1)) S:'$D(IOM) IOM=80 K LRSPCDSC S:J LRSPCDSC=^(J,0) S:I DA=LRSN,DA(1)=LRODT,DR=6,DIC="^LRO(69,"_LRODT_",1," D EN^DIQ:I D LRSPEC^LROE1
"RTN","LRHYPH2",39,0)
 ;
"RTN","LRHYPH2",40,0)
 Q:$D(^TMP("LRHYDY",$J,"KILL",LRODT,LRSN))
"RTN","LRHYPH2",41,0)
 S LRLABLIO=LRDEV S ZTIO=LRDEV
"RTN","LRHYPH2",42,0)
 D ^LRHYBL1
"RTN","LRHYPH2",43,0)
 I $G(LRLABSTP)'="" S LRLABLIO=$P(^%ZIS(1,LRDEV,0),U)_";"_LRLABSTP
"RTN","LRHYPH2",44,0)
 ; get around comments on Howdy screen
"RTN","LRHYPH2",45,0)
 Q:$D(^TMP("LRHYDY",$J,"KILL",LRODT,LRSN))
"RTN","LRHYPH2",46,0)
 S DTIME=.5
"RTN","LRHYPH2",47,0)
 ;
"RTN","LRHYPH2",48,0)
 S LRQUIET=1
"RTN","LRHYPH2",49,0)
 Q:$D(LROLT1(LRODT,LRSN))
"RTN","LRHYPH2",50,0)
 K LRCCOM,X,LRCCOMX,LRCCOM0
"RTN","LRHYPH2",51,0)
 ; The call to OLD^LRORDST hands off the accessioning process and
"RTN","LRHYPH2",52,0)
 ; updating of lab files
"RTN","LRHYPH2",53,0)
 ;
"RTN","LRHYPH2",54,0)
 S LR33ORD=LRORD
"RTN","LRHYPH2",55,0)
 ;K LRORD
"RTN","LRHYPH2",56,0)
 D OLD^LRORDST
"RTN","LRHYPH2",57,0)
 S LRORD=LR33ORD
"RTN","LRHYPH2",58,0)
 I $G(LRUID)'="" D NOW^%DTC S ^TMP("LRHYHOW1",$J,LRUID)=%_U_DUZ
"RTN","LRHYPH2",59,0)
 S DTIME=$$DTIME^XUP(DUZ)
"RTN","LRHYPH2",60,0)
 D D1^LRHYU
"RTN","LRHYPH2",61,0)
 ;
"RTN","LRHYPH2",62,0)
 S ^LRO(69,"AA",+$G(^LRO(69,LRODT,1,LRSN,.1)),LRODT_"|"_LRSN)=""
"RTN","LRHYPH2",63,0)
 ;
"RTN","LRHYPH2",64,0)
 ; Lines below commented out by LR*5.2*491 because:
"RTN","LRHYPH2",65,0)
 ;   (1) Orders have been marked active or discontinued in file
"RTN","LRHYPH2",66,0)
 ;       100 before this code is called.
"RTN","LRHYPH2",67,0)
 ;   (2) Discontinued orders are being marked active in CPRS if
"RTN","LRHYPH2",68,0)
 ;       LRORIEN is the File 100 ien of the discontinued test order.
"RTN","LRHYPH2",69,0)
 ;   (3) If the lines below are needed, LRORIEN would need to be
"RTN","LRHYPH2",70,0)
 ;       be retrieved from the test level of file 69.
"RTN","LRHYPH2",71,0)
 ;
"RTN","LRHYPH2",72,0)
 ;S LRORIEN=$P($G(^LRO(69,LRODT,1,LRSN,0)),U,11)
"RTN","LRHYPH2",73,0)
 ;I $G(LRORIEN) D
"RTN","LRHYPH2",74,0)
 ;.  D STATUS^ORCSAVE2(LRORIEN,6)
"RTN","LRHYPH2",75,0)
 Q:$G(LRNOTEST)  D
"RTN","LRHYPH2",76,0)
 .  K DA,DR S DIE="^LRO(69,"_LRODT_",1,",DA(1)=LRODT,DA=LRSN,DR="12////"_DUZ D ^DIE
"RTN","LRHYPH2",77,0)
 .  K DA,DR S DIE="^LRO(69,"_LRODT_",1,",DA(1)=LRODT,DA=LRSN,DR="13////C" D ^DIE
"RTN","LRHYPH2",78,0)
 Q
"VER")
8.0^22.2
"BLD",10576,6)
^394
**END**
**END**

