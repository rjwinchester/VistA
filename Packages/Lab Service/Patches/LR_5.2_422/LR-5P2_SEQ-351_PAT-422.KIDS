Released LR*5.2*422 SEQ #351
Extracted from mail message
**KIDS**:LR*5.2*422^

**INSTALL NAME**
LR*5.2*422
"BLD",8981,0)
LR*5.2*422^LAB SERVICE^0^3140404^y
"BLD",8981,4,0)
^9.64PA^63^1
"BLD",8981,4,63,0)
63
"BLD",8981,4,63,2,0)
^9.641^63.808^2
"BLD",8981,4,63,2,63.203,0)
ICD CODE  (sub-file)
"BLD",8981,4,63,2,63.203,1,0)
^9.6411^.01^1
"BLD",8981,4,63,2,63.203,1,.01,0)
ICD CODE
"BLD",8981,4,63,2,63.808,0)
AUTOPSY ICD CODE  (sub-file)
"BLD",8981,4,63,2,63.808,1,0)
^9.6411^.01^1
"BLD",8981,4,63,2,63.808,1,.01,0)
AUTOPSY ICD CODE
"BLD",8981,4,63,222)
y^y^p^^^^n^^n
"BLD",8981,4,63,224)

"BLD",8981,4,"APDD",63,63.203)

"BLD",8981,4,"APDD",63,63.203,.01)

"BLD",8981,4,"APDD",63,63.808)

"BLD",8981,4,"APDD",63,63.808,.01)

"BLD",8981,4,"B",63,63)

"BLD",8981,6.3)
29
"BLD",8981,"KRN",0)
^9.67PA^779.2^20
"BLD",8981,"KRN",.4,0)
.4
"BLD",8981,"KRN",.401,0)
.401
"BLD",8981,"KRN",.402,0)
.402
"BLD",8981,"KRN",.403,0)
.403
"BLD",8981,"KRN",.5,0)
.5
"BLD",8981,"KRN",.84,0)
.84
"BLD",8981,"KRN",3.6,0)
3.6
"BLD",8981,"KRN",3.8,0)
3.8
"BLD",8981,"KRN",9.2,0)
9.2
"BLD",8981,"KRN",9.8,0)
9.8
"BLD",8981,"KRN",9.8,"NM",0)
^9.68A^13^13
"BLD",8981,"KRN",9.8,"NM",1,0)
LRAPDA^^0^B92935176
"BLD",8981,"KRN",9.8,"NM",2,0)
LRAUDA^^0^B5906621
"BLD",8981,"KRN",9.8,"NM",3,0)
LRAPICD^^0^B174775261
"BLD",8981,"KRN",9.8,"NM",4,0)
LRAPICD2^^0^B43748147
"BLD",8981,"KRN",9.8,"NM",5,0)
LRAPD1^^0^B24459842
"BLD",8981,"KRN",9.8,"NM",6,0)
LRAPQAT1^^0^B5116733
"BLD",8981,"KRN",9.8,"NM",7,0)
LRSPRPT1^^0^B10863662
"BLD",8981,"KRN",9.8,"NM",8,0)
LRAPCUM1^^0^B6459175
"BLD",8981,"KRN",9.8,"NM",9,0)
LRAUSICD^^0^B6291180
"BLD",8981,"KRN",9.8,"NM",10,0)
LRSPSICD^^0^B7174339
"BLD",8981,"KRN",9.8,"NM",11,0)
LRSPSICP^^0^B6145397
"BLD",8981,"KRN",9.8,"NM",12,0)
LRAPX^^0^B8577110
"BLD",8981,"KRN",9.8,"NM",13,0)
LRU^^0^B45238843
"BLD",8981,"KRN",9.8,"NM","B","LRAPCUM1",8)

"BLD",8981,"KRN",9.8,"NM","B","LRAPD1",5)

"BLD",8981,"KRN",9.8,"NM","B","LRAPDA",1)

"BLD",8981,"KRN",9.8,"NM","B","LRAPICD",3)

"BLD",8981,"KRN",9.8,"NM","B","LRAPICD2",4)

"BLD",8981,"KRN",9.8,"NM","B","LRAPQAT1",6)

"BLD",8981,"KRN",9.8,"NM","B","LRAPX",12)

"BLD",8981,"KRN",9.8,"NM","B","LRAUDA",2)

"BLD",8981,"KRN",9.8,"NM","B","LRAUSICD",9)

"BLD",8981,"KRN",9.8,"NM","B","LRSPRPT1",7)

"BLD",8981,"KRN",9.8,"NM","B","LRSPSICD",10)

"BLD",8981,"KRN",9.8,"NM","B","LRSPSICP",11)

"BLD",8981,"KRN",9.8,"NM","B","LRU",13)

"BLD",8981,"KRN",19,0)
19
"BLD",8981,"KRN",19,"NM",0)
^9.68A^4^4
"BLD",8981,"KRN",19,"NM",1,0)
LRAPSI^^0
"BLD",8981,"KRN",19,"NM",2,0)
LRAPICD^^0
"BLD",8981,"KRN",19,"NM",3,0)
LRAPDGI^^0
"BLD",8981,"KRN",19,"NM",4,0)
LRAPAUDAA^^0
"BLD",8981,"KRN",19,"NM","B","LRAPAUDAA",4)

"BLD",8981,"KRN",19,"NM","B","LRAPDGI",3)

"BLD",8981,"KRN",19,"NM","B","LRAPICD",2)

"BLD",8981,"KRN",19,"NM","B","LRAPSI",1)

"BLD",8981,"KRN",19.1,0)
19.1
"BLD",8981,"KRN",101,0)
101
"BLD",8981,"KRN",409.61,0)
409.61
"BLD",8981,"KRN",771,0)
771
"BLD",8981,"KRN",779.2,0)
779.2
"BLD",8981,"KRN",870,0)
870
"BLD",8981,"KRN",8989.51,0)
8989.51
"BLD",8981,"KRN",8989.52,0)
8989.52
"BLD",8981,"KRN",8994,0)
8994
"BLD",8981,"KRN","B",.4,.4)

"BLD",8981,"KRN","B",.401,.401)

"BLD",8981,"KRN","B",.402,.402)

"BLD",8981,"KRN","B",.403,.403)

"BLD",8981,"KRN","B",.5,.5)

"BLD",8981,"KRN","B",.84,.84)

"BLD",8981,"KRN","B",3.6,3.6)

"BLD",8981,"KRN","B",3.8,3.8)

"BLD",8981,"KRN","B",9.2,9.2)

"BLD",8981,"KRN","B",9.8,9.8)

"BLD",8981,"KRN","B",19,19)

"BLD",8981,"KRN","B",19.1,19.1)

"BLD",8981,"KRN","B",101,101)

"BLD",8981,"KRN","B",409.61,409.61)

"BLD",8981,"KRN","B",771,771)

"BLD",8981,"KRN","B",779.2,779.2)

"BLD",8981,"KRN","B",870,870)

"BLD",8981,"KRN","B",8989.51,8989.51)

"BLD",8981,"KRN","B",8989.52,8989.52)

"BLD",8981,"KRN","B",8994,8994)

"BLD",8981,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8981,"QUES",0)
^9.62^^
"BLD",8981,"REQB",0)
^9.611^7^5
"BLD",8981,"REQB",2,0)
LR*5.2*322^1
"BLD",8981,"REQB",4,0)
LEX*2.0*80^1
"BLD",8981,"REQB",5,0)
ICD*18.0*57^1
"BLD",8981,"REQB",6,0)
DG*5.3*850^1
"BLD",8981,"REQB",7,0)
LR*5.2*350^1
"BLD",8981,"REQB","B","DG*5.3*850",6)

"BLD",8981,"REQB","B","ICD*18.0*57",5)

"BLD",8981,"REQB","B","LEX*2.0*80",4)

"BLD",8981,"REQB","B","LR*5.2*322",2)

"BLD",8981,"REQB","B","LR*5.2*350",7)

"FIA",63)
LAB DATA
"FIA",63,0)
^LR(
"FIA",63,0,0)
63I
"FIA",63,0,1)
y^y^p^^^^n^^n
"FIA",63,0,10)

"FIA",63,0,11)

"FIA",63,0,"RLRO")

"FIA",63,0,"VR")
5.2^LR
"FIA",63,63)
1
"FIA",63,63,80)

"FIA",63,63.02)
1
"FIA",63,63.02,80)

"FIA",63,63.203)
1
"FIA",63,63.203,.01)

"FIA",63,63.808)
1
"FIA",63,63.808,.01)

"KRN",19,1150,-1)
0^3
"KRN",19,1150,0)
LRAPDGI^FS/Gross/Micro/Dx/ICD Coding^^R^^^^^^^^LAB SERVICE
"KRN",19,1150,1,0)
^^4^4^3120626^
"KRN",19,1150,1,1,0)
Allows review of gross specimen and frozen descriptions and entry of
"KRN",19,1150,1,2,0)
microscopic and diagnosis descriptions and ICD coding for each accession
"KRN",19,1150,1,3,0)
number.  This is permitted for unreleased reports only.  However, CPT coding is
"KRN",19,1150,1,4,0)
permitted regardless of the release status of the report.
"KRN",19,1150,20)

"KRN",19,1150,25)
EN3^LRAPD
"KRN",19,1150,"U")
FS/GROSS/MICRO/DX/ICD CODING
"KRN",19,1151,-1)
0^1
"KRN",19,1151,0)
LRAPSI^ICD code search^^R^^^^^^^^LAB SERVICE
"KRN",19,1151,1,0)
^19.06^1^1^3120823^^^^
"KRN",19,1151,1,1,0)
Option searches pathology entries by date for ICD diagnosis code.
"KRN",19,1151,20)

"KRN",19,1151,25)
I^LRAPSE
"KRN",19,1151,"U")
ICD CODE SEARCH
"KRN",19,1152,-1)
0^4
"KRN",19,1152,0)
LRAPAUDAA^Autopsy protocol & ICD coding^^R^^^^^^^^LAB SERVICE
"KRN",19,1152,1,0)
^^3^3^3120626^
"KRN",19,1152,1,1,0)
Allows entry and edit of autopsy summary and ICD codes for an unreleased
"KRN",19,1152,1,2,0)
report.  CPT coding is also permitted regardless of the release status of 
"KRN",19,1152,1,3,0)
the report.
"KRN",19,1152,20)

"KRN",19,1152,25)
A^LRAUDA
"KRN",19,1152,99.1)
62633,37031
"KRN",19,1152,"U")
AUTOPSY PROTOCOL & ICD CODING
"KRN",19,1170,-1)
0^2
"KRN",19,1170,0)
LRAPICD^ICD coding, anat path^^R^^^^^^^^LAB SERVICE^y
"KRN",19,1170,1,0)
^^1^1^3120626^
"KRN",19,1170,1,1,0)
ICD coding for anatomic pathology.
"KRN",19,1170,25)
EN^LRAPX
"KRN",19,1170,"U")
ICD CODING, ANAT PATH
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",14,-1)
1^1
"PKG",14,0)
LAB SERVICE^LR^CORE LAB SYSTEM
"PKG",14,20,0)
^9.402P^1^1
"PKG",14,20,1,0)
2^^LRXDRPT
"PKG",14,20,1,1)

"PKG",14,20,"B",2,1)

"PKG",14,22,0)
^9.49I^1^1
"PKG",14,22,1,0)
5.2^2940927^2960610
"PKG",14,22,1,"PAH",1,0)
422^3140404^2501
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
13
"RTN","LRAPCUM1")
0^8^B6459175^B6249474
"RTN","LRAPCUM1",1,0)
LRAPCUM1 ;AVAMC/REG - AP PATIENT CUM ;7/15/93  10:36
"RTN","LRAPCUM1",2,0)
 ;;5.2;LAB SERVICE;**315,422**;Sep 27, 1994;Build 29
"RTN","LRAPCUM1",3,0)
 ;
"RTN","LRAPCUM1",4,0)
 ; Reference to $$ICDDX^ICDEX supported by ICR #5747
"RTN","LRAPCUM1",5,0)
 ;
"RTN","LRAPCUM1",6,0)
 D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P
"RTN","LRAPCUM1",7,0)
 W !,LR("%"),!,"SNOMED/ICD codes:" F C=0:0 S C=$O(^LR(LRDFN,LRSS,LRI,2,C)) Q:'C  S T=+^(C,0),T=^LAB(61,T,0) D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  W !,"T-",$P(T,"^",2),": " S X=$P(T,"^") D:LR(69.2,.05) C^LRUA W X D M
"RTN","LRAPCUM1",8,0)
 Q:LRA(2)?1P
"RTN","LRAPCUM1",9,0)
 W !
"RTN","LRAPCUM1",10,0)
 N LRX
"RTN","LRAPCUM1",11,0)
 F C=0:0 S C=$O(^LR(LRDFN,LRSS,LRI,3,C)) Q:'C  D  Q:LRA(2)?1P
"RTN","LRAPCUM1",12,0)
 . D:$Y>LRA(1)!'$T MORE
"RTN","LRAPCUM1",13,0)
 . Q:LRA(2)?1P
"RTN","LRAPCUM1",14,0)
 . S LRX=+^LR(LRDFN,LRSS,LRI,3,C,0),LRX=$$ICDDX^ICDEX(LRX,,,"I")
"RTN","LRAPCUM1",15,0)
 . S X=$P(LRX,"^",4)
"RTN","LRAPCUM1",16,0)
 . W !,"ICD code: ",$P(LRX,"^",2),?20
"RTN","LRAPCUM1",17,0)
 . D:LR(69.2,.05) C^LRUA
"RTN","LRAPCUM1",18,0)
 . W X
"RTN","LRAPCUM1",19,0)
 . Q
"RTN","LRAPCUM1",20,0)
 Q
"RTN","LRAPCUM1",21,0)
M F B=0:0 S B=$O(^LR(LRDFN,LRSS,LRI,2,C,2,B)) Q:'B  S M=+^(B,0),M=^LAB(61.1,M,0) D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  W !?5,"M-",$P(M,"^",2),": " S X=$P(M,"^") D:LR(69.2,.05) C^LRUA W X D EX
"RTN","LRAPCUM1",22,0)
 Q:LRA(2)?1P  F B=1.4,3.3,4.5 F F=0:0 S F=$O(^LR(LRDFN,LRSS,LRI,2,C,$P(B,"."),F)) Q:'F  D A
"RTN","LRAPCUM1",23,0)
 Q
"RTN","LRAPCUM1",24,0)
A S M=+^LR(LRDFN,LRSS,LRI,2,C,$P(B,"."),F,0),E="61."_$P(B,".",2),M=^LAB(E,M,0) D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  W !?5,$S(B=1.4:"D-",B=3.3:"F-",B=4.5:"P-",1:""),$P(M,"^",2),?12,": " S X=$P(M,"^") D:LR(69.2,.05) C^LRUA W X
"RTN","LRAPCUM1",25,0)
 Q
"RTN","LRAPCUM1",26,0)
EX F G=0:0 S G=$O(^LR(LRDFN,LRSS,LRI,2,C,2,B,1,G)) Q:'G  S E=+^(G,0),E=^LAB(61.2,E,0) D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  W !?10,"E-",$P(E,"^",2),": " S X=$P(E,"^") D:LR(69.2,.05) C^LRUA W X
"RTN","LRAPCUM1",27,0)
 Q
"RTN","LRAPCUM1",28,0)
MORE D MORE^LRAPCUM Q
"RTN","LRAPD1")
0^5^B24459842^B22367539
"RTN","LRAPD1",1,0)
LRAPD1 ;AVAMC/REG/WTY/KLL - AP DATA ENTRY ;9/25/00
"RTN","LRAPD1",2,0)
 ;;5.2;LAB SERVICE;**41,91,248,259,317,350,422**;Sep 27, 1994;Build 29
"RTN","LRAPD1",3,0)
 ;
"RTN","LRAPD1",4,0)
 ;WTY;17-AUG-01;Unwrapped text and add kills for DR string
"RTN","LRAPD1",5,0)
 ;
"RTN","LRAPD1",6,0)
SP ;Gross Desc/Clinical Hx, Surg Path
"RTN","LRAPD1",7,0)
 S LRSOP="G"
"RTN","LRAPD1",8,0)
 K DR S DR=".09///^S X=LRWHO;.012;.013;.014;.015;.016;"
"RTN","LRAPD1",9,0)
 S DR=DR_".021//^S X=LR(""TR"");1;S:'LR(""FS"") Y=0;1.3"
"RTN","LRAPD1",10,0)
 S LR(6)=1,DR(2,63.812)=".01;.06R;.07R"
"RTN","LRAPD1",11,0)
 Q
"RTN","LRAPD1",12,0)
MSP ;Micro Description/Gross Review, Surg Path
"RTN","LRAPD1",13,0)
 S LRSOP="M"
"RTN","LRAPD1",14,0)
 K DR S DR=".09///^S X=LRWHO;S:'LR(""FS"") Y=1;1.3;1;1.1;"
"RTN","LRAPD1",15,0)
 S DR=DR_"S:'LR(""DX"") Y=.02;1.4;.02;.03;S:'LRV Y=0;.14"
"RTN","LRAPD1",16,0)
 S (LR(7),LR(6))=1
"RTN","LRAPD1",17,0)
 Q
"RTN","LRAPD1",18,0)
BSP ;Micro Description/Snomed Coding
"RTN","LRAPD1",19,0)
 S LRSOP="B",(LR(2),LR(7),LR(6))=1
"RTN","LRAPD1",20,0)
 K DR S DR=".09///^S X=LRWHO;S:'LR(""FS"") Y=1;1.3;1;1.1;"
"RTN","LRAPD1",21,0)
 S DR=DR_"S:'LR(""DX"") Y=.02;1.4;.02;.03;S:'LRV Y=10;.14;10"
"RTN","LRAPD1",22,0)
 S DR(2,63.12)=".01;D T^LRAPD;S:'LR(8) Y=4;2;4;I '$D(LR(1)) S Y=0;"
"RTN","LRAPD1",23,0)
 S DR(2,63.12)=DR(2,63.12)_"1;1.5;3"
"RTN","LRAPD1",24,0)
 S DR(3,63.16)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPD1",25,0)
 S DR(3,63.82)=".01;D R^LRAPD;.02"
"RTN","LRAPD1",26,0)
 Q
"RTN","LRAPD1",27,0)
ASP ;Micro Description/ICDCM Coding
"RTN","LRAPD1",28,0)
 S LRSOP="A",(LR(7),LR(6))=1
"RTN","LRAPD1",29,0)
 K DR S DR=".09///^S X=LRWHO;S:'LR(""FS"") Y=1;1.3;1;1.1;"
"RTN","LRAPD1",30,0)
 S DR=DR_"S:'LR(""DX"") Y=.02;1.4;.02;.03;D F80^LRAPD1;.14;@1;"_$S($G(LRCDSYS)=30:"D EN^LRAPICD(LRDXV)",1:80)
"RTN","LRAPD1",31,0)
 Q
"RTN","LRAPD1",32,0)
F80 ;
"RTN","LRAPD1",33,0)
 I 'LRV S Y="@1"
"RTN","LRAPD1",34,0)
 Q
"RTN","LRAPD1",35,0)
SSP ;Supplementary Report, Surg Path
"RTN","LRAPD1",36,0)
 S (LRSOP,LRSFLG)="S",(LR(2),LR(7),LR(6))=1
"RTN","LRAPD1",37,0)
 K DR
"RTN","LRAPD1",38,0)
 ;Entry of Supp rept must be allowed on released reports
"RTN","LRAPD1",39,0)
 ;S DR="N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) "
"RTN","LRAPD1",40,0)
 ;S DR=DR_"I LRREL(1) D VMSG^LRAPD1 S LRSFLG="""",Y=0;"
"RTN","LRAPD1",41,0)
 ;S DR=DR_".09///^S X=LRWHO;.03;10"
"RTN","LRAPD1",42,0)
 S DR=".09///^S X=LRWHO;.03;10"
"RTN","LRAPD1",43,0)
 S DR(2,63.12)=".01;D T^LRAPD;S:'LR(8) Y=4;2;4;I '$D(LR(1)) "
"RTN","LRAPD1",44,0)
 S DR(2,63.12)=DR(2,63.12)_"S Y=0;1;1.5;3"
"RTN","LRAPD1",45,0)
 S DR(3,63.16)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPD1",46,0)
 S DR(3,63.82)=".01;D R^LRAPD;.02"
"RTN","LRAPD1",47,0)
 Q
"RTN","LRAPD1",48,0)
PSP ;Special Studies, Surg Path
"RTN","LRAPD1",49,0)
 S LRSOP="P"
"RTN","LRAPD1",50,0)
 K DR
"RTN","LRAPD1",51,0)
 S DR="N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) "
"RTN","LRAPD1",52,0)
 S DR=DR_"I LRREL(1) D VMSG^LRAPD1 S Y=0;.03;10"
"RTN","LRAPD1",53,0)
 S DR(2,63.12)="5;1.5"
"RTN","LRAPD1",54,0)
 S DR(3,63.82)=".01;D R^LRAPD;.02",LR(7)=1
"RTN","LRAPD1",55,0)
 Q
"RTN","LRAPD1",56,0)
CY ;Gross Desc/Clinic Hx, Cytopath
"RTN","LRAPD1",57,0)
 S LRSOP="G"
"RTN","LRAPD1",58,0)
 K DR S DR=".09///^S X=LRWHO;.012;.013;.014;.015;.016;"
"RTN","LRAPD1",59,0)
 S DR=DR_".021//^S X=LR(""TR"");1"
"RTN","LRAPD1",60,0)
 S LR(6)=1,DR(2,63.902)=".01;.02;.06R;.07R"
"RTN","LRAPD1",61,0)
 Q
"RTN","LRAPD1",62,0)
MCY ;Micro Desc/Gross Review, Cytopath
"RTN","LRAPD1",63,0)
 S LRSOP="M"
"RTN","LRAPD1",64,0)
 K DR S DR=".09///^S X=LRWHO;1;1.1;S:'LR(""DX"") Y=.021;1.4;"
"RTN","LRAPD1",65,0)
 S DR=DR_".021//^S X=LR(""TR"");.02;.03;.101;S:'LRV Y=0;.14"
"RTN","LRAPD1",66,0)
 S (LR(7),LR(6))=1
"RTN","LRAPD1",67,0)
 Q
"RTN","LRAPD1",68,0)
BCY ;Micro Desc/SNOMED Coding, Cytopath
"RTN","LRAPD1",69,0)
 S LRSOP="B",DIC(0)="M"
"RTN","LRAPD1",70,0)
 S (LR(2),LR(7),LR(6))=1
"RTN","LRAPD1",71,0)
 K DR S DR=".09///^S X=LRWHO;1;1.1;S:'LR(""DX"") Y=.021;1.4;"
"RTN","LRAPD1",72,0)
 S DR=DR_".021//^S X=LR(""TR"");.02;.03;.101;S:'LRV Y=10;.14;10"
"RTN","LRAPD1",73,0)
 S DR(2,63.912)=".01;D T^LRAPD;S:'LR(8) Y=4;2;4;"
"RTN","LRAPD1",74,0)
 S DR(2,63.912)=DR(2,63.912)_"I '$D(LR(1)) S Y=0;1;1.5;3"
"RTN","LRAPD1",75,0)
 S DR(3,63.916)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPD1",76,0)
 S DR(3,63.982)=".01;D R^LRAPD;.02"
"RTN","LRAPD1",77,0)
 Q
"RTN","LRAPD1",78,0)
ACY ;Micro Desc/ICDCM Coding
"RTN","LRAPD1",79,0)
 S LRSOP="A"
"RTN","LRAPD1",80,0)
 S (LR(7),LR(6))=1
"RTN","LRAPD1",81,0)
 K DR S DR=".09///^S X=LRWHO;1;1.1;S:'LR(""DX"") Y=.021;1.4;"
"RTN","LRAPD1",82,0)
 S DR=DR_".021//^S X=LR(""TR"");.02;.03;.101;D F80^LRAPD1;.14;@1;"_$S($G(LRCDSYS)=30:"D EN^LRAPICD(LRDXV)",1:80)
"RTN","LRAPD1",83,0)
 Q
"RTN","LRAPD1",84,0)
SCY ;Supplementary Report, Cyto
"RTN","LRAPD1",85,0)
 S LRSFLG="S"
"RTN","LRAPD1",86,0)
 S (LR(2),LR(7),LR(6))=1
"RTN","LRAPD1",87,0)
 K DR
"RTN","LRAPD1",88,0)
 ;Entry of Supp rept must be allowed on released reports
"RTN","LRAPD1",89,0)
 ;S DR="N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) "
"RTN","LRAPD1",90,0)
 ;S DR=DR_"I LRREL(1) D VMSG^LRAPD1 S LRSFLG="""",Y=0;"
"RTN","LRAPD1",91,0)
 ;S DR=DR_".09///^S X=LRWHO;.03;10"
"RTN","LRAPD1",92,0)
 S DR=".09///^S X=LRWHO;.03;10"
"RTN","LRAPD1",93,0)
 S DR(2,63.912)=".01;D T^LRAPD;S:'LR(8) Y=4;2;4;I '$D(LR(1)) "
"RTN","LRAPD1",94,0)
 S DR(2,63.912)=DR(2,63.912)_"S Y=0;1;1.5;3"
"RTN","LRAPD1",95,0)
 S DR(3,63.916)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPD1",96,0)
 S DR(3,63.982)=".01;D R^LRAPD;.02"
"RTN","LRAPD1",97,0)
 Q
"RTN","LRAPD1",98,0)
PCY ;Special Studies, Cyto
"RTN","LRAPD1",99,0)
 K DR
"RTN","LRAPD1",100,0)
 S DR="N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) "
"RTN","LRAPD1",101,0)
 S DR=DR_"I LRREL(1) D VMSG^LRAPD1 S Y=0;.03;10"
"RTN","LRAPD1",102,0)
 S DR(2,63.912)="5;1.5"
"RTN","LRAPD1",103,0)
 S DR(3,63.982)=".01;D R^LRAPD;.02"
"RTN","LRAPD1",104,0)
 S LR(7)=1
"RTN","LRAPD1",105,0)
 Q
"RTN","LRAPD1",106,0)
EM ;Gross Desc/Clinical Hx, Em
"RTN","LRAPD1",107,0)
 S LRSOP="G",LR(6)=1
"RTN","LRAPD1",108,0)
 K DR S DR=".09///^S X=LRWHO;.012;.013;.014;.015;.016;"
"RTN","LRAPD1",109,0)
 S DR=DR_".021//^S X=LR(""TR"");1"
"RTN","LRAPD1",110,0)
 S DR(2,63.202)=".01;.06R;.07R"
"RTN","LRAPD1",111,0)
 Q
"RTN","LRAPD1",112,0)
MEM ;Micro Desc/Gross Review, EM
"RTN","LRAPD1",113,0)
 S LRSOP="M"
"RTN","LRAPD1",114,0)
 K DR S DR=".09///^S X=LRWHO;1;1.1;S:'LR(""DX"") Y=.021;1.4;"
"RTN","LRAPD1",115,0)
 S DR=DR_".021//^S X=LR(""TR"");.02;.03;S:'LRV Y=0;.14"
"RTN","LRAPD1",116,0)
 S (LR(7),LR(6))=1
"RTN","LRAPD1",117,0)
 Q
"RTN","LRAPD1",118,0)
BEM ;Micro Desc/SNOMED Coding
"RTN","LRAPD1",119,0)
 S LRSOP="B",(LR(2),LR(7),LR(6))=1
"RTN","LRAPD1",120,0)
 K DR S DR=".09///^S X=LRWHO;1;1.1;S:'LR(""DX"") Y=.021;1.4;"
"RTN","LRAPD1",121,0)
 S DR=DR_".021//^S X=LR(""TR"");.02;.03;S:'LRV Y=10;.14;10"
"RTN","LRAPD1",122,0)
 S DR(2,63.212)=".01;D T^LRAPD;S:'LR(8) Y=4;2;4;"
"RTN","LRAPD1",123,0)
 S DR(2,63.212)=DR(2,63.212)_"I '$D(LR(1)) S Y=0;1;1.5;3"
"RTN","LRAPD1",124,0)
 S DR(3,63.216)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPD1",125,0)
 S DR(3,63.282)=".01;D R^LRAPD;.02"
"RTN","LRAPD1",126,0)
 Q
"RTN","LRAPD1",127,0)
AEM ;Micro Desc/ICDCM Coding
"RTN","LRAPD1",128,0)
 S LRSOP="A"
"RTN","LRAPD1",129,0)
 S (LR(7),LR(6))=1
"RTN","LRAPD1",130,0)
 K DR S DR=".09///^S X=LRWHO;1;1.1;S:'LR(""DX"") Y=.021;1.4;"
"RTN","LRAPD1",131,0)
 S DR=DR_".021//^S X=LR(""TR"");.02;.03;D F80^LRAPD1;.14;@1;"_$S($G(LRCDSYS)=30:"D EN^LRAPICD(LRDXV)",1:80)
"RTN","LRAPD1",132,0)
 Q
"RTN","LRAPD1",133,0)
SEM ;Supplementary Report, EM
"RTN","LRAPD1",134,0)
 S LRSFLG="S"
"RTN","LRAPD1",135,0)
 S (LR(2),LR(7),LR(6))=1
"RTN","LRAPD1",136,0)
 K DR
"RTN","LRAPD1",137,0)
 ;Entry of Supp rept must be allowed on released reports
"RTN","LRAPD1",138,0)
 ;S DR="N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) "
"RTN","LRAPD1",139,0)
 ;S DR=DR_"I LRREL(1) D VMSG^LRAPD1 S LRSFLG="""",Y=0;"
"RTN","LRAPD1",140,0)
 ;S DR=DR_".09///^S X=LRWHO;.03;10"
"RTN","LRAPD1",141,0)
 S DR=".09///^S X=LRWHO;.03;10"
"RTN","LRAPD1",142,0)
 S DR(2,63.212)=".01;D T^LRAPD;S:'LR(8) Y=4;2;4;I '$D(LR(1)) "
"RTN","LRAPD1",143,0)
 S DR(2,63.212)=DR(2,63.212)_"S Y=0;1;1.5;3"
"RTN","LRAPD1",144,0)
 S DR(3,63.216)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPD1",145,0)
 S DR(3,63.282)=".01;D R^LRAPD;.02"
"RTN","LRAPD1",146,0)
 Q
"RTN","LRAPD1",147,0)
PEM ;Special Studies, EM
"RTN","LRAPD1",148,0)
 K DR
"RTN","LRAPD1",149,0)
 S DR="N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) "
"RTN","LRAPD1",150,0)
 S DR=DR_"I LRREL(1) D VMSG^LRAPD1 S Y=0;.03;10"
"RTN","LRAPD1",151,0)
 S DR(2,63.212)=5,LR(7)=1
"RTN","LRAPD1",152,0)
 Q
"RTN","LRAPD1",153,0)
VMSG ;Verified message
"RTN","LRAPD1",154,0)
 N LRMSG
"RTN","LRAPD1",155,0)
 S LRMSG=$C(7)_"Report verified.  Cannot edit with this option."
"RTN","LRAPD1",156,0)
 D EN^DDIOL(LRMSG,"","!!")
"RTN","LRAPD1",157,0)
 Q
"RTN","LRAPDA")
0^1^B92935176^B88410283
"RTN","LRAPDA",1,0)
LRAPDA ;DALOI/STAFF - ANATOMIC PATH DATA ENTRY ;01/06/10  10:07
"RTN","LRAPDA",2,0)
 ;;5.2;LAB SERVICE;**72,73,91,121,248,259,295,317,365,350,422**;Sep 27, 1994;Build 29
"RTN","LRAPDA",3,0)
 ;
"RTN","LRAPDA",4,0)
 ; Reference to ^VA(200 supported by IA #10060
"RTN","LRAPDA",5,0)
 ;
"RTN","LRAPDA",6,0)
 S LRDATA=0,LRAU=$S(LRSS'="AU":0,1:1)
"RTN","LRAPDA",7,0)
 W !?20,LRO(68)," (",LRABV,")",!
"RTN","LRAPDA",8,0)
 S:'$D(LRSOP) LRSOP=1 S:'$D(LRD(1)) LRD(1)="0"
"RTN","LRAPDA",9,0)
 S:'$D(^LRO(69.2,LRAA,2,0)) ^(0)="^69.23A^0^0"
"RTN","LRAPDA",10,0)
 ;
"RTN","LRAPDA",11,0)
SEL K LR(1)
"RTN","LRAPDA",12,0)
 I $D(LR(2)) D  G:%<1 END S:%=1 LR(1)=1
"RTN","LRAPDA",13,0)
 . W !!,"Enter Etiology, Function, Procedure & Disease "
"RTN","LRAPDA",14,0)
 . S %=2 D YN^LRU
"RTN","LRAPDA",15,0)
 ;
"RTN","LRAPDA",16,0)
 ;
"RTN","LRAPDA",17,0)
AK ; from LRAPD1
"RTN","LRAPDA",18,0)
 N CORRECT
"RTN","LRAPDA",19,0)
 S:'$D(LRSFLG) LRSFLG=""
"RTN","LRAPDA",20,0)
 W !!,"Data entry for ",LRH(0)," "
"RTN","LRAPDA",21,0)
 S %=1 D YN^LRU G:%<1 END
"RTN","LRAPDA",22,0)
 I %=2 D  G:Y<1 END S LRAD=$E(Y,1,3)_"0000",LRH(0)=$E(Y,1,3)+1700
"RTN","LRAPDA",23,0)
 .S %DT="AE",%DT(0)="-N",%DT("A")="Enter YEAR: " D ^%DT K %DT
"RTN","LRAPDA",24,0)
 I '$O(^LRO(68,LRAA,1,LRAD,1,0)) D  Q
"RTN","LRAPDA",25,0)
 . W $C(7),!!,"NO ",LRO(68)," ACCESSIONS IN FILE FOR ",LRH(0),!!
"RTN","LRAPDA",26,0)
W ;
"RTN","LRAPDA",27,0)
 D LOOKUP^LRAPUTL(.LRDATA,LRH(0),LRO(68),LRSS,LRAD,LRAA)
"RTN","LRAPDA",28,0)
 I LRDATA=-1!('$G(LRSEL))!('$D(LRI)) S LREND=1 Q
"RTN","LRAPDA",29,0)
 S LRIDT=LRI
"RTN","LRAPDA",30,0)
 I LRSEL=2 G:LRUID="" W D REST,OERR^LR7OB63D G W
"RTN","LRAPDA",31,0)
 I LRSEL=3 D REST,OERR^LR7OB63D G W
"RTN","LRAPDA",32,0)
 I LRSEL=1 D REST S:$D(DR(1))#2 DR=DR(1) D OERR^LR7OB63D G W
"RTN","LRAPDA",33,0)
 ;
"RTN","LRAPDA",34,0)
 ;
"RTN","LRAPDA",35,0)
REST ;
"RTN","LRAPDA",36,0)
 N LRXSTOP,LRX,LRX1
"RTN","LRAPDA",37,0)
 ;W "  for ",LRH(0)
"RTN","LRAPDA",38,0)
 I '$D(^LRO(68,LRAA,1,LRAD,1,LRAN,0)) D  Q
"RTN","LRAPDA",39,0)
 . W $C(7),!!,"Accession # ",LRAN," for ",LRH(0)," not in ",LRO(68),!!
"RTN","LRAPDA",40,0)
 S X=^LRO(68,LRAA,1,LRAD,1,LRAN,0),LRLLOC=$P(X,"^",7),LRDFN=+X,LRODT=$P(X,"^",4),LRSN=$P(X,"^",5)
"RTN","LRAPDA",41,0)
 Q:'$D(^LR(LRDFN,0))  S X=^(0) D ^LRUP
"RTN","LRAPDA",42,0)
 ;W !,LRP,"  ID: ",SSN
"RTN","LRAPDA",43,0)
 S (LRIDT,LRI)=+$P($G(^LRO(68,LRAA,1,LRAD,1,LRAN,3)),"^",5)
"RTN","LRAPDA",44,0)
 I LRSS'="AU",'$D(^LR(LRDFN,LRSS,LRI,0)) D  Q
"RTN","LRAPDA",45,0)
 . W $C(7),!,"Inverse date missing or incorrect in Accession Area file "
"RTN","LRAPDA",46,0)
 . W "for",!,LRO(68),"  Year: ",$E(LRAD,2,3),"  Accession: ",LRAN
"RTN","LRAPDA",47,0)
 ;I "SPCYEM"[LRSS,$O(^LR(LRDFN,LRSS,LRI,.1,0)) D
"RTN","LRAPDA",48,0)
 ;.W !,"Specimen(s):"
"RTN","LRAPDA",49,0)
 ;.S X=0 F  S X=$O(^LR(LRDFN,LRSS,LRI,.1,X)) Q:'X  D
"RTN","LRAPDA",50,0)
 ;..W !,$P($G(^LR(LRDFN,LRSS,LRI,.1,X,0)),"^")
"RTN","LRAPDA",51,0)
 ;
"RTN","LRAPDA",52,0)
 ; Don't allow supp. report to be added to a released report if modifications are being added via MM option
"RTN","LRAPDA",53,0)
 S LRXSTOP=0,(LRX,LRX1)=""
"RTN","LRAPDA",54,0)
 I LRSS'="AU",LRD(1)="S" D
"RTN","LRAPDA",55,0)
 . S LRX=$P($G(^LR(LRDFN,LRSS,LRI,0)),"^",11) ;release date/time
"RTN","LRAPDA",56,0)
 . S LRX1=$P($G(^LR(LRDFN,LRSS,LRI,0)),"^",15) ;orig rel date/time
"RTN","LRAPDA",57,0)
 I LRSS="AU",LRSOP="R" D
"RTN","LRAPDA",58,0)
 . S LRX=$P($G(^LR(LRDFN,"AU")),"^",15)  ;release date/time
"RTN","LRAPDA",59,0)
 . S LRX1=$P($G(^LR(LRDFN,"AU")),"^",3)  ;date report completed
"RTN","LRAPDA",60,0)
 I 'LRX,LRX1 D
"RTN","LRAPDA",61,0)
 . W $C(7),!!,"This "_$G(LRAA(1))_" report is currently being"
"RTN","LRAPDA",62,0)
 . W !,"modified; it must first be released before Supplementary"
"RTN","LRAPDA",63,0)
 . W !,"report can be added.",!
"RTN","LRAPDA",64,0)
 . S LRXSTOP=1
"RTN","LRAPDA",65,0)
 Q:LRXSTOP
"RTN","LRAPDA",66,0)
 ;
"RTN","LRAPDA",67,0)
 ;
"RTN","LRAPDA",68,0)
DIE ;Edit
"RTN","LRAPDA",69,0)
 I LRSS="AU" D  D AUE Q
"RTN","LRAPDA",70,0)
 . S LRICDT=$P($G(^LR(LRDFN,"AU")),U,1),ICDFMT=1
"RTN","LRAPDA",71,0)
 . S LRCDSYS=$S(LRICDT'<$$IMPDATE^LEXU("10D"):30,1:1),ICDSYS=LRCDSYS,LRDXV=LRDFN_";"_LRSS
"RTN","LRAPDA",72,0)
 N LRRDT1,LRRDT2,LRIENS,LREL,LRQUIT,LRSNO,LRCPT,LRESCPT
"RTN","LRAPDA",73,0)
 S (LREL,LRESCPT,LRQUIT,LRSNO,LRCPT)=0,LRIENS=LRI_","_LRDFN_","
"RTN","LRAPDA",74,0)
 S LRRDT1=$$GET1^DIQ(LRSF,LRIENS,.11,"I")
"RTN","LRAPDA",75,0)
 S LRRDT2=$$GET1^DIQ(LRSF,LRIENS,.15,"I")
"RTN","LRAPDA",76,0)
 S LRICDT=$$GET1^DIQ(LRSF,LRIENS,.1,"I"),ICDFMT=1
"RTN","LRAPDA",77,0)
 S LRCDSYS=$S(LRICDT'<$$IMPDATE^LEXU("10D"):30,1:1),ICDSYS=LRCDSYS,LRDXV=LRDFN_";"_LRSS_";"_LRI
"RTN","LRAPDA",78,0)
 S:LRRDT1!LRRDT2 LREL=1
"RTN","LRAPDA",79,0)
 ; Determine if CPT activated
"RTN","LRAPDA",80,0)
 I $T(ES^LRCAPES)'="" S LRESCPT=$$ES^LRCAPES()
"RTN","LRAPDA",81,0)
 I LRSOP="G",LREL D  Q
"RTN","LRAPDA",82,0)
 . W $C(7),!!,"Report verified.  Cannot edit with this option."
"RTN","LRAPDA",83,0)
 I LRSOP'="","ABM"[LRSOP,LREL D  Q:LRQUIT
"RTN","LRAPDA",84,0)
 .  ;Allow SNOMED and CPT coding even after release.
"RTN","LRAPDA",85,0)
 . W $C(7),!!,"Report has been verified.  "
"RTN","LRAPDA",86,0)
 . I 'LRESCPT,LRSOP'="B" D  Q
"RTN","LRAPDA",87,0)
 . . W "Cannot edit with this option."
"RTN","LRAPDA",88,0)
 . . S LRQUIT=1
"RTN","LRAPDA",89,0)
 . W "Only "
"RTN","LRAPDA",90,0)
 . I LRESCPT W "CPT " W:LRSOP="B" "and "
"RTN","LRAPDA",91,0)
 . W:LRSOP="B" "SNOMED "
"RTN","LRAPDA",92,0)
 . W "coding permitted.",!
"RTN","LRAPDA",93,0)
 . I LRSOP="B" D
"RTN","LRAPDA",94,0)
 . . K DIR S DIR(0)="Y",DIR("A")="Enter SNOMED coding",DIR("B")="NO"
"RTN","LRAPDA",95,0)
 . . D ^DIR W !
"RTN","LRAPDA",96,0)
 . . S LRSNO=+Y
"RTN","LRAPDA",97,0)
 . Q:'LRESCPT
"RTN","LRAPDA",98,0)
 . K DIR S DIR(0)="Y",DIR("A")="Enter CPT coding",DIR("B")="NO"
"RTN","LRAPDA",99,0)
 . D ^DIR W !
"RTN","LRAPDA",100,0)
 . S LRCPT=+Y
"RTN","LRAPDA",101,0)
 . I "AM"[LRSOP,'LRCPT S LRQUIT=1 Q
"RTN","LRAPDA",102,0)
 . I LRSOP="B",'LRCPT,'LRSNO S LRQUIT=1
"RTN","LRAPDA",103,0)
 ;
"RTN","LRAPDA",104,0)
 ;
"RTN","LRAPDA",105,0)
RESET ; Reset DR string if altered by prior accession/patient
"RTN","LRAPDA",106,0)
 ; Reset DR to orig value in LRAPD1
"RTN","LRAPDA",107,0)
 I LRSOP'="","AMBS"[LRSOP,$G(LRD)'="" D @LRD
"RTN","LRAPDA",108,0)
 I LRSFLG="S",$G(LRD)'="" D @LRD  ;For CY,EM Supp entry
"RTN","LRAPDA",109,0)
 S:LRSNO DR=10    ;Modify DR string if only SNOMED coding permitted
"RTN","LRAPDA",110,0)
 I 'LRSNO,LRCPT S DR=""  ;Set DR string to null in only CPT coding
"RTN","LRAPDA",111,0)
 ; If adding supp rpt to released rpt, remove date rpt completed from DR
"RTN","LRAPDA",112,0)
 I LRRDT1,LRSOP="S"!(LRSFLG="S") S DR=".09///^S X=LRWHO;10"
"RTN","LRAPDA",113,0)
 ;
"RTN","LRAPDA",114,0)
EDIT ; Call to ^DIE
"RTN","LRAPDA",115,0)
 W !
"RTN","LRAPDA",116,0)
 S LRA=^LR(LRDFN,LRSS,LRI,0),LRRC=$P(LRA,"^",10)
"RTN","LRAPDA",117,0)
 I LRCAPA,"SPCYEM"[LRSS D C^LRAPSWK
"RTN","LRAPDA",118,0)
 S DIE="^LR(LRDFN,LRSS,",DA=LRI,DA(1)=LRDFN
"RTN","LRAPDA",119,0)
 D CK^LRU Q:$D(LR("CK"))
"RTN","LRAPDA",120,0)
 I LRSS="SP",LRSOP="B",$O(^LR(LRDFN,LRSS,LRI,1.3,0)) D
"RTN","LRAPDA",121,0)
 . W $C(7),!!,"This accession has a FROZEN SECTION report."
"RTN","LRAPDA",122,0)
 . W !,"Be sure 'FROZEN SECTION' is entered as a SNOMED code in the PROCEDURE field"
"RTN","LRAPDA",123,0)
 . W !,"for the appropriate organ or tissue.",!!
"RTN","LRAPDA",124,0)
 ; Code S LRELSD is in DR string setup in LRAPR
"RTN","LRAPDA",125,0)
 N LRELSD S LRELSD=0
"RTN","LRAPDA",126,0)
 D ^DIE
"RTN","LRAPDA",127,0)
 ;
"RTN","LRAPDA",128,0)
 ; Ask for performing laboratory assignment
"RTN","LRAPDA",129,0)
 I LRSFLG'="S" D EDIT^LRRPLU(LRDFN,LRSS,LRI)
"RTN","LRAPDA",130,0)
 ;
"RTN","LRAPDA",131,0)
 ; Update accession and order file, releasing facility and send CPRS alerts
"RTN","LRAPDA",132,0)
 I LRELSD D
"RTN","LRAPDA",133,0)
 . D ACCCOMP^LRAPRES
"RTN","LRAPDA",134,0)
 . I LRSS'="AU" D
"RTN","LRAPDA",135,0)
 . . D SETRL^LRVERA(LRDFN,LRSS,LRI,DUZ(2))
"RTN","LRAPDA",136,0)
 . . D MAIN^LRAPRES1(LRDFN,LRSS,LRI,LRSF,LRP,$P(LRA,"^",6))
"RTN","LRAPDA",137,0)
 ;
"RTN","LRAPDA",138,0)
 ; Update clinical reminders
"RTN","LRAPDA",139,0)
 D UPDATE^LRPXRM(LRDFN,LRSS,LRI)
"RTN","LRAPDA",140,0)
 ;
"RTN","LRAPDA",141,0)
 D:LRSFLG="S"&('$D(Y)) ^LRAPDSR
"RTN","LRAPDA",142,0)
 D FRE^LRU
"RTN","LRAPDA",143,0)
 I LRSOP'="","ABM"[LRSOP D CPTCOD
"RTN","LRAPDA",144,0)
 ;
"RTN","LRAPDA",145,0)
WKLD ; Capture Workload
"RTN","LRAPDA",146,0)
 I LRSOP="Z","CYSP"[LRSS,LRCAPA D S^LRAPR Q
"RTN","LRAPDA",147,0)
 I LRCAPA,"SPCYEM"[LRSS,LRD(1)'="","MBA"[LRD(1) D C1^LRAPSWK
"RTN","LRAPDA",148,0)
 I LRCAPA,"SPCYEM"[LRSS,LRSOP="G" D C1^LRAPSWK
"RTN","LRAPDA",149,0)
 ;
"RTN","LRAPDA",150,0)
QUEUES ; Update Queues
"RTN","LRAPDA",151,0)
 S X=$P(^LR(LRDFN,LRSS,LRI,0),"^",4)
"RTN","LRAPDA",152,0)
 I X,$D(^VA(200,X,0)) S LR("TR")=$P(^(0),"^")
"RTN","LRAPDA",153,0)
 I "CYEMSP"[LRSS,$D(LR(6)),LRSOP="G" Q:$D(^LRO(69.2,LRAA,1,LRAN,0))  D  Q
"RTN","LRAPDA",154,0)
 . L +^LRO(69.2,LRAA,1):DILOCKTM I '$T D  Q
"RTN","LRAPDA",155,0)
 . . N MSG
"RTN","LRAPDA",156,0)
 . . S MSG(1)="The preliminary reports queue is in use by another person.",MSG(1,"F")="!!"
"RTN","LRAPDA",157,0)
 . . S MSG(2)="  You will need to add this accession to the queue later."
"RTN","LRAPDA",158,0)
 . . D EN^DDIOL(.MSG)
"RTN","LRAPDA",159,0)
 . S ^LRO(69.2,LRAA,1,LRAN,0)=LRDFN_"^"_LRI_"^"_LRH(0)
"RTN","LRAPDA",160,0)
 . S X=^LRO(69.2,LRAA,1,0),^(0)=$P(X,"^",1,2)_"^"_LRAN_"^"_($P(X,"^",4)+1)
"RTN","LRAPDA",161,0)
 . L -^LRO(69.2,LRAA,1)
"RTN","LRAPDA",162,0)
 I "CYEMSP"[LRSS,$D(LR(7)),'$D(^LRO(69.2,LRAA,2,LRAN,0)),LRD(1)'="S" D
"RTN","LRAPDA",163,0)
 . L +^LRO(69.2,LRAA,2):DILOCKTM I '$T D  Q
"RTN","LRAPDA",164,0)
 . . N MSG
"RTN","LRAPDA",165,0)
 . . S MSG(1)="The final reports queue is in use by another person.  ",MSG(1,"F")="!!"
"RTN","LRAPDA",166,0)
 . . S MSG(2)="You will need to add this accession to the queue later."
"RTN","LRAPDA",167,0)
 . . D EN^DDIOL(.MSG)
"RTN","LRAPDA",168,0)
 . S ^LRO(69.2,LRAA,2,LRAN,0)=LRDFN_"^"_LRI_"^"_LRH(0)
"RTN","LRAPDA",169,0)
 . S X=^LRO(69.2,LRAA,2,0),^(0)=$P(X,"^",1,2)_"^"_LRAN_"^"_($P(X,"^",4)+1)
"RTN","LRAPDA",170,0)
 . L -^LRO(69.2,LRAA,2)
"RTN","LRAPDA",171,0)
 D:LRSOP="M"!(LRSOP="B") EN^LRSPGD
"RTN","LRAPDA",172,0)
 Q
"RTN","LRAPDA",173,0)
 ;
"RTN","LRAPDA",174,0)
 ;
"RTN","LRAPDA",175,0)
NM ;
"RTN","LRAPDA",176,0)
 I X'["@"!(X["@"&(Y(Z)="")) D  Q
"RTN","LRAPDA",177,0)
 .W $C(7),!?4,"ENTER WHOLE NUMBERS ONLY",! K X
"RTN","LRAPDA",178,0)
 I Y(Z)'="" W $C(7),?40,"OK TO DELETE" S %=2 D YN^LRU I %'=1 K X Q
"RTN","LRAPDA",179,0)
 S Y(Z)="" Q
"RTN","LRAPDA",180,0)
 ;
"RTN","LRAPDA",181,0)
 ;
"RTN","LRAPDA",182,0)
AUE ; Autopsy Data Entry
"RTN","LRAPDA",183,0)
 W !
"RTN","LRAPDA",184,0)
 N LREL,LRQUIT,LRSNO,LRESCPT,LRCPT
"RTN","LRAPDA",185,0)
 S (LREL,LRQUIT,LRSNO,LRCPT)=0
"RTN","LRAPDA",186,0)
 S LREL=+$$GET1^DIQ(63,LRDFN_",",14.7,"I")
"RTN","LRAPDA",187,0)
 ; Determine if CPT activated
"RTN","LRAPDA",188,0)
 I $T(ES^LRCAPES)'="" S LRESCPT=$$ES^LRCAPES()
"RTN","LRAPDA",189,0)
 ; Allow supp report to be added on verified AU
"RTN","LRAPDA",190,0)
 I LRSOP'="","AFIP"[LRSOP,LREL D  Q:LRQUIT
"RTN","LRAPDA",191,0)
 . Q:LRESCPT&("AP"[LRSOP)
"RTN","LRAPDA",192,0)
 . W $C(7),!!,"Report verified.  Cannot edit with this option!"
"RTN","LRAPDA",193,0)
 . S LRQUIT=1
"RTN","LRAPDA",194,0)
 I LRSOP'="","ABP"[LRSOP,LREL D  Q:LRQUIT
"RTN","LRAPDA",195,0)
 . W $C(7),!!,"Report has been verified.  "
"RTN","LRAPDA",196,0)
 . W "Only "
"RTN","LRAPDA",197,0)
 . I LRESCPT W "CPT " W:LRSOP="B" "and "
"RTN","LRAPDA",198,0)
 . W:LRSOP="B" "SNOMED "
"RTN","LRAPDA",199,0)
 . W "coding permitted.",!
"RTN","LRAPDA",200,0)
 . I LRSOP="B" D
"RTN","LRAPDA",201,0)
 . . K DIR S DIR(0)="Y",DIR("A")="Enter SNOMED coding",DIR("B")="NO"
"RTN","LRAPDA",202,0)
 . . D ^DIR W !
"RTN","LRAPDA",203,0)
 . . S LRSNO=+Y
"RTN","LRAPDA",204,0)
 . Q:'LRESCPT
"RTN","LRAPDA",205,0)
 . K DIR S DIR(0)="Y",DIR("A")="Enter CPT coding",DIR("B")="NO"
"RTN","LRAPDA",206,0)
 . D ^DIR W !
"RTN","LRAPDA",207,0)
 . S LRCPT=+Y
"RTN","LRAPDA",208,0)
 . I "AP"[LRSOP,'LRCPT S LRQUIT=1 Q
"RTN","LRAPDA",209,0)
 . I LRSOP="B",'LRCPT,'LRSNO S LRQUIT=1
"RTN","LRAPDA",210,0)
 ;
"RTN","LRAPDA",211,0)
AURESET ; Reset DR to orig value in LRAUDA
"RTN","LRAPDA",212,0)
 I LRSOP'="","AP"[LRSOP D @(LRSOP_"DR^LRAUDA")
"RTN","LRAPDA",213,0)
 I LRSOP="B" D BDR^LRAUDA
"RTN","LRAPDA",214,0)
 S:LRSNO DR=32       ;Modify DR string if only SNOMED coding permitted
"RTN","LRAPDA",215,0)
 I 'LRSNO,LRCPT S DR=""  ;Set DR string to null inf only CPT coding
"RTN","LRAPDA",216,0)
 ;                              ;
"RTN","LRAPDA",217,0)
 ; Not all of the autopsy fields are within the AU subscript.
"RTN","LRAPDA",218,0)
 ; Therefore, we must lock the entire LRDFN.
"RTN","LRAPDA",219,0)
 L +^LR(LRDFN):DILOCKTM I '$T D  Q
"RTN","LRAPDA",220,0)
 . S MSG="This record is locked by another user.  "
"RTN","LRAPDA",221,0)
 . S MSG=MSG_"Please wait and try again."
"RTN","LRAPDA",222,0)
 . D EN^DDIOL(MSG,"","!!") K MSG
"RTN","LRAPDA",223,0)
 I LRSFLG'="S" D
"RTN","LRAPDA",224,0)
 . N LRELSD S LRELSD=0
"RTN","LRAPDA",225,0)
 . S DIE="^LR(",DA=LRDFN
"RTN","LRAPDA",226,0)
 . D ^DIE
"RTN","LRAPDA",227,0)
 . S LRA=^LR(LRDFN,"AU"),LRI=$P(LRA,U),LRAC=$P(LRA,U,6)
"RTN","LRAPDA",228,0)
 . I LRELSD D MAIN^LRAPRES1(LRDFN,LRSS,LRI,LRSF,LRP,LRAC)
"RTN","LRAPDA",229,0)
 ;
"RTN","LRAPDA",230,0)
 D:LRSFLG="S" ^LRAPDSR
"RTN","LRAPDA",231,0)
 ;
"RTN","LRAPDA",232,0)
 ; Ask for performing laboratory assignment
"RTN","LRAPDA",233,0)
 W !! D EDIT^LRRPLU(LRDFN,LRSS,LRI)
"RTN","LRAPDA",234,0)
 ;
"RTN","LRAPDA",235,0)
 D UPDATE^LRPXRM(LRDFN,"AU")
"RTN","LRAPDA",236,0)
 L -^LR(LRDFN)
"RTN","LRAPDA",237,0)
 D:"BAP"[LRSOP AU
"RTN","LRAPDA",238,0)
 D:LRSOP="R" R
"RTN","LRAPDA",239,0)
 I LRSOP'="","ABP"[LRSOP D CPTCOD
"RTN","LRAPDA",240,0)
 Q
"RTN","LRAPDA",241,0)
 ;
"RTN","LRAPDA",242,0)
 ;
"RTN","LRAPDA",243,0)
AU I '$D(^LRO(69.2,LRAA,2,LRAN,0)) D
"RTN","LRAPDA",244,0)
 .L +^LRO(69.2,LRAA,2):DILOCKTM I '$T D  Q
"RTN","LRAPDA",245,0)
 ..S MSG(1)="The final reports queue is in use by another person.  "
"RTN","LRAPDA",246,0)
 ..S MSG(1,"F")="!!"
"RTN","LRAPDA",247,0)
 ..S MSG(2)="You will need to add this accession to the queue later."
"RTN","LRAPDA",248,0)
 ..D EN^DDIOL(.MSG) K MSG
"RTN","LRAPDA",249,0)
 .S ^LRO(69.2,LRAA,2,LRAN,0)=LRDFN
"RTN","LRAPDA",250,0)
 .S X=^LRO(69.2,LRAA,2,0),^(0)=$P(X,"^",1,2)_"^"_LRAN_"^"_($P(X,"^",4)+1)
"RTN","LRAPDA",251,0)
 .L -^LRO(69.2,LRAA,2)
"RTN","LRAPDA",252,0)
 D AU^LRSPGD
"RTN","LRAPDA",253,0)
 Q
"RTN","LRAPDA",254,0)
 ;
"RTN","LRAPDA",255,0)
 ;
"RTN","LRAPDA",256,0)
R I '$D(^LRO(69.2,LRAA,3,LRAN,0)) D
"RTN","LRAPDA",257,0)
 . L +^LRO(69.2,LRAA,3):DILOCKTM I '$T D  Q
"RTN","LRAPDA",258,0)
 . . S MSG(1)="The interim reports queue is in use by another person.  "
"RTN","LRAPDA",259,0)
 . . S MSG(1,"F")="!!"
"RTN","LRAPDA",260,0)
 . . S MSG(2)="You will need to add this accession to the queue later."
"RTN","LRAPDA",261,0)
 . . D EN^DDIOL(.MSG) K MSG
"RTN","LRAPDA",262,0)
 . S ^LRO(69.2,LRAA,3,LRAN,0)=LRDFN
"RTN","LRAPDA",263,0)
 . S X=^LRO(69.2,LRAA,3,0),^(0)=$P(X,"^",1,2)_"^"_LRAN_"^"_($P(X,"^",4)+1)
"RTN","LRAPDA",264,0)
 . L -^LRO(69.2,LRAA,3)
"RTN","LRAPDA",265,0)
 Q
"RTN","LRAPDA",266,0)
 ;
"RTN","LRAPDA",267,0)
 ;
"RTN","LRAPDA",268,0)
PNAME ; Patient Name Lookup
"RTN","LRAPDA",269,0)
 ; LRPFLG tells LRUPS to limit accessions to the chosen year.
"RTN","LRAPDA",270,0)
 N LRPFLG
"RTN","LRAPDA",271,0)
 S X=LRPNM,LRPFLG=1
"RTN","LRAPDA",272,0)
 K LRPNM,DIC,VADM,VAIN,VA
"RTN","LRAPDA",273,0)
 S DFN=-1,DIC(0)="EQM",(LRX,LRDPF)=""
"RTN","LRAPDA",274,0)
 D:'$D(LRLABKY) LABKEY^LRPARAM
"RTN","LRAPDA",275,0)
 D DPA1^LRDPA
"RTN","LRAPDA",276,0)
 I DFN=-1 S LRAN=-1 Q
"RTN","LRAPDA",277,0)
 D I^LRUPS
"RTN","LRAPDA",278,0)
 Q
"RTN","LRAPDA",279,0)
 ;
"RTN","LRAPDA",280,0)
 ;
"RTN","LRAPDA",281,0)
CPTCOD ; CPT Coding
"RTN","LRAPDA",282,0)
 N LRPRO
"RTN","LRAPDA",283,0)
 Q:$T(CPT^LRCAPES)=""
"RTN","LRAPDA",284,0)
 Q:LREL&('LRCPT)
"RTN","LRAPDA",285,0)
 I 'LREL D
"RTN","LRAPDA",286,0)
 . K DIR S DIR(0)="Y",DIR("A")="Enter CPT coding",DIR("B")="NO"
"RTN","LRAPDA",287,0)
 . D ^DIR W !
"RTN","LRAPDA",288,0)
 . S LRCPT=+Y
"RTN","LRAPDA",289,0)
 Q:'LRCPT
"RTN","LRAPDA",290,0)
 ; SET PROVIDER TO CURRENT USER, ALLOW UPDATES
"RTN","LRAPDA",291,0)
 S LRPRO=DUZ
"RTN","LRAPDA",292,0)
 D PROVIDR^LRAPUTL
"RTN","LRAPDA",293,0)
 Q:LRQUIT
"RTN","LRAPDA",294,0)
 D CPT^LRCAPES(LRAA,LRAD,LRAN,LRPRO)
"RTN","LRAPDA",295,0)
 Q
"RTN","LRAPDA",296,0)
 ;
"RTN","LRAPDA",297,0)
 ;
"RTN","LRAPDA",298,0)
END K LRSFLG,LRICDT,LRCDSYS,ICDSYS,ICDFMT,LRDXV
"RTN","LRAPDA",299,0)
 D:$T(CLEAN^LRCAPES)'="" CLEAN^LRCAPES
"RTN","LRAPDA",300,0)
 D V^LRU
"RTN","LRAPDA",301,0)
 Q
"RTN","LRAPDA",302,0)
 ;
"RTN","LRAPICD")
0^3^B174775261^n/a
"RTN","LRAPICD",1,0)
LRAPICD ;ALB/JAM - Anatomic Pathology ICD-10 DIAGNOSIS CODE API ;6/15/12
"RTN","LRAPICD",2,0)
 ;;5.2;LAB SERVICE;**422**;Sep 27, 1994;Build 29
"RTN","LRAPICD",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","LRAPICD",4,0)
 ;
"RTN","LRAPICD",5,0)
 ;Routine based on ^ZZLXDG and ^ICDLOOK
"RTN","LRAPICD",6,0)
 ;
"RTN","LRAPICD",7,0)
 ; Reference to $$CODEC^ICDEX supported by ICR #5747
"RTN","LRAPICD",8,0)
 ; Reference to $$ICDDX^ICDEX supported by ICR #5747
"RTN","LRAPICD",9,0)
 ; Reference to $$SINFO^ICDEX supported by ICR #5747
"RTN","LRAPICD",10,0)
 ; Reference to $$DIAGSRCH^LEX10CS supported by ICR #5681
"RTN","LRAPICD",11,0)
 ; Reference to $$IMPDATE^LEXU supported by ICR #5679
"RTN","LRAPICD",12,0)
 ; Reference to $$FREQ^LEXU supported by ICR #5679    
"RTN","LRAPICD",13,0)
 ; Reference to $$MAX^LEXU  supported by ICR #5679
"RTN","LRAPICD",14,0)
 ;
"RTN","LRAPICD",15,0)
EN(LRDXV) ;
"RTN","LRAPICD",16,0)
 N LRDFN,LRSS,LRI,CFL
"RTN","LRAPICD",17,0)
 I LRDXV="" Q
"RTN","LRAPICD",18,0)
 S LRDFN=$P(LRDXV,";"),LRSS=$P(LRDXV,";",2),LRI=$P(LRDXV,";",3)
"RTN","LRAPICD",19,0)
 I LRDFN="" Q
"RTN","LRAPICD",20,0)
 I LRSS'="AU",LRI="" Q
"RTN","LRAPICD",21,0)
 S CFL=0
"RTN","LRAPICD",22,0)
 D GETDX
"RTN","LRAPICD",23,0)
 D DEMO
"RTN","LRAPICD",24,0)
 I CFL D DXSAV
"RTN","LRAPICD",25,0)
 K X,Y
"RTN","LRAPICD",26,0)
 Q
"RTN","LRAPICD",27,0)
 ;
"RTN","LRAPICD",28,0)
 ;this is a demo code,
"RTN","LRAPICD",29,0)
 ;in your applications you might need to use some or all of the code below,
"RTN","LRAPICD",30,0)
 ;see comments
"RTN","LRAPICD",31,0)
DEMO ;
"RTN","LRAPICD",32,0)
 N QUIT ; to manage demo loop
"RTN","LRAPICD",33,0)
 N LRETV ;to store the selected code information
"RTN","LRAPICD",34,0)
 N PARAM ;  to set your application specific prompts and messages
"RTN","LRAPICD",35,0)
 N CSYS ;coding system "ICD9" or ICD10"
"RTN","LRAPICD",36,0)
 N LROUT ;to return all available information about the selected code
"RTN","LRAPICD",37,0)
 N DEFLV ;default ICD value for demo
"RTN","LRAPICD",38,0)
 N LRADT
"RTN","LRAPICD",39,0)
 ;settings:
"RTN","LRAPICD",40,0)
 S LRADT=$P($G(LRICDT,DT),".")
"RTN","LRAPICD",41,0)
 ;determine coding system based on the date of interest
"RTN","LRAPICD",42,0)
 S CSYS=$$ICDSYSDG(LRADT)
"RTN","LRAPICD",43,0)
 S DEFLV=$O(LRADX(""))
"RTN","LRAPICD",44,0)
 D SETPARAM(.PARAM) ;edit the SETPARAM subroutine below to set your application specific prompts
"RTN","LRAPICD",45,0)
 ;starting demo loop
"RTN","LRAPICD",46,0)
 S QUIT=0 F  Q:QUIT=1  D
"RTN","LRAPICD",47,0)
 . S LRETV=0,LROUT=""
"RTN","LRAPICD",48,0)
 . ;run either ICD9 or ICD10 prompt/search/select logic
"RTN","LRAPICD",49,0)
 . ;ICD9 (1 is a pointer to the ICD-9 diagnosis system entry in the new file #80.4 )
"RTN","LRAPICD",50,0)
 . ;I CSYS=1 S LRETV=$$DIAG9(LRADT,DEFLV,.LROUT,.PARAM) I LRETV=-2 S:$$QUESTION(1,PARAM("TRY ANOTHER"))'=1 QUIT=1 Q
"RTN","LRAPICD",51,0)
 . ;ICD10 (30 is a pointer to the ICD-10 diagnosis system entry in the new file #80.4 )
"RTN","LRAPICD",52,0)
 . I CSYS=30 S LRETV=$$DIAG10(LRADT,.DEFLV,.PARAM)
"RTN","LRAPICD",53,0)
 . ;display information about the code selected (for demo purposes)
"RTN","LRAPICD",54,0)
 . I LRETV>0 S LRADX($P(LRETV,";",2))=+LRETV D CODEINFO(LRETV) W ! D DXDSP S DEFLV="",CFL=1 W ! Q
"RTN","LRAPICD",55,0)
 . ;if no data found
"RTN","LRAPICD",56,0)
 . I LRETV="" W !!,PARAM("NO DATA FOUND"),!,PARAM("NO DATA FOUND 2"),! Q
"RTN","LRAPICD",57,0)
 . ;in ICD10 if the user answered NO for the question "Do you wish to continue(Y/N)?"
"RTN","LRAPICD",58,0)
 . I +LRETV=-4 Q
"RTN","LRAPICD",59,0)
 . ;no changes to the default value
"RTN","LRAPICD",60,0)
 . I +LRETV=-5 S QUIT=1 Q
"RTN","LRAPICD",61,0)
 . ;no data or was aborted 
"RTN","LRAPICD",62,0)
 . I +LRETV=-2 S QUIT=1 Q
"RTN","LRAPICD",63,0)
 . ;if exit due to ^ in the ICD Diagnosis code prompt 
"RTN","LRAPICD",64,0)
 . I +LRETV=-3 S QUIT=1 Q
"RTN","LRAPICD",65,0)
 . ;if no data found
"RTN","LRAPICD",66,0)
 . I +LRETV=-1 S:$P(LRETV,"^",2)=-1 QUIT=1 Q
"RTN","LRAPICD",67,0)
 . ;user entered "@" to delete the currently selected ICD code 
"RTN","LRAPICD",68,0)
 . I +LRETV=-6 D  Q
"RTN","LRAPICD",69,0)
 ..I DEFLV="" W "  <NOTHING TO DELETE>" Q
"RTN","LRAPICD",70,0)
 ..I $$QUESTION(1,PARAM("DELETE"))=1 K:DEFLV'="" LRADX(DEFLV) D DXDSP S DEFLV=$O(LRADX("")),CFL=1 Q
"RTN","LRAPICD",71,0)
 ..W "  <NOTHING DELETED>",!
"RTN","LRAPICD",72,0)
 . ; if continue search
"RTN","LRAPICD",73,0)
 Q
"RTN","LRAPICD",74,0)
 ;
"RTN","LRAPICD",75,0)
 ;//---------
"RTN","LRAPICD",76,0)
 ;The entry point for ICD-10 diagnosis search functionality
"RTN","LRAPICD",77,0)
 ;can be called from applications directly
"RTN","LRAPICD",78,0)
 ;input parameters :
"RTN","LRAPICD",79,0)
 ; LRADT - date of interest (Fileman format)
"RTN","LRAPICD",80,0)
 ; LRADFLT - default values for the search string (can be a code by default)
"RTN","LRAPICD",81,0)
 ; PARAM - parameters/string constants (see SETPARAM for details)
"RTN","LRAPICD",82,0)
 ;returns ICD-10 code selected by the user:
"RTN","LRAPICD",83,0)
 ;  IEN file #80;ICD code value;IEN file # 757.01^description
"RTN","LRAPICD",84,0)
 ; results
"RTN","LRAPICD",85,0)
 ; or -1 if invalid data(press enter)
"RTN","LRAPICD",86,0)
 ; "" if not found 
"RTN","LRAPICD",87,0)
 ; or -2 if time out
"RTN","LRAPICD",88,0)
 ; or -3 if ^ or ^^
"RTN","LRAPICD",89,0)
 ; or -4 in ICD10 if the user answered NO for the question "Do you wish to continue(Y/N)?"
"RTN","LRAPICD",90,0)
 ; or -5 if no changes to the default value
"RTN","LRAPICD",91,0)
DIAG10(LRADT,LRADFLT,PARAM) ;
"RTN","LRAPICD",92,0)
 N LRAINP,XX
"RTN","LRAPICD",93,0)
 F  D  Q:LRAINP<0!($L($P(LRAINP,U,2))>1)
"RTN","LRAPICD",94,0)
 . S LRAINP=$$SRCHSTR(PARAM("SEARCH_PROMPT"),PARAM("HELP ?"),PARAM("HELP ??"),LRADFLT)
"RTN","LRAPICD",95,0)
 . I LRAINP'<0 I $L($P(LRAINP,U,2))'>1 W !!,PARAM("ENTER MORE") W:$L(PARAM("ENTER MORE2"))>0 !,PARAM("ENTER MORE2") W ! ;user should enter at least 2 characters
"RTN","LRAPICD",96,0)
 I LRAINP<0 Q +LRAINP_"^-1"
"RTN","LRAPICD",97,0)
 I $D(LRADX($P(LRAINP,U,2))) D  Q $P(LRAINP,U)_"^"_XX
"RTN","LRAPICD",98,0)
 .S XX=$$ICDDX^ICDEX($P(LRAINP,U,2),LRADT,30,"E"),LRADFLT=$P(XX,U,2),XX=$TR(XX,"^",";"),CFL=1
"RTN","LRAPICD",99,0)
 Q $$LEXICD10($P(LRAINP,U,2),LRADT,.PARAM)
"RTN","LRAPICD",100,0)
 ;
"RTN","LRAPICD",101,0)
 ;//---------
"RTN","LRAPICD",102,0)
 ;The entry point for ICD-9 FileMan type (^DIC) diagnosis search functionality
"RTN","LRAPICD",103,0)
 ;can be called from applications directly
"RTN","LRAPICD",104,0)
 ;input parameters :
"RTN","LRAPICD",105,0)
 ; LRADT - date of interest
"RTN","LRAPICD",106,0)
 ; LRADFLT - default values for the search string (can be a code by default)
"RTN","LRAPICD",107,0)
 ; LROUT - local array to return results(passed as a reference)
"RTN","LRAPICD",108,0)
 ; PARAM - parameters/string constants (see SETPARAM for details)
"RTN","LRAPICD",109,0)
 ;returns ICD-9 code selected by the user:
"RTN","LRAPICD",110,0)
 ;  IEN file #80;ICD code value^description
"RTN","LRAPICD",111,0)
 ;  -1 no data or was aborted
"RTN","LRAPICD",112,0)
 ;  -2 if timeout 
"RTN","LRAPICD",113,0)
DIAG9(LRADT,LRADFLT,LROUT,PARAM) ;
"RTN","LRAPICD",114,0)
 N LRAINP,LRETV,CDE9
"RTN","LRAPICD",115,0)
 S LRETV=$$ICD9(LRADFLT,LRADT,.LROUT,PARAM("SEARCH_PROMPT"))
"RTN","LRAPICD",116,0)
 I LRETV=-1 Q -2
"RTN","LRAPICD",117,0)
 I LRETV<0 Q +LRETV
"RTN","LRAPICD",118,0)
 S CDE9=$P(LRETV,U)
"RTN","LRAPICD",119,0)
 I $D(LRADX($P(CDE9,";",2))) D  Q $P(CDE9,U)_"^"_XX
"RTN","LRAPICD",120,0)
 .S XX=$$ICDDX^ICDEX($P(CDE9,U,2),LRADT,1,"E"),LRADFLT=$P(XX,U,2),XX=$TR(XX,"^",";"),CFL=1
"RTN","LRAPICD",121,0)
 Q LRETV
"RTN","LRAPICD",122,0)
 ;
"RTN","LRAPICD",123,0)
 ;--------------
"RTN","LRAPICD",124,0)
 ;The entry point for ICD-10 diagnosis search functionality
"RTN","LRAPICD",125,0)
 ;can be called from applications directly
"RTN","LRAPICD",126,0)
 ; Supported ICR 5681 ($$DIAGSRCH^LEX10CS)
"RTN","LRAPICD",127,0)
 ;input parameters :
"RTN","LRAPICD",128,0)
 ; LRATXT - search string
"RTN","LRAPICD",129,0)
 ; LRADATE - date of interest
"RTN","LRAPICD",130,0)
 ; LRAPAR - array with text messages and other string constants
"RTN","LRAPICD",131,0)
 ;returns ICD-10 code selected by the user:
"RTN","LRAPICD",132,0)
 ;  IEN file #80;ICD code value^description
"RTN","LRAPICD",133,0)
 ; or 
"RTN","LRAPICD",134,0)
 ; "" if not found 
"RTN","LRAPICD",135,0)
 ; -1 if exit : ^ or ^^
"RTN","LRAPICD",136,0)
 ; -2 if continue searching
"RTN","LRAPICD",137,0)
 ;
"RTN","LRAPICD",138,0)
LEXICD10(LRATXT,LRADATE,LRAPAR) ; ICD-10 Search
"RTN","LRAPICD",139,0)
 N LRALVTXT
"RTN","LRAPICD",140,0)
 ;parameters check
"RTN","LRAPICD",141,0)
 S LRADATE=+$G(LRADATE)
"RTN","LRAPICD",142,0)
 I LRADATE'?7N Q -1
"RTN","LRAPICD",143,0)
 S LRATXT=$G(LRATXT)
"RTN","LRAPICD",144,0)
 Q:'$L(LRATXT) -1
"RTN","LRAPICD",145,0)
 N LRANUMB
"RTN","LRAPICD",146,0)
 S LRANUMB=$$FREQ^LEXU(LRATXT)
"RTN","LRAPICD",147,0)
 I LRANUMB>$$MAX^LEXU(30) D  I $$QUESTION(2,PARAM("WISH CONTINUE"))'=1 Q -4
"RTN","LRAPICD",148,0)
 . W !
"RTN","LRAPICD",149,0)
 . D FORMWRIT(LRAPAR("EXCEEDS MESSAGE1")_LRATXT_LRAPAR("EXCEEDS MESSAGE2")_LRANUMB_LRAPAR("EXCEEDS MESSAGE3")_LRATXT_""".",0)
"RTN","LRAPICD",150,0)
 . D FORMWRIT("",2)
"RTN","LRAPICD",151,0)
 . W !
"RTN","LRAPICD",152,0)
 ;new and set variables
"RTN","LRAPICD",153,0)
 N DIROUT,DUOUT,DTOUT,LRAEXIT,LRAICDNT
"RTN","LRAPICD",154,0)
 N LRETV,LRAXX,LRALEVEL
"RTN","LRAPICD",155,0)
 S LRETV=""
"RTN","LRAPICD",156,0)
 S LRAEXIT=0
"RTN","LRAPICD",157,0)
 S LRALEVEL=1,LRALVTXT(LRALEVEL)=LRATXT ;level 1 stores the original search string
"RTN","LRAPICD",158,0)
 ; main loop
"RTN","LRAPICD",159,0)
 F  Q:LRAEXIT>0  D
"RTN","LRAPICD",160,0)
 .K LRAICDY
"RTN","LRAPICD",161,0)
 .;get the search string from the current level and call LEX API
"RTN","LRAPICD",162,0)
 .S LRAICDY=$$DIAGSRCH^LEX10CS(LRALVTXT(LRALEVEL),.LRAICDY,LRADATE,30)
"RTN","LRAPICD",163,0)
 .S:$O(LRAICDY(" "),-1)>0 LRAICDY=+LRAICDY
"RTN","LRAPICD",164,0)
 .; Nothing found
"RTN","LRAPICD",165,0)
 .I +LRAICDY'>0 S LRAEXIT=1 S LRAXX=-1 Q
"RTN","LRAPICD",166,0)
 .; display the list of items and ask the user to select the item from the list
"RTN","LRAPICD",167,0)
 .S LRAXX=$$SEL^LRAPICD2(.LRAICDY,8)
"RTN","LRAPICD",168,0)
 .; if ^ was entered 
"RTN","LRAPICD",169,0)
 .;   if this is on the top level then quit 
"RTN","LRAPICD",170,0)
 .I LRAXX=-2,LRALEVEL'>1 S LRETV=-1 S LRAEXIT=1 Q
"RTN","LRAPICD",171,0)
 .;   if lower level then go one level up
"RTN","LRAPICD",172,0)
 .I LRAXX=-2,LRALEVEL>1 S:LRALEVEL>1 LRALEVEL=LRALEVEL-1 Q
"RTN","LRAPICD",173,0)
 .; If timeout, or not selected, or ^^ then quit
"RTN","LRAPICD",174,0)
 .I LRAXX=-1 S LRETV=-1 S LRAEXIT=1 Q
"RTN","LRAPICD",175,0)
 .; if Code Found and Selected by the user save selection in LRETV and quit
"RTN","LRAPICD",176,0)
 .I $P(LRAXX,";")'="99:CAT" S LRETV=LRAXX S LRAEXIT=1 Q
"RTN","LRAPICD",177,0)
 .; If Category Found and Selected by the user:  
"RTN","LRAPICD",178,0)
 .;  go to the next inner level
"RTN","LRAPICD",179,0)
 .;  change level number 
"RTN","LRAPICD",180,0)
 .S LRALEVEL=LRALEVEL+1
"RTN","LRAPICD",181,0)
 .;  set the new level with the new search string
"RTN","LRAPICD",182,0)
 .;  and repeat 
"RTN","LRAPICD",183,0)
 .S LRALVTXT(LRALEVEL)=$P($P($G(LRAXX),"^"),";",2)
"RTN","LRAPICD",184,0)
 Q LRETV
"RTN","LRAPICD",185,0)
 ;----------
"RTN","LRAPICD",186,0)
 ;ICD-9 lookup (FileMan lookup)
"RTN","LRAPICD",187,0)
 ;Supported ICR 5773 (FileMan lookup for files #80 and #80.1)
"RTN","LRAPICD",188,0)
 ;Supported ICR 5699 ($$ICDDATA^ICDXCODE)
"RTN","LRAPICD",189,0)
 ;Supported ICR 5747 ($$CSI^ICDEX)
"RTN","LRAPICD",190,0)
 ;input parameters :
"RTN","LRAPICD",191,0)
 ; LRASRCH - search string 
"RTN","LRAPICD",192,0)
 ; LRAICDT - date of interest  
"RTN","LRAPICD",193,0)
 ; LROUT - local array to return detailed info (passed as a reference)
"RTN","LRAPICD",194,0)
 ;returns ICD-9 code selected by the user:
"RTN","LRAPICD",195,0)
 ;  IEN file #80;ICD code value^description
"RTN","LRAPICD",196,0)
 ; or 
"RTN","LRAPICD",197,0)
 ; -1 if exit : ^ or ^^
"RTN","LRAPICD",198,0)
 ; -2 if no results (timeout)
"RTN","LRAPICD",199,0)
 ;the array LROUT returns details if the return value >0, here is an example: 
"RTN","LRAPICD",200,0)
 ; LROUT="6065^814.14"
"RTN","LRAPICD",201,0)
 ; LROUT(0)=814.14
"RTN","LRAPICD",202,0)
 ; LROUT(0,0)=814.14
"RTN","LRAPICD",203,0)
 ; LROUT(0,1)="6065^814.14^^FX PISIFORM-OPEN^^8^^1^^1^^^0^^^^2781001^^1^1"
"RTN","LRAPICD",204,0)
 ; LROUT(0,2)="OPEN FRACTURE OF PISIFORM BONE OF WRIST"
"RTN","LRAPICD",205,0)
 ;Note: this API is not silent because the ICD lookup is not silent
"RTN","LRAPICD",206,0)
ICD9(LRASRCH,LRAICDT,LROUT,LRAPRMT) ;
"RTN","LRAPICD",207,0)
 N KEY,X,Y,DIC,LRACDS
"RTN","LRAPICD",208,0)
 ;KEY must be newed as ICD lookup code doesn't kill it
"RTN","LRAPICD",209,0)
 S DIC="^ICD9(",DIC(0)="EQMNZIA"
"RTN","LRAPICD",210,0)
 S:$G(LRAPRMT)]"" DIC("A")=LRAPRMT
"RTN","LRAPICD",211,0)
 S:$G(LRASRCH)]"" DIC("B")=LRASRCH
"RTN","LRAPICD",212,0)
 S LRACDS="ICD9"
"RTN","LRAPICD",213,0)
 ;note: you must use Y for the 2nd parameter of $$ICDDATA^ICDXCODE
"RTN","LRAPICD",214,0)
 S DIC("S")="I $$LS^ICDEX(80,+Y,LRAICDT)>0,$$CSI^ICDEX(80,+Y)=1"
"RTN","LRAPICD",215,0)
 D ^DIC
"RTN","LRAPICD",216,0)
 M LROUT=Y
"RTN","LRAPICD",217,0)
 I $G(Y) Q $S($D(DTOUT):-2,$D(DUOUT):-1,$D(DUOUT):-1,Y=-1:-1,Y=-5:"",1:+Y_";"_$P(Y,U,2)_U_$G(Y(0,2)))
"RTN","LRAPICD",218,0)
 Q X
"RTN","LRAPICD",219,0)
 ;
"RTN","LRAPICD",220,0)
 ;---------
"RTN","LRAPICD",221,0)
 ; Clean up environment and quit
"RTN","LRAPICD",222,0)
EXIT ;
"RTN","LRAPICD",223,0)
 K %,DIC,DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","LRAPICD",224,0)
 Q
"RTN","LRAPICD",225,0)
 ;
"RTN","LRAPICD",226,0)
 ;-----------
"RTN","LRAPICD",227,0)
 ; Diagnosis display
"RTN","LRAPICD",228,0)
DXDSP ;
"RTN","LRAPICD",229,0)
 N DXS
"RTN","LRAPICD",230,0)
 S DXS=""
"RTN","LRAPICD",231,0)
 F  S DXS=$O(LRADX(DXS)) Q:DXS=""  D
"RTN","LRAPICD",232,0)
 . ; Determine Active Coding System Based on Date of Interest
"RTN","LRAPICD",233,0)
 . S LRCS=$$SINFO^ICDEX("DIAG",$G(LRADT)) ; Supported by ICR 5747
"RTN","LRAPICD",234,0)
 . W !,?4,DXS,?15,$P($$ICDDX^ICDEX(DXS,$G(LRADT),+LRCS,"E"),"^",4) ; Supported by ICR 5747
"RTN","LRAPICD",235,0)
 Q
"RTN","LRAPICD",236,0)
 ;-----------
"RTN","LRAPICD",237,0)
 ; Look-up help for ?
"RTN","LRAPICD",238,0)
INPHLP ;
"RTN","LRAPICD",239,0)
 N DXS,LRCS
"RTN","LRAPICD",240,0)
 I $D(LRADX) D
"RTN","LRAPICD",241,0)
 . W !?4,"Answer with ICD DIAGNOSIS"
"RTN","LRAPICD",242,0)
 . W !?5,"Choose from:"
"RTN","LRAPICD",243,0)
 . D DXDSP W !
"RTN","LRAPICD",244,0)
 I $G(X)["???" D INPHLP3 Q
"RTN","LRAPICD",245,0)
 I $G(X)["??" D INPHLP2 Q
"RTN","LRAPICD",246,0)
 W !," Enter code or ""text"" for more information." Q
"RTN","LRAPICD",247,0)
 Q
"RTN","LRAPICD",248,0)
 ;-----------
"RTN","LRAPICD",249,0)
 ; Look-up help for ??
"RTN","LRAPICD",250,0)
INPHLP2 ;
"RTN","LRAPICD",251,0)
 W !," Enter a ""free text"" term or part of a term such as ""femur fracture""."
"RTN","LRAPICD",252,0)
 W !!," or "
"RTN","LRAPICD",253,0)
 W !!," Enter a ""classification code"" (ICD/CPT etc) to find the single term"
"RTN","LRAPICD",254,0)
 W !," associated with the code."
"RTN","LRAPICD",255,0)
 W !!," or "
"RTN","LRAPICD",256,0)
 W !!," Enter a ""partial code"". Include the decimal when a search criterion"
"RTN","LRAPICD",257,0)
 W !," includes 3 characters or more for code searches."
"RTN","LRAPICD",258,0)
 Q
"RTN","LRAPICD",259,0)
 ;--------
"RTN","LRAPICD",260,0)
 ; Look-up help for ???
"RTN","LRAPICD",261,0)
INPHLP3 ;
"RTN","LRAPICD",262,0)
 W !," Number of Code Matches"
"RTN","LRAPICD",263,0)
 W !," ----------------------"
"RTN","LRAPICD",264,0)
 W !!," The ICD-10 Diagnosis Code search will show the user the number of matches"
"RTN","LRAPICD",265,0)
 W !," found, indicate if additional characters in ICD code exist, and the number"
"RTN","LRAPICD",266,0)
 W !," of codes within the category or subcategory that are available for selection."
"RTN","LRAPICD",267,0)
 W !," For example:"
"RTN","LRAPICD",268,0)
 W !!," 14 matches found"
"RTN","LRAPICD",269,0)
 W !!," M91. - Juvenile osteochondrosis of hip and pelvis (19)"
"RTN","LRAPICD",270,0)
 W !!," This indicates that 14 unique matches or matching groups have been found"
"RTN","LRAPICD",271,0)
 W !," and will be displayed."
"RTN","LRAPICD",272,0)
 W !!," M91. - the ""-"" indicates that there are additional characters that specify"
"RTN","LRAPICD",273,0)
 W !," unique ICD-10 codes available."
"RTN","LRAPICD",274,0)
 W !!," (19) Indicates that there are 19 additional ICD-10 codes in the M91 ""family"""
"RTN","LRAPICD",275,0)
 W !," that are possible selections."
"RTN","LRAPICD",276,0)
 Q
"RTN","LRAPICD",277,0)
 ;--------
"RTN","LRAPICD",278,0)
 ;ask YES/NO questions
"RTN","LRAPICD",279,0)
 ;input parameters :
"RTN","LRAPICD",280,0)
 ; LRADFLT- 0/null- not default, 1- yes, 2 -no
"RTN","LRAPICD",281,0)
 ; LRAPROM - prompt string
"RTN","LRAPICD",282,0)
 ;returns 
"RTN","LRAPICD",283,0)
 ; 2 - no,
"RTN","LRAPICD",284,0)
 ; 1 - yes,
"RTN","LRAPICD",285,0)
 ; 0 - no answer (time out)
"RTN","LRAPICD",286,0)
 ; -3 - ^ or ^^
"RTN","LRAPICD",287,0)
QUESTION(LRADFLT,LRAPROM) ;
"RTN","LRAPICD",288,0)
 N DIR
"RTN","LRAPICD",289,0)
 S %=$G(LRADFLT,2)
"RTN","LRAPICD",290,0)
 S DIR(0)="Y",DIR("A")=LRAPROM,DIR("B")=$S(%=1:"Yes",%=2:"No",1:"")
"RTN","LRAPICD",291,0)
 D ^DIR
"RTN","LRAPICD",292,0)
 Q:Y["^" -3
"RTN","LRAPICD",293,0)
 Q:Y=1 1
"RTN","LRAPICD",294,0)
 Q:Y=0 2
"RTN","LRAPICD",295,0)
 Q 0
"RTN","LRAPICD",296,0)
 ;
"RTN","LRAPICD",297,0)
 ;------------
"RTN","LRAPICD",298,0)
 ;get search string
"RTN","LRAPICD",299,0)
 ;input parameters :
"RTN","LRAPICD",300,0)
 ; LRAPRMT prompt text
"RTN","LRAPICD",301,0)
 ; LRAHLP1 "?" help text
"RTN","LRAPICD",302,0)
 ; LRAHLP2 "??" help text
"RTN","LRAPICD",303,0)
 ; LRADFLT- default response
"RTN","LRAPICD",304,0)
 ;returns piece1 ^ piece 2
"RTN","LRAPICD",305,0)
 ; piece1:
"RTN","LRAPICD",306,0)
 ; 0 if normal input
"RTN","LRAPICD",307,0)
 ; or -1 if invalid data
"RTN","LRAPICD",308,0)
 ; or -2 if time out
"RTN","LRAPICD",309,0)
 ; or -3 if ^
"RTN","LRAPICD",310,0)
 ; or -5 if user accepts default value then no need to validate it
"RTN","LRAPICD",311,0)
 ; or -6 if user enters "@"
"RTN","LRAPICD",312,0)
 ; piece2: string entered by the user
"RTN","LRAPICD",313,0)
SRCHSTR(LRAPRMT,LRAHLP1,LRAHLP2,LRADFLT) ;
"RTN","LRAPICD",314,0)
 N DIR
"RTN","LRAPICD",315,0)
 S DIR("A")=LRAPRMT
"RTN","LRAPICD",316,0)
 S DIR("?")=LRAHLP1
"RTN","LRAPICD",317,0)
 S DIR("??")=LRAHLP2
"RTN","LRAPICD",318,0)
 I $L($G(LRADFLT)) S DIR("B")=LRADFLT
"RTN","LRAPICD",319,0)
 S DIR(0)="FAOr^0:245"
"RTN","LRAPICD",320,0)
 D ^DIR
"RTN","LRAPICD",321,0)
 Q:$D(DTOUT) -2
"RTN","LRAPICD",322,0)
 Q:$D(DUOUT) -3
"RTN","LRAPICD",323,0)
 Q:X="@" -6 ;quit if user entered "@" and handle deletion case in your application
"RTN","LRAPICD",324,0)
 Q:Y["^" -3
"RTN","LRAPICD",325,0)
 Q:Y="" -1
"RTN","LRAPICD",326,0)
 Q:(($L($G(LRADFLT)))&(Y=LRADFLT)) -5 ;if user accepts default value then no need to validate it
"RTN","LRAPICD",327,0)
 Q 0_U_$$UP^XLFSTR(Y)
"RTN","LRAPICD",328,0)
 ;
"RTN","LRAPICD",329,0)
 ;----------
"RTN","LRAPICD",330,0)
 ;Determines and returns ACTIVE coding system for DIAGNOSES based on date of interest 
"RTN","LRAPICD",331,0)
 ;input parameters :
"RTN","LRAPICD",332,0)
 ; LRAICDD - date of interest
"RTN","LRAPICD",333,0)
 ; if date of interest is null, today's date will be assumed
"RTN","LRAPICD",334,0)
 ;returns coding system  
"RTN","LRAPICD",335,0)
 ; as a pointer to the ICD CODING SYSTEM file #80.4 (supported ICR 5780) 
"RTN","LRAPICD",336,0)
 ; 30  if ICD-10-CM is active system
"RTN","LRAPICD",337,0)
 ; 1   if ICD-9-CM is active system
"RTN","LRAPICD",338,0)
ICDSYSDG(LRAICDD) ; 
"RTN","LRAPICD",339,0)
 N LRAIMPDT
"RTN","LRAPICD",340,0)
 S LRAICDD=$S(LRAICDD<0!($L(+LRAICDD)'=7):DT,1:+$G(LRAICDD))
"RTN","LRAPICD",341,0)
 S LRAIMPDT=$$IMPDATE^LEXU("10D")
"RTN","LRAPICD",342,0)
 Q $S(LRAICDD'<LRAIMPDT:30,1:1)
"RTN","LRAPICD",343,0)
 ;
"RTN","LRAPICD",344,0)
 ;set parameters
"RTN","LRAPICD",345,0)
 ;edit these hardcoded strings that are used for prompts, messages and so on to adjust them to your application's needs
"RTN","LRAPICD",346,0)
 ;input parameters 
"RTN","LRAPICD",347,0)
 ; LRAPAR - local array to sets and store string constants for your messages and prompts 
"RTN","LRAPICD",348,0)
SETPARAM(LRAPAR) ;
"RTN","LRAPICD",349,0)
 ;S LRAPAR("ASKDATE")="Date of interest? "
"RTN","LRAPICD",350,0)
 S LRAPAR("SEARCH_PROMPT")="Select "_$S(LRSS="AU":"AUTOPSY ICD CODE",LRSS="EM":"ICD CODE",1:"ICD DIAGNOSIS")_": "
"RTN","LRAPICD",351,0)
 S LRAPAR("HELP ?")="^D INPHLP^LRAPICD"
"RTN","LRAPICD",352,0)
 S LRAPAR("HELP ??")="^D INPHLP^LRAPICD"
"RTN","LRAPICD",353,0)
 S LRAPAR("NO DATA FOUND")=" No records found matching the value entered, revise search or enter ""?"" for"
"RTN","LRAPICD",354,0)
 S LRAPAR("NO DATA FOUND 2")=" help."
"RTN","LRAPICD",355,0)
 S LRAPAR("EXITING")=" Exiting"
"RTN","LRAPICD",356,0)
 S LRAPAR("TRY LATER")=" Try again later"
"RTN","LRAPICD",357,0)
 S LRAPAR("NO DATA SELECTED")=" No data selected"
"RTN","LRAPICD",358,0)
 S LRAPAR("TRY ANOTHER")="Try another"
"RTN","LRAPICD",359,0)
 S LRAPAR("WISH CONTINUE")="Do you wish to continue (Y/N)"
"RTN","LRAPICD",360,0)
 S LRAPAR("EXCEEDS MESSAGE1")="Searching for """
"RTN","LRAPICD",361,0)
 S LRAPAR("EXCEEDS MESSAGE2")=""" requires inspecting "
"RTN","LRAPICD",362,0)
 S LRAPAR("EXCEEDS MESSAGE3")=" records to determine if they match the search criteria. This could take quite some time. Suggest refining the search by further specifying """
"RTN","LRAPICD",363,0)
 S LRAPAR("NO CHANGES")=" No changes made"
"RTN","LRAPICD",364,0)
 S LRAPAR("DELETE")="   SURE YOU WANT TO DELETE"
"RTN","LRAPICD",365,0)
 S LRAPAR("ENTER MORE")=" Please enter at least the first two characters of the ICD-10 code or code"
"RTN","LRAPICD",366,0)
 S LRAPAR("ENTER MORE2")=" description to start the search."
"RTN","LRAPICD",367,0)
 Q
"RTN","LRAPICD",368,0)
 ;
"RTN","LRAPICD",369,0)
 ;a wrapper for ^DIWP
"RTN","LRAPICD",370,0)
 ;accumulates a text and then writes it to the device
"RTN","LRAPICD",371,0)
 ;input parameters :
"RTN","LRAPICD",372,0)
 ; X - text
"RTN","LRAPICD",373,0)
 ; LRAMODE:
"RTN","LRAPICD",374,0)
 ;  0 - start
"RTN","LRAPICD",375,0)
 ;  1 - accumulate 
"RTN","LRAPICD",376,0)
 ;  2 - write
"RTN","LRAPICD",377,0)
 ;example:
"RTN","LRAPICD",378,0)
 ;D FORMWRIT^LRAPICD("this API is a wrapper for ^DIWP, it accumulates a text and then writes it to the device, you can use it in your application code",0)
"RTN","LRAPICD",379,0)
 ;D FORMWRIT^LRAPICD("some more text ",1)
"RTN","LRAPICD",380,0)
 ;D FORMWRIT^LRAPICD("",2)
"RTN","LRAPICD",381,0)
FORMWRIT(X,LRAMODE) ;
"RTN","LRAPICD",382,0)
 N LRALI1,DIWL,DIWR
"RTN","LRAPICD",383,0)
 ;if "start" mode
"RTN","LRAPICD",384,0)
 I LRAMODE=0 K ^UTILITY($J,"W")
"RTN","LRAPICD",385,0)
 S DIWL=1,DIWR=79
"RTN","LRAPICD",386,0)
 I $L(X)>0 D ^DIWP
"RTN","LRAPICD",387,0)
 ;if "write" mode
"RTN","LRAPICD",388,0)
 I LRAMODE=2 D
"RTN","LRAPICD",389,0)
 . S LRALI1=0 F  S LRALI1=$O(^UTILITY($J,"W",1,LRALI1)) Q:+LRALI1=0  W !,$G(^UTILITY($J,"W",1,LRALI1,0))
"RTN","LRAPICD",390,0)
 . K ^UTILITY($J,"W")
"RTN","LRAPICD",391,0)
 Q
"RTN","LRAPICD",392,0)
 ;
"RTN","LRAPICD",393,0)
 ;---------------
"RTN","LRAPICD",394,0)
 ;press any key (used for demo)
"RTN","LRAPICD",395,0)
PRESSKEY ;
"RTN","LRAPICD",396,0)
 N LRAKEY
"RTN","LRAPICD",397,0)
 R !!,"Press any key to continue.",LRAKEY:DTIME
"RTN","LRAPICD",398,0)
 Q
"RTN","LRAPICD",399,0)
 ;display code info (used for demo)
"RTN","LRAPICD",400,0)
CODEINFO(LRAXX2) ; Write Output
"RTN","LRAPICD",401,0)
 W " ",$P(LRAXX2,";",2)
"RTN","LRAPICD",402,0)
 Q
"RTN","LRAPICD",403,0)
 ;
"RTN","LRAPICD",404,0)
GETDX ;Get DX and set in LRADX array
"RTN","LRAPICD",405,0)
 N DX,DXC,CDE
"RTN","LRAPICD",406,0)
 K LRADX
"RTN","LRAPICD",407,0)
 S DX=0
"RTN","LRAPICD",408,0)
 I LRSS="AU" D  Q
"RTN","LRAPICD",409,0)
 .F  S DX=$O(^LR(LRDFN,80,DX)) Q:'DX  D
"RTN","LRAPICD",410,0)
 ..S DXC=$$CODEC^ICDEX(80,DX) Q:DXC<0  S LRADX(DXC)=DX
"RTN","LRAPICD",411,0)
 F  S DX=$O(^LR(LRDFN,LRSS,LRI,3,DX)) Q:'DX  D
"RTN","LRAPICD",412,0)
 .S CDE=+$G(^LR(LRDFN,LRSS,LRI,3,DX,0)) I 'CDE Q
"RTN","LRAPICD",413,0)
 .S DXC=$$CODEC^ICDEX(80,CDE) Q:DXC<0  S LRADX(DXC)=CDE
"RTN","LRAPICD",414,0)
 Q
"RTN","LRAPICD",415,0)
 ;
"RTN","LRAPICD",416,0)
DXSAV ;Save diagnosis codes
"RTN","LRAPICD",417,0)
 N DX,DXC,TMPDX,LRDXS,LRIEN,LRFL,DIK,DA
"RTN","LRAPICD",418,0)
 S DX=""
"RTN","LRAPICD",419,0)
 F  S DX=$O(LRADX(DX)) Q:DX=""  S TMPDX(LRADX(DX))=""
"RTN","LRAPICD",420,0)
 I LRSS="AU" S DX=0 D  Q
"RTN","LRAPICD",421,0)
 .F  S DX=$O(^LR(LRDFN,80,DX)) Q:'DX  D
"RTN","LRAPICD",422,0)
 ..I $D(TMPDX(DX)) K TMPDX(DX) Q
"RTN","LRAPICD",423,0)
 ..I '$D(TMPDX(DX)) S DA(1)=LRDFN,DA=DX,DIK="^LR("_DA(1)_",80," D ^DIK Q
"RTN","LRAPICD",424,0)
 .S DX=0 F  S DX=$O(TMPDX(DX)) Q:'DX  D
"RTN","LRAPICD",425,0)
 ..K LRIEN,LRDXS
"RTN","LRAPICD",426,0)
 ..S LRIEN(1)=DX
"RTN","LRAPICD",427,0)
 ..S LRDXS(63.808,"+1,"_LRDFN_",",.01)=DX
"RTN","LRAPICD",428,0)
 ..D UPDATE^DIE("","LRDXS","LRIEN")
"RTN","LRAPICD",429,0)
 S DX=0
"RTN","LRAPICD",430,0)
 ; save DX code to subfiles - 63.02(EM); 63.08 (SP); or 63.09 (CY)
"RTN","LRAPICD",431,0)
 ; .01 field is DINUM except for subfile 68.02 (EM)
"RTN","LRAPICD",432,0)
 F  S DX=$O(^LR(LRDFN,LRSS,LRI,3,DX)) Q:'DX  D
"RTN","LRAPICD",433,0)
 .I $D(TMPDX(DX)) K TMPDX(DX) Q
"RTN","LRAPICD",434,0)
 .I '$D(TMPDX(DX)) S DA(2)=LRDFN,DA(1)=LRI,DA=DX,DIK="^LR("_DA(2)_","""_LRSS_""","_DA(1)_",3," D ^DIK Q
"RTN","LRAPICD",435,0)
 S LRFL=$S(LRSS="EM":63.203,LRSS="SP":63.88,1:63.901)
"RTN","LRAPICD",436,0)
 S DX=0 F  S DX=$O(TMPDX(DX)) Q:'DX  D
"RTN","LRAPICD",437,0)
 .K LRIEN,LRDXS
"RTN","LRAPICD",438,0)
 .S:LRSS'="EM" LRIEN(3)=DX
"RTN","LRAPICD",439,0)
 .S LRDXS(LRFL,"+3,"_LRI_","_LRDFN_",",.01)=DX
"RTN","LRAPICD",440,0)
 .D UPDATE^DIE("","LRDXS","LRIEN")
"RTN","LRAPICD",441,0)
 Q
"RTN","LRAPICD2")
0^4^B43748147^n/a
"RTN","LRAPICD2",1,0)
LRAPICD2 ;ALB/JAM - Anatomic Pathology ICD-10 DIAGNOSIS CODE API ;6/15/12
"RTN","LRAPICD2",2,0)
 ;;5.2;LAB SERVICE;**422**;Sep 27, 1994;Build 29
"RTN","LRAPICD2",3,0)
 ;
"RTN","LRAPICD2",4,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","LRAPICD2",5,0)
 ;
"RTN","LRAPICD2",6,0)
 ;Routine based on ^ZZLXDG2
"RTN","LRAPICD2",7,0)
 ;
"RTN","LRAPICD2",8,0)
 ; Input   
"RTN","LRAPICD2",9,0)
 ; 
"RTN","LRAPICD2",10,0)
 ;     X     Length of list to display (default 5)
"RTN","LRAPICD2",11,0)
 ;    .LRASRL   Local array passed by reference
"RTN","LRAPICD2",12,0)
 ;               
"RTN","LRAPICD2",13,0)
 ;             LRASRL()   Input Array from ICDSRCH^LEX10CS
"RTN","LRAPICD2",14,0)
 ;               
"RTN","LRAPICD2",15,0)
 ;             LRASRL(0)=# found ^ Pruning Indicator
"RTN","LRAPICD2",16,0)
 ;             LRASRL(1,0)=Code ^ Code IEN ^ date
"RTN","LRAPICD2",17,0)
 ;             LRASRL(1,"IDL")=ICD-9/10 Description, Long
"RTN","LRAPICD2",18,0)
 ;             LRASRL(1,"IDL",1)=ICD-9/10 IEN ^ date
"RTN","LRAPICD2",19,0)
 ;             LRASRL(1,"IDS")=ICD-9/10 Description, Short
"RTN","LRAPICD2",20,0)
 ;             LRASRL(1,"IDS",1)=ICD-9/10 IEN ^ date
"RTN","LRAPICD2",21,0)
 ;             LRASRL(1,"LEX")=Lexicon Description
"RTN","LRAPICD2",22,0)
 ;             LRASRL(1,"LEX",1)=Expression IEN ^ date
"RTN","LRAPICD2",23,0)
 ;             LRASRL(1,"SYN",1)=Synonym #1
"RTN","LRAPICD2",24,0)
 ;             LRASRL(1,"SYN",m)=Synonym #m
"RTN","LRAPICD2",25,0)
 ;             ...
"RTN","LRAPICD2",26,0)
 ;               
"RTN","LRAPICD2",27,0)
 ; Output
"RTN","LRAPICD2",28,0)
 ;               
"RTN","LRAPICD2",29,0)
 ;    $$SEL  Two Piece "^" delimited string same as
"RTN","LRAPICD2",30,0)
 ;           Fileman's Y output variable
"RTN","LRAPICD2",31,0)
 ;               
"RTN","LRAPICD2",32,0)
 ;             1  Lexicon IEN
"RTN","LRAPICD2",33,0)
 ;             2  Lexicon Term
"RTN","LRAPICD2",34,0)
 ;               
"RTN","LRAPICD2",35,0)
 ;    LRASRL    Local array passed by reference
"RTN","LRAPICD2",36,0)
 ;               
"RTN","LRAPICD2",37,0)
 ;             LRASRL(0)=Code ^ Code IEN ^ date
"RTN","LRAPICD2",38,0)
 ;             LRASRL("IDL")=ICD-9/10 Description, Long
"RTN","LRAPICD2",39,0)
 ;             LRASRL("IDL",1)=ICD-9/10 IEN ^ date
"RTN","LRAPICD2",40,0)
 ;             LRASRL("IDS")=ICD-9/10 Description, Short
"RTN","LRAPICD2",41,0)
 ;             LRASRL("IDS",1)=ICD-9/10 IEN ^ date
"RTN","LRAPICD2",42,0)
 ;             LRASRL("LEX")=Lexicon Description
"RTN","LRAPICD2",43,0)
 ;             LRASRL("LEX",1)=Expression IEN ^ date
"RTN","LRAPICD2",44,0)
 ;               
"RTN","LRAPICD2",45,0)
 ;    or ^ on error 
"RTN","LRAPICD2",46,0)
 ;    or -1 for non-selection
"RTN","LRAPICD2",47,0)
 ;    or -2 if "^" was entered
"RTN","LRAPICD2",48,0)
 ;               
"RTN","LRAPICD2",49,0)
SEL(LRASRL,X) ; Select from List
"RTN","LRAPICD2",50,0)
 N LRAGOUP S LRAGOUP=0
"RTN","LRAPICD2",51,0)
 S X=+($G(X))
"RTN","LRAPICD2",52,0)
 S:X'>0 X=5
"RTN","LRAPICD2",53,0)
 S X=$$ASK(.LRASRL,X)
"RTN","LRAPICD2",54,0)
 I LRAGOUP=1 Q -2
"RTN","LRAPICD2",55,0)
 Q X
"RTN","LRAPICD2",56,0)
 ;
"RTN","LRAPICD2",57,0)
ASK(LRASRL,X) ; Ask for Selection
"RTN","LRAPICD2",58,0)
 N DTOUT,DUOUT,DIROUT
"RTN","LRAPICD2",59,0)
 N LRALIT,LRALL,LRALTOT
"RTN","LRAPICD2",60,0)
 S LRALL=+($G(X))
"RTN","LRAPICD2",61,0)
 S:LRALL'>0 LRALL=5
"RTN","LRAPICD2",62,0)
 S LRALIT=0,LRALTOT=$O(LRASRL(" "),-1)
"RTN","LRAPICD2",63,0)
 Q:+LRALTOT'>0 "^"
"RTN","LRAPICD2",64,0)
 K X
"RTN","LRAPICD2",65,0)
 S:+LRALTOT=1 X=$$ONE(LRALL,.LRASRL)
"RTN","LRAPICD2",66,0)
 S:+LRALTOT>1 X=$$MUL(.LRASRL,LRALL)
"RTN","LRAPICD2",67,0)
 S:'$D(DTOUT)&('$D(DUOUT))&('$D(DIROUT))&(+($G(X))'>0) X=-1
"RTN","LRAPICD2",68,0)
 Q X
"RTN","LRAPICD2",69,0)
ONE(X,LRASRL) ; One Entry Found
"RTN","LRAPICD2",70,0)
 Q:+($G(LRALIT))>0 "^^"
"RTN","LRAPICD2",71,0)
 N DIR,LRALC,LRALEX,LRALFI,LRALIT,LRALSO,LRALNC,LRACNT1
"RTN","LRAPICD2",72,0)
 N LRALSP,LRALTX,LRALC,Y
"RTN","LRAPICD2",73,0)
 S LRALFI=$O(LRASRL(0)) Q:+LRALFI'>0 "^"  S LRALSP=$J(" ",11)
"RTN","LRAPICD2",74,0)
 S LRALSO=$P(LRASRL(1,0),"^",1),LRALNC=$P(LRASRL(1,0),"^",3)
"RTN","LRAPICD2",75,0)
 S:+LRALNC>0 LRALNC=" ("_LRALNC_")" S LRALEX=$G(LRASRL(1,"MENU"))
"RTN","LRAPICD2",76,0)
 S LRALC=$S($D(LRASRL(1,"CAT")):"-",1:"")
"RTN","LRAPICD2",77,0)
 S LRALTX(1)=LRALSO_LRALC_$J(" ",(9-$L(LRALSO)))_" "_LRALEX_LRALNC
"RTN","LRAPICD2",78,0)
 D PR(.LRALTX,64) S DIR("A",1)=" One match found",DIR("A",2)=" "
"RTN","LRAPICD2",79,0)
 S DIR("A",3)=" "_$G(LRALTX(1))
"RTN","LRAPICD2",80,0)
 S LRALC=3
"RTN","LRAPICD2",81,0)
 F LRACNT1=2:1 Q:$G(LRALTX(LRACNT1))=""  S LRALC=LRALC+1,DIR("A",LRALC)=LRALSP_$G(LRALTX(LRACNT1))
"RTN","LRAPICD2",82,0)
 S LRALC=LRALC+1,DIR("A",LRALC)=" ",LRALC=LRALC+1
"RTN","LRAPICD2",83,0)
 S DIR("A")=" OK? (Yes/No) ",DIR("B")="Yes",DIR(0)="YAO" W !
"RTN","LRAPICD2",84,0)
 D ^DIR Q:'$D(DTOUT)&('$D(DUOUT))&('$D(DIROUT))&(+($G(Y))'>0) -1
"RTN","LRAPICD2",85,0)
 S:X["^^"!($D(DTOUT)) LRALIT=1
"RTN","LRAPICD2",86,0)
 I X["^^"!(+($G(LRALIT))>0) K LRASRL Q "^^"
"RTN","LRAPICD2",87,0)
 S X=$S(+Y>0:$$X(1,.LRASRL),1:-1)
"RTN","LRAPICD2",88,0)
 Q X
"RTN","LRAPICD2",89,0)
MUL(LRASRL,Y) ; Multiple Entries Found
"RTN","LRAPICD2",90,0)
 Q:+($G(LRALIT))>0 "^^"
"RTN","LRAPICD2",91,0)
 N LRASRLE,LRALL,LRALMAX,LRALSS,LRALX,X
"RTN","LRAPICD2",92,0)
 S (LRALMAX,LRALSS,LRALIT)=0,LRALL=+($G(Y)),U="^" S:+($G(LRALL))'>0 LRALL=5
"RTN","LRAPICD2",93,0)
 S LRALX=$O(LRASRL(" "),-1),LRALSS=0
"RTN","LRAPICD2",94,0)
 G:+LRALX=0 MULQ W ! W:+LRALX>1 !," ",LRALX," matches found"
"RTN","LRAPICD2",95,0)
 F LRASRLE=1:1:LRALX Q:((LRALSS>0)&(LRALSS<(LRASRLE+1)))  Q:LRALIT  D  Q:LRALIT
"RTN","LRAPICD2",96,0)
 . W:LRASRLE#LRALL=1 ! D MULW
"RTN","LRAPICD2",97,0)
 . S LRALMAX=LRASRLE W:LRASRLE#LRALL=0 !
"RTN","LRAPICD2",98,0)
 . S:LRASRLE#LRALL=0 LRALSS=$$MULS(LRALMAX,LRASRLE,.LRASRL) S:LRALSS["^" LRALIT=1
"RTN","LRAPICD2",99,0)
 I LRASRLE#LRALL'=0,+LRALSS<=0 D
"RTN","LRAPICD2",100,0)
 . W ! S LRALSS=$$MULS(LRALMAX,LRASRLE,.LRASRL) S:LRALSS["^" LRALIT=1
"RTN","LRAPICD2",101,0)
 G MULQ
"RTN","LRAPICD2",102,0)
 Q X
"RTN","LRAPICD2",103,0)
MULW ; Write Multiple
"RTN","LRAPICD2",104,0)
 N LRALEX,LRALI1,LRALSO,LRALNC,LRALT2,LRALTX S LRALSO=$P(LRASRL(+LRASRLE,0),"^",1)
"RTN","LRAPICD2",105,0)
 S LRALNC=$P(LRASRL(+LRASRLE,0),"^",3) S:+LRALNC>0 LRALNC=" ("_LRALNC_")"
"RTN","LRAPICD2",106,0)
 S LRALEX=$G(LRASRL(+LRASRLE,"MENU")),LRALTX(1)=LRALSO
"RTN","LRAPICD2",107,0)
 S LRALTX(1)=LRALTX(1)_$S($D(LRASRL(+LRASRLE,"CAT")):"-",1:" ")_$J(" ",(9-$L(LRALSO)))_" "_LRALEX_LRALNC
"RTN","LRAPICD2",108,0)
 D PR(.LRALTX,60) W !,$J(LRASRLE,5),".  ",$G(LRALTX(1))
"RTN","LRAPICD2",109,0)
 F LRALI1=2:1:5 S LRALT2=$G(LRALTX(LRALI1)) W:$L(LRALT2) !,$J(" ",19),LRALT2
"RTN","LRAPICD2",110,0)
 Q
"RTN","LRAPICD2",111,0)
MULS(X,Y,LRASRL) ; Select from Multiple Entries
"RTN","LRAPICD2",112,0)
 N DIR,DIRB,LRALFI,LRALHLP,LRALLST,LRALMAX,LRALS1 ;@#$ not sure LRALS1 is  needed here
"RTN","LRAPICD2",113,0)
 Q:+($G(LRALIT))>0 "^^"  S LRALMAX=+($G(X)),LRALLST=+($G(Y))
"RTN","LRAPICD2",114,0)
 Q:LRALMAX=0 -1 S LRALFI=$O(LRASRL(0)) Q:+LRALFI'>0 -1
"RTN","LRAPICD2",115,0)
 I +($O(LRASRL(+LRALLST)))>0 D
"RTN","LRAPICD2",116,0)
 . S DIR("A")=" Press <RETURN> for more, ""^"" to exit, or Select 1-"
"RTN","LRAPICD2",117,0)
 . S DIR("A")=DIR("A")_LRALMAX_": "
"RTN","LRAPICD2",118,0)
 I +($O(LRASRL(+LRALLST)))'>0 D
"RTN","LRAPICD2",119,0)
 . S DIR("A")=" Select 1-"_LRALMAX_": "
"RTN","LRAPICD2",120,0)
 S LRALHLP=" Answer must be from 1 to "
"RTN","LRAPICD2",121,0)
 S LRALHLP=LRALHLP_LRALMAX_", or <Return> to continue"
"RTN","LRAPICD2",122,0)
 S DIR("PRE")="S:X[""?"" X=""??"""
"RTN","LRAPICD2",123,0)
 S (DIR("?"),DIR("??"))="^D MULSH^LRAPICD2"
"RTN","LRAPICD2",124,0)
 S DIR(0)="NAO^1:"_LRALMAX_":0" D ^DIR
"RTN","LRAPICD2",125,0)
 S:X="^" LRAGOUP=1
"RTN","LRAPICD2",126,0)
 Q:'$D(DTOUT)&('$D(DUOUT))&('$D(DIROUT))&(+($G(Y))'>0) -1
"RTN","LRAPICD2",127,0)
 S:X["^^"!($D(DTOUT)) LRALIT=1,X="^^" I X["^^"!(+($G(LRALIT))>0) Q "^^"
"RTN","LRAPICD2",128,0)
 K DIR Q:$D(DTOUT)!(X[U) "^^"
"RTN","LRAPICD2",129,0)
 Q $S(+Y>0:+Y,1:"-1")
"RTN","LRAPICD2",130,0)
MULSH ; Select from Multiple Entries Help
"RTN","LRAPICD2",131,0)
 I $L($G(LRALHLP)) W !,$G(LRALHLP) Q
"RTN","LRAPICD2",132,0)
 Q
"RTN","LRAPICD2",133,0)
MULQ ; Quit Multiple
"RTN","LRAPICD2",134,0)
 I +LRALSS'>0,$G(LRALSS)="^" Q "^"
"RTN","LRAPICD2",135,0)
 S X=-1 S:+($G(LRALIT))'>0 X=$$X(+LRALSS,.LRASRL)
"RTN","LRAPICD2",136,0)
 Q X
"RTN","LRAPICD2",137,0)
X(X,LRASRL) ; Set X and Output Array
"RTN","LRAPICD2",138,0)
 N LRALEX,LRASRFI,ZZLIEN,LRALN1,LRALNC,LRALNN,LRALRN,LRALS1,LRALSO
"RTN","LRAPICD2",139,0)
 S LRALS1=+($G(X))
"RTN","LRAPICD2",140,0)
 S LRASRFI=$O(LRASRL(0)) ;@#$ not used?
"RTN","LRAPICD2",141,0)
 S LRALSO=$P($G(LRASRL(LRALS1,0)),"^",1),LRALEX=$G(LRASRL(LRALS1,"MENU"))
"RTN","LRAPICD2",142,0)
 S ZZLIEN=$S($D(LRASRL(LRALS1,"CAT")):"99:CAT;"_$P($G(LRASRL(LRALS1,0)),"^"),1:$P($G(LRASRL(LRALS1,"IDS",1)),"^")_";"_$P($G(LRASRL(LRALS1,0)),"^")_";"_$P($G(LRASRL(LRALS1,"LEX",1)),"^")) Q:'$L(LRALSO) "^"
"RTN","LRAPICD2",143,0)
 Q:'$L(LRALEX) "^"  Q:+ZZLIEN'>0 "^" S X=ZZLIEN_"^"_LRALEX
"RTN","LRAPICD2",144,0)
 S LRALNN="LRASRL("_+LRALS1_")",LRALNC="LRASRL("_+LRALS1_","
"RTN","LRAPICD2",145,0)
 F  S LRALNN=$Q(@LRALNN) Q:'$L(LRALNN)!(LRALNN'[LRALNC)  D
"RTN","LRAPICD2",146,0)
 . S LRALRN="LRALN1("_$P(LRALNN,"(",2,299) S @LRALRN=@LRALNN
"RTN","LRAPICD2",147,0)
 K LRASRL S LRALNN="LRALN1("_+LRALS1_")",LRALNC="LRALN1("_+LRALS1_","
"RTN","LRAPICD2",148,0)
 F  S LRALNN=$Q(@LRALNN) Q:'$L(LRALNN)!(LRALNN'[LRALNC)  D
"RTN","LRAPICD2",149,0)
 . S LRALRN="LRASRL("_$P(LRALNN,"(",2,299),@LRALRN=@LRALNN
"RTN","LRAPICD2",150,0)
 Q X
"RTN","LRAPICD2",151,0)
 ; 
"RTN","LRAPICD2",152,0)
 ; Miscellaneous
"RTN","LRAPICD2",153,0)
CL ; Clear
"RTN","LRAPICD2",154,0)
 K LRALIT
"RTN","LRAPICD2",155,0)
 Q
"RTN","LRAPICD2",156,0)
PR(LRASRL,X) ; Parse Array
"RTN","LRAPICD2",157,0)
 N DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,%,%D,LRALC,LRALI1,LRALL
"RTN","LRAPICD2",158,0)
 K ^UTILITY($J,"W")
"RTN","LRAPICD2",159,0)
 Q:'$D(LRASRL)
"RTN","LRAPICD2",160,0)
 S LRALL=+($G(X))
"RTN","LRAPICD2",161,0)
 S:+LRALL'>0 LRALL=79
"RTN","LRAPICD2",162,0)
 S LRALC=+($G(LRASRL))
"RTN","LRAPICD2",163,0)
 S:+($G(LRALC))'>0 LRALC=$O(LRASRL(" "),-1)
"RTN","LRAPICD2",164,0)
 Q:+LRALC'>0
"RTN","LRAPICD2",165,0)
 S DIWL=1,DIWF="C"_+LRALL
"RTN","LRAPICD2",166,0)
 S LRALI1=0
"RTN","LRAPICD2",167,0)
 F  S LRALI1=$O(LRASRL(LRALI1)) Q:+LRALI1=0  S X=$G(LRASRL(LRALI1)) D ^DIWP
"RTN","LRAPICD2",168,0)
 K LRASRL
"RTN","LRAPICD2",169,0)
 S (LRALC,LRALI1)=0
"RTN","LRAPICD2",170,0)
 F  S LRALI1=$O(^UTILITY($J,"W",1,LRALI1)) Q:+LRALI1=0  D
"RTN","LRAPICD2",171,0)
 . S LRASRL(LRALI1)=$$TM($G(^UTILITY($J,"W",1,LRALI1,0))," "),LRALC=LRALC+1
"RTN","LRAPICD2",172,0)
 S:$L(LRALC) LRASRL=LRALC
"RTN","LRAPICD2",173,0)
 K ^UTILITY($J,"W")
"RTN","LRAPICD2",174,0)
 Q
"RTN","LRAPICD2",175,0)
TM(X,Y) ; Trim Character Y - Default " "
"RTN","LRAPICD2",176,0)
 S X=$G(X) Q:X="" X S Y=$G(Y) S:'$L(Y) Y=" "
"RTN","LRAPICD2",177,0)
 F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","LRAPICD2",178,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","LRAPICD2",179,0)
 Q X
"RTN","LRAPQAT1")
0^6^B5116733^B4707143
"RTN","LRAPQAT1",1,0)
LRAPQAT1 ;AVAMC/REG/CYM - QA CODE SEARCH ;2/12/98  14:31
"RTN","LRAPQAT1",2,0)
 ;;5.2;LAB SERVICE;**201,315,422**;Sep 27, 1994;Build 29
"RTN","LRAPQAT1",3,0)
 ;
"RTN","LRAPQAT1",4,0)
 ; Reference to $$ICDDX^ICDEX supported by ICR #5747
"RTN","LRAPQAT1",5,0)
 ; Reference to $$ICDOP^ICDEX supported by ICR #5747
"RTN","LRAPQAT1",6,0)
 ;
"RTN","LRAPQAT1",7,0)
 D EN^LRUA S (LR("W"),LRS(5),LRQ(9),LRQ(3))=1,LRSDT=9999999-LRSDT,LRP=0
"RTN","LRAPQAT1",8,0)
 F LRB=0:0 S LRP=$O(^TMP("LRAP",$J,LRP)) Q:LRP=""!(LR("Q"))  F LRDFN=0:0 S LRDFN=$O(^TMP("LRAP",$J,LRP,LRDFN)) Q:'LRDFN!(LR("Q"))  S X=^(LRDFN) D L
"RTN","LRAPQAT1",9,0)
 Q
"RTN","LRAPQAT1",10,0)
L S DFN=$P(X,"^",2),LRQ=0,SEX=$P(X,"^",4),SSN=$P(X,"^"),Y=$P(X,"^",3) S DOB=$$FMTE^XLFDT(Y)
"RTN","LRAPQAT1",11,0)
 G:'$D(^LR(LRDFN,"SP"))&('$D(^LR(LRDFN,"CY")))&('$D(^LR(LRDFN,"EM"))) AU
"RTN","LRAPQAT1",12,0)
 D ^LRAPT1 Q:LR("Q")
"RTN","LRAPQAT1",13,0)
AU I $D(^LR(LRDFN,"AU")),+^("AU") D ^LRAPT2
"RTN","LRAPQAT1",14,0)
 Q:'DFN!(LR("Q"))  D INP^VADPT Q:VAIN(1)']""  D A
"RTN","LRAPQAT1",15,0)
 Q
"RTN","LRAPQAT1",16,0)
A S LRPTF=VAIN(10)
"RTN","LRAPQAT1",17,0)
 S LRADM=$P(VAIN(7),U,2)
"RTN","LRAPQAT1",18,0)
 S LRWARD=$P(VAIN(4),U,2)
"RTN","LRAPQAT1",19,0)
 S LRTS=$P(VAIN(3),U,2)
"RTN","LRAPQAT1",20,0)
 K VAIN
"RTN","LRAPQAT1",21,0)
 N LRC,LRF
"RTN","LRAPQAT1",22,0)
 W !,"Adm: ",$P(LRADM,"@"),?35,LRWARD
"RTN","LRAPQAT1",23,0)
 W !,?12,"Specialty: ",$P(LRADM,"@"),?35,LRTS
"RTN","LRAPQAT1",24,0)
 Q:'LRPTF
"RTN","LRAPQAT1",25,0)
 I $D(^DGPT(LRPTF,70)),$P(^(70),"^",10) S W=^(70) F X=10,11,16:1:24 I $P(W,"^",X) S LRF($P(W,"^",X))=""
"RTN","LRAPQAT1",26,0)
 F Y=0:0 S Y=$O(^DGPT(LRPTF,"M",Y)) Q:'Y  S W=^(Y,0) F X=5:1:9,11:1:15 I $P(W,"^",X) S LRF($P(W,"^",X))=""
"RTN","LRAPQAT1",27,0)
 I $D(^DGPT(LRPTF,"401P")) S W=^("401P") F X=1:1:5 I $P(W,"^",X) S LRC($P(W,"^",X))=""
"RTN","LRAPQAT1",28,0)
 F Y=0:0 S Y=$O(^DGPT(LRPTF,"P",Y)) Q:'Y  S W=^(Y,0) F X=5:1:9 I $P(W,"^",X) S LRC($P(W,"^",X))=""
"RTN","LRAPQAT1",29,0)
 F Y=0:0 S Y=$O(^DGPT(LRPTF,"S",Y)) Q:'Y  S W=^(Y,0) F X=8:1:12 I $P(W,"^",X) S LRC($P(W,"^",X))=""
"RTN","LRAPQAT1",30,0)
 N LRTMP,LRX
"RTN","LRAPQAT1",31,0)
 F LRTMP=0:0 S LRTMP=$O(LRF(LRTMP)) Q:'LRTMP  D
"RTN","LRAPQAT1",32,0)
 . S LRX=$$ICDDX^ICDEX(LRTMP,,,"I")
"RTN","LRAPQAT1",33,0)
 . I +LRX=-1 Q
"RTN","LRAPQAT1",34,0)
 . W !,$P(LRX,"^",2),?10,$P(LRX,"^",4)
"RTN","LRAPQAT1",35,0)
 . Q
"RTN","LRAPQAT1",36,0)
 F LRTMP=0:0 S LRTMP=$O(LRC(LRTMP)) Q:'LRTMP  D
"RTN","LRAPQAT1",37,0)
 . S LRX=$$ICDOP^ICDEX(LRTMP,,,"I")
"RTN","LRAPQAT1",38,0)
 . I +LRX=-1 Q
"RTN","LRAPQAT1",39,0)
 . W !,$P(LRX,"^",2),?10,$P(LRX,"^",5)
"RTN","LRAPQAT1",40,0)
 . Q
"RTN","LRAPQAT1",41,0)
 Q
"RTN","LRAPX")
0^12^B8577110^B5097427
"RTN","LRAPX",1,0)
LRAPX ;AVAMC/REG/WTY - AP CODING ;11/26/01
"RTN","LRAPX",2,0)
 ;;5.2;LAB SERVICE;**72,259,422**;Sep 27, 1994;Build 29
"RTN","LRAPX",3,0)
 ;
"RTN","LRAPX",4,0)
 D ^LRAP
"RTN","LRAPX",5,0)
 I '$D(Y) D END Q
"RTN","LRAPX",6,0)
 D @LRSS,END
"RTN","LRAPX",7,0)
 Q
"RTN","LRAPX",8,0)
SP ;SNOMED coding, surg path
"RTN","LRAPX",9,0)
 S LR(2)=1,DR="K LRREL D RELCHK^LRAPX I LRREL(1) S Y=10;.03;10"
"RTN","LRAPX",10,0)
 S DR(2,63.12)=".01;S LR(8)=$P(^LAB(61,X,0),U,4);S:'LR(8) Y=4;2;4;"
"RTN","LRAPX",11,0)
 S DR(2,63.12)=DR(2,63.12)_"I '$D(LR(1)) S Y=0;1;1.5;3"
"RTN","LRAPX",12,0)
 S DR(3,63.16)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPX",13,0)
 S DR(3,63.82)=".01;S:'$P(^LAB(61.5,X,0),U,3) Y=0;.02"
"RTN","LRAPX",14,0)
 D ^LRAPDA,END
"RTN","LRAPX",15,0)
 Q
"RTN","LRAPX",16,0)
CY ;SNOMED coding, cytopath
"RTN","LRAPX",17,0)
 S LR(2)=1,DR="K LRREL D RELCHK^LRAPX I LRREL(1) S Y=10;.03;10"
"RTN","LRAPX",18,0)
 S DR(2,63.912)=".01;S LR(8)=$P(^LAB(61,X,0),U,4);S:'LR(8) Y=4;2;4;"
"RTN","LRAPX",19,0)
 S DR(2,63.912)=DR(2,63.912)_"I '$D(LR(1)) S Y=0;1;1.5;3"
"RTN","LRAPX",20,0)
 S DR(3,63.916)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPX",21,0)
 S DR(3,63.982)=".01;S:'$P(^LAB(61.5,X,0),U,3) Y=0;.02"
"RTN","LRAPX",22,0)
 D ^LRAPDA,END
"RTN","LRAPX",23,0)
 Q
"RTN","LRAPX",24,0)
EM ;SNOMED coding, EM
"RTN","LRAPX",25,0)
 S LR(2)=1,DR="K LRREL D RELCHK^LRAPX I LRREL(1) S Y=10;.03;10"
"RTN","LRAPX",26,0)
 S DR(2,63.212)=".01;S LR(8)=$P(^LAB(61,X,0),U,4);S:'LR(8) Y=4;2;4;"
"RTN","LRAPX",27,0)
 S DR(2,63.212)=DR(2,63.212)_"I '$D(LR(1)) S Y=0;1;1.5;3"
"RTN","LRAPX",28,0)
 S DR(3,63.216)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPX",29,0)
 S DR(3,63.282)=".01;S:'$P(^LAB(61.5,X,0),U,3) Y=0;.02"
"RTN","LRAPX",30,0)
 D ^LRAPDA,END
"RTN","LRAPX",31,0)
 Q
"RTN","LRAPX",32,0)
AU ;SNOMED coding, autopsy
"RTN","LRAPX",33,0)
 S LR(2)=1
"RTN","LRAPX",34,0)
 S DR="K LRREL D RELCHK^LRAPX I LRREL(1) S Y=13.01;13;"
"RTN","LRAPX",35,0)
 S DR=DR_"13.01///^S X=LRWHO;32"
"RTN","LRAPX",36,0)
 S DR(2,63.2)=".01;I '$D(LR(1)) S Y=4;1;1.5;3;4"
"RTN","LRAPX",37,0)
 S DR(3,63.21)=".01"
"RTN","LRAPX",38,0)
 S DR(3,63.22)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAPX",39,0)
 S DR(3,63.24)=".01;S:'$P(^LAB(61.5,X,0),U,3) Y=0;.02"
"RTN","LRAPX",40,0)
 S DR(4,63.23)=".01"
"RTN","LRAPX",41,0)
 ;SET LRSOP="H" SO IT WILL SKIP ALL EDITS AND ONLY EXECUTE DIR
"RTN","LRAPX",42,0)
 S LRSOP="H"
"RTN","LRAPX",43,0)
 D ^LRAPDA,END
"RTN","LRAPX",44,0)
 Q
"RTN","LRAPX",45,0)
ISP ;ICDCM coding, surg path
"RTN","LRAPX",46,0)
 S DR="K LRREL D RELCHK^LRAPX I LRREL(1) S Y=""@2"";.03;@2;D F80^LRAPX;@1;80"
"RTN","LRAPX",47,0)
 D ^LRAPDA,END
"RTN","LRAPX",48,0)
 Q
"RTN","LRAPX",49,0)
ICY ;ICDCM coding, cytopath
"RTN","LRAPX",50,0)
 S DR="K LRREL D RELCHK^LRAPX I LRREL(1) S Y=""@2"";.03;@2;D F80^LRAPX;@1;80"
"RTN","LRAPX",51,0)
 D ^LRAPDA,END
"RTN","LRAPX",52,0)
 Q
"RTN","LRAPX",53,0)
IEM ;ICDCM coding, EM
"RTN","LRAPX",54,0)
 S DR="K LRREL D RELCHK^LRAPX I LRREL(1) S Y=""@2"";.03;@2;D F80^LRAPX;@1;80"
"RTN","LRAPX",55,0)
 D ^LRAPDA,END
"RTN","LRAPX",56,0)
 Q
"RTN","LRAPX",57,0)
IAU ;ICDCM coding, autopsy
"RTN","LRAPX",58,0)
 S DR="D F80^LRAPX;@1;80"
"RTN","LRAPX",59,0)
 D ^LRAPDA,END
"RTN","LRAPX",60,0)
 Q
"RTN","LRAPX",61,0)
EN ;entry point for ICDCM coding
"RTN","LRAPX",62,0)
 D ^LRAP
"RTN","LRAPX",63,0)
 I '$D(Y) D END Q
"RTN","LRAPX",64,0)
 D @("I"_LRSS),END
"RTN","LRAPX",65,0)
 Q
"RTN","LRAPX",66,0)
RELCHK ;Check to see if report is released
"RTN","LRAPX",67,0)
 D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI)
"RTN","LRAPX",68,0)
 Q
"RTN","LRAPX",69,0)
F80 ;ICD field #80 lookup path
"RTN","LRAPX",70,0)
 N LRIENS
"RTN","LRAPX",71,0)
 I LRSS="AU" D  Q
"RTN","LRAPX",72,0)
 .S LRICDT=$P($G(^LR(LRDFN,"AU")),U,1)
"RTN","LRAPX",73,0)
 .S LRCDSYS=$S(LRICDT'<$$IMPDATE^LEXU("10D"):30,1:1),ICDSYS=LRCDSYS,LRDXV=LRDFN_";"_LRSS
"RTN","LRAPX",74,0)
 .I $G(LRCDSYS)=30 D EN^LRAPICD(LRDXV) S Y=0 Q
"RTN","LRAPX",75,0)
 .S Y="@1"
"RTN","LRAPX",76,0)
 S LRIENS=LRI_","_LRDFN_","
"RTN","LRAPX",77,0)
 S LRICDT=$$GET1^DIQ(LRSF,LRIENS,.1,"I")
"RTN","LRAPX",78,0)
 S LRCDSYS=$S(LRICDT'<$$IMPDATE^LEXU("10D"):30,1:1),ICDSYS=LRCDSYS,LRDXV=LRDFN_";"_LRSS_";"_LRI
"RTN","LRAPX",79,0)
 I $G(LRCDSYS)=30 D EN^LRAPICD(LRDXV) S Y=0 Q
"RTN","LRAPX",80,0)
 S Y="@1"
"RTN","LRAPX",81,0)
 Q
"RTN","LRAPX",82,0)
END ;
"RTN","LRAPX",83,0)
 K LRREL
"RTN","LRAPX",84,0)
 D V^LRU
"RTN","LRAPX",85,0)
 Q
"RTN","LRAUDA")
0^2^B5906621^B5184827
"RTN","LRAUDA",1,0)
LRAUDA ;AVAMC/REG/WTY/KLL - AUTOPSY PATH DATA ENTRY ;08/20/01
"RTN","LRAUDA",2,0)
 ;;5.2;LAB SERVICE;**72,248,259,322,422**;Sep 27, 1994;Build 29
"RTN","LRAUDA",3,0)
 ;
"RTN","LRAUDA",4,0)
L ;Define AU Section
"RTN","LRAUDA",5,0)
 S LRDICS="AU",LRQUIT=0,XPAD=""
"RTN","LRAUDA",6,0)
 D ^LRAP
"RTN","LRAUDA",7,0)
 I '$D(Y) D
"RTN","LRAUDA",8,0)
 .S LRQUIT=1
"RTN","LRAUDA",9,0)
 Q
"RTN","LRAUDA",10,0)
P ;Autopsy Protocol
"RTN","LRAUDA",11,0)
 D L
"RTN","LRAUDA",12,0)
 I LRQUIT D END Q
"RTN","LRAUDA",13,0)
 D PDR
"RTN","LRAUDA",14,0)
 S LRSOP="P",LR(6)=1
"RTN","LRAUDA",15,0)
 D EDIT
"RTN","LRAUDA",16,0)
 Q
"RTN","LRAUDA",17,0)
PDR ;Entry for resetting DR string
"RTN","LRAUDA",18,0)
 K DR
"RTN","LRAUDA",19,0)
 ;KLL-RESET PAD SEPARATE FROM PROTOCOL
"RTN","LRAUDA",20,0)
 S:XPAD'="D" DR="13;13.01///^S X=LRWHO;32.1;32.2;32.3;99"
"RTN","LRAUDA",21,0)
 S:XPAD="D" DR="13.01///^S X=LRWHO;32.2;32.3;14.9"
"RTN","LRAUDA",22,0)
 Q
"RTN","LRAUDA",23,0)
PAD ;Provisional Anatomic Diagnoses
"RTN","LRAUDA",24,0)
 D L
"RTN","LRAUDA",25,0)
 I LRQUIT D END Q
"RTN","LRAUDA",26,0)
 K DR S DR="13.01///^S X=LRWHO;32.2;32.3;14.9"
"RTN","LRAUDA",27,0)
 ;KLL-S XPAD=D TO KEEP PAD SEPARATE FROM PROTOCOL
"RTN","LRAUDA",28,0)
 S XPAD="D"
"RTN","LRAUDA",29,0)
 ;
"RTN","LRAUDA",30,0)
 S LRSOP="P",LR(6)=1
"RTN","LRAUDA",31,0)
 D EDIT
"RTN","LRAUDA",32,0)
 Q
"RTN","LRAUDA",33,0)
 ;
"RTN","LRAUDA",34,0)
S ;Special Studies
"RTN","LRAUDA",35,0)
 D L
"RTN","LRAUDA",36,0)
 I LRQUIT D END Q
"RTN","LRAUDA",37,0)
 K DR
"RTN","LRAUDA",38,0)
 S DR="N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS) "
"RTN","LRAUDA",39,0)
 S DR=DR_"I LRREL(1) D VMSG^LRAUDA S Y=0;32"
"RTN","LRAUDA",40,0)
 S DR(2,63.2)=".01;5"
"RTN","LRAUDA",41,0)
 D EDIT
"RTN","LRAUDA",42,0)
 Q
"RTN","LRAUDA",43,0)
B ;Autopsy Report/SNOMED Coding
"RTN","LRAUDA",44,0)
 D L
"RTN","LRAUDA",45,0)
 I LRQUIT D END Q
"RTN","LRAUDA",46,0)
 S LR(2)=1
"RTN","LRAUDA",47,0)
 D BDR
"RTN","LRAUDA",48,0)
 D EDIT
"RTN","LRAUDA",49,0)
 Q
"RTN","LRAUDA",50,0)
BDR ;Entry for resetting DR string
"RTN","LRAUDA",51,0)
 K DR S DR="13;13.01///^S X=LRWHO;32.1;32.2;32.3;99;32"
"RTN","LRAUDA",52,0)
 S DR(2,63.2)=".01;I '$D(LR(1)) S Y=4;1;1.5;3;4"
"RTN","LRAUDA",53,0)
 S DR(3,63.21)=".01",DR(3,63.22)=".01;I '$D(LR(1)) S Y=0;1"
"RTN","LRAUDA",54,0)
 S DR(3,63.24)=".01;S:'$P(^LAB(61.5,X,0),U,3) Y=0;.02"
"RTN","LRAUDA",55,0)
 S DR(4,63.23)=".01",LRSOP="B"
"RTN","LRAUDA",56,0)
 Q
"RTN","LRAUDA",57,0)
 ;
"RTN","LRAUDA",58,0)
A ;Autopsy Report/ICDCM Coding
"RTN","LRAUDA",59,0)
 D L
"RTN","LRAUDA",60,0)
 I LRQUIT D END Q
"RTN","LRAUDA",61,0)
 D ADR
"RTN","LRAUDA",62,0)
 S LRSOP="A"
"RTN","LRAUDA",63,0)
 D EDIT
"RTN","LRAUDA",64,0)
 Q
"RTN","LRAUDA",65,0)
ADR ;Entry for resetting DR string
"RTN","LRAUDA",66,0)
 K DR S DR="13;13.01///^S X=LRWHO;32.1;32.2;32.3;99;"_$S($G(LRCDSYS)=30:"D EN^LRAPICD(LRDXV)",1:80)
"RTN","LRAUDA",67,0)
 Q
"RTN","LRAUDA",68,0)
R ;Autopsy Supplementary Report
"RTN","LRAUDA",69,0)
 D L
"RTN","LRAUDA",70,0)
 I LRQUIT D END Q
"RTN","LRAUDA",71,0)
 S LRSOP="R",LRSFLG="S"
"RTN","LRAUDA",72,0)
 D EDIT
"RTN","LRAUDA",73,0)
 K LRSFLG
"RTN","LRAUDA",74,0)
 Q
"RTN","LRAUDA",75,0)
I ;ICDCM coding
"RTN","LRAUDA",76,0)
 D L
"RTN","LRAUDA",77,0)
 I LRQUIT D END Q
"RTN","LRAUDA",78,0)
 I '$D(Y) D END Q
"RTN","LRAUDA",79,0)
 S DR=$S($G(LRCDSYS)=30:"D EN^LRAPICD(LRDXV)",1:80),LRSOP="I"
"RTN","LRAUDA",80,0)
 D EDIT
"RTN","LRAUDA",81,0)
 Q
"RTN","LRAUDA",82,0)
F ;Final Anatomic DX Date
"RTN","LRAUDA",83,0)
 D L
"RTN","LRAUDA",84,0)
 I LRQUIT D END Q
"RTN","LRAUDA",85,0)
 K DR S DR="13.1;83.1;83.2"
"RTN","LRAUDA",86,0)
 S LRSOP="F"
"RTN","LRAUDA",87,0)
 D EDIT
"RTN","LRAUDA",88,0)
 Q
"RTN","LRAUDA",89,0)
VMSG ;Verified message
"RTN","LRAUDA",90,0)
 N LRMSG
"RTN","LRAUDA",91,0)
 S LRMSG=$C(7)_"Report verified.  Cannot edit with this option."
"RTN","LRAUDA",92,0)
 D EN^DDIOL(LRMSG,"","!!")
"RTN","LRAUDA",93,0)
 Q
"RTN","LRAUDA",94,0)
EDIT ;
"RTN","LRAUDA",95,0)
 D ^LRAPDA
"RTN","LRAUDA",96,0)
END ;
"RTN","LRAUDA",97,0)
 K LRQUIT
"RTN","LRAUDA",98,0)
 D V^LRU
"RTN","LRAUDA",99,0)
 Q
"RTN","LRAUSICD")
0^9^B6291180^B4216631
"RTN","LRAUSICD",1,0)
LRAUSICD ;AVAMC/REG - AUTOPSY ICD SEARCH ;8/15/95  09:01
"RTN","LRAUSICD",2,0)
 ;;5.2;LAB SERVICE;**72,253,315,422**;Sep 27, 1994;Build 29
"RTN","LRAUSICD",3,0)
 ;
"RTN","LRAUSICD",4,0)
 ; Reference to $$CSI^ICDEX supported by ICR #5747
"RTN","LRAUSICD",5,0)
 ; Reference to $$SINFO^ICDEX supported by ICR #5747
"RTN","LRAUSICD",6,0)
 ; Reference to $$ICDDX^ICDEX supported by ICR #5747
"RTN","LRAUSICD",7,0)
 ;
"RTN","LRAUSICD",8,0)
 S IOP="HOME" D ^%ZIS W @IOF,?20,LRO(68)," SEARCH BY ICD CODE"
"RTN","LRAUSICD",9,0)
ASK W ! D B^LRU Q:Y<0
"RTN","LRAUSICD",10,0)
 N LR,VAR,ICDFMT,ICDSYS
"RTN","LRAUSICD",11,0)
 S Y=$$IMP^ICDEX(30) S LR("I10DTI")=Y X ^DD("DD") S LR("I10DTE")=Y
"RTN","LRAUSICD",12,0)
 I (LRSDT<LR("I10DTI")),(LRLDT'<LR("I10DTI")) D  G ASK
"RTN","LRAUSICD",13,0)
 . W !!,$C(7),"Beginning and Ending dates must both be prior to "_LR("I10DTE")_"(ICD-9)"
"RTN","LRAUSICD",14,0)
 . W !,"or both be on or after "_LR("I10DTE")_"(ICD-10)."
"RTN","LRAUSICD",15,0)
 S ICDFMT=$S(LRSDT<LR("I10DTI"):1,1:2)
"RTN","LRAUSICD",16,0)
 S ICDSYS=+$$SINFO^ICDEX("DIAG",LRLDT)
"RTN","LRAUSICD",17,0)
 S LRSDT=LRSDT-.01,LRLDT=LRLDT+.99
"RTN","LRAUSICD",18,0)
 S DIC("A")="Select ICD Diagnosis: "
"RTN","LRAUSICD",19,0)
 S DIC=80,DIC(0)="AEQMZ" D ^DIC K DIC G:+Y<1 ASK D
"RTN","LRAUSICD",20,0)
 . S N=+Y,I(1)=$P(Y(0),U,1),I=$P($$ICDDX^ICDEX(I(1),LRLDT,,"E"),"^",4)
"RTN","LRAUSICD",21,0)
 S ZTRTN="QUE^LRAUSICD" D BEG^LRUTL Q:POP!($D(ZTSK))
"RTN","LRAUSICD",22,0)
QUE U IO D S^LRU K ^TMP($J) S LRPAT1=0,^TMP($J,0,1)="ICD CODE: "_I(1)_"  "_I,^TMP($J,0)=I(1)_"^"_I_"^"_LRO(68)_"^"_"ICD CODE"
"RTN","LRAUSICD",23,0)
 F X=0:0 S LRSDT=$O(^LR("AAU",LRSDT)) Q:'LRSDT!(LRSDT>LRLDT)  D LRDFN
"RTN","LRAUSICD",24,0)
 D ^LRAUS K ^TMP($J) D END^LRUTL Q
"RTN","LRAUSICD",25,0)
LRDFN S LRDFN=0 F LRPAT1=0:1 S LRDFN=$O(^LR("AAU",LRSDT,LRDFN)) Q:'LRDFN  D SN
"RTN","LRAUSICD",26,0)
 Q
"RTN","LRAUSICD",27,0)
SN Q:$P($P($G(^LR(LRDFN,"AU")),U,6)," ")'=LRABV  Q:'$D(^LR(LRDFN,80,N,0))!('$D(^LR(LRDFN,0))#2)  S LRAU=^("AU"),LRAD=$P(LRAU,"^")
"RTN","LRAUSICD",28,0)
 S LRDPF=$P(^LR(LRDFN,0),U,2),DFN=$P(^(0),U,3),LRPF=^DIC(LRDPF,0,"GL"),LRFLN=+$P(@(LRPF_"0)"),"^",2) Q:'$D(@(LRPF_DFN_",0)"))
"RTN","LRAUSICD",29,0)
 S LRPPT=@(LRPF_DFN_",0)"),LRP=$P(LRPPT,"^"),SSN=$P(LRPPT,"^",9),SEX=$P(LRPPT,"^",2),DOB=$P(LRPPT,"^",3) D SSN^LRU
"RTN","LRAUSICD",30,0)
 S LRYR=$E($P(LRAU,"^"),1,3),LRAC=$P(LRAU,"^",6),LRAN=+$P(LRAC," ",3)
"RTN","LRAUSICD",31,0)
 S X1=$P(LRAU,"^"),X2=DOB D ^%DTC S AGE=X\365.25
"RTN","LRAUSICD",32,0)
 S:AGE<1 AGE="<1"
"RTN","LRAUSICD",33,0)
 S ^TMP($J,LRYR,LRAN)=LRAC_"^"_AGE_"^"_SEX_"^"_LRP_"^"_SSN(1)_"^"_+$E($P(LRAU,"^"),4,5)_"/"_+$E($P(LRAU,"^"),6,7)
"RTN","LRAUSICD",34,0)
 Q
"RTN","LRSPRPT1")
0^7^B10863662^B10719224
"RTN","LRSPRPT1",1,0)
LRSPRPT1 ;AVAMC/REG/WTY - SURG PATH RPT PRINT CONT. ;10/16/01
"RTN","LRSPRPT1",2,0)
 ;;5.2;LAB SERVICE;**1,259,315,422**;Sep 27, 1994;Build 29
"RTN","LRSPRPT1",3,0)
 ;
"RTN","LRSPRPT1",4,0)
 ;25-Jul-01;WTY;In line tag L, if being called by LRAPT2, don't do
"RTN","LRSPRPT1",5,0)
 ;              line tag F.  Do H1^LRAPT2 instead.
"RTN","LRSPRPT1",6,0)
 ;21-Aug-01;WTY;Removed call to LRSPRPT2 which prints SNOMED codes.
"RTN","LRSPRPT1",7,0)
 ; Reference to $$ICDDX^ICDEX supported by ICR #5747
"RTN","LRSPRPT1",8,0)
 ;
"RTN","LRSPRPT1",9,0)
 S A=0 F  S A=+$O(^LR(LRDFN,LRSS,LRI,2,A)) Q:'A!(LR("Q"))  D
"RTN","LRSPRPT1",10,0)
 .S T=+^LR(LRDFN,LRSS,LRI,2,A,0),X=$S($D(^LAB(61,T,0)):^(0),1:"")
"RTN","LRSPRPT1",11,0)
 .S T(1)=$P(X,"^"),T(8)=$P(X,"^",2)
"RTN","LRSPRPT1",12,0)
 .D SP Q:LR("Q")
"RTN","LRSPRPT1",13,0)
 .D T
"RTN","LRSPRPT1",14,0)
 Q:LR("Q")
"RTN","LRSPRPT1",15,0)
 I $D(LRS(99)),'+$G(LR("SPSM")) D ^LRSPRPT2
"RTN","LRSPRPT1",16,0)
 Q:LR("Q")
"RTN","LRSPRPT1",17,0)
 I $D(LRS(99)) W ! D
"RTN","LRSPRPT1",18,0)
 .S A=0 F  S A=$O(^LR(LRDFN,LRSS,LRI,3,A)) Q:'A!(LR("Q"))  D
"RTN","LRSPRPT1",19,0)
 ..D:$Y>(IOSL-12) F Q:LR("Q")
"RTN","LRSPRPT1",20,0)
 ..S X=+^LR(LRDFN,LRSS,LRI,3,A,0)
"RTN","LRSPRPT1",21,0)
 ..N LRX
"RTN","LRSPRPT1",22,0)
 ..S LRX=X,LRX=$$ICDDX^ICDEX(LRX,,,"I")
"RTN","LRSPRPT1",23,0)
 ..S X=$P(LRX,U,4)
"RTN","LRSPRPT1",24,0)
 ..W !,"ICD code: ",$P(LRX,U,2),?20 D:LR(69.2,.05) C^LRUA W X
"RTN","LRSPRPT1",25,0)
 Q
"RTN","LRSPRPT1",26,0)
SP ;
"RTN","LRSPRPT1",27,0)
 S C=0 F  S C=$O(^LR(LRDFN,LRSS,LRI,2,A,5,C)) Q:'C!(LR("Q"))  D
"RTN","LRSPRPT1",28,0)
 .S T(3)=^LR(LRDFN,LRSS,LRI,2,A,5,C,0)
"RTN","LRSPRPT1",29,0)
 .S Y=$P(T(3),"^",2),E=$P(T(3),"^",3)
"RTN","LRSPRPT1",30,0)
 .S T(4)=$P(T(3),"^")_":",T(4)=$P($P(LR(LRSS),T(4),2),";",1)
"RTN","LRSPRPT1",31,0)
 .D D^LRU S T(2)=Y
"RTN","LRSPRPT1",32,0)
 .D:$Y>(IOSL-12) F Q:LR("Q")  D WP
"RTN","LRSPRPT1",33,0)
 Q
"RTN","LRSPRPT1",34,0)
WP ;
"RTN","LRSPRPT1",35,0)
 W !!,T(4)," ",E," Date: ",T(2)," ",!,T(1),!
"RTN","LRSPRPT1",36,0)
 D E S B=0
"RTN","LRSPRPT1",37,0)
 F LRZ=0:1 S B=$O(^LR(LRDFN,LRSS,LRI,2,A,5,C,1,B)) Q:'B!(LR("Q"))  D
"RTN","LRSPRPT1",38,0)
 .D:$Y>(IOSL-12) F Q:LR("Q")
"RTN","LRSPRPT1",39,0)
 .S X=^LR(LRDFN,LRSS,LRI,2,A,5,C,1,B,0) D ^DIWP
"RTN","LRSPRPT1",40,0)
 Q:LR("Q")  D:LRZ ^DIWW
"RTN","LRSPRPT1",41,0)
 Q
"RTN","LRSPRPT1",42,0)
E ;
"RTN","LRSPRPT1",43,0)
 K ^UTILITY($J) S DIWR=IOM-10,DIWL=10,DIWF="W"
"RTN","LRSPRPT1",44,0)
 Q
"RTN","LRSPRPT1",45,0)
T ;
"RTN","LRSPRPT1",46,0)
 S T(3)=T,T(4)=61 D EN
"RTN","LRSPRPT1",47,0)
 S M=0 F  S M=$O(^LR(LRDFN,LRSS,LRI,2,A,2,M)) Q:'M!(LR("Q"))  D
"RTN","LRSPRPT1",48,0)
 .S T(3)=+^LR(LRDFN,LRSS,LRI,2,A,2,M,0),T(4)=61.1 D EN Q:LR("Q")  D
"RTN","LRSPRPT1",49,0)
 ..S N=0 F  S N=$O(^LR(LRDFN,LRSS,LRI,2,A,2,M,1,N)) Q:'N!(LR("Q"))  D
"RTN","LRSPRPT1",50,0)
 ...S T(3)=+^LR(LRDFN,LRSS,LRI,2,A,2,M,1,N,0),T(4)=61.2 D EN
"RTN","LRSPRPT1",51,0)
 Q:LR("Q")
"RTN","LRSPRPT1",52,0)
 S M=0 F  S M=$O(^LR(LRDFN,LRSS,LRI,2,A,1,M)) Q:'M!(LR("Q"))  D
"RTN","LRSPRPT1",53,0)
 .S T(3)=+^LR(LRDFN,LRSS,LRI,2,A,1,M,0),T(4)=61.4 D EN
"RTN","LRSPRPT1",54,0)
 Q:LR("Q")
"RTN","LRSPRPT1",55,0)
 S M=0 F  S M=$O(^LR(LRDFN,LRSS,LRI,2,A,3,M)) Q:'M!(LR("Q"))  D
"RTN","LRSPRPT1",56,0)
 .S T(3)=+^LR(LRDFN,LRSS,LRI,2,A,3,M,0),T(4)=61.3 D EN
"RTN","LRSPRPT1",57,0)
 Q
"RTN","LRSPRPT1",58,0)
EN ;also from LRAPT2
"RTN","LRSPRPT1",59,0)
 S C(1)=0
"RTN","LRSPRPT1",60,0)
 F  S C(1)=$O(^LAB(T(4),T(3),"JR",C(1))) Q:'C(1)!(LR("Q"))  D
"RTN","LRSPRPT1",61,0)
 .I $P(^LAB(T(4),T(3),"JR",C(1),0),"^",7) S T(9)=^(0),T(5)=1 D L
"RTN","LRSPRPT1",62,0)
 Q
"RTN","LRSPRPT1",63,0)
L ;
"RTN","LRSPRPT1",64,0)
 S X=$O(^LAB(T(4),T(3),"JR",C(1),1,0))
"RTN","LRSPRPT1",65,0)
 I X K T(5) D
"RTN","LRSPRPT1",66,0)
 .S X=0 F  S X=$O(^LAB(T(4),T(3),"JR",C(1),1,X)) Q:'X  D
"RTN","LRSPRPT1",67,0)
 ..S Y=$P(^LAB(T(4),T(3),"JR",C(1),1,X,0),"^")
"RTN","LRSPRPT1",68,0)
 ..I Y=$E(T(8),1,$L(Y)) S T(5)=1
"RTN","LRSPRPT1",69,0)
 Q:'$D(T(5))
"RTN","LRSPRPT1",70,0)
 D PGCHK
"RTN","LRSPRPT1",71,0)
 Q:LR("Q")
"RTN","LRSPRPT1",72,0)
 W ! D PGCHK Q:LR("Q")
"RTN","LRSPRPT1",73,0)
 W !,"Reference: "
"RTN","LRSPRPT1",74,0)
 D PGCHK Q:LR("Q")
"RTN","LRSPRPT1",75,0)
 W !,$P(T(9),"^")
"RTN","LRSPRPT1",76,0)
 D PGCHK Q:LR("Q")
"RTN","LRSPRPT1",77,0)
 W !,$P(T(9),"^",2)
"RTN","LRSPRPT1",78,0)
 D PGCHK Q:LR("Q")
"RTN","LRSPRPT1",79,0)
 W !
"RTN","LRSPRPT1",80,0)
 I $P(T(9),"^",3) D
"RTN","LRSPRPT1",81,0)
 .W $P(^LAB(95,$P(T(9),"^",3),0),"^"),"  vol.",$P(T(9),"^",4)
"RTN","LRSPRPT1",82,0)
 .W " pg.",$P(T(9),"^",5)
"RTN","LRSPRPT1",83,0)
 S Y=$P(T(9),"^",6) D D^LRU W "  Date: ",Y
"RTN","LRSPRPT1",84,0)
 Q
"RTN","LRSPRPT1",85,0)
F ;
"RTN","LRSPRPT1",86,0)
 D F^LRAPF,^LRAPF
"RTN","LRSPRPT1",87,0)
 Q
"RTN","LRSPRPT1",88,0)
PGCHK ;
"RTN","LRSPRPT1",89,0)
 I $Y>(IOSL-12) D
"RTN","LRSPRPT1",90,0)
 .I LRSS="AU" D  Q
"RTN","LRSPRPT1",91,0)
 ..I '+$G(LRSF515) D H1^LRAPT Q
"RTN","LRSPRPT1",92,0)
 ..D:+$G(LRSF515) FT^LRAURPT,H^LRAURPT
"RTN","LRSPRPT1",93,0)
 .D F
"RTN","LRSPRPT1",94,0)
 Q
"RTN","LRSPRPT1",95,0)
END ;
"RTN","LRSPRPT1",96,0)
 W $C(7),!!,"OK TO DELETE THE ",LRAA(1)," FINAL REPORT LIST"
"RTN","LRSPRPT1",97,0)
 S %=2 D YN^LRU
"RTN","LRSPRPT1",98,0)
 I %=1 K ^LRO(69.2,LRAA,2) S ^LRO(69.2,LRAA,2,0)="^69.23A^0^0" D  Q
"RTN","LRSPRPT1",99,0)
 .W $C(7),!,"LIST DELETED !"
"RTN","LRSPRPT1",100,0)
 W !!,"FINE, LET'S FORGET IT",!
"RTN","LRSPRPT1",101,0)
 Q
"RTN","LRSPSICD")
0^10^B7174339^B4454107
"RTN","LRSPSICD",1,0)
LRSPSICD ;AVAMC/REG - CY/EM/SP ICD SEARCH ;8/15/95  08:39
"RTN","LRSPSICD",2,0)
 ;;5.2;LAB SERVICE;**72,253,315,422**;Sep 27, 1994;Build 29
"RTN","LRSPSICD",3,0)
 ;
"RTN","LRSPSICD",4,0)
 ; Reference to $$CSI^ICDEX supported by ICR #5747
"RTN","LRSPSICD",5,0)
 ; Reference to $$SINFO^ICDEX supported by ICR #5747
"RTN","LRSPSICD",6,0)
 ; Reference to $$ICDDX^ICDEX supported by ICR #5747
"RTN","LRSPSICD",7,0)
 ;
"RTN","LRSPSICD",8,0)
 W @IOF,!?20,LRO(68)," SEARCH BY ICD CODE"
"RTN","LRSPSICD",9,0)
ASK W ! D B^LRU Q:Y<0
"RTN","LRSPSICD",10,0)
 N LR,VAR,ICDFMT,ICDSYS
"RTN","LRSPSICD",11,0)
 S Y=$$IMP^ICDEX(30) S LR("I10DTI")=Y X ^DD("DD") S LR("I10DTE")=Y
"RTN","LRSPSICD",12,0)
 I (LRSDT<LR("I10DTI")),(LRLDT'<LR("I10DTI")) D  G ASK
"RTN","LRSPSICD",13,0)
 . W !!,$C(7),"Beginning and Ending dates must both be prior to "_LR("I10DTE")_"(ICD-9)"
"RTN","LRSPSICD",14,0)
 . W !,"or both be on or after "_LR("I10DTE")_"(ICD-10)."
"RTN","LRSPSICD",15,0)
 S ICDFMT=$S(LRSDT<LR("I10DTI"):1,1:2)
"RTN","LRSPSICD",16,0)
 S ICDSYS=+$$SINFO^ICDEX("DIAG",LRLDT)
"RTN","LRSPSICD",17,0)
 S LRSDT=LRSDT-.01,LRLDT=LRLDT+.99
"RTN","LRSPSICD",18,0)
 S DIC("A")="Select ICD Diagnosis: "
"RTN","LRSPSICD",19,0)
 S DIC=80,DIC(0)="AEMQZ" D ^DIC K DIC G:+Y<1 ASK
"RTN","LRSPSICD",20,0)
 N LRX
"RTN","LRSPSICD",21,0)
 S N=+Y,(LRX,I(1))=$P(Y(0),U),I=$P($$ICDDX^ICDEX(LRX,LRLDT,,"E"),U,4)
"RTN","LRSPSICD",22,0)
 S ZTRTN="QUE^LRSPSICD" D BEG^LRUTL Q:POP!($D(ZTSK))
"RTN","LRSPSICD",23,0)
QUE U IO K ^TMP($J) D L^LRU,S^LRU,XR^LRU
"RTN","LRSPSICD",24,0)
 S ^TMP($J,0)=I(1)_"^"_I_"^"_LRO(68)_"^"_"ICD CODE"
"RTN","LRSPSICD",25,0)
 F X=0:0 S LRSDT=$O(^LR(LRXR,LRSDT)) Q:'LRSDT!(LRSDT>LRLDT)  D L
"RTN","LRSPSICD",26,0)
 D ^LRSPSICP K ^TMP($J) D K^LRU,END^LRUTL Q
"RTN","LRSPSICD",27,0)
L F LRDFN=0:0 S LRDFN=$O(^LR(LRXR,LRSDT,LRDFN)) Q:'LRDFN  D I
"RTN","LRSPSICD",28,0)
 Q
"RTN","LRSPSICD",29,0)
I F LRI=0:0 S LRI=$O(^LR(LRXR,LRSDT,LRDFN,LRI)) Q:'LRI  D TO
"RTN","LRSPSICD",30,0)
 Q
"RTN","LRSPSICD",31,0)
TO N FN
"RTN","LRSPSICD",32,0)
 S FN=0
"RTN","LRSPSICD",33,0)
 Q:$P($P($G(^LR(LRDFN,LRSS,LRI,0)),U,6)," ")'=LRABV  D DXS Q:'FN
"RTN","LRSPSICD",34,0)
 S LREP=^LR(LRDFN,LRSS,LRI,0),H(2)=$E($P(LREP,"^",10),1,3)
"RTN","LRSPSICD",35,0)
 S LRAC=$P(LREP,"^",6),LRAN=+$P(LRAC," ",3)
"RTN","LRSPSICD",36,0)
PRT S LRPF=^DIC($P(^LR(LRDFN,0),"^",2),0,"GL"),LRFLN=+$P(@(LRPF_"0)"),"^",2),DFN=$P(^LR(LRDFN,0),"^",3),LRDPF=$P(^(0),U,2) Q:'$D(@(LRPF_DFN_",0)"))
"RTN","LRSPSICD",37,0)
 S LRPPT=@(LRPF_DFN_",0)"),LRP=$P(LRPPT,"^"),SSN=$P(LRPPT,"^",9),SEX=$P(LRPPT,"^",2),DOB=$P(LRPPT,"^",3),X1=$P(LREP,"^"),X2=DOB D ^%DTC,SSN^LRU S AGE=X\365.25
"RTN","LRSPSICD",38,0)
 S:AGE>110!(AGE<10) AGE="?"
"RTN","LRSPSICD",39,0)
 S ^TMP($J,H(2),LRAN)=LRAC_U_AGE_U_SEX_U_LRP_U_SSN(1)_U_+$E($P(LREP,U,10),4,5)_"/"_$E($P(LREP,U,10),6,7),^TMP($J,"B",LRP,H(2),LRAN)=""
"RTN","LRSPSICD",40,0)
HERE Q
"RTN","LRSPSICD",41,0)
 ;
"RTN","LRSPSICD",42,0)
DXS N DX,DXS
"RTN","LRSPSICD",43,0)
 S DX=0 F  S DX=$O(^LR(LRDFN,LRSS,LRI,3,DX)) Q:'DX  S DXS=+$G(^(DX,0)) I DXS=N S FN=1 Q
"RTN","LRSPSICD",44,0)
 Q
"RTN","LRSPSICP")
0^11^B6145397^B6145447
"RTN","LRSPSICP",1,0)
LRSPSICP ;AVAMC/REG - SEARCH BY ICD CODE PRINT ;8/15/95  08:50 ;
"RTN","LRSPSICP",2,0)
 ;;5.2;LAB SERVICE;**72,422**;Sep 27, 1994;Build 29
"RTN","LRSPSICP",3,0)
 S N=0 D H,H1 S LR("F")=1
"RTN","LRSPSICP",4,0)
 F A=0:1 S N=$O(^TMP($J,"B",N)) Q:N=""!(LR("Q"))  S V(2)=$O(^(N,0)),V(3)=$O(^(V(2),0)),V=^TMP($J,V(2),V(3)) D:$Y>(IOSL-6) H,H1 Q:LR("Q")  W !,$E(N,1,18),?19,$P(V,"^",5),?25,$P(V,"^",3) D A
"RTN","LRSPSICP",5,0)
 S H(2)=1 D H,H2 Q:LR("Q")  D L
"RTN","LRSPSICP",6,0)
 Q
"RTN","LRSPSICP",7,0)
A S H(2)=0 F B=0:1 S H(2)=$O(^TMP($J,"B",N,H(2))) Q:'H(2)!(LR("Q"))  D ABC
"RTN","LRSPSICP",8,0)
 Q
"RTN","LRSPSICP",9,0)
ABC S LRAN=0 F C=0:1 S LRAN=$O(^TMP($J,"B",N,H(2),LRAN)) Q:'LRAN!(LR("Q"))  D PRT
"RTN","LRSPSICP",10,0)
 Q
"RTN","LRSPSICP",11,0)
PRT S V=^TMP($J,H(2),LRAN) W:C>0 ! W ?27,$P(V,"^",2) W ?31,$J($P(V,"^"),7),?39,$E($P(V,"^",8),1,18)
"RTN","LRSPSICP",12,0)
 S O=0 F Z=1:1 S O=$O(^TMP($J,H(2),LRAN,O)) Q:'O!(LR("Q"))  D:$Y>(IOSL-6) H3 Q:LR("Q")  W:Z>1 ! W ?58,$E(^(O),1,21)
"RTN","LRSPSICP",13,0)
 Q
"RTN","LRSPSICP",14,0)
L F B=0:1 S H(2)=$O(^TMP($J,H(2))) Q:'H(2)!(LR("Q"))  D LRAN
"RTN","LRSPSICP",15,0)
 Q
"RTN","LRSPSICP",16,0)
LRAN S LRAN=0 F C=0:1 S LRAN=$O(^TMP($J,H(2),LRAN)) Q:'LRAN!(LR("Q"))  D PT
"RTN","LRSPSICP",17,0)
 Q
"RTN","LRSPSICP",18,0)
PT D:$Y>(IOSL-6) H,H2 Q:LR("Q")
"RTN","LRSPSICP",19,0)
 S V=^TMP($J,H(2),LRAN) W !,$J($P(V,"^"),7),?9,$E($P(V,"^",4),1,18),?28,$P(V,"^",5),?34,$P(V,"^",3),?37,$J($P(V,"^",2),3),?41
"RTN","LRSPSICP",20,0)
 W $J($P(V,"^",6),5),?47,$E($P(V,"^",8),1,15) S O=-1 F Z=1:1 S O=$O(^TMP($J,H(2),LRAN,O)) Q:'O!(LR("Q"))  D:$Y>(IOSL-6) H4 Q:LR("Q")  W:Z>1 ! W ?65,$E(^(O),1,14)
"RTN","LRSPSICP",21,0)
 Q
"RTN","LRSPSICP",22,0)
H I $D(LR("F")),IOST?1"C".E D M^LRU Q:LR("Q")
"RTN","LRSPSICP",23,0)
 D F^LRU W !,LRO(68)," SEARCH (",LRSTR,"=>",LRLST,")"
"RTN","LRSPSICP",24,0)
 W !!,"ICD CODE: ",I(1),?20,I
"RTN","LRSPSICP",25,0)
 W !,LR("%") Q
"RTN","LRSPSICP",26,0)
H1 Q:LR("Q")  W !!,?8,"NAME",?19,"ID",?23,"SEX",?27,"AGE",?32,"ACC #",!! Q
"RTN","LRSPSICP",27,0)
H2 Q:LR("Q")  W !!,"ACC #",?9,"NAME",?28,"ID",?33,"SEX",?37,"AGE",?41,"MO/DA" Q
"RTN","LRSPSICP",28,0)
H3 D H,H1 Q:LR("Q")  W !,$E(N,1,18),?19,$P(V,"^",5),?25,$P(V,"^",3),?27,$P(V,"^",2),?31,$J($P(V,"^"),7) Q
"RTN","LRSPSICP",29,0)
H4 D H,H2 Q:LR("Q")  W !,$J($P(V,"^"),7),?9,$E($P(V,"^",4),1,18),?28,$P(V,"^",5),?34,$P(V,"^",3),?37,$J($P(V,"^",2),3),?41,$J($P(V,"^",6),5) Q
"RTN","LRU")
0^13^B45238843^B44711331
"RTN","LRU",1,0)
LRU ;DALOI/STAFF - LAB UTILITY ;05/11/10  15:14
"RTN","LRU",2,0)
 ;;5.2;LAB SERVICE;**1,72,201,248,350,422**;Sep 27, 1994;Build 29
"RTN","LRU",3,0)
 ;
"RTN","LRU",4,0)
 ;Reference to ^DIC(4 supported by IA #10090
"RTN","LRU",5,0)
 ;Reference to ^XMB(1 supported by IA #10091
"RTN","LRU",6,0)
 ;Reference to ^VA(200 supported by IA #10060
"RTN","LRU",7,0)
 ;Reference to ^%DT supported by IA #10003
"RTN","LRU",8,0)
 ;Reference to ^%ZIS supported by IA #10086
"RTN","LRU",9,0)
 ;Reference to ^DIC supported by IA #10006
"RTN","LRU",10,0)
 ;Reference to ^DIE supported by IA #10018
"RTN","LRU",11,0)
 ;Reference to PID^VADPT6 supported by IA #10062
"RTN","LRU",12,0)
 ;Reference to $$FMTE^XLFDT supported by IA #10103
"RTN","LRU",13,0)
 ;
"RTN","LRU",14,0)
 S X="T",%DT="" D ^%DT,D S H(10)=Y
"RTN","LRU",15,0)
 Q
"RTN","LRU",16,0)
 ;
"RTN","LRU",17,0)
 ;
"RTN","LRU",18,0)
LOCK ;Set and kill lock for ^DIE call. If lock fails LR("CK")=1 is set.
"RTN","LRU",19,0)
 N LRLOKVAR
"RTN","LRU",20,0)
 I '$D(DIE) S LR("CK")=1 Q
"RTN","LRU",21,0)
 D CK I '$G(LR("CK")) D ^DIE K LR("CK") D FRE
"RTN","LRU",22,0)
 Q
"RTN","LRU",23,0)
 ;
"RTN","LRU",24,0)
 ;
"RTN","LRU",25,0)
CK ;
"RTN","LRU",26,0)
 D:$D(LRLOKVAR)#2 FRE
"RTN","LRU",27,0)
 S LRLOKVAR=DIE_DA_")" L +@(LRLOKVAR):DILOCKTM
"RTN","LRU",28,0)
 I '$T D
"RTN","LRU",29,0)
 . W !,$C(7),"ANOTHER TERMINAL IS EDITING THIS ENTRY!" S LR("CK")=1
"RTN","LRU",30,0)
 . K LRLOKVAR
"RTN","LRU",31,0)
 Q
"RTN","LRU",32,0)
 ;
"RTN","LRU",33,0)
 ;
"RTN","LRU",34,0)
FRE I $D(LRLOKVAR) L -@(LRLOKVAR) K LRLOKVAR
"RTN","LRU",35,0)
 Q
"RTN","LRU",36,0)
 ;
"RTN","LRU",37,0)
F ;
"RTN","LRU",38,0)
 S LRQ=LRQ+1,X="N",%DT="T" D ^%DT,D^LRU
"RTN","LRU",39,0)
 ;Suppress unnecessary form feeds
"RTN","LRU",40,0)
 I $G(LRSS)'="BB" W:IOST?1"C".E!($D(LR("F"))) @IOF
"RTN","LRU",41,0)
 W:$G(LRSS)="BB" @IOF
"RTN","LRU",42,0)
 W !,Y,?22,LRQ(1),?(IOM-10),"Pg: ",LRQ
"RTN","LRU",43,0)
 Q
"RTN","LRU",44,0)
 ;
"RTN","LRU",45,0)
 ;
"RTN","LRU",46,0)
M R !,"'^' TO STOP: ",X:DTIME S:'$T!(X["^") LR("Q")=1
"RTN","LRU",47,0)
 W $C(13),$J("",15),$C(13)
"RTN","LRU",48,0)
 Q
"RTN","LRU",49,0)
 ;
"RTN","LRU",50,0)
 ;
"RTN","LRU",51,0)
T ; Returns the Month/Day
"RTN","LRU",52,0)
 Q:'Y  S Y=Y_"000",Y=$E(Y,4,5)_"/"_$E(Y,6,7)_$S(Y[".":" "_$E(Y,9,10)_":"_$E(Y,11,12),1:"")
"RTN","LRU",53,0)
 Q
"RTN","LRU",54,0)
 ;
"RTN","LRU",55,0)
 ;
"RTN","LRU",56,0)
A ; Returns Date in format mm/dd/yyyy with time if a time is passed.
"RTN","LRU",57,0)
 Q:'Y  S Y=$$FMTE^XLFDT(Y,"5M")
"RTN","LRU",58,0)
 I $L($P(Y,"/"))=1 S $P(Y,"/")="0"_$P(Y,"/") ;--> pad for 2 digit day
"RTN","LRU",59,0)
 I $L($P(Y,"/",2))=1 S $P(Y,"/",2)="0"_$P(Y,"/",2) ;--> pad for 2 digit month
"RTN","LRU",60,0)
 Q
"RTN","LRU",61,0)
 ;
"RTN","LRU",62,0)
 ;
"RTN","LRU",63,0)
D ; Returns date in eye-readable month format
"RTN","LRU",64,0)
 S Y=$TR($$FMTE^XLFDT(Y,"M"),"@"," ")
"RTN","LRU",65,0)
 Q
"RTN","LRU",66,0)
 ;
"RTN","LRU",67,0)
 ;
"RTN","LRU",68,0)
DA ; Returns date in eye-readable month format
"RTN","LRU",69,0)
 S Y=$$FMTE^XLFDT(Y,"M")
"RTN","LRU",70,0)
 Q
"RTN","LRU",71,0)
 ;
"RTN","LRU",72,0)
 ;
"RTN","LRU",73,0)
DT ; If Blood Bank maintain existing display, else display 4 digit year.
"RTN","LRU",74,0)
 I $G(LRSS)="BB" S Y=Y_"000",Y=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3)_" "_$S(Y[".":$E(Y,9,10)_":"_$E(Y,11,12),1:"") Q
"RTN","LRU",75,0)
 D A
"RTN","LRU",76,0)
 Q
"RTN","LRU",77,0)
 ;
"RTN","LRU",78,0)
 ;
"RTN","LRU",79,0)
SSN ;
"RTN","LRU",80,0)
 S (SSN,SSN(1),SSN(2))=$G(SSN)
"RTN","LRU",81,0)
 I '$G(LRDPF),$G(LRDFN) S:$P($G(^LR(+LRDFN,0)),U,2) LRDPF=+$P(^(0),U,2)
"RTN","LRU",82,0)
 S (VA("BID"),VA("PID"))="" G:'$G(LRDPF)!(+$G(LRDPF)'=2) SSNFM
"RTN","LRU",83,0)
 N I,X,Y,N
"RTN","LRU",84,0)
 I $D(DFN) D PID^VADPT6 S (SSN,SSN(2))=VA("PID"),SSN(1)=VA("BID")
"RTN","LRU",85,0)
 ;
"RTN","LRU",86,0)
SSNFM ;
"RTN","LRU",87,0)
 S SSN(2)=$TR(SSN,"-","")
"RTN","LRU",88,0)
 ;I $G(DUZ("AG"))'="","NAFARMY"[DUZ("AG") D  Q
"RTN","LRU",89,0)
 ;. S SSN=$S($L(SSN)<11:$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,10),1:$E(SSN,10,11)_"/"_$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,9))
"RTN","LRU",90,0)
 ;. S SSN(1)=$S($P(SSN,"-",3):$P(SSN,"-",3),1:$E(SSN,9,12))
"RTN","LRU",91,0)
 ;
"RTN","LRU",92,0)
 ; Setup identifier for PATIENT (#2) file related entry
"RTN","LRU",93,0)
 I $G(LRDPF)=2,$G(DFN)="" D
"RTN","LRU",94,0)
 . S:$L(SSN)>8 SSN=$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,99)
"RTN","LRU",95,0)
 . S SSN(1)=$S($P(SSN,"-",3):$P(SSN,"-",3),$L($E(SSN,($L(SSN)-3),$L(SSN))):$E(SSN,($L(SSN)-3),$L(SSN)),1:"????")
"RTN","LRU",96,0)
 . S:'$L(SSN) SSN="?"
"RTN","LRU",97,0)
 ;
"RTN","LRU",98,0)
 ; Setup identifier for non-PATIENT (#2) file related entry
"RTN","LRU",99,0)
 I $G(LRDPF)'=2 D
"RTN","LRU",100,0)
 . I SSN?9N.1A S SSN=$E(SSN,1,3)_"-"_$E(SSN,4,5)_"-"_$E(SSN,6,99)
"RTN","LRU",101,0)
 . S SSN(1)=$S($P(SSN,"-",3):$P(SSN,"-",3),$L($E(SSN,($L(SSN)-3),$L(SSN))):$E(SSN,($L(SSN)-3),$L(SSN)),1:"????")
"RTN","LRU",102,0)
 ;
"RTN","LRU",103,0)
 I SSN="" S SSN="?"
"RTN","LRU",104,0)
 ;
"RTN","LRU",105,0)
 Q
"RTN","LRU",106,0)
 ;
"RTN","LRU",107,0)
 ;
"RTN","LRU",108,0)
B D LRU S %DT="AEX",%DT(0)="-N",%DT("A")="Start with Date TODAY// " D ^%DT K %DT I X="" S Y=DT W H(10)
"RTN","LRU",109,0)
 Q:Y<1  S LRSDT=Y
"RTN","LRU",110,0)
 S %DT="AEX",%DT("A")="Go    to   Date TODAY// " D ^%DT K %DT I X="" S Y=DT W H(10)
"RTN","LRU",111,0)
 Q:Y<1  S LRLDT=Y I LRSDT>LRLDT S X=LRSDT,LRSDT=LRLDT,LRLDT=X
"RTN","LRU",112,0)
 S Y=LRSDT D D^LRU S LRSTR=Y,Y=LRLDT D D^LRU S LRLST=Y
"RTN","LRU",113,0)
 Q
"RTN","LRU",114,0)
 ;
"RTN","LRU",115,0)
 ;
"RTN","LRU",116,0)
YN W "? ",$P("YES// ^NO// ","^",%) S LR("%1")=%
"RTN","LRU",117,0)
RX R %Y:$S($D(DTIME):DTIME,1:99999) E  S DTOUT=1,%Y="^" W $C(7)
"RTN","LRU",118,0)
 S:%Y]""!'% %=$A(%Y),%=$S(%=89:1,%=121:1,%=78:2,%=110:2,%=94:-1,1:0)
"RTN","LRU",119,0)
 I %Y="@"!(%Y="S") S %=-1 Q
"RTN","LRU",120,0)
 I '%,%Y]"" W $C(7),!?4,"ANSWER 'YES', 'NO', '^', '@'",!?4,"or press RETURN key to accept default response (if one)" S:$D(LR("%1")) %=LR("%1") W !! G YN
"RTN","LRU",121,0)
 W:$X>73 ! W $P("  (YES)^  (NO)","^",%) K LR("%1")
"RTN","LRU",122,0)
 Q
"RTN","LRU",123,0)
 ;
"RTN","LRU",124,0)
 ;
"RTN","LRU",125,0)
XR Q:'$D(LRSS)  S LRXR="A"_LRSS,LRXREF=LRXR_"A"
"RTN","LRU",126,0)
 Q
"RTN","LRU",127,0)
 ;
"RTN","LRU",128,0)
 ;
"RTN","LRU",129,0)
WAIT W !!,"..."
"RTN","LRU",130,0)
 W $P("HMMM^EXCUSE ME ^SORRY","^",$R(3)+1),", ",$P("THIS MAY TAKE A WHILE^LET ME PUT YOU ON 'HOLD' ^HOLD ON^JUST A MOMENT PLEASE^I'M WORKING AS FAST AS I CAN^LET ME THINK ABOUT THAT ","^",$R(6)+1)_"..."
"RTN","LRU",131,0)
 H 1
"RTN","LRU",132,0)
 Q
"RTN","LRU",133,0)
 ;
"RTN","LRU",134,0)
 ;
"RTN","LRU",135,0)
K K A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,V,W,X,Y,Z
"RTN","LRU",136,0)
 Q
"RTN","LRU",137,0)
 ;
"RTN","LRU",138,0)
 ;
"RTN","LRU",139,0)
V ; Cleanup variables
"RTN","LRU",140,0)
 ;
"RTN","LRU",141,0)
 ; Task background job to create messages
"RTN","LRU",142,0)
 I $D(^LAHM(62.49,"AC")) D
"RTN","LRU",143,0)
 . N ZTIO,ZTRTN,ZTSAVE,ZTDTH,ZTDESC,ZTSK
"RTN","LRU",144,0)
 . S ZTIO="",ZTRTN="ORU^LA7VMSG",ZTDTH=$H,ZTDESC="Send Lab LEDI HL7 Result Message to collecting site"
"RTN","LRU",145,0)
 . D ^%ZTLOAD
"RTN","LRU",146,0)
 ;
"RTN","LRU",147,0)
 D K
"RTN","LRU",148,0)
 K %,%DT,%X,%Y,A,AGE,DO,D1,DA,DE,DFN,DG,DI,DIC,DIE,DIR,DIRUT
"RTN","LRU",149,0)
 K DIWF,DIWL,DLAYGO,DOB,DR,DTOUT,DX,LR,LRA,LRAA,LRABO,LRABV
"RTN","LRU",150,0)
 K LRAC,LRAD,LRADM,LRADX,LRAN,LRAP,LRAPX,LRAU,LRAWRD,LRAX,LRB,LRBL
"RTN","LRU",151,0)
 K LRBLT,LRC,LRCAP,LRCAPA,LRCAPLOC,LRCPT,LRCS,LRD,LRDATA
"RTN","LRU",152,0)
 K LRDATE,LRDFN,LRDPAF,LRDPF,LRDTI,LRE,LREND,LREP,LREXP
"RTN","LRU",153,0)
 K LRF,LRFLN,LRFNAM,LRFND,LRG,LRH,LRI,LRIDT,LRIFN,LRJ
"RTN","LRU",154,0)
 K LRK,LRL,LRLDT,LRLIDT,LRLLOC,LRLOKVAR,LRLST,LRM
"RTN","LRU",155,0)
 K LRMD,LRN,LRND,LRNO,LRNOP,LRO,LRODT,LROLLOC,LROPT,LRORU3
"RTN","LRU",156,0)
 K LRP,LRPABO,LRPF,LRPFN,LRPMOD,LRPNM,LRPPT,LRPRAC
"RTN","LRU",157,0)
 K LRPRH,LRPTF,LRQ,LRQA,LRR,LRRB,LRRC,LRRMD,LRS,LRSA,LRSAV
"RTN","LRU",158,0)
 K LRSD,LRSDT,LRSEL,LRSET,LRSF,LRSIT,LRSN,LRSOP,LRSS,LRST
"RTN","LRU",159,0)
 K LRSTR,LRSVC,LRT,LRTK,LRTOD,LRTREA,LRTS,LRU,LRV,LRW
"RTN","LRU",160,0)
 K LRWARD,LRWD,LRWHN,LRWHO,LRWRD,LRWW,LRX,LRXR,LRXREF
"RTN","LRU",161,0)
 K LRY,LRZ,PNM,POP,SEX,SSN,VA,VADM,VAIN
"RTN","LRU",162,0)
 K ZTDESC,ZTDTH,ZTIO,ZTREQ,ZTRTN,ZTSAVE,ZTSK
"RTN","LRU",163,0)
 K ^UTILITY($J),^TMP($J),^TMP("LRBL",$J),^TMP("LR",$J)
"RTN","LRU",164,0)
 K LRICDT,LRCDSYS,ICDSYS,ICDFMT,LRDXV
"RTN","LRU",165,0)
 Q
"RTN","LRU",166,0)
 ;
"RTN","LRU",167,0)
 ;
"RTN","LRU",168,0)
LRAD ;
"RTN","LRU",169,0)
 S X=$P(^LRO(68,LRAA,0),"^",3),(Y,LRAD)=$S(X="Y":$E(Y,1,3)_"0000","M"[X:$E(Y,1,5)_"00","Q"[X:$E(Y,1,3)_"0000"+(($E(Y,4,5)-1)\3*300+100),1:Y)
"RTN","LRU",170,0)
 D D^LRU S LRH(0)=Y
"RTN","LRU",171,0)
 Q
"RTN","LRU",172,0)
 ;
"RTN","LRU",173,0)
 ;
"RTN","LRU",174,0)
H W !,$C(7),"TO SORT IN SEQUENCE, STARTING FROM A CERTAIN NAME,",!?7,"TYPE THAT NAME"
"RTN","LRU",175,0)
 Q
"RTN","LRU",176,0)
 ;
"RTN","LRU",177,0)
 ;
"RTN","LRU",178,0)
H1 W !,$C(7),"TO SORT ONLY UP TO A CERTAIN NAME,",!?7,"TYPE THAT NAME"
"RTN","LRU",179,0)
 Q
"RTN","LRU",180,0)
 ;
"RTN","LRU",181,0)
 ;
"RTN","LRU",182,0)
L ;
"RTN","LRU",183,0)
 D:'$D(IOM) I
"RTN","LRU",184,0)
 K LR("%")
"RTN","LRU",185,0)
 S LR("%")="-",$P(LR("%"),"-",IOM-1)="-"
"RTN","LRU",186,0)
 Q
"RTN","LRU",187,0)
 ;
"RTN","LRU",188,0)
 ;
"RTN","LRU",189,0)
L1 ;
"RTN","LRU",190,0)
 D:'$D(IOM) I
"RTN","LRU",191,0)
 K LR("%1")
"RTN","LRU",192,0)
 S LR("%1")="=",$P(LR("%1"),"=",IOM-1)="="
"RTN","LRU",193,0)
 Q
"RTN","LRU",194,0)
 ;
"RTN","LRU",195,0)
 ;
"RTN","LRU",196,0)
I ;
"RTN","LRU",197,0)
 S IOP="HOME" D ^%ZIS
"RTN","LRU",198,0)
 Q
"RTN","LRU",199,0)
 ;
"RTN","LRU",200,0)
 ;
"RTN","LRU",201,0)
S S (LR("Q"),LRQ)=0,LRQ(1)=$$INS
"RTN","LRU",202,0)
 Q
"RTN","LRU",203,0)
 ;
"RTN","LRU",204,0)
 ;
"RTN","LRU",205,0)
INS() ;Set institution Name from ^XMB
"RTN","LRU",206,0)
 N Y
"RTN","LRU",207,0)
 S Y=$P($G(^DIC(4,+$P($G(^XMB(1,1,"XUS")),U,17),0)),U)
"RTN","LRU",208,0)
 Q Y
"RTN","LRU",209,0)
 ;
"RTN","LRU",210,0)
 ;
"RTN","LRU",211,0)
INSN() ;Set primary institution number from ^XMB
"RTN","LRU",212,0)
 N Y
"RTN","LRU",213,0)
 S Y=+$P($G(^XMB(1,1,"XUS")),U,17)
"RTN","LRU",214,0)
 Q Y
"RTN","LRU",215,0)
 ;
"RTN","LRU",216,0)
 ;
"RTN","LRU",217,0)
DUZ2 ;Allow user to change Division [DUZ(2)] value
"RTN","LRU",218,0)
 N A
"RTN","LRU",219,0)
 S A(1)="*** THIS OPTION IS NO LONGER AVAILABLE ***",A(1,"F")="!?18"
"RTN","LRU",220,0)
 S A(2)="Use Kernel option 'Change my Division' [XUSER DIV CHG]",A(2,"F")="!?18"
"RTN","LRU",221,0)
 D EN^DDIOL(.A)
"RTN","LRU",222,0)
 Q
"SEC","^DD",63,63,80,8)

"UP",63,63.203,-2)
63^EM
"UP",63,63.203,-1)
63.02^3
"UP",63,63.203,0)
63.203
"UP",63,63.808,-1)
63^80
"UP",63,63.808,0)
63.808
"VER")
8.0^22.0
"^DD",63,63,80,0)
AUTOPSY ICD CODE^63.808PA^^80;0
"^DD",63,63,80,21,0)
^.001^1^1^3130528^^^^
"^DD",63,63,80,21,1,0)
These are the ICD codes on this autopsy.
"^DD",63,63,80,"DT")
3120628
"^DD",63,63.02,80,0)
ICD CODE^63.203PA^^3;0
"^DD",63,63.02,80,21,0)
^^1^1^3120628^
"^DD",63,63.02,80,21,1,0)
These are the ICD codes on this specimen.
"^DD",63,63.02,80,"DT")
3120628
"^DD",63,63.203,0)
ICD CODE SUB-FIELD^NL^.01^1
"^DD",63,63.203,0,"NM","ICD CODE")

"^DD",63,63.203,.01,0)
ICD CODE^MP80'^ICD9(^0;1^Q
"^DD",63,63.203,.01,3)
Enter the ICD code on this specimen.
"^DD",63,63.203,.01,21,0)
^.001^1^1^3120628^^^^
"^DD",63,63.203,.01,21,1,0)
This is the ICD code on this specimen.
"^DD",63,63.203,.01,"DT")
3120628
"^DD",63,63.808,0)
AUTOPSY ICD CODE SUB-FIELD^NL^.01^1
"^DD",63,63.808,0,"NM","AUTOPSY ICD CODE")

"^DD",63,63.808,.01,0)
AUTOPSY ICD CODE^MP80X^ICD9(^0;1^I $D(X) S DINUM=X
"^DD",63,63.808,.01,3)
Enter ICD code on this autopsy.
"^DD",63,63.808,.01,21,0)
^.001^1^1^3120628^^
"^DD",63,63.808,.01,21,1,0)
This is the ICD code on this autopsy.
"^DD",63,63.808,.01,"DT")
3120628
"BLD",8981,6)
^351
**END**
**END**

