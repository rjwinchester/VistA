EMERGENCY Released IB*2*580 SEQ #529
Extracted from mail message
**KIDS**:IB*2.0*580^

**INSTALL NAME**
IB*2.0*580
"BLD",10361,0)
IB*2.0*580^INTEGRATED BILLING^0^3161115^y
"BLD",10361,1,0)
^^3^3^3161115^
"BLD",10361,1,1,0)
This patch will correct the cost based and interagency charge rates for
"BLD",10361,1,2,0)
Polytrauma and PM&RS (Physical Medicine & Rehabilitation Service)
"BLD",10361,1,3,0)
being reversed with the release of IB*2.0*570.
"BLD",10361,4,0)
^9.64PA^^
"BLD",10361,6)
^508
"BLD",10361,6.3)
38
"BLD",10361,"ABPKG")
n
"BLD",10361,"INIT")
POST^IB20P580
"BLD",10361,"KRN",0)
^9.67PA^779.2^20
"BLD",10361,"KRN",.4,0)
.4
"BLD",10361,"KRN",.401,0)
.401
"BLD",10361,"KRN",.402,0)
.402
"BLD",10361,"KRN",.403,0)
.403
"BLD",10361,"KRN",.5,0)
.5
"BLD",10361,"KRN",.84,0)
.84
"BLD",10361,"KRN",3.6,0)
3.6
"BLD",10361,"KRN",3.8,0)
3.8
"BLD",10361,"KRN",9.2,0)
9.2
"BLD",10361,"KRN",9.8,0)
9.8
"BLD",10361,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10361,"KRN",9.8,"NM",1,0)
IB20P580^^0^B10668907
"BLD",10361,"KRN",9.8,"NM","B","IB20P580",1)

"BLD",10361,"KRN",19,0)
19
"BLD",10361,"KRN",19,"NM",0)
^9.68A^^
"BLD",10361,"KRN",19.1,0)
19.1
"BLD",10361,"KRN",101,0)
101
"BLD",10361,"KRN",409.61,0)
409.61
"BLD",10361,"KRN",771,0)
771
"BLD",10361,"KRN",779.2,0)
779.2
"BLD",10361,"KRN",870,0)
870
"BLD",10361,"KRN",8989.51,0)
8989.51
"BLD",10361,"KRN",8989.52,0)
8989.52
"BLD",10361,"KRN",8994,0)
8994
"BLD",10361,"KRN","B",.4,.4)

"BLD",10361,"KRN","B",.401,.401)

"BLD",10361,"KRN","B",.402,.402)

"BLD",10361,"KRN","B",.403,.403)

"BLD",10361,"KRN","B",.5,.5)

"BLD",10361,"KRN","B",.84,.84)

"BLD",10361,"KRN","B",3.6,3.6)

"BLD",10361,"KRN","B",3.8,3.8)

"BLD",10361,"KRN","B",9.2,9.2)

"BLD",10361,"KRN","B",9.8,9.8)

"BLD",10361,"KRN","B",19,19)

"BLD",10361,"KRN","B",19.1,19.1)

"BLD",10361,"KRN","B",101,101)

"BLD",10361,"KRN","B",409.61,409.61)

"BLD",10361,"KRN","B",771,771)

"BLD",10361,"KRN","B",779.2,779.2)

"BLD",10361,"KRN","B",870,870)

"BLD",10361,"KRN","B",8989.51,8989.51)

"BLD",10361,"KRN","B",8989.52,8989.52)

"BLD",10361,"KRN","B",8994,8994)

"BLD",10361,"QDEF")
^^^^^^^^^^
"BLD",10361,"QUES",0)
^9.62^^0
"BLD",10361,"REQB",0)
^9.611^^0
"INIT")
POST^IB20P580
"MBREQ")
0
"PKG",200,-1)
1^1
"PKG",200,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",200,20,0)
^9.402P^1^1
"PKG",200,20,1,0)
2^^IBAXDR
"PKG",200,20,1,1)

"PKG",200,20,"B",2,1)

"PKG",200,22,0)
^9.49I^1^1
"PKG",200,22,1,0)
2.0^2940321^2990406^2447
"PKG",200,22,1,"PAH",1,0)
580^3161115
"PKG",200,22,1,"PAH",1,1,0)
^^3^3^3161115
"PKG",200,22,1,"PAH",1,1,1,0)
This patch will correct the cost based and interagency charge rates for
"PKG",200,22,1,"PAH",1,1,2,0)
Polytrauma and PM&RS (Physical Medicine & Rehabilitation Service)
"PKG",200,22,1,"PAH",1,1,3,0)
being reversed with the release of IB*2.0*570.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","IB20P580")
0^1^B10668907^n/a
"RTN","IB20P580",1,0)
IB20P580 ;ALB/CXW - IB*2*580 POST INIT:COST-BASED/INTERAGENCY FIX ;11-07-2016
"RTN","IB20P580",2,0)
 ;;2.0;INTEGRATED BILLING;**580**;21-MAR-94;Build 38
"RTN","IB20P580",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","IB20P580",4,0)
 ; 
"RTN","IB20P580",5,0)
 ;
"RTN","IB20P580",6,0)
 ; Cost Based/Interagency Rate fix for Polytrauma in Charge Item (363.2)
"RTN","IB20P580",7,0)
 Q
"RTN","IB20P580",8,0)
POST ;
"RTN","IB20P580",9,0)
 N IBEFFDT,IBA,U S U="^"
"RTN","IB20P580",10,0)
 D MSG("   IB*2.0*580 Post-Install .....")
"RTN","IB20P580",11,0)
 S IBEFFDT=3160707 ; effective date of 07/07/2016
"RTN","IB20P580",12,0)
 D UPDTCI(IBEFFDT)  ; update Charge Items (363.2) with 4 rates            
"RTN","IB20P580",13,0)
 D MSG("   IB*2.0*580 Post-Install Complete")
"RTN","IB20P580",14,0)
 Q
"RTN","IB20P580",15,0)
 ;
"RTN","IB20P580",16,0)
UPDTCI(IBEFFDT) ; Update Charge Items (363.2) needs Charge Sets, pass in the effective date of the new charges
"RTN","IB20P580",17,0)
 N IBC,IBCHG,IBCNT,IBCNT1,IBC,IBCI,IBCS,IBDFLTDT,IBDT,IBI,IBLN,IBPE,IBRVCD,IBX,IBXRF,IBZ,DA,DIE,DR,X,Y
"RTN","IB20P580",18,0)
 ; 
"RTN","IB20P580",19,0)
 D MSG("")
"RTN","IB20P580",20,0)
 S IBCNT=0,IBDFLTDT=+$G(IBEFFDT)
"RTN","IB20P580",21,0)
 I 'IBDFLTDT D MSG("** Error: No Effective Date, No Charges Updated") G CIQ
"RTN","IB20P580",22,0)
 ;
"RTN","IB20P580",23,0)
 F IBI=1:1 S IBLN=$P($T(CIF+IBI),";;",2) Q:+IBLN!(IBLN="")  I $E(IBLN)?1A D SETCI
"RTN","IB20P580",24,0)
 ;
"RTN","IB20P580",25,0)
CIQ D MSG(">> "_IBCNT_" Cost Based/Interagency for Polytrauma/PM&RS charge items updated (#363.2).")
"RTN","IB20P580",26,0)
 D MSG("")
"RTN","IB20P580",27,0)
 Q
"RTN","IB20P580",28,0)
 ;
"RTN","IB20P580",29,0)
SETCI ; set Charge Item (duplicates based on item, CS, eff dt, rev cd)
"RTN","IB20P580",30,0)
 ;
"RTN","IB20P580",31,0)
 S IBCS=$P(IBLN,U,2),IBCS=+$O(^IBE(363.1,"B",IBCS,0)) I 'IBCS D MSG("** Error: Charge Set "_$P(IBLN,U,2)_" undefined") Q
"RTN","IB20P580",32,0)
 S IBCI=+$$MCCRUTL($P(IBLN,U,1),5) I 'IBCI D MSG("** Error: Bed Section "_$P(IBLN,U,2)_" undefined") Q
"RTN","IB20P580",33,0)
 S IBDT=IBDFLTDT I +$P(IBLN,U,3) S IBDT=+$P(IBLN,U,3)
"RTN","IB20P580",34,0)
 S IBRVCD=$$RVCD($P(IBLN,U,4))
"RTN","IB20P580",35,0)
 S IBCHG=+$P(IBLN,U,5)
"RTN","IB20P580",36,0)
 S IBXRF="AIVDTS"_IBCS
"RTN","IB20P580",37,0)
 ; check for duplicate charge items
"RTN","IB20P580",38,0)
 S IBCNT1=0
"RTN","IB20P580",39,0)
 ;
"RTN","IB20P580",40,0)
 S IBX=0 F  S IBX=$O(^IBA(363.2,IBXRF,IBCI,-IBDT,IBX)) Q:'IBX  S IBZ=$G(^IBA(363.2,IBX,0)) I $P(IBZ,U,6)=IBRVCD D
"RTN","IB20P580",41,0)
 . S IBCNT1=IBCNT1+1
"RTN","IB20P580",42,0)
 . I +$P(IBZ,U,5)=IBCHG D MSG("   "_$P(IBLN,U,2)_" with $"_IBCHG_" charge item already exists") Q
"RTN","IB20P580",43,0)
 . S DIE="^IBA(363.2,",DA=+IBX,DR=".05///"_IBCHG D ^DIE K DIE,DA,DR,X,Y
"RTN","IB20P580",44,0)
 . S IBCNT=IBCNT+1
"RTN","IB20P580",45,0)
 I IBCNT1>1 D MSG("** Error: "_$P(IBLN,U,2)_" duplicate charge items on 07/07/2016")
"RTN","IB20P580",46,0)
 Q
"RTN","IB20P580",47,0)
 ;
"RTN","IB20P580",48,0)
MCCRUTL(IBC,IBPE) ; returns IEN in 399.1 if Name is found and piece P is true
"RTN","IB20P580",49,0)
 N IBX,IBY S IBY=""
"RTN","IB20P580",50,0)
 I $G(IBC)'="" S IBX=0 F  S IBX=$O(^DGCR(399.1,"B",IBC,IBX)) Q:'IBX  I $P($G(^DGCR(399.1,IBX,0)),U,+$G(IBPE)) S IBY=IBX
"RTN","IB20P580",51,0)
 Q IBY
"RTN","IB20P580",52,0)
 ;
"RTN","IB20P580",53,0)
RVCD(IBRVCD) ; returns IFN if revenue code is valid and active
"RTN","IB20P580",54,0)
 N IBX,IBY S IBY=""
"RTN","IB20P580",55,0)
 I +$G(IBRVCD) S IBX=$G(^DGCR(399.2,+IBRVCD,0)) I +$P(IBX,U,3) S IBY=+IBRVCD
"RTN","IB20P580",56,0)
 Q IBY
"RTN","IB20P580",57,0)
 ;
"RTN","IB20P580",58,0)
MSG(IBA) ;
"RTN","IB20P580",59,0)
 D MES^XPDUTL(IBA)
"RTN","IB20P580",60,0)
 Q
"RTN","IB20P580",61,0)
 ;
"RTN","IB20P580",62,0)
CIF ; 4 Charge Items (363.2): Bedsection ^ Charge Set ^Effective Date ^ Revenue Code ^ Charge
"RTN","IB20P580",63,0)
 ;;     
"RTN","IB20P580",64,0)
TORT ;; Cost Based (Tortiously Liable) for outpatient care
"RTN","IB20P580",65,0)
 ;;PM&RS OUTPATIENT VISIT^TL-OPT VST PM&RS^^^212
"RTN","IB20P580",66,0)
 ;;POLYTRAUMA OUTPATIENT VISIT^TL-OPT VST POLYTRAUMA^^^537
"RTN","IB20P580",67,0)
 ;;          
"RTN","IB20P580",68,0)
IA ;; Interagency for outpatient care
"RTN","IB20P580",69,0)
 ;;PM&RS OUTPATIENT VISIT^IA-OPT VST PM&RS^^^199
"RTN","IB20P580",70,0)
 ;;POLYTRAUMA OUTPATIENT VISIT^IA-OPT VST POLYTRAUMA^^^510
"RTN","IB20P580",71,0)
 ;;
"RTN","IB20P580",72,0)
 Q
"VER")
8.0^22.0
"BLD",10361,6)
^529
**END**
**END**

