Released IB*2*532 SEQ #487
Extracted from mail message
**KIDS**:IB*2.0*532^

**INSTALL NAME**
IB*2.0*532
"BLD",9716,0)
IB*2.0*532^INTEGRATED BILLING^0^3141107^y
"BLD",9716,1,0)
^^9^9^3140807^^
"BLD",9716,1,1,0)
This patch addresses two issues. 
"BLD",9716,1,2,0)
 
"BLD",9716,1,3,0)
The first issue is about a new entry - LABORATRY SERVICES PROVIDED TO
"BLD",9716,1,4,0)
NON-PATIENTS added to the MCCR Utility file (#399.1) for UB-04 Bill 
"BLD",9716,1,5,0)
Classification on the second digit type of bill.
"BLD",9716,1,6,0)
 
"BLD",9716,1,7,0)
The second issue concerns several misspellings in the display messages 
"BLD",9716,1,8,0)
for the chiropractic-related dates and the statement covers dates in the 
"BLD",9716,1,9,0)
[IB EDIT BILLING INFO] Enter/Edit Billing Information option.
"BLD",9716,4,0)
^9.64PA^399^1
"BLD",9716,4,399,0)
399
"BLD",9716,4,399,2,0)
^9.641^399^1
"BLD",9716,4,399,2,399,0)
BILL/CLAIMS  (File-top level)
"BLD",9716,4,399,2,399,1,0)
^9.6411^245^1
"BLD",9716,4,399,2,399,1,245,0)
LAST XRAY DATE
"BLD",9716,4,399,222)
y^n^p^^^^n^^n
"BLD",9716,4,399,224)

"BLD",9716,4,"APDD",399,399)

"BLD",9716,4,"APDD",399,399,245)

"BLD",9716,4,"B",399,399)

"BLD",9716,6)
^456
"BLD",9716,6.3)
26
"BLD",9716,"INIT")
POST^IB20P532
"BLD",9716,"KRN",0)
^9.67PA^779.2^20
"BLD",9716,"KRN",.4,0)
.4
"BLD",9716,"KRN",.4,"NM",0)
^9.68A^^
"BLD",9716,"KRN",.401,0)
.401
"BLD",9716,"KRN",.402,0)
.402
"BLD",9716,"KRN",.403,0)
.403
"BLD",9716,"KRN",.5,0)
.5
"BLD",9716,"KRN",.84,0)
.84
"BLD",9716,"KRN",3.6,0)
3.6
"BLD",9716,"KRN",3.8,0)
3.8
"BLD",9716,"KRN",9.2,0)
9.2
"BLD",9716,"KRN",9.8,0)
9.8
"BLD",9716,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9716,"KRN",9.8,"NM",1,0)
IBCU4^^0^B24318712
"BLD",9716,"KRN",9.8,"NM","B","IBCU4",1)

"BLD",9716,"KRN",19,0)
19
"BLD",9716,"KRN",19.1,0)
19.1
"BLD",9716,"KRN",101,0)
101
"BLD",9716,"KRN",409.61,0)
409.61
"BLD",9716,"KRN",771,0)
771
"BLD",9716,"KRN",779.2,0)
779.2
"BLD",9716,"KRN",870,0)
870
"BLD",9716,"KRN",8989.51,0)
8989.51
"BLD",9716,"KRN",8989.52,0)
8989.52
"BLD",9716,"KRN",8994,0)
8994
"BLD",9716,"KRN","B",.4,.4)

"BLD",9716,"KRN","B",.401,.401)

"BLD",9716,"KRN","B",.402,.402)

"BLD",9716,"KRN","B",.403,.403)

"BLD",9716,"KRN","B",.5,.5)

"BLD",9716,"KRN","B",.84,.84)

"BLD",9716,"KRN","B",3.6,3.6)

"BLD",9716,"KRN","B",3.8,3.8)

"BLD",9716,"KRN","B",9.2,9.2)

"BLD",9716,"KRN","B",9.8,9.8)

"BLD",9716,"KRN","B",19,19)

"BLD",9716,"KRN","B",19.1,19.1)

"BLD",9716,"KRN","B",101,101)

"BLD",9716,"KRN","B",409.61,409.61)

"BLD",9716,"KRN","B",771,771)

"BLD",9716,"KRN","B",779.2,779.2)

"BLD",9716,"KRN","B",870,870)

"BLD",9716,"KRN","B",8989.51,8989.51)

"BLD",9716,"KRN","B",8989.52,8989.52)

"BLD",9716,"KRN","B",8994,8994)

"BLD",9716,"QUES",0)
^9.62^^
"BLD",9716,"REQB",0)
^9.611^1^1
"BLD",9716,"REQB",1,0)
IB*2.0*461^2
"BLD",9716,"REQB","B","IB*2.0*461",1)

"FIA",399)
BILL/CLAIMS
"FIA",399,0)
^DGCR(399,
"FIA",399,0,0)
399I
"FIA",399,0,1)
y^n^p^^^^n^^n
"FIA",399,0,10)

"FIA",399,0,11)

"FIA",399,0,"RLRO")

"FIA",399,0,"VR")
2.0^IB
"FIA",399,399)
1
"FIA",399,399,245)

"INIT")
POST^IB20P532
"MBREQ")
0
"PKG",193,-1)
1^1
"PKG",193,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",193,20,0)
^9.402P^1^1
"PKG",193,20,1,0)
2^^IBAXDR
"PKG",193,20,1,1)

"PKG",193,20,"B",2,1)

"PKG",193,22,0)
^9.49I^1^1
"PKG",193,22,1,0)
2.0^2940321^2940528
"PKG",193,22,1,"PAH",1,0)
532^3141107^15000049
"PKG",193,22,1,"PAH",1,1,0)
^^9^9^3141107
"PKG",193,22,1,"PAH",1,1,1,0)
This patch addresses two issues. 
"PKG",193,22,1,"PAH",1,1,2,0)
 
"PKG",193,22,1,"PAH",1,1,3,0)
The first issue is about a new entry - LABORATRY SERVICES PROVIDED TO
"PKG",193,22,1,"PAH",1,1,4,0)
NON-PATIENTS added to the MCCR Utility file (#399.1) for UB-04 Bill 
"PKG",193,22,1,"PAH",1,1,5,0)
Classification on the second digit type of bill.
"PKG",193,22,1,"PAH",1,1,6,0)
 
"PKG",193,22,1,"PAH",1,1,7,0)
The second issue concerns several misspellings in the display messages 
"PKG",193,22,1,"PAH",1,1,8,0)
for the chiropractic-related dates and the statement covers dates in the 
"PKG",193,22,1,"PAH",1,1,9,0)
[IB EDIT BILLING INFO] Enter/Edit Billing Information option.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","IB20P532")
0^^B4848244^n/a
"RTN","IB20P532",1,0)
IB20P532 ;ALB/CXW - UB-04 BILL CLASSIFICATION UPDATE; 07/15/2014 
"RTN","IB20P532",2,0)
 ;;2.0;INTEGRATED BILLING;**532**;21-MAR-94;Build 26
"RTN","IB20P532",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","IB20P532",4,0)
 Q
"RTN","IB20P532",5,0)
POST ; 
"RTN","IB20P532",6,0)
 ; UB-04 bill classification in mccr utility file 399.1
"RTN","IB20P532",7,0)
 N IBX,U S U="^"
"RTN","IB20P532",8,0)
 D MSG("     IB*2.0*532 Post-Install starts .....")
"RTN","IB20P532",9,0)
 D MCR
"RTN","IB20P532",10,0)
 D MSG("     IB*2.0*532 Post-Install is complete.")
"RTN","IB20P532",11,0)
 Q
"RTN","IB20P532",12,0)
 ;
"RTN","IB20P532",13,0)
MCR ; UB-04 bill classification in field (#.23/piece 2)
"RTN","IB20P532",14,0)
 ; #4 HUMANIT. EMERG (OPT/ESRD) needs to be replaced
"RTN","IB20P532",15,0)
 N IBCOD,IBFN,IBPE,IBI,IBNW,IBX,DA,DD,DO,DIC,DIE,DLAYGO,DR,X,Y
"RTN","IB20P532",16,0)
 S IBPE=23 D MSG("")
"RTN","IB20P532",17,0)
 D MSG(">>> Adding new UB-04 Bill Classification entries to MCCR Utility file (#399.1)")
"RTN","IB20P532",18,0)
 F IBI=1:1 S IBX=$P($T(BILCS+IBI),";;",2) Q:IBX=""  D
"RTN","IB20P532",19,0)
 . S IBNW=$P(IBX,U),IBCOD=$P(IBX,U,2)
"RTN","IB20P532",20,0)
 . S IBFN=+$$EXCODE(IBCOD,IBPE)
"RTN","IB20P532",21,0)
 . ; quit if it's found in the file 
"RTN","IB20P532",22,0)
 . I IBFN,($P($G(^DGCR(399.1,IBFN,0)),U)=IBNW) D MSG("    #"_IBCOD_" "_IBNW_" already exists in the file") Q
"RTN","IB20P532",23,0)
 . K DD,DO S DLAYGO=399.1,DIC="^DGCR(399.1,",DIC(0)="L",X=IBNW D FILE^DICN
"RTN","IB20P532",24,0)
 . I Y<1 D MSG(" >> ERROR when adding the UB-04 Bill Classification for "_IBNW_" to the file, Log a Remedy ticket!") Q 
"RTN","IB20P532",25,0)
 . S DIE=DIC,DA=+Y,DR=".02///"_IBCOD_";.23///"_$P(IBX,U,3)_";.24///"_$P(IBX,U,4) D ^DIE
"RTN","IB20P532",26,0)
 . D MSG("    #"_IBCOD_" "_IBNW_" added")
"RTN","IB20P532",27,0)
 D MSG("")
"RTN","IB20P532",28,0)
 Q
"RTN","IB20P532",29,0)
 ;
"RTN","IB20P532",30,0)
MSG(IBX) ;
"RTN","IB20P532",31,0)
 D MES^XPDUTL(IBX) Q
"RTN","IB20P532",32,0)
 ;
"RTN","IB20P532",33,0)
EXCODE(IBCOD,IBPE) ; Returns IEN if code found in the IBPE piece
"RTN","IB20P532",34,0)
 N IBX,IBY S IBY=""
"RTN","IB20P532",35,0)
 I $G(IBCOD)'="" S IBX=0 F  S IBX=$O(^DGCR(399.1,"C",IBCOD,IBX)) Q:'IBX  I $P($G(^DGCR(399.1,IBX,0)),U,+$G(IBPE)) S IBY=IBX
"RTN","IB20P532",36,0)
 Q IBY
"RTN","IB20P532",37,0)
 ;
"RTN","IB20P532",38,0)
BILCS ; name^code^bill classification^valid location of care values
"RTN","IB20P532",39,0)
 ;;LABORATORY SERVICES PROVIDED TO NON-PATIENTS^4^1^1,3
"RTN","IB20P532",40,0)
 ;
"RTN","IBCU4")
0^1^B24318712^B24388158
"RTN","IBCU4",1,0)
IBCU4 ;ALB/AAS - BILLING UTILITY ROUTINE (CONTINUED) ;12-FEB-90
"RTN","IBCU4",2,0)
 ;;2.0;INTEGRATED BILLING;**109,122,137,245,349,371,399,461,532**;21-MAR-94;Build 26
"RTN","IBCU4",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","IBCU4",4,0)
 ;
"RTN","IBCU4",5,0)
 ;MAP TO DGCRU4
"RTN","IBCU4",6,0)
 ;
"RTN","IBCU4",7,0)
DDAT ;Input transform for Statement Covers From field
"RTN","IBCU4",8,0)
 I '$D(DA) G TO
"RTN","IBCU4",9,0)
 S IB00=+$P(^DGCR(399,+DA,0),"^",3) I +X<$P(IB00,".",1) W !?4,"Cannot precede the 'EVENT DATE'!",*7 K X G DDAT4
"RTN","IBCU4",10,0)
 I +X>(DT_".2359") W !?4,"Cannot bill for future treatment!",*7 K X G DDAT4
"RTN","IBCU4",11,0)
 D PROCDT
"RTN","IBCU4",12,0)
 I DGPRDTB,X>DGPRDTB K X W !?4,"Can't be greater than date of specified Procedures!",*7 G DDAT4
"RTN","IBCU4",13,0)
 G DDAT4
"RTN","IBCU4",14,0)
DDAT1 ;Input transform for Statement covers to
"RTN","IBCU4",15,0)
 I '$D(DA) G FROM
"RTN","IBCU4",16,0)
 S IB00=$S($D(^DGCR(399,+DA,"U")):$P(^("U"),"^",1),1:"") I 'IB00 W !?4,"'Start Date' must be specified first!",*7 K X G DDAT4
"RTN","IBCU4",17,0)
 I +X>DT W !?4,"Cannot bill for future treatment!",*7 K X G DDAT4
"RTN","IBCU4",18,0)
 I +X<IB00 W !?4,"Cannot precede the 'Start Date'!",*7 K X G DDAT4
"RTN","IBCU4",19,0)
 I $P($G(^DGCR(399,+DA,0)),U,5)>2,$$ICD10S(+IB00,+X) W !?4,"Bill Statement dates cannot span ICD-10 activation date!",*7 K X G DDAT4
"RTN","IBCU4",20,0)
 ;I $S($E(IB00,4,5)<10:$E(IB00,2,3),1:$E(IB00,2,3)+1)'=$S($E(X,4,5)<10:$E(X,2,3),1:$E(X,2,3)+1) K X W !?4,"Must be in same fiscal year!",*7 G DDAT4
"RTN","IBCU4",21,0)
 ;I $$FY(+IB00)'=$$FY(X) K X W !?4,"Must be in same fiscal year!",*7 G DDAT4
"RTN","IBCU4",22,0)
 ;I $E(IB00,1,3)'=$E(X,1,3) K X W !?4,"Must be in same calendar year!",*7 G DDAT4
"RTN","IBCU4",23,0)
 D PROCDT
"RTN","IBCU4",24,0)
 I DGPRDTE,X<DGPRDTE K X W !?4,"Can't be less than date of specified Procedures!",*7 G DDAT4
"RTN","IBCU4",25,0)
 G DDAT4
"RTN","IBCU4",26,0)
 ;
"RTN","IBCU4",27,0)
 ;DDAT2   ;Input transform for OP VISITS DATE(S) field  REPLACED WITH IBCU41 6/15/93
"RTN","IBCU4",28,0)
 ;S IB00=$G(^DGCR(399,IBIFN,"U")) I $P(IB00,"^",1)']"" W !?4,*7,"No 'Start Date' on file...can't enter OP visit dates..." K X G DDAT4
"RTN","IBCU4",29,0)
 ;I $P(IB00,"^",2)']"" W !?4,*7,"No 'End Date' on file...can't enter OP visit dates..." K X G DDAT4
"RTN","IBCU4",30,0)
 ;I X<$P(IB00,"^",1) W !?4,*7,"Can't enter a visit date prior to 'Start Date'..." K X G DDAT4
"RTN","IBCU4",31,0)
 ;I X>$P(IB00,"^",2) W !?4,*7,"Can't enter a visit date later than 'End Date'..." K X G DDAT4
"RTN","IBCU4",32,0)
 ;I $P(^DGCR(399,IBIFN,0),"^",19)'=2,$D(^DGCR(399,"ASC2",IBIFN)),$O(^DGCR(399,IBIFN,"OP",0)) W !?4,*7,"Only 1 visit date allowed on bills with Amb. Surg. Codes!" K X G DDAT4
"RTN","IBCU4",33,0)
 ;D APPT^IBCU3,DUPCHK^IBCU3
"RTN","IBCU4",34,0)
 G DDAT4
"RTN","IBCU4",35,0)
 ;
"RTN","IBCU4",36,0)
DDAT3 ; - x-ref call for to and from dates, REPLACED BY TRIGGERS ON .08, 151, 152 ON 10/18/93
"RTN","IBCU4",37,0)
 ;if inpatient bill return DGNEWLOS to cause recalc of los in IBSC6
"RTN","IBCU4",38,0)
 G DDAT4:'$D(X)
"RTN","IBCU4",39,0)
 I $D(^DGCR(399,DA,0)),$P(^(0),"^",5)<3 S DGNEWLOS=1
"RTN","IBCU4",40,0)
 S IB00=$S($D(^DGCR(399,+DA,"U")):^("U"),1:"") I IB00']"" K X G DDAT4
"RTN","IBCU4",41,0)
 S IB02=$S(+$E(IB00,4,5)<10:$E(IB00,2,3),1:$E(IB00,2,3)+1),IB01=$E(IB00,1)_IB02_"0930",$P(^DGCR(399,DA,"U1"),"^",9)=IB02 ;,$P(^DGCR(399,DA,"U1"),"^",11)=$S($P(IB00,"^",2)>IB01:IB02+1,1:"")
"RTN","IBCU4",42,0)
 ;I $P(^DGCR(399,DA,"U1"),"^",11)="" S $P(^("U1"),"^",12)=""
"RTN","IBCU4",43,0)
 ;
"RTN","IBCU4",44,0)
DDAT4 K IB00,IB01,IB02,IB03,DGX,DGNOAP,DGJ,DGPROC,DGPRDT,DGPRDTE,DGPRDTB Q
"RTN","IBCU4",45,0)
 ;
"RTN","IBCU4",46,0)
OTDAT ; Input transform for Other Care Start Date (399,48,.02)
"RTN","IBCU4",47,0)
 I ('$G(DA(1)))!('$G(X)) Q
"RTN","IBCU4",48,0)
 N IBX S IBX=$G(^DGCR(399,DA(1),"U"))
"RTN","IBCU4",49,0)
 I +X<+IBX W !,?4,"Can Not Precede Bill Start Date!",!,*7 K X Q
"RTN","IBCU4",50,0)
 I +X>(+$P(IBX,U,2)+1) W !,?4,"Cannot be after Bill End Date!",!,*7 K X Q
"RTN","IBCU4",51,0)
 Q
"RTN","IBCU4",52,0)
 ;
"RTN","IBCU4",53,0)
CHDAT ; Input transform for chiropractic-related dates (399/245,246,247)
"RTN","IBCU4",54,0)
 ; Make sure that date entered is not after end date of the bill
"RTN","IBCU4",55,0)
 Q:'$D(X)
"RTN","IBCU4",56,0)
 N IBX,Y
"RTN","IBCU4",57,0)
 S IBX=$P($G(^DGCR(399,+DA,"U")),U,2)
"RTN","IBCU4",58,0)
 I IBX="" W !?4,*7,"No end date of the bill on file - can't enter chiropractic-related dates " K X Q
"RTN","IBCU4",59,0)
 I X>+IBX S Y=IBX D DD^%DT W !,?4,*7,"This date cannot be after the end date of the claim ("_Y_") " K X Q
"RTN","IBCU4",60,0)
 Q
"RTN","IBCU4",61,0)
 ;
"RTN","IBCU4",62,0)
TO ;151 pseudo input x-form
"RTN","IBCU4",63,0)
 I +X_.9<IBIDS(.03) W !?4,"Cannot precede the 'EVENT DATE'!",*7 K X Q
"RTN","IBCU4",64,0)
 I +X>(DT_".2359") W !?4,"Cannot bill for future treatment!",*7 K X
"RTN","IBCU4",65,0)
 Q
"RTN","IBCU4",66,0)
FROM ;152 pseudo input x-form
"RTN","IBCU4",67,0)
 I '$D(IBIDS(151)) W !?4,"'Start Date' must be specified first!",*7 K X Q
"RTN","IBCU4",68,0)
 I +X<IBIDS(151) W !?4,"Cannot precede the 'Start Date'!",*7 K X Q
"RTN","IBCU4",69,0)
 I IBIDS(.05)>2,$$ICD10S(+IBIDS(151),+X) W !?4,"Bill Statement dates cannot span ICD-10 activation date!",*7 K X Q
"RTN","IBCU4",70,0)
 ;I $S($E(IBIDS(151),4,5)<10:$E(IBIDS(151),2,3),1:$E(IBIDS(151),2,3)+1)'=$S($E(X,4,5)<10:$E(X,2,3),1:$E(X,2,3)+1) K X W !?4,"Must be in same fiscal year!",*7 Q
"RTN","IBCU4",71,0)
 ;I $$FY(IBIDS(151))'=$$FY(X) K X W !?4,"Must be in same fiscal year!",*7 Q
"RTN","IBCU4",72,0)
 ;I $E(IBIDS(151),1,3)'=$E(X,1,3) K X W !?4,"Must be in same calendar year!",*7 Q
"RTN","IBCU4",73,0)
 Q
"RTN","IBCU4",74,0)
 ;
"RTN","IBCU4",75,0)
FY(DATE) ; return a dates Fiscal Year
"RTN","IBCU4",76,0)
 N IBYR,IBFY S IBFY=""
"RTN","IBCU4",77,0)
 I $G(DATE)?7N.E S IBYR=$S($E(DATE,4,5)<10:$E(DATE,1,3),1:$E(DATE,1,3)+1),IBFY=$E(IBYR,2,3)
"RTN","IBCU4",78,0)
 Q IBFY
"RTN","IBCU4",79,0)
 ;
"RTN","IBCU4",80,0)
SPEC ;  - calculate discharge specialty
"RTN","IBCU4",81,0)
 ;  - input  IBids(.08) = ptf record number
"RTN","IBCU4",82,0)
 ;  - output IBids(161) = pointer to billing specialty in 399.1
"RTN","IBCU4",83,0)
 K IBIDS(161)
"RTN","IBCU4",84,0)
 Q:$S('$D(IBIDS(.08)):1,'$D(^DGPT(+IBIDS(.08),70)):1,'$P(^(70),"^",2):1,'$D(^DIC(42.4,+$P(^(70),"^",2),0)):1,1:0)  S IBIDS(161)=$P(^DGPT(IBIDS(.08),70),"^",2)
"RTN","IBCU4",85,0)
 S IBIDS(161)=$P($G(^DIC(42.4,+IBIDS(161),0)),"^",5) I IBIDS(161)="" K IBIDS(161) Q
"RTN","IBCU4",86,0)
 S IBIDS(161)=$O(^DGCR(399.1,"B",IBIDS(161),0))
"RTN","IBCU4",87,0)
 I '$D(^DGCR(399.1,+IBIDS(161),0)) K IBIDS(161)
"RTN","IBCU4",88,0)
 Q
"RTN","IBCU4",89,0)
 ;
"RTN","IBCU4",90,0)
PROCDT ;  - find first and last dates of procedures
"RTN","IBCU4",91,0)
 ;    can't set from and to date inside of this range
"RTN","IBCU4",92,0)
 S (DGPRDT,DGPROC,DGPRDTE,DGPRDTB)=0
"RTN","IBCU4",93,0)
 F  S DGPROC=$O(^DGCR(399,+DA,"CP",DGPROC)) Q:'DGPROC  S DGPRDT=$P($G(^DGCR(399,+DA,"CP",DGPROC,0)),"^",2) D
"RTN","IBCU4",94,0)
 . I DGPRDTB=0!(DGPRDTB>DGPRDT) S DGPRDTB=DGPRDT
"RTN","IBCU4",95,0)
 . I DGPRDTE=0!(DGPRDTE<DGPRDT) S DGPRDTE=DGPRDT
"RTN","IBCU4",96,0)
 . Q
"RTN","IBCU4",97,0)
 Q
"RTN","IBCU4",98,0)
 ;
"RTN","IBCU4",99,0)
ICD10S(BDT,EDT,IBIFN) ; return Code Version Date if bill dates span the ICD-10 activation date
"RTN","IBCU4",100,0)
 ; enter either the bill to check or the dates to check
"RTN","IBCU4",101,0)
 N IBS,IBV,IBU S IBS=""
"RTN","IBCU4",102,0)
 S IBV=$$CSVDATE^IBACSV(30)
"RTN","IBCU4",103,0)
 I +$G(IBIFN) S IBU=$G(^DGCR(399,+IBIFN,"U")) S:'$G(BDT) BDT=+IBU S:'$G(EDT) EDT=+$P(IBU,U,2)
"RTN","IBCU4",104,0)
 I $G(BDT)<IBV,$G(EDT)'<IBV S IBS=IBV
"RTN","IBCU4",105,0)
 Q IBS
"RTN","IBCU4",106,0)
 ;
"RTN","IBCU4",107,0)
TOBIN(Y,DA) ; Screen for UB-04 bill classification based on UB-04 location of care
"RTN","IBCU4",108,0)
 ; Y = internal value of code for field .25 (UB-04 BILL CLASSIFICATION)
"RTN","IBCU4",109,0)
 ; DA = bill ien in file 399
"RTN","IBCU4",110,0)
 N IB0
"RTN","IBCU4",111,0)
 S IB0=$P($G(^DGCR(399,DA,0)),U,24) ; Get UB-04 LOCATION OF CARE value
"RTN","IBCU4",112,0)
 Q $S('IB0:0,(","_$P($G(^DGCR(399.1,+Y,0)),U,24)_",")'[(","_IB0_","):0,1:1)
"RTN","IBCU4",113,0)
 ;
"RTN","IBCU4",114,0)
TRIG05(X,D0) ; Trigger executed on field .05 of file 399 to set field .25
"RTN","IBCU4",115,0)
 ; Find the correct entry in file 399.1 that corresponds to the value in .05
"RTN","IBCU4",116,0)
 ; X = value of field .05, location of care
"RTN","IBCU4",117,0)
 ; D0 = IEN of bill entry in file 399
"RTN","IBCU4",118,0)
 N Z,Z0,IEN,LOC
"RTN","IBCU4",119,0)
 S LOC=$P($G(^DGCR(399,D0,0)),U,4)
"RTN","IBCU4",120,0)
 S IEN="",Z=0
"RTN","IBCU4",121,0)
 ; *532 return the last entry (eg. #4-lab)
"RTN","IBCU4",122,0)
 I LOC'="" F  S Z=$O(^DGCR(399.1,"C",X,Z)) Q:'Z  S Z0=$P($G(^DGCR(399.1,Z,0)),U,23,24) I +Z0,(","_$P(Z0,U,2)_",")[(","_LOC_",") S IEN=Z
"RTN","IBCU4",123,0)
 Q IEN
"RTN","IBCU4",124,0)
 ;
"RTN","IBCU4",125,0)
TOB(IBIFN,POS) ;Function returns the 3 digit type of bill from UB-04
"RTN","IBCU4",126,0)
 ;  fields or the position (1-3) as determined by POS (optional)
"RTN","IBCU4",127,0)
 N Z
"RTN","IBCU4",128,0)
 S Z=$P($G(^DGCR(399,IBIFN,0)),U,24,26),Z=$P(Z,U)_$P($G(^DGCR(399.1,+$P(Z,U,2),0)),U,2)_$P(Z,U,3)
"RTN","IBCU4",129,0)
 Q $S('$G(POS):Z,1:$E(Z,+POS))
"RTN","IBCU4",130,0)
 ;
"VER")
8.0^22.0
"^DD",399,399,245,0)
LAST XRAY DATE^DX^^U3;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X I $D(X) D CHDAT^IBCU4
"^DD",399,399,245,3)
Enter the last date the patient had an Xray (for chiropractic only).
"^DD",399,399,245,21,0)
^.001^3^3^3140807^^^^
"^DD",399,399,245,21,1,0)
If an Xray was used to demonstrate a subluxation of the spine, enter the
"^DD",399,399,245,21,2,0)
date of the last Xray.
"^DD",399,399,245,21,3,0)
If an Xray date is entered, it will automatically print on CMS-1500.
"^DD",399,399,245,"DT")
3070619
"BLD",9716,6)
^487
**END**
**END**

