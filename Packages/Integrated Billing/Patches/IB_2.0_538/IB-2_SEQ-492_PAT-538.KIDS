Released IB*2*538 SEQ #492
Extracted from mail message
**KIDS**:IB*2.0*538^

**INSTALL NAME**
IB*2.0*538
"BLD",9863,0)
IB*2.0*538^INTEGRATED BILLING^0^3141105^y
"BLD",9863,1,0)
^^10^10^3141029^
"BLD",9863,1,1,0)
This patch addresses two issues.
"BLD",9863,1,2,0)
 
"BLD",9863,1,3,0)
1. The administrative charge $13.07 needs to be added to the prescription
"BLD",9863,1,4,0)
   cost for the rate type: Interagency with an effective date of January
"BLD",9863,1,5,0)
   1st, 2014.
"BLD",9863,1,6,0)
 
"BLD",9863,1,7,0)
2. The administrative charge $13.10 needs to be added to the prescription
"BLD",9863,1,8,0)
   cost for the rate types: Reimbursable Insurance, No Fault Insurance,
"BLD",9863,1,9,0)
   Workers' Compensation, Tort Feasor, Humanitarian, Ineligible and
"BLD",9863,1,10,0)
   Interagency with an effective date of January 1st, 2015.
"BLD",9863,4,0)
^9.64PA^^
"BLD",9863,6)
^467
"BLD",9863,6.3)
29
"BLD",9863,"ABPKG")
n
"BLD",9863,"INIT")
POST^IB20P538
"BLD",9863,"KRN",0)
^9.67PA^779.2^20
"BLD",9863,"KRN",.4,0)
.4
"BLD",9863,"KRN",.401,0)
.401
"BLD",9863,"KRN",.402,0)
.402
"BLD",9863,"KRN",.403,0)
.403
"BLD",9863,"KRN",.5,0)
.5
"BLD",9863,"KRN",.84,0)
.84
"BLD",9863,"KRN",3.6,0)
3.6
"BLD",9863,"KRN",3.8,0)
3.8
"BLD",9863,"KRN",9.2,0)
9.2
"BLD",9863,"KRN",9.8,0)
9.8
"BLD",9863,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9863,"KRN",9.8,"NM",1,0)
IB3PSOU^^0^B21501887
"BLD",9863,"KRN",9.8,"NM","B","IB3PSOU",1)

"BLD",9863,"KRN",19,0)
19
"BLD",9863,"KRN",19,"NM",0)
^9.68A^^
"BLD",9863,"KRN",19.1,0)
19.1
"BLD",9863,"KRN",101,0)
101
"BLD",9863,"KRN",409.61,0)
409.61
"BLD",9863,"KRN",771,0)
771
"BLD",9863,"KRN",779.2,0)
779.2
"BLD",9863,"KRN",870,0)
870
"BLD",9863,"KRN",8989.51,0)
8989.51
"BLD",9863,"KRN",8989.52,0)
8989.52
"BLD",9863,"KRN",8994,0)
8994
"BLD",9863,"KRN","B",.4,.4)

"BLD",9863,"KRN","B",.401,.401)

"BLD",9863,"KRN","B",.402,.402)

"BLD",9863,"KRN","B",.403,.403)

"BLD",9863,"KRN","B",.5,.5)

"BLD",9863,"KRN","B",.84,.84)

"BLD",9863,"KRN","B",3.6,3.6)

"BLD",9863,"KRN","B",3.8,3.8)

"BLD",9863,"KRN","B",9.2,9.2)

"BLD",9863,"KRN","B",9.8,9.8)

"BLD",9863,"KRN","B",19,19)

"BLD",9863,"KRN","B",19.1,19.1)

"BLD",9863,"KRN","B",101,101)

"BLD",9863,"KRN","B",409.61,409.61)

"BLD",9863,"KRN","B",771,771)

"BLD",9863,"KRN","B",779.2,779.2)

"BLD",9863,"KRN","B",870,870)

"BLD",9863,"KRN","B",8989.51,8989.51)

"BLD",9863,"KRN","B",8989.52,8989.52)

"BLD",9863,"KRN","B",8994,8994)

"BLD",9863,"QDEF")
^^^^^^^^^^NO
"BLD",9863,"QUES",0)
^9.62^^
"BLD",9863,"REQB",0)
^9.611^1^1
"BLD",9863,"REQB",1,0)
IB*2.0*510^2
"BLD",9863,"REQB","B","IB*2.0*510",1)

"INIT")
POST^IB20P538
"MBREQ")
0
"PKG",200,-1)
1^1
"PKG",200,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",200,20,0)
^9.402P^1^1
"PKG",200,20,1,0)
2^^IBAXDR
"PKG",200,20,1,1)

"PKG",200,20,"B",2,1)

"PKG",200,22,0)
^9.49I^1^1
"PKG",200,22,1,0)
2.0^2940321^2990406^2447
"PKG",200,22,1,"PAH",1,0)
538^3141105
"PKG",200,22,1,"PAH",1,1,0)
^^10^10^3141105
"PKG",200,22,1,"PAH",1,1,1,0)
This patch addresses two issues.
"PKG",200,22,1,"PAH",1,1,2,0)
 
"PKG",200,22,1,"PAH",1,1,3,0)
1. The administrative charge $13.07 needs to be added to the prescription
"PKG",200,22,1,"PAH",1,1,4,0)
   cost for the rate type: Interagency with an effective date of January
"PKG",200,22,1,"PAH",1,1,5,0)
   1st, 2014.
"PKG",200,22,1,"PAH",1,1,6,0)
 
"PKG",200,22,1,"PAH",1,1,7,0)
2. The administrative charge $13.10 needs to be added to the prescription
"PKG",200,22,1,"PAH",1,1,8,0)
   cost for the rate types: Reimbursable Insurance, No Fault Insurance,
"PKG",200,22,1,"PAH",1,1,9,0)
   Workers' Compensation, Tort Feasor, Humanitarian, Ineligible and
"PKG",200,22,1,"PAH",1,1,10,0)
   Interagency with an effective date of January 1st, 2015.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","IB20P538")
0^^B9467312^n/a
"RTN","IB20P538",1,0)
IB20P538 ;ALB/CXW - IB*2.0*538 Post Init: Administrative Charge Update; 10-15-2014 
"RTN","IB20P538",2,0)
 ;;2.0;INTEGRATED BILLING;**538**;21-MAR-94;Build 29
"RTN","IB20P538",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","IB20P538",4,0)
 Q
"RTN","IB20P538",5,0)
 ;
"RTN","IB20P538",6,0)
POST ; post-install of patch installation
"RTN","IB20P538",7,0)
 ; use default rate types for rx 3rd party bill to update RS in #363
"RTN","IB20P538",8,0)
 ; ibraty=rate type name from file #399.3
"RTN","IB20P538",9,0)
 ; ibeffdt=effective fileman date 
"RTN","IB20P538",10,0)
 ; ibadfe=administrative fee (dollar.cent)
"RTN","IB20P538",11,0)
 ; ibdisp=dispensing fee (dollar.cent)
"RTN","IB20P538",12,0)
 ; ibadjust=adjustment mumps code
"RTN","IB20P538",13,0)
 ;
"RTN","IB20P538",14,0)
 N U,IBCT,IBI,IBJ,IBMG,IBT,IBX,IBY,IBRS,IBRSIN,IBRATY,IBEFFDT,IBADFE,IBDISP,IBADJUST,Y
"RTN","IB20P538",15,0)
 D MES^XPDUTL("Patch IB*2.0*538 Post-Install starts...")
"RTN","IB20P538",16,0)
 D MES^XPDUTL("")
"RTN","IB20P538",17,0)
 S IBADFE="",IBCT=0,IBMG="rate schedule adjustment",U="^"
"RTN","IB20P538",18,0)
 F IBX=1:1 S IBT=$P($T(RSF+IBX),";",3) Q:'$L(IBT)  D
"RTN","IB20P538",19,0)
 . S IBRS=""
"RTN","IB20P538",20,0)
 . S IBRATY=$P(IBT,U),IBRATY=$TR(IBRATY,"/",U)
"RTN","IB20P538",21,0)
 . S IBDISP=$P(IBT,U,2)
"RTN","IB20P538",22,0)
 . S IBADJUST=$P(IBT,U,3)
"RTN","IB20P538",23,0)
 . S (Y,IBEFFDT)=$P(IBT,U,4)
"RTN","IB20P538",24,0)
 . D DD^%DT S IBY=Y
"RTN","IB20P538",25,0)
 . F IBI=1:1 S IBJ=$P(IBRATY,U,IBI) Q:IBJ=""  D
"RTN","IB20P538",26,0)
 .. S IBRSIN=$O(^DGCR(399.3,"B",IBJ,0))
"RTN","IB20P538",27,0)
 .. I 'IBRSIN D MES^XPDUTL("     >>>"_IBJ_" not defined in the Rate Type file (#399.3), no "_IBMG_" added for "_IBY) Q
"RTN","IB20P538",28,0)
 .. ; find the latest ien if multiple
"RTN","IB20P538",29,0)
 .. I $P($G(^DGCR(399.3,+IBRSIN,0)),U,3) S IBRSIN=$O(^DGCR(399.3,"B",IBJ,999999),-1)
"RTN","IB20P538",30,0)
 .. I $P($G(^DGCR(399.3,+IBRSIN,0)),U,3) D MES^XPDUTL("    >>>"_IBJ_" not active in the Rate Type file (#399.3), no "_IBMG_" added for "_IBY) Q
"RTN","IB20P538",31,0)
 .. I $$RSEXIST(IBEFFDT,IBRSIN) D MES^XPDUTL("    >>>Effective date of "_IBY_" for "_IBJ_" "_IBMG_" already exists") Q
"RTN","IB20P538",32,0)
 .. S IBRS=IBRS_U_IBJ
"RTN","IB20P538",33,0)
 . S IBRATY=$E(IBRS,2,$L(IBRS)) Q:IBRS=""
"RTN","IB20P538",34,0)
 . D ENT^IB3PSOU(IBRATY,IBEFFDT,IBADFE,IBDISP,IBADJUST)
"RTN","IB20P538",35,0)
 . F IBI=1:1 S IBJ=$P(IBRATY,U,IBI) Q:IBJ=""  D
"RTN","IB20P538",36,0)
 .. S IBRSIN=$O(^DGCR(399.3,"B",IBJ,0))
"RTN","IB20P538",37,0)
 .. I $$RSEXIST(IBEFFDT,IBRSIN) S IBCT=IBCT+1 D MES^XPDUTL("    >>>Effective date of "_IBY_" for "_IBJ_" "_IBMG_" added")
"RTN","IB20P538",38,0)
 D MES^XPDUTL("  Total "_IBCT_$S(IBCT=1:" entry",1:" entries")_" added to the Rate Schedule file (#363)")
"RTN","IB20P538",39,0)
 D MES^XPDUTL("")
"RTN","IB20P538",40,0)
 D MES^XPDUTL("Patch IB*2.0*538 Post-Install is complete.")
"RTN","IB20P538",41,0)
 Q
"RTN","IB20P538",42,0)
 ;
"RTN","IB20P538",43,0)
RSEXIST(IBEFFDT,IBRSIN) ; return RS IFN if Rate Schedule exists for Effective Date
"RTN","IB20P538",44,0)
 N IBX,IBRSFN,IBRS0 S IBX=0
"RTN","IB20P538",45,0)
 S IBRSFN=0 F  S IBRSFN=$O(^IBE(363,IBRSFN))  Q:'IBRSFN  D  I IBX Q
"RTN","IB20P538",46,0)
 . S IBRS0=$G(^IBE(363,IBRSFN,0))
"RTN","IB20P538",47,0)
 . I $P(IBRS0,U,2)=IBRSIN,$P(IBRS0,U,5)=IBEFFDT S IBX=IBRSFN
"RTN","IB20P538",48,0)
 Q IBX
"RTN","IB20P538",49,0)
 ;
"RTN","IB20P538",50,0)
RSF ; rate type separated by '/'^dispensing fee^adjustment^effective date
"RTN","IB20P538",51,0)
 ;;INTERAGENCY^13.07^S X=X+13.07^3140101
"RTN","IB20P538",52,0)
 ;;REIMBURSABLE INS./NO FAULT INS./WORKERS' COMP./TORT FEASOR/INELIGIBLE/HUMANITARIAN/INTERAGENCY^13.10^S X=X+13.10^3150101
"RTN","IB20P538",53,0)
 ;
"RTN","IB3PSOU")
0^1^B21501887^B21192131
"RTN","IB3PSOU",1,0)
IB3PSOU ;WOIFO/PLT-Outpatient Pharmacy Administrative Fee Change Update ;8/17/10  10:24
"RTN","IB3PSOU",2,0)
 ;;2.0;INTEGRATED BILLING;**437,510,538**;21-MAR-94;Build 29
"RTN","IB3PSOU",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","IB3PSOU",4,0)
 QUIT  ;invalid entry
"RTN","IB3PSOU",5,0)
 ; Procedure updates rate schedules for default rate types or types
"RTN","IB3PSOU",6,0)
 ; specified in IBRATY by inactivating currently active rate
"RTN","IB3PSOU",7,0)
 ; schedules with date (IBDFFDT-1 ) that contain either RX Cost or
"RTN","IB3PSOU",8,0)
 ; TL Fill charge sets.  Procedure adds new rate schedules for the
"RTN","IB3PSOU",9,0)
 ; rate types defined, setting the activation date to IBDFFDT and
"RTN","IB3PSOU",10,0)
 ; updating any defined Fees or adjustment.  When rate schedules
"RTN","IB3PSOU",11,0)
 ; updated by this procedure also contain additional charge sets
"RTN","IB3PSOU",12,0)
 ; other than RX Cost or TL Fill then a separate rate schedule is
"RTN","IB3PSOU",13,0)
 ; created with those additional charge sets and the original fees
"RTN","IB3PSOU",14,0)
 ; and adjustments are maintained.
"RTN","IB3PSOU",15,0)
 ;
"RTN","IB3PSOU",16,0)
 ; Default Rate Types:  REIMBURSABLE INS., NO FAULT INS., TORT 
"RTN","IB3PSOU",17,0)
 ; FEASOR, WORKERS' COMP.
"RTN","IB3PSOU",18,0)
 ;
"RTN","IB3PSOU",19,0)
 ;Input parameters:
"RTN","IB3PSOU",20,0)
 ;
"RTN","IB3PSOU",21,0)
 ;  IBRATY:  (optional) rate type names separated by ^.  If defined
"RTN","IB3PSOU",22,0)
 ;           use these rate types instead of default types.
"RTN","IB3PSOU",23,0)
 ;  IBDFFDT: (required)  Effective date in form mm/dd/yyyy for new rate 
"RTN","IB3PSOU",24,0)
 ;           schedules.
"RTN","IB3PSOU",25,0)
 ;  IBADFE:  (optional)    not currently in use.
"RTN","IB3PSOU",26,0)
 ;  IBDISP:  (required) Dispense Fee: to contain the new annual 
"RTN","IB3PSOU",27,0)
 ;           administrative fee for rate schedules.
"RTN","IB3PSOU",28,0)
 ;  IBADJUST: (optional) if defined must be MUMPS code to define a
"RTN","IB3PSOU",29,0)
 ; unique adjustment to the rate schedule.  If not defined default
"RTN","IB3PSOU",30,0)
 ; adjustment is S X = X + $G(IBADFE) + $G(IBDISP)
"RTN","IB3PSOU",31,0)
 ;
"RTN","IB3PSOU",32,0)
 ;ibraty=rate type name of file #399.3^rate type name^rate type name...
"RTN","IB3PSOU",33,0)
 ;   =""for all-reimbursable ins., no fault ins., tort feasor, works' comp.
"RTN","IB3PSOU",34,0)
 ;ibeffdt=effective external date (mm/dd/yyyy)
"RTN","IB3PSOU",35,0)
 ;ibadfe=administrative fee (ddd.cc)
"RTN","IB3PSOU",36,0)
 ;ibdisp=dispensing fee (ddd.cc)
"RTN","IB3PSOU",37,0)
 ;ibadjust=adjustment mumps code
"RTN","IB3PSOU",38,0)
ENT(IBRATY,IBEFFDT,IBADFE,IBDISP,IBADJUST) ;update admin/disp fee and adjustment of file #363
"RTN","IB3PSOU",39,0)
 N A,B,X,Y,IBA,IBB,IBC,IBINADT,IBRFRC,IBRCOST
"RTN","IB3PSOU",40,0)
 S:IBRATY="" IBRATY="REIMBURSABLE INS.^NO FAULT INS.^WORKERS' COMP.^TORT FEASOR"
"RTN","IB3PSOU",41,0)
 S IBRATY="^"_IBRATY_"^"
"RTN","IB3PSOU",42,0)
 S X=IBEFFDT D ^%DT S IBEFFDT=Y,IBINADT=$$FMADD^XLFDT(IBEFFDT,-1)
"RTN","IB3PSOU",43,0)
 ;get iens of 'tl-rx fill' and 'rx cost' of charge set file #363.1
"RTN","IB3PSOU",44,0)
 ;set ien of 'ia-rx fill' in ibrfrc to create ia-rx rate schedule *538
"RTN","IB3PSOU",45,0)
 S (IBRFRC,IBRCOST)="^" F A="TL-RX FILL","RX COST","IA-RX FILL" S B=0 F B=$O(^IBE(363.1,"B",A,B)) QUIT:'B  S IBRFRC=IBRFRC_B_"^" S:A="RX COST" IBRCOST=IBRCOST_B_"^"
"RTN","IB3PSOU",46,0)
 ;loop through charge set iens of 'ti-rx til' and'rx cost' in ibrfrc
"RTN","IB3PSOU",47,0)
 F IBA=2:1 S IBB=$P(IBRFRC,U,IBA) QUIT:'IBB  D
"RTN","IB3PSOU",48,0)
 . N IBIEN,IBRTNM
"RTN","IB3PSOU",49,0)
 . ;find rate schedule with no inactive date, effective date<ibeffdt, rate type contained in ibraty
"RTN","IB3PSOU",50,0)
 . S IBIEN=0 F  S IBIEN=$O(^IBE(363,"C",IBB,IBIEN)) QUIT:'IBIEN  S A=^IBE(363,IBIEN,0),IBRTNM=$P(^DGCR(399.3,$P(A,U,2),0),U) I '$P(A,U,6),$P(A,U,5)<IBEFFDT,$P(A,U,2),IBRATY[("^"_IBRTNM_"^") D
"RTN","IB3PSOU",51,0)
 .. ;copy-to new entry, and copy-to new entry again if the copy-from entry has charge set other than 'tr-rf fill' and 'rx cost'
"RTN","IB3PSOU",52,0)
 .. S IBC=$$COPY(IBIEN,"") S:IBC IBC=$$COPY(IBIEN,1)
"RTN","IB3PSOU",53,0)
 .. ;inactivate the copy-from entry.
"RTN","IB3PSOU",54,0)
 .. D INACT(IBIEN)
"RTN","IB3PSOU",55,0)
 .. QUIT
"RTN","IB3PSOU",56,0)
 . QUIT
"RTN","IB3PSOU",57,0)
 QUIT
"RTN","IB3PSOU",58,0)
 ;
"RTN","IB3PSOU",59,0)
 ;
"RTN","IB3PSOU",60,0)
 ;ibien=the ien of the copy-from rate schedule file #363
"RTN","IB3PSOU",61,0)
 ;ibc="" copy and update adm, disp, adj including only charge sets for 'tr-rf fill' and 'rx cost'
"RTN","IB3PSOU",62,0)
 ;   =1 copy and no update including all other charge set only
"RTN","IB3PSOU",63,0)
COPY(IBIEN,IBC) ;extrinsic function ="" or 1
"RTN","IB3PSOU",64,0)
 N IBD,IBE,IBNIEN,IBRS0,IBRS1,IBRS10,IBRS11,IBRSCS
"RTN","IB3PSOU",65,0)
 ;copy-to a new entry from ibien containing charge set iba
"RTN","IB3PSOU",66,0)
 N IBNRX S IBNRX=""
"RTN","IB3PSOU",67,0)
 S IBRS0=$G(^IBE(363,IBIEN,0)),IBRS1=$G(^(1)),IBRS10=$G(^(10)),IBRS11=$G(^(11)) D  QUIT:'$G(IBNIEN)
"RTN","IB3PSOU",68,0)
 . ;add new charge set hmn/inelig-rx *510
"RTN","IB3PSOU",69,0)
 . I 'IBC,'$O(^IBE(363,"B",$P($P(IBRS0,U),"-")_"-RX",0)) S IBNRX=$P($P(IBRS0,U),"-")_"-RX"
"RTN","IB3PSOU",70,0)
 . ;add new entry of file #363
"RTN","IB3PSOU",71,0)
 . N DO,DIC,DA,X,DINUM,Y,DTOUT,DUOUT
"RTN","IB3PSOU",72,0)
 . N DIE,DA,DR
"RTN","IB3PSOU",73,0)
 . S DIC="^IBE(363,",DIC(0)="F",X=$S(IBNRX="":$P(IBRS0,U),1:IBNRX)
"RTN","IB3PSOU",74,0)
 . ;copy data fields with new administration fee
"RTN","IB3PSOU",75,0)
 . S DIC("DR")=".02////"_$P(IBRS0,U,2)_";.03////"_$P(IBRS0,U,3)_";.04////"_$P(IBRS0,U,4)_";.05////"_IBEFFDT
"RTN","IB3PSOU",76,0)
 . ;reserve adm, disp values
"RTN","IB3PSOU",77,0)
 . I IBC S DIC("DR")=DIC("DR")_";1.01////"_$P(IBRS1,U)_";1.02////"_$P(IBRS1,U,2)
"RTN","IB3PSOU",78,0)
 . ;update adm, disp values
"RTN","IB3PSOU",79,0)
 . I 'IBC S DIC("DR")=DIC("DR")_";1.01////"_$G(IBDISP)_";1.02////"_$G(IBADFE)
"RTN","IB3PSOU",80,0)
 . D FILE^DICN I Y<0 D MES^XPDUTL("The Rate Schedule "_X_" update failed") QUIT
"RTN","IB3PSOU",81,0)
 . S IBNIEN=+Y
"RTN","IB3PSOU",82,0)
 . ;set adjustment value
"RTN","IB3PSOU",83,0)
 . S DIE="^IBE(363,",DA=IBNIEN,DR="10////"_$S('IBC:$G(IBADJUST),1:IBRS10)
"RTN","IB3PSOU",84,0)
 . D ^DIE
"RTN","IB3PSOU",85,0)
 . QUIT
"RTN","IB3PSOU",86,0)
 ;copy/edit charge set multiple.
"RTN","IB3PSOU",87,0)
 S IBRSCS=0 F  S IBRSCS=$O(^IBE(363,IBIEN,11,IBRSCS)) QUIT:'IBRSCS  S IBD=^(IBRSCS,0) D
"RTN","IB3PSOU",88,0)
 . N DO,DIC,DA,X,DINUM,Y,DTOUT,DUOUT
"RTN","IB3PSOU",89,0)
 . I IBC,IBRFRC[("^"_$P(IBD,U)_"^") QUIT
"RTN","IB3PSOU",90,0)
 . I 'IBC,IBRFRC'[("^"_$P(IBD,U)_"^") S IBE=1 QUIT
"RTN","IB3PSOU",91,0)
 . ;change charge set 'tr-rf fill' to 'rx cost'
"RTN","IB3PSOU",92,0)
 . I 'IBC,IBRCOST'[("^"_$P(IBD,U)_"^") S $P(IBD,U)=$P(IBRCOST,U,2),$P(IBD,U,2)=1
"RTN","IB3PSOU",93,0)
 . ;not 'rx cost' the auto add is null - comment out *510
"RTN","IB3PSOU",94,0)
 . ;S:IBC $P(IBD,U,2)=""
"RTN","IB3PSOU",95,0)
 . S DIC="^IBE(363,"_IBNIEN_",11,",DIC(0)="F",DA(1)=IBNIEN,X=$P(IBD,U),DINUM=$S(IBNRX="":IBRSCS,1:1),DIC("DR")=".02////"_$P(IBD,U,2)
"RTN","IB3PSOU",96,0)
 . D FILE^DICN I Y<0 D MES^XPDUTL("The Rate Schedule "_$P(IBRS0,U)_"'s Charge Set "_X_" update failed")
"RTN","IB3PSOU",97,0)
 . QUIT
"RTN","IB3PSOU",98,0)
 QUIT $G(IBE)
"RTN","IB3PSOU",99,0)
 ;
"RTN","IB3PSOU",100,0)
 ;ibien=the ien of the file #363
"RTN","IB3PSOU",101,0)
INACT(IBIEN) ;inactivate the copy-from rate schedule
"RTN","IB3PSOU",102,0)
 N D,D0,DI,DIC,DQ,DIE,DA,DR,DTOUT
"RTN","IB3PSOU",103,0)
 S DIE="^IBE(363,",DA=IBIEN,DR=".06////"_IBINADT D ^DIE
"RTN","IB3PSOU",104,0)
 QUIT
"RTN","IB3PSOU",105,0)
 ;
"VER")
8.0^22.0
"BLD",9863,6)
^492
**END**
**END**

