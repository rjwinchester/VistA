EMERGENCY Released IB*2*572 SEQ #524
Extracted from mail message
**KIDS**:IB*2.0*572^

**INSTALL NAME**
IB*2.0*572
"BLD",10320,0)
IB*2.0*572^INTEGRATED BILLING^0^3160816^y
"BLD",10320,1,0)
^^8^8^3160816^
"BLD",10320,1,1,0)
Previously released patch IB*2.0*561 applied default revenue code 124 
"BLD",10320,1,2,0)
(PSYCHIATRIC) to five Mental Health Diagnosis Related Groups (DRGs) 881, 
"BLD",10320,1,3,0)
882, 883, 885 and 886.  These charge items included R&B (Room & Board)
"BLD",10320,1,4,0)
101, Intensive Care Unit 200, and Ancillary Services 240 in the CHARGE
"BLD",10320,1,5,0)
ITEM file (#363.2).
"BLD",10320,1,6,0)
 
"BLD",10320,1,7,0)
This patch will still apply default code 124 to R&B but remove it for
"BLD",10320,1,8,0)
Intensive Care Unit 200, and Ancillary Services 240.
"BLD",10320,4,0)
^9.64PA^^
"BLD",10320,6)
^491
"BLD",10320,6.3)
39
"BLD",10320,"ABPKG")
n
"BLD",10320,"INIT")
POST^IB20P572
"BLD",10320,"KRN",0)
^9.67PA^779.2^20
"BLD",10320,"KRN",.4,0)
.4
"BLD",10320,"KRN",.401,0)
.401
"BLD",10320,"KRN",.402,0)
.402
"BLD",10320,"KRN",.403,0)
.403
"BLD",10320,"KRN",.5,0)
.5
"BLD",10320,"KRN",.84,0)
.84
"BLD",10320,"KRN",3.6,0)
3.6
"BLD",10320,"KRN",3.8,0)
3.8
"BLD",10320,"KRN",9.2,0)
9.2
"BLD",10320,"KRN",9.8,0)
9.8
"BLD",10320,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10320,"KRN",9.8,"NM",1,0)
IB20P572^^0^B8731091
"BLD",10320,"KRN",9.8,"NM","B","IB20P572",1)

"BLD",10320,"KRN",19,0)
19
"BLD",10320,"KRN",19,"NM",0)
^9.68A^^
"BLD",10320,"KRN",19.1,0)
19.1
"BLD",10320,"KRN",101,0)
101
"BLD",10320,"KRN",409.61,0)
409.61
"BLD",10320,"KRN",771,0)
771
"BLD",10320,"KRN",779.2,0)
779.2
"BLD",10320,"KRN",870,0)
870
"BLD",10320,"KRN",8989.51,0)
8989.51
"BLD",10320,"KRN",8989.52,0)
8989.52
"BLD",10320,"KRN",8994,0)
8994
"BLD",10320,"KRN","B",.4,.4)

"BLD",10320,"KRN","B",.401,.401)

"BLD",10320,"KRN","B",.402,.402)

"BLD",10320,"KRN","B",.403,.403)

"BLD",10320,"KRN","B",.5,.5)

"BLD",10320,"KRN","B",.84,.84)

"BLD",10320,"KRN","B",3.6,3.6)

"BLD",10320,"KRN","B",3.8,3.8)

"BLD",10320,"KRN","B",9.2,9.2)

"BLD",10320,"KRN","B",9.8,9.8)

"BLD",10320,"KRN","B",19,19)

"BLD",10320,"KRN","B",19.1,19.1)

"BLD",10320,"KRN","B",101,101)

"BLD",10320,"KRN","B",409.61,409.61)

"BLD",10320,"KRN","B",771,771)

"BLD",10320,"KRN","B",779.2,779.2)

"BLD",10320,"KRN","B",870,870)

"BLD",10320,"KRN","B",8989.51,8989.51)

"BLD",10320,"KRN","B",8989.52,8989.52)

"BLD",10320,"KRN","B",8994,8994)

"BLD",10320,"QDEF")
^^^^^^^^^^
"BLD",10320,"QUES",0)
^9.62^^
"BLD",10320,"REQB",0)
^9.611^^0
"INIT")
POST^IB20P572
"MBREQ")
0
"PKG",200,-1)
1^1
"PKG",200,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",200,20,0)
^9.402P^1^1
"PKG",200,20,1,0)
2^^IBAXDR
"PKG",200,20,1,1)

"PKG",200,20,"B",2,1)

"PKG",200,22,0)
^9.49I^1^1
"PKG",200,22,1,0)
2.0^2940321^2990406^2447
"PKG",200,22,1,"PAH",1,0)
572^3160816
"PKG",200,22,1,"PAH",1,1,0)
^^8^8^3160816
"PKG",200,22,1,"PAH",1,1,1,0)
Previously released patch IB*2.0*561 applied default revenue code 124 
"PKG",200,22,1,"PAH",1,1,2,0)
(PSYCHIATRIC) to five Mental Health Diagnosis Related Groups (DRGs) 881, 
"PKG",200,22,1,"PAH",1,1,3,0)
882, 883, 885 and 886.  These charge items included R&B (Room & Board)
"PKG",200,22,1,"PAH",1,1,4,0)
101, Intensive Care Unit 200, and Ancillary Services 240 in the CHARGE
"PKG",200,22,1,"PAH",1,1,5,0)
ITEM file (#363.2).
"PKG",200,22,1,"PAH",1,1,6,0)
 
"PKG",200,22,1,"PAH",1,1,7,0)
This patch will still apply default code 124 to R&B but remove it for
"PKG",200,22,1,"PAH",1,1,8,0)
Intensive Care Unit 200, and Ancillary Services 240.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","IB20P572")
0^1^B8731091^n/a
"RTN","IB20P572",1,0)
IB20P572 ;ALB/CXW - IB*2.0*572 POST INIT: REVENUE CODE FOR MS-DRGS;08-10-2016
"RTN","IB20P572",2,0)
 ;;2.0;INTEGRATED BILLING;**572**;21-MAR-94;Build 39
"RTN","IB20P572",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","IB20P572",4,0)
 Q
"RTN","IB20P572",5,0)
 ;
"RTN","IB20P572",6,0)
POST ;
"RTN","IB20P572",7,0)
 N IBA,IBDT317,IBDT318 S U="^"
"RTN","IB20P572",8,0)
 D MSG("  Revenue Code 124 for Mental Health Diagnosis Fix Post-Install .....")
"RTN","IB20P572",9,0)
 ; effective date of RC v3.17 or RC v3.18
"RTN","IB20P572",10,0)
 S IBDT317=3151001,IBDT318=3160101
"RTN","IB20P572",11,0)
 D RVDRG(IBDT317,IBDT318)
"RTN","IB20P572",12,0)
 D MSG("  Revenue Code 124 for Mental Health Diagnosis Fix Post-Install Complete")
"RTN","IB20P572",13,0)
 Q
"RTN","IB20P572",14,0)
 ;
"RTN","IB20P572",15,0)
 ;
"RTN","IB20P572",16,0)
RVDRG(IBDT317,IBDT318) ; default rvc to 124 for DRGs in Reasonable Charges (#363.2)
"RTN","IB20P572",17,0)
 ;
"RTN","IB20P572",18,0)
 N IB561,IBD101,IBCNT,IBCNO,IBRVC,IBCS,IBCS0,IBBR0,IBDRGC,IBDRGF,IBXRF,IBITM,IBNEF,IBCI,IBCI0,IBCIA
"RTN","IB20P572",19,0)
 N DA,DIE,DR,DT,X,X1,X2,Y
"RTN","IB20P572",20,0)
 S (IBCNO,IBCNT)=0,IB561="IB20P572"
"RTN","IB20P572",21,0)
 ;
"RTN","IB20P572",22,0)
 ; charge items for drgs store in xtmp for 30 days for tracking purpose 
"RTN","IB20P572",23,0)
 ; xtmp(name,0)=purge dt_U_today dt_U_patch#_U_total update_U_total rec.
"RTN","IB20P572",24,0)
 ; xtmp(name,charge set ien,charge item ien)=charge item before update 
"RTN","IB20P572",25,0)
 K ^XTMP(IB561)
"RTN","IB20P572",26,0)
 S DT=$$DT^XLFDT,X1=DT,X2=30 D C^%DTC
"RTN","IB20P572",27,0)
 S ^XTMP(IB561,0)=X_U_DT_U_"IB*2.0*572 POST-INIT"
"RTN","IB20P572",28,0)
 ;
"RTN","IB20P572",29,0)
 D MSG("")
"RTN","IB20P572",30,0)
 D MSG(">>Correcting 124 for MH DRGs of R&B 101 on 1-OCT-15 or 1-JAN-16: 881, 882, 883, 885 & 886...")
"RTN","IB20P572",31,0)
 S IBRVC=$O(^DGCR(399.2,"B",124,0))
"RTN","IB20P572",32,0)
 I 'IBRVC D MSG("    ** Error: Revenue Code 124 undefined, not added") G RVDRGQ
"RTN","IB20P572",33,0)
 ;
"RTN","IB20P572",34,0)
 S IBCS=0 F  S IBCS=$O(^IBE(363.1,IBCS)) Q:'IBCS  D
"RTN","IB20P572",35,0)
 . S IBCS0=$G(^IBE(363.1,IBCS,0)) Q:IBCS0=""
"RTN","IB20P572",36,0)
 . S IBD101=+$P(IBCS0,U,5)
"RTN","IB20P572",37,0)
 . S IBBR0=$G(^IBE(363.3,+$P(IBCS0,U,2),0)) I IBBR0'["RC INPATIENT" Q
"RTN","IB20P572",38,0)
 . ;
"RTN","IB20P572",39,0)
 . S IBXRF="AIVDTS"_IBCS
"RTN","IB20P572",40,0)
 . S IBITM=0 F  S IBITM=$O(^IBA(363.2,IBXRF,IBITM)) Q:'IBITM  D
"RTN","IB20P572",41,0)
 .. S IBNEF="" F  S IBNEF=$O(^IBA(363.2,IBXRF,IBITM,IBNEF)) Q:IBNEF=""  I (IBNEF=-IBDT317)!(IBNEF=-IBDT318) D 
"RTN","IB20P572",42,0)
 ... S IBCI=0 F  S IBCI=$O(^IBA(363.2,IBXRF,IBITM,IBNEF,IBCI)) Q:'IBCI  D
"RTN","IB20P572",43,0)
 .... S IBCIA=$G(^IBA(363.2,IBCI,0)) Q:IBCIA=""
"RTN","IB20P572",44,0)
 .... S IBCI0=$P(IBCIA,U,1)
"RTN","IB20P572",45,0)
 .... S IBDRGC=$P(IBCI0,";",1)
"RTN","IB20P572",46,0)
 .... S IBDRGF=$P(IBCI0,";",2) Q:IBDRGF'="ICD("
"RTN","IB20P572",47,0)
 .... I '$F("^881^882^883^885^886^",(U_IBDRGC_U)) Q
"RTN","IB20P572",48,0)
 .... S ^XTMP(IB561,IBCS,+IBCI)=IBCIA
"RTN","IB20P572",49,0)
 .... S IBCNO=IBCNO+1
"RTN","IB20P572",50,0)
 .... ; remove 124 if not r&b 101 and exists
"RTN","IB20P572",51,0)
 .... I IBD101'=101 D  Q
"RTN","IB20P572",52,0)
 ..... I $P(IBCIA,U,6)="" Q
"RTN","IB20P572",53,0)
 ..... S DIE="^IBA(363.2,",DA=+IBCI
"RTN","IB20P572",54,0)
 ..... S DR=".06///@" D ^DIE K DIE,DA,DR,X,Y
"RTN","IB20P572",55,0)
 ..... S ^XTMP(IB561,IBCS,+IBCI)=IBCIA_U_"D"
"RTN","IB20P572",56,0)
 ..... S IBCNT=IBCNT+1
"RTN","IB20P572",57,0)
 .... ;
"RTN","IB20P572",58,0)
 .... I $P(IBCIA,U,6)=IBRVC Q
"RTN","IB20P572",59,0)
 .... S DIE="^IBA(363.2,",DA=+IBCI
"RTN","IB20P572",60,0)
 .... S DR=".06///"_IBRVC D ^DIE K DIE,DA,DR,X,Y
"RTN","IB20P572",61,0)
 .... S IBCNT=IBCNT+1
"RTN","IB20P572",62,0)
 ;
"RTN","IB20P572",63,0)
RVDRGQ S $P(^XTMP(IB561,0),U,4)=IBCNT_U_IBCNO
"RTN","IB20P572",64,0)
 D MSG("  Done.  "_IBCNT_" existing inpatient charge items updated (#363.2)")
"RTN","IB20P572",65,0)
 D MSG("")
"RTN","IB20P572",66,0)
 Q
"RTN","IB20P572",67,0)
 ;
"RTN","IB20P572",68,0)
 ;
"RTN","IB20P572",69,0)
MSG(IBA) ;
"RTN","IB20P572",70,0)
 D MES^XPDUTL(IBA)
"RTN","IB20P572",71,0)
 Q
"VER")
8.0^22.0
"BLD",10320,6)
^524
**END**
**END**

