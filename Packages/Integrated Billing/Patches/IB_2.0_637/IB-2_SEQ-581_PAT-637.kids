Released IB*2*637 SEQ #581
Extracted from mail message
**KIDS**:IB*2.0*637^

**INSTALL NAME**
IB*2.0*637
"BLD",11384,0)
IB*2.0*637^INTEGRATED BILLING^0^3190128^y
"BLD",11384,1,0)
^^5^5^3190118^
"BLD",11384,1,1,0)
This patch addresses the following issues:
"BLD",11384,1,2,0)
 
"BLD",11384,1,3,0)
- Update the MCCR UTILITY (#399.1) file for 2019.
"BLD",11384,1,4,0)
- Fix an undefined error at line A+7 in routine IBARXMP in the Push Rx 
"BLD",11384,1,5,0)
  Copay Cap Transactions [IBARXM CAP TRANS PUSH] option. 
"BLD",11384,4,0)
^9.64PA^^0
"BLD",11384,6)
^542
"BLD",11384,6.3)
29
"BLD",11384,"ABPKG")
n
"BLD",11384,"INIT")
POST^IB20P637
"BLD",11384,"KRN",0)
^9.67PA^1.61^23
"BLD",11384,"KRN",.4,0)
.4
"BLD",11384,"KRN",.401,0)
.401
"BLD",11384,"KRN",.402,0)
.402
"BLD",11384,"KRN",.403,0)
.403
"BLD",11384,"KRN",.5,0)
.5
"BLD",11384,"KRN",.84,0)
.84
"BLD",11384,"KRN",1.6,0)
1.6
"BLD",11384,"KRN",1.61,0)
1.61
"BLD",11384,"KRN",1.62,0)
1.62
"BLD",11384,"KRN",3.6,0)
3.6
"BLD",11384,"KRN",3.8,0)
3.8
"BLD",11384,"KRN",9.2,0)
9.2
"BLD",11384,"KRN",9.8,0)
9.8
"BLD",11384,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",11384,"KRN",9.8,"NM",1,0)
IBARXMP^^0^B8996586
"BLD",11384,"KRN",9.8,"NM",2,0)
IB20P637^^0^B7163225
"BLD",11384,"KRN",9.8,"NM","B","IB20P637",2)

"BLD",11384,"KRN",9.8,"NM","B","IBARXMP",1)

"BLD",11384,"KRN",19,0)
19
"BLD",11384,"KRN",19.1,0)
19.1
"BLD",11384,"KRN",101,0)
101
"BLD",11384,"KRN",409.61,0)
409.61
"BLD",11384,"KRN",771,0)
771
"BLD",11384,"KRN",779.2,0)
779.2
"BLD",11384,"KRN",870,0)
870
"BLD",11384,"KRN",8989.51,0)
8989.51
"BLD",11384,"KRN",8989.52,0)
8989.52
"BLD",11384,"KRN",8994,0)
8994
"BLD",11384,"KRN","B",.4,.4)

"BLD",11384,"KRN","B",.401,.401)

"BLD",11384,"KRN","B",.402,.402)

"BLD",11384,"KRN","B",.403,.403)

"BLD",11384,"KRN","B",.5,.5)

"BLD",11384,"KRN","B",.84,.84)

"BLD",11384,"KRN","B",1.6,1.6)

"BLD",11384,"KRN","B",1.61,1.61)

"BLD",11384,"KRN","B",1.62,1.62)

"BLD",11384,"KRN","B",3.6,3.6)

"BLD",11384,"KRN","B",3.8,3.8)

"BLD",11384,"KRN","B",9.2,9.2)

"BLD",11384,"KRN","B",9.8,9.8)

"BLD",11384,"KRN","B",19,19)

"BLD",11384,"KRN","B",19.1,19.1)

"BLD",11384,"KRN","B",101,101)

"BLD",11384,"KRN","B",409.61,409.61)

"BLD",11384,"KRN","B",771,771)

"BLD",11384,"KRN","B",779.2,779.2)

"BLD",11384,"KRN","B",870,870)

"BLD",11384,"KRN","B",8989.51,8989.51)

"BLD",11384,"KRN","B",8989.52,8989.52)

"BLD",11384,"KRN","B",8994,8994)

"BLD",11384,"QUES",0)
^9.62^^
"BLD",11384,"REQB",0)
^9.611^1^1
"BLD",11384,"REQB",1,0)
IB*2.0*158^2
"BLD",11384,"REQB","B","IB*2.0*158",1)

"INIT")
POST^IB20P637
"MBREQ")
0
"PKG",200,-1)
1^1
"PKG",200,0)
INTEGRATED BILLING^IB^INTEGRATED BILLING
"PKG",200,22,0)
^9.49I^1^1
"PKG",200,22,1,0)
2.0^2940321^2990406^2447
"PKG",200,22,1,"PAH",1,0)
637^3190128
"PKG",200,22,1,"PAH",1,1,0)
^^5^5^3190128
"PKG",200,22,1,"PAH",1,1,1,0)
This patch addresses the following issues:
"PKG",200,22,1,"PAH",1,1,2,0)
 
"PKG",200,22,1,"PAH",1,1,3,0)
- Update the MCCR UTILITY (#399.1) file for 2019.
"PKG",200,22,1,"PAH",1,1,4,0)
- Fix an undefined error at line A+7 in routine IBARXMP in the Push Rx 
"PKG",200,22,1,"PAH",1,1,5,0)
  Copay Cap Transactions [IBARXM CAP TRANS PUSH] option. 
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","IB20P637")
0^2^B7163225^n/a
"RTN","IB20P637",1,0)
IB20P637 ;ALB/CXW - UPDATE MCCR UTILITY FILE ;01/16/2019
"RTN","IB20P637",2,0)
 ;;2.0;INTEGRATED BILLING;**637**;21-MAR-94;Build 29
"RTN","IB20P637",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","IB20P637",4,0)
 Q
"RTN","IB20P637",5,0)
POST ; 
"RTN","IB20P637",6,0)
 ; 2019 Update occurrence span/value codes in #399.1
"RTN","IB20P637",7,0)
 N IBZ,U S U="^"
"RTN","IB20P637",8,0)
 D MSG("    IB*2.0*637 Post-Install starts .....")
"RTN","IB20P637",9,0)
 D MCCR
"RTN","IB20P637",10,0)
 D MSG("    IB*2.0*637 Post-Install is complete.")
"RTN","IB20P637",11,0)
 Q
"RTN","IB20P637",12,0)
 ;
"RTN","IB20P637",13,0)
MCCR ; 2 types of codes
"RTN","IB20P637",14,0)
 N IBCNT,IBCOD,IBPE,IBFD,IBFD2,IBI,IBX
"RTN","IB20P637",15,0)
 S IBCNT=0
"RTN","IB20P637",16,0)
 ; Occurrence span code in fields #.11/piece 4, #.17/piece 10
"RTN","IB20P637",17,0)
 S IBPE=4,IBFD=.11,IBFD2=.17
"RTN","IB20P637",18,0)
 D MSG(""),MSG(" >>>Occurrence Span Code")
"RTN","IB20P637",19,0)
 F IBI=1:1 S IBX=$P($T(OCSPU+IBI),";;",2) Q:IBX="Q"  D MFILE
"RTN","IB20P637",20,0)
 ;
"RTN","IB20P637",21,0)
 ; Value code in field #.18/piece 11
"RTN","IB20P637",22,0)
 S IBPE=11,IBFD=.18
"RTN","IB20P637",23,0)
 D MSG(""),MSG(" >>>Value Code")
"RTN","IB20P637",24,0)
 F IBI=1:1 S IBX=$P($T(VALU+IBI),";;",2) Q:IBX="Q"  D MFILE
"RTN","IB20P637",25,0)
 D MSG(""),MSG(" Total "_IBCNT_" code"_$S(IBCNT'=1:"s",1:"")_" updated in the MCCR UTILITY (#399.1) file")
"RTN","IB20P637",26,0)
 D MSG("")
"RTN","IB20P637",27,0)
 Q
"RTN","IB20P637",28,0)
 ;
"RTN","IB20P637",29,0)
MFILE ; Update to the mccr utility file
"RTN","IB20P637",30,0)
 N IBA,IBB,IBC,IBFN,IBMS,IBX2,IBX3,IBY,DLAYGO,DIC,DIE,DA,DD,DO,DR,X,Y
"RTN","IB20P637",31,0)
 S IBA=$P(IBX,U),IBB=$P(IBX,U,2),IBC=$P(IBX,U,3)
"RTN","IB20P637",32,0)
 S IBMS=$S(IBC=1:"updated",1:"added")
"RTN","IB20P637",33,0)
 S IBY="    #"_IBA_" "_IBB
"RTN","IB20P637",34,0)
 S IBFN=+$$EXCODE(IBA,IBPE)
"RTN","IB20P637",35,0)
 I IBFN D  Q:'IBFN
"RTN","IB20P637",36,0)
 . S DA=IBFN
"RTN","IB20P637",37,0)
 . S IBX3=$G(^DGCR(399.1,IBFN,0))
"RTN","IB20P637",38,0)
 . S IBX2=IBB_U_IBA
"RTN","IB20P637",39,0)
 . I $P(IBX3,U,1,2)=IBX2 D MSG(IBY_" already exists") S IBFN=0 Q
"RTN","IB20P637",40,0)
 ; 
"RTN","IB20P637",41,0)
 I 'IBFN D  Q:Y<1
"RTN","IB20P637",42,0)
 . S DLAYGO=399.1,DIC="^DGCR(399.1,",DIC(0)="L",X=IBB D FILE^DICN
"RTN","IB20P637",43,0)
 . I Y<1 D MSG(" >> ERROR when adding "_$S(IBPE=11:"Value",1:"Occurrence Span")_" Code #"_IBA_" to the #399.1 file, Log a ticket!") Q
"RTN","IB20P637",44,0)
 . S DA=+Y
"RTN","IB20P637",45,0)
 ; add override flag for new code if no found
"RTN","IB20P637",46,0)
 S DIE="^DGCR(399.1,",DR=".01///"_IBB_";.02///"_IBA_";"_IBFD_"///1"
"RTN","IB20P637",47,0)
 S:IBPE=11 DR=DR_";.19////1" S:IBPE=4 DR=DR_";"_IBFD2_"////1" D ^DIE
"RTN","IB20P637",48,0)
 S IBCNT=IBCNT+1
"RTN","IB20P637",49,0)
 D MSG(IBY_" "_IBMS)
"RTN","IB20P637",50,0)
 Q
"RTN","IB20P637",51,0)
 ;
"RTN","IB20P637",52,0)
EXCODE(IBCOD,IBPE) ; Returns IEN if code found in the IBPE piece
"RTN","IB20P637",53,0)
 N IBX,IBY S IBY=""
"RTN","IB20P637",54,0)
 I $G(IBCOD)'="" S IBX=0 F  S IBX=$O(^DGCR(399.1,"C",IBCOD,IBX)) Q:'IBX  I $P($G(^DGCR(399.1,IBX,0)),U,+$G(IBPE)) S IBY=IBX
"RTN","IB20P637",55,0)
 Q IBY
"RTN","IB20P637",56,0)
 ;
"RTN","IB20P637",57,0)
MSG(IBZ) ;
"RTN","IB20P637",58,0)
 D MES^XPDUTL(IBZ) Q
"RTN","IB20P637",59,0)
 ;
"RTN","IB20P637",60,0)
OCSPU ; Occurrence span code (2)^name^1 - update
"RTN","IB20P637",61,0)
 ;;72^FIRST/LAST DAY^1
"RTN","IB20P637",62,0)
 ;;74^LEAVE OF ABSENCE DATES^1
"RTN","IB20P637",63,0)
 ;;Q
"RTN","IB20P637",64,0)
 ;
"RTN","IB20P637",65,0)
VALU ; Value code (2)^name^1 - update
"RTN","IB20P637",66,0)
 ;;04^PROFESSIONAL COMPONENT CHARGES, COMBINED BILLED^1
"RTN","IB20P637",67,0)
 ;;Q
"RTN","IB20P637",68,0)
 ;
"RTN","IBARXMP")
0^1^B8996586^B8975083
"RTN","IBARXMP",1,0)
IBARXMP ;LL/ELZ - PHARMCAY COPAY CAP PUSH TRANSACTION ;26-APR-2001
"RTN","IBARXMP",2,0)
 ;;2.0;INTEGRATED BILLING;**150,158,637**;21-MAR-94;Build 29
"RTN","IBARXMP",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","IBARXMP",4,0)
 ;
"RTN","IBARXMP",5,0)
PUSH ; this entry point will allow the user to select one or all transactions
"RTN","IBARXMP",6,0)
 ; and transmit them to other treating facilities.  This is used to try
"RTN","IBARXMP",7,0)
 ; to resolve untransmitted transactions.  First IRM should verify the
"RTN","IBARXMP",8,0)
 ; HL7 link is working properly.
"RTN","IBARXMP",9,0)
 ;
"RTN","IBARXMP",10,0)
 N DIR,X,Y,DIRUT,DTOUT,DUOUT,DIROUT,IBER
"RTN","IBARXMP",11,0)
 ;
"RTN","IBARXMP",12,0)
 W !!,"This option will attempt to transmit un-transmitted copay cap transactions.",!,"You can select to send all un-transmitted transactions or selected"
"RTN","IBARXMP",13,0)
 W !,"individual transactions.  If you choose All, it could tie up your terminal",!,"session for some time.",!
"RTN","IBARXMP",14,0)
 S DIR(0)="S^A:All;I:Individual",DIR("A")="Do you want to transmit All or Individual transactions" D ^DIR Q:$D(DIRUT)
"RTN","IBARXMP",15,0)
 ;
"RTN","IBARXMP",16,0)
 D @Y
"RTN","IBARXMP",17,0)
 Q
"RTN","IBARXMP",18,0)
I ; transmits selected individual transactions
"RTN","IBARXMP",19,0)
 N DIC,X,Y,IBZ,IBX,%,%Y,IBTFL,DFN,IBY,IBS,IBONE
"RTN","IBARXMP",20,0)
 ;
"RTN","IBARXMP",21,0)
 S DIC="^IBAM(354.71,",DIC(0)="AEMNQZ",IBS=+$P($$SITE^IBARXMU,"^",3),DIC("S")="I $E(^(0),1,3)=IBS" D ^DIC Q:Y<1
"RTN","IBARXMP",22,0)
 S IBX=+Y,IBZ=Y(0),DFN=$P(IBZ,"^",2),IBTFL=$$TFL^IBARXMU(DFN,.IBTFL),IBY=1
"RTN","IBARXMP",23,0)
 ;
"RTN","IBARXMP",24,0)
 I IBTFL,($P(IBZ,"^",5)="C"!($P(IBZ,"^",5)="X")) W !!,"This transaction appears to already be transmitted.",!,"Do you want to transmit again" S %=2 D YN^DICN G:%'=1 I S IBONE=1
"RTN","IBARXMP",25,0)
 ;
"RTN","IBARXMP",26,0)
 I 'IBTFL W !!,"The patient for this transaction has no treating facilities to transmit to." D STATUS^IBARXMA(.IBY,IBX,0) G I
"RTN","IBARXMP",27,0)
 ;
"RTN","IBARXMP",28,0)
 D FOUND^IBARXMA(.IBY,IBX)
"RTN","IBARXMP",29,0)
 ;
"RTN","IBARXMP",30,0)
 U IO
"RTN","IBARXMP",31,0)
 I '$D(IBER) W !,"Transmission Successful !!",!
"RTN","IBARXMP",32,0)
 I $D(IBER) S X=0 F  S X=$O(IBER(X)) Q:'X  W !,"Error: ",X,"=",IBER(X)
"RTN","IBARXMP",33,0)
 W ! K IBER
"RTN","IBARXMP",34,0)
 ;
"RTN","IBARXMP",35,0)
 G I
"RTN","IBARXMP",36,0)
A ; transmits all un-transmitted transactions
"RTN","IBARXMP",37,0)
 N IBX,IBS
"RTN","IBARXMP",38,0)
 ;
"RTN","IBARXMP",39,0)
 I '$D(^IBAM(354.71,"AC","P")),'$D(^("Y")) W !!,"No Un-transmitted records to send.",!! Q
"RTN","IBARXMP",40,0)
 ;
"RTN","IBARXMP",41,0)
 F IBS="P","Y" S IBX=0 F  S IBX=$O(^IBAM(354.71,"AC",IBS,IBX)) Q:IBX<1  D
"RTN","IBARXMP",42,0)
 . N IBER,IBY,IBZ,DFN
"RTN","IBARXMP",43,0)
 . S IBY=1,IBZ=$G(^IBAM(354.71,IBX,0)) Q:IBZ=""
"RTN","IBARXMP",44,0)
 . S DFN=$P(IBZ,"^",2)
"RTN","IBARXMP",45,0)
 . W !,"Now transmitting ",$P(IBZ,"^")
"RTN","IBARXMP",46,0)
 . D FOUND^IBARXMA(.IBY,IBX)
"RTN","IBARXMP",47,0)
 . U IO
"RTN","IBARXMP",48,0)
 . I '$D(IBER) W !,"Transmission Successful !!",! Q
"RTN","IBARXMP",49,0)
 . I $D(IBER) S X=0 F  S X=$O(IBER(X)) Q:'X  W !,"Error: ",IBER(X)
"RTN","IBARXMP",50,0)
 . W ! K IBER
"RTN","IBARXMP",51,0)
 Q
"VER")
8.0^22.2
"BLD",11384,6)
^581
**END**
**END**

