Released RMPR*3*188 SEQ #163
Extracted from mail message
**KIDS**:RMPR*3.0*188^

**INSTALL NAME**
RMPR*3.0*188
"BLD",10575,0)
RMPR*3.0*188^PROSTHETICS^0^3170526^y
"BLD",10575,1,0)
^^2^2^3170526^
"BLD",10575,1,1,0)
When running the Delayed Order Report (DOR) in Prosthetics, the "Pt IEN"
"BLD",10575,1,2,0)
is not populated.
"BLD",10575,4,0)
^9.64PA^^
"BLD",10575,6.3)
1
"BLD",10575,"ABPKG")
n
"BLD",10575,"KRN",0)
^9.67PA^779.2^20
"BLD",10575,"KRN",.4,0)
.4
"BLD",10575,"KRN",.401,0)
.401
"BLD",10575,"KRN",.402,0)
.402
"BLD",10575,"KRN",.403,0)
.403
"BLD",10575,"KRN",.5,0)
.5
"BLD",10575,"KRN",.84,0)
.84
"BLD",10575,"KRN",3.6,0)
3.6
"BLD",10575,"KRN",3.8,0)
3.8
"BLD",10575,"KRN",9.2,0)
9.2
"BLD",10575,"KRN",9.8,0)
9.8
"BLD",10575,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10575,"KRN",9.8,"NM",1,0)
RMPR9DO^^0^B94877723
"BLD",10575,"KRN",9.8,"NM","B","RMPR9DO",1)

"BLD",10575,"KRN",19,0)
19
"BLD",10575,"KRN",19.1,0)
19.1
"BLD",10575,"KRN",101,0)
101
"BLD",10575,"KRN",409.61,0)
409.61
"BLD",10575,"KRN",771,0)
771
"BLD",10575,"KRN",779.2,0)
779.2
"BLD",10575,"KRN",870,0)
870
"BLD",10575,"KRN",8989.51,0)
8989.51
"BLD",10575,"KRN",8989.52,0)
8989.52
"BLD",10575,"KRN",8994,0)
8994
"BLD",10575,"KRN","B",.4,.4)

"BLD",10575,"KRN","B",.401,.401)

"BLD",10575,"KRN","B",.402,.402)

"BLD",10575,"KRN","B",.403,.403)

"BLD",10575,"KRN","B",.5,.5)

"BLD",10575,"KRN","B",.84,.84)

"BLD",10575,"KRN","B",3.6,3.6)

"BLD",10575,"KRN","B",3.8,3.8)

"BLD",10575,"KRN","B",9.2,9.2)

"BLD",10575,"KRN","B",9.8,9.8)

"BLD",10575,"KRN","B",19,19)

"BLD",10575,"KRN","B",19.1,19.1)

"BLD",10575,"KRN","B",101,101)

"BLD",10575,"KRN","B",409.61,409.61)

"BLD",10575,"KRN","B",771,771)

"BLD",10575,"KRN","B",779.2,779.2)

"BLD",10575,"KRN","B",870,870)

"BLD",10575,"KRN","B",8989.51,8989.51)

"BLD",10575,"KRN","B",8989.52,8989.52)

"BLD",10575,"KRN","B",8994,8994)

"BLD",10575,"QUES",0)
^9.62^^
"BLD",10575,"REQB",0)
^9.611^1^1
"BLD",10575,"REQB",1,0)
RMPR*3.0*163^1
"BLD",10575,"REQB","B","RMPR*3.0*163",1)

"MBREQ")
0
"PKG",280,-1)
1^1
"PKG",280,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",280,20,0)
^9.402P^^0
"PKG",280,22,0)
^9.49I^1^1
"PKG",280,22,1,0)
3.0^2960209^2970624
"PKG",280,22,1,"PAH",1,0)
188^3170526
"PKG",280,22,1,"PAH",1,1,0)
^^2^2^3170526
"PKG",280,22,1,"PAH",1,1,1,0)
When running the Delayed Order Report (DOR) in Prosthetics, the "Pt IEN"
"PKG",280,22,1,"PAH",1,1,2,0)
is not populated.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RMPR9DO")
0^1^B94877723^B94727310
"RTN","RMPR9DO",1,0)
RMPR9DO ;HOIFO/HNC -  ORDER CONROL PROCESSING-REMOTE PROCEDURE ;9/8/03  07:12
"RTN","RMPR9DO",2,0)
 ;;3.0;PROSTHETICS;**59,77,90,60,135,163,188**;Feb 09, 1996;Build 1
"RTN","RMPR9DO",3,0)
 ;
"RTN","RMPR9DO",4,0)
 ;8/5/03 Make sure no dups, HNC patch 77
"RTN","RMPR9DO",5,0)
 ;
"RTN","RMPR9DO",6,0)
 ;Patch RMPR*3.0*163 check all three $O for x-ref 'L', 'L1' and 'CD' to
"RTN","RMPR9DO",7,0)
 ;insure the linked master record has a node 0 defined.
"RTN","RMPR9DO",8,0)
 ;
"RTN","RMPR9DO",9,0)
A1(START,STOP,SITE,SORT,DATE,WHAT) ;entry point for rollup
"RTN","RMPR9DO",10,0)
 ;activated from (option name)
"RTN","RMPR9DO",11,0)
 I WHAT="S" D
"RTN","RMPR9DO",12,0)
 .S STN1=0
"RTN","RMPR9DO",13,0)
 .F  S STN1=$O(^RMPR(669.9,STN1)) Q:STN1'>0  D
"RTN","RMPR9DO",14,0)
 . .S SITE=STN1
"RTN","RMPR9DO",15,0)
 . .D A2
"RTN","RMPR9DO",16,0)
 I WHAT="ALL" G A2
"RTN","RMPR9DO",17,0)
 Q
"RTN","RMPR9DO",18,0)
EN(RESULT,DUZ,START,STOP,SITE,SORT,DATE,RMPRPRSN) ; -- Broker callback to get list to display
"RTN","RMPR9DO",19,0)
 ;entry to send to PCM, WHAT=ALL or S for Summary Only
"RTN","RMPR9DO",20,0)
 ;RMPRPRSN=P for Purchasing D for Delayed Order Report
"RTN","RMPR9DO",21,0)
 S (WHO,RMPRSC)=""
"RTN","RMPR9DO",22,0)
 I RMPRPRSN="P" S RMPRSC=$O(^RMPR(669.9,"PA",DUZ,RMPRSC)) Q:(RMPRSC="")!(WHO'="")  D
"RTN","RMPR9DO",23,0)
 . I '$D(^RMPR(669.9,RMPRSC,0)) Q
"RTN","RMPR9DO",24,0)
 . I '$D(^RMPR(669.9,RMPRSC,5,"B",DUZ)) Q
"RTN","RMPR9DO",25,0)
 . S WHO=$O(^RMPR(669.9,RMPRSC,5,"B",DUZ,""))
"RTN","RMPR9DO",26,0)
 . I START="" S START=$P(^RMPR(669.9,RMPRSC,5,WHO,0),U,2)
"RTN","RMPR9DO",27,0)
 . I STOP="" S STOP=$P(^RMPR(669.9,RMPRSC,5,WHO,0),U,3)
"RTN","RMPR9DO",28,0)
A2 N STRING,CLREND,COLUMN,ON,OFF
"RTN","RMPR9DO",29,0)
 Q:SORT=""
"RTN","RMPR9DO",30,0)
 Q:DATE=""
"RTN","RMPR9DO",31,0)
 Q:START=""
"RTN","RMPR9DO",32,0)
 Q:STOP=""
"RTN","RMPR9DO",33,0)
 Q:SITE=""
"RTN","RMPR9DO",34,0)
 I SITE'="ALL" S SITE=$P(^RMPR(669.9,SITE,0),U,2)
"RTN","RMPR9DO",35,0)
 K ^TMP($J)
"RTN","RMPR9DO",36,0)
 N RMPRA,CDATE,X
"RTN","RMPR9DO",37,0)
 K ADATE,PDAY,RMPRCD
"RTN","RMPR9DO",38,0)
 S VALMCNT=0,RRX=""
"RTN","RMPR9DO",39,0)
 ;if sort for open or pending include all regardless of date
"RTN","RMPR9DO",40,0)
 ;if sort for cancelled or closed include from date passed forward
"RTN","RMPR9DO",41,0)
 ;
"RTN","RMPR9DO",42,0)
 ;PPD# status=pending before date, total days create to 1st action
"RTN","RMPR9DO",43,0)
 ;MHD# manual totals days create to 1st action
"RTN","RMPR9DO",44,0)
 ;CHD# consult totals days create to 1st action
"RTN","RMPR9DO",45,0)
 ;PPDD# status=pending before date, total days in pending state, 1st
"RTN","RMPR9DO",46,0)
 ;      action to current date
"RTN","RMPR9DO",47,0)
 ;
"RTN","RMPR9DO",48,0)
 S (LINE,MHD1,MHD2,MHD3,MHD4,MHD5,CHD1,CHD2,CHD3,CHD4,CHD5,CLNK,MLNK)=0
"RTN","RMPR9DO",49,0)
 S (PPDAY,PPD,PPD1,PPD2,PPD3,PPD4,PPD5)=0
"RTN","RMPR9DO",50,0)
 S (PPDDAY,PPDD1,PPDD2,PPDD3,PPDD4,PPDD5)=0
"RTN","RMPR9DO",51,0)
 I SORT["O"!(SORT["P") D ALL
"RTN","RMPR9DO",52,0)
 I SORT["C"!(SORT["X") D DTFWD
"RTN","RMPR9DO",53,0)
 ;S LINE=LINE+1
"RTN","RMPR9DO",54,0)
 S ^TMP($J,"A1")="^^^^^^^^"_MHD1_U_MHD2_U_MHD3_U_MHD4_U_MHD5_"^^^^"_MLNK_U_0
"RTN","RMPR9DO",55,0)
 I $G(WHAT)="S" S RMPRXM(1)=MHD1_U_MHD2_U_MHD3_U_MHD4_U_MHD5_U_MLNK_U_0
"RTN","RMPR9DO",56,0)
 ;S LINE=LINE+1
"RTN","RMPR9DO",57,0)
 S ^TMP($J,"A2")="^^^^^^^^"_CHD1_U_CHD2_U_CHD3_U_CHD4_U_CHD5_"^^^^"_CLNK_U_1
"RTN","RMPR9DO",58,0)
 I $G(WHAT)="S" S RMPRXM(2)=CHD1_U_CHD2_U_CHD3_U_CHD4_U_CHD5_U_CLNK_U_1
"RTN","RMPR9DO",59,0)
 ;S LINE=LINE+1
"RTN","RMPR9DO",60,0)
 I $G(WHAT)="S" S RMPRXM(3)=PPD1_U_PPD2_U_PPD3_U_PPD4_U_PPD5_U_U_2
"RTN","RMPR9DO",61,0)
 S ^TMP($J,"A3")="^^^^^^^^"_PPDD1_U_PPDD2_U_PPDD3_U_PPDD4_U_PPDD5_"^^^^^"_2
"RTN","RMPR9DO",62,0)
 ;S LINE=LINE+1
"RTN","RMPR9DO",63,0)
 S ^TMP($J,"A4")="^^^^^^^^"_PPD1_U_PPD2_U_PPD3_U_PPD4_U_PPD5_"^^^^^"_3
"RTN","RMPR9DO",64,0)
 ;quarter rollup with full data
"RTN","RMPR9DO",65,0)
 I $G(WHAT)="Q" D MAIL
"RTN","RMPR9DO",66,0)
 ;summary only
"RTN","RMPR9DO",67,0)
 I $G(WHAT)="S" D MAILG
"RTN","RMPR9DO",68,0)
 I $G(WHAT)="ALL" D MAILG,MAIL
"RTN","RMPR9DO",69,0)
 I '$G(WHAT) G EXIT
"RTN","RMPR9DO",70,0)
 Q
"RTN","RMPR9DO",71,0)
ALL ;all open pending records regardless of date passed
"RTN","RMPR9DO",72,0)
 S RMPRI1=0
"RTN","RMPR9DO",73,0)
 F RMPRI1=START:1:STOP D
"RTN","RMPR9DO",74,0)
 .I $L(RMPRI1)=1 S RMPRI=0_RMPRI1
"RTN","RMPR9DO",75,0)
 .E  S RMPRI=RMPRI1
"RTN","RMPR9DO",76,0)
 .S RMPRST=""
"RTN","RMPR9DO",77,0)
 .F  S RMPRST=$O(^RMPR(668,"L1",RMPRI,RMPRST)) Q:RMPRST=""  D
"RTN","RMPR9DO",78,0)
 . .Q:RMPRST="X"
"RTN","RMPR9DO",79,0)
 . .Q:RMPRST="C"
"RTN","RMPR9DO",80,0)
 . .I SORT'["P"&(RMPRST="P") Q
"RTN","RMPR9DO",81,0)
 . .S RMPRA=0
"RTN","RMPR9DO",82,0)
 . .F  S RMPRA=$O(^RMPR(668,"L1",RMPRI,RMPRST,RMPRA)) Q:RMPRA'>0  D
"RTN","RMPR9DO",83,0)
 . . .Q:'$D(^RMPR(668,RMPRA,0))    ;;Patch RMPR*3.0*163 check
"RTN","RMPR9DO",84,0)
 . . .S STN=$P(^RMPR(668,RMPRA,0),U,7)
"RTN","RMPR9DO",85,0)
 . . .I SITE'="ALL"&(SITE'=STN) Q
"RTN","RMPR9DO",86,0)
 . . .S STNX=$$STATN^RMPRUTIL(STN)
"RTN","RMPR9DO",87,0)
 . . .I $G(WHAT)="S" S VISNX=$P($G(^RMPR(669.9,STN1,"INV")),U,2)
"RTN","RMPR9DO",88,0)
 . . .S STS=$P(^RMPR(668,RMPRA,0),U,10)
"RTN","RMPR9DO",89,0)
 . . .Q:STS["X"
"RTN","RMPR9DO",90,0)
 . . .Q:STS["C"
"RTN","RMPR9DO",91,0)
 . . .I SORT'["O"&(STS="O") Q
"RTN","RMPR9DO",92,0)
 . . .I SORT'["P"&(STS="P") Q
"RTN","RMPR9DO",93,0)
 . . .D REC
"RTN","RMPR9DO",94,0)
 Q
"RTN","RMPR9DO",95,0)
DTFWD ;from date passed forward
"RTN","RMPR9DO",96,0)
 S RMPRI1=0
"RTN","RMPR9DO",97,0)
 F RMPRI1=START:1:STOP D
"RTN","RMPR9DO",98,0)
 .I $L(RMPRI1)=1 S RMPRI=0_RMPRI1
"RTN","RMPR9DO",99,0)
 .E  S RMPRI=RMPRI1
"RTN","RMPR9DO",100,0)
 .S RMPRDTM=""
"RTN","RMPR9DO",101,0)
 .F  S RMPRDTM=$O(^RMPR(668,"L",RMPRI,RMPRDTM)) Q:RMPRDTM=""  D
"RTN","RMPR9DO",102,0)
 ..Q:RMPRDTM=""
"RTN","RMPR9DO",103,0)
 ..Q:RMPRDTM<DATE
"RTN","RMPR9DO",104,0)
 ..S RMPRST=""
"RTN","RMPR9DO",105,0)
 ..F  S RMPRST=$O(^RMPR(668,"L",RMPRI,RMPRDTM,RMPRST)) Q:RMPRST=""  D
"RTN","RMPR9DO",106,0)
 .. .Q:RMPRST="O"
"RTN","RMPR9DO",107,0)
 .. .Q:RMPRST="P"
"RTN","RMPR9DO",108,0)
 .. .I SORT'["X"&(RMPRST="X") Q
"RTN","RMPR9DO",109,0)
 .. .I SORT'["C"&(RMPRST="C") Q
"RTN","RMPR9DO",110,0)
 .. .S RMPRA=0
"RTN","RMPR9DO",111,0)
 .. .F  S RMPRA=$O(^RMPR(668,"L",RMPRI,RMPRDTM,RMPRST,RMPRA)) Q:RMPRA'>0  D
"RTN","RMPR9DO",112,0)
 .. . .Q:'$D(^RMPR(668,RMPRA,0))      ;;;;Patch RMPR*3.0*163 check
"RTN","RMPR9DO",113,0)
 .. . .Q:RMPRA=""
"RTN","RMPR9DO",114,0)
 .. . .S STN=$P(^RMPR(668,RMPRA,0),U,7)
"RTN","RMPR9DO",115,0)
 .. . .I SITE'="ALL"&(SITE'=STN) Q
"RTN","RMPR9DO",116,0)
 .. . .S STNX=$$STATN^RMPRUTIL(STN)
"RTN","RMPR9DO",117,0)
 .. . .I $G(WHAT)'="" S VISNX=$P($G(^RMPR(669.9,SITE,"INV")),U,2)
"RTN","RMPR9DO",118,0)
 .. . .S STS=$P(^RMPR(668,RMPRA,0),U,10)
"RTN","RMPR9DO",119,0)
 .. . .Q:STS["O"
"RTN","RMPR9DO",120,0)
 .. . .Q:STS["P"
"RTN","RMPR9DO",121,0)
 .. . .I SORT'["C"&(STS="C") Q
"RTN","RMPR9DO",122,0)
 .. . .I SORT'["X"&(STS="X") Q
"RTN","RMPR9DO",123,0)
 .. . .D REC
"RTN","RMPR9DO",124,0)
 S RMPRDTC=$P(DATE,".",1)
"RTN","RMPR9DO",125,0)
 F  S RMPRDTC=$O(^RMPR(668,"CD",RMPRDTC)) Q:RMPRDTC=""  D
"RTN","RMPR9DO",126,0)
 .Q:RMPRDTC<DATE
"RTN","RMPR9DO",127,0)
 .S RMPRDYS=0
"RTN","RMPR9DO",128,0)
 .F  S RMPRDYS=$O(^RMPR(668,"CD",RMPRDTC,RMPRDYS)) Q:RMPRDYS=""  D
"RTN","RMPR9DO",129,0)
 . .Q:RMPRDYS'>5
"RTN","RMPR9DO",130,0)
 . .S RMPRA=0
"RTN","RMPR9DO",131,0)
 . .F  S RMPRA=$O(^RMPR(668,"CD",RMPRDTC,RMPRDYS,RMPRA)) Q:RMPRA'>0  D
"RTN","RMPR9DO",132,0)
 . . .Q:'$D(^RMPR(668,RMPRA,0))     ;;Patch RMPR*3.0*163 check
"RTN","RMPR9DO",133,0)
 . . .;check site
"RTN","RMPR9DO",134,0)
 . . .S STN=$P(^RMPR(668,RMPRA,0),U,7)
"RTN","RMPR9DO",135,0)
 . . .I SITE'="ALL"&(SITE'=STN) Q
"RTN","RMPR9DO",136,0)
 . . .S STNX=$$STATN^RMPRUTIL(STN)
"RTN","RMPR9DO",137,0)
 . . .;check status
"RTN","RMPR9DO",138,0)
 . . .S STS=$P(^RMPR(668,RMPRA,0),U,10)
"RTN","RMPR9DO",139,0)
 . . .I SORT'["O"&(STS="O") Q
"RTN","RMPR9DO",140,0)
 . . .I SORT'["P"&(STS="P") Q
"RTN","RMPR9DO",141,0)
 . . .I SORT'["C"&(STS="C") Q
"RTN","RMPR9DO",142,0)
 . . .I SORT'["X"&(STS="X") Q
"RTN","RMPR9DO",143,0)
 . . .;ssn range filter
"RTN","RMPR9DO",144,0)
 . . .S DFN=$P(^RMPR(668,RMPRA,0),U,2)
"RTN","RMPR9DO",145,0)
 . . .D DEM^VADPT
"RTN","RMPR9DO",146,0)
 . . .S SSNEN=$E($P(VADM(2),"^",2),10,11)
"RTN","RMPR9DO",147,0)
 . . .I SSNEN>STOP Q
"RTN","RMPR9DO",148,0)
 . . .I SSNEN<START Q
"RTN","RMPR9DO",149,0)
 . . .K SSNEN,VADM
"RTN","RMPR9DO",150,0)
 . . .D REC
"RTN","RMPR9DO",151,0)
 Q
"RTN","RMPR9DO",152,0)
REC ;records to grid
"RTN","RMPR9DO",153,0)
 ;stop date, init action date
"RTN","RMPR9DO",154,0)
 ;check ien, patch 77
"RTN","RMPR9DO",155,0)
 ;
"RTN","RMPR9DO",156,0)
 Q:$D(^TMP($J,RMPRA))
"RTN","RMPR9DO",157,0)
 ;
"RTN","RMPR9DO",158,0)
 N DIC,DIQ,DR,STOPDT
"RTN","RMPR9DO",159,0)
 S DA=RMPRA
"RTN","RMPR9DO",160,0)
 S DIC=668,DIQ="RE",DR=10,DIQ(0)="EN" D EN^DIQ1
"RTN","RMPR9DO",161,0)
 S STOPDT=$P($G(^RMPR(668,RMPRA,0)),U,9),STOPDT=$$DAT2^RMPRUTL1(STOPDT)
"RTN","RMPR9DO",162,0)
 S LINE=LINE+1
"RTN","RMPR9DO",163,0)
 S CDATE=$P(^RMPR(668,RMPRA,0),U,1),CDATE=$$DAT2^RMPRUTL1(CDATE)
"RTN","RMPR9DO",164,0)
 S DFN=$P(^RMPR(668,RMPRA,0),U,2) Q:DFN=""
"RTN","RMPR9DO",165,0)
 N VA,VADM
"RTN","RMPR9DO",166,0)
 D DEM^VADPT
"RTN","RMPR9DO",167,0)
 S WHO=VADM(1)
"RTN","RMPR9DO",168,0)
 S SSN=VADM(2)
"RTN","RMPR9DO",169,0)
 D SVC^VADPT
"RTN","RMPR9DO",170,0)
 S RMPROEOI=$S(VASV(11)>0:"<!>",VASV(12)>0:"<!>",VASV(13)>0:"<!>",1:0)
"RTN","RMPR9DO",171,0)
 D KVAR^VADPT
"RTN","RMPR9DO",172,0)
 ;type
"RTN","RMPR9DO",173,0)
 S TYPE=$$TYPE^RMPREOU(RMPRA,8)
"RTN","RMPR9DO",174,0)
 ;display description if manual
"RTN","RMPR9DO",175,0)
 S DES=$$DES^RMPREOU(RMPRA,22)
"RTN","RMPR9DO",176,0)
 S DES=$TR(DES,"^","*")
"RTN","RMPR9DO",177,0)
 S DES=$TR(DES,"""","'")
"RTN","RMPR9DO",178,0)
 ;init action date
"RTN","RMPR9DO",179,0)
 S ADATE="",PDAY="",WRKDAY=""
"RTN","RMPR9DO",180,0)
 S ADATE=$P(^RMPR(668,RMPRA,0),U,9)
"RTN","RMPR9DO",181,0)
 ;PPD=1 for previous pending
"RTN","RMPR9DO",182,0)
 I ADATE'="" S (PDAY,WRKDAY)=$$WRKDAY^RMPREOU(RMPRA)
"RTN","RMPR9DO",183,0)
 I ADATE="" S (PDAY,WRKDAY)=$$CWRKDAY^RMPREOU(RMPRA) I $P(^RMPR(668,RMPRA,0),U,10)="X" S (PDAY,WRKDAY)=$$CANWKDY^RMPREOU(RMPRA)
"RTN","RMPR9DO",184,0)
 I ADATE'="" S CDAY=$$PDAY^RMPREOU(RMPRA)
"RTN","RMPR9DO",185,0)
 ;
"RTN","RMPR9DO",186,0)
 S STATUS=$$STATUS^RMPREOU(RMPRA)
"RTN","RMPR9DO",187,0)
 I STATUS["PENDING" D
"RTN","RMPR9DO",188,0)
 .I ADATE'=""&(ADATE<DATE) S PPD=1
"RTN","RMPR9DO",189,0)
 .S PPDAY=$$PWRKDAY^RMPREOU(RMPRA)
"RTN","RMPR9DO",190,0)
 S LINKED=$P($G(^RMPR(668,RMPRA,10,0)),U,4)
"RTN","RMPR9DO",191,0)
 I LINKED="" S LINKED=0
"RTN","RMPR9DO",192,0)
 ;
"RTN","RMPR9DO",193,0)
 I RMPROEOI="<!>" S WHO=RMPROEOI_WHO
"RTN","RMPR9DO",194,0)
 S ^TMP($J,RMPRA)=CDATE_U_WHO_U_SSN_U_TYPE_U_DES_U
"RTN","RMPR9DO",195,0)
 ;look at pday and parse
"RTN","RMPR9DO",196,0)
 S (HD1,HD2,HD3,HD4,HD5,DH6)=""
"RTN","RMPR9DO",197,0)
 ;SD Working Days in Pending Status
"RTN","RMPR9DO",198,0)
 S (SD1,SD2,SD3,SD4,SD5)=0
"RTN","RMPR9DO",199,0)
 I (PDAY>0)&(PDAY<6)!(PDAY=0) S HD1=PDAY,DH6="NO"
"RTN","RMPR9DO",200,0)
 I (PPDAY>0)&(PPDAY<6)!(PPDAY=0) S SD1=PPDAY
"RTN","RMPR9DO",201,0)
 I (PDAY>0)&(PDAY<6)&(TYPE["MANUAL")!(PDAY=0)&(TYPE["MANUAL") S MHD1=MHD1+1
"RTN","RMPR9DO",202,0)
 I (PDAY>0)&(PDAY<6)&(TYPE'["MANUAL")!(PDAY=0)&(TYPE'["MANUAL") S CHD1=CHD1+1
"RTN","RMPR9DO",203,0)
 I (PPDAY>0)&(PPDAY<6)&(STATUS["PENDING") S PPDD1=PPDD1+1
"RTN","RMPR9DO",204,0)
 I (PDAY>0)&(PDAY<6)&(PPD=1) S PPD1=PPD1+1
"RTN","RMPR9DO",205,0)
 I HD1=""  S HD1=0
"RTN","RMPR9DO",206,0)
 I (PDAY>5)&(PDAY<10) S HD2=PDAY,DH6="YES"
"RTN","RMPR9DO",207,0)
 I (PPDAY>5)&(PPDAY<10) S SD2=PPDAY
"RTN","RMPR9DO",208,0)
 I (PDAY>5)&(PDAY<10)&(TYPE["MANUAL") S MHD2=MHD2+1
"RTN","RMPR9DO",209,0)
 I (PDAY>5)&(PDAY<10)&(TYPE'["MANUAL") S CHD2=CHD2+1
"RTN","RMPR9DO",210,0)
 I (PPDAY>5)&(PPDAY<10)&(STATUS["PENDING") S PPDD2=PPDD2+1
"RTN","RMPR9DO",211,0)
 I (PDAY>5)&(PDAY<10)&(PPD=1) S PPD2=PPD2+1
"RTN","RMPR9DO",212,0)
 I HD2="" S HD2=0
"RTN","RMPR9DO",213,0)
 I (PDAY>9)&(PDAY<30) S HD3=PDAY,DH6="YES"
"RTN","RMPR9DO",214,0)
 I (PPDAY>9)&(PPDAY<30) S SD3=PPDAY
"RTN","RMPR9DO",215,0)
 I (PDAY>9)&(PDAY<30)&(TYPE["MANUAL") S MHD3=MHD3+1
"RTN","RMPR9DO",216,0)
 I (PDAY>9)&(PDAY<30)&(TYPE'["MANUAL") S CHD3=CHD3+1
"RTN","RMPR9DO",217,0)
 I (PPDAY>9)&(PPDAY<30)&(STATUS["PENDING") S PPDD3=PPDD3+1
"RTN","RMPR9DO",218,0)
 I (PDAY>9)&(PDAY<30)&(PPD=1) S PPD3=PPD3+1
"RTN","RMPR9DO",219,0)
 I HD3="" S HD3=0
"RTN","RMPR9DO",220,0)
 I (PDAY>29)&(PDAY<90) S HD4=PDAY,DH6="YES"
"RTN","RMPR9DO",221,0)
 I (PPDAY>29)&(PPDAY<90) S SD4=PPDAY
"RTN","RMPR9DO",222,0)
 I (PDAY>29)&(PDAY<90)&(TYPE["MANUAL") S MHD4=MHD4+1
"RTN","RMPR9DO",223,0)
 I (PDAY>29)&(PDAY<90)&(TYPE'["MANUAL") S CHD4=CHD4+1
"RTN","RMPR9DO",224,0)
 I (PPDAY>29)&(PPDAY<90)&(STATUS["PENDING") S PPDD4=PPDD4+1
"RTN","RMPR9DO",225,0)
 I (PDAY>29)&(PDAY<90)&(PPD=1) S PPD4=PPD4+1
"RTN","RMPR9DO",226,0)
 I HD4="" S HD4=0
"RTN","RMPR9DO",227,0)
 I PDAY>89 S HD5=PDAY,DH6="YES"
"RTN","RMPR9DO",228,0)
 I PPDAY>89 S SD5=PPDAY
"RTN","RMPR9DO",229,0)
 I (PDAY>89)&(TYPE["MANUAL") S MHD5=MHD5+1
"RTN","RMPR9DO",230,0)
 I (PDAY>89)&(TYPE'["MANUAL") S CHD5=CHD5+1
"RTN","RMPR9DO",231,0)
 I (PPDAY>89)&(STATUS["PENDING") S PPDD5=PPDD5+1
"RTN","RMPR9DO",232,0)
 I (PDAY>89)&(PPD=1) S PPD5=PPD5+1
"RTN","RMPR9DO",233,0)
 I HD5="" S HD5=0
"RTN","RMPR9DO",234,0)
 S (PPD,PPDAY)=0
"RTN","RMPR9DO",235,0)
 I LINKED'=0&(TYPE["MANUAL") S MLNK=MLNK+1
"RTN","RMPR9DO",236,0)
 I LINKED'=0&(TYPE'["MANUAL") S CLNK=CLNK+1
"RTN","RMPR9DO",237,0)
 S ^TMP($J,RMPRA)=^TMP($J,RMPRA)_STOPDT_U_DH6_U_HD1_U_HD2_U_HD3_U_HD4_U_HD5
"RTN","RMPR9DO",238,0)
 S ^TMP($J,RMPRA)=^TMP($J,RMPRA)_U_STATUS_U_RMPRA_U_STNX_U_LINKED
"RTN","RMPR9DO",239,0)
 S ^TMP($J,RMPRA)=^TMP($J,RMPRA)_U_U_SD1_U_SD2_U_SD3_U_SD4_U_SD5_U_DFN
"RTN","RMPR9DO",240,0)
 K CDATE,WHO,SSN,TYPE,DES,PDAY,STATUS,ADATE
"RTN","RMPR9DO",241,0)
 ;PUT RESULTS IN GLOBAL!!
"RTN","RMPR9DO",242,0)
 Q
"RTN","RMPR9DO",243,0)
EXIT ;common exit point
"RTN","RMPR9DO",244,0)
 S RESULT=$NA(^TMP($J))
"RTN","RMPR9DO",245,0)
 Q
"RTN","RMPR9DO",246,0)
MAIL ;send to PCM full dataset
"RTN","RMPR9DO",247,0)
 S XMY("G.RMPR SERVER")=""
"RTN","RMPR9DO",248,0)
 S XMY("G.PROSTHETICS@PSAS.DOMAIN.EXT")=""
"RTN","RMPR9DO",249,0)
 S XMDUZ=.5
"RTN","RMPR9DO",250,0)
 S XMSUB="Full DOR From Station: "_STNX
"RTN","RMPR9DO",251,0)
 N LASTIEN
"RTN","RMPR9DO",252,0)
 S LASTIEN="A1",LASTIEN=$O(^TMP($J,LASTIEN),-1)
"RTN","RMPR9DO",253,0)
 S ^TMP($J,LASTIEN+1)=^TMP($J,"A1")
"RTN","RMPR9DO",254,0)
 S ^TMP($J,LASTIEN+2)=^TMP($J,"A2")
"RTN","RMPR9DO",255,0)
 S ^TMP($J,LASTIEN+3)=^TMP($J,"A3")
"RTN","RMPR9DO",256,0)
 S ^TMP($J,LASTIEN+4)=^TMP($J,"A4")
"RTN","RMPR9DO",257,0)
 K ^TMP($J,"A1")
"RTN","RMPR9DO",258,0)
 K ^TMP($J,"A2")
"RTN","RMPR9DO",259,0)
 K ^TMP($J,"A3")
"RTN","RMPR9DO",260,0)
 K ^TMP($J,"A4")
"RTN","RMPR9DO",261,0)
 S XMTEXT="^TMP($J,"
"RTN","RMPR9DO",262,0)
 D ^XMD
"RTN","RMPR9DO",263,0)
 Q
"RTN","RMPR9DO",264,0)
MAILG ;Mail message to local staff
"RTN","RMPR9DO",265,0)
 S XMDUZ=.5
"RTN","RMPR9DO",266,0)
 S XMY("G.RMPR SERVER")=""
"RTN","RMPR9DO",267,0)
 S XMY("VHACOPSASPIPReport@DOMAIN.EXT")=""
"RTN","RMPR9DO",268,0)
 S XMSUB="DOR From Station: "_STNX
"RTN","RMPR9DO",269,0)
 S RMPRMSG(1)="The Automated Delayed Order Report has transmitted to Prosthetics HQ."
"RTN","RMPR9DO",270,0)
 S RMPRMSG(2)="This was activated by "_$P(XMFROM,"@",1)
"RTN","RMPR9DO",271,0)
 S RMPRMSG(3)=""
"RTN","RMPR9DO",272,0)
 S RMPRMSG(4)="Summary Data Transmitted, includes the following:"
"RTN","RMPR9DO",273,0)
 S RMPRMSG(5)="Totals for site "_STNX_" listed in the order of 0-5, 6-9, 10-29, 30-89, 90+"
"RTN","RMPR9DO",274,0)
 S RMPRMSG(6)="Seperated by ;"
"RTN","RMPR9DO",275,0)
 S RMPRMSG(7)="***Number of MANUALS      ;;"_STNX_";"_MHD1_";"_MHD2_";"_MHD3_";"_MHD4_";"_MHD5
"RTN","RMPR9DO",276,0)
 S RMPRMSG(8)="***Number of CONSULTS     ;;"_STNX_";"_CHD1_";"_CHD2_";"_CHD3_";"_CHD4_";"_CHD5
"RTN","RMPR9DO",277,0)
 S RMPRMSG(9)="***Minus Previous Pending ;;"_STNX_";"_PPD1_";"_PPD2_";"_PPD3_";"_PPD4_";"_PPD5
"RTN","RMPR9DO",278,0)
 S RMPRMSG(10)=""
"RTN","RMPR9DO",279,0)
 S XMTEXT="RMPRMSG("
"RTN","RMPR9DO",280,0)
 D ^XMD
"RTN","RMPR9DO",281,0)
 Q
"VER")
8.0^22.2
"BLD",10575,6)
^163
**END**
**END**

