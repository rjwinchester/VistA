Released RMPR*3*185 SEQ #168
Extracted from mail message
**KIDS**:RMPR*3.0*185^

**INSTALL NAME**
RMPR*3.0*185
"BLD",8521,0)
RMPR*3.0*185^PROSTHETICS^0^3171208^y
"BLD",8521,1,0)
^9.61A^5^5^3170502^^^^
"BLD",8521,1,1,0)
This distribution adds an option allowing Prosthetics end-users 
"BLD",8521,1,2,0)
to select an IFCAP Purchase Request (form 2237) by its Obligation 
"BLD",8521,1,3,0)
Number and post the individual line items to individual patients' 
"BLD",8521,1,4,0)
Prosthetics 2319 records and link to existing patient prosthetics 
"BLD",8521,1,5,0)
suspense record.
"BLD",8521,4,0)
^9.64PA^660^1
"BLD",8521,4,660,0)
660
"BLD",8521,4,660,2,0)
^9.641^660^1
"BLD",8521,4,660,2,660,0)
RECORD OF PROS APPLIANCE/REPAIR  (File-top level)
"BLD",8521,4,660,2,660,1,0)
^9.6411^42^2
"BLD",8521,4,660,2,660,1,41,0)
ECMS ACTIONUID
"BLD",8521,4,660,2,660,1,42,0)
UNIQUE ITEM ID
"BLD",8521,4,660,222)
y^n^p^^^^n^^n
"BLD",8521,4,660,224)

"BLD",8521,4,"APDD",660,660)

"BLD",8521,4,"APDD",660,660,41)

"BLD",8521,4,"APDD",660,660,42)

"BLD",8521,4,"B",660,660)

"BLD",8521,6.3)
19
"BLD",8521,"ABPKG")
n
"BLD",8521,"KRN",0)
^9.67PA^779.2^20
"BLD",8521,"KRN",.4,0)
.4
"BLD",8521,"KRN",.401,0)
.401
"BLD",8521,"KRN",.402,0)
.402
"BLD",8521,"KRN",.403,0)
.403
"BLD",8521,"KRN",.5,0)
.5
"BLD",8521,"KRN",.84,0)
.84
"BLD",8521,"KRN",3.6,0)
3.6
"BLD",8521,"KRN",3.8,0)
3.8
"BLD",8521,"KRN",9.2,0)
9.2
"BLD",8521,"KRN",9.8,0)
9.8
"BLD",8521,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",8521,"KRN",9.8,"NM",1,0)
RMPR37^^0^B31267977
"BLD",8521,"KRN",9.8,"NM",2,0)
RMPR37A^^0^B7729999
"BLD",8521,"KRN",9.8,"NM","B","RMPR37",1)

"BLD",8521,"KRN",9.8,"NM","B","RMPR37A",2)

"BLD",8521,"KRN",19,0)
19
"BLD",8521,"KRN",19,"NM",0)
^9.68A^2^2
"BLD",8521,"KRN",19,"NM",1,0)
RMPR PURCHASING MENU^^2
"BLD",8521,"KRN",19,"NM",2,0)
RMPR ECMS 2237^^0
"BLD",8521,"KRN",19,"NM","B","RMPR ECMS 2237",2)

"BLD",8521,"KRN",19,"NM","B","RMPR PURCHASING MENU",1)

"BLD",8521,"KRN",19.1,0)
19.1
"BLD",8521,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",8521,"KRN",101,0)
101
"BLD",8521,"KRN",409.61,0)
409.61
"BLD",8521,"KRN",771,0)
771
"BLD",8521,"KRN",779.2,0)
779.2
"BLD",8521,"KRN",870,0)
870
"BLD",8521,"KRN",8989.51,0)
8989.51
"BLD",8521,"KRN",8989.52,0)
8989.52
"BLD",8521,"KRN",8994,0)
8994
"BLD",8521,"KRN","B",.4,.4)

"BLD",8521,"KRN","B",.401,.401)

"BLD",8521,"KRN","B",.402,.402)

"BLD",8521,"KRN","B",.403,.403)

"BLD",8521,"KRN","B",.5,.5)

"BLD",8521,"KRN","B",.84,.84)

"BLD",8521,"KRN","B",3.6,3.6)

"BLD",8521,"KRN","B",3.8,3.8)

"BLD",8521,"KRN","B",9.2,9.2)

"BLD",8521,"KRN","B",9.8,9.8)

"BLD",8521,"KRN","B",19,19)

"BLD",8521,"KRN","B",19.1,19.1)

"BLD",8521,"KRN","B",101,101)

"BLD",8521,"KRN","B",409.61,409.61)

"BLD",8521,"KRN","B",771,771)

"BLD",8521,"KRN","B",779.2,779.2)

"BLD",8521,"KRN","B",870,870)

"BLD",8521,"KRN","B",8989.51,8989.51)

"BLD",8521,"KRN","B",8989.52,8989.52)

"BLD",8521,"KRN","B",8994,8994)

"BLD",8521,"QDEF")
^^^^NO^^^^YES^^NO
"BLD",8521,"QUES",0)
^9.62^^
"BLD",8521,"REQB",0)
^9.611^2^2
"BLD",8521,"REQB",1,0)
RMPR*3.0*130^0
"BLD",8521,"REQB",2,0)
RMPR*3.0*178^2
"BLD",8521,"REQB","B","RMPR*3.0*130",1)

"BLD",8521,"REQB","B","RMPR*3.0*178",2)

"FIA",660)
RECORD OF PROS APPLIANCE/REPAIR
"FIA",660,0)
^RMPR(660,
"FIA",660,0,0)
660OID
"FIA",660,0,1)
y^n^p^^^^n^^n
"FIA",660,0,10)

"FIA",660,0,11)

"FIA",660,0,"RLRO")

"FIA",660,0,"VR")
3.0^RMPR
"FIA",660,660)
1
"FIA",660,660,41)

"FIA",660,660,42)

"KRN",19,10837,-1)
0^2
"KRN",19,10837,0)
RMPR ECMS 2237^Record eCMS/IFCAP 2237 Purchase to 2319^^R^^^^^^^^PROSTHETICS
"KRN",19,10837,1,0)
^19.06^2^2^3170511^^^
"KRN",19,10837,1,1,0)
This option will record the information from an eCMS or IFCAP transaction
"KRN",19,10837,1,2,0)
VAF 2237 purchase request to a patient's VAF 10-2319 record.
"KRN",19,10837,25)
RMPR37
"KRN",19,10837,"U")
RECORD ECMS/IFCAP 2237 PURCHAS
"KRN",19,2901160,-1)
2^1
"KRN",19,2901160,0)
RMPR PURCHASING MENU^Purchasing^^M^42243^^^^^^^148^^
"KRN",19,2901160,10,0)
^19.01IP^26^26
"KRN",19,2901160,10,26,0)
10837^RE
"KRN",19,2901160,10,26,"^")
RMPR ECMS 2237
"KRN",19,2901160,"U")
PURCHASING
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",148,-1)
1^1
"PKG",148,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",148,20,0)
^9.402P^^0
"PKG",148,22,0)
^9.49I^1^1
"PKG",148,22,1,0)
3.0^2960209^2960323
"PKG",148,22,1,"PAH",1,0)
185^3171208
"PKG",148,22,1,"PAH",1,1,0)
^^5^5^3171208
"PKG",148,22,1,"PAH",1,1,1,0)
This distribution adds an option allowing Prosthetics end-users 
"PKG",148,22,1,"PAH",1,1,2,0)
to select an IFCAP Purchase Request (form 2237) by its Obligation 
"PKG",148,22,1,"PAH",1,1,3,0)
Number and post the individual line items to individual patients' 
"PKG",148,22,1,"PAH",1,1,4,0)
Prosthetics 2319 records and link to existing patient prosthetics 
"PKG",148,22,1,"PAH",1,1,5,0)
suspense record.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","RMPR37")
0^1^B31267977^Delete
"RTN","RMPR37",1,0)
RMPR37 ;PHX/HNC,JLT-POST AN ECMS 2237 TO 10-2319 ;8/29/1994
"RTN","RMPR37",2,0)
 ;;3.0;PROSTHETICS;**6,34,35,41,62,130,185**;Feb 09, 1996;Build 19
"RTN","RMPR37",3,0)
 ;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RMPR37",4,0)
 ;
"RTN","RMPR37",5,0)
 ;RVD patch #62 - PCE interface
"RTN","RMPR37",6,0)
 ;    patch #130 - Routine temporarily removed from Prosthetics
"RTN","RMPR37",7,0)
 ;DDA patch #185 - Reinstated for eCMS/IFCAP purchase requests
"RTN","RMPR37",8,0)
 ;
"RTN","RMPR37",9,0)
 K ^TMP($J,"RMPRPCE")
"RTN","RMPR37",10,0)
 D DIV4^RMPRSIT G:$D(X) EXIT
"RTN","RMPR37",11,0)
OBL ;get obligation number
"RTN","RMPR37",12,0)
 S DIC("S")="I $P(^(0),U,4)>1&($P(^(0),U,4)<5)"
"RTN","RMPR37",13,0)
 S DIC(0)="EQZ",DIC="^PRCS(410,"
"RTN","RMPR37",14,0)
 S DIC("A")="Select OBLIGATION NUMBER: "
"RTN","RMPR37",15,0)
 K R410
"RTN","RMPR37",16,0)
 D ^PRCSDIC G:Y'>0 EXIT
"RTN","RMPR37",17,0)
 I $P(Y(0),U,2)="CA" W !!,$C(7),?5,"OBILIGATION TRANSACTION CANCELED",! G OBL
"RTN","RMPR37",18,0)
 S RMPR2237=$P(Y,"^",2)
"RTN","RMPR37",19,0)
 S %X=DIC_+Y_",",%Y="R410(" D %XY^%RCR K %X,%Y,DIC
"RTN","RMPR37",20,0)
 ; CHECK FOR eCMS ACTIONID
"RTN","RMPR37",21,0)
 S RMPREAID=$P(R410(1),U,8)
"RTN","RMPR37",22,0)
 S RMPRPO=$P(R410(4),U,5)
"RTN","RMPR37",23,0)
 I RMPRPO="" W !!,$C(7),?5,"**WARNING -- THIS 2237 DOES NOT HAVE AN IFCAP PURCHASE ORDER **",!
"RTN","RMPR37",24,0)
DSP ;display obligation line items
"RTN","RMPR37",25,0)
 K RIT,RIB D HOME^%ZIS W @IOF K RIT,FL,RD
"RTN","RMPR37",26,0)
DSP0 ;DISPLAY BUT WITHOUT CLEARING THE SCREEN.
"RTN","RMPR37",27,0)
 S (CTT,ITN,LCT,PCT)=0 F  S ITN=$O(R410("IT",ITN)) Q:ITN'>0  S LCT=LCT+1 D A^RMPR37A
"RTN","RMPR37",28,0)
 I LCT=PCT W !,"All lines of this 2237 have been posted.",! H 5 G OBL
"RTN","RMPR37",29,0)
ASK ;ask item to post 
"RTN","RMPR37",30,0)
 S X=CTT D COMMA^%DTC
"RTN","RMPR37",31,0)
 W !?34,"TOTAL EST. COST:  ",X
"RTN","RMPR37",32,0)
 S X=$P(R410(4),U,3) D COMMA^%DTC
"RTN","RMPR37",33,0)
 W !?34,"OBLIGATED AMOUNT: ",X S D1=0 W !,"REMARKS:",!
"RTN","RMPR37",34,0)
 F  S D1=$O(R410("RM",D1)) Q:D1'>0  W !,R410("RM",D1,0)
"RTN","RMPR37",35,0)
 W !!,"VENDOR: ",$P(R410(2),U,1)
"RTN","RMPR37",36,0)
 K DIR
"RTN","RMPR37",37,0)
 S DIR("?")="Enter the Line Item # you wish to post."
"RTN","RMPR37",38,0)
 W ! S DIR(0)="N^1:"_LCT
"RTN","RMPR37",39,0)
 S DIR("A")="Please enter Line Item #"
"RTN","RMPR37",40,0)
 D ^DIR
"RTN","RMPR37",41,0)
 I '$D(DTOUT),'$D(DIRUT),$D(X) S (RMPRY,RZ)=X
"RTN","RMPR37",42,0)
 I $D(DTOUT)!($D(DIRUT))!(Y=-1) W !,"Please Try Later!" G OBL
"RTN","RMPR37",43,0)
 S RMPRIT=+Y,RMPREIID="" K X,Y,DA
"RTN","RMPR37",44,0)
 I $D(R410("IT",RMPRIT,4)) S RMPREIID=$P(R410("IT",RMPRIT,4),U,3)
"RTN","RMPR37",45,0)
 I RMPREIID="" S RMPREIID=RMPR2237_"-"_RMPRIT
"RTN","RMPR37",46,0)
 I $D(^RMPR(660,"EIID",RMPREIID)) W !!,"**  LINE ITEM UNIQUE ID "_RMPREIID_" has already been posted!  **",!! G DSP0
"RTN","RMPR37",47,0)
PAT ;get patient
"RTN","RMPR37",48,0)
 D GETPAT^RMPRUTIL G:'$D(RMPRDFN) KILL
"RTN","RMPR37",49,0)
 K DIR,DA S DIR(0)="660,2",DIR("B")="INITIAL ISSUE" D ^DIR G:$D(DIRUT) KILL S (RMTYPE,RMPRTYP)=Y K X,Y
"RTN","RMPR37",50,0)
 K DIR,DA S DIR(0)="660,62" D ^DIR G:$D(DIRUT) KILL S RMPRCAT=Y,RMPRSC="" K X,Y
"RTN","RMPR37",51,0)
 I RMPRCAT=4 K DIR,DA S DIR(0)="660,63" D ^DIR G:$D(DIRUT) KILL S RMPRSC=Y K X,Y
"RTN","RMPR37",52,0)
 S RMPR661="" I $P(R410("IT",RMPRIT,0),U,5)'="" S RMPR661=$O(^RMPR(661,"B",$P(R410("IT",RMPRIT,0),U,5),""))
"RTN","RMPR37",53,0)
 I RMPR661'="" S C=$P(^DD(660,4,0),U,2),Y=RMPR661 D Y^DIQ S RMPR661T=Y K C,Y
"RTN","RMPR37",54,0)
 I RMPR661'="" K DIR,DA S DIR(0)="660,4",DIR("A")="ITEM",DIR("B")=RMPR661T D ^DIR G:$D(DIRUT) KILL S RMPR661=+Y K X,Y
"RTN","RMPR37",55,0)
 I RMPR661="" K DIR,DA S DIR(0)="660,4",DIR("A")="ITEM" D ^DIR G:$D(DIRUT) KILL S RMPR661=+Y K X,Y
"RTN","RMPR37",56,0)
 K DIR,DA S DIR(0)="660,4.5" D ^DIR G:$D(DIRUT) KILL S RMPRHC=+Y K X,Y
"RTN","RMPR37",57,0)
 S RDA=RMPRHC_"^"_RMTYPE_"^C^"_660
"RTN","RMPR37",58,0)
 D CPT^RMPRCPTU(RDA)
"RTN","RMPR37",59,0)
 S RMPRV=$P(R410(2),U)
"RTN","RMPR37",60,0)
 S RMPRQTY=$S($D(R410("IT",RMPRIT,0)):$P(R410("IT",RMPRIT,0),U,2),1:1)
"RTN","RMPR37",61,0)
 K DIR,Y,X S DIR(0)="660,9^O" D ^DIR G:$D(DTOUT)!($D(DUOUT)) KILL S RMPRSN=Y K X,Y
"RTN","RMPR37",62,0)
 K DIR,Y,X S DIR(0)="660,21" D ^DIR G:$D(DTOUT)!($D(DUOUT)) KILL S RMPRLT=Y K X,Y
"RTN","RMPR37",63,0)
AB S %=1 R !,"Would you like to POST this request now" D YN^DICN
"RTN","RMPR37",64,0)
 G:%<0 KILL G:%=0 H G:%=1 POST G:%=2 KILL
"RTN","RMPR37",65,0)
POST W !," Posting Now ..."
"RTN","RMPR37",66,0)
 S DIC="^RMPR(660,",DIC(0)="AEQLM",DLAYGO=660,X=DT
"RTN","RMPR37",67,0)
 S DIC("DR")=".02////^S X=RMPRDFN"
"RTN","RMPR37",68,0)
 K DINUM,DD,DO D FILE^DICN K DLAYGO
"RTN","RMPR37",69,0)
 I Y=-1 W !!,"*** Request failed to post.  Please contact support. ***" H 10 G EXIT
"RTN","RMPR37",70,0)
 S ^RMPR(660,+Y,0)=DT_U_RMPRDFN_U_$P(R410(1),U)_U_RMPRTYP_"^^"_RMPR661_U_RMPRQTY_U_$P(R410("IT",RMPRIT,0),U,3)_U_$P($G(R410(3)),U,4)_U_RMPR("STA")_U_RMPRSN_U_DT_"^3^C^^"_($P(R410("IT",RMPRIT,0),U,7)*RMPRQTY)_"^^^^^^^^"_RMPRLT,RMPRA=+Y
"RTN","RMPR37",71,0)
 S ^RMPR(660,+Y,1)=$P(R410(0),U,1)_"^^^"_$G(RMPRHC)_"^^"_RMCPT
"RTN","RMPR37",72,0)
 S $P(^RMPR(660,+Y,0),U,27)=DUZ
"RTN","RMPR37",73,0)
 ; S two new eCMS ID fields
"RTN","RMPR37",74,0)
 S ^RMPR(660,+Y,5)="^"_RMPREAID_"^"_RMPREIID
"RTN","RMPR37",75,0)
 S ^RMPR(660,+Y,"AM")="^^"_RMPRCAT_U_RMPRSC
"RTN","RMPR37",76,0)
 K RMPRG L +^RMPR(669.9,RMPRSITE,0):999 I $T=0 S RMPRG=DT-99
"RTN","RMPR37",77,0)
 I '$D(RMPRG) S RMPRG=$P(^RMPR(669.9,RMPRSITE,0),U,7),RMPRG=RMPRG-1,$P(^RMPR(669.9,RMPRSITE,0),U,7)=RMPRG L -^RMPR(669.9,RMPRSITE,0)
"RTN","RMPR37",78,0)
 S ^RMPR(660,+Y,"AMS")=RMPRG
"RTN","RMPR37",79,0)
 Q:'$D(R410("IT"))  S D1=0 F  S D1=$O(R410("IT",RMPRIT,1,D1)) Q:D1'>0  S RZI(RMPRIT_D1)=R410("IT",RMPRIT,1,D1,0)
"RTN","RMPR37",80,0)
 S D1=0 F I=1:1 S D1=$O(RZI(D1)) Q:D1'>0  S ^RMPR(660,+Y,"DES",I,0)=RZI(D1)
"RTN","RMPR37",81,0)
 S:RMPREAID'="" ^RMPR(660,+Y,"DES",I,0)=" eCMS ACTIONUID is "_RMPREAID_"/ eCMS ITEMUID is "_RMPREIID
"RTN","RMPR37",82,0)
 S ^RMPR(660,+Y,"DES",0)="^660.028^"_I_U_I,DIK=DIC,(RMPR660,DA)=+Y
"RTN","RMPR37",83,0)
 D IX1^DIK
"RTN","RMPR37",84,0)
 W !?5,"Updated 10-2319 Record"
"RTN","RMPR37",85,0)
 ;added in patch #62
"RTN","RMPR37",86,0)
 S ^TMP($J,"RMPRPCE",660,RMPR660)=RMPRG_"^"_$G(RMPRDFN)
"RTN","RMPR37",87,0)
 D LINK^RMPRS
"RTN","RMPR37",88,0)
 G DSP
"RTN","RMPR37",89,0)
H W !,"Enter `Y` for YES if you want to post this request to the Patient's 10-2319 Record." G AB
"RTN","RMPR37",90,0)
 ;KILL VARS BUT RETURN TO DSP0, LINE SELECTION PROMPT
"RTN","RMPR37",91,0)
KILL W !,$C(7),"** Did Not POST 2237 to Veterans 2319 Record! **" K RMPRIT,RMPREIID,RMTYPE,RMPRTYP,RMPRCAT,RMPRSC,RMPRHC,RMPRV,RMPRQTY,RMPRSN G DSP0
"RTN","RMPR37",92,0)
 ;KILL VARS AND EXIT
"RTN","RMPR37",93,0)
EXIT K ITN,RZZZ,RG,D1,DIK,DIR,DIRUT,DTOUT,DUOUT,I,RMPRCNT,RMPRSEL,DA,RMPRA,RMPRDFN,UN,X,X2,R410,CTT,RTN,RMPRV,RMPRQTY,DIC,Y,RMPRTYP,PRC,RMPRIT,RMPRCAT,RMPRSC,RD,RC,RIT,RIN,RZ,RT,RF,RE,RNI,CI,AZL,RIB,RMPRSN
"RTN","RMPR37",94,0)
 K RMPR660,RMPR661,RMCHK,RMPREAID,LCT,PCT,RMPR2237,RMPRPO
"RTN","RMPR37",95,0)
 K ^TMP($J,"RMPRPCE")
"RTN","RMPR37",96,0)
 K PRCSIP,RAT,RZI,KI,C1,GI,KK,RB,RI,RJ,RXX,RMPRHC,RMPRY,RMPRDOB,RMPRNAM,RMPRSSN,RMPRG,N,RMCPT,RMTYPE,RDA,RMPRCNUM,RMPRSSNE,RRX,PRCFLAG,TYPE Q
"RTN","RMPR37A")
0^2^B7729999^B6408485
"RTN","RMPR37A",1,0)
RMPR37A ;PHX/JLT-CONTINUATION OF POST 2237 TO 10-2319 RMPR37 ;8/29/1994
"RTN","RMPR37A",2,0)
 ;;3.0;PROSTHETICS;**185**;Feb 09, 1996;Build 19
"RTN","RMPR37A",3,0)
 ;
"RTN","RMPR37A",4,0)
 ;DDA Patch #185 - Added ECMS ITEMUID information to display
"RTN","RMPR37A",5,0)
 ;
"RTN","RMPR37A",6,0)
A ;DISPLAY ITEMS INFORMATION ON 2237
"RTN","RMPR37A",7,0)
 Q:'$D(R410("IT"))  W !?5,ITN,">"
"RTN","RMPR37A",8,0)
 S D1=0 F I=0:0 S D1=$O(R410("IT",ITN,1,D1)) Q:D1'>0  W ?10,$P(R410("IT",ITN,1,D1,0),U,1),!
"RTN","RMPR37A",9,0)
 D A1
"RTN","RMPR37A",10,0)
 K R1,RZZZ,QT,CT,RMPRIUID,RTN,RTN4,UN Q
"RTN","RMPR37A",11,0)
A1 S RTN=R410("IT",ITN,0),RTN4=""
"RTN","RMPR37A",12,0)
 S:$D(R410("IT",ITN,4)) RTN4=R410("IT",ITN,4)
"RTN","RMPR37A",13,0)
 S RMPRIUID=$P(RTN4,U,3)
"RTN","RMPR37A",14,0)
 W:RMPRIUID'="" ?1,"ECMS ITEM ID: ",RMPRIUID
"RTN","RMPR37A",15,0)
 S:RMPRIUID="" RMPRIUID=RMPR2237_"-"_ITN
"RTN","RMPR37A",16,0)
 I $D(^RMPR(660,"EIID",RMPRIUID)) W " **POSTED to 2319**" S PCT=PCT+1
"RTN","RMPR37A",17,0)
 W !
"RTN","RMPR37A",18,0)
 W ?10,"QTY: ",$P(RTN,U,2),?20,"UNIT OF ISSUE: "
"RTN","RMPR37A",19,0)
 S UN=$P(RTN,U,3)
"RTN","RMPR37A",20,0)
 W:+UN $P(^PRCD(420.5,UN,0),U,1)
"RTN","RMPR37A",21,0)
 W ?40,"UNIT COST:"
"RTN","RMPR37A",22,0)
 S (X,CT)=$P(RTN,U,7),X2="2$" D COMMA^%DTC
"RTN","RMPR37A",23,0)
 W X,!
"RTN","RMPR37A",24,0)
 S QT=$P(RTN,U,2),CTT=CTT+(CT*QT)
"RTN","RMPR37A",25,0)
 Q
"RTN","RMPR37A",26,0)
NUM ;CHECK FOR ITEMS BY NUMBER ENTRY
"RTN","RMPR37A",27,0)
 I $D(^RMPR(661,"B",RMPRY)) S X=RMPRY,DIC(0)="NMZ",DIC=441 D ^DIC I +Y S RIT(RMPRY,$P(Y(0),U,2))=""
"RTN","RMPR37A",28,0)
 I '$D(R410("IT",RMPRY,1))&($D(RIT)) Q
"RTN","RMPR37A",29,0)
 I '$D(R410("IT",RMPRY,1)) W $C(7),"??" Q
"RTN","RMPR37A",30,0)
 F RI=0:0 S RI=$O(R410("IT",RMPRY,1,RI)) Q:RI'>0  S RZ=R410("IT",RMPRY,1,RI,0) I RZ'="" D EXT
"RTN","RMPR37A",31,0)
 Q
"RTN","RMPR37A",32,0)
EXT S (CI,C1)=1,GI=$L(RZ,",")
"RTN","RMPR37A",33,0)
 I GI>0 F I=1:1:GI-1 S RAT=$F(RZ,",") S RZ=$E(RZ,1,RAT-2)_" "_$E(RZ,RAT,99)
"RTN","RMPR37A",34,0)
 F RT=1:1 S RE=$E(RZ,RT) Q:$A(RE)'>0  I $A(RE)=32 S CI=CI+1
"RTN","RMPR37A",35,0)
 F RT=1:1:CI S RD=$P(RZ," ",RT) S:$L(RD)>2 RD(RD)=RD
"RTN","RMPR37A",36,0)
 D PAR Q
"RTN","RMPR37A",37,0)
CHK ;CHECK FOR ITEMS IN 661 BY SHORT DESCRIPTION X-REF
"RTN","RMPR37A",38,0)
 S AZL=$L(RMPRY)
"RTN","RMPR37A",39,0)
 I $D(^PRC(441,"C",RZ)) F RG=0:0 S RG=$O(^PRC(441,"C",RZ,RG)) Q:RG'>0  S:$D(^RMPR(661,"B",RG)) RIT(RG,RZ)="" G:'$D(^RMPR(661,"B",RG)) EXT
"RTN","RMPR37A",40,0)
 S RD(RZ)="" G EXT
"RTN","RMPR37A",41,0)
PAR S RXX="" F RF=0:0 S RXX=$O(RD(RXX)) Q:RXX=""  I $D(^PRC(441,"C",RXX)) F RNI=0:0 S RNI=$O(^PRC(441,"C",RXX,RNI)) Q:RNI'>0  I $D(^RMPR(661,"B",RNI)) S RIT(RNI,RXX)=""
"RTN","RMPR37A",42,0)
 S RB="" F RF=0:0 S RB=$O(RD(RB)) Q:RB=""  S:RMPRY AZL=3 S RJ=$E(RB,1,AZL) F KK=0:0 S RJ=$O(^PRC(441,"C",RJ)) Q:$E(RB,1,AZL)'=$E(RJ,1,AZL)  F RIN=0:0 S RIN=$O(^PRC(441,"C",RJ,RIN)) Q:RIN'>0  I $D(^RMPR(661,"B",RIN)) S RIT(RIN,RJ)=""
"RTN","RMPR37A",43,0)
 Q
"VER")
8.0^22.0
"^DD",660,660,41,0)
ECMS ACTIONUID^F^^5;2^K:$L(X)>10!($L(X)<1)!'(X?1.10N) X
"^DD",660,660,41,3)
Enter the 1-10 digit eCMS ActionUID value.
"^DD",660,660,41,21,0)
^.001^3^3^3170112^
"^DD",660,660,41,21,1,0)
This field stores the eCMS internal, unique identifier for the
"^DD",660,660,41,21,2,0)
IFCAP 2237 used to perform the Purchase Request.  This data is part
"^DD",660,660,41,21,3,0)
of the eCMS/IFCAP interface.
"^DD",660,660,41,"DT")
3170112
"^DD",660,660,42,0)
UNIQUE ITEM ID^F^^5;3^K:$L(X)>25!($L(X)<1)!'(X?1.10N) X
"^DD",660,660,42,1,0)
^.1
"^DD",660,660,42,1,1,0)
660^EIID
"^DD",660,660,42,1,1,1)
S ^RMPR(660,"EIID",$E(X,1,30),DA)=""
"^DD",660,660,42,1,1,2)
K ^RMPR(660,"EIID",$E(X,1,30),DA)
"^DD",660,660,42,1,1,"%D",0)
^.101^2^2^3170418^^
"^DD",660,660,42,1,1,"%D",1,0)
Regular cross-reference on UNIQUE ITEM ID for use in checking 
"^DD",660,660,42,1,1,"%D",2,0)
if the unique ID has already been associated with a 2319 record.
"^DD",660,660,42,1,1,"DT")
3170228
"^DD",660,660,42,3)
Answer must be 1-25 characters in length.
"^DD",660,660,42,21,0)
4^.001^4^4^3170522^^
"^DD",660,660,42,21,1,0)
This field stores the unique identifier of the eCMS or IFCAP
"^DD",660,660,42,21,2,0)
2237 line item of a Purchase Request.  This data is part of the
"^DD",660,660,42,21,3,0)
eCMS/IFCAP interface if a contract item or is a modification
"^DD",660,660,42,21,4,0)
of the 2237 Obligation Number if not.
"^DD",660,660,42,"DT")
3170418
"BLD",8521,6)
^168
**END**
**END**

