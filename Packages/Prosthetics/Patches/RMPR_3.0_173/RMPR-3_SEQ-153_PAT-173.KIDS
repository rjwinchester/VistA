Released RMPR*3*173 SEQ #153
Extracted from mail message
**KIDS**:RMPR*3.0*173^

**INSTALL NAME**
RMPR*3.0*173
"BLD",8677,0)
RMPR*3.0*173^PROSTHETICS^0^3140623^y
"BLD",8677,1,0)
^^3^3^3140122^^
"BLD",8677,1,1,0)
1. Users are able to edit Inactive HCPCS items in Prosthetics.
"BLD",8677,1,2,0)
 
"BLD",8677,1,3,0)
2. Purge process created for Prosthetics file #664 [PROSTHETICS 1358]
"BLD",8677,4,0)
^9.64PA^^0
"BLD",8677,6.3)
29
"BLD",8677,"ABPKG")
n
"BLD",8677,"KRN",0)
^9.67PA^779.2^20
"BLD",8677,"KRN",.4,0)
.4
"BLD",8677,"KRN",.401,0)
.401
"BLD",8677,"KRN",.402,0)
.402
"BLD",8677,"KRN",.403,0)
.403
"BLD",8677,"KRN",.5,0)
.5
"BLD",8677,"KRN",.84,0)
.84
"BLD",8677,"KRN",3.6,0)
3.6
"BLD",8677,"KRN",3.8,0)
3.8
"BLD",8677,"KRN",9.2,0)
9.2
"BLD",8677,"KRN",9.8,0)
9.8
"BLD",8677,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",8677,"KRN",9.8,"NM",1,0)
RMPRCDP^^0^B34194835
"BLD",8677,"KRN",9.8,"NM",2,0)
RMPRPIY7^^0^B59398060
"BLD",8677,"KRN",9.8,"NM","B","RMPRCDP",1)

"BLD",8677,"KRN",9.8,"NM","B","RMPRPIY7",2)

"BLD",8677,"KRN",19,0)
19
"BLD",8677,"KRN",19,"NM",0)
^9.68A^3^2
"BLD",8677,"KRN",19,"NM",2,0)
RMPR PURGE MENU^^3
"BLD",8677,"KRN",19,"NM",3,0)
RMPR PURGE AGED^^0^
"BLD",8677,"KRN",19,"NM","B","RMPR PURGE AGED",3)

"BLD",8677,"KRN",19,"NM","B","RMPR PURGE MENU",2)

"BLD",8677,"KRN",19.1,0)
19.1
"BLD",8677,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",8677,"KRN",101,0)
101
"BLD",8677,"KRN",101,"NM",0)
^9.68A^^
"BLD",8677,"KRN",409.61,0)
409.61
"BLD",8677,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",8677,"KRN",771,0)
771
"BLD",8677,"KRN",771,"NM",0)
^9.68A^^
"BLD",8677,"KRN",779.2,0)
779.2
"BLD",8677,"KRN",779.2,"NM",0)
^9.68A^^
"BLD",8677,"KRN",870,0)
870
"BLD",8677,"KRN",870,"NM",0)
^9.68A^^
"BLD",8677,"KRN",8989.51,0)
8989.51
"BLD",8677,"KRN",8989.51,"NM",0)
^9.68A^^
"BLD",8677,"KRN",8989.52,0)
8989.52
"BLD",8677,"KRN",8994,0)
8994
"BLD",8677,"KRN","B",.4,.4)

"BLD",8677,"KRN","B",.401,.401)

"BLD",8677,"KRN","B",.402,.402)

"BLD",8677,"KRN","B",.403,.403)

"BLD",8677,"KRN","B",.5,.5)

"BLD",8677,"KRN","B",.84,.84)

"BLD",8677,"KRN","B",3.6,3.6)

"BLD",8677,"KRN","B",3.8,3.8)

"BLD",8677,"KRN","B",9.2,9.2)

"BLD",8677,"KRN","B",9.8,9.8)

"BLD",8677,"KRN","B",19,19)

"BLD",8677,"KRN","B",19.1,19.1)

"BLD",8677,"KRN","B",101,101)

"BLD",8677,"KRN","B",409.61,409.61)

"BLD",8677,"KRN","B",771,771)

"BLD",8677,"KRN","B",779.2,779.2)

"BLD",8677,"KRN","B",870,870)

"BLD",8677,"KRN","B",8989.51,8989.51)

"BLD",8677,"KRN","B",8989.52,8989.52)

"BLD",8677,"KRN","B",8994,8994)

"BLD",8677,"QDEF")
^^^^NO^^^^^^YES
"BLD",8677,"QUES",0)
^9.62^^
"BLD",8677,"REQB",0)
^9.611^1^1
"BLD",8677,"REQB",1,0)
RMPR*3.0*139^2
"BLD",8677,"REQB","B","RMPR*3.0*139",1)

"KRN",19,5676,-1)
3^2
"KRN",19,5676,0)
RMPR PURGE MENU^Purge Obsolete Data^^M^^RMPRMANAGER^^^^^^PROSTHETICS
"KRN",19,5676,1,0)
^19.06^1^1^3140110^^
"KRN",19,5676,1,1,0)
Purge Menu
"KRN",19,5676,10,0)
^19.01IP^4^4
"KRN",19,5676,10,4,0)
13645^PAG
"KRN",19,5676,10,4,"^")
RMPR PURGE AGED
"KRN",19,5676,99)
63361,32513
"KRN",19,5676,"U")
PURGE OBSOLETE DATA
"KRN",19,13645,-1)
0^3
"KRN",19,13645,0)
RMPR PURGE AGED^Purge Aged Purchasing Transactions^^R^^^^^^^^PROSTHETICS
"KRN",19,13645,1,0)
^19.06^2^2^3140110^^
"KRN",19,13645,1,1,0)
Purge file 664, PROSTHETICS ORDERS, of aged transactions based on 
"KRN",19,13645,1,2,0)
same order purged from File 442.
"KRN",19,13645,25)
EN20^RMPRCDP
"KRN",19,13645,"U")
PURGE AGED PURCHASING TRANSACT
"MBREQ")
0
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",101,-1)
1^1
"PKG",101,0)
PROSTHETICS^RMPR^PROSTHETICS VERSION 3.0 ALPHA
"PKG",101,20,0)
^9.402P^^0
"PKG",101,22,0)
^9.49I^1^1
"PKG",101,22,1,0)
3.0^2960209^2960214
"PKG",101,22,1,"PAH",1,0)
173^3140623
"PKG",101,22,1,"PAH",1,1,0)
^^3^3^3140623
"PKG",101,22,1,"PAH",1,1,1,0)
1. Users are able to edit Inactive HCPCS items in Prosthetics.
"PKG",101,22,1,"PAH",1,1,2,0)
 
"PKG",101,22,1,"PAH",1,1,3,0)
2. Purge process created for Prosthetics file #664 [PROSTHETICS 1358]
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","RMPRCDP")
0^1^B34194835^B12814776
"RTN","RMPRCDP",1,0)
RMPRCDP ;PHX/DWL,HNB-PURGE FILE 664 ;8/29/1994
"RTN","RMPRCDP",2,0)
 ;;3.0;PROSTHETICS;**3,173**;Feb 09, 1996;Build 29
"RTN","RMPRCDP",3,0)
 ;
"RTN","RMPRCDP",4,0)
 ;RMPR*3.0*173 Added purge for file 664 to remove aged orders that are 
"RTN","RMPRCDP",5,0)
 ;             no longer defined in IFCAP file 442.  The purge will be
"RTN","RMPRCDP",6,0)
 ;             controlled to ONLY allow orders for a fiscal year greater
"RTN","RMPRCDP",7,0)
 ;             than 6 years ago to be entered and should be run AFTER
"RTN","RMPRCDP",8,0)
 ;             the IFCAP annual purging process and use the same fiscal
"RTN","RMPRCDP",9,0)
 ;             year that purge process used.
"RTN","RMPRCDP",10,0)
 ;
"RTN","RMPRCDP",11,0)
EN1 ;Purge 664, Canceled Transactions
"RTN","RMPRCDP",12,0)
 D DIV4^RMPRSIT Q:$D(X)
"RTN","RMPRCDP",13,0)
EN4 K IOP,ZTIO,%ZIS S %ZIS="MQ",%ZIS("B")="" D ^%ZIS G:POP END
"RTN","RMPRCDP",14,0)
 ;I IOST["C-" W !,$C(7),"YOU MAY NOT SELECT YOUR TERMINAL" G EN4
"RTN","RMPRCDP",15,0)
 I $D(IO("Q")) D
"RTN","RMPRCDP",16,0)
 .S ZTRTN="EN11^RMPRCDP"
"RTN","RMPRCDP",17,0)
 .S ZTDESC="CANCEL TRANSACTIONS IN FILE 664 FOR A STATION/DIVISION"
"RTN","RMPRCDP",18,0)
 .F RD="I","RMPRIEN","RMPRDT","RMPRSITE","RMPR(" S ZTSAVE(RD)=""
"RTN","RMPRCDP",19,0)
 I $D(IO("Q")) K IO("Q") D ^%ZTLOAD W !,$S($D(ZTSK):"<REQUEST QUEUED!>",1:"<REQUEST NOT QUEUED!>") G END
"RTN","RMPRCDP",20,0)
EN11 S (I,RMPRIEN)=0,RMPRDT=$P(^RMPR(669.9,RMPRSITE,0),U,10) G:RMPRDT'>89 END
"RTN","RMPRCDP",21,0)
 S X1=DT,X2=-RMPRDT D C^%DTC S RMPRDT=X D NOW^%DTC S Y=% X ^DD("DD")
"RTN","RMPRCDP",22,0)
 U IO W !!,"Purge Canceled Prosthetic Purchasing Transactions For: ",!,$P(^RMPR(669.9,RMPRSITE,0),U,1)," On ",Y,!!
"RTN","RMPRCDP",23,0)
 F  S RMPRIEN=$O(^RMPR(664,RMPRIEN)) Q:RMPRIEN'>0  D
"RTN","RMPRCDP",24,0)
 .;quit if it is a purchase card transaction, non get purged
"RTN","RMPRCDP",25,0)
 .Q:$D(^RMPR(664,RMPRIEN,4))
"RTN","RMPRCDP",26,0)
 .I ($P(^RMPR(664,RMPRIEN,0),U,5))&($P(^(0),U,5)<RMPRDT&($P(^(0),U,14)=RMPR("STA"))) D
"RTN","RMPRCDP",27,0)
 ..S DA=RMPRIEN,DIC="^RMPR(664," D EN^DIQ
"RTN","RMPRCDP",28,0)
 ..S DA=RMPRIEN,DIK=DIC D ^DIK W "Deleted...",! S RDEL=1
"RTN","RMPRCDP",29,0)
 I '$D(RDEL) S $P(L,"-",IOM)="" W !,L,!,?5,"NO CANCELED PURCHASING TRANSACTIONS DELETED"
"RTN","RMPRCDP",30,0)
 G END
"RTN","RMPRCDP",31,0)
EN ;PURGE 664 FILE OF ENTRIES CLOSED OUT FOR A STATION/DIVISION
"RTN","RMPRCDP",32,0)
 D DIV4^RMPRSIT Q:$D(X)
"RTN","RMPRCDP",33,0)
EN5 K IOP,%ZIS,ZTIO S %ZIS="MQ",%ZIS("B")="" D ^%ZIS G:POP END
"RTN","RMPRCDP",34,0)
 ;I IOST["C-" W !,$C(7),"YOU MAY NOT SELECT YOUR OWN TERMINAL" G EN5
"RTN","RMPRCDP",35,0)
 I $D(IO("Q")) S ZTRTN="EN2^RMPRCDP",ZTDESC="PURGE 664 OF CLOSED OUT ENTRIES" F RD="I","RMPRIEN","RMPRDT","RMPRSITE","RMPR(" S ZTSAVE(RD)=""
"RTN","RMPRCDP",36,0)
 I $D(IO("Q")) K IO("Q") D ^%ZTLOAD W !,$S($D(ZTSK):"<REQUEST QUEUED!>",1:"<REQUEST NOT QUEUED>") G END
"RTN","RMPRCDP",37,0)
EN2 S (I,RMPRIEN)=0,RMPRDT=$P(^RMPR(669.9,RMPRSITE,0),U,9) G:RMPRDT'>89 END
"RTN","RMPRCDP",38,0)
 S X1=DT,X2=-RMPRDT D C^%DTC S RMPRDT=X D NOW^%DTC S Y=% X ^DD("DD")
"RTN","RMPRCDP",39,0)
 U IO W !!,"Purge Closed Prosthetic Purchasing Transactions For",!,$P(^RMPR(669.9,RMPRSITE,0),U,1)," On ",Y,!!
"RTN","RMPRCDP",40,0)
 F  S RMPRIEN=$O(^RMPR(664,RMPRIEN)) Q:RMPRIEN'>0  D
"RTN","RMPRCDP",41,0)
 .;quit if it is a purchase card transaction, non get purged
"RTN","RMPRCDP",42,0)
 .Q:$D(^RMPR(664,RMPRIEN,4))
"RTN","RMPRCDP",43,0)
 .I ($P(^RMPR(664,RMPRIEN,0),U,8))&($P(^(0),U,8)<RMPRDT&($P(^(0),U,14)=RMPR("STA"))) D
"RTN","RMPRCDP",44,0)
 ..S DA=RMPRIEN,DIC="^RMPR(664," D EN^DIQ
"RTN","RMPRCDP",45,0)
 ..S DA=RMPRIEN,DIK=DIC D ^DIK W "Deleted",! S RDEL=1
"RTN","RMPRCDP",46,0)
 I '$D(RDEL) S $P(L,"-",IOM)="" W !,L,!,?5,"NO CLOSED PURCHASING TRANSACTIONS DELETED",!
"RTN","RMPRCDP",47,0)
END K I,RD,RMPRIEN,RMPRDT,RMPR,DIR,DIK,DA,DIC,X1,X2,L,RDEL,ZTSK D ^%ZISC
"RTN","RMPRCDP",48,0)
 Q
"RTN","RMPRCDP",49,0)
EN3 ;Purge Non-Obligated Transactions
"RTN","RMPRCDP",50,0)
 ;IF C.P. and Reference Number missing, transaction not obligated to IFCAP
"RTN","RMPRCDP",51,0)
 D DIV4^RMPRSIT Q:$D(X)
"RTN","RMPRCDP",52,0)
 K IOP,%ZIS,ZTIO S %ZIS="MQ",%ZIS("B")="" D ^%ZIS G:POP END
"RTN","RMPRCDP",53,0)
 I $D(IO("Q")) S ZTRTN="EN3A^RMPRCDP",ZTDESC="Purge Non-Obligated Transactions For Station # "_RMPR("STA"),ZTSAVE("RMPR*")=""
"RTN","RMPRCDP",54,0)
 I $D(IO("Q")) K IO("Q") D ^%ZTLOAD W !,$S($D(ZTSK):"<REQUEST QUEUED!>",1:"<REQUEST NOT QUEUED>")
"RTN","RMPRCDP",55,0)
 G END
"RTN","RMPRCDP",56,0)
EN3A ;
"RTN","RMPRCDP",57,0)
 S RMPRA=0 F  S RMPRA=$O(^RMPR(664,RMPRA)) Q:RMPRA'>0  D
"RTN","RMPRCDP",58,0)
 .;quit if this is a purchase card transaction, non should be purged
"RTN","RMPRCDP",59,0)
 .Q:$D(^RMPR(664,RMPRA,4))
"RTN","RMPRCDP",60,0)
 .I '$P(^RMPR(664,RMPRA,0),U,6)&('$P(^(0),U,7))&($P(^(0),U,14)=RMPR("STA")) D
"RTN","RMPRCDP",61,0)
 ..S DA=RMPRA,DIC="^RMPR(664," D EN^DIQ
"RTN","RMPRCDP",62,0)
 ..S DA=RMPRA,DIK=DIC D ^DIK W "Deleted...",! S RDEL=1
"RTN","RMPRCDP",63,0)
 I $G(RDEL)'=1 W !!,"No Non-Obligated Transactions deleted."
"RTN","RMPRCDP",64,0)
 K RMPRA,DIK,DA,I,DIC D ^%ZISC
"RTN","RMPRCDP",65,0)
 Q
"RTN","RMPRCDP",66,0)
 ;
"RTN","RMPRCDP",67,0)
 ;RMPR*3.0*173 File 664 Aged Order Purge
"RTN","RMPRCDP",68,0)
EN20 ;Purge 664, Aged order transactions based on file 442 purge history for closed/cancelled orders
"RTN","RMPRCDP",69,0)
 S DIR("?")="Enter 'YES' or 'Y' to continue processing."
"RTN","RMPRCDP",70,0)
 S DIR(0)="Y",DIR("A")="Purge MUST follow the IFCAP annual purge process, OK to continue? ",DIR("B")="NO" D ^DIR I $D(DIRUT)!($D(DTOUT))!(+Y'=1) Q
"RTN","RMPRCDP",71,0)
 D DIV4^RMPRSIT G END1:$D(X)
"RTN","RMPRCDP",72,0)
EN21 ;Select Fiscal Year
"RTN","RMPRCDP",73,0)
 D:'$D(DT) DT^DICRW
"RTN","RMPRCDP",74,0)
 S RMPRFYT=1700+$E(DT,1,3)+$E(DT,4),RMPRFY=RMPRFYT
"RTN","RMPRCDP",75,0)
 S DIR("?")="Fiscal year.  Should be same year (or prior) as used in IFCAP annual purge."
"RTN","RMPRCDP",76,0)
 S DIR("A")="Enter FISCAL YEAR (YYYY) to purge",DIR(0)="N^1990:2100",DIR("B")=RMPRFYT-8 D ^DIR K DIR G END1:$D(DIRUT) S RMPRFY=Y
"RTN","RMPRCDP",77,0)
 I RMPRFY>(RMPRFYT-8) W "  You CANNOT purge Prosthetics order data for a fiscal year LESS than 8 years ago!!" G EN21
"RTN","RMPRCDP",78,0)
 S DIR("?")="Enter 'YES' or 'Y' to continue processing."
"RTN","RMPRCDP",79,0)
 S DIR(0)="Y",DIR("A")="Purging closed PROS orders prior to FY end 09/30/"_RMPRFY_", OK? ",DIR("B")="NO" D ^DIR G:$D(DIRUT)!($D(DTOUT)) EN21 I +Y'=1 Q
"RTN","RMPRCDP",80,0)
 S RMPRFYDT=(RMPRFY-1700)_1001
"RTN","RMPRCDP",81,0)
EN25 K IOP,ZTIO,%ZIS S %ZIS="MQ",%ZIS("B")="" D ^%ZIS G:POP END1
"RTN","RMPRCDP",82,0)
 ;I IOST["C-" W !,$C(7),"YOU MAY NOT SELECT YOUR TERMINAL" G EN4
"RTN","RMPRCDP",83,0)
 I $D(IO("Q")) D
"RTN","RMPRCDP",84,0)
 .S ZTRTN="EN26^RMPRCDP"
"RTN","RMPRCDP",85,0)
 .S ZTDESC="PURGE ALL ORDERS IN FILE 664 FOR A STATION/DIVISION THAT ARE SAME/PRIOR TO CURRENT IFCAP PURGE YEAR"
"RTN","RMPRCDP",86,0)
 .S ZTSAVE("RMPR*")=""
"RTN","RMPRCDP",87,0)
 I $D(IO("Q")) K IO("Q") D ^%ZTLOAD W !,$S($D(ZTSK):"<REQUEST QUEUED!>",1:"<REQUEST NOT QUEUED!>") G END1
"RTN","RMPRCDP",88,0)
EN26 S (I,RMPRIEN,RMPRTOTD)=0
"RTN","RMPRCDP",89,0)
 D NOW^%DTC S Y=% X ^DD("DD")
"RTN","RMPRCDP",90,0)
 U IO W !!,"Purge Prosthetic Purchasing Transactions For: ",RMPRFY,"      On ",Y,!!
"RTN","RMPRCDP",91,0)
 F  S RMPRIEN=$O(^RMPR(664,RMPRIEN)) Q:RMPRIEN'>0  D
"RTN","RMPRCDP",92,0)
 . S RMPRDEL=0,RMPRODT=$P(^RMPR(664,RMPRIEN,0),U),RMPROSIT=$P(^RMPR(664,RMPRIEN,0),U,14),RMPRORD=$P($G(^RMPR(664,RMPRIEN,4)),U,5),RMPROIEN=$P($G(^RMPR(664,RMPRIEN,4)),U,6)
"RTN","RMPRCDP",93,0)
 . I RMPRODT<RMPRFYDT,(RMPROSIT=RMPR("STA")!(RMPROSIT="")) D
"RTN","RMPRCDP",94,0)
 ..I RMPRORD=""!(RMPROIEN="") S RMPRDEL=1
"RTN","RMPRCDP",95,0)
 .. I RMPRDEL=0,'$D(^PRC(442,"B",RMPROSIT_"-"_RMPRORD,RMPROIEN)) S RMPRDEL=1
"RTN","RMPRCDP",96,0)
 .. I RMPRDEL=1 D
"RTN","RMPRCDP",97,0)
 ... S DA=RMPRIEN,DIC="^RMPR(664," D EN^DIQ
"RTN","RMPRCDP",98,0)
 ... S DIK=DIC D ^DIK K DIK,DIC
"RTN","RMPRCDP",99,0)
 ... W !,"Deleted...",! S RMPRTOTD=RMPRTOTD+1
"RTN","RMPRCDP",100,0)
 S $P(RMPRL,"-",IOM)="" W !!,RMPRL,!!,?5,"TOTAL PROSTHETICS PURCHASING TRANSACTIONS DELETED: ",RMPRTOTD,!
"RTN","RMPRCDP",101,0)
END1 K I,RD,RMPRIEN,RMPRDT,RMPR,DIR,DIK,DA,DIC,X,X1,X2,RMPRL,RMPRTOTD,ZTSK,RMPRFYT,RMPRDEL,RMPRFY,RMPRFYDT,RMPRODT,RMPROSIT,RMPRORD,RMPROIEN,DIRUT,DTOUT D ^%ZISC
"RTN","RMPRCDP",102,0)
 Q
"RTN","RMPRPIY7")
0^2^B59398060^B54541499
"RTN","RMPRPIY7",1,0)
RMPRPIY7 ;HINCIO/ODJ - PIP EDIT - PROMPTS ;9/18/02  15:17
"RTN","RMPRPIY7",2,0)
 ;;3.0;PROSTHETICS;**61,118,139,173**;Feb 09, 1996;Build 29
"RTN","RMPRPIY7",3,0)
 ;
"RTN","RMPRPIY7",4,0)
 ;DBIA # 800 - FILEMAN read of file #440.
"RTN","RMPRPIY7",5,0)
 Q
"RTN","RMPRPIY7",6,0)
 ;
"RTN","RMPRPIY7",7,0)
 ;RMPR*3.0*173 Modify HCPCS item lookup code to reject if entry
"RTN","RMPRPIY7",8,0)
 ;             flagged as inactive in file 661.11
"RTN","RMPRPIY7",9,0)
 ; The following subroutines are a series of prompts called
"RTN","RMPRPIY7",10,0)
 ; by Edit LOCATION/HCPCS/ITEM option (EI^RMPRPIY6)
"RTN","RMPRPIY7",11,0)
 ;
"RTN","RMPRPIY7",12,0)
 ;***** LOCNM - Prompt for location
"RTN","RMPRPIY7",13,0)
 ;              must be in 661.5 and active
"RTN","RMPRPIY7",14,0)
LOCNM(RMPRSTN,RMPR5,RMPREXC) ;
"RTN","RMPRPIY7",15,0)
 N RMPRERR,DIR,X,Y,DA,DUOUT,DTOUT,DIROUT,RMPRYN,RMPRTDT
"RTN","RMPRPIY7",16,0)
 D NOW^%DTC S RMPRTDT=X ;today's date
"RTN","RMPRPIY7",17,0)
 S RMPREXC=""
"RTN","RMPRPIY7",18,0)
 S RMPRERR=0
"RTN","RMPRPIY7",19,0)
 S DIR(0)="FOA"
"RTN","RMPRPIY7",20,0)
 S DIR("A")="Enter Pros Location: "
"RTN","RMPRPIY7",21,0)
 I $G(RMPR5("NAME"))'="" S DIR("B")=RMPR5("NAME")
"RTN","RMPRPIY7",22,0)
 S DIR("?")="^D QM^RMPRPIYB"
"RTN","RMPRPIY7",23,0)
 S DIR("??")="^D QM2^RMPRPIYB"
"RTN","RMPRPIY7",24,0)
 S RMPR5("IEN")=""
"RTN","RMPRPIY7",25,0)
LOCNM1 D ^DIR
"RTN","RMPRPIY7",26,0)
 ;Patch *139 removes upper case translation to allow access to lower
"RTN","RMPRPIY7",27,0)
 ;case entries used in location creation option
"RTN","RMPRPIY7",28,0)
 ;S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","RMPRPIY7",29,0)
 I $G(RMPR5("IEN"))'="" S RMPREXC="" G LOCNMX
"RTN","RMPRPIY7",30,0)
 I $D(DTOUT) S RMPREXC="T" G LOCNMX
"RTN","RMPRPIY7",31,0)
 I $D(DIROUT) S RMPREXC="P" G LOCNMX
"RTN","RMPRPIY7",32,0)
 I X=""!(X["^") S RMPREXC="^" G LOCNMX
"RTN","RMPRPIY7",33,0)
 K RMPR5
"RTN","RMPRPIY7",34,0)
 S RMPR5("STATION")=RMPRSTN
"RTN","RMPRPIY7",35,0)
 S RMPR5("STATION IEN")=RMPRSTN
"RTN","RMPRPIY7",36,0)
 D LIKE^RMPRPIYB(RMPRSTN,X,.RMPREXC,.RMPR5)
"RTN","RMPRPIY7",37,0)
 I RMPREXC'="" G LOCNM1
"RTN","RMPRPIY7",38,0)
 I $G(RMPR5("IEN"))="" D  G LOCNM1
"RTN","RMPRPIY7",39,0)
 . W !,"Please enter a valid Location"
"RTN","RMPRPIY7",40,0)
 . Q
"RTN","RMPRPIY7",41,0)
 ;
"RTN","RMPRPIY7",42,0)
 ; exit
"RTN","RMPRPIY7",43,0)
LOCNMX Q
"RTN","RMPRPIY7",44,0)
 ;
"RTN","RMPRPIY7",45,0)
 ;***** OK - Prompt for an OK
"RTN","RMPRPIY7",46,0)
OK(RMPRYN,RMPREXC) ;
"RTN","RMPRPIY7",47,0)
 N DIR,X,Y,DA,DUOUT,DTOUT,DIROUT,DIRUT
"RTN","RMPRPIY7",48,0)
 S RMPREXC=""
"RTN","RMPRPIY7",49,0)
 S RMPRYN="N"
"RTN","RMPRPIY7",50,0)
 S DIR("A")="         ...OK"
"RTN","RMPRPIY7",51,0)
 S DIR("B")="Yes"
"RTN","RMPRPIY7",52,0)
 S DIR(0)="Y"
"RTN","RMPRPIY7",53,0)
 D ^DIR
"RTN","RMPRPIY7",54,0)
 I $D(DTOUT) S RMPREXC="T" G OKX
"RTN","RMPRPIY7",55,0)
 I $D(DIROUT) S RMPREXC="P" G OKX
"RTN","RMPRPIY7",56,0)
 I X=""!(X["^") S RMPREXC="^" G OKX
"RTN","RMPRPIY7",57,0)
 S RMPRYN="N" S:Y RMPRYN="Y"
"RTN","RMPRPIY7",58,0)
OKX Q
"RTN","RMPRPIY7",59,0)
 ;
"RTN","RMPRPIY7",60,0)
 ;***** HCPCS - Prompt for HCPCS
"RTN","RMPRPIY7",61,0)
HCPCS(RMPRSTN,RMPRHPTX,RMPR1,RMPR11,RMPREXC) ;
"RTN","RMPRPIY7",62,0)
 N RMPRERR,DIR,X,Y,DUOUT,DTOUT,DIROUT,DIRUT,DIC,DA,RMPR1N,RMSTN
"RTN","RMPRPIY7",63,0)
 N RM6610
"RTN","RMPRPIY7",64,0)
 S DIR("A")="Select HCPCS: ",RMSTN=RMPRSTN
"RTN","RMPRPIY7",65,0)
 S DIR("S")="I $P(^RMPR(661.11,+Y,0),U,4)=RMSTN"
"RTN","RMPRPIY7",66,0)
 S RMPRERR=0
"RTN","RMPRPIY7",67,0)
 S RMPREXC=""
"RTN","RMPRPIY7",68,0)
 S RMPRHPTX=$G(RMPRHPTX)
"RTN","RMPRPIY7",69,0)
 I RMPRHPTX'="" S DIR("B")=RMPRHPTX
"RTN","RMPRPIY7",70,0)
 S DIR(0)="FOA"
"RTN","RMPRPIY7",71,0)
 S DIR("?")="^D QM2^RMPRPIYC"
"RTN","RMPRPIY7",72,0)
 S DIR("??")="^D QM2^RMPRPIYC"
"RTN","RMPRPIY7",73,0)
 S DIR("???")="^D QM2^RMPRPIYC"
"RTN","RMPRPIY7",74,0)
HCPCS1 K RMPR1N D ^DIR
"RTN","RMPRPIY7",75,0)
 I $G(RMPR1N("IEN"))'="" S RMPRHPTX=RMPR1N("HCPCS") G CHECK
"RTN","RMPRPIY7",76,0)
 I $D(DTOUT) S RMPREXC="T" G HCPCSX
"RTN","RMPRPIY7",77,0)
 I $D(DIROUT) S RMPREXC="P" G HCPCSX
"RTN","RMPRPIY7",78,0)
 I X=""!(X["^")!($D(DUOUT)) S RMPREXC="^" G HCPCSX
"RTN","RMPRPIY7",79,0)
 D LIKE^RMPRPIYC(RMPRSTN,X,.RMPREXC,.RMPR1N,.RMPR11)
"RTN","RMPRPIY7",80,0)
 I RMPREXC'="" G HCPCS1
"RTN","RMPRPIY7",81,0)
 I $G(RMPR1N("IEN"))'="",$G(RMPR1("REMOVE")) G HCPCSU
"RTN","RMPRPIY7",82,0)
CHECK I $G(RMPR1N("IEN")),$D(^RMPR(661.1,$G(RMPR1N("IEN")),0)),'($P(^RMPR(661.1,RMPR1N("IEN"),0),U,5)) W !,"** No HCPCS Selected or Unable to Select Inactive HCPCS..." G HCPCS1
"RTN","RMPRPIY7",83,0)
 I $G(RMPR11("IEN")),$D(^RMPR(661.11,$G(RMPR11("IEN")),0)),$P(^RMPR(661.11,$G(RMPR11("IEN")),0),U,9) W !,"** Unable to Select Inactive HCPCS item..." G HCPCS1   ;RMPR*3.0*173 If HCPCS item inactive in file 661.11 reject lookup as Inactive
"RTN","RMPRPIY7",84,0)
 I $G(RMPR1N("IEN"))'="" G HCPCSU
"RTN","RMPRPIY7",85,0)
 G HCPCS1
"RTN","RMPRPIY7",86,0)
HCPCSU K RMPR1 M RMPR1=RMPR1N
"RTN","RMPRPIY7",87,0)
HCPCSX Q
"RTN","RMPRPIY7",88,0)
 ;
"RTN","RMPRPIY7",89,0)
 ;***** ITEM - Prompt for Item - restrict choice to Location and HCPC
"RTN","RMPRPIY7",90,0)
ITEM(RMPRSTN,RMPRLCN,RMPRHCPC,RMPR11,RMPR4,RMPREXC) ;
"RTN","RMPRPIY7",91,0)
 N RMPRERR,DIR,X,Y,DUOUT,DTOUT,DIROUT,DA,RMPRSRC,RMPRYN
"RTN","RMPRPIY7",92,0)
 S RMPRERR=0
"RTN","RMPRPIY7",93,0)
 S RMPREXC=""
"RTN","RMPRPIY7",94,0)
 I $G(RMPRSTN)="" S RMPRERR=1 G ITEMX
"RTN","RMPRPIY7",95,0)
 I $G(RMPRLCN)="" S RMPRERR=2 G ITEMX
"RTN","RMPRPIY7",96,0)
 I $G(RMPRHCPC)="" S RMPRERR=3 G ITEMX
"RTN","RMPRPIY7",97,0)
 K RMPR11,RMPR4
"RTN","RMPRPIY7",98,0)
 S DIR(0)="FOA^1:50"
"RTN","RMPRPIY7",99,0)
 S DIR("A")="Enter PSAS Item to Edit: "
"RTN","RMPRPIY7",100,0)
 S DIR("?")="^D QM^RMPRPIY8"
"RTN","RMPRPIY7",101,0)
 S DIR("??")="^D QQM^RMPRPIY8"
"RTN","RMPRPIY7",102,0)
ITEMA1 D ^DIR
"RTN","RMPRPIY7",103,0)
 I $D(DTOUT) S RMPREXC="T" G ITEMX
"RTN","RMPRPIY7",104,0)
 I $D(DIROUT) S RMPREXC="P" G ITEMX
"RTN","RMPRPIY7",105,0)
 I X=""!(X["^")!$D(DUOUT) S RMPREXC="^" G ITEMX
"RTN","RMPRPIY7",106,0)
 D LIKE^RMPRPIY8(RMPRSTN,RMPRLCN,RMPRHCPC,X,.RMPREXC,.RMPR11,.RMPR4)
"RTN","RMPRPIY7",107,0)
 I RMPREXC="T" G ITEMX
"RTN","RMPRPIY7",108,0)
 I RMPREXC="P" G ITEMX
"RTN","RMPRPIY7",109,0)
 I RMPREXC="^" G ITEMA1
"RTN","RMPRPIY7",110,0)
 I RMPR4("IEN")="" D  G ITEMA1
"RTN","RMPRPIY7",111,0)
 . W !,"Cannot locate ITEM with this sequence NUMBER"
"RTN","RMPRPIY7",112,0)
 . Q
"RTN","RMPRPIY7",113,0)
 W "  ",RMPR11("HCPCS-ITEM"),"  ",RMPR11("DESCRIPTION")
"RTN","RMPRPIY7",114,0)
 D OK(.RMPRYN,.RMPREXC)
"RTN","RMPRPIY7",115,0)
 I RMPRYN'="Y" G ITEMA1
"RTN","RMPRPIY7",116,0)
 G ITEMX
"RTN","RMPRPIY7",117,0)
ITEMX Q RMPRERR
"RTN","RMPRPIY7",118,0)
 ;
"RTN","RMPRPIY7",119,0)
 ;***** QTY - Prompt for Quantity
"RTN","RMPRPIY7",120,0)
QTY(RMPRQTY,RMPREXC) ;
"RTN","RMPRPIY7",121,0)
 N RMPRERR,DIR,X,Y,DUOUT,DTOUT,DIROUT,DIRUT,DA
"RTN","RMPRPIY7",122,0)
 S RMPRQTY=$G(RMPRQTY)
"RTN","RMPRPIY7",123,0)
 S RMPRERR=0
"RTN","RMPRPIY7",124,0)
 S DIR(0)="NA^1:99999:0"
"RTN","RMPRPIY7",125,0)
 S DIR("A")="QUANTITY: "
"RTN","RMPRPIY7",126,0)
 S:RMPRQTY'="" DIR("B")=RMPRQTY
"RTN","RMPRPIY7",127,0)
 D ^DIR
"RTN","RMPRPIY7",128,0)
 I $D(DTOUT) S RMPREXC="T" G QTYX
"RTN","RMPRPIY7",129,0)
 I $D(DIROUT) S RMPREXC="P" G QTYX
"RTN","RMPRPIY7",130,0)
 I X=""!(X["^") S RMPREXC="^" G QTYX
"RTN","RMPRPIY7",131,0)
 S RMPRQTY=Y
"RTN","RMPRPIY7",132,0)
QTYX Q RMPRERR
"RTN","RMPRPIY7",133,0)
 ;
"RTN","RMPRPIY7",134,0)
 ;***** TVAL - Prompt for total $ value
"RTN","RMPRPIY7",135,0)
TVAL(RMPRTVAL,RMPREXC) ;
"RTN","RMPRPIY7",136,0)
 N RMPRERR,DIR,X,Y,DUOUT,DTOUT,DIROUT,DIRUT,DA
"RTN","RMPRPIY7",137,0)
 S RMPRTVAL=$G(RMPRTVAL)
"RTN","RMPRPIY7",138,0)
 S RMPRERR=0
"RTN","RMPRPIY7",139,0)
 S DIR(0)="NOA^0:999999:2"
"RTN","RMPRPIY7",140,0)
 S DIR("A")="TOTAL COST OF QUANTITY: "
"RTN","RMPRPIY7",141,0)
 S:RMPRTVAL'="" DIR("B")=RMPRTVAL
"RTN","RMPRPIY7",142,0)
 D ^DIR
"RTN","RMPRPIY7",143,0)
 I $D(DTOUT) S RMPREXC="T" G TVALX
"RTN","RMPRPIY7",144,0)
 I $D(DIROUT) S RMPREXC="P" G TVALX
"RTN","RMPRPIY7",145,0)
 I X["^" S RMPREXC="^" G TVALX
"RTN","RMPRPIY7",146,0)
 I X="" G TVALX
"RTN","RMPRPIY7",147,0)
 S RMPRTVAL=Y
"RTN","RMPRPIY7",148,0)
TVALX Q RMPRERR
"RTN","RMPRPIY7",149,0)
 ;
"RTN","RMPRPIY7",150,0)
 ;***** REO - Prompt for Re-Order Level
"RTN","RMPRPIY7",151,0)
REO(RMPRREO,RMPREXC) ;
"RTN","RMPRPIY7",152,0)
 N RMPRERR,DIR,X,Y,DUOUT,DTOUT,DIROUT,DIRUT,DA
"RTN","RMPRPIY7",153,0)
 S RMPRREO=$G(RMPRREO)
"RTN","RMPRPIY7",154,0)
 S RMPRERR=0
"RTN","RMPRPIY7",155,0)
 S DIR(0)="NOA^0::0"
"RTN","RMPRPIY7",156,0)
 S DIR("A")="RE-ORDER LEVEL: "
"RTN","RMPRPIY7",157,0)
 S:RMPRREO'="" DIR("B")=RMPRREO
"RTN","RMPRPIY7",158,0)
 D ^DIR
"RTN","RMPRPIY7",159,0)
 I $D(DTOUT) S RMPREXC="T" G REOX
"RTN","RMPRPIY7",160,0)
 I $D(DIROUT) S RMPREXC="P" G REOX
"RTN","RMPRPIY7",161,0)
 I X=""!(X["^")!$D(DUOUT) S RMPREXC="^" G REOX
"RTN","RMPRPIY7",162,0)
 S RMPRREO=Y
"RTN","RMPRPIY7",163,0)
REOX Q RMPRERR
"RTN","RMPRPIY7",164,0)
 ;
"RTN","RMPRPIY7",165,0)
 ;***** VEND - Prompt for Vendor
"RTN","RMPRPIY7",166,0)
VEND(RMPRVEND,RMPREXC) ;
"RTN","RMPRPIY7",167,0)
 N RMPRERR,DIR,X,Y,DUOUT,DTOUT,DIROUT,DIRUT,DA
"RTN","RMPRPIY7",168,0)
 S RMPRVEND=$G(RMPRVEND("IEN"))
"RTN","RMPRPIY7",169,0)
 S RMPRERR=0
"RTN","RMPRPIY7",170,0)
 S DIR(0)="P^440:EMZ"
"RTN","RMPRPIY7",171,0)
 S DIR("A")="VENDOR"
"RTN","RMPRPIY7",172,0)
 S:RMPRVEND'="" DIR("B")=RMPRVEND("NAME")
"RTN","RMPRPIY7",173,0)
 D ^DIR
"RTN","RMPRPIY7",174,0)
 I $D(DTOUT) S RMPREXC="T" G VENDX
"RTN","RMPRPIY7",175,0)
 I $D(DIROUT) S RMPREXC="P" G VENDX
"RTN","RMPRPIY7",176,0)
 I X=""!(X["^")!$D(DUOUT) S RMPREXC="^" G VENDX
"RTN","RMPRPIY7",177,0)
 S RMPRVEND("IEN")=$P(Y,"^",1)
"RTN","RMPRPIY7",178,0)
 S RMPRVEND("NAME")=$P(Y,"^",2)
"RTN","RMPRPIY7",179,0)
VENDX Q RMPRERR
"RTN","RMPRPIY7",180,0)
 ;
"RTN","RMPRPIY7",181,0)
 ;***** PVEN - Pick the current stock record to edit
"RTN","RMPRPIY7",182,0)
PVEN(RMPRSTN,RMPRLCN,RMPRHCPC,RMPRITM,RMPR6,RMPR7,RMPREXC) ;
"RTN","RMPRPIY7",183,0)
 N DIR,X,Y,DA,RMPRGBL,RMPRLIN,RMPRA,RMPRERR,RMPRX,RMPRY,RMPRB
"RTN","RMPRPIY7",184,0)
 N RMPR7I
"RTN","RMPRPIY7",185,0)
 S RMPREXC=""
"RTN","RMPRPIY7",186,0)
 S RMPRX="",RMPRY=0
"RTN","RMPRPIY7",187,0)
 S RMPRLIN=0
"RTN","RMPRPIY7",188,0)
 S RMPRGBL=$Q(^RMPR(661.7,"XSLHIDS",RMPRSTN,RMPRLCN,RMPRHCPC,RMPRITM))
"RTN","RMPRPIY7",189,0)
 G PVEN1A
"RTN","RMPRPIY7",190,0)
PVEN1 S RMPRGBL=$Q(@RMPRGBL)
"RTN","RMPRPIY7",191,0)
PVEN1A I $QS(RMPRGBL,1)'=661.7 G PVEN2
"RTN","RMPRPIY7",192,0)
 I $QS(RMPRGBL,2)'="XSLHIDS" G PVEN2
"RTN","RMPRPIY7",193,0)
 I $QS(RMPRGBL,3)'=RMPRSTN G PVEN2
"RTN","RMPRPIY7",194,0)
 I $QS(RMPRGBL,4)'=RMPRLCN G PVEN2
"RTN","RMPRPIY7",195,0)
 I $QS(RMPRGBL,5)'=RMPRHCPC G PVEN2
"RTN","RMPRPIY7",196,0)
 I $QS(RMPRGBL,6)'=RMPRITM G PVEN2
"RTN","RMPRPIY7",197,0)
 S RMPRLIN=RMPRLIN+1
"RTN","RMPRPIY7",198,0)
 S RMPRA(RMPRLIN)=$QS(RMPRGBL,9)
"RTN","RMPRPIY7",199,0)
 G PVEN1
"RTN","RMPRPIY7",200,0)
PVEN2 I RMPRLIN=0 G PVENX
"RTN","RMPRPIY7",201,0)
 I RMPRLIN=1 S X=1 G PVEN3
"RTN","RMPRPIY7",202,0)
 W !,"Select a current Stock Record to edit...",!
"RTN","RMPRPIY7",203,0)
 W !,?7,"Date",?21,"Quantity",?35,"Value",?42,"Vendor"
"RTN","RMPRPIY7",204,0)
 S RMPRX="",RMPRLIN=0
"RTN","RMPRPIY7",205,0)
 F  S RMPRX=$O(RMPRA(RMPRX)) Q:RMPRX=""  D
"RTN","RMPRPIY7",206,0)
 . S RMPRLIN=RMPRLIN+1
"RTN","RMPRPIY7",207,0)
 . K RMPR7
"RTN","RMPRPIY7",208,0)
 . S RMPR7("IEN")=RMPRA(RMPRX)
"RTN","RMPRPIY7",209,0)
 . S RMPRERR=$$GET^RMPRPIX7(.RMPR7)
"RTN","RMPRPIY7",210,0)
 . W !,?2,$J(RMPRLIN,2)
"RTN","RMPRPIY7",211,0)
 . W ?7,$P(RMPR7("DATE&TIME"),"@",1)
"RTN","RMPRPIY7",212,0)
 . W ?21,$J(RMPR7("QUANTITY"),8,0)
"RTN","RMPRPIY7",213,0)
 . W ?30,$J(RMPR7("VALUE"),10,2)
"RTN","RMPRPIY7",214,0)
 . K RMPR7I
"RTN","RMPRPIY7",215,0)
 . S RMPRERR=$$ETOI^RMPRPIX7(.RMPR7,.RMPR7I)
"RTN","RMPRPIY7",216,0)
 . K RMPR6
"RTN","RMPRPIY7",217,0)
 . S RMPR6("DATE&TIME")=RMPR7I("DATE&TIME")
"RTN","RMPRPIY7",218,0)
 . S RMPR6("HCPCS")=RMPRHCPC
"RTN","RMPRPIY7",219,0)
 . S RMPRERR=$$GET^RMPRPIX6(.RMPR6)
"RTN","RMPRPIY7",220,0)
 . W ?42,RMPR6("VENDOR")
"RTN","RMPRPIY7",221,0)
 . Q
"RTN","RMPRPIY7",222,0)
 K RMPR7,RMPR6
"RTN","RMPRPIY7",223,0)
 S DIR(0)="NAO^1:"_RMPRLIN_": "
"RTN","RMPRPIY7",224,0)
 S DIR("A")="CHOOSE 1-"_RMPRLIN_": "
"RTN","RMPRPIY7",225,0)
 D ^DIR
"RTN","RMPRPIY7",226,0)
 I $D(DTOUT) S RMPREXC="T" G PVENX
"RTN","RMPRPIY7",227,0)
 I $D(DIROUT) S RMPREXC="P" G PVENX
"RTN","RMPRPIY7",228,0)
 I X=""!(X["^")!$D(DUOUT) S RMPREXC="^" G PVENX
"RTN","RMPRPIY7",229,0)
PVEN3 S RMPR7("IEN")=RMPRA(X)
"RTN","RMPRPIY7",230,0)
 S RMPRERR=$$GET^RMPRPIX7(.RMPR7)
"RTN","RMPRPIY7",231,0)
 K RMPR7I
"RTN","RMPRPIY7",232,0)
 S RMPRERR=$$ETOI^RMPRPIX7(.RMPR7,.RMPR7I)
"RTN","RMPRPIY7",233,0)
 S RMPR6("DATE&TIME")=RMPR7I("DATE&TIME")
"RTN","RMPRPIY7",234,0)
 S RMPR6("HCPCS")=RMPRHCPC
"RTN","RMPRPIY7",235,0)
 S RMPRERR=$$GET^RMPRPIX6(.RMPR6)
"RTN","RMPRPIY7",236,0)
PVENX Q
"VER")
8.0^22.0
"BLD",8677,6)
^153
**END**
**END**

