Released GMRV*5*29 SEQ #20
Extracted from mail message
**KIDS**:GMRV*5.0*29^

**INSTALL NAME**
GMRV*5.0*29
"BLD",8763,0)
GMRV*5.0*29^GEN. MED. REC. - VITALS^0^3140221^y
"BLD",8763,1,0)
^^1^1^3140129^
"BLD",8763,1,1,0)
ADD VHIC API CALL FOR PATIENT LOOKUP
"BLD",8763,4,0)
^9.64PA^^
"BLD",8763,6.3)
7
"BLD",8763,"ABPKG")
n
"BLD",8763,"KRN",0)
^9.67PA^779.2^20
"BLD",8763,"KRN",.4,0)
.4
"BLD",8763,"KRN",.401,0)
.401
"BLD",8763,"KRN",.402,0)
.402
"BLD",8763,"KRN",.403,0)
.403
"BLD",8763,"KRN",.5,0)
.5
"BLD",8763,"KRN",.84,0)
.84
"BLD",8763,"KRN",3.6,0)
3.6
"BLD",8763,"KRN",3.8,0)
3.8
"BLD",8763,"KRN",9.2,0)
9.2
"BLD",8763,"KRN",9.8,0)
9.8
"BLD",8763,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",8763,"KRN",9.8,"NM",1,0)
GMVRPCP^^0^B31769410
"BLD",8763,"KRN",9.8,"NM","B","GMVRPCP",1)

"BLD",8763,"KRN",19,0)
19
"BLD",8763,"KRN",19.1,0)
19.1
"BLD",8763,"KRN",101,0)
101
"BLD",8763,"KRN",409.61,0)
409.61
"BLD",8763,"KRN",771,0)
771
"BLD",8763,"KRN",779.2,0)
779.2
"BLD",8763,"KRN",870,0)
870
"BLD",8763,"KRN",8989.51,0)
8989.51
"BLD",8763,"KRN",8989.52,0)
8989.52
"BLD",8763,"KRN",8994,0)
8994
"BLD",8763,"KRN","B",.4,.4)

"BLD",8763,"KRN","B",.401,.401)

"BLD",8763,"KRN","B",.402,.402)

"BLD",8763,"KRN","B",.403,.403)

"BLD",8763,"KRN","B",.5,.5)

"BLD",8763,"KRN","B",.84,.84)

"BLD",8763,"KRN","B",3.6,3.6)

"BLD",8763,"KRN","B",3.8,3.8)

"BLD",8763,"KRN","B",9.2,9.2)

"BLD",8763,"KRN","B",9.8,9.8)

"BLD",8763,"KRN","B",19,19)

"BLD",8763,"KRN","B",19.1,19.1)

"BLD",8763,"KRN","B",101,101)

"BLD",8763,"KRN","B",409.61,409.61)

"BLD",8763,"KRN","B",771,771)

"BLD",8763,"KRN","B",779.2,779.2)

"BLD",8763,"KRN","B",870,870)

"BLD",8763,"KRN","B",8989.51,8989.51)

"BLD",8763,"KRN","B",8989.52,8989.52)

"BLD",8763,"KRN","B",8994,8994)

"BLD",8763,"QUES",0)
^9.62^^
"BLD",8763,"REQB",0)
^9.611^2^2
"BLD",8763,"REQB",1,0)
DG*5.3*857^1
"BLD",8763,"REQB",2,0)
GMRV*5.0*22^1
"BLD",8763,"REQB","B","DG*5.3*857",1)

"BLD",8763,"REQB","B","GMRV*5.0*22",2)

"MBREQ")
0
"PKG",44,-1)
1^1
"PKG",44,0)
GEN. MED. REC. - VITALS^GMRV^Vitals/Measurements Module of General Medical Record.
"PKG",44,20,0)
^9.402P^^
"PKG",44,22,0)
^9.49I^1^1
"PKG",44,22,1,0)
5.0^3021029
"PKG",44,22,1,"PAH",1,0)
29^3140221
"PKG",44,22,1,"PAH",1,1,0)
^^1^1^3140221
"PKG",44,22,1,"PAH",1,1,1,0)
ADD VHIC API CALL FOR PATIENT LOOKUP
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","GMVRPCP")
0^1^B31769410^B29107373
"RTN","GMVRPCP",1,0)
GMVRPCP ;HOIFO/DP-RPC for GMV_PtSelect.pas ; 7/8/05 8:05am
"RTN","GMVRPCP",2,0)
 ;;5.0;GEN. MED. REC. - VITALS;**1,3,22,29**;Oct 31, 2002;Build 7
"RTN","GMVRPCP",3,0)
 ; Integration Agreements:
"RTN","GMVRPCP",4,0)
 ; IA# 510 [Controlled] Calls to set ^DISV
"RTN","GMVRPCP",5,0)
 ; IA# 3027 [Supported] Calls to DGSEC4
"RTN","GMVRPCP",6,0)
 ; IA# 3266 [Controlled] Calls to DOB^DPTLK1
"RTN","GMVRPCP",7,0)
 ; IA# 3267 [Controlled] Calls to SSN^DPTLK1
"RTN","GMVRPCP",8,0)
 ; IA# 3593 [Supported] Calls to DPTLK6
"RTN","GMVRPCP",9,0)
 ; IA# 4440 [Supported] XUPROD calls
"RTN","GMVRPCP",10,0)
 ; IA# 5888 [Controlled] Calls to VIC API
"RTN","GMVRPCP",11,0)
 ; IA# 10035 [Supported] Calls for FILE 2 references.
"RTN","GMVRPCP",12,0)
 ; IA# 10039 [Supported] Reads of ^DIC(42,#,44)
"RTN","GMVRPCP",13,0)
 ; IA# 10040 [Supported] Reads of ^SC(
"RTN","GMVRPCP",14,0)
 ; IA# 10061 [Supported] Calls to VADPT
"RTN","GMVRPCP",15,0)
 ; IA# 10112 [Supported] VASITE calls
"RTN","GMVRPCP",16,0)
 ;
"RTN","GMVRPCP",17,0)
 ; 01/28/2014 KAM GMRV*5*29 Add Call to VIC API during patient lookup
"RTN","GMVRPCP",18,0)
 ;
"RTN","GMVRPCP",19,0)
ADD(X) ; [Procedure] Add line to @RESULTS@(...
"RTN","GMVRPCP",20,0)
 ; Input parameters
"RTN","GMVRPCP",21,0)
 ;  1. X [Literal/Required] Data to add to @RESULTS@(...
"RTN","GMVRPCP",22,0)
 S @RESULTS@(+$O(@RESULTS@(""),-1)+1)=X
"RTN","GMVRPCP",23,0)
 Q
"RTN","GMVRPCP",24,0)
 ;
"RTN","GMVRPCP",25,0)
LOGSEC ; [Procedure] Log Security
"RTN","GMVRPCP",26,0)
 D NOTICE^DGSEC4(.GMVRET,DFN,DATA,3)
"RTN","GMVRPCP",27,0)
 S @RESULTS@(0)=$S(GMVRET:"1^Logged",1:"-1^Unable to log")
"RTN","GMVRPCP",28,0)
 Q
"RTN","GMVRPCP",29,0)
 ;
"RTN","GMVRPCP",30,0)
RPC(RESULTS,OPTION,DFN,DATA) ; [Procedure] Main RPC call tag
"RTN","GMVRPCP",31,0)
 ; RPC: [GMV PTSELECT]
"RTN","GMVRPCP",32,0)
 ; Input parameters
"RTN","GMVRPCP",33,0)
 ;  1. RESULTS [Literal/Required] RPC return array
"RTN","GMVRPCP",34,0)
 ;  2. OPTION [Literal/Required] Call method for RPC
"RTN","GMVRPCP",35,0)
 ;  3. DFN [Literal/Required] Patient IEN
"RTN","GMVRPCP",36,0)
 ;  4. DATA [Literal/Optional] Other data as required for call
"RTN","GMVRPCP",37,0)
 S RESULTS=$NA(^TMP("GMVPTSELECT",$J)) K @RESULTS
"RTN","GMVRPCP",38,0)
 D:$T(@OPTION)]"" @OPTION
"RTN","GMVRPCP",39,0)
 D:'$D(@RESULTS)
"RTN","GMVRPCP",40,0)
 .S @RESULTS@(0)="-1^No results returned"
"RTN","GMVRPCP",41,0)
 D CLEAN^DILF
"RTN","GMVRPCP",42,0)
 Q
"RTN","GMVRPCP",43,0)
 ;
"RTN","GMVRPCP",44,0)
HOSPLOC ; [Procedure] Return location as ptr to 44 or ""
"RTN","GMVRPCP",45,0)
 N VAIN
"RTN","GMVRPCP",46,0)
 D INP^VADPT S @RESULTS@(0)=+$G(^DIC(42,+VAIN(4),44),"")
"RTN","GMVRPCP",47,0)
 Q
"RTN","GMVRPCP",48,0)
 ;
"RTN","GMVRPCP",49,0)
PTHDR ; [Procedure] Patient Info for Header Displays
"RTN","GMVRPCP",50,0)
 I '$D(^DPT(+$G(DFN),0)) D  Q
"RTN","GMVRPCP",51,0)
 .S @RESULTS@(0)="-1^No Such DFN ["_$G(DFN,"<Null>")_"]"
"RTN","GMVRPCP",52,0)
 N GMVIENS
"RTN","GMVRPCP",53,0)
 S @RESULTS@(0)=+DFN,GMVIENS=(+DFN)_","
"RTN","GMVRPCP",54,0)
 S @RESULTS@(1)=$$GET1^DIQ(2,GMVIENS,.01)_"  "_$$GET1^DIQ(2,GMVIENS,.09)
"RTN","GMVRPCP",55,0)
 S @RESULTS@(2)="DOB: "_$$GET1^DIQ(2,GMVIENS,.03)_" "_$$GET1^DIQ(2,GMVIENS,.02)_", Age: "_$$GET1^DIQ(2,GMVIENS,.033)
"RTN","GMVRPCP",56,0)
 Q
"RTN","GMVRPCP",57,0)
 ;
"RTN","GMVRPCP",58,0)
PTLKUP ; [Procedure] Patient lookup handled separately for security
"RTN","GMVRPCP",59,0)
 N GMVIDX,CARDRSLT
"RTN","GMVRPCP",60,0)
 ;
"RTN","GMVRPCP",61,0)
 ; 01/28/2014 KAM GMRV*5*29 Add Call to VIC API during patient lookup
"RTN","GMVRPCP",62,0)
 ;(next two lines)
"RTN","GMVRPCP",63,0)
 D RPCVIC^DPTLK(.CARDRSLT,DATA) ;SUPPLIED VHIC CARD API
"RTN","GMVRPCP",64,0)
 I CARDRSLT>0 S DATA="`"_CARDRSLT
"RTN","GMVRPCP",65,0)
 ; The Variable DATA is unchanged if CARDRSLT is < 0
"RTN","GMVRPCP",66,0)
 ;
"RTN","GMVRPCP",67,0)
 S GMVIDX=$S(DATA?9N.1"P":"SSN",1:"B^BS^BS5")
"RTN","GMVRPCP",68,0)
 D FIND^DIC(2,"","@;.01;.02;.03;.09","MP",DATA,60,GMVIDX)
"RTN","GMVRPCP",69,0)
 I $P(^TMP("DILIST",$J,0),U,3) D  Q
"RTN","GMVRPCP",70,0)
 .S @RESULTS@(0)="-1^Too many patients found matching '"_DATA_"'. Please be more specific."
"RTN","GMVRPCP",71,0)
 F GMV=0:0 S GMV=$O(^TMP("DILIST",$J,GMV)) Q:'GMV  D
"RTN","GMVRPCP",72,0)
 .S @RESULTS@(GMV)=$$PTREC(+^TMP("DILIST",$J,GMV,0))
"RTN","GMVRPCP",73,0)
 I '$D(@RESULTS) S @RESULTS@(0)="-1^No patients matching '"_DATA_"'"
"RTN","GMVRPCP",74,0)
 E  S @RESULTS@(0)=+$O(@RESULTS@(""),-1)
"RTN","GMVRPCP",75,0)
 Q
"RTN","GMVRPCP",76,0)
 ;
"RTN","GMVRPCP",77,0)
PTREC(DFN) ;
"RTN","GMVRPCP",78,0)
 ; Extrinsic to return a Pt Rec  in standard list format
"RTN","GMVRPCP",79,0)
 N GMV
"RTN","GMVRPCP",80,0)
 S GMV=$G(^DPT(DFN,0))
"RTN","GMVRPCP",81,0)
 S GMV="2;"_DFN_U_$P(GMV,U,1)_U_$P(GMV,U,2)_U_$P(GMV,U,3)_U_$P(GMV,U,9)
"RTN","GMVRPCP",82,0)
 S $P(GMV,U,10)=$$DOB^DPTLK1(DFN)
"RTN","GMVRPCP",83,0)
 S $P(GMV,U,11)=$$SSN^DPTLK1(DFN)
"RTN","GMVRPCP",84,0)
 Q GMV
"RTN","GMVRPCP",85,0)
 ;
"RTN","GMVRPCP",86,0)
SELECT ; [Procedure] Select patient
"RTN","GMVRPCP",87,0)
 ; Calls required utilities to check security and
"RTN","GMVRPCP",88,0)
 ; return associated warnings/alerts about a
"RTN","GMVRPCP",89,0)
 ; patient being selected.
"RTN","GMVRPCP",90,0)
 ; Variables:
"RTN","GMVRPCP",91,0)
 ;  IENS: [Private] Fileman IENS
"RTN","GMVRPCP",92,0)
 ;  GMVDFN: [Private] Scratch
"RTN","GMVRPCP",93,0)
 ;  GMVFLD: [Private] FIeld number
"RTN","GMVRPCP",94,0)
 ;  GMVID: [Private] Identifier array
"RTN","GMVRPCP",95,0)
 ;  GMVRET: [Private] Scratch
"RTN","GMVRPCP",96,0)
 ;  GMVX: [Private] Scratch
"RTN","GMVRPCP",97,0)
 ; New private variables
"RTN","GMVRPCP",98,0)
 NEW IENS,GMVCNT,GMVDFN,GMVFLD,GMVHLIEN,GMVI,GMVID,GMVIDS,GMVRET,GMVX,GMVIDIEN
"RTN","GMVRPCP",99,0)
 I '$D(^DPT(+$G(DFN),0))#2 S @RESULTS@(0)="-1^No such patient" Q
"RTN","GMVRPCP",100,0)
 S ^DISV(DUZ,"^DPT(")=DFN ;spacebar return
"RTN","GMVRPCP",101,0)
 S @RESULTS@(0)="1^Required Identifiers & messages"
"RTN","GMVRPCP",102,0)
 S IENS=DFN_","
"RTN","GMVRPCP",103,0)
 D FILE^DID(2,,"REQUIRED IDENTIFIERS","GMVIDS")
"RTN","GMVRPCP",104,0)
 F GMVX=0:0 S GMVX=$O(GMVIDS("REQUIRED IDENTIFIERS",GMVX)) Q:'GMVX  D
"RTN","GMVRPCP",105,0)
 .S GMVFLD=GMVIDS("REQUIRED IDENTIFIERS",GMVX,"FIELD")
"RTN","GMVRPCP",106,0)
 .S GMVID="$$PTID^"_$$GET1^DID(2,GMVFLD,"","LABEL")
"RTN","GMVRPCP",107,0)
 .S GMVID=GMVID_U_$$GET1^DIQ(2,IENS,GMVFLD)
"RTN","GMVRPCP",108,0)
 .D:GMVFLD=.03
"RTN","GMVRPCP",109,0)
 ..S GMVID=GMVID_" ("_$$GET1^DIQ(2,IENS,.033)_")"
"RTN","GMVRPCP",110,0)
 ..S GMVID=GMVID_U_$$DOB^DPTLK1(+IENS)
"RTN","GMVRPCP",111,0)
 .D:GMVFLD=.09
"RTN","GMVRPCP",112,0)
 ..S X=$P(GMVID,U,3),X=$E(X,1,3)_"-"_$E(X,4,5)_"-"_$E(X,6,10)
"RTN","GMVRPCP",113,0)
 ..S $P(GMVID,U,3)=X,$P(GMVID,U,4)=$$SSN^DPTLK1(+IENS)
"RTN","GMVRPCP",114,0)
 .S @RESULTS@($O(@RESULTS@(""),-1)+1)=GMVID
"RTN","GMVRPCP",115,0)
 ; Add ward and Room/Bed
"RTN","GMVRPCP",116,0)
 S GMVID="$$PTID^"_$$GET1^DID(2,.1,"","LABEL")
"RTN","GMVRPCP",117,0)
 S GMVID=GMVID_U_$$GET1^DIQ(2,IENS,.1)
"RTN","GMVRPCP",118,0)
 S GMVIDIEN=$P(GMVID,U,3)
"RTN","GMVRPCP",119,0)
 S GMVIDIEN=$$IDIEN(GMVIDIEN)
"RTN","GMVRPCP",120,0)
 S @RESULTS@($O(@RESULTS@(""),-1)+1)=GMVID
"RTN","GMVRPCP",121,0)
 S GMVID="$$PTID^"_$$GET1^DID(2,.101,"","LABEL")
"RTN","GMVRPCP",122,0)
 S GMVID=GMVID_U_$$GET1^DIQ(2,IENS,.101)
"RTN","GMVRPCP",123,0)
 S @RESULTS@($O(@RESULTS@(""),-1)+1)=GMVID
"RTN","GMVRPCP",124,0)
 ; ------- Clevland Alert -------
"RTN","GMVRPCP",125,0)
 K GMVRET
"RTN","GMVRPCP",126,0)
 D GUIBS5A^DPTLK6(.GMVRET,DFN) D:GMVRET(1)=1
"RTN","GMVRPCP",127,0)
 .D ADD("$$MSGHDR^2^SAME LAST NAME AND LAST 4")
"RTN","GMVRPCP",128,0)
 .S GMVX=1
"RTN","GMVRPCP",129,0)
 .F  S GMVX=$O(GMVRET(GMVX)) Q:'GMVX!(+$G(GMVRET(GMVX)))  D
"RTN","GMVRPCP",130,0)
 ..D ADD($P(GMVRET(GMVX),U,2))
"RTN","GMVRPCP",131,0)
 .D ADD(" ")
"RTN","GMVRPCP",132,0)
 .S GMVX=1
"RTN","GMVRPCP",133,0)
 .F  S GMVX=$O(GMVRET(GMVX)) Q:'GMVX  D:+GMVRET(GMVX)
"RTN","GMVRPCP",134,0)
 ..S GMVDFN=+$P(GMVRET(GMVX),U,2)
"RTN","GMVRPCP",135,0)
 ..D ADD($$GET1^DIQ(2,GMVDFN_",",.01)_"    "_$$DOB^DPTLK1(GMVDFN)_"    "_$$SSN^DPTLK1(GMVDFN))
"RTN","GMVRPCP",136,0)
 .D ADD(" ")
"RTN","GMVRPCP",137,0)
 .D ADD("Please review carefully before continuing")
"RTN","GMVRPCP",138,0)
 .D ADD("$$MSGEND")
"RTN","GMVRPCP",139,0)
 ; ------- Sensitive Record? -------
"RTN","GMVRPCP",140,0)
 K GMVRET
"RTN","GMVRPCP",141,0)
 D PTSEC^DGSEC4(.GMVRET,DFN) D:GMVRET(1)'=0
"RTN","GMVRPCP",142,0)
 .D:GMVRET(1)=3
"RTN","GMVRPCP",143,0)
 ..D ADD("$$MSGHDR^0^CAN'T ACCESS YOUR OWN RECORD!!")
"RTN","GMVRPCP",144,0)
 .D:GMVRET(1)=-1
"RTN","GMVRPCP",145,0)
 ..D ADD("$$MSGHDR^0^INCOMPLETE INFORMATION - CAN'T PROCEED")
"RTN","GMVRPCP",146,0)
 .D:GMVRET(1)=1
"RTN","GMVRPCP",147,0)
 ..D ADD("$$MSGHDR^1^SENSITIVE RECORD ACCESS")
"RTN","GMVRPCP",148,0)
 .D:GMVRET(1)'=-1&(GMVRET(1)'=3)&(GMVRET(1)'=1)
"RTN","GMVRPCP",149,0)
 ..D ADD("$$MSGHDR^3^SENSITIVE RECORD ACCESS")
"RTN","GMVRPCP",150,0)
 .S GMVX=1
"RTN","GMVRPCP",151,0)
 .F  S GMVX=$O(GMVRET(GMVX)) Q:'GMVX  D ADD($TR(GMVRET(GMVX),"*"," "))
"RTN","GMVRPCP",152,0)
 .D ADD("$$MSGEND")
"RTN","GMVRPCP",153,0)
 ; ------- Means Test Information? -------
"RTN","GMVRPCP",154,0)
 D GUIMTD^DPTLK6(.GMVRET,DFN) D:GMVRET(1)=1
"RTN","GMVRPCP",155,0)
 .D ADD("$$MSGHDR^1^NOTICE")
"RTN","GMVRPCP",156,0)
 .F GMVX=1:0 S GMVX=$O(GMVRET(GMVX)) Q:'GMVX  D ADD(GMVRET(GMVX))
"RTN","GMVRPCP",157,0)
 .D ADD("$$MSGEND")
"RTN","GMVRPCP",158,0)
 Q
"RTN","GMVRPCP",159,0)
 ;
"RTN","GMVRPCP",160,0)
IDIEN(GMVIEN) ;
"RTN","GMVRPCP",161,0)
 S GMVIEN=$G(GMVIEN)
"RTN","GMVRPCP",162,0)
 I GMVIEN="" Q ""
"RTN","GMVRPCP",163,0)
 S GMVIEN=$O(^DIC(42,"B",GMVIEN,0))
"RTN","GMVRPCP",164,0)
 I 'GMVIEN Q ""
"RTN","GMVRPCP",165,0)
 S GMVIEN=$P($G(^DIC(42,+GMVIEN,44)),"U",1)
"RTN","GMVRPCP",166,0)
 Q GMVIEN
"RTN","GMVRPCP",167,0)
 ;
"RTN","GMVRPCP",168,0)
CCOW ; Return CCOW site and production indicator
"RTN","GMVRPCP",169,0)
 S @RESULTS@(0)=$P($$SITE^VASITE(),"^",3)_"^"_$$PROD^XUPROD()
"RTN","GMVRPCP",170,0)
 Q
"RTN","GMVRPCP",171,0)
 ;
"VER")
8.0^22.0
"BLD",8763,6)
^20
**END**
**END**

