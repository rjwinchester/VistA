Released PSJ*5*323 SEQ #278
Extracted from mail message
**KIDS**:PSJ*5.0*323^

**INSTALL NAME**
PSJ*5.0*323
"BLD",10051,0)
PSJ*5.0*323^INPATIENT MEDICATIONS^0^3160503^y
"BLD",10051,1,0)
^^4^4^3151014^
"BLD",10051,1,1,0)
This patch will resolve the following issues:
"BLD",10051,1,2,0)
1)  Erroneous data on Patient on Specific Drug Report
"BLD",10051,1,3,0)
2)  Ward Stock issue with Clinic Orders
"BLD",10051,1,4,0)
3)  IV order of PRN is printing multiple labels
"BLD",10051,4,0)
^9.64PA^55^1
"BLD",10051,4,55,0)
55
"BLD",10051,4,55,2,0)
^9.641^55.06^1
"BLD",10051,4,55,2,55.06,0)
UNIT DOSE  (sub-file)
"BLD",10051,4,55,2,55.06,1,0)
^9.6411^34^1
"BLD",10051,4,55,2,55.06,1,34,0)
STOP DATE/TIME
"BLD",10051,4,55,222)
y^n^p^^^^n^^n
"BLD",10051,4,55,224)

"BLD",10051,4,"APDD",55,55.06)

"BLD",10051,4,"APDD",55,55.06,34)

"BLD",10051,4,"B",55,55)

"BLD",10051,6.3)
10
"BLD",10051,"INID")
^y
"BLD",10051,"INIT")
START^PSJ323PO
"BLD",10051,"KRN",0)
^9.67PA^779.2^20
"BLD",10051,"KRN",.4,0)
.4
"BLD",10051,"KRN",.401,0)
.401
"BLD",10051,"KRN",.402,0)
.402
"BLD",10051,"KRN",.403,0)
.403
"BLD",10051,"KRN",.5,0)
.5
"BLD",10051,"KRN",.84,0)
.84
"BLD",10051,"KRN",3.6,0)
3.6
"BLD",10051,"KRN",3.8,0)
3.8
"BLD",10051,"KRN",9.2,0)
9.2
"BLD",10051,"KRN",9.8,0)
9.8
"BLD",10051,"KRN",9.8,"NM",0)
^9.68A^3^3
"BLD",10051,"KRN",9.8,"NM",1,0)
PSJLMPRU^^0^B15059824
"BLD",10051,"KRN",9.8,"NM",2,0)
PSGPEN^^0^B40801558
"BLD",10051,"KRN",9.8,"NM",3,0)
PSIVORFB^^0^B86884261
"BLD",10051,"KRN",9.8,"NM","B","PSGPEN",2)

"BLD",10051,"KRN",9.8,"NM","B","PSIVORFB",3)

"BLD",10051,"KRN",9.8,"NM","B","PSJLMPRU",1)

"BLD",10051,"KRN",19,0)
19
"BLD",10051,"KRN",19.1,0)
19.1
"BLD",10051,"KRN",101,0)
101
"BLD",10051,"KRN",409.61,0)
409.61
"BLD",10051,"KRN",771,0)
771
"BLD",10051,"KRN",779.2,0)
779.2
"BLD",10051,"KRN",870,0)
870
"BLD",10051,"KRN",8989.51,0)
8989.51
"BLD",10051,"KRN",8989.52,0)
8989.52
"BLD",10051,"KRN",8994,0)
8994
"BLD",10051,"KRN","B",.4,.4)

"BLD",10051,"KRN","B",.401,.401)

"BLD",10051,"KRN","B",.402,.402)

"BLD",10051,"KRN","B",.403,.403)

"BLD",10051,"KRN","B",.5,.5)

"BLD",10051,"KRN","B",.84,.84)

"BLD",10051,"KRN","B",3.6,3.6)

"BLD",10051,"KRN","B",3.8,3.8)

"BLD",10051,"KRN","B",9.2,9.2)

"BLD",10051,"KRN","B",9.8,9.8)

"BLD",10051,"KRN","B",19,19)

"BLD",10051,"KRN","B",19.1,19.1)

"BLD",10051,"KRN","B",101,101)

"BLD",10051,"KRN","B",409.61,409.61)

"BLD",10051,"KRN","B",771,771)

"BLD",10051,"KRN","B",779.2,779.2)

"BLD",10051,"KRN","B",870,870)

"BLD",10051,"KRN","B",8989.51,8989.51)

"BLD",10051,"KRN","B",8989.52,8989.52)

"BLD",10051,"KRN","B",8994,8994)

"BLD",10051,"QDEF")
^^^^NO^^^^^^NO
"BLD",10051,"QUES",0)
^9.62^^
"BLD",10051,"REQB",0)
^9.611^2^2
"BLD",10051,"REQB",1,0)
PSJ*5.0*129^2
"BLD",10051,"REQB",2,0)
PSJ*5.0*299^2
"BLD",10051,"REQB","B","PSJ*5.0*129",1)

"BLD",10051,"REQB","B","PSJ*5.0*299",2)

"FIA",55)
PHARMACY PATIENT
"FIA",55,0)
^PS(55,
"FIA",55,0,0)
55P
"FIA",55,0,1)
y^n^p^^^^n^^n
"FIA",55,0,10)

"FIA",55,0,11)

"FIA",55,0,"RLRO")

"FIA",55,0,"VR")
5.0^PSJ
"FIA",55,55)
1
"FIA",55,55.06)
1
"FIA",55,55.06,34)

"INIT")
START^PSJ323PO
"IX",55,55,"ACRUD",0)
55^ACRUD^Clinical Reminders index.^MU^^R^IR^W^55.06^^^^^A
"IX",55,55,"ACRUD",.1,0)
^^8^8^3041215
"IX",55,55,"ACRUD",.1,1,0)
This cross-reference builds two indexes, one for finding
"IX",55,55,"ACRUD",.1,2,0)
all patients with a particular drug and one for
"IX",55,55,"ACRUD",.1,3,0)
finding all the drugs a patient has. The indexes are
"IX",55,55,"ACRUD",.1,4,0)
stored in the Clinical Reminders index global as:
"IX",55,55,"ACRUD",.1,5,0)
 ^PXRMINDX(55,"IP",DRUG,DFN,START,STOP,DAS)
"IX",55,55,"ACRUD",.1,6,0)
 ^PXRMINDX(55,"PI",DFN,DRUG,START,STOP,DAS)
"IX",55,55,"ACRUD",.1,7,0)
respectively. START is the start date and STOP is the stop date.
"IX",55,55,"ACRUD",.1,8,0)
For all the details, see the Clinical Reminders Index Technical Guide/Programmer's Manual.
"IX",55,55,"ACRUD",1)
D SPSPA^PSJXRFS(.X,.DA,"UD")
"IX",55,55,"ACRUD",1.4)
S X=$$PATCH^XPDUTL("PXRM*1.5*12")
"IX",55,55,"ACRUD",2)
D KPSPA^PSJXRFK(.X,.DA,"UD")
"IX",55,55,"ACRUD",2.4)
S X=$$PATCH^XPDUTL("PXRM*1.5*12")
"IX",55,55,"ACRUD",2.5)
K ^PXRMINDX(55)
"IX",55,55,"ACRUD",11.1,0)
^.114IA^2^2
"IX",55,55,"ACRUD",11.1,1,0)
1^F^55.06^10^^1^F
"IX",55,55,"ACRUD",11.1,2,0)
2^F^55.06^34^^2^F
"IX",55,55,"AUDC",0)
55^AUDC^List of patients with orders associated with clinic appointments.^R^^R^IR^W^55.06^^^^^S
"IX",55,55,"AUDC",1)
S ^PS(55,"AUDC",$E(X(1),1,20),$E(X(2),1,20),DA(1),DA)=""
"IX",55,55,"AUDC",2)
K ^PS(55,"AUDC",$E(X(1),1,20),$E(X(2),1,20),DA(1),DA)
"IX",55,55,"AUDC",2.5)
K ^PS(55,"AUDC")
"IX",55,55,"AUDC",11.1,0)
^.114IA^3^2
"IX",55,55,"AUDC",11.1,2,0)
1^F^55.06^34^20^1^F
"IX",55,55,"AUDC",11.1,3,0)
2^F^55.06^130^20^2^F
"IX",55,55,"CIMOU",0)
55^CIMOU^CIMOU - PS(55,"CIMOU",PATIENT,CLINIC,STOP DATE/TIME,PATIENT,ORDER)^R^^R^IR^W^55.06^^^^^LS
"IX",55,55,"CIMOU",.1,0)
^^11^11^3130626^
"IX",55,55,"CIMOU",.1,1,0)
This cross reference is used during enhanced order checks for quick 
"IX",55,55,"CIMOU",.1,2,0)
access to clinic order information for unit dose orders by PATIENT, 
"IX",55,55,"CIMOU",.1,3,0)
CLINIC, STOP DATE/TIME and ORDER NUMBER.
"IX",55,55,"CIMOU",.1,4,0)
 
"IX",55,55,"CIMOU",.1,5,0)
The set condition checks to see if the clinic is defined with YES answered
"IX",55,55,"CIMOU",.1,6,0)
for the ADMINISTER INPATIENT MEDS parameter under the SET UP A CLINIC
"IX",55,55,"CIMOU",.1,7,0)
[SDBUILD] option and if the order has an appointment date/time defined.  
"IX",55,55,"CIMOU",.1,8,0)
If both are true, the cross reference is defined.
"IX",55,55,"CIMOU",.1,9,0)
 
"IX",55,55,"CIMOU",.1,10,0)
Using the same criteria, this cross reference will be defined if a clinic
"IX",55,55,"CIMOU",.1,11,0)
is added or edited using the CLINIC DEFINITION [PSJ CD] option.
"IX",55,55,"CIMOU",1)
S ^PS(55,"CIMOU",X(1),X(2),X(3),DA(1),DA)=""
"IX",55,55,"CIMOU",1.4)
S X=$$CHECK^PSJIMO1() I X
"IX",55,55,"CIMOU",2)
K ^PS(55,"CIMOU",X(1),X(2),X(3),DA(1),DA)
"IX",55,55,"CIMOU",2.5)
K ^PS(55,"CIMOU")
"IX",55,55,"CIMOU",11.1,0)
^.114IA^3^3
"IX",55,55,"CIMOU",11.1,1,0)
1^F^55.06^.5^^1^F
"IX",55,55,"CIMOU",11.1,2,0)
2^F^55.06^130^^2^F
"IX",55,55,"CIMOU",11.1,3,0)
3^F^55.06^34^^3^F
"IX",55,55.06,"AUN",0)
55.06^AUN^Clinic cross-reference.^R^^R^IR^I^55.06^^^^^S
"IX",55,55.06,"AUN",.1,0)
^^2^2^3040729^
"IX",55,55.06,"AUN",.1,1,0)
This cross-reference is used to easily determine if a specific patient 
"IX",55,55.06,"AUN",.1,2,0)
has clinic orders.
"IX",55,55.06,"AUN",1)
S ^PS(55,DA(1),5,"AUN",X(1),X(2),DA)=""
"IX",55,55.06,"AUN",2)
K ^PS(55,DA(1),5,"AUN",X(1),X(2),DA)
"IX",55,55.06,"AUN",2.5)
K ^PS(55,DA(1),5,"AUN")
"IX",55,55.06,"AUN",11.1,0)
^.114IA^2^2
"IX",55,55.06,"AUN",11.1,1,0)
1^F^55.06^34^^1^F
"IX",55,55.06,"AUN",11.1,1,3)

"IX",55,55.06,"AUN",11.1,2,0)
2^F^55.06^130^^2^F
"IX",55,55.06,"AUN",11.1,2,3)

"MBREQ")
0
"PKG",471,-1)
1^1
"PKG",471,0)
INPATIENT MEDICATIONS^PSJ^UNIT DOSE AND IVS
"PKG",471,20,0)
^9.402P^^
"PKG",471,22,0)
^9.49I^1^1
"PKG",471,22,1,0)
5.0^2971215^2990325^66481
"PKG",471,22,1,"PAH",1,0)
323^3160503
"PKG",471,22,1,"PAH",1,1,0)
^^4^4^3160503
"PKG",471,22,1,"PAH",1,1,1,0)
This patch will resolve the following issues:
"PKG",471,22,1,"PAH",1,1,2,0)
1)  Erroneous data on Patient on Specific Drug Report
"PKG",471,22,1,"PAH",1,1,3,0)
2)  Ward Stock issue with Clinic Orders
"PKG",471,22,1,"PAH",1,1,4,0)
3)  IV order of PRN is printing multiple labels
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","PSGPEN")
0^2^B40801558^B39805137
"RTN","PSGPEN",1,0)
PSGPEN ;BIR/CML3 - FIND DEFAULT FOR PRE-EXCHANGE NEEDS ;03 Feb 99 / 9:13 AM
"RTN","PSGPEN",2,0)
 ;;5.0;INPATIENT MEDICATIONS;**30,37,50,58,115,110,127,129,323**;16 DEC 97;Build 10
"RTN","PSGPEN",3,0)
 ;
"RTN","PSGPEN",4,0)
 ; References to ^PSD(58.8 supported by DBIA #2283.
"RTN","PSGPEN",5,0)
 ; References to ^PSI(58.1 supported by DBIA #2284.
"RTN","PSGPEN",6,0)
 ; Reference to ^PS(55 is supported by DBIA #2191.
"RTN","PSGPEN",7,0)
 ; Reference to ^PSDRUG is supported by DBIA #2192.
"RTN","PSGPEN",8,0)
 ; Reference to ^PS(59.7 is supported by DBIA #2181.
"RTN","PSGPEN",9,0)
 ;
"RTN","PSGPEN",10,0)
EN(PSGPENO) ;
"RTN","PSGPEN",11,0)
 S PSGPENO=+PSGPENO
"RTN","PSGPEN",12,0)
 N PSJSITE,PSJPRN,PSJCLO,ND8 S PSJCLO=0,ND8=0 S PSJSITE=0,PSJSITE=$O(^PS(59.7,PSJSITE)) I $P($G(^(PSJSITE,26)),U,5)=1 S PSJPRN=1
"RTN","PSGPEN",13,0)
 D NOW^%DTC S PSGDT=%,DT=$$DT^XLFDT,PSGPEN="" S ND=$G(^PS(55,PSGP,5,PSGPENO,0)),ND8=$G(^PS(55,PSGP,5,PSGPENO,8))
"RTN","PSGPEN",14,0)
 S:$P(ND8,"^",2) PSJCLO=1
"RTN","PSGPEN",15,0)
 S PSGPENWS=0 I PSJPWD,'PSJCLO F Q=0:0 S Q=$O(^PS(55,PSGP,5,PSGPENO,1,Q)) Q:'Q  S ND=$G(^(Q,0)) I ND,'$P(ND,"^",3),($D(^PSI(58.1,"D",+ND,PSJPWD))!$D(^PSD(58.8,"D",+ND,PSJPWD))) S PSGPENWS=1 Q
"RTN","PSGPEN",16,0)
 I PSGPENWS F  S Q=$O(^PS(55,PSGP,5,PSGPENO,1,Q)) Q:'Q  S ND=$G(^(Q,0)) I ND,'$P(ND,"^",3) S:'$D(^PSI(58.1,"D",+ND,PSJPWD))&'$D(^PSD(58.8,"D",+ND,PSJPWD)) PSGPENWS=0 Q:'PSGPENWS  S $P(PSGPENWS,"^",2)=1
"RTN","PSGPEN",17,0)
 I PSGPENWS W !!,"The dispense drug",$E("s",$P(PSGPENWS,"^",2))," for this order ",$S($P(PSGPENWS,"^",2):"are",1:"is a")," WARD STOCK item",$E("s",$P(PSGPENWS,"^",2)),"." S PSGPEN=0
"RTN","PSGPEN",18,0)
 I 'PSGPENWS,PSJPWD S WG=+$O(^PS(57.5,"AB",PSJPWD,0)),PSGPLS=$P($G(^PS(55,PSGP,5,PSGPENO,2)),"^",2) I PSGPLS D
"RTN","PSGPEN",19,0)
 .S PSGPLF=$O(^PS(53.5,"AB",WG,PSGDT))
"RTN","PSGPEN",20,0)
 .N RNDT,PSJRNOS S RNDT=$$LASTREN^PSJLMPRI(PSGP,$S($G(PSJORD)["P":PSJORD,1:"")),PSJRNOS=$P(RNDT,"^",4) I PSJRNOS,'$G(PSJREN) S PSGPLS=PSJRNOS
"RTN","PSGPEN",21,0)
 .I $G(PSJREN),$G(PSJORD)["U" S PSJRNOS=$P(^PS(55,PSGP,5,+PSJORD,2),"^",4) S PSGPLS=$S(PSJRNOS>PSGDT:PSJRNOS,1:$$DATE2^PSJUTL2(PSGDT))
"RTN","PSGPEN",22,0)
 .D:'PSGPLF GF I PSGPLF S PSGPLO=PSGPENO D NCE,^PSGPL0 S:PSGPLC'<0 PSGPEN=PSGPLC
"RTN","PSGPEN",23,0)
 I $G(PSGPRIO)="DONE" S PSGPEN=0
"RTN","PSGPEN",24,0)
 ;
"RTN","PSGPEN",25,0)
UPDD ;
"RTN","PSGPEN",26,0)
 N DIR S DIR(0)="NOA^0:9999:0",DIR("A")="Pre-Exchange DOSES: ",DIR("?")="^D DH^PSGPEN" S:PSGPEN]"" DIR("B")=PSGPEN W ! D ^DIR G:'Y DONE S PSGY=+Y W !!,"...updating dispense drug(s)..."
"RTN","PSGPEN",27,0)
 F FQ=0:0 S FQ=$O(^PS(55,PSGP,5,PSGPENO,1,FQ)) Q:'FQ  S ND=$G(^(FQ,0)),$P(^(0),"^",9)="" I ND,'$P(ND,"^",3) D DD
"RTN","PSGPEN",28,0)
 ;
"RTN","PSGPEN",29,0)
DONE ;
"RTN","PSGPEN",30,0)
 I $P(PSJSYSW0,"^",29)="",$$DEFON^PSGPER1 S $P(PSJSYSW0,"^",29)=0
"RTN","PSGPEN",31,0)
 K PSGID,PSGMAR,PSGOD,PSGPLC,PSGPLF,PSGPLO,PSGPLS,PSGPLUD,WG S:$G(PSJREN) DUOUT=0 Q
"RTN","PSGPEN",32,0)
 ;
"RTN","PSGPEN",33,0)
NCE ;
"RTN","PSGPEN",34,0)
 W !!,"The next cart exchange is ",$$ENDTC^PSGMI(PSGPLF),! Q
"RTN","PSGPEN",35,0)
 ;
"RTN","PSGPEN",36,0)
GF ;
"RTN","PSGPEN",37,0)
 S QQ=0 F Q=0:0 S Q=$O(^PS(53.5,"AB",WG,Q)) Q:'Q  S QQ=Q
"RTN","PSGPEN",38,0)
 I QQ S QQ=$O(^PS(53.5,"AB",WG,QQ,0)) I QQ,$D(^PS(53.5,QQ,0)) S QQ=$P(^(0),"^",4) I QQ>PSGDT S PSGPLF=QQ
"RTN","PSGPEN",39,0)
 Q
"RTN","PSGPEN",40,0)
 ;
"RTN","PSGPEN",41,0)
DD ;
"RTN","PSGPEN",42,0)
 N DA S DRG=$S($P(ND,"^")="":"NOT FOUND",'$D(^PSDRUG(+ND,0)):"NOT FOUND ("_$P(ND,"^")_")",$P(^(0),"^")]"":$P(^(0),"^"),1:$P(ND,"^")_";PSDRUG("),UD=$S('$P(ND,"^",2):1,1:$P(ND,"^",2))
"RTN","PSGPEN",43,0)
 W !,"...",DRG,?45,"U/D: ",UD,"..."
"RTN","PSGPEN",44,0)
 S PSGDA=PSGY I 'PSGPENWS,'PSJCLO,ND,PSJPWD,($D(^PSI(58.1,"D",+ND,PSJPWD))!$D(^PSD(58.8,"D",+ND,PSJPWD))) D PSGPENWS Q:'PSGDA
"RTN","PSGPEN",45,0)
 K DA,DR S PSGDA=$S(UD#1:(PSGDA*((UD\1)+1)),1:PSGDA*UD)
"RTN","PSGPEN",46,0)
 S DIE="^PS(55,"_PSGP_",5,"_PSGPENO_",1,",DA(2)=PSGP,DA(1)=PSGPENO,DA=FQ,DR=".09////"_PSGDA D ^DIE
"RTN","PSGPEN",47,0)
 S PSGPXN=$G(PSGPXN)
"RTN","PSGPEN",48,0)
 D:'PSGPXN
"RTN","PSGPEN",49,0)
 .D NOW^%DTC L +^PS(53.4,0):0 S ND=$G(^PS(53.4,0)) S:ND="" ND="PRE-EXCHANGE NEEDS^53.4P" F PSGPXN=$P(ND,"^",3)+1:1 I '$D(^PS(53.4,PSGPXN)) L +^PS(53.4,PSGPXN):0 I  S ^PS(53.4,0)=$P(ND,"^",1,2)_"^"_PSGPXN_"^"_($P(ND,"^",4)+1) L -^PS(53.4,0) Q
"RTN","PSGPEN",50,0)
 .S ^PS(53.4,PSGPXN,0)=DUZ_"^"_%,^PS(53.4,"B",DUZ,PSGPXN)="",^PS(53.4,"AUD",DUZ,%,PSGPXN)="" L -^PS(53.4,PSGPXN) Q
"RTN","PSGPEN",51,0)
 I $D(^PS(53.4,PSGPXN,1,PSGP,1,PSGPENO,1,FQ,0)) S $P(^(0),"^",2)=$P(^(0),"^",2)+PSGDA Q
"RTN","PSGPEN",52,0)
 ; naked reference below refers to line above
"RTN","PSGPEN",53,0)
 S ^(0)=FQ_"^"_PSGDA I $D(^PS(53.4,PSGPXN,1,PSGP,1,PSGPENO,1,0)) S $P(^(0),"^",3,4)=FQ_"^"_($P(^(0),"^",4)+1) Q
"RTN","PSGPEN",54,0)
 ; naked reference below refers to line above
"RTN","PSGPEN",55,0)
 S ^(0)="^53.401101A^"_FQ_"^1" Q:$D(^PS(53.4,PSGPXN,1,PSGP,1,PSGPENO,0))  S ^(0)=PSGPENO
"RTN","PSGPEN",56,0)
 I $D(^PS(53.4,PSGPXN,1,PSGP,1,0)) S $P(^(0),"^",3,4)=PSGPENO_"^"_($P(^(0),"^",4)+1) Q
"RTN","PSGPEN",57,0)
 ; naked reference below is from line above
"RTN","PSGPEN",58,0)
 S ^(0)="^53.4011A^"_PSGPENO_"^1" Q:$D(^PS(53.4,PSGPXN,1,PSGP,0))  S ^(0)=PSGP
"RTN","PSGPEN",59,0)
 I $D(^PS(53.4,PSGPXN,1,0)) S $P(^(0),"^",3,4)=PSGP_"^"_($P(^(0),"^",4)+1) Q
"RTN","PSGPEN",60,0)
 ; naked reference below is from line above
"RTN","PSGPEN",61,0)
 S ^(0)="^53.401PA^"_PSGP_"^1" Q
"RTN","PSGPEN",62,0)
 ;
"RTN","PSGPEN",63,0)
DH ;
"RTN","PSGPEN",64,0)
 W !!?2,"Enter a number from 0 to 9999, 0 decimal digits."
"RTN","PSGPEN",65,0)
 W !!?2,"Enter the number DOSES needed for this order until the next cart exchange.",!,"This will be the number of times the order will be administered to the patient",!,"from the start of the order until the next cart exchange."
"RTN","PSGPEN",66,0)
 W !!?2,"PLEASE NOTE that this is DOSES, and NOT UNITS.  The doses entered will be",!,"converted to units for each dispense drug of this order, as each dispense drug",!,"may have a different units per dose." Q
"RTN","PSGPEN",67,0)
 ;
"RTN","PSGPEN",68,0)
PSGPENWS ;
"RTN","PSGPEN",69,0)
 W !,"This dispense drug is a WARD STOCK item."
"RTN","PSGPEN",70,0)
 W !,"Would you like to:",!?3,"1 - Enter 0 (no) doses needed for this dispense drug.",!?3,"2 - Enter ",PSGDA," doses needed for this dispense drug.",!?3,"3 - Enter another amount as the doses needed for this dispense drug."
"RTN","PSGPEN",71,0)
 K DIR S DIR(0)="SA^1:0 (no) doses;2:"_PSGDA_" doses;3:another amount",DIR("A")="Select ACTION: ",DIR("?")="^D WH^PSGPEN" W ! D ^DIR I Y=1!'Y S PSGDA=0 Q
"RTN","PSGPEN",72,0)
 Q:Y=2  K DIR S DIR(0)="NA^0:9999:0",DIR("A")="Pre-Exchange DOSES for this dispense drug: ",DIR("?")="^D WDH^PSGPEN" W ! D ^DIR S PSGDA=+Y Q
"RTN","PSGPEN",73,0)
 ;
"RTN","PSGPEN",74,0)
WH ;
"RTN","PSGPEN",75,0)
 S Q="This dispense drug ("_DRG_") is a ward stock item.  Select:"
"RTN","PSGPEN",76,0)
 W !! F Q1=1:1:$L(Q," ") S Q2=$P(Q," ",Q1) W:$X+$L(Q2)>78 ! W Q2," "
"RTN","PSGPEN",77,0)
 W !?3,"1 to enter 0 (no) pre-exchange doses for this dispense drug.",!?3,"2 to enter ",PSGDA," doses for this dispense drug.",!?3,"3 to enter another amount for this dispense drug." Q
"RTN","PSGPEN",78,0)
 ;
"RTN","PSGPEN",79,0)
WDH ;
"RTN","PSGPEN",80,0)
 W !!?2,"Enter a number from 0 to 9999, 0 decimal digits.  If you enter an '^' to exit",!,"NO pre-exchange doses will be entered for this dispense drug." Q
"RTN","PSIVORFB")
0^3^B86884261^B84688439
"RTN","PSIVORFB",1,0)
PSIVORFB ;BIR/MLM - FILE/RETRIEVE ORDERS IN ^PS(55 ;25 Sep 98 / 2:24 PM
"RTN","PSIVORFB",2,0)
 ;;5.0;INPATIENT MEDICATIONS;**3,18,28,68,58,85,110,111,120,134,213,161,181,273,267,285,257,299,323**;16 DEC 97;Build 10
"RTN","PSIVORFB",3,0)
 ;
"RTN","PSIVORFB",4,0)
 ; Reference to ^PS(50.7 is supported by DBIA #2180.
"RTN","PSIVORFB",5,0)
 ; Reference to ^PS(51.2 is supported by DBIA #2178.
"RTN","PSIVORFB",6,0)
 ; Reference to ^PS(52.6 is supported by DBIA #1231.
"RTN","PSIVORFB",7,0)
 ; Reference to ^PS(52.7 is supported by DBIA #2173.
"RTN","PSIVORFB",8,0)
 ; Reference to ^PS(55 is supported by DBIA #2191.
"RTN","PSIVORFB",9,0)
 ; Reference to ^PS(51.1 is supported by DBIA #2177.
"RTN","PSIVORFB",10,0)
 ; Reference to ^PSUHL is supported by DBIA #4803.
"RTN","PSIVORFB",11,0)
 ; 
"RTN","PSIVORFB",12,0)
NEW55 ; Get new order number in 55.
"RTN","PSIVORFB",13,0)
 N DA,DD,DO,DIC,DLAYGO,X,Y,PSIVLIM,MINS,PSJDSTP1,PSJDSTP2,A,PSJCLIN,PSJDNM,PSJPROV,PSJWARD,PSJPAO,PSJALRT
"RTN","PSIVORFB",14,0)
 I ($G(PSIVAC)="PN"),$G(PSJSYSP) D KILL^PSJBCMA5(+$G(PSJSYSP))
"RTN","PSIVORFB",15,0)
 I $D(^PS(55,+DFN)),'$D(^PS(55,+DFN,0)) D ENSET0^PSGNE3(+DFN)
"RTN","PSIVORFB",16,0)
 ;*273 - Set PSIVSITE if not set.
"RTN","PSIVORFB",17,0)
 I $G(PSJORD)["V"!($G(PSJORD)["P"),$G(P(2))]"" D
"RTN","PSIVORFB",18,0)
 . I '$G(PSIVSITE) S PSIVSN=$P(P("IVRM"),"^") D ENCHK^PSIVSET
"RTN","PSIVORFB",19,0)
 . D LIMSTOP(.PSJDSTP1,.PSJDSTP2)
"RTN","PSIVORFB",20,0)
 I ($G(PSJORD)["P"!($G(PSJORD)["V"))&$G(PSIVLIM) I $$CMPLIM(PSJORD,PSJDSTP1,PSJDSTP2) D
"RTN","PSIVORFB",21,0)
 . D
"RTN","PSIVORFB",22,0)
 .. S PSJPROV=DUZ I PSJORD["P" S PSJPROV=$P($G(^PS(53.1,+PSJORD,0)),"^",2)
"RTN","PSIVORFB",23,0)
 .. I PSJORD["V" S PSJPROV=$P($G(^PS(55,DFN,"IV",+PSJORD,0)),"^",6)
"RTN","PSIVORFB",24,0)
 .. D NOW^%DTC S XQA(PSJPROV)="",XQAID="PSJ,"_DFN_";"_PSJPROV_";"_%,XQADATA=""
"RTN","PSIVORFB",25,0)
 .. D
"RTN","PSIVORFB",26,0)
 ... I PSJORD["P" S A=$G(^PS(53.1,+PSJORD,"DSS"))
"RTN","PSIVORFB",27,0)
 ... I PSJORD["V" S A=$G(^PS(55,PSGP,"IV",+PSJORD,"DSS"))
"RTN","PSIVORFB",28,0)
 ... S PSJCLIN=$P(A,"^") I PSJCLIN]"" S PSJCLIN=$P(^SC(PSJCLIN,0),"^")
"RTN","PSIVORFB",29,0)
 .. S A=$G(^DPT(DFN,0)),PSJWARD=$G(^(.1))
"RTN","PSIVORFB",30,0)
 .. S XQAMSG=$P(A,"^")_" ("_$E($P(A,"^"))_$E($P(A,"^",9),6,9)_"): ["_$S(PSJWARD]"":$E(PSJWARD,1,10),$G(PSJCLIN)]"":$E(PSJCLIN,1,10),1:"UNKNOWN")_"] "
"RTN","PSIVORFB",31,0)
 .. S A=$O(DRG("AD",0)) I A]"" S A=DRG("AD",A)
"RTN","PSIVORFB",32,0)
 .. I A="" S A=$O(DRG("SOL",0)) I A]"" S A=DRG("SOL",A)
"RTN","PSIVORFB",33,0)
 .. S PSJDNM=$P(^PS(50.7,+$P(A,"^",6),0),"^")
"RTN","PSIVORFB",34,0)
 .. S XQAMSG=XQAMSG_PSJDNM_" your DURATION not used for stop date/time"
"RTN","PSIVORFB",35,0)
 .. D SETUP^XQALERT
"RTN","PSIVORFB",36,0)
 .. S PSJALRT=$$FMTDUR^PSJLIVMD($S(PSJORD["P":$P($G(^PS(53.1,+PSJORD,2.5)),"^",4),PSJORD["IV":$P($G(^PS(55,DFN,"IV",+PSJORD,2.5)),"^",4),1:"UNK"))
"RTN","PSIVORFB",37,0)
 S DIC="^PS(55,",DIC(0)="LN",DLAYGO=55,(DINUM,X)=+DFN D ^DIC Q:Y<0
"RTN","PSIVORFB",38,0)
LOCK0 F  L +^PS(55,DFN,"IV",0):$S($G(DILOCKTM)>0:DILOCKTM,1:3) I  Q
"RTN","PSIVORFB",39,0)
 S ND=$S($D(^PS(55,DFN,"IV",0)):^(0),1:"^55.01") F DA=$P(ND,"^",3)+1:1 W "." I '$D(^PS(55,DFN,"IV",DA)) S $P(ND,"^",3)=DA,$P(ND,"^",4)=$P(ND,"^",4)+1,^PS(55,DFN,"IV",0)=ND Q
"RTN","PSIVORFB",40,0)
 L +^PS(55,DFN,"IV",+DA):$S($G(DILOCKTM)>0:DILOCKTM,1:3) E  G LOCK0
"RTN","PSIVORFB",41,0)
 S ^PS(55,DFN,"IV",+DA,0)=+DA,^PS(55,DFN,"IV","B",+DA,+DA)=""
"RTN","PSIVORFB",42,0)
 L -^PS(55,DFN,"IV",0) S ON55=+DA_"V"
"RTN","PSIVORFB",43,0)
 I $G(PSJALRT)]"" S PSIVAL="IV LIMIT OVERRIDDEN ("_$G(PSJALRT)_"): ALERT SENT",PSIVALT="",PSIVREA="E" D
"RTN","PSIVORFB",44,0)
 .D LOG^PSIVORAL S P("LIMIT")="",P("OVRIDE")=1 K IVLIM,IVLIMIT
"RTN","PSIVORFB",45,0)
 .S $P(^PS(55,DFN,"IV",+ON55,2.5),"^",4)="" S:$G(PSJORD)["P" $P(^PS(53.1,+PSJORD,2.5),"^",4)=""
"RTN","PSIVORFB",46,0)
 .K PSIVAL,PSIVREA,PSIVALT
"RTN","PSIVORFB",47,0)
 I $G(PSIVCOPY)=1,$G(OLDON) I (OLDON["V")&(OLDON'=(+DA_"V")) D GETOPI^PSJBCMA5(DFN,OLDON)
"RTN","PSIVORFB",48,0)
 I $P($G(^PS(53.45,+$G(DUZ),6,0)),"^",3) D
"RTN","PSIVORFB",49,0)
 .N PSJTROPI,PSJNVO S PSJNVO=$G(P("NEWON")) I (PSJNVO["P") D FILEOPI^PSJBCMA5(DFN,PSJNVO) S PSJTROPI=$$GETOPI^PSJBCMA5(DFN,PSJNVO) Q
"RTN","PSIVORFB",50,0)
 .I ($G(P("PON"))["P"),($G(ON55)["V") S PSJNVO=P("PON") D FILEOPI^PSJBCMA5(DFN,PSJNVO) S PSJTROPI=$$GETOPI^PSJBCMA5(DFN,PSJNVO) Q
"RTN","PSIVORFB",51,0)
 .D FILEOPI^PSJBCMA5(DFN,ON55) S PSJTROPI=$$GETOPI^PSJBCMA5(DFN,ON55)
"RTN","PSIVORFB",52,0)
 Q
"RTN","PSIVORFB",53,0)
SET55 ; Move data from local variables to 55.
"RTN","PSIVORFB",54,0)
 I '$D(ON55) W !,"*** Can't create this order at this time ***" Q
"RTN","PSIVORFB",55,0)
 N DA,DIK,ND,PSIVACT,PSIVDUR,PSJTROPI,PSJTROPL
"RTN","PSIVORFB",56,0)
 I P(9)["PRN" S $P(ZZND,"^",3)="",PSGS0XT="",P(15)=""  ;*323 - If the schedule is changed to PRN, make sure the frequency of the original schedule is removed.
"RTN","PSIVORFB",57,0)
 I (($P($G(ZZND),"^",3))=""&($G(PSGS0XT)="")) S P(15)="" ;*285 - Prevent frequency hangover when changing from non-null to null
"RTN","PSIVORFB",58,0)
 S:'$D(P(21)) (P(21),P("21FLG"))="" S ND(0)=+ON55,P(22)=$S(VAIN(4):+VAIN(4),1:.5) F X=2:1:23 I $D(P(X)) S $P(ND(0),U,X)=P(X)
"RTN","PSIVORFB",59,0)
 S ND(.3)=$G(P("INS")),ND(2.5)="" N X S X=$S($G(PSGORD):PSGORD,1:$G(ON)) I X D
"RTN","PSIVORFB",60,0)
 .N PKG S PKG=$E(X,$L(X)) S PKG=$S(PKG="V":"""IV""",PKG="U":5,PKG="P":"P",1:"") Q:PKG=""
"RTN","PSIVORFB",61,0)
 .S PSIVDUR=$$GETDUR^PSJLIVMD(DFN,+X,$E(X,$L(X)),1) Q:PSIVDUR=""
"RTN","PSIVORFB",62,0)
 .I $G(IVLIMIT) S ND(2.5)="^^^"_PSIVDUR K IVLIMIT Q
"RTN","PSIVORFB",63,0)
 S $P(ND(0),U,17)="A",ND(1)=P("REM"),ND(3)=P("OPI"),ND(.2)=$P($G(P("PD")),U)_U_$G(P("DO"))_U_+P("MR")_U_$G(P("PRY"))_U_$G(P("NAT"))_U_U_U_$G(P("PRNTON"))
"RTN","PSIVORFB",64,0)
 F X=0,1,2.5,3,.2,.3 S ^PS(55,DFN,"IV",+ON55,X)=ND(X)
"RTN","PSIVORFB",65,0)
 ; PSJ*5*213 - if Piggyback, intermittent syringe, or
"RTN","PSIVORFB",66,0)
 ; intermittent chemotherapy, and frequency is null, attempt to
"RTN","PSIVORFB",67,0)
 ; set frequency again based on P(15),PSGS0XT, and piece 3 of ZZND if they exist.
"RTN","PSIVORFB",68,0)
 ; If this still is null, attempt to re-set based upon the schedule name.
"RTN","PSIVORFB",69,0)
 I $G(P("IVCAT"))="I"!($P($G(ND(0)),U,4)?1(1"P",1"S",1"C"))&($P($G(ND(0)),U,15)="") D
"RTN","PSIVORFB",70,0)
 . I $P($G(ND(0)),U,4)="S",$P($G(ND(0)),U,5)'=1 Q  ;Not intermittent syringe
"RTN","PSIVORFB",71,0)
 . I $P($G(ND(0)),U,4)="C",$P($G(ND(0)),U,23)?1(1"A",1"H") Q  ;Not chemo piggyback or syringe
"RTN","PSIVORFB",72,0)
 . I $P($G(ND(0)),U,4)="C",$P($G(ND(0)),U,23)="S",$P($G(ND(0)),U,5)'=1 Q  ;Not intermitent chemo syringe
"RTN","PSIVORFB",73,0)
 . S $P(^PS(55,DFN,"IV",+ON55,0),U,15)=$S($G(P(15))'="":P(15),$G(PSGS0XT)'="":PSGS0XT,$P($G(ZZND),"^",3)'="":$P(ZZND,"^",3),1:$$GETFRQ($P($G(ND(0)),U,9))) K PSJFRQ,PSJSKED
"RTN","PSIVORFB",74,0)
 S $P(^PS(55,DFN,"IV",+ON55,2),U,1,4)=P("LOG")_U_+P("IVRM")_U_U_P("SYRS"),$P(^(2),U,8,10)=P("RES")_U_$G(P("FRES"))_U_$S($G(VAIN(4)):+VAIN(4),1:"")
"RTN","PSIVORFB",75,0)
 S X=^PS(55,DFN,0) I $P(X,"^",7)="" S $P(X,"^",7)=$P($P(P("LOG"),"^"),"."),$P(X,"^",8)="A",^(0)=X D LOGDFN^PSUHL(DFN)
"RTN","PSIVORFB",76,0)
 S $P(^PS(55,DFN,"IV",+ON55,2),U,11)=+P("CLRK")
"RTN","PSIVORFB",77,0)
 S:+$G(P("CLIN")) $P(^PS(55,DFN,"IV",+ON55,"DSS"),"^")=P("CLIN")
"RTN","PSIVORFB",78,0)
 S:+$G(P("APPT")) $P(^PS(55,DFN,"IV",+ON55,"DSS"),"^",2)=P("APPT")
"RTN","PSIVORFB",79,0)
 S:+$G(P("NINIT")) ^PS(55,DFN,"IV",+ON55,4)=P("NINIT")_U_P("NINITDT")
"RTN","PSIVORFB",80,0)
 I '$D(^PS(53.45,PSJSYSP,6)),($G(P("NEWON"))["P") S PSJTROPI=P("NEWON") S PSJTROPL=$$GETOPI^PSJBCMA5(DFN,PSJTROPI)
"RTN","PSIVORFB",81,0)
 I $G(^PS(53.45,PSJSYSP,6))!$P($G(^PS(53.45,PSJSYSP,6,0)),"^",3) D
"RTN","PSIVORFB",82,0)
 . I $G(PSJCOM),$G(PSJCOMSI),$G(PSJORD)["V" M ^TMP("PSJOPI",$J,6)=^PS(53.45,PSJSYSP,6)
"RTN","PSIVORFB",83,0)
 . D FILEOPI^PSJBCMA5(DFN,ON55) K ^TMP("PSJOPI",$J,6)
"RTN","PSIVORFB",84,0)
 I '$G(PSIVCHG)!($G(PSJREN)&($G(PSIVCHG)=2)) I $G(P("PON")),P("PON")'=ON55 D
"RTN","PSIVORFB",85,0)
 . N X S X=$S(P("PON")["P":"^PS(53.1,+P(""PON""),12,0)",P("PON")["V"&$G(PSJREN):"^PS(55,DFN,""IV"",+P(""PON""),5,0)",1:"") Q:X=""
"RTN","PSIVORFB",86,0)
 . I $O(@X) S %X=X,%Y="^PS(55,"_DFN_",""IV"","_+ON55_",5," D %XY^%RCR
"RTN","PSIVORFB",87,0)
 F DRGT="AD","SOL" D PUTD55
"RTN","PSIVORFB",88,0)
 K DA,DIK S DA(1)=DFN,DA=+ON55,DIK="^PS(55,"_DA(1)_",""IV"",",PSIVACT=1 D IX^DIK
"RTN","PSIVORFB",89,0)
 I $G(PSJCOM),$G(PSJCOMSI),$G(PSJORD)["V" K PSJCOMSI N PSJCHILD,PSJOEORD S PSJOEORD=0 F  S PSJOEORD=$O(^PS(55,"ACX",PSJCOM,PSJOEORD)) Q:'PSJOEORD  D
"RTN","PSIVORFB",90,0)
 . N PSJCHILD S PSJCHILD=0 F  S PSJCHILD=$O(^PS(55,"ACX",PSJCOM,PSJOEORD,PSJCHILD)) Q:'PSJCHILD  S PSJCHILD(+PSJCHILD)=PSJCOM
"RTN","PSIVORFB",91,0)
 . S PSJCHILD=0 F  S PSJCHILD=$O(PSJCHILD(PSJCHILD)) Q:'PSJCHILD  D
"RTN","PSIVORFB",92,0)
 .. Q:PSJCHILD=PSJORD  K DR,DA,DIE,ORD S DR="31////"_$P($G(P("OPI")),"^",1,2),DA(1)=DFN
"RTN","PSIVORFB",93,0)
 .. N ON,ON55 S (ON,ON55)=+PSJCHILD_"V" S:+$G(PSJPINIT)'>0 PSJPINIT=DUZ S PSIVALT=1,PSIVAL="COMPLEX ORDER" D ENTACT^PSIVAL D
"RTN","PSIVORFB",94,0)
 ... I $P($G(^PS(55,DFN,"IV",+ON55,3)),"^")'=$P(P("OPI"),"^") S P("FC")="OTHER PRINT INFO^"_$P($G(^(3)),"^")_U_$P(P("OPI"),"^") D GTFC^PSIVORAL
"RTN","PSIVORFB",95,0)
 ... I $D(^PS(55,DFN,"IV",+ON55,0)) S ^PS(55,DFN,"IV",+ON55,3)=P("OPI") D EN1^PSJHL2(DFN,"XX",ON55)
"RTN","PSIVORFB",96,0)
 ... M ^PS(55,DFN,"IV",+ON55,10)=^TMP("PSJOPI",$J,6)
"RTN","PSIVORFB",97,0)
 K ^TMP("PSJOPI",$J)
"RTN","PSIVORFB",98,0)
 Q
"RTN","PSIVORFB",99,0)
 ;
"RTN","PSIVORFB",100,0)
PUTD55 ; Move drug data from local array into 55
"RTN","PSIVORFB",101,0)
 K ^PS(55,DFN,"IV",+ON55,DRGT) S ^PS(55,DFN,"IV",+ON55,DRGT,0)=$S(DRGT="AD":"^55.02PA",1:"^55.11IPA")
"RTN","PSIVORFB",102,0)
 F X=0:0 S X=$O(DRG(DRGT,X)) Q:'X  D
"RTN","PSIVORFB",103,0)
 .S Y=^PS(55,DFN,"IV",+ON55,DRGT,0),$P(Y,U,3)=$P(Y,U,3)+1,DRG=$P(Y,U,3),$P(Y,U,4)=$P(Y,U,4)+1
"RTN","PSIVORFB",104,0)
 .S ^PS(55,DFN,"IV",+ON55,DRGT,0)=Y,Y=$P(DRG(DRGT,X),U)_U_$P(DRG(DRGT,X),U,3) S:DRGT="AD" $P(Y,U,3)=$P(DRG(DRGT,X),U,4) S ^PS(55,DFN,"IV",+ON55,DRGT,+DRG,0)=Y
"RTN","PSIVORFB",105,0)
 Q
"RTN","PSIVORFB",106,0)
GT55 ; Retrieve data from 55 into local array
"RTN","PSIVORFB",107,0)
 K DRG,DRGN,P S:'$D(ON55) ON55=ON S P("REN")="",Y=$G(^PS(55,DFN,"IV",+ON55,0)) F X=1:1:25 S P(X)=$P(Y,U,X)
"RTN","PSIVORFB",108,0)
 S P("21FLG")=P(21)
"RTN","PSIVORFB",109,0)
 S P("PON")=ON55,PSJORIFN=P(21),P(6)=P(6)_U_$P($G(^VA(200,+P(6),0)),U),(DRG,DRGN)="",P("REM")=$G(^PS(55,DFN,"IV",+ON55,1))
"RTN","PSIVORFB",110,0)
 S Y=$G(^PS(55,DFN,"IV",+ON55,2)),P("LOG")=$P(Y,U),P("IVRM")=$P(Y,U,2)_U_$P($G(^PS(59.5,+$P(Y,U,2),0)),U)
"RTN","PSIVORFB",111,0)
 S P("CLRK")=$P(Y,U,11)_U_$P($G(^VA(200,+$P(Y,U,11),0)),U),P("RES")=$P(Y,U,8),P("FRES")=$P(Y,U,9),P("SYRS")=$P(Y,U,4),P("OPI")=$G(^PS(55,DFN,"IV",+ON55,3))
"RTN","PSIVORFB",112,0)
 S P("INS")=$G(^PS(55,DFN,"IV",+ON55,.3))
"RTN","PSIVORFB",113,0)
 S P("CLIN")=$P($G(^PS(55,DFN,"IV",+ON55,"DSS")),"^"),P("APPT")=$P($G(^PS(55,DFN,"IV",+ON55,"DSS")),"^",2)
"RTN","PSIVORFB",114,0)
 S P("DTYP")=$S(P(4)="":0,P(4)="P"!(P(23)="P")!(P(5)):1,P(4)="H":2,1:3)
"RTN","PSIVORFB",115,0)
 D:'$D(PSJLABEL) GTPC(ON55) S ND=$G(^PS(55,DFN,"IV",+ON55,.2)),P("PD")=$S($P(ND,U):$P(ND,U)_U_$$OIDF^PSJLMUT1(+ND)_U_$P($G(^PS(50.7,+ND,0)),U),1:""),P("DO")=$P(ND,U,2),P("PRY")=$P(ND,U,4),P("NAT")=$P(ND,U,5),(PSJCOM,P("PRNTON"))=$P(ND,U,8)
"RTN","PSIVORFB",116,0)
 I P("PRY")="D",'+P("IVRM") S P("IVRM")=+$G(PSIVSN)_U_$P($G(^PS(59.5,+$G(PSIVSN),0)),U)
"RTN","PSIVORFB",117,0)
 S P("MR")=$P(ND,U,3),ND=$G(^PS(51.2,+P("MR"),0)),P("MR")=P("MR")_U_$S($P(ND,U,3)]"":$P(ND,U,3),1:$P(ND,U)) D GTCUM
"RTN","PSIVORFB",118,0)
 D GTDRG,GTOT^PSIVUTL(P(4))
"RTN","PSIVORFB",119,0)
 N ND2P5 S ND2P5=$G(^PS(55,DFN,"IV",+ON55,2.5)) D
"RTN","PSIVORFB",120,0)
 .S P("DUR")=$P(ND2P5,"^",2)
"RTN","PSIVORFB",121,0)
 .S P("LIMIT")=$P(ND2P5,"^",4)
"RTN","PSIVORFB",122,0)
 .S P("IVCAT")=$P(ND2P5,"^",5)
"RTN","PSIVORFB",123,0)
K ; Kill and exit.
"RTN","PSIVORFB",124,0)
 K FIL,ND
"RTN","PSIVORFB",125,0)
 Q
"RTN","PSIVORFB",126,0)
GTDRG ; Get drug info and place in DRG(.
"RTN","PSIVORFB",127,0)
 F DRGT="AD","SOL" S FIL=$S(DRGT="AD":52.6,1:52.7) F Y=0:0 S Y=$O(^PS(55,DFN,"IV",+ON55,DRGT,Y)) Q:'Y  D
"RTN","PSIVORFB",128,0)
 .; naked ref below refers to line above
"RTN","PSIVORFB",129,0)
 .S DRG=$G(^(Y,0)),ND=$G(^PS(FIL,+DRG,0)),(DRGI,DRG(DRGT,0))=$G(DRG(DRGT,0))+1
"RTN","PSIVORFB",130,0)
 .S DRG(DRGT,+DRGI)=+DRG_U_$P(ND,U)_U_$P(DRG,U,2)_U_$P(DRG,U,3)_U_$P(ND,U,13)_U_$P(ND,U,11)
"RTN","PSIVORFB",131,0)
 Q
"RTN","PSIVORFB",132,0)
 ;
"RTN","PSIVORFB",133,0)
GTCUM ; Retrieve dispensing info.
"RTN","PSIVORFB",134,0)
 S ND=$G(^PS(55,DFN,"IV",+ON55,9)),P("LF")=$P(ND,U),P("LFA")=$P(ND,U,2),P("CUM")=$P(ND,U,3)
"RTN","PSIVORFB",135,0)
 Q
"RTN","PSIVORFB",136,0)
 ;
"RTN","PSIVORFB",137,0)
GTPC(ON) ; Retrieve Provider Comments and create "scratch" fields to edit
"RTN","PSIVORFB",138,0)
 Q
"RTN","PSIVORFB",139,0)
 ;
"RTN","PSIVORFB",140,0)
SETNEW ; Create new order and set
"RTN","PSIVORFB",141,0)
 D NEW55,SET55
"RTN","PSIVORFB",142,0)
 Q
"RTN","PSIVORFB",143,0)
 ;
"RTN","PSIVORFB",144,0)
CMPLIM(PSJORD,PSJDSTP1,PSJDSTP2) ; Compare stop date of order against IV Limit
"RTN","PSIVORFB",145,0)
 I $P($G(^PS(53.1,+PSJORD,0)),"^",25)]"" D CHKD Q:PSJPAO 0
"RTN","PSIVORFB",146,0)
 I $G(PSJDSTP1),$E(+PSJDSTP1,1,11)'=$E(+P(3),1,11),+PSJDSTP2'=+P(3) Q 1
"RTN","PSIVORFB",147,0)
 Q 0
"RTN","PSIVORFB",148,0)
 ;
"RTN","PSIVORFB",149,0)
LIMSTOP(PSJDSTP1,PSJDSTP2) ; Calculate default stop date using IV Limit
"RTN","PSIVORFB",150,0)
 ;      Output: PSJDSTP1 - Default stop using duration only
"RTN","PSIVORFB",151,0)
 ;              PSJDSTP2 - Default stop using duration and IV parameters for time
"RTN","PSIVORFB",152,0)
 S PSIVLIM=$$GETLIM^PSIVCAL(DFN,PSJORD)
"RTN","PSIVORFB",153,0)
 I 'PSIVLIM,PSIVLIM]"" S PSIVLIM=$$GETMIN^PSIVCAL(PSIVLIM,DFN,PSJORD)
"RTN","PSIVORFB",154,0)
 I PSIVLIM]"" D
"RTN","PSIVORFB",155,0)
 . S MINS=$$GETMIN^PSIVCAL(PSIVLIM,DFN,PSJORD),PSJDSTP1=$$FMADD^XLFDT(P(2),,,MINS)
"RTN","PSIVORFB",156,0)
 . S X=$P(PSJDSTP1,"."),PSJDSTP2=X_$S($P($G(PSIVSITE),"^",14)="":.2359,1:"."_$P(PSIVSITE,"^",14))
"RTN","PSIVORFB",157,0)
 Q
"RTN","PSIVORFB",158,0)
 ;
"RTN","PSIVORFB",159,0)
GETFRQ(PSJSKED) ;Get frequency using name of schedule
"RTN","PSIVORFB",160,0)
 I PSJSKED="" K PSJSKED Q ""
"RTN","PSIVORFB",161,0)
 S (PSJCNTX,PSJFRQ)=""
"RTN","PSIVORFB",162,0)
 I $D(^PS(51.1,"APPSJ",PSJSKED)) F  S PSJCNTX=$O(^PS(51.1,"APPSJ",PSJSKED,PSJCNTX)) Q:PSJCNTX=""  D  Q:$G(PSJFRQ)'=""
"RTN","PSIVORFB",163,0)
 . I $P($G(^PS(51.1,PSJCNTX,0)),U,3)'="" S PSJFRQ=$P(^PS(51.1,PSJCNTX,0),U,3)
"RTN","PSIVORFB",164,0)
 K PSJCNTX
"RTN","PSIVORFB",165,0)
 Q PSJFRQ
"RTN","PSIVORFB",166,0)
 ;
"RTN","PSIVORFB",167,0)
CHKD ;Check for a previous active order and compare the duration
"RTN","PSIVORFB",168,0)
 N PSJPO,A,PSJDUR
"RTN","PSIVORFB",169,0)
 S PSJDUR=$$GETLIM^PSIVCAL(DFN,PSJORD)
"RTN","PSIVORFB",170,0)
 S PSJPAO=0,PSJPO=PSJORD
"RTN","PSIVORFB",171,0)
CHKDR S PSJPO=$P($G(^PS(53.1,+PSJPO,0)),"^",25) Q:PSJPO=""
"RTN","PSIVORFB",172,0)
 I PSJPO["P" G CHKDR
"RTN","PSIVORFB",173,0)
 I PSJPO["V" S PSIVLIM=$$GETLIM^PSIVCAL(DFN,PSJPO) I PSJDUR'=PSIVLIM S PSJPAO=1 Q
"RTN","PSIVORFB",174,0)
 G CHKDR
"RTN","PSIVORFB",175,0)
 ;
"RTN","PSIVORFB",176,0)
LOGOPI(DFN,ON55) ; Log OPI activity into activity log
"RTN","PSIVORFB",177,0)
 N PSJPICHK
"RTN","PSIVORFB",178,0)
 I ON55["V" D
"RTN","PSIVORFB",179,0)
 .I ($G(P("PON"))["V"),($G(ON55)["V"),(ON55'=P("PON")) D
"RTN","PSIVORFB",180,0)
 ..K PSJARRY1,PSJARRY2 M PSJARRY1=^PS(53.45,+$G(PSJSYSP),6),PSJARRY2=^PS(55,DFN,"IV",+P("PON"),10) S PSJPICHK='$$DIFFAR^PSJBCMA5(.PSJARRY1,.PSJARRY2)
"RTN","PSIVORFB",181,0)
 .Q:$G(PSJPICHK)
"RTN","PSIVORFB",182,0)
 .N PSIVALCK,PSIVRA,PSIVLN,PSIVLSTA S PSIVLN=$O(^PS(55,DFN,"IV",+ON55,"A",""),-1)+1
"RTN","PSIVORFB",183,0)
 .K PSJARRY1,PSJARRY2 S PSJARRY1="",PSJARRY2="" M PSJARRY1=^PS(53.45,+$G(PSJSYSP),6),PSJARRY2=^PS(55,DFN,"IV",+ON55,10) Q:'$$DIFFAR^PSJBCMA5(.PSJARRY1,.PSJARRY2)
"RTN","PSIVORFB",184,0)
 .S P("FC")="OTHER PRINT INFO^"_$P($G(^PS(55,DFN,"IV",+ON55,3)),"^")_U_$P($G(P("OPI")),"^"),PSIVALCK="OPI",PSIVREA="E" D LOG^PSIVORAL
"RTN","PSIVORFB",185,0)
 K PSJARRY1,PSJARRY2
"RTN","PSIVORFB",186,0)
 Q
"RTN","PSJ323PO")
0^^B1916591^n/a
"RTN","PSJ323PO",1,0)
PSJ323PO ;TMC - Patch 323 Post Install routine;9/9/2015
"RTN","PSJ323PO",2,0)
 ;;5.0;INPATIENT MEDICATIONS;**323**;DEC 1997;Build 10
"RTN","PSJ323PO",3,0)
 ;
"RTN","PSJ323PO",4,0)
 ;External reference ^DD(55 supported by DBIA 2191
"RTN","PSJ323PO",5,0)
 ;
"RTN","PSJ323PO",6,0)
 ;This post install routine will identify bad "AUD" cross-references and fix them where the date was stored with quotes around them.
"RTN","PSJ323PO",7,0)
 ;
"RTN","PSJ323PO",8,0)
 Q
"RTN","PSJ323PO",9,0)
START ; 
"RTN","PSJ323PO",10,0)
 N PSJCNT,PSJDFN,PSJSDT,PSJI
"RTN","PSJ323PO",11,0)
 S X1=DT,X2=+90 D C^%DTC
"RTN","PSJ323PO",12,0)
 S PSJCNT=0
"RTN","PSJ323PO",13,0)
 S ^XTMP("PSJ323PO",0)=$G(X)_"^"_DT_"^AUD CROSS REFERENCE DATE FIX^"
"RTN","PSJ323PO",14,0)
 S PSJSDT=0 F  S PSJSDT=$O(^PS(55,"AUD",PSJSDT)) Q:'PSJSDT  I $E(PSJSDT,$L(PSJSDT),$L(PSJSDT))=0  D CHKDT
"RTN","PSJ323PO",15,0)
 W !!,"***********PSJ323PO HAS FINISHED*************"
"RTN","PSJ323PO",16,0)
 Q
"RTN","PSJ323PO",17,0)
CHKDT ;
"RTN","PSJ323PO",18,0)
 S PSJDFN=0 F  S PSJDFN=$O(^PS(55,"AUD",PSJSDT,PSJDFN)) Q:PSJDFN=""  D
"RTN","PSJ323PO",19,0)
 .S PSJI=0 F  S PSJI=$O(^PS(55,"AUD",PSJSDT,PSJDFN,PSJI)) Q:PSJI=""  D
"RTN","PSJ323PO",20,0)
 ..S PSJCNT=PSJCNT+1
"RTN","PSJ323PO",21,0)
 ..S ^XTMP("PSJ323PO",PSJCNT)="^PS(55,""AUD"","_PSJSDT_","_PSJDFN_","_PSJI_")"
"RTN","PSJ323PO",22,0)
 ..K ^PS(55,"AUD",PSJSDT,PSJDFN,PSJI)
"RTN","PSJ323PO",23,0)
 ..S ^PS(55,"AUD",+PSJSDT,PSJDFN,PSJI)=""
"RTN","PSJ323PO",24,0)
 Q
"RTN","PSJLMPRU")
0^1^B15059824^B14898207
"RTN","PSJLMPRU",1,0)
PSJLMPRU ;BIR/MLM - INPATIENT LISTMAN UD PROFILE UTILITIES ;27 Aug 98 / 8:45 AM
"RTN","PSJLMPRU",2,0)
 ;;5.0;INPATIENT MEDICATIONS;**16,58,85,110,185,181,267,323**;16 DEC 97;Build 10
"RTN","PSJLMPRU",3,0)
 ;
"RTN","PSJLMPRU",4,0)
 ; Reference to ^PSDRUG is supported by DBIA 2192.
"RTN","PSJLMPRU",5,0)
 ; Reference to ^PS(55 is supported by DBIA 2191.
"RTN","PSJLMPRU",6,0)
 ;
"RTN","PSJLMPRU",7,0)
PUD(DFN,ON,PSJF,DN) ; Setup LM profile view for UD
"RTN","PSJLMPRU",8,0)
 N PSJFLAG,PSJV
"RTN","PSJLMPRU",9,0)
 ; Naked references on the two lines below refer to full reference ^PS(55,DFN,5,+ON in PSJF using indirection.
"RTN","PSJLMPRU",10,0)
 S ND=$G(@(PSJF_+ON_",0)")),SCH=$G(^(2)),ND4=$G(^(4)),ND6=$G(^(6)),NDP2=$G(^(.2)),PSJFLAG=$P(NDP2,U,7),X=$P(DN,U,2),DO=$S('X:"",1:$G(^(+X))) S:X=.2 DO=$P(DO,U,2)
"RTN","PSJLMPRU",11,0)
 S ND14=$G(@(PSJF_+ON_",14,0)")),RNDT="" I $P(ND14,"^",3) S ND14=$G(^($P(ND14,"^",3),0)),RNDT=$P(ND14,"^")
"RTN","PSJLMPRU",12,0)
 I ("AO"[PSJC)!(PSJC="DF") D
"RTN","PSJLMPRU",13,0)
 .S V='$P(ND4,"^",UDU),PSJL=$$SETSTR^VALM1($S(ND4="":" ",$P(ND4,"^",12):"D",$P(ND4,"^",19)&$P(ND4,"^",18):"H",$P(ND4,"^",23)&$P(ND4,"^",22):"H",$P(ND4,"^",15)&($P(ND4,"^",16)!V):"R",1:" "),PSJL,5,1)
"RTN","PSJLMPRU",14,0)
 .;S X=$S(+PSJSYSU=1&V:1,+PSJSYSU=3&V:1,1:0)
"RTN","PSJLMPRU",15,0)
 .S PSJV=$S($P(NDP2,U,4)="D":"d",1:" ")_$S(+PSJSYSU=1&V:"->",+PSJSYSU=3&V:"->",1:"   ") I PSJFLAG D CNTRL^VALM10(PSJLN,1,4,IORVON,IORVOFF,0)
"RTN","PSJLMPRU",16,0)
 .S PSJL=$$SETSTR^VALM1(PSJV,PSJL,6,3)
"RTN","PSJLMPRU",17,0)
 S RTE=$P(ND,"^",3),SM=$S('$P(ND,"^",5):0,$P(ND,"^",6):1,1:2),STAT=$S($P(ND,U,28)]"":$P(ND,U,28),$P(ND,"^",9)]"":$P(ND,"^",9),1:"NF"),PF=$E("*",$P(ND,"^",20)>0),PSGID=$P(SCH,"^",2),SD=$P(SCH,"^",4),SCH=$P(SCH,"^")
"RTN","PSJLMPRU",18,0)
 I STAT="A",$P(ND,U,27)="R" S STAT="R"
"RTN","PSJLMPRU",19,0)
 S NF="",WS=$S(PSJPWD:$$WS^PSJO(PSJPWD,PSGP,PSJF,+ON),1:0)
"RTN","PSJLMPRU",20,0)
 I $D(PSJCLIN) S WS=0
"RTN","PSJLMPRU",21,0)
 N PSJDISP F PSJDISP=0:0 S PSJDISP=$O(@(PSJF_+ON_",1,"_PSJDISP_")")) Q:'PSJDISP  D
"RTN","PSJLMPRU",22,0)
 .I $P($G(^PSDRUG(+$P($G(@(PSJF_+ON_",1,"_PSJDISP_",0)")),"^"),0)),"^",9)=1 S NF=1
"RTN","PSJLMPRU",23,0)
 NEW DRUGNAME,PSGID1,SD1,LEN,PSGID1,SD1 S LEN=$S($D(PSJEXPT):8,1:5)
"RTN","PSJLMPRU",24,0)
 F X="PSGID","SD" S @(X_1)=$S(PSJC["C":"*****",1:$E($$ENDTC^PSGMI(@X),1,LEN))
"RTN","PSJLMPRU",25,0)
 D DRGDISP^PSJLMUT1(PSGP,ON,39,54,.DRUGNAME,0)
"RTN","PSJLMPRU",26,0)
 F PSJX=0:0 S PSJX=$O(DRUGNAME(PSJX)) Q:'PSJX  D
"RTN","PSJLMPRU",27,0)
 .I PSJX=1 D
"RTN","PSJLMPRU",28,0)
 ..I PSJFLAG D CNTRL^VALM10(PSJLN,1,4,IORVON,IORVOFF,0)
"RTN","PSJLMPRU",29,0)
 ..S PSJL=$$SETSTR^VALM1($S($E(PSJS)="*":$P(PSJS,"^"),1:DRUGNAME(PSJX)),PSJL,9,39)
"RTN","PSJLMPRU",30,0)
 ..S PSJL=$$SETSTR^VALM1($S(PSJC["C":"?",PSJSCHT'="z":PSJSCHT,1:"?"),PSJL,50,3)
"RTN","PSJLMPRU",31,0)
 ..S PSJL=PSJL_PSGID1_"  "_SD1_" "_$E(STAT,1,2)_$S($L(STAT)=1:"     ",1:"    ")_$S($G(RNDT):$E($$ENDTC^PSGMI(RNDT),1,LEN),1:"")
"RTN","PSJLMPRU",32,0)
 ..I NF!WS!SM!PF S PSJL=$$SETSTR^VALM1($S(NF:"NF ",WS:"WS ",SM:$E("HSM",SM,3),1:""),PSJL,69,3) S:PF PSJL=$$SETSTR^VALM1("*",PSJL,79,1)
"RTN","PSJLMPRU",33,0)
 . I PSJX>1 S PSJL="",PSJL=$$SETSTR^VALM1(DRUGNAME(PSJX),PSJL,11,66)
"RTN","PSJLMPRU",34,0)
 . D SETTMP("PSJPRO",PSJL) I ($P(NDP2,U,4)="S"),STAT="P" D CNTRL^VALM10((PSJLN-1),9,9+$L(PSJL),IOINHI_IOBON,IOINORM,0)
"RTN","PSJLMPRU",35,0)
 I ND6'="" N X,PSJTXT3 S X=$$GETSIOPI^PSJBCMA5(DFN,ON) N TXTLN S TXTLN=0 F  S TXTLN=$O(^PS(53.45,DUZ,5,TXTLN)) Q:'TXTLN!$G(PSJTXT3)  D
"RTN","PSJLMPRU",36,0)
 .I ($O(^PS(53.45,DUZ,5," "),-1)>3) S PSJTXT3=1 S PSJL="Instructions too long. See Order View for full text." D PTXT(PSJL,"PSJPRO",10,66) Q
"RTN","PSJLMPRU",37,0)
 .S PSJL=^PS(53.45,DUZ,5,TXTLN,0) D PTXT(PSJL,"PSJPRO",10,66)
"RTN","PSJLMPRU",38,0)
 K ^PS(53.45,DUZ,5)
"RTN","PSJLMPRU",39,0)
 Q
"RTN","PSJLMPRU",40,0)
 ;
"RTN","PSJLMPRU",41,0)
PTXT(TXT,SUB,LM,RM) ; Display Instructions/dosage ordered.
"RTN","PSJLMPRU",42,0)
 ;* Input:       TXT = Text to display.
"RTN","PSJLMPRU",43,0)
 ;                       SUB = First subscript for ^TMP node, ** MUST be PSJ namespace **
"RTN","PSJLMPRU",44,0)
 ;                       LM  = Begin display of text after LM spaces.
"RTN","PSJLMPRU",45,0)
 ;                       RM  = Length of display text.
"RTN","PSJLMPRU",46,0)
 ;                       
"RTN","PSJLMPRU",47,0)
 ;BHW;PSJ*5*185;Extra spaces causes display to "skip" part of the field. 
"RTN","PSJLMPRU",48,0)
 ;S PSJL="",$P(PSJL," ",LM)="" F X=1:1 S WRD=$P(TXT," ",X) Q:WRD=""  D
"RTN","PSJLMPRU",49,0)
 S PSJL="",$P(PSJL," ",LM)=""
"RTN","PSJLMPRU",50,0)
 F X=1:1:$L(TXT," ") S WRD=$P(TXT," ",X) D
"RTN","PSJLMPRU",51,0)
 .;BHW;PSJ*5*185;check if end of string or just extra space
"RTN","PSJLMPRU",52,0)
 .I WRD="" S PSJL=PSJL_" " Q 
"RTN","PSJLMPRU",53,0)
 .I $L(PSJL_" "_WRD)'<RM D SETTMP(SUB,PSJL) S PSJL="",$P(PSJL," ",10)=""
"RTN","PSJLMPRU",54,0)
 .I $L(PSJL_" "_WRD)'<RM S PSJL=PSJL_" "_$E(WRD,1,(RM-10)) D SETTMP(SUB,PSJL) S PSJL="",$P(PSJL," ",10)="",WRD=$E(WRD,(RM-9),$L(WRD))
"RTN","PSJLMPRU",55,0)
 .S PSJL=PSJL_" "_WRD
"RTN","PSJLMPRU",56,0)
 D SETTMP(SUB,PSJL)
"RTN","PSJLMPRU",57,0)
 Q
"RTN","PSJLMPRU",58,0)
SETTMP(SUB,PSJL) ;
"RTN","PSJLMPRU",59,0)
 S ^TMP(SUB,$J,PSJLN,0)=PSJL,PSJLN=PSJLN+1
"RTN","PSJLMPRU",60,0)
 Q
"UP",55,55.06,-1)
55^5
"UP",55,55.06,0)
55.06
"VER")
8.0^22.0
"^DD",55,55.06,34,0)
STOP DATE/TIME^RDX^^2;4^X:X=+X&X&$D(^PS(55,DA(1),5,DA,2)) "S PSGDL=X D EN2^PSSDDUT3" S %DT="ERTX" D ^%DT S X=+Y K:Y'>0 X
"^DD",55,55.06,34,1,0)
^.1
"^DD",55,55.06,34,1,1,0)
55.06^ASD^MUMPS
"^DD",55,55.06,34,1,1,1)
S ^PS(55,DA(1),5,"AUS",+X,DA)="" I $P($G(^PS(55,DA(1),5,DA,0)),"^",7)]"" S ^PS(55,DA(1),5,"AU",$P(^(0),"^",7),+X,DA)=""
"^DD",55,55.06,34,1,1,2)
K ^PS(55,DA(1),5,"AUS",+X,DA) I $P($G(^PS(55,DA(1),5,DA,0)),"^",7)]"" K ^PS(55,DA(1),5,"AU",$P(^(0),"^",7),+X,DA)
"^DD",55,55.06,34,1,1,3)
NEEDED BY UNIT DOSE
"^DD",55,55.06,34,1,1,"%D",0)
^^5^5^2920729^^^
"^DD",55,55.06,34,1,1,"%D",1,0)
Used by Unit Dose to gather orders.  X-refs are in the form of:
"^DD",55,55.06,34,1,1,"%D",2,0)
^PS(55,DA(1),"AU",status,stop date/time,DA)
"^DD",55,55.06,34,1,1,"%D",3,0)
^PS(55,DA(1),"AUS",stop date/time,DA)
"^DD",55,55.06,34,1,1,"%D",4,0)
 
"^DD",55,55.06,34,1,1,"%D",5,0)
These are used primarily by the profiles.
"^DD",55,55.06,34,1,1,"DT")
2920729
"^DD",55,55.06,34,1,2,0)
55.06^AL53^MUMPS
"^DD",55,55.06,34,1,2,1)
I '$D(DIU(0)) D:$D(PSGAL(53))#2 KILL^PSGAL5:PSGAL(53)=X K PSGAL
"^DD",55,55.06,34,1,2,2)
I '$D(DIU(0)),'$D(PSGPO) S PSGAL(53)=X,PSGAL("C")=6000,PSGALFF=34 D ^PSGAL5
"^DD",55,55.06,34,1,2,3)
UNIT DOSE ACTIVITY LOG
"^DD",55,55.06,34,1,2,"%D",0)
^^1^1^2920729^
"^DD",55,55.06,34,1,2,"%D",1,0)
Used by Unit Dose to log any changes made to this field.
"^DD",55,55.06,34,1,3,0)
55^AUD
"^DD",55,55.06,34,1,3,1)
S ^PS(55,"AUD",+(X),DA(1),DA)=""
"^DD",55,55.06,34,1,3,2)
K ^PS(55,"AUD",+(X),DA(1),DA)
"^DD",55,55.06,34,1,3,"%D",0)
^.101^1^1^3150728^^
"^DD",55,55.06,34,1,3,"%D",1,0)
Identifies verified Unit Dose orders by the order's stop date/time.
"^DD",55,55.06,34,1,3,"DT")
2931031
"^DD",55,55.06,34,3)
Enter the date and time that the last dose is to be given (and the order will expire).
"^DD",55,55.06,34,4)
D EN^DDIOL(" TIME IS REQUIRED.","","?0")
"^DD",55,55.06,34,5,1,0)
55.06^25^3
"^DD",55,55.06,34,20,0)
^.3LA^1^1
"^DD",55,55.06,34,20,1,0)
PSJU
"^DD",55,55.06,34,21,0)
^.001^3^3^3150728^^^^
"^DD",55,55.06,34,21,1,0)
  This is the date and time the order will automatically expire.  This
"^DD",55,55.06,34,21,2,0)
package initially calculates a default stop date, depending on the SITE
"^DD",55,55.06,34,21,3,0)
PARAMETERS.
"^DD",55,55.06,34,"DT")
3130625
"BLD",10051,6)
^278
**END**
**END**

