Released SR*3*177 SEQ #172
Extracted from mail message
**KIDS**:SR*3.0*177^

**INSTALL NAME**
SR*3.0*177
"BLD",8642,0)
SR*3.0*177^SURGERY^0^3140806^y
"BLD",8642,1,0)
^^22^22^3120202^
"BLD",8642,1,1,0)
The International Classification of Diseases, Tenth Revision (ICD-10) 
"BLD",8642,1,2,0)
Class 1 Software Remediation project replaces the 30-year-old set of 
"BLD",8642,1,3,0)
diagnosis and procedure codes (ICD-9-CM) that medical personnel use. 
"BLD",8642,1,4,0)
Dates of service, or dates of discharge for inpatients, that occur on or 
"BLD",8642,1,5,0)
after October 10, 2013 will use the ICD-10 code set. Clinical Modification
"BLD",8642,1,6,0)
(ICD-10-CM) diagnosis codes increase from about 13,000 ICD-9 codes to 
"BLD",8642,1,7,0)
more than 68,000. Procedure Coding System (ICD-10-PCS) procedure codes 
"BLD",8642,1,8,0)
increase from about 3,800 ICD-9 codes to nearly 87,000. Both systems also 
"BLD",8642,1,9,0)
expand the number of characters allotted to seven alpha-numeric 
"BLD",8642,1,10,0)
characters. This value does not include the decimal point, which follows 
"BLD",8642,1,11,0)
the third character for the ICD-10-CM code set. There is no decimal point 
"BLD",8642,1,12,0)
in the ICD-10-PCS code set. 
"BLD",8642,1,13,0)
These code sets have the potential to reveal more about quality of care, 
"BLD",8642,1,14,0)
so that data can be used in a more meaningful way to better understand 
"BLD",8642,1,15,0)
complications, better design clinically robust algorithms, and better 
"BLD",8642,1,16,0)
track the outcomes of care. ICD-10-CM also incorporates greater 
"BLD",8642,1,17,0)
specificity and clinical detail to provide information for clinical 
"BLD",8642,1,18,0)
decision making and outcomes research.
"BLD",8642,1,19,0)
 
"BLD",8642,1,20,0)
The only noticeable difference users may see will occur when a specific 
"BLD",8642,1,21,0)
ICD diagnosis code descriptor changes based on the date of operation for 
"BLD",8642,1,22,0)
the case.
"BLD",8642,4,0)
^9.64PA^130.4^4
"BLD",8642,4,130,0)
130
"BLD",8642,4,130,2,0)
^9.641^130.22^5
"BLD",8642,4,130,2,130,0)
SURGERY  (File-top level)
"BLD",8642,4,130,2,130,1,0)
^9.6411^1006^10
"BLD",8642,4,130,2,130,1,32.5,0)
PRIN PRE-OP ICD DIAGNOSIS CODE
"BLD",8642,4,130,2,130,1,66,0)
PLANNED PRIN DIAGNOSIS CODE
"BLD",8642,4,130,2,130,1,69,0)
CODING VERIFIER
"BLD",8642,4,130,2,130,1,253,0)
OTHER RESPIRATORY OCCURRENCE
"BLD",8642,4,130,2,130,1,286,0)
OTHER URINARY TRACT OCCURRENCE
"BLD",8642,4,130,2,130,1,343,0)
OTHER CNS OCCURRENCE
"BLD",8642,4,130,2,130,1,344,0)
OTHER CARDIAC OCCURRENCE
"BLD",8642,4,130,2,130,1,392,0)
OTHER OCCURRENCES (ICD)
"BLD",8642,4,130,2,130,1,489,0)
OTHER WOUND OCCURRENCE
"BLD",8642,4,130,2,130,1,1006,0)
ICD ON NURSE REPORT
"BLD",8642,4,130,2,130.13,0)
INTRAOPERATIVE OCCURRENCES  (sub-file)
"BLD",8642,4,130,2,130.13,1,0)
^9.6411^4^1
"BLD",8642,4,130,2,130.13,1,4,0)
ICD DIAGNOSIS CODE
"BLD",8642,4,130,2,130.17,0)
OTHER PREOP DIAGNOSIS  (sub-file)
"BLD",8642,4,130,2,130.17,1,0)
^9.6411^3^1
"BLD",8642,4,130,2,130.17,1,3,0)
ICD DIAGNOSIS CODE
"BLD",8642,4,130,2,130.18,0)
OTHER POSTOP DIAGS  (sub-file)
"BLD",8642,4,130,2,130.18,1,0)
^9.6411^3^1
"BLD",8642,4,130,2,130.18,1,3,0)
PLANNED ICD DIAGNOSIS CODE
"BLD",8642,4,130,2,130.22,0)
POSTOP OCCURRENCE  (sub-file)
"BLD",8642,4,130,2,130.22,1,0)
^9.6411^6^1
"BLD",8642,4,130,2,130.22,1,6,0)
ICD DIAGNOSIS CODE
"BLD",8642,4,130,222)
y^y^p^^^^n^^n
"BLD",8642,4,130,224)

"BLD",8642,4,130.4,0)
130.4
"BLD",8642,4,130.4,222)
y^y^f^^y^^y^o^n
"BLD",8642,4,133,0)
133
"BLD",8642,4,133,2,0)
^9.641^133^1
"BLD",8642,4,133,2,133,0)
SURGERY SITE PARAMETERS  (File-top level)
"BLD",8642,4,133,2,133,1,0)
^9.6411^39^1
"BLD",8642,4,133,2,133,1,39,0)
ICD ON NURSE INTRAOP
"BLD",8642,4,133,222)
y^y^p^^^^n^^n
"BLD",8642,4,133,224)

"BLD",8642,4,136,0)
136
"BLD",8642,4,136,2,0)
^9.641^136.32^4
"BLD",8642,4,136,2,136,0)
SURGERY PROCEDURE/DIAGNOSIS CODES  (File-top level)
"BLD",8642,4,136,2,136,1,0)
^9.6411^.03^1
"BLD",8642,4,136,2,136,1,.03,0)
PRIN POSTOP DIAGNOSIS CODE
"BLD",8642,4,136,2,136.02,0)
PRIN ASSOCIATED DIAGNOSES  (sub-file)
"BLD",8642,4,136,2,136.02,1,0)
^9.6411^^
"BLD",8642,4,136,2,136.04,0)
OTHER POSTOP DIAGNOSIS CODES  (sub-file)
"BLD",8642,4,136,2,136.04,1,0)
^9.6411^^
"BLD",8642,4,136,2,136.32,0)
OTHER ASSOCIATED DIAGNOSES  (sub-file)
"BLD",8642,4,136,2,136.32,1,0)
^9.6411^^
"BLD",8642,4,136,222)
y^y^p^^^^n^^n
"BLD",8642,4,136,224)

"BLD",8642,4,"APDD",130,130)

"BLD",8642,4,"APDD",130,130,32.5)

"BLD",8642,4,"APDD",130,130,66)

"BLD",8642,4,"APDD",130,130,69)

"BLD",8642,4,"APDD",130,130,253)

"BLD",8642,4,"APDD",130,130,286)

"BLD",8642,4,"APDD",130,130,343)

"BLD",8642,4,"APDD",130,130,344)

"BLD",8642,4,"APDD",130,130,392)

"BLD",8642,4,"APDD",130,130,489)

"BLD",8642,4,"APDD",130,130,1006)

"BLD",8642,4,"APDD",130,130.13)

"BLD",8642,4,"APDD",130,130.13,4)

"BLD",8642,4,"APDD",130,130.17)

"BLD",8642,4,"APDD",130,130.17,3)

"BLD",8642,4,"APDD",130,130.18)

"BLD",8642,4,"APDD",130,130.18,3)

"BLD",8642,4,"APDD",130,130.22)

"BLD",8642,4,"APDD",130,130.22,6)

"BLD",8642,4,"APDD",133,133)

"BLD",8642,4,"APDD",133,133,39)

"BLD",8642,4,"APDD",136,136)

"BLD",8642,4,"APDD",136,136,.03)

"BLD",8642,4,"APDD",136,136.02)

"BLD",8642,4,"APDD",136,136.04)

"BLD",8642,4,"APDD",136,136.32)

"BLD",8642,4,"B",130,130)

"BLD",8642,4,"B",130.4,130.4)

"BLD",8642,4,"B",133,133)

"BLD",8642,4,"B",136,136)

"BLD",8642,6.3)
89
"BLD",8642,"ABPKG")
n
"BLD",8642,"INI")
SR3P177
"BLD",8642,"INID")
^^n
"BLD",8642,"KRN",0)
^9.67PA^779.2^20
"BLD",8642,"KRN",.4,0)
.4
"BLD",8642,"KRN",.401,0)
.401
"BLD",8642,"KRN",.402,0)
.402
"BLD",8642,"KRN",.402,"NM",0)
^9.68A^6^6
"BLD",8642,"KRN",.402,"NM",1,0)
SRSRES1    FILE #130^130^0
"BLD",8642,"KRN",.402,"NM",2,0)
SRSRES2    FILE #130^130^0
"BLD",8642,"KRN",.402,"NM",3,0)
SRSCHED-UNREQUESTED    FILE #130^130^0
"BLD",8642,"KRN",.402,"NM",4,0)
SREQUEST    FILE #130^130^0
"BLD",8642,"KRN",.402,"NM",5,0)
SRSCHED-UNREQUESTED-ICD10    FILE #130^130^0
"BLD",8642,"KRN",.402,"NM",6,0)
SREQUEST-ICD10    FILE #130^130^0
"BLD",8642,"KRN",.402,"NM","B","SREQUEST    FILE #130",4)

"BLD",8642,"KRN",.402,"NM","B","SREQUEST-ICD10    FILE #130",6)

"BLD",8642,"KRN",.402,"NM","B","SRSCHED-UNREQUESTED    FILE #130",3)

"BLD",8642,"KRN",.402,"NM","B","SRSCHED-UNREQUESTED-ICD10    FILE #130",5)

"BLD",8642,"KRN",.402,"NM","B","SRSRES1    FILE #130",1)

"BLD",8642,"KRN",.402,"NM","B","SRSRES2    FILE #130",2)

"BLD",8642,"KRN",.403,0)
.403
"BLD",8642,"KRN",.5,0)
.5
"BLD",8642,"KRN",.84,0)
.84
"BLD",8642,"KRN",3.6,0)
3.6
"BLD",8642,"KRN",3.8,0)
3.8
"BLD",8642,"KRN",9.2,0)
9.2
"BLD",8642,"KRN",9.8,0)
9.8
"BLD",8642,"KRN",9.8,"NM",0)
^9.68A^72^58
"BLD",8642,"KRN",9.8,"NM",1,0)
SRHLDW1^^0^B4699482
"BLD",8642,"KRN",9.8,"NM",3,0)
SRONP2^^0^B17930608
"BLD",8642,"KRN",9.8,"NM",5,0)
SROAUTL2^^0^B35918406
"BLD",8642,"KRN",9.8,"NM",6,0)
SROATM2^^0^B35137516
"BLD",8642,"KRN",9.8,"NM",7,0)
SROAPRT6^^0^B6019028
"BLD",8642,"KRN",9.8,"NM",8,0)
SROAOP1^^0^B11530418
"BLD",8642,"KRN",9.8,"NM",11,0)
SROCD0^^0^B65638166
"BLD",8642,"KRN",9.8,"NM",12,0)
SROICD^^0^B55952758
"BLD",8642,"KRN",9.8,"NM",13,0)
SRHLUO^^0^B28555904
"BLD",8642,"KRN",9.8,"NM",14,0)
SRHLUO3^^0^B31162986
"BLD",8642,"KRN",9.8,"NM",15,0)
SRHLVUO^^0^B24970128
"BLD",8642,"KRN",9.8,"NM",17,0)
SROADX1^^0^B94091442
"BLD",8642,"KRN",9.8,"NM",18,0)
SROAOSET^^0^B4150779
"BLD",8642,"KRN",9.8,"NM",19,0)
SROCD2^^0^B23989346
"BLD",8642,"KRN",9.8,"NM",20,0)
SROCD4^^0^B20829958
"BLD",8642,"KRN",9.8,"NM",21,0)
SROCDX^^0^B22343423
"BLD",8642,"KRN",9.8,"NM",22,0)
SROCDX1^^0^B25379397
"BLD",8642,"KRN",9.8,"NM",23,0)
SROCMPED^^0^B36854349
"BLD",8642,"KRN",9.8,"NM",24,0)
SROCVER^^0^B37320749
"BLD",8642,"KRN",9.8,"NM",25,0)
SROESAD1^^0^B34060780
"BLD",8642,"KRN",9.8,"NM",26,0)
SROESNR2^^0^B33988113
"BLD",8642,"KRN",9.8,"NM",29,0)
SROATMNO^^0^B36769071
"BLD",8642,"KRN",9.8,"NM",30,0)
SROAUTL0^^0^B21283908
"BLD",8642,"KRN",9.8,"NM",31,0)
SROCOMP^^0^B18186198
"BLD",8642,"KRN",9.8,"NM",32,0)
SROAPCA4^^0^B16258498
"BLD",8642,"KRN",9.8,"NM",33,0)
SROAPRT7^^0^B30831500
"BLD",8642,"KRN",9.8,"NM",34,0)
SROVER^^0^B25778110
"BLD",8642,"KRN",9.8,"NM",35,0)
SROVER2^^0^B26606963
"BLD",8642,"KRN",9.8,"NM",36,0)
SROVER3^^0^B37536905
"BLD",8642,"KRN",9.8,"NM",38,0)
SROACMP^^0^B34094394
"BLD",8642,"KRN",9.8,"NM",39,0)
SROACOD^^0^B16693883
"BLD",8642,"KRN",9.8,"NM",41,0)
SROATCM^^0^B25541565
"BLD",8642,"KRN",9.8,"NM",42,0)
SROATCM3^^0^B13088442
"BLD",8642,"KRN",9.8,"NM",43,0)
SRCUSS^^0^B21173871
"BLD",8642,"KRN",9.8,"NM",44,0)
SRCUSS1^^0^B23008051
"BLD",8642,"KRN",9.8,"NM",45,0)
SROALNO^^0^B15400695
"BLD",8642,"KRN",9.8,"NM",46,0)
SRONEW^^0^B36010808
"BLD",8642,"KRN",9.8,"NM",47,0)
SRONOP^^0^B25659962
"BLD",8642,"KRN",9.8,"NM",48,0)
SRONOP1^^0^B16803692
"BLD",8642,"KRN",9.8,"NM",50,0)
SRSCHC2^^0^B1652836
"BLD",8642,"KRN",9.8,"NM",53,0)
SRSUP1^^0^B26965296
"BLD",8642,"KRN",9.8,"NM",54,0)
SRSUPRQ^^0^B28414875
"BLD",8642,"KRN",9.8,"NM",55,0)
SROP^^0^B21934166
"BLD",8642,"KRN",9.8,"NM",56,0)
SROPCE0A^^0^B59645915
"BLD",8642,"KRN",9.8,"NM",57,0)
SROPCE1^^0^B42495285
"BLD",8642,"KRN",9.8,"NM",58,0)
SROPER^^0^B13069473
"BLD",8642,"KRN",9.8,"NM",59,0)
SROMENU^^0^B24367683
"BLD",8642,"KRN",9.8,"NM",62,0)
SROICDL^^0^B34675259
"BLD",8642,"KRN",9.8,"NM",63,0)
SROICDGT^^0^B42226925
"BLD",8642,"KRN",9.8,"NM",64,0)
SR3P177^^0^B1411381
"BLD",8642,"KRN",9.8,"NM",65,0)
SROACOM1^^0^B19579953
"BLD",8642,"KRN",9.8,"NM",66,0)
SROCMPS^^0^B17944214
"BLD",8642,"KRN",9.8,"NM",67,0)
SROATM1^^0^B26038317
"BLD",8642,"KRN",9.8,"NM",68,0)
SROATCM1^^0^B58032375
"BLD",8642,"KRN",9.8,"NM",69,0)
SRSCHUN^^0^B32328292
"BLD",8642,"KRN",9.8,"NM",70,0)
SRSCHUN1^^0^B10221743
"BLD",8642,"KRN",9.8,"NM",71,0)
SRSRQST^^0^B28426612
"BLD",8642,"KRN",9.8,"NM",72,0)
SRSRQST1^^0^B11754122
"BLD",8642,"KRN",9.8,"NM","B","SR3P177",64)

"BLD",8642,"KRN",9.8,"NM","B","SRCUSS",43)

"BLD",8642,"KRN",9.8,"NM","B","SRCUSS1",44)

"BLD",8642,"KRN",9.8,"NM","B","SRHLDW1",1)

"BLD",8642,"KRN",9.8,"NM","B","SRHLUO",13)

"BLD",8642,"KRN",9.8,"NM","B","SRHLUO3",14)

"BLD",8642,"KRN",9.8,"NM","B","SRHLVUO",15)

"BLD",8642,"KRN",9.8,"NM","B","SROACMP",38)

"BLD",8642,"KRN",9.8,"NM","B","SROACOD",39)

"BLD",8642,"KRN",9.8,"NM","B","SROACOM1",65)

"BLD",8642,"KRN",9.8,"NM","B","SROADX1",17)

"BLD",8642,"KRN",9.8,"NM","B","SROALNO",45)

"BLD",8642,"KRN",9.8,"NM","B","SROAOP1",8)

"BLD",8642,"KRN",9.8,"NM","B","SROAOSET",18)

"BLD",8642,"KRN",9.8,"NM","B","SROAPCA4",32)

"BLD",8642,"KRN",9.8,"NM","B","SROAPRT6",7)

"BLD",8642,"KRN",9.8,"NM","B","SROAPRT7",33)

"BLD",8642,"KRN",9.8,"NM","B","SROATCM",41)

"BLD",8642,"KRN",9.8,"NM","B","SROATCM1",68)

"BLD",8642,"KRN",9.8,"NM","B","SROATCM3",42)

"BLD",8642,"KRN",9.8,"NM","B","SROATM1",67)

"BLD",8642,"KRN",9.8,"NM","B","SROATM2",6)

"BLD",8642,"KRN",9.8,"NM","B","SROATMNO",29)

"BLD",8642,"KRN",9.8,"NM","B","SROAUTL0",30)

"BLD",8642,"KRN",9.8,"NM","B","SROAUTL2",5)

"BLD",8642,"KRN",9.8,"NM","B","SROCD0",11)

"BLD",8642,"KRN",9.8,"NM","B","SROCD2",19)

"BLD",8642,"KRN",9.8,"NM","B","SROCD4",20)

"BLD",8642,"KRN",9.8,"NM","B","SROCDX",21)

"BLD",8642,"KRN",9.8,"NM","B","SROCDX1",22)

"BLD",8642,"KRN",9.8,"NM","B","SROCMPED",23)

"BLD",8642,"KRN",9.8,"NM","B","SROCMPS",66)

"BLD",8642,"KRN",9.8,"NM","B","SROCOMP",31)

"BLD",8642,"KRN",9.8,"NM","B","SROCVER",24)

"BLD",8642,"KRN",9.8,"NM","B","SROESAD1",25)

"BLD",8642,"KRN",9.8,"NM","B","SROESNR2",26)

"BLD",8642,"KRN",9.8,"NM","B","SROICD",12)

"BLD",8642,"KRN",9.8,"NM","B","SROICDGT",63)

"BLD",8642,"KRN",9.8,"NM","B","SROICDL",62)

"BLD",8642,"KRN",9.8,"NM","B","SROMENU",59)

"BLD",8642,"KRN",9.8,"NM","B","SRONEW",46)

"BLD",8642,"KRN",9.8,"NM","B","SRONOP",47)

"BLD",8642,"KRN",9.8,"NM","B","SRONOP1",48)

"BLD",8642,"KRN",9.8,"NM","B","SRONP2",3)

"BLD",8642,"KRN",9.8,"NM","B","SROP",55)

"BLD",8642,"KRN",9.8,"NM","B","SROPCE0A",56)

"BLD",8642,"KRN",9.8,"NM","B","SROPCE1",57)

"BLD",8642,"KRN",9.8,"NM","B","SROPER",58)

"BLD",8642,"KRN",9.8,"NM","B","SROVER",34)

"BLD",8642,"KRN",9.8,"NM","B","SROVER2",35)

"BLD",8642,"KRN",9.8,"NM","B","SROVER3",36)

"BLD",8642,"KRN",9.8,"NM","B","SRSCHC2",50)

"BLD",8642,"KRN",9.8,"NM","B","SRSCHUN",69)

"BLD",8642,"KRN",9.8,"NM","B","SRSCHUN1",70)

"BLD",8642,"KRN",9.8,"NM","B","SRSRQST",71)

"BLD",8642,"KRN",9.8,"NM","B","SRSRQST1",72)

"BLD",8642,"KRN",9.8,"NM","B","SRSUP1",53)

"BLD",8642,"KRN",9.8,"NM","B","SRSUPRQ",54)

"BLD",8642,"KRN",19,0)
19
"BLD",8642,"KRN",19,"NM",0)
^9.68A^^
"BLD",8642,"KRN",19.1,0)
19.1
"BLD",8642,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",8642,"KRN",101,0)
101
"BLD",8642,"KRN",409.61,0)
409.61
"BLD",8642,"KRN",771,0)
771
"BLD",8642,"KRN",779.2,0)
779.2
"BLD",8642,"KRN",870,0)
870
"BLD",8642,"KRN",8989.51,0)
8989.51
"BLD",8642,"KRN",8989.52,0)
8989.52
"BLD",8642,"KRN",8994,0)
8994
"BLD",8642,"KRN","B",.4,.4)

"BLD",8642,"KRN","B",.401,.401)

"BLD",8642,"KRN","B",.402,.402)

"BLD",8642,"KRN","B",.403,.403)

"BLD",8642,"KRN","B",.5,.5)

"BLD",8642,"KRN","B",.84,.84)

"BLD",8642,"KRN","B",3.6,3.6)

"BLD",8642,"KRN","B",3.8,3.8)

"BLD",8642,"KRN","B",9.2,9.2)

"BLD",8642,"KRN","B",9.8,9.8)

"BLD",8642,"KRN","B",19,19)

"BLD",8642,"KRN","B",19.1,19.1)

"BLD",8642,"KRN","B",101,101)

"BLD",8642,"KRN","B",409.61,409.61)

"BLD",8642,"KRN","B",771,771)

"BLD",8642,"KRN","B",779.2,779.2)

"BLD",8642,"KRN","B",870,870)

"BLD",8642,"KRN","B",8989.51,8989.51)

"BLD",8642,"KRN","B",8989.52,8989.52)

"BLD",8642,"KRN","B",8994,8994)

"BLD",8642,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",8642,"QUES",0)
^9.62^^
"BLD",8642,"REQB",0)
^9.611^8^6
"BLD",8642,"REQB",1,0)
LEX*2.0*80^2
"BLD",8642,"REQB",3,0)
ICD*18.0*57^2
"BLD",8642,"REQB",5,0)
SR*3.0*159^2
"BLD",8642,"REQB",6,0)
SR*3.0*176^2
"BLD",8642,"REQB",7,0)
SR*3.0*154^2
"BLD",8642,"REQB",8,0)
SR*3.0*161^2
"BLD",8642,"REQB","B","ICD*18.0*57",3)

"BLD",8642,"REQB","B","LEX*2.0*80",1)

"BLD",8642,"REQB","B","SR*3.0*154",7)

"BLD",8642,"REQB","B","SR*3.0*159",5)

"BLD",8642,"REQB","B","SR*3.0*161",8)

"BLD",8642,"REQB","B","SR*3.0*176",6)

"DATA",130.4,1,0)
SURG^1^^DIAG^127^
"DATA",130.4,1,1)
S Y=$$SEARCH^ICDSAPI("DIAG",("I $$LS^ICDEX(80,+Y,"""_SRDT_""")=1"),"QEMZ",SRDT)
"DATA",130.4,2,0)
SURG^30^^DIAG^127^
"DATA",130.4,2,1)
D LEX^SROICD
"DATA",130.4,91,0)
SAMPLE PROC ICD-9^2^^PROC^127
"DATA",130.4,91,1)
S Y=$$SEARCH^ICDSAPI("PROC",("I $$LS^ICDEX(80.1,+Y,"""_EFFDATE_""")=1"),"QEMZ",EFFDATE)
"DATA",130.4,92,0)
SAMPLE PROC ICD-10^31^^PROC^127
"DATA",130.4,92,1)
D ASK^DGICP
"DATA",130.4,93,0)
SAMPLE DIAG ICD-9^1^^DIAG^127
"DATA",130.4,93,1)
S Y=$$SEARCH^ICDSAPI("DIAG",("I $$LS^ICDEX(80,+Y,"""_EFFDATE_""")=1"),"QEMZ",EFFDATE)
"DATA",130.4,94,0)
SAMPLE DIAG ICD-10^30^^DIAG^127
"DATA",130.4,94,1)
D LEX^DGICD
"FIA",130)
SURGERY
"FIA",130,0)
^SRF(
"FIA",130,0,0)
130IP
"FIA",130,0,1)
y^y^p^^^^n^^n
"FIA",130,0,10)

"FIA",130,0,11)

"FIA",130,0,"RLRO")

"FIA",130,0,"VR")
3.0^SR
"FIA",130,130)
1
"FIA",130,130,32.5)

"FIA",130,130,66)

"FIA",130,130,69)

"FIA",130,130,253)

"FIA",130,130,286)

"FIA",130,130,343)

"FIA",130,130,344)

"FIA",130,130,392)

"FIA",130,130,489)

"FIA",130,130,1006)

"FIA",130,130.13)
1
"FIA",130,130.13,4)

"FIA",130,130.17)
1
"FIA",130,130.17,3)

"FIA",130,130.18)
1
"FIA",130,130.18,3)

"FIA",130,130.22)
1
"FIA",130,130.22,6)

"FIA",130.4)
ICD SEARCH API
"FIA",130.4,0)
^DIC(130.4,
"FIA",130.4,0,0)
130.4I
"FIA",130.4,0,1)
y^y^f^^y^^y^o^n
"FIA",130.4,0,10)

"FIA",130.4,0,11)

"FIA",130.4,0,"RLRO")

"FIA",130.4,0,"VR")
3.0^SR
"FIA",130.4,130.4)
0
"FIA",133)
SURGERY SITE PARAMETERS
"FIA",133,0)
^SRO(133,
"FIA",133,0,0)
133P
"FIA",133,0,1)
y^y^p^^^^n^^n
"FIA",133,0,10)

"FIA",133,0,11)

"FIA",133,0,"RLRO")

"FIA",133,0,"VR")
3.0^SR
"FIA",133,133)
1
"FIA",133,133,39)

"FIA",136)
SURGERY PROCEDURE/DIAGNOSIS CODES
"FIA",136,0)
^SRO(136,
"FIA",136,0,0)
136P
"FIA",136,0,1)
y^y^p^^^^n^^n
"FIA",136,0,10)

"FIA",136,0,11)

"FIA",136,0,"RLRO")

"FIA",136,0,"VR")
3.0^SR
"FIA",136,136)
1
"FIA",136,136,.03)

"FIA",136,136,2)

"FIA",136,136,4)

"FIA",136,136.02)
0
"FIA",136,136.03)
1
"FIA",136,136.03,2)

"FIA",136,136.04)
0
"FIA",136,136.32)
0
"FRV1",130.4,"1,0",5)
SURGERY
"FRV1",130.4,"1,0",5,"F")
;DIC(9.4,
"FRV1",130.4,"2,0",5)
SURGERY
"FRV1",130.4,"2,0",5,"F")
;DIC(9.4,
"FRV1",130.4,"91,0",5)
SURGERY
"FRV1",130.4,"91,0",5,"F")
;DIC(9.4,
"FRV1",130.4,"92,0",5)
SURGERY
"FRV1",130.4,"92,0",5,"F")
;DIC(9.4,
"FRV1",130.4,"93,0",5)
SURGERY
"FRV1",130.4,"93,0",5,"F")
;DIC(9.4,
"FRV1",130.4,"94,0",5)
SURGERY
"FRV1",130.4,"94,0",5,"F")
;DIC(9.4,
"INI")
SR3P177
"IX",130.4,130.4,"C",0)
130.4^C^Uniqueness Index for Key 'A' of File #130.4^R^^R^IR^I^130.4^^^^^LS
"IX",130.4,130.4,"C",1)
S ^DIC(130.4,"C",X(1),X(2),X(3),DA)=""
"IX",130.4,130.4,"C",2)
K ^DIC(130.4,"C",X(1),X(2),X(3),DA)
"IX",130.4,130.4,"C",2.5)
K ^DIC(130.4,"C")
"IX",130.4,130.4,"C",11.1,0)
^.114IA^3^3
"IX",130.4,130.4,"C",11.1,1,0)
1^F^130.4^.01^^1
"IX",130.4,130.4,"C",11.1,2,0)
2^F^130.4^.04^^2
"IX",130.4,130.4,"C",11.1,3,0)
3^F^130.4^.02^^3
"KEY",130.4,130.4,"A",0)
130.4^A^P^1026
"KEY",130.4,130.4,"A",2,0)
^.312IA^3^3
"KEY",130.4,130.4,"A",2,1,0)
.01^130.4^1
"KEY",130.4,130.4,"A",2,2,0)
.04^130.4^2
"KEY",130.4,130.4,"A",2,3,0)
.02^130.4^3
"KEYPTR",130.4,130.4,"A")
130.4^C
"KRN",.402,1228,-1)
0^1
"KRN",.402,1228,0)
SRSRES1^3120714.1633^^130^^^3140408
"KRN",.402,1228,"DIAB",1,0,130,1)
.164;T
"KRN",.402,1228,"DIAB",1,1,130.03,0)
.01;T
"KRN",.402,1228,"DIAB",1,1,130.065,0)
.01;T
"KRN",.402,1228,"DIAB",2,0,130,0)
32;T
"KRN",.402,1228,"DIAB",2,0,130,1)
.43;T
"KRN",.402,1228,"DIAB",2,1,130.03,0)
1;T
"KRN",.402,1228,"DIAB",3,0,130,1)
.037;T
"KRN",.402,1228,"DIAB",3,1,130.03,0)
2;T
"KRN",.402,1228,"DIAB",4,0,130,1)
SURGERY POS;T
"KRN",.402,1228,"DIAB",4,1,130.03,0)
3;T
"KRN",.402,1228,"DIAB",5,0,130,0)
32.5;"Prin Pre-OP ICD Diagnosis Code (ICD9)"
"KRN",.402,1228,"DIAB",5,0,130,1)
1.01;T
"KRN",.402,1228,"DIAB",5,1,130.03,0)
4;T
"KRN",.402,1228,"DIAB",6,0,130,1)
1.02;T
"KRN",.402,1228,"DIAB",6,1,130.03,0)
5;T
"KRN",.402,1228,"DIAB",7,0,130,1)
1.03;T
"KRN",.402,1228,"DIAB",8,0,130,0)
32.5;"Prin Pre-OP ICD Diagnosis Code (ICD10)"
"KRN",.402,1228,"DIAB",8,0,130,1)
1.035;T
"KRN",.402,1228,"DIAB",9,0,130,1)
1.04;T
"KRN",.402,1228,"DIAB",10,0,130,0)
.011//I;T
"KRN",.402,1228,"DIAB",10,0,130,1)
.05;T
"KRN",.402,1228,"DIAB",11,0,130,0)
.035;T
"KRN",.402,1228,"DIAB",11,0,130,1)
23;T
"KRN",.402,1228,"DIAB",12,0,130,0)
.15;T
"KRN",.402,1228,"DIAB",12,0,130,1)
.28;T
"KRN",.402,1228,"DIAB",13,0,130,0)
.16;T
"KRN",.402,1228,"DIAB",13,0,130,1)
80;T
"KRN",.402,1228,"DR",1,130)
W !;32T~;S:$G(SRICDV)="" SRICDV=$$ICDSTR^SROICD(DA);I $G(SRICDV)["10" S Y="@1";32.5Prin Pre-OP ICD Diagnosis Code (ICD9)~;@1;I $G(SRICDV)["9" S Y="@2";32.5Prin Pre-OP ICD Diagnosis Code (ICD10)~;@2;.011T~//I;.035T~;.15T~;.16T~;Q;
"KRN",.402,1228,"DR",1,130,1)
.164T~;.43T~;.037T~;65T~;1.01T~;1.02T~;1.03T~;1.035T~;1.04T~;.05T~;23T~;.28T~;80T~;
"KRN",.402,1228,"DR",2,130.03)
.01T~;1T~;2T~;3T~;4T~;5T~;
"KRN",.402,1228,"DR",2,130.065)
.01T~;
"KRN",.402,1230,-1)
0^2
"KRN",.402,1230,0)
SRSRES2^3111109.1242^^130^^^3111109
"KRN",.402,1230,"DIAB",1,0,130,1)
1.02;T
"KRN",.402,1230,"DIAB",2,0,130,0)
32;T
"KRN",.402,1230,"DIAB",2,0,130,1)
1.03;T
"KRN",.402,1230,"DIAB",3,0,130,1)
1.035;T
"KRN",.402,1230,"DIAB",4,0,130,0)
32.5;"Prin Pre-OP ICD Diagnosis Code (ICD9)"
"KRN",.402,1230,"DIAB",4,0,130,1)
1.04;T
"KRN",.402,1230,"DIAB",5,0,130,1)
.05;T
"KRN",.402,1230,"DIAB",6,0,130,1)
.28;T
"KRN",.402,1230,"DIAB",7,0,130,0)
32.5;"Prin Pre-OP ICD Diagnosis Code (ICD10)"
"KRN",.402,1230,"DIAB",9,0,130,0)
.011//I;T
"KRN",.402,1230,"DIAB",10,0,130,0)
.035;T
"KRN",.402,1230,"DIAB",11,0,130,0)
.04;T
"KRN",.402,1230,"DIAB",12,0,130,0)
.14;T
"KRN",.402,1230,"DIAB",13,0,130,0)
.15;T
"KRN",.402,1230,"DIAB",14,0,130,0)
.16;T
"KRN",.402,1230,"DIAB",15,0,130,0)
.164;T
"KRN",.402,1230,"DIAB",17,0,130,0)
.43;T
"KRN",.402,1230,"DIAB",18,0,130,0)
.037;T
"KRN",.402,1230,"DIAB",19,0,130,0)
1.01;T
"KRN",.402,1230,"DR",1,130)
W !;32T~;I $G(SRICDV)["10" S Y="@1";32.5Prin Pre-OP ICD Diagnosis Code (ICD9)~;@1;I $G(SRICDV)["9" S Y="@2";32.5Prin Pre-OP ICD Diagnosis Code (ICD10)~;@2;.011T~//I;.035T~;.04T~;.14T~;.15T~;.16T~;.164T~;Q;.43T~;.037T~;1.01T~;
"KRN",.402,1230,"DR",1,130,1)
1.02T~;1.03T~;1.035T~;1.04T~;.05T~;.28T~;
"KRN",.402,1246,-1)
0^4
"KRN",.402,1246,0)
SREQUEST^3140326.1633^^130^^^3140326
"KRN",.402,1246,"DIAB",1,1,130.03,0)
.01;T
"KRN",.402,1246,"DIAB",1,1,130.065,0)
.01;T
"KRN",.402,1246,"DIAB",2,0,130,0)
32;T
"KRN",.402,1246,"DIAB",2,0,130,1)
.15;T
"KRN",.402,1246,"DIAB",2,0,130,2)
1.02;T
"KRN",.402,1246,"DIAB",2,1,130.03,0)
1;T
"KRN",.402,1246,"DIAB",3,1,130.03,0)
2;T
"KRN",.402,1246,"DIAB",4,1,130.03,0)
3;T
"KRN",.402,1246,"DIAB",5,0,130,0)
32.5;"Prin Pre-OP ICD Diagnosis Code (ICD9)"
"KRN",.402,1246,"DIAB",5,0,130,1)
.16;T
"KRN",.402,1246,"DIAB",5,0,130,2)
1.03;T
"KRN",.402,1246,"DIAB",5,1,130.03,0)
4;T
"KRN",.402,1246,"DIAB",6,1,130.03,0)
5;T
"KRN",.402,1246,"DIAB",8,0,130,1)
.164;T
"KRN",.402,1246,"DIAB",8,0,130,2)
1.035;T
"KRN",.402,1246,"DIAB",9,0,130,0)
.011//"I";T
"KRN",.402,1246,"DIAB",11,0,130,0)
56;T
"KRN",.402,1246,"DIAB",11,0,130,1)
.43;T
"KRN",.402,1246,"DIAB",11,0,130,2)
1.04;T
"KRN",.402,1246,"DIAB",14,0,130,0)
.035;T
"KRN",.402,1246,"DIAB",14,0,130,1)
.037;T
"KRN",.402,1246,"DIAB",14,0,130,2)
.05;T
"KRN",.402,1246,"DIAB",18,0,130,1)
1.01;T
"KRN",.402,1246,"DR",1,130)
I $D(SREQ(32)) S Y="@1";32T~;@1;I $D(SREQ(32.5)) S Y="@2";32.5Prin Pre-OP ICD Diagnosis Code (ICD9)~;@2;I $D(SREQ(.011)) S Y="@4";Q;.011T~//^S X="I";I X="I" S Y="@4";56T~;@4;I $D(SREQ(.035)) S Y="@5";.035T~;@5;
"KRN",.402,1246,"DR",1,130,1)
I $D(SREQ(.15)) S Y="@6";.15T~;@6;I $D(SREQ(.16)) S Y="@7";.16T~;@7;I $D(SREQ(.164)) S Y="@8";.164T~;@8;I $D(SREQ(.43)) S Y="@9";.43T~;@9;I $D(SREQ(.037)) S Y="@10";.037T~;@10;65;I $D(SREQ(1.01)) S Y="@11";1.01T~;@11;
"KRN",.402,1246,"DR",1,130,2)
I $D(SREQ(1.02)) S Y="@12";1.02T~;@12;I $D(SREQ(1.03)) S Y="@13";1.03T~;@13;I $D(SREQ(1.035)) S Y="@14";1.035T~;@14;I $D(SREQ(1.04)) S Y="@15";1.04T~;@15;I $D(SREQ(.05)) S Y="@16";.05T~;@16;23;.28;80;
"KRN",.402,1246,"DR",2,130.03)
.01T~;1T~;2T~;3T~;4T~;5T~;
"KRN",.402,1246,"DR",2,130.065)
.01T~;
"KRN",.402,1247,-1)
0^3
"KRN",.402,1247,0)
SRSCHED-UNREQUESTED^3140324.1815^^130^^^3140805
"KRN",.402,1247,"DIAB",2,0,130,0)
32;T
"KRN",.402,1247,"DIAB",2,0,130,1)
.15;T
"KRN",.402,1247,"DIAB",2,0,130,2)
1.02;T
"KRN",.402,1247,"DIAB",5,0,130,0)
32.5;"Prin Pre-OP ICD Diagnosis Code (ICD9)"
"KRN",.402,1247,"DIAB",5,0,130,1)
.16;T
"KRN",.402,1247,"DIAB",5,0,130,2)
1.03;T
"KRN",.402,1247,"DIAB",8,0,130,1)
.164;T
"KRN",.402,1247,"DIAB",8,0,130,2)
1.035;T
"KRN",.402,1247,"DIAB",9,0,130,0)
.011//"I";T
"KRN",.402,1247,"DIAB",11,0,130,0)
56;T
"KRN",.402,1247,"DIAB",11,0,130,1)
.43;T
"KRN",.402,1247,"DIAB",11,0,130,2)
1.04;T
"KRN",.402,1247,"DIAB",14,0,130,0)
.035;T
"KRN",.402,1247,"DIAB",14,0,130,1)
.037;T
"KRN",.402,1247,"DIAB",14,0,130,2)
.05;T
"KRN",.402,1247,"DIAB",17,0,130,1)
1.01;T
"KRN",.402,1247,"DR",1,130)
I $D(SREQ(32)) S Y="@1";32T~;@1;I $D(SREQ(32.5)) S Y="@2";32.5Prin Pre-OP ICD Diagnosis Code (ICD9)~;@2;I $D(SREQ(.011)) S Y="@4";Q;.011T~//^S X="I";I X="I" S Y="@4";56T~;@4;I $D(SREQ(.035)) S Y="@5";.035T~;@5;
"KRN",.402,1247,"DR",1,130,1)
I $D(SREQ(.15)) S Y="@6";.15T~;@6;I $D(SREQ(.16)) S Y="@7";.16T~;@7;I $D(SREQ(.164)) S Y="@8";.164T~;@8;I $D(SREQ(.43)) S Y="@9";.43T~;@9;I $D(SREQ(.037)) S Y="@10";.037T~;@10;I $D(SREQ(1.01)) S Y="@11";1.01T~;@11;
"KRN",.402,1247,"DR",1,130,2)
I $D(SREQ(1.02)) S Y="@12";1.02T~;@12;I $D(SREQ(1.03)) S Y="@13";1.03T~;@13;I $D(SREQ(1.035)) S Y="@14";1.035T~;@14;I $D(SREQ(1.04)) S Y="@15";1.04T~;@15;I $D(SREQ(.05)) S Y="@16";.05T~;@16;.28;80;
"KRN",.402,1818,-1)
0^5
"KRN",.402,1818,0)
SRSCHED-UNREQUESTED-ICD10^3140324.1814^^130^^^3140805
"KRN",.402,1818,"DIAB",2,0,130,0)
32;T
"KRN",.402,1818,"DIAB",2,0,130,1)
.15;T
"KRN",.402,1818,"DIAB",2,0,130,2)
1.02;T
"KRN",.402,1818,"DIAB",5,0,130,0)
32.5;"Prin Pre-OP ICD Diagnosis Code (ICD10)"
"KRN",.402,1818,"DIAB",5,0,130,1)
.16;T
"KRN",.402,1818,"DIAB",5,0,130,2)
1.03;T
"KRN",.402,1818,"DIAB",8,0,130,1)
.164;T
"KRN",.402,1818,"DIAB",8,0,130,2)
1.035;T
"KRN",.402,1818,"DIAB",9,0,130,0)
.011//"I";T
"KRN",.402,1818,"DIAB",11,0,130,0)
56;T
"KRN",.402,1818,"DIAB",11,0,130,1)
.43;T
"KRN",.402,1818,"DIAB",11,0,130,2)
1.04;T
"KRN",.402,1818,"DIAB",14,0,130,0)
.035;T
"KRN",.402,1818,"DIAB",14,0,130,1)
.037;T
"KRN",.402,1818,"DIAB",14,0,130,2)
.05;T
"KRN",.402,1818,"DIAB",17,0,130,1)
1.01;T
"KRN",.402,1818,"DR",1,130)
I $D(SREQ(32)) S Y="@1";32T~;@1;I $D(SREQ(32.5)) S Y="@2";32.5Prin Pre-OP ICD Diagnosis Code (ICD10)~;@2;I $D(SREQ(.011)) S Y="@4";Q;.011T~//^S X="I";I X="I" S Y="@4";56T~;@4;I $D(SREQ(.035)) S Y="@5";.035T~;@5;
"KRN",.402,1818,"DR",1,130,1)
I $D(SREQ(.15)) S Y="@6";.15T~;@6;I $D(SREQ(.16)) S Y="@7";.16T~;@7;I $D(SREQ(.164)) S Y="@8";.164T~;@8;I $D(SREQ(.43)) S Y="@9";.43T~;@9;I $D(SREQ(.037)) S Y="@10";.037T~;@10;I $D(SREQ(1.01)) S Y="@11";1.01T~;@11;
"KRN",.402,1818,"DR",1,130,2)
I $D(SREQ(1.02)) S Y="@12";1.02T~;@12;I $D(SREQ(1.03)) S Y="@13";1.03T~;@13;I $D(SREQ(1.035)) S Y="@14";1.035T~;@14;I $D(SREQ(1.04)) S Y="@15";1.04T~;@15;I $D(SREQ(.05)) S Y="@16";.05T~;@16;.28;80;
"KRN",.402,1819,-1)
0^6
"KRN",.402,1819,0)
SREQUEST-ICD10^3140326.1638^^130^^^3140326
"KRN",.402,1819,"DIAB",1,1,130.03,0)
.01;T
"KRN",.402,1819,"DIAB",1,1,130.065,0)
.01;T
"KRN",.402,1819,"DIAB",2,0,130,0)
32;T
"KRN",.402,1819,"DIAB",2,0,130,1)
.15;T
"KRN",.402,1819,"DIAB",2,0,130,2)
1.02;T
"KRN",.402,1819,"DIAB",2,1,130.03,0)
1;T
"KRN",.402,1819,"DIAB",3,1,130.03,0)
2;T
"KRN",.402,1819,"DIAB",4,1,130.03,0)
3;T
"KRN",.402,1819,"DIAB",5,0,130,0)
32.5;"Prin Pre-OP ICD Diagnosis Code (ICD10)"
"KRN",.402,1819,"DIAB",5,0,130,1)
.16;T
"KRN",.402,1819,"DIAB",5,0,130,2)
1.03;T
"KRN",.402,1819,"DIAB",5,1,130.03,0)
4;T
"KRN",.402,1819,"DIAB",6,1,130.03,0)
5;T
"KRN",.402,1819,"DIAB",8,0,130,1)
.164;T
"KRN",.402,1819,"DIAB",8,0,130,2)
1.035;T
"KRN",.402,1819,"DIAB",9,0,130,0)
.011//"I";T
"KRN",.402,1819,"DIAB",11,0,130,0)
56;T
"KRN",.402,1819,"DIAB",11,0,130,1)
.43;T
"KRN",.402,1819,"DIAB",11,0,130,2)
1.04;T
"KRN",.402,1819,"DIAB",14,0,130,0)
.035;T
"KRN",.402,1819,"DIAB",14,0,130,1)
.037;T
"KRN",.402,1819,"DIAB",14,0,130,2)
.05;T
"KRN",.402,1819,"DIAB",18,0,130,1)
1.01;T
"KRN",.402,1819,"DR",1,130)
I $D(SREQ(32)) S Y="@1";32T~;@1;I $D(SREQ(32.5)) S Y="@2";32.5Prin Pre-OP ICD Diagnosis Code (ICD10)~;@2;I $D(SREQ(.011)) S Y="@4";Q;.011T~//^S X="I";I X="I" S Y="@4";56T~;@4;I $D(SREQ(.035)) S Y="@5";.035T~;@5;
"KRN",.402,1819,"DR",1,130,1)
I $D(SREQ(.15)) S Y="@6";.15T~;@6;I $D(SREQ(.16)) S Y="@7";.16T~;@7;I $D(SREQ(.164)) S Y="@8";.164T~;@8;I $D(SREQ(.43)) S Y="@9";.43T~;@9;I $D(SREQ(.037)) S Y="@10";.037T~;@10;65;I $D(SREQ(1.01)) S Y="@11";1.01T~;@11;
"KRN",.402,1819,"DR",1,130,2)
I $D(SREQ(1.02)) S Y="@12";1.02T~;@12;I $D(SREQ(1.03)) S Y="@13";1.03T~;@13;I $D(SREQ(1.035)) S Y="@14";1.035T~;@14;I $D(SREQ(1.04)) S Y="@15";1.04T~;@15;I $D(SREQ(.05)) S Y="@16";.05T~;@16;23;.28;80;
"KRN",.402,1819,"DR",2,130.03)
.01T~;1T~;2T~;3T~;4T~;5T~;
"KRN",.402,1819,"DR",2,130.065)
.01T~;
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PGL",130.4,0,5,.05)
OWNER PACKAGE^RP9.4^DIC(9.4,^0;5^Q
"PKG",127,-1)
1^1
"PKG",127,0)
SURGERY^SR^SURGICAL DATA COLLECTION AND OPERATIONS SCHEDULING
"PKG",127,20,0)
^9.402P^^
"PKG",127,22,0)
^9.49I^1^1
"PKG",127,22,1,0)
3.0^2930624^2960829
"PKG",127,22,1,"PAH",1,0)
177^3140806
"PKG",127,22,1,"PAH",1,1,0)
^^22^22^3140806
"PKG",127,22,1,"PAH",1,1,1,0)
The International Classification of Diseases, Tenth Revision (ICD-10) 
"PKG",127,22,1,"PAH",1,1,2,0)
Class 1 Software Remediation project replaces the 30-year-old set of 
"PKG",127,22,1,"PAH",1,1,3,0)
diagnosis and procedure codes (ICD-9-CM) that medical personnel use. 
"PKG",127,22,1,"PAH",1,1,4,0)
Dates of service, or dates of discharge for inpatients, that occur on or 
"PKG",127,22,1,"PAH",1,1,5,0)
after October 10, 2013 will use the ICD-10 code set. Clinical Modification
"PKG",127,22,1,"PAH",1,1,6,0)
(ICD-10-CM) diagnosis codes increase from about 13,000 ICD-9 codes to 
"PKG",127,22,1,"PAH",1,1,7,0)
more than 68,000. Procedure Coding System (ICD-10-PCS) procedure codes 
"PKG",127,22,1,"PAH",1,1,8,0)
increase from about 3,800 ICD-9 codes to nearly 87,000. Both systems also 
"PKG",127,22,1,"PAH",1,1,9,0)
expand the number of characters allotted to seven alpha-numeric 
"PKG",127,22,1,"PAH",1,1,10,0)
characters. This value does not include the decimal point, which follows 
"PKG",127,22,1,"PAH",1,1,11,0)
the third character for the ICD-10-CM code set. There is no decimal point 
"PKG",127,22,1,"PAH",1,1,12,0)
in the ICD-10-PCS code set. 
"PKG",127,22,1,"PAH",1,1,13,0)
These code sets have the potential to reveal more about quality of care, 
"PKG",127,22,1,"PAH",1,1,14,0)
so that data can be used in a more meaningful way to better understand 
"PKG",127,22,1,"PAH",1,1,15,0)
complications, better design clinically robust algorithms, and better 
"PKG",127,22,1,"PAH",1,1,16,0)
track the outcomes of care. ICD-10-CM also incorporates greater 
"PKG",127,22,1,"PAH",1,1,17,0)
specificity and clinical detail to provide information for clinical 
"PKG",127,22,1,"PAH",1,1,18,0)
decision making and outcomes research.
"PKG",127,22,1,"PAH",1,1,19,0)
 
"PKG",127,22,1,"PAH",1,1,20,0)
The only noticeable difference users may see will occur when a specific 
"PKG",127,22,1,"PAH",1,1,21,0)
ICD diagnosis code descriptor changes based on the date of operation for 
"PKG",127,22,1,"PAH",1,1,22,0)
the case.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
58
"RTN","SR3P177")
0^64^B1411381^n/a
"RTN","SR3P177",1,0)
SR3P177 ;ALB/AAS - Patch 177 pre-install;1 Mar 12
"RTN","SR3P177",2,0)
 ;;3.0;Surgery;**177**;24 Jun 93;Build 89
"RTN","SR3P177",3,0)
 ;
"RTN","SR3P177",4,0)
EN ; 
"RTN","SR3P177",5,0)
 N FLD,X,Y,DA,DIK
"RTN","SR3P177",6,0)
 I $G(DUZ)="" W !,"Your DUZ is not defined.  It must be defined to run this routine." Q
"RTN","SR3P177",7,0)
 ;
"RTN","SR3P177",8,0)
 ;Delete updated fields to remove screens.
"RTN","SR3P177",9,0)
 N FLD,X,Y,DA,DIK
"RTN","SR3P177",10,0)
 X ^%ZOSF("UCI") I Y["DEVESS" W !,"CAN'T BE RUN IN DEVESS",!,*7 Q
"RTN","SR3P177",11,0)
 ;
"RTN","SR3P177",12,0)
 F FLD=32.5,66,253,286,343,344,392,489 D
"RTN","SR3P177",13,0)
 . S DIK="^DD(130,",DA=FLD,DA(1)=130
"RTN","SR3P177",14,0)
 . D ^DIK
"RTN","SR3P177",15,0)
 ;
"RTN","SR3P177",16,0)
 ;
"RTN","SR3P177",17,0)
 S FLD=4 D
"RTN","SR3P177",18,0)
 . S DIK="^DD(130.13,",DA=FLD,DA(1)=130.13
"RTN","SR3P177",19,0)
 . D ^DIK
"RTN","SR3P177",20,0)
 ;
"RTN","SR3P177",21,0)
 S FLD=3 D
"RTN","SR3P177",22,0)
 . S DIK="^DD(130.17,",DA=FLD,DA(1)=130.17
"RTN","SR3P177",23,0)
 . D ^DIK
"RTN","SR3P177",24,0)
 ;
"RTN","SR3P177",25,0)
 S FLD=3 D
"RTN","SR3P177",26,0)
 . S DIK="^DD(130.18,",DA=FLD,DA(1)=130.18
"RTN","SR3P177",27,0)
 . D ^DIK
"RTN","SR3P177",28,0)
 ;
"RTN","SR3P177",29,0)
 S FLD=6 D
"RTN","SR3P177",30,0)
 . S DIK="^DD(130.22,",DA=FLD,DA(1)=130.22
"RTN","SR3P177",31,0)
 . D ^DIK
"RTN","SR3P177",32,0)
 ;
"RTN","SR3P177",33,0)
 S FLD=.03 D
"RTN","SR3P177",34,0)
 . S DIK="^DD(136,",DA=FLD,DA(1)=136
"RTN","SR3P177",35,0)
 . D ^DIK
"RTN","SRCUSS")
0^43^B21173871^B17905369
"RTN","SRCUSS",1,0)
SRCUSS ;TAMPA/CFB - SCREEN SERVER ;27 Sep 2013  1:22 PM
"RTN","SRCUSS",2,0)
 ;;3.0;Surgery;**66,108,177**;24 Jun 93;Build 89
"RTN","SRCUSS",3,0)
 ;
"RTN","SRCUSS",4,0)
 ; Reference to $$CSI^ICDEX supported by DBIA #5747
"RTN","SRCUSS",5,0)
 ; Reference to $$CODEN^ICDEX supported by DBIA #5747
"RTN","SRCUSS",6,0)
 ;
"RTN","SRCUSS",7,0)
 K ^TMP("SRCUSS",$J)
"RTN","SRCUSS",8,0)
 S SRCUSS("OUT")=1
"RTN","SRCUSS",9,0)
 I '$D(IOF) S IOP="" D ^%ZIS K IOP
"RTN","SRCUSS",10,0)
 S Q=1 I '$D(Q1) K Q D STOP^SRCUSS3 I $D(Q("DIE")) S Q=1 D BQ^SRCUSS1 S SRCUSS("SRCUSS")="" D ^DIE K SRCUSS("SRCUSS"),Q5 Q
"RTN","SRCUSS",11,0)
0 S SRCUSS("SRCUSS")="" D START^SRCUSS3
"RTN","SRCUSS",12,0)
1 S IOP="" D DT^DICRW:'$D(DT),^%ZIS K IOP D 1^SRCUSS3 I $D(Q("Q")) G:Q("Q") BQ^SRCUSS1 K Q("Q")
"RTN","SRCUSS",13,0)
A S QPQPQ=1,SRCUSS("OUT")=1 K Q("S",Q,Q0(0,Q),Q(1,Q)+1) X:$S('$D(Q(12,4)):0,Q[Q(12,4):1,1:0) Q(0) K:$S('$D(Q(12,4)):0,Q(12,4)=Q:1,1:0) Q(12,4) G BQ^SRCUSS1:$D(Q(12,4))
"RTN","SRCUSS",14,0)
 I Q=1,$D(Q3("DIVE")),+Q3("DIVE")>1 S Q0(0,Q)=+Q3("DIVE"),Q3("DIVE")="P"_$P(Q3("DIVE"),"P",2) X Q(0)
"RTN","SRCUSS",15,0)
 S Q(1,Q)=Q(1,Q)+1,Q(13)=Q(13)+1 G:$D(Q(10,Q))&(Q(1,Q)>2) A1 S Q(2)=$P(Q0(Q,Q0(0,Q)),";",Q(1,Q)) G B^SRCUSS1:Q(2)="",X:Q(2)?1U.E
"RTN","SRCUSS",16,0)
 I Q("ED"),$D(Q("X")),Q("X"),(Q("X")+2=Q(1,Q)) S Q8=$O(^TMP("SRCUSS",$J,Q("X"))) Q:Q8=""  S Q8=$P(^(Q("X"),0),U,1)-$Y+1 G:Q8 ED1^SRCUSS2 Q
"RTN","SRCUSS",17,0)
 S Q(2)=+Q(2),Q7="^DD("_+Q(0,Q)_",Q(2),0)" G:'$D(@(Q7)) A I $D(@(Q7)) X:$D(^(12.1)) ^(12.1) S:$D(DIC("S")) Q("S",Q,Q0(0,Q),Q(1,Q))=DIC("S") K DIC("S") S Q(3)=@(Q7),Q(4)=$P(Q(3),U,2),Q(1)="" K Q(11)
"RTN","SRCUSS",18,0)
A0 I "IMRQ*"[$E(Q(4),1) S Q(4)=$E(Q(4),2,99) S:$E(Q(4))="X"!($E(Q(4))="O") Q(4)="F"_Q(4) S:Q(4)="" Q(4)="F" G A0
"RTN","SRCUSS",19,0)
 S Q("O")=Q(4),Q(5)=$E(Q(4),1) S:Q(5)="" Q(5)="F" G:Q(5)="C" C S:Q(5)'?1N Q(4)=$E(Q(4),2,99) S Q(6)=$P(Q(3),U,4),Q3="(WORD PROCESSING)" K Q(2,Q,Q(1,Q)-1)
"RTN","SRCUSS",20,0)
 I Q(5)="D",$E(Q(4),1)="C" G C
"RTN","SRCUSS",21,0)
 I Q(5)?1N S Q(5)=@("^DD("_+Q(4)_",.01,0)"),Q(7)=$S($P(Q(5),U,2)["W":Q3,1:"(MULTIPLE)"),Q(7)=$S($O(@(Q(8,Q)_Q(9,Q)_","_$C(34)_$P(Q(6),";",1)_$C(34)_",0)"))>0:Q(7)_"(DATA)",1:Q(7)),Q(2,Q,Q(1,Q)-1)=Q(3) D OUT:'$D(Q3("DIVE")) G A2
"RTN","SRCUSS",22,0)
A1 I '$D(Q(11)) S Q(11)=-1 D:Q(5)="P" ID^SRCUSS1 K:Q(11)=-1!(Q(11)="") Q(11)
"RTN","SRCUSS",23,0)
 S Q(7)=$P(Q(6),";",1),Q(7)=$C(34)_Q(7)_$C(34),Q(7)=$S($D(@(Q(8,Q)_Q(9,Q)_","_Q(7)_")"))#2:$P(@("^("_Q(7)_")"),U,$P(Q(6),";",2)),1:"") D @Q(5):'$D(Q3("DIVE"))
"RTN","SRCUSS",24,0)
 K SHEMP F MOE=2:1:8 S PIECE=$P(Q(7),";",MOE) I PIECE?1U.E S SHEMP=1
"RTN","SRCUSS",25,0)
 I $D(SHEMP) S Q(7)=$P(Q(7),";")
"RTN","SRCUSS",26,0)
 K SHEMP,MOE,PIECE
"RTN","SRCUSS",27,0)
A2 Q:$D(Q(10,Q))  G A
"RTN","SRCUSS",28,0)
C D:+Q V X $P(Q(3),U,5,999) S Q(7)=X Q:'+Q  D D:Q(5)="D",OUT:Q(5)'="D" G A
"RTN","SRCUSS",29,0)
COM S Q7=$O(@("^DD("_+Q(0,Q)_","_Q7_")")) S:Q7'?1NP.NP!(Q7="") Q8=1 Q:Q8!(Q7=+Q(12,2))  S:$E($P(^(Q7,0),U,2),1)'="C" Q(12,0)=Q(12,0)_Q7_";" Q
"RTN","SRCUSS",30,0)
D G:Q(7)="" OUT S Q6=Q(7),Q(7)="" I $E(Q6,4,5)'="00" S Q(7)=$P("JAN^FEB^MAR^APR^MAY^JUN^JUL^AUG^SEP^OCT^NOV^DEC",U,$E(Q6,4,5))_" "
"RTN","SRCUSS",31,0)
 I $E(Q6,6,7)'="00" S Q(7)=Q(7)_$E(Q6,6,7)_", "
"RTN","SRCUSS",32,0)
 K Q7 S Q7=$P(Q6,".",2) S:$L(Q7)=1 Q7=Q7_"0" S:Q7 Q7=$E(Q7,1,2)_":"_$E(Q7,3,4) S Q7=$S($L(Q7)=3:Q7_"00",$L(Q7)=4:Q7_"0",1:Q7) I Q7="" K Q7
"RTN","SRCUSS",33,0)
 S Q6=Q6\10000+1700,Q(7)=Q(7)_Q6 S:$D(Q7) Q(7)=Q(7)_" AT "_Q7 G OUT
"RTN","SRCUSS",34,0)
DIE K Q D STOP^SRCUSS3 G:$D(Q("DIE")) DIED S %X="DR(",%Y="Q5(",Q5=DR D %XY^%RCR S Q=$O(DR(1,-1)) S:$E(DR,1,5)="S:DIA" (DR,DR(1,Q))=$P(DR,";",2,999) S @("Q6=$P("_DIE_DA_",0),U,1)"),Q6=DA_U_Q6
"RTN","SRCUSS",35,0)
 D 0 S:$D(Q5)#2 DR=Q5 I $D(Q5)>9 S %X="Q5(",%Y="DR(" D %XY^%RCR
"RTN","SRCUSS",36,0)
 K Q5 Q
"RTN","SRCUSS",37,0)
DIED ; K Q S SRCUSS("SRCUSS")="" D GO^DIE K SRCUSS Q
"RTN","SRCUSS",38,0)
 Q
"RTN","SRCUSS",39,0)
EN1 ;N
"RTN","SRCUSS",40,0)
 S Q7="Q1",Q6=Y G 1
"RTN","SRCUSS",41,0)
F G OUT
"RTN","SRCUSS",42,0)
N G OUT
"RTN","SRCUSS",43,0)
OUT ;
"RTN","SRCUSS",44,0)
 ; JAS - 3/18/14 - PATCH 177 - Added next line for display issues.
"RTN","SRCUSS",45,0)
 N SRDXHLD I $P(Q(3),U,2)["P80" S SRDXHLD=Q(7)
"RTN","SRCUSS",46,0)
 Q:$D(Q("BP"))  D:$D(Q("O")) XO:Q("O")["O" G:Q("ED")&('$D(Q(10))) OUTED^SRCUSS3
"RTN","SRCUSS",47,0)
 ; RBD/JAS - 3/11/14 - PATCH 177 - Code set labeling issue fixed
"RTN","SRCUSS",48,0)
 ;N SRICDV2 I $P(Q(3),U,2)["P80",$G(Q(7))'="" D
"RTN","SRCUSS",49,0)
 N SRICDV2 I $P(Q(3),U,2)["P80" D
"RTN","SRCUSS",50,0)
 . S SRICDV2=$$ICDSTR^SROICD(Q(8))
"RTN","SRCUSS",51,0)
 . I SRICDV2'=$G(SRICDV) S SRICDV=SRICDV2
"RTN","SRCUSS",52,0)
 ; End 177
"RTN","SRCUSS",53,0)
 W Q("HI"),!,Q(1,Q)-1,?5,Q("LO"),$P(Q(3),U,1),$S($P(Q(3),U,2)["P80":" "_$G(SRICDV),1:""),": ",?30 I $D(Q(11)) K:'$D(Q(10)) Q(11)
"RTN","SRCUSS",54,0)
 ; -- line below writes the value in the field
"RTN","SRCUSS",55,0)
 ; JAS - 3/11/14 - PATCH 177 - Add logic to display codeset versioning issues
"RTN","SRCUSS",56,0)
 I $P(Q(3),U,2)'["P80" W Q("HI"),?30,Q(7),Q("LO") Q
"RTN","SRCUSS",57,0)
 I Q(7)["Invalid"  W Q("HI"),?30,SRDXHLD," - ",Q(7) K SRDXHLD Q
"RTN","SRCUSS",58,0)
 W Q("HI"),?30,Q(7)
"RTN","SRCUSS",59,0)
 N SRDXOUT S SRDXOUT=$$OUT^SROICD(Q(7))
"RTN","SRCUSS",60,0)
 I SRDXOUT["Invalid" W " - "_SRDXOUT
"RTN","SRCUSS",61,0)
 K SRDXOUT,SRDXHLD
"RTN","SRCUSS",62,0)
 W Q("LO") Q
"RTN","SRCUSS",63,0)
 ; End 177
"RTN","SRCUSS",64,0)
P S Q8=Q(3) K:Q(7)="" Q(11) G:Q(7)="" OUT I $D(Q(11)),$D(@(U_$P(Q(3),U,3)_Q(7)_",0)")) S @("Q(7)=$P"_$P(Q(11),"$P",2)) G OUT
"RTN","SRCUSS",65,0)
P1 S Q7=U_$P(Q8,U,3),@("Q1=$D("_Q7_"Q("_7_")))"),Q(7)=$S(Q1:$P(^(Q(7),0),U,1),1:Q(7)),@("Q8=^DD("_+$P(@(Q7_"0)"),U,2)_",.01,0)") G P1:$P(Q8,U,2)["P"&(Q1),OUT
"RTN","SRCUSS",66,0)
S G:Q(7)="" OUT S Q7=$P(Q(3),U,3) F Q8=1:1 Q:Q(7)=$P($P(Q7,";",Q8),":",1)  Q:Q8=50
"RTN","SRCUSS",67,0)
 G:Q8=50 OUT S Q(7)=$P($P(Q7,";",Q8),":",2) G OUT
"RTN","SRCUSS",68,0)
V F Q(4)=0:1 Q:'$D(Q(9,Q(4)+1))  Q:'+Q(9,Q(4)+1)  S @("D"_Q(4)_"="_Q(9,Q(4)+1))
"RTN","SRCUSS",69,0)
 S DA=Q(9,Q) Q
"RTN","SRCUSS",70,0)
X X Q(2) G A
"RTN","SRCUSS",71,0)
 Q
"RTN","SRCUSS",72,0)
XO Q:Q(7)=""  D:+Q V S:$D(Y)#2 Q6(1)=Y S Y=Q(7) X @("^DD("_+Q(0,Q)_","_Q(2)_",2)") S Q(7)=Y S:$D(Q6(1)) Y=Q6(1) K Q6(1) Q
"RTN","SRCUSS1")
0^44^B23008051^B20239510
"RTN","SRCUSS1",1,0)
SRCUSS1 ;TAMPA/CFB - SCREEN SERVER ; [ 03/11/02  13:40 PM ]
"RTN","SRCUSS1",2,0)
 ;;3.0;Surgery;**14,31,48,66,108,177**;24 Jun 93;Build 89
"RTN","SRCUSS1",3,0)
B G BQ:Q(13)=2 Q:$D(Q("X"))  S DR="" W:'Q("ED") !! I Q(1)="Q" S Q(1)="" Q
"RTN","SRCUSS1",4,0)
 I '$D(Q(12,12)),Q(1,Q)=3,Q(7)["(MULTIPLE)" S Q7=1 G BP2
"RTN","SRCUSS1",5,0)
 I Q=1,$D(Q3("DIVE")) S Q7=$P(Q3("DIVE"),"P",2) K Q3("DIVE") G BP10
"RTN","SRCUSS1",6,0)
BP1 S DX=1,DY=22 X:Q("ED") Q("XY") I $D(Q3("VIEW")) S Q3("VIEW")=""
"RTN","SRCUSS1",7,0)
 K QPQPQ W "Enter Screen Server Function:  " R Q7:DTIME S:'$T Q7="^^" I Q7?.N S:$L(Q7)>2 Q7="?" S:Q7>15 Q7="?"
"RTN","SRCUSS1",8,0)
 S:Q7="a" Q7="A" S:$E(Q7)="p" Q7="P"_$E(Q7,2,99)
"RTN","SRCUSS1",9,0)
 S:$L(Q7)&("^-+123456789AP"'[$E(Q7)) Q7="?" S:$P(Q7,":",2)>15 Q7="?" S:Q7?.E1C.E Q7="?"
"RTN","SRCUSS1",10,0)
 I Q7[";" F Q8=2:1 S QQ=$P(Q7,";",Q8) S:"123456789"'[$E(QQ) Q7="?" Q:'QQ
"RTN","SRCUSS1",11,0)
 I Q7["?" D QUES G BP2
"RTN","SRCUSS1",12,0)
 K SRCUSS("OUT")
"RTN","SRCUSS1",13,0)
 I Q7'?.N1";".E,(Q7'?.N),(Q7'?.N1":".E),(Q7'="A"),("^^"'[Q7),(Q7'?1"+".N),(Q7'?1"-".N),(Q7'?1"P"1N.N) D QUES G BP2
"RTN","SRCUSS1",14,0)
 W Q("LO")
"RTN","SRCUSS1",15,0)
BP10 I Q7="A" S Q7="1:"_(Q(1,Q)-1)
"RTN","SRCUSS1",16,0)
 S:$S(Q7="^^":1,$E(Q7)'="L":0,+$E(Q7,2,99)<Q:1,1:0) Q(12,4)=$E(Q7,2,99) S Q(13)=1 G BQ:((Q7=""&('$D(Q0(Q,Q0(0,Q)+1))))!(Q7[U))
"RTN","SRCUSS1",17,0)
 I $E(Q7)="P",$L(Q7)>1,('+$E(Q7,2,99)!('$D(Q0(Q,+$E(Q7,2,99))))) D QUES G BP2
"RTN","SRCUSS1",18,0)
 I $E(Q7)="P",$L(Q7)>1,+$E(Q7,2,99) S Q0(0,Q)=$E(Q7,2,99),Q(1,Q)=1 X Q(0) G A^SRCUSS
"RTN","SRCUSS1",19,0)
 S:Q7="" Q7="+1" I $E(Q7,1)="+" S Q0(0,Q)=Q0(0,Q)+Q7,Q(1,Q)=1 G BQ:'$D(Q0(Q,Q0(0,Q))) X Q(0) G A^SRCUSS
"RTN","SRCUSS1",20,0)
 K Q(12,12) I $E(Q7,1)="-" S:Q7="-" Q7="-1" S Q0(0,Q)=$S(Q0(0,Q)+Q7<2:1,1:Q0(0,Q)+Q7),Q(1,Q)=1 X Q(0) G A^SRCUSS
"RTN","SRCUSS1",21,0)
BP2 S (Q2(Q),DR)="" F Q8=1:1 S Q6=$P(Q7,";",Q8) D:Q6[":" BCOM Q:Q6=""!(Q6'=+Q6)  I $P(Q0(Q,Q0(0,Q)),";",Q6+1)'="" D BM
"RTN","SRCUSS1",22,0)
 S:$D(Q("S",Q,Q0(0,Q),Q(1,Q))) DIC("S")=Q("S",Q,Q0(0,Q),Q(1,Q)) D CNG K DIC("S") S @("Q(7)=$D("_Q(8,Q)_Q(9,Q)_",0))") I 'Q(7) G BQ
"RTN","SRCUSS1",23,0)
 I Q2(Q)="",Q("ED") X ^TMP("SRCUSS",$J,^TMP("SRCUSS",$J,0),1),^(2) W !,Q("EPE") G B
"RTN","SRCUSS1",24,0)
 S QPQPQ=1,Q(1,Q)=1 F EMILY=1:1 S Q2(Q,1)=+$P(Q2(Q),U,1),Q2(Q)=$P(Q2(Q),U,2,99) Q:Q2(Q,1)<1  S Q(3)=Q(2,Q,Q2(Q,1)) D M^SRCUSS0 S Q(1,Q)=1
"RTN","SRCUSS1",25,0)
 X:$S('$D(Q(12,4)):1,+Q(12,4)=Q:1,1:0) Q(0) G A^SRCUSS
"RTN","SRCUSS1",26,0)
BCOM S Q(12,2)=+$P(Q6,":",2),Q6=+Q6,Q(12,1)=0 Q:Q(12,2)'>Q6  F Q(12,0)=Q6:1:Q(12,2) S Q7=$S(Q(12,1)+Q8>1:$P(Q7,";",1,Q8+Q(12,1)-1)_";",1:"")_Q(12,0)_";"_$P(Q7,";",Q(12,1)+Q8+$S(Q(12,1)=0:1,1:0),99) S Q(12,1)=Q(12,1)+1
"RTN","SRCUSS1",27,0)
 Q
"RTN","SRCUSS1",28,0)
BM I $D(Q(2,Q,Q6)),$P(@("^DD("_+$P(Q(2,Q,Q6),U,2)_",.01,0)"),U,2)'["W" S Q2(Q)=Q2(Q)_Q6_U Q
"RTN","SRCUSS1",29,0)
 I $D(Q(2,Q,Q6)),$P(@("^DD("_+$P(Q(2,Q,Q6),U,2)_",.01,0)"),U,2)["W",$D(Q3("VIEW")) S Q3("VIEW")=Q3("VIEW")_$P($P(Q(2,Q,Q6),U,4),";",1)_";"
"RTN","SRCUSS1",30,0)
 S DR=DR_$P(Q0(Q,Q0(0,Q)),";",Q6+1)_";Q;" Q
"RTN","SRCUSS1",31,0)
BQ W:Q=1 @IOF W:$D(Q("NOR")) Q("NOR") K:$D(Q0(0,Q)) Q("S",Q,Q0(0,Q)) K:Q=1 Q,Q0,Q1,DE,DP,DQ,Q2,Q3,Q4,Q5,Q6,Q7,Q8,QQ,QQQ,DX,DY,SRCUSS K ^TMP("SRCUSS",$J) Q  ;WITH NEW K:Q=1  Q
"RTN","SRCUSS1",32,0)
CNG W Q("HI") S (DIE,DIC)=Q(8,Q),DA=Q(9,Q) I $D(Q3("VIEW")) Q:Q3("VIEW")=""  S DR=Q3("VIEW") D EN^DIQ R !!,"Press <RET> to continue  ",Q8:DTIME Q
"RTN","SRCUSS1",33,0)
 I $D(Q("S",Q,"IX")) D IX Q
"RTN","SRCUSS1",34,0)
 I 'Q("ED") D SET,ICD
"RTN","SRCUSS1",35,0)
 I 'Q("ED") D ^DIE S SRCUSS("OUT")=1 D RET Q
"RTN","SRCUSS1",36,0)
 G ^SRCUSS2
"RTN","SRCUSS1",37,0)
ID Q:'$D(^DD(+Q(4)))  Q:('(+Q(4)\1=80!(+Q(4)=45.3)))&'($P(^DD(+Q(4),.01,0),U,2)["N"&($D(^DD(+Q(4),0,"ID"))))  S Q(11)=$O(@("^DD("_$S(+Q(4)'="":+Q(4),1:+Q(0,Q))_",0,""ID"","_Q(11)_")")) Q:Q(11)=""  I ^(Q(11))["^(""0"")" S Q(11)=^(Q(11)) Q
"RTN","SRCUSS1",38,0)
 G ID
"RTN","SRCUSS1",39,0)
IX X Q("S",Q,"IX") Q:Q6<1  S DR=".01///"_$P(Q6,U,2) D ^DIE,SET Q
"RTN","SRCUSS1",40,0)
SET S QQ=$S(Q>1:Q-1,1:1) F Q8=1:1:QQ S QQQ=$S(Q>1:Q-Q8,1:1),DA(Q8)=Q(9,QQQ)
"RTN","SRCUSS1",41,0)
 Q
"RTN","SRCUSS1",42,0)
QUES ;
"RTN","SRCUSS1",43,0)
 W:'$D(Q3("VIEW")) !,"To change entries, enter your choices (numbers) separated by a ';', or use",!,"a ':' for ranges.  i.e. 2;3 or 1:3.  Enter 'A' to enter/edit all.",!
"RTN","SRCUSS1",44,0)
 W !,"If there is more than one page to this screen, entering '+' or '-' followed",!,"by the number of pages or entering 'P' followed by the page number will",!,"take you to the desired page."
"RTN","SRCUSS1",45,0)
 W !!,"Enter '^' to quit, or '^^' to return to the menu options."
"RTN","SRCUSS1",46,0)
 R !!,"Press <RET> to continue  ",Q("QUESTION"):DTIME I Q("QUESTION")["?" W !!,"Forget it." H 2
"RTN","SRCUSS1",47,0)
 S Q7="?" Q
"RTN","SRCUSS1",48,0)
RET ; pause for display
"RTN","SRCUSS1",49,0)
 I ($D(DR(1,130))&($E(DR,$L(DR)-6,$L(DR)-4)="27T"))!($D(DR(1,130.16))&($E(DR,$L(DR)-5,$L(DR)-4)="3T")) W Q("NOR"),!!,"Press <RET> to continue  " R Q8:DTIME
"RTN","SRCUSS1",50,0)
 Q
"RTN","SRCUSS1",51,0)
ICD I $G(DIE)["^SRF(" D
"RTN","SRCUSS1",52,0)
 . N SRALAN,SRALAN1,SRALAN2
"RTN","SRCUSS1",53,0)
 .I DIE'="^SRF(",$G(DR) I $P($G(^DD(+Q("0","2"),+DR,0)),U,2)["P80" S DR=+DR_$G(^DD(+Q("0","2"),+DR,.1))_" "_$G(SRICDV)_";Q;"
"RTN","SRCUSS1",54,0)
 . I DIE="^SRF(",$G(DR) F SRALAN=1:2 S SRALAN1=$P(DR,";",SRALAN,SRALAN+1) Q:SRALAN1=""  D
"RTN","SRCUSS1",55,0)
 .. I $P($G(^DD(130,+SRALAN1,0)),U,2)["P80" D
"RTN","SRCUSS1",56,0)
 ... S (SRALAN2,SRALAN2(1,130))=+SRALAN1_$G(^DD(130,+SRALAN1,.1))_" "_$G(SRICDV)_";Q"
"RTN","SRCUSS1",57,0)
 ... S $P(DR,";",SRALAN,SRALAN+1)=SRALAN2
"RTN","SRCUSS1",58,0)
 ... S $P(DR(1,130),";",SRALAN,SRALAN+1)=SRALAN2
"RTN","SRCUSS1",59,0)
 Q
"RTN","SRHLDW1")
0^1^B4699482^B4690924
"RTN","SRHLDW1",1,0)
SRHLDW1 ;B'HAM ISC/DLR - Surgery Interface Master File Update Menu for Files ; [ 06/11/98  6:17 AM ]
"RTN","SRHLDW1",2,0)
 ;;3.0;Surgery;**41,177**;24 Jun 93;Build 89
"RTN","SRHLDW1",3,0)
 ;
"RTN","SRHLDW1",4,0)
 N CNT,OUT,SRTYP
"RTN","SRHLDW1",5,0)
 ;Interface Files (1st 3 letter must be unique for the TMP global)
"RTN","SRHLDW1",6,0)
 S CNT(1)="CPT4^81"
"RTN","SRHLDW1",7,0)
 S CNT(2)="ICD^80"
"RTN","SRHLDW1",8,0)
 S CNT(3)="MEDICATION^50"
"RTN","SRHLDW1",9,0)
 S CNT(4)="MONITOR^133.4"
"RTN","SRHLDW1",10,0)
 S CNT(5)="PERSONNEL^200"
"RTN","SRHLDW1",11,0)
 S CNT(6)="REPLACEMENT FLUID^133.7"
"RTN","SRHLDW1",12,0)
 S CNT(7)="ANES SUPERVISE CODE^132.95"
"RTN","SRHLDW1",13,0)
 S CNT(8)="LOCATION^44"
"RTN","SRHLDW1",14,0)
 F  W @IOF S (OUT,SRTYP)=0 D HDR Q:$G(OUT)=1  D ASK
"RTN","SRHLDW1",15,0)
 W @IOF
"RTN","SRHLDW1",16,0)
END D KDIR Q
"RTN","SRHLDW1",17,0)
HDR ;header for the OBR Menu
"RTN","SRHLDW1",18,0)
 N HDR,SRX,C
"RTN","SRHLDW1",19,0)
 S HDR="Surgery Interface File Download Option" W ?((IOM-$L(HDR))/2),HDR,!!
"RTN","SRHLDW1",20,0)
 S SRX=0 F  S SRX=$O(CNT(SRX)) Q:'SRX  S C=$G(C)+1 W !,SRX,".  ",$P(CNT(SRX),"^")
"RTN","SRHLDW1",21,0)
 W ! D KDIR S DIR(0)="NO^1:"_C,DIR("A")="Enter file to Capture",DIR("?")="Enter the file's corresponding number" D ^DIR S:$D(DIRUT) OUT=1 I '$D(DIRUT) D KDIR S SRTYP=Y
"RTN","SRHLDW1",22,0)
 Q
"RTN","SRHLDW1",23,0)
ASK ;
"RTN","SRHLDW1",24,0)
 N G
"RTN","SRHLDW1",25,0)
 S DIR(0)="YO",DIR("B")="YES",DIR("A")="Update the "_$P(CNT(SRTYP),U)_" file",DIR("B")="YES" D ^DIR I $D(DIRUT)!(Y=0) S OUT=1 Q
"RTN","SRHLDW1",26,0)
 I $P(CNT(SRTYP),U)="CPT4" W !,"NOT AVAILABLE" Q
"RTN","SRHLDW1",27,0)
 W !,"Queuing message" S ZTDTH=$H,ZTIO="",ZTDESC=$P(CNT(SRTYP),U)_" Master File Update.",ZTRTN="ENQ^SRHLDW1"
"RTN","SRHLDW1",28,0)
 F G="SRTYP","CNT("_SRTYP_")" S:$D(@G) ZTSAVE(G)=""
"RTN","SRHLDW1",29,0)
 D ^%ZTLOAD
"RTN","SRHLDW1",30,0)
 Q
"RTN","SRHLDW1",31,0)
ENQ ;
"RTN","SRHLDW1",32,0)
 N FEC,REC,SRENT,SRTBL
"RTN","SRHLDW1",33,0)
 S SRENT="",FEC="REP",REC="MAD",SRTBL=CNT(SRTYP)
"RTN","SRHLDW1",34,0)
 ;cpt4,icd,medication,monitor,personnel,replacement fluid,anes super code,location
"RTN","SRHLDW1",35,0)
 D MSG^SRHLMFN(SRTBL,FEC,REC,SRENT)
"RTN","SRHLDW1",36,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","SRHLDW1",37,0)
 Q
"RTN","SRHLDW1",38,0)
KDIR ;kills all DIR variables
"RTN","SRHLDW1",39,0)
 K DIR,DIRUT,DUOUT,DTOUT,DIROUT
"RTN","SRHLDW1",40,0)
 Q
"RTN","SRHLUO")
0^13^B28555904^B25491414
"RTN","SRHLUO",1,0)
SRHLUO ;B'HAM ISC/DLR - Surgery Interface Utilities for building Outgoing HL7 Segment ; [ 05/06/98   7:14 AM ]
"RTN","SRHLUO",2,0)
 ;;3.0;Surgery;**41,127,177**;24 Jun 93;Build 89
"RTN","SRHLUO",3,0)
 ;
"RTN","SRHLUO",4,0)
 ; Reference to $$ICDDATA^ICDXCODE supported by DBIA #5699
"RTN","SRHLUO",5,0)
 ; 
"RTN","SRHLUO",6,0)
 ; ** ASSUMMED variable list
"RTN","SRHLUO",7,0)
 ; all - INIT^HLTRANS
"RTN","SRHLUO",8,0)
 ; DFN - IEN file #2
"RTN","SRHLUO",9,0)
 ; SRI - incremental variable ^TMP("HLS",$J,SRI) 
"RTN","SRHLUO",10,0)
 ;     - returns the next #
"RTN","SRHLUO",11,0)
 ; CASE- IEN (file 130) case number must be set before the call
"RTN","SRHLUO",12,0)
 ;
"RTN","SRHLUO",13,0)
AL1(SRI,SRENT) ;AL1 segment(s) - allergy information from the generic call to (GMRADPT)
"RTN","SRHLUO",14,0)
 Q:'$D(DFN)
"RTN","SRHLUO",15,0)
 S X="GMRADPT" X ^%ZOSF("TEST") Q:'$T
"RTN","SRHLUO",16,0)
 N TYPE,X,AL1,CNT
"RTN","SRHLUO",17,0)
 ;Allergy package valid entry point returns GMRAL(x)
"RTN","SRHLUO",18,0)
 D ^GMRADPT
"RTN","SRHLUO",19,0)
 S CNT=1
"RTN","SRHLUO",20,0)
 F X=0:0 S X=$O(GMRAL(X)) Q:X'>0  D
"RTN","SRHLUO",21,0)
 .S TYPE=$P(GMRAL(X),"^",3),AL1(X)="AL1"_HL("FS")_$E("0000",$L(CNT)+1,4)_CNT_HL("FS")_$S(TYPE="D":"DA",TYPE="F":"FA",TYPE="O":"MA",1:"")_HL("FS")_HLCOMP_$P(GMRAL(X),"^",2)
"RTN","SRHLUO",22,0)
 .S ^TMP(SRENT,$J,SRI)=AL1(X),SRI=SRI+1,CNT=CNT+1
"RTN","SRHLUO",23,0)
 K GMRAL
"RTN","SRHLUO",24,0)
 Q
"RTN","SRHLUO",25,0)
DG1(SRI,SRENT) ;DG1 segment(s) - surgery diagnosis information
"RTN","SRHLUO",26,0)
 Q:'$D(CASE)
"RTN","SRHLUO",27,0)
 N DG1,I9,SRS,X,X1
"RTN","SRHLUO",28,0)
 S SRS=$$ICDSYS^SROICD($P($G(^SRF(CASE,0)),"^",9))
"RTN","SRHLUO",29,0)
 ;
"RTN","SRHLUO",30,0)
 I $D(^SRF(CASE,34)) I $P(^SRF(CASE,34),U,2)'="" D  ; if#66 Planned Principal Diag Code exists
"RTN","SRHLUO",31,0)
 .S I9=$$ICD^SROICD(CASE,$P(^SRF(CASE,34),U,2))     ; get $$icddata
"RTN","SRHLUO",32,0)
 .S DG1="DG1"_HL("FS")_"0001"_HL("FS")_$S($G(SRS)="10D":"I0",$G(SRS)[9:"I9",1:"")_HL("FS")_$P(I9,U,2)_HL("FS")_$E($P(I9,U,4),1,40)_HL("FS")_HL("FS")_"P" D
"RTN","SRHLUO",33,0)
 ..S ^TMP("HLS",$J,SRI)=DG1,SRI=SRI+1,DG1=""
"RTN","SRHLUO",34,0)
 ;
"RTN","SRHLUO",35,0)
 I $D(^SRF(CASE,33)) I $P(^SRF(CASE,33),U)'="" S DG1="DG1"_HL("FS")_"0001"_HL("FS")_$S($G(SRS)="10D":"I0",$G(SRS)[9:"I9",1:"")_HL("FS")_HL("FS")_$P(^SRF(CASE,33),U)_HL("FS")_HL("FS")_"PR" D
"RTN","SRHLUO",36,0)
 .S ^TMP("HLS",$J,SRI)=DG1,SRI=SRI+1,DG1=""
"RTN","SRHLUO",37,0)
 I $D(^SRF(CASE,14,0)) S X1=2 F X=0:0 S X=$O(^SRF(CASE,14,X)) Q:X'>0  D
"RTN","SRHLUO",38,0)
 .I $P(^(0),U,3) S I9=$$ICDDATA^ICDXCODE("DIAG",$P(^SRF(CASE,14,0),U,3),$P($P($G(^SRF(CASE,0)),"^",9),".")) D
"RTN","SRHLUO",39,0)
 ..S ^TMP("HLS",$J,SRI)="DG1"_HL("FS")_$E("0000",$L(X1)+1,4)_X1_HL("FS")_$S(SRS="10D":"I0",SRS[9:"I9",1:"")_HL("FS")_$P(I9,U,2)_HL("FS")_$E($P(I9,U,4),1,40)_HL("FS")_HL("FS")_"PR",X1=X1+1,SRI=SRI+1
"RTN","SRHLUO",40,0)
 Q
"RTN","SRHLUO",41,0)
ERR(SRI,SRERR)     ;ERR segment
"RTN","SRHLUO",42,0)
 ; SRERR = AE error code and location (segment^sequence #^field^error) 
"RTN","SRHLUO",43,0)
 S ^TMP("HLA",$J,SRI)="ERR"_HL("FS")_$G(SRERR(1))_HLCOMP_$G(SRERR(2))_HLCOMP_$G(SRERR),SRI=SRI+1
"RTN","SRHLUO",44,0)
 Q
"RTN","SRHLUO",45,0)
MSA(SRI,SRAC) ;MSA segment
"RTN","SRHLUO",46,0)
 ; SRAC = Acknowledgement code (ID)
"RTN","SRHLUO",47,0)
 ;  AA = Application Accepted (responsed with information)
"RTN","SRHLUO",48,0)
 ;  AE = Application Error (bad data send error response)
"RTN","SRHLUO",49,0)
 ;  AR = Application Reject (no data in date range ... )
"RTN","SRHLUO",50,0)
 ;
"RTN","SRHLUO",51,0)
 N MSA
"RTN","SRHLUO",52,0)
 S MSA(1)=$G(SRAC),MSA(2)=$G(HL("MID")),MSA(3)=$G(SRERR)
"RTN","SRHLUO",53,0)
 S ^TMP("HLA",$J,SRI)="MSA"_HL("FS") F XX=1:1:3 S ^TMP("HLA",$J,SRI)=$G(^TMP("HLA",$J,SRI))_$G(MSA(XX))_$S(XX=3:"",1:HL("FS"))
"RTN","SRHLUO",54,0)
 S SRI=SRI+1
"RTN","SRHLUO",55,0)
 Q
"RTN","SRHLUO",56,0)
OBX(SRI,SRENT) ;OBX segment(s)
"RTN","SRHLUO",57,0)
 ; This segment builds OBX segments for the following Preoperative data
"RTN","SRHLUO",58,0)
 ;  - vitals\measurements ^GMRVUTL routine:   
"RTN","SRHLUO",59,0)
 ;     height, weight, blood pressure, pulse rate, and temperature
"RTN","SRHLUO",60,0)
 ;  - IN\OUT-PATIENT STATUS field in File #130
"RTN","SRHLUO",61,0)
 ;  - CANCEL DATE and CANCEL REASON for cancelled and aborted cases
"RTN","SRHLUO",62,0)
 ;  - SURGICAL SPECIALTY (OR) or MEDICAL SPECIALTY (NON OR)
"RTN","SRHLUO",63,0)
 ;  - SURGEON PGY and ANES SUPERVISE CODE
"RTN","SRHLUO",64,0)
 Q:'$D(CASE)
"RTN","SRHLUO",65,0)
 N OBX,CNT,TYPE,X,Y
"RTN","SRHLUO",66,0)
 S CNT=1
"RTN","SRHLUO",67,0)
 I $D(^SRF(CASE,"NON")) S OBX(2)="CE",OBX(3)=HLCOMP_"MEDICAL SPECIALTY"_HLCOMP,OBX(5)=$P(^("NON"),U,8) I OBX(5)'="" S OBX(5)=HLCOMP_$P(^ECC(723,OBX(5),0),U)_HLCOMP_"99VA723" D SOBX
"RTN","SRHLUO",68,0)
 I $P(^SRF(CASE,0),U,4)'="" S OBX(2)="CE",OBX(3)=HLCOMP_"SURGICAL SPECIALTY"_HLCOMP,OBX(5)=$P(^(0),U,4) I OBX(5)'="" S OBX(5)=HLCOMP_$P(^SRO(137.45,OBX(5),0),U)_HLCOMP_"99VA137.45" D SOBX
"RTN","SRHLUO",69,0)
 I $D(^SRF(CASE,200)) I $P(^SRF(CASE,200),U,52)'="" S OBX(2)="NM",OBX(3)=HLCOMP_"SURGEON PGY"_HLCOMP_"L",OBX(5)=$P(^(200),U,52) D SOBX
"RTN","SRHLUO",70,0)
 I $D(^SRF(CASE,.3)) I $P(^SRF(CASE,.3),U,6)'="" S OBX(2)="CE",OBX(3)=HLCOMP_"ANES SUPERVISE CODE"_HLCOMP_"L",OBX(5)=$P(^(.3),U,6) D SOBX
"RTN","SRHLUO",71,0)
 I $P(^SRF(CASE,0),U,12)'="" S OBX(2)="CE",OBX(3)=HLCOMP_"PATIENT CLASS"_HLCOMP,OBX(5)=$P(^(0),U,12) S C=$P(^DD(130,.011,0),U,2),Y=OBX(5) D Y^DIQ S OBX(5)=HLCOMP_Y_HLCOMP_"L" D SOBX
"RTN","SRHLUO",72,0)
 S X="GMRVUTL" X ^%ZOSF("TEST") I $T F TYPE="BP","HT","WT","T","P" S GMRVSTR=TYPE D EN6^GMRVUTL I $G(X)'="" S X1=$P(X,"^"),X2=60,SRX=X D C^%DTC I X'<DT D
"RTN","SRHLUO",73,0)
 .S OBX(2)="CE",OBX(5)=$P(SRX,"^",8),OBX(11)="S",OBX(14)=$$HLDATE^HLFNC($P(SRX,"^")),OBX(16)=$$HNAME^SRHLU($P(SRX,U,6))
"RTN","SRHLUO",74,0)
 .I TYPE="BP" S OBX(3)="1002"_HLCOMP_"BP",OBX(5)=$P(SRX,"^",8) D SOBX
"RTN","SRHLUO",75,0)
 .I TYPE="HT" S OBX(3)="1010.3"_HLCOMP_"Height",OBX(5)=$J(2.54*OBX(5),0,2),OBX(6)="cm" D SOBX
"RTN","SRHLUO",76,0)
 .I TYPE="WT" S OBX(3)="1010.1"_HLCOMP_"Body Weight",OBX(5)=$J(OBX(5)/2.2,0,2),OBX(6)="kg" D SOBX
"RTN","SRHLUO",77,0)
 .I TYPE="T" S OBX(3)="1000"_HLCOMP_"Temperature" S OBX(5)=$J(OBX(5)-32*5/9,0,2),OBX(6)="cel" D SOBX
"RTN","SRHLUO",78,0)
 .I TYPE="P" S OBX(3)="1006.2"_HLCOMP_"HR",OBX(6)="min" D SOBX
"RTN","SRHLUO",79,0)
 I $D(^SRF(CASE,30)),$P($G(^SRF(CASE,31)),U,8)'="" D
"RTN","SRHLUO",80,0)
 .S OBX(2)="CE",OBX(3)=HLCOMP_"CANCEL REASON"_HLCOMP_"L",OBX(5)=HLCOMP_$P(^SRO(135,$P(^SRF(CASE,31),U,8),0),U)_HLCOMP_"L",OBX(14)=$$HLDATE^HLFNC($P(^SRF(CASE,30),U)),OBX(16)=$$HNAME^SRHLU($P(^SRF(CASE,30),U,3)) D SOBX
"RTN","SRHLUO",81,0)
 Q
"RTN","SRHLUO",82,0)
SOBX ;sets the OBX segment
"RTN","SRHLUO",83,0)
 S OBX(11)="S"
"RTN","SRHLUO",84,0)
 S OBX(1)=CNT
"RTN","SRHLUO",85,0)
 S ^TMP(SRENT,$J,SRI)="OBX"_HL("FS") F XX=1:1:16 S ^TMP(SRENT,$J,SRI)=$G(^TMP(SRENT,$J,SRI))_$G(OBX(XX))_$S(XX=16:"",1:HL("FS")),OBX(XX)=""
"RTN","SRHLUO",86,0)
 S SRI=SRI+1,CNT=$G(CNT)+1
"RTN","SRHLUO",87,0)
 Q
"RTN","SRHLUO",88,0)
PID(SRI,SRENT) ;PID segment builder returns patient information
"RTN","SRHLUO",89,0)
 Q:'$D(DFN)
"RTN","SRHLUO",90,0)
 N PID
"RTN","SRHLUO",91,0)
 S ^TMP(SRENT,$J,SRI)=$$EN^VAFHLPID(DFN,"1,2,3,4,5,6,7,8,10,11,13,16,17,19",1)
"RTN","SRHLUO",92,0)
 S SRI=SRI+1
"RTN","SRHLUO",93,0)
 Q
"RTN","SRHLUO3")
0^14^B31162986^B25089400
"RTN","SRHLUO3",1,0)
SRHLUO3 ;BIR/DLR - Surgery Interface (Cont.) Utilities for building Outgoing HL7 Segments ; [ 05/20/99   7:14 AM ]
"RTN","SRHLUO3",2,0)
 ;;3.0;Surgery;**41,88,127,151,177**;24 Jun 93;Build 89
"RTN","SRHLUO3",3,0)
 ;
"RTN","SRHLUO3",4,0)
 ; Reference to ^PSS50 supported by DBIA #4533
"RTN","SRHLUO3",5,0)
 ; Reference to $$OBA^ICDEX supported by DBIA #5747
"RTN","SRHLUO3",6,0)
 ; Reference to $$CODEABA^ICDEX supported by DBIA #5747
"RTN","SRHLUO3",7,0)
 ; Reference to $$ICDDATA^ICDXCODE supported by DBIA #5699
"RTN","SRHLUO3",8,0)
 ; Reference to $$IMPDATE^LEXU supported by DBIA #5679
"RTN","SRHLUO3",9,0)
 ; 
"RTN","SRHLUO3",10,0)
 ;
"RTN","SRHLUO3",11,0)
 ;INIT^HLTRANS MUST BE called before calling this routine.
"RTN","SRHLUO3",12,0)
 ;Mandatory variables
"RTN","SRHLUO3",13,0)
 ;I    - IEN of the entry to be processed
"RTN","SRHLUO3",14,0)
 ;SRI  - next available number in ^TMP(SRENT... global
"RTN","SRHLUO3",15,0)
MFE(SRI,REC,FILE,FIELD,SRENT) ;Master File Entry segment
"RTN","SRHLUO3",16,0)
 N I,ID,SRCODE,SRORDER,SRX,SRY,X,SRRX,SRSYS
"RTN","SRHLUO3",17,0)
 ;event point processing
"RTN","SRHLUO3",18,0)
 I $G(SRENT)'="" S I=$P(SRENT,U),ID=$P(SRENT,U,2) D SMFE
"RTN","SRHLUO3",19,0)
 ;set of codes
"RTN","SRHLUO3",20,0)
 I $G(SRENT)="",$G(FIELD)'="" S Y="",C=$P(^DD(FILE,FIELD,0),U,2) D Y^DIQ F X=2:1:$L(C,";")-1 S I=X-1,ID=$P($P(C,";",X),":",2) D SMFE
"RTN","SRHLUO3",21,0)
 ;files
"RTN","SRHLUO3",22,0)
 I $G(SRENT)="",$G(FIELD)="" D
"RTN","SRHLUO3",23,0)
 .I FILE=50 S SDT=$$FMADD^XLFDT(DT,-366) F  S SDT=$O(^SRF("AC",SDT)) Q:'SDT!(SDT>DT)  S XIEN=0 F  S XIEN=$O(^SRF("AC",SDT,XIEN)) Q:'XIEN  D
"RTN","SRHLUO3",24,0)
 ..I $D(^SRF(XIEN,22,0)) S X2=0 F  S X2=$O(^SRF(XIEN,22,X2)) Q:'X2  I $D(^(X2,0)) S I=$P(^(0),U) D DATA^PSS50(I,,,,,"SRRX") S ^TMP("SRHL",$J,"MED",I)=HLCOMP_$P($G(^TMP($J,"SRRX",I,.01)),"^")_HLCOMP
"RTN","SRHLUO3",25,0)
 ..K ^TMP($J,"SRRX",I)
"RTN","SRHLUO3",26,0)
 ..S X2=0 F  S X2=$O(^TMP("SRHL",$J,"MED",X2)) Q:'X2  S ID=^(X2) D SMFE,ZRX
"RTN","SRHLUO3",27,0)
 ..K ^TMP("SRHL",$J,"MED")
"RTN","SRHLUO3",28,0)
 .I FILE=44 S I=0 F  S I=$O(^SC(I)) Q:'I  S ID=$P(^(I,0),U)_HLCOMP_HLCOMP D SMFE
"RTN","SRHLUO3",29,0)
 .I FILE=80 F SRSYS=1,30 S SRORDER="" F  S SRORDER=$$OBA^ICDEX(80,SRORDER,+SRSYS) Q:'$L(SRORDER)  D
"RTN","SRHLUO3",30,0)
 ..S SRCODE=$TR(SRORDER," ",""),I=$$CODEABA^ICDEX(SRCODE,FILE,SRSYS) S ID=SRCODE_HLCOMP_HLCOMP D SMFE,@$S(SRSYS=1:"ZI9",1:"ZI0")
"RTN","SRHLUO3",31,0)
 .I FILE=81 S I=0 F  S I=$O(^ICPT("B",I)) Q:I=""  S ID=I_HLCOMP_HLCOMP D SMFE,ZC4
"RTN","SRHLUO3",32,0)
 .I FILE=133.4 S I=0 F  S I=$O(^SRO(133.4,I)) Q:'I  S ID=HLCOMP_$P(^(I,0),U)_HLCOMP D SMFE,ZMN
"RTN","SRHLUO3",33,0)
 .I FILE=133.7 S I=0 F  S I=$O(^SRO(133.7,I)) Q:'I  S ID=HLCOMP_$P(^(I,0),U)_HLCOMP D SMFE,ZRF
"RTN","SRHLUO3",34,0)
 .I FILE=200 S SDT=$$FMADD^XLFDT(DT,-366) F  S SDT=$O(^SRF("AC",SDT)) Q:'SDT!(SDT>DT)  S XIEN=0 F  S XIEN=$O(^SRF("AC",SDT,XIEN)) Q:'XIEN  D
"RTN","SRHLUO3",35,0)
 ..;4-surgeon,5-first asst.,6-second asst.,13-attend surgeon
"RTN","SRHLUO3",36,0)
 ..I $D(^SRF(XIEN,.1)) F XF=4,5,6,13 S I=$P(^SRF(XIEN,.1),U,XF),ROLE=$S(XF=4:"SURGEON",XF=5:"1ST ASST.",XF=6:"2ND ASST.",XF=13:"ATT. SURGEON") D:I'="" XPER
"RTN","SRHLUO3",37,0)
 ..;1-prin. anes.,2-relief anes.,3-asst. anes.,4-anes. super.
"RTN","SRHLUO3",38,0)
 ..I $D(^SRF(XIEN,.3)) F XF=1,2,3,4 S I=$P(^SRF(XIEN,.3),U,XF),ROLE=$S(XF=1:"PRIN. ANES.",XF=2:"RELIEF ANESTHETIST",XF=3:"ASSISTANT ANESTHETIST",XF=4:"ANES. SUPER.") D:I'="" XPER
"RTN","SRHLUO3",39,0)
 ..;tourniquet applied by
"RTN","SRHLUO3",40,0)
 ..I $D(^SRF(XIEN,2,0)) S X2=0 F  S X2=$O(^SRF(XIEN,2,X2)) Q:'X2  S I=$P(^(X2,0),U,3),ROLE="TOURNIQUET APPLIED BY" D:I'="" XPER
"RTN","SRHLUO3",41,0)
 ..;monitor applied by
"RTN","SRHLUO3",42,0)
 ..I $D(^SRF(XIEN,27,0)) S X2=0 F  S X2=$O(^SRF(XIEN,27,X2)) Q:'X2  S I=$P(^(X2,0),U,4),ROLE="MONITOR APPLIED BY" D:I'="" XPER
"RTN","SRHLUO3",43,0)
 ..;extubated by
"RTN","SRHLUO3",44,0)
 ..I $D(^SRF(XIEN,6,0)) S X2=0 F  S X2=$O(^SRF(XIEN,6,X2)) Q:'X2  I $D(^(X2,6)) S I=$P(^(6),U),ROLE="EXTUBATED BY" D:I'="" XPER
"RTN","SRHLUO3",45,0)
 ..;medications administered by, ordered by
"RTN","SRHLUO3",46,0)
 ..I $D(^SRF(XIEN,22,0)) S X2=0 F  S X2=$O(^SRF(XIEN,22,X2)) Q:'X2  I $D(^(X2,0)) F XF=3,4 S I=$P(^(0),U,XF),ROLE=$S(XF=3:"MEDICATION ORDERED BY",XF=4:"MEDICATION ADM BY") D:I'="" XPER
"RTN","SRHLUO3",47,0)
 .S I=0 F  S I=$O(^TMP("SRHL",$J,"PER",I)) Q:'I  S ID=^(I) D SMFE,STF
"RTN","SRHLUO3",48,0)
 .K ^TMP("SRHL",$J,"PER")
"RTN","SRHLUO3",49,0)
 Q
"RTN","SRHLUO3",50,0)
SMFE ;
"RTN","SRHLUO3",51,0)
 S ^TMP("HLS",$J,SRI)="MFE"_HL("FS")_REC_HL("FS")_I_HL("FS")_$E(DT,1,8)_HL("FS")_ID,SRI=SRI+1
"RTN","SRHLUO3",52,0)
 Q
"RTN","SRHLUO3",53,0)
MFI(SRI,ID,FEC,FILE,SRENT) ;Master File Identification segment
"RTN","SRHLUO3",54,0)
 N SRY
"RTN","SRHLUO3",55,0)
 I '$D(ID)!'$D(FEC) W !!,"Invalid Master File Identifier or Event Code.",!! Q
"RTN","SRHLUO3",56,0)
 ;S SRY=$$IMPDATE^SROICD("10D"),SRY=$S(DT'<IMPDATE:"10",1:"9")
"RTN","SRHLUO3",57,0)
 S SRY=$$IMPDATE^SROICD("10D"),SRY=$S(DT'<SRY:"10",1:"9")
"RTN","SRHLUO3",58,0)
 S ^TMP("HLS",$J,SRI)="MFI"_HL("FS")_HLCOMP_ID_HLCOMP_$S(FILE=80:$S(SRY=9:"I9",SRY=10:"I0",1:""),FILE=81:"C4",$E(FILE,1,3)'=130:"99VA"_FILE,1:"L")_HL("FS")_HL("FS")_FEC_HL("FS")_HL("FS")_HL("FS")_"AL",SRI=SRI+1
"RTN","SRHLUO3",59,0)
 Q
"RTN","SRHLUO3",60,0)
STF ;staff master file
"RTN","SRHLUO3",61,0)
 S ^TMP("HLS",$J,SRI)="STF"_HL("FS")_$P($G(^VA(200,I,1)),U,9)_HLCOMP_HLCOMP_HL("FS")_HL("FS")_$P($$HNAME^SRHLU(I),HLCOMP,2,3),SRI=SRI+1
"RTN","SRHLUO3",62,0)
 Q
"RTN","SRHLUO3",63,0)
ZI9 ;master file update to ICD-9 (File #80)
"RTN","SRHLUO3",64,0)
 S SRY=$$ICDDATA^ICDXCODE("DIAG",SRCODE,$$IMPDATE^LEXU("10D")-1),^TMP("HLS",$J,SRI)="ZI9"_HL("FS")_$P(SRY,U,2)_HLCOMP_$E($P(SRY,U,4),1,30)_HLCOMP_HL("FS")_$S($P(SRY,U,10)'="":$P(SRY,U,10),1:0),SRI=SRI+1
"RTN","SRHLUO3",65,0)
 Q
"RTN","SRHLUO3",66,0)
ZI0 ;master file update to ICD-10 (File #80)
"RTN","SRHLUO3",67,0)
 S SRY=$$ICDDATA^ICDXCODE("DIAG",SRCODE,$$IMPDATE^LEXU("10D")+1),^TMP("HLS",$J,SRI)="ZI0"_HL("FS")_$P(SRY,U,2)_HLCOMP_$E($P(SRY,U,4),1,30)_HLCOMP_HL("FS")_$S($P(SRY,U,10)'="":$P(SRY,U,10),1:0),SRI=SRI+1
"RTN","SRHLUO3",68,0)
 Q
"RTN","SRHLUO3",69,0)
ZC4 ;master file update to CPT-4 (File #81)
"RTN","SRHLUO3",70,0)
 S SRX=$$CPT^ICPTCOD(I),^TMP("HLS",$J,SRI)="ZC4"_HL("FS")_$P(SRX,U,2)_HLCOMP_$P(SRX,U,3)_HLCOMP_HL("FS")_$S($P(SRX,U,7)'="":$P(SRX,U,7),1:0),SRI=SRI+1
"RTN","SRHLUO3",71,0)
 Q
"RTN","SRHLUO3",72,0)
ZRX ;master file update to MEDICATION (File #50)
"RTN","SRHLUO3",73,0)
 D DATA^PSS50(I,,,,,"SRRX") S ^TMP("HLS",$J,SRI)="ZRX"_HL("FS")_HLCOMP_$P($G(^TMP($J,"SRRX",I,.01)),"^")_HLCOMP_HL("FS")_$P($G(^("I")),U)_HL("FS")_$S($P($G(^(2)),U,3)["S":1,1:0),SRI=SRI+1
"RTN","SRHLUO3",74,0)
 K ^TMP($J,"SRRX",I)
"RTN","SRHLUO3",75,0)
 Q
"RTN","SRHLUO3",76,0)
ZMN ;master file update to MONITOR (File #133.2)
"RTN","SRHLUO3",77,0)
 S ^TMP("HLS",$J,SRI)="ZMN"_HL("FS")_HLCOMP_$P(^SRO(133.4,I,0),U)_HLCOMP_HL("FS")_$S($P(^(0),U,2)'="":$P(^(0),U,2),1:0),SRI=SRI+1
"RTN","SRHLUO3",78,0)
 Q
"RTN","SRHLUO3",79,0)
ZRF ;master file update to REPLACEMENT FLUIDS (File #133.7)
"RTN","SRHLUO3",80,0)
 S ^TMP("HLS",$J,SRI)="ZRF"_HL("FS")_HLCOMP_$P(^SRO(133.7,I,0),U)_HLCOMP_HL("FS")_$S($P(^(0),U,2)'="":$P(^(0),U,2),1:0),SRI=SRI+1
"RTN","SRHLUO3",81,0)
 Q
"RTN","SRHLUO3",82,0)
 ;cpt4,icd9,medication,monitor,personnel,replacement fluid
"RTN","SRHLUO3",83,0)
 I SRTYP'=3,(SRTYP'=5) D MSG^SRHLMFN(SRTBL,FEC,REC,SRENT)
"RTN","SRHLUO3",84,0)
 Q
"RTN","SRHLUO3",85,0)
XPER ;personnel information extract (SSN) from file 200
"RTN","SRHLUO3",86,0)
 S ^TMP("SRHL",$J,"PER",I)=$$HNAME^SRHLU(I)_"^"_ROLE
"RTN","SRHLUO3",87,0)
 Q
"RTN","SRHLVUO")
0^15^B24970128^B24398625
"RTN","SRHLVUO",1,0)
SRHLVUO ;B'HAM ISC/DLR - Surgery Interface Utilities for building Outgoing HL7 Segment ; [ 05/06/98   7:14 AM ]
"RTN","SRHLVUO",2,0)
 ;;3.0;Surgery;**41,127,177**;24 Jun 93;Build 89
"RTN","SRHLVUO",3,0)
 ;
"RTN","SRHLVUO",4,0)
 ; ** ASSUMMED variable list
"RTN","SRHLVUO",5,0)
 ; all - INIT^HLTRANS
"RTN","SRHLVUO",6,0)
 ; DFN - IEN file #2
"RTN","SRHLVUO",7,0)
 ; SRI - incremental variable ^TMP("HLS",$J,HLSDT,SRI) 
"RTN","SRHLVUO",8,0)
 ;     - returns the next #
"RTN","SRHLVUO",9,0)
 ; CASE- IEN (file 130) case number must be set before the call
"RTN","SRHLVUO",10,0)
 ;
"RTN","SRHLVUO",11,0)
AL1(SRI) ;AL1 segment(s) builder returns allergy information from the generic call to (GMRADPT)
"RTN","SRHLVUO",12,0)
 Q:'$D(DFN)
"RTN","SRHLVUO",13,0)
 S X="GMRADPT" X ^%ZOSF("TEST") Q:'$T
"RTN","SRHLVUO",14,0)
 N TYPE,X,AL1,CNT
"RTN","SRHLVUO",15,0)
 ;Allergy package valid entry point returns GMRAL(x)
"RTN","SRHLVUO",16,0)
 D ^GMRADPT
"RTN","SRHLVUO",17,0)
 S CNT=1
"RTN","SRHLVUO",18,0)
 F X=0:0 S X=$O(GMRAL(X)) Q:X'>0  D
"RTN","SRHLVUO",19,0)
 .S TYPE=$P(GMRAL(X),"^",3),AL1(X)="AL1"_HLFS_$E("0000",$L(CNT)+1,4)_CNT_HLFS_$S(TYPE="D":"DA",TYPE="F":"FA",TYPE="O":"MA",1:"")_HLFS_HLCOMP_$P(GMRAL(X),"^",2)
"RTN","SRHLVUO",20,0)
 .S ^TMP("HLS",$J,HLSDT,SRI)=AL1(X),SRI=SRI+1,CNT=CNT+1
"RTN","SRHLVUO",21,0)
 K GMRAL
"RTN","SRHLVUO",22,0)
 Q
"RTN","SRHLVUO",23,0)
DG1(SRI) ;DG1 segment(s) builder returns surgery diagnosis information
"RTN","SRHLVUO",24,0)
 Q:'$D(CASE)
"RTN","SRHLVUO",25,0)
 N DG1,I9,X,X1,SRSYS
"RTN","SRHLVUO",26,0)
 I $D(^SRF(CASE,34)),$P(^SRF(CASE,34),U,2) D
"RTN","SRHLVUO",27,0)
 .S SRSYS=$$ICDSYS^SROICD($P(^SRF(CASE,0),"^",9)),I9=$$ICD^SROICD(CASE,$P(^SRF(CASE,34),U,2))
"RTN","SRHLVUO",28,0)
 .S DG1="DG1"_HLFS_"0001"_HLFS_$S(SRSYS["9":"I9",1:"I0")_HLFS_$P(I9,U,2)_HLFS_$E($P(I9,U,4),1,40)_HLFS_HLFS_"P" D
"RTN","SRHLVUO",29,0)
 ..S ^TMP("HLS",$J,HLSDT,SRI)=DG1,SRI=SRI+1,DG1=""
"RTN","SRHLVUO",30,0)
 ..I $D(^SRF(CASE,14,0)) S X1=2 F X=0:0 S X=$O(^SRF(CASE,14,X)) Q:X'>0  D
"RTN","SRHLVUO",31,0)
 ...I $P(^(0),U,3) S I9=$$ICD^SROICD(CASE,$P(^SRF(CASE,14,0),U,3)) D
"RTN","SRHLVUO",32,0)
 ....S ^TMP("HLS",$J,HLSDT,SRI)="DG1"_HLFS_$E("0000",$L(X1)+1,4)_X1_HLFS_$S(SRSYS["9":"I9",1:"I0")_HLFS_$P(I9,U,2)_HLFS_$E($P(I9,U,4),1,40)_HLFS_HLFS_"PR",X1=X1+1,SRI=SRI+1
"RTN","SRHLVUO",33,0)
 Q
"RTN","SRHLVUO",34,0)
ERR(SRI,SRERR)     ;ERR segment builder
"RTN","SRHLVUO",35,0)
 ; SRERR = error code and location (segment^sequence #^field^error) 
"RTN","SRHLVUO",36,0)
 ;         (ONLY AE Application Errors')
"RTN","SRHLVUO",37,0)
 ;
"RTN","SRHLVUO",38,0)
 S ^TMP("HLS",$J,HLSDT,SRI)="ERR"_HLFS_$G(SRERR(1))_HLCOMP_$G(SRERR(2))_HLCOMP_$G(HLERR),SRI=SRI+1
"RTN","SRHLVUO",39,0)
 Q
"RTN","SRHLVUO",40,0)
MSA(SRI,SRAC) ;MSA segment builder
"RTN","SRHLVUO",41,0)
 ; SRAC = Acknowledgement code (ID)
"RTN","SRHLVUO",42,0)
 ;  AA = Application Accepted (responsed with information)
"RTN","SRHLVUO",43,0)
 ;  AE = Application Error (bad data send error response)
"RTN","SRHLVUO",44,0)
 ;  AR = Application Reject
"RTN","SRHLVUO",45,0)
 ;
"RTN","SRHLVUO",46,0)
 N MSA
"RTN","SRHLVUO",47,0)
 S MSA(1)=$G(SRAC),MSA(2)=$G(HLMID),MSA(3)=$G(SRERR)
"RTN","SRHLVUO",48,0)
 S ^TMP("HLS",$J,HLSDT,SRI)="MSA"_HLFS F XX=1:1:3 S ^TMP("HLS",$J,HLSDT,SRI)=$G(^TMP("HLS",$J,HLSDT,SRI))_$G(MSA(XX))_$S(XX=3:"",1:HLFS)
"RTN","SRHLVUO",49,0)
 S SRI=SRI+1
"RTN","SRHLVUO",50,0)
 Q
"RTN","SRHLVUO",51,0)
OBX(SRI) ;OBX segment(s) builder
"RTN","SRHLVUO",52,0)
 ; This segment builds OBX segments for the following Preoperative data
"RTN","SRHLVUO",53,0)
 ;  - vitals\measurements ^GMRVUTL routine:   
"RTN","SRHLVUO",54,0)
 ;     height, weight, blood pressure, pulse rate, and temperature
"RTN","SRHLVUO",55,0)
 ;  - IN\OUT-PATIENT STATUS field in File #130
"RTN","SRHLVUO",56,0)
 ;  - CANCEL DATE and CANCEL REASON for cancelled and aborted cases
"RTN","SRHLVUO",57,0)
 ;  - SURGICAL SPECIALTY (OR) or MEDICAL SPECIALTY (NON OR)
"RTN","SRHLVUO",58,0)
 ;  - SURGEON PGY and ANES SUPERVISE CODE
"RTN","SRHLVUO",59,0)
 Q:'$D(CASE)
"RTN","SRHLVUO",60,0)
 N OBX,CNT,TYPE,X,Y
"RTN","SRHLVUO",61,0)
 S CNT=1
"RTN","SRHLVUO",62,0)
 I $D(^SRF(CASE,"NON")) S OBX(2)="CE",OBX(3)=HLCOMP_"MEDICAL SPECIALTY"_HLCOMP,OBX(5)=$P(^("NON"),U,8) I OBX(5)'="" S OBX(5)=HLCOMP_$P(^ECC(723,OBX(5),0),U)_HLCOMP_"99VA723" D SOBX
"RTN","SRHLVUO",63,0)
 I $P(^SRF(CASE,0),U,4)'="" S OBX(2)="CE",OBX(3)=HLCOMP_"SURGICAL SPECIALTY"_HLCOMP,OBX(5)=$P(^(0),U,4) I OBX(5)'="" S OBX(5)=HLCOMP_$P(^SRO(137.45,OBX(5),0),U)_HLCOMP_"99VA137.45" D SOBX
"RTN","SRHLVUO",64,0)
 I $D(^SRF(CASE,200)) I $P(^SRF(CASE,200),U,52)'="" S OBX(2)="NM",OBX(3)=HLCOMP_"SURGEON PGY"_HLCOMP_"L",OBX(5)=$P(^(200),U,52) D SOBX
"RTN","SRHLVUO",65,0)
 I $D(^SRF(CASE,.3)) I $P(^SRF(CASE,.3),U,6)'="" S OBX(2)="CE",OBX(3)=HLCOMP_"ANES SUPERVISE CODE"_HLCOMP_"L",OBX(5)=$P(^(.3),U,6) D SOBX
"RTN","SRHLVUO",66,0)
 I $P(^SRF(CASE,0),U,12)'="" S OBX(2)="CE",OBX(3)=HLCOMP_"PATIENT CLASS"_HLCOMP,OBX(5)=$P(^(0),U,12) S C=$P(^DD(130,.011,0),U,2),Y=OBX(5) D Y^DIQ S OBX(5)=HLCOMP_Y_HLCOMP_"L" D SOBX
"RTN","SRHLVUO",67,0)
 S X="GMRVUTL" X ^%ZOSF("TEST") I $T F TYPE="BP","HT","WT","T","P" S GMRVSTR=TYPE D EN6^GMRVUTL I $G(X)'="" S X1=$P(X,"^"),X2=60,SRX=X D C^%DTC I X'<DT D
"RTN","SRHLVUO",68,0)
 .S OBX(2)="CE",OBX(5)=$P(SRX,"^",8),OBX(11)="S",OBX(14)=$$HLDATE^HLFNC($P(SRX,"^")),OBX(16)=$$HNAME^SRHLVU($P(SRX,U,6))
"RTN","SRHLVUO",69,0)
 .I TYPE="BP" S OBX(3)="1002"_HLCOMP_"BP",OBX(5)=$P(SRX,"^",8) D SOBX
"RTN","SRHLVUO",70,0)
 .I TYPE="HT" S OBX(3)="1010.3"_HLCOMP_"Height",OBX(5)=$J(2.54*OBX(5),0,2),OBX(6)="cm" D SOBX
"RTN","SRHLVUO",71,0)
 .I TYPE="WT" S OBX(3)="1010.1"_HLCOMP_"Body Weight",OBX(5)=$J(OBX(5)/2.2,0,2),OBX(6)="kg" D SOBX
"RTN","SRHLVUO",72,0)
 .I TYPE="T" S OBX(3)="1000"_HLCOMP_"Temperature" S OBX(5)=$J(OBX(5)-32*5/9,0,2),OBX(6)="cel" D SOBX
"RTN","SRHLVUO",73,0)
 .I TYPE="P" S OBX(3)="1006.2"_HLCOMP_"HR",OBX(6)="min" D SOBX
"RTN","SRHLVUO",74,0)
 I $D(^SRF(CASE,30)),$P($G(^SRF(CASE,31)),U,8)'="" D
"RTN","SRHLVUO",75,0)
 .S OBX(2)="CE",OBX(3)=HLCOMP_"CANCEL REASON"_HLCOMP_"L",OBX(5)=HLCOMP_$P(^SRO(135,$P(^SRF(CASE,31),U,8),0),U)_HLCOMP_"L",OBX(14)=$$HLDATE^HLFNC($P(^SRF(CASE,30),U)),OBX(16)=$$HNAME^SRHLVU($P(^SRF(CASE,30),U,3)) D SOBX
"RTN","SRHLVUO",76,0)
 Q
"RTN","SRHLVUO",77,0)
SOBX ;sets the OBX segment
"RTN","SRHLVUO",78,0)
 S OBX(11)="S"
"RTN","SRHLVUO",79,0)
 S OBX(1)=CNT
"RTN","SRHLVUO",80,0)
 S ^TMP("HLS",$J,HLSDT,SRI)="OBX"_HLFS F XX=1:1:16 S ^TMP("HLS",$J,HLSDT,SRI)=$G(^TMP("HLS",$J,HLSDT,SRI))_$G(OBX(XX))_$S(XX=16:"",1:HLFS),OBX(XX)=""
"RTN","SRHLVUO",81,0)
 S SRI=SRI+1,CNT=$G(CNT)+1
"RTN","SRHLVUO",82,0)
 Q
"RTN","SRHLVUO",83,0)
PID(SRI) ;PID segment builder returns patient information
"RTN","SRHLVUO",84,0)
 Q:'$D(DFN)
"RTN","SRHLVUO",85,0)
 S ^TMP("HLS",$J,HLSDT,SRI)=$$EN^VAFHLPID(DFN,"1,3,4,5,6,7,8,11,13,16,19",1),SRI=SRI+1
"RTN","SRHLVUO",86,0)
 Q
"RTN","SROACMP")
0^38^B34094394^B34040143
"RTN","SROACMP",1,0)
SROACMP ;BIR/ADM - M&M VERIFICATION REPORT ;12/19/07
"RTN","SROACMP",2,0)
 ;;3.0;Surgery;**47,50,127,143,166,177**;24 Jun 93;Build 89
"RTN","SROACMP",3,0)
 S DFN=0 F  S DFN=$O(^TMP("SR",$J,DFN)) Q:'DFN  S SRTN=0 F  S SRTN=$O(^TMP("SR",$J,DFN,SRTN)) Q:'SRTN  D UTIL
"RTN","SROACMP",4,0)
 I SRFORM=1,SRSP D SS
"RTN","SROACMP",5,0)
 D HDR^SROACMP1 I $D(^TMP("SR",$J)) S SRPAT="" F  S SRPAT=$O(^TMP("SRPAT",$J,SRPAT)) Q:SRPAT=""  D  Q:SRSOUT  S SRNM=0 I $Y+7<IOSL W !! F LINE=1:1:132 W "-"
"RTN","SROACMP",6,0)
 .S SRX=^(SRPAT),SRNAME=">>> "_SRPAT_" ("_$P(SRX,"^",2)_")",SRDEATH=$P(SRX,"^",3)
"RTN","SROACMP",7,0)
 .I SRDEATH S SRNAME=SRNAME_" - DIED "_$E(SRDEATH,4,5)_"/"_$E(SRDEATH,6,7)_"/"_$E(SRDEATH,2,3) S X=$E(SRDEATH,9,12) I X S X=X_"000",SRNAME=SRNAME_"@"_$E(X,1,2)_":"_$E(X,3,4)
"RTN","SROACMP",8,0)
 .I $Y+9>IOSL D HDR^SROACMP1 I SRSOUT Q
"RTN","SROACMP",9,0)
 .W !,SRNAME S SRNM=1,DFN=$P(SRX,"^"),SRTN=0 F  S SRTN=$O(^TMP("SR",$J,DFN,SRTN)) Q:'SRTN!SRSOUT  D SET
"RTN","SROACMP",10,0)
 G:SRSOUT END^SROACMP1 I '$D(^TMP("SR",$J)) W !!,"There are no perioperative occurrences or deaths recorded for ",$S(SRFORM=1:"surgeries performed in the selected date range.",1:"completed assessments not yet transmitted.")
"RTN","SROACMP",11,0)
 D HDR2^SROACMP1,END^SROACMP1
"RTN","SROACMP",12,0)
 Q
"RTN","SROACMP",13,0)
UTIL ; list all cases within 30 days prior to postop occurrence and/or 90 days prior to death
"RTN","SROACMP",14,0)
 S SRPOST=0 F  S SRPOST=$O(^SRF(SRTN,16,SRPOST)) Q:'SRPOST  S SRDATE=$E($P(^SRF(SRTN,16,SRPOST,0),"^",7),1,7) I SRDATE S SRBACK=-30 D PRIOR
"RTN","SROACMP",15,0)
 D DEM^VADPT S ^TMP("SRPAT",$J,VADM(1))=DFN_"^"_VA("PID")_"^"_$P(VADM(6),"^")
"RTN","SROACMP",16,0)
 S SRDATE=$P(VADM(6),"^") I SRDATE S SRBACK=-90 D PRIOR
"RTN","SROACMP",17,0)
 Q
"RTN","SROACMP",18,0)
PRIOR ; list cases in 30 days before this occurrence or 90 days before death
"RTN","SROACMP",19,0)
 S X1=SRDATE,X2=SRBACK D C^%DTC S SDATE=X,SRCASE=0 F  S SRCASE=$O(^SRF("B",DFN,SRCASE)) Q:'SRCASE  I '$D(^TMP("SR",$J,DFN,SRCASE)) D
"RTN","SROACMP",20,0)
 .I $D(^XUSEC("SROCHIEF",+DUZ)) Q:'$$MANDIV^SROUTL0(SRINSTP,SRTN)
"RTN","SROACMP",21,0)
 .I '$D(^XUSEC("SROCHIEF",+DUZ)) Q:'$$DIV^SROUTL0(SRTN)
"RTN","SROACMP",22,0)
 .I '$P($G(^SRF(SRCASE,.2)),"^",12)!$P($G(^SRF(SRCASE,30)),"^")!($P($G(^SRF(SRCASE,"NON")),"^")="Y") Q
"RTN","SROACMP",23,0)
 .S SRX=$E($P(^SRF(SRCASE,0),"^",9),1,7) I SRX<SDATE!(SRX>SRDATE) Q
"RTN","SROACMP",24,0)
 .S ^TMP("SR",$J,DFN,SRCASE)=$P(^SRF(SRCASE,0),"^",4)
"RTN","SROACMP",25,0)
 Q
"RTN","SROACMP",26,0)
SET ; set variables to print
"RTN","SROACMP",27,0)
 N SRSEP,SRICDN
"RTN","SROACMP",28,0)
 S SR(0)=^SRF(SRTN,0),(SRD,Y)=$P(SR(0),"^",9),SRSDATE=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3),Y=$P(SR(0),"^",4) I Y S SRSS=$P(^SRO(137.45,Y,0),"^")
"RTN","SROACMP",29,0)
OPS S SROPER=$P(^SRF(SRTN,"OP"),"^")
"RTN","SROACMP",30,0)
 K SRP,Z S:$L(SROPER)<121 SRP(1)=SROPER I $L(SROPER)>120 S SROPER=SROPER_"  " F M=1:1 D OPER Q:Z=""
"RTN","SROACMP",31,0)
 N SRL S SRL=109 D CPTS^SROAUTL0 I SRPROC(1)="" S SRPROC(1)="NOT ENTERED"
"RTN","SROACMP",32,0)
 S SRCHK=0 I SRDEATH S X1=SRDEATH,X2=-90 D C^%DTC I SRD<X S SRCHK=1,SRREL="N/A"
"RTN","SROACMP",33,0)
 I 'SRCHK S X=$P($G(^SRF(SRTN,.4)),"^",7),SRREL=$S(SRDEATH="":"N/A",X="U":"NO",X="R":"YES",1:"NOT ENTERED")
"RTN","SROACMP",34,0)
COMP ; perioperative occurrences
"RTN","SROACMP",35,0)
 K SRC S (SRFG,SRIC)=0 F  S SRIC=$O(^SRF(SRTN,10,SRIC)) Q:SRIC=""  S SRFG=SRFG+1,SRO=^SRF(SRTN,10,SRIC,0),SRICD=$P(SRO,"^",3) D
"RTN","SROACMP",36,0)
 .S Y=SRD D DATE S SRCAT=$P(SRO,"^",2) Q:'SRCAT  S SRC(SRFG)=$P(^SRO(136.5,SRCAT,0),"^")_" "_SRY
"RTN","SROACMP",37,0)
 .I SRICD S SRICDN=$$ICD^SROICD(SRTN,SRICD),SRFG=SRFG+1,SRC(SRFG)="  ICD"_$$ICD910^SROICD(SRTN)_": "_$P(SRICDN,"^",2)_"  "_$P(SRICDN,"^",4)
"RTN","SROACMP",38,0)
 .S $P(SRC(SRFG),"^",2)="10;"_SRIC
"RTN","SROACMP",39,0)
 S SRPC=0 F  S SRPC=$O(^SRF(SRTN,16,SRPC)) Q:SRPC=""  S SRFG=SRFG+1,SRO=^SRF(SRTN,16,SRPC,0),SRICD=$P(SRO,"^",3) D
"RTN","SROACMP",40,0)
 .S Y=$E($P(SRO,"^",7),1,7) D DATE S SRCAT=$P(SRO,"^",2) Q:'SRCAT
"RTN","SROACMP",41,0)
 .S SRSEP="" I SRCAT=3 S X=$P(SRO,"^",4) I X S SRSEP="/"_$S(X=2:"SEPSIS",X=3:"SEPTIC SHOCK",1:"SIRS")_" "
"RTN","SROACMP",42,0)
 .S SRC(SRFG)=$P(^SRO(136.5,SRCAT,0),"^")_"  ** POSTOP ** "_SRSEP_SRY
"RTN","SROACMP",43,0)
 .I $P(SRO,"^",2)=3 S X=$P(SRO,"^",4) I X S SRSEP=$S(X=2:"SEPSIS",X=3:"SEPTIC SHOCK",1:"SIRS")
"RTN","SROACMP",44,0)
 .I SRICD S SRICDN=$$ICD^SROICD(SRTN,SRICD),SRFG=SRFG+1,SRC(SRFG)="  ICD"_$$ICD910^SROICD(SRTN)_": "_$P(SRICDN,"^",2)_"  "_$P(SRICDN,"^",4)
"RTN","SROACMP",45,0)
 .S $P(SRC(SRFG),"^",2)="16;"_SRPC
"RTN","SROACMP",46,0)
RA ; risk assessment type and status
"RTN","SROACMP",47,0)
 S SRA=$G(^SRF(SRTN,"RA")),SRSTATUS=$P(SRA,"^"),SRTYPE=$P(SRA,"^",2),SRYN=$P(SRA,"^",6),SRE=$P(SRA,"^",7) D
"RTN","SROACMP",48,0)
 .I SRTYPE="" S SRTYPE="NON-ASSESSED" Q
"RTN","SROACMP",49,0)
 .S SRTYPE=$S(SRTYPE="C":"CARDIAC",SRYN="Y":"NON-CARDIAC",1:"EXCLUDED")
"RTN","SROACMP",50,0)
 S SRSTATUS=$S(SRSTATUS="C":"COMPLETE",SRSTATUS="T":"TRANSMITTED",SRSTATUS="I":"INCOMPLETE",1:"N/A")
"RTN","SROACMP",51,0)
PRINT ; print case information
"RTN","SROACMP",52,0)
 I $Y+8>IOSL D HDR^SROACMP1 I SRSOUT Q
"RTN","SROACMP",53,0)
 W !!,SRSDATE,?11,SRTN,?25,SRSS,?80,SRTYPE,?98,SRSTATUS,?116,SRREL
"RTN","SROACMP",54,0)
 W !,?11,SRP(1) W:$D(SRP(2)) !,?11,SRP(2)
"RTN","SROACMP",55,0)
 W !,?11,"CPT Codes: ",SRPROC(1) W:$D(SRPROC(2)) !,?24,SRPROC(2)
"RTN","SROACMP",56,0)
 W !,?11,"Occurrences: " I '$D(SRC(1)) S SRC(1)="NONE ENTERED"
"RTN","SROACMP",57,0)
 S SRI=0 F  S SRI=$O(SRC(SRI)) Q:'SRI  D
"RTN","SROACMP",58,0)
 .W:SRI>1 ! W ?24,$P(SRC(SRI),"^")
"RTN","SROACMP",59,0)
 .I $Y+6>IOSL D HDR^SROACMP1 W ! I SRSOUT Q
"RTN","SROACMP",60,0)
 .D TEXT D:SRT WP
"RTN","SROACMP",61,0)
 S SRNDTH=$P($G(^SRF(SRTN,205)),"^",3)
"RTN","SROACMP",62,0)
 I SRDEATH!SRNDTH D  K SRNDTH
"RTN","SROACMP",63,0)
 .I SRNDTH W !,?11,"Date of Death: "_$E(SRNDTH,4,5)_"/"_$E(SRNDTH,6,7)_"/"_$E(SRNDTH,2,3) S X=$E(SRNDTH,9,12) I X S X=X_"000" W "@"_$E(X,1,2)_":"_$E(X,3,4)
"RTN","SROACMP",64,0)
 .W !,?11,"Review of Death Comments: " D
"RTN","SROACMP",65,0)
 ..I '$O(^SRF(SRTN,47,0)) W "NONE ENTERED" Q
"RTN","SROACMP",66,0)
 ..D DWP
"RTN","SROACMP",67,0)
 Q
"RTN","SROACMP",68,0)
OPER ; break procedure if greater than 48 characters
"RTN","SROACMP",69,0)
 S SRP(M)="" F LOOP=1:1 S Z=$P(SROPER," ") Q:Z=""  Q:$L(SRP(M))+$L(Z)'<49  S SRP(M)=SRP(M)_Z_" ",SROPER=$P(SROPER," ",2,200)
"RTN","SROACMP",70,0)
 Q
"RTN","SROACMP",71,0)
DATE S SRY=$S(Y:" ("_$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3)_")",1:" (NO DATE)")
"RTN","SROACMP",72,0)
 Q
"RTN","SROACMP",73,0)
SS ; set up ^TMP for selected specialties
"RTN","SROACMP",74,0)
 K ^TMP("SRSP",$J) S SRQ=0,SRNAME="" F  S SRNAME=$O(^TMP("SRPAT",$J,SRNAME)) Q:SRNAME=""  S DFN=$P(^TMP("SRPAT",$J,SRNAME),"^"),(SRQ,SRTN)=0 D
"RTN","SROACMP",75,0)
 .F  S SRTN=$O(^TMP("SR",$J,DFN,SRTN)) Q:'SRTN  D  Q:SRQ
"RTN","SROACMP",76,0)
 ..S Y=$P(^SRF(SRTN,0),"^",4) S:'Y Y="ZZ" I $D(SRSP(Y)) S ^TMP("SRSP",$J,DFN)="",SRQ=1 Q
"RTN","SROACMP",77,0)
 S SRNAME="" F  S SRNAME=$O(^TMP("SRPAT",$J,SRNAME)) Q:SRNAME=""  S DFN=$P(^TMP("SRPAT",$J,SRNAME),"^") I '$D(^TMP("SRSP",$J,DFN)) K ^TMP("SR",$J,DFN),^TMP("SRPAT",$J,SRNAME)
"RTN","SROACMP",78,0)
 Q
"RTN","SROACMP",79,0)
WP ; print occurrence comments
"RTN","SROACMP",80,0)
 N CM K ^UTILITY($J,"W") S CM=0 F  S CM=$O(^SRF(SRTN,SRY,SRZ,1,CM)) Q:'CM  S X=^SRF(SRTN,SRY,SRZ,1,CM,0),DIWL=30,DIWR=132 D ^DIWP
"RTN","SROACMP",81,0)
 I $D(^UTILITY($J,"W")) F J=1:1:^UTILITY($J,"W",30) D
"RTN","SROACMP",82,0)
 .I $Y+7>IOSL D HDR^SROACMP1 W ! I SRSOUT Q
"RTN","SROACMP",83,0)
 .W !,?30,^UTILITY($J,"W",30,J,0)
"RTN","SROACMP",84,0)
 Q
"RTN","SROACMP",85,0)
TEXT ; check for occurrence comments
"RTN","SROACMP",86,0)
 S SRT=0,SRX=$P(SRC(SRI),"^",2) I SRX'="" S SRY=$P(SRX,";"),SRZ=$P(SRX,";",2) I $O(^SRF(SRTN,SRY,SRZ,1,0)) S SRT=1 W !,?26,">>> Comments:"
"RTN","SROACMP",87,0)
 Q
"RTN","SROACMP",88,0)
DWP ; print review of death comments
"RTN","SROACMP",89,0)
 N CM K ^UTILITY($J,"W") S CM=0 F  S CM=$O(^SRF(SRTN,47,CM)) Q:'CM  S X=^SRF(SRTN,47,CM,0),DIWL=38,DIWR=132 D ^DIWP
"RTN","SROACMP",90,0)
 I $D(^UTILITY($J,"W")) F J=1:1:^UTILITY($J,"W",38) D
"RTN","SROACMP",91,0)
 .I $Y+7>IOSL D HDR^SROACMP1 W ! I SRSOUT Q
"RTN","SROACMP",92,0)
 .W ?38,^UTILITY($J,"W",38,J,0),!
"RTN","SROACMP",93,0)
 Q
"RTN","SROACOD")
0^39^B16693883^B16578804
"RTN","SROACOD",1,0)
SROACOD ;BIR/SJA - ALERT CODERS OF POTENTIAL CODING ISSUES ;04/18/06
"RTN","SROACOD",2,0)
 ;;3.0;Surgery;**146,152,177**;24 Jun 93;Build 89
"RTN","SROACOD",3,0)
 I '$D(SRTN) K SRNEWOP D ^SROPS G:'$D(SRTN) END S SRTN("KILL")=1
"RTN","SROACOD",4,0)
 N I,J,SRCPTP,SRLN,SRNODE0,SRPOST,SRTXT,SRSOUT,SRSUPCPT,X,XX,Y
"RTN","SROACOD",5,0)
 S SRSOUT=0,SRSUPCPT=1 D ^SROAUTL
"RTN","SROACOD",6,0)
START G:SRSOUT END K SRAOTH
"RTN","SROACOD",7,0)
 D HDR^SROAUTL
"RTN","SROACOD",8,0)
 W !,"The following ""final"" codes have been entered for the case.",!!
"RTN","SROACOD",9,0)
 S X=$P($G(^SRO(136,SRTN,0)),"^",2) I X S Y=$P($$CPT^ICPTCOD(X),"^",2) D SSPRIN^SROCPT0 S X=Y
"RTN","SROACOD",10,0)
 W "Principal CPT Code: ",$S($L(X):X,1:"NOT ENTERED") S SRCPTP=X
"RTN","SROACOD",11,0)
 N SRPROC,K,SRL
"RTN","SROACOD",12,0)
 S SRPROC(1)="",SRL=60,K=1 D OTH^SROUTLN W !,"Other CPT Codes: "_$S(SRPROC(1)="":"   NOT ENTERED",1:"")
"RTN","SROACOD",13,0)
 F I=1:1 Q:'$D(SRPROC(I))  W:I=1 ?20,$P(SRPROC(I),", ",2,99),! W:I'=1 ?20,SRPROC(I),!
"RTN","SROACOD",14,0)
 S X=$P($G(^SRO(136,SRTN,0)),"^",3) S:X X=$$ICD^SROICD(SRTN,X),X=$P(X,"^",2)_"   "_$P(X,"^",4)
"RTN","SROACOD",15,0)
 W "Postop Diagnosis Code "_$$ICDSTR^SROICD(SRTN)_": ",$S(X'="":X,1:"NOT ENTERED"),! S SRPOST=X
"RTN","SROACOD",16,0)
 W !!,"If you believe that the information coded is not correct and would like to",!,"alert the coders of the potential issue, enter a brief description of your",!,"concern below.",!
"RTN","SROACOD",17,0)
 D ASK G:SRSOUT END
"RTN","SROACOD",18,0)
 K ^TMP($J,"SRC")
"RTN","SROACOD",19,0)
ED W ! S DIC="^TMP($J,""SRC"",",DIWESUB="Coding Discrepancy Comments" D EN^DIWE
"RTN","SROACOD",20,0)
 I '$D(^TMP($J,"SRC")) W !,"NOTE:   You have exited the field without entering comments. ",!
"RTN","SROACOD",21,0)
 W ! K DIR S DIR("A",1)="1. Transmit Message",DIR("A",2)="2. Edit Text",DIR("A",3)="",DIR("A")="Select Number: "
"RTN","SROACOD",22,0)
 S DIR(0)="NA^1:2",DIR("B")=1,DIR("?",1)="Enter <RET> or '1' to Transmit Message,"
"RTN","SROACOD",23,0)
 S DIR("?")="enter '2' to Edit the text or enter '^' to exit." D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) G END
"RTN","SROACOD",24,0)
 I Y=2 G ED
"RTN","SROACOD",25,0)
MSG I '$P($G(^SRO(136,SRTN,10)),"^")&('$P($G(^SRO(133,SRSITE,7)),"^",2)) D ERR G END
"RTN","SROACOD",26,0)
 K SR,XMY S SRNODE0=$G(^SRF(SRTN,0))
"RTN","SROACOD",27,0)
 S SR(1)="Patient: "_$E(VADM(1),1,20)_$J("",30-$L(VADM(1)))_" Case #: "_SRTN
"RTN","SROACOD",28,0)
 S Y=$P(SRNODE0,"^",9) D DD^%DT S SR(2)="Operation Date: "_Y
"RTN","SROACOD",29,0)
 S SR(3)=""
"RTN","SROACOD",30,0)
 S SR(4)="The following ""final"" codes have been entered for the case."
"RTN","SROACOD",31,0)
 S DFN=$P(SRNODE0,"^") D DEM^VADPT
"RTN","SROACOD",32,0)
 S SR(5)=""
"RTN","SROACOD",33,0)
 S SR(6)="  Principal CPT Code: "_SRCPTP
"RTN","SROACOD",34,0)
 S SRLN=6 F I=1:1 Q:'$D(SRPROC(I))  S SRLN=SRLN+1 S:I=1 SR(SRLN)="  Other CPT Codes: "_$P(SRPROC(I),", ",2,99) S:I>1 SR(SRLN)=$J(SRPROC(I),$L(SRPROC(I))+19)
"RTN","SROACOD",35,0)
 S SRLN=SRLN+1,SR(SRLN)="  Postop Diagnosis Code "_$$ICDSTR^SROICD(SRTN)_": "_SRPOST
"RTN","SROACOD",36,0)
 S SRLN=SRLN+1,SR(SRLN)="",SRLN=SRLN+1
"RTN","SROACOD",37,0)
 S I=0 F  S I=$O(^TMP($J,"SRC",I)) Q:'I  S SR(SRLN)=$G(^(I,0)),SRLN=SRLN+1
"RTN","SROACOD",38,0)
 S I=0 F  S I=$O(^SRO(136,SRTN,11,I)) Q:'I  S XX=$G(^(I,0)) I $P(XX,"^") S XMY($P(XX,"^"))=""
"RTN","SROACOD",39,0)
 S XMY(DUZ)=""
"RTN","SROACOD",40,0)
 S X=$P($G(^SRO(133,SRSITE,7)),"^",2) I X S X=$$GET1^DIQ(3.8,X,.01) S:X]"" XMY("G."_X)=""
"RTN","SROACOD",41,0)
 S XMSUB="Surgery Coding Issues" D NOW^%DTC S Y=% X ^DD("DD")
"RTN","SROACOD",42,0)
 S XMTEXT="SR(" D ^XMD K XMTEXT,XMY,XMSUB,^TMP($J,"SRC")
"RTN","SROACOD",43,0)
 W !!,"Transmitting message..."
"RTN","SROACOD",44,0)
END W @IOF D ^SRSKILL I $D(SRTN("KILL")) K SRTN
"RTN","SROACOD",45,0)
 Q
"RTN","SROACOD",46,0)
ASK K DIR S DIR(0)="Y",DIR("A")="Do you want to alert the coders (Y/N)",DIR("B")="YES" D ^DIR S:'Y SRSOUT=1
"RTN","SROACOD",47,0)
 Q
"RTN","SROACOD",48,0)
ERR ;The Coding Issue Alert cannot be created at this time
"RTN","SROACOD",49,0)
 D EN^DDIOL("The information needed to send a code issue mail message is",,"!!")
"RTN","SROACOD",50,0)
 D EN^DDIOL("not entered.  Because the coding is not completed, no coder",,"!")
"RTN","SROACOD",51,0)
 D EN^DDIOL("is identified. Also, there is no mail group identified in the",,"!")
"RTN","SROACOD",52,0)
 D EN^DDIOL("CODE ISSUE MAIL GROUP site parameter.",,"!")
"RTN","SROACOD",53,0)
 D EN^DDIOL("To send a coding issue message the case must have either the",,"!!")
"RTN","SROACOD",54,0)
 D EN^DDIOL("coder or mail group identified.",,"!")
"RTN","SROACOD",55,0)
 W ! K DIR S DIR(0)="FOA",DIR("A")="Press RETURN to continue  " D ^DIR K DIR
"RTN","SROACOD",56,0)
 Q
"RTN","SROACOM1")
0^65^B19579953^B19771311
"RTN","SROACOM1",1,0)
SROACOM1 ;BIR/MAM - COMPLETE ASSESSMENT ;05/05/10
"RTN","SROACOM1",2,0)
 ;;3.0;Surgery;**166,174,177**;24 Jun 93;Build 89
"RTN","SROACOM1",3,0)
 I '$D(SRTN) Q
"RTN","SROACOM1",4,0)
 S (SRSFLG,SRSOUT,SROVER)=0,SRA=$G(^SRF(SRTN,"RA")),Y=$P(SRA,"^") I Y'="I" W !!,"This assessment has a "_$S(Y="C":"'COMPLETE'",1:"'TRANSMITTED'")_" status.",!!,"No action taken." G END
"RTN","SROACOM1",5,0)
 I $P(SRA,"^",2)="C" D CHK^SROAUTLC
"RTN","SROACOM1",6,0)
 S SRFLD="" I $O(SRX(SRFLD))'="" D LIST
"RTN","SROACOM1",7,0)
 I $P(SRA,"^",2)="C" D CHCK G:SRSOUT END
"RTN","SROACOM1",8,0)
YEP I '$P($G(^SRO(136,SRTN,10)),"^")!('$P($G(^SRO(136,SRTN,0)),"^",2))!('$P($G(^SRO(136,SRTN,0)),"^",3)) W !!,?6,"The coding for Procedure and Diagnosis is not complete."
"RTN","SROACOM1",9,0)
 W ! S SRFLD="" K DIR S DIR("A")="Are you sure you want to complete this assessment ? ",DIR("B")=$S($O(SRX(SRFLD)):"NO",1:"YES"),DIR(0)="YA"
"RTN","SROACOM1",10,0)
 S DIR("?",1)="Enter YES to complete this assessment, or enter NO to leave the status",DIR("?")="unchanged." D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 G END
"RTN","SROACOM1",11,0)
 I 'Y W !!,"No action taken." G END
"RTN","SROACOM1",12,0)
 I $$LOCK^SROUTL(SRTN) D COMPLT Q
"RTN","SROACOM1",13,0)
 E  W !!,"No action taken." G END
"RTN","SROACOM1",14,0)
 Q
"RTN","SROACOM1",15,0)
COMPLT W !!,"Updating the current status to 'COMPLETE'..." K DR,DIE S DA=SRTN,DIE=130,DR="235///C;272.1////"_DUZ D ^DIE K STATUS
"RTN","SROACOM1",16,0)
 I $P(SRA,"^",5)="" K DR,DIE S DA=SRTN,DIE=130,DR="272///"_DT D ^DIE K STATUS
"RTN","SROACOM1",17,0)
 I $P(SRA,"^",2)="C" K DA,DIE,DIK,DR S DIK="^SRF(",DIK(1)=".232^AQ",DA=SRTN D EN1^DIK K DA,DIK
"RTN","SROACOM1",18,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SROACOM1",19,0)
PRINT W !!,"Do you want to print the completed assessment ?  YES//  " R SRYN:DTIME I '$T!(SRYN["^") S SRSOUT=1 Q
"RTN","SROACOM1",20,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y" I "Nn"[SRYN S SRSOUT=1 Q
"RTN","SROACOM1",21,0)
 I "Yy"'[SRYN W !!,"Enter <RET> to print the completed assessment, or 'NO' to return to the menu." G PRINT
"RTN","SROACOM1",22,0)
 W ! K %ZIS,IO("Q"),POP S %ZIS("A")="Print the Completed Assessment on which Device: ",%ZIS="Q" D ^%ZIS I POP S SRSOUT=1 Q
"RTN","SROACOM1",23,0)
 I $D(IO("Q")) K IO("Q") S ZTDESC="Completed Surgery Risk Assessment",(ZTSAVE("SRSITE*"),ZTSAVE("SRTN"))="",ZTRTN="EN^SROACOM1" D ^%ZTLOAD S SRSOUT=1 G END
"RTN","SROACOM1",24,0)
 D EN,END
"RTN","SROACOM1",25,0)
 Q
"RTN","SROACOM1",26,0)
EN U IO S SRABATCH=1 D ^SROAPAS Q
"RTN","SROACOM1",27,0)
END I 'SRSOUT,$E(IOST)'="P" D RET
"RTN","SROACOM1",28,0)
 W @IOF I $E(IOST)="P" D ^%ZISC W @IOF
"RTN","SROACOM1",29,0)
 D ^SRSKILL K SRMD,SRMD1,SRMDD,SRSFLG
"RTN","SROACOM1",30,0)
 Q
"RTN","SROACOM1",31,0)
LIST W @IOF,!,"This assessment is missing the following items:",! S SRZ="",SRCNT=1
"RTN","SROACOM1",32,0)
 F  S SRZ=$O(SRX(SRZ)) Q:SRZ=""  D:$Y+5>IOSL RET Q:SRSOUT  W !,?5,$J(SRCNT,2)_". "_$P($P(SRX(SRZ),":"),"^") S SRCNT=SRCNT+1
"RTN","SROACOM1",33,0)
 S SRSOUT=0 W ! K DIR S DIR(0)="Y",DIR("A")="Do you want to enter the missing items at this time",DIR("B")="NO" D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROACOM1",34,0)
 Q:'Y  I $$LOCK^SROUTL(SRTN) D PRT,UNLOCK^SROUTL(SRTN)
"RTN","SROACOM1",35,0)
 Q
"RTN","SROACOM1",36,0)
PRT S SRSOUT=0,(SRMD,SRMDD,SRMD1)="",SRCNT=0 F  S SRMDD=$O(SRX(SRMDD)) Q:SRMDD=""  S SRMD=$P($G(SRX(SRMDD)),":",2),SRMD1=$P($G(SRX(SRMDD)),"^",2) D  Q:$G(SRSFLG)
"RTN","SROACOM1",37,0)
 .I SRMD=485 W @IOF,! D PRIOR^SROACL2 K DR,DIE S DA=SRTN,DR="485///"_$S(X="@":"@",1:$P(Y,"^")),DIE=130 D ^DIE K DR S:$D(Y) SRSFLG=1 Q
"RTN","SROACOM1",38,0)
 .K DR,DIE S DA=SRTN,DIE=130,DR=$S($G(SRMD1):SRMD1,1:SRMD)_"T" D ^DIE K DR I $D(Y) S SRSFLG=1
"RTN","SROACOM1",39,0)
 S:'$G(SRSOUT) SRSOUT=0
"RTN","SROACOM1",40,0)
 Q
"RTN","SROACOM1",41,0)
CHCK ; cardiac checks added by SR*3*93
"RTN","SROACOM1",42,0)
 N SRADM,SRDIS,SRISCH,SRCPB,SRRET S SRRET=0,X=$G(^SRF(SRTN,208)),SRADM=$P(X,"^",14),SRDIS=$P(X,"^",15),X=$G(^SRF(SRTN,206)),SRISCH=$P(X,"^",36),SRCPB=$P(X,"^",37)
"RTN","SROACOM1",43,0)
 I SRADM,SRDIS,SRADM'<SRDIS W !!,"  ***  NOTE: Discharge Date precedes Admission Date!!  Please check.  ***" D
"RTN","SROACOM1",44,0)
 . S SRRET=1 S:$P($G(SRZZ(418)),U,2)'="" SRX($P(SRZZ(418),"^",2))="" S SRZZ(418)=""
"RTN","SROACOM1",45,0)
 I SRISCH,SRCPB,SRISCH>SRCPB W !!,"  ***  NOTE: Ischemic Time is greater than CPB Time!!  Please check.  ***",! D
"RTN","SROACOM1",46,0)
 . S SRRET=1 S:$P($G(SRZZ(450)),U,2)'="" SRX($P(SRZZ(450),"^",2))="" S SRZZ(450)=""
"RTN","SROACOM1",47,0)
 I SRRET W ! K DIR S DIR(0)="E" D ^DIR K DIR S:$D(DTOUT)!$D(DUOUT) SRSOUT=1 W !
"RTN","SROACOM1",48,0)
 Q
"RTN","SROACOM1",49,0)
RET W !! K DIR S DIR(0)="E" D ^DIR K DIR W @IOF I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROACOM1",50,0)
 Q
"RTN","SROACOM1",51,0)
PAGE I $E(IOST)'="P" D RET Q
"RTN","SROACOM1",52,0)
 W @IOF,!!!
"RTN","SROACOM1",53,0)
 Q
"RTN","SROADX1")
0^17^B94091442^B93981084
"RTN","SROADX1",1,0)
SROADX1 ;BIR/RJS - CONTINUED FROM SROADX ASSOCIATED DIAGNOSIS FOR CODER AND VERIFY SCREENS ;09/12/05 12:01pm
"RTN","SROADX1",2,0)
 ;;3.0;Surgery;**119,150,177**;24 Jun 93;Build 89
"RTN","SROADX1",3,0)
OTHADX ;Display ASDX for OTHER PROCS
"RTN","SROADX1",4,0)
 K SRTMP,SRASSD,SROICD
"RTN","SROADX1",5,0)
 S SRPADX=0,SROCNTR=1
"RTN","SROADX1",6,0)
 F SRI=1:1 S SRPADX=$O(^SRF(SRTN,13,OTH,"OADX",SRPADX)) Q:'SRPADX  D
"RTN","SROADX1",7,0)
 .S SRASSD=^SRF(SRTN,13,OTH,"OADX",SRPADX,0)
"RTN","SROADX1",8,0)
 .D AASDX
"RTN","SROADX1",9,0)
 .S SRTMP(SRI)=SROICD,SROCNTR=SROCNTR+1
"RTN","SROADX1",10,0)
 S SROCNTR=0
"RTN","SROADX1",11,0)
 D ADXDISP
"RTN","SROADX1",12,0)
 I '$O(^SRF(SRTN,13,OTH,"OADX",0)) W !,?5,SRMSG,!
"RTN","SROADX1",13,0)
 D PASSDIAG
"RTN","SROADX1",14,0)
 D ASSDIAG
"RTN","SROADX1",15,0)
 Q
"RTN","SROADX1",16,0)
ASDX N SRI,SRFIRST,SRICD9,SRPRIN,SRPADX,SRASSD ;Display ASDX for PRIN Procs
"RTN","SROADX1",17,0)
 K SRTMP
"RTN","SROADX1",18,0)
 S SRI=0,SRFIRST=1
"RTN","SROADX1",19,0)
 F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),U)
"RTN","SROADX1",20,0)
 S SRPADX=0,SROCNTR=2
"RTN","SROADX1",21,0)
 F SRI=1:1 S SRPADX=$O(^SRF(SRTN,"PADX",SRPADX)) Q:'SRPADX  D
"RTN","SROADX1",22,0)
 .S SRASSD=^SRF(SRTN,"PADX",SRPADX,0)
"RTN","SROADX1",23,0)
 .D AASDX
"RTN","SROADX1",24,0)
 .S SRTMP(SRI)=SROICD,SROCNTR=SROCNTR+1
"RTN","SROADX1",25,0)
 D ADXDISP
"RTN","SROADX1",26,0)
 I '$O(^SRF(SRTN,"PADX",0)) W !,?5,SRMSG
"RTN","SROADX1",27,0)
 D PASSDIAG
"RTN","SROADX1",28,0)
 D ASSDIAG
"RTN","SROADX1",29,0)
 Q
"RTN","SROADX1",30,0)
AASDX S SROICD=""
"RTN","SROADX1",31,0)
 S:SRASSD SRICD9=$P($G(^SRF(SRTN,15,SRASSD,0)),U,3)
"RTN","SROADX1",32,0)
 S:'SRASSD SRICD9=$P($G(^SRF(SRTN,34)),U,2)
"RTN","SROADX1",33,0)
 S:SRICD9 SROICD=$$ICDSTR
"RTN","SROADX1",34,0)
 I 'SRICD9 D
"RTN","SROADX1",35,0)
 .S:SRASSD SROICD=$P($G(^SRF(SRTN,15,SRASSD,0)),U)
"RTN","SROADX1",36,0)
 .S:'SRASSD SROICD=$P($G(^SRF(SRTN,34)),U,1)
"RTN","SROADX1",37,0)
 Q
"RTN","SROADX1",38,0)
PASSDIAG N ADCNT,SRICD9,SRFLG,SRCNTR,SRASSD  ;List PRIN DX to assoc.
"RTN","SROADX1",39,0)
 K SRADX,SRDIRX,SRADIAG
"RTN","SROADX1",40,0)
 S SRICD9=$P($G(^SRF(SRTN,34)),U,2)
"RTN","SROADX1",41,0)
 I SRICD9'="" S SRDIRX(1)=$$ICDSTR,SRADX(1)=$P(SRDIRX(1),U,2),SRADIAG(1)=0
"RTN","SROADX1",42,0)
 I SRICD9="" S SRDIRX(1)=$P($G(^SRF(SRTN,34)),U,1),SRADIAG(1)=0
"RTN","SROADX1",43,0)
 Q
"RTN","SROADX1",44,0)
ASSDIAG N SRDCNT,SRADCNT,SRQ ;DXs for assoc.
"RTN","SROADX1",45,0)
 S (ADCNT,SRASSD)=0,SRCNT=2
"RTN","SROADX1",46,0)
 F  S ADCNT=$O(^SRF(SRTN,15,ADCNT)) Q:ADCNT=""  D
"RTN","SROADX1",47,0)
 .S SRICD9=$P(^SRF(SRTN,15,ADCNT,0),U,3)
"RTN","SROADX1",48,0)
 .S:SRICD9'="" SRDIRX(SRCNT)=$$ICDSTR,SRADX(SRCNT)=$P(SRDIRX(SRCNT),U,2)
"RTN","SROADX1",49,0)
 .S:SRICD9="" SRDIRX(SRCNT)=$P(^SRF(SRTN,15,ADCNT,0),U,1)
"RTN","SROADX1",50,0)
 .S SRADIAG(SRCNT)=ADCNT,SRCNT=SRCNT+1
"RTN","SROADX1",51,0)
 S SRDX2="LO^:0"
"RTN","SROADX1",52,0)
 I (ADCNT<$$SRDIAGS) D
"RTN","SROADX1",53,0)
 .S:(SRCNT>2) SRDIRX(SRCNT)="ALL"
"RTN","SROADX1",54,0)
 .S:$D(SRDIRX) SRDX2="LO^:"_SRCNT
"RTN","SROADX1",55,0)
 .S:$$SRDIAGS=1 SRDX2="LO^:"_(SRCNT-1)
"RTN","SROADX1",56,0)
 Q
"RTN","SROADX1",57,0)
SRDIAGS() N SRDIAGS,SRDGCNT
"RTN","SROADX1",58,0)
 S (SRDIAGS,SRDGCNT)=0
"RTN","SROADX1",59,0)
 S:($P($G(^SRF(SRTN,34)),U)'="")!($P($G(^SRF(SRTN,34)),U,2)) SRDIAGS=1
"RTN","SROADX1",60,0)
 F I=1:1 S SRDGCNT=$O(^SRF(SRTN,15,SRDGCNT)) Q:SRDGCNT=""  S SRDIAGS=SRDIAGS+1
"RTN","SROADX1",61,0)
 Q SRDIAGS
"RTN","SROADX1",62,0)
ICDSTR() N SRICDSTR
"RTN","SROADX1",63,0)
 S SRICDSTR=$$ICD^SROICD(SRTN,SRICD9),SRICDSTR=$P(SRICDSTR,U,2)_"-"_$P(SRICDSTR,U,4)
"RTN","SROADX1",64,0)
 Q SRICDSTR
"RTN","SROADX1",65,0)
PASSDS() N SRPADX,SRASSDS,SRPX
"RTN","SROADX1",66,0)
 S SRASSDS="",SRPADX=0
"RTN","SROADX1",67,0)
 F SRI=1:1 S SRPADX=$O(^SRF(SRTN,"PADX",SRPADX)) Q:'SRPADX  D
"RTN","SROADX1",68,0)
 .S SRPX=^SRF(SRTN,"PADX",SRPADX,0)
"RTN","SROADX1",69,0)
 .S SRPX=SRPX+1
"RTN","SROADX1",70,0)
 .S SRASSDS=$S($L(SRASSDS)<1:SRPX,1:SRASSDS_","_SRPX)
"RTN","SROADX1",71,0)
 Q SRASSDS
"RTN","SROADX1",72,0)
OASSDS() N SRPADX,SRASSDS,SRPX
"RTN","SROADX1",73,0)
 S SRASSDS="",SRPADX=0
"RTN","SROADX1",74,0)
 F SRI=1:1 S SRPADX=$O(^SRF(SRTN,13,D0,"OADX",SRPADX)) Q:'SRPADX  D
"RTN","SROADX1",75,0)
 .S SRPX=^SRF(SRTN,13,D0,"OADX",SRPADX,0)
"RTN","SROADX1",76,0)
 .S SRPX=SRPX+1
"RTN","SROADX1",77,0)
 .S SRASSDS=$S($L(SRASSDS)<1:SRPX,1:SRASSDS_","_SRPX)
"RTN","SROADX1",78,0)
 Q SRASSDS
"RTN","SROADX1",79,0)
SRODIR N SRFLG,SRCNT,SRCNTR
"RTN","SROADX1",80,0)
 S DIR("A",1)=""
"RTN","SROADX1",81,0)
 S (SRFLG,SRCNT)=1,SRCNTR=2,ADCNT=""
"RTN","SROADX1",82,0)
 F  S ADCNT=$O(SRDIRX(ADCNT)) Q:'ADCNT  D
"RTN","SROADX1",83,0)
 .S:'$D(DIR("A",SRCNTR)) DIR("A",SRCNTR)=""
"RTN","SROADX1",84,0)
 .S DIR("A",SRCNTR)=DIR("A",SRCNTR)_SRCNT_". "_SRDIRX(ADCNT),SRCNT=SRCNT+1,SRCNTR=SRCNTR+1,SRFLG=1
"RTN","SROADX1",85,0)
 S DIR("A",SRCNTR+2)=SRODIR("A",1),DIR("A")=SRODIR("A"),DIR("A",SRCNTR+1)=""
"RTN","SROADX1",86,0)
 Q
"RTN","SROADX1",87,0)
COTHBLD N SRCNT,OTH,X,CPT,CPT1,SRDA K SRSEL
"RTN","SROADX1",88,0)
 S OTH=0,SRCNT=1
"RTN","SROADX1",89,0)
 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH  D
"RTN","SROADX1",90,0)
 .S OTHER=$P(^SRF(SRTN,13,OTH,0),U)
"RTN","SROADX1",91,0)
 .S X=$P($G(^SRF(SRTN,13,OTH,2)),U),CPT="NOT ENTERED",CPT1=""
"RTN","SROADX1",92,0)
 .I X S CPT1=X,Y=$$CPT^ICPTCOD(X),SRCPT=$P(Y,U,2),SRSHT=$P(Y,U,3),Y=SRCPT,SRDA=OTH D SSOTH^SROCPT S SRCPT=Y,CPT=SRCPT_"  "_SRSHT
"RTN","SROADX1",93,0)
 .S SRSEL(SRCNT)=OTH_U_OTHER_"^CPT Code: "_CPT_U_CPT1
"RTN","SROADX1",94,0)
 .S SRCNT=SRCNT+1
"RTN","SROADX1",95,0)
 Q
"RTN","SROADX1",96,0)
OTHADXD N SRCOMMA,SROADX,SRICD9,SROADX1,SROODX,SRASSD,SRSUB ;OTHER PROCS ADXs
"RTN","SROADX1",97,0)
 I '$O(^SRF(SRTN,13,OTH,"OADX",0)) W !,?5,SRMSG Q
"RTN","SROADX1",98,0)
 S SRSUB=1
"RTN","SROADX1",99,0)
 D OTHADX
"RTN","SROADX1",100,0)
 Q
"RTN","SROADX1",101,0)
PADXD N SRCOMMA,SRPADX,SRICD9,SRPDX,SRPDX1,SROPRIN,SRSUB
"RTN","SROADX1",102,0)
 S SRPADX=0,SROCNTR=2,SRSUB=1
"RTN","SROADX1",103,0)
 D ADXCHK^SROADX2
"RTN","SROADX1",104,0)
 I '$O(^SRF(SRTN,"PADX",0)),(($P($G(^SRF(SRTN,34)),U)'="")!($P($G(^SRF(SRTN,34)),U,2))),(($P($G(^SRF(SRTN,"OP")),U)'="")!($P($G(^SRF(SRTN,"OP")),U,2))) D
"RTN","SROADX1",105,0)
 .S SRASSD=0,SRFDA="130.275",SRIENU="+1"_","_SRTN_",",SRIENF=0_","_SRTN_"," D UPDATE,FILE
"RTN","SROADX1",106,0)
 D ASDX
"RTN","SROADX1",107,0)
 Q
"RTN","SROADX1",108,0)
ADXDISP N SROCNTR ;ADXS for PROC
"RTN","SROADX1",109,0)
 W !,?5,"Assoc. DX"_$$ICDSTR^SROICD(SRTN)_": "
"RTN","SROADX1",110,0)
 S (SROCNTR,SRDXCNT)=0
"RTN","SROADX1",111,0)
 F I=1:1  S SROCNTR=$O(SRTMP(SROCNTR)) Q:'SROCNTR  D
"RTN","SROADX1",112,0)
 .I $D(SRSUB) D
"RTN","SROADX1",113,0)
 ..W:'(I#2) ?48
"RTN","SROADX1",114,0)
 ..W:I#2 ?16
"RTN","SROADX1",115,0)
 ..W I,". ",$E(SRTMP(SROCNTR),1,25)
"RTN","SROADX1",116,0)
 ..I '(I#2),($O(SRTMP(SROCNTR))) W !
"RTN","SROADX1",117,0)
 .W:'$D(SRSUB) !,?8,I,". ",SRTMP(SROCNTR)
"RTN","SROADX1",118,0)
 S SRDXCNT=I
"RTN","SROADX1",119,0)
 S SRDX1="LO^:"_SRDXCNT
"RTN","SROADX1",120,0)
 S:SRDXCNT>0 SRDX1="LO^:"_SRDXCNT
"RTN","SROADX1",121,0)
 Q
"RTN","SROADX1",122,0)
OTHCPTD N SRM,SRI,SRFIRST ;PROCS/Codes/Mods.
"RTN","SROADX1",123,0)
 S SRFIRST=0
"RTN","SROADX1",124,0)
 W !,?3,"Other Procedures:",!!,OTHCNT,"."
"RTN","SROADX1",125,0)
 D COTHBLD
"RTN","SROADX1",126,0)
 W ?3,$P(SRSEL(SRDA),U,2),!,?2,"Other ",$P(SRSEL(SRDA),U,3)
"RTN","SROADX1",127,0)
 S OTH=$P(SRSEL(SRDA),U) K SRDES S CPT1=$P(SRSEL(SRDA),U,4),X=$$CPTD^ICPTCOD(CPT1,"SRDES") I $O(SRDES(0)) F I=1:1:X W !,?4,SRDES(I)
"RTN","SROADX1",128,0)
 W !,?3,"Modifiers: "
"RTN","SROADX1",129,0)
 S SRI=0
"RTN","SROADX1",130,0)
 F  S SRI=$O(^SRF(SRTN,13,OTH,"MOD",SRI)) Q:'SRI  D
"RTN","SROADX1",131,0)
 .S SRM=$P(^SRF(SRTN,13,OTH,"MOD",SRI,0),U)
"RTN","SROADX1",132,0)
 .W:SRFIRST !,?14
"RTN","SROADX1",133,0)
 .W $P($$MOD^ICPTMOD(SRM,"I"),"^",2),"-",$P($$MOD^ICPTMOD(SRM,"I"),"^",3)
"RTN","SROADX1",134,0)
 .S SRFIRST=1
"RTN","SROADX1",135,0)
 Q
"RTN","SROADX1",136,0)
CPTDISP S X=$P(^SRF(SRTN,"OP"),U,2) I X D  W !
"RTN","SROADX1",137,0)
 .S SRY=$$CPT^ICPTCOD(X),Y=$P(SRY,U,2),(SROCPT2,Z)=$P(SRY,U,3)
"RTN","SROADX1",138,0)
 S:'$D(Y) Y="NOT ENTERED",Z=""
"RTN","SROADX1",139,0)
 W "  CPT Code: "_Y_"  ",Z,!,"  Description:" D ^SROCPT W ! F I=1:1:80 W "-"
"RTN","SROADX1",140,0)
 W !,?3,"Principal CPT Code: "_Y_"  ",!,?3,"Description:",Z,!,?3,"Modifiers: "
"RTN","SROADX1",141,0)
 S SRMOD=0
"RTN","SROADX1",142,0)
 F  S SRMOD=$O(^SRF(SRTN,"OPMOD",SRMOD)) Q:'SRMOD  D
"RTN","SROADX1",143,0)
 .S SRMO=$P(^SRF(SRTN,"OPMOD",SRMOD,0),U)
"RTN","SROADX1",144,0)
 .W:$G(SRFIRST) !,?14
"RTN","SROADX1",145,0)
 .W $P($$MOD^ICPTMOD(SRMO,"I"),"^",2),"-",$P($$MOD^ICPTMOD(SRMO,"I"),"^",3)
"RTN","SROADX1",146,0)
 .S SRFIRST=1
"RTN","SROADX1",147,0)
 Q
"RTN","SROADX1",148,0)
PADDALL Q:$E($G(IOST))'="C"!($G(DIK)'="")
"RTN","SROADX1",149,0)
 D KPADX^SROADX2(DA)
"RTN","SROADX1",150,0)
 N DIE,DR,DA,PADX,SRY,SRY1,SRICD9,SRCNTRN,SRIENU,SRIENF,SRASSD
"RTN","SROADX1",151,0)
 S SRY(0)=Y(0),SRFDA="130.275",SRIENU="+1"_","_SRTN_","
"RTN","SROADX1",152,0)
 S SRICD9=$P($G(^SRF(SRTN,34)),U,2),SRCNTR=1,SRIENF=SRCNTR_","_SRTN_",",SRASSD=0
"RTN","SROADX1",153,0)
 K SRY1 D UPDATE,FILE
"RTN","SROADX1",154,0)
 S PADX=0
"RTN","SROADX1",155,0)
 F  S PADX=$O(^SRF(SRTN,15,PADX)) Q:'PADX  S SRASSD=PADX,SRICD9=$P(^SRF(SRTN,15,SRASSD,0),U,3),SRCNTR=SRCNTR+1,SRIENF=SRCNTR_","_SRTN_"," K SRY1 D UPDATE,FILE
"RTN","SROADX1",156,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",157,0)
 Q
"RTN","SROADX1",158,0)
PADD1 ;PRIN ADX
"RTN","SROADX1",159,0)
 N SRY,SRY0,SRY1,SRY2,SRC,REC,DIE,DA,DR,SRASSD
"RTN","SROADX1",160,0)
 S SRY(0)=Y(0)
"RTN","SROADX1",161,0)
 D KPADX^SROADX2(SRTN)
"RTN","SROADX1",162,0)
 S SRCNTR=0,SRASSD=SRADIAG($P(SRY(0),",",1)),SRFDA="130.275",SRIENU="+1"_","_SRTN_",",SRIENF=SRCNTR_","_SRTN_"," D UPDATE,FILE
"RTN","SROADX1",163,0)
 S SRY(0)=$E(SRY(0),2,$L(SRY(0)))
"RTN","SROADX1",164,0)
 F SRY2=1:1:$P(SRDX2,":",2) D
"RTN","SROADX1",165,0)
 .S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROADX1",166,0)
 .Q:SRY0<1
"RTN","SROADX1",167,0)
 .S SRCNTR=$P(^SRF(SRTN,"PADX",0),U,3)+1,SRASSD=SRADIAG(SRY0),SRFDA="130.275",SRIENU="+1"_","_SRTN_",",SRIENF=SRCNTR_","_SRTN_"," D UPDATE,FILE
"RTN","SROADX1",168,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",169,0)
 Q
"RTN","SROADX1",170,0)
UPDATE ;
"RTN","SROADX1",171,0)
 S SRY1(SRFDA,SRIENU,".01")=SRASSD
"RTN","SROADX1",172,0)
 D UPDATE^DIE("","SRY1")
"RTN","SROADX1",173,0)
 Q
"RTN","SROADX1",174,0)
FILE ;
"RTN","SROADX1",175,0)
 S SRY1(SRFDA,SRIENF,".01")=SRASSD
"RTN","SROADX1",176,0)
 D FILE^DIE("","SRY1")
"RTN","SROADX1",177,0)
 K SRY1
"RTN","SROADX1",178,0)
 Q
"RTN","SROADX1",179,0)
PDELALL W !,"Are you sure you want to DELETE ALL Associated Diagnoses ? (Y/N) "
"RTN","SROADX1",180,0)
 S SRY(0)=Y(0)
"RTN","SROADX1",181,0)
 S %=2 D YN^DICN
"RTN","SROADX1",182,0)
 I %=1 Q:$E($G(IOST))'="C"!($G(DIK)'="")  D KPADX^SROADX2(DA)
"RTN","SROADX1",183,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",184,0)
 Q
"RTN","SROADX1",185,0)
PDEL1 N SRC,SRY,SRY1,SRY2,REC,SRICD9,SRASSD ;DEL 1 PRIN ADX
"RTN","SROADX1",186,0)
 S (SRY,SRY0)=0
"RTN","SROADX1",187,0)
 F  S SRY=$O(^SRF(SRTN,"PADX",SRY)) Q:'SRY  S SRY0=SRY0+1,REC(SRY0)=SRY
"RTN","SROADX1",188,0)
 S SRY(0)=Y(0),SRFDA="130.275"
"RTN","SROADX1",189,0)
 F SRY2=1:1:SRDXCNT D
"RTN","SROADX1",190,0)
 .S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROADX1",191,0)
 .Q:'SRY0
"RTN","SROADX1",192,0)
 .Q:'$D(REC(SRY0))
"RTN","SROADX1",193,0)
 .I SRY0=1,$P(^SRF(SRTN,"PADX",0),U,4)>1 K SRC S SRC(1)="PLEASE DELETE ALL DIAGNOSIS BEFORE THE PRINCIPAL",SRC(1,"F")="!!?5" D SRCWRT K SRC Q 
"RTN","SROADX1",194,0)
 .S SRIENF=REC(SRY0)_","_SRTN_",",SRASSD="@"
"RTN","SROADX1",195,0)
 .W !,"Are you sure you want to DELETE ",SRTMP(SRY0)," ? (Y/N) "
"RTN","SROADX1",196,0)
 .S %=2 D YN^DICN
"RTN","SROADX1",197,0)
 .I %=1 D FILE
"RTN","SROADX1",198,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",199,0)
 Q
"RTN","SROADX1",200,0)
ODEL1 N SRY,SRY0,SRY1,SRY2,SRASSD ;DEL 1 OTH ADX
"RTN","SROADX1",201,0)
 S (SRY,SRY0)=0
"RTN","SROADX1",202,0)
 F  S SRY=$O(^SRF(SRTN,13,OTH,"OADX",SRY)) Q:'SRY  S SRY0=SRY0+1,REC(SRY0)=SRY
"RTN","SROADX1",203,0)
 S SRY(0)=Y(0),SRFDA="130.165"
"RTN","SROADX1",204,0)
 F SRY2=1:1:SRDXCNT D
"RTN","SROADX1",205,0)
 .S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROADX1",206,0)
 .Q:'SRY0
"RTN","SROADX1",207,0)
 .S SRIENF=REC(SRY0)_","_OTH_","_SRTN_",",SRASSD="@"
"RTN","SROADX1",208,0)
 .W !,"Are you sure you want to DELETE ",SRTMP(SRY0)," ? (Y/N) "
"RTN","SROADX1",209,0)
 .Q:SRTMP(SRY0)=""
"RTN","SROADX1",210,0)
 .S %=2 D YN^DICN
"RTN","SROADX1",211,0)
 .I %=1 D FILE
"RTN","SROADX1",212,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",213,0)
 Q
"RTN","SROADX1",214,0)
OADDALL Q:$E($G(IOST))'="C"!($G(DIK)'="")  D KOADX^SROADX2(SRTN,OTH) ;Associate all Diagnosis to OTHER Procedure
"RTN","SROADX1",215,0)
 N SRICD9,PADX,SRFDA,SRIENU,SRIENF,SRY,SRY1
"RTN","SROADX1",216,0)
 S SRY(0)=Y(0),SRFDA="130.165",SRIENU="+1"_","_OTH_","_SRTN_","
"RTN","SROADX1",217,0)
 S PADX=0
"RTN","SROADX1",218,0)
 F  S PADX=$O(SRADIAG(PADX)) Q:'PADX  S SRASSD=SRADIAG(PADX),SRIENF=PADX_","_OTH_","_SRTN_"," K SRY1 D UPDATE,FILE
"RTN","SROADX1",219,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",220,0)
 Q
"RTN","SROADX1",221,0)
OADD1 N SRY,SRY0,SRY1,SRY2,SRCNTR,SRASSD ;Associate 1 Diagnosis to OTHER Procedure
"RTN","SROADX1",222,0)
 S SRY(0)=Y(0),SRCNTR=0
"RTN","SROADX1",223,0)
 S:$D(^SRF(SRTN,13,OTH,"OADX")) SRCNTR=$P(^SRF(SRTN,13,OTH,"OADX",0),U,3)+1
"RTN","SROADX1",224,0)
 D KOADX^SROADX2(SRTN,OTH)
"RTN","SROADX1",225,0)
 S:'$D(^SRF(SRTN,13,OTH,"OADX")) SRCNTR=1
"RTN","SROADX1",226,0)
 S SRFDA="130.165",SRIENU="+1"_","_OTH_","_SRTN_","
"RTN","SROADX1",227,0)
 I SRDIRX(+Y)="ALL" D
"RTN","SROADX1",228,0)
 .S SRY0=0
"RTN","SROADX1",229,0)
 .F  S SRY0=$O(SRADIAG(SRY0)) Q:'SRY0  D
"RTN","SROADX1",230,0)
 ..I '$D(^SRF(SRTN,13,OTH,"OADX","B",SRADIAG(SRY0))) D
"RTN","SROADX1",231,0)
 ..S SRASSD=SRADIAG(SRY0),SRIENF=SRCNTR_","_OTH_","_SRTN_"," K SRY1 D UPDATE,FILE
"RTN","SROADX1",232,0)
 ..S SRCNTR=SRCNTR+1
"RTN","SROADX1",233,0)
 I SRDIRX(+Y)'="ALL" D
"RTN","SROADX1",234,0)
 .F SRY2=1:1:$P(SRDX2,":",2) D
"RTN","SROADX1",235,0)
 ..S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROADX1",236,0)
 ..Q:'SRY0
"RTN","SROADX1",237,0)
 ..S SRASSD=SRADIAG(SRY0),SRIENF=SRCNTR_","_OTH_","_SRTN_"," K SRY1 D UPDATE,FILE
"RTN","SROADX1",238,0)
 ..S SRCNTR=SRCNTR+1
"RTN","SROADX1",239,0)
 S Y(0)=SRY(0)
"RTN","SROADX1",240,0)
 Q
"RTN","SROADX1",241,0)
SRCMSG S SRDX=X
"RTN","SROADX1",242,0)
 S SRC(1)="The Diagnosis/Procedure Code Association may no longer be correct,",SRC(1,"F")="!!?5"
"RTN","SROADX1",243,0)
 S SRC(2)="please confirm or update the values in the Diagnosis Association Field",SRC(2,"F")="!?5"
"RTN","SROADX1",244,0)
 Q
"RTN","SROADX1",245,0)
SRCWRT D EN^DDIOL(.SRC)
"RTN","SROADX1",246,0)
 D CONT
"RTN","SROADX1",247,0)
 Q:$G(DTOUT)
"RTN","SROADX1",248,0)
 S:$D(SRDX) X=SRDX
"RTN","SROADX1",249,0)
 S SRFLG=1
"RTN","SROADX1",250,0)
 Q
"RTN","SROADX1",251,0)
CONT N DIR
"RTN","SROADX1",252,0)
 S DIR(0)="FO^"
"RTN","SROADX1",253,0)
 S DIR("A")="Press RETURN to continue  "
"RTN","SROADX1",254,0)
 D ^DIR
"RTN","SROADX1",255,0)
 Q
"RTN","SROADX1",256,0)
ADXKILL K ADCNT,SRCOMMA,SRDXCNT,SROCNTR,SROCPT2,SROFLG,SRTMP,SRICD9,SRDIAGS
"RTN","SROADX1",257,0)
 K SRASDX,SRMSG,SRADX,SRPADX,SRODIR,REC,SRDIRX,SROANS
"RTN","SROADX1",258,0)
 Q
"RTN","SROALNO")
0^45^B15400695^B15168639
"RTN","SROALNO",1,0)
SROALNO ;B'HAM ISC/MAM - SELECT CASE WITHOUT ASSESS ; 2 MAR 1992  3:35 pm
"RTN","SROALNO",2,0)
 ;;3.0;Surgery;**104,177**;24 Jun 93;Build 89
"RTN","SROALNO",3,0)
 W ! S (SRDT,CNT)=0 F I=0:0 S SRDT=$O(^SRF("ADT",DFN,SRDT)) Q:'SRDT!(SRSOUT)  S SROP=0 F I=0:0 S SROP=$O(^SRF("ADT",DFN,SRDT,SROP)) Q:'SROP!($D(SRTN))!(SRSOUT)  D LIST
"RTN","SROALNO",4,0)
 I $D(SRTN) Q
"RTN","SROALNO",5,0)
OPT W !!!,"Select Operation: " R X:DTIME I '$T!("^"[X) S SRSOUT=1 G END
"RTN","SROALNO",6,0)
 I '$D(SRCASE(X)) W !!,"Enter the number corresponding to the surgical case for which you will be",!,"creating a surgical risk assessment." G OPT
"RTN","SROALNO",7,0)
 I X=CNT G ^SRONEW
"RTN","SROALNO",8,0)
 S SRTN=+SRCASE(X)
"RTN","SROALNO",9,0)
ENTER ; edit or delete
"RTN","SROALNO",10,0)
 W @IOF,!,?1,VADM(1)_"  "_VA("PID"),!!,?1 S SROP=SRTN,SRSDATE=$P(^SRF(SRTN,0),"^",9) D CASE
"RTN","SROALNO",11,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SROALNO",12,0)
 W !!,"1. Enter Information",!,"2. Review Information",!,"3. Delete Surgery Case",!!,"Select Number:  1//  " R X:DTIME I '$T!(X["^") S SRSOUT=1 G END
"RTN","SROALNO",13,0)
 S:X="" X=1 I X<1!(X>3)!(X'?.N) D HELP G ENTER
"RTN","SROALNO",14,0)
 I X=3 D ^SROPDEL G END
"RTN","SROALNO",15,0)
 I X=2 D RT K DR S ST="REVIEW" D EN2^SROVAR S Q3("VIEW")="",DR="[SROMEN-OPER]",DA=SRTN,DIE=130 D ^SRCUSS K Q3("VIEW") G END
"RTN","SROALNO",16,0)
 Q
"RTN","SROALNO",17,0)
LIST ; list cases
"RTN","SROALNO",18,0)
 I $P($G(^SRF(SROP,"NON")),"^")="Y" Q
"RTN","SROALNO",19,0)
 S SRSCAN=1 I $D(^SRF(SROP,.2)),$P(^(.2),"^",12)'="" K SRSCAN
"RTN","SROALNO",20,0)
 I $D(SRSCAN),$D(^SRF(SROP,30)),$P(^(30),"^") Q
"RTN","SROALNO",21,0)
 I $D(SRSCAN),$D(^SRF(SROP,31)),$P(^(31),"^",8) Q
"RTN","SROALNO",22,0)
 I $D(^SRF(SROP,37)),$P(^(37),"^") Q
"RTN","SROALNO",23,0)
 I $Y+5>IOSL S SRBACK=0 D SEL^SROPER Q:$D(SRTN)!(SRSOUT)  D:'SRBACK HDR I SRBACK S CNT=0,SROP=SRCASE(1)-1,SRDT=$P(SRCASE(1),"^",2) W @IOF,!,?1,VADM(1)_"   "_VA("PID"),! Q
"RTN","SROALNO",24,0)
 S CNT=CNT+1,SRSDATE=$P(^SRF(SROP,0),"^",9)
"RTN","SROALNO",25,0)
 W !,CNT_". "
"RTN","SROALNO",26,0)
CASE W $E(SRSDATE,4,5)_"-"_$E(SRSDATE,6,7)_"-"_$E(SRSDATE,2,3)
"RTN","SROALNO",27,0)
 S SROPER=$P(^SRF(SROP,"OP"),"^") I $O(^SRF(SROP,13,0)) S SROTHER=0 F I=0:0 S SROTHER=$O(^SRF(SROP,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROALNO",28,0)
 D ^SROP1 K SROPS,MM,MMM S:$L(SROPER)<65 SROPS(1)=SROPER I $L(SROPER)>64 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROALNO",29,0)
 W ?14,SROPS(1) I $D(SROPS(2)) W !,?14,SROPS(2) I $D(SROPS(3)) W !,?14,SROPS(3) W:$D(SROPS(4)) !,?14,SROPS(4)
"RTN","SROALNO",30,0)
 W ! S SRCASE(CNT)=SROP_"^"_SRDT
"RTN","SROALNO",31,0)
 Q
"RTN","SROALNO",32,0)
OTHER ; other operations
"RTN","SROALNO",33,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SROP,13,SROTHER,0),"^"))>235 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROALNO",34,0)
 I SRLONG S SROPERS=$P(^SRF(SROP,13,SROTHER,0),"^")
"RTN","SROALNO",35,0)
 S SROPER=SROPER_$S(SROPERS=" ...":SROPERS,1:", "_SROPERS)
"RTN","SROALNO",36,0)
 Q
"RTN","SROALNO",37,0)
LOOP ; break procedures
"RTN","SROALNO",38,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<65  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROALNO",39,0)
 Q
"RTN","SROALNO",40,0)
END K SRTN D ^SRSKILL W @IOF
"RTN","SROALNO",41,0)
 Q
"RTN","SROALNO",42,0)
HELP W !!,"Enter RETURN or '1' to enter or edit information contained within one of the",!,"options found under the Operations Menu.  If you want to display a two screen",!,"overview of this case, enter '2'."
"RTN","SROALNO",43,0)
 W "  To delete this case from your records,",!,"enter '3'.  Please note that deleting a case will remove EVERYTHING pertaining",!,"to this operative procedure.",!
"RTN","SROALNO",44,0)
 W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SROALNO",45,0)
 Q
"RTN","SROALNO",46,0)
RT ; start RT logging
"RTN","SROALNO",47,0)
 I $D(XRTL) S XRTN="SROP" D T0^%ZOSV
"RTN","SROALNO",48,0)
 Q
"RTN","SROALNO",49,0)
HDR ; print heading
"RTN","SROALNO",50,0)
 W @IOF,!,?1,VADM(1)_"   "_VA("PID")
"RTN","SROALNO",51,0)
 Q
"RTN","SROAOP1")
0^8^B11530418^B11582758
"RTN","SROAOP1",1,0)
SROAOP1 ;BIR/MAM - SET OPERATION INFO ;02/28/07
"RTN","SROAOP1",2,0)
 ;;3.0;Surgery;**38,47,63,81,88,95,97,125,142,153,160,177**;24 Jun 93;Build 89
"RTN","SROAOP1",3,0)
 N SRCSTAT K SRA,SRAO F I=0,200,"OP" S SRA(I)=$G(^SRF(SRTN,I))
"RTN","SROAOP1",4,0)
 S SRDOC="Surgeon: "_$P(^VA(200,$P(^SRF(SRTN,.1),"^",4),0),"^") F I=3,4,5 S SRAO(I)=""
"RTN","SROAOP1",5,0)
 K SROPS S SROPER=$P(SRA("OP"),"^")
"RTN","SROAOP1",6,0)
 S SRAO(2)="^26"
"RTN","SROAOP1",7,0)
 S:$L(SROPER)<49 SROPS(1)=SROPER K M,MM,MMM I $L(SROPER)>48 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROAOP1",8,0)
 S X=$P(SRA(0),"^",4) S:X X=$P(^SRO(137.45,X,0),"^",1) S SRAO(1)=X_"^.04"
"RTN","SROAOP1",9,0)
 S SRHDR(.5)=SRDOC,SRPAGE="PAGE: 1 OF 2"
"RTN","SROAOP1",10,0)
 S SRCSTAT=">> Coding "_$S($P($G(^SRO(136,SRTN,10)),"^"):"",1:"Not ")_"Complete <<"
"RTN","SROAOP1",11,0)
 D HDR^SROAUTL
"RTN","SROAOP1",12,0)
 S X=$P($G(^SRO(136,SRTN,0)),"^",3) S:X X=$$ICD^SROICD(SRTN,X),X=$P(X,"^",2)_"   "_$P(X,"^",4)
"RTN","SROAOP1",13,0)
 W "Postop Diagnosis Code "_$$ICDSTR^SROICD(SRTN)_": ",$S(X'="":X,1:"NOT ENTERED"),!
"RTN","SROAOP1",14,0)
 W !," 1. Surgical Specialty: ",?33,$P(SRAO(1),"^"),!," 2. Principal Operation: ",?33,SROPS(1) I $D(SROPS(2)) W !,?33,SROPS(2) I $D(SROPS(3)) W !,?33,SROPS(3) I $D(SROPS(4)) W !,?33,SROPS(4)
"RTN","SROAOP1",15,0)
 N SRPROC,SRL S SRL=49 D CPTS^SROAUTL0 W !," 3. CPT Codes (view only):" I SRPROC(1)="" S SRPROC(1)="NOT ENTERED"
"RTN","SROAOP1",16,0)
 F I=1:1 Q:'$D(SRPROC(I))  W:I=1 ?33,SRPROC(I) W:I'=1 !,?33,SRPROC(I)
"RTN","SROAOP1",17,0)
 W !," 4. Other Procedures:" W:$O(^SRF(SRTN,13,0)) ?33,"***INFORMATION ENTERED***"
"RTN","SROAOP1",18,0)
 W !," 5. Concurrent Procedure:" S CON=$P($G(^SRF(SRTN,"CON")),"^") I CON,'($P($G(^SRF(CON,30)),"^")!($P($G(^SRF(CON,31)),"^",8))) W ?33,"***INFORMATION ENTERED***"
"RTN","SROAOP1",19,0)
 S X=$P(SRA(200),"^",52),SRAO(6)=X_"^214",NYUK=$P(SRA(0),"^",10) D EMERG S SRAO(7)=SHEMP_"^.035"
"RTN","SROAOP1",20,0)
 S Y=$P($G(^SRF(SRTN,"1.0")),"^",8),C=$P(^DD(130,1.09,0),"^",2) D:Y'="" Y^DIQ S SRAO(8)=Y_"^1.09"
"RTN","SROAOP1",21,0)
 S Y=$P($G(^SRF(SRTN,1.1)),"^",3),C=$P(^DD(130,1.13,0),"^",2) D:Y'="" Y^DIQ S SRAO(9)=Y_"^1.13"
"RTN","SROAOP1",22,0)
 D TECH^SROPRIN S SRAO(10)=SRTECH
"RTN","SROAOP1",23,0)
 S X=$P(SRA(200),"^",54),SRAO(11)=X_"^340" K SRA(.2)
"RTN","SROAOP1",24,0)
 S Y=$P($G(^SRF(SRTN,200.1)),"^",4) D
"RTN","SROAOP1",25,0)
 .I Y="" S (Y,$P(^SRF(SRTN,200.1),"^",4))="N"
"RTN","SROAOP1",26,0)
 .S C=$P(^DD(130,443,0),"^",2) D:Y'="" Y^DIQ S SRAO(12)=Y_"^443"
"RTN","SROAOP1",27,0)
 S Y=$P($G(^SRF(SRTN,200.1)),"^",6) D
"RTN","SROAOP1",28,0)
 .I Y="" S (Y,$P(^SRF(SRTN,200.1),"^",6))="N"
"RTN","SROAOP1",29,0)
 .S C=$P(^DD(130,446,0),"^",2) D:Y'="" Y^DIQ S SRAO(13)=Y_"^446"
"RTN","SROAOP1",30,0)
 W !," 6. PGY of Primary Surgeon:",?33,$P(SRAO(6),"^"),!," 7. Surgical Priority:",?33,$P(SRAO(7),"^"),!," 8. Wound Classification: ",?33,$P(SRAO(8),"^")
"RTN","SROAOP1",31,0)
 W !," 9. ASA Classification:",?33,$P(SRAO(9),"^")
"RTN","SROAOP1",32,0)
 W !,"10. Princ. Anesthesia Technique: ",$P(SRAO(10),"^")
"RTN","SROAOP1",33,0)
 W !,"11. RBC Units Transfused:",?33,$P(SRAO(11),"^")
"RTN","SROAOP1",34,0)
 W !,"12. Intraop Disseminated Cancer:",?33,$P(SRAO(12),"^")
"RTN","SROAOP1",35,0)
 W !,"13. Intraoperative Ascites:",?33,$P(SRAO(13),"^")
"RTN","SROAOP1",36,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROAOP1",37,0)
 Q
"RTN","SROAOP1",38,0)
YN S SHEMP=$S(NYUK="NS":"NS",NYUK="N":"NO",NYUK="Y":"YES",1:"")
"RTN","SROAOP1",39,0)
 Q
"RTN","SROAOP1",40,0)
LOOP ; break procedures
"RTN","SROAOP1",41,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<49  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROAOP1",42,0)
 Q
"RTN","SROAOP1",43,0)
EMERG ; surgical priority
"RTN","SROAOP1",44,0)
 I NYUK="" S SHEMP="" Q
"RTN","SROAOP1",45,0)
 S Y=NYUK,C=$P(^DD(130,.035,0),"^",2) D Y^DIQ S SHEMP=Y
"RTN","SROAOP1",46,0)
 Q
"RTN","SROAOSET")
0^18^B4150779^B3998437
"RTN","SROAOSET",1,0)
SROAOSET ;B'HAM ISC/MAM - SET SRAO ARRAY ; 17 MAR 1992 1:55 pm
"RTN","SROAOSET",2,0)
 ;;3.0;Surgery;**127,177**;24 Jun 93;Build 89
"RTN","SROAOSET",3,0)
 S SRA(0)=^SRF(SRTN,0),SRA(34)=$G(^SRF(SRTN,34)),X=$P(SRA(34),"^",2) S:X X=$$ICD^SROICD(SRTN,X),X=$P(X,"^",2)_"   "_$P(X,"^",4) S SRAO(1)=X_"^66" K SRA(34)
"RTN","SROAOSET",4,0)
 S SRA(205)=$G(^SRF(SRTN,205)),X=$P(SRA(205),"^") S:X X=X_" DAYS" S SRAO(2)=X_"^247"
"RTN","SROAOSET",5,0)
 S X=$P(SRA(205),"^",2),X=$S(X="":"",X=1:"DISCHARGED ALIVE",X=2:"DIED IN HOSPITAL",X=3:"REMAINS IN VAMC FACILITY",X=4:"TRANSFERRED TO ANOTHER VAMC",X=5:"READMITTED",X="NS":"NO STUDY",1:"")
"RTN","SROAOSET",6,0)
 S SRAO(3)=X_"^341"
"RTN","SROAOSET",7,0)
DISP W @IOF,!,SRANAME,?65,"PAGE: 1",! F MOE=1:1:80 W "-"
"RTN","SROAOSET",8,0)
 W !,"1. Postoperative Diagnosis Code "_$$ICDSTR^SROICD(SRTN)_":",?43,$P(SRAO(1),"^"),!,"2. Length of Postoperative Hospital Stay:",?43,$P(SRAO(2),"^"),!,"3. 30 Day Postoperative Status:",?43,$P(SRAO(3),"^")
"RTN","SROAOSET",9,0)
 W ! F MOE=1:1:80 W "-"
"RTN","SROAOSET",10,0)
 Q
"RTN","SROAOSET",11,0)
YN ;
"RTN","SROAOSET",12,0)
 S SHEMP=$S(NYUK="NS":"NS",NYUK="N":"NO",NYUK="Y":"YES",1:"")
"RTN","SROAOSET",13,0)
 Q
"RTN","SROAPCA4")
0^32^B16258498^B15333948
"RTN","SROAPCA4",1,0)
SROAPCA4 ;BIR/SJA - CARDIAC COMPLIANCE DATA ;09/01/2011
"RTN","SROAPCA4",2,0)
 ;;3.0;Surgery;**95,125,153,174,176,177**;24 Jun 93;Build 89
"RTN","SROAPCA4",3,0)
 ;
"RTN","SROAPCA4",4,0)
 ; Reference to ^DGPM("APTT1" supported by DBIA #565
"RTN","SROAPCA4",5,0)
 ; Reference to File #405 supported by DBIA #3029
"RTN","SROAPCA4",6,0)
 ; Reference to Field #27.02 in File #2 supported by DBIA #1850
"RTN","SROAPCA4",7,0)
 ;
"RTN","SROAPCA4",8,0)
 S SRA(201)=$G(^SRF(SRTN,201)),SRA(202)=$G(^SRF(SRTN,202)),SRA(208)=$G(^SRF(SRTN,208)),SRA(0)=$G(^SRF(SRTN,0)),SRA(202.1)=$G(^SRF(SRTN,202.1))
"RTN","SROAPCA4",9,0)
 N SRPREF,SRREF,SRREFP,SRFOL,SRFOLP,SRSOUT,SRY S (SRPREF,SRREF,SRREFP,SRFOL,SRFOLP)="",SRSOUT=0,(VAIP("D"),SRSDATE)=$P(SRA(0),"^",9) D IN5^VADPT
"RTN","SROAPCA4",10,0)
 I 'VAIP(13) S X1=$P($G(^SRF(SRTN,.2)),"^",12),X2=1 D C^%DTC S SR24=X,SRDT=$O(^DGPM("APTT1",DFN,SRSDATE)) G:'SRDT!(SRDT>SR24) TS S VAIP("D")=SRDT D IN5^VADPT
"RTN","SROAPCA4",11,0)
TS I VAIP(13) K DA,DIC,DIQ,DR S DIC=405,DR=.05,DA=VAIP(13),DIQ="SRY",DIQ(0)="IE" D EN^DIQ1 S SRREF=SRY(405,VAIP(13),.05,"E"),SRREFP=SRY(405,VAIP(13),.05,"I") I SRREFP S SRREFP=$$GET1^DIQ(4,SRREFP,99)
"RTN","SROAPCA4",12,0)
 I VAIP(17) K DA,DIC,DIQ,DR,SRY S DIC=405,DR=.05,DA=VAIP(17),DIQ="SRY",DIQ(0)="IE" D EN^DIQ1 S SRFOL=SRY(405,VAIP(17),.05,"E"),SRFOLP=SRY(405,VAIP(17),.05,"I") I SRFOLP S SRFOLP=$$GET1^DIQ(4,SRFOLP,99)
"RTN","SROAPCA4",13,0)
 K DA,DIC,DIQ,DR,SRY S DIC="^DPT(",DIQ="SRY",DIQ(0)="I",DA=DFN,DR=27.02 D EN^DIQ1 S X=$G(SRY(2,DFN,27.02,"I")) I X S SRPREF=$$GET1^DIQ(4,X,99)
"RTN","SROAPCA4",14,0)
 I $Y+7>IOSL D PAGE^SROAPCA I SRSOUT Q
"RTN","SROAPCA4",15,0)
 D DD
"RTN","SROAPCA4",16,0)
 Q
"RTN","SROAPCA4",17,0)
LAB ;D PAGE^SROAPCA I SRSOUT Q
"RTN","SROAPCA4",18,0)
 W !!,"III. DETAILED LABORATORY INFO - PREOPERATIVE VALUES"
"RTN","SROAPCA4",19,0)
 N SROUN S SROUN=" mg/dl"
"RTN","SROAPCA4",20,0)
 W !,"Creatinine:",?14,$J($P(SRA(201),U,4),4),SROUN S Y=$P(SRA(202),"^",4) D DT W ?25,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",21,0)
 W ?41,"T. Cholesterol:",?57,$J($P(SRA(201),U,26),4),SROUN S Y=$P(SRA(202),"^",26) D DT W ?68,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",22,0)
 W !,"Hemoglobin:",?14,$J($P(SRA(201),U,20),4),SROUN S Y=$P(SRA(202),"^",20) D DT W ?25,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",23,0)
 W ?41,"HDL:",?57,$J($P(SRA(201),U,21),4),SROUN S Y=$P(SRA(202),"^",22) D DT W ?68,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",24,0)
 W !,"Albumin:",?14,$J($P(SRA(201),U,8),4)," g/dl" S Y=$P(SRA(202),"^",8) D DT W ?25,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",25,0)
 W ?41,"LDL:",?57,$J($P(SRA(201),U,25),4),SROUN S Y=$P(SRA(202),"^",25) D DT W ?68,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",26,0)
 W !,"Triglyceride:",?14,$J($P(SRA(201),U,22),4),SROUN S Y=$P(SRA(202),"^",22) D DT W ?25,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",27,0)
 W ?41,"Hemoglobin A1c:",?57,$J($P(SRA(201),U,28),4)," %" S Y=$P(SRA(202.1),"^") D DT W ?68,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",28,0)
 W !,"Potassium:",?14,$J($P(SRA(201),U,23),4)," mg/L" S Y=$P(SRA(202),"^",23) D DT W ?25,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",29,0)
 W ?41,"BNP:",?57,$J($P(SRA(201),U,29),4),SROUN S Y=$P(SRA(202.1),"^",2) D DT W ?68,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",30,0)
 W !,"T. Bilirubin:",?14,$J($P(SRA(201),U,24),4),SROUN S Y=$P(SRA(202),"^",24) D DT W ?25,"("_$E(X,1,8)_")"
"RTN","SROAPCA4",31,0)
 Q
"RTN","SROAPCA4",32,0)
DD ;Detailed Discharge Information
"RTN","SROAPCA4",33,0)
 N VAINDT,SRPTF,SRRES
"RTN","SROAPCA4",34,0)
 S X=$P(SRA(208),"^",15) I X S X=X-.01 ;AAS - Patch 177 - Date needs to be at least .01 less than discharge date.
"RTN","SROAPCA4",35,0)
 S VAINDT=X D INP^VADPT S SRPTF=VAIN(10)
"RTN","SROAPCA4",36,0)
 S SRRES="" D RPC^DGPTFAPI(.SRRES,SRPTF)
"RTN","SROAPCA4",37,0)
 I $Y+9>IOSL D PAGE^SROAPCA I SRSOUT Q
"RTN","SROAPCA4",38,0)
 W !!,"X. DETAILED DISCHARGE INFORMATION",!,"   Discharge ICD-"_$$ICD910^SROICD(SRTN)_" Codes: " I $G(SRRES(0))>0 S SRRES="" D
"RTN","SROAPCA4",39,0)
 .S SRRES=$P(SRRES(1),U,3)_"  " I $D(SRRES(2)) F I=1:1:9 S:$P(SRRES(2),"^",I)'="" SRRES=SRRES_$P(SRRES(2),"^",I)_"  " I $L(SRRES)>45 W SRRES S SRRES=""
"RTN","SROAPCA4",40,0)
 .W:$D(SRRES) !,?26,SRRES
"RTN","SROAPCA4",41,0)
 W !!,"Type of Disposition: ",$P($G(SRRES(1)),U,1)
"RTN","SROAPCA4",42,0)
 W !,"Place of Disposition: ",$P($G(SRRES(1)),U,2)
"RTN","SROAPCA4",43,0)
 W !,"Preferred VAMC identification code: ",SRPREF
"RTN","SROAPCA4",44,0)
 W !,"Primary care or referral VAMC identification code: ",SRREFP
"RTN","SROAPCA4",45,0)
 W !,"Follow-up VAMC identification code: ",SRFOLP
"RTN","SROAPCA4",46,0)
 Q
"RTN","SROAPCA4",47,0)
YN ; store answer
"RTN","SROAPCA4",48,0)
 S SHEMP=$S(NYUK="NS":"NS",NYUK="N":"NO",NYUK="Y":"YES",1:"")
"RTN","SROAPCA4",49,0)
 Q
"RTN","SROAPCA4",50,0)
DT S X="NS" I Y>1 D DT^SROAPCA1
"RTN","SROAPCA4",51,0)
 Q
"RTN","SROAPRT6")
0^7^B6019028^B5989513
"RTN","SROAPRT6",1,0)
SROAPRT6 ;BIR/MAM - PRINT OUTCOME INFO ;01/29/07
"RTN","SROAPRT6",2,0)
 ;;3.0;Surgery;**38,47,88,127,156,160,177**;24 Jun 93;Build 89
"RTN","SROAPRT6",3,0)
 K SRA S X=$P($G(^SRO(136,SRTN,0)),"^",3) S:X X=$$ICD^SROICD(SRTN,X),X=$P(X,"^",2)_"   "_$P(X,"^",4) S SRAO(1)=X_"^.03"
"RTN","SROAPRT6",4,0)
 S SRA(205)=$G(^SRF(SRTN,205)),X=$P(SRA(205),"^") I X'="" S X=$S(X="NA":"NA",1:X_" DAYS")
"RTN","SROAPRT6",5,0)
 S SRAO(2)=X_"^247"
"RTN","SROAPRT6",6,0)
 S X=$P(SRA(205),"^",3),Y=$S(X'="":X,1:$P($G(^DPT(DFN,.35)),"^")),SRDEAD=Y I Y D D^DIQ S SRDEAD=Y
"RTN","SROAPRT6",7,0)
 S SRAO(3)=SRDEAD,NYUK="N",SRET=0 K SRCPT
"RTN","SROAPRT6",8,0)
 F  S SRET=$O(^SRF(SRTN,29,SRET)) Q:'SRET  S CASE=$P(^SRF(SRTN,29,SRET,0),"^"),SRC=$P($G(^SRO(136,CASE,0)),"^",2) I $P($G(^SRF(CASE,.2)),"^",10),SRC D
"RTN","SROAPRT6",9,0)
 .S Y=$P($$CPT^ICPTCOD(SRC),"^",2) D MOD
"RTN","SROAPRT6",10,0)
 .S NYUK="Y",SRCPT(SRC)=Y
"RTN","SROAPRT6",11,0)
 S $P(^SRF(SRTN,205),"^",4)=NYUK D YN S SRAO(4)=SHEMP_"^262" F I="6A","6B","6C","6D","6E","6F","7A","7B","7C","7D","7E","7F" S SRAO(I)=""
"RTN","SROAPRT6",12,0)
DISP ;
"RTN","SROAPRT6",13,0)
 W !,?27,"OUTCOME INFORMATION"
"RTN","SROAPRT6",14,0)
 W !!,$J("Postoperative Diagnosis Code "_$$ICDSTR^SROICD(SRTN)_": ",39)_$P(SRAO(1),"^"),!,$J("Length of Postoperative Hospital Stay: ",39)_$P(SRAO(2),"^")
"RTN","SROAPRT6",15,0)
 W !,$J("Date of Death: ",39)_$P(SRAO(3),"^")
"RTN","SROAPRT6",16,0)
 I SRAO(3) S X1=$P(^SRF(SRTN,0),"^",9),X2=90 D C^%DTC D
"RTN","SROAPRT6",17,0)
 .I SRAO(3)'>X W !,$J("Death Unrelated/Related: ",39)_$S($P($G(^SRF(SRTN,.4)),"^",7)="R":"RELATED",$P($G(^SRF(SRTN,.4)),"^",7)="U":"UNRELATED",1:"")
"RTN","SROAPRT6",18,0)
 .I SRA(3)>X W !,$J("Death Unrelated/Related: ",39)_"N/A"
"RTN","SROAPRT6",19,0)
 W !,$J("Return to OR Within 30 Days: ",39)_$P(SRAO(4),"^")
"RTN","SROAPRT6",20,0)
 D RET W:$E(IOST)="P" ! I $Y+24>IOSL D PAGE^SROAPAS I SRSOUT Q
"RTN","SROAPRT6",21,0)
 D ^SROAPRT7
"RTN","SROAPRT6",22,0)
 Q
"RTN","SROAPRT6",23,0)
MOD ;; append CPT modifiers to CPT code
"RTN","SROAPRT6",24,0)
 N SRTN S SRTN=CASE D SSPRIN^SROCPT0
"RTN","SROAPRT6",25,0)
 Q
"RTN","SROAPRT6",26,0)
YN ;
"RTN","SROAPRT6",27,0)
 S SHEMP=$S(NYUK="NS":"NS",NYUK="N":"NO",NYUK="Y":"YES",1:"")
"RTN","SROAPRT6",28,0)
 Q
"RTN","SROAPRT6",29,0)
RET ; print returns
"RTN","SROAPRT6",30,0)
 S X=0 F  S X=$O(SRCPT(X)) Q:'X  W !,?15,"CPT Code: "_SRCPT(X)
"RTN","SROAPRT6",31,0)
 Q
"RTN","SROAPRT7")
0^33^B30831500^B30682535
"RTN","SROAPRT7",1,0)
SROAPRT7 ;BIR/MAM - PRINT OCCURRENCES ;08/16/2011
"RTN","SROAPRT7",2,0)
 ;;3.0;Surgery;**38,47,57,60,125,160,176,177**;24 Jun 93;Build 89
"RTN","SROAPRT7",3,0)
 K SRA,SRAO D EN^SROCCAT S SRA(205)=$G(^SRF(SRTN,205))
"RTN","SROAPRT7",4,0)
 S NYUK=$P(SRA(205),"^",5) D YN S SRAO(1)=SHEMP_"^403",NYUK=$P(SRA(205),"^",6) D YN S SRAO("1A")=SHEMP_"^248",NYUK=$P(SRA(205),"^",7) D YN S SRAO("1B")=SHEMP_"^249"
"RTN","SROAPRT7",5,0)
 S NYUK=$P(SRA(205),"^",37) D YN S SRAO("6E")=SHEMP_"^488",NYUK=$P(SRA(205),"^",8) D YN S SRAO("1C")=SHEMP_"^404",NYUK=$P(SRA(205),"^",39) D YN S SRAO("6F")=SHEMP_"^447"
"RTN","SROAPRT7",6,0)
 S NYUK=$P(SRA(205),"^",9) D YN S SRAO(2)=SHEMP_"^318",NYUK=$P(SRA(205),"^",10) D YN S SRAO("2A")=SHEMP_"^251",NYUK=$P(SRA(205),"^",11) D YN S SRAO("2B")=SHEMP_"^412",NYUK=$P(SRA(205),"^",12) D YN S SRAO("2C")=SHEMP_"^252"
"RTN","SROAPRT7",7,0)
 S NYUK=$P(SRA(205),"^",13) D YN S SRAO("2D")=SHEMP_"^285"
"RTN","SROAPRT7",8,0)
 S NYUK=$P(SRA(205),"^",15) D YN S SRAO(3)=SHEMP_"^319",NYUK=$P(SRA(205),"^",16) D YN S SRAO("3A")=SHEMP_"^409",NYUK=$P(SRA(205),"^",17) D YN S SRAO("3B")=SHEMP_"^254",NYUK=$P(SRA(205),"^",18) D YN S SRAO("3C")=SHEMP_"^255"
"RTN","SROAPRT7",9,0)
 S NYUK=$P(SRA(205),"^",20) D YN S SRAO(4)=SHEMP_"^320",NYUK=$P(SRA(205),"^",21) D YN S SRAO("4A")=SHEMP_"^256",NYUK=$P(SRA(205),"^",22) D YN S SRAO("4B")=SHEMP_"^410",NYUK=$P(SRA(205),"^",23) D YN S SRAO("4C")=SHEMP_"^287"
"RTN","SROAPRT7",10,0)
 S NYUK=$P(SRA(205),"^",25) D YN S SRAO(5)=SHEMP_"^321",NYUK=$P(SRA(205),"^",26) D YN S SRAO("5A")=SHEMP_"^411",NYUK=$P(SRA(205),"^",27) D YN S SRAO("5B")=SHEMP_"^258",NYUK=$P(SRA(205),"^",28) D YN S SRAO("5C")=SHEMP_"^259"
"RTN","SROAPRT7",11,0)
 S NYUK=$P(SRA(205),"^",30) D YN S SRAO(6)=SHEMP_"^322",NYUK=$P(SRA(205),"^",32) D YN S SRAO("6A")=SHEMP_"^257"
"RTN","SROAPRT7",12,0)
 S NYUK=$P(SRA(205),"^",33) D YN S SRAO("6B")=SHEMP_"^261",NYUK=$P(SRA(205),"^",34) D YN S SRAO("6C")=SHEMP_"^263",NYUK=$P(SRA(205),"^",35) D YN S SRAO("6D")=SHEMP_"^250"
"RTN","SROAPRT7",13,0)
 K SROOC N SRDUR,SRSEP,SRSTAR
"RTN","SROAPRT7",14,0)
 D OCC^SROAUTL0
"RTN","SROAPRT7",15,0)
 S X=$G(SROOC(21)) I X'="" S X=$P($G(SROOC(21)),U)_" "_$E($P($G(SROOC(21)),U,2),1,17)
"RTN","SROAPRT7",16,0)
 S SRAO("6G")=X_"^392"
"RTN","SROAPRT7",17,0)
 S X=$G(SROOC(29)) I X'="" S X=$P($G(SROOC(29)),U)_" "_$E($P($G(SROOC(29)),U,2),1,17)
"RTN","SROAPRT7",18,0)
 S SRAO("2E")=X_"^253"
"RTN","SROAPRT7",19,0)
 S X=$G(SROOC(30)) I X'="" S X=$P($G(SROOC(30)),U)_" "_$E($P($G(SROOC(30)),U,2),1,17)
"RTN","SROAPRT7",20,0)
 S SRAO("4D")=X_"^343"
"RTN","SROAPRT7",21,0)
 S X=$G(SROOC(31)) I X'="" S X=$P($G(SROOC(31)),U)_" "_$E($P($G(SROOC(31)),U,2),1,17)
"RTN","SROAPRT7",22,0)
 S SRAO("3D")=X_"^286"
"RTN","SROAPRT7",23,0)
 S X=$G(SROOC(32)) I X'="" S X=$P($G(SROOC(32)),U)_" "_$E($P($G(SROOC(32)),U,2),1,17)
"RTN","SROAPRT7",24,0)
 S SRAO("5D")=X_"^344"
"RTN","SROAPRT7",25,0)
 S X=$G(SROOC(36)) I X'="" S X=$P($G(SROOC(36)),U)_" "_$E($P($G(SROOC(36)),U,2),1,17)
"RTN","SROAPRT7",26,0)
 S SRAO("1D")=X_"^489"
"RTN","SROAPRT7",27,0)
 S Y=6 F  S Y=$O(SRAO(Y)) Q:Y=""  D
"RTN","SROAPRT7",28,0)
 .I $E(Y)="1" S SRI=$S(Y="1A":1,Y="1B":2,Y="1C":22,1:"") Q:SRI=""
"RTN","SROAPRT7",29,0)
 .I $E(Y)="2" S SRI=$S(Y="2A":4,Y="2B":7,Y="2C":5,Y="2D":6,1:"")  Q:SRI=""
"RTN","SROAPRT7",30,0)
 .I $E(Y)="3" S SRI=$S(Y="3A":8,Y="3B":9,Y="3C":10,1:"")  Q:SRI=""
"RTN","SROAPRT7",31,0)
 .I $E(Y)="4" S SRI=$S(Y="4A":12,Y="4B":13,Y="4C":14,1:"")  Q:SRI=""
"RTN","SROAPRT7",32,0)
 .I $E(Y)="5" S SRI=$S(Y="5A":16,Y="5B":17,Y="5C":11,1:"")  Q:SRI=""
"RTN","SROAPRT7",33,0)
 .I $E(Y)="6" S SRI=$S(Y="6A":15,Y="6B":19,Y="6C":20,Y="6D":3,Y="6E":35,Y="6F":38,1:"")  Q:SRI=""
"RTN","SROAPRT7",34,0)
 .S SRIN=Y I SROC(SRI)="       "&($P(SRAO(SRIN),"^")="YES") S $P(SRAO(SRIN),"^")="ND"
"RTN","SROAPRT7",35,0)
 .S $P(SRAO(SRIN),"^")=$S($P(SRAO(SRIN),"^")="YES":$E(SROC(SRI),4,5)_"/"_$E(SROC(SRI),6,7)_"/"_$E(SROC(SRI),2,3),$P(SRAO(SRIN),"^")="NO":"   "_$P(SRAO(SRIN),"^"),$P(SRAO(SRIN),"^")="ND":" NO DATE",1:$P(SRAO(SRIN),"^"))
"RTN","SROAPRT7",36,0)
 I $G(SRSEP)'="" S X=$P(SRAO("6D"),"^"),$P(SRAO("6D"),"^")=SRSEP_" "_X
"RTN","SROAPRT7",37,0)
 I $G(SRDUR)'="" S X=$P(SRAO("4A"),"^"),$P(SRAO("4A"),"^")=SRDUR_"  "_X
"RTN","SROAPRT7",38,0)
 F SRK="1D","4D","3D","5D","2E","6G" S SRKO=$S(SRK="4D":30,SRK="3D":31,SRK="5D":32,SRK="2E":29,SRK="6G":21,SRK="1D":36,1:"") I $P(SRAO(SRK),"^")'="" D
"RTN","SROAPRT7",39,0)
 .S SRSTAR=1 I SROC(SRKO)="       " S SRD="NO DATE"
"RTN","SROAPRT7",40,0)
 .I SROC(SRKO)'="       " S SRD=$E(SROC(SRKO),4,5)_"/"_$E(SROC(SRKO),6,7)_"/"_$E(SROC(SRKO),2,3)
"RTN","SROAPRT7",41,0)
 .S $P(SRAO(SRK),"^")="* "_$P(SRAO(SRK),"^")_$J(SRD,(26-$L($P(SRAO(SRK),"^")))+10)
"RTN","SROAPRT7",42,0)
DISP W:$E(IOST)'="C" ! W !,?21,"PERIOPERATIVE OCCURRENCE INFORMATION",!!,"WOUND OCCURRENCES:",?33,$P(SRAO(1),"^"),?41,"CNS OCCURRENCES:",?74,$P(SRAO(4),"^")
"RTN","SROAPRT7",43,0)
 W !,"Superficial Incisional SSI:",?30,$P(SRAO("1A"),"^"),?41,"Stroke/CVA:" D
"RTN","SROAPRT7",44,0)
 .I $P(SRAO("4A"),"^")="   NO" W ?68,"NO SYMPTOMS" Q
"RTN","SROAPRT7",45,0)
 .W ?58,$J($P(SRAO("4A"),"^"),21)
"RTN","SROAPRT7",46,0)
 W !,"Deep Incisional SSI:",?30,$P(SRAO("1B"),"^"),?41,"Coma > 24 Hours:",?71,$P(SRAO("4B"),"^")
"RTN","SROAPRT7",47,0)
 W !,"Wound Disruption:",?30,$P(SRAO("1C"),"^"),?41,"Peripheral Nerve Injury:",?71,$P(SRAO("4C"),"^")
"RTN","SROAPRT7",48,0)
 I $P(SRAO("1D"),"^")'=""!($P(SRAO("4D"),"^")'="") W !,$P(SRAO("1D"),"^"),?41,$P(SRAO("4D"),"^")
"RTN","SROAPRT7",49,0)
 W !!,"URINARY TRACT OCCURRENCES: ",?33,$P(SRAO(3),"^"),?41,"CARDIAC OCCURRENCES:",?74,$P(SRAO(5),"^")
"RTN","SROAPRT7",50,0)
 W !,"Renal Insufficiency: ",?30,$P(SRAO("3A"),"^"),?41,"Arrest Requiring CPR:",?71,$P(SRAO("5A"),"^")
"RTN","SROAPRT7",51,0)
 W !,"Acute Renal Failure:",?30,$P(SRAO("3B"),"^"),?41,"Myocardial Infarction:",?71,$P(SRAO("5B"),"^")
"RTN","SROAPRT7",52,0)
 W !,"Urinary Tract Infection:",?30,$P(SRAO("3C"),"^"),?41,$P(SRAO("5D"),"^")
"RTN","SROAPRT7",53,0)
 I $P(SRAO("3D"),"^")'="" W !,$P(SRAO("3D"),"^")
"RTN","SROAPRT7",54,0)
 W !,?41,"OTHER OCCURRENCES:",?74,$P(SRAO(6),"^")
"RTN","SROAPRT7",55,0)
 W !,"RESPIRATORY OCCURRENCES:",?33,$P(SRAO(2),"^"),?41,"Bleeding/Transfusions:",?71,$P(SRAO("6A"),"^")
"RTN","SROAPRT7",56,0)
 W !,"Pneumonia:",?30,$P(SRAO("2A"),"^"),?41,"Graft/Prosthesis/Flap Failure:",?71,$P(SRAO("6B"),"^")
"RTN","SROAPRT7",57,0)
 W !,"Unplanned Intubation:",?30,$P(SRAO("2B"),"^"),?41,"DVT/Thrombophlebitis:",?71,$P(SRAO("6C"),"^")
"RTN","SROAPRT7",58,0)
 W !,"Pulmonary Embolism:",?30,$P(SRAO("2C"),"^"),?41,"Systemic Sepsis: " D
"RTN","SROAPRT7",59,0)
 .I $P(SRAO("6D"),"^")="   NO" W ?71,$P(SRAO("6D"),"^") Q
"RTN","SROAPRT7",60,0)
 .W $J($P(SRAO("6D"),"^"),21)
"RTN","SROAPRT7",61,0)
 W !,"On Ventilator > 48 Hours:",?30,$P(SRAO("2D"),"^"),?41,"Organ/Space SSI:",?71,$P(SRAO("6E"),"^")
"RTN","SROAPRT7",62,0)
 W !,$P(SRAO("2E"),"^"),?41,"C. difficile Colitis:",?71,$P(SRAO("6F"),"^")
"RTN","SROAPRT7",63,0)
 W !,?41,$P(SRAO("6G"),"^")
"RTN","SROAPRT7",64,0)
 I $G(SRSTAR) W !,"* indicates Other "_$$ICDSTR^SROICD(SRTN)
"RTN","SROAPRT7",65,0)
 I $E(IOST)="C" W !! K DIR S DIR(0)="FOA",DIR("A")="Press RETURN to continue" D ^DIR K DIR
"RTN","SROAPRT7",66,0)
 Q
"RTN","SROAPRT7",67,0)
YN S SHEMP=$S(NYUK="NS":"NS",NYUK="N":"NO",NYUK="Y":"YES",1:"")
"RTN","SROAPRT7",68,0)
 Q
"RTN","SROATCM")
0^41^B25541565^B25780812
"RTN","SROATCM",1,0)
SROATCM ;BIR/MAM - TRANSMIT CARDIAC ASSESSMENTS ;03/02/06
"RTN","SROATCM",2,0)
 ;;3.0;Surgery;**38,55,68,90,93,95,99,125,153,174,175,177**;24 Jun 93;Build 89
"RTN","SROATCM",3,0)
 ;
"RTN","SROATCM",4,0)
 ; Reference to ^DGPM("APTT1" supported by DBIA #565
"RTN","SROATCM",5,0)
 ; Reference to File #405 supported by DBIA #3029
"RTN","SROATCM",6,0)
 ; Reference to Field #27.02 in File #2 supported by DBIA #1850
"RTN","SROATCM",7,0)
 ;
"RTN","SROATCM",8,0)
 K ^TMP("SRA",$J) S SRATOT=0,SRASITE=+$P($$SITE^SROVAR,"^",3),(SRAMNUM,SRACNT)=1
"RTN","SROATCM",9,0)
 S SRADFN=0 F  S SRADFN=$O(^SRF("ARS","C","C",SRADFN)) Q:'SRADFN  S SRTN=0 F  S SRTN=$O(^SRF("ARS","C","C",SRADFN,SRTN)) Q:'SRTN  D STUFF
"RTN","SROATCM",10,0)
 S SRATOTM=SRAMNUM D ^SROATCM2
"RTN","SROATCM",11,0)
 Q
"RTN","SROATCM",12,0)
STUFF ; stuff entries into ^TMP("SRA",$J
"RTN","SROATCM",13,0)
 ; check for fouled up ARS x ref
"RTN","SROATCM",14,0)
 I $P(^SRF(SRTN,"RA"),"^",2)="N" K ^SRF("ARS","C","C",SRADFN,SRTN) K DR S DIE=130,DR="235///C",DA=SRTN D ^DIE K DR Q
"RTN","SROATCM",15,0)
 ; the next line is commented out to allow re-transmissions
"RTN","SROATCM",16,0)
 ;S SRART=$P(^SRF(SRTN,"RA"),"^",3) I SRART S DIE=130,DR="235///T",DA=SRTN D ^DIE K DR,DA,DIE Q
"RTN","SROATCM",17,0)
 I $P(^SRF(SRTN,"RA"),"^",2)'="C" Q
"RTN","SROATCM",18,0)
 I SRACNT>100 S SRACNT=1,SRAMNUM=SRAMNUM+1
"RTN","SROATCM",19,0)
 S SRATOT=SRATOT+1 K SRA,VADM
"RTN","SROATCM",20,0)
 F I=0,200,205:1:208 S SRA(I)=$G(SRF(SRTN,I))
"RTN","SROATCM",21,0)
 D ^SROATCM1,P93
"RTN","SROATCM",22,0)
 K SHEMP,SRA,VADM,VAPA
"RTN","SROATCM",23,0)
 S X=$E($P(^SRF(SRTN,0),"^",9),1,5)_"00",^TMP("SRWL",$J,X)=""
"RTN","SROATCM",24,0)
 Q
"RTN","SROATCM",25,0)
P93 ; referring & follow-up sites, patient address & phone number
"RTN","SROATCM",26,0)
 N SRPREF,SRREF,SRREFP,SRFOL,SRFOLP,SRSOUT,SRY S (SRPREF,SRREF,SRREFP,SRFOL,SRFOLP)="",SRSOUT=0,(VAIP("D"),SRSDATE)=$P(SRA(0),"^",9) D IN5^VADPT
"RTN","SROATCM",27,0)
 ; if not admitted before surgery, look for admission within 24 hours of leaving OR
"RTN","SROATCM",28,0)
 I 'VAIP(13) S X1=$P($G(^SRF(SRTN,.2)),"^",12),X2=1 D C^%DTC S SR24=X,SRDT=$O(^DGPM("APTT1",DFN,SRSDATE)) G:'SRDT!(SRDT>SR24) TS S VAIP("D")=SRDT D IN5^VADPT
"RTN","SROATCM",29,0)
TS I VAIP(13) K DA,DIC,DIQ,DR S DIC=405,DR=.05,DA=VAIP(13),DIQ="SRY",DIQ(0)="IE" D EN^DIQ1 S SRREF=SRY(405,VAIP(13),.05,"E"),SRREFP=SRY(405,VAIP(13),.05,"I") I SRREFP S SRREFP=$$GET1^DIQ(4,SRREFP,99)
"RTN","SROATCM",30,0)
 I VAIP(17) K DA,DIC,DIQ,DR,SRY S DIC=405,DR=.05,DA=VAIP(17),DIQ="SRY",DIQ(0)="IE" D EN^DIQ1 S SRFOL=SRY(405,VAIP(17),.05,"E"),SRFOLP=SRY(405,VAIP(17),.05,"I") I SRFOLP S SRFOLP=$$GET1^DIQ(4,SRFOLP,99)
"RTN","SROATCM",31,0)
 S SHEMP=$E(SHEMP,1,11)_" 18"_$J(VAPA(1),35)_$J(VAPA(2),30),^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1
"RTN","SROATCM",32,0)
 S SHEMP=$E(SHEMP,1,11)_" 19"_$J(VAPA(3),30)_$J(VAPA(4),15)
"RTN","SROATCM",33,0)
 K DA,DIC,DIQ,DR,SRY S X=$P(VAPA(5),"^") I X S DIC=5,DA=X,DR=1,DIQ="SRY",DIQ(0)="E" D EN^DIQ1 S X=SRY(5,$P(VAPA(5),"^"),1,"E")
"RTN","SROATCM",34,0)
 S SHEMP=SHEMP_$J(X,5),^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1,SHEMP=$E(SHEMP,1,11)_" 20"_$J(VAPA(8),20)_$J($TR(SRREF,","," "),30)_$J(SRREFP,6)
"RTN","SROATCM",35,0)
 K DA,DIC,DIQ,DR,SRY S DIC="^DPT(",DIQ="SRY",DIQ(0)="I",DA=DFN,DR=27.02 D EN^DIQ1 S X=$G(SRY(2,DFN,27.02,"I")) I X S SRPREF=$$GET1^DIQ(4,X,99)
"RTN","SROATCM",36,0)
 S SHEMP=SHEMP_$J(SRPREF,6)
"RTN","SROATCM",37,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1,SHEMP=$E(SHEMP,1,11)_" 21"_$J($TR(SRFOL,","," "),30)_$J(SRFOLP,6)
"RTN","SROATCM",38,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1
"RTN","SROATCM",39,0)
 S SHEMP=$E(SHEMP,1,11)_" 22"_$J($P(SRA(201),"^",21),6)_$J($P(SRA(202),"^",21),7)_$J($P(SRA(201),"^",22),6)_$J($P(SRA(202),"^",22),7)
"RTN","SROATCM",40,0)
 S SHEMP=SHEMP_$J($P(SRA(201),"^",23),6)_$J($P(SRA(202),"^",23),7)_$J($P(SRA(201),"^",24),6)_$J($P(SRA(202),"^",24),7)
"RTN","SROATCM",41,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1
"RTN","SROATCM",42,0)
 ;
"RTN","SROATCM",43,0)
 S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SHEMP=$E(SHEMP,1,11)_" 23"_$J($P(SRA(201),"^",25),6)_$J($P(SRA(202),"^",25),7)_$J($P(SRA(201),"^",26),6)_$J($P(SRA(202),"^",26),7)_$J($P(VADM(3),"^"),7) K VADM
"RTN","SROATCM",44,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1
"RTN","SROATCM",45,0)
 S SHEMP=$E(SHEMP,1,11)_" 24"_$J($P(SRA(208),"^",10),2)_$J($P(SRA(206),"^",38),2)_$J($P(SRA(207),"^",24),2)_$J($P(SRA(207),"^",25),2)_$J($P(SRA(206),"^",39),2)
"RTN","SROATCM",46,0)
 N SR22,SR23 S SR22=$P(SRA(208),"^",22),SR23=$P(SRA(208),"^",23)
"RTN","SROATCM",47,0)
 D NMCS S SHEMP=SHEMP_$J(SRIP,2)_$J(" ",2)_$S(SR22:$J(SR22,12,4),1:$J(SR22,12))_$S(SR23:$J(SR23,12,4),1:$J(SR23,12))_$J($P(SRA(206),"^",41),2)
"RTN","SROATCM",48,0)
 S SHEMP=SHEMP_$J($P(SRA(207),"^",26),3)
"RTN","SROATCM",49,0)
 ;
"RTN","SROATCM",50,0)
 N VAINDT,SRPTF,SRRES,SRDISTYP
"RTN","SROATCM",51,0)
 S VAINDT=$P(SRA(208),"^",15)-.0001 D INP^VADPT S SRPTF=VAIN(10)
"RTN","SROATCM",52,0)
 S SRRES="" D RPC^DGPTFAPI(.SRRES,SRPTF)
"RTN","SROATCM",53,0)
 S SRRES(0)=$G(SRRES(0)),SRRES(1)=$G(SRRES(1)),SRRES(2)=$G(SRRES(2))
"RTN","SROATCM",54,0)
 S SRDISTYP=$P(SRRES(1),U)
"RTN","SROATCM",55,0)
 I SRDISTYP]"" S SRDISTYP=$S(SRDISTYP="REGULAR":1,SRDISTYP="NBC OR WHILE ASIH":2,SRDISTYP="EXPIRATION 6 MONTH LIMIT":3,SRDISTYP="IRREGULAR":4,SRDISTYP="TRANSFER":5,SRDISTYP="DEATH WITH AUTOPSY":6,SRDISTYP="DEATH WITHOUT AUTOPSY":7,1:"")
"RTN","SROATCM",56,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP_$J($P(SRRES(1),U,3),8)_$J($P(SRA(205),"^",40),2),SRACNT=SRACNT+1
"RTN","SROATCM",57,0)
 S SHEMP=$E(SHEMP,1,11)_" 25"_$J(SRDISTYP,2) I $D(SRRES(2)) F I=1:1:7 S SHEMP=SHEMP_$J($P(SRRES(2),"^",I),8)
"RTN","SROATCM",58,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1
"RTN","SROATCM",59,0)
 D ^SROATCM3
"RTN","SROATCM",60,0)
 Q
"RTN","SROATCM",61,0)
NMCS S SRIP=$P(SRA(206),"^",40) I SRIP'="Y" Q
"RTN","SROATCM",62,0)
 N SROCC S SROCC=0 F  S SROCC=$O(^SRF(SRTN,10,SROCC)) Q:'SROCC  I $P(^SRF(SRTN,10,SROCC,0),"^",2)=34 S SRIP="I" Q
"RTN","SROATCM",63,0)
 I SRIP="Y" S SROCC=0 F  S SROCC=$O(^SRF(SRTN,16,SROCC)) Q:'SROCC  I $P(^SRF(SRTN,16,SROCC,0),"^",2)=34 S SRIP="P" Q
"RTN","SROATCM",64,0)
 Q
"RTN","SROATCM1")
0^68^B58032375^B57561203
"RTN","SROATCM1",1,0)
SROATCM1 ;BIR/MAM - STUFF TRANMISSION IN ^TMP ;09/28/2011
"RTN","SROATCM1",2,0)
 ;;3.0;Surgery;**38,71,79,90,88,93,95,111,125,135,134,142,153,160,174,175,176,177**;24 Jun 93;Build 89
"RTN","SROATCM1",3,0)
 K SRA F I=0,.2,52,200,201,202,205:1:208,207.1,209,202.1,200.1,"1.0" S SRA(I)=$G(^SRF(SRTN,I))
"RTN","SROATCM1",4,0)
 S DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANAME=VADM(1),SEX=$P(VADM(5),"^"),Z=$P(VADM(3),"^"),SRSDATE=$P(SRA(0),"^",9),Y=$E(SRSDATE,1,7),AGE=$E(Y,1,3)-$E(Z,1,3)-($E(Y,4,7)<$E(Z,4,7))
"RTN","SROATCM1",5,0)
 N SRPID S SRPID=VA("PID"),SRPID=$TR(SRPID,"-","") ; remove hyphens from PID
"RTN","SROATCM1",6,0)
 ;JAS - 06/06/14 - PATCH 177 - Changed first character from "~" to "$" to denote new format for ICD-10
"RTN","SROATCM1",7,0)
 S SHEMP="$"_$J(SRASITE,3)_$J(SRTN,7)_" 1 "_DT_$J(AGE,3)_$J(SEX,1)_$J(SRSDATE,12,4)_SRPID
"RTN","SROATCM1",8,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 2 ",SRACNT=SRACNT+1
"RTN","SROATCM1",9,0)
 S SRHD=$P(SRA(206),"^")
"RTN","SROATCM1",10,0)
 I SRHD["C" S SRH="C",SRHD=$E(SRHD,1,$L(SRHD)-1)
"RTN","SROATCM1",11,0)
 E  S SRH=" "
"RTN","SROATCM1",12,0)
 S SRWD=$P(SRA(206),"^",2)
"RTN","SROATCM1",13,0)
 I SRWD["K" S SRW="K",SRWD=$E(SRWD,1,$L(SRWD)-1)
"RTN","SROATCM1",14,0)
 E  S SRW=" "
"RTN","SROATCM1",15,0)
 S SHEMP=SHEMP_$J(SRHD,3)_SRH_$J(SRWD,3)_SRW_$J($P(SRA(200),"^",2),2)_$J($P(SRA(200),"^",11),2)_$J($P(SRA(206),"^",5),3)_$J($P(SRA(206),"^",6),2)_$J($P(SRA(206),"^",7),2)
"RTN","SROATCM1",16,0)
 S SRCT=$P($G(^SRF(SRTN,201)),"^",4) S:SRCT["NS" SRCT=""
"RTN","SROATCM1",17,0)
 S SHEMP=SHEMP_$J($P(SRA(200.1),"^",5),2)_$J(SRCT,4)_$J($P(SRA(206),"^",10),2)_$J($P(SRA(206),"^",11),2)_$J($P(SRA(200),"^",8),2)_$J(" ",2)_$J($P(SRA(206),"^",14),2)_$J(" ",2)
"RTN","SROATCM1",18,0)
 S SHEMP=SHEMP_$J($P(SRA(206),"^",16),2)_$J($P(SRA(206),"^",17),2)_$J($P(SRA(206),"^",18),3)_$J($P(SRA(206),"^",19),3)_$J($P(SRA(206),"^",20),2)_$J($P(SRA(206),"^",21),2)_$J($P(SRA(206),"^",22),2)_$J($P(SRA(206),"^",23),2)
"RTN","SROATCM1",19,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP_$J($P(SRA(208),"^",19),2)_$J($P(SRA(205),"^",8),2)_$J($P(SRA(205),"^",6),2)
"RTN","SROATCM1",20,0)
 S SHEMP=$E(SHEMP,1,11)_" 3 ",SRACNT=SRACNT+1
"RTN","SROATCM1",21,0)
 S SHEMP=SHEMP_$J($P(SRA(206),"^",24),2)_$J($P(SRA(206),"^",25),3)_$J($P(SRA(206),"^",26),3)_$J($P(SRA(206),"^",27),3)
"RTN","SROATCM1",22,0)
 ; Left Main (node 3 pos 26-28), LAD (node 3 pos 29-31), Right Coronary (node 3 pos 32-34) & Circumflex Stenosis (node 3 pos 35-37)
"RTN","SROATCM1",23,0)
 S SHEMP=SHEMP_$J($P(SRA(206),"^",28),3)_$J($P($G(SRA(206)),"^",33),3)_$J($P($G(SRA(206)),"^",34),3)_$J($P($G(SRA(206)),"^",35),3)
"RTN","SROATCM1",24,0)
 ; LV Cont Grade (node 3 pos 39-40) & Mitral Regurgitation(node 3 pos 41-42)
"RTN","SROATCM1",25,0)
 N SROLV S SROLV=$P(SRA(206),"^",30)
"RTN","SROATCM1",26,0)
 S SHEMP=SHEMP_$J($S(SROLV="IIIa":"3A",SROLV="IIIb":"3B",1:SROLV),3)_$J($P($G(SRA(206)),"^",9),2)
"RTN","SROATCM1",27,0)
 ; Estimate of Mortality and ASA Class are changed to not transmit "NS"
"RTN","SROATCM1",28,0)
 S SREMDATE=$P($G(SRA(206)),"^",32)
"RTN","SROATCM1",29,0)
 S SREMO=$P($G(^SRF(SRTN,206)),"^",31) S:SREMO["NS" SREMDATE=""
"RTN","SROATCM1",30,0)
 ; Estimate of Mortality (node 3 pos 43-45) & date (node 3 pos 46-57)
"RTN","SROATCM1",31,0)
 S SHEMP=SHEMP_$J(SREMO,3)
"RTN","SROATCM1",32,0)
 S SHEMP=SHEMP_$S(SREMDATE="":$J(SREMDATE,12),1:$J(SREMDATE,12,4))
"RTN","SROATCM1",33,0)
 S X="",Y=$P($G(^SRF(SRTN,1.1)),"^",3) S:Y X=$P($P($G(^SRO(132.8,Y,0)),"^"),"-") S X=$E(X) S:X["N" X=""
"RTN","SROATCM1",34,0)
 S SHEMP=SHEMP_$J(X,1)
"RTN","SROATCM1",35,0)
 ; Cardiac Est. of Surg. Priority(node 3 pos 59) & date(node 3 pos 60-71)
"RTN","SROATCM1",36,0)
 S SHEMP=SHEMP_$J($P($G(SRA(208)),"^",12),1)
"RTN","SROATCM1",37,0)
 N SREMSPDT S SREMSPDT=$P($G(SRA(208)),"^",13)
"RTN","SROATCM1",38,0)
 S SHEMP=SHEMP_$S(SREMSPDT="":$J(SREMSPDT,12),1:$J(SREMSPDT,12,4))_$J($P(SRA("1.0"),"^",8),2)
"RTN","SROATCM1",39,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 4 ",SRACNT=SRACNT+1
"RTN","SROATCM1",40,0)
 S SHEMP=SHEMP_$J($P(SRA(207),"^"),2)_$J($P(SRA(207),"^",2),2)_$J($P(SRA(207),"^",3),2)_$J($P(SRA(207),"^",4),2)_$J($P(SRA(207),"^",5),2)_$J(" ",2)_$J($P(SRA(207),"^",7),2)
"RTN","SROATCM1",41,0)
 S SHEMP=SHEMP_$J($P(SRA(207),"^",8),2)_$J($P(SRA(207),"^",9),2)_$J($P(SRA(207),"^",10),2)_$J($P(SRA(207),"^",12),2)_$J($P(SRA(207),"^",13),2)_$J($P(SRA(207),"^",14),2)_$J($P(SRA(207),"^",15),2)
"RTN","SROATCM1",42,0)
 S SHEMP=SHEMP_$J($P(SRA(207),"^",16),2)_$J($P(SRA(207),"^",17),2)_$J($P(SRA(207),"^",18),2)_"  "
"RTN","SROATCM1",43,0)
 S SRDEATH=$P($G(SRA(208)),"^"),SRDDATE=$E($P($G(^DPT(DFN,.35)),"^"),1,12) I SRDDATE'="" S SRDDATE=$$LJ^XLFSTR(SRDDATE,12,0)
"RTN","SROATCM1",44,0)
 S SHEMP=SHEMP_$J(SRDEATH,2)_$J(SRDDATE,12)
"RTN","SROATCM1",45,0)
 S SHEMP=SHEMP_$P(SRA(207),"^",20)_$J($P(SRA(207),"^",28),2)
"RTN","SROATCM1",46,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 5 ",SRACNT=SRACNT+1
"RTN","SROATCM1",47,0)
 N SROR S SROR="",Y=$P(^SRF(SRTN,0),"^",2),C=$P(^DD(130,.02,0),"^",2) I Y'="" D Y^DIQ S SROR=Y
"RTN","SROATCM1",48,0)
 S SHEMP=SHEMP_$J($E(SROR,1,30),30) F I=1:1:6 S SHEMP=SHEMP_$J($P(SRA(52),"^",I),2)
"RTN","SROATCM1",49,0)
 S SHEMP=SHEMP_$J($P(SRA(200),"^",55),2) F I=9:1:14 S SHEMP=SHEMP_$J($P(SRA(200.1),"^",I),2)
"RTN","SROATCM1",50,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 6 ",SRACNT=SRACNT+1
"RTN","SROATCM1",51,0)
 S SHEMP=SHEMP_$J($P(SRA(205),"^",27),2)_$J($P(SRA(208),"^",3),2)_$J($P(SRA(205),"^",17),2)_$J($P(SRA(208),"^",4),2)_$J($P(SRA(208),"^",5),2)_$J($P(SRA(205),"^",28),2)_$J($P(SRA(208),"^",6),2)
"RTN","SROATCM1",52,0)
 N SRRCS D RCSP S SHEMP=SHEMP_$J($P(SRA(205),"^",13),2)_$J(SRRCS,2)_$J($P(SRA(205),"^",22),2)
"RTN","SROATCM1",53,0)
 N SRCVA D CVA S SHEMP=SHEMP_$J(SRCVA,2)
"RTN","SROATCM1",54,0)
 N SRIP D CPR S SHEMP=SHEMP_$J(SRIP,2)
"RTN","SROATCM1",55,0)
 ;
"RTN","SROATCM1",56,0)
 ;Ethnicity contained in VADM(11)
"RTN","SROATCM1",57,0)
 N SROETCD,SROPTF S SROETCD="",SROPTF=""
"RTN","SROATCM1",58,0)
 S SROETCD=$P($G(VADM(11,1)),U,1)            ;Ethnicity code
"RTN","SROATCM1",59,0)
 S SROPTF=$$PTR2CODE^DGUTL4(SROETCD,2,4)     ;PTF Ethnicity code
"RTN","SROATCM1",60,0)
 S SHEMP=SHEMP_$J($G(SROPTF),1)   ;Ethnicity
"RTN","SROATCM1",61,0)
 ;
"RTN","SROATCM1",62,0)
 ;Multiple races contained in VADM(12)
"RTN","SROATCM1",63,0)
 N SRORAC,SRORCD,SRORCE S SRORCE=0,SRORAC="",SRORACE="",SRORCD=""
"RTN","SROATCM1",64,0)
 F  S SRORCE=$O(VADM(12,SRORCE)) Q:SRORCE=""  D
"RTN","SROATCM1",65,0)
 .S SRORAC=$P($G(VADM(12,SRORCE)),U,1)        ;Race code
"RTN","SROATCM1",66,0)
 .S SRORCD=$$PTR2CODE^DGUTL4(SRORAC,1,4)     ;PTF race code
"RTN","SROATCM1",67,0)
 .S SRORACE=SRORACE_$J(SRORCD,1)
"RTN","SROATCM1",68,0)
 ;
"RTN","SROATCM1",69,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP_SRORACE  ;Eth, race added
"RTN","SROATCM1",70,0)
 ;
"RTN","SROATCM1",71,0)
 S SHEMP=$E(SHEMP,1,11)_" 7 ",SRACNT=SRACNT+1
"RTN","SROATCM1",72,0)
 S SHEMP=SHEMP_$TR(SRANAME,","," ")
"RTN","SROATCM1",73,0)
 I $P($G(^SRF(SRTN,"RA")),"^",3)=1 S SHEMP=SHEMP_$J("***RE-TRANSMISSION",38)
"RTN","SROATCM1",74,0)
 ; zip code, employ status, hemoglobin, hemo date, serum albumin, albumin date, creatitine date, total ischemic time, min invasive, total cpb time, total pre,post ICU & step down unit LOS,
"RTN","SROATCM1",75,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 8 ",SRACNT=SRACNT+1
"RTN","SROATCM1",76,0)
 K VADM D ADD^VADPT S X=$S($P(VAPA(11),"^",2)'="":$P(VAPA(11),"^",2),1:VAPA(6))
"RTN","SROATCM1",77,0)
 S SHEMP=SHEMP_$J(X,10)_$J($P(SRA(208),"^",18),1)_$J($P(SRA(201),"^",20),7)_$J($P(SRA(202),"^",20),7)_$J($P(SRA(201),"^",8),4)_$J($P(SRA(202),"^",8),7)_$J($P(SRA(202),"^",4),7)_$J($P(SRA(206),"^",36),4)
"RTN","SROATCM1",78,0)
 S SHEMP=SHEMP_$J($P(SRA(207),"^",22),1)_$J($P(SRA(206),"^",37),4)_$J($P(SRA(207),"^",23),2)
"RTN","SROATCM1",79,0)
 ; cpt codes
"RTN","SROATCM1",80,0)
NODE9 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 9 ",SRACNT=SRACNT+1
"RTN","SROATCM1",81,0)
 S SRPMOD="",SR10SP="          ",CPT=$P($G(^SRO(136,SRTN,0)),"^",2) D
"RTN","SROATCM1",82,0)
 .I CPT S CPT=$P($$CPT^ICPTCOD(CPT),"^",2),SRCASE=SRTN D MOD^SROATM3 S SRPMOD=SRM
"RTN","SROATCM1",83,0)
 .S SHEMP=SHEMP_$J(CPT,5),SRPMOD=SRPMOD_SR10SP
"RTN","SROATCM1",84,0)
 K CPT F I=1:1:10 S (CPT(I),SRMOD(I))=""
"RTN","SROATCM1",85,0)
 S (OPS,CNT)=0 F  S OPS=$O(^SRO(136,SRTN,3,OPS)) Q:'OPS!(CNT=10)  S CNT=CNT+1,X=$P($G(^SRO(136,SRTN,3,OPS,0)),"^") I X S CPT(CNT)=$P($$CPT^ICPTCOD(X),"^",2) D OTH^SROATM3
"RTN","SROATCM1",86,0)
 S SHEMP=SHEMP_$J(CPT(1),5)_$J(CPT(2),5)_$J(CPT(3),5)_$J(CPT(4),5)_$J(CPT(5),5)_$J(CPT(6),5)_$J(CPT(7),5)_$J(CPT(8),5)_$J(CPT(9),5)_$J(CPT(10),5)
"RTN","SROATCM1",87,0)
 ; card cath date, admission date/time, hospital discharge date/time, anesthesia start & end date/times
"RTN","SROATCM1",88,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 10",SRACNT=SRACNT+1
"RTN","SROATCM1",89,0)
 I $P(SRA(207),"^",21)'="" D
"RTN","SROATCM1",90,0)
 .I $E($P(SRA(207),"^",21),8)="." Q
"RTN","SROATCM1",91,0)
 .E  S $P(SRA(207),"^",21)=$P(SRA(207),"^",21)_"."
"RTN","SROATCM1",92,0)
 S $P(SRA(207),"^",21)=$$LJ^XLFSTR($P(SRA(207),"^",21),12,0)
"RTN","SROATCM1",93,0)
 S SHEMP=SHEMP_$J($E($P(SRA(207),"^",21),1,12),12)
"RTN","SROATCM1",94,0)
 S (SRDATE,SRI)="" F SRI=14,15 S SRDATE=$E($P($G(SRA(208)),"^",SRI),1,12) S SRDATE=$$LJ^XLFSTR(SRDATE,12,0) S SHEMP=SHEMP_SRDATE
"RTN","SROATCM1",95,0)
 S (SRDATE,SRI)="" F SRI=1,4 S SRDATE=$P(SRA(.2),"^",SRI) S SRDATE=$$LJ^XLFSTR(SRDATE,12,0) S SHEMP=SHEMP_SRDATE
"RTN","SROATCM1",96,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 11",SRACNT=SRACNT+1
"RTN","SROATCM1",97,0)
 S (SRDATE,SRI)="" F SRI=10,12,2,3 S SRDATE=$P(SRA(.2),"^",SRI),SRDATE=$$LJ^XLFSTR(SRDATE,12,0) S SHEMP=SHEMP_SRDATE
"RTN","SROATCM1",98,0)
 ; preop risk factors comments
"RTN","SROATCM1",99,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 12",SRACNT=SRACNT+1 S SHEMP=SHEMP_$TR($E($G(^SRF(SRTN,206.1)),1,65),",","^")
"RTN","SROATCM1",100,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 13",SRACNT=SRACNT+1 S SHEMP=SHEMP_$TR($E($G(^SRF(SRTN,206.1)),66,130),",","^")
"RTN","SROATCM1",101,0)
 ; resource data comments
"RTN","SROATCM1",102,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 14",SRACNT=SRACNT+1 S SHEMP=SHEMP_$TR($E($G(^SRF(SRTN,206.2)),1,65),",","^")
"RTN","SROATCM1",103,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_" 15",SRACNT=SRACNT+1 S SHEMP=SHEMP_$TR($E($G(^SRF(SRTN,206.2)),66,130),",","^")
"RTN","SROATCM1",104,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1,SHEMP=$E(SHEMP,1,11)_" 16"_$E(SRPMOD,1,10) F I=1:1:5 S SHEMP=SHEMP_$E(SRMOD(I)_SR10SP,1,10)
"RTN","SROATCM1",105,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1,SHEMP=$E(SHEMP,1,11)_" 17" F I=6:1:10 S SHEMP=SHEMP_$E(SRMOD(I)_SR10SP,1,10)
"RTN","SROATCM1",106,0)
 S X=$$SITE^SROUTL0(SRTN),SRDIV=$S(X:$P(^SRO(133,X,0),"^"),1:""),SRDIV=$S(SRDIV:$$GET1^DIQ(4,SRDIV,99),1:SRASITE),SHEMP=SHEMP_$J(SRDIV,6)
"RTN","SROATCM1",107,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1
"RTN","SROATCM1",108,0)
 Q
"RTN","SROATCM1",109,0)
RCSP S SRRCS=0,X=$P(SRA(208),"^",7) I X="N" Q
"RTN","SROATCM1",110,0)
 N SROCC S SROCC=0 F  S SROCC=$O(^SRF(SRTN,16,SROCC)) Q:'SROCC  I $P(^SRF(SRTN,16,SROCC,0),"^",2)=27 S X=$P(^SRF(SRTN,16,SROCC,0),"^",5) S:X'="" SRRCS=X Q
"RTN","SROATCM1",111,0)
 Q
"RTN","SROATCM1",112,0)
CVA S X=$P(SRA(205),"^",21),SRCVA=$S(X="Y":"Y",1:1) I SRCVA=1 Q
"RTN","SROATCM1",113,0)
 N SROCC S SROCC=0 F  S SROCC=$O(^SRF(SRTN,16,SROCC)) Q:'SROCC  I $P(^SRF(SRTN,16,SROCC,0),"^",2)=12 S X=$P(^SRF(SRTN,16,SROCC,0),"^",8) S:X'="" SRCVA=X Q
"RTN","SROATCM1",114,0)
 Q
"RTN","SROATCM1",115,0)
CPR S SRIP=$P(SRA(205),"^",26) I SRIP'="Y" Q
"RTN","SROATCM1",116,0)
 N SROCC S SROCC=0 F  S SROCC=$O(^SRF(SRTN,10,SROCC)) Q:'SROCC  I $P(^SRF(SRTN,10,SROCC,0),"^",2)=16 S SRIP="I" Q
"RTN","SROATCM1",117,0)
 I SRIP="Y" S SROCC=0 F  S SROCC=$O(^SRF(SRTN,16,SROCC)) Q:'SROCC  I $P(^SRF(SRTN,16,SROCC,0),"^",2)=16 S SRIP="P" Q
"RTN","SROATCM1",118,0)
 Q
"RTN","SROATCM3")
0^42^B13088442^B12876503
"RTN","SROATCM3",1,0)
SROATCM3 ;BIR/SJA - STUFF TRANMISSION IN ^TMP ;05/11/10
"RTN","SROATCM3",2,0)
 ;;3.0;Surgery;**125,135,153,164,166,174,177**;24 Jun 93;Build 89
"RTN","SROATCM3",3,0)
 N SRDISP,NYUK S SRDISP="",NYUK=$P(SRRES(1),U,2),SRA(209.1)=$G(^SRF(SRTN,209.1)),SRA(207.1)=$G(^SRF(SRTN,207.1)),SRA(205)=$G(^SRF(SRTN,205)),SRA(208)=$G(^SRF(SRTN,208))
"RTN","SROATCM3",4,0)
 I NYUK'="" D
"RTN","SROATCM3",5,0)
 .S SRDISP=$S(NYUK="BOARDING HOUSE":16,NYUK="COMMUNITY HOSPITAL":6,NYUK="COMMUNITY NURSING HOME":8,NYUK="FOSTER HOME":14,NYUK="HALFWAY HOUSE":15,NYUK="HOME-BASED PRIMARY CARE (HBPC)":20,1:NYUK)
"RTN","SROATCM3",6,0)
 .Q:SRDISP'=NYUK  S SRDISP=$S(NYUK="HOSPICE CARE":22,NYUK="MILITARY HOSPITAL":3,NYUK="NURSE CARE CONTD ANOTHER COMM ":10,NYUK="NURSING CARE CONT AT SAME NURS":9,NYUK="OTHER FEDERAL HOSPITAL":4,1:NYUK)
"RTN","SROATCM3",7,0)
 .Q:SRDISP'=NYUK  S SRDISP=$S(NYUK="OTHER GOVERNMENT HOSPITAL":5,NYUK="OTHER PLACEMENT/UNKNOWN (NOT S":19,NYUK="PENAL INSTITUTION":17,NYUK="REFER MEDICARE HOME HEALTH CAR":25,NYUK="REFER OTHER AGENCY-PD HOME HEA":26,1:NYUK)
"RTN","SROATCM3",8,0)
 .Q:SRDISP'=NYUK  S SRDISP=$S(NYUK="REFER VA-PD HOME/COMMUNITY HEA":24,NYUK="RESIDENTIAL HOTEL/RESIDENT (IE":18,NYUK="RESPITE CARE":23,NYUK="RETURN TO COMMUNITY-INDEPENDEN":1,NYUK="SPINAL CORD INJURY-VACO APPROV":21,1:NYUK)
"RTN","SROATCM3",9,0)
 .Q:SRDISP'=NYUK  S SRDISP=$S(NYUK="STATE HOME":11,NYUK="STATE HOME":13,NYUK="VA DOMICILLARY":12,NYUK="VA MEDICAL CENTER":2,NYUK="VA NURSING HOME CARE UNIT (NHC":7,1:"")
"RTN","SROATCM3",10,0)
 ;
"RTN","SROATCM3",11,0)
LN26 S SHEMP=$E(SHEMP,1,11)_" 26"_$J(SRDISP,2)_$J($P(SRA(206),"^",13),2)_$J($P(SRA(206),"^",15),2)_$J("",2)_$J($P(SRA(207),"^",27),2)_$J($P(SRA(209),"^"),2)_$J($P(SRA(209),"^",2),2)
"RTN","SROATCM3",12,0)
 S SHEMP=SHEMP_$J($P(SRA(209),"^",3),2)_$J($P(SRA(209),"^",4),2)_$J($P(SRA(209),"^",5),2)_$J($P(SRA(209),"^",6),3)_$J($P(SRA(209),"^",7),3)_$J($P(SRA(209),"^",8),3)_$J($P(SRA(209),"^",9),2)_$J($P(SRA(209),"^",10),2)
"RTN","SROATCM3",13,0)
 S X=$P(SRA(206),"^",42),Y="" F I=1:1:5 S Y=Y_$P(X,",",I)
"RTN","SROATCM3",14,0)
 S SHEMP=SHEMP_$J($P(SRA(209),"^",11),2)_$J(Y,5)
"RTN","SROATCM3",15,0)
 S X=$P(SRA(209),"^",12) S:X="" X="N" S SHEMP=SHEMP_$J(X,2)
"RTN","SROATCM3",16,0)
 ; CT Surgery Consult Date and cause for delay & Primary Cause for Delay
"RTN","SROATCM3",17,0)
 S SHEMP=SHEMP_$J("",9)
"RTN","SROATCM3",18,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1
"RTN","SROATCM3",19,0)
LN27 ;Line #27 - Other Cardiac Procedures
"RTN","SROATCM3",20,0)
 S SHEMP=$E(SHEMP,1,11)_" 27"_$TR($E($G(SRA(209.1)),1,65),",","^")
"RTN","SROATCM3",21,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1
"RTN","SROATCM3",22,0)
LN28 ;Lines 28 - New fields added in 2006 update
"RTN","SROATCM3",23,0)
 S SHEMP=$E(SHEMP,1,11)_" 28"_$J($P(SRA(209),"^",13),2)_$J($P(SRA(209),"^",14),2)_$J($P(SRA(207.1),"^",2),2)_$J($P(SRA(201),"^",28),6)_$J($P(SRA(202.1),"^"),7)
"RTN","SROATCM3",24,0)
 S SHEMP=SHEMP_$J($P(SRA(201),"^",29),5)_$J($P(SRA(202.1),"^",2),7)
"RTN","SROATCM3",25,0)
 I $D(SRRES(2)) F I=8,9 S SHEMP=SHEMP_$J($P(SRRES(2),"^",I),8)
"RTN","SROATCM3",26,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SRACNT=SRACNT+1
"RTN","SROATCM3",27,0)
 Q
"RTN","SROATM1")
0^67^B26038317^B25818950
"RTN","SROATM1",1,0)
SROATM1 ;BIR/MAM - NON CARDIAC TRANSMISSION ;09/15/2011
"RTN","SROATM1",2,0)
 ;;3.0;Surgery;**27,38,47,60,62,81,88,93,95,125,153,160,166,174,176,177**;24 Jun 93;Build 89
"RTN","SROATM1",3,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROATM1",4,0)
 ;**         controlled procedure. Local modifications to this routine
"RTN","SROATM1",5,0)
 ;**         are prohibited.
"RTN","SROATM1",6,0)
 ;
"RTN","SROATM1",7,0)
 ; Reference to ^DIC(45.3 supported by DBIA #218
"RTN","SROATM1",8,0)
 ;
"RTN","SROATM1",9,0)
 N SRINTUB,SRDTH,SRPID,SROR F I=0,200,200.1,206,52 S SRA(I)=$G(^SRF(SRTN,I))
"RTN","SROATM1",10,0)
 S DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRANAME=VADM(1),SEX=$P(VADM(5),"^"),Z=$P(VADM(3),"^"),SRSDATE=$E($P(SRA(0),"^",9),1,12),Y=$E(SRSDATE,1,7),AGE=$E(Y,1,3)-$E(Z,1,3)-($E(Y,4,7)<$E(Z,4,7))
"RTN","SROATM1",11,0)
 S SRPID=VA("PID"),SRPID=$TR(SRPID,"-","") ; remove hyphens from PID
"RTN","SROATM1",12,0)
 S X=$$SITE^SROUTL0(SRTN),SRDIV=$S(X:$P(^SRO(133,X,0),"^"),1:""),SRDIV=$S(SRDIV:$$GET1^DIQ(4,SRDIV,99),1:SRASITE)
"RTN","SROATM1",13,0)
 S X=$P($G(^SRF(SRTN,205)),"^",3),SRDTH=$S(X:X,1:$P(VADM(6),"^"))
"RTN","SROATM1",14,0)
 S SROR="",Y=$P(SRA(0),"^",2),C=$P(^DD(130,.02,0),"^",2) I Y'="" D Y^DIQ S SROR=Y
"RTN","SROATM1",15,0)
 ;JAS - 06/06/14 - PATCH 177 - Changed first character from ">" to "$" to denote new format for ICD-10
"RTN","SROATM1",16,0)
 S SHEMP="$"_$J(SRASITE,3)_$J(SRTN,7)_"  1"_DT_$J(AGE,3)_$J(SEX,1)_$J(SRSDATE,12)_$J(SRPID,20)_$J(SRDIV,6)_$J(SRDTH,12)_$J($E(SROR,1,30),30)
"RTN","SROATM1",17,0)
 F I=1:1:6 S SHEMP=SHEMP_$J($P(SRA(52),"^",I),2)
"RTN","SROATM1",18,0)
 S SHEMP=SHEMP_$J($P(SRA(200),"^",55),2) F I=9:1:14 S SHEMP=SHEMP_$J($P(SRA(200.1),"^",I),2)
"RTN","SROATM1",19,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_"  2",SRACNT=SRACNT+1
"RTN","SROATM1",20,0)
 S NYUK=$P(SRA(200),"^",2) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",3) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",4) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200.1),"^",2) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",21,0)
 S NYUK=$P(SRA(200),"^",6) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",7) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",8) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",10) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",22,0)
 S NYUK=$P(SRA(200),"^",11) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",12) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200.1),"^",6) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",15) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",23,0)
 S NYUK=$P(SRA(200),"^",16) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",17) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",31) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",32) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",24,0)
 S NYUK=$P(SRA(200),"^",33) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",34) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",35) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",36) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",25,0)
 S NYUK=$P(SRA(200),"^",38) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",39) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",41) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",42) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",26,0)
 S NYUK=$P(SRA(200),"^",43) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",19) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",20) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",21) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",27,0)
 S NYUK=$P(SRA(200),"^",22) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",23) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",24) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",25) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",28,0)
 S NYUK=$P(SRA(200),"^",26) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",27) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",28) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",29) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",29,0)
 S NYUK=$P(SRA(200),"^",45) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",46) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",47) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",48) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",30,0)
 S NYUK=$P(SRA(200),"^",49) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200),"^",50) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(200.1),"^",3),SHEMP=SHEMP_$J(NYUK,2)
"RTN","SROATM1",31,0)
 S NYUK=$P(SRA(0),"^",4) S:NYUK NYUK=$E($P(^DIC(45.3,$P(^SRO(137.45,NYUK,0),"^",2),0),"^"),1,3) S SHEMP=SHEMP_$J(NYUK,3)
"RTN","SROATM1",32,0)
 S NYUK=$P(SRA(200),"^",52),SHEMP=SHEMP_$J(NYUK,2),X=$P(SRA(0),"^",10),NYUK=$S(X="EM":"Y",1:"N") D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",33,0)
 S NYUK=$P($G(^SRF(SRTN,"1.0")),"^",8),SHEMP=SHEMP_$J(NYUK,2),NYUK=$P(SRA(200),"^",53) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",34,0)
 S SRASA="",Y=$P($G(^SRF(SRTN,1.1)),"^",3) S:Y X=$P($G(^SRO(132.8,Y,0)),"^"),SRASA=X S NYUK=$E(SRASA,1,1) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM1",35,0)
 K SRTECH,SRZ,SRTRAUMA S SRT=0 F  S SRT=$O(^SRF(SRTN,6,SRT)) Q:'SRT  D ^SROPRIN Q:$D(SRZ)
"RTN","SROATM1",36,0)
 I $D(SRTECH) S SRTRAUMA=$P(^SRF(SRTN,6,SRT,0),"^",14),SRINTUB=$P($G(^SRF(SRTN,6,SRT,8)),"^",2)
"RTN","SROATM1",37,0)
 I '$D(SRTECH) S (SRTECH,SRTRAUMA,SRINTUB)=""
"RTN","SROATM1",38,0)
 S SHEMP=SHEMP_$J(SRTECH,1)_$J($E(SRASA,2),1)_$J(SRINTUB,1)_$J($P(SRA(200.1),"^",8),1)
"RTN","SROATM1",39,0)
 S NYUK=$P(SRA(206),"^"),SHEMP=SHEMP_$J(NYUK,4),NYUK=$P(SRA(206),"^",2),SHEMP=SHEMP_$J(NYUK,4)
"RTN","SROATM1",40,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_"  3",SRACNT=SRACNT+1
"RTN","SROATM1",41,0)
 D ^SROATM2
"RTN","SROATM1",42,0)
 Q
"RTN","SROATM1",43,0)
ONE S MOE=$S(NYUK="NS":"S",NYUK="":" ",1:NYUK)
"RTN","SROATM1",44,0)
 Q
"RTN","SROATM2")
0^6^B35137516^B35035640
"RTN","SROATM2",1,0)
SROATM2 ;BIR/MAM - NON CARDIAC TRANSMISSION (CONT) ;09/15/2011
"RTN","SROATM2",2,0)
 ;;3.0;Surgery;**38,39,45,47,57,60,62,68,81,88,97,129,125,142,153,160,174,175,176,177**;24 Jun 93;Build 89
"RTN","SROATM2",3,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROATM2",4,0)
 ;**         controlled procedure. Local modifications to this routine
"RTN","SROATM2",5,0)
 ;**         are prohibited.
"RTN","SROATM2",6,0)
 ;
"RTN","SROATM2",7,0)
 K SRA F I=.2,.3,1.1,200.1,201:1:208,208.1,202.1 S SRA(I)=$G(^SRF(SRTN,I))
"RTN","SROATM2",8,0)
 S SRA("CON")=$P($G(^SRF(SRTN,"CON")),"^") I SRA("CON"),$P($G(^SRF(SRA("CON"),30)),"^")!($P($G(^SRF(SRA("CON"),31)),"^",8)) S SRA("CON")=""
"RTN","SROATM2",9,0)
 D RS
"RTN","SROATM2",10,0)
 S SHEMP=SHEMP_$J($E($P(SRA(.2),"^",2),1,12),12)_$J($E($P(SRA(.2),"^",3),1,12),12)_$J(SRATT,2)_$J($P(SRA(200.1),"^",4),2)_$J($P($G(^SRF(SRTN,200)),"^",54),2)
"RTN","SROATM2",11,0)
 S SRICD=$P($G(^SRO(136,SRTN,0)),"^",3) S:SRICD SRICD=$P($$ICD^SROICD(SRTN,SRICD),"^",2) S SHEMP=SHEMP_$J(SRICD,8)_$J($P(SRA(205),"^"),4)_"      "
"RTN","SROATM2",12,0)
 S NYUK="N",SRET=0 F  S SRET=$O(^SRF(SRTN,29,SRET)) Q:'SRET  S CASE=$P(^SRF(SRTN,29,SRET,0),"^") I $P($G(^SRF(CASE,.2)),"^",10) S NYUK="Y" Q
"RTN","SROATM2",13,0)
 S SHEMP=SHEMP_NYUK_$J($P($G(^SRF(SRTN,.4)),"^",7),1)_$J($E($P($G(^SRF(SRTN,0)),"^",12)),1)_$J($P($G(^SRF(SRTN,0)),"^",3),1)
"RTN","SROATM2",14,0)
 S (SRADMIT,SRADMT)=0 I '$P(SRA(208),"^",14) D ADM^SROQ0A S SRADMIT=$S(SRADMT=0:"0",1:"1")
"RTN","SROATM2",15,0)
 S SHEMP=SHEMP_" "_SRADMIT D OCC^SROATMNO S SHEMP=SHEMP_SRTMP_$J(SROCTYPE,1)_$J(SROC(35),2)_$J(SROC(36),2)
"RTN","SROATM2",16,0)
 S NYUK=$E($P(VADM(3),"^"),1,7),SHEMP=SHEMP_$J(NYUK,7) ; date of birth
"RTN","SROATM2",17,0)
 S SHEMP=SHEMP_$J(SROC(38),2)_$J(SROC(39),2) K SROC,SROCTYPE,SRTMP
"RTN","SROATM2",18,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_"  4",SRACNT=SRACNT+1
"RTN","SROATM2",19,0)
 F MOE=1:1:6 S CPT(MOE)=""
"RTN","SROATM2",20,0)
 S (X,CNT)=0 F  S X=$O(^SRF(SRTN,29,X)) Q:'X!(CNT=6)  I $P(^SRF(SRTN,29,X,0),"^",3)="R" S NYUK=$P(^SRF(SRTN,29,X,0),"^") D RETURN
"RTN","SROATM2",21,0)
 S SHEMP=SHEMP_$J(CNT,2)
"RTN","SROATM2",22,0)
 S SHEMP=SHEMP_$J(CPT(1),5)_$J(CPT(2),5)_$J(CPT(3),5)_$J(CPT(4),5)_$J(CPT(5),5)_$J(CPT(6),5)
"RTN","SROATM2",23,0)
 F MOE=1:1:6 S CPT(MOE)=""
"RTN","SROATM2",24,0)
 S (X,CNT)=0 F  S X=$O(^SRF(SRTN,29,X)) Q:'X!(CNT=6)  I $P(^SRF(SRTN,29,X,0),"^",3)'="R" S NYUK=$P(^SRF(SRTN,29,X,0),"^") D RETURN
"RTN","SROATM2",25,0)
 S SHEMP=SHEMP_$J(CNT,2)
"RTN","SROATM2",26,0)
 S SHEMP=SHEMP_$J(CPT(1),5)_$J(CPT(2),5)_$J(CPT(3),5)_$J(CPT(4),5)_$J(CPT(5),5)_$J(CPT(6),5)
"RTN","SROATM2",27,0)
 S SRSDATE=$P(^SRF(SRTN,0),"^",9) K SRSEP D OCC^SROAUTL0 S:'$D(SRO) SRO="",$P(SRO," ",198)="" S SHEMP=SHEMP_$E(SRO,1,112)
"RTN","SROATM2",28,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_"  5",SRACNT=SRACNT+1
"RTN","SROATM2",29,0)
 S NYUK=$P(SRA(205),"^",6) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",7) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",8) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",10) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM2",30,0)
 S NYUK="N" I $P(SRA(205),"^",11)="Y"!($P(SRA(205),"^",28)="Y") S NYUK="Y"
"RTN","SROATM2",31,0)
 D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",12) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",13) D ONE S SHEMP=SHEMP_MOE,NYUK=$P($G(SROOC(29)),U)
"RTN","SROATM2",32,0)
 D IFELSE
"RTN","SROATM2",33,0)
 S NYUK=$P(SRA(205),"^",16) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",17) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",18) D ONE S SHEMP=SHEMP_MOE,NYUK=$P($G(SROOC(31)),U)
"RTN","SROATM2",34,0)
 D IFELSE
"RTN","SROATM2",35,0)
 N SRCVA D CVA S SHEMP=SHEMP_SRCVA
"RTN","SROATM2",36,0)
 S NYUK=$P(SRA(205),"^",22) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",23) D ONE S SHEMP=SHEMP_MOE,NYUK=$P($G(SROOC(30)),U)
"RTN","SROATM2",37,0)
 D IFELSE
"RTN","SROATM2",38,0)
 S NYUK=$P(SRA(205),"^",26) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",27) D ONE S SHEMP=SHEMP_MOE_" " S NYUK=$P($G(SROOC(32)),U)
"RTN","SROATM2",39,0)
 D IFELSE
"RTN","SROATM2",40,0)
 S NYUK=$P(SRA(205),"^",31) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",32) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",33) D ONE S SHEMP=SHEMP_MOE,NYUK=$P(SRA(205),"^",34) D ONE S SHEMP=SHEMP_MOE
"RTN","SROATM2",41,0)
 S NYUK=$P(SRA(205),"^",35) D ONE S SHEMP=SHEMP_MOE,NYUK=$P($G(SROOC(21)),U) D IFELSE
"RTN","SROATM2",42,0)
 S SHEMP=SHEMP_$E(SRO,113,196),NYUK=$P(SRA(205),"^",37) D ONE S SHEMP=SHEMP_MOE,NYUK=$P($G(SROOC(36)),U) D IFELSE
"RTN","SROATM2",43,0)
 S SHEMP=SHEMP_$J($E(SRO,204),1)
"RTN","SROATM2",44,0)
 S NYUK=$P(SRA(205),"^",39) D ONE S SHEMP=SHEMP_MOE_$E(SRO,197,203)
"RTN","SROATM2",45,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_"  6",SRACNT=SRACNT+1
"RTN","SROATM2",46,0)
 S SHEMP=SHEMP_$J($P(SRA(201),"^"),5)_$J($P(SRA(202),"^"),7)_$J($P(SRA(201),"^",8),4)_$J($P(SRA(202),"^",8),7)_$J($P(SRA(201),"^",9),5)_$J($P(SRA(202),"^",9),7)_$J($P(SRA(201),"^",5),5)_$J($P(SRA(202),"^",5),7)
"RTN","SROATM2",47,0)
 S SHEMP=SHEMP_$J($P(SRA(201),"^",4),4)_$J($P(SRA(202),"^",4),7)
"RTN","SROATM2",48,0)
 S SHEMP=SHEMP_$J($P(SRA(201),"^",27),5)_$J($P(SRA(202),"^",27),7)
"RTN","SROATM2",49,0)
 S SHEMP=SHEMP_$J($P(SRA(203),"^",15),5)_$J($P(SRA(204),"^",15),7)
"RTN","SROATM2",50,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_"  7",SRACNT=SRACNT+1
"RTN","SROATM2",51,0)
 S SHEMP=SHEMP_$J($E($P(SRA(208),"^",14),1,12),12)_"  "_$J($P($G(SRA(208)),"^",11),2)_$J($P($G(SRA(208)),"^",10),2)_$J($E($P($G(SRA(208)),"^",9),1,4),4)
"RTN","SROATM2",52,0)
 S SHEMP=SHEMP_$J($E($P(SRA(208),"^",15),1,12),12)_"    "_$J($P($G(SRA(206)),"^",3),2)_$J($P($G(SRA(206)),"^",4),2)_$J($P($G(SRA(206)),"^",8),2)_"  "
"RTN","SROATM2",53,0)
 S SHEMP=SHEMP_$J($E($P(SRA(208),"^",16),1,12),12)_$J($E($P(SRA(208),"^",17),1,12),12)_$J($E($P(SRA(.2),"^",12),1,12),12)_$J($E($P(SRA(.2),"^"),1,12),12)
"RTN","SROATM2",54,0)
 S SHEMP=SHEMP_$J($E($P(SRA(1.1),"^",8),1,12),12)_$J($E($P(SRA(208.1),"^"),1,12),12)_$J($E($P(SRA(208.1),"^",2),1,12),12)_$J($E($P(SRA(208.1),"^",3),1,3),3)_$J(SRA("CON"),10)_$J($E($P(SRA(.2),"^",4),1,12),12)
"RTN","SROATM2",55,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_"  8",SRACNT=SRACNT+1
"RTN","SROATM2",56,0)
 S SHEMP=SHEMP_$J($P(SRA(201),"^",11),5)_$J($P(SRA(202),"^",11),7)_$J($P(SRA(201),"^",12),5)_$J($P(SRA(202),"^",12),7)_$J($P(SRA(201),"^",13),4)_$J($P(SRA(202),"^",13),7)_$J($P(SRA(201),"^",14),4)_$J($P(SRA(202),"^",14),7)
"RTN","SROATM2",57,0)
 S SHEMP=SHEMP_$J($P(SRA(201),"^",15),5)_$J($P(SRA(202),"^",15),7)
"RTN","SROATM2",58,0)
 S SHEMP=SHEMP_$J($P(SRA(201),"^",28),6)_$J($P(SRA(202.1),"^"),7)
"RTN","SROATM2",59,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SHEMP,SHEMP=$E(SHEMP,1,11)_"  9",SRACNT=SRACNT+1
"RTN","SROATM2",60,0)
 D ^SROATM3
"RTN","SROATM2",61,0)
 Q
"RTN","SROATM2",62,0)
ONE S MOE=$S(NYUK="NS":"S",NYUK="":" ",1:NYUK)
"RTN","SROATM2",63,0)
 Q
"RTN","SROATM2",64,0)
IFELSE I NYUK["NO ICD" S SHEMP=SHEMP_$J(" ",8)
"RTN","SROATM2",65,0)
 E  S SHEMP=SHEMP_$J(NYUK,8)
"RTN","SROATM2",66,0)
 Q
"RTN","SROATM2",67,0)
CVA S X=$P(SRA(205),"^",21),SRCVA=$S(X="Y":"Y",1:1) I SRCVA=1 Q
"RTN","SROATM2",68,0)
 N SROCC S SROCC=0 F  S SROCC=$O(^SRF(SRTN,16,SROCC)) Q:'SROCC  I $P(^SRF(SRTN,16,SROCC,0),"^",2)=12 S X=$P(^SRF(SRTN,16,SROCC,0),"^",8) S:X'="" SRCVA=X Q
"RTN","SROATM2",69,0)
 Q
"RTN","SROATM2",70,0)
RS ; resident supervision (attending code)
"RTN","SROATM2",71,0)
 N SRSR,SRX S (SRATT,SRSR)="",SRX=$G(^SRF(SRTN,.1)) D SRES
"RTN","SROATM2",72,0)
 S SRATT=$P(SRX,"^",10) I SRATT="" D
"RTN","SROATM2",73,0)
 .I SRSR=0 S SRATT=$S($P(^SRF(SRTN,0),"^",9)<3040401:1,1:9) Q
"RTN","SROATM2",74,0)
 .S SRATT=99
"RTN","SROATM2",75,0)
 Q
"RTN","SROATM2",76,0)
SRES ; does site have residents?
"RTN","SROATM2",77,0)
 N SRDIV,SRSITE,Y S SRDIV=$P($G(^SRF(SRTN,8)),"^") I SRDIV S SRSITE=$O(^SRO(133,"B",SRDIV,0)),SRSR=$P(^SRO(133,SRSITE,0),"^",19)
"RTN","SROATM2",78,0)
 Q
"RTN","SROATM2",79,0)
RETURN ; CPT of Returns
"RTN","SROATM2",80,0)
 S Y=$P($G(^SRO(136,NYUK,0)),"^",2) I Y S CNT=CNT+1,CPT(CNT)=$P($$CPT^ICPTCOD(Y),"^",2)
"RTN","SROATM2",81,0)
 Q
"RTN","SROATMNO")
0^29^B36769071^B36435737
"RTN","SROATMNO",1,0)
SROATMNO ;BIR/MAM - TRANSMIT NO ASSESSMENT ;09/12/2011
"RTN","SROATMNO",2,0)
 ;;3.0;Surgery;**27,38,47,62,68,79,83,81,88,93,95,97,129,125,142,153,160,166,174,175,176,177**;24 Jun 93;Build 89
"RTN","SROATMNO",3,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROATMNO",4,0)
 ;**         controlled procedure. Local modifications to this routine
"RTN","SROATMNO",5,0)
 ;**         are prohibited.
"RTN","SROATMNO",6,0)
 ;
"RTN","SROATMNO",7,0)
 ; Reference to ^DIC(45.3 supported by DBIA #218
"RTN","SROATMNO",8,0)
 ;
"RTN","SROATMNO",9,0)
 N SR1L,SR10SP,SRINTUB,SR95PO,SRLO,SRPID,TDATE K ^TMP("SRA",$J) S SRATOT=0,SRASITE=+$P($$SITE^SROVAR,"^",3),(SRAMNUM,SRACNT)=1
"RTN","SROATMNO",10,0)
 S Z=$E(DT,1,3)-2,SRLO=Z_"1215"
"RTN","SROATMNO",11,0)
 S TDATE=0 F  S TDATE=$O(^SRF("AQ",TDATE)) Q:TDATE=""  I DT'<TDATE S SRTN=0 F  S SRTN=$O(^SRF("AQ",TDATE,SRTN)) Q:'SRTN  D SET
"RTN","SROATMNO",12,0)
 S SRATOTM=SRAMNUM,SR1L=1 D ^SROATM4
"RTN","SROATMNO",13,0)
 Q
"RTN","SROATMNO",14,0)
SET I $P($G(^SRF(SRTN,.4)),"^",2)="T"!(TDATE<SRLO) K ^SRF("AQ",TDATE,SRTN) Q
"RTN","SROATMNO",15,0)
 I $P($G(^SRF(SRTN,"NON")),"^")="Y" K ^SRF("AQ",TDATE,SRTN) S $P(^SRF(SRTN,.4),"^",2)="" Q
"RTN","SROATMNO",16,0)
 I $P($G(^SRF(SRTN,"RA")),"^",6)="Y",$P($G(^SRF(SRTN,"RA")),"^",2)="N" K ^SRF("AQ",TDATE,SRTN) Q
"RTN","SROATMNO",17,0)
 I $P($G(^SRF(SRTN,0)),"^",9)="" K ^SRF("AQ",TDATE,SRTN) Q
"RTN","SROATMNO",18,0)
 S SR10SP="          " K DA,DIE,DR S DA=SRTN,DIE=130,DR="905///R" D ^DIE K DR,DA,DIE
"RTN","SROATMNO",19,0)
 S SRA(0)=^SRF(SRTN,0),DATE=$E($P(SRA(0),"^",9),1,7),SPEC=$P(SRA(0),"^",4) S:SPEC SPEC=$P(^DIC(45.3,$P(^SRO(137.45,SPEC,0),"^",2),0),"^")
"RTN","SROATMNO",20,0)
 S EMERG=$P(SRA(0),"^",10),EMERG=$S(EMERG="EM":"Y",1:"N")
"RTN","SROATMNO",21,0)
 K SRTECH,SRZ S SRT=0 F  S SRT=$O(^SRF(SRTN,6,SRT)) Q:'SRT  D ^SROPRIN Q:$D(SRZ)
"RTN","SROATMNO",22,0)
 I $D(SRTECH) S SRINTUB=$P($G(^SRF(SRTN,6,SRT,8)),"^",2)
"RTN","SROATMNO",23,0)
 I '$D(SRTECH) S (SRTECH,SRINTUB)=""
"RTN","SROATMNO",24,0)
 S CPT=$P($G(^SRO(136,SRTN,0)),"^",2),SRPMOD="" I CPT S CPT=$P($$CPT^ICPTCOD(CPT),"^",2) D
"RTN","SROATMNO",25,0)
 .S SRM=0,SRCNT=1 F  S SRM=$O(^SRO(136,SRTN,1,SRM)) Q:'SRM  D  Q:SRCNT>5
"RTN","SROATMNO",26,0)
 ..S X=$P(^SRO(136,SRTN,1,SRM,0),"^") I X S Y=$P($$MOD^ICPTMOD(X,"I"),"^",2),SRPMOD=SRPMOD_Y,SRCNT=SRCNT+1
"RTN","SROATMNO",27,0)
 S DFN=$P(SRA(0),"^") N I D DEM^VADPT S SRDOB=$E($P(VADM(3),"^"),1,7),SRDEATH=$P(VADM(6),U),SRSEX=$P(VADM(5),"^")
"RTN","SROATMNO",28,0)
 S SRPID=VA("PID"),SRPID=$TR(SRPID,"-","") ; remove hyphens from PID
"RTN","SROATMNO",29,0)
 S X=$$SITE^SROUTL0(SRTN),SRDIV=$S(X:$P(^SRO(133,X,0),"^"),1:""),SRDIV=$S(SRDIV:$$GET1^DIQ(4,SRDIV,99),1:SRASITE)
"RTN","SROATMNO",30,0)
 D RS^SROATM2
"RTN","SROATMNO",31,0)
 S SRMAJMIN=$E($P($G(^SRF(SRTN,0)),U,3),1)
"RTN","SROATMNO",32,0)
 S SRDTHUR=$E($P($G(^SRF(SRTN,.4)),U,7),1)
"RTN","SROATMNO",33,0)
 S SRSTATUS=$S($P($G(^SRF(SRTN,208)),"^",14):"I",1:$E($P($G(^SRF(SRTN,0)),U,12),1))
"RTN","SROATMNO",34,0)
 I SRSTATUS'="I"&(SRSTATUS'="O") S VAIP("D")=$P(SRA(0),"^",9) D IN5^VADPT S SRSTATUS=$S(VAIP(13):"I",1:"O") K VAIP
"RTN","SROATMNO",35,0)
 S SRAGE="" I $P(VADM(3),"^") S SRAGE=$E(DATE,1,3)-$E($P(VADM(3),"^"),1,3)-($E(DATE,4,7)<$E($P(VADM(3),"^"),4,7))
"RTN","SROATMNO",36,0)
 S SRASA="",Y=$P($G(^SRF(SRTN,1.1)),"^",3) S:Y X=$P($G(^SRO(132.8,Y,0)),"^"),SRASA=$E(X,1,2)
"RTN","SROATMNO",37,0)
 ; Admission wi 14 days following outpatient surgery due to an Occurrence
"RTN","SROATMNO",38,0)
 S (SRADMIT,SRADMT)=0 I SRSTATUS="O" D ADM^SROQ0A S SRADMIT=$S(SRADMT=0:"0",1:"1")
"RTN","SROATMNO",39,0)
 S EXC=$P($G(^SRF(SRTN,"RA")),"^",7),SRWOUND=$P($G(^SRF(SRTN,"1.0")),"^",8)
"RTN","SROATMNO",40,0)
 D OCC
"RTN","SROATMNO",41,0)
 S SRNODE="  X" S:$P($G(^SRF(SRTN,"RA")),U,6)="N" SRNODE="  *" S:$P($G(^SRF(SRTN,"RA")),U,2)="C" SRNODE="  C"
"RTN","SROATMNO",42,0)
 ;JAS - 06/06/14 - PATCH 177 - Changed first character from "/" to "$" to denote new format for ICD-10
"RTN","SROATMNO",43,0)
 S SRTEMP="$"_$J(SRASITE,3)_$J(SRTN,7)_SRNODE_$J(DATE,7)_$J(SRTECH,3)_$J(EMERG,1)_$J(SPEC,3)_$J(CPT,5)_$J(EXC,1)_$J(SRPID,20)_$J(SRDIV,6)_$J(SRSEX,1)
"RTN","SROATMNO",44,0)
 S SRTEMP=SRTEMP_$J(SRMAJMIN,1)_$J($E(SRDEATH,1,7),7)_$J(SRDTHUR,1)_$J(SRSTATUS,1)_$J(SRAGE,3)_$J(SRASA,2)_$J(SRADMIT,1)_SRTMP
"RTN","SROATMNO",45,0)
 K CPT,SRMOD F SRZ=1:1:10 S (CPT(SRZ),SRMOD(SRZ))=""
"RTN","SROATMNO",46,0)
 S (OPS,CNT)=0 F  S OPS=$O(^SRO(136,SRTN,3,OPS)) Q:'OPS!(CNT=10)  S CNT=CNT+1,X=$P($G(^SRO(136,SRTN,3,OPS,0)),"^") I X S CPT(CNT)=$P($$CPT^ICPTCOD(X),"^",2) D MOD
"RTN","SROATMNO",47,0)
 S SRCC=$P($G(^SRF(SRTN,"CON")),"^"),SRBLANK="          "
"RTN","SROATMNO",48,0)
 I SRCC,$P($G(^SRF(SRCC,30)),"^")!($P($G(^SRF(SRCC,31)),"^",8)) S SRCC=""
"RTN","SROATMNO",49,0)
 S SRTEMP=SRTEMP_$J(CPT(1),5)_$J(CPT(2),5)_$J(CPT(3),5)_$J(CPT(4),5)_$J(CPT(5),5)_$J(CPT(6),5)_$J(CPT(7),5)_$J(CPT(8),5)_$J(CPT(9),5)_$J(CPT(10),5)_$J(SRWOUND,2)_$J(SROCTYPE,1)_SRBLANK_$J(SRCC,10)_$J(SRDEATH,12)
"RTN","SROATMNO",50,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SRTEMP,SRACNT=SRACNT+1
"RTN","SROATMNO",51,0)
 S SRICD=$P($G(^SRO(136,SRTN,0)),"^",3) S:SRICD SRICD=$P($$ICD^SROICD(SRTN,SRICD),"^",2)
"RTN","SROATMNO",52,0)
 N SRCVA D CVA S SRA(.2)=$G(^SRF(SRTN,.2))
"RTN","SROATMNO",53,0)
 S SRTEMP="/"_$J(SRASITE,3)_$J(SRTN,7)_"  B"_$J($E($P(SRA(.2),"^"),1,12),12)_$J($E($P(SRA(.2),"^",4),1,12),12)_$E(SRPMOD_SR10SP,1,10)
"RTN","SROATMNO",54,0)
 F I=1:1:10 S SRTEMP=SRTEMP_$E(SRMOD(I)_SR10SP,1,10)
"RTN","SROATMNO",55,0)
 S SRTEMP=SRTEMP_$J(SRINTUB,1)_SR95PO_$J(SRATT,2)_$J(SRDOB,7)_$J(SRICD,8)_$J(SROC(38),2)_$J(SROC(39),2)
"RTN","SROATMNO",56,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SRTEMP_$J($P(SRA(.2),"^",10),12)_$J($P(SRA(.2),"^",12),12)_$J($P(SRA(.2),"^",2),12)_$J($P(SRA(.2),"^",3),12)_$J(SRCVA,1),SRACNT=SRACNT+1
"RTN","SROATMNO",57,0)
 S SRA(.9)=$G(^SRF(SRTN,.9)),SRA("VER")=$G(^SRF(SRTN,"VER")),SRA(52)=$G(^SRF(SRTN,52))
"RTN","SROATMNO",58,0)
 S SRTEMP="/"_$J(SRASITE,3)_$J(SRTN,7)_"  D"_$J($P(SRA(.9),"^"),12)_$J($P(SRA(.9),"^",2),12)_$J($P(SRA(.9),"^",3),12)_$J($P(SRA(.9),"^",4),12)_$J($P(SRA(.9),"^",5),12)_$J($P(SRA(.9),"^",6),12)
"RTN","SROATMNO",59,0)
 S SRTEMP=SRTEMP_$J($P($G(^SRF(SRTN,30)),"^"),12)_$J($P($G(^SRF(SRTN,31)),"^",8),4)_$J($P($G(^SRF(SRTN,30)),"^",4),50)
"RTN","SROATMNO",60,0)
 F I=7:1:18 S SRTEMP=SRTEMP_$J($P(SRA("VER"),"^",I),2)
"RTN","SROATMNO",61,0)
 S SROR="",Y=$P(^SRF(SRTN,0),"^",2),C=$P(^DD(130,.02,0),"^",2) I Y'="" D Y^DIQ S SROR=Y
"RTN","SROATMNO",62,0)
 S SRTEMP=SRTEMP_$J($E(SROR,1,30),30) F I=1:1:6 S SRTEMP=SRTEMP_$J($P(SRA(52),"^",I),2)
"RTN","SROATMNO",63,0)
 S ^TMP("SRA",$J,SRAMNUM,SRACNT,0)=SRTEMP,SRACNT=SRACNT+1
"RTN","SROATMNO",64,0)
 I SRACNT>100 S SRACNT=1,SRAMNUM=SRAMNUM+1
"RTN","SROATMNO",65,0)
 S SRATOT=SRATOT+1
"RTN","SROATMNO",66,0)
 S X=$E($P(^SRF(SRTN,0),"^",9),1,5)_"00",^TMP("SRWL",$J,X)=""
"RTN","SROATMNO",67,0)
 K DATE,ANES,EMERG,EXC,SPEC,SRADMIT,SRADMT,SRATT,SRBLANK,SRCC,SRDIV,SRDOB,SRDTHUR,SRICD,SRIO,SRMAJMIN,SROCTYPE,SROR,SRSEX,SRTEMP,SRTMP,SRWOUND,SRZ,SR14,CPT
"RTN","SROATMNO",68,0)
 Q
"RTN","SROATMNO",69,0)
OCC ; total of each occurrence by category
"RTN","SROATMNO",70,0)
 N SRIOFLAG,SRPOFLAG
"RTN","SROATMNO",71,0)
 F SRK=1:1:39 S SROC(SRK)=""
"RTN","SROATMNO",72,0)
 S (SRPO,SRIOFLAG)=0 F  S SRPO=$O(^SRF(SRTN,10,SRPO)) Q:'SRPO  S SRSUB=$P(^SRF(SRTN,10,SRPO,0),U,2) I SRSUB'="" D
"RTN","SROATMNO",73,0)
 .S SROC(SRSUB)=SROC(SRSUB)+1,SRIOFLAG=1
"RTN","SROATMNO",74,0)
 S (SRPO,SRPOFLAG)=0 F  S SRPO=$O(^SRF(SRTN,16,SRPO)) Q:'SRPO  S SRSUB=$P(^SRF(SRTN,16,SRPO,0),U,2) I SRSUB'="" D
"RTN","SROATMNO",75,0)
 .S SROC(SRSUB)=SROC(SRSUB)+1,SRPOFLAG=1
"RTN","SROATMNO",76,0)
 S (SROCTYPE,SRTMP)="" F SRK=1:1:10 S SRTMP=SRTMP_$J(SROC(SRK),2)
"RTN","SROATMNO",77,0)
 S SRTMP=SRTMP_$J(SROC(37),2) F SRK=12:1:32 S SRTMP=SRTMP_$J(SROC(SRK),2)
"RTN","SROATMNO",78,0)
 S SR95PO=$J(SROC(33),2)_$J(SROC(34),2)_$J(SROC(35),2)_$J(SROC(36),2)
"RTN","SROATMNO",79,0)
 I SRIOFLAG=1,(SRPOFLAG=0) S SROCTYPE="I"
"RTN","SROATMNO",80,0)
 I SRIOFLAG=0,(SRPOFLAG=1) S SROCTYPE="P"
"RTN","SROATMNO",81,0)
 I SRIOFLAG=1,(SRPOFLAG=1) S SROCTYPE="B"
"RTN","SROATMNO",82,0)
 I SRIOFLAG=0,(SRPOFLAG=0) S SROCTYPE=""
"RTN","SROATMNO",83,0)
 Q
"RTN","SROATMNO",84,0)
MOD N SRM S SRM=0,SRCNT=1 F  S SRM=$O(^SRO(136,SRTN,3,OPS,1,SRM)) Q:'SRM  D  Q:SRCNT>5
"RTN","SROATMNO",85,0)
 .S X=$P(^SRO(136,SRTN,3,OPS,1,SRM,0),"^"),Y=$P($$MOD^ICPTMOD(X,"I"),"^",2)
"RTN","SROATMNO",86,0)
 .I Y'="" S SRMOD(CNT)=SRMOD(CNT)_Y,SRCNT=SRCNT+1
"RTN","SROATMNO",87,0)
 Q
"RTN","SROATMNO",88,0)
CVA S X=$P($G(^SRF(SRTN,205)),"^",21),SRCVA=$S(X="Y":"Y",1:1) I SRCVA=1 Q
"RTN","SROATMNO",89,0)
 N SROCC S SROCC=0 F  S SROCC=$O(^SRF(SRTN,16,SROCC)) Q:'SROCC  I $P(^SRF(SRTN,16,SROCC,0),"^",2)=12 S X=$P(^SRF(SRTN,16,SROCC,0),"^",8) S:X'="" SRCVA=X Q
"RTN","SROATMNO",90,0)
 Q
"RTN","SROAUTL0")
0^30^B21283908^B21141152
"RTN","SROAUTL0",1,0)
SROAUTL0 ;BIR/ADM,SLM - RISK ASSESSMENT UTILITY ;08/16/2011
"RTN","SROAUTL0",2,0)
 ;;3.0;Surgery;**38,47,57,60,61,63,81,125,153,160,174,176,177**;24 Jun 93;Build 89
"RTN","SROAUTL0",3,0)
PREOP K DR S SRQ=1,DR="325;238;240;204;203;396;332;333;338;339;215;217"
"RTN","SROAUTL0",4,0)
 Q
"RTN","SROAUTL0",5,0)
PREMD K DR S SRQ=1,DR=".011;247;413;417;418;419;420;421;452;453;454"
"RTN","SROAUTL0",6,0)
 Q
"RTN","SROAUTL0",7,0)
OPER K DR S SRQ=0,DR=".03;.04;26;27;214;.42;.035;1.09;1.13;.37;.22;.23;340;66"
"RTN","SROAUTL0",8,0)
 Q
"RTN","SROAUTL0",9,0)
LR K DR S SRQ=0,DR="225;292;228;295;224;291;234;301;230;297;227;294"
"RTN","SROAUTL0",10,0)
 Q
"RTN","SROAUTL0",11,0)
OUT1 ; man preop edit scr
"RTN","SROAUTL0",12,0)
 Q
"RTN","SROAUTL0",13,0)
LAB ; man lab edit scrn
"RTN","SROAUTL0",14,0)
 Q
"RTN","SROAUTL0",15,0)
CPTS ; put CPT codes in array for display
"RTN","SROAUTL0",16,0)
 N SRDA,K,X,XX,Y K SRPROC S K=1,Y=$P($G(^SRO(136,SRTN,0)),"^",2),Y=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"")
"RTN","SROAUTL0",17,0)
 I $L(Y) D SSPRIN^SROCPT0
"RTN","SROAUTL0",18,0)
 S SRPROC(K)=$S($L(Y):Y,1:"NO PRIN CODE")
"RTN","SROAUTL0",19,0)
 S SRDA=0 F  S SRDA=$O(^SRO(136,SRTN,3,SRDA)) Q:'SRDA  D
"RTN","SROAUTL0",20,0)
 .S Y=$P($G(^SRO(136,SRTN,3,SRDA,0)),"^"),Y=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"")
"RTN","SROAUTL0",21,0)
 .I $L(Y) D SSOTH^SROCPT0
"RTN","SROAUTL0",22,0)
 .I $L(Y)+$L(SRPROC(K))'>SRL S SRPROC(K)=SRPROC(K)_", "_Y Q
"RTN","SROAUTL0",23,0)
 .S K=K+1,SRPROC(K)=Y
"RTN","SROAUTL0",24,0)
 I SRPROC(1)=""!(SRPROC(1)="NO PRIN CODE") S SRPROC(1)="NOT ENTERED"
"RTN","SROAUTL0",25,0)
 Q
"RTN","SROAUTL0",26,0)
DISP ; display CPT code info
"RTN","SROAUTL0",27,0)
 N SRFIRST,SRMO,SRMOD,SRCSTAT S SRPAGE="",SRCSTAT=">> Coding "_$S($P($G(^SRO(136,SRTN,10)),"^"):"",1:"Not ")_"Complete <<"
"RTN","SROAUTL0",28,0)
 D HDR^SROAUTL S SRFIRST=0,SRW="NOT ENTERED"
"RTN","SROAUTL0",29,0)
 S Y=$P($G(^SRO(136,SRTN,0)),"^",2) I Y S Y=$P($$CPT^ICPTCOD(Y),"^",2) D DES^SROCPT0
"RTN","SROAUTL0",30,0)
 W "Principal CPT Code: "_SRW I $G(SRDES(1))'="" F I=1:1 Q:$L(SRDES(I))'>1  W !,?5,SRDES(I)
"RTN","SROAUTL0",31,0)
 I $O(^SRO(136,SRTN,1,0)) W !,?3,"Modifier: " D
"RTN","SROAUTL0",32,0)
 .S SRMOD=0 F  S SRMOD=$O(^SRO(136,SRTN,1,SRMOD)) Q:'SRMOD  D
"RTN","SROAUTL0",33,0)
 ..S SRMO=$P(^SRO(136,SRTN,1,SRMOD,0),"^")
"RTN","SROAUTL0",34,0)
 ..W:SRFIRST !,?13 W $P($$MOD^ICPTMOD(SRMO,"I"),"^",2),"-",$P($$MOD^ICPTMOD(SRMO,"I"),"^",3)
"RTN","SROAUTL0",35,0)
 ..S SRFIRST=1
"RTN","SROAUTL0",36,0)
 K SRDES W !
"RTN","SROAUTL0",37,0)
OTH S SROTH=0 F  S SROTH=$O(^SRO(136,SRTN,3,SROTH)) Q:'SROTH  D  K SRDES W !
"RTN","SROAUTL0",38,0)
 .S Y=$P($G(^SRO(136,SRTN,3,SROTH,0)),"^"),Y=$S(Y:$P($$CPT^ICPTCOD(Y),"^",2),1:"") D DES^SROCPT0
"RTN","SROAUTL0",39,0)
 .W !,"Other CPT Code:     "_SRW I $G(SRDES(1))'="" F I=1:1 Q:$L(SRDES(I))'>1  W !,?5,SRDES(I)
"RTN","SROAUTL0",40,0)
 .I $O(^SRO(136,SRTN,3,SROTH,1,0)) S SRFIRST=0 W !,?3,"Modifier: " D
"RTN","SROAUTL0",41,0)
 ..S SRMOD=0 F  S SRMOD=$O(^SRO(136,SRTN,3,SROTH,1,SRMOD)) Q:'SRMOD  D
"RTN","SROAUTL0",42,0)
 ...S SRMO=$P(^SRO(136,SRTN,3,SROTH,1,SRMOD,0),"^")
"RTN","SROAUTL0",43,0)
 ...W:SRFIRST !,?13 W $P($$MOD^ICPTMOD(SRMO,"I"),"^",2),"-",$P($$MOD^ICPTMOD(SRMO,"I"),"^",3)
"RTN","SROAUTL0",44,0)
 ...S SRFIRST=1
"RTN","SROAUTL0",45,0)
PRESS K DIR S DIR(0)="FOA",DIR("A")="Press ENTER to continue."
"RTN","SROAUTL0",46,0)
 S DIR("A",1)="CPT Codes should be verified. If need be, report discrepancies to the"
"RTN","SROAUTL0",47,0)
 S DIR("A",2)="official CPT coder for surgery.",DIR("A",3)="" D ^DIR K DIR
"RTN","SROAUTL0",48,0)
 Q
"RTN","SROAUTL0",49,0)
OCC ; occur data
"RTN","SROAUTL0",50,0)
 D EN^SROCCAT K ^TMP("SROCC",$J),SRO,SROC,SROOC
"RTN","SROAUTL0",51,0)
 F SRK=1:1:39 S SROC(SRK)="       "
"RTN","SROAUTL0",52,0)
 S (SRFLG,SRIO,SRPO)=0 F  S SRIO=$O(^SRF(SRTN,10,SRIO)) Q:'SRIO  D
"RTN","SROAUTL0",53,0)
 .S SROCC=$P(^SRF(SRTN,10,SRIO,0),U,2) Q:'SROCC
"RTN","SROAUTL0",54,0)
 .S ^TMP("SROCC",$J,SROCC,$E($P(^SRF(SRTN,0),U,9),1,7),10)=SRIO
"RTN","SROAUTL0",55,0)
 F  S SRPO=$O(^SRF(SRTN,16,SRPO)) Q:'SRPO  D
"RTN","SROAUTL0",56,0)
 .S SRDATE=$E($P(^SRF(SRTN,16,SRPO,0),U,7),1,7)
"RTN","SROAUTL0",57,0)
 .S X1=$E(SRSDATE,1,7),X2=30 D C^%DTC
"RTN","SROAUTL0",58,0)
 .I SRDATE>X Q
"RTN","SROAUTL0",59,0)
 .I '$G(SRDATE) S SRDATE="       "
"RTN","SROAUTL0",60,0)
 .S SROCC=$P(^SRF(SRTN,16,SRPO,0),U,2) Q:'SROCC
"RTN","SROAUTL0",61,0)
 .S ^TMP("SROCC",$J,SROCC,SRDATE,16)=SRPO
"RTN","SROAUTL0",62,0)
 I '$D(^TMP("SROCC",$J)) D OCCEND Q
"RTN","SROAUTL0",63,0)
 ;remove multiples
"RTN","SROAUTL0",64,0)
 S SROCC=0 F  S SROCC=$O(^TMP("SROCC",$J,SROCC)) Q:'SROCC  S SROCCDT=$O(^TMP("SROCC",$J,SROCC,0)),SRTYPE=$O(^TMP("SROCC",$J,SROCC,SROCCDT,0)) D
"RTN","SROAUTL0",65,0)
 .I SROCC=21!(SROCC>28&(SROCC<33))!(SROCC=36) D
"RTN","SROAUTL0",66,0)
 ..S SRDA=^TMP("SROCC",$J,SROCC,SROCCDT,SRTYPE),SRICD=$P(^SRF(SRTN,SRTYPE,SRDA,0),U,3)
"RTN","SROAUTL0",67,0)
 ..I SRICD S SROOC(SROCC)=$P($$ICD^SROICD(SRTN,SRICD),"^",2)_"^"_$P(^SRF(SRTN,SRTYPE,SRDA,0),U)
"RTN","SROAUTL0",68,0)
 ..E  S SROOC(SROCC)="NO ICD CODE ENTERED"
"RTN","SROAUTL0",69,0)
 .S ^TMP("SROCC",$J,"SR",SROCC,SROCCDT)=""
"RTN","SROAUTL0",70,0)
 S SRK=1,SRO="",SROCC=0 F  S SROCC=$O(^TMP("SROCC",$J,"SR",SROCC)) Q:'SROCC  S SROCCDT="" F  S SROCCDT=$O(^TMP("SROCC",$J,"SR",SROCC,SROCCDT)) Q:SROCCDT=""  D
"RTN","SROAUTL0",71,0)
 .I SROCC=3 S SRPO=^TMP("SROCC",$J,SROCC,SROCCDT,16) I SRPO S X=$P(^SRF(SRTN,16,SRPO,0),"^",4) S:X SRSEP=X
"RTN","SROAUTL0",72,0)
 .I SROCC=12 S SRPO=^TMP("SROCC",$J,SROCC,SROCCDT,16) I SRPO S X=$P(^SRF(SRTN,16,SRPO,0),"^",8) S:X SRDUR=X
"RTN","SROAUTL0",73,0)
 .S SROC(SROCC)=SROCCDT
"RTN","SROAUTL0",74,0)
 F I=1:1:22,29:1:32,35,36,38 S SRO=SRO_$J(SROC(I),7)
"RTN","SROAUTL0",75,0)
 S X=$G(SRSEP),SRO=SRO_X I X S SRSEP=$S(X=2:"SEPSIS",X=3:"SEPTIC SHOCK",1:"SIRS")
"RTN","SROAUTL0",76,0)
 S X=$G(SRDUR),SRO=SRO_X I X S SRDUR=$S(X=2:"<24 HOURS",X=3:"24-72 HOURS",X=4:">72 HOURS",1:"NO SYMPTOMS")
"RTN","SROAUTL0",77,0)
OCCEND K ^TMP("SROCC",$J),SRPOCC,SRPOCCD,SRSDATE,SRTYPE,SRDATE,SRDA,SRFLG,SRICD,SRJ,SRK,SROCC,SROCCDT,SRPO,X1,X2
"RTN","SROAUTL0",78,0)
 Q
"RTN","SROAUTL2")
0^5^B35918406^B35937353
"RTN","SROAUTL2",1,0)
SROAUTL2 ;BIR/ADM - RISK ASSESSMENT UTILITY ;08/25/2011
"RTN","SROAUTL2",2,0)
 ;;3.0;Surgery;**38,47,63,88,125,153,160,176,177**;24 Jun 93;Build 89
"RTN","SROAUTL2",3,0)
 S SRZ=0 F  S SRZ=$O(SRY(130,SRTN,SRZ)) Q:'SRZ  D
"RTN","SROAUTL2",4,0)
 .I SRY(130,SRTN,SRZ,"I")="" D TR S X=$T(@SRP),SRFLD=$P(X,";;",2),SRX(SRZ)=$P(SRFLD,"^",2)
"RTN","SROAUTL2",5,0)
 .I SRY(130,SRTN,SRZ,"I")="NS" D TR S X=$T(@SRP),SRFLD=$P(X,";;",2),SRDT=$P(SRFLD,"^",4) S:SRDT'="" SRLR(SRDT)=""
"RTN","SROAUTL2",6,0)
 S SRDT=0 F  S SRDT=$O(SRLR(SRDT)) Q:'SRDT  K SRX(SRDT)
"RTN","SROAUTL2",7,0)
 Q
"RTN","SROAUTL2",8,0)
RELATE S DFN=$P(^SRF(SRTN,0),"^"),SRDEATH=$P($G(^DPT(DFN,.35)),"^") I 'SRDEATH Q
"RTN","SROAUTL2",9,0)
 S X2=$P(^SRF(SRTN,0),"^",9),X1=SRDEATH D ^%DTC I X>90 Q
"RTN","SROAUTL2",10,0)
 S X=$P($G(^SRF(SRTN,.4)),"^",7) I X="" S SRX(903)="Death Unrelated/Related"
"RTN","SROAUTL2",11,0)
 Q
"RTN","SROAUTL2",12,0)
TR S SRP=SRZ,SRP=$TR(SRP,"1234567890.","ABCDEFGHIJP")
"RTN","SROAUTL2",13,0)
 Q
"RTN","SROAUTL2",14,0)
GET S X=$T(@J)
"RTN","SROAUTL2",15,0)
 Q
"RTN","SROAUTL2",16,0)
PJC ;;.03^Major or Minor^Major or Minor^
"RTN","SROAUTL2",17,0)
PDB ;;.42^Other Procedures^^
"RTN","SROAUTL2",18,0)
PCG ;;.37^Anesthesia Technique^^
"RTN","SROAUTL2",19,0)
CE ;;35^Concurrent Case^Concurrent Case^
"RTN","SROAUTL2",20,0)
PJD ;;.04^Surgery Specialty^Surgical Specialty^
"RTN","SROAUTL2",21,0)
BF ;;26^Principal Procedure^Principal Operation^
"RTN","SROAUTL2",22,0)
BGJ ;;270^Preoperative Serum Sodium^Serum Sodium^304
"RTN","SROAUTL2",23,0)
CJD ;;304^Date Preoperative Serum Sodium was Performed^^
"RTN","SROAUTL2",24,0)
BBD ;;224^Preoperative BUN (mg/dl)^BUN^291
"RTN","SROAUTL2",25,0)
BIA ;;291^Date Preoperative BUN was Performed^^
"RTN","SROAUTL2",26,0)
BBC ;;223^Preoperative Serum Creatinine (mg/dl)^Serum Creatinine^290
"RTN","SROAUTL2",27,0)
BIJ ;;290^Date Preoperative Serum Creatinine was Performed^^
"RTN","SROAUTL2",28,0)
BBE ;;225^Preoperative Serum Albumin (g/dl)^Serum Albumin^292
"RTN","SROAUTL2",29,0)
BIB ;;292^Date Preoperative Serum Albumin was Performed^^
"RTN","SROAUTL2",30,0)
BBH ;;228^Preoperative Total Bilirubin (mg/dl)^Total Bilirubin^295
"RTN","SROAUTL2",31,0)
BIE ;;295^Date Preoperative Total Bilrubin was Performed^^
"RTN","SROAUTL2",32,0)
BBG ;;227^Preoperative SGOT (mU/ml)^SGOT^294
"RTN","SROAUTL2",33,0)
BID ;;294^Date Preoperative SGOT was Performed^^
"RTN","SROAUTL2",34,0)
BBI ;;229^Preoperative Alkaline Phosphatase (mU/ml)^Alkaline Phosphatase^296
"RTN","SROAUTL2",35,0)
BIF ;;296^Date Preoperative Alkaline Phosphatase was Performed^^
"RTN","SROAUTL2",36,0)
BCJ ;;230^Preoperative WBC (X 1000/mm3)^WBC^297
"RTN","SROAUTL2",37,0)
BIG ;;297^Date Preoperative WBC was Performed
"RTN","SROAUTL2",38,0)
BCD ;;234^Preoperative Hematocrit^Hematocrit^301
"RTN","SROAUTL2",39,0)
CJA ;;301^Date Preoperative Hematocrit was Performed^^
"RTN","SROAUTL2",40,0)
BCA ;;231^Preoperative Platelet Count (X 1000/mm3)^Platelet Count^298
"RTN","SROAUTL2",41,0)
BIH ;;298^Date Preoperative Platelet Count was Performed^^
"RTN","SROAUTL2",42,0)
BCC ;;233^Preoperative PTT (seconds)^PTT^300
"RTN","SROAUTL2",43,0)
CJJ ;;300^Date Preoperative PTT was Performed^^
"RTN","SROAUTL2",44,0)
BCB ;;232^Preoperative PT (seconds)^PT^299
"RTN","SROAUTL2",45,0)
BII ;;299^Date Preoperative PT was Performed^^
"RTN","SROAUTL2",46,0)
BGD ;;274^Highest Postoperative Serum Sodium^Highest Serum Sodium^305
"RTN","SROAUTL2",47,0)
CJE ;;305^Date Highest Serum Sodium was Recorded^^
"RTN","SROAUTL2",48,0)
DJE ;;405^Lowest Serum Sodium^Lowest Serum Sodium^407
"RTN","SROAUTL2",49,0)
DJG ;;407^Date of Lowest Serum Sodium^^
"RTN","SROAUTL2",50,0)
BGE ;;275^Highest Postoperative Potassium^Highest Potassium^306
"RTN","SROAUTL2",51,0)
CJF ;;306^Date Highest Potassium was Recorded^^
"RTN","SROAUTL2",52,0)
DJF ;;406^Lowest Postoperative Potassium^Lowest Potassium^408
"RTN","SROAUTL2",53,0)
DJH ;;408^Date of Lowest Postoperative Potassium^^
"RTN","SROAUTL2",54,0)
BGG ;;277^Highest Postoperative Serum Creatinine^Highest Serum Creatinine^308
"RTN","SROAUTL2",55,0)
CJH ;;308^Date Highest Serum Creatinine was Recorded^^
"RTN","SROAUTL2",56,0)
BGH ;;278^Highest Postoperative CPK^Highest CPK^309
"RTN","SROAUTL2",57,0)
CJI ;;309^Date Highest CPK was Recorded^^
"RTN","SROAUTL2",58,0)
BGI ;;279^Highest Postoperative CPK-MB^Highest CPK-MB^310
"RTN","SROAUTL2",59,0)
CAJ ;;310^Date Highest CPK-MB Band was Recorded^^
"RTN","SROAUTL2",60,0)
BHJ ;;280^Highest Postoperative Total Bilirubin^Highest Total Bilirubin^311
"RTN","SROAUTL2",61,0)
CAA ;;311^Date Highest Total Bilirubin was Recorded^^
"RTN","SROAUTL2",62,0)
BHA ;;281^Highest Postoperative WBC^Highest WBC^312
"RTN","SROAUTL2",63,0)
CAB ;;312^Date Highest WBC was Recorded^^
"RTN","SROAUTL2",64,0)
BHC ;;283^Lowest Postoperative Hematocrit^Lowest Hematocrit^314
"RTN","SROAUTL2",65,0)
CAD ;;314^Date Lowest Hematocrit was Recorded^^
"RTN","SROAUTL2",66,0)
DEE ;;455^Highest Postoperative Serum Troponin I^Highest Troponin I^455.1
"RTN","SROAUTL2",67,0)
DEEPA ;;455.1^Date of Highest Postop Troponin I^^
"RTN","SROAUTL2",68,0)
DEF ;;456^Highest Postoperative Serum Troponin T^Highest Troponin T^456.1
"RTN","SROAUTL2",69,0)
DEFPA ;;456.1^Date of Highest Postop Troponin T^^
"RTN","SROAUTL2",70,0)
DHG ;;487^Preoperative INR^INR^487.1
"RTN","SROAUTL2",71,0)
DHGPA ;;487.1^Date Preoperative INR was Performed^^
"RTN","SROAUTL2",72,0)
DDD ;;444^Preoperative Anion Gap^Anion Gap^444.1
"RTN","SROAUTL2",73,0)
DDDPA ;;444.1^Date Preoperative Anion Gap was Recorded^^
"RTN","SROAUTL2",74,0)
DDE ;;445^Highest Postoperative Anion Gap^Highest Anion Gap^445.1
"RTN","SROAUTL2",75,0)
DDEPA ;;445.1^Date Highest Anion Gap was Recorded^^
"RTN","SROAUTL2",76,0)
EJD ;;504^Preoperative Hemoglobin A1c^Hemoglobin A1c^504.1
"RTN","SROAUTL2",77,0)
EJDPA ;;504.1^Date Preoperative Hemoglobin A1c was Performed^^
"RTN","SROAUTL2",78,0)
BG ;;27^Principal Procedure Code (CPT)^Principal CPT Code^
"RTN","SROAUTL2",79,0)
BAD ;;214^PGY of Primary Surgeon ('0' for Staff Surgeon)^PGY of Primary Surgeon^
"RTN","SROAUTL2",80,0)
PJCE ;;.035^Case Schedule Type^Surgical Priority^
"RTN","SROAUTL2",81,0)
APJI ;;1.09^Wound Classification^Wound Classification^
"RTN","SROAUTL2",82,0)
APAC ;;1.13^ASA Class^ASA Classification^
"RTN","SROAUTL2",83,0)
PBJE ;;.205^Time Patient In the O.R.^Time Patient In the O.R.^
"RTN","SROAUTL2",84,0)
PBB ;;.22^Time the Operation Began^Date/Time Operation Began^
"RTN","SROAUTL2",85,0)
PBC ;;.23^Time the Operation Ends^Date/Time Operation Ended^
"RTN","SROAUTL2",86,0)
PBCB ;;.232^Time Patient Out of the O.R.^Time Patient Out of the O.R.^
"RTN","SROAUTL2",87,0)
CDJ ;;340^Number of RBC Units Transfused^RBC Units Transfused^
"RTN","SROAUTL2",88,0)
DDC ;;443^Intraoperative Disseminated Cancer (Y/N)^Intraoperative Disseminated Cancer^
"RTN","SROAUTL2",89,0)
DDF ;;446^Intraoperative Ascites (Y/N)^Intraoperative Ascites
"RTN","SROAUTL2",90,0)
FF ;;66^Principal Diagnosis Code (ICD)^Postop Diagnosis Code (ICD)^
"RTN","SROAUTL2",91,0)
BDG ;;247^Length of Postoperative Stay^Length of Postoperative Hospital Stay^
"RTN","SROAUTL2",92,0)
AJB ;;102^Reason for not Creating an Assessment^Exclusion Criteria^
"RTN","SROAUTL2",93,0)
PJAA ;;.011^In/Out-Patient Status^Hospital Admission Status^
"RTN","SROAUTL2",94,0)
PAFF ;;.166^Attending Code^Attending Code
"RTN","SROAUTL2",95,0)
PBA ;;.21^Anesthesia Care Start Time^Anesthesia Start^
"RTN","SROAUTL2",96,0)
PBD ;;.24^Anesthesia Care End Time^Anesthesia Finish^
"RTN","SROCD0")
0^11^B65638166^B61009295
"RTN","SROCD0",1,0)
SROCD0 ;BIR/ADM - CASE CODING INPUT/EDIT ;08/01/05
"RTN","SROCD0",2,0)
 ;;3.0;Surgery;**142,152,159,177**;24 Jun 93;Build 89
"RTN","SROCD0",3,0)
 ;;
"RTN","SROCD0",4,0)
 ; Reference to CL^SDCO21 supported by DBIA #406
"RTN","SROCD0",5,0)
 ;;
"RTN","SROCD0",6,0)
PRDX ; edit Principal Postop Diagnosis
"RTN","SROCD0",7,0)
 N SRDUP,SRDXY,SRI,SROLD,ENVARR,SCEC,SRNEW,SRNUM S SCEC=$$SCEC()
"RTN","SROCD0",8,0)
 S (SROLD,X)=$P(^SRO(136,SRTN,0),"^",3),SRDIAG="NOT ENTERED" I 'X D PDXEN Q
"RTN","SROCD0",9,0)
 I X S Y=$$ICD^SROICD(SRTN,X),SRNUM=$P(Y,U,2),SRDES=$P(Y,U,4),SRDIAG=SRNUM_"  "_SRDES
"RTN","SROCD0",10,0)
 W !,"Principal Postop Diagnosis:",!!,?5,"ICD"_$$ICD910^SROICD(SRTN)_" Code: "_SRDIAG D:SCEC
"RTN","SROCD0",11,0)
 .D GETS^DIQ(136,SRTN_",",".04:.11","E","ENVARR")
"RTN","SROCD0",12,0)
 .I $D(ENVARR(136,SRTN_",",.04,"E")) D
"RTN","SROCD0",13,0)
 ..N SRCOLSPN S SRCOLSPN=13 W !
"RTN","SROCD0",14,0)
 ..I $D(SRCL(3)) W ?SRCOLSPN,"SC:",$E(ENVARR(136,SRTN_",",.04,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",15,0)
 ..I $D(SRCL(7)) W ?SRCOLSPN,"CV:",$E(ENVARR(136,SRTN_",",.1,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",16,0)
 ..I $D(SRCL(1)) W ?SRCOLSPN,"AO:",$E(ENVARR(136,SRTN_",",.05,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",17,0)
 ..I $D(SRCL(2)) W ?SRCOLSPN,"IR:",$E(ENVARR(136,SRTN_",",.06,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",18,0)
 ..I $D(SRCL(4)) W ?SRCOLSPN,"SWAC:",$E(ENVARR(136,SRTN_",",.07,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",19,0)
 ..I $D(SRCL(8)) W ?SRCOLSPN,"SHAD:",$E(ENVARR(136,SRTN_",",.11,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",20,0)
 ..I $D(SRCL(5)) W ?SRCOLSPN,"MST:",$E(ENVARR(136,SRTN_",",.08,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",21,0)
 ..I $D(SRCL(6)) W ?SRCOLSPN,"H&N:",$E(ENVARR(136,SRTN_",",.09,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",22,0)
 K DIR S DIR(0)="SO^1:Update Principal Postop Diagnosis Code;2:Update Service Connected/Environmental Indicators only"
"RTN","SROCD0",23,0)
 S DIR("A")="Enter selection (1 or 2)",DIR("B")=1 D ^DIR I $D(DTOUT)!$D(DUOUT)!'Y Q
"RTN","SROCD0",24,0)
 S SRDXY=Y I SRDXY=1 D PDXEN Q
"RTN","SROCD0",25,0)
 I SRDXY=2 D PSCEI
"RTN","SROCD0",26,0)
 Q
"RTN","SROCD0",27,0)
PRESS W ! K DIR S DIR("A")="Press Enter/Return key to continue ",DIR(0)="FOA" D ^DIR K DIR
"RTN","SROCD0",28,0)
 Q
"RTN","SROCD0",29,0)
PDXEN ;
"RTN","SROCD0",30,0)
 ; JAS - 6/19/13 - Patch 177 - modifications to correct ^DIR incompatibility with ICD-10 Code Set Versioning Utility
"RTN","SROCD0",31,0)
 N X,Y,SRPRMT S SRPRMT="Principal Postop Diagnosis Code ",SRDEF=$P($G(SROICD),"-",1)
"RTN","SROCD0",32,0)
 D ICDSRCH^SROICD
"RTN","SROCD0",33,0)
 I $G(X)="^" K X Q
"RTN","SROCD0",34,0)
 I $G(X)="" W !,"This is a required entry." G PDXEN
"RTN","SROCD0",35,0)
 I $G(X)="@" W !!," Deletion of the Principal Postop Diagnosis Code is not allowed! ??" G PDXEN
"RTN","SROCD0",36,0)
 S SRNEW=+$G(Y)
"RTN","SROCD0",37,0)
 ; End 177
"RTN","SROCD0",38,0)
 S (SRDUP,SRI)=0 I SRNEW=SROLD Q
"RTN","SROCD0",39,0)
 I SRNEW,SRNEW'=SROLD F  S SRI=$O(SRADIAG(SRI)) Q:'SRI  I SRADIAG(SRI)=SRNEW S SRDUP=1 Q
"RTN","SROCD0",40,0)
 I SRDUP D DUP,HDR^SROCD G PDXEN
"RTN","SROCD0",41,0)
 K DR,DIE,DA S DIE=136,DA=SRTN,DR=".03////"_SRNEW D ^DIE K DR,DIE I $D(Y) Q
"RTN","SROCD0",42,0)
 I SRNEW'=SROLD S X=SROLD D PRINASOD^SROCDX2
"RTN","SROCD0",43,0)
 D REMIND
"RTN","SROCD0",44,0)
PSCEI I $P(^SRO(136,SRTN,0),"^",3) D
"RTN","SROCD0",45,0)
 .I SCEC D SCEI^SROCD3 K SRCL Q
"RTN","SROCD0",46,0)
 .W !!,"  >>>  No SC/EI information required for this patient.  <<<" D PRESS
"RTN","SROCD0",47,0)
 Q
"RTN","SROCD0",48,0)
POTH W !,"Other Procedures:",!
"RTN","SROCD0",49,0)
 N SRSHT,SRNEW,SROLD,SRPOTH,CNT,OTHER,SROPY K SRSEL S CNT=1,OTH=0 F  S OTH=$O(^SRO(136,SRTN,3,OTH)) Q:'OTH!(SRSOUT)  D
"RTN","SROCD0",50,0)
 .S X=$P($G(^SRO(136,SRTN,3,OTH,0)),U),CPT1=""
"RTN","SROCD0",51,0)
 .I X S CPT1=X,Y=$$CPT^ICPTCOD(X,$P($G(^SRF(SRTN,0)),"^",9)),SRCPT=$P(Y,U,2),SRSHT=$P(Y,U,3),Y=SRCPT,SRDA=OTH D SSOTH^SROCPT0 S SRCPT=Y,CPT=SRCPT_"  "_SRSHT
"RTN","SROCD0",52,0)
 .W !,CNT_". CPT Code: "_CPT
"RTN","SROCD0",53,0)
 .S SRSEL(CNT)=OTH_"^CPT Code: "_CPT_"^"_CPT1_"^"_SRCPT
"RTN","SROCD0",54,0)
 .D OTHADXD^SROCDX1
"RTN","SROCD0",55,0)
 .S CNT=CNT+1
"RTN","SROCD0",56,0)
 W !,CNT_". Enter NEW Other Procedure Code",! K DIR S DIR("A")="Enter selection",DIR(0)="NO^1:"_CNT D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROCD0",57,0)
 I 'Y,$$ADCHK D DELWRN^SROCDX2,PRESS Q
"RTN","SROCD0",58,0)
 Q:'Y  S (OTHCNT,SRDA)=Y W !! I SRDA<CNT D  G PH
"RTN","SROCD0",59,0)
 .D HDR^SROCD,OTHCPTD^SROCDX,OTHADX^SROCDX1
"RTN","SROCD0",60,0)
 .K DIR S DIR(0)="SO^1:Update Other Procedure CPT Code;2:Update Associated Diagnoses"
"RTN","SROCD0",61,0)
 .S DIR("A")="Enter selection (1 or 2)",DIR("B")=1 D ^DIR I $D(DTOUT)!$D(DUOUT)!'Y Q
"RTN","SROCD0",62,0)
 .S SROPY=Y I SROPY=1 D OPEN Q
"RTN","SROCD0",63,0)
 .I SROPY=2 D OASS
"RTN","SROCD0",64,0)
 S SRDUP=0 K DIR S DIR("A")="Enter new OTHER PROCEDURE CPT code",DIR(0)="136.03,.01" D ^DIR K DIR S SRNEW=+$G(Y) I $D(DTOUT)!$D(DUOUT)!($G(Y)="") G PH
"RTN","SROCD0",65,0)
 S SRX=0 F  S SRX=$O(^SRO(136,SRTN,3,SRX)) Q:'SRX  I $P($G(^SRO(136,SRTN,3,SRX,0)),U)=SRNEW S SRDUP=1 Q
"RTN","SROCD0",66,0)
 K DD,DO S SRDICN=1,DIC="^SRO(136,SRTN,3,",X=SRNEW,DIC(0)="L" D FILE^DICN K DIC,DD,DO,SRDICN I +Y<0 Q
"RTN","SROCD0",67,0)
 K DA S (SRPOTH,DA)=+Y,DA(1)=SRTN D OPROC^SROMOD0 K DA
"RTN","SROCD0",68,0)
 S SRDA=CNT,OTHER=SRNEW D COTHADX^SROCDX
"RTN","SROCD0",69,0)
PH D HDR^SROCD D POTH
"RTN","SROCD0",70,0)
 Q
"RTN","SROCD0",71,0)
OPEN N SRDIRED W ! S SROLD=$P(SRSEL(SRDA),U,3),SRDIE=1,SRDIRED=0 K DA,DIE,DIR,DR
"RTN","SROCD0",72,0)
 S DA=$P(SRSEL(SRDA),U),DA(1)=SRTN,DIE="^SRO(136,SRTN,3,",DR=".01T" D ^DIE K DIE,DR,SRDIE Q:$D(Y)
"RTN","SROCD0",73,0)
 I 'SRDIRED K DA Q
"RTN","SROCD0",74,0)
 D OPROC^SROMOD0
"RTN","SROCD0",75,0)
 S X=$P($G(^SRO(136,SRTN,3,$P(SRSEL(SRDA),U),0)),"^") I SROLD'=X D SADXO^SROCDX2 K DA
"RTN","SROCD0",76,0)
OASS S SRPOTH=$P(SRSEL(SRDA),U) D COTHADX^SROCDX
"RTN","SROCD0",77,0)
 Q
"RTN","SROCD0",78,0)
DUP K DIR S DIR("A",1)="",DIR("A",2)="This code has already been selected. Please try again.",DIR("A",3)="",DIR("A")="Press the ENTER key to continue",DIR(0)="FO" D ^DIR K DIR
"RTN","SROCD0",79,0)
 Q
"RTN","SROCD0",80,0)
DOTH W !,"Other Postop Diagnosis:",!
"RTN","SROCD0",81,0)
 N CNT,SRDUP,SRI,SRJ,SRNEW,SRSYS,SRSYS1,SRX,SCEC,ENVARR,SRNUM S SCEC=$$SCEC()
"RTN","SROCD0",82,0)
 K SRSEL S CNT=1,OTH=0 F  S OTH=$O(^SRO(136,SRTN,4,OTH)) Q:'OTH!(SRSOUT)  D
"RTN","SROCD0",83,0)
 .S (SRX,X)=$P(^SRO(136,SRTN,4,OTH,0),U),SRDIAG="NOT ENTERED"
"RTN","SROCD0",84,0)
 .S SRSYS=$$ICDSTR^SROICD(SRTN)
"RTN","SROCD0",85,0)
 .I X S Y=$$ICD^SROICD(SRTN,X),SRNUM=$P(Y,U,2),SRDES=$P(Y,U,4),SRDIAG=SRNUM_"  "_SRDES
"RTN","SROCD0",86,0)
 .S SRSYS1=$P(SRSYS,")",1),SRSYS1=$P(SRSYS1,"(",2) ;AAS
"RTN","SROCD0",87,0)
 .W !,CNT_". "_SRSYS1_" Code: "_SRDIAG S SRSEL(CNT)=OTH_"^"_SRSYS1_" Code: "_SRDIAG_"^"_SRNUM_"^"_SRX ;AAS
"RTN","SROCD0",88,0)
 .D:SCEC OIND
"RTN","SROCD0",89,0)
 .S CNT=CNT+1 I 'SCEC W !
"RTN","SROCD0",90,0)
 W !,CNT_". Enter NEW Other Postop Diagnosis Code",! K DIR S DIR("A")="Enter selection",DIR(0)="NO^1:"_CNT D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROCD0",91,0)
 Q:'Y  S SRDA=Y W !! I SRDA<CNT D  G DH
"RTN","SROCD0",92,0)
 .D HDR^SROCD W !,"Other Postop Diagnosis:",!!,SRDA_". "_$P(SRSEL(SRDA),U,2) I SCEC S OTH=$P(SRSEL(SRDA),"^") D OIND
"RTN","SROCD0",93,0)
 .K DIR S DIR(0)="SO^1:Update Other Postop Diagnosis Code;2:Update Service Connected/Environmental Indicators only"
"RTN","SROCD0",94,0)
 .S DIR("A")="Enter selection (1 or 2)",DIR("B")=1 D ^DIR I $D(DTOUT)!$D(DUOUT)!'Y Q
"RTN","SROCD0",95,0)
 .S SRDXY=Y D:SRDXY=1 ODXEN D:SRDXY=2 OSCEI Q
"RTN","SROCD0",96,0)
 ; JAS - 6/20/13 - Patch 177 - modifications to correct ^DIR incompatibility with ICD-10 Code Set Versioning Utility
"RTN","SROCD0",97,0)
 N X,Y,SRPRMT,SRDEF S SRPRMT="Enter new OTHER POSTOP DIAGNOSIS Code ",SRDEF=""
"RTN","SROCD0",98,0)
 D ICDSRCH^SROICD
"RTN","SROCD0",99,0)
 I $G(X)="^" K X G DH
"RTN","SROCD0",100,0)
 S SRNEW=+$G(Y) I $G(Y)="" G DH
"RTN","SROCD0",101,0)
 ; END 177
"RTN","SROCD0",102,0)
 S (SRDUP,SRI)=0 F  S SRI=$O(SRADIAG(SRI)) Q:'SRI  I SRADIAG(SRI)=SRNEW S SRDUP=1 Q
"RTN","SROCD0",103,0)
 I SRDUP D DUP G DH
"RTN","SROCD0",104,0)
 S:'$D(DA(1)) DA(1)=SRTN
"RTN","SROCD0",105,0)
 K DD,DO S DIC="^SRO(136,SRTN,4,",X=SRNEW,DIC(0)="L" D FILE^DICN K DA,DD,DIC,DO,DR
"RTN","SROCD0",106,0)
 D REMIND
"RTN","SROCD0",107,0)
DH D PASSDIAG^SROCDX1,ASSDIAG^SROCDX1,HDR^SROCD,DOTH
"RTN","SROCD0",108,0)
 Q
"RTN","SROCD0",109,0)
ODXEN ;
"RTN","SROCD0",110,0)
 ; JAS - 6/20/13 - Patch 177 - modifications to correct ^DIR incompatibility with ICD-10 Code Set Versioning Utility
"RTN","SROCD0",111,0)
 N X,Y,SRPRMT,SRDEF S SRPRMT="Enter new OTHER POSTOP DIAGNOSIS Code "
"RTN","SROCD0",112,0)
 S SROLD=$P(SRSEL(SRDA),U,4),SRDEF=$P($G(SRSEL(SRDA)),"^",3)
"RTN","SROCD0",113,0)
 D ICDSRCH^SROICD
"RTN","SROCD0",114,0)
 I $G(X)="^" K X Q
"RTN","SROCD0",115,0)
 S SRNEW=+$G(Y)
"RTN","SROCD0",116,0)
 ; END 177
"RTN","SROCD0",117,0)
 I X="@" S SRSOUT=0 D  I SRSOUT S SRSOUT=0 Q
"RTN","SROCD0",118,0)
 .K DIR S DIR("A")="SURE YOU WANT TO DELETE THE ENTIRE OTHER POSTOP DIAGNOSIS CODE",DIR(0)="YO",DIR("B")="NO"
"RTN","SROCD0",119,0)
 .D ^DIR K DIR I $D(DTOUT)!$D(DUOUT)!'Y S SRSOUT=1 Q
"RTN","SROCD0",120,0)
 .K DA,DIE,DR S DA=$P(SRSEL(SRDA),U),DA(1)=SRTN,DIE="^SRO(136,SRTN,4,",DR=".01///@" D ^DIE
"RTN","SROCD0",121,0)
 .S X=$P(SRSEL(SRDA),U,4) D DELASOC^SROCDX2 K DA,DIE,DR,SRSEL(SRDA)
"RTN","SROCD0",122,0)
 .D REMIND S SRSOUT=1
"RTN","SROCD0",123,0)
 S (SRDUP,SRI)=0 F  S SRI=$O(SRADIAG(SRI)) Q:'SRI  I SRADIAG(SRI)=SRNEW,SROLD'=SRNEW S SRDUP=1 Q
"RTN","SROCD0",124,0)
 I SRDUP D DUP Q
"RTN","SROCD0",125,0)
 I SRNEW=SROLD Q
"RTN","SROCD0",126,0)
 I SRNEW,SRNEW'=SROLD K DA,DIE,DIR S DA=$P(SRSEL(SRDA),U),DA(1)=SRTN,DIE="^SRO(136,SRTN,4,",DR=".01////"_SRNEW D ^DIE
"RTN","SROCD0",127,0)
 S X=$P(SRSEL(SRDA),U,4) D DELASOC^SROCDX2 K DA,DIE,DR
"RTN","SROCD0",128,0)
 D REMIND
"RTN","SROCD0",129,0)
OSCEI I '$D(SRCL) W !!,"  >>>  No SC/EI information required for this patient.  <<<" D PRESS Q
"RTN","SROCD0",130,0)
 D OSCEI^SROCD
"RTN","SROCD0",131,0)
 Q
"RTN","SROCD0",132,0)
SCEC() N SRSDATE,DFN,SCEC S SRSDATE=$S($D(SRTN):$P(^SRF(SRTN,0),U,9),1:DT)
"RTN","SROCD0",133,0)
 S DFN=$P(^SRF(SRTN,0),U) D CL^SDCO21(DFN,SRSDATE,,.SRCL)
"RTN","SROCD0",134,0)
 S SCEC=$S($D(SRCL):1,1:0)
"RTN","SROCD0",135,0)
 Q SCEC
"RTN","SROCD0",136,0)
ADCHK() ; check for other procedures with no associated diagnosis
"RTN","SROCD0",137,0)
 N SRADX,SROTH,SRQ S (SRADX,SROTH,SRQ)=0
"RTN","SROCD0",138,0)
 F  S SROTH=$O(^SRO(136,SRTN,3,SROTH)) Q:'SROTH  I '$O(^SRO(136,SRTN,3,SROTH,2,0)) S SRADX=1 Q
"RTN","SROCD0",139,0)
 Q SRADX
"RTN","SROCD0",140,0)
REMIND ; display reminder to update procedure/diagnosis associations
"RTN","SROCD0",141,0)
 K DIR W ! S DIR("A",1)="Please review and update procedure associations for this diagnosis."
"RTN","SROCD0",142,0)
 S DIR("A",2)="",DIR("A")="Press Enter/Return key to continue ",DIR(0)="FOA" D ^DIR K DIR
"RTN","SROCD0",143,0)
 Q
"RTN","SROCD0",144,0)
OIND D GETS^DIQ(136.04,OTH_","_SRTN_",",".02:.09","E","ENVARR")
"RTN","SROCD0",145,0)
 I $D(ENVARR(136.04,OTH_","_SRTN_",",.02,"E")) D
"RTN","SROCD0",146,0)
 .N SRCOLSPN S SRCOLSPN=13 W !
"RTN","SROCD0",147,0)
 .I $D(SRCL(3)) W ?SRCOLSPN,"SC:",$E(ENVARR(136.04,OTH_","_SRTN_",",.02,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",148,0)
 .I $D(SRCL(7)) W ?SRCOLSPN,"CV:",$E(ENVARR(136.04,OTH_","_SRTN_",",.08,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",149,0)
 .I $D(SRCL(1)) W ?SRCOLSPN,"AO:",$E(ENVARR(136.04,OTH_","_SRTN_",",.03,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",150,0)
 .I $D(SRCL(2)) W ?SRCOLSPN,"IR:",$E(ENVARR(136.04,OTH_","_SRTN_",",.04,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",151,0)
 .I $D(SRCL(4)) W ?SRCOLSPN,"SWAC:",$E(ENVARR(136.04,OTH_","_SRTN_",",.07,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",152,0)
 .I $D(SRCL(8)) W ?SRCOLSPN,"SHAD:",$E(ENVARR(136.04,OTH_","_SRTN_",",.09,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",153,0)
 .I $D(SRCL(5)) W ?SRCOLSPN,"MST:",$E(ENVARR(136.04,OTH_","_SRTN_",",.05,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",154,0)
 .I $D(SRCL(6)) W ?SRCOLSPN,"H&N:",$E(ENVARR(136.04,OTH_","_SRTN_",",.06,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROCD0",155,0)
 Q
"RTN","SROCD2")
0^19^B23989346^B22859343
"RTN","SROCD2",1,0)
SROCD2 ;BIR/ADM - DISPLAY MAIN SCREEN FOR CASE CODING ;07/27/05
"RTN","SROCD2",2,0)
 ;;3.0;Surgery;**142,177**;24 Jun 93;Build 89
"RTN","SROCD2",3,0)
 ; display information from file 136
"RTN","SROCD2",4,0)
EN N SCEC,SRCHFNO,SRFIRST,SRFLG,SRCMOD,SRSHRT,SRNON
"RTN","SROCD2",5,0)
DSPLY S (SREDIT,SRSOUT,SRNON,SRCHFNO)=0 I $P($G(^SRF(SRTN,"NON")),"^")="Y" S SRNON=1
"RTN","SROCD2",6,0)
 S SRDATE=$P($G(^SRF(SRTN,0)),"^",9),SR(0)=$G(^SRO(136,SRTN,0))
"RTN","SROCD2",7,0)
 D HDR^SROCD W !,$S('SRNON:"Surgery Procedure",1:"Non-OR Procedure")_" PCE/Billing Information:",!
"RTN","SROCD2",8,0)
 S SRSYS=$$ICDSTR^SROICD(SRTN)
"RTN","SROCD2",9,0)
 S SRDIAG="NOT ENTERED",SRDX=$P(SR(0),"^",3) I SRDX S SRDIAG=$$ICD^SROICD(SRTN,SRDX),SRDIAG=$P(SRDIAG,"^",2)_"  "_$P(SRDIAG,"^",4)
"RTN","SROCD2",10,0)
 W !,"1. Principal Postop Diagnosis Code "_SRSYS_": ",SRDIAG
"RTN","SROCD2",11,0)
 W !,"2. Other Postop Diagnosis Code "_SRSYS_": " I '$O(^SRO(136,SRTN,4,0)) W "NOT ENTERED"
"RTN","SROCD2",12,0)
 S (SRFLG,SRD)=0 F  S SRD=$O(^SRO(136,SRTN,4,SRD)) Q:'SRD  D
"RTN","SROCD2",13,0)
 .S SRDIAG="",SRDX=$P($G(^SRO(136,SRTN,4,SRD,0)),"^") I SRDX S SRDIAG=$$ICD^SROICD(SRTN,SRDX),SRDIAG=$P(SRDIAG,"^",2)_"  "_$P(SRDIAG,"^",4)
"RTN","SROCD2",14,0)
 .W:SRFLG ! W SRDIAG S SRFLG=1
"RTN","SROCD2",15,0)
 S CPT=$P(SR(0),"^",2),SRCPT="NOT ENTERED",(SRSHRT,SRX)="",SRFLG=0
"RTN","SROCD2",16,0)
 I CPT S Y=$$CPT^ICPTCOD(CPT,SRDATE),SRCPT=$P(Y,"^",2),SRSHRT=$P(Y,"^",3)
"RTN","SROCD2",17,0)
 S SRMSG="NO Assoc. DX ENTERED"
"RTN","SROCD2",18,0)
 I CPT,$O(^SRO(136,SRTN,1,0)) D
"RTN","SROCD2",19,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRX="-" F  S SRI=$O(^SRO(136,SRTN,1,SRI)) Q:'SRI  D
"RTN","SROCD2",20,0)
 ..S SRM=$P(^SRO(136,SRTN,1,SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2) K SRM
"RTN","SROCD2",21,0)
 ..S SRX=SRX_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROCD2",22,0)
 W !,"3. Principal CPT Code: ",SRCPT_SRX_"  "_SRSHRT
"RTN","SROCD2",23,0)
 D PADXD^SROCDX1
"RTN","SROCD2",24,0)
 W !,"4. Other CPT Code: " I '$O(^SRO(136,SRTN,3,0)) W ?23,"NOT ENTERED"
"RTN","SROCD2",25,0)
 S SRX=0,SRFIRST=1 F  S SRX=$O(^SRO(136,SRTN,3,SRX)) Q:'SRX  D
"RTN","SROCD2",26,0)
 .S (SRSHRT,SRY)="",CPT=$P($G(^SRO(136,SRTN,3,SRX,0)),"^")
"RTN","SROCD2",27,0)
 .I CPT S Y=$$CPT^ICPTCOD(CPT,SRDATE),SRCPT=$P(Y,"^",2),SRSHRT=$P(Y,"^",3)
"RTN","SROCD2",28,0)
 .I CPT,$O(^SRO(136,SRTN,3,SRX,1,0)) D
"RTN","SROCD2",29,0)
 ..S (SRCOMMA,SRFLG,SRI)=0,SRCMOD="",SRY="-" F  S SRI=$O(^SRO(136,SRTN,3,SRX,1,SRI)) Q:'SRI  D
"RTN","SROCD2",30,0)
 ...S SRM=$P(^SRO(136,SRTN,3,SRX,1,SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2) K SRM
"RTN","SROCD2",31,0)
 ...S SRY=SRY_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROCD2",32,0)
 .W:'SRFIRST !,?3,"Other CPT Code: " W SRCPT_SRY_"  "_SRSHRT S SRFIRST=0
"RTN","SROCD2",33,0)
 .W !,?5,"Assoc. DX "_$$ICDSTR^SROICD(SRTN)_": " I '$O(^SRO(136,SRTN,3,SRX,2,0)) W " NOT ENTERED"
"RTN","SROCD2",34,0)
 .I CPT S (SRCNT,SRD,SRFLG)=0 F  S SRD=$O(^SRO(136,SRTN,3,SRX,2,SRD)) Q:'SRD  D
"RTN","SROCD2",35,0)
 ..S SRDIAG="",SRDX=$P($G(^SRO(136,SRTN,3,SRX,2,SRD,0)),"^"),SRCNT=SRCNT+1
"RTN","SROCD2",36,0)
 ..I SRDX S SRDIAG=$$ICD^SROICD(SRTN,SRDX),SRDIAG=$P(SRDIAG,"^",2)_"-"_$P(SRDIAG,"^",4)
"RTN","SROCD2",37,0)
 ..I SRCNT#2 W:$G(SRFLG) ! W ?16,$E(SRDIAG,1,28) S SRFLG=1
"RTN","SROCD2",38,0)
 ..I '(SRCNT#2) W ?48,$E(SRDIAG,1,28)
"RTN","SROCD2",39,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROCD2",40,0)
 I $P(^SRO(136,SRTN,0),"^",3)=""!($P(^SRO(136,SRTN,0),"^",2)="") D REQ Q:SRSOUT  G DSPLY
"RTN","SROCD2",41,0)
 S SRAO(1)=.03,SRAO(2)="",SRAO(3)=".02",SRAO(4)=""
"RTN","SROCD2",42,0)
ASK K DIR S DIR("A")="Enter number of item to edit (1-4): ",DIR(0)="FOA",DIR("?",1)="Enter the number corresponding to the information you want to update. You may"
"RTN","SROCD2",43,0)
 S DIR("?",2)="enter 'ALL' to update all the information displayed on this screen, or a",DIR("?")="range of numbers separated by a ':' to update more than one item." D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROCD2",44,0)
 I X="" D ^SROCD4 Q
"RTN","SROCD2",45,0)
 S:$E(X)="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),($E(X)'="A") D HELP Q:SRSOUT  G ASK
"RTN","SROCD2",46,0)
 I $E(X)="A" S X="1:4"
"RTN","SROCD2",47,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>4)!(Y>Z) D HELP Q:SRSOUT  G ASK
"RTN","SROCD2",48,0)
 I X?.N1":".N D RANGE Q
"RTN","SROCD2",49,0)
 S EMILY=X D ONE Q
"RTN","SROCD2",50,0)
 Q
"RTN","SROCD2",51,0)
HELP W !!,"Enter the number corresponding to the information you want to update. You may",!,"enter 'ALL' to update all the information displayed on this screen, or a"
"RTN","SROCD2",52,0)
 W !,"range of numbers separated by a ':' to update more than one item.",!
"RTN","SROCD2",53,0)
 Q
"RTN","SROCD2",54,0)
RANGE ; range of numbers
"RTN","SROCD2",55,0)
 N CURLEY,EMILY,SHEMP
"RTN","SROCD2",56,0)
 S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROCD2",57,0)
 Q
"RTN","SROCD2",58,0)
ONE ; edit one item
"RTN","SROCD2",59,0)
 D HDR^SROCD
"RTN","SROCD2",60,0)
 I EMILY=4 D POTH^SROCD0 Q
"RTN","SROCD2",61,0)
 I EMILY=2 D DOTH^SROCD0 Q
"RTN","SROCD2",62,0)
 I EMILY=1 D PRDX^SROCD0 Q
"RTN","SROCD2",63,0)
 I EMILY=3 D PCPT^SROCDX
"RTN","SROCD2",64,0)
 Q
"RTN","SROCD2",65,0)
REQ W !,"The following information is required before continuing.",!
"RTN","SROCD2",66,0)
PDX I $P(^SRO(136,SRTN,0),"^",3)="" D  Q:SRSOUT
"RTN","SROCD2",67,0)
 .K DA,DIE,DR S DA=SRTN,DIE=136,DR=".03Principal Postop Diagnosis Code "_$$ICDSTR^SROICD(SRTN) D ^DIE I $D(Y) S SRSOUT=1 Q
"RTN","SROCD2",68,0)
 .S Y=$P(^SRO(136,SRTN,0),"^",3) I Y S SCEC=$$SCEC^SROCD0() I SCEC D SCEI^SROCD3 K SRCL
"RTN","SROCD2",69,0)
 I $P(^SRO(136,SRTN,0),"^",3)="" W !,"This is a required response. Enter '^' to exit" G PDX
"RTN","SROCD2",70,0)
 I $D(SCEC) K SCEC Q
"RTN","SROCD2",71,0)
PCPT I $P(^SRO(136,SRTN,0),"^",2)="" K DA,DIE,DR S DA=SRTN,DIE=136,DR=".02T" D ^DIE I $D(Y) S SRSOUT=1 Q
"RTN","SROCD2",72,0)
 I $P(^SRO(136,SRTN,0),"^",2)="" W !,"This is a required response. Enter '^' to exit" G PCPT
"RTN","SROCD2",73,0)
 D PRIN^SROMOD0 K DA,DIE,DR
"RTN","SROCD2",74,0)
 Q
"RTN","SROCD4")
0^20^B20829958^B27765963
"RTN","SROCD4",1,0)
SROCD4 ;BIR/ADM - MARK CASE CODING COMPLETE ;10/17/05
"RTN","SROCD4",2,0)
 ;;3.0;Surgery;**142,177**;24 Jun 93;Build 89
"RTN","SROCD4",3,0)
 ;
"RTN","SROCD4",4,0)
 ; Reference to CL^SDCO21 supported by DBIA #406
"RTN","SROCD4",5,0)
 ;
"RTN","SROCD4",6,0)
 N SR,SRCL,SRDATA,SRDX,SRK,SRMISS,SROTH,SRSDATE,SRTYPE
"RTN","SROCD4",7,0)
 S SR(0)=^SRO(136,SRTN,0) S SRSOUT=0,SREDIT=1
"RTN","SROCD4",8,0)
 I $P(SR(0),"^",2)="" S SRMISS("PRINCIPAL PROCEDURE CODE")=""
"RTN","SROCD4",9,0)
 I $P(SR(0),"^",3)="" S SRMISS("PRINCIPAL POSTOP DIAGNOSIS CODE")=""
"RTN","SROCD4",10,0)
 S DFN=$P(^SRF(SRTN,0),"^"),SRSDATE=$P(^SRF(SRTN,0),"^",9) D CL^SDCO21(DFN,SRSDATE,,.SRCL) I $D(SRCL) D PSCEI
"RTN","SROCD4",11,0)
 I '$O(^SRO(136,SRTN,2,0)) S SRMISS("PRINCIPAL ASSOCIATED DIAGNOSIS")=""
"RTN","SROCD4",12,0)
 S SROTH=0 F  S SROTH=$O(^SRO(136,SRTN,3,SROTH)) Q:'SROTH  I '$O(^SRO(136,SRTN,3,SROTH,2,0)) S SRMISS("OTHER ASSOCIATED DIAGNOSIS")="" Q
"RTN","SROCD4",13,0)
 S SROTH=0 F  S SROTH=$O(^SRO(136,SRTN,4,SROTH)) Q:'SROTH  I $D(SRCL) S SRDX=^SRO(136,SRTN,4,SROTH,0) D OSCEI
"RTN","SROCD4",14,0)
 I $D(SRMISS) D MISS Q
"RTN","SROCD4",15,0)
 I $P($G(^SRO(136,SRTN,10)),"^"),'$$CHNG^SROCD1 D  Q
"RTN","SROCD4",16,0)
 .I '$P(^SRF(SRTN,0),"^",15) D FILE Q
"RTN","SROCD4",17,0)
 I '$P($G(^SRO(136,SRTN,10)),"^") D  D ^DIR K DIR I $D(DTOUT)!$D(DUOUT)!'Y Q
"RTN","SROCD4",18,0)
 .W ! K DIR S DIR("A")="Is the coding of this case complete and ready to send to PCE",DIR("B")="NO",DIR(0)="Y"
"RTN","SROCD4",19,0)
FILE D NOW^%DTC S SRNOW=$E(%,1,12) D
"RTN","SROCD4",20,0)
 .K DA,DIE,DR S DA=SRTN,DIE=136,DR="10////1" D ^DIE K DA,DIE,DR
"RTN","SROCD4",21,0)
 .K DD,DO S DIC="^SRO(136,SRTN,11,",DIC(0)="L",X=DUZ,DIC("DR")="1////"_SRNOW D FILE^DICN K DA,DD,DIC,DO,DR
"RTN","SROCD4",22,0)
 .W !!,"Processing data to be sent to PCE..." D CHKIN I SRK D  K SRK Q
"RTN","SROCD4",23,0)
 ..W !!,"Information needed to send the case to PCE is missing. Use the PCE"
"RTN","SROCD4",24,0)
 ..W !,"Filing Status Report to review missing information. The case will be"
"RTN","SROCD4",25,0)
 ..W !,"sent to PCE upon completion of the missing information.",! D PAGE
"RTN","SROCD4",26,0)
 .D START^SROPCEP ; send to PCE
"RTN","SROCD4",27,0)
 .W !!,"Coding completed and sent to PCE.",! D PAGE
"RTN","SROCD4",28,0)
 Q
"RTN","SROCD4",29,0)
CHKIN ; check for items in file 130 required by PCE
"RTN","SROCD4",30,0)
 N SR,SRAO,SRATT,SRCHK,SRCPT,SRCV,SRDATE,SRDEPC,SRDIAG,SRDXF,SREC,SRHNC,SRINOUT,SRIR,SRLOC,SRMST,SRNON,SRO,SRODIAG,SRPROV,SRRPROV,SRSC,SRUP,SRX
"RTN","SROCD4",31,0)
 D UTIL^SROPCEP
"RTN","SROCD4",32,0)
 Q
"RTN","SROCD4",33,0)
MISS W !!,"Coding of this surgical case is not complete.",!,"The following items are missing:",!
"RTN","SROCD4",34,0)
 S SRDATA="" F  S SRDATA=$O(SRMISS(SRDATA)) Q:SRDATA=""  W ?5,SRDATA,!
"RTN","SROCD4",35,0)
 W !,"This case cannot be sent to PCE until all missing information is supplied.",!
"RTN","SROCD4",36,0)
PAGE K DIR S DIR(0)="FOA",DIR("A")="Press Enter/Return key to continue " D ^DIR K DIR
"RTN","SROCD4",37,0)
 Q
"RTN","SROCD4",38,0)
PSCEI S SRTYPE="PRINCIPAL"
"RTN","SROCD4",39,0)
 I $D(SRCL(1)),$P(SR(0),"^",5)="" D SRSET Q
"RTN","SROCD4",40,0)
 I $D(SRCL(2)),$P(SR(0),"^",6)="" D SRSET Q
"RTN","SROCD4",41,0)
 I $D(SRCL(3)),$P(SR(0),"^",4)="" D SRSET Q
"RTN","SROCD4",42,0)
 I $D(SRCL(4)),$P(SR(0),"^",7)="" D SRSET Q
"RTN","SROCD4",43,0)
 I $D(SRCL(5)),$P(SR(0),"^",8)="" D SRSET Q
"RTN","SROCD4",44,0)
 I $D(SRCL(6)),$P(SR(0),"^",9)="" D SRSET Q
"RTN","SROCD4",45,0)
 I $D(SRCL(7)),$P(SR(0),"^",10)="" D SRSET
"RTN","SROCD4",46,0)
 Q
"RTN","SROCD4",47,0)
OSCEI S SRTYPE="OTHER DIAGNOSIS"
"RTN","SROCD4",48,0)
 I $D(SRCL(1)),$P(SRDX,"^",3)="" D SRSET Q
"RTN","SROCD4",49,0)
 I $D(SRCL(2)),$P(SRDX,"^",4)="" D SRSET Q
"RTN","SROCD4",50,0)
 I $D(SRCL(3)),$P(SRDX,"^",2)="" D SRSET Q
"RTN","SROCD4",51,0)
 I $D(SRCL(4)),$P(SRDX,"^",7)="" D SRSET Q
"RTN","SROCD4",52,0)
 I $D(SRCL(5)),$P(SRDX,"^",5)="" D SRSET Q
"RTN","SROCD4",53,0)
 I $D(SRCL(6)),$P(SRDX,"^",6)="" D SRSET Q
"RTN","SROCD4",54,0)
 I $D(SRCL(7)),$P(SRDX,"^",8)="" D SRSET
"RTN","SROCD4",55,0)
 Q
"RTN","SROCD4",56,0)
SRSET S SRMISS(SRTYPE_" SC/EI")=""
"RTN","SROCD4",57,0)
 Q
"RTN","SROCD4",58,0)
CONV ; convert coding data from file 130 to file 136
"RTN","SROCD4",59,0)
 I $O(^SRO(136,0)) D MES^XPDUTL("Conversion has already run.") Q
"RTN","SROCD4",60,0)
 D NITE^SROPCE
"RTN","SROCD4",61,0)
C2 N SRCT,SRD,SRODX,SRPDX,SRPP,SROP,SRP,SRTN
"RTN","SROCD4",62,0)
 D MES^XPDUTL(" Converting coding data from file 130 to file 136...")
"RTN","SROCD4",63,0)
 S (SRCT,SRTN)=0 F  S SRTN=$O(^SRF(SRTN)) Q:'SRTN  D
"RTN","SROCD4",64,0)
 .I '$P($G(^SRF(SRTN,.2)),"^",12)&'$P($G(^SRF(SRTN,"NON")),"^",5) Q
"RTN","SROCD4",65,0)
 .S SRPP=$P($G(^SRF(SRTN,"OP")),"^",2),(SROP,SRP)=0 F  S SRP=$O(^SRF(SRTN,13,SRP)) Q:'SRP  I $P($G(^SRF(SRTN,13,SRP,2)),"^") S SROP=1 Q
"RTN","SROCD4",66,0)
 .S SRPDX=$P($G(^SRF(SRTN,34)),"^",2),(SRODX,SRD)=0 F  S SRD=$O(^SRF(SRTN,15,SRD)) Q:'SRD  I $P($G(^SRF(SRTN,15,SRD,0)),"^",3) S SRODX=1 Q
"RTN","SROCD4",67,0)
 .I SRPP!SROP!SRPDX!SRODX D
"RTN","SROCD4",68,0)
 ..Q:$D(^SRO(136,SRTN,0))
"RTN","SROCD4",69,0)
 ..D ^SROCD1 S SRCT=SRCT+1 I '(SRCT#10000) D MES^XPDUTL(SRCT_" cases converted... ")
"RTN","SROCD4",70,0)
 D MES^XPDUTL("Total cases converted: "_SRCT)
"RTN","SROCD4",71,0)
 Q
"RTN","SROCD4",72,0)
PRE ; pre-install entry
"RTN","SROCD4",73,0)
 ; delete APCE x-refs
"RTN","SROCD4",74,0)
 K DIE,DR,DIK,DA S DIK="^DD(130.16,3,1,",DA=1,DA(1)=3,DA(2)=130.16 D ^DIK
"RTN","SROCD4",75,0)
 K DIK,DA S DIK="^DD(130.165,.01,1,",DA=2,DA(1)=.01,DA(2)=130.165 D ^DIK
"RTN","SROCD4",76,0)
 K DIK,DA S DIK="^DD(130.18,.01,1,",DA=9,DA(1)=.01,DA(2)=130.18 D ^DIK
"RTN","SROCD4",77,0)
 K DIK,DA S DIK="^DD(130.18,3,1,",DA=1,DA(1)=3,DA(2)=130.18 D ^DIK
"RTN","SROCD4",78,0)
 K DIK,DA S DIK="^DD(130,27,1,",DA=1,DA(1)=27,DA(2)=130 D ^DIK
"RTN","SROCD4",79,0)
 K DIK,DA S DIK="^DD(130.275,.01,1,",DA=1,DA(1)=.01,DA(2)=130.275 D ^DIK
"RTN","SROCD4",80,0)
 K DIK,DA S DIK="^DD(130,32.5,1,",DA=1,DA(1)=32.5,DA(2)=130 D ^DIK
"RTN","SROCD4",81,0)
 K DIK,DA S DIK="^DD(130,66,1,",DA=1,DA(1)=66,DA(2)=130 D ^DIK K DIK,DA
"RTN","SROCD4",82,0)
 Q
"RTN","SROCDX")
0^21^B22343423^B21645937
"RTN","SROCDX",1,0)
SROCDX ;BIR/ADM - CASE CODING INPUT/EDIT ;08/29/05
"RTN","SROCDX",2,0)
 ;;3.0;Surgery;**142,177**;24 Jun 93;Build 89
"RTN","SROCDX",3,0)
PCPT ; edit principal procedure code
"RTN","SROCDX",4,0)
 N SRPPY,SRPRIN S (SRPRIN,X)=$P(^SRO(136,SRTN,0),"^",2) I 'X D PPROC Q
"RTN","SROCDX",5,0)
 W !,"Principal Procedure:",! D CPTDISP,ASDX^SROCDX1
"RTN","SROCDX",6,0)
 K DIR S DIR(0)="SO^1:Update Principal Procedure CPT Code;2:Update Associated Diagnoses"
"RTN","SROCDX",7,0)
 S DIR("A")="Enter selection (1 or 2)",DIR("B")=1 D ^DIR I $D(DTOUT)!$D(DUOUT)!'Y Q
"RTN","SROCDX",8,0)
 S SRPPY=Y D  Q
"RTN","SROCDX",9,0)
 .I SRPPY=1 D PPROC Q
"RTN","SROCDX",10,0)
 .I SRPPY=2 D CASDX
"RTN","SROCDX",11,0)
 Q
"RTN","SROCDX",12,0)
PPROC N SRCPT S SRCPT=$P(^SRO(136,SRTN,0),"^",2),SRDIE=1 W !
"RTN","SROCDX",13,0)
 K DR,DIE,DA S DIE=136,DA=SRTN,DR=".02T" D ^DIE K DIE,DR,SRDIE I $D(Y) S SRSOUT=1
"RTN","SROCDX",14,0)
 D PRIN^SROMOD0 I SRCPT'=$P(^SRO(136,SRTN,0),"^",2) D SADXP^SROCDX2 K DA
"RTN","SROCDX",15,0)
 S X=$P(^SRO(136,SRTN,0),"^",2) I $G(SRPRIN)=X Q
"RTN","SROCDX",16,0)
CASDX ; associate principal CPT to diagnosis
"RTN","SROCDX",17,0)
 N SRADX,SRDX0,SRDX1,SRDX2,SRDXCT,SRODIR,SRDIRX,OTHCNT,SRASSDS,SROCT
"RTN","SROCDX",18,0)
 S CPT=$P(^SRO(136,SRTN,0),"^",2) Q:'CPT  K DIR
"RTN","SROCDX",19,0)
 S SRODIR("A",1)="   Select the number(s) of the Diagnosis Code to associate to"
"RTN","SROCDX",20,0)
 S SRODIR("A")="   the procedure selected"
"RTN","SROCDX",21,0)
 D HDR^SROCD,CPTDISP,ASDX^SROCDX1
"RTN","SROCDX",22,0)
 K DIR D SRODIR
"RTN","SROCDX",23,0)
 W !
"RTN","SROCDX",24,0)
 S DIR(0)=SRDX2,SRASSDS=$$PASSDS^SROCDX1,DIR("B")=SRASSDS
"RTN","SROCDX",25,0)
 F I=1:1 D ^DIR Q:(($$VALASC())&('$$DXDUP(Y)))
"RTN","SROCDX",26,0)
 Q:(Y["^")!(Y="")
"RTN","SROCDX",27,0)
 D PADD1^SROCDX1 Q
"RTN","SROCDX",28,0)
 Q:Y="Q"!(Y["")
"RTN","SROCDX",29,0)
 G CASDX
"RTN","SROCDX",30,0)
 Q
"RTN","SROCDX",31,0)
COTHADX D COTHBLD        ;Associate "Other" CPTs to Diagnosis
"RTN","SROCDX",32,0)
 N SRDX0,SRDX1,SRDX2,SRDIR,OTHCNT,SRASSDS
"RTN","SROCDX",33,0)
 S OTHCNT=SRDA
"RTN","SROCDX",34,0)
 S SRODIR("A",1)="   Select the number(s) of the Diagnosis Code to associate to"
"RTN","SROCDX",35,0)
 S SRODIR("A")="   the procedure selected"
"RTN","SROCDX",36,0)
 K DIR D HDR^SROCD,OTHCPTD,OTHADX^SROCDX1
"RTN","SROCDX",37,0)
 K DIR D SRODIR W ! F I=1:1:80 W "-"
"RTN","SROCDX",38,0)
 S DIR(0)=SRDX2 I $G(D0)="",$G(SRPOTH) S D0=SRPOTH
"RTN","SROCDX",39,0)
 S SRASSDS=$$OASSDS^SROCDX1
"RTN","SROCDX",40,0)
 S DIR("B")=SRASSDS I SRASSDS="",$G(SRDIRX(1))'="" S DIR("B")=1
"RTN","SROCDX",41,0)
 F I=1:1 D ^DIR Q:(($$VALASC())&('$$DXDUP(Y)))
"RTN","SROCDX",42,0)
 Q:(Y["^")!(Y="")
"RTN","SROCDX",43,0)
 D OADD1^SROCDX1
"RTN","SROCDX",44,0)
 Q:Y="Q"!(Y["")
"RTN","SROCDX",45,0)
 G COTHADX
"RTN","SROCDX",46,0)
 Q
"RTN","SROCDX",47,0)
DXDUP(SRDX) I (Y["^")!($G(DTOUT)) Q 0
"RTN","SROCDX",48,0)
 N SRAI,SRDXX,SRDUP,DIR S SRDUP=0
"RTN","SROCDX",49,0)
 I SRDX="" Q 0
"RTN","SROCDX",50,0)
 F SRAI=1:1:$L(SRDX,",") D
"RTN","SROCDX",51,0)
 .Q:$P(SRDX,",",SRAI)<1
"RTN","SROCDX",52,0)
 .I $D(SRDXX($P(SRDX,",",SRAI)))!((SRDIRX($P(SRDX,",",SRAI))="ALL")&($L(SRDX,",")>1)) S SRDUP=1,DIR(0)="FO^",DIR("A",1)="     **Duplicates entered",DIR("A")="     Press Return to continue" D ^DIR
"RTN","SROCDX",53,0)
 .S SRDXX($P(SRDX,",",SRAI))=""
"RTN","SROCDX",54,0)
 Q SRDUP
"RTN","SROCDX",55,0)
VALASC() I (Y["^")!('$G(Y(0)))!($G(DTOUT)) Q 1
"RTN","SROCDX",56,0)
 N VALA,DIR S VALA=1
"RTN","SROCDX",57,0)
 S:Y=""!(Y=U)!('+Y(0))!(Y[",0")!($P(Y,",",1)=0) VALA=0
"RTN","SROCDX",58,0)
 I 'VALA S DIR("A",1)="     **Invalid input",DIR(0)="FO^",DIR("A")="     Press Return to continue" D ^DIR
"RTN","SROCDX",59,0)
 Q VALA
"RTN","SROCDX",60,0)
SRODIR N SRFLG,SRCNT,SRCNTR,SRSYS
"RTN","SROCDX",61,0)
 S SRSYS=$$ICDSYS^SROICD($P(^SRF(SRTN,0),"^",9))
"RTN","SROCDX",62,0)
 S DIR("A",1)="Only the following ICD"_$S(SRSYS="10D":"10",1:"9")_" Diagnosis Codes can be associated:"
"RTN","SROCDX",63,0)
 S DIR("A",2)=""
"RTN","SROCDX",64,0)
 S (SRFLG,SRCNT)=1,SRCNTR=3,ADCNT="" F  S ADCNT=$O(SRDIRX(ADCNT)) Q:'ADCNT  D
"RTN","SROCDX",65,0)
 .S:'$D(DIR("A",SRCNTR)) DIR("A",SRCNTR)=""
"RTN","SROCDX",66,0)
 .S DIR("A",SRCNTR)=DIR("A",SRCNTR)_SRCNT_". "_SRDIRX(ADCNT),SRCNT=SRCNT+1,SRCNTR=SRCNTR+1,SRFLG=1
"RTN","SROCDX",67,0)
 S DIR("A",SRCNTR+2)=SRODIR("A",1),DIR("A")=SRODIR("A"),DIR("A",SRCNTR+1)=""
"RTN","SROCDX",68,0)
 Q
"RTN","SROCDX",69,0)
COTHBLD N SRCNT,OTH,X,CPT,CPT1,SRDA K SRSEL
"RTN","SROCDX",70,0)
 S OTH=0,SRCNT=1 F  S OTH=$O(^SRO(136,SRTN,3,OTH)) Q:'OTH  D
"RTN","SROCDX",71,0)
 .S X=$P(^SRO(136,SRTN,3,OTH,0),U),CPT1=""
"RTN","SROCDX",72,0)
 .I X S CPT1=X,Y=$$CPT^ICPTCOD(X),SRCPT=$P(Y,U,2),SRSHT=$P(Y,U,3),Y=SRCPT,SRDA=OTH D SSOTH^SROCPT0 S SRCPT=Y,CPT=SRCPT_"  "_SRSHT
"RTN","SROCDX",73,0)
 .S SRSEL(SRCNT)=OTH_"^CPT Code: "_CPT_U_CPT1_U_$E(SRCPT,1,5)_"  "_SRSHT
"RTN","SROCDX",74,0)
 .S SRCNT=SRCNT+1
"RTN","SROCDX",75,0)
 Q
"RTN","SROCDX",76,0)
OTHCPTD N SRM,SRI,SRFIRST,SRY ;PROCS/Codes/Mods.
"RTN","SROCDX",77,0)
 S SRFIRST=0 D COTHBLD
"RTN","SROCDX",78,0)
 W !,"Other Procedures:",!!,OTHCNT,"."," CPT Code: "_$P(SRSEL(SRDA),U,4)
"RTN","SROCDX",79,0)
 S OTH=$P(SRSEL(SRDA),U) W !,?5,"Modifiers: "
"RTN","SROCDX",80,0)
 S SRI=0 F  S SRI=$O(^SRO(136,SRTN,3,OTH,1,SRI)) Q:'SRI  D
"RTN","SROCDX",81,0)
 .S SRM=$P(^SRO(136,SRTN,3,OTH,1,SRI,0),U)
"RTN","SROCDX",82,0)
 .W:SRFIRST !,?16 W $P($$MOD^ICPTMOD(SRM,"I"),"^",2),"-",$P($$MOD^ICPTMOD(SRM,"I"),"^",3)
"RTN","SROCDX",83,0)
 .S SRFIRST=1
"RTN","SROCDX",84,0)
 I '$O(^SRO(136,SRTN,3,OTH,1,0)) W "NOT ENTERED"
"RTN","SROCDX",85,0)
 Q
"RTN","SROCDX",86,0)
CPTDISP N SRFIRST,SRMO
"RTN","SROCDX",87,0)
 S X=$P(^SRO(136,SRTN,0),U,2) I X S SRY=$$CPT^ICPTCOD(X),Y=$P(SRY,U,2),(SROCPT2,Z)=$P(SRY,U,3)
"RTN","SROCDX",88,0)
 S:'$D(Y) Y="NOT ENTERED",Z="" W !,?3,"CPT Code: "_Y_"  "_Z,!,?3,"Modifiers: "
"RTN","SROCDX",89,0)
 I '$O(^SRO(136,SRTN,1,0)) W "NOT ENTERED"
"RTN","SROCDX",90,0)
 S SRMOD=0 F  S SRMOD=$O(^SRO(136,SRTN,1,SRMOD)) Q:'SRMOD  D
"RTN","SROCDX",91,0)
 .S SRMO=$P(^SRO(136,SRTN,1,SRMOD,0),U)
"RTN","SROCDX",92,0)
 .W:$G(SRFIRST) !,?14 W $P($$MOD^ICPTMOD(SRMO,"I"),"^",2),"-",$P($$MOD^ICPTMOD(SRMO,"I"),"^",3)
"RTN","SROCDX",93,0)
 .S SRFIRST=1
"RTN","SROCDX",94,0)
 Q
"RTN","SROCDX1")
0^22^B25379397^B25247822
"RTN","SROCDX1",1,0)
SROCDX1 ;BIR/ADM,BAJ - ASSOCIATED DIAGNOSIS FOR CODER SCREENS ; 4/17/07 11:04am
"RTN","SROCDX1",2,0)
 ;;3.0;Surgery;**142,161,177**;24 Jun 93;Build 89
"RTN","SROCDX1",3,0)
OTHADX ;Display ASDX for OTHER PROCS
"RTN","SROCDX1",4,0)
 N SRTMP,SRASSD,SROICD
"RTN","SROCDX1",5,0)
 S SRPADX=0,SROCNTR=1 F SRI=1:1 S SRPADX=$O(^SRO(136,SRTN,3,OTH,2,SRPADX)) Q:'SRPADX  D
"RTN","SROCDX1",6,0)
 .S SRICD9=^SRO(136,SRTN,3,OTH,2,SRPADX,0)
"RTN","SROCDX1",7,0)
 .S:SRICD9 SROICD=$$ICDSTR
"RTN","SROCDX1",8,0)
 .S SRTMP(SRI)=SROICD,SROCNTR=SROCNTR+1
"RTN","SROCDX1",9,0)
 S SROCNTR=0
"RTN","SROCDX1",10,0)
 D ADXDISP I '$O(^SRO(136,SRTN,3,OTH,2,0)) W "NOT ENTERED",!
"RTN","SROCDX1",11,0)
 D PASSDIAG,ASSDIAG
"RTN","SROCDX1",12,0)
 Q
"RTN","SROCDX1",13,0)
ASDX ;Display ASDX for PRIN Procs
"RTN","SROCDX1",14,0)
 N SRI,SRFIRST,SRICD9,SRPRIN,SRPADX,SRASSD K SRTMP
"RTN","SROCDX1",15,0)
 S SRI=0,SRFIRST=1 F  S SRI=$O(^SRO(136,SRTN,1,SRI)) Q:'SRI  S SRM=$P(^SRO(136,SRTN,1,SRI,0),U)
"RTN","SROCDX1",16,0)
 S SRPADX=0,SROCNTR=2 F SRI=1:1 S SRPADX=$O(^SRO(136,SRTN,2,SRPADX)) Q:'SRPADX  D
"RTN","SROCDX1",17,0)
 .S SRICD9=^SRO(136,SRTN,2,SRPADX,0) Q:'SRICD9
"RTN","SROCDX1",18,0)
 .S:SRICD9 SROICD=$$ICDSTR
"RTN","SROCDX1",19,0)
 .S SRTMP(SRI)=$G(SROICD),SROCNTR=$G(SROCNTR)+1
"RTN","SROCDX1",20,0)
 D ADXDISP I '$O(^SRO(136,SRTN,2,0)) W !,?5,SRMSG
"RTN","SROCDX1",21,0)
 D PASSDIAG,ASSDIAG
"RTN","SROCDX1",22,0)
 Q
"RTN","SROCDX1",23,0)
AASDX S SROICD=""
"RTN","SROCDX1",24,0)
 S:SRASSD SRICD9=$P($G(^SRO(136,SRTN,4,SRASSD,0)),U)
"RTN","SROCDX1",25,0)
 S:'SRASSD SRICD9=$P($G(^SRO(136,SRTN,0)),U,3)
"RTN","SROCDX1",26,0)
 S:SRICD9 SROICD=$$ICDSTR
"RTN","SROCDX1",27,0)
 Q
"RTN","SROCDX1",28,0)
PASSDIAG N ADCNT,SRICD9,SRFLG,SRCNTR,SRASSD  ;List PRIN DX to assoc.
"RTN","SROCDX1",29,0)
 K SRADX,SRDIRX,SRADIAG S SRICD9=$P($G(^SRO(136,SRTN,0)),U,3)
"RTN","SROCDX1",30,0)
 I SRICD9'="" S SRDIRX(1)=$$ICDSTR,SRADX(1)=$P(SRDIRX(1),U,2),SRADIAG(1)=$P($G(^SRO(136,SRTN,0)),U,3)
"RTN","SROCDX1",31,0)
 I SRICD9="" S SRDIRX(1)="",SRADIAG(1)=""
"RTN","SROCDX1",32,0)
 Q
"RTN","SROCDX1",33,0)
ASSDIAG N SRDCNT,SRADCNT,SRQ ;DXs for assoc.
"RTN","SROCDX1",34,0)
 S (ADCNT,SRASSD)=0 S SRCNT=$S($G(SRDIRX(1))'="":1,1:0)
"RTN","SROCDX1",35,0)
 F  S ADCNT=$O(^SRO(136,SRTN,4,ADCNT)) Q:ADCNT=""  D
"RTN","SROCDX1",36,0)
 .S SRICD9=$P(^SRO(136,SRTN,4,ADCNT,0),U)
"RTN","SROCDX1",37,0)
 .S:SRICD9'="" SRCNT=SRCNT+1,SRDIRX(SRCNT)=$$ICDSTR,SRADX(SRCNT)=$P(SRDIRX(SRCNT),U,2)
"RTN","SROCDX1",38,0)
 .S:SRICD9="" SRDIRX(SRCNT)=$P(^SRO(136,SRTN,4,ADCNT,0),U)
"RTN","SROCDX1",39,0)
 .S SRADIAG(SRCNT)=$P(^SRO(136,SRTN,4,ADCNT,0),U)
"RTN","SROCDX1",40,0)
 ;modified to use 1 as lower limit, SRCNT as upper (SRO*3.0*161)
"RTN","SROCDX1",41,0)
 S:$D(SRDIRX) SRDX2="LO^1:"_SRCNT
"RTN","SROCDX1",42,0)
 Q
"RTN","SROCDX1",43,0)
SRDIAGS() N SRDIAGS,SRDGCNT
"RTN","SROCDX1",44,0)
 S (SRDIAGS,SRDGCNT)=0 S:$D(^SRF(SRTN,34)) SRDIAGS=1
"RTN","SROCDX1",45,0)
 F I=1:1 S SRDGCNT=$O(^SRF(SRTN,15,SRDGCNT)) Q:SRDGCNT=""  S SRDIAGS=SRDIAGS+1
"RTN","SROCDX1",46,0)
 Q SRDIAGS
"RTN","SROCDX1",47,0)
ICDSTR() N SRICDSTR
"RTN","SROCDX1",48,0)
 S SRICDSTR=$$ICD^SROICD(SRTN,SRICD9),SRICDSTR=$P(SRICDSTR,U,2)_"-"_$P(SRICDSTR,U,4)
"RTN","SROCDX1",49,0)
 Q SRICDSTR
"RTN","SROCDX1",50,0)
PASSDS() N SRDX,SRI,SRJ,SRPADX,SRASSDS,SRPX
"RTN","SROCDX1",51,0)
 S SRASSDS="",SRPADX=0 F  S SRPADX=$O(^SRO(136,SRTN,2,SRPADX)) Q:'SRPADX  D
"RTN","SROCDX1",52,0)
 .S SRDX=$P(^SRO(136,SRTN,2,SRPADX,0),"^")
"RTN","SROCDX1",53,0)
 .S SRJ=0 F  S SRJ=$O(SRADIAG(SRJ)) Q:'SRJ  I SRADIAG(SRJ)=SRDX S SRPX=SRJ Q
"RTN","SROCDX1",54,0)
 .S SRASSDS=$S($L(SRASSDS)<1:SRPX,1:SRASSDS_","_SRPX)
"RTN","SROCDX1",55,0)
 Q SRASSDS
"RTN","SROCDX1",56,0)
OASSDS() N SRDX,SRI,SRJ,SRPADX,SRASSDS,SRPX
"RTN","SROCDX1",57,0)
 S SRASSDS="",SRPADX=0 F  S SRPADX=$O(^SRO(136,SRTN,3,SRPOTH,2,SRPADX)) Q:'SRPADX  D
"RTN","SROCDX1",58,0)
 .S SRDX=$P(^SRO(136,SRTN,3,SRPOTH,2,SRPADX,0),"^")
"RTN","SROCDX1",59,0)
 .S SRJ=0 F  S SRJ=$O(SRADIAG(SRJ)) Q:'SRJ  I SRADIAG(SRJ)=SRDX S SRPX=SRJ Q
"RTN","SROCDX1",60,0)
 .S SRASSDS=$S($L(SRASSDS)<1:SRPX,1:SRASSDS_","_SRPX)
"RTN","SROCDX1",61,0)
 Q SRASSDS
"RTN","SROCDX1",62,0)
OTHADXD N SRCOMMA,SROADX,SRICD9,SROADX1,SROODX,SRASSD,SRSUB ;OTHER PROCS ADXs
"RTN","SROCDX1",63,0)
 I '$O(^SRO(136,SRTN,3,OTH,2,0)) W !,?5,SRMSG Q
"RTN","SROCDX1",64,0)
 S SRSUB=1 D OTHADX
"RTN","SROCDX1",65,0)
 Q
"RTN","SROCDX1",66,0)
PADXD N SRCOMMA,SRPADX,SRICD9,SRPDX,SRPDX1,SROPRIN,SRSUB
"RTN","SROCDX1",67,0)
 S SRPADX=0,SROCNTR=2,SRSUB=1
"RTN","SROCDX1",68,0)
 I '$O(^SRO(136,SRTN,2,0)),$P(^SRO(136,SRTN,0),U,3) D
"RTN","SROCDX1",69,0)
 .S SRASSD=$P(^SRO(136,SRTN,0),U,3),SRFDA="136.02",SRIENU="+1"_","_SRTN_",",SRIENF=0_","_SRTN_"," D UPDATE,FILE
"RTN","SROCDX1",70,0)
 D ASDX
"RTN","SROCDX1",71,0)
 Q
"RTN","SROCDX1",72,0)
ADXDISP N SROCNTR ;ADXS for PROC
"RTN","SROCDX1",73,0)
 W !,?5,"Assoc. DX"_$$ICDSTR^SROICD(SRTN)_": " N SRFIRST
"RTN","SROCDX1",74,0)
 S (SROCNTR,SRDXCNT)=0,SRFIRST=1
"RTN","SROCDX1",75,0)
 F I=1:1  S SROCNTR=$O(SRTMP(SROCNTR)) Q:'SROCNTR  D
"RTN","SROCDX1",76,0)
 .I $D(SRSUB) D
"RTN","SROCDX1",77,0)
 ..W:'(I#2) ?48 W:I#2 ?16 W $E(SRTMP(SROCNTR),1,28)
"RTN","SROCDX1",78,0)
 ..I '(I#2),($O(SRTMP(SROCNTR))) W !
"RTN","SROCDX1",79,0)
 .I '$D(SRSUB) W:'SRFIRST ! W ?16,$E(SRTMP(SROCNTR),1,28) S SRFIRST=0
"RTN","SROCDX1",80,0)
 S SRDXCNT=I,SRDX1="LO^:"_SRDXCNT S:SRDXCNT>0 SRDX1="LO^:"_SRDXCNT
"RTN","SROCDX1",81,0)
 Q
"RTN","SROCDX1",82,0)
PADD1 ;PRIN ADX
"RTN","SROCDX1",83,0)
 N SRY,SRY0,SRY1,SRY2,SRC,REC,DIE,DA,DR,SRASSD
"RTN","SROCDX1",84,0)
 S SRY(0)=Y(0)
"RTN","SROCDX1",85,0)
 D KPADX^SROCDX2(SRTN)
"RTN","SROCDX1",86,0)
 S SRCNTR=0,SRASSD=SRADIAG($P(SRY(0),",",1)),SRFDA="136.02",SRIENU="+1"_","_SRTN_",",SRIENF=SRCNTR_","_SRTN_"," D UPDATE,FILE
"RTN","SROCDX1",87,0)
 S SRY(0)=$E(SRY(0),2,$L(SRY(0)))
"RTN","SROCDX1",88,0)
 F SRY2=1:1:$P(SRDX2,":",2) D
"RTN","SROCDX1",89,0)
 .S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROCDX1",90,0)
 .Q:SRY0<1
"RTN","SROCDX1",91,0)
 .S SRCNTR=$P(^SRO(136,SRTN,2,0),U,3)+1,SRASSD=SRADIAG(SRY0),SRFDA="136.02",SRIENU="+1"_","_SRTN_",",SRIENF=SRCNTR_","_SRTN_"," D UPDATE,FILE
"RTN","SROCDX1",92,0)
 S Y(0)=SRY(0)
"RTN","SROCDX1",93,0)
 Q
"RTN","SROCDX1",94,0)
OADD1 N SRY,SRY0,SRY1,SRY2,SRCNTR,SRASSD ;Associate 1 Diagnosis to OTHER Procedure
"RTN","SROCDX1",95,0)
 S SRY(0)=Y(0),SRCNTR=0
"RTN","SROCDX1",96,0)
 S:$D(^SRO(136,SRTN,3,OTH,2)) SRCNTR=$P(^SRO(136,SRTN,3,OTH,2,0),U,3)+1
"RTN","SROCDX1",97,0)
 D KOADX^SROCDX2(SRTN,OTH)
"RTN","SROCDX1",98,0)
 S:'$D(^SRO(136,SRTN,3,OTH,2)) SRCNTR=1
"RTN","SROCDX1",99,0)
 S SRFDA="136.32",SRIENU="+1"_","_OTH_","_SRTN_","
"RTN","SROCDX1",100,0)
 F SRY2=1:1:$P(SRDX2,":",2) D
"RTN","SROCDX1",101,0)
 .S SRY0=$P(SRY(0),",",SRY2)
"RTN","SROCDX1",102,0)
 .Q:'SRY0
"RTN","SROCDX1",103,0)
 .S SRASSD=SRADIAG(SRY0),SRIENF=SRCNTR_","_OTH_","_SRTN_"," K SRY1 D UPDATE,FILE
"RTN","SROCDX1",104,0)
 .S SRCNTR=SRCNTR+1
"RTN","SROCDX1",105,0)
 S Y(0)=SRY(0)
"RTN","SROCDX1",106,0)
 Q
"RTN","SROCDX1",107,0)
UPDATE ;
"RTN","SROCDX1",108,0)
 S SRY1(SRFDA,SRIENU,".01")=SRASSD
"RTN","SROCDX1",109,0)
 D UPDATE^DIE("","SRY1")
"RTN","SROCDX1",110,0)
 Q
"RTN","SROCDX1",111,0)
FILE ;
"RTN","SROCDX1",112,0)
 S SRY1(SRFDA,SRIENF,".01")=SRASSD D FILE^DIE("","SRY1") K SRY1
"RTN","SROCDX1",113,0)
 Q
"RTN","SROCDX1",114,0)
CONT N DIR S DIR(0)="FO^",DIR("A")="Press RETURN to continue  " D ^DIR
"RTN","SROCDX1",115,0)
 Q
"RTN","SROCMPED")
0^23^B36854349^B34021331
"RTN","SROCMPED",1,0)
SROCMPED ;BIR/MAM - ENTER/EDIT OCCURRENCES ;08/16/2011
"RTN","SROCMPED",2,0)
 ;;3.0;Surgery;**26,38,47,125,153,170,176,177**;24 Jun 93;Build 89
"RTN","SROCMPED",3,0)
 I '$P(^SRF(SRTN,SRTYPE,SRENTRY,0),"^",2) D NOCAT I SRSOUT S SRSOUT=0 Q
"RTN","SROCMPED",4,0)
 I '$D(^SRF(SRTN,SRTYPE,SRENTRY,0)) K SRENTRY S SRSOUT=0 Q
"RTN","SROCMPED",5,0)
START I '$D(^SRF(SRTN,SRTYPE,SRENTRY)) K SRENTRY S SRSOUT=0 Q
"RTN","SROCMPED",6,0)
 S SRSOUT=0,SR=^SRF(SRTN,SRTYPE,SRENTRY,0)
"RTN","SROCMPED",7,0)
 I $G(SRNEW),$P(SR,"^",2)=3,SRTYPE=16 D SEPSIS G:SRSOUT END G START
"RTN","SROCMPED",8,0)
 I $G(SRNEW),$P(SR,"^",2)=27,SRTYPE=16,$P($G(^SRF(SRTN,"RA")),"^",2)="C" D RCP G:SRSOUT END G START
"RTN","SROCMPED",9,0)
 I $G(SRNEW),$P(SR,"^",2)=12,SRTYPE=16 D STROKE G:SRSOUT END G START
"RTN","SROCMPED",10,0)
 D HDR^SROAUTL W !
"RTN","SROCMPED",11,0)
 S SRO(1)=$P(SR,"^")_"^.01",X=$P(SR,"^",2),SRO(2)=X_"^"_$S(SRTYPE=10:3,1:5) I X S $P(SRO(2),"^")=$P(^SRO(136.5,X,0),"^")
"RTN","SROCMPED",12,0)
 I $P(SR,"^",2)=3 S Y=$P(SR,"^",4),C=$P(^DD(130.22,7,0),"^",2) D:Y'="" Y^DIQ S SRO(3)=Y_"^7"
"RTN","SROCMPED",13,0)
 I $P(SR,"^",2)=12 S Y=$P(SR,"^",8),C=$P(^DD(130.22,9,0),"^",2) D:Y'="" Y^DIQ S SRO(3)=Y_"^9"
"RTN","SROCMPED",14,0)
 I $P(SR,"^",2)'=3&($P(SR,"^",2)'=12) D
"RTN","SROCMPED",15,0)
 .S SRSDATE=$E($P(SR,"^",7),1,7) I 'SRSDATE S SRSDATE=$E($P(^SRF(SRTN,0),"^",9),1,7)
"RTN","SROCMPED",16,0)
 .I $P(SR,"^",2)=27,$P($G(^SRF(SRTN,"RA")),"^",2)="C" S Y=$P(SR,"^",5),C=$P(^DD(130.22,8,0),"^",2) D:Y'="" Y^DIQ S SRO(3)=Y_"^8" Q
"RTN","SROCMPED",17,0)
 .S X=$P(SR,"^",3) D:X ICDSTR S SRO(3)=X_"^"_$S(SRTYPE=10:4,1:6)
"RTN","SROCMPED",18,0)
 S SR(2)=$G(^SRF(SRTN,SRTYPE,SRENTRY,2)),SRO(4)=$P(SR(2),"^")_"^"_$S(SRTYPE=10:2,1:3)
"RTN","SROCMPED",19,0)
 S X=$P(SR,"^",6),SHEMP=$S(X="U":"UNRESOLVED",X="I":"IMPROVED",X="D":"DEATH",X="W":"WORSE",1:""),SRO(5)=SHEMP_"^.05"
"RTN","SROCMPED",20,0)
 K SRO(6) I SRTYPE=16 S X=$P(SR,"^",7) S:X X=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) S SRO(6)=X_"^2"
"RTN","SROCMPED",21,0)
DISP N SRSYS S SRSYS=$$ICD910^SROICD(SRTN)
"RTN","SROCMPED",22,0)
 W !,"1. Occurrence: ",?32,$P(SRO(1),"^"),!,"2. Occurrence Category: ",?32,$P(SRO(2),"^")
"RTN","SROCMPED",23,0)
 W !,"3. "_$S($P(SR,"^",2)=3:"Sepsis Type",$P(SR,"^",2)=12:"Stroke/CVA Duration",$P(SR,"^",2)=27&($P($G(^SRF(SRTN,"RA")),"^",2)="C"):"CPB Status",1:"ICD Diagnosis Code "_$$ICDSTR^SROICD(SRTN))_":",?32,$P(SRO(3),"^")
"RTN","SROCMPED",24,0)
 W !,"4. Treatment Instituted:",?32,$P(SRO(4),"^"),!,"5. Outcome to Date:",?32,$P(SRO(5),"^")
"RTN","SROCMPED",25,0)
 I $D(SRO(6)) W !,"6. Date Noted: ",?32,$P(SRO(6),"^")
"RTN","SROCMPED",26,0)
 S SRX=$S(SRTYPE=10:6,1:7),SRO(SRX)="^" I $O(^SRF(SRTN,SRTYPE,SRENTRY,1,0)) S SRO(SRX)="*** INFORMATION ENTERED ***"_SRO(SRX)
"RTN","SROCMPED",27,0)
 S X=$S(SRTYPE=10:1,1:4),SRO(SRX)=SRO(SRX)_X,SRMAX=SRX
"RTN","SROCMPED",28,0)
 W !,SRX_". Occurrence Comments: ",?31,$P(SRO(SRX),"^")
"RTN","SROCMPED",29,0)
 W !!,SRLINE
"RTN","SROCMPED",30,0)
 W !!,"Select Occurrence Information: " R X:DTIME I '$T!("^"[X) S:X["^" SRSOUT=1 G END
"RTN","SROCMPED",31,0)
 I "Aa"[X S X="1:"_SRMAX
"RTN","SROCMPED",32,0)
 I X'?.N1":".N,'$D(SRO(X)) D HELP G:SRSOUT END W @IOF G START
"RTN","SROCMPED",33,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>SRMAX)!(Y>Z) D HELP G:SRSOUT END W @IOF G START
"RTN","SROCMPED",34,0)
 D HDR^SROAUTL W !
"RTN","SROCMPED",35,0)
 I X?.N1":".N D RANGE G START
"RTN","SROCMPED",36,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN) D:SRZ=2 PRESS
"RTN","SROCMPED",37,0)
 .S SRZ=X K DIE,DA,DR S DA(1)=SRTN,DA=SRENTRY,DIE="^SRF("_SRTN_","_SRTYPE_","
"RTN","SROCMPED",38,0)
 .S DR=$P(SRO(X),"^",2)_$S((SRTYPE=16&($P(SRO(X),"^",2)=6))!(SRTYPE=10&($P(SRO(X),"^",2)=4)):"ICD Diagnosis Code "_$$ICDSTR^SROICD(SRTN),1:"T") D ^DIE K DR,DA
"RTN","SROCMPED",39,0)
 .I SRZ=3,$P(SR,"^",2)=12,$P(^SRF(SRTN,16,SRENTRY,0),"^",8)<2 D YUP
"RTN","SROCMPED",40,0)
 G START
"RTN","SROCMPED",41,0)
 Q
"RTN","SROCMPED",42,0)
ICDSTR ; get diagnosis info
"RTN","SROCMPED",43,0)
 N SRICDSTR
"RTN","SROCMPED",44,0)
 S SRICDSTR=$$ICD^SROICD(SRTN,X),X=$P(SRICDSTR,"^",2)_"  "_$P(SRICDSTR,"^",4)
"RTN","SROCMPED",45,0)
 Q
"RTN","SROCMPED",46,0)
HELP W @IOF,!!!!,"Enter the number, or range of numbers you want to edit.  Examples of proper",!,"responses are listed below."
"RTN","SROCMPED",47,0)
 W !!,"1. Enter 'A' to update all occurrence information."
"RTN","SROCMPED",48,0)
 S RANGE="(1-"_SRMAX_")"
"RTN","SROCMPED",49,0)
 W !!,"2. Enter a number "_RANGE_" to update a specific occurrence element.  (For",!,"   example, enter '2' to update the occurrence category)"
"RTN","SROCMPED",50,0)
 W !!,"3. Enter a range of numbers "_RANGE_" separated by a ':' to enter a range of",!,"   elements.  (For example, enter '1:3' to enter occurrence, occurrence",!,"   category, and ICD diagnosis code)"
"RTN","SROCMPED",51,0)
 W ! D PRESS
"RTN","SROCMPED",52,0)
 Q
"RTN","SROCMPED",53,0)
RANGE ; range of numbers
"RTN","SROCMPED",54,0)
 I $$LOCK^SROUTL(SRTN) D  D UNLOCK^SROUTL(SRTN)
"RTN","SROCMPED",55,0)
 .S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  D ONE
"RTN","SROCMPED",56,0)
 I CURLEY=2 D PRESS
"RTN","SROCMPED",57,0)
 Q
"RTN","SROCMPED",58,0)
ONE ; edit one item
"RTN","SROCMPED",59,0)
 K DR,DA,DIE
"RTN","SROCMPED",60,0)
 S DR=$P(SRO(EMILY),"^",2)_$S((SRTYPE=16&($P(SRO(EMILY),"^",2)=6))!(SRTYPE=10&($P(SRO(EMILY),"^",2)=4)):"ICD Diagnosis Code "_$$ICDSTR^SROICD(SRTN),1:"T")
"RTN","SROCMPED",61,0)
 S DA=SRENTRY,DA(1)=SRTN
"RTN","SROCMPED",62,0)
 S DIE="^SRF("_SRTN_","_SRTYPE_","
"RTN","SROCMPED",63,0)
 D ^DIE K DR,DA
"RTN","SROCMPED",64,0)
 I '$D(^SRF(SRTN,SRTYPE,SRENTRY))!$D(DTOUT)!$D(Y) S SRSOUT=1
"RTN","SROCMPED",65,0)
 Q
"RTN","SROCMPED",66,0)
END K SRO,SR,X,DA,DIE,DR,Y
"RTN","SROCMPED",67,0)
 Q
"RTN","SROCMPED",68,0)
SEPSIS D HDR^SROAUTL K DA,DIE,DR
"RTN","SROCMPED",69,0)
 S DA=SRENTRY,DA(1)=SRTN,DR="7T",DIE="^SRF("_SRTN_","_SRTYPE_"," D ^DIE K DR,DA
"RTN","SROCMPED",70,0)
 K DA,DIE,DR S SRNEW=0 I $D(DTOUT)!$D(Y) S SRSOUT=1 Q
"RTN","SROCMPED",71,0)
 Q
"RTN","SROCMPED",72,0)
STROKE D HDR^SROAUTL K DIR S DIR(0)="130.22,9",DIR("A")="Stroke/CVA Duration",DIR("B")="<24 HOURS" D ^DIR K DIR I $D(DTOUT) S SRSOUT=1 Q 
"RTN","SROCMPED",73,0)
 K DA,DR,DIE I X["^"!(X="@")!(Y=1) D DEL S DA=SRTN,DIE=130,DR="256////N" D ^DIE K DR,DA,DIE Q
"RTN","SROCMPED",74,0)
 S DA=SRENTRY,DR="9///"_Y,DA(1)=SRTN,DIE="^SRF(SRTN,16," D ^DIE S SRNEW=0 K DR,DA,DIE
"RTN","SROCMPED",75,0)
 Q
"RTN","SROCMPED",76,0)
RCP D HDR^SROAUTL K DA,DIE,DR
"RTN","SROCMPED",77,0)
 S DA=SRENTRY,DA(1)=SRTN,DR="8T",DIE="^SRF("_SRTN_","_SRTYPE_"," D ^DIE K DR,DA
"RTN","SROCMPED",78,0)
 K DA,DIE,DR S SRNEW=0 I $D(DTOUT)!$D(Y) S SRSOUT=1 Q
"RTN","SROCMPED",79,0)
 Q
"RTN","SROCMPED",80,0)
NOCAT W @IOF,!,"The occurrence selected does not have a corresponding category.  A category",!,"must be selected at this time, or the occurrence will be deleted.",!
"RTN","SROCMPED",81,0)
 K DIE,DIC,X,Y,SRCAT
"RTN","SROCMPED",82,0)
 S DIC=136.5,DIC(0)="QEAMZ",DIC("A")="Select Occurrence Category: ",DIC("S")="I '$P(^(0),U,2)" S:SRTYPE=10 DIC("S")=DIC("S")_",$P(^(0),U,3)" D ^DIC
"RTN","SROCMPED",83,0)
 I +Y>0 S SRCAT=+Y K DIE,DR,DA S DA(1)=SRTN,DA=SRENTRY,DIE="^SRF("_DA_","_SRTYPE_",",DR=$S(SRTYPE=10:3,1:5)_"////"_SRCAT D ^DIE K DR,DA
"RTN","SROCMPED",84,0)
 I $D(SRCAT) K SRCAT Q
"RTN","SROCMPED",85,0)
DEL W !!,"Are you sure that you want to delete this occurrence ? NO// " R SRYN:DTIME I '$T!(SRYN["^") D YUP S SRSOUT=1 Q
"RTN","SROCMPED",86,0)
 I "YyNn"'[SRYN W !!,"Enter 'YES' to delete this occurrence from the patient's record.  Enter 'NO'",!,"to backup and enter a category for this occurrence." G DEL
"RTN","SROCMPED",87,0)
 I "Nn"[SRYN G NOCAT
"RTN","SROCMPED",88,0)
YUP ; delete occurrence
"RTN","SROCMPED",89,0)
 K DIK,DA S DA=SRENTRY,DA(1)=SRTN,DIK="^SRF("_SRTN_","_SRTYPE_"," D ^DIK K DIK,DA
"RTN","SROCMPED",90,0)
 Q
"RTN","SROCMPED",91,0)
PRESS W ! K DIR S DIR(0)="E" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SROCMPED",92,0)
 Q
"RTN","SROCMPS")
0^66^B17944214^B17061652
"RTN","SROCMPS",1,0)
SROCMPS ;BIR/MAM - ENTER/EDIT OCCURRENCES ;06/17/04  6:55 AM
"RTN","SROCMPS",2,0)
 ;;3.0;Surgery;**14,32,38,95,102,116,125,142,177**;24 Jun 93;Build 89
"RTN","SROCMPS",3,0)
INTRA S SRTYPE=10,SRTY="INTRAOPERATIVE",SRTYPDD="130.13A"
"RTN","SROCMPS",4,0)
POST I '$D(SRTYPE) S SRTYPE=16,SRTY="POSTOPERATIVE",SRTYPDD="130.22A"
"RTN","SROCMPS",5,0)
 W @IOF,! S SRSOUT=0 I '$D(SRTN) S SRTN1=1 D ^SROPS I '$D(SRTN) S SRSOUT=1 G END
"RTN","SROCMPS",6,0)
 D SRA^SROES
"RTN","SROCMPS",7,0)
 S SRSUPCPT=1 D ^SROAUTL S SRNAME=$P(VADM(1),"^")_"  ("_VA("PID")_")",SRLINE="" F I=0:1:79 S SRLINE=SRLINE_"-"
"RTN","SROCMPS",8,0)
EDIT G:SRSOUT END K SRCOMP S SRNEW=0
"RTN","SROCMPS",9,0)
 I '$O(^SRF(SRTN,SRTYPE,0)) D NEW G:SRSOUT END D ^SROCMPED G EDIT
"RTN","SROCMPS",10,0)
 D HDR^SROAUTL W "Enter/Edit "_$S(SRTYPE=10:"Intraoperative",1:"Postoperative")_" Occurrences",! S (COMP,CNT)=0 F  S COMP=$O(^SRF(SRTN,SRTYPE,COMP)) Q:'COMP  D LIST
"RTN","SROCMPS",11,0)
SEL W !,"Select a number ("_$S(CNT=1:1,1:"1-"_CNT)_"), or type 'NEW' to enter another occurrence: " R X:DTIME I '$T!("^"[X) S SRSOUT=1 G END
"RTN","SROCMPS",12,0)
 K SRENTRY I $E(X)="N"!($E(X)="n") D NEW G:SRSOUT END D ^SROCMPED G EDIT
"RTN","SROCMPS",13,0)
 I '$D(SRCOMP(X)) W !!,"Select the number corresponding to the occurrence you want to update, or",!,"enter 'NEW' to add another occurrence. ",!!,"Press RETURN to continue  " R X:DTIME G EDIT
"RTN","SROCMPS",14,0)
 S:'$D(SRENTRY) SRENTRY=$P(SRCOMP(X),"^",3) D ^SROCMPED G EDIT
"RTN","SROCMPS",15,0)
 Q
"RTN","SROCMPS",16,0)
END D:$D(SRTN) EN^SROCCAT,EXIT^SROES I $D(SRTN1) K SRTN,SRTN1
"RTN","SROCMPS",17,0)
 I 'SRSOUT W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SROCMPS",18,0)
 D:'$D(SROVER) ^SRSKILL W @IOF
"RTN","SROCMPS",19,0)
 Q
"RTN","SROCMPS",20,0)
LIST ; list existing occurrences
"RTN","SROCMPS",21,0)
 S CNT=CNT+1,SRC(0)=^SRF(SRTN,SRTYPE,COMP,0),SRCMP=$P(SRC(0),"^"),SRCAT=$P(SRC(0),"^",2),SRCAT=$S(SRCAT:$P(^SRO(136.5,SRCAT,0),"^"),1:"NOT ENTERED"),SRCOMP(CNT)=SRCMP_"^"_SRCAT_"^"_COMP
"RTN","SROCMPS",22,0)
 W !,CNT_".  ",?5,SRCMP,!,?5,"Category: "_SRCAT,!
"RTN","SROCMPS",23,0)
 Q
"RTN","SROCMPS",24,0)
NEW ; enter new occurrences
"RTN","SROCMPS",25,0)
 D HDR^SROAUTL W ! I '$O(^SRF(SRTN,SRTYPE,0)) W !,"There are no "_$S(SRTYPE=10:"Intraoperative",1:"Postoperative")_" Occurrences entered for this case.",!!
"RTN","SROCMPS",26,0)
 K DIR,X S SRDD=$S(SRTYPE=10:130.13,1:130.22),DIR(0)=SRDD_","_$S(SRTYPE=10:3,1:5)_"O",DIR("A")="Enter a New "_$S(SRTYPE=10:"Intraoperative",1:"Postoperative")_" Occurrence" D ^DIR I $D(DUOUT)!(Y="") S SRSOUT=1 Q
"RTN","SROCMPS",27,0)
 K SRCOM,SRPOINT S SRPOINT=+Y,SRCOM=$P(Y,"^",2),SRNEW=1 D PRESS
"RTN","SROCMPS",28,0)
 ; JAS - 05/02/13 - PATCH 177 - Rewrote filing logic.
"RTN","SROCMPS",29,0)
 I '$D(^SRF(SRTN,SRTYPE,0)) S ^SRF(SRTN,SRTYPE,0)="^"_SRTYPDD_"^^"
"RTN","SROCMPS",30,0)
 K DD,DA,DO,DIC,DINUM S X=SRCOM,DIC(0)="L",DLAYGO=SRDD,DA(1)=SRTN,DIC="^SRF("_SRTN_","_SRTYPE_"," D FILE^DICN S SRENTRY=+Y
"RTN","SROCMPS",31,0)
 N SRDA S SRDA=+Y
"RTN","SROCMPS",32,0)
 S SRICD="" I SRCOM["OTHER" D ICD I SRSOUT Q
"RTN","SROCMPS",33,0)
 S $P(^SRF(SRTN,SRTYPE,SRDA,0),"^",2)=SRPOINT
"RTN","SROCMPS",34,0)
 I $D(SRICD) S $P(^SRF(SRTN,SRTYPE,SRDA,0),"^",3)=SRICD
"RTN","SROCMPS",35,0)
 K SRDA
"RTN","SROCMPS",36,0)
 ; END 177
"RTN","SROCMPS",37,0)
 Q
"RTN","SROCMPS",38,0)
ICD I '$D(SRTN) Q
"RTN","SROCMPS",39,0)
 W !!,"Since you have selected one of the 'OTHER' occurrence categories, an ICD",!,"Diagnosis Code should be entered for this occurrence."
"RTN","SROCMPS",40,0)
 ; JAS - 05/02/13 - PATCH 177 - Replaced DIR call with DIE
"RTN","SROCMPS",41,0)
 N DIE,DA,DR,SRDA
"RTN","SROCMPS",42,0)
 S DA(1)=SRTN,DA=+Y,SRDA=+Y,DIE="^SRF("_SRTN_","_SRTYPE_","
"RTN","SROCMPS",43,0)
 S DR=$S(SRTY="INTRAOPERATIVE":4,1:6)_"Select ICD Diagnosis Code "_$$ICDSTR^SROICD(SRTN) D ^DIE K DR,DA I $D(DUOUT) Q
"RTN","SROCMPS",44,0)
 I +X>0 S SRICD=+X,SRCOM=$P($$ICDC^SROICD(+X),"^",3)
"RTN","SROCMPS",45,0)
 ; End 177
"RTN","SROCMPS",46,0)
 Q
"RTN","SROCMPS",47,0)
DESC ; output occurrence category description when doing lookup
"RTN","SROCMPS",48,0)
 N SRX,SRY,SRZ
"RTN","SROCMPS",49,0)
 S SRX=0,SRY=Y F  S SRX=$O(^SRO(136.5,SRY,1,SRX)) Q:'SRX  S SRZ(SRX)=^SRO(136.5,SRY,1,SRX,0),SRZ(SRX,"F")="!?2"
"RTN","SROCMPS",50,0)
 I $O(SRZ(0)) D EN^DDIOL(.SRZ)
"RTN","SROCMPS",51,0)
 D EN^DDIOL(" ","","!")
"RTN","SROCMPS",52,0)
 Q
"RTN","SROCMPS",53,0)
PRESS K DIR W ! S DIR(0)="FOA",DIR("A")="Press RETURN to continue: " D ^DIR K DIR I $D(DTOUT) S SRSOUT=1
"RTN","SROCMPS",54,0)
 Q
"RTN","SROCMPS",55,0)
CO() ; called by screen on post-op occurrence category field
"RTN","SROCMPS",56,0)
 N SRSCR,SRTYPE,SRX S SRSCR="I '$P(^(0),U,2)" D  Q SRSCR
"RTN","SROCMPS",57,0)
 .S SRX=$S($D(SRTN):SRTN,$D(DA(1)):DA(1),1:"") Q:'SRX
"RTN","SROCMPS",58,0)
 .S SRTYPE=$P($G(^SRF(SRX,"RA")),U,2)
"RTN","SROCMPS",59,0)
 .I SRTYPE'=""&(SRTYPE'="C") S SRSCR=SRSCR_"&($P(^(0),U,4)'="_"""Y"""_")"
"RTN","SROCMPS",60,0)
 Q
"RTN","SROCOMP")
0^31^B18186198^B18025907
"RTN","SROCOMP",1,0)
SROCOMP ;BIR/MAM - VIEW OCCURRENCES ; [ 05/11/04  7:54 AM ]
"RTN","SROCOMP",2,0)
 ;;3.0;Surgery;**37,38,88,129,177**;24 Jun 93;Build 89
"RTN","SROCOMP",3,0)
 S SRSOUT=0 K SRNEWOP D ^SROPS I '$D(SRTN) S SRSOUT=1 G END
"RTN","SROCOMP",4,0)
 S SR(0)=^SRF(SRTN,0),DFN=$P(SR(0),"^") D DEM^VADPT S SRNAME=VADM(1)_" ("_VA("PID")_")"
"RTN","SROCOMP",5,0)
 S Y=$P(SR(0),"^",9) D D^DIQ S SRSDATE=$P(Y,"@")_" "_$P(Y,"@",2)
"RTN","SROCOMP",6,0)
 S SR(.1)=$G(^SRF(SRTN,.1)),SRSUR=$P(SR(.1),"^",4),SRATT=$P(SR(.1),"^",13)
"RTN","SROCOMP",7,0)
 S SRSUR=$S(SRSUR:$P(^VA(200,SRSUR,0),"^"),1:"NOT ENTERED"),SRATT=$S(SRATT:$P(^VA(200,SRATT,0),"^"),1:"NOT ENTERED")
"RTN","SROCOMP",8,0)
 S SRATC="",Y=$P($G(^SRF(SRTN,.1)),"^",10) I Y S C=$P(^DD(130,.166,0),"^",2) D Y^DIQ S SRATC=Y
"RTN","SROCOMP",9,0)
 I SRATC="" S SRATC="ATTENDING CODE NOT ENTERED"
"RTN","SROCOMP",10,0)
 S SROPER=$P(^SRF(SRTN,"OP"),"^"),X=$P(^("OP"),"^",2) I X S CPT=$P($$CPT^ICPTCOD(X),"^",2),Y=CPT D SSPRIN^SROCPT S CPT=Y,SROPER=SROPER_" ("_CPT_")"
"RTN","SROCOMP",11,0)
 K SROPS,MM,MMM S:$L(SROPER)<55 SROPS(1)=SROPER I $L(SROPER)>54 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROCOMP",12,0)
 S X=$P($G(^SRF(SRTN,.2)),"^",12) S DIAG=$S(X:"POST",1:"PRE")
"RTN","SROCOMP",13,0)
 S SRDIAG=$S(DIAG="POST":$P($G(^SRF(SRTN,34)),"^"),1:$P($G(^SRF(SRTN,33)),"^")) I DIAG="POST" S X=$P($G(^SRF(SRTN,34)),"^",2) I X S ICD=$$ICD^SROICD(SRTN,X),SRDIAG=SRDIAG_" ("_$P(ICD,"^",2)_")"
"RTN","SROCOMP",14,0)
 I '$L(SRDIAG) S SRDIAG="NOT ENTERED"
"RTN","SROCOMP",15,0)
 S (CMP,CNT)=0 F  S CMP=$O(^SRF(SRTN,10,CMP)) Q:'CMP  S CNT=CNT+1,INTRA(CNT)=$P(^SRF(SRTN,10,CMP,0),"^")_"^"_$P(^(0),"^",6)
"RTN","SROCOMP",16,0)
 S (CMP,CNT)=0 F  S CMP=$O(^SRF(SRTN,16,CMP)) Q:'CMP  S CNT=CNT+1,POST(CNT)=$P(^SRF(SRTN,16,CMP,0),"^")_"^"_$P(^(0),"^",6)_"^"_$P(^(0),"^",7)
"RTN","SROCOMP",17,0)
 D HDR
"RTN","SROCOMP",18,0)
 W !!,"Date of Operation: ",?21,SRSDATE,!,"Principal Operation: ",?21,SROPS(1) I $D(SROPS(2)) W !,?21,SROPS(2) I $D(SROPS(3)) W !,?21,SROPS(3)
"RTN","SROCOMP",19,0)
 W !!,"Surgeon: ",?19,SRSUR,!,"Attending Surgeon: "_SRATT,!,"Attending Code: ",?16,SRATC
"RTN","SROCOMP",20,0)
 W !!,"Principal "_$S(DIAG="POST":"Postop",1:"Preop")_" Diagnosis: ",?30,SRDIAG
"RTN","SROCOMP",21,0)
 W !!,"Intraoperative Occurrences: " I '$O(INTRA(0)) W "NONE ENTERED"
"RTN","SROCOMP",22,0)
 I $O(INTRA(0)) S CMP=0 F  S CMP=$O(INTRA(CMP)) Q:'CMP!(SRSOUT)  D INTRA
"RTN","SROCOMP",23,0)
 G:SRSOUT END W !!,"Postoperative Occurrences:  " I '$O(POST(0)) W "NONE ENTERED"
"RTN","SROCOMP",24,0)
 I $O(POST(0)) S CMP=0 F  S CMP=$O(POST(CMP)) Q:'CMP!(SRSOUT)  D POST
"RTN","SROCOMP",25,0)
 I SRSOUT G END
"RTN","SROCOMP",26,0)
 K SRRET S (RET,CNT)=0 F  S RET=$O(^SRF(SRTN,29,RET)) Q:'RET  S X=^SRF(SRTN,29,RET,0),Y=$P(X,"^",3) I Y="R" S CNT=CNT+1,SRRET(CNT)=$P(X,"^")
"RTN","SROCOMP",27,0)
 I $O(SRRET(0)) D RET W !!,"Related Returns to Surgery: " S RET=0 F  S RET=$O(SRRET(RET)) Q:'RET!(SRSOUT)  D RELATE
"RTN","SROCOMP",28,0)
END I 'SRSOUT W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SROCOMP",29,0)
 D ^SRSKILL K SRTN W @IOF
"RTN","SROCOMP",30,0)
 Q
"RTN","SROCOMP",31,0)
LOOP ; break procedure if greater than 55 characters
"RTN","SROCOMP",32,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<55  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROCOMP",33,0)
 Q
"RTN","SROCOMP",34,0)
RET W !!,"Press RETURN to continue, or '^' to quit: " R X:DTIME I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROCOMP",35,0)
 I X["?" W !!,"Press RETURN to list more information, or '^' to leave this option." G RET
"RTN","SROCOMP",36,0)
HDR W @IOF,!,SRNAME,?50,"OCCURRENCES",! F LINE=1:1:80 W "-"
"RTN","SROCOMP",37,0)
 Q
"RTN","SROCOMP",38,0)
INTRA ; intraop occurrences
"RTN","SROCOMP",39,0)
 I $Y+4>IOSL D RET I SRSOUT Q
"RTN","SROCOMP",40,0)
 W:CMP>1 ! W ?30,$P(INTRA(CMP),"^") S OUT=$P(INTRA(CMP),"^",2),OUT=$S(OUT="I":"IMPROVED",OUT="W":"WORSE",OUT="D":"DEATH",OUT="U":"UNRESOLVED",1:"NOT ENTERED") W !,?30,"Outcome: "_OUT
"RTN","SROCOMP",41,0)
 Q
"RTN","SROCOMP",42,0)
POST ; postop occurrences
"RTN","SROCOMP",43,0)
 I $Y+4>IOSL D RET I SRSOUT Q
"RTN","SROCOMP",44,0)
 W:CMP>1 ! W ?30,$P(POST(CMP),"^") S D=$P(POST(CMP),"^",3) I D S D=" ("_$E(D,4,5)_"/"_$E(D,6,7)_"/"_$E(D,2,3)_")" W D
"RTN","SROCOMP",45,0)
 S OUT=$P(POST(CMP),"^",2),OUT=$S(OUT="I":"IMPROVED",OUT="W":"WORSE",OUT="D":"DEATH",OUT="U":"UNRESOLVED",1:"NOT ENTERED") W !,?30,"Outcome: "_OUT
"RTN","SROCOMP",46,0)
 Q
"RTN","SROCOMP",47,0)
RELATE ; print related returns
"RTN","SROCOMP",48,0)
 I $Y+4>IOSL D RET I SRSOUT Q
"RTN","SROCOMP",49,0)
 S Y=$P(^SRF(SRRET(RET),0),"^",9),SRSDATE=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3),SROPER=$P(^SRF(SRRET(RET),"OP"),"^")
"RTN","SROCOMP",50,0)
 K SROPS,MM,MMM S:$L(SROPER)<55 SROPS(1)=SROPER I $L(SROPER)>54 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROCOMP",51,0)
 W !,SRSDATE,?10,SROPS(1) I $D(SROPS(2)) W !,?10,SROPS(2) I $D(SROPS(3)) W !,?10,SROPS(3)
"RTN","SROCOMP",52,0)
 W !
"RTN","SROCOMP",53,0)
 Q
"RTN","SROCVER")
0^24^B37320749^B31713915
"RTN","SROCVER",1,0)
SROCVER ;BIR/SJA - CODE SET VERSIONING UTILITY ;16 Oct 2013  3:23 PM
"RTN","SROCVER",2,0)
 ;;3.0;Surgery;**116,177**;24 Jun 93;Build 89
"RTN","SROCVER",3,0)
 ;
"RTN","SROCVER",4,0)
 ;Reference to $$CPT^ICPTCOD supported by DBIA #1995
"RTN","SROCVER",5,0)
 ;Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SROCVER",6,0)
 ;Reference to $$CODEC^ICDEX supported by DBIA #5747
"RTN","SROCVER",7,0)
 ;
"RTN","SROCVER",8,0)
VALIDAT N ATTD,SRBB,SRCC,DLN,SRII,SRJJ,SLN,OCOD,SRAA,SRCODE,SRDATE,SRMOD,SRND0,SRND1,SRND34,SRNON,SRJ,SROP,SRPD,SRT,SRY,SRX,SRX1,SRYY,XMY,Y
"RTN","SROCVER",9,0)
 K ^TMP("SRCVER",$J) S $P(DLN,"-",78)=""
"RTN","SROCVER",10,0)
 S SRTN=$S($D(SRTN):SRTN,1:DA),SRND0=$G(^SRF(SRTN,0)),SROP=$G(^SRF(SRTN,"OP")),SRND1=$G(^SRF(SRTN,.1)),SRNON=$G(^SRF(SRTN,"NON"))
"RTN","SROCVER",11,0)
 S SRPD=$S($D(^SRF(SRTN,"NON")):$P(SRNON,"^",6),1:$P(SRND1,"^",4)),ATTD=$S($D(^SRF(SRTN,"NON")):$P(SRNON,"^",7),1:$P(SRND1,"^",13)),SRND34=$G(^SRF(SRTN,34))
"RTN","SROCVER",12,0)
 S SRDATE=$S($P(SRND0,"^",9):$P(SRND0,"^",9),1:DT)
"RTN","SROCVER",13,0)
 ;
"RTN","SROCVER",14,0)
 S SRCODE=$P(SROP,"^",2) I SRCODE S SRT=$$CPT^ICPTCOD(SRCODE,SRDATE) I $P(SRT,"^",7)=0 S ^TMP("SRCVER",$J,"1;!;PRINCIPAL CPT CODE",$P(SRT,"^",2))=SRCODE D
"RTN","SROCVER",15,0)
 .S (SRJJ,SRII)=0 F  S SRII=$O(^SRF(SRTN,"OPMOD",SRII)) Q:'SRII  S SRMOD="" S (Y,SRT)=$P($G(^SRF(SRTN,"OPMOD",SRII,0)),"^") D DISPLAY^SROMOD S SRMOD=$S($G(SRMOD):SRMOD_","_Y,1:Y) D
"RTN","SROCVER",16,0)
 ..S ^TMP("SRCVER",$J,"1_1;; CPT MODIFIER",SRMOD)=SRT_"^"_SRII
"RTN","SROCVER",17,0)
 ;
"RTN","SROCVER",18,0)
 S (SRT,SRAA)=0 F  S SRAA=$O(^SRF(SRTN,13,SRAA)) Q:'SRAA  S OCOD=+$G(^(SRAA,2)) I OCOD S SRT=$$CPT^ICPTCOD(OCOD,SRDATE) I $P(SRT,"^",7)=0 S ^TMP("SRCVER",$J,"2;!;OTHER PROCEDURE CPT CODE",$P(SRT,"^",2))=OCOD_"^"_SRAA D
"RTN","SROCVER",19,0)
 .S SRBB=0 F  S SRBB=$O(^SRF(SRTN,13,SRAA,"MOD",SRBB)) Q:'SRBB  S SRMOD="" S (SRT,Y)=$P($G(^SRF(SRTN,13,SRAA,"MOD",SRBB,0)),"^") D DISPLAY^SROMOD S SRMOD=$S($G(SRMOD):SRMOD_","_Y,1:Y) D
"RTN","SROCVER",20,0)
 ..S ^TMP("SRCVER",$J,"2_1;; CPT MODIFIER",SRMOD)=$P(SRT,"^")_"^"_SRAA
"RTN","SROCVER",21,0)
 ;
"RTN","SROCVER",22,0)
 ; RBD - 10/15/13 - PATCH 177 - Logic expanded to include ICD-10
"RTN","SROCVER",23,0)
 I $P(SRND34,"^",3)'="" S SRT=$$ICD^SROICD(SRTN,$P(SRND34,"^",3)) I +$P(SRT,"^",10)=0 S ^TMP("SRCVER",$J,"3;!;PRIN DIAGNOSIS CODE",$$CODEC^ICDEX(80,$P(SRND34,"^",3)))=$P(SRND34,"^",3)
"RTN","SROCVER",24,0)
 ;
"RTN","SROCVER",25,0)
 S SRAA=0 F  S SRAA=$O(^SRF(SRTN,14,SRAA)) Q:'SRAA  S OCOD=$P(^SRF(SRTN,14,SRAA,0),"^",3) I OCOD S SRT=$$ICD^SROICD(SRTN,OCOD) I +$P(SRT,"^",10)=0 S ^TMP("SRCVER",$J,"4;!;OTHER PREOP DIAGNOSIS",$$CODEC^ICDEX(80,OCOD))=OCOD_"^"_SRAA
"RTN","SROCVER",26,0)
 ; End 177
"RTN","SROCVER",27,0)
 ;
"RTN","SROCVER",28,0)
DISP Q:'$D(^TMP("SRCVER",$J))
"RTN","SROCVER",29,0)
 W !!,DLN
"RTN","SROCVER",30,0)
 D EN^DDIOL("The following codes are no longer active and will be deleted for case #:"_SRTN,,"!")
"RTN","SROCVER",31,0)
 S SRAA="" F  S SRAA=$O(^TMP("SRCVER",$J,SRAA)) Q:SRAA=""  W:SRAA["!" ! S (SRBB,SRCC)="" F  S SRBB=$O(^TMP("SRCVER",$J,SRAA,SRBB)) Q:SRBB=""  S SRCC=SRCC+1 D
"RTN","SROCVER",32,0)
 .; RBD - 10/15/13 - PATCH 177 - Display Code Set Version also
"RTN","SROCVER",33,0)
 .W:SRCC=1 !,?10,$P(SRAA,";",3)_$S($P(SRAA,";",3)["DIAGNOSIS":" "_SRICDV,1:"")_": ",?40,SRBB W:SRCC>1 !,?40,SRBB
"RTN","SROCVER",34,0)
 D EN^DDIOL("New active codes must be re-entered. A MailMan message will be sent to",,"!!")
"RTN","SROCVER",35,0)
 D EN^DDIOL("the "_$S(SRNON'="":"provider and attending provider",1:"surgeon and attending surgeon")_" of record and to the user who edited",,"!")
"RTN","SROCVER",36,0)
 D EN^DDIOL("the record with case details for follow-up.",,"!")
"RTN","SROCVER",37,0)
 W !!,DLN
"RTN","SROCVER",38,0)
 W !!,"Press RETURN to continue  " R SRX:DTIME
"RTN","SROCVER",39,0)
 D SENDMSG
"RTN","SROCVER",40,0)
 Q
"RTN","SROCVER",41,0)
SENDMSG ;Send mail message when check is complete.
"RTN","SROCVER",42,0)
 Q:'$D(^TMP("SRCVER",$J))
"RTN","SROCVER",43,0)
 ; RBD - 10/15/13 - PATCH 177 - Logic expanded to include ICD-10
"RTN","SROCVER",44,0)
 K SR,XMY S XMDUZ="SURGERY PACKAGE",XMSUB="ICD"_$S($$ICD910^SROICD(SRTN)["10":"-9",1:"")_" OR CPT CODE DELETION",XMY(DUZ)="",SLN=0 D NOW^%DTC S Y=% X ^DD("DD")
"RTN","SROCVER",45,0)
 ; End 177
"RTN","SROCVER",46,0)
 F SRJJ=SRPD,ATTD,DUZ S:$G(SRJJ) XMY(SRJJ)=""
"RTN","SROCVER",47,0)
 S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT
"RTN","SROCVER",48,0)
 S SR(1)="Patient: "_$E(VADM(1),1,20)_$J("",30-$L(VADM(1)))_" Case #: "_SRTN
"RTN","SROCVER",49,0)
 S Y=SRDATE D DD^%DT
"RTN","SROCVER",50,0)
 S SR(2)=$S(SRNON'="":"Procedure Date: ",1:"Operation Date: ")_Y_"      "_$P(SROP,"^"),SR(3)=""
"RTN","SROCVER",51,0)
 S SR(5)="The following codes are no longer active and were deleted for this"
"RTN","SROCVER",52,0)
 S SR(6)="case when the "_$S(SRNON'="":"Time Procedure Began",1:"Time Patient in OR")_" was entered."
"RTN","SROCVER",53,0)
 S SR(7)="",SLN=8
"RTN","SROCVER",54,0)
 S SRX=$J("",8),SRX1=$J("",40)
"RTN","SROCVER",55,0)
 ;
"RTN","SROCVER",56,0)
PCPT S SRAA=0,SRAA=$O(^TMP("SRCVER",$J,"1;!;PRINCIPAL CPT CODE",SRAA)) I SRAA S SR(SLN)=SRX_"PRINCIPAL CPT CODE:         "_SRAA D
"RTN","SROCVER",57,0)
 .K SRY S SRY(130,SRTN_",",27)="@" D FILE^DIE("","SRY")
"RTN","SROCVER",58,0)
 .S SRMOD="",SRJJ=0 F  S SRMOD=$O(^TMP("SRCVER",$J,"1_1;; CPT MODIFIER",SRMOD)) Q:SRMOD=""  D
"RTN","SROCVER",59,0)
 ..S SRJJ=SRJJ+1,SLN=SLN+1 S:SRJJ=1 SR(SLN)=SRX_" CPT MODIFIER:"_$J("",14)_SRMOD S:SRJJ>1 SR(SLN)=$J("",36)_SRMOD
"RTN","SROCVER",60,0)
 ..K SRY S SRY(130,SRTN_",",28)="@" D FILE^DIE("","SRY")
"RTN","SROCVER",61,0)
 S SLN=SLN+1,SR(SLN)=""
"RTN","SROCVER",62,0)
 ;
"RTN","SROCVER",63,0)
OCPT S SRAA=0,SLN=SLN+1 F  S SRAA=$O(^TMP("SRCVER",$J,"2;!;OTHER PROCEDURE CPT CODE",SRAA)) Q:'SRAA  S SR(SLN)=SRX_"OTHER PROCEDURE CPT CODE:   "_SRAA,SRJ=$P($G(^(SRAA)),"^",2) D
"RTN","SROCVER",64,0)
 .K SRY S SRY(130.16,SRJ_","_SRTN_",",3)="@" D FILE^DIE("","SRY")
"RTN","SROCVER",65,0)
 .S SRMOD="",SRJJ=0 F  S SRMOD=$O(^TMP("SRCVER",$J,"2_1;; CPT MODIFIER",SRMOD)) Q:SRMOD=""  S SRJ=$G(^(SRMOD)) D
"RTN","SROCVER",66,0)
 ..S SRJJ=SRJJ+1,SLN=SLN+1 S:SRJJ=1 SR(SLN)=SRX_" CPT MODIFIER:"_$J("",14)_SRMOD S:SRJJ>1 SR(SLN)=$J("",36)_SRMOD
"RTN","SROCVER",67,0)
 ..K SRY S SRY(130.16,SRJ_","_SRTN_",",4)="@" D FILE^DIE("","SRY")
"RTN","SROCVER",68,0)
 ;
"RTN","SROCVER",69,0)
PD ; RBD - 10/15/13 - PATCH 177 - Expanded to include ICD-10
"RTN","SROCVER",70,0)
 S SRAA=0,SLN=SLN+1,SRAA=$O(^TMP("SRCVER",$J,"3;!;PRIN DIAGNOSIS CODE",SRAA)) I SRAA'="" S SR(SLN)=SRX_"PRIN DIAGNOSIS CODE "_SRICDV_":"_SRX_SRAA K SRY S SRY(130,SRTN_",",32.5)="@" D FILE^DIE("","SRY") D
"RTN","SROCVER",71,0)
 .I +$P($$ICD^SROICD(SRTN,$P(SRND34,"^",2)),"^",10)=0 D
"RTN","SROCVER",72,0)
 ..K SRY S SRY(130,SRTN_",",66)="@" D FILE^DIE("","SRY")
"RTN","SROCVER",73,0)
 ;
"RTN","SROCVER",74,0)
OPD S (SRJJ,SRAA)=0 F  S SRAA=$O(^TMP("SRCVER",$J,"4;!;OTHER PREOP DIAGNOSIS",SRAA)) Q:SRAA=""  S SLN=SLN+1,SRJJ=SRJJ+1 S SRYY=$P($G(^(SRAA)),"^",2) D
"RTN","SROCVER",75,0)
 .S:SRJJ=1 SR(SLN)=SRX_"OTHER PREOP DIAGNOSIS "_SRICDV_":"_$J("",6)_SRAA S:SRJJ>1 SR(SLN)=$J("",36)_SRAA
"RTN","SROCVER",76,0)
 .K SRY S SRY(130.17,SRYY_","_SRTN_",",3)="@" D FILE^DIE("","SRY")
"RTN","SROCVER",77,0)
 ; End 177
"RTN","SROCVER",78,0)
 S (SR(SLN+1),SR(SLN+2))=""
"RTN","SROCVER",79,0)
 S SR(SLN+3)="New active codes must be re-entered."
"RTN","SROCVER",80,0)
 S XMTEXT="SR(" D ^XMD
"RTN","SROCVER",81,0)
 ; RBD - 10/15/13 - PATCH 177 - Date change so re-acquire Code Set Version
"RTN","SROCVER",82,0)
 S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SROCVER",83,0)
 ; End 177
"RTN","SROCVER",84,0)
 ;
"RTN","SROCVER",85,0)
CFLS ;This line of code to update Surgery-CoreFLS changes
"RTN","SROCVER",86,0)
 Q:'$D(^TMP("CSLSUR1",$J))
"RTN","SROCVER",87,0)
 S SRSITE=$S($D(SRSITE):SRSITE,1:$$SITE^SROUTL0(SRTN))
"RTN","SROCVER",88,0)
 ;JAS - 11/07/14 - PATCH 177 - Added code to preserve Fileman variables since ^SROERR0 was intermittently killing them
"RTN","SROCVER",89,0)
 N SRFMTMP
"RTN","SROCVER",90,0)
 S SRFMTMP("DC")=DC,SRFMTMP("DL")=DL,SRFMTMP("DP")=DP,SRFMTMP("DA")=DA,SRFMTMP("DR")=DR
"RTN","SROCVER",91,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SROCVER",92,0)
 I $G(DC)="" S DC=SRFMTMP("DC")
"RTN","SROCVER",93,0)
 I $G(DL)="" S DL=SRFMTMP("DL")
"RTN","SROCVER",94,0)
 I $G(DP)="" S DP=SRFMTMP("DP")
"RTN","SROCVER",95,0)
 I $G(DA)="" S DA=SRFMTMP("DA")
"RTN","SROCVER",96,0)
 I $G(DR)="" S DR=SRFMTMP("DR")
"RTN","SROCVER",97,0)
 K SRFMTMP
"RTN","SROCVER",98,0)
 ;END 177
"RTN","SROCVER",99,0)
 Q
"RTN","SROESAD1")
0^25^B34060780^B34222417
"RTN","SROESAD1",1,0)
SROESAD1 ;BIR/ADM - SURGERY E-SIG UTILITY ; [ 04/16/01  1:03 PM ]
"RTN","SROESAD1",2,0)
 ;;3.0;Surgery;**100,127,177**;24 Jun 93;Build 89
"RTN","SROESAD1",3,0)
 ;
"RTN","SROESAD1",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESAD1",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESAD1",6,0)
 ;**         are prohibited.
"RTN","SROESAD1",7,0)
 ;
"RTN","SROESAD1",8,0)
 N SRALN,SRE,SRE1,SRFILE,SRFLD,SRG,SRI,SRJ,SRLN,SRMULT,SRNM,SRNUM,SRPF,SRPRE,SRS,SRSUB,SRTITLE,SRVAL,SRVAL1,SRVAL2,SRX,SRY,X
"RTN","SROESAD1",9,0)
 F SRJ="SRADDEND","SRAD1","SRAD2","SRADM1","SRADM2" K ^TMP(SRJ,$J,SRTN)
"RTN","SROESAD1",10,0)
 S SRI=0,SRG=$NA(^TMP("SRADDEND",$J,SRTN)) K @SRG
"RTN","SROESAD1",11,0)
 D GET^SROESAD
"RTN","SROESAD1",12,0)
SING ; single fields
"RTN","SROESAD1",13,0)
 S SRFLD="" F  S SRFLD=$O(^TMP("SRAD1",$J,SRTN,130,SRFLD)) Q:SRFLD=""  D
"RTN","SROESAD1",14,0)
 .S SRTITLE=$P(SRFLD,"-"),X=$P(SRFLD,"-",2),SRFILE=$P(X,","),SRNUM=$P(X,",",2) I SRNUM[";W" D WPS Q
"RTN","SROESAD1",15,0)
 .S SRVAL1="<NOT ENTERED>",SRY=$G(^TMP("SRAD1",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESAD1",16,0)
 .S SRVAL2="<DELETED>",SRY=$G(^TMP("SRAD2",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESAD1",17,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)="  from "_SRVAL1 D LINE(1) S @SRG@(SRI)="    to "_SRVAL2
"RTN","SROESAD1",18,0)
MULT ; multiples
"RTN","SROESAD1",19,0)
 S SRMULT="" F  S SRMULT=$O(^TMP("SRADM1",$J,SRTN,SRMULT)) Q:SRMULT=""  D
"RTN","SROESAD1",20,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRMULT_" subfile was changed as follows:"
"RTN","SROESAD1",21,0)
 .S SRE=0 F  S SRE=$O(^TMP("SRADM1",$J,SRTN,SRMULT,SRE)) Q:'SRE  D
"RTN","SROESAD1",22,0)
 ..S SRE1="",SRJ=2,SRPF=0 F  S SRE1=$O(^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  D  Q:SRE1=""
"RTN","SROESAD1",23,0)
 ...S SRFLD="" F  S SRFLD=$O(^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D PROC Q:SRFLD=""
"RTN","SROESAD1",24,0)
 Q
"RTN","SROESAD1",25,0)
WPS ; word-processing fields
"RTN","SROESAD1",26,0)
 D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=" >> from original "_SRTITLE_" text:"
"RTN","SROESAD1",27,0)
 I '$O(^TMP("SRAD1",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>"
"RTN","SROESAD1",28,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRAD1",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRAD1",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESAD1",29,0)
WPS2 D LINE(1) S @SRG@(SRI)=" >> to updated "_SRTITLE_" text:" I '$O(^TMP("SRAD2",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>"
"RTN","SROESAD1",30,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRAD2",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRAD2",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESAD1",31,0)
 Q
"RTN","SROESAD1",32,0)
EXT ; get external value
"RTN","SROESAD1",33,0)
 S SRX=$$EXTERNAL^DILFD(SRFILE,SRNUM,"",SRY)
"RTN","SROESAD1",34,0)
 I SRFILE=130 D  Q
"RTN","SROESAD1",35,0)
 .I SRNUM=27,SRX'="" S SRX=$E(SRX,1,5) D CPT Q
"RTN","SROESAD1",36,0)
 .I SRNUM=66 D DIAG
"RTN","SROESAD1",37,0)
 I SRFILE=130.16,SRNUM=3,SRX'="" S SRX=$E(SRX,1,5) D CPT Q
"RTN","SROESAD1",38,0)
 I SRFILE=130.18,SRNUM=3 D DIAG
"RTN","SROESAD1",39,0)
 Q
"RTN","SROESAD1",40,0)
DIAG S SRY=$$ICD^SROICD(SRTN,SRY),SRX=SRX_"  "_$P(SRY,"^",4)
"RTN","SROESAD1",41,0)
 Q
"RTN","SROESAD1",42,0)
CPT S X=$$CPT^ICPTCOD(SRX,$P($G(^SRF(SRTN,0)),"^",9)),SRX=SRX_"  "_$P(X,"^",3)
"RTN","SROESAD1",43,0)
 Q
"RTN","SROESAD1",44,0)
PROC S SRTITLE=$P(SRFLD,"-",2),X=$P(SRFLD,"-",3),SRFILE=$P(X,","),SRNUM=$P(X,",",2),SRJ=$P(SRFLD,"-",4) I SRNUM[";W" D WPM Q
"RTN","SROESAD1",45,0)
 S SRVAL1="",SRY=$G(^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESAD1",46,0)
 S SRVAL2="",SRY=$G(^TMP("SRADM2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESAD1",47,0)
 I $P(SRFLD,"-")="01",SRVAL1=""!(SRVAL2="") D FP01 Q
"RTN","SROESAD1",48,0)
 I 'SRPF,$P(SRNUM,";")=.01,SRVAL1=""!(SRVAL2="") D FP01S Q
"RTN","SROESAD1",49,0)
 I SRPF D FPX Q
"RTN","SROESAD1",50,0)
 S:SRVAL1="" SRVAL1="<NOT ENTERED>" S:SRVAL2="" SRVAL2="<DELETED>"
"RTN","SROESAD1",51,0)
 I SRVAL2=SRVAL1 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" entry "_SRVAL1_" was changed:" Q
"RTN","SROESAD1",52,0)
 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"  from "_SRVAL1 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"    to "_SRVAL2
"RTN","SROESAD1",53,0)
 Q
"RTN","SROESAD1",54,0)
FP01S ; add or delete subfile entry
"RTN","SROESAD1",55,0)
 I SRVAL1="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESAD1",56,0)
 I SRVAL2="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESAD1",57,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESAD1",58,0)
 Q
"RTN","SROESAD1",59,0)
FP01 ; add or delete
"RTN","SROESAD1",60,0)
 I SRVAL1="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESAD1",61,0)
 I SRVAL2="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESAD1",62,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESAD1",63,0)
 Q
"RTN","SROESAD1",64,0)
FPX S SRJ=SRJ+2 I SRNUM[";W" D WPM
"RTN","SROESAD1",65,0)
 S SRVAL="",SRY=$G(^TMP("SRADM"_SRNM,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL=SRX
"RTN","SROESAD1",66,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_": "_SRVAL
"RTN","SROESAD1",67,0)
 Q
"RTN","SROESAD1",68,0)
FWPM ; word-processing in multiples in added or deleted entries
"RTN","SROESAD1",69,0)
 I '$O(^TMP("SRAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=2
"RTN","SROESAD1",70,0)
 I '$O(^TMP("SRAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=1
"RTN","SROESAD1",71,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_":" S SRLN=0
"RTN","SROESAD1",72,0)
 F  S SRLN=$O(^TMP("SRADM"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRADM"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_X
"RTN","SROESAD1",73,0)
 Q
"RTN","SROESAD1",74,0)
WPM ; word-processing in multiples
"RTN","SROESAD1",75,0)
 I SRPF S SRJ=SRJ+2 D FWPM Q
"RTN","SROESAD1",76,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> from original "_SRTITLE_" text:"
"RTN","SROESAD1",77,0)
 I '$O(^TMP("SRAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>" D WPM2 Q
"RTN","SROESAD1",78,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRADM1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESAD1",79,0)
WPM2 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> to updated "_SRTITLE_" text:" I '$O(^TMP("SRAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>" Q
"RTN","SROESAD1",80,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRADM2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRADM2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESAD1",81,0)
 Q
"RTN","SROESAD1",82,0)
SPACE(NUM) ; create spaces
"RTN","SROESAD1",83,0)
 ; pass in position, returns number of needed spaces
"RTN","SROESAD1",84,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SROESAD1",85,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SROESAD1",86,0)
 Q
"RTN","SROESAD1",87,0)
LINE(NUM) ; create carriage returns
"RTN","SROESAD1",88,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SROESAD1",89,0)
 Q
"RTN","SROESNR2")
0^26^B33988113^B34159372
"RTN","SROESNR2",1,0)
SROESNR2 ;BIR/ADM - NURSE REPORT E-SIG UTILITY ; [ 03/21/01  6:36 AM
"RTN","SROESNR2",2,0)
 ;;3.0;Surgery;**100,127,177**;24 Jun 93;Build 89
"RTN","SROESNR2",3,0)
 ;
"RTN","SROESNR2",4,0)
 ;** NOTICE: This routine is part of an implementation of a nationally
"RTN","SROESNR2",5,0)
 ;**         controlled procedure.  Local modifications to this routine
"RTN","SROESNR2",6,0)
 ;**         are prohibited.
"RTN","SROESNR2",7,0)
 ;
"RTN","SROESNR2",8,0)
 N SRALN,SRE,SRE1,SRFILE,SRFLD,SRG,SRI,SRJ,SRLN,SRMULT,SRNM,SRNUM,SRPF,SRS,SRTITLE,SRVAL,SRVAL1,SRVAL2,SRX,SRY,X
"RTN","SROESNR2",9,0)
 S SRI=0,SRG=$NA(^TMP("SRNR",$J,SRTN)) K @SRG
"RTN","SROESNR2",10,0)
SING ; single fields
"RTN","SROESNR2",11,0)
 S SRFLD="" F  S SRFLD=$O(^TMP("SRNRAD1",$J,SRTN,130,SRFLD)) Q:SRFLD=""  D
"RTN","SROESNR2",12,0)
 .S SRTITLE=$P(SRFLD,"-"),X=$P(SRFLD,"-",2),SRFILE=$P(X,","),SRNUM=$P(X,",",2) I SRNUM[";W" D WPS Q
"RTN","SROESNR2",13,0)
 .S SRVAL1="<NOT ENTERED>",SRY=$G(^TMP("SRNRAD1",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESNR2",14,0)
 .S SRVAL2="<DELETED>",SRY=$G(^TMP("SRNRAD2",$J,SRTN,130,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESNR2",15,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)="  from "_SRVAL1 D LINE(1) S @SRG@(SRI)="    to "_SRVAL2
"RTN","SROESNR2",16,0)
MULT ; multiples
"RTN","SROESNR2",17,0)
 S SRMULT="" F  S SRMULT=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT)) Q:SRMULT=""  D
"RTN","SROESNR2",18,0)
 .D LINE(2) S @SRG@(SRI)="The "_SRMULT_" subfile was changed as follows:"
"RTN","SROESNR2",19,0)
 .S SRE=0 F  S SRE=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE)) Q:'SRE  D
"RTN","SROESNR2",20,0)
 ..S SRE1="",SRJ=2,SRPF=0 F  S SRE1=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1)) Q:SRE1=""  D  Q:SRE1=""
"RTN","SROESNR2",21,0)
 ...S SRFLD="" F  S SRFLD=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) Q:SRFLD=""  D PROC Q:SRFLD=""
"RTN","SROESNR2",22,0)
 Q
"RTN","SROESNR2",23,0)
WPS ; word-processing fields
"RTN","SROESNR2",24,0)
 D LINE(2) S @SRG@(SRI)="The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=" >> from original "_SRTITLE_" text:"
"RTN","SROESNR2",25,0)
 I '$O(^TMP("SRNRAD1",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>"
"RTN","SROESNR2",26,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRNRAD1",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRAD1",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESNR2",27,0)
WPS2 D LINE(1) S @SRG@(SRI)=" >> to updated "_SRTITLE_" text:" I '$O(^TMP("SRNRAD2",$J,SRTN,130,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>"
"RTN","SROESNR2",28,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRNRAD2",$J,SRTN,130,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRAD2",$J,SRTN,130,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)="    "_X
"RTN","SROESNR2",29,0)
 Q
"RTN","SROESNR2",30,0)
EXT ; get external value
"RTN","SROESNR2",31,0)
 S SRX=$$EXTERNAL^DILFD(SRFILE,SRNUM,"",SRY)
"RTN","SROESNR2",32,0)
 I SRFILE=130 D  Q
"RTN","SROESNR2",33,0)
 .I SRNUM=27,SRX'="" S SRX=$E(SRX,1,5) D CPT Q
"RTN","SROESNR2",34,0)
 .I SRNUM=66 D DIAG
"RTN","SROESNR2",35,0)
 I SRFILE=130.16,SRNUM=3,SRX'="" S SRX=$E(SRX,1,5) D CPT Q
"RTN","SROESNR2",36,0)
 I SRFILE=130.18,SRNUM=3 D DIAG
"RTN","SROESNR2",37,0)
 Q
"RTN","SROESNR2",38,0)
DIAG S SRY=$$ICD^SROICD(SRTN,SRY) S SRX=SRX_"  "_$P(SRY,"^",4) K SRY
"RTN","SROESNR2",39,0)
 Q
"RTN","SROESNR2",40,0)
CPT S X=$$CPT^ICPTCOD(SRX,$P($G(^SRF(SRTN,0)),"^",9)),SRX=SRX_"  "_$P(X,"^",3)
"RTN","SROESNR2",41,0)
 Q
"RTN","SROESNR2",42,0)
PROC S SRTITLE=$P(SRFLD,"-",2),X=$P(SRFLD,"-",3),SRFILE=$P(X,","),SRNUM=$P(X,",",2),SRJ=$P(SRFLD,"-",4) I SRNUM[";W" D WPM Q
"RTN","SROESNR2",43,0)
 S SRVAL1="",SRY=$G(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL1=SRX
"RTN","SROESNR2",44,0)
 S SRVAL2="",SRY=$G(^TMP("SRNRMULT2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL2=SRX
"RTN","SROESNR2",45,0)
 I $P(SRFLD,"-")="01",SRVAL1=""!(SRVAL2="") D FP01 Q
"RTN","SROESNR2",46,0)
 I 'SRPF,$P(SRNUM,";")=.01,SRVAL1=""!(SRVAL2="") D FP01S Q
"RTN","SROESNR2",47,0)
 I SRPF D FPX Q
"RTN","SROESNR2",48,0)
 S:SRVAL1="" SRVAL1="<NOT ENTERED>" S:SRVAL2="" SRVAL2="<DELETED>"
"RTN","SROESNR2",49,0)
 I SRVAL2=SRVAL1 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" entry "_SRVAL1_" was changed:" Q
"RTN","SROESNR2",50,0)
 D:$P(SRFLD,"-")="01" LINE(1) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"  from "_SRVAL1 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"    to "_SRVAL2
"RTN","SROESNR2",51,0)
 Q
"RTN","SROESNR2",52,0)
FP01S ; add or delete subfile entry
"RTN","SROESNR2",53,0)
 I SRVAL1="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESNR2",54,0)
 I SRVAL2="" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESNR2",55,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESNR2",56,0)
 Q
"RTN","SROESNR2",57,0)
FP01 ; add or delete
"RTN","SROESNR2",58,0)
 I SRVAL1="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was ADDED:" S SRNM=2
"RTN","SROESNR2",59,0)
 I SRVAL2="" D LINE(2) S @SRG@(SRI)=$$SPACE(SRJ)_"The following "_SRTITLE_" was DELETED:" S SRNM=1
"RTN","SROESNR2",60,0)
 S SRPF=1,SRVAL=$S(SRNM=1:SRVAL1,1:SRVAL2) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_SRTITLE_": "_SRVAL
"RTN","SROESNR2",61,0)
 Q
"RTN","SROESNR2",62,0)
FPX S SRJ=SRJ+2 I SRNUM[";W" D WPM
"RTN","SROESNR2",63,0)
 S SRVAL="",SRY=$G(^TMP("SRNRMULT"_SRNM,$J,SRTN,SRMULT,SRE,SRE1,SRFLD)) I SRY'="" D EXT S SRVAL=SRX
"RTN","SROESNR2",64,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_": "_SRVAL
"RTN","SROESNR2",65,0)
 Q
"RTN","SROESNR2",66,0)
FWPM ; word-processing in multiples in added or deleted entries
"RTN","SROESNR2",67,0)
 I '$O(^TMP("SRNRAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=2
"RTN","SROESNR2",68,0)
 I '$O(^TMP("SRNRAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S SRS=1
"RTN","SROESNR2",69,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_SRTITLE_":" S SRLN=0
"RTN","SROESNR2",70,0)
 F  S SRLN=$O(^TMP("SRNRMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRMULT"_SRS,$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_X
"RTN","SROESNR2",71,0)
 Q
"RTN","SROESNR2",72,0)
WPM ; word-processing in multiples
"RTN","SROESNR2",73,0)
 I SRPF S SRJ=SRJ+2 D FWPM Q
"RTN","SROESNR2",74,0)
 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ)_"The "_SRTITLE_" field was changed" D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> from original "_SRTITLE_" text:"
"RTN","SROESNR2",75,0)
 I '$O(^TMP("SRNRAD1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <NO TEXT ENTERED>" D WPM2 Q
"RTN","SROESNR2",76,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRMULT1",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESNR2",77,0)
WPM2 D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_">> to updated "_SRTITLE_" text:" I '$O(^TMP("SRNRAD2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,0)) S @SRG@(SRI)=@SRG@(SRI)_" <TEXT DELETED>" Q
"RTN","SROESNR2",78,0)
 S SRLN=0 F  S SRLN=$O(^TMP("SRNRMULT2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN)) Q:'SRLN  S X=^TMP("SRNRMULT2",$J,SRTN,SRMULT,SRE,SRE1,SRFLD,SRLN) D LINE(1) S @SRG@(SRI)=$$SPACE(SRJ+2)_X
"RTN","SROESNR2",79,0)
 Q
"RTN","SROESNR2",80,0)
SPACE(NUM) ; create spaces
"RTN","SROESNR2",81,0)
 ; pass in position, returns number of needed spaces
"RTN","SROESNR2",82,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SROESNR2",83,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SROESNR2",84,0)
 Q
"RTN","SROESNR2",85,0)
LINE(NUM) ; create carriage returns
"RTN","SROESNR2",86,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SROESNR2",87,0)
 Q
"RTN","SROICD")
0^12^B55952758^B818894
"RTN","SROICD",1,0)
SROICD ;BIR/SJA - CODE SET VERSIONING UTILITY ;27 Sep 2013  4:00 PM
"RTN","SROICD",2,0)
 ;;3.0;Surgery;**116,127,177**;24 Jun 93;Build 89
"RTN","SROICD",3,0)
 ;
"RTN","SROICD",4,0)
 ; Reference to $$ICDDATA^ICDXCODE supported by DBIA #5699
"RTN","SROICD",5,0)
 ; Reference to $$LS^ICDEX supported by DBIA #5747
"RTN","SROICD",6,0)
 ; Reference to $$CODEC^ICDEX supported by DBIA #5747
"RTN","SROICD",7,0)
 ; Reference to $$CODEN^ICDEX supported by DBIA #5747
"RTN","SROICD",8,0)
 ; Reference to $$SYS^ICDEX supported by DBIA #5747
"RTN","SROICD",9,0)
 ; Reference to $$VST^ICDEX supported by DBIA #5747
"RTN","SROICD",10,0)
 ; Reference to $$SEARCH^ICDSAPI supported by DBIA #5757
"RTN","SROICD",11,0)
 ; Reference to $$DIAGSRCH^LEX10CS supported by DBIA #5681
"RTN","SROICD",12,0)
 ; Reference to $$IMPDATE^LEXU supported by DBIA #5679
"RTN","SROICD",13,0)
 ; Reference to $$FREQ^LEXU supported by DBIA #5679
"RTN","SROICD",14,0)
 ; Reference to $$MAX^LEXU supported by DBIA #5679
"RTN","SROICD",15,0)
 ;
"RTN","SROICD",16,0)
ICDVST(SRCODE) ; Output Short Description, called from SRCUSS
"RTN","SROICD",17,0)
 ; -- Input SRCODE in external code (e.g. "100.0" or "H54.0"
"RTN","SROICD",18,0)
 N SRIEN,SRVST
"RTN","SROICD",19,0)
 S SRIEN=+$$CODEN^ICDEX($G(SRCODE),80)
"RTN","SROICD",20,0)
 I SRIEN<1 Q ""
"RTN","SROICD",21,0)
 S SRVST=$$VST^ICDEX(80,SRIEN)
"RTN","SROICD",22,0)
 Q SRVST
"RTN","SROICD",23,0)
ICDC(SRCODE) ; output principal ICD
"RTN","SROICD",24,0)
 N SRC,SRSDATE,SRDA
"RTN","SROICD",25,0)
 I $D(SRCODE),SRCODE="" Q
"RTN","SROICD",26,0)
 S SRDA=$S($G(SRIEN):SRIEN,$D(DA(2)):DA(2),$D(DA(1)):DA(1),$D(D0):D0,1:"")
"RTN","SROICD",27,0)
 S SRC=$$ICD(SRDA,SRCODE)
"RTN","SROICD",28,0)
 Q $P(SRC,"^",2,4)
"RTN","SROICD",29,0)
 ;
"RTN","SROICD",30,0)
ICD(SRIEN,SRC) ;
"RTN","SROICD",31,0)
 N SRSYS,SRICD,SRDATE
"RTN","SROICD",32,0)
 S SRDATE=$P($P($G(^SRF(SRIEN,0)),"^",9),".")
"RTN","SROICD",33,0)
 S SRSYS=$$ICDSYS(SRDATE)
"RTN","SROICD",34,0)
 S SRICD=$$ICDDATA^ICDXCODE(SRSYS,SRC,SRDATE,"I")
"RTN","SROICD",35,0)
 Q SRICD
"RTN","SROICD",36,0)
 ;
"RTN","SROICD",37,0)
ICDSYS(SRDT,SRICDTYP) ; determine ICD coding system 
"RTN","SROICD",38,0)
 ; If date of interest is null, today's date will be assumed
"RTN","SROICD",39,0)
 ; If SRICDTYP is null, Diagnosis is assumed for code type
"RTN","SROICD",40,0)
 N SRSYS,SRIMPDT
"RTN","SROICD",41,0)
 S SRDT=$S($G(SRDT):$P(SRDT,"."),1:DT)
"RTN","SROICD",42,0)
 S SRIMPDT=$$IMPDATE("10D")
"RTN","SROICD",43,0)
 ; JAS - 06/12/13 - PATCH 177 - Modified ICD-9 to return proper 3 character coding system abbrev.
"RTN","SROICD",44,0)
 S SRSYS=$S(SRDT'<SRIMPDT:"10D",1:"ICD")
"RTN","SROICD",45,0)
 I $G(SRICDTYP)="DIAG" S SRSYS=$S(SRSYS="10D":"10D",1:"ICD")
"RTN","SROICD",46,0)
 I $G(SRICDTYP)="PROC" S SRSYS=$S(SRSYS="10D":"10P",1:"ICP")
"RTN","SROICD",47,0)
 ; END 177
"RTN","SROICD",48,0)
 Q SRSYS
"RTN","SROICD",49,0)
 ;
"RTN","SROICD",50,0)
ICDSTR(SRIEN) ; return either "(ICD9)" or "(ICD10)" string
"RTN","SROICD",51,0)
 N SRDT,SRSYS
"RTN","SROICD",52,0)
 S SRDT=$P($P($G(^SRF(SRIEN,0)),"^",9),"."),SRDT=$S($G(SRDT):SRDT,1:DT)
"RTN","SROICD",53,0)
 S SRSYS=$$ICDSYS(SRDT),SRSYS=$S(SRSYS="10D":"(ICD10)",1:"(ICD9)")
"RTN","SROICD",54,0)
 Q SRSYS
"RTN","SROICD",55,0)
 ;
"RTN","SROICD",56,0)
ICD910(SRIEN) ; return either "9" or "10"
"RTN","SROICD",57,0)
 N SRDT,SRSYS
"RTN","SROICD",58,0)
 S SRDT=$P($P($G(^SRF(SRIEN,0)),"^",9),"."),SRDT=$S($G(SRDT):SRDT,1:DT)
"RTN","SROICD",59,0)
 S SRSYS=$$ICDSYS(SRDT),SRSYS=$S(SRSYS="10D":"10",1:"9")
"RTN","SROICD",60,0)
 Q SRSYS
"RTN","SROICD",61,0)
IMPDATE(SRCODSYS) ; a wrapper for IMPDATE API
"RTN","SROICD",62,0)
 Q $$IMPDATE^LEXU(SRCODSYS)
"RTN","SROICD",63,0)
 ;
"RTN","SROICD",64,0)
P80 ;No longer Used.  ICD-9/ICD-10 diagnosis selection - called by input transform
"RTN","SROICD",65,0)
 N DIC,SRDA,SRDT,SRSYS
"RTN","SROICD",66,0)
 S SRDA=$S($G(SRIEN):SRIEN,$D(DA(2)):DA(2),$D(DA(1)):DA(1),$D(D0):D0,1:"") I 'SRDA K X Q
"RTN","SROICD",67,0)
 S SRDT=$S($G(SRDA):$P($P(^SRF(SRDA,0),"^",9),"."),1:DT),SRSYS=$$ICDSYS(SRDT)
"RTN","SROICD",68,0)
 I $L(X)>100!($L(X)<1) K X Q
"RTN","SROICD",69,0)
 I SRSYS["10" S SRTXT=X D LEX Q
"RTN","SROICD",70,0)
 S Y=$$SEARCH^ICDSAPI("DIAG",("I $$LS^ICDEX(80,+Y,"""_SRDT_""")=1"),"QEMZ",SRDT) S:Y>0 X=+Y
"RTN","SROICD",71,0)
 I Y'>0 S X="" Q
"RTN","SROICD",72,0)
 Q
"RTN","SROICD",73,0)
ASKOK(SRTOTAL) ;
"RTN","SROICD",74,0)
 ; -- See default setting of SRASK at LEX+8
"RTN","SROICD",75,0)
 I $G(SRASK)=1 D  Q
"RTN","SROICD",76,0)
 . D EN^DDIOL("A total of "_$G(SRTOTAL)_" Entries found for this search.","","!!")
"RTN","SROICD",77,0)
 . D EN^DDIOL("Please refine your Search!")
"RTN","SROICD",78,0)
 . D EN^DDIOL(" ")
"RTN","SROICD",79,0)
 . H 3 S SROK=0
"RTN","SROICD",80,0)
 . Q
"RTN","SROICD",81,0)
 ;
"RTN","SROICD",82,0)
 I $G(SRASK)=2 D  Q
"RTN","SROICD",83,0)
 . W !!,"Searching for """_SRICDTXT_""" requires inspecting "_$G(SRTOTAL)_" records to determine"
"RTN","SROICD",84,0)
 . W !,"if they match the search criteria. This could take quite some time. Suggest"
"RTN","SROICD",85,0)
 . W !,"refining the search by further specifying """_SRICDTXT_""".",!
"RTN","SROICD",86,0)
 . ;
"RTN","SROICD",87,0)
 . N DIR,X,Y
"RTN","SROICD",88,0)
 . S DIR(0)="Y",DIR("A")="Do you wish to continue (Y/N)"
"RTN","SROICD",89,0)
 . S DIR("B")="No"
"RTN","SROICD",90,0)
 . S DIR("?")="Answer 'Y' for 'Yes' to continue searching on "_SRICDTXT_" or 'N' for 'No' to refine search criteria."
"RTN","SROICD",91,0)
 . D ^DIR
"RTN","SROICD",92,0)
 . I $D(DIROUT)!($D(DIRUT))!($D(DTOUT))!($D(DTOUT)) S SROK=0 Q
"RTN","SROICD",93,0)
 . S SROK=Y
"RTN","SROICD",94,0)
 . I SROK=1 W !,"   Searching...."
"RTN","SROICD",95,0)
 . W !
"RTN","SROICD",96,0)
 Q
"RTN","SROICD",97,0)
LEX N %DT,DIROUT,DUOUT,DTOUT,SREXIT,SRICDDT,SRICDTXT,SRICDUP,SRICDY,XX,SRTOT,SROK,SRZZONE
"RTN","SROICD",98,0)
 ; Begin Recursive Loop
"RTN","SROICD",99,0)
 S SRICDTXT=$G(X) Q:'$L(SRICDTXT)
"RTN","SROICD",100,0)
 ; RBD - 10/15/13 - PATCH 177 - Spacebar search functionality added.
"RTN","SROICD",101,0)
 I SRICDTXT=" " S SRICDTXT=$$SPACEBAR("^ICD9(") I SRICDTXT=" " K SRICDY G LOOK2
"RTN","SROICD",102,0)
 ; End 177
"RTN","SROICD",103,0)
 I $L(SRICDTXT)<2 D  S X="" Q
"RTN","SROICD",104,0)
 . D EN^DDIOL("Please enter at least the first two characters of the ICD-10","","!!?5")
"RTN","SROICD",105,0)
 . D EN^DDIOL("code or code description to start the search.","","!?5")
"RTN","SROICD",106,0)
 . D EN^DDIOL(" ")
"RTN","SROICD",107,0)
 . Q
"RTN","SROICD",108,0)
 S:'$G(SRASK) SRASK=2
"RTN","SROICD",109,0)
 S SRTOT=$$FREQ^LEXU(SRICDTXT) ;IA 5679
"RTN","SROICD",110,0)
 I SRTOT>$$MAX^LEXU(30) D ASKOK(SRTOT) Q:'$G(SROK)
"RTN","SROICD",111,0)
 S SRICDDT=$G(SRDT),SREXIT=0
"RTN","SROICD",112,0)
 K SRASK,SROK
"RTN","SROICD",113,0)
LOOK ; Lookup
"RTN","SROICD",114,0)
 Q:+($G(SREXIT))>0  K SRICDY
"RTN","SROICD",115,0)
 S SRICDY=$$DIAGSRCH^LEX10CS(SRICDTXT,.SRICDY,SRICDDT,30)
"RTN","SROICD",116,0)
 S:$O(SRICDY(" "),-1)>0 SRICDY=+SRICDY
"RTN","SROICD",117,0)
 ; RBD - 10/15/13 - PATCH 177 - LOOK2 label added for Spacebar logic
"RTN","SROICD",118,0)
LOOK2 I +SRICDY'>0 D  K X,Y Q
"RTN","SROICD",119,0)
 . D EN^DDIOL("No records found matching the value entered, revise search or enter ""?""","","!?5")
"RTN","SROICD",120,0)
 . D EN^DDIOL("for help.","","!?5")
"RTN","SROICD",121,0)
 . D EN^DDIOL(" ","","!?4")
"RTN","SROICD",122,0)
 . Q
"RTN","SROICD",123,0)
 ; RBD - 10/15/13 - PATCH 177 - 8 items at a time changed to 4
"RTN","SROICD",124,0)
 S XX=$$SEL^SROICDL(.SRICDY,4)
"RTN","SROICD",125,0)
 ; End 177
"RTN","SROICD",126,0)
 I $D(DUOUT)&('$D(DIROUT)) K:'$D(SRICDNT) X Q
"RTN","SROICD",127,0)
 I $D(DTOUT)&('$D(DIROUT)) S SREXIT=1 K X Q
"RTN","SROICD",128,0)
 I $D(DIROUT) S SREXIT=1 K X Q
"RTN","SROICD",129,0)
 ; Abort if timed out or user enters "^^"
"RTN","SROICD",130,0)
 I $D(DTOUT)!($D(DIROUT)) S SREXIT=1 K X Q
"RTN","SROICD",131,0)
 ; Up one level (SRICDUP) if user enters "^"
"RTN","SROICD",132,0)
 ; Quit if already at top level and user enters "^"
"RTN","SROICD",133,0)
 I $D(DUOUT),'$D(DIROUT),$L($G(SRICDUP)) K X Q
"RTN","SROICD",134,0)
 ; No Selection
"RTN","SROICD",135,0)
 I '$D(DUOUT),XX=-1 S SREXIT=1
"RTN","SROICD",136,0)
 ; Code Found and Selected
"RTN","SROICD",137,0)
 I $P(XX,";")'="99:CAT" S Y=+$$ICDDATA^ICDXCODE("10D",$P($P(XX,"^"),";",2)) S SREXIT=1 D  Q
"RTN","SROICD",138,0)
 . ; RBD - 10/15/13 - PATCH 177 - Spacebar logic added.
"RTN","SROICD",139,0)
 . D SAVSPACE("^ICD9(",Y)
"RTN","SROICD",140,0)
 . ; End 177
"RTN","SROICD",141,0)
 . ;CHOOSE 1-5: 1  003.0   ICD-9  003.0  SALMONELLA ENTERITIS  (C/C)
"RTN","SROICD",142,0)
 . W:'$D(SRZZONE) "  ",$P(XX,";",2),"  ICD-10  ",$$VST^ICDEX(80,Y)
"RTN","SROICD",143,0)
 ; Category Found and Selected
"RTN","SROICD",144,0)
 D NXT G:+($G(SREXIT))'>0 LOOK
"RTN","SROICD",145,0)
 Q
"RTN","SROICD",146,0)
NXT ; Next
"RTN","SROICD",147,0)
 Q:+($G(SREXIT))>0  N SRICDNT,SRICDND,SRICDX
"RTN","SROICD",148,0)
 S SRICDNT=$G(SRICDTXT),SRICDND=$G(SRICDDT),SRICDX=$G(XX)
"RTN","SROICD",149,0)
 N SRICDTXT,SRICDDT S SRICDTXT=$P($P(SRICDX,"^"),";",2),SRICDDT=SRICDND
"RTN","SROICD",150,0)
 G LOOK
"RTN","SROICD",151,0)
 Q
"RTN","SROICD",152,0)
 ; RBD - 10/15/13 - PATCH 177 - Spacebar save & retrieval APIs added
"RTN","SROICD",153,0)
 ; retrieves the last code selected by the user - space bar recall
"RTN","SROICD",154,0)
 ; logic here
"RTN","SROICD",155,0)
SPACEBAR(SRROOT) ;
"RTN","SROICD",156,0)
 N SRICDIEN,SRRTV
"RTN","SROICD",157,0)
 S SRRTV=" " I SRROOT="^ICD9(" D
"RTN","SROICD",158,0)
 . S SRICDIEN=$G(^DISV(DUZ,SRROOT))  ; subscription to ICR #510
"RTN","SROICD",159,0)
 . I $L(SRICDIEN) S SRRTV=$$CODEC^ICDEX(80,SRICDIEN)
"RTN","SROICD",160,0)
 Q SRRTV
"RTN","SROICD",161,0)
 ;
"RTN","SROICD",162,0)
 ; store the selected code for the space bar recall feature above
"RTN","SROICD",163,0)
SAVSPACE(SRROOT,SRRETV) ;
"RTN","SROICD",164,0)
 I +$G(DUZ)=0 Q
"RTN","SROICD",165,0)
 ; Subscription to ICD #510 needed for call to RECALL API below
"RTN","SROICD",166,0)
 I SRROOT="^ICD9(" D RECALL^DILFD(80,SRRETV_",",+DUZ) Q
"RTN","SROICD",167,0)
 Q
"RTN","SROICD",168,0)
 ;
"RTN","SROICD",169,0)
 ; End 177
"RTN","SROICD",170,0)
OUT(SRICDC) ; called by output transform fields of the ICD diagnosis code fields
"RTN","SROICD",171,0)
 N SRDA,SRDT,SRY
"RTN","SROICD",172,0)
 ;JAS - 5/31/13 - PATCH 177 - Rewrote the following line since it was grabbing the wrong ien.
"RTN","SROICD",173,0)
 S SRDA=$S($G(SRIEN):SRIEN,$G(SRTN):SRTN,$D(DA(1)):DA(1),$D(D0):D0,1:"")
"RTN","SROICD",174,0)
 S SRDT=$P($P($G(^SRF(SRDA,0)),"^",9),".")
"RTN","SROICD",175,0)
 ;JAS - 4/18/13 - PATCH 177 - Either internal or external value could be passed in, so made changes to handle that
"RTN","SROICD",176,0)
 I SRICDC?1N.N S SRY=$$ICDDATA^ICDXCODE("DIAG",SRICDC,SRDT,"I")
"RTN","SROICD",177,0)
 E  S SRY=$$ICDDATA^ICDXCODE("DIAG",SRICDC,SRDT,"E")
"RTN","SROICD",178,0)
 ;End 177
"RTN","SROICD",179,0)
 Q $P(SRY,"^",2)
"RTN","SROICD",180,0)
 ;
"RTN","SROICD",181,0)
SCRN(SRCODE) ;screen for active ICD codes
"RTN","SROICD",182,0)
 N SRSTAT,SRDA,SRDT
"RTN","SROICD",183,0)
 S SRDA=$S($G(SRIEN):SRIEN,$D(DA(2)):DA(2),$D(DA(1)):DA(1),$D(D0):D0,1:"")
"RTN","SROICD",184,0)
 S SRDT=$S($G(SRDA):$P($P(^SRF(SRDA,0),"^",9),"."),1:DT)
"RTN","SROICD",185,0)
 S SRSTAT=$$LS^ICDEX(80,SRCODE,SRDT)
"RTN","SROICD",186,0)
 Q $S(SRSTAT<1:0,1:1)
"RTN","SROICD",187,0)
 ;
"RTN","SROICD",188,0)
ICDSRCH ; To handle ICD ICD-9/10 Diagnosis Code Searches when ^DIC or ^DIE cannot be used
"RTN","SROICD",189,0)
 ; SRPRMT - For specific label, this field needs to be set from calling routine
"RTN","SROICD",190,0)
 ; SRDEF - For displaying the default field value at diagnosis prompt
"RTN","SROICD",191,0)
 ; X & Y variables need to be newed prior to calling this tag
"RTN","SROICD",192,0)
 I $G(SRPRMT)="" S SRPRMT=" Select ICD Diagnosis "
"RTN","SROICD",193,0)
 N SRDT,SRSYS
"RTN","SROICD",194,0)
 S SRDT=$P($P($G(^SRF(SRTN,0)),"^",9),"."),SRDT=$S($G(SRDT):SRDT,1:DT),SRSYS=$$SYS^ICDEX("DIAG",SRDT)
"RTN","SROICD",195,0)
 W !!,SRPRMT_$$ICDSTR^SROICD(SRTN)_": "_$S($G(SRDEF)'="":SRDEF_"// ",1:"") R X:DTIME
"RTN","SROICD",196,0)
 I X="",$G(SRDEF)'="" S X=SRDEF
"RTN","SROICD",197,0)
 ; RBD - 10/15/13 - PATCH 177 - Needs to Quit when X Null also
"RTN","SROICD",198,0)
 I (X="")!(X="^")!(X="@") Q
"RTN","SROICD",199,0)
 ; End 177
"RTN","SROICD",200,0)
 I X["?" D  K X,Y G ICDSRCH
"RTN","SROICD",201,0)
 .N SRTAG,SRFMT S SRTAG=""
"RTN","SROICD",202,0)
 .I SRSYS=30 S SRTAG=$S(X["???":"D3^SROICDGT",X["??":"D2^SROICDGT",X["?":"D1^SROICDGT",1:"D1^SROICDGT") D @SRTAG Q
"RTN","SROICD",203,0)
 .I SRSYS=1 S SRTAG="Answer with ICD-9 DIAGNOSIS CODE NUMBER, or DESCRIPTION."
"RTN","SROICD",204,0)
 .S SRFMT=$S(X["??":"!?8",1:"!?5")
"RTN","SROICD",205,0)
 .D EN^DDIOL(SRTAG,"",SRFMT)
"RTN","SROICD",206,0)
 .Q
"RTN","SROICD",207,0)
 I SRSYS=1 S Y=$$SEARCH^ICDSAPI("DIAG","","QEMZ",SRDT)
"RTN","SROICD",208,0)
 E  D LEX^SROICD
"RTN","SROICD",209,0)
 ;JAS - 11/07/13 - PATCH 177 - Need to Kill Y too prior to returning to ICDSRCH
"RTN","SROICD",210,0)
 I $G(Y)'>0!($G(Y)="") D  K X,Y G ICDSRCH
"RTN","SROICD",211,0)
 .I SRSYS=1 W !,?6,"Enter the ICD Diagnosis code for the principal postoperative diagnosis.",!,?6,"Screen prevents selection of inactive diagnosis."
"RTN","SROICD",212,0)
 K SRPRMT,SRDEF
"RTN","SROICD",213,0)
 Q
"RTN","SROICD",214,0)
 ;
"RTN","SROICD",215,0)
TEST1 ;
"RTN","SROICD",216,0)
 ; do not ask question
"RTN","SROICD",217,0)
 S SRASK=1
"RTN","SROICD",218,0)
 S X="FRACTURE",SRDT=3150101 D LEX
"RTN","SROICD",219,0)
 Q
"RTN","SROICD",220,0)
TEST2 ;
"RTN","SROICD",221,0)
 ; ask question
"RTN","SROICD",222,0)
 S SRASK=2
"RTN","SROICD",223,0)
 S X="FRACTURE",SRDT=3150101 D LEX
"RTN","SROICD",224,0)
 Q
"RTN","SROICDGT")
0^63^B42226925^n/a
"RTN","SROICDGT",1,0)
SROICDGT ;BIR/SJA - CODE SET VERSIONING UTILITY ;26 Sep 2013  3:39 PM
"RTN","SROICDGT",2,0)
 ;;3.0;Surgery;**177**;24 Jun 93;Build 89
"RTN","SROICDGT",3,0)
 ;
"RTN","SROICDGT",4,0)
 ; Reference to $$SYS^ICDEX supported by DBIA #5747
"RTN","SROICDGT",5,0)
 ;
"RTN","SROICDGT",6,0)
GETAPI(SRAPP,TYPE,SRIEN) ;ICD-9/ICD-10 selection - called by input transform
"RTN","SROICDGT",7,0)
 ; - INPUT: X    := the initial user input to be searched on (REQUIRED)
"RTN","SROICDGT",8,0)
 ;         SRAPP := application name in file 130.4;.01 (REQUIRED)
"RTN","SROICDGT",9,0)
 ;          TYPE := type of call in file 130.4;.04 (REQUIRED)
"RTN","SROICDGT",10,0)
 ;         SRIEN := top level entry in file 130 (DA) used to get date to compute correct version (OPTIONAL but needs DA)
"RTN","SROICDGT",11,0)
 ;                  Note: applications using this as an example will need to modify the code that uses this.
"RTN","SROICDGT",12,0)
 ; - OUTPUT: X   := the internal value to be stored in the field.
"RTN","SROICDGT",13,0)
 ;           Y   := the internal value to be stored in the field
"RTN","SROICDGT",14,0)
 ;
"RTN","SROICDGT",15,0)
 N DIC,DIE,SRDA,SRDT,ENTRY,SRCODE,SRVER,SRX,DTOUT,DUOUT,DIROUT,SRONECH
"RTN","SROICDGT",16,0)
 ; JAS - Patch 177 - Next line - A value for Y was leaking into this API
"RTN","SROICDGT",17,0)
 K Y
"RTN","SROICDGT",18,0)
 I X=" " S X=$$SPACEBAR^SROICD("^ICD9(") I X=" " K X,Y Q
"RTN","SROICDGT",19,0)
 I X="?BAD" W ! S X="" Q
"RTN","SROICDGT",20,0)
 ;
"RTN","SROICDGT",21,0)
 I X="@" K X Q
"RTN","SROICDGT",22,0)
 I '$L($G(SRAPP)) D MSG("The Application making the call was not specified.") K X Q
"RTN","SROICDGT",23,0)
 I '$L($G(TYPE)) D MSG("The Search Type (diagnosis or procedure) was not specified.") K X Q
"RTN","SROICDGT",24,0)
 I $L($G(X))>100!($L($G(X))<1) D MSG("Answer must be 1-100 characters in length.") K X Q
"RTN","SROICDGT",25,0)
 ;
"RTN","SROICDGT",26,0)
 ; -- next three lines are Surgery Specific
"RTN","SROICDGT",27,0)
 ;
"RTN","SROICDGT",28,0)
 ; - Note: X and SRDT are used inside the executed code
"RTN","SROICDGT",29,0)
 S SRDA=$S($G(SRIEN):SRIEN,$D(DA(2)):DA(2),$D(DA(1)):DA(1),$D(DA):DA,$D(D0):D0,$G(SRTN):SRTN,1:"")
"RTN","SROICDGT",30,0)
 I $G(^SRF($G(SRDA),0))="" D MSG("Entry in the Surgery file was not found.") K X Q
"RTN","SROICDGT",31,0)
 S SRDT=$S($G(SRDA):$P($P(^SRF(SRDA,0),"^",9),"."),1:DT) ; SRDT is used in executable code
"RTN","SROICDGT",32,0)
 ;
"RTN","SROICDGT",33,0)
 N DA
"RTN","SROICDGT",34,0)
 S SRVER=$$SYS^ICDEX(TYPE,SRDT)
"RTN","SROICDGT",35,0)
 I SRVER'>0 D MSG("Could not acquire the correct ICD Version for '"_TYPE_"' on "_$$FMTE^XLFDT(SRDT)) K X Q
"RTN","SROICDGT",36,0)
 ;
"RTN","SROICDGT",37,0)
 I X["?" D  K X,Y Q
"RTN","SROICDGT",38,0)
 . N SRTAG S SRTAG=""
"RTN","SROICDGT",39,0)
 . I SRVER=30 S SRTAG=$S(X["???":"D3",X["??":"D2",X["?":"D1",1:"D1") D @SRTAG Q
"RTN","SROICDGT",40,0)
 . I SRVER=1 S SRTAG="Answer with ICD-9 DIAGNOSIS CODE NUMBER, or DESCRIPTION."
"RTN","SROICDGT",41,0)
 . N SRFORMAT S SRFORMAT=$S(X["??":"!?8",1:"!?5")
"RTN","SROICDGT",42,0)
 . D EN^DDIOL(SRTAG,"",SRFORMAT)
"RTN","SROICDGT",43,0)
 . Q
"RTN","SROICDGT",44,0)
 I SRVER=30,X="*" S X=""
"RTN","SROICDGT",45,0)
 ;
"RTN","SROICDGT",46,0)
 I SRVER=30,$L(X)<2 D  K X,Y S SRONECH=1 Q
"RTN","SROICDGT",47,0)
 . D EN^DDIOL("Please enter at least the first two characters of the ICD-10","","!!?5")
"RTN","SROICDGT",48,0)
 . D EN^DDIOL("code or code description to start the search.","","!?5")
"RTN","SROICDGT",49,0)
 . D EN^DDIOL(" ")
"RTN","SROICDGT",50,0)
 . Q
"RTN","SROICDGT",51,0)
 ;
"RTN","SROICDGT",52,0)
 S ENTRY=$O(^DIC(130.4,"C",SRAPP,TYPE,SRVER,0))
"RTN","SROICDGT",53,0)
 I ENTRY'>0 D MSG("Search Entry in ICD SEARCH API file for application '"_SRAPP_"' of type '"_TYPE_"' for Version '"_SRVER_"' is missing.") K X Q
"RTN","SROICDGT",54,0)
 S SRCODE=$G(^DIC(130.4,ENTRY,1))
"RTN","SROICDGT",55,0)
 I '$L(SRCODE) D MSG("No Executable Code found for a ICD code search for type '"_TYPE_"'.") K X Q
"RTN","SROICDGT",56,0)
 I $L(SRCODE) X SRCODE
"RTN","SROICDGT",57,0)
 I SRVER=1 D
"RTN","SROICDGT",58,0)
 . I $D(Y(0,1)) W "  ",$P(Y(0,1),U,2),"  ICD-9  ",$P(Y(0,1),U,4)
"RTN","SROICDGT",59,0)
 I $G(Y)>0 S X=+Y Q
"RTN","SROICDGT",60,0)
 K X,Y
"RTN","SROICDGT",61,0)
 Q
"RTN","SROICDGT",62,0)
MSG(SRTEXT) ;
"RTN","SROICDGT",63,0)
 D EN^DDIOL(SRTEXT)
"RTN","SROICDGT",64,0)
 Q
"RTN","SROICDGT",65,0)
 ;
"RTN","SROICDGT",66,0)
D1 ; -- Diagnosis ?  Help
"RTN","SROICDGT",67,0)
 Q:$G(SRONECH)
"RTN","SROICDGT",68,0)
 Q:X="?BAD"
"RTN","SROICDGT",69,0)
 I X["???" D D3 Q  ;For calls from ^DIR, doesn't support ??? help
"RTN","SROICDGT",70,0)
 I X["??" D D2 Q
"RTN","SROICDGT",71,0)
 D EN^DDIOL("Enter code or ""text"" for more information.","","!?5")
"RTN","SROICDGT",72,0)
 D EN^DDIOL(" ")
"RTN","SROICDGT",73,0)
 Q
"RTN","SROICDGT",74,0)
 ;
"RTN","SROICDGT",75,0)
D2 ; -- Diagnosis ??  Help
"RTN","SROICDGT",76,0)
 D EN^DDIOL("Enter a ""free text"" term or part of a term such as ""femur fracture"".","","!?8")
"RTN","SROICDGT",77,0)
 D EN^DDIOL("    or","","!?8")
"RTN","SROICDGT",78,0)
 D EN^DDIOL("Enter a ""classification code"" (ICD/CPT, etc.) to find the single term","","!?8")
"RTN","SROICDGT",79,0)
 D EN^DDIOL("associated with the code","","!?8")
"RTN","SROICDGT",80,0)
 D EN^DDIOL("    or","","!?8")
"RTN","SROICDGT",81,0)
 D EN^DDIOL("Enter a ""partial code"". Include the decimal when a search criterion","","!?8")
"RTN","SROICDGT",82,0)
 D EN^DDIOL("includes 3 characters or more for code searches.","","!?8")
"RTN","SROICDGT",83,0)
 D EN^DDIOL(" ")
"RTN","SROICDGT",84,0)
 Q
"RTN","SROICDGT",85,0)
 ;
"RTN","SROICDGT",86,0)
D3 ; -- Diagnosis ???  Help
"RTN","SROICDGT",87,0)
 N SRHLP
"RTN","SROICDGT",88,0)
 S SRHLP(1)="Number of Code Matches"
"RTN","SROICDGT",89,0)
 S SRHLP(1,"F")="!?8"
"RTN","SROICDGT",90,0)
 S SRHLP(2)="----------------------"
"RTN","SROICDGT",91,0)
 S SRHLP(2,"F")="!?8"
"RTN","SROICDGT",92,0)
 S SRHLP(3)="The ICD-10 Diagnosis Code search will show the user the number of"
"RTN","SROICDGT",93,0)
 S SRHLP(3,"F")="!!?8"
"RTN","SROICDGT",94,0)
 S SRHLP(4)="matches found, indicate if additional characters in ICD code exist,"
"RTN","SROICDGT",95,0)
 S SRHLP(4,"F")="!?8"
"RTN","SROICDGT",96,0)
 S SRHLP(5)="and the number of codes within the category or subcategory that are"
"RTN","SROICDGT",97,0)
 S SRHLP(5,"F")="!?8"
"RTN","SROICDGT",98,0)
 S SRHLP(6)="available for selection.  For example:"
"RTN","SROICDGT",99,0)
 S SRHLP(6,"F")="!?8"
"RTN","SROICDGT",100,0)
 S SRHLP(8)="19 matches found"
"RTN","SROICDGT",101,0)
 S SRHLP(8,"F")="!!?8"
"RTN","SROICDGT",102,0)
 S SRHLP(10)="M91. -      Juvenile osteochondrosis of hip and pelvis (19)"
"RTN","SROICDGT",103,0)
 S SRHLP(10,"F")="!!?8"
"RTN","SROICDGT",104,0)
 S SRHLP(12)="This indicates that 19 unique matches or matching groups have been"
"RTN","SROICDGT",105,0)
 S SRHLP(12,"F")="!!?8"
"RTN","SROICDGT",106,0)
 S SRHLP(13)="found and will be displayed."
"RTN","SROICDGT",107,0)
 S SRHLP(13,"F")="!?8"
"RTN","SROICDGT",108,0)
 S SRHLP(15)="M91. -  the ""-"" indicates that there are additional characters"
"RTN","SROICDGT",109,0)
 S SRHLP(15)="M91. -  the ""-"" indicates that there are additional characters"
"RTN","SROICDGT",110,0)
 S SRHLP(15,"F")="!!?8"
"RTN","SROICDGT",111,0)
 S SRHLP(16)="that specify unique ICD-10 codes available."
"RTN","SROICDGT",112,0)
 S SRHLP(16,"F")="!?8"
"RTN","SROICDGT",113,0)
 S SRHLP(18)="(19)   Indicates that there are 19 additional ICD-10 codes in the"
"RTN","SROICDGT",114,0)
 S SRHLP(18,"F")="!!?8"
"RTN","SROICDGT",115,0)
 S SRHLP(19)="M91 ""family"" that are possible selections."
"RTN","SROICDGT",116,0)
 S SRHLP(19,"F")="!?8"
"RTN","SROICDGT",117,0)
 D EN^DDIOL(.SRHLP)
"RTN","SROICDGT",118,0)
 Q
"RTN","SROICDGT",119,0)
 ;
"RTN","SROICDGT",120,0)
TR(X) ;
"RTN","SROICDGT",121,0)
 S X=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","SROICDGT",122,0)
 Q X
"RTN","SROICDGT",123,0)
TEST ; -- test api calls
"RTN","SROICDGT",124,0)
 S X="003.1" D GETAPI^SROICDGT("SURG","DIAG",1)
"RTN","SROICDGT",125,0)
 Q
"RTN","SROICDGT",126,0)
 S X="F1" W !,"1" D GETAPI^SROICDGT(,"DIAG",1) ;no application
"RTN","SROICDGT",127,0)
 S X="F1" W !,"2" D GETAPI^SROICDGT("SURG",,1) ;no Type
"RTN","SROICDGT",128,0)
 S X="F1" W !,"3" D GETAPI^SROICDGT("SURG","DIAG",199999) ;no entry is Surgery file
"RTN","SROICDGT",129,0)
 S X="" W !,"4" D GETAPI^SROICDGT("SURG","DIAG",1) ;Answer too short
"RTN","SROICDGT",130,0)
 S X="aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa"
"RTN","SROICDGT",131,0)
 W !,"5" D GETAPI^SROICDGT("SURG","PROC",1) ;answer too long
"RTN","SROICDGT",132,0)
 S X="F1" W !,"6" D GETAPI^SROICDGT("SURG","DAIG",1) ; NO VERSION found
"RTN","SROICDGT",133,0)
 S X="F1" W !,"7" D GETAPI^SROICDGT("SUGR","DIAG",1) ; no entry for Daig
"RTN","SROICDGT",134,0)
 S X="F1" W !,"8" D GETAPI^SROICDGT("SURG","PROC",1) ;no executable code
"RTN","SROICDGT",135,0)
 ;
"RTN","SROICDGT",136,0)
 S X="330" W !,"9 - SHOULD WORK" D GETAPI^SROICDGT("SURG","DIAG",1) ; This one is icd-9
"RTN","SROICDGT",137,0)
 S X="S62" W !,"10 - SHOULD WORK" D GETAPI^SROICDGT("SURG","DIAG",21) ; This one is icd-10
"RTN","SROICDGT",138,0)
 S X="COCAINE" W !,"11 - SHOULD WORK" D GETAPI^SROICDGT("SURG","DIAG",21) ; This one is icd-10
"RTN","SROICDGT",139,0)
 S X="fracture" W !,"12 - SHOULD WORK" D GETAPI^SROICDGT("SURG","DIAG",21) ; This one is icd-10
"RTN","SROICDGT",140,0)
 Q
"RTN","SROICDL")
0^62^B34675259^n/a
"RTN","SROICDL",1,0)
SROICDL ;ALB/SJA - Select ICD DIAGNOSIS FROM LIXICON UTILITY LIST ;12/07/2011
"RTN","SROICDL",2,0)
 ;;3.0;Surgery;**177**;24 Jun 93;Build 89
"RTN","SROICDL",3,0)
 ;
"RTN","SROICDL",4,0)
SEL(SRL,X) ; Select from List
"RTN","SROICDL",5,0)
 ;
"RTN","SROICDL",6,0)
 ;
"RTN","SROICDL",7,0)
 ; Input   
"RTN","SROICDL",8,0)
 ; 
"RTN","SROICDL",9,0)
 ;     X     Length of list to display (default 5)
"RTN","SROICDL",10,0)
 ;    .SRL   Local array passed by reference
"RTN","SROICDL",11,0)
 ;               
"RTN","SROICDL",12,0)
 ;             SRL()   Input Array from ICDSRCH^LEX10CS
"RTN","SROICDL",13,0)
 ;               
"RTN","SROICDL",14,0)
 ;             SRL(0)=# found ^ Pruning Indicator
"RTN","SROICDL",15,0)
 ;             SRL(1,0)=Code ^ Code IEN ^ date
"RTN","SROICDL",16,0)
 ;             SRL(1,"IDL")=ICD-9/10 Description, Long
"RTN","SROICDL",17,0)
 ;             SRL(1,"IDL",1)=ICD-9/10 IEN ^ date
"RTN","SROICDL",18,0)
 ;             SRL(1,"IDS")=ICD-9/10 Description, Short
"RTN","SROICDL",19,0)
 ;             SRL(1,"IDS",1)=ICD-9/10 IEN ^ date
"RTN","SROICDL",20,0)
 ;             SRL(1,"LEX")=Lexicon Description
"RTN","SROICDL",21,0)
 ;             SRL(1,"LEX",1)=Expression IEN ^ date
"RTN","SROICDL",22,0)
 ;             SRL(1,"SYN",1)=Synonym #1
"RTN","SROICDL",23,0)
 ;             SRL(1,"SYN",m)=Synonym #m
"RTN","SROICDL",24,0)
 ;             ...
"RTN","SROICDL",25,0)
 ;               
"RTN","SROICDL",26,0)
 ; Output
"RTN","SROICDL",27,0)
 ;               
"RTN","SROICDL",28,0)
 ;    $$SEL  Two Piece "^" delimited string same as
"RTN","SROICDL",29,0)
 ;           Fileman's Y output variable
"RTN","SROICDL",30,0)
 ;               
"RTN","SROICDL",31,0)
 ;             1  Lexicon IEN
"RTN","SROICDL",32,0)
 ;             2  Lexicon Term
"RTN","SROICDL",33,0)
 ;               
"RTN","SROICDL",34,0)
 ;    SRL    Local array passed by reference
"RTN","SROICDL",35,0)
 ;               
"RTN","SROICDL",36,0)
 ;             SRL(0)=Code ^ Code IEN ^ date
"RTN","SROICDL",37,0)
 ;             SRL("IDL")=ICD-9/10 Description, Long
"RTN","SROICDL",38,0)
 ;             SRL("IDL",1)=ICD-9/10 IEN ^ date
"RTN","SROICDL",39,0)
 ;             SRL("IDS")=ICD-9/10 Description, Short
"RTN","SROICDL",40,0)
 ;             SRL("IDS",1)=ICD-9/10 IEN ^ date
"RTN","SROICDL",41,0)
 ;             SRL("LEX")=Lexicon Description
"RTN","SROICDL",42,0)
 ;             SRL("LEX",1)=Expression IEN ^ date
"RTN","SROICDL",43,0)
 ;               
"RTN","SROICDL",44,0)
 ;    or ^ on error 
"RTN","SROICDL",45,0)
 ;    or -1 for non-selection
"RTN","SROICDL",46,0)
 ;               
"RTN","SROICDL",47,0)
 S X=+($G(X)) S:X'>0 X=5 S X=$$ASK(.SRL,X)
"RTN","SROICDL",48,0)
 Q X
"RTN","SROICDL",49,0)
ASK(SRL,X) ; Ask for Selection
"RTN","SROICDL",50,0)
 N SRLIT,SRLL,SRLTOT S SRLL=+($G(X)) S:SRLL'>0 SRLL=5
"RTN","SROICDL",51,0)
 S SRLIT=0,SRLTOT=$O(SRL(" "),-1) Q:+SRLTOT'>0 "^"
"RTN","SROICDL",52,0)
 K X S:+SRLTOT=1 X=$$ONE(SRLL,.SRL) S:+SRLTOT>1 X=$$MUL(.SRL,SRLL)
"RTN","SROICDL",53,0)
 S:'$D(DTOUT)&('$D(DUOUT))&('$D(DIROUT))&(+($G(X))'>0) X=-1
"RTN","SROICDL",54,0)
 Q X
"RTN","SROICDL",55,0)
ONE(X,SRL) ; One Entry Found
"RTN","SROICDL",56,0)
 Q:+($G(SRLIT))>0 "^^"  N Z,DIR,SRLC,SRLEX,SRLFI,SRLIT,SRLSO,SRLNC
"RTN","SROICDL",57,0)
 N SRLSP,SRLTX,SRLC,Y S SRLFI=$O(SRL(0)) Q:+SRLFI'>0 "^"
"RTN","SROICDL",58,0)
 S SRLSP=$J(" ",11)
"RTN","SROICDL",59,0)
 S SRLSO=$P(SRL(1,0),"^",1),SRLNC=$P(SRL(1,0),"^",3)
"RTN","SROICDL",60,0)
 S:+SRLNC>0 SRLNC=" ("_SRLNC_")" S SRLEX=$G(SRL(1,"MENU"))
"RTN","SROICDL",61,0)
 S SRLC=$S($D(SRL(1,"CAT")):"-",1:"")
"RTN","SROICDL",62,0)
 S SRLTX(1)=SRLSO_SRLC_$J(" ",(9-$L(SRLSO)))_" "_SRLEX_SRLNC
"RTN","SROICDL",63,0)
 ;
"RTN","SROICDL",64,0)
 D PR(.SRLTX,64)
"RTN","SROICDL",65,0)
 S DIR("A",1)=" One code found",DIR("A",2)=" "
"RTN","SROICDL",66,0)
 S DIR("A",3)=" "_$G(SRLTX(1))
"RTN","SROICDL",67,0)
 S SRLC=3
"RTN","SROICDL",68,0)
 F Z=2:1 Q:$G(SRLTX(Z))=""  S SRLC=SRLC+1,DIR("A",SRLC)=SRLSP_$G(SRLTX(Z))
"RTN","SROICDL",69,0)
 S SRLC=SRLC+1
"RTN","SROICDL",70,0)
 S DIR("A",SRLC)=" "
"RTN","SROICDL",71,0)
 S SRLC=SRLC+1
"RTN","SROICDL",72,0)
 ;
"RTN","SROICDL",73,0)
 S DIR("A")=" OK? (Yes/No) ",DIR("B")="Yes",DIR(0)="YAO" W !
"RTN","SROICDL",74,0)
 D ^DIR Q:'$D(DTOUT)&('$D(DUOUT))&('$D(DIROUT))&(+($G(Y))'>0) -1
"RTN","SROICDL",75,0)
 S:X["^^"!($D(DTOUT)) SRLIT=1
"RTN","SROICDL",76,0)
 I X["^^"!(+($G(SRLIT))>0) K SRL Q "^^"
"RTN","SROICDL",77,0)
 S X=$S(+Y>0:$$X(1,.SRL),1:-1)
"RTN","SROICDL",78,0)
 I X>0 S SRZZONE=1
"RTN","SROICDL",79,0)
 Q X
"RTN","SROICDL",80,0)
MUL(SRL,Y) ; Multiple Entries Found
"RTN","SROICDL",81,0)
 Q:+($G(SRLIT))>0 "^^"  N SRLE,SRLL,SRLMAX,SRLSS,SRLX,X
"RTN","SROICDL",82,0)
 S (SRLMAX,SRLSS,SRLIT)=0,SRLL=+($G(Y)),U="^" S:+($G(SRLL))'>0 SRLL=5
"RTN","SROICDL",83,0)
 S SRLX=$O(SRL(" "),-1),SRLSS=0
"RTN","SROICDL",84,0)
 G:+SRLX=0 MULQ W ! W:+SRLX>1 !," ",SRLX," matches found"
"RTN","SROICDL",85,0)
 F SRLE=1:1:SRLX Q:((SRLSS>0)&(SRLSS<(SRLE+1)))  Q:SRLIT  D  Q:SRLIT
"RTN","SROICDL",86,0)
 . W:SRLE#SRLL=1 ! D MULW
"RTN","SROICDL",87,0)
 . S SRLMAX=SRLE W:SRLE#SRLL=0 !
"RTN","SROICDL",88,0)
 . S:SRLE#SRLL=0 SRLSS=$$MULS(SRLMAX,SRLE,.SRL) S:SRLSS["^" SRLIT=1
"RTN","SROICDL",89,0)
 I SRLE#SRLL'=0,+SRLSS<=0 D
"RTN","SROICDL",90,0)
 . W ! S SRLSS=$$MULS(SRLMAX,SRLE,.SRL) S:SRLSS["^" SRLIT=1
"RTN","SROICDL",91,0)
 G MULQ
"RTN","SROICDL",92,0)
 Q X
"RTN","SROICDL",93,0)
MULW ; Write Multiple
"RTN","SROICDL",94,0)
 N SRLEX,SRLI,SRLSO,SRLNC,SRLT,SRLTX S SRLSO=$P(SRL(+SRLE,0),"^",1)
"RTN","SROICDL",95,0)
 S SRLNC=$P(SRL(+SRLE,0),"^",3) S:+SRLNC>0 SRLNC=" ("_SRLNC_")"
"RTN","SROICDL",96,0)
 S SRLEX=$G(SRL(+SRLE,"MENU")),SRLTX(1)=SRLSO
"RTN","SROICDL",97,0)
 S SRLTX(1)=SRLTX(1)_$S($D(SRL(+SRLE,"CAT")):"-",1:" ")_$J(" ",(9-$L(SRLSO)))_" "_SRLEX_SRLNC
"RTN","SROICDL",98,0)
 D PR(.SRLTX,60) W !,$J(SRLE,5),".  ",$G(SRLTX(1))
"RTN","SROICDL",99,0)
 F SRLI=2:1:5 S SRLT=$G(SRLTX(SRLI)) W:$L(SRLT) !,$J(" ",19),SRLT
"RTN","SROICDL",100,0)
 Q
"RTN","SROICDL",101,0)
MULS(X,Y,SRL) ; Select from Multiple Entries
"RTN","SROICDL",102,0)
 N DIR,DIRB,SRLFI,SRLHLP,SRLLAST,SRLMAX,SRLS
"RTN","SROICDL",103,0)
 Q:+($G(SRLIT))>0 "^^"  S SRLMAX=+($G(X)),SRLLAST=+($G(Y))
"RTN","SROICDL",104,0)
 Q:SRLMAX=0 -1 S SRLFI=$O(SRL(0)) Q:+SRLFI'>0 -1
"RTN","SROICDL",105,0)
 I +($O(SRL(+SRLLAST)))>0 D
"RTN","SROICDL",106,0)
 . S DIR("A")=" Press <RETURN> for more, ""^"" to exit, or Select 1-"
"RTN","SROICDL",107,0)
 . S DIR("A")=DIR("A")_SRLMAX_": "
"RTN","SROICDL",108,0)
 I +($O(SRL(+SRLLAST)))'>0 D
"RTN","SROICDL",109,0)
 . S DIR("A")=" Select 1-"_SRLMAX_": "
"RTN","SROICDL",110,0)
 S SRLHLP=" Answer must be from 1 to "
"RTN","SROICDL",111,0)
 S SRLHLP=SRLHLP_SRLMAX_", or <Return> to continue"
"RTN","SROICDL",112,0)
 S DIR("PRE")="S:X[""?"" X=""??"""
"RTN","SROICDL",113,0)
 S (DIR("?"),DIR("??"))="^D MULSH^SROICDL"
"RTN","SROICDL",114,0)
 S DIR(0)="NAO^1:"_SRLMAX_":0" D ^DIR
"RTN","SROICDL",115,0)
 Q:'$D(DTOUT)&('$D(DUOUT))&('$D(DIROUT))&(+($G(Y))'>0) -1
"RTN","SROICDL",116,0)
 S:X["^^"!($D(DTOUT)) SRLIT=1,X="^^" I X["^^"!(+($G(SRLIT))>0) Q "^^"
"RTN","SROICDL",117,0)
 K DIR Q:$D(DTOUT)!(X[U) "^^"
"RTN","SROICDL",118,0)
 Q $S(+Y>0:+Y,1:"-1")
"RTN","SROICDL",119,0)
MULSH ; Select from Multiple Entries Help
"RTN","SROICDL",120,0)
 I $L($G(SRLHLP)) W !,$G(SRLHLP) Q
"RTN","SROICDL",121,0)
 Q
"RTN","SROICDL",122,0)
MULQ ; Quit Multiple
"RTN","SROICDL",123,0)
 I +SRLSS'>0,$G(SRLSS)="^" Q "^"
"RTN","SROICDL",124,0)
 S X=-1 S:+($G(SRLIT))'>0 X=$$X(+SRLSS,.SRL)
"RTN","SROICDL",125,0)
 Q X
"RTN","SROICDL",126,0)
X(X,SRL) ; Set X and Outpot Array
"RTN","SROICDL",127,0)
 N SRLEX,SRFI,SRLIEN,SRLN,SRLNC,SRLNN,SRLRN,SRLS,SRLSO
"RTN","SROICDL",128,0)
 S SRLS=+($G(X)) S SRFI=$O(SRL(0))
"RTN","SROICDL",129,0)
 S SRLSO=$P($G(SRL(SRLS,0)),"^",1),SRLEX=$G(SRL(SRLS,"MENU"))
"RTN","SROICDL",130,0)
 ;
"RTN","SROICDL",131,0)
 S SRLIEN=$S($D(SRL(SRLS,"CAT")):"99:CAT;"_$P($G(SRL(SRLS,0)),"^"),1:$P($G(SRL(SRLS,"IDS",1)),"^")_";"_$P($G(SRL(SRLS,0)),"^")_";"_$P($G(SRL(SRLS,"LEX",1)),"^")) Q:'$L(SRLSO) "^"
"RTN","SROICDL",132,0)
 ;
"RTN","SROICDL",133,0)
 Q:'$L(SRLEX) "^"  Q:+SRLIEN'>0 "^" S X=SRLIEN_"^"_SRLEX
"RTN","SROICDL",134,0)
 S SRLNN="SRL("_+SRLS_")",SRLNC="SRL("_+SRLS_","
"RTN","SROICDL",135,0)
 F  S SRLNN=$Q(@SRLNN) Q:'$L(SRLNN)!(SRLNN'[SRLNC)  D
"RTN","SROICDL",136,0)
 . S SRLRN="SRLN("_$P(SRLNN,"(",2,299) S @SRLRN=@SRLNN
"RTN","SROICDL",137,0)
 K SRL S SRLNN="SRLN("_+SRLS_")",SRLNC="SRLN("_+SRLS_","
"RTN","SROICDL",138,0)
 F  S SRLNN=$Q(@SRLNN) Q:'$L(SRLNN)!(SRLNN'[SRLNC)  D
"RTN","SROICDL",139,0)
 . S SRLRN="SRL("_$P(SRLNN,"(",2,299),@SRLRN=@SRLNN
"RTN","SROICDL",140,0)
 Q X
"RTN","SROICDL",141,0)
 ; 
"RTN","SROICDL",142,0)
 ; Miscellaneous
"RTN","SROICDL",143,0)
CL ; Clear
"RTN","SROICDL",144,0)
 K SRLIT
"RTN","SROICDL",145,0)
 Q
"RTN","SROICDL",146,0)
PR(SRL,X) ; Parse Array
"RTN","SROICDL",147,0)
 N DIW,DIWF,DIWI,DIWL,DIWR,DIWT,DIWTC,DIWX,DN,I,Z,%,%D,SRLC,SRLI,SRLL
"RTN","SROICDL",148,0)
 K ^UTILITY($J,"W") Q:'$D(SRL)  S SRLL=+($G(X)) S:+SRLL'>0 SRLL=79
"RTN","SROICDL",149,0)
 S SRLC=+($G(SRL)) S:+($G(SRLC))'>0 SRLC=$O(SRL(" "),-1) Q:+SRLC'>0
"RTN","SROICDL",150,0)
 S DIWL=1,DIWF="C"_+SRLL S SRLI=0
"RTN","SROICDL",151,0)
 F  S SRLI=$O(SRL(SRLI)) Q:+SRLI=0  S X=$G(SRL(SRLI)) D ^DIWP
"RTN","SROICDL",152,0)
 K SRL S (SRLC,SRLI)=0
"RTN","SROICDL",153,0)
 F  S SRLI=$O(^UTILITY($J,"W",1,SRLI)) Q:+SRLI=0  D
"RTN","SROICDL",154,0)
 . S SRL(SRLI)=$$TM($G(^UTILITY($J,"W",1,SRLI,0))," "),SRLC=SRLC+1
"RTN","SROICDL",155,0)
 S:$L(SRLC) SRL=SRLC K ^UTILITY($J,"W")
"RTN","SROICDL",156,0)
 Q
"RTN","SROICDL",157,0)
TM(X,Y) ; Trim Character Y - Default " "
"RTN","SROICDL",158,0)
 S X=$G(X) Q:X="" X S Y=$G(Y) S:'$L(Y) Y=" "
"RTN","SROICDL",159,0)
 F  Q:$E(X,1)'=Y  S X=$E(X,2,$L(X))
"RTN","SROICDL",160,0)
 F  Q:$E(X,$L(X))'=Y  S X=$E(X,1,($L(X)-1))
"RTN","SROICDL",161,0)
 Q X
"RTN","SROMENU")
0^59^B24367683^B21565979
"RTN","SROMENU",1,0)
SROMENU ;B'HAM ISC/MAM - OPERATION MENU OPTIONS ;27 Sep 2013  1:03 PM
"RTN","SROMENU",2,0)
 ;;3.0;Surgery;**52,67,69,104,107,100,134,175,177**;24 Jun 93;Build 89
"RTN","SROMENU",3,0)
TECH ; sromen-anes tech
"RTN","SROMENU",4,0)
 G:'$G(SRTN) NO D ^SROLOCK G:SROLOCK END
"RTN","SROMENU",5,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",6,0)
 K DR,SRODR S DR="[SROMEN-ANES TECH]",DIE=130,DA=SRTN D ^DIE I $D(SRODR) D ^SROCON1
"RTN","SROMENU",7,0)
 G END
"RTN","SROMENU",8,0)
OP ; sromen-op
"RTN","SROMENU",9,0)
 D RT K SRODR
"RTN","SROMENU",10,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",11,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",12,0)
 ; RBD - 10/15/13 - PATCH 177 - Code Set labeling issue fixed.
"RTN","SROMENU",13,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SROMENU",14,0)
 ; End 177
"RTN","SROMENU",15,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DR="[SROMEN-OPER]",DA=SRTN,ST="OPERATION"_$S(SROLOCK:" **LOCKED",1:"") D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",16,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",17,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",18,0)
 S SROERR=SRTN G END
"RTN","SROMENU",19,0)
COMP ; sromen-comp
"RTN","SROMENU",20,0)
 K SRODR
"RTN","SROMENU",21,0)
 G:'$G(SRTN) NO D ^SROLOCK G:SROLOCK END
"RTN","SROMENU",22,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",23,0)
 K DR W @IOF,! S DIE=130,DA=SRTN,DR="[SROMEN-COMP]" D ^DIE
"RTN","SROMENU",24,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",25,0)
 G END
"RTN","SROMENU",26,0)
SHORT ; sromen-out
"RTN","SROMENU",27,0)
 D RT K SRODR
"RTN","SROMENU",28,0)
 G:'$G(SRTN) NO
"RTN","SROMENU",29,0)
 ; RBD - 10/15/13 - PATCH 177 - Code set labeling issue fixed.
"RTN","SROMENU",30,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SROMENU",31,0)
 ; End 177
"RTN","SROMENU",32,0)
 D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",33,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",34,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,DR="[SROMEN-OUT]",ST="SHORT SCREEN"_$S(SROLOCK:" **LOCKED",1:"") D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",35,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",36,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",37,0)
 S SROERR=SRTN G END
"RTN","SROMENU",38,0)
VERF ; Time Out Verified Utilizing Checklist
"RTN","SROMENU",39,0)
 D RT K SRODR
"RTN","SROMENU",40,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",41,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",42,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,DR="[SROMEN-VERF]",ST="TIME OUT CHECKLIST"_$S(SROLOCK:" **LOCKED",1:"") D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",43,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",44,0)
 S SROERR=SRTN G END
"RTN","SROMENU",45,0)
PACU ; sromen-pacu
"RTN","SROMENU",46,0)
 D RT K SRODR
"RTN","SROMENU",47,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",48,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",49,0)
 K DR S DIE=130,DA=SRTN,ST="PACU"_$S(SROLOCK:" **LOCKED",1:""),DR="[SROMEN-PACU]" D EN2^SROVAR,^SRCUSS I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",50,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",51,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SROMENU",52,0)
 G END
"RTN","SROMENU",53,0)
POST ; sromen-post
"RTN","SROMENU",54,0)
 ; JAS - 11/13/13 - PATCH 177 - Added next line to fix code set labeling issue.
"RTN","SROMENU",55,0)
 K SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SROMENU",56,0)
 D RT K SRODR
"RTN","SROMENU",57,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",58,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",59,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,ST="POST OPERATION"_$S(SROLOCK:" **LOCKED",1:""),DR="[SROMEN-POST]" D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",60,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",61,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",62,0)
 S SROERR=SRTN G END
"RTN","SROMENU",63,0)
REF ; sromen-refer
"RTN","SROMENU",64,0)
 K SRODR
"RTN","SROMENU",65,0)
 G:'$G(SRTN) NO D ^SROLOCK G:SROLOCK END
"RTN","SROMENU",66,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",67,0)
 W @IOF K DR S DIE=130,DA=SRTN,DR="[SROMEN-REFER]" W !! D ^DIE
"RTN","SROMENU",68,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",69,0)
 G END
"RTN","SROMENU",70,0)
STAFF ; sromen-staff
"RTN","SROMENU",71,0)
 D RT K SRODR
"RTN","SROMENU",72,0)
 G:'$G(SRTN) NO D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",73,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",74,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,ST="SURGICAL STAFF"_$S(SROLOCK:" **LOCKED",1:""),DR="[SROMEN-STAFF]" D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",75,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",76,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",77,0)
 S SROERR=SRTN G END
"RTN","SROMENU",78,0)
START ; sromen-start
"RTN","SROMENU",79,0)
 D RT K SRODR
"RTN","SROMENU",80,0)
 G:'$G(SRTN) NO
"RTN","SROMENU",81,0)
 ; RBD - 10/15/13 - PATCH 177 - Code set labeling issue fixed.
"RTN","SROMENU",82,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SROMENU",83,0)
 ; End 177
"RTN","SROMENU",84,0)
 D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SROMENU",85,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROMENU",86,0)
 K DR S SRDTIME=DTIME,DTIME=3600,DIE=130,DA=SRTN,ST="STARTUP"_$S(SROLOCK:" **LOCKED",1:""),DR="[SROMEN-START]" D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I $D(Q3("VIEW")) K Q3("VIEW") G END
"RTN","SROMENU",87,0)
 I '$P(^SRF(SRTN,0),"^",20) D ^SROPCE1
"RTN","SROMENU",88,0)
 I $D(SRODR) D ^SROCON1
"RTN","SROMENU",89,0)
 S SROERR=SRTN G END
"RTN","SROMENU",90,0)
REV ; review request information (request menu)
"RTN","SROMENU",91,0)
 K SRNEWOP D ^SROPS D RT G:'$G(SRTN) END
"RTN","SROMENU",92,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SROMENU",93,0)
 K Y,DR S Q3("VIEW")="",ST="REVIEW REQUEST",DIC=130,DA=SRTN,DR="[SRSREQV]" D EN2^SROVAR,^SRCUSS K DR,SRTN
"RTN","SROMENU",94,0)
 G END
"RTN","SROMENU",95,0)
NO ;
"RTN","SROMENU",96,0)
 W !!,"An operative procedure must be selected to use this option.",!
"RTN","SROMENU",97,0)
 W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SROMENU",98,0)
END ;
"RTN","SROMENU",99,0)
 I $D(SROERR) D ^SROERR0
"RTN","SROMENU",100,0)
 I $G(SRTN) D UNLOCK^SROUTL(SRTN)
"RTN","SROMENU",101,0)
 K SRDTIME D ^SRSKILL W @IOF
"RTN","SROMENU",102,0)
 Q
"RTN","SROMENU",103,0)
RT ; start RT logging
"RTN","SROMENU",104,0)
 I $G(SRTN),$D(XRTL) S XRTN="SROMENU" D T0^%ZOSV
"RTN","SROMENU",105,0)
 Q
"RTN","SRONEW")
0^46^B36010808^B35630421
"RTN","SRONEW",1,0)
SRONEW ;BIR/MAM - ENTER A NEW CASE ;11/01/2011
"RTN","SRONEW",2,0)
 ;;3.0;Surgery;**3,23,26,30,47,58,48,67,107,100,144,175,176,177**;24 Jun 93;Build 89
"RTN","SRONEW",3,0)
 ;
"RTN","SRONEW",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRONEW",5,0)
 ;
"RTN","SRONEW",6,0)
DEAD S SRSOUT=0,X=$P($G(VADM(6)),"^") I X D  I SRSOUT D ^SRSKILL G ^SROP
"RTN","SRONEW",7,0)
 .S SRDEATH=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W @IOF,!,?1,VADM(1)_"   "_VA("PID")_"        * Died "_SRDEATH_" *"
"RTN","SRONEW",8,0)
 .W !!,$C(7) K DIR S DIR("A",1)=">>> The patient you have selected died on "_SRDEATH_"."
"RTN","SRONEW",9,0)
 .S DIR("A")="    Are you sure this is the correct patient ? ",DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR
"RTN","SRONEW",10,0)
 .W @IOF I 'Y!$D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SRONEW",11,0)
 .W !,"Entering a new surgical case for "_VADM(1)_".",!!
"RTN","SRONEW",12,0)
DATE K %DT W ! S %DT("A")="Select the Date of Operation: ",%DT="AEX" D ^%DT I Y<0 W !!,"When entering a new surgery case, a date MUST be entered.  If you do not",!,"know the date of operation, enter this patient on the Waiting List."
"RTN","SRONEW",13,0)
 I Y<0 D CONT G:"Yy"'[SRYN END G DATE
"RTN","SRONEW",14,0)
 G:Y'>0 END S SRSDATE=Y
"RTN","SRONEW",15,0)
ODP N SRSODP
"RTN","SRONEW",16,0)
 K DIR S DIR(0)="130,616",DIR("A")="Desired Procedure Date" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRONEW",17,0)
 I Y=""!(X["^")!(Y<SRSDATE) W !!,"The Desired Procedure Date MUST be entered and should be greater than or equal  to date of operation.  Enter '^' to exit.",! G ODP
"RTN","SRONEW",18,0)
 S SRSODP=+Y
"RTN","SRONEW",19,0)
 S SRSC1=1 K SRCTN S SRSDPT=DFN,SRSCC="" D CON G:SRSCC="^" END
"RTN","SRONEW",20,0)
OP D ^SROPROC I SRSOUT G END
"RTN","SRONEW",21,0)
 S SRPRIN=SRSOP
"RTN","SRONEW",22,0)
OPD ; Principal Preoperative Diagnosis
"RTN","SRONEW",23,0)
 K DIR S DIR(0)="130,32",DIR("A")="Principal Preoperative Diagnosis" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRONEW",24,0)
 I Y=""!(X["^") W !!,"A Principal Preoperative Diagnosis must be entered",!,"when creating a new case. Enter '^' to exit.",! G OPD
"RTN","SRONEW",25,0)
 I X[";" W !,"The Principal Preoperative Diagnosis cannot contain a semicolon (;).",!,"Please re-enter the Diagnosis, using commas in place of the semicolons." G OPD
"RTN","SRONEW",26,0)
 S SRSOPD=Y
"RTN","SRONEW",27,0)
 W !!,"The information entered into the Principal Preoperative Diagnosis field",!,"has been transferred into the Indications for Operation field.",!,"The Indications for Operation field can be updated later if necessary.",!
"RTN","SRONEW",28,0)
DOC W ! S DIC("A")="Select Surgeon: ",DIC=200,DIC(0)="QEAM",SRSDOC="" D ^DIC K DIC("A") I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRONEW",29,0)
 I Y<0!(X["^") W !!,"A Surgeon must be entered when creating a case.  Enter '^' to exit.",! G DOC
"RTN","SRONEW",30,0)
 S (DA,SRSDOC)=+Y
"RTN","SRONEW",31,0)
 S RESTRICT="130,.14",Y=SRSDOC K SROK D KEY^SROXPR I '$D(SROK) W !!,"The person you selected does not have the appropriate keys necessary to be",!,"entered as a surgeon.  Please make another selection.",! K SRSDOC,DA,DIC G DOC
"RTN","SRONEW",32,0)
CASE ; create case in SURGERY file
"RTN","SRONEW",33,0)
 K DA,DIC,DD,DO,DINUM,SRTN S X=DFN,DIC="^SRF(",DIC(0)="L" D FILE^DICN K DIC,DO,DINUM S SRTN=+Y G:'$$LOCK^SROUTL(SRTN) DEL
"RTN","SRONEW",34,0)
 S ^SRF(SRTN,8)=SRSITE("DIV"),^SRF(SRTN,"OP")=""
"RTN","SRONEW",35,0)
 S ^SRF(SRTN,52)="0^0^0^0^0^0"  ; default flash sterilization fields to zero
"RTN","SRONEW",36,0)
 K DIE,DR S DA=SRTN,DIE=130,DR=".09////"_SRSDATE_";26////"_SRPRIN_";68////"_SRPRIN_";.14////"_SRSDOC_";616////"_SRSODP_";612////"_SRSODP_";613////"_$$DSMP^SRSDT D ^DIE K DR
"RTN","SRONEW",37,0)
ASURG ; attending surgeon
"RTN","SRONEW",38,0)
 K DIR S DIR(0)="130,.164",DIR("A")="Attending Surgeon" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRONEW",39,0)
 I Y=""!(X["^") W !!,"An Attending Surgeon must be entered when creating a case. Enter '^' to exit.",! G ASURG
"RTN","SRONEW",40,0)
 S SRATTND=+Y
"RTN","SRONEW",41,0)
SPEC W ! K DIC S DIC=137.45,DIC(0)="QEAMZ",DIC("A")="Select Surgical Specialty: ",DIC("S")="I '$P(^(0),""^"",3)" D ^DIC I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRONEW",42,0)
 I Y<0!(X["^") W !!,"To create a surgical case, a Surgical Specialty MUST be selected.  Enter '^'",!,"to exit.",! G SPEC
"RTN","SRONEW",43,0)
 S SRSS=+Y
"RTN","SRONEW",44,0)
UPDATE ; update case in SURGERY file
"RTN","SRONEW",45,0)
 S DA=SRTN,DIE=130,DR=".04////"_SRSS_";.164////"_SRATTND_";32////"_SRSOPD D ^DIE K DR
"RTN","SRONEW",46,0)
 S SRSOPD(1)=SRSOPD D WP^DIE(130,SRTN_",",55,"A","SRSOPD")
"RTN","SRONEW",47,0)
 ; Brief Clinical History
"RTN","SRONEW",48,0)
 K DR S DR="60T",DA=SRTN,DIE=130 W ! D ^DIE
"RTN","SRONEW",49,0)
 K DR,DA S DR="[SRO-NOCOMP]",DA=SRTN,DIE=130 D ^DIE K DR
"RTN","SRONEW",50,0)
 S ^SRF(SRTN,8)=SRSITE("DIV") D ^SROXRET
"RTN","SRONEW",51,0)
DIE D ^SROBLOD K DR,DIE,DA S DR="38////"_BLOOD_";40////"_CROSSM,DA=SRTN,DIE=130 D ^DIE K DR,DA,DIE
"RTN","SRONEW",52,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SRONEW",53,0)
 S DR="[SRSRES1]",DIE=130,DA=SRTN D ^DIE,RT S ST="NEW SURGERY" D EN2^SROVAR
"RTN","SRONEW",54,0)
 S SPD=$$CHKS^SRSCOR(SRTN)
"RTN","SRONEW",55,0)
 K DR S DR="[SRSRES-ENTRY]",DIE=130,DA=SRTN D ^SRCUSS,RISK^SROAUTL3,^SROPCE1
"RTN","SRONEW",56,0)
 I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SRONEW",57,0)
 I $D(SRCTN) D
"RTN","SRONEW",58,0)
 .S SRCTN(.02)=$P(^SRF(SRCTN,0),"^",2),SRCTN(10)=$P($G(^SRF(SRCTN,31)),"^",4),SRCTN(11)=$P($G(^SRF(SRCTN,31)),"^",5)
"RTN","SRONEW",59,0)
 .S DIE=130,DR=".02////"_SRCTN(.02)_";10////"_SRCTN(10)_";11////"_SRCTN(11)_";35////"_SRCTN_";614////"_$P(SRCTN(10),"."),DA=SRTN D ^DIE
"RTN","SRONEW",60,0)
 .S DR="35////"_SRTN,DA=SRCTN,DIE=130 D ^DIE
"RTN","SRONEW",61,0)
 D UNLOCK^SROUTL(SRTN),^SROERR
"RTN","SRONEW",62,0)
 Q
"RTN","SRONEW",63,0)
DEL S DA=SRTN,DIK="^SRF(" D ^DIK
"RTN","SRONEW",64,0)
END K SRTN D ^SRSKILL
"RTN","SRONEW",65,0)
 Q
"RTN","SRONEW",66,0)
CONT ; continue new entry ?
"RTN","SRONEW",67,0)
 W !!,"Do you want to continue  ?  YES//  " R SRYN:DTIME I '$T S SRYN="N" Q
"RTN","SRONEW",68,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y" I "YyNn"'[SRYN W !!,"Enter RETURN if you want to re-enter a date and continue creating a new",!,"case, or 'NO' to leave this option." G CONT
"RTN","SRONEW",69,0)
 Q
"RTN","SRONEW",70,0)
RT ;start RT logging
"RTN","SRONEW",71,0)
 I $D(XRTL) S XRTN="SRONEW" D T0^%ZOSV
"RTN","SRONEW",72,0)
 Q
"RTN","SRONEW",73,0)
CON ; check for concurrent case
"RTN","SRONEW",74,0)
 S SRSCON=0,SRDT=SRSDATE-.0001 F  S SRDT=$O(^SRF("AC",SRDT)) Q:'SRDT!($E(SRDT,1,7)'=SRSDATE)!(SRSCON)  S (SRSCC,SRSCON)=0 F  S SRSCC=$O(^SRF("AC",SRDT,SRSCC)) Q:'SRSCC  D  Q:SRSCON
"RTN","SRONEW",75,0)
 .I ^(SRSCC)=SRSDPT,'$P($G(^SRF(SRSCC,"CON")),"^"),$P($G(^SRF(SRSCC,"NON")),"^")'="Y",'$P($G(^SRF(SRSCC,30)),"^"),'$P($G(^SRF(SRSCC,.2)),"^",12),'$P($G(^SRF(SRSCC,"LOCK")),"^") S SRSCON=1
"RTN","SRONEW",76,0)
 .I SRSCON D CC^SRSREQ I '$D(SRCTN) S SRSCON=0
"RTN","SRONEW",77,0)
 Q
"RTN","SRONOP")
0^47^B25659962^B25370271
"RTN","SRONOP",1,0)
SRONOP ;B;HAM ISC/MAM - NON-O.R. PROCEDURES ; [ 01/30/01  1:07 PM ]
"RTN","SRONOP",2,0)
 ;;3.0;Surgery;**44,58,64,67,70,100,177**;24 Jun 93;Build 89
"RTN","SRONOP",3,0)
 K SROEDIT S:$D(^XUSEC("SROEDIT",DUZ))&'$D(DUZ("SAV")) SROEDIT=1 S (SRNEWOP,SRSOUT)=0 W @IOF,!
"RTN","SRONOP",4,0)
 K DIC S DIC("A")="Select Patient: ",DIC=2,DIC(0)="QEAMZ" D ^DIC K DIC I Y<0 S SRSOUT=1 G END
"RTN","SRONOP",5,0)
 S DFN=+Y D DEM^VADPT S SRNM=VADM(1) D HDR
"RTN","SRONOP",6,0)
ADT S (SRBACK,SRDT,CNT)=0 F  S SRDT=$O(^SRF("ADT",DFN,SRDT)) Q:'SRDT!SRSOUT!SRNEWOP!$D(SRTN)!SRBACK  S SROP=0 F  S SROP=$O(^SRF("ADT",DFN,SRDT,SROP)) Q:'SROP!$D(SRTN)!SRSOUT!SRNEWOP!SRBACK  D LIST
"RTN","SRONOP",7,0)
 G:SRBACK ADT G:$D(SRTN) ASK G:SRNEWOP ^SRONOP1 G:SRSOUT END
"RTN","SRONOP",8,0)
 I $D(SROEDIT) S CNT=CNT+1,SRCASE(CNT)="" W !,CNT_".",?4,"NEW PROCEDURE"
"RTN","SRONOP",9,0)
SEL W !!,"Select Procedure: " R X:DTIME I '$T!("^"[X) S SRSOUT=1 G END
"RTN","SRONOP",10,0)
 I $D(SROEDIT),X="NEW"!(X="new")!(X=CNT) G ^SRONOP1
"RTN","SRONOP",11,0)
 I '$D(SRCASE(X)) W !!,"Enter the number corresponding to the procedure you want to edit." W:$D(SROEDIT) !,"Enter '"_CNT_"' or 'NEW' to create a new procedure" G SEL
"RTN","SRONOP",12,0)
 S SRTN=SRCASE(X)
"RTN","SRONOP",13,0)
ASK S SROP=SRTN,SRSDATE=$P(^SRF(SRTN,0),"^",9) I $E(SRSDATE,1,7)>DT D FUTURE G:SRSOUT END I '$D(SRTN) D HDR G ADT
"RTN","SRONOP",14,0)
 Q:'$D(SROEDIT)  D HDR W !,?1 D CASE W !!,"Do you want to edit or delete this procedure ? "
"RTN","SRONOP",15,0)
 W !!,"1. Edit",!,"2. Delete",!!,"Select Number:  1// " R X:DTIME I '$T!(X["^") S SRSOUT=1 G END
"RTN","SRONOP",16,0)
 S:X="" X=1 I X<1!(X>2) W !!,"Enter '1' to edit information related to this procedure, or '2' to delete",!,"this procedure from your records.",!!,"Press RETURN to continue  " R X:DTIME G ASK
"RTN","SRONOP",17,0)
 I X=1 K SROEDIT Q
"RTN","SRONOP",18,0)
 D DEL^SRONOP1
"RTN","SRONOP",19,0)
END I 'SRSOUT W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SRONOP",20,0)
 D ^SRSKILL K SROEDIT,SRTN W @IOF
"RTN","SRONOP",21,0)
 Q
"RTN","SRONOP",22,0)
EDIT ; edit procedure
"RTN","SRONOP",23,0)
 Q:'$D(SRTN)  I '$D(SRNM),$D(VADM(1)) S SRNM=VADM(1)
"RTN","SRONOP",24,0)
 I '$D(SRNM) S DFN=$P(^SRF(SRTN,0),"^") D DEM^VADPT S SRNM=VADM(1)
"RTN","SRONOP",25,0)
 D ^SROLOCK I SROLOCK S Q3("VIEW")=""
"RTN","SRONOP",26,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SRONOP",27,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SRONOP",28,0)
 D RT K DR S SRDTIME=DTIME,DTIME=3600,SRSOUT=1,ST="NON-O.R. PROCEDURE"_$S(SROLOCK:" **LOCKED",1:""),DIE=130,DR="[SRNON-OR]",DA=SRTN D EN2^SROVAR,^SRCUSS S DTIME=SRDTIME I 'SROLOCK D ^SROPCE1
"RTN","SRONOP",29,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SRONOP",30,0)
 I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SRONOP",31,0)
 D ^SRSKILL
"RTN","SRONOP",32,0)
 Q
"RTN","SRONOP",33,0)
LIST ; list case
"RTN","SRONOP",34,0)
 Q:$P($G(^SRF(SROP,"NON")),"^")'="Y"
"RTN","SRONOP",35,0)
 I $Y+5>IOSL S SRBACK=0 D CONT Q:$D(SRTN)!SRSOUT!SRNEWOP  D HDR Q:SRBACK
"RTN","SRONOP",36,0)
 S CNT=CNT+1,SRSDATE=$P(^SRF(SROP,0),"^",9) W !,CNT_". "
"RTN","SRONOP",37,0)
CASE S SROPER=$P(^SRF(SROP,"OP"),"^"),SRCASE(CNT)=SROP D LOCK
"RTN","SRONOP",38,0)
 K SROPS,MM,MMM S:$L(SROPER)<60 SROPS(1)=SROPER I $L(SROPER)>59 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRONOP",39,0)
 S Y=SRSDATE D D^DIQ S SRSDATE=$P(Y,"@")_" "_$P(Y,"@",2)
"RTN","SRONOP",40,0)
 W SRSDATE,?20,SROPS(1) I $D(SROPS(2)) W !,?20,SROPS(2) I $D(SROPS(3)) W !,?20,SROPS(3) I $D(SROPS(4)) W !,?20,SROPS(4)
"RTN","SRONOP",41,0)
 W !
"RTN","SRONOP",42,0)
 Q
"RTN","SRONOP",43,0)
LOCK ; case locked?
"RTN","SRONOP",44,0)
 I $D(SRTN),$P($G(^SRF(SRTN,"LOCK")),"^") S SROPER=SROPER_" **LOCKED**"
"RTN","SRONOP",45,0)
 Q
"RTN","SRONOP",46,0)
LOOP ; break procedure if greater than 60 characters
"RTN","SRONOP",47,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRONOP",48,0)
 Q
"RTN","SRONOP",49,0)
RT ; start RT logging
"RTN","SRONOP",50,0)
 I $D(XRTL) S XRTN="SRONOP" D T0^%ZOSV
"RTN","SRONOP",51,0)
 Q
"RTN","SRONOP",52,0)
CONT W ! K DIR S DIR("A")="Select procedure or press RETURN to continue listing procedures: ",DIR(0)="FOA"
"RTN","SRONOP",53,0)
 S DIR("?",1)="Enter the number corresponding to the desired procedures"_$S($D(SROEDIT):", enter 'NEW' to",1:"")
"RTN","SRONOP",54,0)
 S DIR("?")=$S($D(SROEDIT):"create a new procedure, ",1:"")_"or press RETURN to continue listing procedures." D ^DIR Q:Y=""  I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SRONOP",55,0)
 I $D(SROEDIT),Y="NEW"!(Y="new") S SRNEWOP=1 Q
"RTN","SRONOP",56,0)
 I Y'?.N!'$D(SRCASE(+Y)) S SRBACK=1 D
"RTN","SRONOP",57,0)
 .W !!,"Enter the number corresponding to the procedure you want to edit.",!,"If the desired procedure does not appear, press RETURN to continue",!,"listing additional procedures"
"RTN","SRONOP",58,0)
 .W:$D(SROEDIT) ", or enter 'NEW' to create a new procedure" W ".",!
"RTN","SRONOP",59,0)
 I SRBACK K DIR S DIR("A")="  Press RETURN to continue. ",DIR("0")="FOA" D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SRONOP",60,0)
 I 'SRBACK S SRTN=+SRCASE(Y)
"RTN","SRONOP",61,0)
 Q
"RTN","SRONOP",62,0)
FUTURE  D HDR W !,?1 D CASE W !,$C(7) K DIR
"RTN","SRONOP",63,0)
 S DIR("A",1)=">>> The procedure you have selected has a future date.",DIR("A")="    Are you sure you have selected the correct procedure ? ",DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SRONOP",64,0)
 I 'Y K SRTN
"RTN","SRONOP",65,0)
 Q
"RTN","SRONOP",66,0)
HDR ; print heading
"RTN","SRONOP",67,0)
 W @IOF,!,?1,VADM(1)_"   "_VA("PID") S X=$P($G(VADM(6)),"^") W:X "        * Died "_$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3)_" *" W !
"RTN","SRONOP",68,0)
 Q
"RTN","SRONOP1")
0^48^B16803692^B16584848
"RTN","SRONOP1",1,0)
SRONOP1 ;BIR/MAM - NON-O.R. PROCEDURES ;06/15/05
"RTN","SRONOP1",2,0)
 ;;3.0;Surgery;**44,56,58,48,67,70,88,100,142,177**;24 Jun 93;Build 89
"RTN","SRONOP1",3,0)
 S X=$P($G(VADM(6)),"^") I X D  I SRSOUT D ^SRSKILL G ^SRONOP
"RTN","SRONOP1",4,0)
 .S SRDEATH=$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3) W @IOF,!,?1,VADM(1)_"   "_VA("PID")_"        * Died "_SRDEATH_" *"
"RTN","SRONOP1",5,0)
 .W !!,$C(7) K DIR S DIR("A",1)=">>> The patient you have selected died on "_SRDEATH_"."
"RTN","SRONOP1",6,0)
 .S DIR("A")="    Are you sure this is the correct patient ? ",DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR
"RTN","SRONOP1",7,0)
 .I 'Y!$D(DTOUT)!$D(DUOUT) S SRSOUT=1
"RTN","SRONOP1",8,0)
 W @IOF,!,"Entering a new non-O.R. procedure for "_SRNM_".",!!
"RTN","SRONOP1",9,0)
OP ; principal procedure
"RTN","SRONOP1",10,0)
 W ! K DIR S DIR(0)="130,26A",DIR("A")="Enter the Procedure: " D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRONOP1",11,0)
 S SROPER=Y
"RTN","SRONOP1",12,0)
DATE W ! K %DT S %DT="AEX",%DT("A")="Select the Date of the Procedure: " D ^%DT I X="" W !!,"The Date of the Procedure MUST be entered." G DATE
"RTN","SRONOP1",13,0)
 I Y<0!$D(DTOUT) S SRSOUT=1 G END
"RTN","SRONOP1",14,0)
 S SRSDATE=+Y
"RTN","SRONOP1",15,0)
DOC W ! K DIR S DIR("A")="Provider",DIR(0)="130,123" D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 G END
"RTN","SRONOP1",16,0)
 S SRSDOC=+Y
"RTN","SRONOP1",17,0)
SPEC W ! K DIR S DIR("A")="Medical Specialty",DIR(0)="130,125" D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 G END
"RTN","SRONOP1",18,0)
 S SRSPEC=+Y
"RTN","SRONOP1",19,0)
SUMM ; dictated summary expected?
"RTN","SRONOP1",20,0)
 N SREXPT W ! K DIR S DIR("A")="Will a summary of this procedure be dictated? (Y/N)"
"RTN","SRONOP1",21,0)
 S DIR("?",1)="This field indicates if the provider will dictate a summary of this",DIR("?",2)="procedure to be electronically signed. Enter YES if a dictated summary"
"RTN","SRONOP1",22,0)
 S DIR("?")="is expected. Enter NO or leave blank if no summary is expected.",DIR(0)="Y" D ^DIR K DIR
"RTN","SRONOP1",23,0)
 I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 G END
"RTN","SRONOP1",24,0)
 S SREXPT=Y
"RTN","SRONOP1",25,0)
 K DIC,DO,DA,DD,DINUM,SRTN S X=DFN,DIC="^SRF(",DIC(0)="L",DLAYGO=130 D FILE^DICN K DD,DO,DIC,DLAYGO S SRTN=+Y
"RTN","SRONOP1",26,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK S Q3("VIEW")=""
"RTN","SRONOP1",27,0)
 K DR S DIE=130,DR="120///"_SRSDATE_";26///"_SROPER_";118///Y;123////"_SRSDOC_";125////"_SRSPEC_";1004////"_SREXPT,DA=SRTN D ^DIE K DR,DA,DIE S ^SRF(SRTN,8)=SRSITE("DIV")
"RTN","SRONOP1",28,0)
 D RT S SRSOUT=1,SRN=$E(SRNM,1,20),Q3(1)="** NON-O.R. PROCEDURE **  CASE #"_SRTN_"  "_SRN_" "
"RTN","SRONOP1",29,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SRONOP1",30,0)
 S SRDTIME=DTIME,DTIME=3600,ST="NON-O.R. PROCEDURE",DIE=130,DR="[SRNON-OR]",DA=SRTN D ^SRCUSS S DTIME=SRDTIME D ^SROPCE1 S SRSOUT=0
"RTN","SRONOP1",31,0)
 S SRSOP=SROPER,SRL=$P(^SRF(SRTN,"NON"),"^",2) S ORL=$S(SRL:SRL_";SC(",1:"") D ^SROERR
"RTN","SRONOP1",32,0)
 D ^SRSKILL I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SRONOP1",33,0)
 Q
"RTN","SRONOP1",34,0)
END I SRSOUT W !!,"No action taken.",!!,"Press RETURN to continue  " R X:DTIME
"RTN","SRONOP1",35,0)
 D ^SRSKILL K SRTN W @IOF
"RTN","SRONOP1",36,0)
 Q
"RTN","SRONOP1",37,0)
RT ; start RT logging
"RTN","SRONOP1",38,0)
 I $D(XRTL) S ZRTN="SRONOP1" D T0^%ZOSV
"RTN","SRONOP1",39,0)
 Q
"RTN","SRONOP1",40,0)
DEL ; delete procedure
"RTN","SRONOP1",41,0)
 W !!,"Are you sure that you want to remove this procedure from your ",!,"records ?  NO// " R X:DTIME I '$T!(X="^") W !!,"No action taken..." Q
"RTN","SRONOP1",42,0)
 S X=$E(X) S:X="" X="N" I "YyNn"'[X W !!,"Enter RETURN or 'NO' if this procedure should remain on file.  Enter 'YES'",!,"to delete this procedure."
"RTN","SRONOP1",43,0)
 I "Nn"[X W !!,"No action taken." Q
"RTN","SRONOP1",44,0)
 I $P($G(^SRF(SRTN,"TIU")),"^",3) D EN^DDIOL("This case can't be deleted, there is a Procedure Report (Non-O.R.) associated with it.",,"!!,?2,$C(7)") Q
"RTN","SRONOP1",45,0)
 W !!,"Deleting procedure..."
"RTN","SRONOP1",46,0)
 S SRX=$P($G(^SRF(SRTN,0)),"^",15) I SRX S SRVSIT=SRX D DEL^SROPCEP ; delete visit
"RTN","SRONOP1",47,0)
 I $D(^SRO(136,SRTN,0)) S DA=SRTN,DIK="^SRO(136," D ^DIK K DA,DIK ; remove entry in file 136
"RTN","SRONOP1",48,0)
 D DEL^SROERR S DA=SRTN,DIK="^SRF(" D ^DIK
"RTN","SRONOP1",49,0)
 Q
"RTN","SRONP2")
0^3^B17930608^B17607439
"RTN","SRONP2",1,0)
SRONP2 ;BIR/ADM - PROCEDURE REPORT (NON-OR) ;07/26/04  9:45 AM
"RTN","SRONP2",2,0)
 ;;3.0;Surgery;**132,142,177**;24 Jun 93;Build 89
"RTN","SRONP2",3,0)
 Q
"RTN","SRONP2",4,0)
OPTOP(SRTN) ; send op-top to ^TMP
"RTN","SRONP2",5,0)
 ; SRTN   - case number in file 130
"RTN","SRONP2",6,0)
 ;
"RTN","SRONP2",7,0)
 N ANE,DFN,ICD,J,NUM,SR,SRATT,SRCASE,SRDIV,SRI,SRL,SRLINE,SRLOC,SRN,SROPTOP,SRSPEC,SRSTATUS,SRTECH,X,Y
"RTN","SRONP2",8,0)
 S SRCASE=SRTN,SRG=$NA(^TMP("SRNOR",$J,SRCASE)) K @SRG
"RTN","SRONP2",9,0)
 S SRI=0,SRDIV=$$SITE^SROUTL0(SRTN)
"RTN","SRONP2",10,0)
 I $P($G(^SRF(SRTN,30)),"^")!$P($G(^SRF(SRTN,31)),"^",8) D LINE(1) S @SRG@(SRI)="  * * PROCEDURE ABORTED * *" D LINE(1)
"RTN","SRONP2",11,0)
 F SRN=0:.1:1.1,"NON" S SR(SRN)=$G(^SRF(SRTN,SRN))
"RTN","SRONP2",12,0)
 S Y=$P(SR("NON"),"^",8),C=$P(^DD(130,125,0),"^",2) D:Y'="" Y^DIQ S SRSPEC=$S(Y="":"NOT ENTERED",1:$E(Y,1,25))
"RTN","SRONP2",13,0)
 S SRLOC="NOT ENTERED",SRL=$P(SR("NON"),"^",2) S:SRL SRLOC=$E($P(^SC(SRL,0),"^"),1,25)
"RTN","SRONP2",14,0)
 D LINE(1) S @SRG@(SRI)="Med. Specialty: "_SRSPEC,@SRG@(SRI)=@SRG@(SRI)_$$SPACE(44)_"Location: "_SRLOC
"RTN","SRONP2",15,0)
 S X=$P($G(^SRF(SRTN,33)),"^",2) D LINE(2) S @SRG@(SRI)="Principal Diagnosis: " D
"RTN","SRONP2",16,0)
 .I X="" S @SRG@(SRI)=@SRG@(SRI)_"NOT ENTERED" Q
"RTN","SRONP2",17,0)
 .D LINE(1) S @SRG@(SRI)="  "_X
"RTN","SRONP2",18,0)
 .S @SRG@(SRI)=@SRG@(SRI)
"RTN","SRONP2",19,0)
 .N OTH,CNT S (OTH,CNT)=0 F  S OTH=$O(^SRF(SRTN,15,OTH)) Q:'OTH  S CNT=CNT+1 D DIAG
"RTN","SRONP2",20,0)
 S Y=$P(SR("NON"),"^",6),C=$P(^DD(130,123,0),"^",2) D:Y'="" Y^DIQ D LINE(2) S @SRG@(SRI)="Provider: "_Y
"RTN","SRONP2",21,0)
 S X=$P($G(SR(0)),"^",12),SRSTATUS=$S(X="I":"INPATIENT",X="O":"OUTPATIENT",1:"NOT ENTERED")
"RTN","SRONP2",22,0)
 S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(50)_"Patient Status: "_SRSTATUS
"RTN","SRONP2",23,0)
 S Y=$P(SR("NON"),"^",7),C=$P(^DD(130,124,0),"^",2) D:Y'="" Y^DIQ,N(28) S:Y="" Y="N/A" D LINE(1) S @SRG@(SRI)="Attending: "_Y
"RTN","SRONP2",24,0)
 D RS S:SRATT="" SRATT="NOT ENTERED" D LINE(1) S @SRG@(SRI)="Attending Code: "_SRATT
"RTN","SRONP2",25,0)
 S Y=$P(SR(.3),"^",4),C=$P(^DD(130,.34,0),"^",2) D:Y'="" Y^DIQ S:Y="" Y="N/A" D LINE(2) S @SRG@(SRI)="Attend Anesth: "_Y
"RTN","SRONP2",26,0)
 S X=$P(SR(.3),"^",6),X=$S(X:$P(^SRO(132.95,X,0),"^"),1:"N/A")
"RTN","SRONP2",27,0)
 D LINE(1) S @SRG@(SRI)="Anesthesia Supervisor Code: "_X
"RTN","SRONP2",28,0)
 S Y=$P(SR(.3),"^"),C=$P(^DD(130,.31,0),"^",2) D:Y'="" Y^DIQ S:Y="" Y="N/A" D LINE(1) S @SRG@(SRI)="Anesthetist: "_Y
"RTN","SRONP2",29,0)
 D LINE(2) S @SRG@(SRI)="Anesthesia Technique(s): " D
"RTN","SRONP2",30,0)
 .I '$O(^SRF(SRTN,6,0)) S @SRG@(SRI)=@SRG@(SRI)_"N/A" Q
"RTN","SRONP2",31,0)
 .S ANE=0 F  S ANE=$O(^SRF(SRTN,6,ANE)) Q:'ANE  D ANE
"RTN","SRONP2",32,0)
 D TECH I $E(SRTECH,1,2)'="NO" S X=$P($G(^SRF(SRTN,31)),"^",9),X=$S(X="N":"NO",X="Y":"YES",1:"") I X'="" D LINE(2) S @SRG@(SRI)="Diagnostic/Therapeutic: "_X
"RTN","SRONP2",33,0)
 D ^SRONP0
"RTN","SRONP2",34,0)
 Q
"RTN","SRONP2",35,0)
DIAG D LINE(1) S X=$G(^SRF(SRTN,15,OTH,0)),@SRG@(SRI)=$S(CNT=1:" Other: ",1:"        ")_$P(X,"^"),ICD=$P(X,"^",3)
"RTN","SRONP2",36,0)
 S:ICD ICD=$P($$ICD^SROICD(SRTN,ICD),"^",2)
"RTN","SRONP2",37,0)
 S ICD=$S(ICD:ICD,1:"NOT ENTERED"),@SRG@(SRI)=@SRG@(SRI)_$$SPACE(50)_"ICD"_$$ICD910^SROICD(SRTN)_" Code: "_ICD
"RTN","SRONP2",38,0)
 Q
"RTN","SRONP2",39,0)
N(SRL) N SRNM I $L(Y)>SRL S SRNM=$P(Y,",")_","_$E($P(Y,",",2))_".",Y=SRNM
"RTN","SRONP2",40,0)
 Q
"RTN","SRONP2",41,0)
TECH N SRT,SRZ D TECH^SROPRIN
"RTN","SRONP2",42,0)
 Q
"RTN","SRONP2",43,0)
ANE ; print anesthesia technique
"RTN","SRONP2",44,0)
 N A,AGNT,C,CNT
"RTN","SRONP2",45,0)
 S A=^SRF(SRTN,6,ANE,0),Y=$P(A,"^"),C=$P(^DD(130.06,.01,0),"^",2) D:Y'="" Y^DIQ D LINE(1) S Y=Y_$S($P(A,"^",3)="Y":"  (PRINCIPAL)",1:""),@SRG@(SRI)=$$SPACE(2)_Y D AGENT
"RTN","SRONP2",46,0)
 Q
"RTN","SRONP2",47,0)
AGENT ; print agents
"RTN","SRONP2",48,0)
 Q:$P(A,"^")="N"  N SRDOSE,SRY
"RTN","SRONP2",49,0)
 D LINE(1) S @SRG@(SRI)="     Agent: " I '$O(^SRF(SRTN,6,ANE,1,0)) S @SRG@(SRI)=@SRG@(SRI)_"NONE ENTERED" Q
"RTN","SRONP2",50,0)
 S (AGNT,CNT)=0 F  S AGNT=$O(^SRF(SRTN,6,ANE,1,AGNT)) Q:'AGNT  S CNT=CNT+1 D
"RTN","SRONP2",51,0)
 .S SRY=^SRF(SRTN,6,ANE,1,AGNT,0),SRDOSE=$P(SRY,"^",2)
"RTN","SRONP2",52,0)
 .S Y=$P(SRY,"^"),C=$P(^DD(130.47,.01,0),"^",2) D Y^DIQ
"RTN","SRONP2",53,0)
 .D:CNT>1 LINE(1) S @SRG@(SRI)=@SRG@(SRI)_$$SPACE(13)_Y
"RTN","SRONP2",54,0)
 .I SRDOSE S @SRG@(SRI)=@SRG@(SRI)_"   "_SRDOSE_" mg"
"RTN","SRONP2",55,0)
 Q
"RTN","SRONP2",56,0)
RS ; attending code
"RTN","SRONP2",57,0)
 I $$GET1^DID(130,.166,"","LABEL")["ATTENDING CODE" D  Q
"RTN","SRONP2",58,0)
 .S Y=$P(SR(.1),"^",10),C=$P(^DD(130,.166,0),"^",2) D Y^DIQ S SRATT=Y
"RTN","SRONP2",59,0)
 S Y=$P(SR(.1),"^",16),C=$P(^DD(130,.165,0),"^",2) D Y^DIQ S SRATT=Y
"RTN","SRONP2",60,0)
 Q
"RTN","SRONP2",61,0)
COMM(X,NUM) ; output word-processing text
"RTN","SRONP2",62,0)
 ; X = line of text to be processed
"RTN","SRONP2",63,0)
 ; NUM = left margin
"RTN","SRONP2",64,0)
 N I,J,K,Y,SRL S SRL=80-NUM
"RTN","SRONP2",65,0)
 I $L(X)<(SRL+1)!($E(X,1,SRL)'[" ") D LINE(1) S @SRG@(SRI)=$$SPACE(NUM)_X Q
"RTN","SRONP2",66,0)
 S K=1 F  D  I $L(X)<SRL+1 S X(K)=X Q
"RTN","SRONP2",67,0)
 .F I=0:1:SRL-1 S J=SRL-I,Y=$E(X,J) I Y=" " S X(K)=$E(X,1,J-1),X=$E(X,J+1,$L(X)) S K=K+1 Q
"RTN","SRONP2",68,0)
 F I=1:1:K D LINE(1) S @SRG@(SRI)=$$SPACE(NUM)_X(I)
"RTN","SRONP2",69,0)
 Q
"RTN","SRONP2",70,0)
SPACE(NUM) ; create spaces
"RTN","SRONP2",71,0)
 ; pass in position returns number of needed spaces
"RTN","SRONP2",72,0)
 I '$D(@SRG@(SRI)) S @SRG@(SRI)=""
"RTN","SRONP2",73,0)
 Q $J("",NUM-$L(@SRG@(SRI)))
"RTN","SRONP2",74,0)
LINE(NUM) ; create carriage returns
"RTN","SRONP2",75,0)
 F J=1:1:NUM S SRI=SRI+1,@SRG@(SRI)=""
"RTN","SRONP2",76,0)
 Q
"RTN","SROP")
0^55^B21934166^B21464405
"RTN","SROP",1,0)
SROP ;BIR/MAM - SELECT CASE ;08/02/11
"RTN","SROP",2,0)
 ;;3.0;Surgery;**7,44,58,64,104,176,177**;24 Jun 93;Build 89
"RTN","SROP",3,0)
 I '$D(^XUSEC("SROEDIT",DUZ))!$D(DUZ("SAV")) K SRNEWOP G ^SROPS
"RTN","SROP",4,0)
 S SRSOUT=0 K DIC S DIC("A")="Select Patient: ",DIC=2,DIC(0)="QEAM" D ^DIC K DIC I Y<0 S SRSOUT=1 G END
"RTN","SROP",5,0)
 S DFN=+Y D DEM^VADPT D HDR
"RTN","SROP",6,0)
ADT S (SRBACK,SRDT,CNT)=0 F  S SRDT=$O(^SRF("ADT",DFN,SRDT)) Q:'SRDT!SRSOUT!$D(SRTN)!SRBACK  S SROP=0 F  S SROP=$O(^SRF("ADT",DFN,SRDT,SROP)) Q:'SROP!$D(SRTN)!SRSOUT!SRBACK  D LIST
"RTN","SROP",7,0)
 G:SRBACK ADT D:SRSOUT HDR I $D(SRTN) G ENTER
"RTN","SROP",8,0)
 S CNT=CNT+1,SRCASE(CNT)="" W !,CNT,". ENTER NEW SURGICAL CASE" S SRNEWOP=1
"RTN","SROP",9,0)
OPT S SRSOUT=0 W !!!,"Select Operation: " R X:DTIME I '$T!("^"[X) S SRSOUT=1 G END
"RTN","SROP",10,0)
 I '$D(SRCASE(X)) W !!,"Enter the number of the desired operation" W $S('$D(SRNEWOP):".",1:", or '"_CNT_"' to enter a new case.") G OPT
"RTN","SROP",11,0)
 I X=CNT G ^SRONEW
"RTN","SROP",12,0)
 S SRTN=+SRCASE(X) I $P(^SRF(SRTN,0),"^",4)="" D SS^SRSCHUP I SRSOUT G END
"RTN","SROP",13,0)
ENTER ; edit or delete
"RTN","SROP",14,0)
 ;JAS - 7/31/13 - Patch 177 (NEXT LINE)
"RTN","SROP",15,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SROP",16,0)
 S SROP=SRTN,SRSDATE=$P(^SRF(SRTN,0),"^",9) D HDR I $E(SRSDATE,1,7)>DT D FUTURE G:SRSOUT END I '$D(SRTN) D HDR G ADT
"RTN","SROP",17,0)
 W !,?1 D CASE W !!,"1. Enter Information",!,"2. Review Information",!,"3. Delete Surgery Case",!!,"Select Number:  1//  " R X:DTIME I '$T!(X["^") S SRSOUT=1 G END
"RTN","SROP",18,0)
 S:X="" X=1 I X<1!(X>3)!(X'?.N) D HELP G ENTER
"RTN","SROP",19,0)
 I X=3 D ^SROPDEL G END
"RTN","SROP",20,0)
 I X=2 D RT K DR S ST="REVIEW" D EN2^SROVAR S Q3("VIEW")="",DR="[SROMEN-OPER]",DA=SRTN,DIE=130 D ^SRCUSS K Q3("VIEW") G END
"RTN","SROP",21,0)
 I '$D(^SRF(SRTN,52)),$P($G(^SRF(SRTN,.2)),"^",12)="" S ^SRF(SRTN,52)="0^0^0^0^0^0"  ; default flash sterilization fields to zero
"RTN","SROP",22,0)
 D ^SROPCE1
"RTN","SROP",23,0)
 Q
"RTN","SROP",24,0)
LIST ; list cases
"RTN","SROP",25,0)
 I $P($G(^SRF(SROP,"NON")),"^")="Y" Q
"RTN","SROP",26,0)
 S SRSCAN=1 I $P($G(^SRF(SROP,.2)),"^",10)!$P($G(^SRF(SROP,.2)),"^",12) K SRSCAN
"RTN","SROP",27,0)
 I $D(SRSCAN),$D(^SRF(SROP,30)),$P(^(30),"^") Q
"RTN","SROP",28,0)
 I $D(SRSCAN),$D(^SRF(SROP,31)),$P(^(31),"^",8) Q
"RTN","SROP",29,0)
 I $D(^SRF(SROP,37)),$P(^(37),"^") Q
"RTN","SROP",30,0)
 I $Y+5>IOSL S SRBACK=0 D SEL^SROPER Q:$D(SRTN)!(SRSOUT)  D HDR Q:SRBACK
"RTN","SROP",31,0)
 S CNT=CNT+1,SRSDATE=$P(^SRF(SROP,0),"^",9)
"RTN","SROP",32,0)
 W !,CNT_". "
"RTN","SROP",33,0)
CASE W $E(SRSDATE,4,5)_"-"_$E(SRSDATE,6,7)_"-"_$E(SRSDATE,2,3)
"RTN","SROP",34,0)
 S SROPER=$P(^SRF(SROP,"OP"),"^") I $O(^SRF(SROP,13,0)) S SROTHER=0 F  S SROTHER=$O(^SRF(SROP,13,SROTHER)) Q:'SROTHER  D OTHER
"RTN","SROP",35,0)
 D ^SROP1,LOCK K SROPS,MM,MMM S:$L(SROPER)<65 SROPS(1)=SROPER I $L(SROPER)>64 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROP",36,0)
 W ?14,SROPS(1) I $D(SROPS(2)) W !,?14,SROPS(2) I $D(SROPS(3)) W !,?14,SROPS(3) W:$D(SROPS(4)) !,?14,SROPS(4)
"RTN","SROP",37,0)
 W ! S SRCASE(CNT)=SROP_"^"_SRDT
"RTN","SROP",38,0)
 Q
"RTN","SROP",39,0)
LOCK ; case locked?
"RTN","SROP",40,0)
 I $D(SRTN),$P($G(^SRF(SRTN,"LOCK")),"^") S SROPER=SROPER_" **LOCKED**"
"RTN","SROP",41,0)
 Q
"RTN","SROP",42,0)
OTHER ; other operations
"RTN","SROP",43,0)
 S SRLONG=1 I $L(SROPER)+$L($P(^SRF(SROP,13,SROTHER,0),"^"))>235 S SRLONG=0,SROTHER=999,SROPERS=" ..."
"RTN","SROP",44,0)
 I SRLONG S SROPERS=$P(^SRF(SROP,13,SROTHER,0),"^")
"RTN","SROP",45,0)
 S SROPER=SROPER_$S(SROPERS=" ...":SROPERS,1:", "_SROPERS)
"RTN","SROP",46,0)
 Q
"RTN","SROP",47,0)
LOOP ; break procedures
"RTN","SROP",48,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<65  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROP",49,0)
 Q
"RTN","SROP",50,0)
END K SRTN D ^SRSKILL W @IOF
"RTN","SROP",51,0)
 Q
"RTN","SROP",52,0)
HELP W !!,"Enter RETURN or '1' to enter or edit information contained within one of the",!,"options found under the Operations Menu.  If you want to display a two screen",!,"overview of this case, enter '2'."
"RTN","SROP",53,0)
 W "  To delete this case from your records,",!,"enter '3'.  Please note that deleting a case will remove EVERYTHING pertaining",!,"to this operative procedure.",!
"RTN","SROP",54,0)
 W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SROP",55,0)
 Q
"RTN","SROP",56,0)
RT ; start RT logging
"RTN","SROP",57,0)
 I $D(XRTL) S XRTN="SROP" D T0^%ZOSV
"RTN","SROP",58,0)
 Q
"RTN","SROP",59,0)
HDR ; print heading
"RTN","SROP",60,0)
 W @IOF,!,?1,VADM(1)_"   "_VA("PID") S X=$P($G(VADM(6)),"^") W:X "        * DIED "_$E(X,4,5)_"/"_$E(X,6,7)_"/"_$E(X,2,3)_" *" W !
"RTN","SROP",61,0)
 Q
"RTN","SROP",62,0)
FUTURE W !,?1 D CASE W !,$C(7) K DIR
"RTN","SROP",63,0)
 S DIR("A",1)=">>> The case you have selected has a future date.",DIR("A")="    Are you sure you have selected the correct case ? ",DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROP",64,0)
 I 'Y K SRTN Q
"RTN","SROP",65,0)
 D HDR
"RTN","SROP",66,0)
 Q
"RTN","SROPCE0A")
0^56^B59645915^B42322529
"RTN","SROPCE0A",1,0)
SROPCE0A ;BIR/ADM - PCE FILING STATUS REPORT, LONG FORM ;03/17/05
"RTN","SROPCE0A",2,0)
 ;;3.0;Surgery;**58,62,69,77,50,86,88,127,142,177**;24 Jun 93;Build 89
"RTN","SROPCE0A",3,0)
 ;
"RTN","SROPCE0A",4,0)
 ; Reference to ^ECC(723 supported by DBIA #205
"RTN","SROPCE0A",5,0)
 ;
"RTN","SROPCE0A",6,0)
 S (SRFCPT,SRQCPT,SRFICD,SRQICD,SRUCPT,SRUICD)=0
"RTN","SROPCE0A",7,0)
 N SRIMPDT,ICD
"RTN","SROPCE0A",8,0)
 S (SRFICD(9),SRFICD(10),SRQICD(9),SRQICD(10),SRUICD(9),SRUICD(10))=0
"RTN","SROPCE0A",9,0)
 D HDR
"RTN","SROPCE0A",10,0)
 F  S SRSDT=$O(^SRF("AC",SRSDT)) Q:'SRSDT!(SRSDT>SRSEDT)!SRSOUT  D
"RTN","SROPCE0A",11,0)
 . S SRTN=0 F  S SRTN=$O(^SRF("AC",SRSDT,SRTN)) Q:'SRTN  D
"RTN","SROPCE0A",12,0)
 .. I $D(^SRF(SRTN,0)),$$DIV^SROUTL0(SRTN),$P($G(^SRF(SRTN,30)),"^")="" D UTIL Q:SRSOUT
"RTN","SROPCE0A",13,0)
 D:'SRSOUT TOTAL
"RTN","SROPCE0A",14,0)
 Q
"RTN","SROPCE0A",15,0)
TOTAL D ICDCHK D:$Y+10>IOSL PAGE Q:SRSOUT
"RTN","SROPCE0A",16,0)
 W !,?28,"CPT",?36,$S(ICD=9:"ICD9",ICD=10:"ICD10",ICD=910:"ICD9   ICD10",1:"")
"RTN","SROPCE0A",17,0)
 W !,?20,"CASES",?27,"CODES",?35,"CODES" W:ICD=910 ?43,"CODES"
"RTN","SROPCE0A",18,0)
 W !,?13,"FILED: ",$J(CNT(1),5),?27,$J(SRFCPT,5) W:ICD=910 ?35,$J(SRFICD(9),5),?43,$J(SRFICD(10),5) W:ICD=9 ?35,$J(SRFICD(9),5) W:ICD=10 ?35,$J(SRFICD(10),5)
"RTN","SROPCE0A",19,0)
 W !,?9,"NOT FILED: "_$J(CNT(4),5) F I=1:1:5 S CNT(6)=CNT(6)+CNT(I)
"RTN","SROPCE0A",20,0)
 W:CNT(5) !,?9,"UNCERTAIN: "_$J(CNT(5),5) W !,?20,"-----",?27,"-----",?35,"-----" W:ICD=910 ?43,"-----"
"RTN","SROPCE0A",21,0)
 W !,?13,"TOTAL: ",$J(CNT(6),5),?27,$J(SRFCPT+SRQCPT+SRUCPT,5)
"RTN","SROPCE0A",22,0)
 W:ICD=9!(ICD=10) ?35,$J(SRFICD(ICD)+SRQICD(ICD)+SRUICD(ICD),5) W:ICD=910 ?35,$J(SRFICD(9)+SRQICD(9)+SRUICD(9),5),?43,$J(SRFICD(10)+SRQICD(10)+SRUICD(10),5)
"RTN","SROPCE0A",23,0)
 Q
"RTN","SROPCE0A",24,0)
UTIL ; process case
"RTN","SROPCE0A",25,0)
 S SRDIV=$P($G(^SRF(SRTN,8)),"^") I SRDIV S SRSPS=$O(^SRO(133,"B",SRDIV,0))
"RTN","SROPCE0A",26,0)
 I 'SRDIV S SRSPS=SRSITE
"RTN","SROPCE0A",27,0)
 S X=^SRO(133,SRSPS,0),SRPARAM=$P(X,"^",15),SRSR=$P(X,"^",19) I SRPARAM=""!(SRPARAM="N") Q
"RTN","SROPCE0A",28,0)
 S SRINOUT=$P(^SRF(SRTN,0),"^",12) I SRPARAM="O",SRINOUT'="",SRINOUT'="O" Q
"RTN","SROPCE0A",29,0)
 S SRNON=0 I $P($G(^SRF(SRTN,"NON")),"^")="Y" S SRNON=1
"RTN","SROPCE0A",30,0)
 I SRFLG=1!(SRFLG=3&('SRNON)) Q:'$P($G(^SRF(SRTN,.2)),"^",12)
"RTN","SROPCE0A",31,0)
 I SRFLG=2!(SRFLG=3&SRNON) Q:'$P($G(^SRF(SRTN,"NON")),"^",5)
"RTN","SROPCE0A",32,0)
 Q:SRFLG=2&('SRNON)  Q:SRFLG=1&(SRNON)
"RTN","SROPCE0A",33,0)
 S SRSS=$S('SRNON:$P(^SRF(SRTN,0),"^",4),1:$P(^SRF(SRTN,"NON"),"^",8)) I SRSPEC,SRSPEC'=SRSS Q
"RTN","SROPCE0A",34,0)
 S SRSSNM=$S('SRNON:$P(^SRO(137.45,SRSS,0),"^"),1:$P(^ECC(723,SRSS,0),"^"))
"RTN","SROPCE0A",35,0)
 I SRPARAM="O",SRINOUT="" S SRSTATUS=5,CNT(5)=CNT(5)+1 D CASE,CHK^SROPCE0,MISS Q
"RTN","SROPCE0A",36,0)
 I $P(^SRF(SRTN,0),"^",15) S SRSTATUS=1,CNT(1)=CNT(1)+1 D CASE,LINE Q
"RTN","SROPCE0A",37,0)
 S SRSTATUS=4,CNT(4)=CNT(4)+1 D CASE,CHK^SROPCE0,MISS
"RTN","SROPCE0A",38,0)
 Q
"RTN","SROPCE0A",39,0)
MISS ; list fields missing data
"RTN","SROPCE0A",40,0)
 Q:SRSOUT  S SRFLD="" S SRFLD=$O(SRX(SRFLD)) I SRFLD="" W !,?15,"No Missing Information" D LINE Q
"RTN","SROPCE0A",41,0)
 S SRCT=1,SRFLD="" W !,?15,"Missing Information:" F  S SRFLD=$O(SRX(SRFLD)) Q:SRFLD=""  D:$Y+5>IOSL PAGE Q:SRSOUT  W !,$J(SRCT_". ",20),SRX(SRFLD) S SRCT=SRCT+1
"RTN","SROPCE0A",42,0)
LINE I 'SRSOUT W ! F I=1:1:IOM W "-"
"RTN","SROPCE0A",43,0)
 Q
"RTN","SROPCE0A",44,0)
CASE ; print case info
"RTN","SROPCE0A",45,0)
 D:$Y+9>IOSL PAGE Q:SRSOUT  D DEM,SCHED^SROPCE0B
"RTN","SROPCE0A",46,0)
 W !,SRSDATE,?22,SRSNM,?49,SRPROV,?71,SRSSNM,?113,$S(SRSTATUS=1:"FILED",SRSTATUS=4:"NOT FILED",1:"UNCERTAIN")
"RTN","SROPCE0A",47,0)
 W !,SRTN,?22,SRSSN_"  ("_SRAGE_")",?49,SRATT,?71,SRDIAG(1),?113,$E(SRSCHED,1,17),!
"RTN","SROPCE0A",48,0)
 W:(SRFLG=3)&SRNON "NON-OR" W ?22,SRPROC(1) W:$D(SRDIAG(2)) ?71,SRDIAG(2) W:$D(SRPROC(2)) !,?22,SRPROC(2) W:$D(SRPROC(3)) !,?22,SRPROC(3) W !
"RTN","SROPCE0A",49,0)
 ; JAS - 6/10/13 - PATCH 177 - Modified to print 2nd line for Diagnosis description, if available
"RTN","SROPCE0A",50,0)
 I "1,2,3"[SRSTATUS F SRI=1:1 Q:'$D(SRCPT(SRI))&'$D(SRDX(SRI))  D:$Y+4>IOSL PAGE Q:SRSOUT  W ! D  W:$D(SRDX(SRI)) ?71,"ICD"_$$ICD910^SROICD(SRTN)_" Diagnosis Code: "_SRDX(SRI) W:$G(SRDX(SRI,2))'="" !,?83,"DX Cont.: "_SRDX(SRI,2)
"RTN","SROPCE0A",51,0)
 .I $D(SRCPT(SRI)) S SRCPT(SRI)=$S($D(SRDX(SRI)):$E(SRCPT(SRI),1,68),1:SRCPT(SRI)) W ?1,SRCPT(SRI)
"RTN","SROPCE0A",52,0)
 Q
"RTN","SROPCE0A",53,0)
DEM ; get patient demographic information
"RTN","SROPCE0A",54,0)
 S SR(0)=^SRF(SRTN,0),DFN=$P(SR(0),"^") D DEM^VADPT S SRSNM=VADM(1),SRSSN=VA("PID"),Y=SRSDT X ^DD("DD") S SRSDATE=Y,X1=$E(SRSDT,1,7),X2=$P(VADM(3),"^"),SRAGE=$E(X1,1,3)-$E(X2,1,3)-($E(X1,4,7)<$E(X2,4,7))
"RTN","SROPCE0A",55,0)
 I $L(SRSNM)>25 S X=SRSNM,SRSNM=$P(X,",")_","_$E($P(X,",",2))_"."
"RTN","SROPCE0A",56,0)
PROC ; get principal procedure and other case information
"RTN","SROPCE0A",57,0)
 K SRPROC S X=$P(^SRF(SRTN,"OP"),"^") I $L(X)<60 S SRPROC(1)=X
"RTN","SROPCE0A",58,0)
 I $L(X)>59 S K=1 F  D  I $L(X)<60 S SRPROC(K)=X Q
"RTN","SROPCE0A",59,0)
 .F I=0:1:58 S J=59-I,Y=$E(X,J) I Y=" " S SRPROC(K)=$E(X,1,J-1),X=$E(X,J+1,$L(X)) S K=K+1 Q
"RTN","SROPCE0A",60,0)
 K SRDIAG S X=$S(SRNON:$P($G(^SRF(SRTN,33)),"^",2),1:$P($G(^SRF(SRTN,34)),"^")) I $L(X)<40 S SRDIAG(1)=X
"RTN","SROPCE0A",61,0)
 I $L(X)>39 S K=1 F  D  I $L(X)<40 S SRDIAG(K)=X Q
"RTN","SROPCE0A",62,0)
 .F I=0:1:38 S J=39-I,Y=$E(X,J) I Y=" " S SRDIAG(K)=$E(X,1,J-1),X=$E(X,J+1,$L(X)) S K=K+1 Q
"RTN","SROPCE0A",63,0)
 I SRDIAG(1)="" S SRDIAG(1)="NOT ENTERED"
"RTN","SROPCE0A",64,0)
 I SRNON S X=$G(^SRF(SRTN,"NON")) S SRPROV=$S($P(X,"^",6):$P(^VA(200,$P(X,"^",6),0),"^"),1:"NOT ENTERED"),SRATT=$S($P(X,"^",7):$P(^VA(200,$P(X,"^",7),0),"^"),1:"NOT ENTERED")
"RTN","SROPCE0A",65,0)
 I 'SRNON S X=$G(^SRF(SRTN,.1)) S SRPROV=$S($P(X,"^",4):$P(^VA(200,$P(X,"^",4),0),"^"),1:"NOT ENTERED"),SRATT=$S($P(X,"^",13):$P(^VA(200,$P(X,"^",13),0),"^"),1:"NOT ENTERED")
"RTN","SROPCE0A",66,0)
 I $L(SRPROV)>20 S X=SRPROV,SRPROV=$P(X,",")_","_$E($P(X,",",2))_"."
"RTN","SROPCE0A",67,0)
 I $L(SRATT)>20 S X=SRATT,SRATT=$P(X,",")_","_$E($P(X,",",2))_"."
"RTN","SROPCE0A",68,0)
 Q:"1,2,3"'[SRSTATUS
"RTN","SROPCE0A",69,0)
CPT ; get CPT codes
"RTN","SROPCE0A",70,0)
 N SRICPT K SRCPT S SRJ=1,X=$P($G(^SRO(136,SRTN,0)),"^",2) I X D
"RTN","SROPCE0A",71,0)
 .S SRICPT=$$CPT^ICPTCOD(X,$P($G(^SRF(SRTN,0)),"^",9)),SRCPT(1)="CPT Code: "_$P(SRICPT,"^",2)_"  "_$P(SRICPT,"^",3),SRJ=SRJ+1
"RTN","SROPCE0A",72,0)
 .S:SRSTATUS=1 SRFCPT=SRFCPT+1 S:SRSTATUS=2 SRQCPT=SRQCPT+1 S:SRSTATUS=3 SRUCPT=SRUCPT+1
"RTN","SROPCE0A",73,0)
 .I X,$O(^SRO(136,SRTN,1,0)) D
"RTN","SROPCE0A",74,0)
 ..N SRI,SRX,SRY,SRZ S SRX=" Modifiers: -"
"RTN","SROPCE0A",75,0)
 ..S SRI=0 F  S SRI=$O(^SRO(136,SRTN,1,SRI)) Q:'SRI  D
"RTN","SROPCE0A",76,0)
 ...S SRZ=$P(^SRO(136,SRTN,1,SRI,0),"^"),SRY=$$MOD^ICPTMOD(SRZ,"I",$P($G(^SRF(SRTN,0)),"^",9)),SRX=SRX_$P(SRY,"^",2)_" "_$P(SRY,"^",3)
"RTN","SROPCE0A",77,0)
 ...S SRCPT(SRJ)=SRX,SRJ=SRJ+1,SRX="            -"
"RTN","SROPCE0A",78,0)
 S SROP=0 F  S SROP=$O(^SRO(136,SRTN,3,SROP)) Q:'SROP  S X=$P($G(^SRO(136,SRTN,3,SROP,0)),"^") I X D
"RTN","SROPCE0A",79,0)
 .S SRICPT=$$CPT^ICPTCOD(X,$P($G(^SRF(SRTN,0)),"^",9)),SRCPT(SRJ)="CPT Code: "_$P(SRICPT,"^",2)_"  "_$P(SRICPT,"^",3),SRJ=SRJ+1
"RTN","SROPCE0A",80,0)
 .I $O(^SRO(136,SRTN,3,SROP,1,0)) D
"RTN","SROPCE0A",81,0)
 ..N SRI,SRX,SRY,SRZ S SRX=" Modifiers: -"
"RTN","SROPCE0A",82,0)
 ..S SRI=0 F  S SRI=$O(^SRO(136,SRTN,3,SROP,1,SRI)) Q:'SRI  D
"RTN","SROPCE0A",83,0)
 ...S SRZ=$P(^SRO(136,SRTN,3,SROP,1,SRI,0),"^"),SRY=$$MOD^ICPTMOD(SRZ,"I",$P($G(^SRF(SRTN,0)),"^",9)),SRX=SRX_$P(SRY,"^",2)_" "_$P(SRY,"^",3)
"RTN","SROPCE0A",84,0)
 ...S SRCPT(SRJ)=SRX,SRJ=SRJ+1,SRX="            -"
"RTN","SROPCE0A",85,0)
 .S:SRSTATUS=1 SRFCPT=SRFCPT+1 S:SRSTATUS=2 SRQCPT=SRQCPT+1 S:SRSTATUS=3 SRUCPT=SRUCPT+1
"RTN","SROPCE0A",86,0)
DX ; get diagnosis and ICD codes
"RTN","SROPCE0A",87,0)
 K SRDX,SRSYS,SRSY S SRJ=1,X=$P($G(^SRO(136,SRTN,0)),"^",3) I X D
"RTN","SROPCE0A",88,0)
 .S SRSYS=$$ICDSYS^SROICD($P(^SRF(SRTN,0),"^",9)),SRSY=$S(SRSYS="10D":10,1:9)
"RTN","SROPCE0A",89,0)
 .; JAS - 6/10/13 - PATCH 177 - Created additional array variable to contain remainder of ICD-10 short description 
"RTN","SROPCE0A",90,0)
 .N SRPARSE S SRDX(1)=$$ICD^SROICD(SRTN,X),SRPARSE(1)=$P(SRDX(1),"^",4) D PR^SROICDL(.SRPARSE,31)
"RTN","SROPCE0A",91,0)
 .I +SRPARSE>1 S SRDX(1,2)=SRPARSE(2)_" "_$G(SRPARSE(3))
"RTN","SROPCE0A",92,0)
 .S SRDX(1)=$P(SRDX(1),"^",2)_"  "_SRPARSE(1),SRJ=SRJ+1 K SRPARSE
"RTN","SROPCE0A",93,0)
 .; End 177
"RTN","SROPCE0A",94,0)
 .S:SRSTATUS=1 SRFICD=$G(SRFICD)+1,SRFICD(SRSY)=$G(SRFICD(SRSY))+1 S:SRSTATUS=2 SRQICD=$G(SRQICD)+1,SRQICD(SRSY)=$G(SRQICD(SRSY))+1 S:SRSTATUS=3 SRUICD=$G(SRUICD)+1,SRUICD(SRSY)=$G(SRUICD(SRSY))+1
"RTN","SROPCE0A",95,0)
 S SRPODX=0 F  S SRPODX=$O(^SRO(136,SRTN,4,SRPODX)) Q:'SRPODX  S X=$P(^SRO(136,SRTN,4,SRPODX,0),"^") I X D
"RTN","SROPCE0A",96,0)
 .S SRSYS=$$ICDSYS^SROICD($P(^SRF(SRTN,0),"^",9)),SRSY=$S(SRSYS="10D":10,1:9)
"RTN","SROPCE0A",97,0)
 .; JAS - 6/10/13 - PATCH 177 - Created additional array variable to contain remainder of ICD-10 short description 
"RTN","SROPCE0A",98,0)
 .N SRPARSE S SRDX(SRJ)=$$ICD^SROICD(SRTN,X),SRPARSE(1)=$P(SRDX(SRJ),"^",4) D PR^SROICDL(.SRPARSE,31)
"RTN","SROPCE0A",99,0)
 .I +SRPARSE>1 S SRDX(SRJ,2)=SRPARSE(2)_" "_$G(SRPARSE(3))
"RTN","SROPCE0A",100,0)
 .S SRDX(SRJ)=$P(SRDX(SRJ),"^",2)_"  "_SRPARSE(1),SRJ=SRJ+1 K SRPARSE
"RTN","SROPCE0A",101,0)
 .; End 177
"RTN","SROPCE0A",102,0)
 .S:SRSTATUS=1 SRFICD=$G(SRFICD)+1,SRFICD(SRSY)=$G(SRFICD(SRSY))+1 S:SRSTATUS=2 SRQICD=$G(SRQICD)+1,SRQICD(SRSY)=$G(SRQICD(SRSY))+1 S:SRSTATUS=3 SRUICD=$G(SRUICD)+1,SRUICD(SRSY)=$G(SRUICD(SRSY))+1
"RTN","SROPCE0A",103,0)
 . ;
"RTN","SROPCE0A",104,0)
 Q
"RTN","SROPCE0A",105,0)
PAGE I $E(IOST)="P"!SRHDR G HDR
"RTN","SROPCE0A",106,0)
 W ! K DIR S DIR(0)="E" D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROPCE0A",107,0)
HDR ; print heading
"RTN","SROPCE0A",108,0)
 I $D(ZTQUEUED) D ^SROSTOP I SRHALT S SRSOUT=1 Q
"RTN","SROPCE0A",109,0)
 W:$Y @IOF W:$E(IOST)="P" !,?(IOM-$L(SRINST)\2),SRINST W !,?(IOM-$L(SRRPT)\2),SRRPT,?(IOM-10),$J("PAGE "_SRPAGE,9),!,?(IOM-$L(SRTITLE)\2),SRTITLE,!,?(IOM-$L(SRFRTO)\2),SRFRTO W:$E(IOST)="P" !,?(IOM-$L(SRPRINT)\2),SRPRINT
"RTN","SROPCE0A",110,0)
 W !!,"DATE OF "_$S(SRFLG=1:"OPERATION",SRFLG=2:"PROCEDURE",1:"OP/PROCEDURE"),?22,"PATIENT NAME",?49,$S(SRFLG=1:"SURGEON",SRFLG=2:"PROVIDER",1:"SURGEON/PROVIDER"),?71,"SPECIALTY",?113,"PCE FILING STATUS"
"RTN","SROPCE0A",111,0)
 W !,"CASE #",?22,"PATIENT ID  (AGE)",?49,"ATTENDING",?71,"PRINCIPAL "_$S(SRFLG=1:"POST-OP ",1:"")_"DIAGNOSIS",?113,"SCHED STATUS",!,?22,"PRINCIPAL PROCEDURE"
"RTN","SROPCE0A",112,0)
 S SRHDR=0,SRPAGE=SRPAGE+1 W ! F I=1:1:IOM W "="
"RTN","SROPCE0A",113,0)
 Q
"RTN","SROPCE0A",114,0)
ICDCHK S SRIMPDT=$$IMPDATE^SROICD("10D")
"RTN","SROPCE0A",115,0)
 S:SDATE<SRIMPDT&(EDATE<SRIMPDT) ICD=9 S:SDATE'<SRIMPDT&(EDATE'<SRIMPDT) ICD=10 S:SDATE<SRIMPDT&(EDATE'<SRIMPDT) ICD=910
"RTN","SROPCE0A",116,0)
 Q
"RTN","SROPCE1")
0^57^B42495285^B42506082
"RTN","SROPCE1",1,0)
SROPCE1 ;BIR/ADM - ASK SC/EI QUESTIONS FOR PCE AND CROSS REFERENCE LOGIC ;07/24/07
"RTN","SROPCE1",2,0)
 ;;3.0;Surgery;**58,105,119,150,152,159,177**;24 Jun 93;Build 89
"RTN","SROPCE1",3,0)
 ;
"RTN","SROPCE1",4,0)
 ; Reference to CL^SDCO21 supported by DBIA #406
"RTN","SROPCE1",5,0)
 ; Reference to DIS^DGRPDB supported by DBIA #700
"RTN","SROPCE1",6,0)
 ; Reference to Field #.322013 in File #2 supported by DBIA #3475
"RTN","SROPCE1",7,0)
 ;
"RTN","SROPCE1",8,0)
EN1 I '$P(^SRO(133,SRSITE,0),"^",16) Q
"RTN","SROPCE1",9,0)
 N SRPDATE,SRSDATE S SRPDATE=$P(^SRO(133,SRSITE,0),"^",17),SRSDATE=$S($D(SRTN):$P(^SRF(SRTN,0),"^",9),$D(SRWLST):$P(^SRO(133.8,SRSS,1,SROFN,0),"^",5),1:DT) I SRPDATE,SRSDATE<SRPDATE Q
"RTN","SROPCE1",10,0)
 N SRAO,SRDR,SREC,SRELIG,SRIR,SRPERC,SRQ,SRSC,SRCL,SRX,VAEL,VASV,SRCV,SRMST,SRHNC,SRPRJ S SRQ=0
"RTN","SROPCE1",11,0)
CLASS ; build classification array
"RTN","SROPCE1",12,0)
 S:$D(SRTN) DFN=$P(^SRF(SRTN,0),"^") D CL^SDCO21(DFN,SRSDATE,,.SRCL)
"RTN","SROPCE1",13,0)
 I '$D(SRCL) W !!,"No classification information is required for this patient.",! K DA,DIE,DR S:$D(SRTN) DA=SRTN,DIE=130,DR=".0155////1" S:$D(SRWLST) DA(1)=SRSS,DA=SROFN,DIE="^SRO(133.8,"_DA(1)_",1,",DR="20////1" D ^DIE G END
"RTN","SROPCE1",14,0)
 I $D(SRTN),'$P(^SRF(SRTN,0),"^",20) G ELIG
"RTN","SROPCE1",15,0)
 I $D(SRWLST),'$P(^SRO(133.8,SRSS,1,SROFN,0),"^",20) G ELIG
"RTN","SROPCE1",16,0)
ASK W ! K DIR S DIR("A")="Do you want to update classification information (Y/N)? ",DIR("B")="NO",DIR(0)="YA" D ^DIR K DIR I 'Y!$D(DTOUT)!$D(DUOUT) W:'$D(SRWLST) @IOF Q
"RTN","SROPCE1",17,0)
ELIG ; output of eligibility and service connected conditions
"RTN","SROPCE1",18,0)
 N SRY D DEM^VADPT,ELIG^VADPT,SVC^VADPT
"RTN","SROPCE1",19,0)
 S SRELIG=$P(VAEL(1),"^",2),SRSC=$P(VAEL(3),"^"),SRSC=$S(SRSC:"YES",SRSC=0:"NO",1:""),SRPERC=$P(VAEL(3),"^",2)
"RTN","SROPCE1",20,0)
 S SRAO=$S(VASV(2):"YES",1:"NO"),SRIR=$S(VASV(3):"YES",1:"NO"),SRCV=$S(VASV(10):"YES",1:"NO"),SRPRJ=$S($G(VASV(11)):"YES",1:"NO")
"RTN","SROPCE1",21,0)
 S SRMST=$S($D(SRCL(5)):"YES",1:"NO"),SRHNC=$S($D(SRCL(6)):"YES",1:"NO")
"RTN","SROPCE1",22,0)
 S DIC=2,DA=DFN,DR=".322013",DIQ="SRY",DIQ(0)="I" D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SROPCE1",23,0)
 S SREC=SRY(2,DFN,.322013,"I"),SREC=$S(SREC="Y":"YES",1:"NO")
"RTN","SROPCE1",24,0)
 W @IOF,!,VADM(1)_"  ("_VA("PID")_")       ",$P(VAEL(6),"^",2),!!,"   * * * Eligibility Information and Service Connected Conditions * * *"
"RTN","SROPCE1",25,0)
 W !!,?5,"Primary Eligibility: "_SRELIG,!,?5,"Combat Vet: "_SRCV,?22,"A/O Exp.: "_SRAO,?39,"M/S Trauma: "_SRMST
"RTN","SROPCE1",26,0)
 W !,?5,"ION Rad.: "_SRIR,?22,"SWAC: "_SREC,?39,"H/N Cancer: "_SRHNC
"RTN","SROPCE1",27,0)
 W !,?5,"PROJ 112/SHAD: "_SRPRJ
"RTN","SROPCE1",28,0)
 D DIS^DGRPDB
"RTN","SROPCE1",29,0)
 W ! F I=1:1:79 W "-"
"RTN","SROPCE1",30,0)
SUP S SRY="operation" I $D(SRTN),$P($G(^SRF(SRTN,"NON")),"^")="Y" S SRY="procedure"
"RTN","SROPCE1",31,0)
 K DIR W !!,"Please supply the following required information about this "_SRY_":",! S:$D(SRWLST) DA(1)=SRSS,DA=SROFN S:$D(SRTN) DA=SRTN S SRDR="" S:'$D(SRQ) SRQ=0 D  I SRQ S:$D(SRWLST) SRSOUT=1 G END
"RTN","SROPCE1",32,0)
 .I $D(SRCL(3)) D SC I SRQ Q
"RTN","SROPCE1",33,0)
 .I $D(SRCL(7)) D CV I SRQ Q
"RTN","SROPCE1",34,0)
 .I $D(SRCL(1)) D AO I SRQ Q
"RTN","SROPCE1",35,0)
 .I $D(SRCL(2)) D IR I SRQ Q
"RTN","SROPCE1",36,0)
 .I $D(SRCL(4)) D EC I SRQ Q
"RTN","SROPCE1",37,0)
 .I $D(SRCL(8)) D PRJ I SRQ Q
"RTN","SROPCE1",38,0)
 .I $D(SRCL(5)) D MST I SRQ Q
"RTN","SROPCE1",39,0)
 .I $D(SRCL(6)) D HNC
"RTN","SROPCE1",40,0)
 K DA,DIE,DR S:$D(SRTN) DA=SRTN,DIE=130,DR=SRDR_".0155////1" S:$D(SRWLST) DA(1)=SRSS,DA=SROFN,DIE="^SRO(133.8,"_DA(1)_",1,",DR=SRDR_"20////1"
"RTN","SROPCE1",41,0)
 D ^DIE
"RTN","SROPCE1",42,0)
UPDX I $D(SRTN),X,$D(^SRF(SRTN,15)) D
"RTN","SROPCE1",43,0)
 .R !!,"Update all 'OTHER POSTOP DIAGNOSIS' Eligibility and",!,"Service Connected Conditions with these values?  Enter YES or NO. <NO>",Z:DTIME S:'$T Z=""
"RTN","SROPCE1",44,0)
 .D:(Z["Y")!(Z["y") UPDSC
"RTN","SROPCE1",45,0)
 .I Z["?" D  G UPDX
"RTN","SROPCE1",46,0)
 ..W !!,"Associate all of the existing OTHER POSTOP DIAGNOSIS for this surgical case with the new Eligibility and Service Connected Conditions?"
"RTN","SROPCE1",47,0)
 ..W !,"To edit diagnoses classification status individually, please use the Physician's Verification or the CPT/ICD Coding screens"
"RTN","SROPCE1",48,0)
END K DA,DIE,DR,SRZ,X,Y I 'SRQ,'$D(SRREQ),'$D(SRWLST) D PRESS
"RTN","SROPCE1",49,0)
 Q
"RTN","SROPCE1",50,0)
SC S DIR("A")="Treatment related to Service Connected condition (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,16",1:"130,.016") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",51,0)
 I X=""!(X="@") W !,$C(7),?15,"Enter YES or NO." G SC
"RTN","SROPCE1",52,0)
 S SRCL(3)=Y,SRDR=$G(SRDR)_$S($D(SRWLST):"16",1:".016")_"////"_SRCL(3)_";"
"RTN","SROPCE1",53,0)
 S SRCL(3,"UPDATE")=1
"RTN","SROPCE1",54,0)
 Q
"RTN","SROPCE1",55,0)
CV N SRCVD S SRCVD=$S($D(SRWLST):$P(^SRO(133.8,SRSS,1,SROFN,0),"^",23),1:$P(^SRF(SRTN,0),"^",24)),DIR("B")=$S(SRCVD=0:"NO",1:"YES")
"RTN","SROPCE1",56,0)
 S DIR("A")="Treatment related to Combat (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,23",1:"130,.024") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",57,0)
 I X=""!(X="@") W !,$C(7),?15,"Enter YES or NO." G CV
"RTN","SROPCE1",58,0)
 S SRCL(7)=Y,SRDR=SRDR_$S($D(SRWLST):"23",1:".024")_"////"_SRCL(7)_";"
"RTN","SROPCE1",59,0)
 S SRCL(7,"UPDATE")=1
"RTN","SROPCE1",60,0)
 Q
"RTN","SROPCE1",61,0)
AO S DIR("A")="Treatment related to Agent Orange Exposure (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,17",1:"130,.017") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",62,0)
 I X=""!(X="@") W !,$C(7),?15,"Enter YES or NO." G AO
"RTN","SROPCE1",63,0)
 S SRCL(1)=Y,SRDR=SRDR_$S($D(SRWLST):"17",1:".017")_"////"_SRCL(1)_";"
"RTN","SROPCE1",64,0)
 S SRCL(1,"UPDATE")=1
"RTN","SROPCE1",65,0)
 Q
"RTN","SROPCE1",66,0)
IR S DIR("A")="Treatment related to Ionizing Radiation Exposure (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,18",1:"130,.018") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",67,0)
 I X=""!(X="@") W !,$C(7),?15,"Enter YES or NO." G IR
"RTN","SROPCE1",68,0)
 S SRCL(2)=Y,SRDR=SRDR_$S($D(SRWLST):"18",1:".018")_"////"_SRCL(2)_";"
"RTN","SROPCE1",69,0)
 S SRCL(2,"UPDATE")=1
"RTN","SROPCE1",70,0)
 Q
"RTN","SROPCE1",71,0)
EC S DIR("A")="Treatment related to SW Asia (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,19",1:"130,.019") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",72,0)
 I X=""!(X="@") W !,$C(7),?15,"Enter YES or NO." G EC
"RTN","SROPCE1",73,0)
 S SRCL(4)=Y,SRDR=SRDR_$S($D(SRWLST):"19",1:".019")_"////"_SRCL(4)_";"
"RTN","SROPCE1",74,0)
 S SRCL(4,"UPDATE")=1
"RTN","SROPCE1",75,0)
 Q
"RTN","SROPCE1",76,0)
PRJ S DIR("A")="Treatment related to PROJ 112/SHAD (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,24",1:"130,.026") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",77,0)
 I X=""!(X="@") W !,$C(7),?15,"Enter YES or NO." G PRJ
"RTN","SROPCE1",78,0)
 S SRCL(8)=Y,SRDR=SRDR_$S($D(SRWLST):"24",1:".026")_"////"_SRCL(8)_";"
"RTN","SROPCE1",79,0)
 S SRCL(8,"UPDATE")=1
"RTN","SROPCE1",80,0)
 Q
"RTN","SROPCE1",81,0)
MST S DIR("A")="Treatment related to Military Sexual Trauma (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,21",1:"130,.022") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",82,0)
 I X=""!(X="@") W !,$C(7),?15,"Enter YES or NO." G MST
"RTN","SROPCE1",83,0)
 S SRCL(5)=Y,SRDR=SRDR_$S($D(SRWLST):"21",1:".022")_"////"_SRCL(5)_";"
"RTN","SROPCE1",84,0)
 S SRCL(5,"UPDATE")=1
"RTN","SROPCE1",85,0)
 Q
"RTN","SROPCE1",86,0)
HNC S DIR("A")="Treatment related to Head and/or Neck Cancer (Y/N)",DIR(0)=$S($D(SRWLST):"133.801,22",1:"130,.023") D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRQ=1 Q
"RTN","SROPCE1",87,0)
 I X=""!(X="@") W !,$C(7),?15,"Enter YES or NO." G HNC
"RTN","SROPCE1",88,0)
 S SRCL(6)=Y,SRDR=SRDR_$S($D(SRWLST):"22",1:".023")_"////"_SRCL(6)_";"
"RTN","SROPCE1",89,0)
 S SRCL(6,"UPDATE")=1
"RTN","SROPCE1",90,0)
 Q
"RTN","SROPCE1",91,0)
WL ; entry from waiting list
"RTN","SROPCE1",92,0)
 N SRWLST S SRWLST=1 G EN1
"RTN","SROPCE1",93,0)
 Q
"RTN","SROPCE1",94,0)
REQ ; entry from new request entry
"RTN","SROPCE1",95,0)
 N SRREQ S SRREQ=1 G EN1
"RTN","SROPCE1",96,0)
PRESS W ! K DIR S DIR("A")="Press RETURN to continue  ",DIR(0)="FOA" D ^DIR K DIR W @IOF
"RTN","SROPCE1",97,0)
 Q
"RTN","SROPCE1",98,0)
UPDSC ;Update existing DX to Service Connected/Environmental Indicators associations.
"RTN","SROPCE1",99,0)
 K DA,DIE
"RTN","SROPCE1",100,0)
 S (DA,I)=0,DA(1)=SRTN,DIE="^SRF("_SRTN_",15,"
"RTN","SROPCE1",101,0)
 K DR
"RTN","SROPCE1",102,0)
 D:$D(SRCL(1,"UPDATE")) BLDDR(5,SRCL(1))
"RTN","SROPCE1",103,0)
 D:$D(SRCL(2,"UPDATE")) BLDDR(6,SRCL(2))
"RTN","SROPCE1",104,0)
 D:$D(SRCL(3,"UPDATE")) BLDDR(4,SRCL(3))
"RTN","SROPCE1",105,0)
 D:$D(SRCL(4,"UPDATE")) BLDDR(9,SRCL(4))
"RTN","SROPCE1",106,0)
 D:$D(SRCL(5,"UPDATE")) BLDDR(7,SRCL(5))
"RTN","SROPCE1",107,0)
 D:$D(SRCL(6,"UPDATE")) BLDDR(8,SRCL(6))
"RTN","SROPCE1",108,0)
 D:$D(SRCL(7,"UPDATE")) BLDDR(10,SRCL(7))
"RTN","SROPCE1",109,0)
 D:$D(SRCL(8,"UPDATE")) BLDDR(11,SRCL(8))
"RTN","SROPCE1",110,0)
 F I=1:1 S DA=$O(^SRF(SRTN,15,DA)) Q:DA=""  D ^DIE
"RTN","SROPCE1",111,0)
 Q
"RTN","SROPCE1",112,0)
BLDDR(DXPIECE,NEWSC) ;Build the DR string for updating DX/Service Indicators associations
"RTN","SROPCE1",113,0)
 S:$D(DR) DR=DR_";"
"RTN","SROPCE1",114,0)
 S:'$D(DR) DR=""
"RTN","SROPCE1",115,0)
 S DR=DR_DXPIECE_"///"_NEWSC
"RTN","SROPCE1",116,0)
 K DXPIECE,NEWSC
"RTN","SROPCE1",117,0)
 Q
"RTN","SROPER")
0^58^B13069473^B12586025
"RTN","SROPER",1,0)
SROPER ;B'HAM ISC/MAM - SELECT OPERATION ; [ 01/30/01  1:26 PM ]
"RTN","SROPER",2,0)
 ;;3.0;Surgery;**37,107,100,177**;24 Jun 93;Build 89
"RTN","SROPER",3,0)
 ;
"RTN","SROPER",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SROPER",5,0)
 ;
"RTN","SROPER",6,0)
NEW ; enter a new surgery
"RTN","SROPER",7,0)
 S %DT("A")="Select the Date of Operation: ",%DT="AEX" D ^%DT I Y<0 W !!,"When entering a new surgery case, a date MUST be entered.  If you do not",!,"know the date of operation, enter this patient on the Waiting List." W !!!
"RTN","SROPER",8,0)
 I Y<0 D CONT G:"Yy"'[SRYN END G NEW
"RTN","SROPER",9,0)
 G:Y'>0 END S SRSDATE=Y
"RTN","SROPER",10,0)
 S SRSC1=1 K SRCTN S SRSDPT=DFN,SRSCC="" D CONCUR^SRSREQ G:SRSCC="^" END
"RTN","SROPER",11,0)
OPER D ^SROPROC I SRSOUT G END
"RTN","SROPER",12,0)
 S SRPRIN=SRSOP K SRSOP
"RTN","SROPER",13,0)
 G:Y'>0 END S SRSDATE=Y
"RTN","SROPER",14,0)
 K DA,DIC,DO,DD,DINUM,SRTN S X=DFN,DIC="^SRF(",DIC(0)="L",DLAYGO=130 D FILE^DICN K DIC,DLAYGO,DO S SRTN=+Y
"RTN","SROPER",15,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK Q
"RTN","SROPER",16,0)
 K DIE,DR S DA=SRTN,DIE=130,DR=".09///"_SRSDATE_";26///"_SRPRIN_";68///"_SRPRIN D ^DIE K DR
"RTN","SROPER",17,0)
 K DR,DA S DR="[SRO-NOCOMP]",DA=SRTN,DIE=130 D ^DIE K DR
"RTN","SROPER",18,0)
 S ^SRF(SRTN,8)=SRSITE("DIV") D ^SROXRET
"RTN","SROPER",19,0)
 D ^SROBLOD K DR,DIE,DA S DR="38////"_BLOOD_";40////"_CROSSM,DA=SRTN,DIE=130 D ^DIE K DR,DA,DIE
"RTN","SROPER",20,0)
 K SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN) ;AAS need SRICDV defined for next call
"RTN","SROPER",21,0)
 S DR="[SRSRES1]",DIE=130,DA=SRTN D ^DIE D RT S SPD=$$CHKS^SRSCOR(SRTN),ST="" D EN2^SROVAR K DR S DR="[SRSRES-ENTRY]",DIE=130,DA=SRTN D ^SRCUSS I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SROPER",22,0)
 I $D(SRCTN) S DIE=130,DR="35////"_SRCTN,DA=SRTN D ^DIE S SROERR=SRTN D ^SROERR0 S DR="35////"_SRTN,DA=SRCTN,DIE=130 D ^DIE S SROERR=SRCTN D ^SROERR0
"RTN","SROPER",23,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SROPER",24,0)
 Q
"RTN","SROPER",25,0)
END D ^SRSKILL
"RTN","SROPER",26,0)
 Q
"RTN","SROPER",27,0)
SEL ; select case
"RTN","SROPER",28,0)
 W !!!,"Select Operation, or enter RETURN to continue listing Procedures: " R X:DTIME W @IOF I '$T!(X["^") S SRSOUT=1 Q
"RTN","SROPER",29,0)
 I X="" Q
"RTN","SROPER",30,0)
 I '$D(SRCASE(X)) W !!,"Please enter the number corresponding to the Surgical Case you want to edit.",!,"If the case desired does not appear, enter RETURN to continue listing",!,"additional cases."
"RTN","SROPER",31,0)
 I '$D(SRCASE(X)) W !!,"Press RETURN to continue  " R X:DTIME S:'$T SRSOUT=1 S SRBACK=1 Q
"RTN","SROPER",32,0)
 S SRTN=+SRCASE(X)
"RTN","SROPER",33,0)
 Q
"RTN","SROPER",34,0)
CONT ; continue new entry ?
"RTN","SROPER",35,0)
 W !!,"Do you want to continue  ?  YES//  " R SRYN:DTIME I '$T S SRYN="N" Q
"RTN","SROPER",36,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="Y" I "YyNn"'[SRYN W !!,"Enter RETURN if you want to re-enter a date and continue creating a new",!,"case, or 'NO' to leave this option." G CONT
"RTN","SROPER",37,0)
 Q
"RTN","SROPER",38,0)
RT ; start RT logging
"RTN","SROPER",39,0)
 I $D(XRTL) S XRTN="SROPER" D T0^%ZOSV
"RTN","SROPER",40,0)
 Q
"RTN","SROVER")
0^34^B25778110^B25619011
"RTN","SROVER",1,0)
SROVER ;BIR/MAM - VERIFY CASE ;[ 01/30/01  1:52 PM ]
"RTN","SROVER",2,0)
 ;;3.0;Surgery;**7,34,38,86,88,100,119,177**;24 Jun 93;Build 89
"RTN","SROVER",3,0)
BEG S (SRSOUT,SRS,SR2)=0 I $D(^SRF(SRTN,.2)),$P(^(.2),"^",3) S SRS=1
"RTN","SROVER",4,0)
DONE K X I $D(^SRF(SRTN,"VER")),$P(^("VER"),"^")="Y" W !!,"The procedure has already been verified.  Do you wish to continue ?  YES// " R X:DTIME I '$T!(X["^") G END
"RTN","SROVER",5,0)
 S:'$D(X) X="Y"
"RTN","SROVER",6,0)
 S:X="" X="Y" S X=$E(X) I X["?"!("YyNn"'[X) W !!,"Enter RETURN if you would like to reverify this case, or 'N' to exit",!,"this option." G DONE
"RTN","SROVER",7,0)
 G:"Yy"'[X END
"RTN","SROVER",8,0)
 S S(0)=^SRF(SRTN,0),Y=$E($P(S(0),"^",9),1,7),SRDATE=Y X ^DD("DD") S SRSDATE=Y,DFN=$P(S(0),"^") D DEM^VADPT S SRNM=VADM(1)_" ("_VA("PID")_")"
"RTN","SROVER",9,0)
 N ANS,SRLCK S ANS="NO"
"RTN","SROVER",10,0)
STRT D PRINT
"RTN","SROVER",11,0)
 I $P($G(^SRF(SRTN,"LOCK")),"^") W !!,"This case has been locked.  If you wish to update it, please contact",!,"your Chief of Surgery, or package coordinator." G END
"RTN","SROVER",12,0)
UP W ! G:SR2 VER W !,"Do you need to update the information above ?  NO// " R X:DTIME S:'$T X="^"
"RTN","SROVER",13,0)
 I X["^" W !!,"Verification of this case has not been made." G END
"RTN","SROVER",14,0)
 S (X,ANS)=$E(X)
"RTN","SROVER",15,0)
 I X?.E1C.E W !!,"Your answer has a control character in it, please re-type it.",! G UP
"RTN","SROVER",16,0)
 I "YyNn"'[X W !!,"If the information above is not correct, enter 'YES'.  You may then update",!,"any of the fields displayed.  Enter RETURN to proceed with verification",!,"of this case." G UP
"RTN","SROVER",17,0)
 S:X="" (X,ANS)="N" I "Yy"[X D CHECK^SROES I SRSOUT S SRLCK=0 K XQUIT G END
"RTN","SROVER",18,0)
 I "Yy"[ANS S SRLCK=1 D PRINT,RT,^SROVER1 G:SRSOUT END G STRT
"RTN","SROVER",19,0)
VER W !,"Will you verify that the information on your screen is correct ? YES// " R X:DTIME S:'$T X="^" I X["^" W !!,"No action has been taken. " G END
"RTN","SROVER",20,0)
 S X=$E(X)
"RTN","SROVER",21,0)
 I "YyNn"'[X W !,"Enter 'YES' if the procedures, diagnosis, and occurrences are correct",!,"for this case.  If you enter 'NO', the case will be left unverified." G VER
"RTN","SROVER",22,0)
 S:X="" X="Y" I "Yy"[X S $P(^SRF(SRTN,"VER"),"^")="Y"
"RTN","SROVER",23,0)
END S SROERR=SRTN D ^SROERR0
"RTN","SROVER",24,0)
 I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SROVER",25,0)
 W !!,"Press RETURN to continue  " R X:DTIME D ^SRSKILL,ADXKILL^SROADX1 W @IOF
"RTN","SROVER",26,0)
 Q
"RTN","SROVER",27,0)
LOOP ; break procedure if greater than 45 characters
"RTN","SROVER",28,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<45  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROVER",29,0)
 Q
"RTN","SROVER",30,0)
RT ; start RT logging
"RTN","SROVER",31,0)
 I $D(XRTL) S XRTN="SROVER" D T0^%ZOSV
"RTN","SROVER",32,0)
 Q
"RTN","SROVER",33,0)
OTHER I '$O(^SRF(SRTN,13,0)) Q
"RTN","SROVER",34,0)
 S OTH=0 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH!(SRSOUT)  D
"RTN","SROVER",35,0)
 .S OTHER=$P(^SRF(SRTN,13,OTH,0),"^"),CPT=$P($G(^SRF(SRTN,13,OTH,2)),"^"),X=$S(CPT:$P($$CPT^ICPTCOD(CPT),"^",2),1:"NOT ENTERED")
"RTN","SROVER",36,0)
 .W !,?3,OTHER_"  CPT Code: ",X
"RTN","SROVER",37,0)
 .I CPT,$O(^SRF(SRTN,13,OTH,"MOD",0)) D  W !,?10,SRX
"RTN","SROVER",38,0)
 ..S (SRCOMMA,SRI)=0,SRCMOD="",SRX="Modifiers:  -" F  S SRI=$O(^SRF(SRTN,13,OTH,"MOD",SRI)) Q:'SRI  D
"RTN","SROVER",39,0)
 ...S SRM=$P(^SRF(SRTN,13,OTH,"MOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROVER",40,0)
 ...S SRX=SRX_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROVER",41,0)
 .D OTHADXD^SROADX1
"RTN","SROVER",42,0)
 Q
"RTN","SROVER",43,0)
PRINT ; print information
"RTN","SROVER",44,0)
 W @IOF,!,SRNM,?52,"Operation Date: "_SRSDATE,! F I=1:1:80 W "-"
"RTN","SROVER",45,0)
 K ^UTILITY($J,"W") W !,"1. Indications for Operation:" S SRIND=0 F I=0:0 S SRIND=$O(^SRF(SRTN,40,SRIND)) Q:'SRIND  S X=^SRF(SRTN,40,SRIND,0),DIWL=3,DIWR=76,DIWF="N" D ^DIWP
"RTN","SROVER",46,0)
 I $D(^UTILITY($J,"W")) F V=1:1:^UTILITY($J,"W",3)-1 W !,?3,^UTILITY($J,"W",3,V,0)
"RTN","SROVER",47,0)
 S S("OP")=^SRF(SRTN,"OP"),CPT=$P(S("OP"),"^",2) S SROPER=$P(S("OP"),"^")
"RTN","SROVER",48,0)
 K SROPS,MM,MMM S:$L(SROPER)<45 SROPS(1)=SROPER I $L(SROPER)>44 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROVER",49,0)
 S X=$S(CPT:$P($$CPT^ICPTCOD(CPT),"^",2),1:"NOT ENTERED")
"RTN","SROVER",50,0)
 W !,"2. Principal CPT Code:  ",X I CPT K SRDES S X=$$CPTD^ICPTCOD(CPT,"SRDES") I $O(SRDES(0)) F I=1:1:X W !,?5,SRDES(I)
"RTN","SROVER",51,0)
 I CPT,$O(^SRF(SRTN,"OPMOD",0)) D  W !,?10,SRX
"RTN","SROVER",52,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRX="Modifiers:  -" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROVER",53,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2)
"RTN","SROVER",54,0)
 ..S SRX=SRX_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROVER",55,0)
 S SRMSG="NO Assoc. DX ENTERED",SRASDX="Assoc. DX: "
"RTN","SROVER",56,0)
 D PADXD^SROADX1
"RTN","SROVER",57,0)
 W !,"3. Principal Procedure: ",?24,SROPS(1) I $D(SROPS(2)) W !,?24,SROPS(2) I $D(SROPS(3)) W !,?24,SROPS(3)
"RTN","SROVER",58,0)
 W !,"4. Other Procedures: ",?24 D OTHER
"RTN","SROVER",59,0)
 W !,"5. Postoperative Diagnosis: " I $D(^SRF(SRTN,34)) W ?30,$P(^(34),"^")
"RTN","SROVER",60,0)
 W !,"6. Intraoperative Occurrences: "_$S($O(^SRF(SRTN,10,0)):"** INFORMATION ENTERED **",1:"NO OCCURRENCES HAVE BEEN ENTERED")
"RTN","SROVER",61,0)
 W !,"7. Principal Pre-OP Diagnosis: " I $D(^SRF(SRTN,33)) W $P(^(33),"^")
"RTN","SROVER",62,0)
 S SRDIAG="NOT ENTERED",SRDX=$P($G(^SRF(SRTN,34)),"^",3) I SRDX S SRDIAG=$$ICD^SROICD(SRTN,SRDX),SRDIAG=$P(SRDIAG,"^",2)_"  "_$P(SRDIAG,"^",4)
"RTN","SROVER",63,0)
 W !,"8. Principal Pre-OP Diagnosis Code "_$$ICDSTR^SROICD(SRTN)_": "_SRDIAG
"RTN","SROVER",64,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROVER",65,0)
 Q
"RTN","SROVER2")
0^35^B26606963^B26717453
"RTN","SROVER2",1,0)
SROVER2 ;BIR/ADM - Case Coding and Verification ; 8/10/04 3:00pm
"RTN","SROVER2",2,0)
 ;;3.0;Surgery;**86,88,100,127,119,177**;24 Jun 93;Build 89
"RTN","SROVER2",3,0)
 I '$D(SRSITE) D ^SROVAR I '$D(SRSITE) S XQUIT="" Q
"RTN","SROVER2",4,0)
 I '$G(SRTN) D ^SROPS1 I '$D(SRTN) S XQUIT="" Q
"RTN","SROVER2",5,0)
BEG N SRDES,SRDX,SREDIT,SRMOD,SRNON,SRSEL,SRTXT S (SREDIT,SRMOD,SRSOUT,SRS,SR2)=0 K ^TMP("SRV1",$J),^TMP("SRV2",$J) I $D(^SRF(SRTN,.2)),$P(^(.2),"^",3) S SRS=1
"RTN","SROVER2",6,0)
 S S(0)=^SRF(SRTN,0),Y=$P(S(0),"^",9),SRDATE=Y D D^DIQ S SRSDATE=Y,DFN=$P(S(0),"^") D DEM^VADPT S SRNM=VADM(1)_"  ("_VA("PID")_")"
"RTN","SROVER2",7,0)
 S SRNON=$S($P($G(^SRF(SRTN,"NON")),"^")="Y":1,1:0)
"RTN","SROVER2",8,0)
PRINT ; print information
"RTN","SROVER2",9,0)
 D HDR S S("OP")=^SRF(SRTN,"OP"),CPT=$P(S("OP"),"^",2),SROPER=$P(S("OP"),"^")
"RTN","SROVER2",10,0)
 S SRJ=0,Y="" F  S SRJ=$O(^SRF(SRTN,"OPMOD",SRJ)) Q:'SRJ  S Y=Y_$S($L(Y):",",1:"")_^SRF(SRTN,"OPMOD",SRJ,0)
"RTN","SROVER2",11,0)
 S ^TMP("SRV1",$J,"OP")=SROPER_"^"_CPT_"^"_Y
"RTN","SROVER2",12,0)
 S SRCPT="" I CPT S Y=$$CPT^ICPTCOD(CPT,$P($G(^SRF(SRTN,0)),"^",9)),SRCPT=$P(Y,"^",2)_"  "_$P(Y,"^",3)
"RTN","SROVER2",13,0)
 K SROPS,MM,MMM S:$L(SROPER)<45 SROPS(1)=SROPER I $L(SROPER)>44 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SROVER2",14,0)
 W !,"1. Principal Procedure: ",?24,SROPS(1) I $D(SROPS(2)) W !,?24,SROPS(2) I $D(SROPS(3)) W !,?24,SROPS(3)
"RTN","SROVER2",15,0)
 W !,"2. Principal CPT Code: ",?24,$S(CPT:SRCPT,1:"NOT ENTERED")
"RTN","SROVER2",16,0)
 I CPT K SRDES S X=$$CPTD^ICPTCOD(CPT,"SRDES",,$P($G(^SRF(SRTN,0)),"^",9)) I $O(SRDES(0)) F I=1:1:X W !,?6,SRDES(I)
"RTN","SROVER2",17,0)
 I CPT,$O(^SRF(SRTN,"OPMOD",0)) D  W !,?10,SRX
"RTN","SROVER2",18,0)
 .S (SRCOMMA,SRI)=0,SRCMOD="",SRX="Modifiers:  -" F  S SRI=$O(^SRF(SRTN,"OPMOD",SRI)) Q:'SRI  D
"RTN","SROVER2",19,0)
 ..S SRM=$P(^SRF(SRTN,"OPMOD",SRI,0),"^"),SRCMOD=$P($$MOD^ICPTMOD(SRM,"I"),"^",2) K SRM
"RTN","SROVER2",20,0)
 ..S SRX=SRX_$S(SRCOMMA:",",1:"")_SRCMOD,SRCOMMA=1
"RTN","SROVER2",21,0)
 S SRMSG="NO Assoc. DX ENTERED"
"RTN","SROVER2",22,0)
 D PADXD^SROADX1
"RTN","SROVER2",23,0)
 W !,"3. Other Procedures: "_$S($O(^SRF(SRTN,13,0)):"** INFORMATION ENTERED **",1:"NO OTHER PROCEDURES HAVE BEEN ENTERED")
"RTN","SROVER2",24,0)
 S X=0 F  S X=$O(^SRF(SRTN,13,X)) Q:'X  D  S ^TMP("SRV1",$J,13,X)=$P($G(^SRF(SRTN,13,X,0)),"^")_"^"_$P($G(^SRF(SRTN,13,X,2)),"^")_"^"_Y
"RTN","SROVER2",25,0)
 .S SRJ=0,Y="" F  S SRJ=$O(^SRF(SRTN,13,X,"MOD",SRJ)) Q:'SRJ  S Y=Y_$S($L(Y):",",1:"")_^SRF(SRTN,13,X,"MOD",SRJ,0)
"RTN","SROVER2",26,0)
 I SRNON S SRTXT=$P($G(^SRF(SRTN,33)),"^",2) W !,"4. Principal Diagnosis: "_SRTXT
"RTN","SROVER2",27,0)
 I 'SRNON S SRTXT=$P($G(^SRF(SRTN,34)),"^") W !,"4. Postoperative Diagnosis: "_SRTXT
"RTN","SROVER2",28,0)
 S SRDIAG="NOT ENTERED",SRDX=$P($G(^SRF(SRTN,34)),"^",2) I SRDX S SRDIAG=$$ICD^SROICD(SRTN,SRDX),SRDIAG=$P(SRDIAG,"^",2)_"  "_$P(SRDIAG,"^",4)
"RTN","SROVER2",29,0)
 W !,"5. Principal Diagnosis Code: "_SRDIAG S ^TMP("SRV1",$J,34)=SRTXT_"^"_SRDX
"RTN","SROVER2",30,0)
 W !,"6. Other Postop Diagnosis: "_$S($O(^SRF(SRTN,15,0)):"** INFORMATION ENTERED **",1:"NO OTHER POSTOP DIAGNOSIS HAS BEEN ENTERED")
"RTN","SROVER2",31,0)
 W !,"7. Principal Pre-OP Diagnosis: " I $D(^SRF(SRTN,33)) W $P(^(33),"^")
"RTN","SROVER2",32,0)
 S SRDIAG="NOT ENTERED",SRDX=$P($G(^SRF(SRTN,34)),"^",3) I SRDX S SRDIAG=$$ICD^SROICD(SRTN,SRDX),SRDIAG=$P(SRDIAG,"^",2)_"  "_$P(SRDIAG,"^",4)
"RTN","SROVER2",33,0)
 W !,"8. Principal Pre-OP Diagnosis Code: "_SRDIAG
"RTN","SROVER2",34,0)
 S X=0 F  S X=$O(^SRF(SRTN,15,X)) Q:'X  S Y=$G(^SRF(SRTN,15,X,0)),^TMP("SRV1",$J,15,X)=$P(Y,"^")_"^"_$P(Y,"^",3)
"RTN","SROVER2",35,0)
 W ! F LINE=1:1:80 W "-"
"RTN","SROVER2",36,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) I 'SRLCK G END
"RTN","SROVER2",37,0)
 D ^SROVER3,MOD G:SRSOUT END G:'SREDIT PRINT
"RTN","SROVER2",38,0)
END K ^TMP("SRV1",$J),^TMP("SRV2",$J) S SROERR=SRTN D ^SROERR0,^SRSKILL,ADXKILL^SROADX1 W @IOF
"RTN","SROVER2",39,0)
 I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SROVER2",40,0)
 Q
"RTN","SROVER2",41,0)
HDR W @IOF,!,SRNM,!,"Operation Date: "_SRSDATE,?40,"Case #",SRTN,! F I=1:1:80 W "-"
"RTN","SROVER2",42,0)
 Q
"RTN","SROVER2",43,0)
LOOP ; break procedure if greater than 45 characters
"RTN","SROVER2",44,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<45  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SROVER2",45,0)
 Q
"RTN","SROVER2",46,0)
ORPT ; print operation/procedure report
"RTN","SROVER2",47,0)
 N SRNON S SRNON=$S($P($G(^SRF(SRTN,"NON")),"^")="Y":1,1:0) I SRNON D CODE^SRONON Q
"RTN","SROVER2",48,0)
 D CODE^SROPRPT
"RTN","SROVER2",49,0)
 Q
"RTN","SROVER2",50,0)
NRPT ; print nurse intraoperative report
"RTN","SROVER2",51,0)
 N SRNON S SRNON=$S($P($G(^SRF(SRTN,"NON")),"^")="Y":1,1:0) I SRNON W !!,?5,"Nurse Intraoperative Report NOT available on Non-OR Procedure",! D PRESS^SROVER3 W @IOF Q
"RTN","SROVER2",52,0)
 D CODE^SRONIN
"RTN","SROVER2",53,0)
 Q
"RTN","SROVER2",54,0)
MOD ; if data changed set coder verification field
"RTN","SROVER2",55,0)
 D CHECK I SRMOD S $P(^SRF(SRTN,"VER"),"^",2)=DUZ
"RTN","SROVER2",56,0)
 Q
"RTN","SROVER2",57,0)
CHECK ; check for changes to data
"RTN","SROVER2",58,0)
 S X=$P(^SRF(SRTN,"OP"),"^",1,2) D  I X'=^TMP("SRV1",$J,"OP") S SRMOD=1 Q
"RTN","SROVER2",59,0)
 .S SRJ=0,Y="" F  S SRJ=$O(^SRF(SRTN,"OPMOD",SRJ)) Q:'SRJ  S Y=Y_$S($L(Y):",",1:"")_^SRF(SRTN,"OPMOD",SRJ,0)
"RTN","SROVER2",60,0)
 .S X=X_"^"_Y
"RTN","SROVER2",61,0)
 S X=0 F  S X=$O(^SRF(SRTN,13,X)) Q:'X!SRMOD  D  S ^TMP("SRV2",$J,13,X)=$P($G(^SRF(SRTN,13,X,0)),"^")_"^"_$P($G(^SRF(SRTN,13,X,2)),"^")_"^"_Y I ^TMP("SRV2",$J,13,X)'=$G(^TMP("SRV1",$J,13,X)) S SRMOD=1 Q
"RTN","SROVER2",62,0)
 .S SRJ=0,Y="" F  S SRJ=$O(^SRF(SRTN,13,X,"MOD",SRJ)) Q:'SRJ  S Y=Y_$S($L(Y):",",1:"")_^SRF(SRTN,13,X,"MOD",SRJ,0)
"RTN","SROVER2",63,0)
 Q:SRMOD  S X=0 F  S X=$O(^TMP("SRV1",$J,13,X)) Q:'X!SRMOD  I ^TMP("SRV1",$J,13,X)'=$G(^TMP("SRV2",$J,13,X)) S SRMOD=1 Q
"RTN","SROVER2",64,0)
 Q:SRMOD  I SRNON S X=$P($G(^SRF(SRTN,33)),"^",2)_"^"_$P($G(^SRF(SRTN,34)),"^",2) I X'=^TMP("SRV1",$J,34) S SRMOD=1 Q
"RTN","SROVER2",65,0)
 I 'SRNON S X=$P($G(^SRF(SRTN,34)),"^",1,2) I X'=^TMP("SRV1",$J,34) S SRMOD=1 Q
"RTN","SROVER2",66,0)
 S X=0 F  S X=$O(^SRF(SRTN,15,X)) Q:'X!SRMOD  S Y=$G(^SRF(SRTN,15,X,0)),^TMP("SRV2",$J,15,X)=$P(Y,"^")_"^"_$P(Y,"^",3) I ^TMP("SRV2",$J,15,X)'=$G(^TMP("SRV1",$J,15,X)) S SRMOD=1 Q
"RTN","SROVER2",67,0)
 Q:SRMOD  S X=0 F  S X=$O(^TMP("SRV1",$J,15,X)) Q:'X!SRMOD  I ^TMP("SRV1",$J,15,X)'=$G(^TMP("SRV2",$J,15,X)) S SRMOD=1 Q
"RTN","SROVER2",68,0)
 Q
"RTN","SROVER3")
0^36^B37536905^B37508747
"RTN","SROVER3",1,0)
SROVER3 ;BIR/ADM - Case Coding and Verification ;07/26/07
"RTN","SROVER3",2,0)
 ;;3.0;Surgery;**86,88,127,119,152,159,177**;24 Jun 93;Build 89
"RTN","SROVER3",3,0)
 ;;
"RTN","SROVER3",4,0)
 ; Reference to CL^SDCO21 supported by DBIA #406
"RTN","SROVER3",5,0)
 ;;
"RTN","SROVER3",6,0)
 S SROVER=1,SRAO(1)=26,SRAO(2)=27,SRAO(3)="",SRAO(4)=$S(SRNON:33,1:34),SRAO(5)=66,SRAO(6)="",SRAO(7)=32,SRAO(8)=32.5,SRMSG="NO Assoc. DX ENTERED"
"RTN","SROVER3",7,0)
ASK W ! K DIR S DIR("A")="Select Information to Edit: ",DIR(0)="FOA",DIR("?",1)="Enter the number corresponding to the information you want to update.  You may"
"RTN","SROVER3",8,0)
 S DIR("?",2)="enter 'ALL' to update all the information displayed on this screen, or a",DIR("?")="range of numbers separated by a ':' to update more than one item." D ^DIR K DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROVER3",9,0)
 I X="" S SREDIT=1 Q
"RTN","SROVER3",10,0)
 S:$E(X)="a" X="A" I '$D(SRAO(X)),(X'?.N1":".N),($E(X)'="A") D HELP Q:SRSOUT  G ASK
"RTN","SROVER3",11,0)
 I $E(X)="A" S X="1:8"
"RTN","SROVER3",12,0)
 I X?.N1":".N S Y=$E(X),Z=$P(X,":",2) I Y<1!(Z>8)!(Y>Z) D HELP Q:SRSOUT  G ASK
"RTN","SROVER3",13,0)
 D HDR^SROVER2 I X?.N1":".N D RANGE Q
"RTN","SROVER3",14,0)
 S EMILY=X D ONE Q
"RTN","SROVER3",15,0)
 Q
"RTN","SROVER3",16,0)
HELP W !!,"Enter the number corresponding to the information you want to update.  You may",!,"enter 'ALL' to update all the information displayed on this screen, or a"
"RTN","SROVER3",17,0)
 W !,"range of numbers separated by a ':' to update more than one item."
"RTN","SROVER3",18,0)
 Q
"RTN","SROVER3",19,0)
PRESS W ! K DIR S DIR("A")="Press RETURN to continue ",DIR(0)="FOA" D ^DIR K DIR
"RTN","SROVER3",20,0)
 Q
"RTN","SROVER3",21,0)
RANGE ; range of numbers
"RTN","SROVER3",22,0)
 S SHEMP=$P(X,":"),CURLEY=$P(X,":",2) F EMILY=SHEMP:1:CURLEY Q:SRSOUT  W ! D ONE
"RTN","SROVER3",23,0)
 Q
"RTN","SROVER3",24,0)
ONE ; edit one item
"RTN","SROVER3",25,0)
 I EMILY=3 D POTH Q
"RTN","SROVER3",26,0)
 I EMILY=6 D DOTH Q
"RTN","SROVER3",27,0)
 W ! K DR,DIE,DA S DIE=130,DA=SRTN,DR=SRAO(EMILY)_"T" D ^DIE K DR,DIE I $D(Y) S SRSOUT=1
"RTN","SROVER3",28,0)
 I EMILY=4&($$SCEC()) D ASK^SROPCE1 K SRCL
"RTN","SROVER3",29,0)
 I EMILY=2 D CASDX^SROADX
"RTN","SROVER3",30,0)
 Q
"RTN","SROVER3",31,0)
POTH W !,"Other Procedures:",!
"RTN","SROVER3",32,0)
 N SRSHT K SRSEL S CNT=1,OTH=0 F  S OTH=$O(^SRF(SRTN,13,OTH)) Q:'OTH!(SRSOUT)  D
"RTN","SROVER3",33,0)
 .S OTHER=$P(^SRF(SRTN,13,OTH,0),U),X=$P($G(^SRF(SRTN,13,OTH,2)),U),CPT="NOT ENTERED",CPT1=""
"RTN","SROVER3",34,0)
 .I X S CPT1=X,Y=$$CPT^ICPTCOD(X,$P($G(^SRF(SRTN,0)),"^",9)),SRCPT=$P(Y,U,2),SRSHT=$P(Y,U,3),Y=SRCPT,SRDA=OTH D SSOTH^SROCPT S SRCPT=Y,CPT=SRCPT_"  "_SRSHT
"RTN","SROVER3",35,0)
 .W !,CNT_". "_OTHER
"RTN","SROVER3",36,0)
 .W !,?5,"CPT Code: "_CPT
"RTN","SROVER3",37,0)
 .S SRSEL(CNT)=OTH_"^"_OTHER_"^CPT Code: "_CPT_"^"_CPT1
"RTN","SROVER3",38,0)
 .D OTHADXD^SROADX1
"RTN","SROVER3",39,0)
 .S CNT=CNT+1
"RTN","SROVER3",40,0)
 W !,CNT_". Enter NEW Other Procedure",! K DIR S DIR("A")="Enter selection",DIR(0)="NO^1:"_CNT D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROVER3",41,0)
 Q:'Y  S SRDA=Y W !! I SRDA<CNT D  G PH
"RTN","SROVER3",42,0)
 .D HDR^SROVER2
"RTN","SROVER3",43,0)
 .W !,"Other Procedures:",!
"RTN","SROVER3",44,0)
 .W !,SRDA,"."
"RTN","SROVER3",45,0)
 .W ?3,$P(SRSEL(SRDA),U,2),!,?5,$P(SRSEL(SRDA),U,3)
"RTN","SROVER3",46,0)
 .S OTH=$P(SRSEL(SRDA),U) K SRDES S CPT1=$P(SRSEL(SRDA),U,4),X=$$CPTD^ICPTCOD(CPT1,"SRDES",,$P($G(^SRF(SRTN,0)),"^",9)) I $O(SRDES(0)) F I=1:1:X W !,?5,SRDES(I)
"RTN","SROVER3",47,0)
 .K DA,DIE,DIR,DR W ! S DA=$P(SRSEL(SRDA),U),DA(1)=SRTN,DIE="^SRF(SRTN,13,",DR=".01;3" D ^DIE D:$D(DA) COTHADX^SROADX K DA,DIE,DR Q:$D(Y)  D PRESS
"RTN","SROVER3",48,0)
 K DIR S DIR("A")="Enter new OTHER PROCEDURE",DIR(0)="130.16,.01" D ^DIR K DIR S SRNEW=Y I $D(DTOUT)!$D(DUOUT)!(Y="") G PH
"RTN","SROVER3",49,0)
 K DD,DO S DIC="^SRF(SRTN,13,",X=SRNEW,DIC(0)="L",DIC("P")=$P(^DD(130,.42,0),U,2) D FILE^DICN K DIC,DD,DO I +Y<0 Q
"RTN","SROVER3",50,0)
 K DA,DIE,DIR,DR S DA=+Y,DA(1)=SRTN,DIE="^SRF(SRTN,13,",DR="3" D ^DIE K DA,DIE,DR Q:$D(Y)  S SRDA=CNT,OTHER=SRNEW D COTHADX^SROADX D PRESS
"RTN","SROVER3",51,0)
PH D HDR^SROVER2 D POTH
"RTN","SROVER3",52,0)
 Q
"RTN","SROVER3",53,0)
DOTH W !,"Other Postop Diagnosis:",!
"RTN","SROVER3",54,0)
 N SCEC,ENVARR S SCEC=$$SCEC()
"RTN","SROVER3",55,0)
 K SRSEL S CNT=1,OTH=0 F  S OTH=$O(^SRF(SRTN,15,OTH)) Q:'OTH!(SRSOUT)  D
"RTN","SROVER3",56,0)
 .S OTHER=$P(^SRF(SRTN,15,OTH,0),U),X=$P($G(^SRF(SRTN,15,OTH,0)),U,3),SRDIAG="NOT ENTERED"
"RTN","SROVER3",57,0)
 .I X S Y=$$ICD^SROICD(SRTN,X),SRNUM=$P(Y,U,2),SRDES=$P(Y,U,4),SRDIAG=SRNUM_"  "_SRDES
"RTN","SROVER3",58,0)
 .W !,CNT_". "_OTHER,!,?5,"ICD"_$$ICD910^SROICD(SRTN)_" Code: "_SRDIAG S SRSEL(CNT)=OTH_"^"_OTHER_"^ICD Code: "_SRDIAG
"RTN","SROVER3",59,0)
 .D:SCEC
"RTN","SROVER3",60,0)
 ..D GETS^DIQ(130.18,OTH_","_SRTN_",","4:11","E","ENVARR")
"RTN","SROVER3",61,0)
 ..I $D(ENVARR(130.18,OTH_","_SRTN_",",4,"E")) D
"RTN","SROVER3",62,0)
 ...N SRCOLSPN S SRCOLSPN=13 W !
"RTN","SROVER3",63,0)
 ...I $D(SRCL(3)) W ?SRCOLSPN,"SC:",$E(ENVARR(130.18,OTH_","_SRTN_",",4,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROVER3",64,0)
 ...I $D(SRCL(7)) W ?SRCOLSPN,"CV:",$E(ENVARR(130.18,OTH_","_SRTN_",",10,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROVER3",65,0)
 ...I $D(SRCL(1)) W ?SRCOLSPN,"AO:",$E(ENVARR(130.18,OTH_","_SRTN_",",5,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROVER3",66,0)
 ...I $D(SRCL(2)) W ?SRCOLSPN,"IR:",$E(ENVARR(130.18,OTH_","_SRTN_",",6,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROVER3",67,0)
 ...I $D(SRCL(4)) W ?SRCOLSPN,"SWAC:",$E(ENVARR(130.18,OTH_","_SRTN_",",9,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROVER3",68,0)
 ...I $D(SRCL(8)) W ?SRCOLSPN,"SHAD:",$E(ENVARR(130.18,OTH_","_SRTN_",",11,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROVER3",69,0)
 ...I $D(SRCL(5)) W ?SRCOLSPN,"MST:",$E(ENVARR(130.18,OTH_","_SRTN_",",7,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROVER3",70,0)
 ...I $D(SRCL(6)) W ?SRCOLSPN,"H&N:",$E(ENVARR(130.18,OTH_","_SRTN_",",8,"E")) S SRCOLSPN=SRCOLSPN+8
"RTN","SROVER3",71,0)
 .S CNT=CNT+1
"RTN","SROVER3",72,0)
 W !,CNT_". Enter NEW Other Postop Diagnosis",! K DIR S DIR("A")="Enter selection",DIR(0)="NO^1:"_CNT D ^DIR I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROVER3",73,0)
 Q:'Y  S SRDA=Y W !! I SRDA<CNT D  G DH
"RTN","SROVER3",74,0)
 .W ?3,$P(SRSEL(SRDA),U,2),!,?5,$P(SRSEL(SRDA),U,3)
"RTN","SROVER3",75,0)
 .N SRCVET K DA,DIE,DIR S DA=$P(SRSEL(SRDA),U),DA(1)=SRTN,DIE="^SRF(SRTN,15,",DR=".01T;3T;"
"RTN","SROVER3",76,0)
 .S SRCVET=$P($G(^SRF(SRTN,15,DA,2)),"^",7) S SRCVET=$S(SRCVET=0:"NO",1:"YES")
"RTN","SROVER3",77,0)
 .S:$D(SRCL(3)) DR=DR_"4T;" S:$D(SRCL(7)) DR=DR_"10T//"_SRCVET_";" S:$D(SRCL(1)) DR=DR_"5T;" S:$D(SRCL(2)) DR=DR_"6T;" S:$D(SRCL(4)) DR=DR_"9T;" S:$D(SRCL(5)) DR=DR_"7T;" S:$D(SRCL(6)) DR=DR_"8T;" S:$D(SRCL(8)) DR=DR_"11T;"
"RTN","SROVER3",78,0)
 .D ^DIE K DA,DIE,DIR,DR
"RTN","SROVER3",79,0)
 K DIR,SRCL S DIR("A")="Enter new Other Postop Diagnosis",DIR(0)="130.18,.01" D ^DIR K DIR S SRNEW=Y I $D(DTOUT)!$D(DUOUT)!(Y="") G DH
"RTN","SROVER3",80,0)
 S DIR("A")="Planned Other ICD Diagnosis Code",DIR(0)="130.18,3" D ^DIR K DIR S SRCODE=$P(Y,U) I $D(DTOUT)!$D(DUOUT) S SRSOUT=1 Q
"RTN","SROVER3",81,0)
 S:'$D(DA(1)) DA(1)=SRTN
"RTN","SROVER3",82,0)
 S SRCODE=Y K DD,DO S DIC="^SRF(SRTN,15,",X=SRNEW,DIC(0)="L",DIC("DR")="3////"_$P(SRCODE,U),DIC("P")=$P(^DD(130,.74,0),U,2) D FILE^DICN K DA,DD,DIC,DO,DR
"RTN","SROVER3",83,0)
DH D HDR^SROVER2 D DOTH
"RTN","SROVER3",84,0)
 Q
"RTN","SROVER3",85,0)
SCEC() N SRSDATE,DFN,SCEC S SRSDATE=$S($D(SRTN):$P(^SRF(SRTN,0),U,9),1:DT)
"RTN","SROVER3",86,0)
 S DFN=$P(^SRF(SRTN,0),U) D CL^SDCO21(DFN,SRSDATE,,.SRCL)
"RTN","SROVER3",87,0)
 S SCEC=$S($D(SRCL):1,1:0)
"RTN","SROVER3",88,0)
 Q SCEC
"RTN","SRSCHC2")
0^50^B1652836^B1775654
"RTN","SRSCHC2",1,0)
SRSCHC2 ;B'HAM ISC/MAM - SCHEDULING INFO FOR CONCURRENT CASES ; [ 04/26/97  3:07 PM ]
"RTN","SRSCHC2",2,0)
 ;;3.0;Surgery;**67,107,177**;24 Jun 93;Build 89
"RTN","SRSCHC2",3,0)
 ;
"RTN","SRSCHC2",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRSCHC2",5,0)
 ;
"RTN","SRSCHC2",6,0)
 D ^SROBLOD K DR,DIE,DA S DR="38////"_BLOOD_";40////"_CROSSM,DA=SRTN,DIE=130 D ^DIE K DR,DA,DIE
"RTN","SRSCHC2",7,0)
 D RT K DR,SRODR,SRNOCON S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SRSCHC2",8,0)
 S DA=SRTN S DIE=130,DR="[SRSRES2]",DA=SRTN D ^DIE S DIE=130,DR="[SRSRES-SCHED]",DA=SRTN S SPD=$$CHKS^SRSCOR(SRTN) D EN2^SROVAR K Q3("VIEW") D ^SRCUSS K DR
"RTN","SRSCHC2",9,0)
 I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SRSCHC2",10,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SRSCHC2",11,0)
 I $D(SRODR) S SRNOCON=1 D ^SROCON1
"RTN","SRSCHC2",12,0)
 Q
"RTN","SRSCHC2",13,0)
RT ; start RT logging
"RTN","SRSCHC2",14,0)
 I $D(XRTL) S XRTN="SRSCHC2" D T0^%ZOSV
"RTN","SRSCHC2",15,0)
 Q
"RTN","SRSCHUN")
0^69^B32328292^B30666407
"RTN","SRSCHUN",1,0)
SRSCHUN ;BIR/ADM - MAKE UNREQUESTED OPERATION ; 31 Jul 2014  2:41 PM
"RTN","SRSCHUN",2,0)
 ;;3.0;Surgery;**3,67,68,88,103,100,144,158,175,177**;24 Jun 93;Build 89
"RTN","SRSCHUN",3,0)
MUST S SRLINE="" F I=1:1:80 S SRLINE=SRLINE_"="
"RTN","SRSCHUN",4,0)
 W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?14,"SCHEDULE UNREQUESTED OPERATION: REQUIRED INFORMATION",!!,SRNM_" ("_$G(SRSSN)_")",?65,SREQDT,!,SRLINE,!
"RTN","SRSCHUN",5,0)
ODP N SRSODP K DIR S DIR(0)="130,616",DIR("A")="Desired Procedure Date" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRSCHUN",6,0)
 I Y=""!(X["^")!(Y<SRSDATE) W !!,"The Desired Procedure Date MUST be entered and should be greater than or equal  to date of operation.  Enter '^' to exit.",! G ODP
"RTN","SRSCHUN",7,0)
 S SRSODP=+Y
"RTN","SRSCHUN",8,0)
SURG ; surgeon
"RTN","SRSCHUN",9,0)
 K DIR S DIR(0)="130,.14",DIR("A")="Surgeon" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRSCHUN",10,0)
 I Y=""!(X["^") W !!,"To create a surgical case, a surgeon MUST be selected.  Enter '^' to exit.",! G SURG
"RTN","SRSCHUN",11,0)
 S SRSDOC=+Y
"RTN","SRSCHUN",12,0)
CASE ; create case in SURGERY file
"RTN","SRSCHUN",13,0)
 K DA,DIC,DD,DO,DINUM,SRTN S X=SRSDPT,DIC="^SRF(",DIC(0)="L",DLAYGO=130 D FILE^DICN K DD,DO,DIC,DLAYGO S SRTN=+Y,SRLCK=$$LOCK^SROUTL(SRTN)
"RTN","SRSCHUN",14,0)
 S ^SRF(SRTN,8)=SRSITE("DIV"),^SRF(SRTN,"OP")=""
"RTN","SRSCHUN",15,0)
 D NOW^%DTC S SREQDAY=+$E(%,1,12),SRNOCON=1 K DR,DIE
"RTN","SRSCHUN",16,0)
 S DA=SRTN,DIE=130,DR=".09////"_SRSDATE_";.14////"_SRSDOC_";1.098////"_+SREQDAY_";1.099////"_DUZ_";Q;.02////"_SRSOR_";10////"_SRSDT1_";11////"_SRSDT2_";616////"_SRSODP_";612////"_SRSODP_";613////"_SREQDAY_";615////"_SREQDAY
"RTN","SRSCHUN",17,0)
 D ^DIE K DR
"RTN","SRSCHUN",18,0)
ASURG ; attending surgeon
"RTN","SRSCHUN",19,0)
 K DA,DIC,DIQ,DR,SRY S DIC="^SRF(",DA=SRTN,DIQ="SRY",DIQ(0)="E",DR=.164 D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SRSCHUN",20,0)
 I $G(SRY(130,SRTN,.164,"E"))'="" S SRATTND=SRY(130,SRTN,.164,"E") W !,"Attending Surgeon: "_SRATTND,! G SPEC
"RTN","SRSCHUN",21,0)
 K DIR S DIR(0)="130,.164",DIR("A")="Attending Surgeon" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRSCHUN",22,0)
 I Y=""!(X["^") W !!,"An Attending Surgeon must be entered when creating a case. Enter '^' to exit.",! G ASURG
"RTN","SRSCHUN",23,0)
 S SRATTND=+Y,DA=SRTN,DIE=130,DR=".164////"_SRATTND D ^DIE K DA,DIE,DR
"RTN","SRSCHUN",24,0)
SPEC ; surgical specialty
"RTN","SRSCHUN",25,0)
 K DIR S DIR(0)="130,.04",DIR("A")="Surgical Specialty" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRSCHUN",26,0)
 I Y=""!(X["^") W !!,"To create a surgical case, a surgical specialty MUST be selected.  Enter '^'",!,"to exit.",! G SPEC
"RTN","SRSCHUN",27,0)
 S SRSS=+Y
"RTN","SRSCHUN",28,0)
OP ; principal operative procedure
"RTN","SRSCHUN",29,0)
 K DIR S DIR(0)="130,26",DIR("A")="Principal Operative Procedure" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRSCHUN",30,0)
 I X["^" W !!,"Principal procedure must not contain an up-arrow (^).",! G OP
"RTN","SRSCHUN",31,0)
 S SRSOP=Y I SRSOP="" G OP
"RTN","SRSCHUN",32,0)
OPD ; Principal Preoperative Diagnosis
"RTN","SRSCHUN",33,0)
 K DIR S DIR(0)="130,32",DIR("A")="Principal Preoperative Diagnosis" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRSCHUN",34,0)
 I Y=""!(X["^") W !!,"A Principal Preoperative Diagnosis must be entered",!,"when creating a new case. Enter '^' to exit.",! G OPD
"RTN","SRSCHUN",35,0)
 I X[";" W !,"The Principal Preoperative Diagnosis cannot contain a semicolon (;).",!,"Please re-enter the Diagnosis, using commas in place of the semicolons." G OPD
"RTN","SRSCHUN",36,0)
 S SRSOPD=Y
"RTN","SRSCHUN",37,0)
 W !!,"The information entered into the Principal Preoperative Diagnosis field",!,"has been transferred into the Indications for Operation field.",!,"The Indications for Operation field can be updated later if necessary.",!
"RTN","SRSCHUN",38,0)
 W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SRSCHUN",39,0)
UPDATE ; update case in SURGERY file
"RTN","SRSCHUN",40,0)
 S DA=SRTN,DIE=130,DR="26////"_SRSOP_";68////"_SRSOP_";36////0;Q;.04////"_SRSS_";32////"_SRSOPD D ^DIE
"RTN","SRSCHUN",41,0)
 K DR,DA S DR="[SRO-NOCOMP]",DA=SRTN,DIE=130 D ^DIE K DR
"RTN","SRSCHUN",42,0)
 D ^SROXRET K SRNOCON
"RTN","SRSCHUN",43,0)
OTHER ; other required fields
"RTN","SRSCHUN",44,0)
 S SRFLD=0 F  S SRFLD=$O(^SRO(133,SRSITE,4,SRFLD)) Q:'SRFLD!(SRSOUT)  D OTHDIR Q:SRSOUT
"RTN","SRSCHUN",45,0)
 I SRSOUT G DEL
"RTN","SRSCHUN",46,0)
 S SRSOPD(1)=SRSOPD D WP^DIE(130,SRTN_",",55,"A","SRSOPD")
"RTN","SRSCHUN",47,0)
 D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SRSCHUN",48,0)
 S SROERR=SRTN D ^SROERR I $D(SRDUOUT) S SRSOUT=1
"RTN","SRSCHUN",49,0)
 I $D(SRCC),SRSCON=2 S DIE=130,DR="35////"_SRSCON(1),DA=SRTN D ^DIE K DR S DR="35////"_SRTN,DA=SRSCON(1),DIE=130 D ^DIE K DR,DA S SROERR=SRSCON(1) D ^SROERR0
"RTN","SRSCHUN",50,0)
 Q
"RTN","SRSCHUN",51,0)
DEL S DA=SRTN,DIK="^SRF(" D ^DIK G END
"RTN","SRSCHUN",52,0)
CON ; request concurrent case
"RTN","SRSCHUN",53,0)
 D MUST Q:SRSOUT  S SRSCON(SRSCON,"DOC")=$P(^VA(200,SRSDOC,0),"^"),SRSCON(SRSCON,"SS")=$P(^SRO(137.45,SRSS,0),"^"),SRSCON(SRSCON,"OP")=$P(^SRF(SRTN,"OP"),"^"),SRSCON(SRSCON)=SRTN K DA
"RTN","SRSCHUN",54,0)
 Q
"RTN","SRSCHUN",55,0)
OTHDIR ; call to reader for site specific required fields
"RTN","SRSCHUN",56,0)
 ;JAS - 08/05/14 - SR*3*177 - Modified this section for ICD-10
"RTN","SRSCHUN",57,0)
 K DIR,SREQ,SRY S FLD=$P(^SRO(133,SRSITE,4,SRFLD,0),"^") D FIELD^DID(130,FLD,"","TITLE","SRY") S DIR(0)="130,"_FLD,DIR("A")=SRY("TITLE") D DIRYN I $D(DTOUT)!($G(X)="^") S SRSOUT=1 Q
"RTN","SRSCHUN",58,0)
 I "^32.5^66^253^286^343^344^392^489^"[("^"_FLD_"^") I $G(X)="@"!($G(X)="") S X="^"
"RTN","SRSCHUN",59,0)
 I $G(Y)=""!(X["^") W !!,"It is mandatory that you provide this information before proceeding with this",!,"option.",! D ASK Q:SRSOUT  G OTHDIR
"RTN","SRSCHUN",60,0)
 S SREQ(130,SRTN_",",FLD)=$P(Y,"^") D FILE^DIE("","SREQ","^TMP(""SR"",$J)")
"RTN","SRSCHUN",61,0)
 Q
"RTN","SRSCHUN",62,0)
DIRYN ; call ^DIR if not FILE 80 or ICD-9 FILE 80 (added for SR*3.0*177)
"RTN","SRSCHUN",63,0)
 I "^32.5^66^253^286^343^344^392^489^"[("^"_FLD_"^") D  Q
"RTN","SRSCHUN",64,0)
 . S SRPRMT=DIR("A")_" ",SRDEF=$$GET1^DIQ(130,SRTN,FLD)
"RTN","SRSCHUN",65,0)
 . D ICDSRCH^SROICD
"RTN","SRSCHUN",66,0)
 D ^DIR
"RTN","SRSCHUN",67,0)
 Q
"RTN","SRSCHUN",68,0)
ASK K DIR S DIR(0)="Y",DIR("A")="Do you want to continue with this option ",DIR("B")="YES"
"RTN","SRSCHUN",69,0)
 S DIR("?")="Enter RETURN to continue with this option, or 'NO' to discontinue this option." D ^DIR S:'Y SRSOUT=1
"RTN","SRSCHUN",70,0)
 Q
"RTN","SRSCHUN",71,0)
END D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SRSCHUN",72,0)
 I '$D(SRCC),SRSOUT W !!,"No surgical case has been scheduled.",! S SRTN("OR")=SRSOR,SRTN("START")=SRSDT1,SRTN("END")=SRSDT2,SRSEDT=$E(SRSDT2,1,7) D ^SRSCG
"RTN","SRSCHUN",73,0)
 Q
"RTN","SRSCHUN1")
0^70^B10221743^B9878171
"RTN","SRSCHUN1",1,0)
SRSCHUN1 ;B'HAM ISC/MAM - MAKE UNREQUESTED OPERATION (optional fields); [ 04/26/97  3:15 PM ]
"RTN","SRSCHUN1",2,0)
 ;;3.0;Surgery;**34,47,58,67,107,177**;24 Jun 93;Build 89
"RTN","SRSCHUN1",3,0)
 ;
"RTN","SRSCHUN1",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRSCHUN1",5,0)
 ;
"RTN","SRSCHUN1",6,0)
ANES W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?14,"SCHEDULE UNREQUESTED OPERATION: ANESTHESIA PERSONNEL",!!,SRNM_" ("_SRSSN_")",?65,SREQDT,!,SRLINE
"RTN","SRSCHUN1",7,0)
 K DA,DIE,DR S DIE=130,DA=SRTN,DR=".31T;.34T" D ^DIE K DA,DIE,DR Q:$D(DTOUT)  G:$D(Y) SS
"RTN","SRSCHUN1",8,0)
PROC W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?14,"SCHEDULE UNREQUESTED OPERATION: PROCEDURE INFORMATION",!!,SRNM_" ("_SRSSN_")",?65,SREQDT,!,SRLINE
"RTN","SRSCHUN1",9,0)
 S SROPER=$P(^SRF(SRTN,"OP"),"^") K SROPS,MM,MMM S:$L(SROPER)<55 SROPS(1)=SROPER I $L(SROPER)>54 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSCHUN1",10,0)
 W !,"Principal Procedure: ",?26,SROPS(1) I $D(SROPS(2)) W !,?26,SROPS(2) I $D(SROPS(3)) W !,?26,SROPS(3)
"RTN","SRSCHUN1",11,0)
 I $D(SREQ(27)) W !,"Principal Procedure Code (CPT): "_$P(SREQ(27),"^",2)
"RTN","SRSCHUN1",12,0)
 K DR S DR="" I '$D(SREQ(27)) S DR="27T;"
"RTN","SRSCHUN1",13,0)
 S DR=DR_".42T;60T",DR(2,130.16)=".01T;3T;1.5T",DA=SRTN,DIE=130 D ^DIE K DR,DA Q:$D(DTOUT)  G:$D(Y) SS
"RTN","SRSCHUN1",14,0)
BLOOD W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?20,"SCHEDULE UNREQUESTED OPERATION: BLOOD INFORMATION",!!,SRNM_" ("_SRSSN_")",?65,SREQDT,!,SRLINE,!
"RTN","SRSCHUN1",15,0)
 D ^SROBLOD Q:$D(SRT)  G:$D(SRDUOUT) SS
"RTN","SRSCHUN1",16,0)
OTH S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SRSCHUN1",17,0)
 W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?20,"SCHEDULE UNREQUESTED OPERATION: OTHER INFORMATION",!!,SRNM_" ("_SRSSN_")",?65,SREQDT,!,SRLINE,!
"RTN","SRSCHUN1",18,0)
 ;JAS - 03/25/14 - PATCH 177 - Changes for ICD-10
"RTN","SRSCHUN1",19,0)
 K DR I SRICDV["9" S DR="[SRSCHED-UNREQUESTED]"
"RTN","SRSCHUN1",20,0)
 E  S DR="[SRSCHED-UNREQUESTED-ICD10]"
"RTN","SRSCHUN1",21,0)
 S DIE=130,DA=SRTN D ^DIE K DR S:$D(DTOUT) SRDUOUT=1 I $D(SRODR) D ^SROCON1
"RTN","SRSCHUN1",22,0)
 ;End of 177
"RTN","SRSCHUN1",23,0)
 Q:$D(SRDUOUT)
"RTN","SRSCHUN1",24,0)
 ;
"RTN","SRSCHUN1",25,0)
SS S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SRSCHUN1",26,0)
 D RT K DA,DR,DIC,DIE S DR="[SRSRES-SCHED]",DIE=130,DA=SRTN D EN2^SROVAR K Q3("VIEW") S SPD=$$CHKS^SRSCOR(SRTN) D ^SRCUSS
"RTN","SRSCHUN1",27,0)
 I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SRSCHUN1",28,0)
 K DR S SRSOUT=1 D:$D(SRODR) ^SROCON1 D RISK^SROAUTL3,^SROPCE1
"RTN","SRSCHUN1",29,0)
 S SROERR=SRTN K SRTX D ^SROERR0
"RTN","SRSCHUN1",30,0)
 Q
"RTN","SRSCHUN1",31,0)
LOOP ; break procedure if greater than 54 charcaters
"RTN","SRSCHUN1",32,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<55  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSCHUN1",33,0)
 Q
"RTN","SRSCHUN1",34,0)
RT ; start RT logging
"RTN","SRSCHUN1",35,0)
 I $D(XRTL) S XRTN="SRSCHUN1" D T0^%ZOSV
"RTN","SRSCHUN1",36,0)
 Q
"RTN","SRSRQST")
0^71^B28426612^B26866519
"RTN","SRSRQST",1,0)
SRSRQST ;BIR/MAM,ADM - MAKE OPERATION REQUESTS ;11/01/01  9:40 AM
"RTN","SRSRQST",2,0)
 ;;3.0;Surgery;**3,58,67,88,103,105,100,144,175,177**;24 Jun 93;Build 89
"RTN","SRSRQST",3,0)
MUST S SRLINE="" F I=1:1:80 S SRLINE=SRLINE_"="
"RTN","SRSRQST",4,0)
 W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?20,"OPERATION REQUEST: REQUIRED INFORMATION",!!,SRNM_" ("_SRSSN_")",?65,SREQDT,!,SRLINE,!
"RTN","SRSRQST",5,0)
SURG ; surgeon
"RTN","SRSRQST",6,0)
 K DIR S DIR(0)="130,.14",DIR("A")="Surgeon" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G END
"RTN","SRSRQST",7,0)
 I Y=""!(X["^") W !!,"To make an operation request, a Surgeon MUST be selected.  Enter '^' to exit.",! G SURG
"RTN","SRSRQST",8,0)
 S SRSDOC=+Y
"RTN","SRSRQST",9,0)
CASE K DA,DIC,DD,DO,DINUM,SRTN S X=SRSDPT,DIC="^SRF(",DIC(0)="L",DLAYGO=130 D FILE^DICN K DD,DO,DIC,DLAYGO S SRTN=+Y
"RTN","SRSRQST",10,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN)
"RTN","SRSRQST",11,0)
 S ^SRF(SRTN,8)=SRSITE("DIV"),^SRF(SRTN,"OP")=""
"RTN","SRSRQST",12,0)
 D NOW^%DTC S SREQDAY=+$E(%,1,12),SRNOCON=1 K DR,DIE
"RTN","SRSRQST",13,0)
 S DA=SRTN,DIE=130,DR="36////1;Q;.09////"_SRSDATE_";.14////"_SRSDOC_";1.098////"_+SREQDAY_";1.099////"_DUZ_";Q"_";612////"_SRSDATE_";616////"_SRSDATE_";613////"_SREQDAY D ^DIE K DR
"RTN","SRSRQST",14,0)
ASURG ; attending surgeon
"RTN","SRSRQST",15,0)
 K DIR S DIR(0)="130,.164",DIR("A")="Attending Surgeon" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRSRQST",16,0)
 I Y=""!(X["^") W !!,"To make an operation request, Attending Surgeon MUST be selected.  Enter '^' to exit.",! G ASURG
"RTN","SRSRQST",17,0)
 S SRATTND=+Y
"RTN","SRSRQST",18,0)
SPEC ; surgical specialty
"RTN","SRSRQST",19,0)
 I SRWL W !,"Surgical Specialty: "_$P(^SRO(137.45,SRSS,0),"^") G OP
"RTN","SRSRQST",20,0)
 K DIR S DIR(0)="130,.04",DIR("A")="Surgical Specialty" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRSRQST",21,0)
 I Y=""!(X["^") W !!,"To make an operation request, a Surgical Specialty MUST be selected.  Enter '^'",!,"to exit.",! G SPEC
"RTN","SRSRQST",22,0)
 S SRSS=+Y
"RTN","SRSRQST",23,0)
OP ; principal operative procedure
"RTN","SRSRQST",24,0)
 I SRWL W !,"Principal Operative Procedure: "_SRSOP G OPD
"RTN","SRSRQST",25,0)
 K DIR S DIR(0)="130,26",DIR("A")="Principal Operative Procedure" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRSRQST",26,0)
 I X["^" W !!,"Principal procedure must not contain an up-arrow (^).",! G OP
"RTN","SRSRQST",27,0)
 S SRSOP=Y
"RTN","SRSRQST",28,0)
OPD ; Principal Preoperative Diagnosis
"RTN","SRSRQST",29,0)
 K DIR S DIR(0)="130,32",DIR("A")="Principal Preoperative Diagnosis" D ^DIR K DIR I $D(DTOUT)!(X="^") S SRSOUT=1 G DEL
"RTN","SRSRQST",30,0)
 I Y=""!(X["^") W !,"Principal Preoperative Diagnosis MUST be entered",!,"before proceeding with this request. Enter '^' to exit.",! G OPD
"RTN","SRSRQST",31,0)
 I X[";" W !!,"The Principal Preoperative Diagnosis cannot contain a semicolon (;).",!,"Please re-enter the Diagnosis, using commas in place of the semicolons." G OPD
"RTN","SRSRQST",32,0)
 S SRSOPD=Y
"RTN","SRSRQST",33,0)
 W !!,"The information entered into the Principal Preoperative Diagnosis field",!,"has been transferred into the Indications for Operation field.",!,"The Indications for Operation field can be updated later if necessary.",!
"RTN","SRSRQST",34,0)
 W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SRSRQST",35,0)
UPDATE S DA=SRTN,DIE=130,DR="26////"_SRSOP_";68////"_SRSOP_";.04////"_SRSS_";.164////"_SRATTND_";32////"_SRSOPD D ^DIE
"RTN","SRSRQST",36,0)
 I SRWL K DA,DIE,DR S DA=SRTN,DIE=130,DR=".016////"_SRCL(16)_";.017////"_SRCL(17)_";.018////"_SRCL(18)_";.019////"_SRCL(19)_";.0155////"_SRCL(20)_";.022////"_SRCL(21)_";.023////"_SRCL(22) D ^DIE
"RTN","SRSRQST",37,0)
 K DR,DA S DR="[SRO-NOCOMP]",DA=SRTN,DIE=130 D ^DIE K DR
"RTN","SRSRQST",38,0)
 S ^SRF(SRTN,8)=SRSITE("DIV") D ^SROXRET K SRNOCON
"RTN","SRSRQST",39,0)
OTHER ; other required fields
"RTN","SRSRQST",40,0)
 S SRFLD=0 F  S SRFLD=$O(^SRO(133,SRSITE,4,SRFLD)) Q:'SRFLD!(SRSOUT)  D OTHDIR Q:SRSOUT
"RTN","SRSRQST",41,0)
 I SRSOUT G DEL
"RTN","SRSRQST",42,0)
 S SRSOPD(1)=SRSOPD D WP^DIE(130,SRTN_",",55,"A","SRSOPD")
"RTN","SRSRQST",43,0)
 I $D(SRCC),SRSCON=2 S DIE=130,DR="35////"_SRSCON(1),DA=SRTN D ^DIE K DR S DR="35////"_SRTN,DA=SRSCON(1),DIE=130 D ^DIE K DR,DA
"RTN","SRSRQST",44,0)
 D ^SROERR I $D(SRDUOUT) S SRSOUT=1 Q
"RTN","SRSRQST",45,0)
 I '$D(SRCC) D ^SRSRQST1
"RTN","SRSRQST",46,0)
 D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SRSRQST",47,0)
 Q
"RTN","SRSRQST",48,0)
DEL I SRSOUT S DA=SRTN,DIK="^SRF(" D ^DIK
"RTN","SRSRQST",49,0)
END D:$G(SRLCK) UNLOCK^SROUTL(SRTN)
"RTN","SRSRQST",50,0)
 I SRSOUT W !!,"No request has been entered.",! S:'$D(SRCC) SRSOUT=0
"RTN","SRSRQST",51,0)
 Q
"RTN","SRSRQST",52,0)
CON ; request concurrent case
"RTN","SRSRQST",53,0)
 D MUST Q:SRSOUT  S SRSCON(SRSCON,"DOC")=$P(^VA(200,SRSDOC,0),"^"),SRSCON(SRSCON,"SS")=$P(^SRO(137.45,SRSS,0),"^"),SRSCON(SRSCON,"OP")=SRSOP,SRSCON(SRSCON)=SRTN K DA
"RTN","SRSRQST",54,0)
 Q
"RTN","SRSRQST",55,0)
OTHDIR ; call to reader for site specific required fields
"RTN","SRSRQST",56,0)
 ;JAS - 08/05/14 - SR*3*177 - Modified this section for ICD-10
"RTN","SRSRQST",57,0)
 K DIR,SREQ,SRY S FLD=$P(^SRO(133,SRSITE,4,SRFLD,0),"^") D FIELD^DID(130,FLD,"","TITLE","SRY") S DIR(0)="130,"_FLD,DIR("A")=SRY("TITLE") D DIRYN I $D(DTOUT)!($G(X)="^") S SRSOUT=1 Q
"RTN","SRSRQST",58,0)
 I "^32.5^66^253^286^343^344^392^489^"[("^"_FLD_"^") I $G(X)="@"!($G(X)="") S X="^"
"RTN","SRSRQST",59,0)
 I $G(Y)=""!(X["^") W !!,"It is mandatory that you provide this information before proceeding with this",!,"request.",! D ASK Q:SRSOUT  G OTHDIR
"RTN","SRSRQST",60,0)
 S SREQ(130,SRTN_",",FLD)=$P(Y,"^") D FILE^DIE("","SREQ","^TMP(""SR"",$J)")
"RTN","SRSRQST",61,0)
 Q
"RTN","SRSRQST",62,0)
DIRYN ; call ^DIR if not FILE 80 or ICD-9 FILE 80 (added for SR*3.0*177)
"RTN","SRSRQST",63,0)
 I "^32.5^66^253^286^343^344^392^489^"[("^"_FLD_"^") D  Q
"RTN","SRSRQST",64,0)
 . S SRPRMT=DIR("A")_" ",SRDEF=$$GET1^DIQ(130,SRTN,FLD)
"RTN","SRSRQST",65,0)
 . D ICDSRCH^SROICD
"RTN","SRSRQST",66,0)
 D ^DIR
"RTN","SRSRQST",67,0)
 Q 
"RTN","SRSRQST",68,0)
ASK K DIR S DIR(0)="Y",DIR("A")="Do you want to continue with this request ",DIR("B")="YES"
"RTN","SRSRQST",69,0)
 S DIR("?")="Enter RETURN to continue with this request, or 'NO' to discontinue this request." D ^DIR S:'Y SRSOUT=1
"RTN","SRSRQST",70,0)
 Q
"RTN","SRSRQST1")
0^72^B11754122^B10838483
"RTN","SRSRQST1",1,0)
SRSRQST1 ;B'HAM ISC/MAM,ADM - MAKE REQUEST (optional fields); [ 04/26/97  3:23 PM ]
"RTN","SRSRQST1",2,0)
 ;;3.0;Surgery;**12,34,37,47,58,67,107,177**;24 Jun 93;Build 89
"RTN","SRSRQST1",3,0)
 ;
"RTN","SRSRQST1",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRSRQST1",5,0)
 ;
"RTN","SRSRQST1",6,0)
 D:SRWL REF W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?20,"OPERATION REQUEST: PROCEDURE INFORMATION",!!,SRNM_" ("_SRSSN_")",?65,SREQDT,!,SRLINE
"RTN","SRSRQST1",7,0)
 S SROPER=$P(^SRF(SRTN,"OP"),"^") K SROPS,MM,MMM S:$L(SROPER)<55 SROPS(1)=SROPER I $L(SROPER)>54 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSRQST1",8,0)
 W !,"Principal Procedure: ",?26,SROPS(1) I $D(SROPS(2)) W !,?26,SROPS(2) I $D(SROPS(3)) W !,?26,SROPS(3)
"RTN","SRSRQST1",9,0)
 I $D(SREQ(27)) W !,"Principal Procedure Code (CPT): "_$P(SREQ(27),"^",2)
"RTN","SRSRQST1",10,0)
 S SRSPEC=$P(^SRF(SRTN,0),"^",4),SRAVG=""
"RTN","SRSRQST1",11,0)
 K DR S DR="" I '$D(SREQ(27)) S DR="27T;"
"RTN","SRSRQST1",12,0)
 S DR=DR_".42T;S SRSCPT=$P(^SRF(SRTN,""OP""),""^"",2) D ^SRSAVG;37T//^S X=SRAVG;60T",DR(2,130.16)=".01T;3T;1.5T",DA=SRTN,DIE=130 D ^DIE K DR,DA G:$D(DTOUT) REQ G:$D(Y) SS
"RTN","SRSRQST1",13,0)
BLOOD W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?20,"OPERATION REQUEST: BLOOD INFORMATION",!!,SRNM_" ("_SRSSN_")",?65,SREQDT,!,SRLINE,!
"RTN","SRSRQST1",14,0)
 D ^SROBLOD G:$D(SRT) REQ G:$D(SRDUOUT) SS
"RTN","SRSRQST1",15,0)
OTH S SRICDV=$$ICDSTR^SROICD(SRTN) W @IOF W:$D(SRCC) !,?29,$S(SRSCON=1:"FIRST",1:"SECOND")_" CONCURRENT CASE" W !,?20,"OPERATION REQUEST: OTHER INFORMATION",!!,SRNM_" ("_SRSSN_")",?65,SREQDT,!,SRLINE,!
"RTN","SRSRQST1",16,0)
 ;JAS - 03/26/14 - PATCH 177 - Changes for ICD-10
"RTN","SRSRQST1",17,0)
 K DR I SRICDV["9" S DR="[SREQUEST]"
"RTN","SRSRQST1",18,0)
 E  S DR="[SREQUEST-ICD10]"
"RTN","SRSRQST1",19,0)
 S DIE=130,DA=SRTN D ^DIE K DR S:$D(DTOUT) SRDUOUT=1 I $D(SRODR) D ^SROCON1
"RTN","SRSRQST1",20,0)
 ;End OF 177
"RTN","SRSRQST1",21,0)
 I $D(SRDUOUT) G REQ
"RTN","SRSRQST1",22,0)
SS S SRICDV=$$ICDSTR^SROICD(SRTN) D RT K DA,DR,DIC,DIE S DR="[SRSRES-ENTRY]",DIE=130,DA=SRTN D EN2^SROVAR K Q3("VIEW")
"RTN","SRSRQST1",23,0)
 S SPD=$$CHKS^SRSCOR(SRTN) D ^SRCUSS
"RTN","SRSRQST1",24,0)
 I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SRSRQST1",25,0)
 K DR D:$D(SRODR) ^SROCON1 D RISK^SROAUTL3,REQ^SROPCE1 D:'$D(SRCC) REQ
"RTN","SRSRQST1",26,0)
 S SROERR=SRTN K SRTX D ^SROERR0
"RTN","SRSRQST1",27,0)
 Q
"RTN","SRSRQST1",28,0)
LOOP ; break procedure if greater than 54 charcaters
"RTN","SRSRQST1",29,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<55  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSRQST1",30,0)
 Q
"RTN","SRSRQST1",31,0)
RT ; start RT logging
"RTN","SRSRQST1",32,0)
 I $D(XRTL) S XRTN="SRSRQST1" D T0^%ZOSV
"RTN","SRSRQST1",33,0)
 Q
"RTN","SRSRQST1",34,0)
REF S REFER="",SREFER=$O(^SRO(133.8,"B",SRSER,0)) I $O(^SRO(133.8,SREFER,1,$P(SRW(SRW),"^",2),1,0)) S REFER=^SRO(133.8,SREFER,1,$P(SRW(SRW),"^",2),1,1,0)
"RTN","SRSRQST1",35,0)
 I REFER'="" S ^SRF(SRTN,18,0)="^130.03A^1^1",^SRF(SRTN,18,1,0)=REFER,^SRF(SRTN,18,"B",$P(REFER,"^"),1)=""
"RTN","SRSRQST1",36,0)
DIK K DA,DIK S DA(1)=SREFER,DA=$P(SRW(SRW),"^",2),DIK="^SRO(133.8,"_DA(1)_",1," D ^DIK
"RTN","SRSRQST1",37,0)
 Q
"RTN","SRSRQST1",38,0)
REQ ; print request message
"RTN","SRSRQST1",39,0)
 W !!,"A request has been made for "_SRNM_" on "_$E(SRSDATE,4,5)_"/"_$E(SRSDATE,6,7)_"/"_$E(SRSDATE,2,3)_".",!
"RTN","SRSRQST1",40,0)
 Q
"RTN","SRSUP1")
0^53^B26965296^B26118535
"RTN","SRSUP1",1,0)
SRSUP1 ;BIR/MAM - UPDATE SCHEDULED OPERATION ; [ 01/29/01  2:13 PM ]
"RTN","SRSUP1",2,0)
 ;;3.0;Surgery;**7,16,19,47,58,67,77,50,93,107,114,100,131,177**;24 Jun 93;Build 89
"RTN","SRSUP1",3,0)
 ;
"RTN","SRSUP1",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRSUP1",5,0)
 ;
"RTN","SRSUP1",6,0)
 I $P($G(^SRF(SRTN,"CON")),"^") G CHANGE
"RTN","SRSUP1",7,0)
CON W !!,"Do you want to add a concurrent case ?  NO// " R SRYN:DTIME I '$T!(SRYN["^") G END
"RTN","SRSUP1",8,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="N"
"RTN","SRSUP1",9,0)
 I "YyNn"'[SRYN W !!,"Enter 'YES' if you need to add a case to be performed concurrently with this",!,"case.  Press RETURN to update other information related to this case." G CON
"RTN","SRSUP1",10,0)
 I "Nn"'[SRYN G ^SRSCHCA
"RTN","SRSUP1",11,0)
CHANGE S SRC=1,SRI=$P($G(^SRF(SRTN,8)),"^"),SRS=$O(^SRO(133,"B",SRI,0)),SRTIME=$P(^SRO(133,SRS,0),"^",12) S:SRTIME="" SRTIME=1500
"RTN","SRSUP1",12,0)
 S X1=$E($P(^SRF(SRTN,0),"^",9),1,7),X2=-1,SRYN="N" G:X1<DT EDIT D C^%DTC S SRTIME=X_"."_SRTIME D NOW^%DTC I %>SRTIME S SRC=0
"RTN","SRSUP1",13,0)
 K SRSCC S SRSUPDT=1 W !!,"Do you want to change the ",$S(SRC:"date/",1:""),"time or operating room for which this",!,"case is scheduled ? NO// " R SRYN:DTIME I '$T!(SRYN["^") G END
"RTN","SRSUP1",14,0)
 S SRYN=$E(SRYN) S:SRYN="" SRYN="N"
"RTN","SRSUP1",15,0)
 I "YyNn"'[SRYN W !!,"Enter 'YES' if you need to change the ",$S(SRC:"date, ",1:""),"time or operating room for this",!,"case.  Enter RETURN to update other information related to this case." G CHANGE
"RTN","SRSUP1",16,0)
EDIT G:'$$LOCK^SROUTL(SRTN) END
"RTN","SRSUP1",17,0)
 ;JAS - 7/31/13 - Patch 177 (NEXT LINE)
"RTN","SRSUP1",18,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SRSUP1",19,0)
 I "Yy"'[SRYN D RT K ST,DR,DIE,DA S SPD=$$CHKS^SRSCOR(SRTN),DR="[SRSRES-SCHED]",DIE=130,DA=SRTN D EN2^SROVAR K Q3("VIEW") D ^SRCUSS D SRDYN D:$D(SRODR) ^SROCON1 D RISK^SROAUTL3,^SROPCE1,OERR G END
"RTN","SRSUP1",20,0)
 D ^SRSTCH I SRSOUT G END
"RTN","SRSUP1",21,0)
 D ^SRORESV S SRTN("OR")=SRSOR,SRTN("START")=SRSDT1,SRTN("END")=SRSDT2,SRSEDT=$E(SRSDT2,1,7) D ^SRSCG
"RTN","SRSUP1",22,0)
 S SRTN("SRT")=SRT,SRSTIME1=SRTN("START")_"^"_SRTN("END")_"^"_SRSDT1_"^"_SRSDT2
"RTN","SRSUP1",23,0)
DATE W !! K NODATE S OLDATE=$E(SRTN("START"),1,7) I 'SRC S SRSDATE=OLDATE W !!,"Press RETURN to continue... " R X:DTIME G DIS
"RTN","SRSUP1",24,0)
 S %DT="AEFX",%DT("A")="Reschedule this Procedure for which Date ?  " D ^%DT K %DT S SRSDATE=$S(Y>0:Y,1:OLDATE) I Y<0 S NODATE=1
"RTN","SRSUP1",25,0)
 I '$D(NODATE) D CHECK I SRNOK G DATE
"RTN","SRSUP1",26,0)
 I $D(NODATE) D NODATE I SRSOUT G SCHED
"RTN","SRSUP1",27,0)
DIS D ^SRSDISP I SRSOUT G SCHED
"RTN","SRSUP1",28,0)
 W ! K DIC S DIC="^SRS(",DIC(0)="QEAMZ",DIC("S")="I $$ORDIV^SROUTL0(+Y,$G(SRSITE(""DIV""))),('$P(^SRS(+Y,0),U,6))",DIC("A")="Schedule this case for which Operating Room: " D ^DIC K DIC I Y<0 S SRSOUT=1 G SCHED
"RTN","SRSUP1",29,0)
 S SRSOR=+Y,X1=SRSDATE,X2=2830103 D ^%DTC S SRSDAY=$P("MO^TU^WE^TH^FR^SA^SU","^",X#7+1)
"RTN","SRSUP1",30,0)
 D ^SRSTIME I SRSOUT G SCHED
"RTN","SRSUP1",31,0)
 S SRNOREQ=1 K DIE,DR,DA S DR="36///1;Q;.09///"_$S(SRSDATE=OLDATE:OLDATE,1:SRSDATE),DA=SRTN,DIE=130 D ^DIE K DR,DA,DIE
"RTN","SRSUP1",32,0)
SCHED S S(0)=^SRF(SRTN,0),SRSERV=$P(S(0),"^",4) S DA=SRTN,DIE=130,DR=".04////"_SRSERV D ^DIE K DR,DA,DIE
"RTN","SRSUP1",33,0)
 I SRSOUT S SRSDATE=OLDATE,SRSOR=SRTN("OR"),SRSTIME=SRTN("SRT"),SRSDT1=$P(SRSTIME1,"^",3),SRSDT2=$P(SRSTIME1,"^",4),SRSET1=$P(SRSTIME,"^",2)
"RTN","SRSUP1",34,0)
 K SRGRPH,SRSDT3 S COUNT=1,MM=$E(SRSDT2,1,7),XX=$E(SRSDT1,1,7) I MM>XX S SRSDT3=MM,$P(SRSTIME,"^",2)="24:00"
"RTN","SRSUP1",35,0)
 K X0,X1 D EN2^SRSCHD2 I $D(SRSLAP) S SRSOUT=1 K SRSLAP G SCHED
"RTN","SRSUP1",36,0)
 D:SRSDATE'=OLDATE ^SROXRET D OERR
"RTN","SRSUP1",37,0)
 D UNLOCK^SROUTL(SRTN)
"RTN","SRSUP1",38,0)
END ;
"RTN","SRSUP1",39,0)
 W @IOF D ^SRSKILL K SRTN
"RTN","SRSUP1",40,0)
 Q
"RTN","SRSUP1",41,0)
NODATE ; new date not entered
"RTN","SRSUP1",42,0)
 W !!,"Since no date has been entered, I must assume that you want to re-schedule",!,"this case for the same date.  If you have made a mistake and want to",!,"leave this case scheduled for the same operating room at the same times,"
"RTN","SRSUP1",43,0)
 W !,"enter RETURN when prompted to select an operating room."
"RTN","SRSUP1",44,0)
 R !!,"Press RETURN to continue  ",X:DTIME I '$T!(X["^") S SRSOUT=1
"RTN","SRSUP1",45,0)
 Q
"RTN","SRSUP1",46,0)
DIE S SRICDV=$$ICDSTR^SROICD(SRTN) K ST,DR,DIE,DA S DR="[SRSRES-SCHED]",DIE=130,DA=SRTN D EN2^SROVAR K Q3("VIEW") D ^SRCUSS K DR D SRDYN
"RTN","SRSUP1",47,0)
 Q
"RTN","SRSUP1",48,0)
RT ; start RT logging
"RTN","SRSUP1",49,0)
 I $D(XRTL) S XRTN="SRSUP1" D T0^%ZOSV
"RTN","SRSUP1",50,0)
 Q
"RTN","SRSUP1",51,0)
CHECK N SRHOL S SRHOL="",SRNOK=0,X=SRSDATE D H^%DTC S SRDAY=%Y+1 S SRDL=$P($G(^SRO(133,SRSITE,2)),"^",SRDAY) S:SRDL="" SRDL=1
"RTN","SRSUP1",52,0)
 I 'SRDL W !!,"Scheduling not allowed for "_$S(SRDAY=1:"SUNDAY",SRDAY=2:"MONDAY",SRDAY=3:"TUESDAY",SRDAY=4:"WEDNESDAY",SRDAY=5:"THURSDAY",SRDAY=6:"FRIDAY",1:"SATURDAY")_" !!",! S SRNOK=1 Q
"RTN","SRSUP1",53,0)
 K DIC S DIC=40.5,DIC(0)="XM",X=SRSDATE D ^DIC K DIC S SRHOL=$P(Y,"^") I SRHOL>0,'$D(^SRO(133,SRSITE,3,SRSDATE,0)) D  S SRNOK=1
"RTN","SRSUP1",54,0)
 .S DIC=40.5,DR="2",DA=SRHOL,DIQ="SRY",DIQ(0)="E" D EN^DIQ1 K DA,DIC,DIQ,DR
"RTN","SRSUP1",55,0)
 .W !!,"Scheduling not allowed for "_SRY(40.5,SRHOL,2,"E")_" !!",!
"RTN","SRSUP1",56,0)
 Q
"RTN","SRSUP1",57,0)
OERR ; update status in ORDER file (100)
"RTN","SRSUP1",58,0)
 S SROERR=SRTN D ^SROERR0
"RTN","SRSUP1",59,0)
 Q
"RTN","SRSUP1",60,0)
SRDYN I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SRSUP1",61,0)
 Q
"RTN","SRSUPRQ")
0^54^B28414875^B28797469
"RTN","SRSUPRQ",1,0)
SRSUPRQ ;B'HAM ISC/MAM - UPDATE REQUESTED OPERATIONS; [ 08/29/01  9:04 AM ]
"RTN","SRSUPRQ",2,0)
 ;;3.0;Surgery;**7,47,58,67,107,114,100,154,177**;24 Jun 93;Build 89
"RTN","SRSUPRQ",3,0)
 ;
"RTN","SRSUPRQ",4,0)
 ; Reference to ^TMP("CSLSUR1" supported by DBIA #3498
"RTN","SRSUPRQ",5,0)
 ;
"RTN","SRSUPRQ",6,0)
 K SRSCHED
"RTN","SRSUPRQ",7,0)
ASK K DIC,SRCASE S SRSOUT=0,DIC=2,DIC(0)="QEAMZ",DIC("A")="Select Patient: " D ^DIC K DIC Q:Y<0  S SRDFN=+Y,SRNM=$P(Y(0),"^")
"RTN","SRSUPRQ",8,0)
 S (CNT,SRSDATE,SRTN)=0 F  S SRSDATE=$O(^SRF("AR",SRSDATE)) Q:'SRSDATE  F  S SRTN=$O(^SRF("AR",SRSDATE,SRDFN,SRTN)) Q:'SRTN  D SETUP
"RTN","SRSUPRQ",9,0)
 I '$D(SRCASE(1)) W !!,"There are no requested cases for "_SRNM_"." G END
"RTN","SRSUPRQ",10,0)
 S GRAMMER=$S($D(SRCASE(2)):"cases are",1:"case is") W @IOF,!,"The following "_GRAMMER_" requested for "_SRNM_":",!
"RTN","SRSUPRQ",11,0)
 S CNT=0 F  S CNT=$O(SRCASE(CNT)) Q:'CNT  D OPS W !,$P(SRCASE(CNT),"^",2),?15,SROPS(1) I $D(SROPS(2)) W !,?15,SROPS(2) I $D(SROPS(3)) W !,?15,SROPS(3)
"RTN","SRSUPRQ",12,0)
OPT S SREQ=1 I $D(SRCASE(2)) D MANY
"RTN","SRSUPRQ",13,0)
 G:"^"[SREQ END S:'$D(SRCASE(2)) SRTN=$P(SRCASE(1),"^") S SRSDATE=$E($P(^SRF(SRTN,0),"^",9),1,7) I $P(^SRF(SRTN,0),"^",4)="" D SS^SRSCHUP I SRSOUT K SRTN
"RTN","SRSUPRQ",14,0)
 Q:$D(SRSCHED)  G:'$D(SRTN) END W !!,"1. Delete",!,"2. Update Request Information",!,"3. Change the Request Date"
"RTN","SRSUPRQ",15,0)
SEL W !!,"Select Number: " R Z:DTIME S:'$T!("^"[Z) SRSOUT=1 G:SRSOUT END S:Z["?" Z=4
"RTN","SRSUPRQ",16,0)
 I Z<1!(Z>3)!(+Z\1'=Z) W !!,"If you want to delete this request, enter '1'.  Enter '2' if you only want",!,"to update the general information about this case, or '3' to change the date",!,"that this case is requested for." G SEL
"RTN","SRSUPRQ",17,0)
 I $D(^XTMP("SRLOCK-"_SRTN)) D MSG G END
"RTN","SRSUPRQ",18,0)
 I Z=1 D DEL G END
"RTN","SRSUPRQ",19,0)
 I Z=2 D UPDATE S SRSOUT=1 G END
"RTN","SRSUPRQ",20,0)
 I Z=3 D CHANGE^SRSDT
"RTN","SRSUPRQ",21,0)
END I '$D(SRLATE) S SRLATE=0
"RTN","SRSUPRQ",22,0)
 I 'SRLATE,'SRSOUT W !!,"Press RETURN to continue  " R X:DTIME
"RTN","SRSUPRQ",23,0)
 W @IOF D ^SRSKILL K SRTN,SRTN1,SRTNX
"RTN","SRSUPRQ",24,0)
 Q
"RTN","SRSUPRQ",25,0)
OPS S SROPER=$P(SRCASE(CNT),"^",3) K SROPS,MM,MMM S:$L(SROPER)<60 SROPS(1)=SROPER I $L(SROPER)>59 S SROPER=SROPER_"  " F M=1:1 D LOOP Q:MMM=""
"RTN","SRSUPRQ",26,0)
 Q
"RTN","SRSUPRQ",27,0)
LOOP ; break procedure if greater than 60 characters
"RTN","SRSUPRQ",28,0)
 S SROPS(M)="" F LOOP=1:1 S MM=$P(SROPER," "),MMM=$P(SROPER," ",2,200) Q:MMM=""  Q:$L(SROPS(M))+$L(MM)'<60  S SROPS(M)=SROPS(M)_MM_" ",SROPER=MMM
"RTN","SRSUPRQ",29,0)
 Q
"RTN","SRSUPRQ",30,0)
MANY ; select requested case if more than one
"RTN","SRSUPRQ",31,0)
 W !!,"Select Operation Request: " R SREQ:DTIME S:'$T SREQ="^" Q:"^"[SREQ  I SREQ["?"!'$D(SRCASE(SREQ)) W !!,"Enter the number corresponding to the request that will be updated or deleted. " G MANY
"RTN","SRSUPRQ",32,0)
 S SRTN=$P(SRCASE(SREQ),"^")
"RTN","SRSUPRQ",33,0)
 Q
"RTN","SRSUPRQ",34,0)
SETUP ; set SRCASE array to list requested cases for this patient
"RTN","SRSUPRQ",35,0)
 S CNT=CNT+1,SRSDT=$P(^SRF(SRTN,0),"^",9),SRSDT=$E(SRSDT,4,5)_"-"_$E(SRSDT,6,7)_"-"_$E(SRSDT,2,3),SRCASE(CNT)=SRTN_"^"_CNT_".  "_SRSDT_"^"_$P(^SRF(SRTN,"OP"),"^")
"RTN","SRSUPRQ",36,0)
 Q
"RTN","SRSUPRQ",37,0)
DEL ; delete request
"RTN","SRSUPRQ",38,0)
 S SRBOTH=0 W !!,"Are you sure that you want to delete this request ?  YES// " R X:DTIME S:'$T X="N" S:X="" X="Y" I X["?" W !!,"Enter RETURN if this request is to be deleted, or NO to quit. " G DEL
"RTN","SRSUPRQ",39,0)
 S X=$E(X) Q:"Yy"'[X  I '$$LOCK^SROUTL(SRTN) Q
"RTN","SRSUPRQ",40,0)
 K DIE,DR,DA S DA=SRTN,DIE=130,DR="36///0;Q;.09///"_SRSDATE D ^DIE K DR,DA,DIE S SRSDOC=$P(^SRF(SRTN,.1),"^",4)
"RTN","SRSUPRQ",41,0)
 S SRCON=$P($G(^SRF(SRTN,"CON")),"^") I SRCON D CON I SRBOTH="^" G END
"RTN","SRSUPRQ",42,0)
OPALSO ; delete from file 130
"RTN","SRSUPRQ",43,0)
 S SROPCOM="Operation ..."
"RTN","SRSUPRQ",44,0)
 S DFN=SRDFN,SRCC="",SRTNX=SRTN D KILL^SROPDEL,UNLOCK^SROUTL(SRTNX) S SRTN=SRTN1 I $D(SRCON) S SRC="" G:"^"[SRBOTH END I SRBOTH=1 S SRTN=SRCON,SRCC="Concurrent " D KILL^SROPDEL,UNLOCK^SROUTL(SRCON)
"RTN","SRSUPRQ",45,0)
 Q
"RTN","SRSUPRQ",46,0)
CON S SRCON=^SRF(SRTN,"CON"),SRC="the request for" D CC Q:SRBOTH="^"  I SRBOTH=1 K DIE,DR,DA S DA=SRCON,DIE=130,DR="36///0;Q;.09///"_SRSDATE D ^DIE K DR,DIE,DA S SRSDOCC=$P(^SRF(SRCON,.1),"^",4)
"RTN","SRSUPRQ",47,0)
 Q
"RTN","SRSUPRQ",48,0)
CC ; check to see if concurrent case should be deleted
"RTN","SRSUPRQ",49,0)
 W !!,"A concurrent case has been requested for this operation.  Do you want to",!,"delete "_SRC_" it also ?  YES// " R SRBOTH:DTIME S:'$T SRBOTH="^" I SRBOTH["?" W !!,"Enter 'Y' if you want to delete "_SRC_" concurrent case." G CC
"RTN","SRSUPRQ",50,0)
 S:SRBOTH="" SRBOTH="Y" S SRBOTH=$E(SRBOTH) I "YyNn"'[SRBOTH W !!,"Enter RETURN if you want these case to remain concurrent." G CC
"RTN","SRSUPRQ",51,0)
 I SRBOTH["Y" S SRBOTH=1
"RTN","SRSUPRQ",52,0)
 S DA=SRCON,DR="35///@",DIE=130 D ^DIE S SROERR=SRCON D ^SROERR0 S DA=SRTN,DR="35///@",DIE=130 D ^DIE
"RTN","SRSUPRQ",53,0)
 I SRBOTH'=1 K SRCON
"RTN","SRSUPRQ",54,0)
 Q
"RTN","SRSUPRQ",55,0)
UPDATE ; update requested operation
"RTN","SRSUPRQ",56,0)
 N SRLCK S SRLCK=$$LOCK^SROUTL(SRTN) Q:'SRLCK
"RTN","SRSUPRQ",57,0)
 D AVG^SRSREQ D RT K SRLNTH,SRLNTH1,DR,X
"RTN","SRSUPRQ",58,0)
 ;JAS - 7/31/13 - Patch 177 (NEXT LINE)
"RTN","SRSUPRQ",59,0)
 N SRICDV S SRICDV=$$ICDSTR^SROICD(SRTN)
"RTN","SRSUPRQ",60,0)
 S ST="UPDATE REQUEST",DA=SRTN,DIE=130,DR="[SRSRES-ENTRY]"
"RTN","SRSUPRQ",61,0)
 D EN2^SROVAR K Q3("VIEW"),Y
"RTN","SRSUPRQ",62,0)
 S SPD=$$CHKS^SRSCOR(SRTN)
"RTN","SRSUPRQ",63,0)
 D ^SRCUSS
"RTN","SRSUPRQ",64,0)
 I SPD'=$$CHKS^SRSCOR(SRTN) S ^TMP("CSLSUR1",$J)=""
"RTN","SRSUPRQ",65,0)
 K DR D:$D(SRODR) ^SROCON1
"RTN","SRSUPRQ",66,0)
 D RISK^SROAUTL3
"RTN","SRSUPRQ",67,0)
 D ^SROPCE1
"RTN","SRSUPRQ",68,0)
 S SROERR=SRTN K SRTX D ^SROERR0
"RTN","SRSUPRQ",69,0)
 I $G(SRLCK) D UNLOCK^SROUTL(SRTN)
"RTN","SRSUPRQ",70,0)
 Q
"RTN","SRSUPRQ",71,0)
RT ; start RT logging
"RTN","SRSUPRQ",72,0)
 I $D(XRTL) S XRTN="SRSUPRQ" D T0^%ZOSV
"RTN","SRSUPRQ",73,0)
 Q
"RTN","SRSUPRQ",74,0)
MSG W !!,"This case is currently being edited.",!,"Please try again later...",!! Q
"SEC","^DIC",130.4,130.4,0,"AUDIT")
@
"SEC","^DIC",130.4,130.4,0,"DD")
@
"SEC","^DIC",130.4,130.4,0,"DEL")
@
"SEC","^DIC",130.4,130.4,0,"LAYGO")
@
"SEC","^DIC",130.4,130.4,0,"RD")
@
"SEC","^DIC",130.4,130.4,0,"WR")
@
"UP",130,130.13,-1)
130^10
"UP",130,130.13,0)
130.13
"UP",130,130.17,-1)
130^14
"UP",130,130.17,0)
130.17
"UP",130,130.18,-1)
130^15
"UP",130,130.18,0)
130.18
"UP",130,130.22,-1)
130^16
"UP",130,130.22,0)
130.22
"UP",136,136.02,-1)
136^2
"UP",136,136.02,0)
136.02
"UP",136,136.04,-1)
136^4
"UP",136,136.04,0)
136.04
"UP",136,136.32,-2)
136^3
"UP",136,136.32,-1)
136.03^2
"UP",136,136.32,0)
136.32
"VER")
8.0^22.0
"^DD",130,130,32.5,0)
PRIN PRE-OP ICD DIAGNOSIS CODE^*P80'X^ICD9(^34;3^D GETAPI^SROICDGT("SURG","DIAG",DA)
"^DD",130,130,32.5,.1)
Prin Pre-op ICD Diagnosis Code
"^DD",130,130,32.5,1,0)
^.1
"^DD",130,130,32.5,1,1,0)
130^AM^MUMPS
"^DD",130,130,32.5,1,1,1)
S $P(^SRF(DA,34),"^",2)=X
"^DD",130,130,32.5,1,1,2)
Q
"^DD",130,130,32.5,1,1,"%D",0)
^^3^3^3120210^
"^DD",130,130,32.5,1,1,"%D",1,0)
This cross reference stuffs the current value of the PRIN PRE-OP
"^DD",130,130,32.5,1,1,"%D",2,0)
ICD DIAGNOSIS CODE field (#32.5) into the PRIN DIAGNOSIS CODE
"^DD",130,130,32.5,1,1,"%D",3,0)
field (#66).
"^DD",130,130,32.5,1,1,"DT")
3120210
"^DD",130,130,32.5,3)
Enter the ICD Diagnosis code for the principal Pre-OP diagnosis.
"^DD",130,130,32.5,12.1)
S DIC("S")="I $P(^(0),""^"",9)'=1"
"^DD",130,130,32.5,21,0)
^.001^2^2^3130305^^^^
"^DD",130,130,32.5,21,1,0)
This is the principal Pre-OP ICD diagnosis code.  It should be entered
"^DD",130,130,32.5,21,2,0)
for all cases.
"^DD",130,130,32.5,"DT")
3140311
"^DD",130,130,66,0)
PLANNED PRIN DIAGNOSIS CODE^*P80'XO^ICD9(^34;2^D GETAPI^SROICDGT("SURG","DIAG",$S($G(DA):DA,$G(SRTN):SRTN,1:""))
"^DD",130,130,66,.1)
Planned Principal Diagnosis Code
"^DD",130,130,66,1,0)
^.1^^-1
"^DD",130,130,66,1,2,0)
130^PADX1^MUMPS
"^DD",130,130,66,1,2,1)
Q
"^DD",130,130,66,1,2,2)
D PRINASOD^SROADX2
"^DD",130,130,66,1,2,"%D",0)
^.101^2^2^3031015^^
"^DD",130,130,66,1,2,"%D",1,0)
This MUMPS cross reference removes associations to procedures upon edits 
"^DD",130,130,66,1,2,"%D",2,0)
or deletes of the diagnosis.
"^DD",130,130,66,1,2,"DT")
3031002
"^DD",130,130,66,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130,66,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130,66,3)
Enter the planned ICD Diagnosis code for the principal diagnosis.
"^DD",130,130,66,21,0)
^.001^2^2^3120215^^^^
"^DD",130,130,66,21,1,0)
This is the planned principal postoperative ICD diagnosis code assigned 
"^DD",130,130,66,21,2,0)
by the clinician.
"^DD",130,130,66,"DEL",1,0)
I 1 D EN^DDIOL("The PRIN DIAGNOSIS CODE can't be deleted.",,"!!,?2")
"^DD",130,130,66,"DT")
3140728
"^DD",130,130,69,0)
CODING VERIFIER^P200'^VA(200,^VER;2^Q
"^DD",130,130,69,.1)
Coding Verifier
"^DD",130,130,69,3)
Enter the name of the person entering the CPT and ICD codes for this case.
"^DD",130,130,69,21,0)
^^4^4^2981124^^
"^DD",130,130,69,21,1,0)
This is the person who last updated procedure and/or diagnosis
"^DD",130,130,69,21,2,0)
descriptions and/or codes for this case using the Update/Verify
"^DD",130,130,69,21,3,0)
Procedure/Diagnosis Codes [SRCODING EDIT] option.  This field is updated
"^DD",130,130,69,21,4,0)
automatically by the option when information is changed.
"^DD",130,130,69,"DT")
3111024
"^DD",130,130,253,0)
OTHER RESPIRATORY OCCURRENCE^*P80'XO^ICD9(^205;14^D GETAPI^SROICDGT("SURG","DIAG",$G(DA))
"^DD",130,130,253,.1)
Other Respiratory Occurrence (ICD Diagnosis)
"^DD",130,130,253,2)
S Y(0)=Y I $G(Y) S Y=$$ICDC^SROICD(Y),Y=$P(Y,"^")_"  "_$P(Y,"^",3)
"^DD",130,130,253,2.1)
I $G(Y) S Y=$$ICDC^SROICD(Y),Y=$P(Y,"^")_"  "_$P(Y,"^",3)
"^DD",130,130,253,3)
Enter the ICD Diagnosis code related to the postoperative respiratory occurrence.
"^DD",130,130,253,21,0)
^.001^4^4^3120215^^^
"^DD",130,130,253,21,1,0)
Definition Revised (2004):
"^DD",130,130,253,21,2,0)
Enter any other respiratory occurrences that you feel to be significant
"^DD",130,130,253,21,3,0)
and that are not covered by the predefined respiratory occurrence
"^DD",130,130,253,21,4,0)
categories. Enter the ICD-CM code for this entry.
"^DD",130,130,253,"DT")
3130318
"^DD",130,130,286,0)
OTHER URINARY TRACT OCCURRENCE^*P80'XO^ICD9(^205;19^D GETAPI^SROICDGT("SURG","DIAG",DA)
"^DD",130,130,286,.1)
Other Urinary Tract Occurrences (ICD Diagnosis)
"^DD",130,130,286,2)
S Y(0)=Y I $G(Y) S Y=$$ICDC^SROICD(Y),Y=$P(Y,"^")_"  "_$P(Y,"^",3)
"^DD",130,130,286,2.1)
I $G(Y) S Y=$$ICDC^SROICD(Y),Y=$P(Y,"^")_"  "_$P(Y,"^",3)
"^DD",130,130,286,3)
Enter the ICD Diagnosis code for the postoperative urinary tract occurrence.
"^DD",130,130,286,21,0)
^.001^4^4^3120215^^
"^DD",130,130,286,21,1,0)
Definition Revised (2004):
"^DD",130,130,286,21,2,0)
Enter any other urinary occurrences which you feel to be significant 
"^DD",130,130,286,21,3,0)
and that are not covered by the predefined urinary tract occurrence
"^DD",130,130,286,21,4,0)
categories. Enter the ICD-CM code for this entry.
"^DD",130,130,286,"DT")
3120217
"^DD",130,130,343,0)
OTHER CNS OCCURRENCE^*P80'XO^ICD9(^205;24^D GETAPI^SROICDGT("SURG","DIAG",DA)
"^DD",130,130,343,.1)
Other CNS Occurrence
"^DD",130,130,343,2)
S Y(0)=Y I $G(Y) S Y=$$ICDC^SROICD(Y),Y=$P(Y,"^")_"  "_$P(Y,"^",3)
"^DD",130,130,343,2.1)
I $G(Y) S Y=$$ICDC^SROICD(Y),Y=$P(Y,"^")_"  "_$P(Y,"^",3)
"^DD",130,130,343,3)
Enter the ICD Diagnosis code for any other CNS occurrence.
"^DD",130,130,343,21,0)
^.001^4^4^3120215^^^
"^DD",130,130,343,21,1,0)
Definition Revised (2004):
"^DD",130,130,343,21,2,0)
Enter any other neurologic related occurrences, which you feel to be 
"^DD",130,130,343,21,3,0)
significant and that are not covered by the predefined CNS occurrence
"^DD",130,130,343,21,4,0)
categories. Enter the ICD-CM code for this entry.
"^DD",130,130,343,"DT")
3120217
"^DD",130,130,344,0)
OTHER CARDIAC OCCURRENCE^*P80'XO^ICD9(^205;29^D GETAPI^SROICDGT("SURG","DIAG",DA)
"^DD",130,130,344,.1)
Other Cardiac Occurrence
"^DD",130,130,344,2)
S Y(0)=Y I $G(Y) S Y=$$ICDC^SROICD(Y),Y=$P(Y,"^")_"  "_$P(Y,"^",3)
"^DD",130,130,344,2.1)
I $G(Y) S Y=$$ICDC^SROICD(Y),Y=$P(Y,"^")_"  "_$P(Y,"^",3)
"^DD",130,130,344,3)
Enter the ICD Diagnosis code corresponding to the cardiac occurrence.
"^DD",130,130,344,21,0)
^.001^4^4^3120215^^
"^DD",130,130,344,21,1,0)
Definition Revised (2004):
"^DD",130,130,344,21,2,0)
Enter any other cardiac related surgical occurrences which you feel to 
"^DD",130,130,344,21,3,0)
be significant and that are not covered by the predefined occurrence
"^DD",130,130,344,21,4,0)
categories. Enter the ICD-CM code for this entry.
"^DD",130,130,344,"DT")
3130110
"^DD",130,130,392,0)
OTHER OCCURRENCES (ICD)^*P80'X^ICD9(^205;36^D GETAPI^SROICDGT("SURG","DIAG",DA)
"^DD",130,130,392,.1)
Other Occurrences (ICD)
"^DD",130,130,392,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130,392,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130,392,3)
Enter the ICD Diagnosis Code for any other occurrence.
"^DD",130,130,392,21,0)
^.001^4^4^3120215^^
"^DD",130,130,392,21,1,0)
Definition Revised (2004):
"^DD",130,130,392,21,2,0)
Enter any other surgical occurrences which you feel to be significant
"^DD",130,130,392,21,3,0)
and that are not covered by the predefined occurrence categories. Enter
"^DD",130,130,392,21,4,0)
the ICD-CM code for this entry. 
"^DD",130,130,392,"DT")
3120217
"^DD",130,130,489,0)
OTHER WOUND OCCURRENCE^*P80'X^ICD9(^205;38^D GETAPI^SROICDGT("SURG","DIAG",DA)
"^DD",130,130,489,.1)
Other Wound Occurrence
"^DD",130,130,489,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130,489,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130,489,3)
Enter the ICD Diagnosis code for any other wound occurrence.
"^DD",130,130,489,21,0)
^.001^5^5^3120215^^
"^DD",130,130,489,21,1,0)
Definition Revised (2004):
"^DD",130,130,489,21,2,0)
Enter any other wound occurrences that you feel to be significant and
"^DD",130,130,489,21,3,0)
that are not covered by the predefined wound occurrence categories.
"^DD",130,130,489,21,4,0)
Enter the ICD-CM code for this entry. (Example: Seromas, ICD-CM
"^DD",130,130,489,21,5,0)
code: 998.13)
"^DD",130,130,489,"DT")
3120217
"^DD",130,130,1006,0)
ICD ON NURSE REPORT^S^1:YES;0:NO;^TIU;7^Q
"^DD",130,130,1006,3)
Enter YES if the ICD ON NURSE INTRAOP site parameter is set to YES, INCLUDE ICD at the time the nurse intraoperative report is signed.
"^DD",130,130,1006,21,0)
^^5^5^3111026^
"^DD",130,130,1006,21,1,0)
This field reflects the content of the ICD ON NURSE INTRAOP site
"^DD",130,130,1006,21,2,0)
parameter in SURGERY SITE PARAMETERS file (#133).  This field will be set
"^DD",130,130,1006,21,3,0)
at the time the Nurse Intraoperative Report is signed and will be checked
"^DD",130,130,1006,21,4,0)
any time an automatic addendum is made to the report to determine whether
"^DD",130,130,1006,21,5,0)
the ICD codes should appear on the report.
"^DD",130,130,1006,"DT")
3111026
"^DD",130,130.13,4,0)
ICD DIAGNOSIS CODE^*P80'X^ICD9(^0;3^D GETAPI^SROICDGT("SURG","DIAG",$S($G(DA(1)):DA(1),$G(SRTN):SRTN,1:""))
"^DD",130,130.13,4,.1)
ICD Diagnosis Code
"^DD",130,130.13,4,3)
Enter the ICD Diagnosis code corresponding to this intraoperative occurrence.
"^DD",130,130.13,4,21,0)
^.001^3^3^3120215^^
"^DD",130,130.13,4,21,1,0)
If the occurrence entered does not fit in any of the predefined
"^DD",130,130.13,4,21,2,0)
categories, it must have an ICD Diagnosis code entered.
"^DD",130,130.13,4,21,3,0)
 
"^DD",130,130.13,4,"DT")
3130417
"^DD",130,130.17,3,0)
ICD DIAGNOSIS CODE^*P80'OX^ICD9(^0;3^D GETAPI^SROICDGT("SURG","DIAG",DA(1))
"^DD",130,130.17,3,.1)
ICD Diagnosis Code
"^DD",130,130.17,3,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130.17,3,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130.17,3,3)
Enter the ICD Diagnosis code which corresponds with this diagnosis.
"^DD",130,130.17,3,21,0)
^^4^4^2920504^
"^DD",130,130.17,3,21,1,0)
This is the ICD Diagnosis Code which corresponds with this diagnosis.
"^DD",130,130.17,3,21,2,0)
Entering this field is optional, but may be valuable in documentation
"^DD",130,130.17,3,21,3,0)
of this case.
"^DD",130,130.17,3,21,4,0)
 
"^DD",130,130.17,3,"DT")
3120217
"^DD",130,130.18,3,0)
PLANNED ICD DIAGNOSIS CODE^*P80'OX^ICD9(^0;3^D GETAPI^SROICDGT("SURG","DIAG",$S($G(DA(1)):DA(1),$G(SRTN):SRTN,1:""))
"^DD",130,130.18,3,.1)
Planned Other ICD Diagnosis Code
"^DD",130,130.18,3,1,0)
^.1^^-1
"^DD",130,130.18,3,1,2,0)
130.18^PADX^MUMPS
"^DD",130,130.18,3,1,2,1)
Q
"^DD",130,130.18,3,1,2,2)
D DELASOC^SROADX2
"^DD",130,130.18,3,1,2,"%D",0)
^^2^2^3031014^
"^DD",130,130.18,3,1,2,"%D",1,0)
This MUMPS cross reference removes associations to procedures upon edits 
"^DD",130,130.18,3,1,2,"%D",2,0)
or deletes of the diagnosis.
"^DD",130,130.18,3,1,2,"DT")
3030923
"^DD",130,130.18,3,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130.18,3,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130.18,3,3)
Enter the planned ICD Diagnosis Code that corresponds to this diagnosis.
"^DD",130,130.18,3,21,0)
^^2^2^3111026^
"^DD",130,130.18,3,21,1,0)
This is the planned ICD-CM code corresponding with this postoperative
"^DD",130,130.18,3,21,2,0)
diagnosis.
"^DD",130,130.18,3,"DT")
3120702
"^DD",130,130.22,6,0)
ICD DIAGNOSIS CODE^*P80OX^ICD9(^0;3^D GETAPI^SROICDGT("SURG","DIAG",$S($G(DA(1)):DA(1),$G(SRTN):SRTN,1:""))
"^DD",130,130.22,6,.1)
ICD Diagnosis Code
"^DD",130,130.22,6,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130.22,6,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",130,130.22,6,3)
Enter the ICD Diagnosis code corresponding to this postoperative occurrence.
"^DD",130,130.22,6,21,0)
^^3^3^2921106^^
"^DD",130,130.22,6,21,1,0)
If the occurrence entered does not fit in any of the predefined
"^DD",130,130.22,6,21,2,0)
categories, an ICD Diagnosis Code must be entered.
"^DD",130,130.22,6,21,3,0)
 
"^DD",130,130.22,6,"DT")
3120714
"^DD",130.4,130.4,0)
FIELD^^.05^6
"^DD",130.4,130.4,0,"DDA")
N
"^DD",130.4,130.4,0,"DT")
3120216
"^DD",130.4,130.4,0,"ID",.02)
S %I=Y,Y=$S('$D(^(0)):"",$D(^ICDS(+$P(^(0),U,2),0))#2:$P(^(0),U,1),1:""),C=$P(^DD(80.4,.01,0),U,2) D Y^DIQ:Y]"" W "   ",Y,@("$E("_DIC_"%I,0),0)") S Y=%I K %I
"^DD",130.4,130.4,0,"IX","AC",130.4,.02)

"^DD",130.4,130.4,0,"IX","B",130.4,.01)

"^DD",130.4,130.4,0,"NM","ICD SEARCH API")

"^DD",130.4,130.4,0,"VRPK")
DG
"^DD",130.4,130.4,.001,0)
NUMBER^NJ3,0^^ ^K:+X'=X!(X>999)!(X<1)!(X?.E1"."1N.N) X
"^DD",130.4,130.4,.001,3)
Type a number between 1 and 999, 0 decimal digits.
"^DD",130.4,130.4,.001,21,0)
^^1^1^3120212^
"^DD",130.4,130.4,.001,21,1,0)
This is the internal entry number for this field.
"^DD",130.4,130.4,.001,"DT")
3120212
"^DD",130.4,130.4,.01,0)
APPLICATION NAME^RF^^0;1^K:$L(X)>30!($L(X)<3)!'(X'?1P.E) X
"^DD",130.4,130.4,.01,1,0)
^.1
"^DD",130.4,130.4,.01,1,1,0)
130.4^B
"^DD",130.4,130.4,.01,1,1,1)
S ^DIC(130.4,"B",$E(X,1,30),DA)=""
"^DD",130.4,130.4,.01,1,1,2)
K ^DIC(130.4,"B",$E(X,1,30),DA)
"^DD",130.4,130.4,.01,1,1,"%D",0)
^^1^1^3120217^
"^DD",130.4,130.4,.01,1,1,"%D",1,0)
This is the regular 'B' cross reference for this file.
"^DD",130.4,130.4,.01,3)
Enter the name of the application that this API will be used by.  Answer must be 3-30 characters in length.
"^DD",130.4,130.4,.01,21,0)
^.001^2^2^3120217^^^
"^DD",130.4,130.4,.01,21,1,0)
This is the name of the application that this API will be used by.
"^DD",130.4,130.4,.01,21,2,0)
A package may have more than one application name if it is required.
"^DD",130.4,130.4,.01,23,0)
^.001^10^10^3120217^^^^
"^DD",130.4,130.4,.01,23,1,0)
This field will be used by applications to enter a name.
"^DD",130.4,130.4,.01,23,2,0)
Some applications may need more than one name, for example in ADT an
"^DD",130.4,130.4,.01,23,3,0)
entry might be created for PTF and another for RUG if they
"^DD",130.4,130.4,.01,23,4,0)
needed different API calls.
"^DD",130.4,130.4,.01,23,5,0)
 
"^DD",130.4,130.4,.01,23,6,0)
The value in this field will be used in the API to retrieve the correct
"^DD",130.4,130.4,.01,23,7,0)
entry.  For example, in Surgery, this field might contain SURG.  The input
"^DD",130.4,130.4,.01,23,8,0)
transform for a top level field might read 
"^DD",130.4,130.4,.01,23,9,0)
D GETAPI^SROICDGT("SURG,"DIAG",DA)
"^DD",130.4,130.4,.01,23,10,0)
 
"^DD",130.4,130.4,.01,"DT")
3120227
"^DD",130.4,130.4,.02,0)
CODING SYSTEM^P80.4'^ICDS(^0;2^Q
"^DD",130.4,130.4,.02,.1)
ICD CODING SYSTEM
"^DD",130.4,130.4,.02,1,0)
^.1
"^DD",130.4,130.4,.02,1,1,0)
^^TRIGGER^130.4^.04
"^DD",130.4,130.4,.02,1,1,1)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DIC(130.4,D0,0)):^(0),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y X ^DD(130.4,.02,1,1,1.1) S DIH=$G(^DIC(130.4,DIV(0),0)),DIV=X S $P(^(0),U,4)=DIV,DIH=130.4,DIG=.04 D ^DICR
"^DD",130.4,130.4,.02,1,1,1.1)
S X=DIV N SINFO S SINFO=$$SINFO^ICDEX($P(^DIC(130.4,DA,0),U,2)) S X=$S($P(SINFO,U,4)=80:"DIAG",$P(SINFO,U,4)=80.1:"PROC",1:"")
"^DD",130.4,130.4,.02,1,1,2)
K DIV S DIV=X,D0=DA,DIV(0)=D0 S Y(1)=$S($D(^DIC(130.4,D0,0)):^(0),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X="" S DIH=$G(^DIC(130.4,DIV(0),0)),DIV=X S $P(^(0),U,4)=DIV,DIH=130.4,DIG=.04 D ^DICR
"^DD",130.4,130.4,.02,1,1,"%D",0)
^^1^1^3120217^
"^DD",130.4,130.4,.02,1,1,"%D",1,0)
This trigger automatically sets the TYPE field to the correct value.
"^DD",130.4,130.4,.02,1,1,"CREATE VALUE")
N SINFO S SINFO=$$SINFO^ICDEX($P(^DIC(130.4,DA,0),U,2)) S X=$S($P(SINFO,U,4)=80:"DIAG",$P(SINFO,U,4)=80.1:"PROC",1:"")
"^DD",130.4,130.4,.02,1,1,"DELETE VALUE")
@
"^DD",130.4,130.4,.02,1,1,"DT")
3120217
"^DD",130.4,130.4,.02,1,1,"FIELD")
TYPE
"^DD",130.4,130.4,.02,1,2,0)
130.4^AC
"^DD",130.4,130.4,.02,1,2,1)
S ^DIC(130.4,"AC",$E(X,1,30),DA)=""
"^DD",130.4,130.4,.02,1,2,2)
K ^DIC(130.4,"AC",$E(X,1,30),DA)
"^DD",130.4,130.4,.02,1,2,"DT")
3120212
"^DD",130.4,130.4,.02,3)
Select the correct coding system for this entry.
"^DD",130.4,130.4,.02,21,0)
^.001^1^1^3120217^^^^
"^DD",130.4,130.4,.02,21,1,0)
This is the version that this API will be used to retrieve data for.
"^DD",130.4,130.4,.02,"DT")
3120227
"^DD",130.4,130.4,.04,0)
TYPE^S^DIAG:DIAGNOSIS;PROC:PROCEDURE;^0;4^Q
"^DD",130.4,130.4,.04,3)
Select either Diagnosis or Procedure.
"^DD",130.4,130.4,.04,5,1,0)
130.4^.02^1
"^DD",130.4,130.4,.04,21,0)
^^2^2^3120217^
"^DD",130.4,130.4,.04,21,1,0)
This is the Type of ICD search API that will be executed for this entry.
"^DD",130.4,130.4,.04,21,2,0)
Current choices are Diagnosis or Procedure.
"^DD",130.4,130.4,.04,23,0)
^^7^7^3130808^
"^DD",130.4,130.4,.04,23,1,0)
The value stored in the Database (either DIAG or PROC) is used in
"^DD",130.4,130.4,.04,23,2,0)
calls to retrieve the correct API.  For example, in the Surgery file
"^DD",130.4,130.4,.04,23,3,0)
the input transform would be 'D GETAPI^SROICDGT("SURG","DIAG",DA) for
"^DD",130.4,130.4,.04,23,4,0)
a top level field.
"^DD",130.4,130.4,.04,23,5,0)
 
"^DD",130.4,130.4,.04,23,6,0)
This value may also be used for calls to other ICD API's.  For
"^DD",130.4,130.4,.04,23,7,0)
example s x=$$ICDDX^ICDEX(CODE,...
"^DD",130.4,130.4,.04,"DT")
3130808
"^DD",130.4,130.4,.05,0)
OWNER PACKAGE^RP9.4^DIC(9.4,^0;5^Q
"^DD",130.4,130.4,.05,3)
Enter the package that is responsible for this entry.
"^DD",130.4,130.4,.05,21,0)
^^1^1^3120216^
"^DD",130.4,130.4,.05,21,1,0)
This is the package that is responsible for this entry. 
"^DD",130.4,130.4,.05,"DT")
3120216
"^DD",130.4,130.4,1,0)
MUMPS CODE TO EXECUTE^K^^1;E1,245^K:$L(X)>245 X D:$D(X) ^DIM
"^DD",130.4,130.4,1,3)
This is Standard MUMPS code.
"^DD",130.4,130.4,1,9)
@
"^DD",130.4,130.4,1,21,0)
^^2^2^3120212^
"^DD",130.4,130.4,1,21,1,0)
Enter the MUMPS code to execute the correct search user interface for this
"^DD",130.4,130.4,1,21,2,0)
coding system.
"^DD",130.4,130.4,1,"DT")
3120212
"^DD",133,133,39,0)
ICD ON NURSE INTRAOP^S^0:NO, DO NOT INCLUDE ICD;1:YES, INCLUDE ICD;^.1;3^Q
"^DD",133,133,39,.1)
ICD on Nurse Intraop Report
"^DD",133,133,39,3)
Enter YES to require the principal diagnosis code prior to electronic signature and to make it part of the report.
"^DD",133,133,39,21,0)
^^5^5^3111107^
"^DD",133,133,39,21,1,0)
If this field is set to YES, INCLUDE ICD, the principal diagnosis 
"^DD",133,133,39,21,2,0)
code will be required before electronic signature can be applied and
"^DD",133,133,39,21,3,0)
the ICD code will be part of the report.  If the field is null or
"^DD",133,133,39,21,4,0)
set to NO, DO NOT INCLUDE ICD, the principal diagnosis code will 
"^DD",133,133,39,21,5,0)
not be required before electronic signature can be applied.
"^DD",133,133,39,"DT")
3111107
"^DD",136,136,.03,0)
PRIN POSTOP DIAGNOSIS CODE^*P80'X^ICD9(^0;3^D GETAPI^SROICDGT("SURG","DIAG",$S($G(DA):DA,$G(SRTN):SRTN,1:""))
"^DD",136,136,.03,.1)
Principal Postop Diagnosis Code
"^DD",136,136,.03,1,0)
^.1^^0
"^DD",136,136,.03,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",136,136,.03,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",136,136,.03,3)
Enter the ICD Diagnosis code for the principal postoperative diagnosis.
"^DD",136,136,.03,21,0)
^^1^1^3111110^
"^DD",136,136,.03,21,1,0)
This is the principal postoperative ICD diagnosis code.
"^DD",136,136,.03,"DEL",1,0)
I 1 D EN^DDIOL("Deletion of the Principal Postop Diagnosis Code is not allowed! ",,"!!,?2")
"^DD",136,136,.03,"DT")
3120629
"^DD",136,136,2,0)
PRIN ASSOCIATED DIAGNOSES^136.02PA^^2;0
"^DD",136,136,2,"DT")
3041215
"^DD",136,136,4,0)
OTHER POSTOP DIAGNOSIS CODES^136.04PA^^4;0
"^DD",136,136,4,"DT")
3050112
"^DD",136,136.02,0)
PRIN ASSOCIATED DIAGNOSES SUB-FIELD^^.01^1
"^DD",136,136.02,0,"DT")
3120215
"^DD",136,136.02,0,"NM","PRIN ASSOCIATED DIAGNOSES")

"^DD",136,136.02,0,"UP")
136
"^DD",136,136.02,.01,0)
PRIN ASSOCIATED DIAGNOSIS^M*P80'OX^ICD9(^0;1^D GETAPI^SROICDGT("SURG","DIAG",DA(1))
"^DD",136,136.02,.01,.1)
Principal Associated Diagnosis Code
"^DD",136,136.02,.01,1,0)
^.1^^0
"^DD",136,136.02,.01,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",136,136.02,.01,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",136,136.02,.01,3)
Enter a diagnosis code associated with the principal procedure.
"^DD",136,136.02,.01,21,0)
^.001^1^1^3120215^^^
"^DD",136,136.02,.01,21,1,0)
This is a diagnosis associated with the principal procedure. 
"^DD",136,136.02,.01,"DT")
3120217
"^DD",136,136.03,2,0)
OTHER ASSOCIATED DIAGNOSES^136.32PA^^2;0
"^DD",136,136.04,0)
OTHER POSTOP DIAGNOSIS CODES SUB-FIELD^^.09^9
"^DD",136,136.04,0,"DT")
3120215
"^DD",136,136.04,0,"NM","OTHER POSTOP DIAGNOSIS CODES")

"^DD",136,136.04,0,"UP")
136
"^DD",136,136.04,.01,0)
OTHER POSTOP DIAGNOSIS CODE^M*P80'OX^ICD9(^0;1^D GETAPI^SROICDGT("SURG","DIAG",$S($G(DA(1)):DA(1),$G(SRTN):SRTN,1:""))
"^DD",136,136.04,.01,.1)
Other Postop Diagnosis Code
"^DD",136,136.04,.01,1,0)
^.1
"^DD",136,136.04,.01,1,1,0)
^^TRIGGER^136.04^.02
"^DD",136,136.04,.01,1,1,1)
X ^DD(136.04,.01,1,1,1.3) I X S X=DIV S Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P(Y(1),U,2),X=X S DIU=X K Y S X=DIV S X=$P(^SRO(136,DA(1),0),U,4) X ^DD(136.04,.01,1,1,1.4)
"^DD",136,136.04,.01,1,1,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(0)=X S Y(2)=$C(59)_$P($G(^DD(136.04,.02,0)),U,3),Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,2)_":",2),$C(59))=""
"^DD",136,136.04,.01,1,1,1.4)
S DIH=$G(^SRO(136,DIV(0),4,DIV(1),0)),DIV=X S $P(^(0),U,2)=DIV,DIH=136.04,DIG=.02 D ^DICR
"^DD",136,136.04,.01,1,1,2)
Q
"^DD",136,136.04,.01,1,1,"CREATE CONDITION")
SERVICE CONNECTED=""
"^DD",136,136.04,.01,1,1,"CREATE VALUE")
S X=$P(^SRO(136,DA(1),0),U,4)
"^DD",136,136.04,.01,1,1,"DELETE VALUE")
NO EFFECT
"^DD",136,136.04,.01,1,1,"DT")
3050112
"^DD",136,136.04,.01,1,1,"FIELD")
SERVICE CONNECTED
"^DD",136,136.04,.01,1,2,0)
^^TRIGGER^136.04^.03
"^DD",136,136.04,.01,1,2,1)
X ^DD(136.04,.01,1,2,1.3) I X S X=DIV S Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X=DIV S X=$P(^SRO(136,DA(1),0),U,5) X ^DD(136.04,.01,1,2,1.4)
"^DD",136,136.04,.01,1,2,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(0)=X S Y(2)=$C(59)_$P($G(^DD(136.04,.03,0)),U,3),Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,3)_":",2),$C(59))=""
"^DD",136,136.04,.01,1,2,1.4)
S DIH=$G(^SRO(136,DIV(0),4,DIV(1),0)),DIV=X S $P(^(0),U,3)=DIV,DIH=136.04,DIG=.03 D ^DICR
"^DD",136,136.04,.01,1,2,2)
Q
"^DD",136,136.04,.01,1,2,"CREATE CONDITION")
AGENT ORANGE EXPOSURE=""
"^DD",136,136.04,.01,1,2,"CREATE VALUE")
S X=$P(^SRO(136,DA(1),0),U,5)
"^DD",136,136.04,.01,1,2,"DELETE VALUE")
NO EFFECT
"^DD",136,136.04,.01,1,2,"DT")
3050112
"^DD",136,136.04,.01,1,2,"FIELD")
AGENT ORANGE EXPOSURE
"^DD",136,136.04,.01,1,3,0)
^^TRIGGER^136.04^.04
"^DD",136,136.04,.01,1,3,1)
X ^DD(136.04,.01,1,3,1.3) I X S X=DIV S Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P(Y(1),U,4),X=X S DIU=X K Y S X=DIV S X=$P(^SRO(136,DA(1),0),U,6) X ^DD(136.04,.01,1,3,1.4)
"^DD",136,136.04,.01,1,3,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(0)=X S Y(2)=$C(59)_$P($G(^DD(136.04,.04,0)),U,3),Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,4)_":",2),$C(59))=""
"^DD",136,136.04,.01,1,3,1.4)
S DIH=$G(^SRO(136,DIV(0),4,DIV(1),0)),DIV=X S $P(^(0),U,4)=DIV,DIH=136.04,DIG=.04 D ^DICR
"^DD",136,136.04,.01,1,3,2)
Q
"^DD",136,136.04,.01,1,3,"CREATE CONDITION")
IONIZING RADIATION EXPOSURE=""
"^DD",136,136.04,.01,1,3,"CREATE VALUE")
S X=$P(^SRO(136,DA(1),0),U,6)
"^DD",136,136.04,.01,1,3,"DELETE VALUE")
NO EFFECT
"^DD",136,136.04,.01,1,3,"DT")
3050112
"^DD",136,136.04,.01,1,3,"FIELD")
IONIZING RADIATION EXPOSURE
"^DD",136,136.04,.01,1,4,0)
^^TRIGGER^136.04^.05
"^DD",136,136.04,.01,1,4,1)
X ^DD(136.04,.01,1,4,1.3) I X S X=DIV S Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P(Y(1),U,5),X=X S DIU=X K Y S X=DIV S X=$P(^SRO(136,DA(1),0),U,8) X ^DD(136.04,.01,1,4,1.4)
"^DD",136,136.04,.01,1,4,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(0)=X S Y(2)=$C(59)_$P($G(^DD(136.04,.05,0)),U,3),Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,5)_":",2),$C(59))=""
"^DD",136,136.04,.01,1,4,1.4)
S DIH=$G(^SRO(136,DIV(0),4,DIV(1),0)),DIV=X S $P(^(0),U,5)=DIV,DIH=136.04,DIG=.05 D ^DICR
"^DD",136,136.04,.01,1,4,2)
Q
"^DD",136,136.04,.01,1,4,"CREATE CONDITION")
MILITARY SEXUAL TRAUMA=""
"^DD",136,136.04,.01,1,4,"CREATE VALUE")
S X=$P(^SRO(136,DA(1),0),U,8)
"^DD",136,136.04,.01,1,4,"DELETE VALUE")
NO EFFECT
"^DD",136,136.04,.01,1,4,"DT")
3050112
"^DD",136,136.04,.01,1,4,"FIELD")
MILITARY SEXUAL TRAUMA
"^DD",136,136.04,.01,1,5,0)
^^TRIGGER^136.04^.06
"^DD",136,136.04,.01,1,5,1)
X ^DD(136.04,.01,1,5,1.3) I X S X=DIV S Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P(Y(1),U,6),X=X S DIU=X K Y S X=DIV S X=$P(^SRO(136,DA(1),0),U,9) X ^DD(136.04,.01,1,5,1.4)
"^DD",136,136.04,.01,1,5,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(0)=X S Y(2)=$C(59)_$P($G(^DD(136.04,.06,0)),U,3),Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,6)_":",2),$C(59))=""
"^DD",136,136.04,.01,1,5,1.4)
S DIH=$G(^SRO(136,DIV(0),4,DIV(1),0)),DIV=X S $P(^(0),U,6)=DIV,DIH=136.04,DIG=.06 D ^DICR
"^DD",136,136.04,.01,1,5,2)
Q
"^DD",136,136.04,.01,1,5,"CREATE CONDITION")
HEAD AND/OR NECK CANCER=""
"^DD",136,136.04,.01,1,5,"CREATE VALUE")
S X=$P(^SRO(136,DA(1),0),U,9)
"^DD",136,136.04,.01,1,5,"DELETE VALUE")
NO EFFECT
"^DD",136,136.04,.01,1,5,"DT")
3050112
"^DD",136,136.04,.01,1,5,"FIELD")
HEAD AND/OR NECK CANCER
"^DD",136,136.04,.01,1,6,0)
^^TRIGGER^136.04^.07
"^DD",136,136.04,.01,1,6,1)
X ^DD(136.04,.01,1,6,1.3) I X S X=DIV S Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P(Y(1),U,7),X=X S DIU=X K Y S X=DIV S X=$P(^SRO(136,DA(1),0),U,7) X ^DD(136.04,.01,1,6,1.4)
"^DD",136,136.04,.01,1,6,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(0)=X S Y(2)=$C(59)_$P($G(^DD(136.04,.07,0)),U,3),Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,7)_":",2),$C(59))=""
"^DD",136,136.04,.01,1,6,1.4)
S DIH=$G(^SRO(136,DIV(0),4,DIV(1),0)),DIV=X S $P(^(0),U,7)=DIV,DIH=136.04,DIG=.07 D ^DICR
"^DD",136,136.04,.01,1,6,2)
Q
"^DD",136,136.04,.01,1,6,"CREATE CONDITION")
SOUTHWEST ASIA CONDITIONS=""
"^DD",136,136.04,.01,1,6,"CREATE VALUE")
S X=$P(^SRO(136,DA(1),0),U,7)
"^DD",136,136.04,.01,1,6,"DELETE VALUE")
NO EFFECT
"^DD",136,136.04,.01,1,6,"DT")
3060728
"^DD",136,136.04,.01,1,6,"FIELD")
SOUTH
"^DD",136,136.04,.01,1,7,0)
^^TRIGGER^136.04^.08
"^DD",136,136.04,.01,1,7,1)
X ^DD(136.04,.01,1,7,1.3) I X S X=DIV S Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P(Y(1),U,8),X=X S DIU=X K Y S X=DIV S X=$P(^SRO(136,DA(1),0),U,10) X ^DD(136.04,.01,1,7,1.4)
"^DD",136,136.04,.01,1,7,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(0)=X S Y(2)=$C(59)_$P($G(^DD(136.04,.08,0)),U,3),Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,8)_":",2),$C(59))=""
"^DD",136,136.04,.01,1,7,1.4)
S DIH=$G(^SRO(136,DIV(0),4,DIV(1),0)),DIV=X S $P(^(0),U,8)=DIV,DIH=136.04,DIG=.08 D ^DICR
"^DD",136,136.04,.01,1,7,2)
Q
"^DD",136,136.04,.01,1,7,"CREATE CONDITION")
COMBAT VET=""
"^DD",136,136.04,.01,1,7,"CREATE VALUE")
S X=$P(^SRO(136,DA(1),0),U,10)
"^DD",136,136.04,.01,1,7,"DELETE VALUE")
NO EFFECT
"^DD",136,136.04,.01,1,7,"DT")
3050112
"^DD",136,136.04,.01,1,7,"FIELD")
COMBAT VET
"^DD",136,136.04,.01,1,8,0)
^^TRIGGER^136.04^.09
"^DD",136,136.04,.01,1,8,1)
X ^DD(136.04,.01,1,8,1.3) I X S X=DIV S Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P(Y(1),U,9),X=X S DIU=X K Y S X=DIV S X=$P(^SRO(136,DA(1),0),U,11) X ^DD(136.04,.01,1,8,1.4)
"^DD",136,136.04,.01,1,8,1.3)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(0)=X S Y(2)=$C(59)_$P($G(^DD(136.04,.09,0)),U,3),Y(1)=$S($D(^SRO(136,D0,4,D1,0)):^(0),1:"") S X=$P($P(Y(2),$C(59)_$P(Y(1),U,9)_":",2),$C(59))=""
"^DD",136,136.04,.01,1,8,1.4)
S DIH=$G(^SRO(136,DIV(0),4,DIV(1),0)),DIV=X S $P(^(0),U,9)=DIV,DIH=136.04,DIG=.09 D ^DICR
"^DD",136,136.04,.01,1,8,2)
Q
"^DD",136,136.04,.01,1,8,"CREATE CONDITION")
PROJ 112/SHAD=""
"^DD",136,136.04,.01,1,8,"CREATE VALUE")
S X=$P(^SRO(136,DA(1),0),U,11)
"^DD",136,136.04,.01,1,8,"DELETE VALUE")
NO EFFECT
"^DD",136,136.04,.01,1,8,"DT")
3051117
"^DD",136,136.04,.01,1,8,"FIELD")
PROJ
"^DD",136,136.04,.01,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",136,136.04,.01,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",136,136.04,.01,3)
Enter the ICD Diagnosis Code that corresponds to this postoperative diagnosis.
"^DD",136,136.04,.01,21,0)
^^2^2^3111123^
"^DD",136,136.04,.01,21,1,0)
This is the ICD-CM code corresponding with this postoperative
"^DD",136,136.04,.01,21,2,0)
diagnosis.
"^DD",136,136.04,.01,"DT")
3120629
"^DD",136,136.04,.02,0)
SERVICE CONNECTED^S^1:YES;0:NO;^0;2^Q
"^DD",136,136.04,.02,.1)
Treatment related to Service Connected condition (Y/N)
"^DD",136,136.04,.02,3)
If this diagnosis is a service connected problem, enter YES.
"^DD",136,136.04,.02,5,1,0)
136.04^.01^1
"^DD",136,136.04,.02,21,0)
^.001^3^3^3050112^^
"^DD",136,136.04,.02,21,1,0)
This field indicates if this diagnosis is a service connected problem.
"^DD",136,136.04,.02,21,2,0)
This information may be passed to the VISIT file (#9000010) for use by
"^DD",136,136.04,.02,21,3,0)
PCE.
"^DD",136,136.04,.02,"DT")
3050112
"^DD",136,136.04,.03,0)
AGENT ORANGE EXPOSURE^S^1:YES;0:NO;^0;3^Q
"^DD",136,136.04,.03,.1)
Treatment related to Agent Orange Exposure (Y/N)
"^DD",136,136.04,.03,3)
If this diagnosis is an agent orange exposure problem, enter YES.
"^DD",136,136.04,.03,5,1,0)
136.04^.01^2
"^DD",136,136.04,.03,21,0)
^.001^3^3^3050112^^
"^DD",136,136.04,.03,21,1,0)
This field indicates if this diagnosis is an agent orange exposure 
"^DD",136,136.04,.03,21,2,0)
problem. This information may be passed to the VISIT file (#9000010)
"^DD",136,136.04,.03,21,3,0)
for use by PCE.
"^DD",136,136.04,.03,"DT")
3050112
"^DD",136,136.04,.04,0)
IONIZING RADIATION EXPOSURE^S^1:YES;0:NO;^0;4^Q
"^DD",136,136.04,.04,.1)
Treatment related to Ionizing Radiation Exposure (Y/N)
"^DD",136,136.04,.04,3)
If this diagnosis is an ionizing radiation exposure problem, enter YES.
"^DD",136,136.04,.04,5,1,0)
136.04^.01^3
"^DD",136,136.04,.04,21,0)
^.001^3^3^3050112^^
"^DD",136,136.04,.04,21,1,0)
This field indicates if this diagnosis is an ionizing radiation 
"^DD",136,136.04,.04,21,2,0)
exposure problem. This information may be passed to the VISIT file
"^DD",136,136.04,.04,21,3,0)
(#9000010) for use by PCE.
"^DD",136,136.04,.04,"DT")
3050112
"^DD",136,136.04,.05,0)
MILITARY SEXUAL TRAUMA^S^1:YES;0:NO;^0;5^Q
"^DD",136,136.04,.05,.1)
Treatment related to Military Sexual Trauma (Y/N)
"^DD",136,136.04,.05,3)
If this diagnosis is related to military sexual trauma, enter YES.
"^DD",136,136.04,.05,5,1,0)
136.04^.01^4
"^DD",136,136.04,.05,21,0)
^.001^3^3^3050112^^
"^DD",136,136.04,.05,21,1,0)
This field indicates if this diagnosis is a military sexual trauma
"^DD",136,136.04,.05,21,2,0)
problem. This information may be passed to the VISIT file (#9000010)
"^DD",136,136.04,.05,21,3,0)
for use by PCE.
"^DD",136,136.04,.05,"DT")
3050112
"^DD",136,136.04,.06,0)
HEAD AND/OR NECK CANCER^S^1:YES;0:NO;^0;6^Q
"^DD",136,136.04,.06,.1)
Treatment related to Head and/or Neck Cancer (Y/N)
"^DD",136,136.04,.06,3)
If this diagnosis is related to head and/or neck cancer, enter YES.
"^DD",136,136.04,.06,5,1,0)
136.04^.01^5
"^DD",136,136.04,.06,21,0)
^.001^3^3^3050112^^
"^DD",136,136.04,.06,21,1,0)
This field indicates if this diagnosis is a head and/or neck cancer
"^DD",136,136.04,.06,21,2,0)
problem. This information may be passed to the VISIT file (#9000010)
"^DD",136,136.04,.06,21,3,0)
for use by PCE.
"^DD",136,136.04,.06,"DT")
3050112
"^DD",136,136.04,.07,0)
SOUTHWEST ASIA CONDITIONS^S^1:YES;0:NO;^0;7^Q
"^DD",136,136.04,.07,.1)
Treatment related to service in SW Asia (Y/N)
"^DD",136,136.04,.07,3)
If this diagnosis is a problem related to service in SW Asia, enter YES.
"^DD",136,136.04,.07,5,1,0)
136.04^.01^6
"^DD",136,136.04,.07,21,0)
^^3^3^3060726^
"^DD",136,136.04,.07,21,1,0)
This field indicates if this diagnosis is related to service in SW Asia. 
"^DD",136,136.04,.07,21,2,0)
This information may be passed to the VISIT file (#9000010) for use by 
"^DD",136,136.04,.07,21,3,0)
PCE.
"^DD",136,136.04,.07,"DT")
3060726
"^DD",136,136.04,.08,0)
COMBAT VET^S^1:YES;0:NO;^0;8^Q
"^DD",136,136.04,.08,.1)
Treatment related to Combat (Y/N)
"^DD",136,136.04,.08,3)
If this diagnosis is related to combat, enter YES.
"^DD",136,136.04,.08,5,1,0)
136.04^.01^7
"^DD",136,136.04,.08,21,0)
^.001^3^3^3050112^^
"^DD",136,136.04,.08,21,1,0)
This field indicates if this diagnosis is a combat related problem.
"^DD",136,136.04,.08,21,2,0)
This information may be passed to the VISIT file (#9000010) for use by
"^DD",136,136.04,.08,21,3,0)
PCE.
"^DD",136,136.04,.08,"DT")
3050112
"^DD",136,136.04,.09,0)
PROJ 112/SHAD^S^1:YES;0:NO;^0;9^Q
"^DD",136,136.04,.09,.1)
Treatment related to PROJ 112/SHAD (Y/N)
"^DD",136,136.04,.09,3)
If this diagnosis is related to PROJ 112/SHAD, enter YES.
"^DD",136,136.04,.09,5,1,0)
136.04^.01^8
"^DD",136,136.04,.09,21,0)
^.001^3^3^3051117^^
"^DD",136,136.04,.09,21,1,0)
This field indicates if this diagnosis is a PROJ 112/SHAD related 
"^DD",136,136.04,.09,21,2,0)
problem.  This information may be passed to the VISIT file (#9000010) for 
"^DD",136,136.04,.09,21,3,0)
use by PCE.
"^DD",136,136.04,.09,"DT")
3051117
"^DD",136,136.32,0)
OTHER ASSOCIATED DIAGNOSES SUB-FIELD^^.01^1
"^DD",136,136.32,0,"DT")
3120215
"^DD",136,136.32,0,"NM","OTHER ASSOCIATED DIAGNOSES")

"^DD",136,136.32,0,"UP")
136.03
"^DD",136,136.32,.01,0)
OTHER ASSOCIATED DIAGNOSIS^M*P80'OX^ICD9(^0;1^D GETAPI^SROICDGT("SURG","DIAG",DA(2))
"^DD",136,136.32,.01,.1)
Other Associated Diagnosis Code
"^DD",136,136.32,.01,1,0)
^.1^^0
"^DD",136,136.32,.01,2)
S Y(0)=Y I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",136,136.32,.01,2.1)
I $G(Y) S Y=$$OUT^SROICD(Y)
"^DD",136,136.32,.01,3)
Enter a diagnosis code associated with this procedure.
"^DD",136,136.32,.01,21,0)
^^1^1^3041215^
"^DD",136,136.32,.01,21,1,0)
This is a diagnosis associated with the other procedure.
"^DD",136,136.32,.01,"DT")
3120217
"^DIC",130.4,130.4,0)
ICD SEARCH API^130.4I
"^DIC",130.4,130.4,0,"GL")
^DIC(130.4,
"^DIC",130.4,130.4,"%D",0)
13^1.001^13^13^3120227^
"^DIC",130.4,130.4,"%D",1,0)
This file is used as a repository of ICD search (lookup) functionality
"^DIC",130.4,130.4,"%D",2,0)
to support an application's need for different user interface calls
"^DIC",130.4,130.4,"%D",3,0)
across multiple versions of ICD Diagnosis and Procedure coding.
"^DIC",130.4,130.4,"%D",4,0)
 
"^DIC",130.4,130.4,"%D",5,0)
Each entry is associated with a specific version of ICD Diagnosis or
"^DIC",130.4,130.4,"%D",6,0)
Procedure coding, an application, and executable M code.  The executable
"^DIC",130.4,130.4,"%D",7,0)
M code can be invoked from within the input transform of a field
"^DIC",130.4,130.4,"%D",8,0)
that points to the ICD DIAGNOSIS file (80) or the ICD OPERATION/
"^DIC",130.4,130.4,"%D",9,0)
PROCEDURE file (80.1) to achieve the correct search functionality
"^DIC",130.4,130.4,"%D",10,0)
specific to the ICD version.
"^DIC",130.4,130.4,"%D",11,0)
 
"^DIC",130.4,130.4,"%D",12,0)
This file was developed during the ICD-10 Remediation project with
"^DIC",130.4,130.4,"%D",13,0)
the intent that it will support ICD-11 and beyond.
"^DIC",130.4,"B","ICD SEARCH API",130.4)

"BLD",8642,6)
^172
**END**
**END**

