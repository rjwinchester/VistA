Released PSO*7*465 SEQ #395
Extracted from mail message
**KIDS**:PSO*7.0*465^

**INSTALL NAME**
PSO*7.0*465
"BLD",10295,0)
PSO*7.0*465^OUTPATIENT PHARMACY^0^3160705^y
"BLD",10295,1,0)
^^5^5^3160630^
"BLD",10295,1,1,0)
This patch will fix the following issues:
"BLD",10295,1,2,0)
1. The CMOP transmission stopped due to an Undefined
"BLD",10295,1,3,0)
   error
"BLD",10295,1,4,0)
2. Update the Technical Manual/Security Guide for
"BLD",10295,1,5,0)
   the HL7 record sent to the dispensing machines
"BLD",10295,4,0)
^9.64PA^^
"BLD",10295,6.3)
2
"BLD",10295,"ABPKG")
n
"BLD",10295,"KRN",0)
^9.67PA^779.2^20
"BLD",10295,"KRN",.4,0)
.4
"BLD",10295,"KRN",.401,0)
.401
"BLD",10295,"KRN",.402,0)
.402
"BLD",10295,"KRN",.403,0)
.403
"BLD",10295,"KRN",.5,0)
.5
"BLD",10295,"KRN",.84,0)
.84
"BLD",10295,"KRN",3.6,0)
3.6
"BLD",10295,"KRN",3.8,0)
3.8
"BLD",10295,"KRN",9.2,0)
9.2
"BLD",10295,"KRN",9.8,0)
9.8
"BLD",10295,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10295,"KRN",9.8,"NM",1,0)
PSOHLSN2^^0^B9515359
"BLD",10295,"KRN",9.8,"NM","B","PSOHLSN2",1)

"BLD",10295,"KRN",19,0)
19
"BLD",10295,"KRN",19.1,0)
19.1
"BLD",10295,"KRN",101,0)
101
"BLD",10295,"KRN",409.61,0)
409.61
"BLD",10295,"KRN",771,0)
771
"BLD",10295,"KRN",779.2,0)
779.2
"BLD",10295,"KRN",870,0)
870
"BLD",10295,"KRN",8989.51,0)
8989.51
"BLD",10295,"KRN",8989.52,0)
8989.52
"BLD",10295,"KRN",8994,0)
8994
"BLD",10295,"KRN","B",.4,.4)

"BLD",10295,"KRN","B",.401,.401)

"BLD",10295,"KRN","B",.402,.402)

"BLD",10295,"KRN","B",.403,.403)

"BLD",10295,"KRN","B",.5,.5)

"BLD",10295,"KRN","B",.84,.84)

"BLD",10295,"KRN","B",3.6,3.6)

"BLD",10295,"KRN","B",3.8,3.8)

"BLD",10295,"KRN","B",9.2,9.2)

"BLD",10295,"KRN","B",9.8,9.8)

"BLD",10295,"KRN","B",19,19)

"BLD",10295,"KRN","B",19.1,19.1)

"BLD",10295,"KRN","B",101,101)

"BLD",10295,"KRN","B",409.61,409.61)

"BLD",10295,"KRN","B",771,771)

"BLD",10295,"KRN","B",779.2,779.2)

"BLD",10295,"KRN","B",870,870)

"BLD",10295,"KRN","B",8989.51,8989.51)

"BLD",10295,"KRN","B",8989.52,8989.52)

"BLD",10295,"KRN","B",8994,8994)

"BLD",10295,"QDEF")
^^^^NO^^^^^^NO
"BLD",10295,"QUES",0)
^9.62^^
"BLD",10295,"REQB",0)
^9.611^1^1
"BLD",10295,"REQB",1,0)
PSO*7.0*404^2
"BLD",10295,"REQB","B","PSO*7.0*404",1)

"MBREQ")
0
"PKG",206,-1)
1^1
"PKG",206,0)
OUTPATIENT PHARMACY^PSO^OUTPATIENT LABELS, PROFILE, INVENTORY, PRESCRIPTIONS
"PKG",206,20,0)
^9.402P^^
"PKG",206,22,0)
^9.49I^1^1
"PKG",206,22,1,0)
7.0^3021122^3021202^66481
"PKG",206,22,1,"PAH",1,0)
465^3160705
"PKG",206,22,1,"PAH",1,1,0)
^^5^5^3160705
"PKG",206,22,1,"PAH",1,1,1,0)
This patch will fix the following issues:
"PKG",206,22,1,"PAH",1,1,2,0)
1. The CMOP transmission stopped due to an Undefined
"PKG",206,22,1,"PAH",1,1,3,0)
   error
"PKG",206,22,1,"PAH",1,1,4,0)
2. Update the Technical Manual/Security Guide for
"PKG",206,22,1,"PAH",1,1,5,0)
   the HL7 record sent to the dispensing machines
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSOHLSN2")
0^1^B9515359^B9232532
"RTN","PSOHLSN2",1,0)
PSOHLSN2 ;BIR/LE - Utilities for PSOHLSN1 ;02/27/04
"RTN","PSOHLSN2",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**143,226,239,225,404,465**;DEC 1997;Build 2
"RTN","PSOHLSN2",3,0)
 ;
"RTN","PSOHLSN2",4,0)
 ;Ext ref to $$ICDDX^ICDCODE sup DBIA 3990
"RTN","PSOHLSN2",5,0)
 ;Ext ref to $$ICDD^ICDCODE sup DBIA 3990
"RTN","PSOHLSN2",6,0)
 ;
"RTN","PSOHLSN2",7,0)
DG1 ;this section builds both DG1 segments 
"RTN","PSOHLSN2",8,0)
 ;IF IT IS DECIDED IN THE FUTURE TO CAPTURE THEN SEND ICD CODES, THE CODE BELOW WILL NEED TO BE RE-EVALUATED FOR ANY NECESSARY CHANGES.
"RTN","PSOHLSN2",9,0)
 Q  ;*465
"RTN","PSOHLSN2",10,0)
 Q:'$D(^PSRX(PSRXIEN,"ICD",1,0))
"RTN","PSOHLSN2",11,0)
 N LP,DG,DXDESC,I
"RTN","PSOHLSN2",12,0)
 S LIMIT=4,FIELD(0)="DG1",FIELD(4)=""
"RTN","PSOHLSN2",13,0)
 ;I '$D(^PSRX(PSRXIEN,"ICD",1,0)) S FIELD(1)=1,FIELD(2)="",FIELD(3)="^^^^^" D SEG^PSOHLSN1 Q
"RTN","PSOHLSN2",14,0)
 I $P(^PSRX(PSRXIEN,"ICD",1,0),"^",1)="" Q  ;S FIELD(1)=1,FIELD(2)="",FIELD(3)="^^^^^" D SEG^PSOHLSN1 Q
"RTN","PSOHLSN2",15,0)
 F I=1:1:8 D
"RTN","PSOHLSN2",16,0)
 . Q:'$D(^PSRX(PSRXIEN,"ICD",I,0))
"RTN","PSOHLSN2",17,0)
 . S PSOICD="",PSOICD=^PSRX(PSRXIEN,"ICD",I,0) Q:$P(PSOICD,U,1)=""
"RTN","PSOHLSN2",18,0)
 . S (DG,DXDESC)=""
"RTN","PSOHLSN2",19,0)
 . I $P(PSOICD,U,1)'="" D
"RTN","PSOHLSN2",20,0)
 .. N PSOICDD,PSOARRY,PSOICDX,PSOFILDT  ;*404
"RTN","PSOHLSN2",21,0)
 .. S PSOFILDT=$$GET1^DIQ(52,PSRXIEN_",","22","I")  ;*404
"RTN","PSOHLSN2",22,0)
 .. S PSOICDX=$$ICDDX^ICDCODE($P(PSOICD,U,1),PSOFILDT)  ;*404
"RTN","PSOHLSN2",23,0)
 .. S PSOICDD=$$ICDD^ICDCODE($P(PSOICDX,U,2),"PSOARRY",PSOFILDT)  ;*404
"RTN","PSOHLSN2",24,0)
 .. S DXDESC=PSOARRY(1),FIELD(1)=I,FIELD(2)=""  ;*404
"RTN","PSOHLSN2",25,0)
 .. S FIELD(3)=$P(PSOICD,U,1)_U_DXDESC_U_"80"_U_$P(PSOICDX,U,2)_U_DXDESC_U_"ICD9"  ;*404
"RTN","PSOHLSN2",26,0)
 .. D SEG^PSOHLSN1
"RTN","PSOHLSN2",27,0)
 K PSOICD("K")
"RTN","PSOHLSN2",28,0)
 Q
"RTN","PSOHLSN2",29,0)
ZCL N STOP,IBQ,ICD,I,JJJ,EI
"RTN","PSOHLSN2",30,0)
 S LIMIT=3,FIELD(0)="ZCL"
"RTN","PSOHLSN2",31,0)
 I '$D(^PSRX(PSRXIEN,"ICD"))&($D(^PSRX(PSRXIEN,"IBQ"))) D    ;For edits; currently CPRS doesn't update SC/EI for edits, but just in case they start
"RTN","PSOHLSN2",32,0)
 . S FIELD(1)=1,FIELD(2)=3
"RTN","PSOHLSN2",33,0)
 . S EI="",EI=^PSRX(PSRXIEN,"IBQ")
"RTN","PSOHLSN2",34,0)
 . S JJJ=0 F I=3,4,1,5,2,6,7,8 S JJJ=JJJ+1,FIELD(3)=$P(EI,U,I) S FIELD(1)=1,FIELD(2)=JJJ D SEG^PSOHLSN1
"RTN","PSOHLSN2",35,0)
 E  F I=1:1:8 D
"RTN","PSOHLSN2",36,0)
 . Q:'$D(^PSRX(PSRXIEN,"ICD",I,0))
"RTN","PSOHLSN2",37,0)
 . S PSOICD=^PSRX(PSRXIEN,"ICD",I,0),ICD=$P(PSOICD,"^",1)
"RTN","PSOHLSN2",38,0)
 . Q:ICD=""&(I>1)
"RTN","PSOHLSN2",39,0)
 . F JJJ=2:1:9 S EI=$P(PSOICD,U,JJJ),FIELD(2)=JJJ-1 D
"RTN","PSOHLSN2",40,0)
 .. S FIELD(1)=$S(ICD="":1,1:I)
"RTN","PSOHLSN2",41,0)
 .. ;S FIELD(3)=$S(EI=1:EI,1:0)
"RTN","PSOHLSN2",42,0)
 .. S FIELD(3)=$S(EI=1:EI,EI=0:EI,1:"")
"RTN","PSOHLSN2",43,0)
 .. D SEG^PSOHLSN1
"RTN","PSOHLSN2",44,0)
 K PSOICD
"RTN","PSOHLSN2",45,0)
 Q
"RTN","PSOHLSN2",46,0)
 ;CPRS doesn't look at the ZCL segment when their CIDC switch is off.  Always send both ZCL and ZSC for consistency
"RTN","PSOHLSN2",47,0)
ZSC S PSOCPS=$$DT^PSOMLLDT S LIMIT=$S($G(PSOCPS):8,1:1) X NULLFLDS
"RTN","PSOHLSN2",48,0)
 S FIELD(0)="ZSC" N JJJ,PSOICD
"RTN","PSOHLSN2",49,0)
 I '$D(^PSRX(PSRXIEN,"ICD",1,0)) D
"RTN","PSOHLSN2",50,0)
 . I '$G(PSOCPS) S FIELD(1)=$S($P($G(^PSRX(PSRXIEN,"IB")),"^"):"NSC",1:"SC")
"RTN","PSOHLSN2",51,0)
 . I $G(PSOCPS) D
"RTN","PSOHLSN2",52,0)
 .. S FIELD(1)=$P($G(^PSRX(PSRXIEN,"IBQ")),"^")
"RTN","PSOHLSN2",53,0)
 .. F JJJ=2:1:8 S FIELD(JJJ)=$P($G(^PSRX(PSRXIEN,"IBQ")),"^",JJJ)
"RTN","PSOHLSN2",54,0)
 .D SEG^PSOHLSN1
"RTN","PSOHLSN2",55,0)
 I $D(^PSRX(PSRXIEN,"ICD",1,0)) D
"RTN","PSOHLSN2",56,0)
 . S PSOICD=$G(^PSRX(PSRXIEN,"ICD",1,0))
"RTN","PSOHLSN2",57,0)
 . F JJJ=2:1:9 D
"RTN","PSOHLSN2",58,0)
 .. I JJJ=2 S FIELD(3)=$P(PSOICD,"^",JJJ)  ;AO
"RTN","PSOHLSN2",59,0)
 .. I JJJ=3 S FIELD(4)=$P(PSOICD,"^",JJJ)  ;IR
"RTN","PSOHLSN2",60,0)
 .. I JJJ=4 S FIELD(1)=$P(PSOICD,"^",JJJ)  ;SC
"RTN","PSOHLSN2",61,0)
 .. I JJJ=5 S FIELD(5)=$P(PSOICD,"^",JJJ)  ;EC
"RTN","PSOHLSN2",62,0)
 .. I JJJ=6 S FIELD(2)=$P(PSOICD,"^",JJJ)  ;MST
"RTN","PSOHLSN2",63,0)
 .. I JJJ=7 S FIELD(6)=$P(PSOICD,"^",JJJ)  ;HNC
"RTN","PSOHLSN2",64,0)
 .. I JJJ=8 S FIELD(7)=$P(PSOICD,"^",JJJ)  ;CV
"RTN","PSOHLSN2",65,0)
 .. I JJJ=9 S FIELD(8)=$P(PSOICD,"^",JJJ)  ;SHAD
"RTN","PSOHLSN2",66,0)
 . D SEG^PSOHLSN1
"RTN","PSOHLSN2",67,0)
 Q
"VER")
8.0^22.0
"BLD",10295,6)
^395
**END**
**END**

