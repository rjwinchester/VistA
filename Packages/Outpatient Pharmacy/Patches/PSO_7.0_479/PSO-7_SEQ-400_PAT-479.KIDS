Released PSO*7*479 SEQ #400
Extracted from mail message
**KIDS**:PSO*7.0*479^

**INSTALL NAME**
PSO*7.0*479
"BLD",10391,0)
PSO*7.0*479^OUTPATIENT PHARMACY^0^3170119^y
"BLD",10391,1,0)
^^2^2^3170118^
"BLD",10391,1,1,0)
This patch will fix the following issue:
"BLD",10391,1,2,0)
User attempts to '^' at the Device prompts, the fill is still processed
"BLD",10391,4,0)
^9.64PA^^
"BLD",10391,6.3)
2
"BLD",10391,"KRN",0)
^9.67PA^779.2^20
"BLD",10391,"KRN",.4,0)
.4
"BLD",10391,"KRN",.401,0)
.401
"BLD",10391,"KRN",.402,0)
.402
"BLD",10391,"KRN",.403,0)
.403
"BLD",10391,"KRN",.5,0)
.5
"BLD",10391,"KRN",.84,0)
.84
"BLD",10391,"KRN",3.6,0)
3.6
"BLD",10391,"KRN",3.8,0)
3.8
"BLD",10391,"KRN",9.2,0)
9.2
"BLD",10391,"KRN",9.8,0)
9.8
"BLD",10391,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10391,"KRN",9.8,"NM",1,0)
PSORRX2^^0^B34725424
"BLD",10391,"KRN",9.8,"NM","B","PSORRX2",1)

"BLD",10391,"KRN",19,0)
19
"BLD",10391,"KRN",19.1,0)
19.1
"BLD",10391,"KRN",101,0)
101
"BLD",10391,"KRN",409.61,0)
409.61
"BLD",10391,"KRN",771,0)
771
"BLD",10391,"KRN",779.2,0)
779.2
"BLD",10391,"KRN",870,0)
870
"BLD",10391,"KRN",8989.51,0)
8989.51
"BLD",10391,"KRN",8989.52,0)
8989.52
"BLD",10391,"KRN",8994,0)
8994
"BLD",10391,"KRN","B",.4,.4)

"BLD",10391,"KRN","B",.401,.401)

"BLD",10391,"KRN","B",.402,.402)

"BLD",10391,"KRN","B",.403,.403)

"BLD",10391,"KRN","B",.5,.5)

"BLD",10391,"KRN","B",.84,.84)

"BLD",10391,"KRN","B",3.6,3.6)

"BLD",10391,"KRN","B",3.8,3.8)

"BLD",10391,"KRN","B",9.2,9.2)

"BLD",10391,"KRN","B",9.8,9.8)

"BLD",10391,"KRN","B",19,19)

"BLD",10391,"KRN","B",19.1,19.1)

"BLD",10391,"KRN","B",101,101)

"BLD",10391,"KRN","B",409.61,409.61)

"BLD",10391,"KRN","B",771,771)

"BLD",10391,"KRN","B",779.2,779.2)

"BLD",10391,"KRN","B",870,870)

"BLD",10391,"KRN","B",8989.51,8989.51)

"BLD",10391,"KRN","B",8989.52,8989.52)

"BLD",10391,"KRN","B",8994,8994)

"BLD",10391,"QDEF")
^^^^NO^^^^^^NO
"BLD",10391,"QUES",0)
^9.62^^
"BLD",10391,"REQB",0)
^9.611^1^1
"BLD",10391,"REQB",1,0)
PSO*7.0*454^2
"BLD",10391,"REQB","B","PSO*7.0*454",1)

"MBREQ")
0
"PKG",206,-1)
1^1
"PKG",206,0)
OUTPATIENT PHARMACY^PSO^OUTPATIENT LABELS, PROFILE, INVENTORY, PRESCRIPTIONS
"PKG",206,20,0)
^9.402P^^
"PKG",206,22,0)
^9.49I^1^1
"PKG",206,22,1,0)
7.0^3021122^3021202^66481
"PKG",206,22,1,"PAH",1,0)
479^3170119
"PKG",206,22,1,"PAH",1,1,0)
^^2^2^3170119
"PKG",206,22,1,"PAH",1,1,1,0)
This patch will fix the following issue:
"PKG",206,22,1,"PAH",1,1,2,0)
User attempts to '^' at the Device prompts, the fill is still processed
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","PSORRX2")
0^1^B34725424^B32510176
"RTN","PSORRX2",1,0)
PSORRX2 ;AITC/BWF - Remote RX driver ;8/30/16 12:00am
"RTN","PSORRX2",2,0)
 ;;7.0;OUTPATIENT PHARMACY;**454,479**;DEC 1997;Build 2
"RTN","PSORRX2",3,0)
 ;
"RTN","PSORRX2",4,0)
 Q
"RTN","PSORRX2",5,0)
 ; read response from refill site
"RTN","PSORRX2",6,0)
READMSG(HLDAT,TYPE,LOCDRUG) ;
"RTN","PSORRX2",7,0)
 N ORFS,ORCS,ORRS,ORES,ORSS,HLQUIT,ORQUIT,OREMSG1,OREMSG2,ORSMSG,ORSMSG,GBLLOC,LBLOOP,LBTXT,LBLOVF,DIR,ORERR,MSGDONE,MSGCNT,MSGTXT
"RTN","PSORRX2",8,0)
 S ORFS=$G(HL("FS")),ORCS=$E($G(HL("ECH")),1),ORRS=$E($G(HL("ECH")),2),ORES=$E($G(HL("ECH")),3),ORSS=$E($G(HL("ECH")),4)
"RTN","PSORRX2",9,0)
 S TYPE=$G(TYPE,"")
"RTN","PSORRX2",10,0)
 S HLQUIT=0,ORQUIT="",OREMSG1="",OREMSG2="",ORERR=""
"RTN","PSORRX2",11,0)
 F  X HLNEXT Q:HLQUIT'>0!(ORQUIT'="")  D
"RTN","PSORRX2",12,0)
 .N LOOP
"RTN","PSORRX2",13,0)
 .S LOOP=0 F  S LOOP=$O(HLNODE(LOOP)) Q:LOOP=""  S HLNODE=HLNODE_HLNODE(LOOP)
"RTN","PSORRX2",14,0)
 .I $E(HLNODE,1,3)="MSA"&($P(HLNODE,ORFS,2)'="AA") S ORERR=$P(HLNODE,ORFS,4)
"RTN","PSORRX2",15,0)
 .I $E(HLNODE,1,3)="ERR" S OREMSG1=$P(HLNODE,ORFS,9)
"RTN","PSORRX2",16,0)
 .I $E(HLNODE,1,3)="NTE" D
"RTN","PSORRX2",17,0)
 ..D REFNTE(.HLNODE,.HLDAT)
"RTN","PSORRX2",18,0)
 ..S ORSMSG=$P(@HLDAT@(1),ORFS)
"RTN","PSORRX2",19,0)
 .I $E(HLNODE,1,3)="PID" D
"RTN","PSORRX2",20,0)
 ..S @HLDAT@(0)=$$FMADD^XLFDT($$NOW^XLFDT,2)_U_$$NOW^XLFDT
"RTN","PSORRX2",21,0)
 ..D REFPID(.HLNODE,.HLDAT)
"RTN","PSORRX2",22,0)
 .I $E(HLNODE,1,3)="ORC" D
"RTN","PSORRX2",23,0)
 ..D REFORC(.HLNODE,.HLDAT,TYPE)
"RTN","PSORRX2",24,0)
 .I $E(HLNODE,1,3)="RXD" D
"RTN","PSORRX2",25,0)
 ..D REFRXD(.HLNODE,.HLDAT,TYPE)
"RTN","PSORRX2",26,0)
 I '$L(ORERR),'$L(OREMSG1) D
"RTN","PSORRX2",27,0)
 .I '$D(@HLDAT) S ORERR="No data was returned from the target vista." Q
"RTN","PSORRX2",28,0)
 .W !!,"TRANSACTION SUCCESSFUL...  The "_$S($G(PRXNUM):"partial ",1:"refill ")_"for RX #"_RRXNUM_" has been recorded on"
"RTN","PSORRX2",29,0)
 .W !,"the prescription at the host system."
"RTN","PSORRX2",30,0)
 .W !!,"Select a printer to generate the label or '^' to bypass printing.",!
"RTN","PSORRX2",31,0)
 .D LOGDATA^PSORWRAP(.HLDAT,TYPE,LOCDRUG,"")
"RTN","PSORRX2",32,0)
 I $L(ORERR) D
"RTN","PSORRX2",33,0)
 . K PSORRBLD  ; no need to rebuild worklist
"RTN","PSORRX2",34,0)
 . I ORERR="Invalid Receiving Application" S ORERR="OneVA software not installed at host site"  ; This error is returned if patch is not installed at remote/host site.  Making it more user friendly.
"RTN","PSORRX2",35,0)
 . W !!,ORERR
"RTN","PSORRX2",36,0)
 . S DIR(0)="FO",DIR("A")="Press RETURN to continue"
"RTN","PSORRX2",37,0)
 . D ^DIR
"RTN","PSORRX2",38,0)
 I OREMSG1'="" D
"RTN","PSORRX2",39,0)
 . K PSORRBLD  ; no need to rebuild worklist
"RTN","PSORRX2",40,0)
 . W !!,OREMSG1_". "_$S($L(OREMSG2):OREMSG2_".",1:""),!
"RTN","PSORRX2",41,0)
 . I '$D(ORSMSG) S DIR(0)="FO",DIR("A")="Press RETURN to continue" D ^DIR
"RTN","PSORRX2",42,0)
 I $D(ORSMSG) D
"RTN","PSORRX2",43,0)
 .S MSGDONE=0
"RTN","PSORRX2",44,0)
 .F MSGCNT=1:1 D  Q:MSGDONE
"RTN","PSORRX2",45,0)
 ..S MSGTXT=$P(ORSMSG,"|",MSGCNT) I MSGTXT']"" S MSGDONE=1 Q
"RTN","PSORRX2",46,0)
 ..W !,MSGTXT
"RTN","PSORRX2",47,0)
 .S DIR(0)="FO",DIR("A")="Press RETURN to continue" D ^DIR
"RTN","PSORRX2",48,0)
 Q
"RTN","PSORRX2",49,0)
 ; HLDAT(1)=MESSAGE^PATIENT DFN^RX NUMBER^REMOTE SITE#^FILL/PARTIAL DATE^PHARMACIST NAME^QUANTITY^DISPENSE DATE^DRUG NAME^DAYS SUPPLY
"RTN","PSORRX2",50,0)
REFNTE(DATA,HLDAT) ;
"RTN","PSORRX2",51,0)
 ; Message details
"RTN","PSORRX2",52,0)
 N NTETYP,NTETEXT,NTETYPE
"RTN","PSORRX2",53,0)
 S NTETYPE=$P(DATA,ORFS,3)
"RTN","PSORRX2",54,0)
 S NTETEXT=$P(DATA,ORFS,4)
"RTN","PSORRX2",55,0)
 I NTETYPE="L" D
"RTN","PSORRX2",56,0)
 .I $L($P($G(@HLDAT@(1)),U)) S $P(@HLDAT@(1),U)=$P($G(@HLDAT@(1)),U)_"|"_NTETEXT Q
"RTN","PSORRX2",57,0)
 .S $P(@HLDAT@(1),U)=NTETEXT
"RTN","PSORRX2",58,0)
 I NTETYPE="O" D
"RTN","PSORRX2",59,0)
 .S @HLDAT@("LBL",$O(@HLDAT@("LBL",""),-1)+1)=NTETEXT
"RTN","PSORRX2",60,0)
 Q
"RTN","PSORRX2",61,0)
 ;
"RTN","PSORRX2",62,0)
REFPID(DATA,HLDAT) ;
"RTN","PSORRX2",63,0)
 ; patient IEN from remote site
"RTN","PSORRX2",64,0)
 S $P(@HLDAT@(1),U,2)=$P($P($P(DATA,ORFS,4),ORCS,11),ORRS,2)
"RTN","PSORRX2",65,0)
 Q
"RTN","PSORRX2",66,0)
 ;
"RTN","PSORRX2",67,0)
REFORC(DATA,HLDAT,TYPE) ;
"RTN","PSORRX2",68,0)
 N RXNUM,RXSITE,RXDATE,PHARMLN,PHARMFN,REQSITE,PHONE,PHNAME,PNAME,RPDATE,RPROV
"RTN","PSORRX2",69,0)
 S RXNUM=$P($P(DATA,ORFS,3),ORCS)
"RTN","PSORRX2",70,0)
 S RXSITE=$P($P(DATA,ORFS,14),ORCS,4)
"RTN","PSORRX2",71,0)
 S RPDATE=$P(DATA,ORFS,10)
"RTN","PSORRX2",72,0)
 S RPROV=$P(DATA,ORFS,12)
"RTN","PSORRX2",73,0)
 S PHNAME=$P(DATA,ORFS,11)
"RTN","PSORRX2",74,0)
 S $P(@HLDAT@(1),U,3)=RXNUM
"RTN","PSORRX2",75,0)
 S $P(@HLDAT@(1),U,4)=RXSITE
"RTN","PSORRX2",76,0)
 S $P(@HLDAT@(1),U,5)=RPDATE
"RTN","PSORRX2",77,0)
 S $P(@HLDAT@(1),U,6)=PHNAME
"RTN","PSORRX2",78,0)
 S $P(@HLDAT@("RX0"),U)=RXNUM,$P(@HLDAT@("RX0"),U,2)=DFN,$P(@HLDAT@("RX0"),U,5)=$P($P($P(DATA,ORFS,22),ORCS,8),ORSS,2),$P(@HLDAT@("RX0"),U,6)=LOCDRUG
"RTN","PSORRX2",79,0)
 S $P(@HLDAT@("RX0"),U,4)=$P($P($P(DATA,ORFS,20),ORRS,1),ORCS,2)
"RTN","PSORRX2",80,0)
 S $P(@HLDAT@("RX0"),U,13)=$P(DATA,ORFS,16),$P(@HLDAT@("RX0"),U,19)=""
"RTN","PSORRX2",81,0)
 ; dont forget copies in p18, if needed
"RTN","PSORRX2",82,0)
 S $P(@HLDAT@("RX2"),U,2)=RPDATE,$P(@HLDAT@("RX2"),U,10)=$P($P($P(DATA,ORFS,20),ORRS,2),ORCS,2)
"RTN","PSORRX2",83,0)
 S $P(@HLDAT@("RX3"),U)=$P(DATA,ORFS,28)
"RTN","PSORRX2",84,0)
 I TYPE="RF" D
"RTN","PSORRX2",85,0)
 .S $P(@HLDAT@("RREF0"),U)=RPDATE,$P(@HLDAT@("RREF0"),U,2)="W",$P(@HLDAT@("RREF0"),U,7)=$P($P($P(DATA,ORFS,20),ORRS,3),ORCS,2)
"RTN","PSORRX2",86,0)
 .S $P(@HLDAT@("RREF0"),U,17)=$P($P($P(DATA,ORFS,20),ORRS,4),ORCS,2)
"RTN","PSORRX2",87,0)
 I TYPE="PR" D
"RTN","PSORRX2",88,0)
 .S $P(@HLDAT@("RPAR0"),U)=RPDATE,$P(@HLDAT@("RPAR0"),U,2)="W",$P(@HLDAT@("RPAR0"),U,7)=$P($P($P(DATA,ORFS,20),ORRS,3),ORCS,2)
"RTN","PSORRX2",89,0)
 .S $P(@HLDAT@("RPAR0"),U,17)=$P($P($P(DATA,ORFS,20),ORRS,4),ORCS,2)
"RTN","PSORRX2",90,0)
 S $P(@HLDAT@("ROR1"),U,5)=$P($P($P(DATA,ORFS,20),ORRS,5),ORCS,2)
"RTN","PSORRX2",91,0)
 S @HLDAT@("RXSTA")=$P($P(DATA,ORFS,26),ORCS),@HLDAT@("RXSTA2")=$P($P(DATA,ORFS,26),ORCS,2)
"RTN","PSORRX2",92,0)
 S @HLDAT@("PATST")=$P($P(DATA,ORFS,26),ORCS,4)
"RTN","PSORRX2",93,0)
 ; HOST INFO
"RTN","PSORRX2",94,0)
 ; P1 - NAME, P2 - ADDRESS~~CITY~STATE~ZIP, P3 - PHONE NUMBER, P4 - HOST SITE NUMBER
"RTN","PSORRX2",95,0)
 S $P(DATA,ORFS,23)=$P($P(DATA,ORFS,23),ORSS)_ORSS_$P($P(DATA,ORFS,23),ORSS,3,5)
"RTN","PSORRX2",96,0)
 S @HLDAT@("HINFO")=$P($P(DATA,ORFS,22),ORCS)_U_$P(DATA,ORFS,23)_U_$P(DATA,ORFS,24)
"RTN","PSORRX2",97,0)
 S $P(@HLDAT@("HINFO"),U,4)=RXSITE
"RTN","PSORRX2",98,0)
 S $P(@HLDAT@("HINFO"),U,5)=$P($P($P(DATA,ORFS,22),ORCS,8),ORSS,2)  ;Clinic
"RTN","PSORRX2",99,0)
 Q
"RTN","PSORRX2",100,0)
REFRXD(DATA,HLDAT,TYPE)  ;
"RTN","PSORRX2",101,0)
 N QTY,DSUPP,DNAME,HINFO,SIG1D,SIGDAT,SIGNUM,SIGTXT,I
"RTN","PSORRX2",102,0)
 S ($P(@HLDAT@(1),U,7),$P(@HLDAT@("RX0"),U,7))=$P(DATA,ORFS,5)  ; quantity
"RTN","PSORRX2",103,0)
 S $P(@HLDAT@(1),U,8)=$P(DATA,ORFS,4) ; dispense date
"RTN","PSORRX2",104,0)
 S $P(@HLDAT@(1),U,9)=$P($P(DATA,ORFS,3),ORCS,1) ; drug name
"RTN","PSORRX2",105,0)
 S ($P(@HLDAT@(1),U,10),$P(@HLDAT@("RX0"),U,8))=$P(DATA,ORFS,13) ; days supply
"RTN","PSORRX2",106,0)
 S $P(@HLDAT@("RX0"),U,9)=$P(DATA,ORFS,9),$P(@HLDAT@("RX0"),U,11)="W"
"RTN","PSORRX2",107,0)
 S $P(@HLDAT@("RX0"),U,18)=$P(DATA,ORFS,23)  ; Copies
"RTN","PSORRX2",108,0)
 S $P(@HLDAT@("RX2"),U,6)=$P(DATA,ORFS,20)  ; Rx Expiration Date 
"RTN","PSORRX2",109,0)
 ;
"RTN","PSORRX2",110,0)
 I TYPE="RF" D
"RTN","PSORRX2",111,0)
 .S $P(@HLDAT@("RREF0"),U,4)=$P(DATA,ORFS,5),$P(@HLDAT@("RREF0"),U,10)=$P(DATA,ORFS,13)
"RTN","PSORRX2",112,0)
 .S @HLDAT@("RFIEN")=$P($P(DATA,ORFS,8),":",3)
"RTN","PSORRX2",113,0)
 I TYPE="PR" D
"RTN","PSORRX2",114,0)
 .S $P(@HLDAT@("RPAR0"),U,4)=$P(DATA,ORFS,5),$P(@HLDAT@("RPAR0"),U,10)=$P(DATA,ORFS,13)
"RTN","PSORRX2",115,0)
 .S @HLDAT@("PARIEN")=$P($P(DATA,ORFS,8),":",3)
"RTN","PSORRX2",116,0)
 ;
"RTN","PSORRX2",117,0)
 S @HLDAT@("RSIG")=$P($P($P(DATA,ORFS,16),ORRS,1),ORCS,2)_U_$P($P($P(DATA,ORFS,16),ORRS,1),ORCS)
"RTN","PSORRX2",118,0)
 S @HLDAT@("RIEN")=$P($P(DATA,ORFS,8),":")
"RTN","PSORRX2",119,0)
 ;I '$P($G(@HLDAT@("RSIG")),U,2) Q
"RTN","PSORRX2",120,0)
 S SIG1D=0
"RTN","PSORRX2",121,0)
 F I=2:1 D  Q:SIG1D
"RTN","PSORRX2",122,0)
 .S SIGDAT=$P($P(DATA,ORFS,16),ORRS,I) I SIGDAT']"" S SIG1D=1 Q
"RTN","PSORRX2",123,0)
 .S SIGNUM=$P(SIGDAT,ORCS),SIGNUM=$P(SIGNUM,"_",2),SIGTXT=$P(SIGDAT,ORCS,2) Q:'SIGNUM
"RTN","PSORRX2",124,0)
 .S @HLDAT@("RSIG1",SIGNUM)=SIGTXT
"RTN","PSORRX2",125,0)
 Q
"VER")
8.0^22.0
"BLD",10391,6)
^400
**END**
**END**

