Released PRCA*4.5*362 SEQ #310
Extracted from mail message
**KIDS**:PRCA*4.5*362^

**INSTALL NAME**
PRCA*4.5*362
"BLD",11399,0)
PRCA*4.5*362^ACCOUNTS RECEIVABLE^0^3190829^y
"BLD",11399,4,0)
^9.64PA^^
"BLD",11399,6.3)
1
"BLD",11399,"ABPKG")
n
"BLD",11399,"KRN",0)
^9.67PA^1.5^24
"BLD",11399,"KRN",.4,0)
.4
"BLD",11399,"KRN",.401,0)
.401
"BLD",11399,"KRN",.402,0)
.402
"BLD",11399,"KRN",.403,0)
.403
"BLD",11399,"KRN",.5,0)
.5
"BLD",11399,"KRN",.84,0)
.84
"BLD",11399,"KRN",1.5,0)
1.5
"BLD",11399,"KRN",1.6,0)
1.6
"BLD",11399,"KRN",1.61,0)
1.61
"BLD",11399,"KRN",1.62,0)
1.62
"BLD",11399,"KRN",3.6,0)
3.6
"BLD",11399,"KRN",3.8,0)
3.8
"BLD",11399,"KRN",9.2,0)
9.2
"BLD",11399,"KRN",9.8,0)
9.8
"BLD",11399,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",11399,"KRN",9.8,"NM",1,0)
RCCPCPS1^^0^B54822379
"BLD",11399,"KRN",9.8,"NM","B","RCCPCPS1",1)

"BLD",11399,"KRN",19,0)
19
"BLD",11399,"KRN",19.1,0)
19.1
"BLD",11399,"KRN",101,0)
101
"BLD",11399,"KRN",409.61,0)
409.61
"BLD",11399,"KRN",771,0)
771
"BLD",11399,"KRN",779.2,0)
779.2
"BLD",11399,"KRN",870,0)
870
"BLD",11399,"KRN",8989.51,0)
8989.51
"BLD",11399,"KRN",8989.52,0)
8989.52
"BLD",11399,"KRN",8994,0)
8994
"BLD",11399,"KRN","B",.4,.4)

"BLD",11399,"KRN","B",.401,.401)

"BLD",11399,"KRN","B",.402,.402)

"BLD",11399,"KRN","B",.403,.403)

"BLD",11399,"KRN","B",.5,.5)

"BLD",11399,"KRN","B",.84,.84)

"BLD",11399,"KRN","B",1.5,1.5)

"BLD",11399,"KRN","B",1.6,1.6)

"BLD",11399,"KRN","B",1.61,1.61)

"BLD",11399,"KRN","B",1.62,1.62)

"BLD",11399,"KRN","B",3.6,3.6)

"BLD",11399,"KRN","B",3.8,3.8)

"BLD",11399,"KRN","B",9.2,9.2)

"BLD",11399,"KRN","B",9.8,9.8)

"BLD",11399,"KRN","B",19,19)

"BLD",11399,"KRN","B",19.1,19.1)

"BLD",11399,"KRN","B",101,101)

"BLD",11399,"KRN","B",409.61,409.61)

"BLD",11399,"KRN","B",771,771)

"BLD",11399,"KRN","B",779.2,779.2)

"BLD",11399,"KRN","B",870,870)

"BLD",11399,"KRN","B",8989.51,8989.51)

"BLD",11399,"KRN","B",8989.52,8989.52)

"BLD",11399,"KRN","B",8994,8994)

"BLD",11399,"QDEF")
^^^^NO^^^^^^NO
"BLD",11399,"QUES",0)
^9.62^^
"BLD",11399,"REQB",0)
^9.611^1^1
"BLD",11399,"REQB",1,0)
PRCA*4.5*338^2
"BLD",11399,"REQB","B","PRCA*4.5*338",1)

"MBREQ")
0
"PKG",561,-1)
1^1
"PKG",561,0)
ACCOUNTS RECEIVABLE^PRCA^FMS
"PKG",561,22,0)
^9.49I^1^1
"PKG",561,22,1,0)
4.5^2950320^2950331
"PKG",561,22,1,"PAH",1,0)
362^3190829
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RCCPCPS1")
0^1^B54822379^B37370113
"RTN","RCCPCPS1",1,0)
RCCPCPS1 ;WISC/RFJ-build description for patient statement ;08 Aug 2001
"RTN","RCCPCPS1",2,0)
 ;;4.5;Accounts Receivable;**34,48,104,170,176,192,265,362**;Mar 20, 1995;Build 1
"RTN","RCCPCPS1",3,0)
 ;;Per VHA Directive 6402, this routine should not be modified.
"RTN","RCCPCPS1",4,0)
 Q
"RTN","RCCPCPS1",5,0)
 ;
"RTN","RCCPCPS1",6,0)
 ;
"RTN","RCCPCPS1",7,0)
TRANDESC(RCTRANDA,RCWIDTH) ;  build the description array for a transaction
"RTN","RCCPCPS1",8,0)
 ;
"RTN","RCCPCPS1",9,0)
 ;  initialize
"RTN","RCCPCPS1",10,0)
 N DESCRIPT,RCBILLDA,RCCATEG,RCCATTXT,RCDATA0,RCDATA1,RCDATA3,RCLINE,TRANTYPE,X
"RTN","RCCPCPS1",11,0)
 I '$G(RCWIDTH) S RCWIDTH=50 ; Default max. width is 50 characters
"RTN","RCCPCPS1",12,0)
 K RCDESC
"RTN","RCCPCPS1",13,0)
 S RCLINE=1,RCDESC(1)=""
"RTN","RCCPCPS1",14,0)
 ;
"RTN","RCCPCPS1",15,0)
 S RCBILLDA=+$P($G(^PRCA(433,RCTRANDA,0)),"^",2) I 'RCBILLDA Q
"RTN","RCCPCPS1",16,0)
 S RCDATA0=^PRCA(430,RCBILLDA,0)
"RTN","RCCPCPS1",17,0)
 S RCCATEG=+$P(RCDATA0,"^",2),RCCATTXT=$P($G(^PRCA(430.2,RCCATEG,0)),"^")
"RTN","RCCPCPS1",18,0)
 S RCDATA1=^PRCA(433,RCTRANDA,1)
"RTN","RCCPCPS1",19,0)
 S TRANTYPE=$P(RCDATA1,"^",2)
"RTN","RCCPCPS1",20,0)
 ;
"RTN","RCCPCPS1",21,0)
 ;  build the first line description
"RTN","RCCPCPS1",22,0)
 ;  if transaction type is an increase or decrease, set description
"RTN","RCCPCPS1",23,0)
 I TRANTYPE=1!(TRANTYPE=35) D
"RTN","RCCPCPS1",24,0)
 .   ;  if c means test, set description to category for c means test
"RTN","RCCPCPS1",25,0)
 .   I RCCATEG=18 S DESCRIPT=$S($P(RCDATA0,"^",16):$P(^PRCA(430.2,$P(RCDATA0,"^",16),0),"^"),1:RCCATTXT) Q
"RTN","RCCPCPS1",26,0)
 .   ;  otherwise, set to category name
"RTN","RCCPCPS1",27,0)
 .   ;PRCA*4.5*362
"RTN","RCCPCPS1",28,0)
 .   I RCCATEG>47,RCCATEG<86 D  Q
"RTN","RCCPCPS1",29,0)
 .   . I RCCATTXT["RX" S DESCRIPT="COMMUNITY CARE RX" Q
"RTN","RCCPCPS1",30,0)
 .   . I RCCATTXT["INPT" S DESCRIPT="COMMUNITY CARE INPT" Q
"RTN","RCCPCPS1",31,0)
 .   . I RCCATTXT["OPT" S DESCRIPT="COMMUNITY CARE OUTPATIENT" Q
"RTN","RCCPCPS1",32,0)
 .   . I RCCATTXT["URGENT" S DESCRIPT="COMMUNITY CARE URGENT CARE" Q
"RTN","RCCPCPS1",33,0)
 .   . I RCCATTXT["RESPITE" S DESCRIPT="COMMUNITY CARE RESPITE CARE" Q
"RTN","RCCPCPS1",34,0)
 .   . I RCCATTXT["NURSING" S DESCRIPT="COMMUNITY CARE NURSING HOME"
"RTN","RCCPCPS1",35,0)
 .   ;end PRCA*4.5*362
"RTN","RCCPCPS1",36,0)
 .   ;
"RTN","RCCPCPS1",37,0)
 .   S DESCRIPT=RCCATTXT
"RTN","RCCPCPS1",38,0)
 ;
"RTN","RCCPCPS1",39,0)
 ;  if the bill category is a rx-copay and it is an increase adjustment
"RTN","RCCPCPS1",40,0)
 ;  then set the description to copay
"RTN","RCCPCPS1",41,0)
 I RCCATEG=22!(RCCATEG=23),TRANTYPE=1 S DESCRIPT="COPAY"
"RTN","RCCPCPS1",42,0)
 ;
"RTN","RCCPCPS1",43,0)
 ;  if the bill category is adult day health care, remove health
"RTN","RCCPCPS1",44,0)
 I RCCATEG=33 S DESCRIPT="ADULT DAY CARE"
"RTN","RCCPCPS1",45,0)
 ;
"RTN","RCCPCPS1",46,0)
 ;  if the bill category is respite or geriatric eval,
"RTN","RCCPCPS1",47,0)
 ;  take the 2nd piece removing institutional
"RTN","RCCPCPS1",48,0)
 I RCCATEG=35!(RCCATEG=36)!(RCCATEG=37)!(RCCATEG=38) S DESCRIPT=$P(RCCATTXT,"-")_$S(RCCATEG=35!(RCCATEG=37):" IN",1:" OUT")_"PATIENT"
"RTN","RCCPCPS1",49,0)
 ;
"RTN","RCCPCPS1",50,0)
 ;  if it is a comment transaction
"RTN","RCCPCPS1",51,0)
 I TRANTYPE=45 S DESCRIPT="COMMENT: "_$P($G(^PRCA(433,RCTRANDA,5)),"^",2)
"RTN","RCCPCPS1",52,0)
 ;
"RTN","RCCPCPS1",53,0)
 ;  prepayment bill (1=increase, 35=decrease, otherwise refund)
"RTN","RCCPCPS1",54,0)
 I RCCATEG=26 S DESCRIPT=$S(TRANTYPE=1:"OVERPAYMENT CREDIT",TRANTYPE=35:"OVERPAYMENT CREDIT DECREASE",1:"OVERPAYMENT REFUND")
"RTN","RCCPCPS1",55,0)
 ;
"RTN","RCCPCPS1",56,0)
 ;  if the first line description not set (like payments), set it
"RTN","RCCPCPS1",57,0)
 ;  to the type of transaction
"RTN","RCCPCPS1",58,0)
 I $G(DESCRIPT)="" S DESCRIPT=$P($G(^PRCA(430.3,+$P(RCDATA1,"^",2),0)),"^")
"RTN","RCCPCPS1",59,0)
 ;
"RTN","RCCPCPS1",60,0)
 ;  if the transaction date is different from the process date,
"RTN","RCCPCPS1",61,0)
 ;  show it with the description
"RTN","RCCPCPS1",62,0)
 I $P(RCDATA1,"^"),$P($P(RCDATA1,"^"),".")'=$P($P(RCDATA1,"^",9),".") S DESCRIPT=DESCRIPT_"  ("_$$DATE($P($P(RCDATA1,"^"),"."))_")"
"RTN","RCCPCPS1",63,0)
 ;
"RTN","RCCPCPS1",64,0)
 ;  set the first description line
"RTN","RCCPCPS1",65,0)
 D SETDESC(DESCRIPT)
"RTN","RCCPCPS1",66,0)
 ;
"RTN","RCCPCPS1",67,0)
 ;  if it is a payment transaction, show amount paid interest, admin, other
"RTN","RCCPCPS1",68,0)
 I TRANTYPE=2!(TRANTYPE=34) D
"RTN","RCCPCPS1",69,0)
 .   S RCDATA3=$G(^PRCA(433,RCTRANDA,3))
"RTN","RCCPCPS1",70,0)
 .   ;  if not interest, admin, or other, quit
"RTN","RCCPCPS1",71,0)
 .   I '$P(RCDATA3,"^",2),'$P(RCDATA3,"^",3),'$P(RCDATA3,"^",4),'$P(RCDATA3,"^",5) Q
"RTN","RCCPCPS1",72,0)
 .   ;
"RTN","RCCPCPS1",73,0)
 .   S DESCRIPT="  (Int:"_$J(+$P(RCDATA3,"^",2),1,2)_"  Adm:"_$J(+$P(RCDATA3,"^",3),1,2)
"RTN","RCCPCPS1",74,0)
 .   ;  calculate other
"RTN","RCCPCPS1",75,0)
 .   S X=$P(RCDATA1,"^",5)-$P(RCDATA3,"^")-$P(RCDATA3,"^",2)-$P(RCDATA3,"^",3)
"RTN","RCCPCPS1",76,0)
 .   S DESCRIPT=DESCRIPT_$S(X:" Other:"_$J(X,1,2)_")",1:")")
"RTN","RCCPCPS1",77,0)
 .   D SETDESC(DESCRIPT)
"RTN","RCCPCPS1",78,0)
 ;
"RTN","RCCPCPS1",79,0)
 ;  if it is a admin cost or interest charge, total the amounts
"RTN","RCCPCPS1",80,0)
 I TRANTYPE=13!(TRANTYPE=12) D  Q
"RTN","RCCPCPS1",81,0)
 .   S X=$G(^PRCA(433,RCTRANDA,2)) I X="" Q
"RTN","RCCPCPS1",82,0)
 .   S RCTOTAL("INT")=$G(RCTOTAL("INT"))+$P(X,"^",7)
"RTN","RCCPCPS1",83,0)
 .   S RCTOTAL("ADM")=$G(RCTOTAL("ADM"))+$P(X,"^",8)
"RTN","RCCPCPS1",84,0)
 .   S RCTOTAL("OTH")=$G(RCTOTAL("OTH"))+($P(RCDATA1,"^",5)-$P(X,"^",7)-$P(X,"^",8))
"RTN","RCCPCPS1",85,0)
 ;
"RTN","RCCPCPS1",86,0)
 ;  if not an increase adjustment, quit
"RTN","RCCPCPS1",87,0)
 I TRANTYPE'=1 Q
"RTN","RCCPCPS1",88,0)
 ;
"RTN","RCCPCPS1",89,0)
 ;  increase to c means test, ltc or rx-copay, get data from ib
"RTN","RCCPCPS1",90,0)
 I RCCATEG=18!(RCCATEG=22)!(RCCATEG=23)!((RCCATEG>32)&(RCCATEG<40)) D  Q     ;PRCA*4.5*362 - added quit, no longer the last check
"RTN","RCCPCPS1",91,0)
 .   S X="IBRFN1" X ^%ZOSF("TEST") I '$T Q
"RTN","RCCPCPS1",92,0)
 .   K ^TMP("IBRFN1",$J)
"RTN","RCCPCPS1",93,0)
 .   D STMT^IBRFN1(RCTRANDA)
"RTN","RCCPCPS1",94,0)
 .   D IBDATA
"RTN","RCCPCPS1",95,0)
 ;
"RTN","RCCPCPS1",96,0)
 ; PRCA*4.5*362
"RTN","RCCPCPS1",97,0)
 ; Community Care Transaction Description Adjustments
"RTN","RCCPCPS1",98,0)
 I RCCATEG>47,RCCATEG<86 D
"RTN","RCCPCPS1",99,0)
 .   S X="IBRFN1" X ^%ZOSF("TEST") I '$T Q
"RTN","RCCPCPS1",100,0)
 .   K ^TMP("IBRFN1",$J)
"RTN","RCCPCPS1",101,0)
 .   D STMT^IBRFN1(RCTRANDA)
"RTN","RCCPCPS1",102,0)
 .   D IBDATA
"RTN","RCCPCPS1",103,0)
 ;END PRCA*4.5*362
"RTN","RCCPCPS1",104,0)
 Q
"RTN","RCCPCPS1",105,0)
 ;
"RTN","RCCPCPS1",106,0)
 ;
"RTN","RCCPCPS1",107,0)
 ;  Returns RCDESC(1..n) array of Bill Description
"RTN","RCCPCPS1",108,0)
BILLDESC(RCBILLDA,RCWIDTH) ;
"RTN","RCCPCPS1",109,0)
 ;  initialize
"RTN","RCCPCPS1",110,0)
 N DESCRIPT,RCCATEG,RCCATTXT,RCDATA0,RCLINE,X
"RTN","RCCPCPS1",111,0)
 I '$G(RCWIDTH) S RCWIDTH=50 ; Default max. width is 50 characters
"RTN","RCCPCPS1",112,0)
 K RCDESC
"RTN","RCCPCPS1",113,0)
 S RCLINE=1,RCDESC(1)=""
"RTN","RCCPCPS1",114,0)
 ;
"RTN","RCCPCPS1",115,0)
 S RCDATA0=^PRCA(430,RCBILLDA,0)
"RTN","RCCPCPS1",116,0)
 S RCCATEG=+$P(RCDATA0,"^",2),RCCATTXT=$P($G(^PRCA(430.2,RCCATEG,0)),"^")
"RTN","RCCPCPS1",117,0)
 ;
"RTN","RCCPCPS1",118,0)
 ;  if category=c means test, set the description and quit
"RTN","RCCPCPS1",119,0)
 I RCCATEG=18 S DESCRIPT=$S($P(RCDATA0,"^",16):$P(^PRCA(430.2,$P(RCDATA0,"^",16),0),"^"),1:RCCATTXT) D SETDESC(DESCRIPT) Q
"RTN","RCCPCPS1",120,0)
 ;
"RTN","RCCPCPS1",121,0)
 ;  set the category description
"RTN","RCCPCPS1",122,0)
 D SETDESC(RCCATTXT)
"RTN","RCCPCPS1",123,0)
 ;
"RTN","RCCPCPS1",124,0)
 ;  if category not champva subsitence and not tricare patient, quit
"RTN","RCCPCPS1",125,0)
 I RCCATEG'=27,RCCATEG'=31 Q
"RTN","RCCPCPS1",126,0)
 ;
"RTN","RCCPCPS1",127,0)
 ;  build description for champva subsistence and tricare patient bills
"RTN","RCCPCPS1",128,0)
 ;  get data from ib
"RTN","RCCPCPS1",129,0)
 S X="IBRFN1" X ^%ZOSF("TEST") I '$T Q
"RTN","RCCPCPS1",130,0)
 K ^TMP("IBRFN1",$J)
"RTN","RCCPCPS1",131,0)
 D STMTB^IBRFN1($P(RCDATA0,"^"))
"RTN","RCCPCPS1",132,0)
 D IBDATA
"RTN","RCCPCPS1",133,0)
 Q
"RTN","RCCPCPS1",134,0)
 ;
"RTN","RCCPCPS1",135,0)
 ;
"RTN","RCCPCPS1",136,0)
IBDATA ;  get data from IB for description
"RTN","RCCPCPS1",137,0)
 N IBDATA,IBJ
"RTN","RCCPCPS1",138,0)
 ;
"RTN","RCCPCPS1",139,0)
 ;  show IB data
"RTN","RCCPCPS1",140,0)
 S IBJ=0 F  S IBJ=$O(^TMP("IBRFN1",$J,IBJ)) Q:'IBJ  S IBDATA=^TMP("IBRFN1",$J,IBJ) D
"RTN","RCCPCPS1",141,0)
 .   ;
"RTN","RCCPCPS1",142,0)
 .   ;  if no drug or bill date returned from IB, then it is outpatient
"RTN","RCCPCPS1",143,0)
 .   ;PRCA*4.5*362 - finish completing line 1 of the Transaction for Community Care copays
"RTN","RCCPCPS1",144,0)
 .   I RCDESC(1)["COMMUNITY CARE RESPITE" D       ;determine if inpatient or outpatient
"RTN","RCCPCPS1",145,0)
 .   . I $P(IBDATA,"^",5) D SETDESC("INPATIENT") Q
"RTN","RCCPCPS1",146,0)
 .   . D SETDESC("OUTPATIENT")
"RTN","RCCPCPS1",147,0)
 .   ;
"RTN","RCCPCPS1",148,0)
 .   I RCDESC(1)["COMMUNITY CARE NURSING" D       ;determining if Nursing Home or Adult Day Care
"RTN","RCCPCPS1",149,0)
 .   . I $P(IBDATA,"^",5) D SETDESC("INPATIENT") Q
"RTN","RCCPCPS1",150,0)
 .   . S RCDESC(1)="" S DESCRIPT="COMMUNITY CARE ADULT DAY CARE" D SETDESC(DESCRIPT)
"RTN","RCCPCPS1",151,0)
 .   ;
"RTN","RCCPCPS1",152,0)
 .   I RCDESC(1)["COMMUNITY CARE RX" D  Q       ;Use Bill from date as Fill Date
"RTN","RCCPCPS1",153,0)
 .   . D:$P(IBDATA,"^",3) SETDESC("FD:"_$$DATE($P(IBDATA,"^",3)))
"RTN","RCCPCPS1",154,0)
 .   ;END PRCA*4.5*362
"RTN","RCCPCPS1",155,0)
 .   ;
"RTN","RCCPCPS1",156,0)
 .   I $P(IBDATA,"^",3)="" D:$P(IBDATA,"^",2) SETDESC("VISIT DATE: "_$$DATE($P(IBDATA,"^",2))) Q
"RTN","RCCPCPS1",157,0)
 .   ;
"RTN","RCCPCPS1",158,0)
 .   ;  if no drug quantity returned from ib, then it is inpatient
"RTN","RCCPCPS1",159,0)
 .   I '$P(IBDATA,"^",6) D  Q
"RTN","RCCPCPS1",160,0)
 .   .   I $P(IBDATA,"^",2) D SETDESC("  ADMISSION DATE: "_$$DATE($P(IBDATA,"^",2)))
"RTN","RCCPCPS1",161,0)
 .   .   I $P(IBDATA,"^",3) D SETDESC("  BEGINNING DATE OF BILLING CYCLE: "_$$DATE($P(IBDATA,"^",3)))
"RTN","RCCPCPS1",162,0)
 .   .   I $P(IBDATA,"^",4) D SETDESC("  ENDING DATE OF BILLING CYCLE: "_$$DATE($P(IBDATA,"^",4)))
"RTN","RCCPCPS1",163,0)
 .   .   I $P(IBDATA,"^",5) D SETDESC("  DISCHARGE DATE: "_$$DATE($P(IBDATA,"^",5)))
"RTN","RCCPCPS1",164,0)
 .   ;
"RTN","RCCPCPS1",165,0)
 .   ;  pharmacy
"RTN","RCCPCPS1",166,0)
 .   D:$P(IBDATA,"^",2) SETDESC("RX:"_$P(IBDATA,"^",2))
"RTN","RCCPCPS1",167,0)
 .   D:$P(IBDATA,"^",7) SETDESC("FD:"_$$DATE($P(IBDATA,"^",7)))
"RTN","RCCPCPS1",168,0)
 .   ;
"RTN","RCCPCPS1",169,0)
 .   ;  if not patient statement detail, quit
"RTN","RCCPCPS1",170,0)
 .   I $$DET^RCFN01($P(RCDATA0,"^",9))'=2 Q
"RTN","RCCPCPS1",171,0)
 .   ;
"RTN","RCCPCPS1",172,0)
 .   ;  return pharmacy detail
"RTN","RCCPCPS1",173,0)
 .   I $P(IBDATA,"^",3)'="" D SETDESC(" DRUG:"_$TR($P(IBDATA,"^",3),"|~"))
"RTN","RCCPCPS1",174,0)
 .   I $P(IBDATA,"^",4) D SETDESC(" DAYS:"_$P(IBDATA,"^",4))
"RTN","RCCPCPS1",175,0)
 .   I $P(IBDATA,"^",6) D SETDESC(" QTY:"_$P(IBDATA,"^",6))
"RTN","RCCPCPS1",176,0)
 .   I $P(IBDATA,"^",5)'="" D SETDESC(" PHY:"_$P(IBDATA,"^",5))
"RTN","RCCPCPS1",177,0)
 .   I $P(IBDATA,"^",8) D SETDESC(" CHG:$"_$J($P(IBDATA,"^",8),0,2))
"RTN","RCCPCPS1",178,0)
 ;
"RTN","RCCPCPS1",179,0)
 K ^TMP("IBRFN1",$J)
"RTN","RCCPCPS1",180,0)
 Q
"RTN","RCCPCPS1",181,0)
 ;
"RTN","RCCPCPS1",182,0)
 ;
"RTN","RCCPCPS1",183,0)
 ; Add line to the description, not longer than RCWIDTH
"RTN","RCCPCPS1",184,0)
 ; Input: RCLINE,RCWIDTH
"RTN","RCCPCPS1",185,0)
 ; Output: RCDESC
"RTN","RCCPCPS1",186,0)
SETDESC(DESCRIPT) N LENGTH
"RTN","RCCPCPS1",187,0)
 ;  calculate the length of the description
"RTN","RCCPCPS1",188,0)
 S LENGTH=$L(RCDESC(RCLINE))+$L(DESCRIPT)
"RTN","RCCPCPS1",189,0)
 I RCDESC(RCLINE)'="" S LENGTH=LENGTH+1
"RTN","RCCPCPS1",190,0)
 ;
"RTN","RCCPCPS1",191,0)
 ;  the description line cannot go over RCWIDTH characters
"RTN","RCCPCPS1",192,0)
 I LENGTH<RCWIDTH S RCDESC(RCLINE)=RCDESC(RCLINE)_$S(RCDESC(RCLINE)="":"",1:" ")_DESCRIPT Q
"RTN","RCCPCPS1",193,0)
 ;
"RTN","RCCPCPS1",194,0)
 ; Description line to add is over RCWIDTH
"RTN","RCCPCPS1",195,0)
 ; The given string will be splitted _only_ if the limit is more than 44 characters.
"RTN","RCCPCPS1",196,0)
 I $L(DESCRIPT)>RCWIDTH D  Q
"RTN","RCCPCPS1",197,0)
 .   I RCDESC(RCLINE)'="" S RCLINE=RCLINE+1
"RTN","RCCPCPS1",198,0)
 .   S RCDESC(RCLINE)=$E(DESCRIPT,1,RCWIDTH)
"RTN","RCCPCPS1",199,0)
 .   S RCLINE=RCLINE+1
"RTN","RCCPCPS1",200,0)
 .   S RCDESC(RCLINE)=$E(DESCRIPT,RCWIDTH+1,2*RCWIDTH)
"RTN","RCCPCPS1",201,0)
 ;
"RTN","RCCPCPS1",202,0)
 ;  over RCWIDTH characters, start new line
"RTN","RCCPCPS1",203,0)
 I RCDESC(RCLINE)'="" S RCLINE=RCLINE+1
"RTN","RCCPCPS1",204,0)
 S RCDESC(RCLINE)=DESCRIPT
"RTN","RCCPCPS1",205,0)
 Q
"RTN","RCCPCPS1",206,0)
 ;
"RTN","RCCPCPS1",207,0)
DATE(FMDT) ;  format date mm/dd/yyyy
"RTN","RCCPCPS1",208,0)
 I 'FMDT Q ""
"RTN","RCCPCPS1",209,0)
 N X,Y,%DT S %DT="TX",X=FMDT D ^%DT Q:Y<0 ""
"RTN","RCCPCPS1",210,0)
 Q $E(FMDT,4,5)_"/"_$E(FMDT,6,7)_"/"_(1700+$E(FMDT,1,3))
"VER")
8.0^22.2
"BLD",11399,6)
^310
**END**
**END**

