KIDS Distribution saved on Nov 09, 2016@11:52:13
Treasury Cross-Servicing Program
**KIDS**:PRCA*4.5*301^

**INSTALL NAME**
PRCA*4.5*301
"BLD",9500,0)
PRCA*4.5*301^ACCOUNTS RECEIVABLE^0^3161109^y
"BLD",9500,1,0)
^^3^3^3150316^^^
"BLD",9500,1,1,0)
This patch contains VistA changes to support technology and
"BLD",9500,1,2,0)
business changes that are occurring with the implementation of
"BLD",9500,1,3,0)
the Treasury Cross Servicing project.
"BLD",9500,4,0)
^9.64PA^344^8
"BLD",9500,4,340,0)
340
"BLD",9500,4,340,2,0)
^9.641^340^1
"BLD",9500,4,340,2,340,0)
AR DEBTOR  (File-top level)
"BLD",9500,4,340,2,340,1,0)
^9.6411^7.05^4
"BLD",9500,4,340,2,340,1,7.02,0)
TCSP RECALL FLAG
"BLD",9500,4,340,2,340,1,7.03,0)
TCSP RECALL DATE
"BLD",9500,4,340,2,340,1,7.04,0)
TCSP RECALL REASON
"BLD",9500,4,340,2,340,1,7.05,0)
DATE DEBTOR REFERRED TO TCSP
"BLD",9500,4,340,222)
y^n^p^^^^n^^n
"BLD",9500,4,340,224)

"BLD",9500,4,342,0)
342
"BLD",9500,4,342,2,0)
^9.641^342^1
"BLD",9500,4,342,2,342,0)
AR SITE PARAMETER  (File-top level)
"BLD",9500,4,342,2,342,1,0)
^9.6411^100^1
"BLD",9500,4,342,2,342,1,100,0)
CROSS-SERVICING START DATE
"BLD",9500,4,342,222)
y^n^p^^^^n^^n
"BLD",9500,4,342,224)

"BLD",9500,4,344,0)
344
"BLD",9500,4,344,2,0)
^9.641^344.01^2
"BLD",9500,4,344,2,344,0)
AR BATCH PAYMENT  (File-top level)
"BLD",9500,4,344,2,344,1,0)
^9.6411^.19^1
"BLD",9500,4,344,2,344,1,.19,0)
RECEIPT PAY TYPE
"BLD",9500,4,344,2,344.01,0)
TRANSACTION  (sub-file)
"BLD",9500,4,344,2,344.01,1,0)
^9.6411^.09^2
"BLD",9500,4,344,2,344.01,1,.09,0)
PATIENT NAME OR BILL NUMBER
"BLD",9500,4,344,2,344.01,1,.15,0)
LOCKBOX TRANSACTION CODE
"BLD",9500,4,344,222)
y^y^p^^^^n^^n
"BLD",9500,4,344,224)

"BLD",9500,4,348.5,0)
348.5
"BLD",9500,4,348.5,222)
y^y^f^^n^^y^o^n
"BLD",9500,4,348.6,0)
348.6
"BLD",9500,4,348.6,222)
y^y^f^^n^^y^o^n
"BLD",9500,4,348.7,0)
348.7
"BLD",9500,4,348.7,222)
y^y^f^^n^^y^o^n
"BLD",9500,4,430,0)
430
"BLD",9500,4,430,2,0)
^9.641^430.0172^3
"BLD",9500,4,430,2,430,0)
ACCOUNTS RECEIVABLE  (File-top level)
"BLD",9500,4,430,2,430,1,0)
^9.6411^169.4^45
"BLD",9500,4,430,2,430,1,151,0)
DATE BILL REFERRED TO TCSP
"BLD",9500,4,430,2,430,1,152,0)
TCSP RECALL FLAG
"BLD",9500,4,430,2,430,1,153,0)
TCSP RECALL EFF. DATE
"BLD",9500,4,430,2,430,1,154,0)
TCSP RECALL REASON
"BLD",9500,4,430,2,430,1,155,0)
RECALL AMOUNT
"BLD",9500,4,430,2,430,1,157,0)
STOP TCSP REFERRAL FLAG
"BLD",9500,4,430,2,430,1,158,0)
STOP TCSP REFERRAL EFF. DATE
"BLD",9500,4,430,2,430,1,159,0)
STOP TCSP REFERRAL REASON
"BLD",9500,4,430,2,430,1,159.1,0)
STOP TCSP REFERRAL COMMENT
"BLD",9500,4,430,2,430,1,159.2,0)
TCSP CASE RECALL FLAG
"BLD",9500,4,430,2,430,1,159.3,0)
TCSP CASE RECALL EFF DATE
"BLD",9500,4,430,2,430,1,159.4,0)
TCSP CASE RECALL REASON
"BLD",9500,4,430,2,430,1,159.5,0)
TCSP GENDER
"BLD",9500,4,430,2,430,1,161,0)
ORIGINAL TCSP TIN
"BLD",9500,4,430,2,430,1,162,0)
ORIGINAL TCSP DEBTOR NAME
"BLD",9500,4,430,2,430,1,163,0)
TCSP DELINQUENCY DATE
"BLD",9500,4,430,2,430,1,164,0)
TCSP DEBTOR ADDRESS, LINE 1
"BLD",9500,4,430,2,430,1,165,0)
TCSP DEBTOR ADDRESS, LINE 2
"BLD",9500,4,430,2,430,1,166,0)
TCSP DEBTOR ADDRESS, CITY
"BLD",9500,4,430,2,430,1,167,0)
TCSP DEBTOR ADDRESS, STATE
"BLD",9500,4,430,2,430,1,168,0)
TCSP DEBTOR ZIP CODE
"BLD",9500,4,430,2,430,1,169,0)
ORIGINAL TCSP AMOUNT
"BLD",9500,4,430,2,430,1,169.1,0)
CURRENT TCSP AMOUNT
"BLD",9500,4,430,2,430,1,169.2,0)
TCSP DEBTOR PHONE
"BLD",9500,4,430,2,430,1,169.3,0)
TCSP COUNTRY CODE
"BLD",9500,4,430,2,430,1,169.4,0)
TCSP DOB
"BLD",9500,4,430,2,430,1,173,0)
DUE PROCESS NOTIFICATION FLAG
"BLD",9500,4,430,2,430,1,174,0)
DUE PROCESS REQUEST DATE
"BLD",9500,4,430,2,430,1,175,0)
DUE PROCESS LETTER PRINT DATE
"BLD",9500,4,430,2,430,1,176,0)
DUE PROCESS REFERRAL DATE
"BLD",9500,4,430,2,430,1,177,0)
DUE PROCESS ERROR DATE
"BLD",9500,4,430,2,430,1,178,0)
DUE PROCESS ERROR CODES
"BLD",9500,4,430,2,430,1,191,0)
SEND TCSP RECORD 1
"BLD",9500,4,430,2,430,1,192,0)
SEND TCSP RECORD 2
"BLD",9500,4,430,2,430,1,193,0)
SEND TCSP RECORD 2A
"BLD",9500,4,430,2,430,1,194,0)
SEND TCSP RECORD 2C
"BLD",9500,4,430,2,430,1,199.2,0)
STOP INTEREST ADMIN CALC
"BLD",9500,4,430,2,430,1,301,0)
RETURNED DATE
"BLD",9500,4,430,2,430,1,302,0)
RETURN REASON CODE
"BLD",9500,4,430,2,430,1,303,0)
COMPROMISED INDICATOR
"BLD",9500,4,430,2,430,1,304,0)
COMPROMISE AMOUNT
"BLD",9500,4,430,2,430,1,305,0)
CLOSED DATE
"BLD",9500,4,430,2,430,1,306,0)
BANKRUPTCY DATE
"BLD",9500,4,430,2,430,1,307,0)
DATE OF DEATH
"BLD",9500,4,430,2,430,1,308,0)
DATE OF DISSOLUTION
"BLD",9500,4,430,2,430.0171,0)
CS DECREASE ADJ TRANS NUMBER  (sub-file)
"BLD",9500,4,430,2,430.0171,1,0)
^9.6411^^0
"BLD",9500,4,430,2,430.0172,0)
REJECT DATE  (sub-file)
"BLD",9500,4,430,2,430.0172,1,0)
^9.6411^^0
"BLD",9500,4,430,222)
y^n^p^^^^n^^n
"BLD",9500,4,430,224)

"BLD",9500,4,430.5,0)
430.5
"BLD",9500,4,430.5,222)
y^n^f^^n^^y^o^n
"BLD",9500,4,"APDD",340,340)

"BLD",9500,4,"APDD",340,340,7.02)

"BLD",9500,4,"APDD",340,340,7.03)

"BLD",9500,4,"APDD",340,340,7.04)

"BLD",9500,4,"APDD",340,340,7.05)

"BLD",9500,4,"APDD",342,342)

"BLD",9500,4,"APDD",342,342,100)

"BLD",9500,4,"APDD",344,344)

"BLD",9500,4,"APDD",344,344,.19)

"BLD",9500,4,"APDD",344,344.01)

"BLD",9500,4,"APDD",344,344.01,.09)

"BLD",9500,4,"APDD",344,344.01,.15)

"BLD",9500,4,"APDD",430,430)

"BLD",9500,4,"APDD",430,430,151)

"BLD",9500,4,"APDD",430,430,152)

"BLD",9500,4,"APDD",430,430,153)

"BLD",9500,4,"APDD",430,430,154)

"BLD",9500,4,"APDD",430,430,155)

"BLD",9500,4,"APDD",430,430,157)

"BLD",9500,4,"APDD",430,430,158)

"BLD",9500,4,"APDD",430,430,159)

"BLD",9500,4,"APDD",430,430,159.1)

"BLD",9500,4,"APDD",430,430,159.2)

"BLD",9500,4,"APDD",430,430,159.3)

"BLD",9500,4,"APDD",430,430,159.4)

"BLD",9500,4,"APDD",430,430,159.5)

"BLD",9500,4,"APDD",430,430,161)

"BLD",9500,4,"APDD",430,430,162)

"BLD",9500,4,"APDD",430,430,163)

"BLD",9500,4,"APDD",430,430,164)

"BLD",9500,4,"APDD",430,430,165)

"BLD",9500,4,"APDD",430,430,166)

"BLD",9500,4,"APDD",430,430,167)

"BLD",9500,4,"APDD",430,430,168)

"BLD",9500,4,"APDD",430,430,169)

"BLD",9500,4,"APDD",430,430,169.1)

"BLD",9500,4,"APDD",430,430,169.2)

"BLD",9500,4,"APDD",430,430,169.3)

"BLD",9500,4,"APDD",430,430,169.4)

"BLD",9500,4,"APDD",430,430,173)

"BLD",9500,4,"APDD",430,430,174)

"BLD",9500,4,"APDD",430,430,175)

"BLD",9500,4,"APDD",430,430,176)

"BLD",9500,4,"APDD",430,430,177)

"BLD",9500,4,"APDD",430,430,178)

"BLD",9500,4,"APDD",430,430,191)

"BLD",9500,4,"APDD",430,430,192)

"BLD",9500,4,"APDD",430,430,193)

"BLD",9500,4,"APDD",430,430,194)

"BLD",9500,4,"APDD",430,430,199.2)

"BLD",9500,4,"APDD",430,430,301)

"BLD",9500,4,"APDD",430,430,302)

"BLD",9500,4,"APDD",430,430,303)

"BLD",9500,4,"APDD",430,430,304)

"BLD",9500,4,"APDD",430,430,305)

"BLD",9500,4,"APDD",430,430,306)

"BLD",9500,4,"APDD",430,430,307)

"BLD",9500,4,"APDD",430,430,308)

"BLD",9500,4,"APDD",430,430.0171)

"BLD",9500,4,"APDD",430,430.0172)

"BLD",9500,4,"B",340,340)

"BLD",9500,4,"B",342,342)

"BLD",9500,4,"B",344,344)

"BLD",9500,4,"B",348.5,348.5)

"BLD",9500,4,"B",348.6,348.6)

"BLD",9500,4,"B",348.7,348.7)

"BLD",9500,4,"B",430,430)

"BLD",9500,4,"B",430.5,430.5)

"BLD",9500,6.3)
144
"BLD",9500,"ABPKG")
n
"BLD",9500,"INID")
^n
"BLD",9500,"INIT")
ENTER^RC45301P
"BLD",9500,"KRN",0)
^9.67PA^779.2^20
"BLD",9500,"KRN",.4,0)
.4
"BLD",9500,"KRN",.4,"NM",0)
^9.68A^7^6
"BLD",9500,"KRN",.4,"NM",2,0)
TCS IAI ERROR CODES LIST    FILE #348.5^348.5^0
"BLD",9500,"KRN",.4,"NM",3,0)
PRCA PROFILE    FILE #430^430^0
"BLD",9500,"KRN",.4,"NM",4,0)
PRCA MEANS PROFILE    FILE #430^430^0
"BLD",9500,"KRN",.4,"NM",5,0)
PRCA OTHER PROFILE    FILE #430^430^0
"BLD",9500,"KRN",.4,"NM",6,0)
PRCA TCSP RECALLB    FILE #430^430^0
"BLD",9500,"KRN",.4,"NM",7,0)
PRCA TCSP RECALLD    FILE #430^430^0
"BLD",9500,"KRN",.4,"NM","B","PRCA MEANS PROFILE    FILE #430",4)

"BLD",9500,"KRN",.4,"NM","B","PRCA OTHER PROFILE    FILE #430",5)

"BLD",9500,"KRN",.4,"NM","B","PRCA PROFILE    FILE #430",3)

"BLD",9500,"KRN",.4,"NM","B","PRCA TCSP RECALLB    FILE #430",6)

"BLD",9500,"KRN",.4,"NM","B","PRCA TCSP RECALLD    FILE #430",7)

"BLD",9500,"KRN",.4,"NM","B","TCS IAI ERROR CODES LIST    FILE #348.5",2)

"BLD",9500,"KRN",.401,0)
.401
"BLD",9500,"KRN",.401,"NM",0)
^9.68A^^
"BLD",9500,"KRN",.402,0)
.402
"BLD",9500,"KRN",.402,"NM",0)
^9.68A^^
"BLD",9500,"KRN",.403,0)
.403
"BLD",9500,"KRN",.403,"NM",0)
^9.68A^^
"BLD",9500,"KRN",.5,0)
.5
"BLD",9500,"KRN",.5,"NM",0)
^9.68A^^
"BLD",9500,"KRN",.84,0)
.84
"BLD",9500,"KRN",.84,"NM",0)
^9.68A^^
"BLD",9500,"KRN",3.6,0)
3.6
"BLD",9500,"KRN",3.6,"NM",0)
^9.68A^^
"BLD",9500,"KRN",3.8,0)
3.8
"BLD",9500,"KRN",3.8,"NM",0)
^9.68A^3^3
"BLD",9500,"KRN",3.8,"NM",1,0)
TCSP^^0
"BLD",9500,"KRN",3.8,"NM",2,0)
TPC^^0
"BLD",9500,"KRN",3.8,"NM",3,0)
TPL^^0
"BLD",9500,"KRN",3.8,"NM","B","TCSP",1)

"BLD",9500,"KRN",3.8,"NM","B","TPC",2)

"BLD",9500,"KRN",3.8,"NM","B","TPL",3)

"BLD",9500,"KRN",9.2,0)
9.2
"BLD",9500,"KRN",9.2,"NM",0)
^9.68A^^
"BLD",9500,"KRN",9.8,0)
9.8
"BLD",9500,"KRN",9.8,"NM",0)
^9.68A^66^45
"BLD",9500,"KRN",9.8,"NM",1,0)
RCTCSPD^^0^B168545559
"BLD",9500,"KRN",9.8,"NM",3,0)
RCTOPD^^0^B70123756
"BLD",9500,"KRN",9.8,"NM",4,0)
PRCABJ^^0^B39614762
"BLD",9500,"KRN",9.8,"NM",5,0)
RCTCSPU^^0^B55616924
"BLD",9500,"KRN",9.8,"NM",6,0)
RCDPBPLI^^0^B57251656
"BLD",9500,"KRN",9.8,"NM",7,0)
RCDPBPLM^^0^B61916200
"BLD",9500,"KRN",9.8,"NM",8,0)
PRCADR2^^0^B16711783
"BLD",9500,"KRN",9.8,"NM",9,0)
RCDPAPLI^^0^B46722534
"BLD",9500,"KRN",9.8,"NM",10,0)
RCBEADJ^^0^B77125147
"BLD",9500,"KRN",9.8,"NM",11,0)
RCTCSP1^^0^B168147966
"BLD",9500,"KRN",9.8,"NM",13,0)
PRCAAPR1^^0^B45827636
"BLD",9500,"KRN",9.8,"NM",14,0)
PRCAATR^^0^B22771269
"BLD",9500,"KRN",9.8,"NM",15,0)
PRCAPRO^^0^B14760379
"BLD",9500,"KRN",9.8,"NM",16,0)
RCTCSPRS^^0^B53928265
"BLD",9500,"KRN",9.8,"NM",17,0)
RCBECHGS^^0^B14080962
"BLD",9500,"KRN",9.8,"NM",18,0)
RCTCSP2^^0^B87861761
"BLD",9500,"KRN",9.8,"NM",19,0)
PRCADR^^0^B17506368
"BLD",9500,"KRN",9.8,"NM",20,0)
RCCPCPS^^0^B80898915
"BLD",9500,"KRN",9.8,"NM",21,0)
PRCAGT^^0^B22272453
"BLD",9500,"KRN",9.8,"NM",22,0)
PRCAGU^^0^B12887006
"BLD",9500,"KRN",9.8,"NM",26,0)
RCTCSJS^^0^B200131768
"BLD",9500,"KRN",9.8,"NM",27,0)
RCTCSJS1^^0^B57381357
"BLD",9500,"KRN",9.8,"NM",28,0)
RCTCSJR^^0^B113325699
"BLD",9500,"KRN",9.8,"NM",36,0)
PRCAGDR^^0^B14896021
"BLD",9500,"KRN",9.8,"NM",38,0)
RCDPURED^^0^B50615527
"BLD",9500,"KRN",9.8,"NM",41,0)
RCTCSP3^^0^B79802534
"BLD",9500,"KRN",9.8,"NM",42,0)
RCTCSP3S^^0^B30705650
"BLD",9500,"KRN",9.8,"NM",43,0)
RC45301P^^0^B1337108
"BLD",9500,"KRN",9.8,"NM",44,0)
RCDPURET^^0^B75859214
"BLD",9500,"KRN",9.8,"NM",45,0)
RCDPRPL3^^0^B81971704
"BLD",9500,"KRN",9.8,"NM",46,0)
RCDPXPAY^^0^B65069620
"BLD",9500,"KRN",9.8,"NM",47,0)
PRCAGS^^0^B22454707
"BLD",9500,"KRN",9.8,"NM",48,0)
PRCAGST1^^0^B9484383
"BLD",9500,"KRN",9.8,"NM",49,0)
PRCAREP^^0^B13936976
"BLD",9500,"KRN",9.8,"NM",50,0)
RCWROFF^^0^B38468960
"BLD",9500,"KRN",9.8,"NM",51,0)
RCWROFF1^^0^B35416905
"BLD",9500,"KRN",9.8,"NM",52,0)
PRCAEXM^^0^B13617982
"BLD",9500,"KRN",9.8,"NM",53,0)
RCBEUTR1^^0^B36268452
"BLD",9500,"KRN",9.8,"NM",54,0)
PRCASER1^^0^B16741481
"BLD",9500,"KRN",9.8,"NM",60,0)
RCBEPAY^^0^B26246409
"BLD",9500,"KRN",9.8,"NM",61,0)
RCBEPAYF^^0^B49084627
"BLD",9500,"KRN",9.8,"NM",62,0)
RCDPXPAP^^0^B54412655
"BLD",9500,"KRN",9.8,"NM",64,0)
RCBEIB^^0^B41614858
"BLD",9500,"KRN",9.8,"NM",65,0)
RCDPLPL3^^0^B54165729
"BLD",9500,"KRN",9.8,"NM",66,0)
RCDPLPL4^^0^B238259256
"BLD",9500,"KRN",9.8,"NM","B","PRCAAPR1",13)

"BLD",9500,"KRN",9.8,"NM","B","PRCAATR",14)

"BLD",9500,"KRN",9.8,"NM","B","PRCABJ",4)

"BLD",9500,"KRN",9.8,"NM","B","PRCADR",19)

"BLD",9500,"KRN",9.8,"NM","B","PRCADR2",8)

"BLD",9500,"KRN",9.8,"NM","B","PRCAEXM",52)

"BLD",9500,"KRN",9.8,"NM","B","PRCAGDR",36)

"BLD",9500,"KRN",9.8,"NM","B","PRCAGS",47)

"BLD",9500,"KRN",9.8,"NM","B","PRCAGST1",48)

"BLD",9500,"KRN",9.8,"NM","B","PRCAGT",21)

"BLD",9500,"KRN",9.8,"NM","B","PRCAGU",22)

"BLD",9500,"KRN",9.8,"NM","B","PRCAPRO",15)

"BLD",9500,"KRN",9.8,"NM","B","PRCAREP",49)

"BLD",9500,"KRN",9.8,"NM","B","PRCASER1",54)

"BLD",9500,"KRN",9.8,"NM","B","RC45301P",43)

"BLD",9500,"KRN",9.8,"NM","B","RCBEADJ",10)

"BLD",9500,"KRN",9.8,"NM","B","RCBECHGS",17)

"BLD",9500,"KRN",9.8,"NM","B","RCBEIB",64)

"BLD",9500,"KRN",9.8,"NM","B","RCBEPAY",60)

"BLD",9500,"KRN",9.8,"NM","B","RCBEPAYF",61)

"BLD",9500,"KRN",9.8,"NM","B","RCBEUTR1",53)

"BLD",9500,"KRN",9.8,"NM","B","RCCPCPS",20)

"BLD",9500,"KRN",9.8,"NM","B","RCDPAPLI",9)

"BLD",9500,"KRN",9.8,"NM","B","RCDPBPLI",6)

"BLD",9500,"KRN",9.8,"NM","B","RCDPBPLM",7)

"BLD",9500,"KRN",9.8,"NM","B","RCDPLPL3",65)

"BLD",9500,"KRN",9.8,"NM","B","RCDPLPL4",66)

"BLD",9500,"KRN",9.8,"NM","B","RCDPRPL3",45)

"BLD",9500,"KRN",9.8,"NM","B","RCDPURED",38)

"BLD",9500,"KRN",9.8,"NM","B","RCDPURET",44)

"BLD",9500,"KRN",9.8,"NM","B","RCDPXPAP",62)

"BLD",9500,"KRN",9.8,"NM","B","RCDPXPAY",46)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSJR",28)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSJS",26)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSJS1",27)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSP1",11)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSP2",18)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSP3",41)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSP3S",42)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSPD",1)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSPRS",16)

"BLD",9500,"KRN",9.8,"NM","B","RCTCSPU",5)

"BLD",9500,"KRN",9.8,"NM","B","RCTOPD",3)

"BLD",9500,"KRN",9.8,"NM","B","RCWROFF",50)

"BLD",9500,"KRN",9.8,"NM","B","RCWROFF1",51)

"BLD",9500,"KRN",19,0)
19
"BLD",9500,"KRN",19,"NM",0)
^9.68A^18^14
"BLD",9500,"KRN",19,"NM",2,0)
RCTCSP STOP^^0
"BLD",9500,"KRN",19,"NM",3,0)
RCTCSP RECALLB^^0
"BLD",9500,"KRN",19,"NM",4,0)
RCTCSP RECALLD^^0
"BLD",9500,"KRN",19,"NM",5,0)
RCTCSP MENU^^0
"BLD",9500,"KRN",19,"NM",6,0)
RCTCSP BILL REPORT^^0
"BLD",9500,"KRN",19,"NM",7,0)
RCTCSP RECALL REPORT^^0
"BLD",9500,"KRN",19,"NM",8,0)
RCTCSP REPORT^^0
"BLD",9500,"KRN",19,"NM",10,0)
RCTCSPR SERVER^^0
"BLD",9500,"KRN",19,"NM",12,0)
RCTCSP RECONCIL REPORT^^0
"BLD",9500,"KRN",19,"NM",14,0)
RCTCSP IAI ERROR CODES LIST^^0
"BLD",9500,"KRN",19,"NM",15,0)
RCTCSP REJECT REPORT^^0
"BLD",9500,"KRN",19,"NM",16,0)
RCTCSP REJ SERVER^^0
"BLD",9500,"KRN",19,"NM",17,0)
PRCAF SUPERVISOR MENU^^2
"BLD",9500,"KRN",19,"NM",18,0)
RCTCSPD SERVER^^0
"BLD",9500,"KRN",19,"NM","B","PRCAF SUPERVISOR MENU",17)

"BLD",9500,"KRN",19,"NM","B","RCTCSP BILL REPORT",6)

"BLD",9500,"KRN",19,"NM","B","RCTCSP IAI ERROR CODES LIST",14)

"BLD",9500,"KRN",19,"NM","B","RCTCSP MENU",5)

"BLD",9500,"KRN",19,"NM","B","RCTCSP RECALL REPORT",7)

"BLD",9500,"KRN",19,"NM","B","RCTCSP RECALLB",3)

"BLD",9500,"KRN",19,"NM","B","RCTCSP RECALLD",4)

"BLD",9500,"KRN",19,"NM","B","RCTCSP RECONCIL REPORT",12)

"BLD",9500,"KRN",19,"NM","B","RCTCSP REJ SERVER",16)

"BLD",9500,"KRN",19,"NM","B","RCTCSP REJECT REPORT",15)

"BLD",9500,"KRN",19,"NM","B","RCTCSP REPORT",8)

"BLD",9500,"KRN",19,"NM","B","RCTCSP STOP",2)

"BLD",9500,"KRN",19,"NM","B","RCTCSPD SERVER",18)

"BLD",9500,"KRN",19,"NM","B","RCTCSPR SERVER",10)

"BLD",9500,"KRN",19.1,0)
19.1
"BLD",9500,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",9500,"KRN",101,0)
101
"BLD",9500,"KRN",101,"NM",0)
^9.68A^^
"BLD",9500,"KRN",409.61,0)
409.61
"BLD",9500,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",9500,"KRN",771,0)
771
"BLD",9500,"KRN",771,"NM",0)
^9.68A^^
"BLD",9500,"KRN",779.2,0)
779.2
"BLD",9500,"KRN",779.2,"NM",0)
^9.68A^^
"BLD",9500,"KRN",870,0)
870
"BLD",9500,"KRN",870,"NM",0)
^9.68A^^
"BLD",9500,"KRN",8989.51,0)
8989.51
"BLD",9500,"KRN",8989.51,"NM",0)
^9.68A^^
"BLD",9500,"KRN",8989.52,0)
8989.52
"BLD",9500,"KRN",8989.52,"NM",0)
^9.68A^^
"BLD",9500,"KRN",8994,0)
8994
"BLD",9500,"KRN",8994,"NM",0)
^9.68A^^
"BLD",9500,"KRN","B",.4,.4)

"BLD",9500,"KRN","B",.401,.401)

"BLD",9500,"KRN","B",.402,.402)

"BLD",9500,"KRN","B",.403,.403)

"BLD",9500,"KRN","B",.5,.5)

"BLD",9500,"KRN","B",.84,.84)

"BLD",9500,"KRN","B",3.6,3.6)

"BLD",9500,"KRN","B",3.8,3.8)

"BLD",9500,"KRN","B",9.2,9.2)

"BLD",9500,"KRN","B",9.8,9.8)

"BLD",9500,"KRN","B",19,19)

"BLD",9500,"KRN","B",19.1,19.1)

"BLD",9500,"KRN","B",101,101)

"BLD",9500,"KRN","B",409.61,409.61)

"BLD",9500,"KRN","B",771,771)

"BLD",9500,"KRN","B",779.2,779.2)

"BLD",9500,"KRN","B",870,870)

"BLD",9500,"KRN","B",8989.51,8989.51)

"BLD",9500,"KRN","B",8989.52,8989.52)

"BLD",9500,"KRN","B",8994,8994)

"BLD",9500,"QDEF")
^^^^^^^^YES
"BLD",9500,"QUES",0)
^9.62^^
"BLD",9500,"REQB",0)
^9.611^27^10
"BLD",9500,"REQB",1,0)
PRCA*4.5*229^2
"BLD",9500,"REQB",3,0)
PRCA*4.5*263^2
"BLD",9500,"REQB",9,0)
PRCA*4.5*265^2
"BLD",9500,"REQB",13,0)
PRCA*4.5*249^2
"BLD",9500,"REQB",18,0)
PRCA*4.5*270^2
"BLD",9500,"REQB",23,0)
PRCA*4.5*296^2
"BLD",9500,"REQB",24,0)
PRCA*4.5*304^2
"BLD",9500,"REQB",25,0)
PRCA*4.5*303^2
"BLD",9500,"REQB",26,0)
PRCA*4.5*309^2
"BLD",9500,"REQB",27,0)
PRCA*4.5*298^2
"BLD",9500,"REQB","B","PRCA*4.5*229",1)

"BLD",9500,"REQB","B","PRCA*4.5*249",13)

"BLD",9500,"REQB","B","PRCA*4.5*263",3)

"BLD",9500,"REQB","B","PRCA*4.5*265",9)

"BLD",9500,"REQB","B","PRCA*4.5*270",18)

"BLD",9500,"REQB","B","PRCA*4.5*296",23)

"BLD",9500,"REQB","B","PRCA*4.5*298",27)

"BLD",9500,"REQB","B","PRCA*4.5*303",25)

"BLD",9500,"REQB","B","PRCA*4.5*304",24)

"BLD",9500,"REQB","B","PRCA*4.5*309",26)

"DATA",348.5,1,0)
01^FAST Code/ ALC/ Station^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,1,1)
Cannot be blank or is invalid.
"DATA",348.5,2,0)
02^ALC^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,2,1)
ALC of input record does not Match file ALC.
"DATA",348.5,3,0)
03^DMS Processing Code^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,3,1)
DMS Processing Code cannot be blank or is invalid.
"DATA",348.5,4,0)
04^Agency Debt ID^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,4,1)
Invalid agency debt id or agency debt id not specified.
"DATA",348.5,5,0)
05^Debt Type^1
"DATA",348.5,5,1)
Debt Type does not exist in Agency Profile or invalid Debt Type code.
"DATA",348.5,6,0)
06^Debt Type^1
"DATA",348.5,6,1)
Cannot reset debt type.
"DATA",348.5,7,0)
07^Debtor TIN^2,2C,4,6
"DATA",348.5,7,1)
Invalid TIN number or TIN not specified.
"DATA",348.5,8,0)
08^Debtor TIN^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,8,1)
Cannot reset TIN, change TIN, or TIN does not match existing debt number.
"DATA",348.5,9,0)
09^Debtor TIN^2
"DATA",348.5,9,1)
Invalid TIN for a RT 2 Action Code Add record.
"DATA",348.5,10,0)
10^Debtor TIN^2
"DATA",348.5,10,1)
Debtor already in debtor table.
"DATA",348.5,11,0)
11^Debtor TIN^2
"DATA",348.5,11,1)
This is a Joint & Several debt.
"DATA",348.5,12,0)
12^Debtor TIN^2
"DATA",348.5,12,1)
If Debtor TIN is provided, a valid TIN Type must be Entered.
"DATA",348.5,13,0)
13^Debtor TIN^2,2C,4,6
"DATA",348.5,13,1)
Debtor TIN must be Numeric.
"DATA",348.5,14,0)
14^Referred Debt Balance^1
"DATA",348.5,14,1)
Delinquent amount not numeric or amount < $25 limit.
"DATA",348.5,15,0)
15^Referred Debt Balance^1
"DATA",348.5,15,1)
For adjust action, amount cannot be zero.
"DATA",348.5,16,0)
16^Referred Debt Balance^1
"DATA",348.5,16,1)
Cannot decrease a debt with existing current balance of zero.
"DATA",348.5,17,0)
17^Referred Debt Balance^1
"DATA",348.5,17,1)
For refund record, there is no offset payment found for the offset year / date, or year / date is invalid.
"DATA",348.5,18,0)
18^Referred Debt Balance^1
"DATA",348.5,18,1)
Refund record amount in excess of offset.
"DATA",348.5,19,0)
19^Referred Debt Balance^1
"DATA",348.5,19,1)
For refund reversal record, there is no offset payment found for the offset year / date, or year / date is invalid.
"DATA",348.5,20,0)
20^Referred Debt Balance^1
"DATA",348.5,20,1)
Amount of refund reversal record exceeds amount of previous refund.
"DATA",348.5,21,0)
21^Referred Debt Balance^1
"DATA",348.5,21,1)
Referred Debt Balance must be Equal to the Sum of Initial Principal, Initial Interest, Initial Admin Costs, and Initial Penalty.
"DATA",348.5,22,0)
22^Referred Debt Balance^1
"DATA",348.5,22,1)
Referred Debt Balance must be Numeric.
"DATA",348.5,23,0)
23^Referred Debt Balance^1
"DATA",348.5,23,1)
Referred Debt Balance is Required.
"DATA",348.5,24,0)
24^Debt Judgment^2
"DATA",348.5,24,1)
Invalid Judgment Debt value.
"DATA",348.5,25,0)
25^Delinquency Date^1
"DATA",348.5,25,1)
Invalid date for Delinquent Date, not numeric or not specified.
"DATA",348.5,26,0)
26^Delinquency Date^1
"DATA",348.5,26,1)
Cannot reset Delinquent Date.
"DATA",348.5,27,0)
27^Delinquency Date^1
"DATA",348.5,27,1)
Delinquent date cannot be > (later than) processing date.
"DATA",348.5,28,0)
28^Delinquency Date^1
"DATA",348.5,28,1)
Date error (incorrect format) when adding or updating debt record.
"DATA",348.5,29,0)
29^Delinquency Date^1
"DATA",348.5,29,1)
Date error when updating Debt record.
"DATA",348.5,30,0)
30^Delinquency Date^1
"DATA",348.5,30,1)
Date Delinquency Began is more than 10 years prior to current date
"DATA",348.5,31,0)
31^Individual or Business^2
"DATA",348.5,31,1)
Invalid Individual/Business Indicator or not specified.
"DATA",348.5,32,0)
32^Individual or Business^2
"DATA",348.5,32,1)
Cannot reset Business/individual indicator.
"DATA",348.5,33,0)
33^Debtor Name Last or Business^2
"DATA",348.5,33,1)
Debtor Last Name/Business cannot be blank.
"DATA",348.5,34,0)
34^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,34,1)
N/A
"DATA",348.5,35,0)
35^Debtor Name Last or Business^2
"DATA",348.5,35,1)
Only present when changing last name.
"DATA",348.5,36,0)
36^Debtor Name Last or Business, Debtor Name First, Debtor Name Middle ^2
"DATA",348.5,36,1)
The debtor is not in Debtor table.
"DATA",348.5,37,0)
37^Contact Address 1^2C
"DATA",348.5,37,1)
Contact address line 1 cannot be blank.
"DATA",348.5,38,0)
38^Contact Address 1^2C
"DATA",348.5,38,1)
Cannot reset Contact address line 1.
"DATA",348.5,39,0)
39^Contact City^2C
"DATA",348.5,39,1)
Contact city cannot be blank.
"DATA",348.5,40,0)
40^Contact City^2C
"DATA",348.5,40,1)
Cannot reset Contact city.
"DATA",348.5,41,0)
41^Contact Country Name, Contact State^2C
"DATA",348.5,41,1)
Invalid contact state code or cannot be blank unless country code field is completed and not 'US'.
"DATA",348.5,42,0)
42^Contact Country Name, Contact  State^2C
"DATA",348.5,42,1)
If Country Code is xx (completed and not 'US' on debt record or this update record), State Code must be blank.
"DATA",348.5,43,0)
43^Contact State^2C
"DATA",348.5,43,1)
Contact state code can only be reset when country code field is completed.
"DATA",348.5,44,0)
44^Contact Country Name^2C
"DATA",348.5,44,1)
Invalid Contact Country Code or code is not valid since state code is completed on debt record or this update record and country code is not 'US'.
"DATA",348.5,45,0)
45^Contact Country Name^2C
"DATA",348.5,45,1)
Invalid Contact Country Code or code is not valid since state code is completed and country code is not 'US'. 
"DATA",348.5,46,0)
46^Contact Country Name^2C
"DATA",348.5,46,1)
If Contact Country Code is xx (completed and not 'US'), Alias State Code must be blank.
"DATA",348.5,47,0)
47^Contact Zip Code^2C
"DATA",348.5,47,1)
The first 5 characters of zip code must be numeric if 'US' address or cannot be blank. If country code field is completed and not 'US' and state code field is blank, the first five characters must be completed or zeros.
"DATA",348.5,48,0)
48^Contact Zip Code^2C
"DATA",348.5,48,1)
Cannot reset contact Zip Code unless country code field is completed and not 'US'.
"DATA",348.5,49,0)
49^Debt Origination Date^1
"DATA",348.5,49,1)
Invalid date for Date Debt Originally Opened, not numeric or not specified.
"DATA",348.5,50,0)
50^Debt Origination Date^1
"DATA",348.5,50,1)
Date error (incorrect format) when adding or updating date Debt Originally Opened information.
"DATA",348.5,51,0)
51^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,51,1)
N/A
"DATA",348.5,52,0)
52^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,52,1)
N/A
"DATA",348.5,53,0)
53
"DATA",348.5,54,0)
54
"DATA",348.5,55,0)
55
"DATA",348.5,56,0)
56
"DATA",348.5,57,0)
57^Debtor Alias Last or Business Name^4
"DATA",348.5,57,1)
Alias Last name cannot be blank.
"DATA",348.5,58,0)
58^Debtor Alias Last or Business Name^4
"DATA",348.5,58,1)
Cannot reset Alias last name.
"DATA",348.5,59,0)
59^Record Type, Action Code^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,59,1)
Invalid record type/record action.
"DATA",348.5,60,0)
60^Record Type
"DATA",348.5,60,1)
Invalid record type for Add Action.
"DATA",348.5,61,0)
61^Record Type
"DATA",348.5,61,1)
Invalid record type for Update Action.
"DATA",348.5,62,0)
62^Record Type^2,2A,2B,2C, 2D,2E,3,4
"DATA",348.5,62,1)
Invalid record type for Delete Action.
"DATA",348.5,63,0)
63^Record Type^2,2A,2B,2C, 2D,2E,3,4,6
"DATA",348.5,63,1)
Invalid record type for Adjust Action.
"DATA",348.5,64,0)
64^Entire Record Type 1^1
"DATA",348.5,64,1)
Duplicate Debt record found in database for 'Add'.
"DATA",348.5,65,0)
65^Entire Record Type 1^1
"DATA",348.5,65,1)
General error occurred when adding or updating debt record. Base debt record not found
"DATA",348.5,66,0)
66^Entire Record Type 2^2
"DATA",348.5,66,1)
Debt record not found for adding debtor information. 
"DATA",348.5,67,0)
67^Entire Record Type 4^4
"DATA",348.5,67,1)
Duplicate Debt Alias found in database for 'Add'.
"DATA",348.5,68,0)
68^Entire Record Type 4^4
"DATA",348.5,68,1)
General error occurred when adding or updating debt record. Base debt record not found.
"DATA",348.5,69,0)
69^Entire Record Types^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,69,1)
Debt record not found in database for update. Missing contact data for debtor.
"DATA",348.5,70,0)
70^Entire Record Type 4^4
"DATA",348.5,70,1)
Debt Alias record not found in database for update.
"DATA",348.5,71,0)
71^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,71,1)
N/A
"DATA",348.5,72,0)
72^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,72,1)
N/A
"DATA",348.5,73,0)
73^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,73,1)
N/A
"DATA",348.5,74,0)
74^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,74,1)
N/A
"DATA",348.5,75,0)
75^NOT USED FOR CROSS- SERVICING^X
"DATA",348.5,75,1)
N/A
"DATA",348.5,76,0)
76^Original Amt of Debt^1
"DATA",348.5,76,1)
Original Amount not numeric or amount < $25 limit or not specified.
"DATA",348.5,77,0)
77^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,77,1)
N/A
"DATA",348.5,78,0)
78^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,78,1)
N/A
"DATA",348.5,79,0)
79^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,79,1)
N/A
"DATA",348.5,80,0)
80^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,80,1)
N/A
"DATA",348.5,81,0)
81^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,81,1)
N/A
"DATA",348.5,82,0)
82^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,82,1)
N/A
"DATA",348.5,83,0)
83^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,83,1)
N/A
"DATA",348.5,84,0)
84^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,84,1)
N/A
"DATA",348.5,85,0)
85^Debtor Name Middle^2
"DATA",348.5,85,1)
Middle initial not allowed for business debts.
"DATA",348.5,86,0)
86^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,86,1)
N/A
"DATA",348.5,87,0)
87^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,87,1)
N/A
"DATA",348.5,88,0)
88^Bypass Indicators^6
"DATA",348.5,88,1)
Bypass code is invalid or does not exist.
"DATA",348.5,89,0)
89^Bypass Indicators^6
"DATA",348.5,89,1)
Bypass code already in place for this debt.
"DATA",348.5,90,0)
90^Bypass Indicators^6
"DATA",348.5,90,1)
Bypass code not found for this debt. 
"DATA",348.5,91,0)
91^Bypass Indicators^6
"DATA",348.5,91,1)
Bypass code indicator is full, cannot add another bypass.
"DATA",348.5,92,0)
92^Bypass Indicators^6
"DATA",348.5,92,1)
Default debt load bypass indicator exceed limit of 10.
"DATA",348.5,93,0)
93^Bypass Indicators^6
"DATA",348.5,93,1)
Similar or duplicate Bypass Indicator already exists for this debt.
"DATA",348.5,94,0)
94^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,94,1)
N/A
"DATA",348.5,95,0)
95^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,95,1)
N/A
"DATA",348.5,96,0)
96^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,96,1)
N/A
"DATA",348.5,97,0)
97^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,97,1)
N/A
"DATA",348.5,98,0)
98^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,98,1)
N/A
"DATA",348.5,99,0)
99^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,99,1)
N/A
"DATA",348.5,100,0)
1A^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,100,1)
N/A
"DATA",348.5,101,0)
1B^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,101,1)
N/A
"DATA",348.5,102,0)
1C^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,102,1)
N/A
"DATA",348.5,103,0)
1D^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,103,1)
N/A
"DATA",348.5,104,0)
1E^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,104,1)
N/A
"DATA",348.5,105,0)
1F^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,105,1)
N/A
"DATA",348.5,106,0)
1G^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,106,1)
N/A
"DATA",348.5,107,0)
1H^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,107,1)
N/A
"DATA",348.5,108,0)
1I^Individual/Joint Several Indicator^1
"DATA",348.5,108,1)
Individual/Joint Several status indicator is invalid.
"DATA",348.5,109,0)
1J^Individual/Joint Several Indicator^1
"DATA",348.5,109,1)
Cannot reset to a regular debt.
"DATA",348.5,110,0)
1K^Individual/Joint Several Indicator^1
"DATA",348.5,110,1)
This is the last debtor for this debt.
"DATA",348.5,111,0)
1L^Individual/Joint Several Indicator^1
"DATA",348.5,111,1)
Cannot add Debtor to non-active Joint & Several Debt.
"DATA",348.5,112,0)
1M^Individual/Joint Several Indicator^1
"DATA",348.5,112,1)
Individual/Joint Several Ind is Required.
"DATA",348.5,113,0)
1N^Admin Debt Class^1
"DATA",348.5,113,1)
Admin Debt Class is Required if Debt Type = "A".
"DATA",348.5,114,0)
1O^Admin Debt Class^1
"DATA",348.5,114,1)
Admin Debt Class must be Null if Debt Type = "L".
"DATA",348.5,115,0)
1P^Admin Debt Class^1
"DATA",348.5,115,1)
Invalid Admin Debt Classification Code.
"DATA",348.5,116,0)
1Q^Consumer or Commercial^1
"DATA",348.5,116,1)
Invalid Consumer/Commercial Code.
"DATA",348.5,117,0)
1R^Consumer or Commercial^1
"DATA",348.5,117,1)
Consumer/Commercial is Required.
"DATA",348.5,118,0)
1S^Initial Principal^1
"DATA",348.5,118,1)
Initial Principal must be Numeric.
"DATA",348.5,119,0)
1T^Initial Interest^1
"DATA",348.5,119,1)
Initial Interest must be Numeric.
"DATA",348.5,120,0)
1U^Initial Admin Costs^1
"DATA",348.5,120,1)
Initial Admin Costs must be Numeric.
"DATA",348.5,121,0)
1V^Initial Penalty^1
"DATA",348.5,121,1)
Initial Penalty must be Numeric.
"DATA",348.5,122,0)
1W^Initial Principal, Initial Interest, Initial Admin Costs, Initial Penalty^1
"DATA",348.5,122,1)
One of these Referred Balance Components is Required.
"DATA",348.5,123,0)
1X^Initial Interest Type^1
"DATA",348.5,123,1)
Interest code is not allowed when agency program indicates FedDebt will not accrue interest
"DATA",348.5,124,0)
1Y^Interest Rate^1
"DATA",348.5,124,1)
Interest Rate is required if Initial Int Type = "A" / "F".
"DATA",348.5,125,0)
1Z^Interest Rate^1
"DATA",348.5,125,1)
Interest rate is not allowed when agency program indicates FedDebt will not accrue interest
"DATA",348.5,126,0)
2A^Interest Rate^1
"DATA",348.5,126,1)
Interest Rate must be Null if Initial Int Type = "C".
"DATA",348.5,127,0)
2B^Interest Rate^1
"DATA",348.5,127,1)
Interest Rate must be Between 0.00 And 100.00.
"DATA",348.5,128,0)
2C^Interest Rate^1
"DATA",348.5,128,1)
Interest Rate must be Numeric.
"DATA",348.5,129,0)
2D^Penalty Rate^1
"DATA",348.5,129,1)
Penalty Rate is Required if Penalty is Accrued.
"DATA",348.5,130,0)
2E^Penalty Rate^1
"DATA",348.5,130,1)
Penalty Rate must be Null if Penalty is not Accrued.
"DATA",348.5,131,0)
2F^Penalty Rate^1
"DATA",348.5,131,1)
Penalty Rate must be Between 0.00 And 100.00
"DATA",348.5,132,0)
2G^Penalty Rate^1
"DATA",348.5,132,1)
Penalty Rate must be Numeric.
"DATA",348.5,133,0)
2H^Last Interest Calc Date^1
"DATA",348.5,133,1)
Date is Required if Interest Rate is Entered or profile indicates required
"DATA",348.5,134,0)
2I^Last Interest Calc Date^1
"DATA",348.5,134,1)
Last Interest Calc Date must be Null if Interest Rate is Not Entered.
"DATA",348.5,135,0)
2J^Last Interest Calc Date^1
"DATA",348.5,135,1)
Last Interest Calc Date must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,136,0)
2K^Last Interest Calc Date^1
"DATA",348.5,136,1)
Last Interest Calc Date must be less than or equal to the System Date.
"DATA",348.5,137,0)
2L^Last Penalty Calc Date^1
"DATA",348.5,137,1)
Date is Required if Pen Rate is Entered or profile indicates required
"DATA",348.5,138,0)
2M^Last Penalty Calc Date^1
"DATA",348.5,138,1)
Last Penalty Calc Date must be Null if Penalty Rate is Not Entered.
"DATA",348.5,139,0)
2N^Last Penalty Calc Date^1
"DATA",348.5,139,1)
Last Penalty Calc Date must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,140,0)
2O^Last Penalty Calc Date^1
"DATA",348.5,140,1)
Last Penalty Calc Date must be less than or equal to the System Date.
"DATA",348.5,141,0)
2P^Last PMT Amt Prior to Ref^1
"DATA",348.5,141,1)
Last PMT Amt Prior to Ref must be Numeric.
"DATA",348.5,142,0)
2Q^Last PMT Date Prior to Ref^1
"DATA",348.5,142,1)
Last PMT Date Prior to Ref must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,143,0)
2R^Last PMT Date Prior to Ref^1
"DATA",348.5,143,1)
Last PMT Date Prior to Ref must be less than or equal to the System Date.
"DATA",348.5,144,0)
2S^SOL Expiration Date^1
"DATA",348.5,144,1)
SOL Expiration Date is Required.
"DATA",348.5,145,0)
2T^SOL Expiration Date^1
"DATA",348.5,145,1)
SOL Expiration Date must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,146,0)
2U^Guarantor Exists^1
"DATA",348.5,146,1)
Invalid 'Guarantor Exists' Code.
"DATA",348.5,147,0)
2V^Foreclosure Indicator^1
"DATA",348.5,147,1)
Invalid Foreclosure Indicator Code.
"DATA",348.5,148,0)
2X^Written Off^1
"DATA",348.5,148,1)
Invalid Written Off Code.
"DATA",348.5,149,0)
2Y^Debtor TIN Type^2
"DATA",348.5,149,1)
If Debtor TIN Type is provided, a valid TIN must be Entered.
"DATA",348.5,150,0)
2Z^Debtor TIN Type^2
"DATA",348.5,150,1)
Invalid Debtor TIN Type Code.
"DATA",348.5,151,0)
3A^Debtor Generation^2A
"DATA",348.5,151,1)
Invalid Debtor Generation Code.
"DATA",348.5,152,0)
3B^Debtor Gender^2A
"DATA",348.5,152,1)
Invalid Debtor Gender Code.
"DATA",348.5,153,0)
3C^Date of Birth^2A
"DATA",348.5,153,1)
Date of Birth must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,154,0)
3D^Date of Birth^2A
"DATA",348.5,154,1)
Date of Birth must be less than the System Date.
"DATA",348.5,155,0)
3E^Agency Debtor ID^2,2A,2B,2C, 2D,2E,3, 4,5A,5B,6
"DATA",348.5,155,1)
Agency Debtor ID is Required.
"DATA",348.5,156,0)
3F^Judgment Date^1
"DATA",348.5,156,1)
Judgment Date must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,157,0)
3G^Relationship to Primary^3
"DATA",348.5,157,1)
Invalid Relationship to Primary Code.
"DATA",348.5,158,0)
3H^Relationship to Primary^3
"DATA",348.5,158,1)
Relationship to Primary is Required.
"DATA",348.5,159,0)
3I^Contact Type to Rcv DL^3
"DATA",348.5,159,1)
Invalid Contact Type to Receive Demand Letter Code.
"DATA",348.5,160,0)
3J^Contact Type to Rcv DL^3
"DATA",348.5,160,1)
Contact Type to Receive Demand Letter is Required.
"DATA",348.5,161,0)
3K^Contact Type^2C
"DATA",348.5,161,1)
Invalid Contact Type Code.
"DATA",348.5,162,0)
3L^Contact Type^2C
"DATA",348.5,162,1)
Contact Type is Required. Contact Type is missing - see Error Code 3K.
"DATA",348.5,163,0)
3M^Contact Free Form Name^2C
"DATA",348.5,163,1)
Contact Free Form Name cannot be blank.
"DATA",348.5,164,0)
3N^Contact Title^2C
"DATA",348.5,164,1)
Invalid Contact Title
"DATA",348.5,165,0)
3O^Contact Primary Name^2C
"DATA",348.5,165,1)
Contact Primary Name cannot be blank
"DATA",348.5,166,0)
3P^Contact Phone Type^2C
"DATA",348.5,166,1)
Invalid Contact Phone Type Code.
"DATA",348.5,167,0)
3Q^Contact Phone^2C
"DATA",348.5,167,1)
Contact Phone must be Numeric.
"DATA",348.5,168,0)
3R^Contact Phone Ext^2C
"DATA",348.5,168,1)
Contact Phone Ext must be Numeric.
"DATA",348.5,169,0)
3S^Contact Primary Phone^2C
"DATA",348.5,169,1)
Invalid Contact Primary Phone Code.
"DATA",348.5,170,0)
3T^Contact Primary Address^2C
"DATA",348.5,170,1)
Invalid Contact Primary Address code
"DATA",348.5,171,0)
3U^Contact Email Address^2C
"DATA",348.5,171,1)
Invalid Contact Email Address
"DATA",348.5,172,0)
3V^Contact Primary Email Address^2C
"DATA",348.5,172,1)
Invalid Contact Primary Email Code.
"DATA",348.5,173,0)
3W^Salary^2E
"DATA",348.5,173,1)
Salary must be Numeric.
"DATA",348.5,174,0)
3X^Salary Cycle^2E
"DATA",348.5,174,1)
Invalid Salary Cycle Code.
"DATA",348.5,175,0)
3Y^Salary Gross or Net^2E
"DATA",348.5,175,1)
Invalid Salary Gross or Net Code.
"DATA",348.5,176,0)
3Z^Fed Civilian Employee^2A
"DATA",348.5,176,1)
Invalid Fed Civilian Employee Code.
"DATA",348.5,177,0)
4A^Fed Military Employee^2A
"DATA",348.5,177,1)
Invalid Fed Military Employee Code.
"DATA",348.5,178,0)
4B^Last Debtor Contact Date^3
"DATA",348.5,178,1)
Last Debtor Contact Date must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,179,0)
4C^Last Debtor Contact Date^3
"DATA",348.5,179,1)
Last Debtor Contact Date must be less than or equal to the System Date.
"DATA",348.5,180,0)
4D^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,180,1)
N/A
"DATA",348.5,181,0)
4E^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,181,1)
N/A
"DATA",348.5,182,0)
4F^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,182,1)
N/A
"DATA",348.5,183,0)
4G^Business Debtor Type^2B
"DATA",348.5,183,1)
Invalid Business Debtor Type Code.
"DATA",348.5,184,0)
4H^Business Type^2B
"DATA",348.5,184,1)
Invalid Business Type Code.
"DATA",348.5,185,0)
4I^Date of Incorporation^2B
"DATA",348.5,185,1)
Date of Incorporation must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,186,0)
4J^State of Incorporation^2B
"DATA",348.5,186,1)
Invalid State of Incorporation Code.
"DATA",348.5,187,0)
4K^Federal Contractor Indicator^2B
"DATA",348.5,187,1)
Invalid Federal Contractor Indicator Code.
"DATA",348.5,188,0)
4L^Date of Dissolution^2B
"DATA",348.5,188,1)
Date of Dissolution must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,189,0)
4M^Property Type^2D
"DATA",348.5,189,1)
Invalid Property Type Code.
"DATA",348.5,190,0)
4N^Date Reported to CB^3
"DATA",348.5,190,1)
Date Reported to CB must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,191,0)
4O^Debtor Alias Type^4
"DATA",348.5,191,1)
Invalid Debtor Alias Type Code.
"DATA",348.5,192,0)
4P^Debtor Alias First Name^4
"DATA",348.5,192,1)
Debtor Alias First Name cannot be blank.
"DATA",348.5,193,0)
4Q^Debtor Alias Generation^4
"DATA",348.5,193,1)
Invalid Debtor Alias Generation Code.
"DATA",348.5,194,0)
4R^Financial Transaction Type^5A,5B
"DATA",348.5,194,1)
Invalid Financial Transaction Type Code.
"DATA",348.5,195,0)
4S^Financial Transaction Type^5A,5B
"DATA",348.5,195,1)
Financial Transaction Type is Required.
"DATA",348.5,196,0)
4T^Trans Type^5A,5B
"DATA",348.5,196,1)
Invalid Trans Type Code.
"DATA",348.5,197,0)
4U^Trans Type^5A,5B
"DATA",348.5,197,1)
Trans Type is Required.
"DATA",348.5,198,0)
4V^Identification Date^5A,5B
"DATA",348.5,198,1)
Identification Date must be a Valid Date in YYYYMMDD Format.
"DATA",348.5,199,0)
4W^Identification Date^5A,5B
"DATA",348.5,199,1)
Identification Date must be less than or equal to the System Date.
"DATA",348.5,200,0)
4X^Identification Date^5A,5B
"DATA",348.5,200,1)
Identification Date is Required.
"DATA",348.5,201,0)
4Y^Agency Trans ID^5A,5B
"DATA",348.5,201,1)
Agency Trans ID is Required.
"DATA",348.5,202,0)
4Z
"DATA",348.5,203,0)
5A^Agency Trans ID^5A,5B
"DATA",348.5,203,1)
Agency Trans ID must be Unique, Agency Trans ID already exists within FedDebt.
"DATA",348.5,204,0)
5B^Trans Amount^5A,5B
"DATA",348.5,204,1)
Trans Amount must be greater than Zero.
"DATA",348.5,205,0)
5C^Trans Amount^5A,5B
"DATA",348.5,205,1)
Trans Amount must be Numeric.
"DATA",348.5,206,0)
5D^Trans Amount^5A,5B
"DATA",348.5,206,1)
Trans Amount is Required.
"DATA",348.5,207,0)
5E^SIGNED Principal Amount^5B
"DATA",348.5,207,1)
If Financial Type Code = L, the value of the adjustment cannot reduce the Principal Amount below zero.
"DATA",348.5,208,0)
5F^SIGNED Penalty Amount^5B
"DATA",348.5,208,1)
If Financial Type Code = L, the value of the adjustment cannot reduce the Penalty Amount below zero.
"DATA",348.5,209,0)
5G^SIGNED Principal Amount, SIGNED Interest Amount, SIGNED Admin Cost Amount, SIGNED Penalty Amount^5B
"DATA",348.5,209,1)
If Financial Type Code = L, one of these debt balance components is required.
"DATA",348.5,210,0)
5H^Financial Instrument Type^5A
"DATA",348.5,210,1)
Invalid Financial Instrument Type Code.
"DATA",348.5,211,0)
5I^Financial Instrument Type^5A
"DATA",348.5,211,1)
Financial Instrument Type is Required.
"DATA",348.5,212,0)
5J^Financial Instrument Num^5A
"DATA",348.5,212,1)
Financial Instrument Num is Required.
"DATA",348.5,213,0)
5K^SIGNED Interest Amount^5B
"DATA",348.5,213,1)
If Financial Type Code = L, the value of the adjustment cannot reduce the Interest Amount below zero.
"DATA",348.5,214,0)
5L
"DATA",348.5,215,0)
5M
"DATA",348.5,216,0)
5N^Credit Card Authorization Number^5A
"DATA",348.5,216,1)
Credit Card Authorization Number is Required if Financial Instrument Type Code = C.
"DATA",348.5,217,0)
5O^Credit Card Authorization Number^5A
"DATA",348.5,217,1)
Credit Card Authorization Number must be Null if Financial Instrument Type Code <> C. 
"DATA",348.5,218,0)
5P^SIGNED Admin Cost Amount^5B
"DATA",348.5,218,1)
If Financial Type Code = L, the value of the adjustment cannot reduce the Admin Cost Amount below zero.
"DATA",348.5,219,0)
5Q^Agency Debt ID and Agency Debtor ID^5A
"DATA",348.5,219,1)
Payment or Reversal is Unidentified
"DATA",348.5,220,0)
5R^Agency Debt ID^5B
"DATA",348.5,220,1)
Cannot increase adjustment in PA
"DATA",348.5,221,0)
5S^Agency Debt ID^5B
"DATA",348.5,221,1)
Cannot process an adjustment for a closed case
"DATA",348.5,222,0)
5T^Recall Request Reason for Debt^1
"DATA",348.5,222,1)
Invalid Recall Request Reason for Debt Code.
"DATA",348.5,223,0)
5U^Recall Request Reason for Debtor^2
"DATA",348.5,223,1)
Invalid Recall Request Reason for Debtor Code.
"DATA",348.5,224,0)
5V^Recall Request Reason for Case^3
"DATA",348.5,224,1)
Invalid Recall Request Reason for Case Code.
"DATA",348.5,225,0)
5W^Trans Sequence Number^5A,5B
"DATA",348.5,225,1)
Transaction's Sequence Number duplicates another transaction's number in the same file.
"DATA",348.5,226,0)
5X^Trans Sequence Number^5A,5B
"DATA",348.5,226,1)
Transaction's Sequence Number is Required.
"DATA",348.5,227,0)
5Y^Judgment/Non Judgment^1
"DATA",348.5,227,1)
Invalid Judgment Debt value.
"DATA",348.5,228,0)
5Z^Health Insurance Claim^1
"DATA",348.5,228,1)
Invalid Health Insurance Claim Code
"DATA",348.5,229,0)
6A^Debtor Last Name Update Reason^2
"DATA",348.5,229,1)
Invalid Debtor Last Name Update Reason code
"DATA",348.5,230,0)
6B^DUNS Num^2B
"DATA",348.5,230,1)
Invalid DUNS Num code
"DATA",348.5,231,0)
6C^Employer Name^2E
"DATA",348.5,231,1)
Employer Name cannot be blank
"DATA",348.5,232,0)
6D^Employer EIN^2E
"DATA",348.5,232,1)
Employer EIN cannot be blank
"DATA",348.5,233,0)
6E^Agency Match Original Trans ID^5A,5B
"DATA",348.5,233,1)
Agency Match Original Trans ID does not match Agency Trans ID of the Original Payment  
"DATA",348.5,234,0)
6F^SIGNED Trans Amt of Original Payment^5A
"DATA",348.5,234,1)
Trans Amt of Original Payment does not match corresponding payment
"DATA",348.5,235,0)
6G^Transaction Amt of Original Adjustment^5B
"DATA",348.5,235,1)
Trans Amt of Original Adjustment does not match corresponding adjustment
"DATA",348.5,236,0)
6H^Transaction Amt of Original Offset^5B
"DATA",348.5,236,1)
Trans Amt of Original Adjustment does not match corresponding TOP offset
"DATA",348.5,237,0)
6I^Debtor Name First^2
"DATA",348.5,237,1)
Debtor First Name cannot be blank for individual debtor.
"DATA",348.5,238,0)
6J^Property Description^2D
"DATA",348.5,238,1)
Property Description cannot be blank if adding a property.
"DATA",348.5,239,0)
6K^Override Action^6
"DATA",348.5,239,1)
Override Action cannot be blank.
"DATA",348.5,240,0)
6L^Referring a debt^1,2,2C,3
"DATA",348.5,240,1)
Must include all required record types in order to save debt.
"DATA",348.5,241,0)
6M^Referred Debt Balance^1
"DATA",348.5,241,1)
Debt Balance must be greater or equal to referral threshold
"DATA",348.5,242,0)
6N^Processing a debt^3
"DATA",348.5,242,1)
Only one case allowed when individual liability
"DATA",348.5,243,0)
6O^Processing a debt^2
"DATA",348.5,243,1)
At least one debtor must be assigned to the debt
"DATA",348.5,244,0)
6P^Processing a debt^3
"DATA",348.5,244,1)
Debt cannot have more than 26 cases assigned
"DATA",348.5,245,0)
6Q^Processing a debt^2
"DATA",348.5,245,1)
Only one debtor allowed when individual liability
"DATA",348.5,246,0)
6R^Processing a debt^1
"DATA",348.5,246,1)
At least one case must be assigned to the debt
"DATA",348.5,247,0)
6S^FAST Code/ ALC/ Station^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,247,1)
The agency program profile is inactive
"DATA",348.5,248,0)
6T^FAST Code/ ALC/ Station^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,248,1)
The agency program certification has expired
"DATA",348.5,249,0)
6U^Agency Debt ID, Agency Debtor ID^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,249,1)
Debt/Debtor Agency Code Conflict
"DATA",348.5,250,0)
6V^Agency Debt ID, Agency Debtor ID^1,2,2A,2B, 2C,2D,2E, 3,4,5A,5B, 6
"DATA",348.5,250,1)
Debt/Debtor Bureau Code Conflict
"DATA",348.5,251,0)
6W^Agency Debt ID^1
"DATA",348.5,251,1)
Debt already exists
"DATA",348.5,252,0)
6X^Agency Debtor ID^2
"DATA",348.5,252,1)
Duplicate debtor for this debt
"DATA",348.5,253,0)
6Y^Agency Debtor ID^2
"DATA",348.5,253,1)
New debtors may only be added to JOS debts
"DATA",348.5,254,0)
6Z^Agency Debtor ID^2
"DATA",348.5,254,1)
A debtor already exists with this key
"DATA",348.5,255,0)
7A^Agency Debtor ID^2A
"DATA",348.5,255,1)
Debtor is not an individual debtor
"DATA",348.5,256,0)
7B^Agency Debtor ID^2B
"DATA",348.5,256,1)
Debtor is not a business debtor
"DATA",348.5,257,0)
7C^Agency Debtor ID^2
"DATA",348.5,257,1)
Debtor not found for agency debtor Id
"DATA",348.5,258,0)
7D^Individual or Business^2
"DATA",348.5,258,1)
Consumer debt type may not have business debtors
"DATA",348.5,259,0)
7E^Debtor TIN Type^2
"DATA",348.5,259,1)
Consumer debt may not have debtors with TIN type of EIN 
"DATA",348.5,260,0)
7F^Debtor TIN^2
"DATA",348.5,260,1)
TIN cannot be blank due to debtor in TOP. Mark TIN invalid.
"DATA",348.5,261,0)
7G^Individual/Joint Several Indicator^1
"DATA",348.5,261,1)
New debtors may only be added to JOS debts
"DATA",348.5,262,0)
7H^Relationship to Primary^3
"DATA",348.5,262,1)
The Relationship to Primary must not be null
"DATA",348.5,263,0)
7I^Relationship to Primary^3
"DATA",348.5,263,1)
There can only be one primary debtor for this debt
"DATA",348.5,264,0)
7J^Relationship to Primary^3
"DATA",348.5,264,1)
There must be a primary debtor for this debt
"DATA",348.5,265,0)
7K^Admin Debt Class^1
"DATA",348.5,265,1)
Admin Debt Class is not allowed for loan debt type
"DATA",348.5,266,0)
7L^Penalty Rate^1
"DATA",348.5,266,1)
Penalty rate exceeds system threshold
"DATA",348.5,267,0)
7M^Penalty Rate^1
"DATA",348.5,267,1)
Not allowed when agency program indicates no accrual
"DATA",348.5,268,0)
7N^Contact Type to Rcv DL^3
"DATA",348.5,268,1)
Primary and Valid address required for contact to receive Demand Letter  When adding new IAI debt the SLFIND/SLFBUS contact primary name indicator must equal "Y".
"DATA",348.5,269,0)
7O^Agency Debtor ID^2,3,4
"DATA",348.5,269,1)
Agency Debtor ID does not match agency records
"DATA",348.5,270,0)
7P^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,270,1)
N/A
"DATA",348.5,271,0)
7Q^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,271,1)
N/A
"DATA",348.5,272,0)
7R^Cannot add debtors to non J&S debt^2
"DATA",348.5,272,1)
Cannot add debtors to non Joint & Several debt.
"DATA",348.5,273,0)
7S^NOT USED FOR CROSS-SERVICING^X
"DATA",348.5,273,1)
N/A
"DATA",348.5,274,0)
7T^Override already exists^6
"DATA",348.5,274,1)
Override already exists
"DATA",348.5,275,0)
7U^Update fields cannot be blank^1
"DATA",348.5,275,1)
Update fields cannot be blank.
"DATA",348.5,276,0)
7V^The debt/debtor has no case data^3
"DATA",348.5,276,1)
Debt/Debtor has no Case Data - Record Type 3 is Required.
"DATA",348.5,277,0)
7W^Individual Liability Debt May Only Have One Record Type 3^3
"DATA",348.5,277,1)
Individual Liability Debt May Only Have One Record Type 3
"DATA",348.5,278,0)
7X^Invalid Guarantor Exists^1
"DATA",348.5,278,1)
Invalid Guarantor Exists 
"DATA",348.5,279,0)
7Y^Individual Debt Liability Invalid^3
"DATA",348.5,279,1)
Individual Debt Liability is invalid.
"DATA",348.5,280,0)
7Z^Liability Is Not 100%^3
"DATA",348.5,280,1)
Liability for debt does not equal 100%
"DATA",348.5,281,0)
8A^Invalid Agency Code - Verify Station Field^1,2,2A,2B, 2C,2D,2E, 3,46
"DATA",348.5,281,1)
Invalid Agency Code - Verify Station Field.
"DATA",348.5,282,0)
8B^Invalid Bureau Code - Verify Station Field^1,2,2A,2B, 2C,2D,2E, 3,4,6
"DATA",348.5,282,1)
Invalid Bureau Code - Verify Station Field.
"DATA",348.5,283,0)
8C^Invalid Office Code - Verify Station Field^1,2,2A,2B, 2C,2D,2E, 3,4,6
"DATA",348.5,283,1)
Invalid Office Code - Verify Station Field.
"DATA",348.5,284,0)
8D^Invalid Program Code - Verify Station Field^1,2,2A,2B, 2C,2D,2E, 3,4,6
"DATA",348.5,284,1)
Invalid Program Code - Verify Station Field.
"DATA",348.5,285,0)
9A^Batch Control ID is Invalid^H,1,2,2A, 2B,2C,2D, 2E,3,4,5A, 5B,6
"DATA",348.5,285,1)
When Batch Control ID is invalid or RECORD COUNT and TOTAL TRANSACTION AMOUNT values are inconsistent. 
"DATA",348.5,286,0)
9B^Invalid Beneficiary Name^1
"DATA",348.5,286,1)
Beneficiary Name is Invalid
"DATA",348.5,287,0)
9C^Invalid Payment Agreement Terms^1
"DATA",348.5,287,1)
Payment Agreement Terms is Invalid
"DATA",348.5,288,0)
9D^Invalid Job Title^2E
"DATA",348.5,288,1)
Job Title is Invalid
"DATA",348.5,289,0)
9E^Adjustment Information Only^5A
"DATA",348.5,289,1)
Full amount of adjustment could not be applied to the debt.  Cannot reduce below zero.
"DATA",348.5,290,0)
9F
"DATA",348.5,291,0)
9G^Action Code ^5A,5B
"DATA",348.5,291,1)
Invalid Action Code (Syntax Validation)
"DATA",348.5,292,0)
9H^Debtor Closed due to Entity Out of Business^1,2,2A,2B, 2C,2D,2E, 3,4,6
"DATA",348.5,292,1)
Debtor Closed due to Entity Out of Business
"DATA",348.5,293,0)
9I^Debtor Closed due to Death^1,2,2A,2B, 2C,2D,2E, 3,4,6
"DATA",348.5,293,1)
Debtor Closed due to Death
"DATA",348.5,294,0)
9J^Transaction's Sequence Number should be between 1 and 999,999^5A,5B
"DATA",348.5,294,1)
Transactions' Sequence Number should be between 1 and 999,999
"DATA",348.5,295,0)
9K^Trans Amt does not match the sum of components^5B
"DATA",348.5,295,1)
Trans Amt does not match the sum of components 
"DATA",348.5,296,0)
9L^Trans ID has to be 15 chars long^5A,5B
"DATA",348.5,296,1)
Trans ID has to be 15 chars long
"DATA",348.5,297,0)
9M^Cannot adjust the current case balance below ZERO^5B
"DATA",348.5,297,1)
Cannot adjust the current case balance below ZERO
"DATA",348.5,298,0)
ZZ^Manual Intervention Required^H,1,2,2A, 2B,2C,2D, 2E,3,4,5A, 5B,6
"DATA",348.5,298,1)
A Non-Disclosed error was detected which requires manual intervention to discern the type of error that was encountered. 
"DATA",348.6,1,0)
A^Add a new record^Sent on Record Type 1
"DATA",348.6,2,0)
U^Update record^Sent on Record Type 2 only
"DATA",348.6,3,0)
L^Debt Recall^Sent on Record Type 1, 2, 3 
"DATA",348.6,4,0)
B^Add New Debt to Existing Debtor^Sent on Record Type 2 only
"DATA",348.6,5,0)
V^Add Joint Debtor to an Existing Debt^Sent on Record Type 2 only
"DATA",348.6,6,0)
D^Delete Payment Bypass^Sent on Record Type 6 only
"DATA",348.7,1,0)
H^Header Record^Batch and Record information
"DATA",348.7,2,0)
1^Debt Record^Debt information
"DATA",348.7,3,0)
2^Debtor Record^Debtor information
"DATA",348.7,4,0)
2A^Individual Debtor Record
"DATA",348.7,5,0)
2B^Business Debtor Record^Not used for Cross Servicing
"DATA",348.7,6,0)
2C^Debtor Contact information
"DATA",348.7,7,0)
2D^Debtor Record (Property Information)
"DATA",348.7,8,0)
2E^Debtor Record (Employment Information)^Not used for Cross Servicing
"DATA",348.7,9,0)
3^Case Record
"DATA",348.7,10,0)
4^Alias Name (for agency use only)^Not used for Cross Servicing
"DATA",348.7,11,0)
5A^Creditor Agency Financial Transactions (Collections/Reversals)
"DATA",348.7,12,0)
5B^Creditor Agency Financial Transactions (Adjustments)
"DATA",348.7,13,0)
6^Payment Bypass/Offset^Not used for Cross Servicing
"DATA",348.7,14,0)
Z^Trailer Record
"DATA",430.5,1,0)
Z^UNCOLLECTABLE
"DATA",430.5,2,0)
D^ADMINISTRATIVE RESOLUTION APPROVED FOR DEATH
"DATA",430.5,3,0)
B^ADMINISTRATIVE RESOLUTION APPROVED FOR BANKRUPTCY
"DATA",430.5,4,0)
W^ADMINISTRATIVE RESOLUTION APPROVED FOR INABILITY TO PAY
"DATA",430.5,5,0)
E^ADMINISTRATIVE RESOLUTION APPROVED FOR ENTITY OUT OF BUSINESS
"DATA",430.5,6,0)
T^CA AGREES - COMPLAINT - STOP COLLECTION ACTIVITY
"DATA",430.5,7,0)
Y^CA AGREES - DEBT AMOUNT IS INCORRECT - STOP COLLECTION ACTIVITY
"DATA",430.5,8,0)
C^CA AGREES - CONGRESSIONAL DISPUTE - STOP COLLECTION ACTIVITY
"DATA",430.5,9,0)
M^CA AGREES - MISCELLANEOUS DISPUTE - STOP COLLECTION ACTIVITY
"DATA",430.5,10,0)
G^CA AGREES - WRONG DEBTOR - STOP COLLECTION ACTIVITY
"DATA",430.5,11,0)
V^CA AGREES - PREVIOUSLY PAID - STOP COLLECTION ACTIVITY
"DATA",430.5,12,0)
H^CA AGREES - PREVIOUSLY RESOLVED - STOP COLLECTION ACTIVITY
"DATA",430.5,13,0)
X^DISPUTE TIMER EXPIRED
"DATA",430.5,14,0)
P^SATISFIED PA - PAID IN FULL OR COMPROMISED
"DATA",430.5,15,0)
F^PAID IN FULL (OUTSIDE OF A PAYMENT AGREEMENT)
"DATA",430.5,16,0)
S^SYSTEM COMPROMISED (BALANCE BELOW $25)
"DATA",430.5,17,0)
R^RECALLED
"DATA",430.5,18,0)
A^MANUALLY RETURNED TO AGENCY
"DATA",430.5,19,0)
N^PROOF OF DEBT DOCUMENTATION NOT PROVIDED - STOP COLLECTION ACTIVITY
"DATA",430.5,20,0)
Q^PROOF OF DEBT TIMER EXPIRED
"FIA",340)
AR DEBTOR
"FIA",340,0)
^RCD(340,
"FIA",340,0,0)
340V
"FIA",340,0,1)
y^n^p^^^^n^^n
"FIA",340,0,10)

"FIA",340,0,11)

"FIA",340,0,"RLRO")

"FIA",340,0,"VR")
4.5^PRCA
"FIA",340,340)
1
"FIA",340,340,7.02)

"FIA",340,340,7.03)

"FIA",340,340,7.04)

"FIA",340,340,7.05)

"FIA",342)
AR SITE PARAMETER
"FIA",342,0)
^RC(342,
"FIA",342,0,0)
342P
"FIA",342,0,1)
y^n^p^^^^n^^n
"FIA",342,0,10)

"FIA",342,0,11)

"FIA",342,0,"RLRO")

"FIA",342,0,"VR")
4.5^PRCA
"FIA",342,342)
1
"FIA",342,342,100)

"FIA",344)
AR BATCH PAYMENT
"FIA",344,0)
^RCY(344,
"FIA",344,0,0)
344I
"FIA",344,0,1)
y^y^p^^^^n^^n
"FIA",344,0,10)

"FIA",344,0,11)

"FIA",344,0,"RLRO")

"FIA",344,0,"VR")
4.5^PRCA
"FIA",344,344)
1
"FIA",344,344,.19)

"FIA",344,344.01)
1
"FIA",344,344.01,.09)

"FIA",344,344.01,.15)

"FIA",348.5)
TCS IAI ERROR CODES
"FIA",348.5,0)
^RC(348.5,
"FIA",348.5,0,0)
348.5
"FIA",348.5,0,1)
y^y^f^^n^^y^o^n
"FIA",348.5,0,10)

"FIA",348.5,0,11)

"FIA",348.5,0,"RLRO")

"FIA",348.5,0,"VR")
4.5^PRCA
"FIA",348.5,348.5)
0
"FIA",348.6)
TCS IAI ACTION CODES
"FIA",348.6,0)
^RC(348.6,
"FIA",348.6,0,0)
348.6
"FIA",348.6,0,1)
y^y^f^^n^^y^o^n
"FIA",348.6,0,10)

"FIA",348.6,0,11)

"FIA",348.6,0,"RLRO")

"FIA",348.6,0,"VR")
4.5^PRCA
"FIA",348.6,348.6)
0
"FIA",348.7)
TCS IAI RECORD TYPES
"FIA",348.7,0)
^RC(348.7,
"FIA",348.7,0,0)
348.7
"FIA",348.7,0,1)
y^y^f^^n^^y^o^n
"FIA",348.7,0,10)

"FIA",348.7,0,11)

"FIA",348.7,0,"RLRO")

"FIA",348.7,0,"VR")
4.5^PRCA
"FIA",348.7,348.7)
0
"FIA",430)
ACCOUNTS RECEIVABLE
"FIA",430,0)
^PRCA(430,
"FIA",430,0,0)
430I
"FIA",430,0,1)
y^n^p^^^^n^^n
"FIA",430,0,10)

"FIA",430,0,11)

"FIA",430,0,"RLRO")

"FIA",430,0,"VR")
4.5^PRCA
"FIA",430,430)
1
"FIA",430,430,151)

"FIA",430,430,152)

"FIA",430,430,153)

"FIA",430,430,154)

"FIA",430,430,155)

"FIA",430,430,157)

"FIA",430,430,158)

"FIA",430,430,159)

"FIA",430,430,159.1)

"FIA",430,430,159.2)

"FIA",430,430,159.3)

"FIA",430,430,159.4)

"FIA",430,430,159.5)

"FIA",430,430,161)

"FIA",430,430,162)

"FIA",430,430,163)

"FIA",430,430,164)

"FIA",430,430,165)

"FIA",430,430,166)

"FIA",430,430,167)

"FIA",430,430,168)

"FIA",430,430,169)

"FIA",430,430,169.1)

"FIA",430,430,169.2)

"FIA",430,430,169.3)

"FIA",430,430,169.4)

"FIA",430,430,171)

"FIA",430,430,172)

"FIA",430,430,173)

"FIA",430,430,174)

"FIA",430,430,175)

"FIA",430,430,176)

"FIA",430,430,177)

"FIA",430,430,178)

"FIA",430,430,191)

"FIA",430,430,192)

"FIA",430,430,193)

"FIA",430,430,194)

"FIA",430,430,199.2)

"FIA",430,430,301)

"FIA",430,430,302)

"FIA",430,430,303)

"FIA",430,430,304)

"FIA",430,430,305)

"FIA",430,430,306)

"FIA",430,430,307)

"FIA",430,430,308)

"FIA",430,430.0171)
0
"FIA",430,430.0172)
0
"FIA",430.5)
AR RETURN REASON CODE
"FIA",430.5,0)
^PRCA(430.5,
"FIA",430.5,0,0)
430.5
"FIA",430.5,0,1)
y^n^f^^n^^y^o^n
"FIA",430.5,0,10)

"FIA",430.5,0,11)

"FIA",430.5,0,"RLRO")

"FIA",430.5,0,"VR")
4.5^PRCA
"FIA",430.5,430.5)
0
"INIT")
ENTER^RC45301P
"KRN",.4,384,-1)
0^3
"KRN",.4,384,0)
PRCA PROFILE^3150121.0053^^430^^^3150121
"KRN",.4,384,"%D",0)
^.4001^4^4^3150116^^^^
"KRN",.4,384,"%D",1,0)
This template prints a profile of an account where the debtor
"KRN",.4,384,"%D",2,0)
is not an employee, ex-employee, Category 'C' (Means Test),
"KRN",.4,384,"%D",3,0)
or Vendor.
"KRN",.4,384,"%D",4,0)
OPTION: PRCAC PROFILE
"KRN",.4,384,"DXS",1,9)
S X=$P(^PRCA(430,D0,0),U,5) W:X&$D(^PRCA(430.6,+X,0)) ?23,$E($P(^PRCA(430.6,X,0),U,2),1,55)
"KRN",.4,384,"F",1)
N %I,%H,% D NOW^%DTC S X=% S Y=X D DT K DIP;L18;d;Z;"NOW"~" ACCOUNTS RECEIVABLE PROFILE"~
"KRN",.4,384,"F",2)
S X="=",DIP(1)=$G(X) S X=75,X1=DIP(1) S %=X,X="" S:X1]"" $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("=",75)"~"NAME: ";C1~9;X~
"KRN",.4,384,"F",3)
"BILL #: ";C40~.01;X~D EN1^PRCADR;Z;"D EN1^PRCADR"~" ";C1~D PROFRJ^RCTCSJS1(D0);Z;"D PROFRJ^RCTCSJS1(D0)"~"CURRENT STATUS: ";S1;C1~8;X~
"KRN",.4,384,"F",4)
"CATEGORY: ";C40~2;X~"CP: ";C1~250;X~"DATE BILL PREPARED: ";C40~10;X~D EN5^PRCADR1;Z;"D EN5^PRCADR1"~D EN1^PRCADR1;Z;"D EN1^PRCADR1"~
"KRN",.4,384,"F",5)
D EN5^PRCADR Q:$D(PRCA("HALT"))  W "";Z;"D EN5^PRCADR Q:$D(PRCA("HALT"))  W """~D EN3^PRCADR;Z;"D EN3^PRCADR"~"TRANSACTIONS: ";S1;C1~
"KRN",.4,384,"F",6)
D EN2^PRCADR;Z;"D EN2^PRCADR"~Q:$D(PRCA("HALT"))  W "";Z;"Q:$D(PRCA("HALT"))  W """~"BILL RESULTING FROM: ";S1;C1~
"KRN",.4,384,"F",7)
X DXS(1,9);Z;"S X=$P(^PRCA(430,D0,0),U,5) W:X&$D(^PRCA(430.6,+X,0)) ?23,$E($P(^PRCA(430.6,X,0),U,2),1,55)"~D EN4^PRCADR1;Z;"D EN4^PRCADR1"~
"KRN",.4,384,"F",8)
Q:'$D(PRCA("WROFF"))  K DXS S D0=PRCA("WROFF") D ^PRCATW1 K DXS;Z;"Q:'$D(PRCA("WROFF"))  K DXS S D0=PRCA("WROFF") D ^PRCATW1 K DXS"~
"KRN",.4,384,"H")
@
"KRN",.4,384,"IOM")
80
"KRN",.4,384,"LAST")

"KRN",.4,384,"ROU")
^PRCATP1
"KRN",.4,384,"ROUOLD")
PRCATP1
"KRN",.4,384,"SUB")
1
"KRN",.4,387,-1)
0^5
"KRN",.4,387,0)
PRCA OTHER PROFILE^3150116.1902^^430^^^3150120
"KRN",.4,387,"%D",0)
^^3^3^2910603^^
"KRN",.4,387,"%D",1,0)
This template prints a profile of an account where the debtor is
"KRN",.4,387,"%D",2,0)
an employee or ex-employee.
"KRN",.4,387,"%D",3,0)
OPTION: PRCAC PROFILE
"KRN",.4,387,"DXS",1,9)
S X=$P(^PRCA(430,D0,0),U,5) W:X&$D(^PRCA(430.6,+X,0)) ?23,$E($P(^PRCA(430.6,X,0),U,2),1,55)
"KRN",.4,387,"F",1)
N %I,%H,% D NOW^%DTC S X=% S Y=X D DT K DIP;L18;d;Z;"NOW"~" ACCOUNTS RECEIVABLE PROFILE"~
"KRN",.4,387,"F",2)
S X="=",DIP(1)=$G(X) S X=75,X1=DIP(1) S %=X,X="" S:X1]"" $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("=",75)"~"NAME: ";C1~9;X~
"KRN",.4,387,"F",3)
"BILL #: ";C40~.01;X~D EN1^PRCADR;Z;"D EN1^PRCADR"~" ";C1~D PROFRJ^RCTCSJS1(D0);Z;"D PROFRJ^RCTCSJS1(D0)"~"CURRENT STATUS: ";S1;C1~8;X~
"KRN",.4,387,"F",4)
"CATEGORY: ";C40~2;X~"CP: ";C1~250;X~"FUND (APPROPRIATION): ";C40~203;X~"DATE BILL PREPARED: ";C40~10;X~D EN1^PRCADR1;Z;"D EN1^PRCADR1"~
"KRN",.4,387,"F",5)
D EN3^PRCADR;Z;"D EN3^PRCADR"~D EN5^PRCADR Q:$D(PRCA("HALT"))  W "";Z;"D EN5^PRCADR Q:$D(PRCA("HALT"))  W """~"TRANSACTIONS: ";S1;C1~
"KRN",.4,387,"F",6)
D EN2^PRCADR;Z;"D EN2^PRCADR"~Q:$D(PRCA("HALT"))  W "";Z;"Q:$D(PRCA("HALT"))  W """~"BILL RESULTING FROM: ";S1;C1~
"KRN",.4,387,"F",7)
X DXS(1,9);Z;"S X=$P(^PRCA(430,D0,0),U,5) W:X&$D(^PRCA(430.6,+X,0)) ?23,$E($P(^PRCA(430.6,X,0),U,2),1,55)"~D EN4^PRCADR1;Z;"D EN4^PRCADR1"~
"KRN",.4,387,"F",8)
Q:'$D(PRCA("WROFF"))  K DXSS S D0=PRCA("WROFF") D ^PRCATW1 K DX;Z;"Q:'$D(PRCA("WROFF"))  K DXSS S D0=PRCA("WROFF") D ^PRCATW1 K DX"~
"KRN",.4,387,"H")
@
"KRN",.4,387,"IOM")
80
"KRN",.4,387,"LAST")

"KRN",.4,387,"ROU")
^PRCATP4
"KRN",.4,387,"ROUOLD")
PRCATP4
"KRN",.4,387,"SUB")
1
"KRN",.4,388,-1)
0^4
"KRN",.4,388,0)
PRCA MEANS PROFILE^3150116.185^^430^^^3150116
"KRN",.4,388,"%D",0)
^.4001^3^3^3150116^^
"KRN",.4,388,"%D",1,0)
This template prints a profile of a Category 'C' (Means Test) account.
"KRN",.4,388,"%D",2,0)
COMPILED: ^PRCATP2
"KRN",.4,388,"%D",3,0)
OPTION: PRCAC PROFILE
"KRN",.4,388,"DXS",1,9)
S X=$P(^PRCA(430,D0,0),U,5) W:X&$D(^PRCA(430.6,+X,0)) ?23,$E($P(^PRCA(430.6,X,0),U,2),1,55)
"KRN",.4,388,"F",1)
N %I,%H,% D NOW^%DTC S X=% S Y=X D DT K DIP;L18;d;Z;"NOW"~" MEANS TEST ACCOUNTS RECEIVABLE PROFILE"~
"KRN",.4,388,"F",2)
S X="=",DIP(1)=$G(X) S X=75,X1=DIP(1) S %=X,X="" S:X1]"" $P(X,X1,%\$L(X1)+1)=X1,X=$E(X,1,%) W X K DIP;C1;Z;"DUP("=",75)"~"NAME: ";C1~9;X~
"KRN",.4,388,"F",3)
"BILL #: ";C40~.01;X~D EN1^PRCADR;Z;"D EN1^PRCADR"~" ";C1~D PROFRJ^RCTCSJS1(D0);Z;"D PROFRJ^RCTCSJS1(D0)"~"CURRENT STATUS: ";S1;C~8;X~"CATEGORY: ";C40~
"KRN",.4,388,"F",4)
2;X~"CARE: ";C44~
"KRN",.4,388,"F",5)
S DIP(1)=$S($D(^PRCA(430,D0,0)):^(0),1:"") S X=$P($G(^PRCA(430.2,+$P(DIP(1),U,16),0)),U),DIP(2)=$G(X) S X=1,DIP(3)=$G(X) S X=26,X=$E(DIP(2),DIP(3),X) W X K DIP;C50;Z;"$E(TYPE OF CARE,1,26)"~
"KRN",.4,388,"F",6)
"CP: ";C1~250;X~"FUND (APPROPRIATION): ";C40~203;X~"DATE BILL PREPARED: ";C40~10;X~D EN5^PRCADR1;Z;"D EN5^PRCADR1"~D EN1^PRCADR1;Z;"D EN1^PRCADR1"~
"KRN",.4,388,"F",7)
D EN5^PRCADR;Z;"D EN5^PRCADR"~Q:$D(PRCA("HALT"))  W "";Z;"Q:$D(PRCA("HALT"))  W """~D EN3^PRCADR;Z;"D EN3^PRCADR"~"TRANSACTIONS: ";S1;C1~
"KRN",.4,388,"F",8)
D EN2^PRCADR;Z;"D EN2^PRCADR"~Q:$D(PRCA("HALT"))  W "";Z;"Q:$D(PRCA("HALT"))  W """~"BILL RESULTING FROM: ";S1;C1~
"KRN",.4,388,"F",9)
X DXS(1,9);Z;"S X=$P(^PRCA(430,D0,0),U,5) W:X&$D(^PRCA(430.6,+X,0)) ?23,$E($P(^PRCA(430.6,X,0),U,2),1,55)"~D EN4^PRCADR1;Z;"D EN4^PRCADR1"~
"KRN",.4,388,"F",10)
Q:'$D(PRCA("WROFF"))  W "";Z;"Q:'$D(PRCA("WROFF"))  W """~K DXS S D0=PRCA("WROFF") D ^PRCATW1 K DXS;Z;"K DXS S D0=PRCA("WROFF") D ^PRCATW1 K DXS"~
"KRN",.4,388,"H")
@
"KRN",.4,388,"IOM")
80
"KRN",.4,388,"LAST")

"KRN",.4,388,"ROU")
^PRCATP2
"KRN",.4,388,"ROUOLD")
PRCATP2
"KRN",.4,388,"SUB")
1
"KRN",.4,1628,-1)
0^2
"KRN",.4,1628,0)
TCS IAI ERROR CODES LIST^3140919.0403^@^348.5^^@^3160917
"KRN",.4,1628,"F",2)
.01;L2;"CD"~1;C5;W20~2;C27;W10~3;C38;W42~
"KRN",.4,1628,"H")
TCS ERROR CODES LIST
"KRN",.4,1633,-1)
0^6
"KRN",.4,1633,0)
PRCA TCSP RECALLB^3150730.152^^430^^^3160918
"KRN",.4,1633,"%D",0)
^^2^2^3150730^^
"KRN",.4,1633,"%D",1,0)
This print template supports the Cross-Servicing
"KRN",.4,1633,"%D",2,0)
Recall Report sorted by bill number.
"KRN",.4,1633,"DXS")
2
"KRN",.4,1633,"DXS",1,9)
S DEBTOR=$P($G(^PRCA(430,D0,0)),U,9),X=$$SSN^RCFN01($P(^RCD(340,DEBTOR,0),"^")),X=$S(X<0:"",1:X) W X
"KRN",.4,1633,"F",1)
.01;L11;C1//~9;L18;C14//~X DXS(1,9);L9;C34//;Z;"S DEBTOR=$P($G(^PRCA(430,D0,0)),U,9),X=$$SSN^RCFN01($P(^RCD(340,DEBTOR,0),"^")),X=$S(X<0:"",1:X) W X"~
"KRN",.4,1633,"F",2)
155;R8;C45//~153;L8//~S DIP(1)=$S($D(^PRCA(430,D0,15)):^(15),1:"") S X=$P(DIP(1),U,4),X=X W X K DIP;L2;C68//;Z;"INTERNAL(TCSP RECALL REASON)"~
"KRN",.4,1633,"F",3)
W "-";X//;Z;"W "-""~154;X;L10;C71//~
"KRN",.4,1633,"H")
ACCOUNTS RECEIVABLE LIST
"KRN",.4,1633,"SUB")
1
"KRN",.4,1634,-1)
0^7
"KRN",.4,1634,0)
PRCA TCSP RECALLD^3150730.1523^^430^^^3160919
"KRN",.4,1634,"%D",0)
^^2^2^3150730^^
"KRN",.4,1634,"%D",1,0)
This print template supports the Cross-Servicing
"KRN",.4,1634,"%D",2,0)
Recall Report sorted by debtor.
"KRN",.4,1634,"DXS")
2
"KRN",.4,1634,"DXS",1,9)
S DEBTOR=$P($G(^PRCA(430,D0,0)),U,9),X=$$SSN^RCFN01($P(^RCD(340,DEBTOR,0),"^")),X=$S(X<0:"",1:X) W X
"KRN",.4,1634,"F",1)
9;L18;C1//~.01;L11;C21//~X DXS(1,9);L9;C34//;Z;"S DEBTOR=$P($G(^PRCA(430,D0,0)),U,9),X=$$SSN^RCFN01($P(^RCD(340,DEBTOR,0),"^")),X=$S(X<0:"",1:X) W X"~
"KRN",.4,1634,"F",2)
155;R8;C45//~153;L8//~S DIP(1)=$S($D(^PRCA(430,D0,15)):^(15),1:"") S X=$P(DIP(1),U,4),X=X W X K DIP;L2;C68//;Z;"INTERNAL(TCSP RECALL REASON)"~
"KRN",.4,1634,"F",3)
W "-";X//;Z;"W "-""~154;X;L10;C71//~
"KRN",.4,1634,"H")
ACCOUNTS RECEIVABLE LIST
"KRN",.4,1634,"SUB")
1
"KRN",3.8,313,-1)
0^1
"KRN",3.8,313,0)
TCSP^PU^^^^^
"KRN",3.8,313,2,0)
^3.801^2^2^3160822^^^^
"KRN",3.8,313,2,1,0)
This mail group will receive confirmation and reject messages from Austin
"KRN",3.8,313,2,2,0)
for Cross Servicing transmissions.
"KRN",3.8,313,3)

"KRN",3.8,318,-1)
0^2
"KRN",3.8,318,0)
TPC^PU^^^^^
"KRN",3.8,318,2,0)
^^3^3^3150713^
"KRN",3.8,318,2,1,0)
This TPC mail group will receive confirmation messages
"KRN",3.8,318,2,2,0)
from Austin for Cross Servicing transmissions to the
"KRN",3.8,318,2,3,0)
Q-TPC.domain.ext domain.
"KRN",3.8,318,3)

"KRN",3.8,319,-1)
0^3
"KRN",3.8,319,0)
TPL^PU^^^^^
"KRN",3.8,319,2,0)
^^3^3^3150713^
"KRN",3.8,319,2,1,0)
This TPL mail group will receive confirmation messages
"KRN",3.8,319,2,2,0)
from Austin for Cross Servicing transmissions to the
"KRN",3.8,319,2,3,0)
Q-TPL.domain.ext domain.
"KRN",3.8,319,3)

"KRN",19,3031,-1)
2^17
"KRN",19,3031,0)
PRCAF SUPERVISOR MENU^Supervisor's AR Menu^^M^1^^^^^^^53^^1^1
"KRN",19,3031,10,0)
^19.01IP^29^29
"KRN",19,3031,10,29,0)
11559
"KRN",19,3031,10,29,"^")
RCTCSP MENU
"KRN",19,3031,"U")
SUPERVISOR'S AR MENU
"KRN",19,11556,-1)
0^2
"KRN",19,11556,0)
RCTCSP STOP^Stop/Reactivate TCSP Referral For a Bill^^R^^^^^^^^
"KRN",19,11556,1,0)
^19.06^3^3^3150113^^
"KRN",19,11556,1,1,0)
This option is used to allow the user to stop Cross-Servicing referral for
"KRN",19,11556,1,2,0)
a bill.  It also is used to re-activate Cross-Servicing referral for a
"KRN",19,11556,1,3,0)
bill that had been previously stopped.
"KRN",19,11556,25)
STOP^RCTCSPU
"KRN",19,11556,"U")
STOP/REACTIVATE TCSP REFERRAL 
"KRN",19,11557,-1)
0^3
"KRN",19,11557,0)
RCTCSP RECALLB^Recall/Reactivate TCSP Referral For a Bill^^R^^^^^^^^
"KRN",19,11557,1,0)
^^3^3^3140415^
"KRN",19,11557,1,1,0)
This option is used to allow the user to recall a bill from Cross 
"KRN",19,11557,1,2,0)
Servicing.  It is also used to delete the recall if the recall has not 
"KRN",19,11557,1,3,0)
taken place.
"KRN",19,11557,25)
RCLLSETB^RCTCSPU
"KRN",19,11557,"U")
RECALL/REACTIVATE TCSP REFERRA
"KRN",19,11558,-1)
0^4
"KRN",19,11558,0)
RCTCSP RECALLD^Recall/Reactivate TCSP Referral For a Debtor^^R^^^^^^^^
"KRN",19,11558,1,0)
^19.06^3^3^3150113^^
"KRN",19,11558,1,1,0)
This option is used to allow the user to recall a debtor and all of 
"KRN",19,11558,1,2,0)
the associated bills from Cross-Servicing.  It is also used to delete the
"KRN",19,11558,1,3,0)
recall if the recall has not taken place.
"KRN",19,11558,25)
RCLLSETD^RCTCSPU
"KRN",19,11558,"U")
RECALL/REACTIVATE TCSP REFERRA
"KRN",19,11559,-1)
0^5
"KRN",19,11559,0)
RCTCSP MENU^Cross-Servicing Menu^^M^^^^^^^^
"KRN",19,11559,1,0)
^19.06^2^2^3150113^^^^
"KRN",19,11559,1,1,0)
This menu is placed on the AR Supervisor's Menu.  It contains
"KRN",19,11559,1,2,0)
 options for Cross-Servicing.
"KRN",19,11559,10,0)
^19.01IP^10^10
"KRN",19,11559,10,1,0)
11556
"KRN",19,11559,10,1,"^")
RCTCSP STOP
"KRN",19,11559,10,2,0)
11557
"KRN",19,11559,10,2,"^")
RCTCSP RECALLB
"KRN",19,11559,10,3,0)
11558
"KRN",19,11559,10,3,"^")
RCTCSP RECALLD
"KRN",19,11559,10,4,0)
11560
"KRN",19,11559,10,4,"^")
RCTCSP BILL REPORT
"KRN",19,11559,10,5,0)
11561
"KRN",19,11559,10,5,"^")
RCTCSP REPORT
"KRN",19,11559,10,6,0)
11562
"KRN",19,11559,10,6,"^")
RCTCSP RECALL REPORT
"KRN",19,11559,10,8,0)
11572
"KRN",19,11559,10,8,"^")
RCTCSP RECONCIL REPORT
"KRN",19,11559,10,9,0)
11574^
"KRN",19,11559,10,9,"^")
RCTCSP REJECT REPORT
"KRN",19,11559,10,10,0)
11575^
"KRN",19,11559,10,10,"^")
RCTCSP IAI ERROR CODES LIST
"KRN",19,11559,99)
64231,38758
"KRN",19,11559,"U")
CROSS-SERVICING MENU
"KRN",19,11560,-1)
0^6
"KRN",19,11560,0)
RCTCSP BILL REPORT^Cross-Servicing Bill Report^^R^^^^^^^^
"KRN",19,11560,1,0)
^19.06^5^5^3150113^^^^
"KRN",19,11560,1,1,0)
This report lists the bills for the individual debtor that have been
"KRN",19,11560,1,2,0)
forwarded to Cross-Servicing.  For each bill, the report displays
"KRN",19,11560,1,3,0)
the status code, the original amount of the bill, the current amount of
"KRN",19,11560,1,4,0)
the bill, the principle, interest, administrative cost, court cost, and
"KRN",19,11560,1,5,0)
the Cross-Servicing referral date.
"KRN",19,11560,25)
BILLREP^RCTCSP1
"KRN",19,11560,"U")
CROSS-SERVICING BILL REPORT
"KRN",19,11561,-1)
0^8
"KRN",19,11561,0)
RCTCSP REPORT^Print Cross-Servicing Report^^R^^^^^^^^
"KRN",19,11561,1,0)
^19.06^5^5^3150113^^^
"KRN",19,11561,1,1,0)
This option is used to print a Cross-Servicing report.  For each bill 
"KRN",19,11561,1,2,0)
which has been referred to Cross-Servicing, the report will display the
"KRN",19,11561,1,3,0)
Debtor's name, the Debtor SSN, the original amount referred, and the 
"KRN",19,11561,1,4,0)
Cross-Servicing referred date.  The user will have the option of sorting
"KRN",19,11561,1,5,0)
by Bill Number, Debtor Name, or Cross-Servicing Referred Date.
"KRN",19,11561,25)
CSRPRT^RCTCSP1
"KRN",19,11561,"U")
PRINT CROSS-SERVICING REPORT
"KRN",19,11562,-1)
0^7
"KRN",19,11562,0)
RCTCSP RECALL REPORT^Cross-Servicing Recall Report^^R^^^^^^^^
"KRN",19,11562,1,0)
^19.06^3^3^3150113^^^^
"KRN",19,11562,1,1,0)
The Cross-Servicing Recall Report lists the bills that have been recalled
"KRN",19,11562,1,2,0)
from Cross-Servicing.  The report has two sort options, a sort by Bill 
"KRN",19,11562,1,3,0)
Number, and a sort by Debtor Name.
"KRN",19,11562,25)
CSRCLRT^RCTCSP1
"KRN",19,11562,"U")
CROSS-SERVICING RECALL REPORT
"KRN",19,11563,-1)
0^10
"KRN",19,11563,0)
RCTCSPR SERVER^TCSP Reconciliation Messages^^S^^^^^^^^
"KRN",19,11563,1,0)
^^2^2^3140718^
"KRN",19,11563,1,1,0)
This server processes reconciliation messages from Treasury for the Cross
"KRN",19,11563,1,2,0)
Servicing referral process.
"KRN",19,11563,25)
RCTCSPRS
"KRN",19,11563,220)
^R^^Y^Y^R^1
"KRN",19,11563,"U")
TCSP RECONCILIATION MESSAGES
"KRN",19,11572,-1)
0^12
"KRN",19,11572,0)
RCTCSP RECONCIL REPORT^Print Reconciliation Report^^R^^^^^^^^
"KRN",19,11572,1,0)
^19.06^8^8^3140926^^^
"KRN",19,11572,1,1,0)
This option is used to print a Reconciliation Report.  For
"KRN",19,11572,1,2,0)
each bill which has been returned from Treasury by reconciliation,
"KRN",19,11572,1,3,0)
the report will display the Debtor's name, Bill Number, Returned
"KRN",19,11572,1,4,0)
Date, and Closed Date.  A second text line will display 
"KRN",19,11572,1,5,0)
the Returned Code Description.  If there is a Date of Death,
"KRN",19,11572,1,6,0)
a Date of Bankruptcy, or a Date of Dissolution, then this
"KRN",19,11572,1,7,0)
date will appear on a new line with a text description and
"KRN",19,11572,1,8,0)
the date.
"KRN",19,11572,25)
RCRPRT^RCTCSP2
"KRN",19,11572,"U")
PRINT RECONCILIATION REPORT
"KRN",19,11574,-1)
0^15
"KRN",19,11574,0)
RCTCSP REJECT REPORT^Debt Referral Reject Report^^R^^^^^^^^
"KRN",19,11574,1,0)
4^19.06^10^10^3141208^^^^
"KRN",19,11574,1,1,0)
This option allows the user to report identified Debt Referral Rejects.
"KRN",19,11574,1,2,0)
 
"KRN",19,11574,1,3,0)
The report prints out based on the following user defined parameters: 
"KRN",19,11574,1,4,0)
 (i.e. -Range of Dates,   -in either Brief or Detail mode,
"KRN",19,11574,1,5,0)
       -sorted by Bill Number, Debtor Name or CS Referred Date,
"KRN",19,11574,1,6,0)
       -for a given Reject Origination Source (or All),
"KRN",19,11574,1,7,0)
       -and in either Ascending or Descending print order.)
"KRN",19,11574,1,8,0)
 
"KRN",19,11574,1,9,0)
In addition, output can be made to a device or file in either print 
"KRN",19,11574,1,10,0)
or in Excel spreadsheet format.
"KRN",19,11574,25)
RJRPT^RCTCSJR
"KRN",19,11574,"U")
DEBT REFERRAL REJECT REPORT
"KRN",19,11575,-1)
0^14
"KRN",19,11575,0)
RCTCSP IAI ERROR CODES LIST^List IAI Error Codes^^R^^^^^^^^
"KRN",19,11575,1,0)
^19.06^3^3^3141112^^
"KRN",19,11575,1,1,0)
This option is a listing of the IAI Error Codes, in error code order.  Its
"KRN",19,11575,1,2,0)
display contains a) Error Code, b) Field Name, c) associated Record Types 
"KRN",19,11575,1,3,0)
and d) Description.
"KRN",19,11575,25)
ECLIST^RCTCSJR
"KRN",19,11575,"U")
LIST IAI ERROR CODES
"KRN",19,11576,-1)
0^16
"KRN",19,11576,0)
RCTCSP REJ SERVER^TCSP Reject Return Messages^^S^^^^^^^^
"KRN",19,11576,1,0)
^19.06^2^2^3150113^^^
"KRN",19,11576,1,1,0)
This server processes rejection messages for the Cross-Servicing referral
"KRN",19,11576,1,2,0)
process.
"KRN",19,11576,25)
SERVER^RCTCSJS
"KRN",19,11576,220)
^R^^Y^Y^R^1
"KRN",19,11576,"U")
TCSP REJECT RETURN MESSAGES
"KRN",19,11577,-1)
0^18
"KRN",19,11577,0)
RCTCSPD SERVER^Due Process Notification Server^^S^^^^^^^^
"KRN",19,11577,1,0)
^19.06^2^2^3150325^^
"KRN",19,11577,1,1,0)
This server processes reject messages from AITC
"KRN",19,11577,1,2,0)
for Due Process Notification letters.
"KRN",19,11577,25)
RCTCSP3S
"KRN",19,11577,220)
^R^^Y^Y^E^1
"KRN",19,11577,"U")
DUE PROCESS NOTIFICATION SERVE
"MBREQ")
0
"ORD",5,.4)
.4;5;;;EDEOUT^DIFROMSO(.4,DA,"",XPDA);FPRE^DIFROMSI(.4,"",XPDA);EPRE^DIFROMSI(.4,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.4,DA,"",XPDA);DEL^DIFROMSK(.4,"",%)
"ORD",5,.4,0)
PRINT TEMPLATE
"ORD",11,3.8)
3.8;11;;;MAILG^XPDTA1;MAILGF1^XPDIA1;MAILGE1^XPDIA1;MAILGF2^XPDIA1;;MAILGDEL^XPDIA1(%)
"ORD",11,3.8,0)
MAIL GROUP
"ORD",18,19)
19;18;;;OPT^XPDTA;OPTF1^XPDIA;OPTE1^XPDIA;OPTF2^XPDIA;;OPTDEL^XPDIA
"ORD",18,19,0)
OPTION
"PKG",53,-1)
1^1
"PKG",53,0)
ACCOUNTS RECEIVABLE^PRCA^FMS
"PKG",53,20,0)
^9.402P^1^1
"PKG",53,20,1,0)
2^^PRCAMRG
"PKG",53,20,1,1)

"PKG",53,20,"B",2,1)

"PKG",53,22,0)
^9.49I^1^1
"PKG",53,22,1,0)
4.5^2950913^2960627
"PKG",53,22,1,"PAH",1,0)
301^3161109^100992
"PKG",53,22,1,"PAH",1,1,0)
^^3^3^3161109
"PKG",53,22,1,"PAH",1,1,1,0)
This patch contains VistA changes to support technology and
"PKG",53,22,1,"PAH",1,1,2,0)
business changes that are occurring with the implementation of
"PKG",53,22,1,"PAH",1,1,3,0)
the Treasury Cross Servicing project.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
YES
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
45
"RTN","PRCAAPR1")
0^13^B45827636
"RTN","PRCAAPR1",1,0)
PRCAAPR1 ;WASH-ISC@ALTOONA,PA/RGY - PATIENT ACCOUNT PROFILE ;2/12/97  11:48 AM
"RTN","PRCAAPR1",2,0)
 ;;4.5;Accounts Receivable;**34,45,108,143,141,206,192,218,276,275,284,303,301**;Mar 20, 1995;Build 144
"RTN","PRCAAPR1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAAPR1",4,0)
 ;
"RTN","PRCAAPR1",5,0)
HDR ;Head for Account profile
"RTN","PRCAAPR1",6,0)
 S X="",$P(X,"=",23)="" W @IOF,!,X,"   A c c o u n t   P r o f i l e   ",X
"RTN","PRCAAPR1",7,0)
HDR1 N DMC,IBRX,RSN,TOP4,TOP6,DPTFLG,ACCTNUM,RCCV
"RTN","PRCAAPR1",8,0)
 S IBRX=0,DPTFLG=0
"RTN","PRCAAPR1",9,0)
 ;
"RTN","PRCAAPR1",10,0)
 ; PRCAAPR cleans up BILL, COUNT, DEBT, DTOUT, DIC, OUT, PRCADB, SEL, X
"RTN","PRCAAPR1",11,0)
 ;Display new 'Statement Account Number" (Patch 206)
"RTN","PRCAAPR1",12,0)
 I PRCADB["DPT(" S DPTFLG=1,ACCTNUM=$$ACCT(PRCADB)
"RTN","PRCAAPR1",13,0)
 ;
"RTN","PRCAAPR1",14,0)
 W !,$P(DEBT,"^",2) I DPTFLG!(PRCADB["VA(200,") S X=$S(PRCADB["DPT(":$P(^DPT(+PRCADB,0),"^",9),1:$P($G(^VA(200,+PRCADB,1)),"^",9)) W " (",$E(X,1,3),"-",$E(X,4,5),"-",$E(X,6,9),")"
"RTN","PRCAAPR1",15,0)
 W ?53,"Statement Day: ",$S($$PST^RCAMFN01(+DEBT)>0:$$PST^RCAMFN01(+DEBT),1:"N/A")
"RTN","PRCAAPR1",16,0)
 K Y S X("ADD")=$$DADD^RCAMADD(PRCADB)
"RTN","PRCAAPR1",17,0)
 ;
"RTN","PRCAAPR1",18,0)
 ;Display new 'Statement Account Number" (Patch 206)
"RTN","PRCAAPR1",19,0)
 I DPTFLG W !,"Statement Account #: ",ACCTNUM,?52,"Last Statement: "
"RTN","PRCAAPR1",20,0)
 E  W !?52,"Last Statement: "
"RTN","PRCAAPR1",21,0)
 ;
"RTN","PRCAAPR1",22,0)
 S Y=+$$LST^RCFN01(PRCADB,2)
"RTN","PRCAAPR1",23,0)
 I Y>0 S Y("CCPC")=$$FPS^RCCPCFN(+DEBT) S:Y("CCPC") Y=+$P(Y("CCPC"),"^")
"RTN","PRCAAPR1",24,0)
 W $S(Y=-1:"N/A",1:$$SLH^RCFN01(Y))
"RTN","PRCAAPR1",25,0)
 W !,$P(X("ADD"),"^")
"RTN","PRCAAPR1",26,0)
 W:+$G(Y("CCPC")) ?52,"Activity as of: ",$$SLH^RCFN01($$ASOF^RCCPCFN($P(Y("CCPC"),"^",2)))
"RTN","PRCAAPR1",27,0)
 W:$P(X("ADD"),"^",2)]"" !,$P(X("ADD"),"^",2) W:$P(X("ADD"),"^",3)]"" !,$P(X("ADD"),"^",3)
"RTN","PRCAAPR1",28,0)
 W ! W:$P(X("ADD"),"^",4)]"" $P(X("ADD"),"^",4),", ",$P(X("ADD"),"^",5),"  ",$S($P(X("ADD"),"^",6):$P(X("ADD"),"^",6),1:$P(X("ADD"),"^",8))
"RTN","PRCAAPR1",29,0)
 W ?55,"Amount Owed: ",?69,$J(+$G(^TMP("PRCAAPR",$J,"C")),9,2)
"RTN","PRCAAPR1",30,0)
 W !,"Phone #: ",$S($P(X("ADD"),"^",7)]"":$P(X("ADD"),"^",7),1:"N/A")
"RTN","PRCAAPR1",31,0)
 I PRCADB["DPT(" W ?51,"RX Copay Exempt: " S IBRX=$$RXST^IBARXEU(+PRCADB,DT) W $S($P(IBRX,U)=1:"YES",$P(IBRX,U)=0:"NO",1:"N/A")
"RTN","PRCAAPR1",32,0)
 I PRCADB["DPT(" W !?57,"CV Status: " S RCCV=$$CVEDT^DGCV(+PRCADB,DT) W $S($P(RCCV,U,3)>0:"YES",1:"NO") I $P(RCCV,U,2) W !?52,"CV Status Ends: ",$$SLH^RCFN01($P(RCCV,U,2))
"RTN","PRCAAPR1",33,0)
 ; *108 add exemption reason/dmc info
"RTN","PRCAAPR1",34,0)
 I IBRX>0,($P(IBRX,U)=1) S DIC="^IBE(354.2,",DIC(0)="M",X=+$P(IBRX,"^",3) D ^DIC I Y>0 W !,?54,"(",$P(Y,"^",2),")"
"RTN","PRCAAPR1",35,0)
 I $D(^RCD(340,"DMC",1,+DEBT)) S DMC=$G(^RCD(340,+DEBT,3)) D
"RTN","PRCAAPR1",36,0)
 .I $P(DMC,"^",2) W !,"** Account forwarded to DMC: ",$$SLH^RCFN01($P(DMC,"^",2)),?50,"Total DMC Amount: ",?69,$J($P(DMC,"^",5),9,2)
"RTN","PRCAAPR1",37,0)
 .I $P(DMC,"^",9)'="" W !,?49,"Lesser Amt to DMC: ",?69,$J($P(DMC,"^",9),9,2)
"RTN","PRCAAPR1",38,0)
 .Q
"RTN","PRCAAPR1",39,0)
 I $D(^RCD(340,"TOP",+DEBT)) S TOP4=$G(^RCD(340,+DEBT,4)),TOP6=$G(^(6)) D
"RTN","PRCAAPR1",40,0)
 .I +TOP6 W !,"** Account forwarded to TOP: ",$$SLH^RCFN01($P(TOP6,"^")),?45,"Total TOP Amount: ",?65,$J($P(TOP4,"^",3),13,2)
"RTN","PRCAAPR1",41,0)
 .I $P(TOP6,"^",6) W !,?45,"TOP HOLD DATE: ",$$SLH^RCFN01($P(TOP6,"^",6))
"RTN","PRCAAPR1",42,0)
 .Q
"RTN","PRCAAPR1",43,0)
 I $D(^RCD(340,"TCSP",+DEBT)) D
"RTN","PRCAAPR1",44,0)
 .W !,"x Debt Referred to Cross-Servicing",?45,"Total CS Debt: ",?65,$J($$TOTALB^RCTCSPU(+DEBT),13,2)
"RTN","PRCAAPR1",45,0)
 .Q
"RTN","PRCAAPR1",46,0)
 I $O(^RCD(340,+DEBT,2,0)) D
"RTN","PRCAAPR1",47,0)
 .S Y=0 F X=0:0 S X=$O(^RCD(340,+DEBT,2,X)) Q:'X  W:'Y ! W !,$G(^(X,0)) S Y=Y+1 W:Y=3&$O(^RCD(340,+DEBT,2,X)) "..." Q:Y=3
"RTN","PRCAAPR1",48,0)
 .Q
"RTN","PRCAAPR1",49,0)
 Q
"RTN","PRCAAPR1",50,0)
 ; PRCA*4.5*276 - moved headers right to add EOB indicator to bill #, adjusted at tag BLN accordingly
"RTN","PRCAAPR1",51,0)
 ; PRCA*4.5*275 - moved headers to line up with column changes
"RTN","PRCAAPR1",52,0)
HDR2 W !!,"#",?5,"Bill #",?20,"Est",?31,"Type",?43,"Paid",?52,"Prin",?58,"Int",?64,"Adm",?72,"Balance"
"RTN","PRCAAPR1",53,0)
 Q
"RTN","PRCAAPR1",54,0)
DIS ;Display bill line items
"RTN","PRCAAPR1",55,0)
 NEW STAT1
"RTN","PRCAAPR1",56,0)
 I '$O(^TMP("PRCAAPR",$J,"C",0)) S X="",$P(X,"*",22)="" W !!,X,"  NO ACCOUNT INFORMATION AVAILABLE  ",X G Q1
"RTN","PRCAAPR1",57,0)
 F STAT1=0:0 S STAT1=$O(^TMP("PRCAAPR",$J,"C",STAT1)) Q:'STAT1!$D(OUT)  D BHDR S BILL=0 F  S BILL=$O(^TMP("PRCAAPR",$J,"C",STAT1,BILL)) Q:BILL=""!$D(OUT)  D BLN
"RTN","PRCAAPR1",58,0)
 I '$D(OUT) D READ
"RTN","PRCAAPR1",59,0)
Q1 Q
"RTN","PRCAAPR1",60,0)
BHDR ;Display status line
"RTN","PRCAAPR1",61,0)
 S X=$S(+$P(^TMP("PRCAAPR",$J,"C",STAT1),"^",2)=99:"PAYMENTS",1:$P($G(^PRCA(430.3,+$O(^PRCA(430.3,"AC",+$P(^TMP("PRCAAPR",$J,"C",STAT1),"^",2),0)),0)),"^"))
"RTN","PRCAAPR1",62,0)
 S Y=" "_X_" ("_$J(+^TMP("PRCAAPR",$J,"C",STAT1),0,2)_") " W ! F X=1:1:80-$L(Y)/2 W "-"
"RTN","PRCAAPR1",63,0)
 W Y F X=1:1:IOM-$X-1 W "-"
"RTN","PRCAAPR1",64,0)
 Q
"RTN","PRCAAPR1",65,0)
BLN ;
"RTN","PRCAAPR1",66,0)
 N PRCOUT,REJFLAG
"RTN","PRCAAPR1",67,0)
 I $Y+5>IOSL,COUNT D READ G:$D(OUT) Q2 D HDR,HDR2,BHDR
"RTN","PRCAAPR1",68,0)
 ; PRCA*4.5*276, attach EOB indicator '%' to bill # when applicable
"RTN","PRCAAPR1",69,0)
 S PRCOUT=$$COMP3^PRCAAPR(BILL)
"RTN","PRCAAPR1",70,0)
 I STAT1'=99,PRCOUT'="%" S PRCOUT=$$IBEEOBCK(BILL)
"RTN","PRCAAPR1",71,0)
 ; PRCA*4.5*303 - add reject indicator to kbill if applicable ; #IA 6060
"RTN","PRCAAPR1",72,0)
 S REJFLAG=0 S:STAT1'=99 REJFLAG=$$BILLREJ^IBJTU6($P($P($G(^PRCA(430,BILL,0)),"^"),"-",2))
"RTN","PRCAAPR1",73,0)
 S:STAT1'=99 COUNT=COUNT+1,^TMP("PRCAAPR",$J,"O",COUNT)=BILL S X=$S(STAT1=99:BILL,1:$G(PRCOUT)_$S(REJFLAG:"c",1:"")_$G(^PRCA(430,BILL,0)))
"RTN","PRCAAPR1",74,0)
 ; PRCA*4.5*303 - End
"RTN","PRCAAPR1",75,0)
 I $D(^PRCA(430,"TCSP",BILL)) S X="x"_X ;prca*4.5*301
"RTN","PRCAAPR1",76,0)
 W !,$S(STAT1'=99:COUNT,1:"*"),?4,$P(X,"^") W:STAT1'=99 ?20,$$SLH^RCFN01($P(X,"^",10))
"RTN","PRCAAPR1",77,0)
 W:STAT1'=99 ?31,$S($P(X,"^",2)=31:"TRIC PT",1:$E($P($G(^PRCA(430.2,$S($O(^PRCA(430.2,"AC",24,0))=$P(X,"^",2):+$P(X,"^",16),1:+$P(X,"^",2)),0)),"^"),1,7))  ; PRCA*4.5*192 changed CHMP PT to TRIC PT
"RTN","PRCAAPR1",78,0)
 W:STAT1=99 ?31,"PAYMENT"
"RTN","PRCAAPR1",79,0)
 S X=$S(STAT1=99:"^^^^^^"_^TMP("PRCAAPR",$J,"C",STAT1,BILL),1:$G(^PRCA(430,BILL,7))) W ?39 W:STAT1=99 "-" W $J($P(X,"^",7)+$P(X,"^",8)+$P(X,"^",9)+$P(X,"^",10)+$P(X,"^",11),8,2)
"RTN","PRCAAPR1",80,0)
 W ?48 W:STAT1=99 " " W:STAT1'=99 $S($P(^PRCA(430,BILL,0),"^",2)=$O(^PRCA(430.2,"AC",33,0)):"-",1:" ")
"RTN","PRCAAPR1",81,0)
 W $J($P(X,"^"),7,2),?57,$J($P(X,"^",2),5,2),?63,$J($P(X,"^",3),5,2),?69,$S(STAT1=99:"-",$P(^PRCA(430,BILL,0),"^",2)=$O(^PRCA(430.2,"AC",33,0)):"-",1:" ")
"RTN","PRCAAPR1",82,0)
 W $S(STAT1=99:$J(^TMP("PRCAAPR",$J,"C",STAT1,BILL),9,2),1:$J($P(X,"^")+$P(X,"^",2)+$P(X,"^",3)+$P(X,"^",4)+$P(X,"^",5),9,2))
"RTN","PRCAAPR1",83,0)
 K ^TMP("PRCAAPR",$J,"C",STAT1,BILL) K:$O(^TMP("PRCAAPR",$J,"C",STAT1,""))="" ^TMP("PRCAAPR",$J,"C",STAT1)
"RTN","PRCAAPR1",84,0)
Q2 Q
"RTN","PRCAAPR1",85,0)
READ ;Read bill number
"RTN","PRCAAPR1",86,0)
 W !!,"Select 1-",COUNT W:$O(^TMP("PRCAAPR",$J,"C","")) " or return to continue" R ": ",X:DTIME I X["^"!'$T S:'$T DTOUT=1 S OUT=1 G Q3
"RTN","PRCAAPR1",87,0)
 I X["?" W !!,"To see detailed information for a bill number, enter the corresponding '#'",!,"next to the bill.  (Ex: 1 or 1,3)" G READ
"RTN","PRCAAPR1",88,0)
 I X="",'$O(^TMP("PRCAAPR",$J,"C","")) S OUT=1 G Q3
"RTN","PRCAAPR1",89,0)
 G:X="" Q3 S SEL=X
"RTN","PRCAAPR1",90,0)
 F X=1:1:$L(SEL,",") S Y=$P(SEL,",",X) I Y'?1N.N!'$D(^TMP("PRCAAPR",$J,"O",+Y)) W *7," ??" G READ
"RTN","PRCAAPR1",91,0)
 S OUT=1 F X=1:1:$L(SEL,",") S Y=$P(SEL,",",X) D EN1^PRCAATR($G(^TMP("PRCAAPR",$J,"O",+Y)))
"RTN","PRCAAPR1",92,0)
Q3 Q
"RTN","PRCAAPR1",93,0)
 ;
"RTN","PRCAAPR1",94,0)
ACCT(DFN) ;Get account number. Join station with DFN (Patch 206)
"RTN","PRCAAPR1",95,0)
 N SITE,ACCT,ACCT1,LEN
"RTN","PRCAAPR1",96,0)
 S DFN=+DFN
"RTN","PRCAAPR1",97,0)
 S LEN=$L(DFN)-1
"RTN","PRCAAPR1",98,0)
 S SITE=$$SITE^RCMSITE                          ;station number
"RTN","PRCAAPR1",99,0)
 S ACCT=$$RJ^XLFSTR(DFN,13,0)                   ;add leading zeroes
"RTN","PRCAAPR1",100,0)
 S ACCT1=SITE_"-"_$E(ACCT,1,$L(ACCT)-$L(DFN))   ;add hyphen
"RTN","PRCAAPR1",101,0)
 S ACCT1=ACCT1_"-"_$E(ACCT,$L(ACCT)-LEN,99)     ;add hyphen
"RTN","PRCAAPR1",102,0)
 S ACCT1=ACCT1_"-"_$E($P($P(DEBT,U,2),","),1,5) ;add last name
"RTN","PRCAAPR1",103,0)
 Q ACCT1
"RTN","PRCAAPR1",104,0)
 ;
"RTN","PRCAAPR1",105,0)
 ; PRCA*4.5*276 -  Use Event Date to find an associated 3rd Party bill with an associated EEOB
"RTN","PRCAAPR1",106,0)
IBEEOBCK(PRCAAR) ; Passed AR Bill
"RTN","PRCAAPR1",107,0)
 ; Function will quit as soon as a 3rd party bill is located that has an associated EEOB
"RTN","PRCAAPR1",108,0)
 ;
"RTN","PRCAAPR1",109,0)
 ; Find 3rd Party Bills with an Event Date
"RTN","PRCAAPR1",110,0)
 N PRCAREF,PRCAEEOB,PRCADT,DFN,DBTR,X1
"RTN","PRCAAPR1",111,0)
 ; Get DFN
"RTN","PRCAAPR1",112,0)
 S DBTR=+$P($G(^PRCA(430,PRCAAR,0)),U,9)
"RTN","PRCAAPR1",113,0)
 S X1=$P($G(^RCD(340,DBTR,0)),U) I X1'["DPT" Q ""
"RTN","PRCAAPR1",114,0)
 S DFN=+X1
"RTN","PRCAAPR1",115,0)
 S PRCAEEOB=""
"RTN","PRCAAPR1",116,0)
 ; Loop through Xref of ARbill (#430) to Action file (#350)
"RTN","PRCAAPR1",117,0)
 I +$G(PRCAAR) S PRCAREF=0 F  S PRCAREF=$O(^IB("ABIL",$P($G(^PRCA(430,PRCAAR,0)),"^"),PRCAREF)) Q:'PRCAREF  D  Q:PRCAEEOB="%"
"RTN","PRCAAPR1",118,0)
 . S PRCADT=$P($G(^IB(PRCAREF,0)),"^",17) ;Get event Date
"RTN","PRCAAPR1",119,0)
 . I PRCADT S PRCAEEOB=$$TPEVDT(DFN,PRCADT) Q:PRCAEEOB="%"
"RTN","PRCAAPR1",120,0)
 . I PRCADT S PRCAEEOB=$$TPOPV(DFN,PRCADT)
"RTN","PRCAAPR1",121,0)
 ;
"RTN","PRCAAPR1",122,0)
 Q PRCAEEOB
"RTN","PRCAAPR1",123,0)
 ;
"RTN","PRCAAPR1",124,0)
 ; PRCA*4.5*276 - Traverse all THIRD PARTY bills for a patient with a specific Event Date (399,.03)
"RTN","PRCAAPR1",125,0)
TPEVDT(DFN,EVDT) ;
"RTN","PRCAAPR1",126,0)
 ; Function will quit as soon as a 3rd party bill is located that has an associated EEOB
"RTN","PRCAAPR1",127,0)
 ; PRCA*4.5*284 - Use the 399,"APDT" (by patient) index instead of the 399,"D" index for efficiency
"RTN","PRCAAPR1",128,0)
 I '$G(DFN)!'$G(EVDT) Q ""
"RTN","PRCAAPR1",129,0)
 N PRCAIFN,PRCAEEOB
"RTN","PRCAAPR1",130,0)
 S PRCAEEOB="",PRCAIFN=""
"RTN","PRCAAPR1",131,0)
 F  S PRCAIFN=$O(^DGCR(399,"APDT",DFN,PRCAIFN),-1) Q:'PRCAIFN  D  Q:PRCAEEOB="%"
"RTN","PRCAAPR1",132,0)
 . I $D(^DGCR(399,"APDT",DFN,PRCAIFN,9999999-EVDT)) S PRCAEEOB=$$COMP3^PRCAAPR(PRCAIFN)
"RTN","PRCAAPR1",133,0)
 Q PRCAEEOB
"RTN","PRCAAPR1",134,0)
 ;
"RTN","PRCAAPR1",135,0)
 ; PRCA*4.5*276 - Traverse all THIRD PARTY bills for a patient with any Opt Visit Dates same as Event Date (399,43)
"RTN","PRCAAPR1",136,0)
TPOPV(DFN,EVDT) ;
"RTN","PRCAAPR1",137,0)
 ; Function will quit as soon as a 3rd party bill is located that has an associated EEOB
"RTN","PRCAAPR1",138,0)
 N PRCAIFN,PRCAEEOB
"RTN","PRCAAPR1",139,0)
 S PRCAEEOB=""
"RTN","PRCAAPR1",140,0)
 I +$G(DFN),+$G(EVDT) S PRCAIFN=0 F  S PRCAIFN=$O(^DGCR(399,"AOPV",DFN,EVDT,PRCAIFN)) Q:'PRCAIFN  D  Q:PRCAEEOB="%"
"RTN","PRCAAPR1",141,0)
 . ; attach EOB indicator '%' to bill # when applicable
"RTN","PRCAAPR1",142,0)
 . S PRCAEEOB=$$COMP3^PRCAAPR(PRCAIFN)
"RTN","PRCAAPR1",143,0)
 Q PRCAEEOB
"RTN","PRCAATR")
0^14^B22771269
"RTN","PRCAATR",1,0)
PRCAATR ;WASH-ISC@ALTOONA,PA/RGY - VIEW TRANSACTION FOR BILLS ;2/14/96  2:46 PM
"RTN","PRCAATR",2,0)
V ;;4.5;Accounts Receivable;**36,104,172,138,233,276,303,301**;Mar 20, 1995;Build 144
"RTN","PRCAATR",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAATR",4,0)
 ;
"RTN","PRCAATR",5,0)
 ; PRCAAPR cleans up DEBT, DTOUT
"RTN","PRCAATR",6,0)
EN1(BILL) ;ENTRY POINT FROM PRCAAPR
"RTN","PRCAATR",7,0)
 NEW X,Y,COUNT,OUT,TRAN,SEL,PRCAATRX,PRCAIO,PRCAIOS,D0,PRCAQUE,POP,PRCAPRT,Y,ZTSK,PRCOUT,PRCA15,REJFLG
"RTN","PRCAATR",8,0)
 I '$D(BILL) G Q
"RTN","PRCAATR",9,0)
 I BILL'?1N.N!'$D(^PRCA(430,+BILL,0)) G Q
"RTN","PRCAATR",10,0)
 ; PRCA*4.5*276
"RTN","PRCAATR",11,0)
 S PRCOUT=$$COMP3^PRCAAPR(BILL) ; check for 1st and 3rd party payments
"RTN","PRCAATR",12,0)
 I PRCOUT'="%" S PRCOUT=$$IBEEOBCK^PRCAAPR1(BILL)
"RTN","PRCAATR",13,0)
 S PRCAPRT=1,PRCAIO=IO(0),PRCAIO(0)=IO(0),COUNT=0 K ^TMP("PRCAATR",$J)
"RTN","PRCAATR",14,0)
 D HDR,DIS,^%ZISC
"RTN","PRCAATR",15,0)
Q K ^TMP("PRCAATR",$J),IO("Q") Q
"RTN","PRCAATR",16,0)
HDR ;Header
"RTN","PRCAATR",17,0)
 D HDR^PRCAAPR1
"RTN","PRCAATR",18,0)
 I $P($G(^PRCA(430,BILL,13)),"^") W !,"MEDICARE CONTRACTUAL ADJUSTMENT: ",$J($P($G(^PRCA(430,BILL,13)),"^"),0,2)
"RTN","PRCAATR",19,0)
 I $P($G(^PRCA(430,BILL,13)),"^",2) W !,"UNREIMBURSED MEDICARE EXPENSE: ",$J($P($G(^PRCA(430,BILL,13)),"^",2),0,2)
"RTN","PRCAATR",20,0)
 ; PRCA*4.5*303 - Adding reject indicator, 'x' to bill number when applicable
"RTN","PRCAATR",21,0)
 S REJFLG=$$BILLREJ^IBJTU6($P($P($G(^PRCA(430,BILL,0)),"^"),"-",2)) ; IA# 6060
"RTN","PRCAATR",22,0)
 ; PRCA*4.5*276 - attach EEOB indicator to bill number
"RTN","PRCAATR",23,0)
 I +$G(^PRCA(430,BILL,15)) S PRCA15=^(15) I $P(PRCA15,U)]"" W !,"CS Referred Date: " S Y=$P(PRCA15,U) D DD^%DT W Y  ;prca*4.5*301
"RTN","PRCAATR",24,0)
 S PRCA15=$G(^PRCA(430,BILL,15)) D
"RTN","PRCAATR",25,0)
 .I $P(PRCA15,U,2)]"" W !,"CS Recall Reason: ",$E($$GET1^DIQ(430,BILL,154),1,31) W ?51,"CS Recall Date: " S Y=$P(PRCA15,U,3) D DD^%DT W Y Q  ;prca*4.5*301
"RTN","PRCAATR",26,0)
 .I $P(PRCA15,U,4)]"",$P(PRCA15,U,2)="" W !,"CS Recall Reason: ",$E($$GET1^DIQ(430,BILL,154),1,31) W ?51,"CS Recall Date: "
"RTN","PRCAATR",27,0)
 W ! D PROFRJ^RCTCSJS1(BILL) ; Reject history  ;prca*4.5*301
"RTN","PRCAATR",28,0)
 W !,"Bill #: ",$G(PRCOUT)_$S(REJFLG:"c",1:"")_$P(^PRCA(430,BILL,0),"^") D:$P(^(0),"^",9)'=+DEBT DEB
"RTN","PRCAATR",29,0)
 W !!,"#",?8,"Tr #",?17,"Type",?52,"Date",?70,"Amount"
"RTN","PRCAATR",30,0)
 S X="",$P(X,"-",IOM)="" W !,X
"RTN","PRCAATR",31,0)
 Q
"RTN","PRCAATR",32,0)
DIS ;Display transactions
"RTN","PRCAATR",33,0)
 W !,?17,"Original Amount",?52,$$SLH^RCFN01($P(^PRCA(430,BILL,0),"^",10)),?65,$J($P(^(0),"^",3),11,2)
"RTN","PRCAATR",34,0)
 I '$O(^PRCA(433,"C",BILL,0)) D
"RTN","PRCAATR",35,0)
 . S X="",$P(X,"*",20)="" W !!,X,"  NO TRANSACTION INFORMATION AVAILABLE  ",X
"RTN","PRCAATR",36,0)
RD . R !!,"Press return to continue: ",X:DTIME S:'$T DTOUT=1 S OUT=1
"RTN","PRCAATR",37,0)
 . I X["?" W !!,"Press the return key to return to menu." G RD
"RTN","PRCAATR",38,0)
 . Q
"RTN","PRCAATR",39,0)
 F TRAN=0:0 S TRAN=$O(^PRCA(433,"C",BILL,TRAN)) Q:'TRAN!$D(OUT)  D TLN
"RTN","PRCAATR",40,0)
 S X=$G(^PRCA(430,BILL,7))
"RTN","PRCAATR",41,0)
 I '$D(OUT) W !?65,"-----------",!,?64,"$",$J($P(X,"^")+$P(X,"^",2)+$P(X,"^",3)+$P(X,"^",4)+$P(X,"^",5),11,2) D READ
"RTN","PRCAATR",42,0)
 Q
"RTN","PRCAATR",43,0)
TLN ;Display a transaction
"RTN","PRCAATR",44,0)
 N YR
"RTN","PRCAATR",45,0)
 I $Y+5>IOSL,COUNT D READ G:$D(DTOUT)!$D(OUT) Q1 D HDR
"RTN","PRCAATR",46,0)
 S COUNT=COUNT+1,X=$G(^PRCA(433,TRAN,1)),^TMP("PRCAATR",$J,COUNT)=TRAN
"RTN","PRCAATR",47,0)
 W !,COUNT,$S($P(^PRCA(433,TRAN,0),"^",4)=1!$P(^(0),"^",10):"(I)",1:""),?8,TRAN,?17
"RTN","PRCAATR",48,0)
 W $S($P($G(^PRCA(430.3,+$P(X,"^",2),0)),"^",3)=17:$P($G(^PRCA(433,TRAN,5)),"^",2),1:$P($G(^(0)),"^"))
"RTN","PRCAATR",49,0)
 ;  show decrease adjustments as negative (patch 4.5*172)
"RTN","PRCAATR",50,0)
 I $P(X,"^",2)=35 S:$P(X,"^",5)>0 $P(X,"^",5)=-$P(X,"^",5)
"RTN","PRCAATR",51,0)
 W ?52,$S(+X:$$SLH^RCFN01(+X),1:""),?65,$J($P(X,"^",5),11,2)
"RTN","PRCAATR",52,0)
Q1 Q
"RTN","PRCAATR",53,0)
READ ;Read a trans number
"RTN","PRCAATR",54,0)
 I IO'=IO(0) G Q2
"RTN","PRCAATR",55,0)
ASK W !!,"Select 1-",COUNT,$S(PRCAPRT:" or 'P' to Print",1:" to print") W:TRAN " or return to continue" R ": ",X:DTIME I X["^"!'$T S:'$T DTOUT=1 S OUT=1 G Q2
"RTN","PRCAATR",56,0)
 I PRCAPRT,X="P" S %ZIS="MQ" D ^%ZIS D  S PRCAPRT=0,PRCAIO=IO,PRCAIO(0)=IO(0) G:'POP ASK K POP S OUT=1 G Q2
"RTN","PRCAATR",57,0)
 . I $D(IO("S")) S PRCAIOS=ION D ^%ZISC
"RTN","PRCAATR",58,0)
 . Q
"RTN","PRCAATR",59,0)
 I X["?" W !!,"To see detailed information for a transaction number, enter the corresponding '#'",!,"next to the transaction.  (Ex: 1 or 1,3)" G ASK
"RTN","PRCAATR",60,0)
 I X="" S:TRAN="" OUT=1 G Q2
"RTN","PRCAATR",61,0)
 S SEL=X
"RTN","PRCAATR",62,0)
 F X=1:1:$L(SEL,",") S Y=$P(SEL,",",X) I Y'?1N.N!'$D(^TMP("PRCAATR",$J,+Y)) W *7," ??" G READ
"RTN","PRCAATR",63,0)
 F PRCAATRX=1:1:$L(SEL,",") S Y=$P(SEL,",",PRCAATRX) D VT Q:$D(OUT)
"RTN","PRCAATR",64,0)
 S OUT=1
"RTN","PRCAATR",65,0)
Q2 Q
"RTN","PRCAATR",66,0)
VT ;View a transaction
"RTN","PRCAATR",67,0)
 N IOP,%ZIS,ZTRTN,ZTDESC,ZTSAVE,ZTDTH
"RTN","PRCAATR",68,0)
 S D0=$G(^TMP("PRCAATR",$J,+Y)) G:'D0 Q3
"RTN","PRCAATR",69,0)
 I $D(IO("Q")) S ZTSAVE("D0")="",ZTSAVE("PRCAIO")=IO,ZTSAVE("PRCAIO(0)")=IO(0),ZTRTN="DQ^PRCAATR",ZTDESC="AR TRANS PROFILE",ZTDTH=$H D ^%ZTLOAD W !,"*** Trans # ",D0," REQUEST QUEUED ***" G Q3
"RTN","PRCAATR",70,0)
 I IO'=IO(0) W !,"OK, Printing Transaction # ",D0," ..."
"RTN","PRCAATR",71,0)
 I $D(PRCAIOS) S IOP=PRCAIOS D ^%ZIS
"RTN","PRCAATR",72,0)
 U IO D DQ U IO(0)
"RTN","PRCAATR",73,0)
Q3 Q
"RTN","PRCAATR",74,0)
DQ ;
"RTN","PRCAATR",75,0)
 W @IOF S X="",$P(X,"=",30)="" W !,X," TRANSACTION PROFILE ",X,!!
"RTN","PRCAATR",76,0)
 K DXS D ^PRCATR3 K DXS S X=D0 D ENF^IBOLK
"RTN","PRCAATR",77,0)
RD1 I $E(IOST)="C" R !!,"PRESS <RETURN> TO CONTINUE: ",X:DTIME S:'$T DTOUT=1,OUT=1 I X["?" W !!,"Press return to view next transaction or to continue" G RD1
"RTN","PRCAATR",78,0)
 Q
"RTN","PRCAATR",79,0)
DEB ;View debtor
"RTN","PRCAATR",80,0)
 NEW PRCA
"RTN","PRCAATR",81,0)
 S PRCA=$P(^PRCA(430,BILL,0),"^",9) I PRCA S PRCA=$P(^RCD(340,PRCA,0),"^") W "   ",$P($G(@("^"_$P(PRCA,";",2)_+PRCA_",0)")),"^")
"RTN","PRCAATR",82,0)
 Q
"RTN","PRCABJ")
0^4^B39614762
"RTN","PRCABJ",1,0)
PRCABJ ;WASH-ISC@ALTOONA,PA/LDB,TJK-NIGHTLY PROCESS FOR ACCOUNTS RECEIVABLE ;11/8/96  3:54 PM
"RTN","PRCABJ",2,0)
 ;;4.5;Accounts Receivable;**11,34,101,114,155,153,141,165,167,173,201,237,304,301**;Mar 20, 1995;Build 144
"RTN","PRCABJ",3,0)
 ;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCABJ",4,0)
 ;
"RTN","PRCABJ",5,0)
 ;This routine is called by the PRCA NIGHTLY PROCESS option which should be run nightly to call the following tasks
"RTN","PRCABJ",6,0)
 ;1) Update of interest/admin charges on patients' accounts
"RTN","PRCABJ",7,0)
 ;2) Update statement days
"RTN","PRCABJ",8,0)
 ;3) Print of Patient Statements, Uniform Billing forms, and non-patient follow-up letters
"RTN","PRCABJ",9,0)
 ;4) Purge of Receipts
"RTN","PRCABJ",10,0)
 ;5) Creation of TOP (Treasury Offset Program) documents
"RTN","PRCABJ",11,0)
 ;6) Creation of Cross-Servicing (Treasury Cross-Servicing Project) documents
"RTN","PRCABJ",12,0)
 ;7) Print of the Follow-up list
"RTN","PRCABJ",13,0)
 ;8) Purge AR Events
"RTN","PRCABJ",14,0)
 ;9) Flag prepayments for refund review
"RTN","PRCABJ",15,0)
 ;10) Print Comment List
"RTN","PRCABJ",16,0)
 ;11) Starts the Repayment Plan Monitor
"RTN","PRCABJ",17,0)
 ;12) Generates Diagnostic Measures Workload Reports
"RTN","PRCABJ",18,0)
 ;13) Matches EFT with ERA
"RTN","PRCABJ",19,0)
 ;14) Generates CBO Data Extract files for Boston ARC
"RTN","PRCABJ",20,0)
 ;15) Auto-audit of Paper Bills
"RTN","PRCABJ",21,0)
 ;16) Generate the AR Diagnostic Measures Statistical Reports (for a defined period)
"RTN","PRCABJ",22,0)
 ;
"RTN","PRCABJ",23,0)
 ;Process will first check and Validate AR pointer files 341.1,
"RTN","PRCABJ",24,0)
 ;430.2, and 430.3.
"RTN","PRCABJ",25,0)
 ;Process will terminate and send bulletin if files are not valid
"RTN","PRCABJ",26,0)
 ;
"RTN","PRCABJ",27,0)
EN ;Start of nightly process-check to see if process is already running
"RTN","PRCABJ",28,0)
 L +^RC("PRCABJ"):5 Q:'$T
"RTN","PRCABJ",29,0)
 NEW ERROR S ERROR=0
"RTN","PRCABJ",30,0)
 D VERIFY I ERROR L -^RC("PRCABJ") Q
"RTN","PRCABJ",31,0)
 ;
"RTN","PRCABJ",32,0)
DRIVER ;All processes are called from this point
"RTN","PRCABJ",33,0)
 N CHK,POP,% S CHK=0
"RTN","PRCABJ",34,0)
 D CHK,INT,CHK,EN^RCCPCBJ,CHK,STM,CHK,RECPT,CHK,TOP,CHK,TCSP,CHK,EVNT,CHK,BNUM
"RTN","PRCABJ",35,0)
 D CHK,ENUM,CHK,PURFMS,CHK,EN3^RCFMOBR,CHK,START^RCRJR,CHK,UB
"RTN","PRCABJ",36,0)
 D CHK,STATMNT,CHK,UDLIST^PRCABJ1,CHK,LIST,CHK,COMMENT,CHK,REPAY
"RTN","PRCABJ",37,0)
 D CHK,WRKLD,CHK,EFT,CHK,CBO,ABAUDIT,ARDM
"RTN","PRCABJ",38,0)
 D NOW^%DTC S $P(^RC(342,1,0),"^",10)=%
"RTN","PRCABJ",39,0)
 L -^RC("PRCABJ")
"RTN","PRCABJ",40,0)
 K ^RC("PRCABJ")
"RTN","PRCABJ",41,0)
 Q
"RTN","PRCABJ",42,0)
 ;
"RTN","PRCABJ",43,0)
CHK ;checkpoint of process
"RTN","PRCABJ",44,0)
 S CHK=CHK+1 S ^RC("PRCABJ")=CHK
"RTN","PRCABJ",45,0)
 Q
"RTN","PRCABJ",46,0)
 ;
"RTN","PRCABJ",47,0)
VERIFY ;Verifies Pointer Files--Will HALT Process if Pointer Files Invalid
"RTN","PRCABJ",48,0)
 NEW A,B,FILE
"RTN","PRCABJ",49,0)
 F FILE=341.1,430.2,430.3 D  Q:ERROR
"RTN","PRCABJ",50,0)
    .S A=$S(FILE=341.1:"AC;0;2",FILE=430.2:"AC;0;7",1:"AC;0;3")
"RTN","PRCABJ",51,0)
    .S B=$S(FILE=341.1:"",1:"C;0;2")
"RTN","PRCABJ",52,0)
    .D EN1^PRCABJV(FILE,A,B,.ERROR)
"RTN","PRCABJ",53,0)
    .Q:'ERROR
"RTN","PRCABJ",54,0)
    .;SEND BULLETIN HERE IF FILE IN ERROR
"RTN","PRCABJ",55,0)
    .NEW XMB,XMTEXT,XMDUZ
"RTN","PRCABJ",56,0)
    .S XMDUZ="ACCOUNTS RECEIVABLE PACKAGE"
"RTN","PRCABJ",57,0)
    .S XMB="PRCA NIGHTLY PROCESS ABORT"
"RTN","PRCABJ",58,0)
    .S XMTEXT="ERROR("
"RTN","PRCABJ",59,0)
    .D ^XMB
"RTN","PRCABJ",60,0)
    .Q
"RTN","PRCABJ",61,0)
 Q
"RTN","PRCABJ",62,0)
 ;
"RTN","PRCABJ",63,0)
INT ;  update interest and admin charges for non-benefit debts
"RTN","PRCABJ",64,0)
 ;  example: vendor, employee, ex-employee
"RTN","PRCABJ",65,0)
 D NONBENE^RCBECHGS
"RTN","PRCABJ",66,0)
 Q
"RTN","PRCABJ",67,0)
 ;
"RTN","PRCABJ",68,0)
STM ;Update statement days for PERSONS, VENDORS, and Institutions
"RTN","PRCABJ",69,0)
 D STM^PRCABJ1
"RTN","PRCABJ",70,0)
 Q
"RTN","PRCABJ",71,0)
 ;
"RTN","PRCABJ",72,0)
STATMNT ;Print patient statements
"RTN","PRCABJ",73,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH,PRCADEV
"RTN","PRCABJ",74,0)
 S (IOP,PRCADEV)=$P($G(^RC(342,1,0)),"^",8)
"RTN","PRCABJ",75,0)
 I IOP]"" D
"RTN","PRCABJ",76,0)
 .S ZTRTN="PRCAGS",ZTDTH=$H,ZTDESC="Print AR Statements/Letters"
"RTN","PRCABJ",77,0)
 .S %ZIS="N0" D ^%ZIS Q:POP
"RTN","PRCABJ",78,0)
 .S ZTSAVE("PRCADEV")="" D ^%ZTLOAD,^%ZISC
"RTN","PRCABJ",79,0)
 Q
"RTN","PRCABJ",80,0)
 ;
"RTN","PRCABJ",81,0)
RECPT ;Manage Receipts and Deposits
"RTN","PRCABJ",82,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH
"RTN","PRCABJ",83,0)
 S ZTIO="",ZTRTN="MAN^RCDPUT",ZTDTH=$H,ZTDESC="Manage Receipts and Deposits"
"RTN","PRCABJ",84,0)
 D ^%ZTLOAD
"RTN","PRCABJ",85,0)
 Q
"RTN","PRCABJ",86,0)
 ;
"RTN","PRCABJ",87,0)
TOP ;Transmit TOP documents
"RTN","PRCABJ",88,0)
 Q:$$DOW^XLFDT(DT,1)'=1
"RTN","PRCABJ",89,0)
 I DT'<$P($G(^RC(342,1,30)),"^",1)&(DT'>$P($G(^RC(342,1,30)),"^",2)) D ^RCEXINAD
"RTN","PRCABJ",90,0)
 N RCM,RCDOC
"RTN","PRCABJ",91,0)
 ;Run of TOP documents every Monday
"RTN","PRCABJ",92,0)
 I +$E(DT,6,7)>7,$E(DT,6,7)<15 S RCM=1
"RTN","PRCABJ",93,0)
 I '$D(^RCD(340,"TOP")),'$G(RCM) Q
"RTN","PRCABJ",94,0)
 S RCDOC=$S($G(RCM):"M",1:"U")
"RTN","PRCABJ",95,0)
 I $E(DT,4,5)=12,RCDOC="M" S RCDOC="Y"
"RTN","PRCABJ",96,0)
TOPQUE N ZTDESC,ZTASK,ZTDTH,ZTIO,ZTRTN,ARDUZ,ZTSAVE
"RTN","PRCABJ",97,0)
 S ZTIO="",ZTRTN="^RCTOPD",ZTSAVE("RCDOC")=""
"RTN","PRCABJ",98,0)
 S ZTDESC="TOP REFERRAL DOCUMENTS",ZTDTH=$H
"RTN","PRCABJ",99,0)
 D ^%ZTLOAD
"RTN","PRCABJ",100,0)
 Q
"RTN","PRCABJ",101,0)
 ;
"RTN","PRCABJ",102,0)
TCSP ;Transmit Cross-Servicing (Treasury Cross-Servicing Project) documents
"RTN","PRCABJ",103,0)
 Q:$$DOW^XLFDT(DT,1)'=2
"RTN","PRCABJ",104,0)
 ;Run TCSP documents every Tuesday
"RTN","PRCABJ",105,0)
TCSPQUE N ZTDESC,ZTASK,ZTDTH,ZTIO,ZTRTN
"RTN","PRCABJ",106,0)
 S ZTIO="",ZTRTN="^RCTCSPD"
"RTN","PRCABJ",107,0)
 S ZTDESC="CROSS-SERVICING REFERRAL DOCUMENTS",ZTDTH=$H
"RTN","PRCABJ",108,0)
 D ^%ZTLOAD
"RTN","PRCABJ",109,0)
 Q
"RTN","PRCABJ",110,0)
 ;
"RTN","PRCABJ",111,0)
UB ;Print Uniform Billing forms
"RTN","PRCABJ",112,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH
"RTN","PRCABJ",113,0)
 S ZTIO="",ZTRTN="PRCALT2",ZTDTH=$H,ZTDESC="Print Reimbursable Health Insurance Uniform Billing forms"
"RTN","PRCABJ",114,0)
 D ^%ZTLOAD,^%ZISC
"RTN","PRCABJ",115,0)
 Q
"RTN","PRCABJ",116,0)
 ;
"RTN","PRCABJ",117,0)
LIST ;Print Follow-up List
"RTN","PRCABJ",118,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH,BEG,END,PRCADEV
"RTN","PRCABJ",119,0)
 S IOP=$P($G(^RC(342,1,0)),"^",8)
"RTN","PRCABJ",120,0)
 I IOP]"" D
"RTN","PRCABJ",121,0)
 .S %ZIS="N0" D ^%ZIS Q:POP
"RTN","PRCABJ",122,0)
 .S ZTRTN="DQ1^PRCACM",ZTDTH=$H,PRCADEV=ION_";"_IOST_";"_IOM_";"_IOSL_";"_$G(IO("DOC"))
"RTN","PRCABJ",123,0)
 .S (ZTSAVE("BEG"),ZTSAVE("END"))=DT,ZTSAVE("PRCADEV")="",ZTDESC="Bill Comment Follow-Up List"
"RTN","PRCABJ",124,0)
 .D ^%ZTLOAD,^%ZISC
"RTN","PRCABJ",125,0)
 Q
"RTN","PRCABJ",126,0)
 ;
"RTN","PRCABJ",127,0)
COMMENT ;Print Comment List
"RTN","PRCABJ",128,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH,BEG,END,PRCADEV
"RTN","PRCABJ",129,0)
 S IOP=$P($G(^RC(342,1,0)),"^",8)
"RTN","PRCABJ",130,0)
 I IOP]"" D
"RTN","PRCABJ",131,0)
 .S %ZIS="N0" D ^%ZIS Q:POP
"RTN","PRCABJ",132,0)
 .S ZTRTN="DQ2^PRCACM",ZTDTH=$H,PRCADEV=ION_";"_IOST_";"_IOM_";"_IOSL_";"_$G(IO("DOC"))
"RTN","PRCABJ",133,0)
 .S (ZTSAVE("BEG"),ZTSAVE("END"))=DT,ZTSAVE("PRCADEV")="",ZTDESC="Debtor Comment Follow-up List"
"RTN","PRCABJ",134,0)
 .D ^%ZTLOAD,^%ZISC
"RTN","PRCABJ",135,0)
 Q
"RTN","PRCABJ",136,0)
 ;
"RTN","PRCABJ",137,0)
REPAY ; Starts the Repayment Plan Monitor
"RTN","PRCABJ",138,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","PRCABJ",139,0)
 S ZTIO="",ZTRTN="EN^RCDMB1MT",ZTDTH=$H,ZTDESC="Repayment Plan Monitor"
"RTN","PRCABJ",140,0)
 D ^%ZTLOAD
"RTN","PRCABJ",141,0)
 Q
"RTN","PRCABJ",142,0)
 ;
"RTN","PRCABJ",143,0)
WRKLD ; Generates Diagnostic Measures Workload Reports
"RTN","PRCABJ",144,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","PRCABJ",145,0)
 S ZTIO="",ZTRTN="DQ^RCDMBWLR",ZTDTH=$H,ZTDESC="Diagnostic Measures Workload Reports"
"RTN","PRCABJ",146,0)
 D ^%ZTLOAD
"RTN","PRCABJ",147,0)
 Q
"RTN","PRCABJ",148,0)
 ;
"RTN","PRCABJ",149,0)
 ;PRCA*4.5*304 new tag ARDM
"RTN","PRCABJ",150,0)
ARDM ; Generate AR Diagnostic Measures statistic reports weekly
"RTN","PRCABJ",151,0)
 N ZTDESC,ZTDTH,ZTIO,ZTRTN,ZTSAVE
"RTN","PRCABJ",152,0)
 ;
"RTN","PRCABJ",153,0)
 ; run the report
"RTN","PRCABJ",154,0)
 S ZTIO="",ZTRTN="AUTO^RCDPENRU",ZTDTH=$H,ZTDESC="AR Diagnostic Measures Statistical Reports"
"RTN","PRCABJ",155,0)
 D ^%ZTLOAD
"RTN","PRCABJ",156,0)
 Q
"RTN","PRCABJ",157,0)
 ;
"RTN","PRCABJ",158,0)
EVNT ;Purge AR Events
"RTN","PRCABJ",159,0)
 N IOP,ZTIO,ZTDESC,ZTASK,ZTIO,ZTRTN,ZTSAVE,%ZIS
"RTN","PRCABJ",160,0)
 S ZTIO="",ZTRTN="PUR^RCEVDRV1",ZTDTH=$H,ZTDESC="Purge AR Event Information" D ^%ZTLOAD
"RTN","PRCABJ",161,0)
 Q
"RTN","PRCABJ",162,0)
PURFMS ;Purge FMS documents
"RTN","PRCABJ",163,0)
 NEW ZTRTN,ZTIO,ZTDTH,ZTSK,ZTDESC
"RTN","PRCABJ",164,0)
 S ZTIO="",ZTRTN="EN^RCFMPUR",ZTDESC="AR/FMS DOC PURGE",ZTDTH=$H D ^%ZTLOAD
"RTN","PRCABJ",165,0)
 Q
"RTN","PRCABJ",166,0)
 ;
"RTN","PRCABJ",167,0)
EFT ; Starts matching of EFTs to EOBs job
"RTN","PRCABJ",168,0)
 NEW ZTRTN,ZTIO,ZTDTH,ZTSK,ZTDESC
"RTN","PRCABJ",169,0)
 S ZTIO="",ZTRTN="EN^RCDPEM",ZTDESC="AR/EDI LOCKBOX MATCHING EFTs",ZTDTH=$H D ^%ZTLOAD
"RTN","PRCABJ",170,0)
 Q
"RTN","PRCABJ",171,0)
 ;
"RTN","PRCABJ",172,0)
BNUM ;Check bill numbering series
"RTN","PRCABJ",173,0)
 I $P(^RC(342,1,0),"^",3)="" S $P(^RC(342,1,0),"^",3)="K"_$E($$FY^RCFN01,2)_"00000"
"RTN","PRCABJ",174,0)
 I $E($P(^RC(342,1,0),"^",3),2)'=$E($$FY^RCFN01,2) S $P(^RC(342,1,0),"^",3)="K"_$E($$FY^RCFN01,2)_"00000"
"RTN","PRCABJ",175,0)
 Q
"RTN","PRCABJ",176,0)
ENUM ;Check event numbering series
"RTN","PRCABJ",177,0)
 I $P(^RC(342,1,0),"^",6)="" S $P(^RC(342,1,0),"^",6)="K"_$E($$FY^RCFN01,2)_"A0000"
"RTN","PRCABJ",178,0)
 I $E($P(^RC(342,1,0),"^",6),2)'=$E($$FY^RCFN01,2) S $P(^RC(342,1,0),"^",6)="K"_$E($$FY^RCFN01,2)_"A0000"
"RTN","PRCABJ",179,0)
 Q
"RTN","PRCABJ",180,0)
 ;
"RTN","PRCABJ",181,0)
CBO ; Create Extract Files for ARC
"RTN","PRCABJ",182,0)
 NEW ZTRTN,ZTIO,ZTDTH,ZTSK,ZTDESC
"RTN","PRCABJ",183,0)
 S ZTIO="",ZTRTN="EN^RCXVTSK",ZTDESC="CBO DATA EXTRACT",ZTDTH=$H
"RTN","PRCABJ",184,0)
 D ^%ZTLOAD
"RTN","PRCABJ",185,0)
 Q
"RTN","PRCABJ",186,0)
ABAUDIT ;PRCA*4.5*304 - Auto-audit Paper bills
"RTN","PRCABJ",187,0)
 ;
"RTN","PRCABJ",188,0)
 N ZTRTN,ZTIO,ZTDTH,ZTSK,ZTDESC
"RTN","PRCABJ",189,0)
 ;
"RTN","PRCABJ",190,0)
 S ZTIO="",ZTRTN="ABAUDIT^PRCABJ2",ZTDESC="AR AUTO-AUDIT OF PAPER BILLS",ZTDTH=$H D ^%ZTLOAD
"RTN","PRCABJ",191,0)
 Q
"RTN","PRCADR")
0^19^B17506368
"RTN","PRCADR",1,0)
PRCADR ;SF-ISC/YJK-PRINT ADDRESS,TRANS.,BALANCE ; 22 Jul 2014  6:53 AM
"RTN","PRCADR",2,0)
V ;;4.5;Accounts Receivable;**21,45,108,141,241,301**;Mar 20, 1995;Build 144
"RTN","PRCADR",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCADR",4,0)
 ;print debtor's 3rd party address,transaction,balances.
"RTN","PRCADR",5,0)
EN1 ;PRINT ADDRESS, SOCIAL SECURITY NUMBER AND DATE OF BIRTH.
"RTN","PRCADR",6,0)
 N RCDMC,RCTOP,RCKAT,RCTCSP,PRCA15,Y
"RTN","PRCADR",7,0)
 K PRCAGL D EN11 Q:'$D(PRCAGL)  D WR1^PRCADR2
"RTN","PRCADR",8,0)
 I $D(^PRCA(430,D0,8)),$P(^(8),U,7)["N" W !,"* UNABLE TO LOCATE *"
"RTN","PRCADR",9,0)
 S PRCA15=$G(^PRCA(430,D0,15)) D
"RTN","PRCADR",10,0)
 .I $P(PRCA15,U,2)]"" W !,"CS Recall Reason: ",$E($$GET1^DIQ(430,D0,154),1,31) W ?51,"CS Recall Date: " S Y=$P(PRCA15,U,3) D DD^%DT W Y ;prca*4.5*301
"RTN","PRCADR",11,0)
 .I $P(PRCA15,U,4)]"",$P(PRCA15,U,2)="" W !,"CS Recall Reason: ",$E($$GET1^DIQ(430,D0,154),1,31) W ?51,"CS Recall Date: " ;prca*4.5*301
"RTN","PRCADR",12,0)
 D END1 Q
"RTN","PRCADR",13,0)
EN11 Q:'$D(D0)  S Z0=$S($P(^PRCA(430,D0,0),U,9)'="":$P(^(0),U,9),1:"") Q:Z0=""
"RTN","PRCADR",14,0)
EN12 S PRCADB=$P(^RCD(340,Z0,0),"^"),RCDMC=$D(^RCD(340,"DMC",1,Z0)),RCTOP=$D(^RCD(340,"TOP",Z0)),RCTCSP=$D(^RCD(340,"TCSP",Z0))
"RTN","PRCADR",15,0)
 S X=$$DADD^RCAMADD(PRCADB) S $P(PRCAGL,"^",1,6)=$P(X,"^",1,6),$P(PRCAGL,"^",9)=$P(X,"^",7) K PRCADB
"RTN","PRCADR",16,0)
 S Z1=$P(^RCD(340,Z0,0),";",1),Z2=$P($P(^(0),"^"),";",2),PRCASTE=$P(PRCAGL,U,5)
"RTN","PRCADR",17,0)
 S (PRCASSN,PRCADOB)="" I '$D(^VA(200,Z1,0)),'$D(^DPT(Z1,0)) Q
"RTN","PRCADR",18,0)
 S DFN=Z1 D DEM^VADPT I VAERR K VAERR Q
"RTN","PRCADR",19,0)
 S PRCASSN=$S(Z2["VA(200":$P(^VA(200,Z1,1),U,9),1:"")
"RTN","PRCADR",20,0)
 I Z2["DPT(" S DFN=Z1 D DEM^VADPT S PRCASSN=$P(VADM(2),"^",2)
"RTN","PRCADR",21,0)
 S RCKAT="" I $$EMGRES^DGUTL(DFN)["K" S RCKAT=1
"RTN","PRCADR",22,0)
 S PRCASSN=$S((PRCASSN["-")!($L(PRCASSN)>9):PRCASSN,1:$E(PRCASSN,1,3)_"-"_$E(PRCASSN,4,5)_"-"_$E(PRCASSN,6,9))
"RTN","PRCADR",23,0)
 S PRCADOB=$S(Z2["VA(200":$P(^VA(200,Z1,1),U,3),Z2["DPT":$P(VADM(3),"^",1),1:"")
"RTN","PRCADR",24,0)
 S PRCADOB=$$SLH^RCFN01(PRCADOB) K DFN,VAERR,VADM,Z1,Z2 Q
"RTN","PRCADR",25,0)
END1 K %,PRCADOB,PRCASSN,PRCASTE,PRCAGL,Z1,Z2,Z0 Q
"RTN","PRCADR",26,0)
EN2 ;prints all transaction type of AR in the Profile of AR.
"RTN","PRCADR",27,0)
 Q:'$D(D0)  S PRCAEN=0,PRCAK1=1 K PRCA("WROFF")
"RTN","PRCADR",28,0)
 F I=0:0 S PRCAEN=$O(^PRCA(433,"C",D0,PRCAEN)) Q:'PRCAEN  D WR2^PRCADR2 S PRCAK1=PRCAK1+1 I PRCAK1>7 D EN5 Q:$D(PRCA("HALT"))  S PRCAK1=-5
"RTN","PRCADR",29,0)
END2 K I,PRCAEN,PRCAK1,PRCAG,% Q  ;end of EN2
"RTN","PRCADR",30,0)
EN3 ;Print the balances and paid amount of Principal,Interest and Admin.
"RTN","PRCADR",31,0)
PRBAL S (PRCAK("PB"),PRCAK("IB"),PRCAK("AB"),PRCAK("IP"),PRCAK("PP"),PRCAK("AP"),PRCAK("MF"),PRCAK("CC"))=0
"RTN","PRCADR",32,0)
 I $D(^PRCA(430,D0,7)) D PRBAL1
"RTN","PRCADR",33,0)
 S (PRCAL(1),PRCAL(2),PRCAL(3),PRCAL(4),PRCAL(5),PRCAL(6),PRCACODE)=""
"RTN","PRCADR",34,0)
 I $D(^PRCA(430,D0,6)) S PRCAGL6=^(6),PRCAL(1)=$P(PRCAGL6,U,1),PRCAL(2)=$P(PRCAGL6,U,2),PRCAL(3)=$P(PRCAGL6,U,3),PRCAL(4)=$P(PRCAGL6,U,4),PRCACODE=$P(PRCAGL6,U,5),PRCAL(5)=$P(PRCAGL6,U,7),PRCAL(6)=$P(PRCAGL6,U,14)
"RTN","PRCADR",35,0)
 S PRCACODE=$S(PRCACODE]"""":PRCACODE,1:"DC/DOJ")
"RTN","PRCADR",36,0)
 S PRCALT=PRCAL(1) D LDATE S PRCAL(1)=PRCALT,PRCALT=PRCAL(2) D LDATE S PRCAL(2)=PRCALT,PRCALT=PRCAL(3) D LDATE S PRCAL(3)=PRCALT
"RTN","PRCADR",37,0)
 S PRCALT=PRCAL(4) D LDATE S PRCAL(4)=PRCALT,PRCALT=PRCAL(5) D LDATE S PRCAL(5)=PRCALT,PRCALT=PRCAL(6) D LDATE S PRCAL(6)=PRCALT
"RTN","PRCADR",38,0)
 D WR3^PRCADR2
"RTN","PRCADR",39,0)
END3 K PRCAL,PRCACODE,PRCALT,PRCAGL6,PRCAGL7,PRCAK Q
"RTN","PRCADR",40,0)
PRBAL1 S PRCAGL7=^PRCA(430,D0,7),PRCAK("PP")=$P(PRCAGL7,U,7),PRCAK("IP")=$P(PRCAGL7,U,8),PRCAK("AP")=$P(PRCAGL7,U,9)
"RTN","PRCADR",41,0)
 S PRCAK("PB")=$P(PRCAGL7,U,1),PRCAK("IB")=$P(PRCAGL7,U,2),PRCAK("AB")=$P(PRCAGL7,U,3),PRCAK("MF")=$P(PRCAGL7,U,4),PRCAK("CC")=$P(PRCAGL7,U,5)
"RTN","PRCADR",42,0)
 Q
"RTN","PRCADR",43,0)
LDATE Q:PRCALT=""  S PRCALT=$$SLH^RCFN01(PRCALT) Q
"RTN","PRCADR",44,0)
EN4 ;Print 3rd party address information.
"RTN","PRCADR",45,0)
 Q:'$D(D0)  S Z0=$S($P(^PRCA(430,D0,0),U,9)'="":$P(^(0),U,9),1:"") Q:Z0=""  S PRCADB=$P(^RCD(340,Z0,0),"^") S X=$$DADD^RCAMADD(PRCADB) S $P(PRCAGL,"^",1,6)=$P(X,"^",1,6),$P(PRCAGL,"^",9)=$P(X,"^",7) K PRCADB
"RTN","PRCADR",46,0)
 W !,?12,$P(PRCAGL,U) F X=2,3,4 W:$P(PRCAGL,U,X)'="" !,?12,$P(PRCAGL,U,X)
"RTN","PRCADR",47,0)
 I $P(PRCAGL,U,5)'="",$P(PRCAGL,U,5)'[" " W ", ",$P(PRCAGL,U,5)," ",$P(PRCAGL,U,6)
"RTN","PRCADR",48,0)
 W "      PHONE NO.: ",$P(PRCAGL,U,9)
"RTN","PRCADR",49,0)
END4 K %,PRCAGL,Z0 Q
"RTN","PRCADR",50,0)
EN5 K PRCA("HALT") Q:'$D(PRCAIO)
"RTN","PRCADR",51,0)
 I $E(IOST,1,2)["C-" R !,?8,"ENTER '^' TO HALT:  ",X:$S($D(DTIME):DTIME,1:999) I (X["^")!('$T) S PRCA("HALT")=1 Q
"RTN","PRCADR",52,0)
 I $E(IOST,1,2)["C-",$D(IOF) W @IOF
"RTN","PRCADR",53,0)
 Q
"RTN","PRCADR",54,0)
 ;
"RTN","PRCADR",55,0)
SVDT(D0) ;Called from the PRCA 3RD PROFILE print template
"RTN","PRCADR",56,0)
 N X S X="IBRFN" X ^%ZOSF("TEST") G SVDTQ:'$T
"RTN","PRCADR",57,0)
 S D0=$P($P($G(^PRCA(430,+D0,0)),"^"),"-",2)
"RTN","PRCADR",58,0)
 S X=$$SVDT^IBRFN(D0)
"RTN","PRCADR",59,0)
 Q X
"RTN","PRCADR",60,0)
SVDTQ Q 0
"RTN","PRCADR2")
0^8^B16711783
"RTN","PRCADR2",1,0)
PRCADR2 ;SF-ISC/YJK-PRINT ADDRESS,TRANS.,BALANCE ;3/19/97  3:19 PM
"RTN","PRCADR2",2,0)
V ;;4.5;Accounts Receivable;**45,104,108,149,141,172,241,233,263,301**;Mar 20, 1995;Build 144
"RTN","PRCADR2",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCADR2",4,0)
 ;print debtor's /3rd party address,transaction,balances.
"RTN","PRCADR2",5,0)
 N RCDMC,RCTOP
"RTN","PRCADR2",6,0)
WR1 W !!,$P(PRCAGL,U,1),?39,"SOC.SEC.NO.: ",?55,PRCASSN
"RTN","PRCADR2",7,0)
 W:$P(PRCAGL,U,2)'="" !,$P(PRCAGL,U,2)
"RTN","PRCADR2",8,0)
 W !,$P(PRCAGL,U,4),", ",PRCASTE,"  ",$P(PRCAGL,U,6),?39,"DATE OF BIRTH: ",?55,PRCADOB,!,"PHONE NO.: ",$P(PRCAGL,U,9),?39,"DATE POSTED: " S Y=$P($G(^PRCA(430,D0,6)),"^",21) W:'Y "N/A" I Y D DD^%DT W $P(Y,"@")," ",$P(Y,"@",2)
"RTN","PRCADR2",9,0)
 I $G(RCKAT) W !,"EMERGENCY RESPONSE INDICATOR: HURRICANE KATRINA"
"RTN","PRCADR2",10,0)
 I $G(RCDMC) W !,"****Debtor's Account Forwarded To DMC****"
"RTN","PRCADR2",11,0)
 I $G(RCTOP) W !,"****Debtor's Account Forwarded To TOP****"
"RTN","PRCADR2",12,0)
 I $G(RCTCSP) W !,"****Debt Referred to Cross-Servicing****"
"RTN","PRCADR2",13,0)
END1 K %,PRCADOB,PRCASSN,PRCASTE,PRCAGL,Z1,Z2,Z0
"RTN","PRCADR2",14,0)
 Q
"RTN","PRCADR2",15,0)
 ;
"RTN","PRCADR2",16,0)
 ;
"RTN","PRCADR2",17,0)
WR2 ;called by EN2^PRCADR
"RTN","PRCADR2",18,0)
 W ! S PRCAGL0=$S($D(^PRCA(433,PRCAEN,0)):^(0),1:""),PRCAG=$S($D(^PRCA(433,PRCAEN,1)):^(1),1:"") Q:(PRCAG="")!(PRCAGL0="")
"RTN","PRCADR2",19,0)
 S PRCATD=$P(PRCAG,U,1),PRCATY=$P(PRCAG,U,2) Q:'$D(^PRCA(430.3,+PRCATY,0))  S PRCATYPE=$P(^(0),U,3) W ?1,$S($P(PRCAGL0,U,10):"*",1:""),?2,+PRCAGL0
"RTN","PRCADR2",20,0)
 I $P(PRCAG,U,3)="" D
"RTN","PRCADR2",21,0)
 .W:PRCATYPE=17 ?12,$P($G(^PRCA(433,PRCAEN,5)),"^",2)
"RTN","PRCADR2",22,0)
 .W:(PRCATYPE=1)!(PRCATYPE=21) ?12,$P(PRCAG,U,4)
"RTN","PRCADR2",23,0)
 I $P(PRCAG,U,3)'="" W ?12,$P(PRCAG,U,3)
"RTN","PRCADR2",24,0)
 S:(PRCATYPE=8)!((PRCATYPE=9)!(PRCATYPE=10)) PRCA("WROFF")=PRCAEN
"RTN","PRCADR2",25,0)
 W:PRCATY?1N.N&(PRCATYPE'=17) ?22,$P(^PRCA(430.3,PRCATY,0),U,1) I (PRCATYPE=2)!(PRCATYPE=20),$P(^PRCA(433,PRCAEN,0),U,7)]"" W "(",$P(^(0),U,7),")"
"RTN","PRCADR2",26,0)
 S Y=PRCATD D DD^%DT S Y(1)=$P(Y,", ",2)
"RTN","PRCADR2",27,0)
 S PRCATD=$E(PRCATD,4,5)_"/"_$E(PRCATD,6,7)_"/"_$E(Y(1),3,4)  ;trans date
"RTN","PRCADR2",28,0)
 ;  if a decrease adjustment, show as negative (patch 4.5*172)
"RTN","PRCADR2",29,0)
 I $P(PRCAG,"^",2)=35,$P(PRCAG,"^",5)>0 S $P(PRCAG,"^",5)=-$P(PRCAG,"^",5)
"RTN","PRCADR2",30,0)
 W ?44,PRCATD,?54,$J($P(PRCAG,U,5),11,2) W:+$P(PRCAGL0,U,4)<2 ?67,"INCOMPLETE"
"RTN","PRCADR2",31,0)
END2 K PRCAG,PRCATD,PRCATY,PRCATYPE,PRCAGL0
"RTN","PRCADR2",32,0)
 Q  ;end of WR2
"RTN","PRCADR2",33,0)
 ;
"RTN","PRCADR2",34,0)
 ;
"RTN","PRCADR2",35,0)
WR3 W !,?18,"BALANCES",?31,"PAID"
"RTN","PRCADR2",36,0)
 W !,?44,"LETTER1/ICD:",?58,PRCAL(1)
"RTN","PRCADR2",37,0)
 W !,"PRINCIPAL:",?16,$J(PRCAK("PB"),10,2),?26,$J(PRCAK("PP"),9,2),?44,"LETTER2:",?58,PRCAL(2)
"RTN","PRCADR2",38,0)
 W !,"INTEREST:",?16,$J(PRCAK("IB"),10,2),?26,$J(PRCAK("IP"),9,2),?44,"LETTER3:",?58,PRCAL(3)
"RTN","PRCADR2",39,0)
 W !,"ADMINISTRATIVE:",?16,$J(PRCAK("AB"),10,2),?26,$J(PRCAK("AP"),9,2),?44,"IRS LETTER:",?58,PRCAL(6)
"RTN","PRCADR2",40,0)
 W ! W:PRCAK("MF")>0 "MARSHAL FEE:",?16,$J(PRCAK("MF"),10,2),?26,$J(0,9,2) W ?44,PRCACODE_" REF.DATE:",?62,PRCAL(4)
"RTN","PRCADR2",41,0)
 W:PRCAK("CC")>0 !,"COURT COST:",?16,$J(PRCAK("CC"),10,2),?26,$J(0,9,2)
"RTN","PRCADR2",42,0)
 W !,"CURRENT:",?16,$J(PRCAK("PB")+PRCAK("IB")+PRCAK("AB")+PRCAK("MF")+PRCAK("CC"),10,2),?26,$J(PRCAK("PP")+PRCAK("AP")+PRCAK("IP"),9,2)
"RTN","PRCADR2",43,0)
 K PRCAL I $D(^PRCA(430,D0,6)) S PRCAL=^(6) I $P(PRCAL,"^",15)]"" W !!,"     Date forwarded to IRS: " S Y=$P(PRCAL,"^",15) D DD^%DT W Y
"RTN","PRCADR2",44,0)
 I $D(PRCAL),$P(PRCAL,"^",16)]"" W !,"Prin/Int/Admin IRS balance: " F X=16:1:18 W +$P(PRCAL,"^",X),"/"
"RTN","PRCADR2",45,0)
 K PRCAL I $G(^PRCA(430,D0,12)) S PRCAL=^(12) I $P(PRCAL,U)]"" W !!,"     Date forwarded to DMC: " S Y=$P(PRCAL,U) D DD^%DT W Y
"RTN","PRCADR2",46,0)
 I $D(PRCAL),$P(PRCAL,U,2)]"" W !,"Prin/Int/Admin DMC balance: " F X=2:1:4 W +$P(PRCAL,U,X),"/"
"RTN","PRCADR2",47,0)
 I $D(PRCAL),$P($G(^RCD(340,(+$P(^PRCA(430,D0,0),"^",9)),3)),"^",9)'="" W !,"Lesser Withhold Amt to DMC: ",$J($P(^(3),"^",9),0,2)
"RTN","PRCADR2",48,0)
 K PRCAL I $G(^PRCA(430,D0,14)) S PRCAL=^(14) I $P(PRCAL,U)]"" W !!,"Date forwarded to TOP: " S Y=$P(PRCAL,U) D DD^%DT W Y
"RTN","PRCADR2",49,0)
 I $D(PRCAL),$P($G(^RCD(340,(+$P(^PRCA(430,D0,0),"^",9)),6)),"^",6)'="" W !,"TOP Hold Date:  " S Y=$P(^(6),"^",6) D DD^%DT W Y
"RTN","PRCADR2",50,0)
 I $G(^PRCA(430,D0,15)) S PRCAL=^(15) I $P(PRCAL,U)]"" W !!,"CS Referred Date: " S Y=$P(PRCAL,U) D DD^%DT W Y
"RTN","PRCADR2",51,0)
END3 K PRCAL,PRCACODE,PRCALT,PRCAK,PRCAGL6,PRCAGL7 Q
"RTN","PRCAEXM")
0^52^B13617982
"RTN","PRCAEXM",1,0)
PRCAEXM ;SF-ISC/YJK-ADMIN.COST CHARGE TRANSACTION ;3/30/94  11:19 AM
"RTN","PRCAEXM",2,0)
V ;;4.5;Accounts Receivable;**67,103,196,301**;Mar 20, 1995;Build 144
"RTN","PRCAEXM",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAEXM",4,0)
 ;Update Int/adm.balance
"RTN","PRCAEXM",5,0)
 ;and Administrative cost charge transaction, is called by ^PRCAWO.
"RTN","PRCAEXM",6,0)
 ;
"RTN","PRCAEXM",7,0)
EN1 ;Adjustment Interest/admin.cost from an AR - this makes the int/adm.balance
"RTN","PRCAEXM",8,0)
 ;,marshal fee and court cost zero,0.
"RTN","PRCAEXM",9,0)
 N PRCAIND,ADMINTOT,PRCAERR,PRCABN0
"RTN","PRCAEXM",10,0)
 D BEGIN^PRCAWO G:('$D(PRCABN))!('$D(PRCAEN)) END G:'$D(^PRCA(430,PRCABN,7)) END
"RTN","PRCAEXM",11,0)
 L +^PRCA(430,PRCABN):1 I '$T W !!,*7,"ANOTHER USER IS EDITING THIS BILL" G EN1
"RTN","PRCAEXM",12,0)
 S PRCABN0=PRCABN
"RTN","PRCAEXM",13,0)
 S PRCAIND=$G(^PRCA(430,PRCABN,7))
"RTN","PRCAEXM",14,0)
 S PRCAMT=$P(PRCAIND,U,2)+$P(PRCAIND,U,3)+$P(PRCAIND,U,4)+$P(PRCAIND,U,5)
"RTN","PRCAEXM",15,0)
 S %=$P(^PRCA(430,PRCABN,0),U,2) I "PC"'[$P(^PRCA(430.2,%,0),U,6) W *7,!,"This AR may not be appropriate to charge Interest/Administrative cost.",!,"Please check the category of this AR.",! H 3
"RTN","PRCAEXM",16,0)
 K % W !!,"You may exempt the account from all the interest and administrative cost balances - making those balances zero (0),",!,"or adjust them."
"RTN","PRCAEXM",17,0)
EN011 S %=2 W !!,"Do you want to exempt the account from all the Int/Adm. costs" D YN^DICN I %<0 S PRCACOMM="User Canceled" D DELETE^PRCAWO1 K PRCACOMM G EN1
"RTN","PRCAEXM",18,0)
 I %=1 D EN11,END G EN1
"RTN","PRCAEXM",19,0)
 I %=0 W !,"ANSWER 'YES' OR 'NO' " G EN011
"RTN","PRCAEXM",20,0)
 W !,"Adjusting the administrative/Interest charge ...",!
"RTN","PRCAEXM",21,0)
 I $D(^PRCA(430,"TCSP",PRCABN)) W !,"BILL HAS BEEN REFERRED TO CROSS-SERVICING.",!,"NO MANUAL COST ADJUSTMENTS ARE ALLOWED." G EN1  ;prca*4.5*301
"RTN","PRCAEXM",22,0)
 D DIEEN^PRCAWO1,END G EN1
"RTN","PRCAEXM",23,0)
 ;
"RTN","PRCAEXM",24,0)
 ;  exempt interest and admin charges
"RTN","PRCAEXM",25,0)
EN11 S PRCATYPE=14,DIE="^PRCA(433,",DA=PRCAEN
"RTN","PRCAEXM",26,0)
 S DR=".03////^S X="_PRCABN_";11////^S X="_DT_";12////^S X="_PRCATYPE_";15////^S X="_PRCAMT_";"
"RTN","PRCAEXM",27,0)
 S DR=DR_"27////^S X="_+$P(PRCAIND,U,2)_";"  ;interest
"RTN","PRCAEXM",28,0)
 S DR=DR_"28////^S X="_+$P(PRCAIND,U,3)_";"  ;admin charge
"RTN","PRCAEXM",29,0)
 S DR=DR_"25////^S X="_+$P(PRCAIND,U,4)_";"  ;marshal fee
"RTN","PRCAEXM",30,0)
 S DR=DR_"26////^S X="_+$P(PRCAIND,U,5)_";"  ;court cost
"RTN","PRCAEXM",31,0)
 S DIC=DIE,PRCA("LOCK")=0 D LOCKF^PRCAWO1 Q:PRCA("LOCK")=1  D ^DIE
"RTN","PRCAEXM",32,0)
 I PRCAEN,$D(^PRCA(430,"TCSP",PRCABN)) D DECADJ^RCTCSPU(PRCABN,PRCAEN) ;prca*4.5*301 add cs 5B flag
"RTN","PRCAEXM",33,0)
 S $P(^PRCA(430,PRCABN,7),U,2,5)="0^0^0^0" D TRANST^PRCAWO1 Q
"RTN","PRCAEXM",34,0)
 ;
"RTN","PRCAEXM",35,0)
 ;
"RTN","PRCAEXM",36,0)
EN2 Q:'$D(PRCAEN)  Q:($P(^PRCA(433,PRCAEN,2),U,8)="")&($P(^PRCA(433,PRCAEN,2),U,7)="")
"RTN","PRCAEXM",37,0)
 W !,"MONTHLY ADMIN. CHARGE: ",?25,+$P(^PRCA(433,PRCAEN,2),U,8),?40,"INTEREST CHARGE: ",+$P(^PRCA(433,PRCAEN,2),U,7) Q
"RTN","PRCAEXM",38,0)
 ;
"RTN","PRCAEXM",39,0)
END L -^PRCA(433,+$G(PRCAEN)),-^PRCA(430,+$G(PRCABN))
"RTN","PRCAEXM",40,0)
 S X(1)=0,X=$G(^PRCA(430,+$G(PRCABN0),7)),X(1)=+X,X(1)=$P(X,"^",2)+X(1),X(1)=$P(X,"^",3)+X(1),X(1)=$P(X,"^",4)+X(1),X(1)=$P(X,"^",5)+X(1)
"RTN","PRCAEXM",41,0)
 K PRCA("STATUS")
"RTN","PRCAEXM",42,0)
 I X(1)=0,$G(PRCABN0) D
"RTN","PRCAEXM",43,0)
 .;Check for payment transactions
"RTN","PRCAEXM",44,0)
 .F X=0:0 S X=$O(^PRCA(433,"C",PRCABN0,X)) Q:'X  I ",2,7,20,"[(","_$P($G(^PRCA(430.3,+$P($G(^PRCA(433,X,1)),"^",2),0)),"^",3)_",") S PRCA("STATUS")=$O(^PRCA(430.3,"AC",108,0))
"RTN","PRCAEXM",45,0)
 .S:'$D(PRCA("STATUS")) PRCA("STATUS")=$O(^PRCA(430.3,"AC",111,0))
"RTN","PRCAEXM",46,0)
 .S DA=PRCABN0,DIE="^PRCA(430,",DR="8////"_PRCA("STATUS") D ^DIE
"RTN","PRCAEXM",47,0)
 K PRCATY,PRCA,PRCA2,PRCAD,PRCABN,PRCAEN,PRCATYPE,DA,DIE,DIC,PRCAMT,DR,X,% Q
"RTN","PRCAGDR")
0^36^B14896021
"RTN","PRCAGDR",1,0)
PRCAGDR ;WASH-ISC@ALTOONA,PA/CMS - BALANCE DISCREPANCY REPORT ;12/3/93  9:40 AM
"RTN","PRCAGDR",2,0)
V ;;4.5;Accounts Receivable;**78,198,219,301**;Mar 20, 1995;Build 144
"RTN","PRCAGDR",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAGDR",4,0)
 N CHK,DAT,DEB,DIC,LN1,LN2,NAM,SSN,STD,PG,POP,Y,X,%ZIS S COMM=0
"RTN","PRCAGDR",5,0)
PAT ;select patient
"RTN","PRCAGDR",6,0)
 N DPTNOFZY,DPTNOFZK S (DPTNOFZY,DPTNOFZK)=1
"RTN","PRCAGDR",7,0)
 W ! S DIC="^DPT(",DIC(0)="AENMQ",DIC("A")="Select Patient: " D ^DIC G:Y<1 OUT S DEB=$O(^RCD(340,"B",+Y_";DPT(",0)) I 'DEB W *7," No AR Information exists!" G PAT
"RTN","PRCAGDR",8,0)
 S $P(LN1,"_",80)="",$P(LN2,"=",80)="",NAM=$$NAM^RCFN01(DEB),SSN=$E($$SSN^RCFN01(DEB),6,9),STD=$$PST^RCAMFN01(DEB) S:STD<1 STD="UNKNOWN"
"RTN","PRCAGDR",9,0)
 S PG=0 D HD
"RTN","PRCAGDR",10,0)
 I '$$EN^PRCAMRKC(DEB) W !!,"This patient's account is currently in balance!"
"RTN","PRCAGDR",11,0)
 E  W !!,"This account is out-of-balance!"
"RTN","PRCAGDR",12,0)
 D ST
"RTN","PRCAGDR",13,0)
 D ASK I CHK=1 D DEV
"RTN","PRCAGDR",14,0)
 G PAT
"RTN","PRCAGDR",15,0)
DEV W ! S IOP="Q",%ZIS="QN",%ZIS("B")="" D ^%ZIS G:POP OUT
"RTN","PRCAGDR",16,0)
 I '$D(IO("Q")) W !!,*7,"YOU MUST QUEUE THIS REPORT!!",! G DEV
"RTN","PRCAGDR",17,0)
 S ZTSAVE("DEB")="",ZTSAVE("NAM")="",ZTSAVE("SSN")="",ZTSAVE("STD")="",ZTRTN="EN^PRCAGDR",ZTDESC="AR DISCREPANCY REPORT" D ^%ZTLOAD G OUT
"RTN","PRCAGDR",18,0)
 Q
"RTN","PRCAGDR",19,0)
OUT D ^%ZISC
"RTN","PRCAGDR",20,0)
 K ^XTMP("PRCAGU",$J),COMM
"RTN","PRCAGDR",21,0)
 Q
"RTN","PRCAGDR",22,0)
CONT ;Ask to Continue
"RTN","PRCAGDR",23,0)
 ;N Y
"RTN","PRCAGDR",24,0)
 ;W !! S DIR(0)="E" D ^DIR I Y'=1 S DTOUT=1 Q
"RTN","PRCAGDR",25,0)
 Q
"RTN","PRCAGDR",26,0)
HD ;PAGE HEADING
"RTN","PRCAGDR",27,0)
 N DIR,Y S PG=PG+1
"RTN","PRCAGDR",28,0)
 W @IOF,!!,?3,NAM,"(",$E(NAM,1),SSN,")   ACCOUNT BALANCE DISCREPANCY REPORT"
"RTN","PRCAGDR",29,0)
 N %,%H,%I,X,Y
"RTN","PRCAGDR",30,0)
 D NOW^%DTC S Y=% D DD^%DT
"RTN","PRCAGDR",31,0)
 W !,?3,"STATEMENT DAY: ",STD,?46,Y,"    PAGE ",PG,!,LN2
"RTN","PRCAGDR",32,0)
HDQ Q
"RTN","PRCAGDR",33,0)
ASK ;Ask print statement
"RTN","PRCAGDR",34,0)
 N DIR,X,Y
"RTN","PRCAGDR",35,0)
 W ! S DIR("A")="Print example of patient statement",DIR(0)="Y" D ^DIR S CHK=Y
"RTN","PRCAGDR",36,0)
 Q
"RTN","PRCAGDR",37,0)
EN ;Enter here to print statement from queue
"RTN","PRCAGDR",38,0)
 N BN,DAT,PAGE,X,Y S PG=0,PAGE=0,$P(LN1,"_",80)="",$P(LN2,"=",80)=""
"RTN","PRCAGDR",39,0)
 D HD,ST
"RTN","PRCAGDR",40,0)
 Q
"RTN","PRCAGDR",41,0)
ST ;Start here find bills
"RTN","PRCAGDR",42,0)
 NEW BBAL,BEG,CHK,END,LDT3,PBAL,PDAT,PEND,SITE,TBAL,X,Y
"RTN","PRCAGDR",43,0)
 ; initialize variables for CS
"RTN","PRCAGDR",44,0)
 NEW CSBB,CSTCH,CSTPC,CSPREV S (CSBB,CSTCH,CSTPC)=0
"RTN","PRCAGDR",45,0)
 I 'STD D 9^PRCAGDT Q
"RTN","PRCAGDR",46,0)
 K ^TMP("PRCAGT",$J) D SITE^PRCAGU
"RTN","PRCAGDR",47,0)
 D NOW^%DTC S END=%,CHK=1,PBAL=0,DAT=$E(DT,1,5)_$S($L(STD)=1:0_STD,1:STD)
"RTN","PRCAGDR",48,0)
 S LDT3=$$FPS^RCAMFN01(DAT,-3)
"RTN","PRCAGDR",49,0)
 S BEG=$$LST^RCFN01(DEB,2) I $P(BEG,".")'<$P(DAT,".") D 8^PRCAGDT(BEG) Q
"RTN","PRCAGDR",50,0)
 I BEG<1 S PDAT="",BEG=0,PBAL=0
"RTN","PRCAGDR",51,0)
 I BEG S PDAT=BEG,BEG=9999999.999999-BEG D PBAL^PRCAGU(DEB,.BEG,.PBAL)
"RTN","PRCAGDR",52,0)
 D EN^PRCAGT(DEB,BEG,.END)
"RTN","PRCAGDR",53,0)
 S TBAL=0 D TBAL^PRCAGT(DEB,.TBAL)
"RTN","PRCAGDR",54,0)
 S BBAL=0 D BBAL^PRCAGU(DEB,.BBAL)
"RTN","PRCAGDR",55,0)
 I CSBB,CSBB'<BBAL Q  ; entire account has been referred to CS
"RTN","PRCAGDR",56,0)
 W !!,"Patient Statement Check:",!!
"RTN","PRCAGDR",57,0)
 S X=$$PRE^PRCAGU(DEB) S PEND=$P(X,U,2),X=+X
"RTN","PRCAGDR",58,0)
 I X,BBAL D 3^PRCAGDT Q
"RTN","PRCAGDR",59,0)
 I BBAL=0,PEND,-PEND=PBAL+TBAL D 2^PRCAGDT Q
"RTN","PRCAGDR",60,0)
 I BBAL'=(PBAL+TBAL) D 1^PRCAGDT(DEB,BBAL,.TBAL,PBAL,BEG) Q
"RTN","PRCAGDR",61,0)
 I BBAL=0,$G(SITE("ZERO")) D 4^PRCAGDT Q
"RTN","PRCAGDR",62,0)
 I BBAL'>0,'$D(^TMP("PRCAGT",$J,DEB)) D 5^PRCAGDT Q
"RTN","PRCAGDR",63,0)
 I BBAL<0,BBAL>-.99 D 6^PRCAGDT Q
"RTN","PRCAGDR",64,0)
 I BBAL'<0,'$D(^XTMP("PRCAGU",$J,DEB)),'COMM D 10^PRCAGDT Q  ;third letter printed, not comment
"RTN","PRCAGDR",65,0)
 S TBAL=TBAL+PBAL
"RTN","PRCAGDR",66,0)
 ;adjust amounts to be filed in 349.2 for CS bills
"RTN","PRCAGDR",67,0)
 S TBAL=TBAL-CSBB ; reduce the total bill balance by CS balance
"RTN","PRCAGDR",68,0)
 S CSPREV=CSBB-(CSTCH+CSTPC) ; compute the CS previous balance as the difference between the bill balance and the transaction balance
"RTN","PRCAGDR",69,0)
 S PBAL=PBAL-CSPREV ; reduce the previous balance by the CS previous balance
"RTN","PRCAGDR",70,0)
 S TBAL("CH")=TBAL("CH")-CSTCH ; reduce total charges by CS charges
"RTN","PRCAGDR",71,0)
 S TBAL("PC")=TBAL("PC")-CSTPC ; reduce total credits by CS credits
"RTN","PRCAGDR",72,0)
 I CHK=1 D OK^PRCAGDT
"RTN","PRCAGDR",73,0)
 K ^TMP("PRCAGT",$J)
"RTN","PRCAGDR",74,0)
 Q
"RTN","PRCAGS")
0^47^B22454707
"RTN","PRCAGS",1,0)
PRCAGS ;WASH-ISC@ALTOONA,PA/CMS-Patient Statement ;6/19/96  5:12 PM
"RTN","PRCAGS",2,0)
V ;;4.5;Accounts Receivable;**34,78,301**;Mar 20, 1995;Build 144
"RTN","PRCAGS",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","PRCAGS",4,0)
 ;ENTRY FROM NIGHTLY PROCESS
"RTN","PRCAGS",5,0)
 NEW HDAT,DEB
"RTN","PRCAGS",6,0)
EN ;entry from patient statement option
"RTN","PRCAGS",7,0)
 NEW %,%H,%I,DAT,END,LDT1,LDT3,SDT,SITE,PRNT,X,X1,X2,Y
"RTN","PRCAGS",8,0)
 D DT^DICRW,SITE^PRCAGU
"RTN","PRCAGS",9,0)
 I '$D(SITE) D  Q
"RTN","PRCAGS",10,0)
 .   D NOW^%DTC S Y=% D DD^%DT
"RTN","PRCAGS",11,0)
 .   W !!,"AR SITE PARAMETER ENTRIES NOT DEFINED!",?46,Y,!!,"COULD NOT PROCESS AR PATIENT STATEMENTS"
"RTN","PRCAGS",12,0)
 ;
"RTN","PRCAGS",13,0)
 S:$G(HDAT)="" HDAT=DT S SDT=+$E(HDAT,6,7)
"RTN","PRCAGS",14,0)
 D NOW^%DTC S END=%
"RTN","PRCAGS",15,0)
 S LDT1=$$FPS^RCAMFN01(HDAT,-1)
"RTN","PRCAGS",16,0)
 S LDT3=$$FPS^RCAMFN01(HDAT,-3)
"RTN","PRCAGS",17,0)
 ;I $G(DEB) S DAT=HDAT D STS G ENQ ;if comming in thru option.
"RTN","PRCAGS",18,0)
 ;F DEB=0:0 S DEB=$O(^RCD(340,"AC",SDT,DEB)) Q:'DEB  I $P(^RCD(340,DEB,0),U,1)["DPT" S DAT=HDAT D STS
"RTN","PRCAGS",19,0)
 F DEB=0:0 S DEB=$O(^RCD(340,"AC",SDT,DEB)) Q:'DEB  I $P(^RCD(340,DEB,0),U,1)'["DPT" D
"RTN","PRCAGS",20,0)
 .S DAT=$$LST^RCFN01(DEB,10) I $P(DAT,".")'<$P(HDAT,".") Q
"RTN","PRCAGS",21,0)
 .S PRNT="FL",SB="" D EN^PRCAGF(DEB,SB,.PRNT) I PRNT D UPDAT^PRCAGU(DEB,HDAT),BEVN^PRCAGU(DEB,HDAT)
"RTN","PRCAGS",22,0)
ENQ K DAT,DEB,^TMP("PRCAGT",$J)
"RTN","PRCAGS",23,0)
 Q
"RTN","PRCAGS",24,0)
STS ;start statement process
"RTN","PRCAGS",25,0)
 ;NEW BBAL,BEG,PBAL,PDAT,PEND,SBAL,SDT,TBAL,X,Y
"RTN","PRCAGS",26,0)
 ;K ^TMP("PRCAGT",$J)
"RTN","PRCAGS",27,0)
 ;D NOW^%DTC S END=%
"RTN","PRCAGS",28,0)
 ;S BEG=+$$LST^RCFN01(DEB,2) I $P(BEG,".")'<$P(DAT,".") G STSQ ;statement printed on or after this date
"RTN","PRCAGS",29,0)
 ;I BEG<1 S PDAT="",BEG=0,PBAL=0 ;get last date/time event occurred
"RTN","PRCAGS",30,0)
 ;I BEG S PDAT=BEG,BEG=9999999.999999-BEG,PBAL=0 D PBAL^PRCAGU(DEB,.BEG,.PBAL) ;Get previous bal and prev date of last transaction
"RTN","PRCAGS",31,0)
 ;D EN^PRCAGT(DEB,BEG,.END) ;get transactions reset END to last tran
"RTN","PRCAGS",32,0)
 ;S TBAL=0 D TBAL^PRCAGT(DEB,.TBAL) ;get trans bal
"RTN","PRCAGS",33,0)
 ;S BBAL=0 D BBAL^PRCAGU(DEB,.BBAL) ;get bill bal
"RTN","PRCAGS",34,0)
 ;S X=$$PRE^PRCAGU(DEB) S PEND=$P(X,U,2),X=+X I X,BBAL D REF^PRCAGD(DEB,X,$G(REP)) G STSQ ;unprocessed refund and outstand bills send disc
"RTN","PRCAGS",35,0)
 ;I BBAL=0,PEND,-PEND=PBAL+TBAL G STSQ ;all of the amount due is prepayment pending or refund review status
"RTN","PRCAGS",36,0)
 ;I BBAL'=(PBAL+TBAL) D EN^PRCAGD(DEB,BBAL,TBAL,PBAL,BEG,$G(REP)) G STSQ ;send disc
"RTN","PRCAGS",37,0)
 ;I BBAL=0,$G(SITE("ZERO")) G STSQ ;zero balance
"RTN","PRCAGS",38,0)
 ;I BBAL'>0,'$D(^TMP("PRCAGT",$J,DEB)) G STSQ ;no amt due no activity
"RTN","PRCAGS",39,0)
 ;I BBAL<0,BBAL>-.99 G STSQ ;refund less than 1.00
"RTN","PRCAGS",40,0)
 ;I BBAL'<0,'$$ACT^PRCAGT(DEB,LDT3) G STSQ ;no activty past 3 stat
"RTN","PRCAGS",41,0)
 ;S TBAL=TBAL+PBAL
"RTN","PRCAGS",42,0)
 ;D EN^PRCAGST(DEB,.TBAL,PDAT,PBAL) S SITE("SCAN")="" ;print statement
"RTN","PRCAGS",43,0)
 ;D EN^PRCAGF(DEB,TBAL) S ERR="" ;get forms and print
"RTN","PRCAGS",44,0)
 ;D OPEN^RCEVDRV1(2,$P(^RCD(340,DEB,0),U),END,DUZ,$$SITE^RCMSITE,.ERR,.EVN,BBAL("PB")_U_BBAL("INT")_U_BBAL("ADM")_U_BBAL("CT")_U_BBAL("MF"))
"RTN","PRCAGS",45,0)
 ;I EVN D CLOSE^RCEVDRV1(EVN)
"RTN","PRCAGS",46,0)
 ;D UPDAT^PRCAGU(DEB,DT) ;set bill letter field
"RTN","PRCAGS",47,0)
 ;S SITE("SCAN")=$G(^RC(342,1,5))
"RTN","PRCAGS",48,0)
STSQ ;Q
"RTN","PRCAGS",49,0)
REP ;entry from reprint statement queued option
"RTN","PRCAGS",50,0)
 NEW DA,DEB,ETY,LST,SDT,SITE,X,Y
"RTN","PRCAGS",51,0)
 D SITE^PRCAGU
"RTN","PRCAGS",52,0)
 S ETY=+$O(^RC(341.1,"AC",2,0))
"RTN","PRCAGS",53,0)
 I 'BEG S BEG=1
"RTN","PRCAGS",54,0)
 F DA=BEG-1:0 S DA=$O(^RC(341,DA))  Q:'DA  I ETY=$P($G(^RC(341,DA,0)),U,2) Q:$S(END="*"&($P($P(^RC(341,DA,0),U,7),".")>HDAT):1,END'="*"&(DA>END):1,1:0)  S DEB=$P(^RC(341,DA,0),U,5) I DEB D REPS
"RTN","PRCAGS",55,0)
REPQ Q
"RTN","PRCAGS",56,0)
REPS ;Start reprint statement process
"RTN","PRCAGS",57,0)
 NEW BBAL,BDT,CR,DAT,EDT,LDT,LST,NOT,PBAL,PDAT,TBAL,X,Y
"RTN","PRCAGS",58,0)
 ; initialize variables for CS
"RTN","PRCAGS",59,0)
 NEW CSBB,CSTCH,CSTPC,CSPREV S (CSBB,CSTCH,CSTPC)=0
"RTN","PRCAGS",60,0)
 S DAT=9999999-HDAT
"RTN","PRCAGS",61,0)
 D DT^DICRW S EDT=$P(^RC(341,DA,0),U,6),LDT=$P(^(0),U,7) ;ending date of transactions to reprint
"RTN","PRCAGS",62,0)
 F I=2,3 S II=$P($G(^RC(341,DA,1)),U,I) I II S BBAL("INT")=II Q
"RTN","PRCAGS",63,0)
 K I,II
"RTN","PRCAGS",64,0)
 S BDT=0 D LST^PRCAGU(DEB,DA,.BDT) I 'BDT S PDAT="",PBAL=0 ;get last date/time of previous event before reprint event
"RTN","PRCAGS",65,0)
 I BDT S PDAT=9999999-$P(BDT,"."),PBAL=0 D PBAL^PRCAGU(DEB,.BDT,.PBAL) ;Get previous bal and prev date of last transaction
"RTN","PRCAGS",66,0)
 D EN^PRCAGT(DEB,BDT,EDT) ;get transactions for date range
"RTN","PRCAGS",67,0)
 S TBAL=0 D TBAL^PRCAGT(DEB,.TBAL) ;get trans bal
"RTN","PRCAGS",68,0)
 I CSBB,CSBB'<BBAL Q  ; entire account has been referred to CS
"RTN","PRCAGS",69,0)
 S TBAL=PBAL+TBAL
"RTN","PRCAGS",70,0)
 I TBAL=0,SITE("ZERO") G REPSQ ;zero balance
"RTN","PRCAGS",71,0)
 I TBAL'>0,'$D(^TMP("PRCAGT",$J,DEB)) G REPSQ ;less than 0 no activity
"RTN","PRCAGS",72,0)
 I TBAL<0,TBAL>-.99 G REPSQ ;refund less than 1.00
"RTN","PRCAGS",73,0)
 ; adjust amounts to be filed in 349.2 for CS bills
"RTN","PRCAGS",74,0)
 S TBAL=TBAL-CSBB ; reduce the total bill balance by CS balance
"RTN","PRCAGS",75,0)
 S CSPREV=CSBB-(CSTCH+CSTPC) ; compute the CS previous balance as the difference between the bill balance and the transaction balance
"RTN","PRCAGS",76,0)
 S PBAL=PBAL-CSPREV ; reduce the previous balance by the CS previous balance
"RTN","PRCAGS",77,0)
 S TBAL("CH")=TBAL("CH")-CSTCH ; reduce total charges by CS charges
"RTN","PRCAGS",78,0)
 S TBAL("PC")=TBAL("PC")-CSTPC ; reduce total credits by CS credits
"RTN","PRCAGS",79,0)
 D EN^PRCAGST(DEB,.TBAL,PDAT,PBAL,LDT) ;print statement
"RTN","PRCAGS",80,0)
 S (CR,NOT)=0,SITE("SCAN")=""
"RTN","PRCAGS",81,0)
 F STAT=16,42 F BN=0:0 S BN=$O(^PRCA(430,"AS",DEB,STAT,BN)) Q:'BN  D
"RTN","PRCAGS",82,0)
 .S LET=$G(^PRCA(430,BN,6)) F X=1:1:3 I $P(LET,U,X)=HDAT Q
"RTN","PRCAGS",83,0)
 .S LET=X S SB="" D LT^PRCAGF(BN,SB,LET) ;get forms and print
"RTN","PRCAGS",84,0)
 S SITE("SCAN")=$G(^RC(342,1,5))
"RTN","PRCAGS",85,0)
REPSQ Q
"RTN","PRCAGS",86,0)
BILL ;start reprint bill from queued option
"RTN","PRCAGS",87,0)
 NEW BN,PRCADA,DEB,X,Y
"RTN","PRCAGS",88,0)
 S DAT=9999999-DAT I 'BEG S BEG=1
"RTN","PRCAGS",89,0)
 F PRCADA=BEG-1:0 S PRCADA=$O(^RC(341,PRCADA)) Q:'PRCADA  I $P(^RC(341,PRCADA,0),U,2)=$S(ETY="UB":9,1:10) Q:$S('PRCADA:1,END="*"&($P($P(^RC(341,PRCADA,0),"^",7),".")>DAT):1,PRCADA>END&(END'="*"):1,1:0)  D BILLS
"RTN","PRCAGS",90,0)
BILLQ Q
"RTN","PRCAGS",91,0)
BILLS ;start reprint bills process
"RTN","PRCAGS",92,0)
 NEW BAL,NOTICE,PRCASV,X,Y
"RTN","PRCAGS",93,0)
 S BN=$G(^RC(341,PRCADA,5)) Q:'BN
"RTN","PRCAGS",94,0)
 S NOTICE=+$P(BN,U,2),BN=+BN
"RTN","PRCAGS",95,0)
 S BAL=$G(^RC(341,PRCADA,1)) S BAL=+BAL+$P(BAL,U,2)+$P(BAL,U,3)+$P(BAL,U,4)+$P(BAL,U,5)
"RTN","PRCAGS",96,0)
 I ETY'="UB" D LT^PRCAGF(BN,BAL,NOTICE) Q
"RTN","PRCAGS",97,0)
 I NOTICE>1 S PRCASV("NOTICE")=NOTICE,PRCASV("ARREC")=BN D REPRNT^IBCF13 Q
"RTN","PRCAGS",98,0)
 Q
"RTN","PRCAGST1")
0^48^B9484383
"RTN","PRCAGST1",1,0)
PRCAGST1 ;WASH-ISC@ALTOONA,PA/CMS-Print Patient Statement Bottom ;10/16/96  11:13 AM
"RTN","PRCAGST1",2,0)
V ;;4.5;Accounts Receivable;**2,48,104,176,249,301**;Mar 20, 1995;Build 144
"RTN","PRCAGST1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAGST1",4,0)
 ;ENTRY FROM PRCAGST PAGE 1
"RTN","PRCAGST1",5,0)
 NEW AMT,BN,DAT,DESC,I,REF,THNK,TN,TTY,X,Y,RCTOTAL
"RTN","PRCAGST1",6,0)
 D HDR
"RTN","PRCAGST1",7,0)
 S DESC(1)="Previous Balance",REF="" D WRL(PDAT,.DESC,PBAL,REF)
"RTN","PRCAGST1",8,0)
 S DAT=0
"RTN","PRCAGST1",9,0)
 F  S DAT=$O(^TMP("PRCAGT",$J,DEB,DAT)) Q:'DAT  S BN=0 F  S BN=$O(^TMP("PRCAGT",$J,DEB,DAT,BN)) Q:'BN  D
"RTN","PRCAGST1",10,0)
 . Q:$D(^PRCA(430,"TCSP",BN))  ; skip CS bills/transactions
"RTN","PRCAGST1",11,0)
 . S REF=$P($G(^PRCA(430,BN,0)),"^") ; Get Bill Name
"RTN","PRCAGST1",12,0)
 . I $D(^TMP("PRCAGT",$J,DEB,DAT,BN,0)) S AMT=+^(0) I AMT D  Q
"RTN","PRCAGST1",13,0)
 .. D BILLDESC(BN,.DESC)  ; Compile bill description
"RTN","PRCAGST1",14,0)
 .. D WRL(DAT,.DESC,AMT,REF) ; Print the item
"RTN","PRCAGST1",15,0)
 . S TN=0 F  S TN=$O(^TMP("PRCAGT",$J,DEB,DAT,BN,TN)) Q:'TN  S AMT=^(TN) D
"RTN","PRCAGST1",16,0)
 .. S TTY=$P(AMT,U,2) S AMT=+AMT
"RTN","PRCAGST1",17,0)
 .. D AMOUNT(TN,TTY,.AMT,.THNK) ; Adjust Amount sign (+/-) and "Thank You" flag
"RTN","PRCAGST1",18,0)
 .. D TRANDESC(TN,.DESC) ; Compile description
"RTN","PRCAGST1",19,0)
 .. D WRL(DAT,.DESC,AMT,REF) ; Print the item
"RTN","PRCAGST1",20,0)
 I ($Y+9)>(IOSL-2) D  D HDR
"RTN","PRCAGST1",21,0)
 . W !,"|" F I=12,46,9,12 S Y="",$P(Y,"_",I)="" W Y,"|"
"RTN","PRCAGST1",22,0)
 D SUM^PRCAGST2
"RTN","PRCAGST1",23,0)
 Q
"RTN","PRCAGST1",24,0)
WRL(DAT,DESC,AMT,REF) ;Write transaction
"RTN","PRCAGST1",25,0)
 NEW LN,I,X,Y
"RTN","PRCAGST1",26,0)
 S LN=1,X=0 F  S X=$O(DESC(X)) Q:'X  S LN=$G(LN)+1
"RTN","PRCAGST1",27,0)
 I ($Y+LN)>(IOSL-2) D  D HDR
"RTN","PRCAGST1",28,0)
 . W !,"|" F I=12,46,9,12 S Y="",$P(Y,"_",I)="" W Y,"|"
"RTN","PRCAGST1",29,0)
 W !,"|",$S($G(DAT):$$DAT(DAT),1:""),?12,"|",DESC(1),?58,"|",$J(AMT,8,2),?67,"|",?68,$G(REF),?79,"|"
"RTN","PRCAGST1",30,0)
 F X=1:0 S X=$O(DESC(X)) Q:'X  W !,"|",?12,"|",DESC(X),?58,"|",?67,"|",?79,"|"
"RTN","PRCAGST1",31,0)
 Q
"RTN","PRCAGST1",32,0)
 ;
"RTN","PRCAGST1",33,0)
 ; Get transaction description array
"RTN","PRCAGST1",34,0)
TRANDESC(PRTRAN,RCDESC) N RCTOTAL
"RTN","PRCAGST1",35,0)
 ; RCTOTAL not used in reprinted statements.
"RTN","PRCAGST1",36,0)
 K RCDESC
"RTN","PRCAGST1",37,0)
 D TRANDESC^RCCPCPS1(PRTRAN,45) ; returns RCDESC() array (max. length 45 characters)
"RTN","PRCAGST1",38,0)
 Q
"RTN","PRCAGST1",39,0)
 ;
"RTN","PRCAGST1",40,0)
AMOUNT(BN,TTY,AMT,THNK) ;Adjust (+/-) amount depending on Transaction Type
"RTN","PRCAGST1",41,0)
 N BN0,CAT,TS
"RTN","PRCAGST1",42,0)
 S BN0=$G(^PRCA(430,BN,0)),CAT=$$CATN^PRCAFN(+$P(BN0,U,2))
"RTN","PRCAGST1",43,0)
 I ",2,8,9,10,11,14,19,47,34,35,29,"[(","_TTY_",") I AMT'<0 S AMT=-AMT
"RTN","PRCAGST1",44,0)
 I ",2,8,9,10,11,12,14,19,47,34,35,29,"'[(","_TTY_",") I AMT<0 S AMT=-AMT
"RTN","PRCAGST1",45,0)
 I +CAT=33,TTY=1 I AMT<0 S AMT=-AMT
"RTN","PRCAGST1",46,0)
 I +CAT=33,TTY=35 I AMT>0 S AMT=-AMT
"RTN","PRCAGST1",47,0)
 S TS=$P($G(^PRCA(430.3,TTY,0)),U,3) I '$D(THNK),(TS=2!(TS=20)) S THNK=1
"RTN","PRCAGST1",48,0)
 Q
"RTN","PRCAGST1",49,0)
 ; Description for bills
"RTN","PRCAGST1",50,0)
 ; Input: PRBILL - Bill IEN
"RTN","PRCAGST1",51,0)
 ; Output: RCDESC(1..n) - Description Array
"RTN","PRCAGST1",52,0)
BILLDESC(PRBILL,RCDESC) K RCDESC
"RTN","PRCAGST1",53,0)
 D BILLDESC^RCCPCPS1(PRBILL,45) ; returns RCDESC() array (max. length 45 characters)
"RTN","PRCAGST1",54,0)
 Q
"RTN","PRCAGST1",55,0)
DAT(DAT) ;slash date
"RTN","PRCAGST1",56,0)
 I 'DAT Q ""
"RTN","PRCAGST1",57,0)
 Q $$SLH^RCFN01(DAT,"/")
"RTN","PRCAGST1",58,0)
HDR ;statement transaction header
"RTN","PRCAGST1",59,0)
 NEW I,Y
"RTN","PRCAGST1",60,0)
 S PAGE=$G(PAGE)+1
"RTN","PRCAGST1",61,0)
 I PAGE>1 W @IOF I $G(^RC(342,1,5))]"" F I=1:1:18 W !
"RTN","PRCAGST1",62,0)
 W !,"Department of Veterans Affairs",?50,"Acct No.:",$P($$SITE^VASITE(),U,3)_"/"_$E(SSN,6,9)
"RTN","PRCAGST1",63,0)
 W !,NAM,?50,"Page ",PAGE
"RTN","PRCAGST1",64,0)
 S Y="",$P(Y,"_",80)="" W !,Y
"RTN","PRCAGST1",65,0)
 W !,"|Date Posted|",?13,"     Description",?58,"| Amount ",?67,"| Reference |"
"RTN","PRCAGST1",66,0)
 W !,"|" F I=12,46,9,12 S Y="",$P(Y,"_",I)="" W Y,"|"
"RTN","PRCAGST1",67,0)
 Q
"RTN","PRCAGT")
0^21^B22272453
"RTN","PRCAGT",1,0)
PRCAGT ;WASH-ISC@ALTOONA,PA/CMS-Patient Statement Build Tran List ;8/19/93
"RTN","PRCAGT",2,0)
V ;;4.5;Accounts Receivable;**100,162,165,169,219,301**;Mar 20, 1995;Build 144
"RTN","PRCAGT",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAGT",4,0)
 ;SEND (DEB=340-IFN,BEG,END,TRANTYPE=430.3-IFN)
"RTN","PRCAGT",5,0)
 ;BUILD ^TMP("PRCAGT",$J,DEB,DATE,BILL,TN)=TAMT^TTY
"RTN","PRCAGT",6,0)
 ;IF (TN,TTY)=0 TAMT=BILL'S ORIG AMT
"RTN","PRCAGT",7,0)
 ;CALLER MUST KILL ^TMP
"RTN","PRCAGT",8,0)
EN(DEB,BEG,END,TTY) ;*CALLER MUST KILL ^TMP("PRCAGT",$J)
"RTN","PRCAGT",9,0)
 NEW Y K ^TMP("PRCAGT",$J)
"RTN","PRCAGT",10,0)
 S:$G(BEG)="" BEG=0 I $G(END)="" D NOW^%DTC S END=%
"RTN","PRCAGT",11,0)
 S TTY=$G(TTY) I TTY="" D F430
"RTN","PRCAGT",12,0)
 D F433
"RTN","PRCAGT",13,0)
Q Q
"RTN","PRCAGT",14,0)
F430 ;
"RTN","PRCAGT",15,0)
 NEW DAT,BN
"RTN","PRCAGT",16,0)
 S DAT=BEG F  S DAT=$O(^PRCA(430,"ATD",DEB,DAT)) Q:('DAT)!(DAT>END)  S BN=0 F  S BN=$O(^PRCA(430,"ATD",DEB,DAT,BN)) Q:'BN  D
"RTN","PRCAGT",17,0)
 .;Q:$D(^PRCA(430,"TCSP",BN))  ;prca*4.5*301
"RTN","PRCAGT",18,0)
 .I $P(^PRCA(430,BN,0),U,3) S ^TMP("PRCAGT",$J,DEB,DAT,BN,0)=$P(^PRCA(430,BN,0),"^",3)_"^0"
"RTN","PRCAGT",19,0)
 Q
"RTN","PRCAGT",20,0)
F433 ;
"RTN","PRCAGT",21,0)
 NEW DAT,TN,TN0,TN1 S COMM=0
"RTN","PRCAGT",22,0)
 F DAT=BEG:0 S DAT=$O(^PRCA(433,"ATD",DEB,DAT)) Q:('DAT)!(DAT>END)  F TN=0:0 S TN=$O(^PRCA(433,"ATD",DEB,DAT,TN)) Q:'TN  D
"RTN","PRCAGT",23,0)
 .S TN0=$G(^PRCA(433,TN,0)) Q:TN0=""  S TN1=$G(^PRCA(433,TN,1))
"RTN","PRCAGT",24,0)
 .I $P(TN1,U,2)=45 S COMM=1
"RTN","PRCAGT",25,0)
 .I $G(TTY)'="" Q:TTY'=$P(TN1,U,2)
"RTN","PRCAGT",26,0)
 .I TTY="",",3,4,5,6,7,24,25,30,"[(","_$P(TN1,U,2)_",") Q
"RTN","PRCAGT",27,0)
 .I ($P(TN0,U,2)="")!($P(TN0,U,4)'=2) Q
"RTN","PRCAGT",28,0)
 .I $G(PRCAHIST)="THIST",$P(TN1,U,2)=45 G F433A
"RTN","PRCAGT",29,0)
 .I $P(TN0,U,10)=1 Q
"RTN","PRCAGT",30,0)
 .;
"RTN","PRCAGT",31,0)
 .;  if transaction type not 46 (unsuspended) and not 47 (suspended)
"RTN","PRCAGT",32,0)
 .;  then check to see if the bill was suspended or unsuspended at the
"RTN","PRCAGT",33,0)
 .;  time the transaction was entered.  if the bill is suspended, then
"RTN","PRCAGT",34,0)
 .;  the transaction should not be counted.  if the bill is unsuspended
"RTN","PRCAGT",35,0)
 .;  then the transaction should be counted.
"RTN","PRCAGT",36,0)
 .I $P(TN1,"^",2)'=46,$P(TN1,"^",2)'=47 D  I TN1="" Q
"RTN","PRCAGT",37,0)
 .   .   N RCTRANDA,RCSTOP,TRANTYPE
"RTN","PRCAGT",38,0)
 .   .   ;  check to see if bill was unsuspended when transaction was created
"RTN","PRCAGT",39,0)
 .   .   ;  if so, count the transaction
"RTN","PRCAGT",40,0)
 .   .   S RCSTOP=0
"RTN","PRCAGT",41,0)
 .   .   S RCTRANDA=TN F  S RCTRANDA=$O(^PRCA(433,"C",+$P(TN0,"^",2),RCTRANDA),-1) Q:'RCTRANDA  D  I RCSTOP Q
"RTN","PRCAGT",42,0)
 .   .   .   ;  transaction not complete
"RTN","PRCAGT",43,0)
 .   .   .   I $P($G(^PRCA(433,RCTRANDA,0)),"^",4)'=2 Q
"RTN","PRCAGT",44,0)
 .   .   .   S TRANTYPE=$P($G(^PRCA(433,RCTRANDA,1)),"^",2)
"RTN","PRCAGT",45,0)
 .   .   .   ;  transaction type is unsuspended (46) meaning the bill
"RTN","PRCAGT",46,0)
 .   .   .   ;  was unsuspended when the transaction was created.  the
"RTN","PRCAGT",47,0)
 .   .   .   ;  transaction should be counted.
"RTN","PRCAGT",48,0)
 .   .   .   I TRANTYPE=46 S RCSTOP=1 Q
"RTN","PRCAGT",49,0)
 .   .   .   ;  transaction type is suspended (47) meaning the bill
"RTN","PRCAGT",50,0)
 .   .   .   ;  was suspended when the transaction was created.  the
"RTN","PRCAGT",51,0)
 .   .   .   ;  transaction should not be counted.
"RTN","PRCAGT",52,0)
 .   .   .   I TRANTYPE=47 S RCSTOP=1,TN1="" Q
"RTN","PRCAGT",53,0)
 .;
"RTN","PRCAGT",54,0)
 .I TTY="",+$P(TN1,U,5)=0,$P(TN1,U,2)'=45 Q
"RTN","PRCAGT",55,0)
F433A .S ^TMP("PRCAGT",$J,DEB,DAT,$P(TN0,U,2),TN)=+$P(TN1,U,5)_U_$P(TN1,U,2)
"RTN","PRCAGT",56,0)
 S DAT=0 F  S DAT=$O(^TMP("PRCAGT",$J,DEB,DAT)) Q:'DAT  S END=DAT
"RTN","PRCAGT",57,0)
 Q
"RTN","PRCAGT",58,0)
TBAL(DEB,TBAL) ;get balance of transactions
"RTN","PRCAGT",59,0)
 NEW BN,CH,DAT,PC,RF,RR,TAMT,TN,TTY,CS,CSFLAG
"RTN","PRCAGT",60,0)
 S RR=+$O(^PRCA(430.2,"AC",33,0)),(CH,RF,PC)=0,CSFLAG=$D(CSTCH)
"RTN","PRCAGT",61,0)
 I '$D(^TMP("PRCAGT",$J,DEB)) G TBALQ
"RTN","PRCAGT",62,0)
 F DAT=0:0 S DAT=$O(^TMP("PRCAGT",$J,DEB,DAT)) Q:'DAT  F BN=0:0 S BN=$O(^TMP("PRCAGT",$J,DEB,DAT,BN)) Q:'BN  D
"RTN","PRCAGT",63,0)
 .S CS=$D(^PRCA(430,"TCSP",BN)) ; set flag for CS bills
"RTN","PRCAGT",64,0)
 .I $D(^TMP("PRCAGT",$J,DEB,DAT,BN,0)) S CH=CH+^(0) S:CS CSTCH=$G(CSTCH)+^(0)
"RTN","PRCAGT",65,0)
 .F TN=0:0 S TN=$O(^TMP("PRCAGT",$J,DEB,DAT,BN,TN)) Q:'TN  S TAMT=^(TN),TTY=$P(TAMT,U,2) I TTY'=45 D
"RTN","PRCAGT",66,0)
 ..I TTY=12 S:TAMT<0 PC=PC+TAMT S:TAMT'<0 CH=CH+TAMT S:TAMT<0&CS CSTPC=$G(CSTPC)+TAMT S:TAMT'<0 CSTCH=$G(CSTCH)+TAMT
"RTN","PRCAGT",67,0)
 ..;  interest and admin charges may be negative
"RTN","PRCAGT",68,0)
 ..;  this was added in patch 165
"RTN","PRCAGT",69,0)
 ..I TTY'=13 S TAMT=$TR(+TAMT,"-")
"RTN","PRCAGT",70,0)
 ..I $P(^PRCA(430,BN,0),U,2)=RR S:TTY=1 PC=PC-TAMT S:TTY=35 CH=CH+TAMT S:TTY=41 RF=RF+TAMT Q
"RTN","PRCAGT",71,0)
 ..I ",2,8,9,10,11,14,19,47,34,35,29,"[(","_TTY_",") S PC=PC-TAMT S:CS CSTPC=$G(CSTPC)-TAMT Q
"RTN","PRCAGT",72,0)
 ..I ",1,13,46,43,"[(","_TTY_",") S CH=CH+TAMT S:CS CSTCH=$G(CSTCH)+TAMT
"RTN","PRCAGT",73,0)
 ;
"RTN","PRCAGT",74,0)
TBALQ S TBAL("RF")=RF,TBAL("CH")=CH,TBAL("PC")=PC,TBAL=RF+CH+PC
"RTN","PRCAGT",75,0)
 I 'CSFLAG K CSTCH,CSTPC
"RTN","PRCAGT",76,0)
 Q
"RTN","PRCAGT",77,0)
ACT(DEB,DAT) ;Quit 1 if debtor has activity other than interest
"RTN","PRCAGT",78,0)
 NEW BN,DATT,TN,TN0,TN1
"RTN","PRCAGT",79,0)
 S TN=0 F DATT=$P($G(DAT),"."):0 S DATT=$O(^PRCA(430,"ATD",DEB,DATT)) Q:'DATT!(TN)  F BN=0:0 S BN=$O(^PRCA(430,"ATD",DEB,DATT,BN)) Q:'BN!(TN)  S TN=1 Q
"RTN","PRCAGT",80,0)
 I TN=1 G Q1
"RTN","PRCAGT",81,0)
 S BN=0 F DATT=$P($G(DAT),"."):0 S DATT=$O(^PRCA(433,"ATD",DEB,DATT)) Q:'DATT!(BN)  F TN=0:0 S TN=$O(^PRCA(433,"ATD",DEB,DATT,TN)) Q:'TN!(BN)  D
"RTN","PRCAGT",82,0)
 .S TN0=$G(^PRCA(433,TN,0)) Q:TN0=""  S TN1=$G(^PRCA(433,TN,1))
"RTN","PRCAGT",83,0)
 .I ($P(TN0,U,4)=1)!($P(TN0,U,10)=1) Q
"RTN","PRCAGT",84,0)
 .I +$P(TN1,U,5)=0,$P(TN1,U,2)'=45 Q
"RTN","PRCAGT",85,0)
 .I +$P(TN1,U,2)'=13 S BN=1 Q
"RTN","PRCAGT",86,0)
 I BN=1 G Q1
"RTN","PRCAGT",87,0)
Q0 Q 0
"RTN","PRCAGT",88,0)
Q1 Q 1
"RTN","PRCAGU")
0^22^B12887006
"RTN","PRCAGU",1,0)
PRCAGU ;WASH-ISC@ALTOONA,PA/CMS-Patient Statement Utility ;8/23/94  8:06 AM
"RTN","PRCAGU",2,0)
V ;;4.5;Accounts Receivable;**181,219,301**;Mar 20, 1995;Build 144
"RTN","PRCAGU",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAGU",4,0)
 Q  ;This routine should not be called from the top
"RTN","PRCAGU",5,0)
SITE ;Set statement variables from Site Parameter File
"RTN","PRCAGU",6,0)
 NEW SP0,SP2
"RTN","PRCAGU",7,0)
 S SP0=$G(^RC(342,1,0)) I SP0="" G SITEQ
"RTN","PRCAGU",8,0)
 S SP2=$G(^RC(342,1,2))
"RTN","PRCAGU",9,0)
 S SITE("SUP")=+$P(SP0,U,2) ;suppres right&oblig
"RTN","PRCAGU",10,0)
 S SITE("DETL")=+$P(SP0,U,5) ;Copay info 1-brief or 2-expanded
"RTN","PRCAGU",11,0)
 S SITE("COM1")=$P($G(SP2),U,1) ;statement comment 1
"RTN","PRCAGU",12,0)
 S SITE("COM2")="" ; statement comment 2 disabled with GMT patch ;($P($G(SP2),U,2))
"RTN","PRCAGU",13,0)
 S SITE("SCAN")=$G(^RC(342,1,5)) ;mark for auto stuffer
"RTN","PRCAGU",14,0)
 S SITE("ZERO")=$P($G(SP0),U,9) ;suppress zero balance
"RTN","PRCAGU",15,0)
SITEQ Q
"RTN","PRCAGU",16,0)
PBAL(DEB,DAT,PBAL) ;get previous balance and date of last transaction
"RTN","PRCAGU",17,0)
 N EVN,I,Y G:'DEB PBALQ
"RTN","PRCAGU",18,0)
 S EVN=$O(^RC(341,"AD",DEB,+$O(^RC(341.1,"AC",2,0)),DAT,0))
"RTN","PRCAGU",19,0)
 I '$G(EVN) G PBALQ
"RTN","PRCAGU",20,0)
 S Y=$G(^RC(341,EVN,1)) F I=1:1:5 S PBAL=PBAL+$P(Y,U,I)
"RTN","PRCAGU",21,0)
 S DAT=$P($G(^RC(341,EVN,0)),U,6)
"RTN","PRCAGU",22,0)
PBALQ Q
"RTN","PRCAGU",23,0)
BBAL(DEB,BBAL) ;get bills balances return array
"RTN","PRCAGU",24,0)
 NEW ADM,AC,BAL,CT,I,INT,MF,OP,PB,PRE,STAT,CS,CSFLAG
"RTN","PRCAGU",25,0)
 S (BBAL,PB,INT,ADM,MF,CT)=0,LET3="",CSFLAG=$D(CSBB)
"RTN","PRCAGU",26,0)
 G:'DEB BBALQ
"RTN","PRCAGU",27,0)
 S AC=+$O(^PRCA(430.3,"AC",102,0)),OP=+$O(^PRCA(430.3,"AC",112,0)),PRE=+$O(^PRCA(430.2,"AC",33,0))
"RTN","PRCAGU",28,0)
 F STAT=AC,OP F BN=0:0 S BN=$O(^PRCA(430,"AS",DEB,STAT,BN)) Q:'BN  D
"RTN","PRCAGU",29,0)
 .S BAL=$G(^PRCA(430,BN,7)),CS=$D(^PRCA(430,"TCSP",BN)) ; set flag for CS bills
"RTN","PRCAGU",30,0)
 .I $D(^PRCA(430,BN,6)) S LET3=$P(^(6),U,3) I LET3="" S ^XTMP("PRCAGU",$J,DEB,BN)=""
"RTN","PRCAGU",31,0)
 .I $P(^PRCA(430,BN,0),U,2)=PRE S PB=PB-BAL Q
"RTN","PRCAGU",32,0)
 .S PB=PB+$P(BAL,U,1),INT=INT+$P(BAL,U,2),ADM=ADM+$P(BAL,U,3),MF=MF+$P(BAL,U,4),CT=CT+$P(BAL,U,5)
"RTN","PRCAGU",33,0)
 .; for CS bills, update the CS bill balance
"RTN","PRCAGU",34,0)
 .I CS S CSBB=$G(CSBB)+$P(BAL,U,1)+$P(BAL,U,2)+$P(BAL,U,3)+$P(BAL,U,4)+$P(BAL,U,5)
"RTN","PRCAGU",35,0)
 S BBAL=PB+INT+ADM+MF+CT
"RTN","PRCAGU",36,0)
 F X="PB","INT","ADM","MF","CT" S BBAL(X)=@X
"RTN","PRCAGU",37,0)
BBALQ I 'CSFLAG K CSBB
"RTN","PRCAGU",38,0)
 Q
"RTN","PRCAGU",39,0)
UPDAT(DEB,DAT) ;update bill file 430 letter fields
"RTN","PRCAGU",40,0)
 NEW BN,DA,DIE,DR,II,LET,NOT,X,Y
"RTN","PRCAGU",41,0)
 G:'DEB UPDATQ
"RTN","PRCAGU",42,0)
 S:$G(DAT)="" DAT=DT S DIE="^PRCA(430,",NOT=0,BN=0
"RTN","PRCAGU",43,0)
 F  S BN=$O(^PRCA(430,"AS",DEB,16,BN)) Q:'BN  S DA=BN D
"RTN","PRCAGU",44,0)
 .S LET=$G(^PRCA(430,BN,6))
"RTN","PRCAGU",45,0)
 .F II=1:1:4 Q:$P(LET,U,II)=DAT  I $P(LET,U,II)="" S NOT=II,DR=$S(II=1:61,II=2:62,II=3:63,1:68)_"////^S X="_DAT_";68.1////^S X="_DAT D ^DIE Q
"RTN","PRCAGU",46,0)
UPDATQ Q
"RTN","PRCAGU",47,0)
BEVN(DEB,DAT) ;set event for non patient letters
"RTN","PRCAGU",48,0)
 NEW BAL,BN,DA,DIE,DR,EVN,I,NOT,X,Y
"RTN","PRCAGU",49,0)
 G:'DEB BEVNQ
"RTN","PRCAGU",50,0)
 S:$G(DAT)="" DAT=DT S DIE="^RC(341,",NOT=0,BN=0
"RTN","PRCAGU",51,0)
 F  S BN=$O(^PRCA(430,"AS",DEB,16,BN)) Q:'BN  D
"RTN","PRCAGU",52,0)
 .F I=1:1:3 I $P($G(^PRCA(430,BN,6)),U,I)=DAT S NOT=I Q
"RTN","PRCAGU",53,0)
 .S:'NOT NOT=4 S BAL=$G(^PRCA(430,BN,7)),ERR="",EVN=""
"RTN","PRCAGU",54,0)
 .D OPEN^RCEVDRV1(10,$P(^RCD(340,DEB,0),U),DAT,DUZ,$$SITE^RCMSITE,.ERR,.EVN,+BAL_U_$P(BAL,U,2)_U_$P(BAL,U,3)_U_$P(BAL,U,4)_U_$P(BAL,U,5))
"RTN","PRCAGU",55,0)
 .I EVN S DA=EVN,DR="5.01////^S X="_BN_";5.02////^S X="_NOT D ^DIE D CLOSE^RCEVDRV1(EVN)
"RTN","PRCAGU",56,0)
BEVNQ Q
"RTN","PRCAGU",57,0)
PRE(DEB) ;check for prepay bills in Refund review or Pending Calm
"RTN","PRCAGU",58,0)
 NEW BAL,BN,PEN,PRE,RR,STAT,Y
"RTN","PRCAGU",59,0)
 S (BAL,Y)=0 G:'DEB PREQ
"RTN","PRCAGU",60,0)
 S RR=+$O(^PRCA(430.3,"AC",113,0)),PEN=+$O(^PRCA(430.3,"AC",107,0)),PRE=+$O(^PRCA(430.2,"AC",33,0))
"RTN","PRCAGU",61,0)
 F STAT=RR,PEN F BN=0:0 S BN=$O(^PRCA(430,"AS",DEB,STAT,BN)) Q:'BN  D
"RTN","PRCAGU",62,0)
 .I $P($G(^PRCA(430,BN,0)),U,2)=PRE S Y=BN,BAL=BAL+$G(^PRCA(430,BN,7))
"RTN","PRCAGU",63,0)
PREQ Q Y_U_BAL
"RTN","PRCAGU",64,0)
LST(DEB,EVN,BDT) ;get last statement date before the statement date sent
"RTN","PRCAGU",65,0)
 NEW BEG,DAT,Y
"RTN","PRCAGU",66,0)
 S BDT=0 I 'DEB G LSTQ
"RTN","PRCAGU",67,0)
 S Y=+$O(^RC(341.1,"AC",2,0)),BEG=$P($G(^RC(341,EVN,0)),U,7) I 'BEG G LSTQ
"RTN","PRCAGU",68,0)
 S BEG=9999999.999999-BEG
"RTN","PRCAGU",69,0)
 F DAT=BEG:0 S DAT=$O(^RC(341,"AD",DEB,Y,DAT)) Q:'DAT  S BDT=DAT Q
"RTN","PRCAGU",70,0)
 ;return BDT in inverse date
"RTN","PRCAGU",71,0)
LSTQ Q
"RTN","PRCAPRO")
0^15^B14760379
"RTN","PRCAPRO",1,0)
PRCAPRO ;SF-ISC/YJK-PROFILE OF ACCOUNTS RECEIVABLE ;10/17/95  2:02 PM
"RTN","PRCAPRO",2,0)
V ;;4.5;Accounts Receivable;**2,21,125,147,198,301**;Mar 20, 1995;Build 144
"RTN","PRCAPRO",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAPRO",4,0)
 ;PRINT THE PROFILE OF A/R CALLING THE ROUTINES CREATED BY PRINT TEMPLATE
"RTN","PRCAPRO",5,0)
INIT K %ZIS,IOP,DXS S PRCABN=""
"RTN","PRCAPRO",6,0)
EN ;
"RTN","PRCAPRO",7,0)
 N DPTNOFZY,DPTNOFZK S (DPTNOFZY,DPTNOFZK)=1
"RTN","PRCAPRO",8,0)
 S DIC("S")="S Z0=$S($D(^PRCA(430.3,+$P(^(0),U,8),0)):$P(^(0),U,3),1:0) I (Z0<200)!(Z0=240)",DIC="^PRCA(430,",DIC(0)="AEMQZ",D="B^C^D^E" D MIX^DIC1 K DIC G:Y<0 END S (PRCABN,D0)=+Y
"RTN","PRCAPRO",9,0)
 G:$P(^PRCA(430,D0,0),U,8)="" END
"RTN","PRCAPRO",10,0)
 I $P(^PRCA(430.3,+$P(^PRCA(430,D0,0),U,8),0),U,3)=104 W *7,!,"This is a New Bill.  You should audit this bill to see the profile. ",! G EN
"RTN","PRCAPRO",11,0)
 I $P(^PRCA(430.3,+$P(^PRCA(430,D0,0),U,8),0),U,3)=101 W *7,!,"This is an Incomplete Bill.  You should edit this bill to see the profile.",! G EN
"RTN","PRCAPRO",12,0)
 S %ZIS="Q" D ^%ZIS Q:POP  S IOM=80,PRCAIO=IO,PRCAIO(0)=IO(0)
"RTN","PRCAPRO",13,0)
 I $D(IO("Q")) K IO("Q") S ZTRTN="PROC^PRCAPRO",ZTSAVE("PRCAIO(0)")=PRCAIO(0),ZTSAVE("D0")=PRCABN,ZTSAVE("PRCABN")=PRCABN,ZTSAVE("PRCAIO")=PRCAIO,ZTDESC="Profile of Accounts Receivable" D ^%ZTLOAD,CLOSE G EN
"RTN","PRCAPRO",14,0)
 U IO D PROC,CLOSE G EN
"RTN","PRCAPRO",15,0)
CLOSE D ^%ZISC D END Q
"RTN","PRCAPRO",16,0)
PROC ;===============SUBROUTINE==========================================
"RTN","PRCAPRO",17,0)
 S PRCAGL=^PRCA(430,D0,0) Q:+$P(PRCAGL,U,2)'>0  S PRCAT=$P(^PRCA(430.2,$P(PRCAGL,U,2),0),U,6) S:$P(PRCAGL,U,2)=$O(^PRCA(430.2,"AC",33,0)) PRBN=D0
"RTN","PRCAPRO",18,0)
 W:IO=IO(0) @IOF
"RTN","PRCAPRO",19,0)
 K DXS,^UTILITY($J,"W") D @$S(PRCAT="C":"^PRCATP2",PRCAT="P":"^PRCATP1","OV"[PRCAT:"^PRCATP3",PRCAT="T":"^PRCATP5",1:"^PRCATP4")
"RTN","PRCAPRO",20,0)
 I +$G(PRBN),'$D(PRCA("HALT")) D DISP^PRCARFD(PRBN)
"RTN","PRCAPRO",21,0)
 W !! K PRBN,PRCAIO,ZTSAVE,ZTDTH,ZTRTN,%ZIS,IOP,DIW,DIWL,DIWR Q
"RTN","PRCAPRO",22,0)
END K PRCAIO,PRCABN,PRCAGL,PRCAT Q
"RTN","PRCAPRO",23,0)
TRANSPR ;TRANSACTION PROFILE
"RTN","PRCAPRO",24,0)
EN1 N DPTNOFZY,DPTNOFZK S (DPTNOFZY,DPTNOFZK)=1
"RTN","PRCAPRO",25,0)
 K PRCAIO W ! S DIC="^PRCA(433,",DIC(0)="AEQM",DIC("A")="ENTER AR TRANSACTION NO. OR BILL NO.: " D ^DIC G:Y<0 EXIT S PRCADA=+Y
"RTN","PRCAPRO",26,0)
 S PRCA("MESS")="Do you want to queue this output " D QUE^PRCAQUE G:'$D(PRCAQUE) EXIT S IOP=PRCA("DEV"),IOM=80,PRCAIO=IO,PRCAIO(0)=IO(0)
"RTN","PRCAPRO",27,0)
 I IO=IO(0) D TR,CLOSE G EN1
"RTN","PRCAPRO",28,0)
 I PRCA("DEV")["Q" S ZTRTN="TR^PRCAPRO",ZTSAVE("PRCATYP")="",ZTSAVE("PRCADA")=PRCADA,ZTSAVE("PRCAIO(0)")=PRCAIO(0),ZTSAVE("PRCAIO")=PRCAIO,ZTDESC="Transaction Profile"
"RTN","PRCAPRO",29,0)
 I  D ^%ZTLOAD,CLOSE W:(IOM-$X)<20 ! W "   <REQUEST QUEUED>",*7,! D KILLV G EN1
"RTN","PRCAPRO",30,0)
 U IO D TR,CLOSE K %ZIS,IOP,PRCAIO G EN1
"RTN","PRCAPRO",31,0)
TR W:$D(IOF)&($E(IOST,1,2)="C-") @IOF S Z="TRANSACTION PROFILE",Z1=(IOM/2)-($L(Z)/2) W !,?Z1,Z,! F I=1:1:78 W "="
"RTN","PRCAPRO",32,0)
 K Z,Z1 W ! S D0=PRCADA K DXS D ^PRCATR3 K DXS S X=PRCADA D ENF^IBOLK
"RTN","PRCAPRO",33,0)
 S PRCABN=$P($$EN^PRCAFN1(PRCADA),"^",2)
"RTN","PRCAPRO",34,0)
 W !,"FUND: ",$P($G(^PRCA(430,PRCABN,11)),U,17),?40,"RSC: ",$P($G(^PRCA(430,PRCABN,11)),U,23)
"RTN","PRCAPRO",35,0)
 S CAT=+$$CAT^PRCAFN1(+PRCABN)
"RTN","PRCAPRO",36,0)
 I CAT=24 D STMT^IBRFN1(PRCADA) D:$D(^TMP("IBRFN1",$J))
"RTN","PRCAPRO",37,0)
 .S Z=0 F  S Z=$O(^TMP("IBRFN1",$J,Z)) Q:'Z  S X=^(Z) D
"RTN","PRCAPRO",38,0)
 ..I $P($G(^PRCA(430,+PRCABN,0)),"^",16)=4 W !,"Visit date: ",$$FMTE^XLFDT($P(X,"^",2)) Q
"RTN","PRCAPRO",39,0)
 ..W !,"Admission date: ",$$FMTE^XLFDT($P(X,"^",2)),?30,"Discharge date: ",$$FMTE^XLFDT($P(X,"^",5))
"RTN","PRCAPRO",40,0)
 D KILLV Q
"RTN","PRCAPRO",41,0)
KILLV K DIR,DIRUT,DIROUT,DUOUT,DTOUT,PRCABN,PRCATYP,DIC,%ZIS,IOP,DA,DD,E,ZTDTH,ZTRTN,ZTSAVE,PRCA,PRCADA,PRCAQUE,DXS,^TMP("IBRFN1") Q
"RTN","PRCAPRO",42,0)
EXIT D KILLV Q
"RTN","PRCAREP")
0^49^B13936976
"RTN","PRCAREP",1,0)
PRCAREP ;SF-ISC/YJK-CREATE REPAYMENT DATE SCHEDULE ;10/15/93  9:47 AM
"RTN","PRCAREP",2,0)
V ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","PRCAREP",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCAREP",4,0)
 ;This sets up repayment schedule for A/R.
"RTN","PRCAREP",5,0)
BEGIN K DIC
"RTN","PRCAREP",6,0)
EN W !! D BILL^PRCAUTL G:('$D(PRCABN)) END I +PRCA("STATUS")>0,$P(^PRCA(430.3,PRCA("STATUS"),0),U,3)'=102 W !,*7,"NOT AN ACTIVE ACCOUNT !" G EN
"RTN","PRCAREP",7,0)
 I $D(^PRCA(430,"TCSP",PRCABN)) W !,"BILL HAS BEEN REFERRED TO CROSS-SERVICING.",!,"A REPAYMENT PLAN FOR THIS BILL MUST BE ESTABLISHED WITH TREASURY." Q  ;prca*4.5*301
"RTN","PRCAREP",8,0)
 I $D(^PRCA(430,PRCABN,5)) W *7,!,"THIS ACCOUNT ALREADY HAS A REPAYMENT PLAN !",!
"RTN","PRCAREP",9,0)
 S PRCAPB=$S($D(^PRCA(430,PRCABN,7)):$P(^(7),U,1)+$P(^(7),U,2)+$P(^(7),U,3)+$P(^(7),U,4)+$P(^(7),U,5),1:$P(^(0),U,3)),PRCAMT=0
"RTN","PRCAREP",10,0)
 S PRCADT="" D DIE G:PRCA("LOCK")=1 EN I (+PRCADT>0)&(+PRCAMT>0) D SET G EN
"RTN","PRCAREP",11,0)
 I '$D(^PRCA(430,PRCABN,4)) W !,"NO REPAYMENT PLAN!",*7 K ^PRCA(430,PRCABN,5) G EN
"RTN","PRCAREP",12,0)
 I $P(^PRCA(430,PRCABN,4),U,1)="" W *7,!,"NO REPAYMENT PLAN !" K ^PRCA(430,PRCABN,5) G EN
"RTN","PRCAREP",13,0)
 W !,"NOTHING CHANGED !",! G EN
"RTN","PRCAREP",14,0)
 ;
"RTN","PRCAREP",15,0)
DIE S DIC="^PRCA(430,",DIE=DIC,DA=PRCABN,DR="41;S PRCADT=X;42;S PRCADAY=X;43;S PRCAMT=X" S PRCA("LOCK")=0 D LOCKF^PRCAWO1 D:PRCA("LOCK")=0 ^DIE
"RTN","PRCAREP",16,0)
 K DIE,DR L -^PRCA(430,+$G(PRCABN)) Q  ;end of DIE
"RTN","PRCAREP",17,0)
SET S PRCANPAY=PRCAPB/PRCAMT,PRCANPAY=$S(PRCANPAY>(PRCAPB\PRCAMT):PRCAPB\PRCAMT+1,1:PRCAPB\PRCAMT)
"RTN","PRCAREP",18,0)
 W !!,"NUMBER OF PAYMENTS WILL BE ",PRCANPAY,! I PRCANPAY>60 W !,*7,"THIS NUMBER SHOULD BE LESS THAN 60 !, CHECK THE INPUT AGAIN",! Q
"RTN","PRCAREP",19,0)
 S %DT="AEFX",%DT("A")="DUE DATE OF 1ST PAYMENT: " D ^%DT K %DT
"RTN","PRCAREP",20,0)
 I Y<0 W !,*7,"NOTHING CHANGED !" Q
"RTN","PRCAREP",21,0)
 K ^PRCA(430,PRCABN,5) S PRCAYR=$E(Y,1,3),PRCAMON=$E(Y,4,5) S:$L(PRCADAY)=1 PRCADAY="0"_PRCADAY D HOLD^PRCAUT1
"RTN","PRCAREP",22,0)
 F Z0=1:1:PRCANPAY S Z1=PRCAYR_$S((PRCAMON<10&($E(PRCAMON,1)'=0)):0_PRCAMON,1:PRCAMON)_PRCADAY,^PRCA(430,DA,5,Z0,0)=Z1_U_"0",PRCAMON=PRCAMON+1 S:PRCAMON=13 PRCAMON=1,PRCAYR=PRCAYR+1
"RTN","PRCAREP",23,0)
 S ^PRCA(430,DA,5,0)="^430.051DA^"_PRCANPAY_"^"_PRCANPAY,$P(^PRCA(430,DA,4),U,4)=PRCANPAY
"RTN","PRCAREP",24,0)
 S PRCAKTY=$O(^PRCA(430.3,"AC",16,"")) D TRAN,IXDIK S $P(^PRCA(433,PRCAEN,0),U,4)=2
"RTN","PRCAREP",25,0)
 W !!,"THE REPAYMENT PLAN HAS BEEN ESTABLISHED.",!
"RTN","PRCAREP",26,0)
EXIT K PRCAKTY,PRCAMON,PRCAYR,PRCANPAY,DA1,DIK,DA Q  ;end of SET
"RTN","PRCAREP",27,0)
IXDIK S DIK="^PRCA(430,"_PRCABN_",5,",DA(1)=PRCABN D IXALL^DIK K DIK Q
"RTN","PRCAREP",28,0)
TRAN S PRCAEN=-1 D SETTR^PRCAUTL Q:PRCAEN<0  S DA=PRCAEN
"RTN","PRCAREP",29,0)
 S DIE="^PRCA(433,",DR=".03////"_PRCABN_";11///"_PRCADT_";12///"_PRCAKTY_";15///"_PRCAPB_"" D ^DIE
"RTN","PRCAREP",30,0)
 K DIE,DR,PRCADT Q
"RTN","PRCAREP",31,0)
END K PRCAS,PRCAMT,PRCA,PRCAKTY,PRCADT,DA,DIE,PRCAYR,PRCAMON,PRCANPAY,DR,PRCAEN,PRCABN,PRCAPB,Z0,PRCADAY,DIC,PRCAS,PRCATY D KVAR^VADPT Q  ;end of PRCAREP
"RTN","PRCAREP",32,0)
PROFILE ;print the repayment plan profile.
"RTN","PRCAREP",33,0)
 K %ZIS,DXS,IOP
"RTN","PRCAREP",34,0)
 D BILL^PRCAUTL G:'$D(PRCABN) END
"RTN","PRCAREP",35,0)
 S %ZIS="Q" D ^%ZIS Q:POP  S IOM=80,PRCAIO=IO,PRCAIO(0)=IO(0)
"RTN","PRCAREP",36,0)
 I IO=IO(0) W:$D(IOF) @IOF D TR,CLOSE K PRCAIO,PRCATY G PROFILE
"RTN","PRCAREP",37,0)
 I $D(IO("Q")) K IO("Q") S ZTRTN="TR^PRCAREP",ZTSAVE("PRCABN")=PRCABN,ZTSAVE("PRCAIO(0)")=PRCAIO(0),ZTSAVE("PRCAIO")=PRCAIO,ZTDESC="Repayment Plan Profile"
"RTN","PRCAREP",38,0)
 I  D ^%ZTLOAD,CLOSE W:(IOM-$X)<20 ! W "   <REQUEST QUEUED>",*7,! K PRCA,PRCATY G PROFILE
"RTN","PRCAREP",39,0)
 U IO D TR,CLOSE G PROFILE
"RTN","PRCAREP",40,0)
TR S D0=PRCABN K DXS D ^PRCATR1 K DXS W !! K PRCABN,PRCAKTY,PRCA Q
"RTN","PRCAREP",41,0)
CLOSE D ^%ZISC K IOP,%ZIS,PRCAIO Q
"RTN","PRCASER1")
0^54^B16741481
"RTN","PRCASER1",1,0)
PRCASER1 ;WASH-ISC@ALTOONA,PA/RGY-Accept transaction from billing engine ;9/8/93  2:21 PM
"RTN","PRCASER1",2,0)
V ;;4.5;Accounts Receivable;**48,104,165,233,301**;Mar 20, 1995;Build 144
"RTN","PRCASER1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","PRCASER1",4,0)
 NEW AMT,AMT1,PRCAERR,PRCABN,PRCADJ,X1,XMDUZ,XMSUB,XMTEXT,XMY,DEBT
"RTN","PRCASER1",5,0)
 I '$D(X) S PRCAERR="-1^PRCA020" G Q
"RTN","PRCASER1",6,0)
 I $O(^PRCA(430.3,"AC",+X,0))'?1N.N,$P($G(^PRCA(430.3,+X,0)),"^",3)'=21 S PRCAERR="-1^PRCA021" G Q
"RTN","PRCASER1",7,0)
 I +X'=21,$P($G(^PRCA(430.3,+X,0)),"^",3)'=21 S PRCAERR="-1^PRCA022" G Q
"RTN","PRCASER1",8,0)
 I $P(X,"^",2)'?.N.1".".2N S PRCAERR="-1^PRCA023" G Q
"RTN","PRCASER1",9,0)
 I $P(X,"^",2)'>0 S PRCAERR="-1^PRCA017" G Q
"RTN","PRCASER1",10,0)
 I $P(X,"^",3)="" S PRCAERR="-1^PRCA006" G Q
"RTN","PRCASER1",11,0)
 S PRCABN=$O(^PRCA(430,"B",$P(X,"^",3),0)) I $G(^PRCA(430,+PRCABN,0))="" S PRCAERR="-1^PRCA007" G Q
"RTN","PRCASER1",12,0)
 I '$D(^VA(200,+$P(X,"^",4),0)) S PRCAERR="-1^PRCA013" G Q
"RTN","PRCASER1",13,0)
 I $P(X,"^",5)'?7N S PRCAERR="-1^PRCA024" G Q
"RTN","PRCASER1",14,0)
 S (AMT1,AMT)=$P(X,"^",2)
"RTN","PRCASER1",15,0)
 D DEC(PRCABN,.AMT,$P(X,"^",4),$P(X,U,6),$P(X,U,5))
"RTN","PRCASER1",16,0)
 S XMDUZ="AR Package",XMTEXT="X1(",DEBT=$P($G(^PRCA(430,PRCABN,0)),"^",9),DEBT=$E($$NAM^RCFN01(DEBT),1)_" ("_$E($$SSN^RCFN01(DEBT),6,9)_")"
"RTN","PRCASER1",17,0)
 I AMT'=AMT1 S X1(1)="A decrease adjustment for bill/Pt name (SSN) #"_$P(X,"^",3)_"/"_DEBT_" has been",XMSUB="Automatic Adj: "_$P(X,"^",3)
"RTN","PRCASER1",18,0)
 I AMT=AMT1 S X1(1)="**** NOTICE: A decrease adjustment for bill/Pt name (SSN) #"_$P(X,U,3)_"/"_DEBT,XMSUB="Manual Adj: "_$P(X,U,3),X1(3)=" "
"RTN","PRCASER1",19,0)
 S Y=DT X ^DD("DD") S X1(2)=$S(AMT'=AMT1:"automatically",1:"needs to be manually")_" applied in the amount of $"_$J($S(AMT1=AMT:AMT1,1:AMT1-AMT),0,2)_" on "_Y_"."
"RTN","PRCASER1",20,0)
 I AMT,AMT'=AMT1 S X1(3)="Please review bill for proper application of the unapplied amount of $"_$J(AMT,0,2)_"."
"RTN","PRCASER1",21,0)
 S X1(4)=" ",X1(5)="Data sent from Service"
"RTN","PRCASER1",22,0)
 S X1(6)="        Amount: $"_$J(AMT1,0,2)
"RTN","PRCASER1",23,0)
 S Y=$P(X,U,5) X ^DD("DD") S X1(7)="          Date: "_Y
"RTN","PRCASER1",24,0)
 S X1(8)="        Reason: "_$S($P(X,"^",6)]"":$P(X,"^",6),1:"N/A")
"RTN","PRCASER1",25,0)
 S X1(9)=" Adjustment by: "_$P($G(^VA(200,+$P(X,"^",4),0)),"^")
"RTN","PRCASER1",26,0)
 S AMT=0 F X=1:1:5 S AMT=AMT+$P($G(^PRCA(430,PRCABN,7)),U,X)
"RTN","PRCASER1",27,0)
 S AMT1=AMT-+$G(^PRCA(430,PRCABN,7))
"RTN","PRCASER1",28,0)
 S X=$P(^PRCA(430.3,+$P($G(^PRCA(430,PRCABN,0)),U,8),0),U,1)
"RTN","PRCASER1",29,0)
 S X1(10)=" ",X1(12)=" ",X1(13)="Bill status is "_$S(XMSUB["Auto":"now ",1:"")_X_" with a balance of $"_$J(AMT,0,2)_".",X1(14)=" "
"RTN","PRCASER1",30,0)
 I AMT1>0 S X1(15)=" *WARNING*  There is outstanding administrative charges of $"_$J(AMT1,0,2)_".",X1(16)="            An adjustment of administrative charges MAY need to be done."
"RTN","PRCASER1",31,0)
 S XMY("G.PRCA ADJUSTMENT TRANS")=""
"RTN","PRCASER1",32,0)
 D ^XMD
"RTN","PRCASER1",33,0)
Q S Y=$S($D(PRCAERR):PRCAERR,1:0) Q
"RTN","PRCASER1",34,0)
TEST ;21^AMT^BILL#^DUZ^DATE^REASON
"RTN","PRCASER1",35,0)
 S U="^",X="21^15^500-K40000I^101091^3150129^BILLED AT HIGHER TIER RATE" D ^PRCASER1 W !,Y,!
"RTN","PRCASER1",36,0)
 Q
"RTN","PRCASER1",37,0)
DEC(PRCABN,AMT,APR,REA,BDT,PRCAEN) ;Auto decrease from service Bill#,Tran amt,person,reason,Tran date
"RTN","PRCASER1",38,0)
 NEW BAL,DA,DIC,DIE,DR,ERR,PRCA,PRCAA2,PRCAMT,PRCASV,X,Y,PRCADUP
"RTN","PRCASER1",39,0)
 S PRCADUP=0
"RTN","PRCASER1",40,0)
 S PRCAEN="",BAL=+$G(^PRCA(430,PRCABN,7)) I 'BAL Q
"RTN","PRCASER1",41,0)
 I $P(^PRCA(430,PRCABN,0),U,8)'=$O(^PRCA(430.3,"AC",102,"")),$P(^PRCA(430,PRCABN,0),U,8)'=$O(^PRCA(430.3,"AC",112,"")) Q
"RTN","PRCASER1",42,0)
 I $P(^PRCA(430,PRCABN,0),U,2)=$O(^PRCA(430.2,"AC",33,0)) Q
"RTN","PRCASER1",43,0)
 S BAL=$S(AMT>BAL:BAL,1:AMT)
"RTN","PRCASER1",44,0)
 S PRCA("ADJ")=$O(^PRCA(430.3,"AC",21,0)),PRCASV("FY")=$$FY^RCFN01(DT)_U_BAL,PRCASV("APR")=APR,PRCASV("BDT")=$S($G(BDT)>0:BDT,1:DT)
"RTN","PRCASER1",45,0)
 D SETTR^PRCAUTL,PATTR^PRCAUTL S DIE="^PRCA(433,",DR="[PRCA FY ADJ2 BATCH]",DA=PRCAEN D ^DIE
"RTN","PRCASER1",46,0)
 S PRCAA2=$P(^PRCA(433,PRCAEN,4,0),U,3) D UPFY^PRCADJ,TRANUP^PRCAUTL
"RTN","PRCASER1",47,0)
 I ("^30^31^")[("^"_$P($G(^PRCA(430,PRCABN,0)),"^",2)_"^") D EN^PRCAFBDM(PRCABN,BAL,PRCA("ADJ"),$G(PRCADJ("BDT")),PRCAEN,.ERR)
"RTN","PRCASER1",48,0)
 D UPPRIN^PRCADJ
"RTN","PRCASER1",49,0)
 I "AutoAUTO"'[$E(REA,1,4) S REA="Auto Dec.: "_REA
"RTN","PRCASER1",50,0)
 S DA=PRCAEN,DIE="^PRCA(433,",DR="41///"_REA D ^DIE
"RTN","PRCASER1",51,0)
 S AMT=AMT-+$P($G(^PRCA(433,PRCAEN,1)),U,5)
"RTN","PRCASER1",52,0)
 I PRCAEN,$D(^PRCA(430,"TCSP",PRCABN)) D DECADJ^RCTCSPU(PRCABN,PRCAEN) ;prca*4.5*301 add cs decrease adjustment 5B
"RTN","PRCASER1",53,0)
 Q
"RTN","RC45301P")
0^43^B1337108
"RTN","RC45301P",1,0)
RC45301P ;ALB/BDB - CROSS-SERVICING PROJECT POST-INSTALL;3/31/15
"RTN","RC45301P",2,0)
 ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RC45301P",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RC45301P",4,0)
 ; 1) This routine sets the Cross-Servicing Start Date into the
"RTN","RC45301P",5,0)
 ;       AR SITE PARAMETER file (#342)
"RTN","RC45301P",6,0)
 ; 2) Runs the Due Process Notification initialization process
"RTN","RC45301P",7,0)
 ;
"RTN","RC45301P",8,0)
ENTER ; Entry point for post-install
"RTN","RC45301P",9,0)
 D CS
"RTN","RC45301P",10,0)
 D DPNINIT
"RTN","RC45301P",11,0)
 Q
"RTN","RC45301P",12,0)
 ;
"RTN","RC45301P",13,0)
CS ; Set the Cross-Servicing Start Date equal to DT
"RTN","RC45301P",14,0)
 D BMES^XPDUTL(">>>Cross-Servicing Start Date set to "_DT_".")
"RTN","RC45301P",15,0)
 S ^RC(342,1,"CS")=DT
"RTN","RC45301P",16,0)
 Q
"RTN","RC45301P",17,0)
 ;
"RTN","RC45301P",18,0)
DPNINIT ;
"RTN","RC45301P",19,0)
 D BMES^XPDUTL(">>>Begin the Due Process Initialization.")
"RTN","RC45301P",20,0)
 D BMES^XPDUTL(">>>The Initialization may take up to 8 hours.")
"RTN","RC45301P",21,0)
 D ENTER^RCTCSP3
"RTN","RC45301P",22,0)
 D BMES^XPDUTL(">>>Due Process Initialization is complete.")
"RTN","RC45301P",23,0)
 K DPNINIT
"RTN","RC45301P",24,0)
 Q
"RTN","RC45301P",25,0)
 ;
"RTN","RCBEADJ")
0^10^B77125147
"RTN","RCBEADJ",1,0)
RCBEADJ ;WISC/RFJ-adjustment ;Jun 06, 2014@19:11:19
"RTN","RCBEADJ",2,0)
 ;;4.5;Accounts Receivable;**169,172,204,173,208,233,298,301**;Mar 20, 1995;Build 144
"RTN","RCBEADJ",3,0)
 ;Per VA Directive 6402, this routine should not be modified.
"RTN","RCBEADJ",4,0)
 Q
"RTN","RCBEADJ",5,0)
 ;
"RTN","RCBEADJ",6,0)
 ;
"RTN","RCBEADJ",7,0)
DECREASE ;  menu option: create a decrease adjustment
"RTN","RCBEADJ",8,0)
 D ADJUST("DECREASE")
"RTN","RCBEADJ",9,0)
 Q
"RTN","RCBEADJ",10,0)
 ;
"RTN","RCBEADJ",11,0)
 ;
"RTN","RCBEADJ",12,0)
INCREASE ;  menu option: create an increase adjustment
"RTN","RCBEADJ",13,0)
 D ADJUST("INCREASE")
"RTN","RCBEADJ",14,0)
 Q
"RTN","RCBEADJ",15,0)
 ;
"RTN","RCBEADJ",16,0)
ADJUST(RCBETYPE,RCEDI) ;  create an adjustment
"RTN","RCBEADJ",17,0)
 ;  rcbetype = INCREASE for increase or DECREASE for decrease
"RTN","RCBEADJ",18,0)
 ;  rcedi = the ien of the bill selected via the EDI Worklist;ien of 
"RTN","RCBEADJ",19,0)
 ;    XX      the ERA entry or null/undefined if bill should be selected
"RTN","RCBEADJ",20,0)
 N RCBILLDA
"RTN","RCBEADJ",21,0)
 F  D  Q:RCBILLDA<0!$G(RCEDI)
"RTN","RCBEADJ",22,0)
 .   K RCTRANDA,RCLIST
"RTN","RCBEADJ",23,0)
 .   ;
"RTN","RCBEADJ",24,0)
 .   ;  select a bill
"RTN","RCBEADJ",25,0)
 .   S RCBILLDA=$S('$G(RCEDI):$$GETABILL^RCBEUBIL,1:+RCEDI)
"RTN","RCBEADJ",26,0)
 .   I RCBILLDA<1 Q
"RTN","RCBEADJ",27,0)
 .   I $D(^PRCA(430,"TCSP",RCBILLDA)),(RCBETYPE="INCREASE") W !,"BILL HAS BEEN REFERRED TO CROSS-SERVICING.",!,"NO MANUAL INCREASE ADJUSTMENTS ARE ALLOWED." Q  ;prca*4.5*301
"RTN","RCBEADJ",28,0)
 .   I $D(^PRCA(430,"TCSP",RCBILLDA)),(RCBETYPE="DECREASE") S %=2 W !!,"IS THIS ACTION BEING PERFORMED DUE TO THE CLAIMS MATCHING PROCESS? " D YN^DICN Q:(%<0)!(%=2)  ;prca*4.5*301
"RTN","RCBEADJ",29,0)
 .   ;
"RTN","RCBEADJ",30,0)
 .   ;  adjust the bill
"RTN","RCBEADJ",31,0)
 .   D ADJBILL(RCBETYPE,RCBILLDA,$P($G(RCEDI),";",2))
"RTN","RCBEADJ",32,0)
 Q
"RTN","RCBEADJ",33,0)
 ;
"RTN","RCBEADJ",34,0)
ADJBILL(RCBETYPE,RCBILLDA,RCEDIWL) ;  adjust a bill
"RTN","RCBEADJ",35,0)
 ; RCEDIWL = ien of ERA entry if called from worklist
"RTN","RCBEADJ",36,0)
 N RCAMOUNT,RCBALANC,RCDATA7,RCLIST,RCONTADJ,RCTRANDA,TOTALCAL,TOTALSTO,I,X,Y
"RTN","RCBEADJ",37,0)
 ;  lock the bill
"RTN","RCBEADJ",38,0)
 L +^PRCA(430,RCBILLDA):5 E  W !,"ANOTHER USER IS CURRENTLY WORKING WITH THIS BILL." Q
"RTN","RCBEADJ",39,0)
 ;
"RTN","RCBEADJ",40,0)
 ;  show data for the bill
"RTN","RCBEADJ",41,0)
 D SHOWBILL^RCWROFF1(RCBILLDA)
"RTN","RCBEADJ",42,0)
 ;
"RTN","RCBEADJ",43,0)
 ;  check the balance of the bill
"RTN","RCBEADJ",44,0)
 W !!,"Checking the bill's balance ..."
"RTN","RCBEADJ",45,0)
 S RCBALANC=$$OUTOFBAL^RCBDBBAL(RCBILLDA)
"RTN","RCBEADJ",46,0)
 I RCBALANC="" W " IN Balance!"
"RTN","RCBEADJ",47,0)
 ;
"RTN","RCBEADJ",48,0)
 ;  out of balance, ask to fix it
"RTN","RCBEADJ",49,0)
 I RCBALANC'="" D  I RCBILLDA<1 D UNLOCK Q
"RTN","RCBEADJ",50,0)
 .   S TOTALCAL=$P(RCBALANC,"^")+$P(RCBALANC,"^",2)+$P(RCBALANC,"^",3)+$P(RCBALANC,"^",4)+$P(RCBALANC,"^",5)
"RTN","RCBEADJ",51,0)
 .   S RCDATA7=$G(^PRCA(430,RCBILLDA,7))
"RTN","RCBEADJ",52,0)
 .   S TOTALSTO=$P(RCDATA7,"^")+$P(RCDATA7,"^",2)+$P(RCDATA7,"^",3)+$P(RCDATA7,"^",4)+$P(RCDATA7,"^",5)
"RTN","RCBEADJ",53,0)
 .   W " OUT of Balance!"
"RTN","RCBEADJ",54,0)
 .   W !!,"                  BALANCE:",$J("Calculated",12),$J("Stored",12)
"RTN","RCBEADJ",55,0)
 .   W !,"                  ------- ",$J("------------",12),$J("------------",12)
"RTN","RCBEADJ",56,0)
 .   W !,"        Principal Balance:",$J($P(RCBALANC,"^",1),12,2),$J($P(RCDATA7,"^",1),12,2)
"RTN","RCBEADJ",57,0)
 .   I +$P(RCBALANC,"^",1)'=+$P(RCDATA7,"^",1) W "  <<-- OUT OF BALANCE"
"RTN","RCBEADJ",58,0)
 .   W !,"         Interest Balance:",$J($P(RCBALANC,"^",2),12,2),$J($P(RCDATA7,"^",2),12,2)
"RTN","RCBEADJ",59,0)
 .   I +$P(RCBALANC,"^",2)'=+$P(RCDATA7,"^",2) W "  <<-- OUT OF BALANCE"
"RTN","RCBEADJ",60,0)
 .   W !,"            Admin Balance:",$J($P(RCBALANC,"^",3),12,2),$J($P(RCDATA7,"^",3),12,2)
"RTN","RCBEADJ",61,0)
 .   I +$P(RCBALANC,"^",3)'=+$P(RCDATA7,"^",3) W "  <<-- OUT OF BALANCE"
"RTN","RCBEADJ",62,0)
 .   W !,"               MF Balance:",$J($P(RCBALANC,"^",4),12,2),$J($P(RCDATA7,"^",4),12,2)
"RTN","RCBEADJ",63,0)
 .   I +$P(RCBALANC,"^",4)'=+$P(RCDATA7,"^",4) W "  <<-- OUT OF BALANCE"
"RTN","RCBEADJ",64,0)
 .   W !,"               CC Balance:",$J($P(RCBALANC,"^",5),12,2),$J($P(RCDATA7,"^",5),12,2)
"RTN","RCBEADJ",65,0)
 .   I +$P(RCBALANC,"^",5)'=+$P(RCDATA7,"^",5) W "  <<-- OUT OF BALANCE"
"RTN","RCBEADJ",66,0)
 .   W !,"                  ------- ",$J("-------------",12),$J("-------------",12)
"RTN","RCBEADJ",67,0)
 .   W !,"                    TOTAL:",$J(TOTALCAL,12,2),$J(TOTALSTO,12,2)
"RTN","RCBEADJ",68,0)
 .   I +TOTALCAL'=+TOTALSTO W "  <<-- OUT OF BALANCE"
"RTN","RCBEADJ",69,0)
 .   ;
"RTN","RCBEADJ",70,0)
 .   ;  ask to fix the balances
"RTN","RCBEADJ",71,0)
 .   S Y=$$ASKFIX I Y'=1 W !,"  NOTE: You must fix the Balance Discrepancy before processing an adjustment!" S RCBILLDA=0 Q
"RTN","RCBEADJ",72,0)
 .   ;
"RTN","RCBEADJ",73,0)
 .   ;  fix it
"RTN","RCBEADJ",74,0)
 .   S $P(RCDATA7,"^",1)=+$P(RCBALANC,"^",1) ; principal
"RTN","RCBEADJ",75,0)
 .   S $P(RCDATA7,"^",2)=+$P(RCBALANC,"^",2) ; interest
"RTN","RCBEADJ",76,0)
 .   S $P(RCDATA7,"^",3)=+$P(RCBALANC,"^",3) ; admin
"RTN","RCBEADJ",77,0)
 .   S $P(RCDATA7,"^",4)=+$P(RCBALANC,"^",4) ; marshal fee
"RTN","RCBEADJ",78,0)
 .   S $P(RCDATA7,"^",5)=+$P(RCBALANC,"^",5) ; court cost
"RTN","RCBEADJ",79,0)
 .   S $P(^PRCA(430,RCBILLDA,7),"^",1,5)=$P(RCDATA7,"^",1,5)
"RTN","RCBEADJ",80,0)
 .   ;
"RTN","RCBEADJ",81,0)
 .   W !,"  Balance Discrepancy FIXED!"
"RTN","RCBEADJ",82,0)
 ;
"RTN","RCBEADJ",83,0)
 ;  if the principal balance is zero, do not allow it to be adjusted
"RTN","RCBEADJ",84,0)
 ;  ask to close/cancel it
"RTN","RCBEADJ",85,0)
 I RCBETYPE="DECREASE",'$G(^PRCA(430,RCBILLDA,7)) W !!,"Note: This bill has NO PRINCIPAL BALANCE to decrease !" D INTADMIN(RCBILLDA),UNLOCK Q
"RTN","RCBEADJ",86,0)
 ;
"RTN","RCBEADJ",87,0)
 ; If entry is from EDI Lockbox worklist, display total adjustments in ERA
"RTN","RCBEADJ",88,0)
 N AP D
"RTN","RCBEADJ",89,0)
 .N BILL,EOB,ERA,SEQ S ERA="",AP=0
"RTN","RCBEADJ",90,0)
 .F  S ERA=$O(^RCY(344.4,"AP",1,ERA)) Q:'ERA  D  Q:AP
"RTN","RCBEADJ",91,0)
 ..S SEQ=0
"RTN","RCBEADJ",92,0)
 ..F  S SEQ=$O(^RCY(344.4,"AP",1,ERA,SEQ)) Q:'SEQ  D  Q:AP
"RTN","RCBEADJ",93,0)
 ...S EOB=$P($G(^RCY(344.4,ERA,1,SEQ,0)),U,2) Q:'EOB
"RTN","RCBEADJ",94,0)
 ...S:$P($G(^IBM(361.1,EOB,0)),U)=RCBILLDA AP=1 ;IA #4051
"RTN","RCBEADJ",95,0)
 ;
"RTN","RCBEADJ",96,0)
 ;  Ask to enter transaction even though it is marked for autopost PRCA*4.5*298
"RTN","RCBEADJ",97,0)
 I RCBETYPE="DECREASE",AP S Y=$$ASKAUPO() I Y'=1 W !,"Exiting bill adjustment." D UNLOCK Q
"RTN","RCBEADJ",98,0)
 ;
"RTN","RCBEADJ",99,0)
 ;  ask to enter adjustment amount
"RTN","RCBEADJ",100,0)
 S RCAMOUNT=$$AMOUNT(RCBILLDA,RCBETYPE)
"RTN","RCBEADJ",101,0)
 I RCAMOUNT<0 D UNLOCK Q
"RTN","RCBEADJ",102,0)
 ;
"RTN","RCBEADJ",103,0)
 ;  if decrease, make negative
"RTN","RCBEADJ",104,0)
 I RCBETYPE="DECREASE" S RCAMOUNT=-RCAMOUNT
"RTN","RCBEADJ",105,0)
 ;
"RTN","RCBEADJ",106,0)
 ;  ask if it is a contract adjustment
"RTN","RCBEADJ",107,0)
 I RCBETYPE="DECREASE","^9^28^29^30^32^"[("^"_$P($G(^PRCA(430,RCBILLDA,0)),"^",2)_"^") S RCONTADJ=$$ASKCONT I RCONTADJ<0 D UNLOCK Q
"RTN","RCBEADJ",108,0)
 ;
"RTN","RCBEADJ",109,0)
 ;  show what the new transaction will look like
"RTN","RCBEADJ",110,0)
 S RCDATA7=$G(^PRCA(430,RCBILLDA,7))
"RTN","RCBEADJ",111,0)
 W !!,"If you process the transaction, the bill will look like:"
"RTN","RCBEADJ",112,0)
 W !,"Current Principal Balance: ",$J($P(RCDATA7,"^"),11,2)
"RTN","RCBEADJ",113,0)
 W !,"  NEW ",RCBETYPE," Adjustment: ",$J(RCAMOUNT,11,2)
"RTN","RCBEADJ",114,0)
 W !,"                           -----------"
"RTN","RCBEADJ",115,0)
 W !,"    NEW Principal Balance: ",$J($P(RCDATA7,"^")+RCAMOUNT,11,2)
"RTN","RCBEADJ",116,0)
 ;
"RTN","RCBEADJ",117,0)
 ;  ask to enter transaction
"RTN","RCBEADJ",118,0)
 S Y=$$ASKOK(RCBETYPE) I Y'=1 D UNLOCK Q
"RTN","RCBEADJ",119,0)
 ;
"RTN","RCBEADJ",120,0)
ADDADJ ;  add adjustment
"RTN","RCBEADJ",121,0)
 S RCTRANDA=$$INCDEC^RCBEUTR1(RCBILLDA,RCAMOUNT,"","","",$G(RCONTADJ))
"RTN","RCBEADJ",122,0)
 I 'RCTRANDA W !,"  *** W A R N I N G: Adjustment NOT Processed! ***" D UNLOCK Q
"RTN","RCBEADJ",123,0)
 I RCTRANDA W !,"  Adjustment Transaction: ",RCTRANDA," has been added."
"RTN","RCBEADJ",124,0)
 I RCTRANDA,'$G(RCEDIWL),(RCBETYPE="DECREASE"),$D(^PRCA(430,"TCSP",RCBILLDA)) D DECADJ^RCTCSPU(RCBILLDA,RCTRANDA) ;prca*4.5*301 add cs decrease adjustment
"RTN","RCBEADJ",125,0)
 I '$G(REFMS)&(DT>$$LDATE^RCRJR(DT)) S Y=$E($$FPS^RCAMFN01(DT,1),1,5)_"01" D DD^%DT W !!,"   * * * * Transmission will be held until "_Y_" * * * *"
"RTN","RCBEADJ",126,0)
 ;
"RTN","RCBEADJ",127,0)
 ;  ask to enter a comment
"RTN","RCBEADJ",128,0)
 W !!,"Enter a comment for the ",RCBETYPE," Adjustment:"
"RTN","RCBEADJ",129,0)
 S Y=$$EDIT433^RCBEUTRA(RCTRANDA,"41;")
"RTN","RCBEADJ",130,0)
 ;
"RTN","RCBEADJ",131,0)
 ;  ask to exempt interest and admin charges
"RTN","RCBEADJ",132,0)
 I RCBETYPE="DECREASE" D INTADMIN(RCBILLDA)
"RTN","RCBEADJ",133,0)
 ;
"RTN","RCBEADJ",134,0)
 ;  notification of subsequent payer bulletin
"RTN","RCBEADJ",135,0)
 S RCDATA7=$G(^PRCA(430,RCBILLDA,7)),X=0
"RTN","RCBEADJ",136,0)
 F I=1:1:5 S X=X+$P(RCDATA7,"^",I)
"RTN","RCBEADJ",137,0)
 I RCDATA7'="",'X D
"RTN","RCBEADJ",138,0)
 .   N PRCABN,PRCAEN,PRCAMT
"RTN","RCBEADJ",139,0)
 .   S PRCABN=RCBILLDA,PRCAEN=RCTRANDA,PRCAMT=+$P($G(^PRCA(433,RCTRANDA,1)),"^",5)
"RTN","RCBEADJ",140,0)
 .   D EOB^PRCADJ
"RTN","RCBEADJ",141,0)
 ;
"RTN","RCBEADJ",142,0)
 ;  unlock and ask the next bill to adjust
"RTN","RCBEADJ",143,0)
 D UNLOCK
"RTN","RCBEADJ",144,0)
 Q
"RTN","RCBEADJ",145,0)
 ;
"RTN","RCBEADJ",146,0)
 ;
"RTN","RCBEADJ",147,0)
UNLOCK ;  unlock bill and transaction
"RTN","RCBEADJ",148,0)
 L -^PRCA(430,RCBILLDA)
"RTN","RCBEADJ",149,0)
 I $G(RCTRANDA) L -^PRCA(433,RCTRANDA)
"RTN","RCBEADJ",150,0)
 Q
"RTN","RCBEADJ",151,0)
 ;
"RTN","RCBEADJ",152,0)
 ;
"RTN","RCBEADJ",153,0)
INTADMIN(RCBILLDA) ;  ask and adjust the interest and admin
"RTN","RCBEADJ",154,0)
 N RCAMOUNT,RCTRANDA,Y
"RTN","RCBEADJ",155,0)
 ;
"RTN","RCBEADJ",156,0)
 ;  check to see if there is interest and admin charges
"RTN","RCBEADJ",157,0)
 S RCAMOUNT=$G(^PRCA(430,RCBILLDA,7))
"RTN","RCBEADJ",158,0)
 I '$P(RCAMOUNT,"^",2),'$P(RCAMOUNT,"^",3),'$P(RCAMOUNT,"^",4),'$P(RCAMOUNT,"^",5) Q
"RTN","RCBEADJ",159,0)
 ;
"RTN","RCBEADJ",160,0)
 ;  only ask if there is no principal
"RTN","RCBEADJ",161,0)
 I RCAMOUNT Q
"RTN","RCBEADJ",162,0)
 ;
"RTN","RCBEADJ",163,0)
 W !!,"You have the option to automatically EXEMPT the interest"
"RTN","RCBEADJ",164,0)
 W !,"and administrative charges.  This will close the bill."
"RTN","RCBEADJ",165,0)
 S Y=$$ASKEXEMP I Y'=1 Q
"RTN","RCBEADJ",166,0)
 ;
"RTN","RCBEADJ",167,0)
 W !!,"Creating an EXEMPT transaction ..."
"RTN","RCBEADJ",168,0)
 S RCTRANDA=$$EXEMPT^RCBEUTR2(RCBILLDA,$P(RCAMOUNT,"^",2)_"^"_$P(RCAMOUNT,"^",3)_"^^"_$P(RCAMOUNT,"^",4)_"^"_$P(RCAMOUNT,"^",5))
"RTN","RCBEADJ",169,0)
 I 'RCTRANDA W !,"  *** W A R N I N G: EXEMPTION NOT Processed! ***" Q
"RTN","RCBEADJ",170,0)
 I RCTRANDA W !,"   Exempt Transaction: ",RCTRANDA," has been added."
"RTN","RCBEADJ",171,0)
INTC35B ;Check if CS5B entry needed for exempt transaction
"RTN","RCBEADJ",172,0)
 I RCTRANDA,'$G(RCEDIWL),(RCBETYPE="DECREASE"),$D(^PRCA(430,"TCSP",RCBILLDA)) D DECADJ^RCTCSPU(RCBILLDA,RCTRANDA) ;prca*4.5*301 add cs exempt
"RTN","RCBEADJ",173,0)
 I '$G(REFMS)&(DT>$$LDATE^RCRJR(DT)) S Y=$E($$FPS^RCAMFN01(DT,1),1,5)_"01" D DD^%DT W !!,"   * * * * Transmission will be held until "_Y_" * * * *"
"RTN","RCBEADJ",174,0)
 ;
"RTN","RCBEADJ",175,0)
 W !,"  Current Bill Status: ",$P($G(^PRCA(430.3,+$P($G(^PRCA(430,RCBILLDA,0)),"^",8),0)),"^")
"RTN","RCBEADJ",176,0)
 Q
"RTN","RCBEADJ",177,0)
 ;
"RTN","RCBEADJ",178,0)
ASKOK(RCBETYPE) ;  ask record decrease or increase transaction
"RTN","RCBEADJ",179,0)
 N DIR,DIQ2,DIRUT,DTOUT,DUOUT,X,Y
"RTN","RCBEADJ",180,0)
 S DIR(0)="YO",DIR("B")="YES"
"RTN","RCBEADJ",181,0)
 S DIR("A")="Are you sure you want to enter this "_RCBETYPE_" adjustment "
"RTN","RCBEADJ",182,0)
 W ! D ^DIR
"RTN","RCBEADJ",183,0)
 I $G(DTOUT)!($G(DUOUT)) S Y=-1
"RTN","RCBEADJ",184,0)
 Q Y
"RTN","RCBEADJ",185,0)
 ;
"RTN","RCBEADJ",186,0)
ASKAUPO() ;  ask record even though marked for auto post PRCA*4.5*298
"RTN","RCBEADJ",187,0)
 N DIR,DIQ2,DIRUT,DTOUT,DUOUT,X,Y
"RTN","RCBEADJ",188,0)
 S DIR(0)="YOA",DIR("B")="NO"
"RTN","RCBEADJ",189,0)
 S DIR("A")="Marked for Auto-Post. Are you sure? (Y/N) "
"RTN","RCBEADJ",190,0)
 W ! D ^DIR
"RTN","RCBEADJ",191,0)
 I $G(DTOUT)!($G(DUOUT)) S Y=-1
"RTN","RCBEADJ",192,0)
 Q Y
"RTN","RCBEADJ",193,0)
 ;
"RTN","RCBEADJ",194,0)
ASKFIX() ;  ask to fix bill's balance
"RTN","RCBEADJ",195,0)
 N DIR,DIQ2,DIRUT,DTOUT,DUOUT,X,Y
"RTN","RCBEADJ",196,0)
 S DIR(0)="YO",DIR("B")="YES"
"RTN","RCBEADJ",197,0)
 S DIR("A")="  Do you want to FIX the balance discrepancy "
"RTN","RCBEADJ",198,0)
 W ! D ^DIR
"RTN","RCBEADJ",199,0)
 I $G(DTOUT)!($G(DUOUT)) S Y=-1
"RTN","RCBEADJ",200,0)
 Q Y
"RTN","RCBEADJ",201,0)
 ;
"RTN","RCBEADJ",202,0)
 ;
"RTN","RCBEADJ",203,0)
ASKEXEMP() ;  ask to record an exempt transaction
"RTN","RCBEADJ",204,0)
 N DIR,DIQ2,DIRUT,DTOUT,DUOUT,X,Y
"RTN","RCBEADJ",205,0)
 S DIR(0)="YO",DIR("B")="NO"
"RTN","RCBEADJ",206,0)
 S DIR("A")="  Would you like to EXEMPT the interest and admin charges "
"RTN","RCBEADJ",207,0)
 D ^DIR
"RTN","RCBEADJ",208,0)
 I $G(DTOUT)!($G(DUOUT)) S Y=-1
"RTN","RCBEADJ",209,0)
 Q Y
"RTN","RCBEADJ",210,0)
 ;
"RTN","RCBEADJ",211,0)
 ;
"RTN","RCBEADJ",212,0)
ASKCONT() ;  ask if contract adjustment
"RTN","RCBEADJ",213,0)
 N DIR,DIQ2,DIRUT,DTOUT,DUOUT,X,Y
"RTN","RCBEADJ",214,0)
 S DIR(0)="YO",DIR("B")="YES"
"RTN","RCBEADJ",215,0)
 S DIR("A")="  Is this a CONTRACT adjustment "
"RTN","RCBEADJ",216,0)
 W ! D ^DIR
"RTN","RCBEADJ",217,0)
 I $G(DTOUT)!($G(DUOUT)) S Y=-1
"RTN","RCBEADJ",218,0)
 Q Y
"RTN","RCBEADJ",219,0)
 ;
"RTN","RCBEADJ",220,0)
ADJNUM(RCBILLDA) ;  get next adjustment number for a bill
"RTN","RCBEADJ",221,0)
 N %,ADJUST,DATA1,RCTRANDA
"RTN","RCBEADJ",222,0)
 S RCTRANDA=0
"RTN","RCBEADJ",223,0)
 F  S RCTRANDA=$O(^PRCA(433,"C",RCBILLDA,RCTRANDA)) Q:'RCTRANDA  S DATA1=$G(^PRCA(433,RCTRANDA,1)) I $P(DATA1,"^",4),$P(DATA1,"^",2)=1!($P(DATA1,"^",2)=35) S ADJUST=$P(DATA1,"^",4)+1
"RTN","RCBEADJ",224,0)
 Q ADJUST
"RTN","RCBEADJ",225,0)
 ;
"RTN","RCBEADJ",226,0)
 ;
"RTN","RCBEADJ",227,0)
AMOUNT(RCBILLDA,RCBETYPE) ;  enter the adjustment amount for a bill
"RTN","RCBEADJ",228,0)
 N DIR,DIRUT,DTOUT,DUOUT,PRINBAL,X,Y
"RTN","RCBEADJ",229,0)
 S PRINBAL=+$P($G(^PRCA(430,RCBILLDA,7)),"^")
"RTN","RCBEADJ",230,0)
 I RCBETYPE="INCREASE" S PRINBAL=9999999.99
"RTN","RCBEADJ",231,0)
 W !!,"Enter the ",RCBETYPE," Adjustment AMOUNT, from .01 to ",$J(PRINBAL,0,2),"."
"RTN","RCBEADJ",232,0)
 S DIR(0)="NAO^.01:"_PRINBAL_":2"
"RTN","RCBEADJ",233,0)
 S DIR("A")="  "_RCBETYPE_" PRINCIPAL BALANCE BY: "
"RTN","RCBEADJ",234,0)
 D ^DIR
"RTN","RCBEADJ",235,0)
 I $G(DTOUT)!($G(DUOUT)) S Y=-1
"RTN","RCBEADJ",236,0)
 Q $S(Y'="":Y,1:-1)
"RTN","RCBEADJ",237,0)
 ;
"RTN","RCBECHGS")
0^17^B14080962
"RTN","RCBECHGS",1,0)
RCBECHGS ;WISC/RFJ-add charges to an account or bill (top routine) ;1 Jun 00
"RTN","RCBECHGS",2,0)
 ;;4.5;Accounts Receivable;**153,237,301**;Mar 20, 1995;Build 144
"RTN","RCBECHGS",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCBECHGS",4,0)
 Q
"RTN","RCBECHGS",5,0)
 ;
"RTN","RCBECHGS",6,0)
 ;
"RTN","RCBECHGS",7,0)
FIRSTPTY ;  add int/admin charges to all benefit debts
"RTN","RCBECHGS",8,0)
 ;  this entry point is called from CCPC on the
"RTN","RCBECHGS",9,0)
 ;  statement day
"RTN","RCBECHGS",10,0)
 ;  variable rclasdat passed equal to statement date
"RTN","RCBECHGS",11,0)
 ;
"RTN","RCBECHGS",12,0)
 N RCDEBTDA
"RTN","RCBECHGS",13,0)
 K ^TMP("RCBECHGS REPORT",$J)  ;used to generate mailman report
"RTN","RCBECHGS",14,0)
 ;
"RTN","RCBECHGS",15,0)
 ;  check statement date
"RTN","RCBECHGS",16,0)
 I +$E(RCLASDAT,6,7)'=+$P($G(^RC(342,1,0)),"^",11) Q
"RTN","RCBECHGS",17,0)
 ;
"RTN","RCBECHGS",18,0)
 ;  lock the int/admin update to prevent two jobs from applying
"RTN","RCBECHGS",19,0)
 ;  the charges at the same time
"RTN","RCBECHGS",20,0)
 L +^RCD(340,"RCBECHGS")
"RTN","RCBECHGS",21,0)
 ;
"RTN","RCBECHGS",22,0)
 S RCDEBTDA=0 F  S RCDEBTDA=$O(^RCD(340,"AB","DPT(",RCDEBTDA)) Q:'RCDEBTDA  D CHGACCT(RCDEBTDA,RCLASDAT)
"RTN","RCBECHGS",23,0)
 ;
"RTN","RCBECHGS",24,0)
 ;  clear the lock
"RTN","RCBECHGS",25,0)
 L -^RCD(340,"RCBECHGS")
"RTN","RCBECHGS",26,0)
 ;
"RTN","RCBECHGS",27,0)
 ;  generate mailman report showing all charges added
"RTN","RCBECHGS",28,0)
 D REPORT^RCBECHGU
"RTN","RCBECHGS",29,0)
 ;
"RTN","RCBECHGS",30,0)
 K ^TMP("RCBECHGS REPORT",$J)
"RTN","RCBECHGS",31,0)
 Q
"RTN","RCBECHGS",32,0)
 ;
"RTN","RCBECHGS",33,0)
 ;
"RTN","RCBECHGS",34,0)
NONBENE ;  add int/adm/penalty charges to all non-benefit debts
"RTN","RCBECHGS",35,0)
 ;  this includes vendor, employee, ex-employee.
"RTN","RCBECHGS",36,0)
 ;  this is called by prcabj.  it does not update first party
"RTN","RCBECHGS",37,0)
 ;  debts since they work off a set statement day where as
"RTN","RCBECHGS",38,0)
 ;  non-benefit debts could be any statement day.
"RTN","RCBECHGS",39,0)
 ;
"RTN","RCBECHGS",40,0)
 N RCDEBTDA,RCLASDAT
"RTN","RCBECHGS",41,0)
 K ^TMP("RCBECHGS REPORT",$J)  ;used to generate mailman report
"RTN","RCBECHGS",42,0)
 ;
"RTN","RCBECHGS",43,0)
 ;  lock the int/admin update to prevent two jobs from applying
"RTN","RCBECHGS",44,0)
 ;  the charges at the same time
"RTN","RCBECHGS",45,0)
 L +^RCD(340,"RCBECHGS")
"RTN","RCBECHGS",46,0)
 ;
"RTN","RCBECHGS",47,0)
 ;  get the last date the system was last updated
"RTN","RCBECHGS",48,0)
 S RCLASDAT=$P($P(^RC(342,1,0),"^",10),".")
"RTN","RCBECHGS",49,0)
 ;  loop all days from the last update date up to today
"RTN","RCBECHGS",50,0)
 ;  this will make sure all accounts are updated for missed days
"RTN","RCBECHGS",51,0)
 F  S RCLASDAT=$$FMADD^XLFDT(RCLASDAT,1) Q:RCLASDAT>DT  D
"RTN","RCBECHGS",52,0)
 .   S RCDEBTDA=0
"RTN","RCBECHGS",53,0)
 .   F  S RCDEBTDA=$O(^RCD(340,"AC",+$E(RCLASDAT,6,7),RCDEBTDA)) Q:'RCDEBTDA  D
"RTN","RCBECHGS",54,0)
 .   .   ;  do not look at first party debts here
"RTN","RCBECHGS",55,0)
 .   .   I $P($G(^RCD(340,RCDEBTDA,0)),"^")["DPT(" Q
"RTN","RCBECHGS",56,0)
 .   .   ;  add int/admin to non-benefit debts
"RTN","RCBECHGS",57,0)
 .   .   D CHGACCT(RCDEBTDA,RCLASDAT)
"RTN","RCBECHGS",58,0)
 ;
"RTN","RCBECHGS",59,0)
 ;  clear the lock
"RTN","RCBECHGS",60,0)
 L -^RCD(340,"RCBECHGS")
"RTN","RCBECHGS",61,0)
 ;
"RTN","RCBECHGS",62,0)
 ;  generate mailman report showing all charges added
"RTN","RCBECHGS",63,0)
 D REPORT^RCBECHGU
"RTN","RCBECHGS",64,0)
 ;
"RTN","RCBECHGS",65,0)
 K ^TMP("RCBECHGS REPORT",$J)
"RTN","RCBECHGS",66,0)
 Q
"RTN","RCBECHGS",67,0)
 ;
"RTN","RCBECHGS",68,0)
 ;
"RTN","RCBECHGS",69,0)
CHGACCT(RCDEBTDA,RCUPDATE) ;  get bills for debtor and add charges
"RTN","RCBECHGS",70,0)
 ;  for a given date in rcupdate
"RTN","RCBECHGS",71,0)
 N DAYSINT,DFN,FROMDATE,RCBILLDA,RCDATA0,RCDATA6,RCDATE,RCLASTDT,RCSTATUS,VA,VADM,VAERR,X
"RTN","RCBECHGS",72,0)
 S RCDATA0=$G(^RCD(340,RCDEBTDA,0))
"RTN","RCBECHGS",73,0)
 ;  do not add charges for insurance companies
"RTN","RCBECHGS",74,0)
 I $P(RCDATA0,"^")["DIC(36" Q
"RTN","RCBECHGS",75,0)
 ;  if first party and patient is dead, do not add charges
"RTN","RCBECHGS",76,0)
 I $P(RCDATA0,"^")["DPT(" S DFN=+$P(RCDATA0,"^") D DEM^VADPT I +VADM(6) Q
"RTN","RCBECHGS",77,0)
 ;If Emergency Response Indicator flag is set quit out, do not add charges.
"RTN","RCBECHGS",78,0)
 I $P(RCDATA0,"^")["DPT(",$$EMERES^PRCAUTL(+$P(RCDATA0,"^"))]"" Q
"RTN","RCBECHGS",79,0)
 ;  lock the debtor to show charges being applied
"RTN","RCBECHGS",80,0)
 L +^RCD(340,RCDEBTDA)
"RTN","RCBECHGS",81,0)
 ;
"RTN","RCBECHGS",82,0)
 ;  loop thru all bills in active (16) and suspended (40) status
"RTN","RCBECHGS",83,0)
 ;  build a list of bills sorted by the date bill prepared
"RTN","RCBECHGS",84,0)
 K ^TMP("RCBECHGS",$J)
"RTN","RCBECHGS",85,0)
 F RCSTATUS=16,40 D
"RTN","RCBECHGS",86,0)
 .   S RCBILLDA=0 F  S RCBILLDA=$O(^PRCA(430,"AS",RCDEBTDA,RCSTATUS,RCBILLDA)) Q:'RCBILLDA  D
"RTN","RCBECHGS",87,0)
 .   .   ;  hold letter date (field 21) is set for bill
"RTN","RCBECHGS",88,0)
 .   .   I $G(^PRCA(430,RCBILLDA,1)) Q
"RTN","RCBECHGS",89,0)
 .   .   ;  no letter1 sent
"RTN","RCBECHGS",90,0)
 .   .   I '$G(^PRCA(430,RCBILLDA,6)) Q
"RTN","RCBECHGS",91,0)
 .   .   ;  no principal balance
"RTN","RCBECHGS",92,0)
 .   .   I '$P($G(^PRCA(430,RCBILLDA,7)),"^") Q
"RTN","RCBECHGS",93,0)
 .   .   ;  no date bill prepared
"RTN","RCBECHGS",94,0)
 .   .   I '$P(^PRCA(430,RCBILLDA,0),"^",10) Q
"RTN","RCBECHGS",95,0)
 .   .   ;  bill sent to cross-servicing   prca*4.5*301
"RTN","RCBECHGS",96,0)
 .   .   I $D(^PRCA(430,"TCSP",RCBILLDA)) Q
"RTN","RCBECHGS",97,0)
  .   .  ;  bill automatically recalled from cross-servicing   prca*4.5*301
"RTN","RCBECHGS",98,0)
 .   .   I $P($G(^PRCA(430,RCBILLDA,19)),"^",11) Q
"RTN","RCBECHGS",99,0)
 .   .   ;  store the bills in date prepared order
"RTN","RCBECHGS",100,0)
 .   .   S ^TMP("RCBECHGS",$J,"LIST",$P(^PRCA(430,RCBILLDA,0),"^",10),RCBILLDA)=""
"RTN","RCBECHGS",101,0)
 ;
"RTN","RCBECHGS",102,0)
 ;  *** calculate interest ***
"RTN","RCBECHGS",103,0)
 D INTEREST^RCBECHGI
"RTN","RCBECHGS",104,0)
 ;
"RTN","RCBECHGS",105,0)
 ;  *** calculate admin ***
"RTN","RCBECHGS",106,0)
 D ADMIN^RCBECHGA
"RTN","RCBECHGS",107,0)
 ;
"RTN","RCBECHGS",108,0)
 ;  *** calculate penalty ***
"RTN","RCBECHGS",109,0)
 ;  penalty charges are not assessed on a first party account
"RTN","RCBECHGS",110,0)
 I $P(RCDATA0,"^")'["DPT(" D PENALTY^RCBECHGP
"RTN","RCBECHGS",111,0)
 ;
"RTN","RCBECHGS",112,0)
 ;  *** add charges to bills for this account ***
"RTN","RCBECHGS",113,0)
 D ADDCHARG^RCBECHGU
"RTN","RCBECHGS",114,0)
 ;
"RTN","RCBECHGS",115,0)
 ;  clear the lock on the debtor
"RTN","RCBECHGS",116,0)
 L -^RCD(340,RCDEBTDA)
"RTN","RCBECHGS",117,0)
 ;
"RTN","RCBECHGS",118,0)
 K ^TMP("RCBECHGS",$J)
"RTN","RCBECHGS",119,0)
 Q
"RTN","RCBEIB")
0^64^B41614858
"RTN","RCBEIB",1,0)
RCBEIB ;WISC/RFJ-integrated billing entry points ;1 Jun 00
"RTN","RCBEIB",2,0)
 ;;4.5;Accounts Receivable;**157,270,301**;Mar 20, 1995;Build 144
"RTN","RCBEIB",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","RCBEIB",4,0)
 Q
"RTN","RCBEIB",5,0)
 ;
"RTN","RCBEIB",6,0)
 ; PRCA*4.5*270 add CRD flag
"RTN","RCBEIB",7,0)
 ; CANCEL(RCBILLDA,RCCANDAT,RCCANDUZ,RCCANAMT,RCCANCOM) ;  this entry point is
"RTN","RCBEIB",8,0)
CANCEL(RCBILLDA,RCCANDAT,RCCANDUZ,RCCANAMT,RCCANCOM,RCCRD) ;  this entry point is
"RTN","RCBEIB",9,0)
 ;  called when a bill is cancelled in IB
"RTN","RCBEIB",10,0)
 ;  input   rcbillda = ien of bill to cancel
"RTN","RCBEIB",11,0)
 ;          rccandat = (optional) the date the bill was cancelled
"RTN","RCBEIB",12,0)
 ;          rccanduz = (optional) the user cancelling the bill
"RTN","RCBEIB",13,0)
 ;          rccanamt = (optional) amount being cancelled
"RTN","RCBEIB",14,0)
 ;          rccancom = (optional) comments
"RTN","RCBEIB",15,0)
 ;          rccrd    = (optional) CRD flag, indicates corrected record which FMS must handle differently
"RTN","RCBEIB",16,0)
 ;
"RTN","RCBEIB",17,0)
 ;  if the optional fields are passed, they will be stored in the
"RTN","RCBEIB",18,0)
 ;  comment field (98) of the bill.
"RTN","RCBEIB",19,0)
 ;
"RTN","RCBEIB",20,0)
 ;  returns 1 if bill is cancelled in AR
"RTN","RCBEIB",21,0)
 ;          0^error message if process fails to cancel bill in AR
"RTN","RCBEIB",22,0)
 ;
"RTN","RCBEIB",23,0)
 N ACTDATE,COMMENT,DATA,INTADM,LINE,PIECE,RCBALANC,RCDATA0,RCDATE,RCFCANC,RCLIST,RCOMMENT,RCPAYAMT,RCPAYMNT,RCTRANDA,VALUE,X,XMDUN,XMY,Y
"RTN","RCBEIB",24,0)
 ;
"RTN","RCBEIB",25,0)
 ;  lock the bill
"RTN","RCBEIB",26,0)
 L +^PRCA(430,RCBILLDA):10
"RTN","RCBEIB",27,0)
 I '$T Q "0^AR bill is locked by another process"
"RTN","RCBEIB",28,0)
 ;
"RTN","RCBEIB",29,0)
 S RCDATA0=$G(^PRCA(430,RCBILLDA,0))
"RTN","RCBEIB",30,0)
 I RCDATA0="" L -^PRCA(430,RCBILLDA) Q "0^AR bill not found"
"RTN","RCBEIB",31,0)
 ;
"RTN","RCBEIB",32,0)
 ;  add comments to bill
"RTN","RCBEIB",33,0)
 S RCOMMENT(1)="Bill was cancelled in IB on "_$$FMTE^XLFDT($$NOW^XLFDT)_".",LINE=2
"RTN","RCBEIB",34,0)
 S Y=$G(RCCANDAT) I Y S Y=$E(Y,4,5)_"/"_$E(Y,6,7)_"/"_$E(Y,2,3),LINE=LINE+1,RCOMMENT(LINE)="   Cancel Date: "_Y
"RTN","RCBEIB",35,0)
 S Y=$G(RCCANDUZ) I Y S Y=$P($G(^VA(200,+RCCANDUZ,0)),"^"),LINE=LINE+1,RCOMMENT(LINE)="   Cancel   By: "_Y
"RTN","RCBEIB",36,0)
 S Y=$G(RCCANAMT) I Y S Y=$J(Y,0,2),LINE=LINE+1,RCOMMENT(LINE)=" Cancel Amount: "_Y
"RTN","RCBEIB",37,0)
 I $G(RCCANCOM)'="" S LINE=LINE+1,RCOMMENT(LINE)="      Comments: "_RCCANCOM
"RTN","RCBEIB",38,0)
 I LINE'=2 S RCOMMENT(2)="The following information was passed from IB:"
"RTN","RCBEIB",39,0)
 D ADDCOMM^RCBEUBIL(RCBILLDA,.RCOMMENT)
"RTN","RCBEIB",40,0)
 ;
"RTN","RCBEIB",41,0)
 ;  test to see if the bill is active in AR
"RTN","RCBEIB",42,0)
 S ACTDATE=$P($G(^PRCA(430,RCBILLDA,6)),"^",21)
"RTN","RCBEIB",43,0)
 ;
"RTN","RCBEIB",44,0)
 ;  === bill not activated ===
"RTN","RCBEIB",45,0)
 ;  set status to cancelled bill (26)
"RTN","RCBEIB",46,0)
 I 'ACTDATE D CHGSTAT^RCBEUBIL(RCBILLDA,26) L -^PRCA(430,RCBILLDA) Q 1
"RTN","RCBEIB",47,0)
 ;
"RTN","RCBEIB",48,0)
 ;  === bill is activated ===
"RTN","RCBEIB",49,0)
 ;
"RTN","RCBEIB",50,0)
 ;  get the balance of the bill
"RTN","RCBEIB",51,0)
 S RCBALANC=$$GETTRANS^RCDPBTLM(RCBILLDA)
"RTN","RCBEIB",52,0)
 ;
"RTN","RCBEIB",53,0)
 ;  calculate payments made
"RTN","RCBEIB",54,0)
 S RCDATE="",RCPAYAMT=0,RCPAYMNT=""
"RTN","RCBEIB",55,0)
 F  S RCDATE=$O(RCLIST(RCDATE)) Q:'RCDATE  D
"RTN","RCBEIB",56,0)
 .   S RCTRANDA=0
"RTN","RCBEIB",57,0)
 .   F  S RCTRANDA=$O(RCLIST(RCDATE,RCTRANDA)) Q:'RCTRANDA  D
"RTN","RCBEIB",58,0)
 .   .   I RCLIST(RCDATE,RCTRANDA)'["PAYMENT" Q
"RTN","RCBEIB",59,0)
 .   .   F PIECE=2:1:6 D
"RTN","RCBEIB",60,0)
 .   .   .   ;  total payments
"RTN","RCBEIB",61,0)
 .   .   .   S RCPAYAMT=RCPAYAMT+$P(RCLIST(RCDATE,RCTRANDA),"^",PIECE)
"RTN","RCBEIB",62,0)
 .   .   .   ;  total payments by prin ^ int ^ adm ^ mf ^ cc
"RTN","RCBEIB",63,0)
 .   .   .   S $P(RCPAYMNT,"^",PIECE-1)=$P(RCPAYMNT,"^",PIECE-1)+$P(RCLIST(RCDATE,RCTRANDA),"^",PIECE)
"RTN","RCBEIB",64,0)
 ;
"RTN","RCBEIB",65,0)
 ;  if the current bill status is active, cancel it
"RTN","RCBEIB",66,0)
 I $P(^PRCA(430,RCBILLDA,0),"^",8)=16!($P(^PRCA(430,RCBILLDA,0),"^",8)=42) D
"RTN","RCBEIB",67,0)
 .   ;  if there is a principal balance, decrease it
"RTN","RCBEIB",68,0)
 .   S COMMENT(1)="Bill cancelled in IB.  Automatic decrease adjustment created."
"RTN","RCBEIB",69,0)
 .   ;
"RTN","RCBEIB",70,0)
 .   ; PRCA*4.5*270 need to  let FMS know if this is a corrected record
"RTN","RCBEIB",71,0)
 .   ;I $P(RCBALANC,"^") S RCTRANDA=$$INCDEC^RCBEUTR1(RCBILLDA,-$P(RCBALANC,"^"),.COMMENT) I 'RCTRANDA Q
"RTN","RCBEIB",72,0)
 .   I $P(RCBALANC,"^") S RCTRANDA=$$INCDEC^RCBEUTR1(RCBILLDA,-$P(RCBALANC,"^"),.COMMENT,"","","",$G(RCCRD)) I 'RCTRANDA Q
"RTN","RCBEIB",73,0)
 .   I $D(^PRCA(430,"TCSP",RCBILLDA)) D DECADJ^RCTCSPU(RCBILLDA,RCTRANDA) ;prca*4.5*301 add cs decrease adjustment
"RTN","RCBEIB",74,0)
 .   ;
"RTN","RCBEIB",75,0)
 .   ;  create an int/adm charge (minus)
"RTN","RCBEIB",76,0)
 .   ;  determine if there is an interest ^ admin ^ mf ^ cc charge
"RTN","RCBEIB",77,0)
 .   ;  set value = interest ^ admin ^ mf ^ cc (and make negative)
"RTN","RCBEIB",78,0)
 .   S INTADM=0,VALUE=""
"RTN","RCBEIB",79,0)
 .   F PIECE=2:1:5 S INTADM=INTADM+$P(RCBALANC,"^",PIECE),VALUE=VALUE_(-$P(RCBALANC,"^",PIECE))_"^"
"RTN","RCBEIB",80,0)
 .   I INTADM S RCTRANDA=$$INTADM^RCBEUTR1(RCBILLDA,VALUE,.COMMENT) I 'RCTRANDA Q
"RTN","RCBEIB",81,0)
 .   I $D(^PRCA(430,"TCSP",RCBILLDA)) D DECADJ^RCTCSPU(RCBILLDA,RCTRANDA) ;prca*4.5*301 add cs decrease adjustment
"RTN","RCBEIB",82,0)
 .   ;
"RTN","RCBEIB",83,0)
 .   ;  mark bill as cancellation (39)
"RTN","RCBEIB",84,0)
 .   D CHGSTAT^RCBEUBIL(RCBILLDA,39)
"RTN","RCBEIB",85,0)
 ;
"RTN","RCBEIB",86,0)
 ;  recheck status to see if bill was cancelled
"RTN","RCBEIB",87,0)
 ;  set rcfcanc to indicate bill could not be canceled
"RTN","RCBEIB",88,0)
 S RCDATA0=$G(^PRCA(430,RCBILLDA,0))
"RTN","RCBEIB",89,0)
 I $P(RCDATA0,"^",8)'=39,$P(RCDATA0,"^",8)'=26 S RCFCANC="AR could not automatically CANCEL the bill.  User action is required."
"RTN","RCBEIB",90,0)
 ;
"RTN","RCBEIB",91,0)
 ;  if the bill was cancelled in AR and no payments, do not send mail
"RTN","RCBEIB",92,0)
 I $G(RCFCANC)="",'RCPAYAMT L -^PRCA(430,RCBILLDA) Q 1
"RTN","RCBEIB",93,0)
 ;
"RTN","RCBEIB",94,0)
 ;
"RTN","RCBEIB",95,0)
 ;  bill could not be cancelled in AR or payments made,
"RTN","RCBEIB",96,0)
 ;  send mailman message to user
"RTN","RCBEIB",97,0)
 K ^TMP($J,"RCRJRCORMM")
"RTN","RCBEIB",98,0)
 S ^TMP($J,"RCRJRCORMM",1,0)="Integrated Billing has cancelled bill "_$P(RCDATA0,"^")_"."
"RTN","RCBEIB",99,0)
 S ^TMP($J,"RCRJRCORMM",2,0)=" "
"RTN","RCBEIB",100,0)
 S ^TMP($J,"RCRJRCORMM",3,0)="     BILL: "_$P(RCDATA0,"^")_"            STATUS: "_$P($G(^PRCA(430.3,+$P(^PRCA(430,RCBILLDA,0),"^",8),0)),"^")
"RTN","RCBEIB",101,0)
 S DATA=$$ACCNTHDR^RCDPAPLM($P(RCDATA0,"^",9))
"RTN","RCBEIB",102,0)
 S ^TMP($J,"RCRJRCORMM",4,0)="  ACCOUNT: "_$P(DATA,"^")_" "_$P(DATA,"^",2)
"RTN","RCBEIB",103,0)
 S ^TMP($J,"RCRJRCORMM",5,0)=" "
"RTN","RCBEIB",104,0)
 S ^TMP($J,"RCRJRCORMM",6,0)="                                Principal  Interest     Admin"
"RTN","RCBEIB",105,0)
 S ^TMP($J,"RCRJRCORMM",7,0)="  Current Balance:             "_$J($P(RCBALANC,"^"),10,2)_$J($P(RCBALANC,"^",2),10,2)_$J($P(RCBALANC,"^",3)+$P(RCBALANC,"^",4)+$P(RCBALANC,"^",5),10,2)
"RTN","RCBEIB",106,0)
 S LINE=7
"RTN","RCBEIB",107,0)
 ;
"RTN","RCBEIB",108,0)
 ;  if payments made, show amount paid
"RTN","RCBEIB",109,0)
 I RCPAYAMT S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)="  Payments   Made:             "_$J(-$P(RCPAYMNT,"^"),10,2)_$J(-$P(RCPAYMNT,"^",2),10,2)_$J(-$P(RCPAYMNT,"^",3)-$P(RCPAYMNT,"^",4)-$P(RCPAYMNT,"^",5),10,2)
"RTN","RCBEIB",110,0)
 ;
"RTN","RCBEIB",111,0)
 ;  if comments passed from IB, include them
"RTN","RCBEIB",112,0)
 I $D(RCOMMENT(2)) D
"RTN","RCBEIB",113,0)
 .   S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)=" "
"RTN","RCBEIB",114,0)
 .   F X=1:1 Q:'$D(RCOMMENT(X))  S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)=RCOMMENT(X)
"RTN","RCBEIB",115,0)
 ;
"RTN","RCBEIB",116,0)
 ;  if the bill could not be cancelled in AR, let user know the error
"RTN","RCBEIB",117,0)
 I $G(RCFCANC)'="" D
"RTN","RCBEIB",118,0)
 .   S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)=" "
"RTN","RCBEIB",119,0)
 .   S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)="* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *"
"RTN","RCBEIB",120,0)
 .   S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)=RCFCANC
"RTN","RCBEIB",121,0)
 .   S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)="* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *"
"RTN","RCBEIB",122,0)
 ;
"RTN","RCBEIB",123,0)
 ;  if a payment has been made, let user know it needs to be refunded
"RTN","RCBEIB",124,0)
 I RCPAYAMT D
"RTN","RCBEIB",125,0)
 .   S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)=" "
"RTN","RCBEIB",126,0)
 .   S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)="* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *"
"RTN","RCBEIB",127,0)
 .   S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)="In AR, a payment of $ "_$J(-RCPAYAMT,0,2)_" has been collected and needs to be REFUNDED."
"RTN","RCBEIB",128,0)
 .   S LINE=LINE+1,^TMP($J,"RCRJRCORMM",LINE,0)="* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *"
"RTN","RCBEIB",129,0)
 ;
"RTN","RCBEIB",130,0)
 ;  send report
"RTN","RCBEIB",131,0)
 S XMY("G.PRCA ADJUSTMENT TRANS")=""
"RTN","RCBEIB",132,0)
 S X=$$SENDMSG^RCRJRCOR("AR User Action Required "_$P(RCDATA0,"^"),.XMY)
"RTN","RCBEIB",133,0)
 K ^TMP($J,"RCRJRCORMM")
"RTN","RCBEIB",134,0)
 ;
"RTN","RCBEIB",135,0)
 L -^PRCA(430,RCBILLDA)
"RTN","RCBEIB",136,0)
 ;
"RTN","RCBEIB",137,0)
 Q $S($G(RCFCANC)'="":"0^"_RCFCANC,1:1)
"RTN","RCBEPAY")
0^60^B26246409
"RTN","RCBEPAY",1,0)
RCBEPAY ;WISC/RFJ - payment processing (top routine) ;1 Jun 00
"RTN","RCBEPAY",2,0)
 ;;4.5;Accounts Receivable;**153,304,301**;Mar 20, 1995;Build 144
"RTN","RCBEPAY",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCBEPAY",4,0)
 ;
"RTN","RCBEPAY",5,0)
 Q
"RTN","RCBEPAY",6,0)
 ;
"RTN","RCBEPAY",7,0)
 ;
"RTN","RCBEPAY",8,0)
PROCESS(RCRECTDA,RCPAYDA) ;  process a payment for receipt
"RTN","RCBEPAY",9,0)
 ;  rcrectda - receipt ien file 344
"RTN","RCBEPAY",10,0)
 ;  rcpayda  - payment ien file 344 under rcrectda
"RTN","RCBEPAY",11,0)
 ;  returns 0 if processed, 1^error if not processed
"RTN","RCBEPAY",12,0)
 ;
"RTN","RCBEPAY",13,0)
 N RCACCT,RCBILLDA,RCDATA,RCERROR,RCPAYAMT,RCPAYDAT,RCTRANDA,X,RCERROR
"RTN","RCBEPAY",14,0)
 ;
"RTN","RCBEPAY",15,0)
 ;  lock the receipt payment
"RTN","RCBEPAY",16,0)
 L +^RCY(344,RCRECTDA,1,RCPAYDA):10
"RTN","RCBEPAY",17,0)
 I '$T Q "1^Another user is working with this payment"
"RTN","RCBEPAY",18,0)
 ;
"RTN","RCBEPAY",19,0)
 ;  get the payment data
"RTN","RCBEPAY",20,0)
 S RCDATA=^RCY(344,RCRECTDA,1,RCPAYDA,0)
"RTN","RCBEPAY",21,0)
 ;
"RTN","RCBEPAY",22,0)
 ;  there is no account, this will go to suspense
"RTN","RCBEPAY",23,0)
 I $P(RCDATA,"^",3)="" L -^RCY(344,RCRECTDA,1,RCPAYDA) D  Q RCERROR
"RTN","RCBEPAY",24,0)
 . S RCERROR=0
"RTN","RCBEPAY",25,0)
 . I '$T S RCERROR="1^Another user is updating the Suspense File Audit Log."  Q
"RTN","RCBEPAY",26,0)
 . ;
"RTN","RCBEPAY",27,0)
 . ;file a "P"ending entry in the Suspense Audit Log File and for the disposition
"RTN","RCBEPAY",28,0)
 . ;if not already there and not $0 payment (auto-adjustment back to FMS).
"RTN","RCBEPAY",29,0)
 . I '$D(^RCY(344,RCRECTDA,1,RCPAYDA,3)),($P($G(^RCY(344,RCRECTDA,1,RCPAYDA,0)),U,4)'=0) D
"RTN","RCBEPAY",30,0)
 . . D AUDIT(RCRECTDA,RCPAYDA,"I")
"RTN","RCBEPAY",31,0)
 . . ;
"RTN","RCBEPAY",32,0)
 . . ;update disposition
"RTN","RCBEPAY",33,0)
 . . D SUSPDIS(RCRECTDA,RCPAYDA,"P")
"RTN","RCBEPAY",34,0)
 ;
"RTN","RCBEPAY",35,0)
 ;  check the payment for errors
"RTN","RCBEPAY",36,0)
 S X=$$CHECKPAY^RCBEPAYC(RCRECTDA,RCPAYDA)
"RTN","RCBEPAY",37,0)
 I X L -^RCY(344,RCRECTDA,1,RCPAYDA) Q X
"RTN","RCBEPAY",38,0)
 ;
"RTN","RCBEPAY",39,0)
 ;  get the payment date from the payment.  if not on payment get it
"RTN","RCBEPAY",40,0)
 ;  from the deposit.  if not on deposit, set equal to today
"RTN","RCBEPAY",41,0)
 S RCPAYDAT=$P($P(RCDATA,"^",6),".") I 'RCPAYDAT S RCPAYDAT=$P($G(^RCY(344.1,+$P(^RCY(344,RCRECTDA,0),"^",6),0)),"^",3) I 'RCPAYDAT S RCPAYDAT=DT
"RTN","RCBEPAY",42,0)
 ;  get the payment amount (amount paid minus amount processed).
"RTN","RCBEPAY",43,0)
 ;  if the payment amount is not greater than zero, do not post.
"RTN","RCBEPAY",44,0)
 S RCPAYAMT=$P(RCDATA,"^",4)-$P(RCDATA,"^",5) I RCPAYAMT'>0 L -^RCY(344,RCRECTDA,1,RCPAYDA) Q 0
"RTN","RCBEPAY",45,0)
 ;
"RTN","RCBEPAY",46,0)
 ;  get the account
"RTN","RCBEPAY",47,0)
 S RCACCT=$P(RCDATA,"^",3)
"RTN","RCBEPAY",48,0)
 ;  if the account is a bill and the debtor is first party,
"RTN","RCBEPAY",49,0)
 ;  then get the account from the debtor file
"RTN","RCBEPAY",50,0)
 I RCACCT["PRCA(430," S X=$P($G(^RCD(340,+$P($G(^PRCA(430,+RCACCT,0)),"^",9),0)),"^") I X["DPT(" S RCACCT=X
"RTN","RCBEPAY",51,0)
 ;
"RTN","RCBEPAY",52,0)
 ;
"RTN","RCBEPAY",53,0)
 ;  ----------------- START PROCESSING PAYMENT -----------------
"RTN","RCBEPAY",54,0)
 ;
"RTN","RCBEPAY",55,0)
 ;  === benefit debt (example: first party account) ===
"RTN","RCBEPAY",56,0)
 I RCACCT["DPT(" D  Q RCERROR
"RTN","RCBEPAY",57,0)
 .   S RCERROR=$$FIRSTPTY^RCBEPAYF
"RTN","RCBEPAY",58,0)
 .   ;  store or clear error
"RTN","RCBEPAY",59,0)
 .   D SETERROR(RCRECTDA,RCPAYDA,$P(RCERROR,"^",2))
"RTN","RCBEPAY",60,0)
 .   L -^RCY(344,RCRECTDA,1,RCPAYDA)
"RTN","RCBEPAY",61,0)
 ;
"RTN","RCBEPAY",62,0)
 ;
"RTN","RCBEPAY",63,0)
 ;  === non-benefit debt (example: third party) ===
"RTN","RCBEPAY",64,0)
 S RCBILLDA=+$P(RCDATA,"^",3)
"RTN","RCBEPAY",65,0)
 ;  lock the bill to prevent another used from changing the balance
"RTN","RCBEPAY",66,0)
 L +^PRCA(430,RCBILLDA):10
"RTN","RCBEPAY",67,0)
 I '$T D  Q RCERROR
"RTN","RCBEPAY",68,0)
 .   S RCERROR="1^Another user is working with bill "_$P(^PRCA(430,RCBILLDA,0),"^")
"RTN","RCBEPAY",69,0)
 .   D SETERROR(RCRECTDA,RCPAYDA,$P(RCERROR,"^",2))
"RTN","RCBEPAY",70,0)
 .   L -^RCY(344,RCRECTDA,1,RCPAYDA)
"RTN","RCBEPAY",71,0)
 ;
"RTN","RCBEPAY",72,0)
 ;  exempt any interest/admin/penalty charges added on or after
"RTN","RCBEPAY",73,0)
 ;  the payment date
"RTN","RCBEPAY",74,0)
 D EXEMPT^RCBECHGE(RCBILLDA,RCPAYDAT)
"RTN","RCBEPAY",75,0)
 ;
"RTN","RCBEPAY",76,0)
 ;  once charges have been exempted, recheck the payment for errors
"RTN","RCBEPAY",77,0)
 S X=$$CHECKPAY^RCBEPAYC(RCRECTDA,RCPAYDA)
"RTN","RCBEPAY",78,0)
 I X D  Q RCERROR
"RTN","RCBEPAY",79,0)
 .   S RCERROR="1^"_$P(X,"^",2)
"RTN","RCBEPAY",80,0)
 .   D SETERROR(RCRECTDA,RCPAYDA,$P(RCERROR,"^",2))
"RTN","RCBEPAY",81,0)
 .   L -^PRCA(430,RCBILLDA)
"RTN","RCBEPAY",82,0)
 .   L -^RCY(344,RCRECTDA,1,RCPAYDA)
"RTN","RCBEPAY",83,0)
 ;
"RTN","RCBEPAY",84,0)
 ;  apply payment to bill
"RTN","RCBEPAY",85,0)
 ;  return error if problem adding payment transaction
"RTN","RCBEPAY",86,0)
 S RCTRANDA=$$PAYTRAN^RCBEPAY1(RCBILLDA,RCPAYAMT,RCRECTDA,RCPAYDA,RCPAYDAT)
"RTN","RCBEPAY",87,0)
 I 'RCTRANDA D  Q RCERROR
"RTN","RCBEPAY",88,0)
 .   S RCERROR="1^"_$P(RCTRANDA,"^",2)
"RTN","RCBEPAY",89,0)
 .   D SETERROR(RCRECTDA,RCPAYDA,$P(RCERROR,"^",2))
"RTN","RCBEPAY",90,0)
 .   L -^PRCA(430,RCBILLDA)
"RTN","RCBEPAY",91,0)
 .   L -^RCY(344,RCRECTDA,1,RCPAYDA)
"RTN","RCBEPAY",92,0)
 ;
"RTN","RCBEPAY",93,0)
 ;  set the amount processed in the receipt
"RTN","RCBEPAY",94,0)
 D SETAMT(RCRECTDA,RCPAYDA,$P($G(^PRCA(433,RCTRANDA,1)),"^",5))
"RTN","RCBEPAY",95,0)
 ;
"RTN","RCBEPAY",96,0)
 ;  payment applied to bill
"RTN","RCBEPAY",97,0)
 D SETERROR(RCRECTDA,RCPAYDA,"")
"RTN","RCBEPAY",98,0)
 L -^PRCA(430,RCBILLDA)
"RTN","RCBEPAY",99,0)
 L -^RCY(344,RCRECTDA,1,RCPAYDA)
"RTN","RCBEPAY",100,0)
 Q 0
"RTN","RCBEPAY",101,0)
 ;
"RTN","RCBEPAY",102,0)
 ;
"RTN","RCBEPAY",103,0)
SETAMT(RCRECTDA,RCPAYDA,RCAMOUNT) ;  update the amount posted on the receipt
"RTN","RCBEPAY",104,0)
 N DATA
"RTN","RCBEPAY",105,0)
 S DATA=$G(^RCY(344,RCRECTDA,1,RCPAYDA,0))
"RTN","RCBEPAY",106,0)
 I DATA="" Q
"RTN","RCBEPAY",107,0)
 S $P(^RCY(344,RCRECTDA,1,RCPAYDA,0),"^",5)=$P(DATA,"^",5)+RCAMOUNT
"RTN","RCBEPAY",108,0)
 Q
"RTN","RCBEPAY",109,0)
 ;
"RTN","RCBEPAY",110,0)
 ;
"RTN","RCBEPAY",111,0)
SETERROR(RCRECTDA,RCPAYDA,RCERROR) ;  store the error on the receipt
"RTN","RCBEPAY",112,0)
 ;  or clear the posting error if null and defined
"RTN","RCBEPAY",113,0)
 ;  error is null and posting error data in file is null
"RTN","RCBEPAY",114,0)
 I RCERROR="",$P($G(^RCY(344,RCRECTDA,1,RCPAYDA,1)),"^")="" Q
"RTN","RCBEPAY",115,0)
 ;  error is null, clear posting error
"RTN","RCBEPAY",116,0)
 I RCERROR="" S $P(^RCY(344,RCRECTDA,1,RCPAYDA,1),"^")="" Q
"RTN","RCBEPAY",117,0)
 ;  error exists, set the posting error
"RTN","RCBEPAY",118,0)
 I RCERROR'="" S $P(^RCY(344,RCRECTDA,1,RCPAYDA,1),"^")=$E(RCERROR,1,60)
"RTN","RCBEPAY",119,0)
 Q
"RTN","RCBEPAY",120,0)
 ;
"RTN","RCBEPAY",121,0)
 ;
"RTN","RCBEPAY",122,0)
AUDIT(RCRECTDA,RCPAYDA,RCSTAT) ; store entry in Suspense Audit Log
"RTN","RCBEPAY",123,0)
 N RCAUDIT,RCDATA,RCDATA1,RCDATA0
"RTN","RCBEPAY",124,0)
 ;
"RTN","RCBEPAY",125,0)
 ; get the data elements
"RTN","RCBEPAY",126,0)
 S RCDATA=$G(^RCY(344,RCRECTDA,0))  ;double check these
"RTN","RCBEPAY",127,0)
 S RCDATA0=$G(^RCY(344,RCRECTDA,1,RCPAYDA,0))
"RTN","RCBEPAY",128,0)
 S RCDATA1=$G(^RCY(344,RCRECTDA,1,RCPAYDA,1))
"RTN","RCBEPAY",129,0)
 ;
"RTN","RCBEPAY",130,0)
 ; set up array
"RTN","RCBEPAY",131,0)
 S RCAUDIT(344.71,"+1,",.01)=$$NOW^XLFDT      ;Date/Time Stamp
"RTN","RCBEPAY",132,0)
 S RCAUDIT(344.71,"+1,",.02)=DUZ              ;User
"RTN","RCBEPAY",133,0)
 S RCAUDIT(344.71,"+1,",.03)=$P(RCDATA,U,1)   ;Receipt #
"RTN","RCBEPAY",134,0)
 S RCAUDIT(344.71,"+1,",.04)=RCPAYDA          ;Transaction #
"RTN","RCBEPAY",135,0)
 S RCAUDIT(344.71,"+1,",.05)=$P(RCDATA0,U,4)  ;Amount
"RTN","RCBEPAY",136,0)
 S RCAUDIT(344.71,"+1,",.06)=$P(RCDATA0,U,9)  ;Claim #
"RTN","RCBEPAY",137,0)
 S RCAUDIT(344.71,"+1,",.07)=RCSTAT           ;Status
"RTN","RCBEPAY",138,0)
 S RCAUDIT(344.71,"+1,",.08)=$P(RCDATA1,U,2)  ;Reason text
"RTN","RCBEPAY",139,0)
 ;
"RTN","RCBEPAY",140,0)
 ;file entry
"RTN","RCBEPAY",141,0)
 D UPDATE^DIE(,"RCAUDIT")
"RTN","RCBEPAY",142,0)
 Q
"RTN","RCBEPAY",143,0)
 ;
"RTN","RCBEPAY",144,0)
 ;
"RTN","RCBEPAY",145,0)
SUSPDIS(RCRECTDA,RCTRANDA,RCSTAT) ;Update the disposition field
"RTN","RCBEPAY",146,0)
 ;
"RTN","RCBEPAY",147,0)
 N DA,DR,DIE,DTOUT
"RTN","RCBEPAY",148,0)
 S DA=RCTRANDA,DA(1)=RCRECTDA,DIE="^RCY(344,"_DA(1)_",1,"
"RTN","RCBEPAY",149,0)
 S DR="3.01////"_RCSTAT_";"
"RTN","RCBEPAY",150,0)
 I RCSTAT="P" D
"RTN","RCBEPAY",151,0)
 . S DR=DR_"3.02////"_$$NOW^XLFDT_";"
"RTN","RCBEPAY",152,0)
 . S DR=DR_"3.03////"_DUZ_";"
"RTN","RCBEPAY",153,0)
 I RCSTAT'="P" D
"RTN","RCBEPAY",154,0)
 . S DR=DR_"3.04////"_$$NOW^XLFDT_";"
"RTN","RCBEPAY",155,0)
 . S DR=DR_"3.05////"_DUZ_";"
"RTN","RCBEPAY",156,0)
 S DR=$P(DR,";",1,$L(DR,";")-1)
"RTN","RCBEPAY",157,0)
 ;
"RTN","RCBEPAY",158,0)
 D ^DIE
"RTN","RCBEPAY",159,0)
 Q
"RTN","RCBEPAY",160,0)
 ; 
"RTN","RCBEPAYF")
0^61^B49084627
"RTN","RCBEPAYF",1,0)
RCBEPAYF ;WISC/RFJ-first party payment processing(called by rcbepay) ;1 Jun 00
"RTN","RCBEPAYF",2,0)
 ;;4.5;Accounts Receivable;**153,301**;Mar 20, 1995;Build 144
"RTN","RCBEPAYF",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCBEPAYF",4,0)
 Q
"RTN","RCBEPAYF",5,0)
 ;
"RTN","RCBEPAYF",6,0)
 ;
"RTN","RCBEPAYF",7,0)
FIRSTPTY() ;  apply payment to first party account
"RTN","RCBEPAYF",8,0)
 ;  called by rcbepay
"RTN","RCBEPAYF",9,0)
 N PAYMENT,RCBILBAL,RCBILLDA,RCDATE,RCDEBTDA,RCERROR,RCREPAMT,RCSTATUS,RCTRANDA,X
"RTN","RCBEPAYF",10,0)
 K ^TMP("RCBEPAY",$J)
"RTN","RCBEPAYF",11,0)
 ; acc't lookup info  BB prca*4.5*301
"RTN","RCBEPAYF",12,0)
 S CSBILLDA=+$E($P(RCDATA,"^",7),22,99),CSDEP=$P(RCDATA,"^",19),CSBILL=$E($P(RCDATA,"^",7),1,3)_"-"_$E($P(RCDATA,"^",7),4,10)
"RTN","RCBEPAYF",13,0)
 I 'CSDEP S CSDEP=169     ;Default for missing pay type
"RTN","RCBEPAYF",14,0)
 I $E($G(CSDEP),1,3)=170 S CSBILLDA=$O(^PRCA(430,"B",CSBILL,0))
"RTN","RCBEPAYF",15,0)
 I RCDATA["PRCA(430," S CSBILLDA=+$P(RCDATA,"^",3)
"RTN","RCBEPAYF",16,0)
 I CSDEP>167,CSDEP<171 S RCBETYPE=CSDEP
"RTN","RCBEPAYF",17,0)
 ;end PRCA*4.5*301
"RTN","RCBEPAYF",18,0)
 ;
"RTN","RCBEPAYF",19,0)
 ;  look up account in debtor file
"RTN","RCBEPAYF",20,0)
 S RCDEBTDA=$$DEBT^RCEVUTL(RCACCT)
"RTN","RCBEPAYF",21,0)
 I RCDEBTDA<0 Q "1^Could not add Patient ("_RCACCT_") to debtor file"
"RTN","RCBEPAYF",22,0)
 ;
"RTN","RCBEPAYF",23,0)
 ;  lock the debtor account
"RTN","RCBEPAYF",24,0)
 L +^RCD(340,RCDEBTDA):20 I '$T Q "1^Another user is working with this patient account"
"RTN","RCBEPAYF",25,0)
 ;
"RTN","RCBEPAYF",26,0)
 ;  build list of active(16) and open(42) bills for patient
"RTN","RCBEPAYF",27,0)
 ;  sorted by date bill prepared
"RTN","RCBEPAYF",28,0)
 F RCSTATUS=16,42 S RCBILLDA=0 F  S RCBILLDA=$O(^PRCA(430,"AS",RCDEBTDA,RCSTATUS,RCBILLDA)) Q:'RCBILLDA  D
"RTN","RCBEPAYF",29,0)
 .   ;  check bill for prepayment
"RTN","RCBEPAYF",30,0)
 .   I $P(^PRCA(430,RCBILLDA,0),"^",2)=26 Q  ; ACCOUNTS RECEIVABLE CATEGORY (PREPAYMENT=26)
"RTN","RCBEPAYF",31,0)
 .   ;
"RTN","RCBEPAYF",32,0)
 .   ;  checks if payment was via a "170" CS Treasury lockbox transaction ; prca*4.5*301
"RTN","RCBEPAYF",33,0)
 .   ;    Ignores bill if bill is NOT a "TCSP" CS bill
"RTN","RCBEPAYF",34,0)
 .   ;    else sets as FIRST if designated as bill to be applied, or subsequent in oldest date order
"RTN","RCBEPAYF",35,0)
 .   I CSDEP=170 D  Q  ; prca*4.5*301
"RTN","RCBEPAYF",36,0)
 .   .  I $D(^PRCA(430,"TCSP",RCBILLDA)) D  Q  ;
"RTN","RCBEPAYF",37,0)
 .   .  . I CSBILLDA=RCBILLDA S ^TMP("RCBEPAY",$J,0,RCBILLDA)="" Q
"RTN","RCBEPAYF",38,0)
 .   .  . S ^TMP("RCBEPAY",$J,880000000+$P($G(^PRCA(430,RCBILLDA,0)),"^",10),RCBILLDA)=""
"RTN","RCBEPAYF",39,0)
 .   .  S ^TMP("RCBEPAY",$J,990000000+$P($G(^PRCA(430,RCBILLDA,0)),"^",10),RCBILLDA)=""
"RTN","RCBEPAYF",40,0)
 .   I $E($G(CSDEP),1,3)'=168,$D(^PRCA(430,"TCSP",RCBILLDA)) Q   ;BB prca*4.5*301
"RTN","RCBEPAYF",41,0)
 .   ;I $P(RCDATA,"^",3)["PRCA(430,",RCBILLDA=+$P(RCDATA,"^",3) S ^TMP("RCBEPAY",$J,0,RCBILLDA)="" Q
"RTN","RCBEPAYF",42,0)
 .   ;I CSBILLDA=RCBILLDA S ^TMP("RCBEPAY",$J,0,RCBILLDA)="" Q
"RTN","RCBEPAYF",43,0)
 .   S ^TMP("RCBEPAY",$J,+$P($G(^PRCA(430,RCBILLDA,0)),"^",10),RCBILLDA)=""
"RTN","RCBEPAYF",44,0)
PROC ;
"RTN","RCBEPAYF",45,0)
 ;  loop all the bills for a patients account and keep looping them
"RTN","RCBEPAYF",46,0)
 ;  until either there is no more bills or the money paid is zero.
"RTN","RCBEPAYF",47,0)
 ;  the bills are looped in case of repayments.  if there is money
"RTN","RCBEPAYF",48,0)
 ;  left over, this will apply more money to the repayment bills
"RTN","RCBEPAYF",49,0)
 ;  instead of creating a prepayment.  a prepayment should only be
"RTN","RCBEPAYF",50,0)
 ;  created if all bills for the account is collected/closed.
"RTN","RCBEPAYF",51,0)
 S RCERROR=0
"RTN","RCBEPAYF",52,0)
 ;  quit the loop if no money left to apply OR an error occurred OR
"RTN","RCBEPAYF",53,0)
 ;  no more bills left to apply payment to
"RTN","RCBEPAYF",54,0)
 F  D  I 'RCPAYAMT!(RCERROR)!($O(^TMP("RCBEPAY",$J,""))="") Q
"RTN","RCBEPAYF",55,0)
 .   ;  loop the bills by date prepared and apply the payment
"RTN","RCBEPAYF",56,0)
 .   ;  quit if no money left to apply OR and error occurred
"RTN","RCBEPAYF",57,0)
 .   S RCDATE="" F  S RCDATE=$O(^TMP("RCBEPAY",$J,RCDATE)) Q:RCDATE=""  D  I 'RCPAYAMT!(RCERROR) Q
"RTN","RCBEPAYF",58,0)
 .   .   S RCBILLDA=0 F  S RCBILLDA=$O(^TMP("RCBEPAY",$J,RCDATE,RCBILLDA)) Q:'RCBILLDA  D  I 'RCPAYAMT!(RCERROR) Q
"RTN","RCBEPAYF",59,0)
 .   .   .   L +^PRCA(430,RCBILLDA):10
"RTN","RCBEPAYF",60,0)
 .   .   .   I '$T S RCERROR="1^Another user is working with bill "_$P(^PRCA(430,RCBILLDA,0),"^") Q
"RTN","RCBEPAYF",61,0)
 .   .   .   ;
"RTN","RCBEPAYF",62,0)
 .   .   .   ;  exempt any interest/admin/penalty charges added on or after
"RTN","RCBEPAYF",63,0)
 .   .   .   ;  the payment date
"RTN","RCBEPAYF",64,0)
 .   .   .   D EXEMPT^RCBECHGE(RCBILLDA,RCPAYDAT)
"RTN","RCBEPAYF",65,0)
 .   .   .   ;
"RTN","RCBEPAYF",66,0)
 .   .   .   ;  get the repayment amount (if any)
"RTN","RCBEPAYF",67,0)
 .   .   .   S RCREPAMT=$P($G(^PRCA(430,RCBILLDA,4)),"^",3) I CSDEP=168!(CSDEP=170) S RCREPAMT=0   ;PRCA*4.5*301
"RTN","RCBEPAYF",68,0)
 .   .   .   ;
"RTN","RCBEPAYF",69,0)
 .   .   .   ;  get the balance of the bill
"RTN","RCBEPAYF",70,0)
 .   .   .   S X=$G(^PRCA(430,RCBILLDA,7))
"RTN","RCBEPAYF",71,0)
 .   .   .   S RCBILBAL=$P(X,"^")+$P(X,"^",2)+$P(X,"^",3)+$P(X,"^",4)+$P(X,"^",5)
"RTN","RCBEPAYF",72,0)
 .   .   .   ;  if bill has no balance, chg status = collected/closed
"RTN","RCBEPAYF",73,0)
 .   .   .   I 'RCBILBAL D  Q    ;PRCA*4.5*301
"RTN","RCBEPAYF",74,0)
 .   .   .   . D CHGSTAT^RCBEUBIL(RCBILLDA,22)
"RTN","RCBEPAYF",75,0)
 .   .   .   . L -^PRCA(430,RCBILLDA)
"RTN","RCBEPAYF",76,0)
 .   .   .   . K ^TMP("RCBEPAY",$J,RCDATE,RCBILLDA)
"RTN","RCBEPAYF",77,0)
 .   .   .   ;
"RTN","RCBEPAYF",78,0)
 .   .   .   ;  determine amount to pay
"RTN","RCBEPAYF",79,0)
 .   .   .   ;  if the payment is greater than billed amount, pay billed amount
"RTN","RCBEPAYF",80,0)
 .   .   .   ;  if there is a repayment amount, pay the repayment amount
"RTN","RCBEPAYF",81,0)
 .   .   .   ;  do not allow payment to exceed amount paid
"RTN","RCBEPAYF",82,0)
 .   .   .   S PAYMENT=RCPAYAMT
"RTN","RCBEPAYF",83,0)
 .   .   .   I PAYMENT>RCBILBAL S PAYMENT=RCBILBAL
"RTN","RCBEPAYF",84,0)
 .   .   .   I RCREPAMT S PAYMENT=RCREPAMT I PAYMENT>RCBILBAL S PAYMENT=RCBILBAL
"RTN","RCBEPAYF",85,0)
 .   .   .   I PAYMENT>RCPAYAMT S PAYMENT=RCPAYAMT
"RTN","RCBEPAYF",86,0)
 .   .   .   ;
"RTN","RCBEPAYF",87,0)
 .   .   .   ;  apply payment to bill
"RTN","RCBEPAYF",88,0)
 .   .   .   ;  return error if problem adding payment transaction
"RTN","RCBEPAYF",89,0)
 .   .   .   S RCTRANDA=$$PAYTRAN^RCBEPAY1(RCBILLDA,PAYMENT,RCRECTDA,RCPAYDA,RCPAYDAT)
"RTN","RCBEPAYF",90,0)
 .   .   .   I 'RCTRANDA L -^PRCA(430,RCBILLDA) S RCERROR="1^"_$P(RCTRANDA,"^",2) Q
"RTN","RCBEPAYF",91,0)
 .   .   .   ;
"RTN","RCBEPAYF",92,0)
 .   .   .   ;  payment applied to bill, subtract off the payment amount
"RTN","RCBEPAYF",93,0)
 .   .   .   S RCPAYAMT=RCPAYAMT-$P($G(^PRCA(433,RCTRANDA,1)),"^",5)
"RTN","RCBEPAYF",94,0)
 .   .   .   ;
"RTN","RCBEPAYF",95,0)
 .   .   .   ;  set the amount processed on the receipt payment
"RTN","RCBEPAYF",96,0)
 .   .   .   D SETAMT^RCBEPAY(RCRECTDA,RCPAYDA,$P($G(^PRCA(433,RCTRANDA,1)),"^",5))
"RTN","RCBEPAYF",97,0)
 .   .   .   ;
"RTN","RCBEPAYF",98,0)
 .   .   .   ;  if Bill is Cross-Serviced, then create DECREASED ADJUSTMENT for 5B reporting
"RTN","RCBEPAYF",99,0)
 .   .   .   I $E($G(CSDEP),1,3)=168,$D(^PRCA(430,"TCSP",RCBILLDA)) D CS5B(RCBILLDA) ; BB prca*4.5*301
"RTN","RCBEPAYF",100,0)
 .   .   .   I $E($G(CSDEP),1,3)=170,RCBILLDA'=CSBILLDA,$D(^PRCA(430,"TCSP",RCBILLDA)) D CS5B(RCBILLDA) ; BB prca*4.5*301
"RTN","RCBEPAYF",101,0)
 .   .   .   ;
"RTN","RCBEPAYF",102,0)
 .   .   .   ;  get the new balance of the bill.  if it is zero
"RTN","RCBEPAYF",103,0)
 .   .   .   ;  remove it from the tmp global (this will stop the
"RTN","RCBEPAYF",104,0)
 .   .   .   ;  loop if dollars are left and no bills are active)
"RTN","RCBEPAYF",105,0)
 .   .   .   S X=$G(^PRCA(430,RCBILLDA,7))
"RTN","RCBEPAYF",106,0)
 .   .   .   S RCBILBAL=$P(X,"^")+$P(X,"^",2)+$P(X,"^",3)+$P(X,"^",4)+$P(X,"^",5)
"RTN","RCBEPAYF",107,0)
 .   .   .   I 'RCBILBAL D      ;PRCA*4.5*301
"RTN","RCBEPAYF",108,0)
 .   .   .   . D CHGSTAT^RCBEUBIL(RCBILLDA,22)
"RTN","RCBEPAYF",109,0)
 .   .   .   . K ^TMP("RCBEPAY",$J,RCDATE,RCBILLDA)
"RTN","RCBEPAYF",110,0)
 .   .   .   . I $D(^PRCA(430,"TCSP",RCBILLDA)),RCBILLDA=CSBILLDA S $P(^PRCA(430,RCBILLDA,15),"^")="" K ^PRCA(430,"TCSP",RCBILLDA)     ;S DA=RCBILLDA,DIE="^PRCA(430,",DR="151////@" D ^DIE K DIE,DA,DR
"RTN","RCBEPAYF",111,0)
 .   .   .   ;
"RTN","RCBEPAYF",112,0)
 .   .   .   L -^PRCA(430,RCBILLDA)
"RTN","RCBEPAYF",113,0)
 ;
"RTN","RCBEPAYF",114,0)
 K ^TMP("RCBEPAY",$J)
"RTN","RCBEPAYF",115,0)
 ;
"RTN","RCBEPAYF",116,0)
 ;  if an error occurred, quit
"RTN","RCBEPAYF",117,0)
 I RCERROR L -^RCD(340,RCDEBTDA) Q RCERROR
"RTN","RCBEPAYF",118,0)
 ;
"RTN","RCBEPAYF",119,0)
 ;  if no money left, quit
"RTN","RCBEPAYF",120,0)
 I 'RCPAYAMT L -^RCD(340,RCDEBTDA) Q 0
"RTN","RCBEPAYF",121,0)
 ;
"RTN","RCBEPAYF",122,0)
 ;  dollars remaining, create a prepayment
"RTN","RCBEPAYF",123,0)
 N %,%H,%I,%X,D,D0,DFN,DI,DIC,DICR,DIG,DIH,DIU,DIV,DIW,DQ,I,PRCA,RCREF,VA,VADM
"RTN","RCBEPAYF",124,0)
 D EN^PRCAPAY3(RCACCT,RCPAYAMT,RCPAYDAT,DUZ,$P(^RCY(344,RCRECTDA,0),"^"),"","",.RCERROR,"")
"RTN","RCBEPAYF",125,0)
 ;  no errors
"RTN","RCBEPAYF",126,0)
 I RCERROR=""!(RCERROR=0) D
"RTN","RCBEPAYF",127,0)
 .   S RCERROR=0
"RTN","RCBEPAYF",128,0)
 .   ;  set the amount processed on the receipt
"RTN","RCBEPAYF",129,0)
 .   D SETAMT^RCBEPAY(RCRECTDA,RCPAYDA,RCPAYAMT)
"RTN","RCBEPAYF",130,0)
 ;  error creating prepayment
"RTN","RCBEPAYF",131,0)
 I RCERROR'=0 S RCERROR="1^"_RCERROR
"RTN","RCBEPAYF",132,0)
 ;
"RTN","RCBEPAYF",133,0)
 L -^RCD(340,RCDEBTDA)
"RTN","RCBEPAYF",134,0)
 Q RCERROR
"RTN","RCBEPAYF",135,0)
 ;
"RTN","RCBEPAYF",136,0)
CS5B(RCBILLDA) ; logs DEC ADJ for 5B CS reporting if Cross-Serviced bill ; prca*4.5*301 ; LEG  
"RTN","RCBEPAYF",137,0)
 ; note: can use either I +$G(^PRCA(430,RCBILLDA,15)) D  ; bill is Cross-Serviced
"RTN","RCBEPAYF",138,0)
 I $D(^PRCA(430,"TCSP",RCBILLDA)) D  ; bill is Cross-Serviced
"RTN","RCBEPAYF",139,0)
 . ;  checks for valid bill
"RTN","RCBEPAYF",140,0)
 . S DIC="^PRCA(430,",DIC(0)="KMNZ",X=RCBILLDA D ^DIC
"RTN","RCBEPAYF",141,0)
 . ; checks if DEC ADJ record was previously logged
"RTN","RCBEPAYF",142,0)
 . S IDX=0,PREV=0
"RTN","RCBEPAYF",143,0)
 . F  S IDX=$O(^PRCA(430,RCBILLDA,17,IDX)) Q:'IDX  D  ;
"RTN","RCBEPAYF",144,0)
 . . I +$G(^PRCA(430,RCBILLDA,17,IDX,0))=RCTRANDA S PREV=1
"RTN","RCBEPAYF",145,0)
 . I PREV Q  ; transaction was already logged
"RTN","RCBEPAYF",146,0)
 . ;
"RTN","RCBEPAYF",147,0)
 . ;  gets next DEC ADJ subfile entry number or creates 1st
"RTN","RCBEPAYF",148,0)
 . K DR,DA,DD,DO,DIC,DIE
"RTN","RCBEPAYF",149,0)
 . S X=RCTRANDA       ; CS DECREASE ADJ TRANS NUMBER
"RTN","RCBEPAYF",150,0)
 . S DA(1)=RCBILLDA
"RTN","RCBEPAYF",151,0)
 . S DIC="^PRCA(430,"_DA(1)_",17,"
"RTN","RCBEPAYF",152,0)
 . S DIC(0)="KLMNZ"
"RTN","RCBEPAYF",153,0)
 . S DIC("P")=$P(^DD(430,171,0),"^",2)
"RTN","RCBEPAYF",154,0)
 . D ^DIC
"RTN","RCBEPAYF",155,0)
 . ;  set DEC ADJ Fields
"RTN","RCBEPAYF",156,0)
 . S DIE=DIC K DIC
"RTN","RCBEPAYF",157,0)
 . S DA=+Y
"RTN","RCBEPAYF",158,0)
 . S DR="1////1" ; SEND TCSP RECORD 5B
"RTN","RCBEPAYF",159,0)
 . S DIC("DR")=DR
"RTN","RCBEPAYF",160,0)
 . D ^DIE
"RTN","RCBEPAYF",161,0)
 Q
"RTN","RCBEUTR1")
0^53^B36268452
"RTN","RCBEUTR1",1,0)
RCBEUTR1 ;WISC/RFJ-add int,admin chg or increase,decrease principal  ;1 Jun 00
"RTN","RCBEUTR1",2,0)
 ;;4.5;Accounts Receivable;**153,169,192,226,270,276,301**;Mar 20, 1995;Build 144
"RTN","RCBEUTR1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCBEUTR1",4,0)
 Q
"RTN","RCBEUTR1",5,0)
 ;
"RTN","RCBEUTR1",6,0)
 ;
"RTN","RCBEUTR1",7,0)
INTADM(RCBILLDA,RCVALUE,RCCOMMNT,RCDATE) ;  add an intererst/admin charge (transaction type=13)
"RTN","RCBEUTR1",8,0)
 ;  for a bill.  rcvalue = interest ^ admin ^ penalty ^ marshal fee ^ court cost
"RTN","RCBEUTR1",9,0)
 ;  for the transaction.  rcdate = process date (optional)
"RTN","RCBEUTR1",10,0)
 ;  returns transaction number if successful
"RTN","RCBEUTR1",11,0)
 ;
"RTN","RCBEUTR1",12,0)
 N RCDRSTRG,RCTRANDA,Y
"RTN","RCBEUTR1",13,0)
 ;  add the transaction (if added to 433, transaction is locked)
"RTN","RCBEUTR1",14,0)
 S RCTRANDA=$$ADD433^RCBEUTRA(RCBILLDA,13) I 'RCTRANDA Q 0
"RTN","RCBEUTR1",15,0)
 ;
"RTN","RCBEUTR1",16,0)
 ;  build dr string
"RTN","RCBEUTR1",17,0)
 ;  transaction date (strip off time)
"RTN","RCBEUTR1",18,0)
 S RCDRSTRG="11////"_$S($G(RCDATE):$P(RCDATE,"."),1:DT)_";"
"RTN","RCBEUTR1",19,0)
 ;
"RTN","RCBEUTR1",20,0)
 ;  transaction values
"RTN","RCBEUTR1",21,0)
 S RCDRSTRG=RCDRSTRG_"15////"_($P(RCVALUE,"^")+$P(RCVALUE,"^",2)+$P(RCVALUE,"^",3)+$P(RCVALUE,"^",4)+$P(RCVALUE,"^",5))_";"
"RTN","RCBEUTR1",22,0)
 I $P(RCVALUE,"^",4) S RCDRSTRG=RCDRSTRG_"25////"_$P(RCVALUE,"^",4)_";"  ;marshal fee
"RTN","RCBEUTR1",23,0)
 I $P(RCVALUE,"^",5) S RCDRSTRG=RCDRSTRG_"26////"_$P(RCVALUE,"^",5)_";"  ;court cost
"RTN","RCBEUTR1",24,0)
 I $P(RCVALUE,"^",1) S RCDRSTRG=RCDRSTRG_"27////"_$P(RCVALUE,"^",1)_";"  ;interest
"RTN","RCBEUTR1",25,0)
 I $P(RCVALUE,"^",2) S RCDRSTRG=RCDRSTRG_"28////"_$P(RCVALUE,"^",2)_";"  ;admin
"RTN","RCBEUTR1",26,0)
 I $P(RCVALUE,"^",3) S RCDRSTRG=RCDRSTRG_"29////"_$P(RCVALUE,"^",3)_";"  ;penalty
"RTN","RCBEUTR1",27,0)
 I $G(RCDATE) S RCDRSTRG=RCDRSTRG_"19////"_RCDATE_";"  ;date entered
"RTN","RCBEUTR1",28,0)
 ;
"RTN","RCBEUTR1",29,0)
 ;  input the fields for the transaction
"RTN","RCBEUTR1",30,0)
 S Y=$$EDIT433^RCBEUTRA(RCTRANDA,RCDRSTRG) I 'Y L -^PRCA(433,RCTRANDA) Q 0
"RTN","RCBEUTR1",31,0)
 ;
"RTN","RCBEUTR1",32,0)
 ;  set the comment
"RTN","RCBEUTR1",33,0)
 I $D(RCCOMMNT(1)) D ADDCOMM^RCBEUTRA(RCTRANDA,.RCCOMMNT)
"RTN","RCBEUTR1",34,0)
 ;
"RTN","RCBEUTR1",35,0)
 ;  move over 433 from 430 (no principal, just move it)
"RTN","RCBEUTR1",36,0)
 D FY433^RCBEUTRA(RCTRANDA)
"RTN","RCBEUTR1",37,0)
 ;
"RTN","RCBEUTR1",38,0)
 ;  mark transaction as processed
"RTN","RCBEUTR1",39,0)
 D PROCESS^RCBEUTRA(RCTRANDA)
"RTN","RCBEUTR1",40,0)
 ;
"RTN","RCBEUTR1",41,0)
 ;  update the bill file with the balance of the transaction
"RTN","RCBEUTR1",42,0)
 D SETBAL^RCBEUBIL(RCTRANDA)
"RTN","RCBEUTR1",43,0)
 ;
"RTN","RCBEUTR1",44,0)
 ;  if the bill has no balance, close or cancel it
"RTN","RCBEUTR1",45,0)
 D CLOSEIT(RCBILLDA)
"RTN","RCBEUTR1",46,0)
 ;
"RTN","RCBEUTR1",47,0)
 ;  clear the lock and return the transaction added
"RTN","RCBEUTR1",48,0)
 L -^PRCA(433,RCTRANDA)
"RTN","RCBEUTR1",49,0)
 Q RCTRANDA
"RTN","RCBEUTR1",50,0)
 ;
"RTN","RCBEUTR1",51,0)
 ; PRCA*4.5*270 add CRD flag so FMS knows this is a corrected record
"RTN","RCBEUTR1",52,0)
 ; INCDEC(RCBILLDA,RCVALUE,RCCOMMNT,RCDATE,RCPREPAY,RCONTADJ) ;  automatically
"RTN","RCBEUTR1",53,0)
INCDEC(RCBILLDA,RCVALUE,RCCOMMNT,RCDATE,RCPREPAY,RCONTADJ,RCCRD) ;
"RTN","RCBEUTR1",54,0)
 ;  automatically create an increase or decrease adjustment for a bill
"RTN","RCBEUTR1",55,0)
 ;  pass variables:
"RTN","RCBEUTR1",56,0)
 ;      rcvalue  = principal value for the transaction.
"RTN","RCBEUTR1",57,0)
 ;                 if rcvalue is less than zero, it will create a
"RTN","RCBEUTR1",58,0)
 ;                 decrease adjustment.  if rcvalue is greater than
"RTN","RCBEUTR1",59,0)
 ;                 zero, it will create an increase adjustment.
"RTN","RCBEUTR1",60,0)
 ;      rccommnt = the comments for the word processing field.
"RTN","RCBEUTR1",61,0)
 ;      rcdate   = optional processing date and time.  if not
"RTN","RCBEUTR1",62,0)
 ;                 passed, the current date and time will be used
"RTN","RCBEUTR1",63,0)
 ;      rcprepay = optional prepayment transaction.  this is the
"RTN","RCBEUTR1",64,0)
 ;                 payment transaction applied to the bill to
"RTN","RCBEUTR1",65,0)
 ;                 create the decrease adjustment.  this gets
"RTN","RCBEUTR1",66,0)
 ;                 stored in field 20 (file 433).
"RTN","RCBEUTR1",67,0)
 ;      rcontadj = optional contract adjustment.  if 1 then this
"RTN","RCBEUTR1",68,0)
 ;                 gets stored in field 88 (file 433).
"RTN","RCBEUTR1",69,0)
 ;      rccrd    = optional corrected flag.  If 1, then FMS must 1st cancel or delete the
"RTN","RCBEUTR1",70,0)
 ;                 original billing document before creating the new one.
"RTN","RCBEUTR1",71,0)
 ;
"RTN","RCBEUTR1",72,0)
 ;  returns transaction number added to 433 if successful.
"RTN","RCBEUTR1",73,0)
 ;
"RTN","RCBEUTR1",74,0)
 N ADJNUMB,RCDRSTRG,RCTRANDA,X,Y,RCNEG
"RTN","RCBEUTR1",75,0)
 ;
"RTN","RCBEUTR1",76,0)
 ;  add the transaction (if added to 433, transaction is locked)
"RTN","RCBEUTR1",77,0)
 S RCTRANDA=$$ADD433^RCBEUTRA(RCBILLDA,$S(RCVALUE>0:1,1:35)) I 'RCTRANDA Q 0
"RTN","RCBEUTR1",78,0)
 ;
"RTN","RCBEUTR1",79,0)
 ;  build dr string
"RTN","RCBEUTR1",80,0)
 ;  11=transaction date (strip off time)
"RTN","RCBEUTR1",81,0)
 S RCDRSTRG="11////"_$S($G(RCDATE):$P(RCDATE,"."),1:DT)_";"
"RTN","RCBEUTR1",82,0)
 ;  transaction value (make sure it is not negative)
"RTN","RCBEUTR1",83,0)
 I RCVALUE<0 S RCVALUE=-RCVALUE
"RTN","RCBEUTR1",84,0)
 S RCDRSTRG=RCDRSTRG_"15////"_RCVALUE_";"
"RTN","RCBEUTR1",85,0)
 S RCDRSTRG=RCDRSTRG_"81////"_RCVALUE_";"
"RTN","RCBEUTR1",86,0)
 I $G(RCBETYPE)="DECREASE" S RCDRSTRG=RCDRSTRG_"31////"_RCVALUE_";"    ;PRCA*4.5*301
"RTN","RCBEUTR1",87,0)
 ;
"RTN","RCBEUTR1",88,0)
 ;  get the next adjustment number if increase(1) or decrease(35)
"RTN","RCBEUTR1",89,0)
 ;  start with the last transaction and work backwards
"RTN","RCBEUTR1",90,0)
 S X=999999999999,ADJNUMB=1
"RTN","RCBEUTR1",91,0)
 F  S X=$O(^PRCA(433,"C",RCBILLDA,X),-1) Q:'X  I $P($G(^PRCA(433,X,1)),"^",4) I $P(^(1),"^",2)=1!($P(^(1),"^",2)=35) S ADJNUMB=$P(^(1),"^",4)+1 Q
"RTN","RCBEUTR1",92,0)
 S RCDRSTRG=RCDRSTRG_"14////"_ADJNUMB_";"
"RTN","RCBEUTR1",93,0)
 ;
"RTN","RCBEUTR1",94,0)
 ;  date entered
"RTN","RCBEUTR1",95,0)
 I $G(RCDATE) S RCDRSTRG=RCDRSTRG_"19////"_RCDATE_";"
"RTN","RCBEUTR1",96,0)
 ;
"RTN","RCBEUTR1",97,0)
 ;  store the prepayment transaction
"RTN","RCBEUTR1",98,0)
 I $G(RCPREPAY) D
"RTN","RCBEUTR1",99,0)
 .   S RCDRSTRG=RCDRSTRG_"20////"_RCPREPAY_";"
"RTN","RCBEUTR1",100,0)
 .   ;  for prepayments, set the incomplete transaction flag
"RTN","RCBEUTR1",101,0)
 .   ;  this will no longer be used after patch 146 and can
"RTN","RCBEUTR1",102,0)
 .   ;  be removed
"RTN","RCBEUTR1",103,0)
 .   S RCDRSTRG=RCDRSTRG_"10////1;"
"RTN","RCBEUTR1",104,0)
 ;
"RTN","RCBEUTR1",105,0)
 ;  contract adjustment
"RTN","RCBEUTR1",106,0)
 I $G(RCONTADJ) S RCDRSTRG=RCDRSTRG_"88///1;"
"RTN","RCBEUTR1",107,0)
 ;
"RTN","RCBEUTR1",108,0)
 ;  input the fields for the transaction
"RTN","RCBEUTR1",109,0)
 S Y=$$EDIT433^RCBEUTRA(RCTRANDA,RCDRSTRG) I 'Y L -^PRCA(433,RCTRANDA) Q 0
"RTN","RCBEUTR1",110,0)
 ;
"RTN","RCBEUTR1",111,0)
 ;  set the comment
"RTN","RCBEUTR1",112,0)
 I $D(RCCOMMNT(1)) D ADDCOMM^RCBEUTRA(RCTRANDA,.RCCOMMNT)
"RTN","RCBEUTR1",113,0)
 ;
"RTN","RCBEUTR1",114,0)
 ;  mark the transaction processed
"RTN","RCBEUTR1",115,0)
 D PROCESS^RCBEUTRA(RCTRANDA)
"RTN","RCBEUTR1",116,0)
 ;
"RTN","RCBEUTR1",117,0)
 ;  update the fiscal year multiple (must be done after marked as
"RTN","RCBEUTR1",118,0)
 ;  processed so the value is defined)
"RTN","RCBEUTR1",119,0)
 D FYMULT^RCBEUTRA(RCTRANDA)
"RTN","RCBEUTR1",120,0)
 ;
"RTN","RCBEUTR1",121,0)
 ;  update the bill file with the balance of the transaction
"RTN","RCBEUTR1",122,0)
 ; PRCA276 - add exception condition - needs to quit receipt processing when negative claim balance could result
"RTN","RCBEUTR1",123,0)
 S RCNEG=0 D SETBAL^RCBEUBIL(RCTRANDA,.RCNEG) I RCNEG D DEL433^RCBEUTRA(RCTRANDA,"CANCELLED WORKLIST DEC ADJ TO PREVENT NEG PRIN BAL",1) L -^PRCA(433,RCTRANDA) Q "0^1"
"RTN","RCBEUTR1",124,0)
 ;
"RTN","RCBEUTR1",125,0)
 ;  if the bill has no balance, close or cancel it
"RTN","RCBEUTR1",126,0)
 D CLOSEIT(RCBILLDA)
"RTN","RCBEUTR1",127,0)
 ;
"RTN","RCBEUTR1",128,0)
 ;  send FMS document if non-accrued (redo this later on)
"RTN","RCBEUTR1",129,0)
 I '$$ACCK^PRCAACC(RCBILLDA) D
"RTN","RCBEUTR1",130,0)
 .   N D0,DA,DI,DIC,DIE,DIQ2,DQ,DR,ENT,FMSNUM,GECSDATA
"RTN","RCBEUTR1",131,0)
 .   N CATEG,DATA1,ERR
"RTN","RCBEUTR1",132,0)
 .   S CATEG=$P($G(^PRCA(430,RCBILLDA,0)),"^",2)
"RTN","RCBEUTR1",133,0)
 .   ;
"RTN","RCBEUTR1",134,0)
 .   ;  category=29 champva, do not send to fms, quit
"RTN","RCBEUTR1",135,0)
 .   I CATEG=29 Q
"RTN","RCBEUTR1",136,0)
 .   ;
"RTN","RCBEUTR1",137,0)
 .   ;  category=30 tricare or 32 tricare third party, and contract adj
"RTN","RCBEUTR1",138,0)
 .   I (CATEG=30!(CATEG=32)),$P($G(^PRCA(433,RCTRANDA,8)),"^",8) D  Q
"RTN","RCBEUTR1",139,0)
 .   .   S DATA1=$G(^PRCA(433,RCTRANDA,1))
"RTN","RCBEUTR1",140,0)
 .   .   D EN^PRCAFWO(RCBILLDA,$P(DATA1,"^",1),$P(DATA1,"^",5),$$SITE^RCMSITE,RCTRANDA)
"RTN","RCBEUTR1",141,0)
 .   ;
"RTN","RCBEUTR1",142,0)
 .   ;  all other categories
"RTN","RCBEUTR1",143,0)
 .   ;  pass trans amount(1;5),trans type(1;2),trans date(1;1)
"RTN","RCBEUTR1",144,0)
 .   S DATA1=$G(^PRCA(433,RCTRANDA,1))
"RTN","RCBEUTR1",145,0)
 .   ;
"RTN","RCBEUTR1",146,0)
 .   ; PRCA*4.5*270 - pass CRD flag to FMS
"RTN","RCBEUTR1",147,0)
 .   D EN^PRCAFBDM(RCBILLDA,$P(DATA1,"^",5),$P(DATA1,"^",2),$P(DATA1,"^",1),RCTRANDA,.ERR,$G(RCCRD))
"RTN","RCBEUTR1",148,0)
 ;
"RTN","RCBEUTR1",149,0)
 ;  clear the lock and return the transaction added
"RTN","RCBEUTR1",150,0)
 L -^PRCA(433,RCTRANDA)
"RTN","RCBEUTR1",151,0)
 Q RCTRANDA
"RTN","RCBEUTR1",152,0)
 ;
"RTN","RCBEUTR1",153,0)
 ;
"RTN","RCBEUTR1",154,0)
CLOSEIT(RCBILLDA) ;  check to cancel or close bill with no balance
"RTN","RCBEUTR1",155,0)
 N AMTPAID,BILLBAL,DATA7,TRANDA
"RTN","RCBEUTR1",156,0)
 ;  if the bill has no balance, close or cancel it
"RTN","RCBEUTR1",157,0)
 S DATA7=$G(^PRCA(430,RCBILLDA,7))
"RTN","RCBEUTR1",158,0)
 S BILLBAL=$P(DATA7,"^")+$P(DATA7,"^",2)+$P(DATA7,"^",3)+$P(DATA7,"^",4)+$P(DATA7,"^",5)
"RTN","RCBEUTR1",159,0)
 I 'BILLBAL D
"RTN","RCBEUTR1",160,0)
 .   ;  get payments recorded against the bill.  if payments have been
"RTN","RCBEUTR1",161,0)
 .   ;  made, then the status of the bill should be collected/closed.
"RTN","RCBEUTR1",162,0)
 .   S AMTPAID=$P(DATA7,"^",7)+$P(DATA7,"^",8)+$P(DATA7,"^",9)+$P(DATA7,"^",10)+$P(DATA7,"^",11)
"RTN","RCBEUTR1",163,0)
 .   I AMTPAID D CHGSTAT^RCBEUBIL(RCBILLDA,22) Q
"RTN","RCBEUTR1",164,0)
 .   ;  if the last transaction was a decrease contract adjustment,
"RTN","RCBEUTR1",165,0)
 .   ;  then the status will be collected/closed
"RTN","RCBEUTR1",166,0)
 .   S TRANDA=+$O(^PRCA(433,"C",RCBILLDA,999999999999),-1)
"RTN","RCBEUTR1",167,0)
 .   I $P($G(^PRCA(433,TRANDA,8)),"^",8) D CHGSTAT^RCBEUBIL(RCBILLDA,22) Q
"RTN","RCBEUTR1",168,0)
 .   ;  otherwise it should be cancellation
"RTN","RCBEUTR1",169,0)
 .   D CHGSTAT^RCBEUBIL(RCBILLDA,39)
"RTN","RCBEUTR1",170,0)
 Q
"RTN","RCCPCPS")
0^20^B80898915
"RTN","RCCPCPS",1,0)
RCCPCPS ;WASH-ISC@ALTOONA,PA/NYB-Build Patient Statement File ;12/19/96  4:14 PM
"RTN","RCCPCPS",2,0)
V ;;4.5;Accounts Receivable;**34,70,80,48,104,116,149,170,181,190,223,237,219,265,301**;Mar 20,1995;Build 144
"RTN","RCCPCPS",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCCPCPS",4,0)
EN N CCPC,CNT,DAT,DEB,DIK,END,INADFL,LDT1,LDT3,PCC,PRN,RCDATE,RCT,SVADM,SVAMT,SVINT,SVOTH,SITE,TXT,VAR,X,%
"RTN","RCCPCPS",5,0)
 N RCINFULL,RCINPART S COMM=0
"RTN","RCCPCPS",6,0)
 K ^RCPS(349.2)
"RTN","RCCPCPS",7,0)
 F X="PA","IS" S RCT=$O(^RCT(349.1,"B",X,0)) Q:'RCT  K ^RCT(349.1,+RCT,4),^RCT(349.1,+RCT,5)
"RTN","RCCPCPS",8,0)
 K ^XTMP("RCCPC")
"RTN","RCCPCPS",9,0)
 D DT^DICRW,SITE^PRCAGU
"RTN","RCCPCPS",10,0)
 I '$D(SITE) W !!,"AR SITE PARAMETER ENTRIES NOT DEFINED!",?50 D NOW^%DTC S Y=% D DD^%DT W Y W !!,"COULD NOT PROCESS AR PATIENT STATEMENTS" Q
"RTN","RCCPCPS",11,0)
 D NOW^%DTC S END=%
"RTN","RCCPCPS",12,0)
 S LDT1=$$FPS^RCAMFN01(DT,-1),RCDATE=DT
"RTN","RCCPCPS",13,0)
 S (CNT,DEB)=0,PRN=1
"RTN","RCCPCPS",14,0)
 F  S DEB=$O(^RCD(340,"AB","DPT(",DEB)) Q:DEB=""  D
"RTN","RCCPCPS",15,0)
 .   N AMT,BBAL,BEG,BN,CAT,DESC,ETY,FC,ND,PAT,PBAL,PC
"RTN","RCCPCPS",16,0)
 .   N PDAT,PEND,ST,SVINT,SVADM,SVOTH,ADDR
"RTN","RCCPCPS",17,0)
 .   I $L(+$$SSN^RCFN01(DEB))<5 Q
"RTN","RCCPCPS",18,0)
 .   ;Check for Emergency Response Indicator (ERI) Flag.
"RTN","RCCPCPS",19,0)
 .   N RCDFN S RCDFN=$P($G(^RCD(340,DEB,0)),"^",1) I $$EMERES^PRCAUTL(+RCDFN)]"" Q
"RTN","RCCPCPS",20,0)
 .   ; initialize variables for CS
"RTN","RCCPCPS",21,0)
 .   N CSBB,CSTCH,CSTPC,CSPREV S (CSBB,CSTCH,CSTPC)=0
"RTN","RCCPCPS",22,0)
 .   S INADFL=0
"RTN","RCCPCPS",23,0)
 .   S (SVADM,SVAMT,SVINT,SVOTH)=0
"RTN","RCCPCPS",24,0)
 .   N REF,SBAL,SDT,TBAL,TN,TTY,X,Y
"RTN","RCCPCPS",25,0)
 .   K ^TMP("PRCAGT",$J)
"RTN","RCCPCPS",26,0)
 .   S BEG=+$$LST^RCFN01(DEB,2)
"RTN","RCCPCPS",27,0)
 .   S LDT3=$S(BEG>0:$$FPS^RCAMFN01($P(BEG,"."),-3),1:0)
"RTN","RCCPCPS",28,0)
 .   I $P(BEG,".")'<$P(RCDATE,".") Q
"RTN","RCCPCPS",29,0)
 .   D NOW^%DTC S END=%
"RTN","RCCPCPS",30,0)
 .   I BEG<1 S PDAT="",BEG=0,PBAL=0
"RTN","RCCPCPS",31,0)
 .   I BEG S PDAT=BEG,BEG=9999999.999999-BEG,PBAL=0 D PBAL^PRCAGU(DEB,.BEG,.PBAL) ;get prev bal
"RTN","RCCPCPS",32,0)
 .   D EN^PRCAGT(DEB,BEG,.END)
"RTN","RCCPCPS",33,0)
 .   S TBAL=0 D TBAL^PRCAGT(DEB,.TBAL) ;get trans bal
"RTN","RCCPCPS",34,0)
 .   S BBAL=0 D BBAL^PRCAGU(DEB,.BBAL) ;get bill bal
"RTN","RCCPCPS",35,0)
 .   I CSBB,CSBB'<BBAL Q  ; entire account has been referred to CS
"RTN","RCCPCPS",36,0)
 .   S X=$$PRE^PRCAGU(DEB) S PEND=$P(X,U,2),X=+X I X,BBAL D REF^PRCAGD(DEB,X,$G(REP)) Q
"RTN","RCCPCPS",37,0)
 .   I BBAL=0,PEND,-PEND=PBAL+TBAL Q
"RTN","RCCPCPS",38,0)
 .   I BBAL'=(PBAL+TBAL) D EN^PRCAGD(DEB,BBAL,TBAL,PBAL,BEG,$G(REP)) Q
"RTN","RCCPCPS",39,0)
 .   I BBAL'>0,'$D(^TMP("PRCAGT",$J,DEB)) Q
"RTN","RCCPCPS",40,0)
 .   I BBAL=0,$G(SITE("ZERO")) Q
"RTN","RCCPCPS",41,0)
 .   I BBAL<0,BBAL>-.99 Q
"RTN","RCCPCPS",42,0)
 .   I BBAL'<0,'$D(^XTMP("PRCAGU",$J,DEB)),'COMM Q  ;third letter printed,not comment
"RTN","RCCPCPS",43,0)
 .   S TBAL=TBAL+PBAL
"RTN","RCCPCPS",44,0)
 .   ;adjust amounts to be filed in 349.2 for CS bills
"RTN","RCCPCPS",45,0)
 .   S TBAL=TBAL-CSBB ; reduce the total bill balance by CS balance
"RTN","RCCPCPS",46,0)
 .   S CSPREV=CSBB-(CSTCH+CSTPC) ; compute the CS previous balance as the difference between the bill balance and the transaction balance
"RTN","RCCPCPS",47,0)
 .   S PBAL=PBAL-CSPREV ; reduce the previous balance by the CS previous balance
"RTN","RCCPCPS",48,0)
 .   S TBAL("CH")=TBAL("CH")-CSTCH ; reduce total charges by CS charges
"RTN","RCCPCPS",49,0)
 .   S TBAL("PC")=TBAL("PC")-CSTPC ; reduce total credits by CS credits
"RTN","RCCPCPS",50,0)
 .   I '$D(^RCPS(349.2,0)) S ^(0)="AR CCPC STATEMENTS RECORDS^349.2I^"
"RTN","RCCPCPS",51,0)
 .   S ^RCPS(349.2,DEB,0)=DEB_"^"_$$SSN^RCFN01(DEB)_"^"
"RTN","RCCPCPS",52,0)
 .   S ADDR=$$DADD^RCAMADD(DEB,1) ;get patient's address, confidential if applicable
"RTN","RCCPCPS",53,0)
 .   S ^RCPS(349.2,DEB,1)=$P(ADDR,"^",1,6)
"RTN","RCCPCPS",54,0)
 .   S ST=$P(ADDR,"^",5)
"RTN","RCCPCPS",55,0)
 .   S ^RCPS(349.2,DEB,7)=$P(^RCD(340,DEB,0),U,7) ;large print
"RTN","RCCPCPS",56,0)
 .   I $G(ST)'="" S ST=$O(^DIC(5,"C",ST,0))
"RTN","RCCPCPS",57,0)
 .   I $G(ST)>90,'$P($G(^DIC(5,ST,0)),"^",6) S FC=$P($G(^DIC(5,ST,0)),"^")
"RTN","RCCPCPS",58,0)
 .   S $P(^RCPS(349.2,DEB,1),"^",7)=$G(FC) S:$G(FC)]"" $P(^RCPS(349.2,DEB,1),"^",5)="FX"
"RTN","RCCPCPS",59,0)
 .   S:$G(FC)]"" $P(^RCPS(349.2,DEB,1),"^",6)=$P(ADDR,"^",8)
"RTN","RCCPCPS",60,0)
 .   D NOW^%DTC S $P(^RCPS(349.2,DEB,0),"^",10)=%
"RTN","RCCPCPS",61,0)
 .   S $P(^RCPS(349.2,DEB,0),"^",3)=$$NAM^RCFN01(DEB)
"RTN","RCCPCPS",62,0)
 .   S $P(^RCPS(349.2,DEB,0),"^",4,7)=$S(TBAL'>0:0,1:TBAL)_"^"_PBAL_"^"_TBAL("CH")_"^"_TBAL("PC"),$P(^(0),"^",8)=PBAL+TBAL("CH")+TBAL("PC")+TBAL("RF")
"RTN","RCCPCPS",63,0)
 .   S $P(^RCPS(349.2,DEB,0),"^",13,17)=BBAL("PB")_"^"_BBAL("INT")_"^"_BBAL("ADM")_"^"_BBAL("MF")_"^"_BBAL("CT")
"RTN","RCCPCPS",64,0)
 .   ;
"RTN","RCCPCPS",65,0)
 .   N RCBILLDA,RCDATA1,RCDEBTDA,RCDESC,RCPSDA,RCTOTAL,RCTRANDA,RCTRDATE,VALUE,RCCOM1,RCCOM2,RCCOM3
"RTN","RCCPCPS",66,0)
 .   S RCDEBTDA=DEB
"RTN","RCCPCPS",67,0)
 .   I '$D(^RCPS(349.2,RCDEBTDA,2,0)) S ^(0)="^349.21DA^^"
"RTN","RCCPCPS",68,0)
 .   ;
"RTN","RCCPCPS",69,0)
 .   S RCCOM1=$E($TR($G(SITE("COM1")),"~|^",""),1,80),(RCCOM2,RCCOM3)=""
"RTN","RCCPCPS",70,0)
 .   ; Add second comment line for the GMT-reduced status
"RTN","RCCPCPS",71,0)
 .   I $$GMT^PRCAGST(RCDEBTDA) S RCCOM2="REDUCTION OF INPATIENT COPAYMENT DUE TO GEOGRAPHIC MEANS TEST STATUS"
"RTN","RCCPCPS",72,0)
 .   I TBAL'>0 S RCCOM3=" *THIS IS NOT A BILL*"
"RTN","RCCPCPS",73,0)
 .   I RCCOM1'="",RCCOM2'="" S $E(RCCOM1,80)=" " ;Make sure GMT message will be printed on separate line.
"RTN","RCCPCPS",74,0)
 .   S ^RCPS(349.2,RCDEBTDA,3)=RCCOM1_RCCOM2_RCCOM3
"RTN","RCCPCPS",75,0)
 .   ;
"RTN","RCCPCPS",76,0)
 .   S RCPSDA=0 ; this variable used to set the description on the PS segment
"RTN","RCCPCPS",77,0)
 .   S RCTRDATE=0 F  S RCTRDATE=$O(^TMP("PRCAGT",$J,RCDEBTDA,RCTRDATE)) Q:'RCTRDATE  S RCBILLDA=0 F  S RCBILLDA=$O(^TMP("PRCAGT",$J,RCDEBTDA,RCTRDATE,RCBILLDA)) Q:'RCBILLDA  D
"RTN","RCCPCPS",78,0)
 .   .   Q:$D(^PRCA(430,"TCSP",RCBILLDA))  ; skip CS bills/transactions
"RTN","RCCPCPS",79,0)
 .   .   I $P($G(^RCPS(349.2,RCDEBTDA,0)),"^",8)<0 S PC(75)=75
"RTN","RCCPCPS",80,0)
 .   .   I $P($G(^PRCA(430,RCBILLDA,6)),"^",2)]"",($P($G(^PRCA(430,RCBILLDA,7)),"^")>0) S PC(1)="01"
"RTN","RCCPCPS",81,0)
 .   .   S CAT=$P($G(^PRCA(430,RCBILLDA,0)),"^",2)
"RTN","RCCPCPS",82,0)
 .   .   S PC=$P($G(^PRCA(430.2,CAT,0)),"^",14)
"RTN","RCCPCPS",83,0)
 .   .   F X=1:1:100 I $P(PC,",",X)'="" S PCC=$P(PC,",",X),PC(+PCC)=PCC Q:PCC=""
"RTN","RCCPCPS",84,0)
 .   .   S PC="",X=0 F  S X=$O(PC(X)) Q:X=""  I $G(PC(X))'="" S PC=PC_PC(X)
"RTN","RCCPCPS",85,0)
 .   .   S $P(^RCPS(349.2,RCDEBTDA,4),"^")=PC
"RTN","RCCPCPS",86,0)
 .   .   ;
"RTN","RCCPCPS",87,0)
 .   .   I $D(^TMP("PRCAGT",$J,RCDEBTDA,RCTRDATE,RCBILLDA,0)) S AMT=+^(0) I AMT D
"RTN","RCCPCPS",88,0)
 .   .   .   ;  get the description for the bill
"RTN","RCCPCPS",89,0)
 .   .   .   K RCDESC D BILLDESC^RCCPCPS1(RCBILLDA)
"RTN","RCCPCPS",90,0)
 .   .   .   ;
"RTN","RCCPCPS",91,0)
 .   .   .   ;  store the description in file 349.2, PS segment
"RTN","RCCPCPS",92,0)
 .   .   .   S RCPSDA=RCPSDA+1
"RTN","RCCPCPS",93,0)
 .   .   .   S $P(^RCPS(349.2,RCDEBTDA,2,RCPSDA,0),"^",1,4)=$P(RCTRDATE,".")_"^"_$G(RCDESC(1))_"^"_$G(AMT)_"^"_$P(^PRCA(430,RCBILLDA,0),"^")
"RTN","RCCPCPS",94,0)
 .   .   .   F X=2:1 Q:$G(RCDESC(X))=""  S RCPSDA=RCPSDA+1,^RCPS(349.2,RCDEBTDA,2,RCPSDA,0)="^"_RCDESC(X)_"^^"
"RTN","RCCPCPS",95,0)
 .   .   ;
"RTN","RCCPCPS",96,0)
 .   .   S RCTRANDA=0 F  S RCTRANDA=$O(^TMP("PRCAGT",$J,RCDEBTDA,RCTRDATE,RCBILLDA,RCTRANDA)) D:'RCTRANDA NO Q:'RCTRANDA  D
"RTN","RCCPCPS",97,0)
 .   .   .   ;  get the description for the transaction
"RTN","RCCPCPS",98,0)
 .   .   .   K RCDESC D TRANDESC^RCCPCPS1(RCTRANDA),RCDESC
"RTN","RCCPCPS",99,0)
 .   .   .   ;  if it is an interest/admin charge, summarize it below
"RTN","RCCPCPS",100,0)
 .   .   .   I $G(RCDESC(1))["INTEREST" Q
"RTN","RCCPCPS",101,0)
 .   .   .   ;  get the value of the transaction for the statement
"RTN","RCCPCPS",102,0)
 .   .   .   S VALUE=$$TRANVALU^RCDPBTLM(RCTRANDA)
"RTN","RCCPCPS",103,0)
 .   .   .   S VALUE=$P(VALUE,"^",2)+$P(VALUE,"^",3)+$P(VALUE,"^",4)+$P(VALUE,"^",5)+$P(VALUE,"^",6)
"RTN","RCCPCPS",104,0)
 .   .   .   ;  if it is a suspended (47) or unsuspended (46) transaction, show value
"RTN","RCCPCPS",105,0)
 .   .   .   ;  make suspended charges appear as negative
"RTN","RCCPCPS",106,0)
 .   .   .   S RCDATA1=$G(^PRCA(433,RCTRANDA,1))
"RTN","RCCPCPS",107,0)
 .   .   .   I $P(RCDATA1,"^",2)=47!($P(RCDATA1,"^",2)=46) S VALUE=$P(RCDATA1,"^",5) I $P(RCDATA1,"^",2)=47 S VALUE=-VALUE
"RTN","RCCPCPS",108,0)
 .   .   .   ;  if it is an amended bill, show value
"RTN","RCCPCPS",109,0)
 .   .   .   I $P(RCDATA1,"^",2)=33 S VALUE=$P(RCDATA1,"^",5)
"RTN","RCCPCPS",110,0)
 .   .   .   ;  store the description in file 349.2, PS segment
"RTN","RCCPCPS",111,0)
 .   .   .   S RCPSDA=RCPSDA+1
"RTN","RCCPCPS",112,0)
 .   .   .   S $P(^RCPS(349.2,RCDEBTDA,2,RCPSDA,0),"^",1,5)=$P(RCTRDATE,".")_"^"_$G(RCDESC(1))_"^"_VALUE_"^"_$P(^PRCA(430,RCBILLDA,0),"^")
"RTN","RCCPCPS",113,0)
 .   .   .   F X=2:1 Q:$G(RCDESC(X))=""  S RCPSDA=RCPSDA+1,^RCPS(349.2,RCDEBTDA,2,RCPSDA,0)="^"_RCDESC(X)_"^^"
"RTN","RCCPCPS",114,0)
 .   .   .   ;
"RTN","RCCPCPS",115,0)
 .   .   .   ;  for comment transaction ... not sure what this is for ?
"RTN","RCCPCPS",116,0)
 .   .   .   I $P(RCDATA1,"^",2)=45,$P($G(^PRCA(433,RCTRANDA,5)),"^",2)["your waiver rights" S ^RCPS(349.2,+RCDEBTDA,4)="0150"
"RTN","RCCPCPS",117,0)
 .   ;
"RTN","RCCPCPS",118,0)
 .   ;  if interest, admin, or other, add them here
"RTN","RCCPCPS",119,0)
 .   S X=$G(RCTOTAL("INT"))+$G(RCTOTAL("ADM"))+$G(RCTOTAL("OTH"))
"RTN","RCCPCPS",120,0)
 .   I X>0 D
"RTN","RCCPCPS",121,0)
 .   .   S RCDESC="INTEREST/ADM. CHARGE (Int:"_$J($G(RCTOTAL("INT")),1,2)_" Adm:"_$J($G(RCTOTAL("ADM")),1,2)_" Other:"_$J($G(RCTOTAL("OTH")),1,2)_")"
"RTN","RCCPCPS",122,0)
 .   .   S RCPSDA=RCPSDA+1
"RTN","RCCPCPS",123,0)
 .   .   S ^RCPS(349.2,RCDEBTDA,2,RCPSDA,0)="^"_RCDESC_"^"_$J(X,1,2)
"RTN","RCCPCPS",124,0)
 .   .   S ^RCPS(349.2,RCDEBTDA,2,0)="^349.21DA^"_RCPSDA_"^"_RCPSDA
"RTN","RCCPCPS",125,0)
 .   ;
"RTN","RCCPCPS",126,0)
 .   ;  set 0th node
"RTN","RCCPCPS",127,0)
 .   I RCPSDA S ^RCPS(349.2,RCDEBTDA,2,0)="^349.21DA^"_RCPSDA_"^"_RCPSDA
"RTN","RCCPCPS",128,0)
 .   ;
"RTN","RCCPCPS",129,0)
 .   I RCPSDA'<287 S ^XTMP("RCCPC",0)=DT,^XTMP("RCCPC",RCDEBTDA)="" Q
"RTN","RCCPCPS",130,0)
 .   D NO
"RTN","RCCPCPS",131,0)
 ;
"RTN","RCCPCPS",132,0)
 S DIK="^RCPS(349.2," D IXALL^DIK
"RTN","RCCPCPS",133,0)
 S DEB=0 S DEB=$O(^RCPS(349.2,DEB)) Q:DEB=""  S $P(^(DEB,0),"^",18)=1
"RTN","RCCPCPS",134,0)
 K ^XTMP("PRCAGU",$J,DEB),COMM
"RTN","RCCPCPS",135,0)
 ;
"RTN","RCCPCPS",136,0)
OSTM ;Process old statements
"RTN","RCCPCPS",137,0)
 S DIK="^RCPS(349.2,",DA=0 F  S DA=$O(^XTMP("RCCPC",DA)) Q:'DA  D ^DIK
"RTN","RCCPCPS",138,0)
 K DA
"RTN","RCCPCPS",139,0)
 ;
"RTN","RCCPCPS",140,0)
STATMNT ;Print patient statements
"RTN","RCCPCPS",141,0)
 N IOP,ZTIO,ZTSAVE,ZTRTN,ZTDESC,ZTASK,%ZIS,ZTDTH,PRCADEV
"RTN","RCCPCPS",142,0)
 S (IOP,PRCADEV)=$P($G(^RC(342,1,0)),"^",8)
"RTN","RCCPCPS",143,0)
 I IOP]"" D
"RTN","RCCPCPS",144,0)
 .S ZTRTN="STM^RCCPCSTM",ZTDTH=$H,ZTDESC="Print old AR Statements"
"RTN","RCCPCPS",145,0)
 .S %ZIS="N0" D ^%ZIS Q:POP
"RTN","RCCPCPS",146,0)
 .S ZTSAVE("PRCADEV")="" D ^%ZTLOAD,^%ZISC
"RTN","RCCPCPS",147,0)
 Q
"RTN","RCCPCPS",148,0)
 ;
"RTN","RCCPCPS",149,0)
NO ;If there is no activity
"RTN","RCCPCPS",150,0)
 I $G(^RCPS(349.2,+DEB,4))["0150" D
"RTN","RCCPCPS",151,0)
 .S ^RCPS(349.2,+DEB,2,1,0)="^NOTICE: You now have delinquent charges. Please^^"
"RTN","RCCPCPS",152,0)
 .S ^RCPS(349.2,+DEB,2,2,0)="^review Enforcement of Involuntary Collections^^"
"RTN","RCCPCPS",153,0)
 .S ^RCPS(349.2,+DEB,2,3,0)="^on reverse.^^"
"RTN","RCCPCPS",154,0)
 .S ^RCPS(349.2,+DEB,2,0)="^^3^3"
"RTN","RCCPCPS",155,0)
 I $G(^RCPS(349.2,DEB,2,1,0))="" D
"RTN","RCCPCPS",156,0)
 .S ^RCPS(349.2,DEB,2,1,0)="^No Activity in the Last 30 Days!^^"
"RTN","RCCPCPS",157,0)
 .S ^RCPS(349.2,DEB,2,2,0)="^Please refer to previous statement of rights.^^"
"RTN","RCCPCPS",158,0)
 .S ^RCPS(349.2,DEB,2,0)="^^2^2"
"RTN","RCCPCPS",159,0)
 .I $G(^RCPS(349.2,DEB,4))="" S ^(4)="90"
"RTN","RCCPCPS",160,0)
 Q
"RTN","RCCPCPS",161,0)
BUILD ;This is the entry point from the BUILD CCPC file option
"RTN","RCCPCPS",162,0)
 N TDT,QDT,ZTDESC,ZTASK,ZTSK,ZDTDTH,ZTIO,ZTRTN
"RTN","RCCPCPS",163,0)
 S TDT=$O(^RCPS(349.2,0)) I TDT D
"RTN","RCCPCPS",164,0)
 .S TDT=$$ASOF^RCCPCFN($P($G(^RCPS(349.2,+TDT,0)),"^",10))
"RTN","RCCPCPS",165,0)
 .S TDT=$TR($$SLH^RCFN01(TDT),"/","")
"RTN","RCCPCPS",166,0)
 .S TDT("T")=$P($G(^RCT(349,1,0)),"^",10),TDT("T")=$E(TDT("T"),1,4)_$E(TDT("T"),7,8)
"RTN","RCCPCPS",167,0)
 .I TDT("T")=TDT D
"RTN","RCCPCPS",168,0)
 ..W *7,!,"The current file reflects activity as of ",$E(TDT,1,2)_"/"_$E(TDT,3,4)_"/"_$E(TDT,5,8)_".",!
"RTN","RCCPCPS",169,0)
 ..W !,"IT WAS TRANSMITTED ON ",$TR($P($P($G(^RCT(349,1,0)),"^"),".",2,4),".","/"),!
"RTN","RCCPCPS",170,0)
 ..S TDT=$P($G(^RCT(349,1,0)),"^",9)
"RTN","RCCPCPS",171,0)
 ..W !,"For statement date: ",$E(TDT,1,2)_"/"_$E(TDT,3,4)_"/"_$E(TDT,5,8)
"RTN","RCCPCPS",172,0)
 ..W !!,"PLEASE CONTACT CUSTOMER SUPPORT BEFORE PROCEEDING.",!!
"RTN","RCCPCPS",173,0)
TIME S ZTIO="",ZTRTN="EN^RCCPCPS",ZTDESC="Build CCPC Statement File"
"RTN","RCCPCPS",174,0)
 S ZTDTH="" D ^%ZTLOAD Q:$G(ZTSK)=""
"RTN","RCCPCPS",175,0)
 S %H=ZTSK("D") D YMD^%DTC S QDT=X_%
"RTN","RCCPCPS",176,0)
 I (QDT>DT_"."_0800)&(QDT<(DT_"."_1801)) D  G TIME
"RTN","RCCPCPS",177,0)
 .W !!,*7,"You Can Not Queue this Job Between 8:00am and 6:00pm.",!
"RTN","RCCPCPS",178,0)
 .D KILL^%ZTLOAD
"RTN","RCCPCPS",179,0)
 W !,"Queued for Building."
"RTN","RCCPCPS",180,0)
 Q
"RTN","RCCPCPS",181,0)
 ;
"RTN","RCCPCPS",182,0)
RCDESC ;Remove "IN PART" & "IN FULL" from the the bill description
"RTN","RCCPCPS",183,0)
 QUIT:$G(RCDESC(1))=""
"RTN","RCCPCPS",184,0)
 S RCINFULL=" (IN FULL)"
"RTN","RCCPCPS",185,0)
 S RCINPART=" (IN PART)"
"RTN","RCCPCPS",186,0)
 I RCDESC(1)[RCINFULL S RCDESC(1)=$P(RCDESC(1),RCINFULL)_$P(RCDESC(1),RCINFULL,2)
"RTN","RCCPCPS",187,0)
 I RCDESC(1)[RCINPART S RCDESC(1)=$P(RCDESC(1),RCINPART)_$P(RCDESC(1),RCINPART,2)
"RTN","RCCPCPS",188,0)
 Q
"RTN","RCDPAPLI")
0^9^B46722534
"RTN","RCDPAPLI",1,0)
RCDPAPLI ;WISC/RFJ-account profile top list manager init ;1 Jun 99
"RTN","RCDPAPLI",2,0)
 ;;4.5;Accounts Receivable;**114,141,241,303,301**;Mar 20, 1995;Build 144
"RTN","RCDPAPLI",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPAPLI",4,0)
 Q
"RTN","RCDPAPLI",5,0)
 ;
"RTN","RCDPAPLI",6,0)
INIT ;  init for list manager screen
"RTN","RCDPAPLI",7,0)
 N DMCDATA,RCBILLDA,RCCOMM,RCDATA,RCDATE,RCLINE,RCSTATDA,RCTOTAL
"RTN","RCDPAPLI",8,0)
 N TOP4,TOP6
"RTN","RCDPAPLI",9,0)
 K ^TMP("RCDPAPLM",$J),^TMP("RCDPAPLMX",$J),^TMP("VALM VIDEO",$J)
"RTN","RCDPAPLI",10,0)
 ;
"RTN","RCDPAPLI",11,0)
 ;  fast exit
"RTN","RCDPAPLI",12,0)
 I $G(RCDPFXIT) S VALMQUIT=1 Q
"RTN","RCDPAPLI",13,0)
 ;
"RTN","RCDPAPLI",14,0)
 I '$G(RCDEBTDA) D  Q
"RTN","RCDPAPLI",15,0)
 .   D SET("",1,1,80)
"RTN","RCDPAPLI",16,0)
 .   D SET("*****  Select an ACCOUNT  *****",2,1,80)
"RTN","RCDPAPLI",17,0)
 .   S VALMCNT=2
"RTN","RCDPAPLI",18,0)
 .   D HDR^RCDPAPLM
"RTN","RCDPAPLI",19,0)
 ;
"RTN","RCDPAPLI",20,0)
 ;  get bills for a debtor
"RTN","RCDPAPLI",21,0)
 D GETBILLS^RCDPAPST(RCDEBTDA)
"RTN","RCDPAPLI",22,0)
 ;
"RTN","RCDPAPLI",23,0)
 I '$O(^TMP("RCDPAPST",$J,0)) D  Q
"RTN","RCDPAPLI",24,0)
 .   D SET("",1,1,80,IORVOFF,IORVOFF)
"RTN","RCDPAPLI",25,0)
 .   D SET("  *****  Account does not have any bills *****",2,1,80)
"RTN","RCDPAPLI",26,0)
 .   S VALMCNT=2
"RTN","RCDPAPLI",27,0)
 .   S RCTOTAL(1)=0
"RTN","RCDPAPLI",28,0)
 .   D HDR^RCDPAPLM
"RTN","RCDPAPLI",29,0)
 ;
"RTN","RCDPAPLI",30,0)
 ;  set the listmanager line number
"RTN","RCDPAPLI",31,0)
 S RCLINE=0
"RTN","RCDPAPLI",32,0)
 ;
"RTN","RCDPAPLI",33,0)
 S RCDATE=9999999 F  S RCDATE=$O(^TMP("RCDPAPST",$J,RCDATE),-1) Q:'RCDATE  D
"RTN","RCDPAPLI",34,0)
 .   S RCSTATDA=0 F  S RCSTATDA=$O(^TMP("RCDPAPST",$J,RCDATE,RCSTATDA)) Q:'RCSTATDA  D
"RTN","RCDPAPLI",35,0)
 .   .   S RCBILLDA=0 F  S RCBILLDA=$O(^TMP("RCDPAPST",$J,RCDATE,RCSTATDA,RCBILLDA)) Q:'RCBILLDA  D
"RTN","RCDPAPLI",36,0)
 .   .   .   S RCDATA=^TMP("RCDPAPST",$J,RCDATE,RCSTATDA,RCBILLDA)
"RTN","RCDPAPLI",37,0)
 .   .   .   ;  add up dollars owed by account (all bills)
"RTN","RCDPAPLI",38,0)
 .   .   .   S RCTOTAL(1)=$G(RCTOTAL(1))+$P(RCDATA,"^")
"RTN","RCDPAPLI",39,0)
 .   .   .   S RCTOTAL(2)=$G(RCTOTAL(2))+$P(RCDATA,"^",2)
"RTN","RCDPAPLI",40,0)
 .   .   .   S RCTOTAL(3)=$G(RCTOTAL(3))+$P(RCDATA,"^",3)
"RTN","RCDPAPLI",41,0)
 .   .   .   ;
"RTN","RCDPAPLI",42,0)
 .   .   .   ;  if not a selected status, do not display
"RTN","RCDPAPLI",43,0)
 .   .   .   I ("^"_$G(^DISV(DUZ,"RCDPAPLM","STATUS"))_"^")'[("^"_RCSTATDA_"^") Q
"RTN","RCDPAPLI",44,0)
 .   .   .   ;
"RTN","RCDPAPLI",45,0)
 .   .   .   ;  display the bill in listmanager if the status selected
"RTN","RCDPAPLI",46,0)
 .   .   .   D SETBILL
"RTN","RCDPAPLI",47,0)
 .   .   .   ;
"RTN","RCDPAPLI",48,0)
 .   .   .   ;  add up dollars owed by account (bills displayed)
"RTN","RCDPAPLI",49,0)
 .   .   .   S RCTOTAL(4)=$G(RCTOTAL(4))+$P(RCDATA,"^")
"RTN","RCDPAPLI",50,0)
 .   .   .   S RCTOTAL(5)=$G(RCTOTAL(5))+$P(RCDATA,"^",2)
"RTN","RCDPAPLI",51,0)
 .   .   .   S RCTOTAL(6)=$G(RCTOTAL(6))+$P(RCDATA,"^",3)
"RTN","RCDPAPLI",52,0)
 ;
"RTN","RCDPAPLI",53,0)
 ;  show totals of all bills displayed in listmanager
"RTN","RCDPAPLI",54,0)
 S RCLINE=RCLINE+1
"RTN","RCDPAPLI",55,0)
 D SET("                                                    --------- -------- --------",RCLINE,1,80)
"RTN","RCDPAPLI",56,0)
 S RCLINE=RCLINE+1
"RTN","RCDPAPLI",57,0)
 D SET("   TOTAL BALANCE OWED FOR ALL BILLS DISPLAYED",RCLINE,1,80)
"RTN","RCDPAPLI",58,0)
 D SET($J($G(RCTOTAL(4)),9,2),RCLINE,53,62)
"RTN","RCDPAPLI",59,0)
 D SET($J($G(RCTOTAL(5)),9,2),RCLINE,62,71)
"RTN","RCDPAPLI",60,0)
 D SET($J($G(RCTOTAL(6)),9,2),RCLINE,71,80)
"RTN","RCDPAPLI",61,0)
 ;
"RTN","RCDPAPLI",62,0)
 ;  get the pending payments for the debtor
"RTN","RCDPAPLI",63,0)
 S RCTOTAL("PP")=$$PENDPAY^RCDPURET($P(^RCD(340,RCDEBTDA,0),"^"))
"RTN","RCDPAPLI",64,0)
 I $O(^TMP($J,"RCDPUREC","PP",0)) D
"RTN","RCDPAPLI",65,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",66,0)
 .   S RCLINE=RCLINE+1 D SET("Pending Payments",RCLINE,1,80,0,IORVON,IORVOFF)
"RTN","RCDPAPLI",67,0)
 .   N %,DATA,DATE,RECEIPT,RECTDA,TRANDA,TYPE
"RTN","RCDPAPLI",68,0)
 .   S RECTDA=0 F  S RECTDA=$O(^TMP($J,"RCDPUREC","PP",RECTDA)) Q:'RECTDA  D
"RTN","RCDPAPLI",69,0)
 .   .   S RECEIPT=$P($G(^RCY(344,RECTDA,0)),"^")
"RTN","RCDPAPLI",70,0)
 .   .   S TYPE=$E($P($G(^RC(341.1,+$P(^RCY(344,RECTDA,0),"^",4),0)),"^"),1,14)
"RTN","RCDPAPLI",71,0)
 .   .   S TRANDA=0 F  S TRANDA=$O(^TMP($J,"RCDPUREC","PP",RECTDA,TRANDA)) Q:'TRANDA  D
"RTN","RCDPAPLI",72,0)
 .   .   .   S DATA=^TMP($J,"RCDPUREC","PP",RECTDA,TRANDA)
"RTN","RCDPAPLI",73,0)
 .   .   .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",74,0)
 .   .   .   D SET(RECEIPT_"/"_TRANDA,RCLINE,1,80)
"RTN","RCDPAPLI",75,0)
 .   .   .   S DATE=$P(DATA,"^",6)
"RTN","RCDPAPLI",76,0)
 .   .   .   S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RCDPAPLI",77,0)
 .   .   .   D SET(DATE,RCLINE,13,21)
"RTN","RCDPAPLI",78,0)
 .   .   .   ;  build type of payment display
"RTN","RCDPAPLI",79,0)
 .   .   .   S %=$E(TYPE_"              ",1,14)
"RTN","RCDPAPLI",80,0)
 .   .   .   I $P(DATA,"^",7)'="" S %=%_"/"_$P(DATA,"^",7)  ;  check #
"RTN","RCDPAPLI",81,0)
 .   .   .   I $P(DATA,"^",8)'="" S %=%_"/"_$P(DATA,"^",8)  ;  bank #
"RTN","RCDPAPLI",82,0)
 .   .   .   I $P(DATA,"^",2)'="" S %=%_"/"_$P(DATA,"^",2)  ;  confirmation
"RTN","RCDPAPLI",83,0)
 .   .   .   D SET(%,RCLINE,29,53)
"RTN","RCDPAPLI",84,0)
 .   .   .   ;  show amount paid
"RTN","RCDPAPLI",85,0)
 .   .   .   D SET($J($P(DATA,"^",4),9,2),RCLINE,53,62)
"RTN","RCDPAPLI",86,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",87,0)
 .   D SET("                                                    ---------",RCLINE,1,80)
"RTN","RCDPAPLI",88,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",89,0)
 .   D SET("   TOTAL PENDING PAYMENTS",RCLINE,1,80)
"RTN","RCDPAPLI",90,0)
 .   D SET($J($G(RCTOTAL("PP")),9,2),RCLINE,53,62)
"RTN","RCDPAPLI",91,0)
 .   K ^TMP($J,"RCDPUREC","PP")
"RTN","RCDPAPLI",92,0)
 ;
"RTN","RCDPAPLI",93,0)
 ;  dmc info
"RTN","RCDPAPLI",94,0)
 I $D(^RCD(340,"DMC",1,+RCDEBTDA)) D
"RTN","RCDPAPLI",95,0)
 .   S DMCDATA=$G(^RCD(340,+RCDEBTDA,3))
"RTN","RCDPAPLI",96,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",97,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",98,0)
 .   D SET("** Account forwarded to DMC: "_$S('$P(DMCDATA,"^",2):"",1:$$SLH^RCFN01($P(DMCDATA,"^",2))),RCLINE,1,80)
"RTN","RCDPAPLI",99,0)
 .   D SET("Total DMC Amount: "_$J($P(DMCDATA,"^",5),9,2),RCLINE,50,80)
"RTN","RCDPAPLI",100,0)
 .   I $P(DMCDATA,"^",9)'="" D
"RTN","RCDPAPLI",101,0)
 .   .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",102,0)
 .   .   D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",103,0)
 .   .   D SET("Lesser Amt to DMC: "_$J($P(DMCDATA,"^",9),9,2),RCLINE,49,80)
"RTN","RCDPAPLI",104,0)
 ;   top info
"RTN","RCDPAPLI",105,0)
 I $D(^RCD(340,"TOP",+RCDEBTDA)) D
"RTN","RCDPAPLI",106,0)
 .   S TOP6=$G(^RCD(340,+RCDEBTDA,6)),TOP4=$G(^(4))
"RTN","RCDPAPLI",107,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",108,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",109,0)
 .   D SET("** Account forwarded to TOP: "_$S('$P(TOP6,"^"):"",1:$$SLH^RCFN01($P(TOP6,"^"))),RCLINE,1,80)
"RTN","RCDPAPLI",110,0)
 .   D SET("Total TOP Amount: "_$J($P(TOP4,"^",3),13,2),RCLINE,45,80)
"RTN","RCDPAPLI",111,0)
 .   I $P(TOP6,"^",6)'="" D
"RTN","RCDPAPLI",112,0)
 .   .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",113,0)
 .   .   D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",114,0)
 .   .   D SET("TOP Hold Date: "_$$SLH^RCFN01($P(TOP6,"^",6)),RCLINE,45,80)
"RTN","RCDPAPLI",115,0)
 ;
"RTN","RCDPAPLI",116,0)
 ;   cross-servicing info
"RTN","RCDPAPLI",117,0)
 I $D(^RCD(340,"TCSP",+RCDEBTDA)) D
"RTN","RCDPAPLI",118,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",119,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",120,0)
 .   D SET^RCDPBPLM("Debt Referred to Cross-Servicing",RCLINE,1,80)
"RTN","RCDPAPLI",121,0)
 .   D SET("Total CS Debt: "_$J($$TOTALB^RCTCSPU(+RCDEBTDA),13,2),RCLINE,45,80)
"RTN","RCDPAPLI",122,0)
 ;
"RTN","RCDPAPLI",123,0)
 ;  show if hurricane katrina vet
"RTN","RCDPAPLI",124,0)
 I $P(^RCD(340,+RCDEBTDA,0),U)["DPT(" S DFN=+^(0) D
"RTN","RCDPAPLI",125,0)
 .   Q:$$EMGRES^DGUTL(DFN)'["K"
"RTN","RCDPAPLI",126,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPAPLI",127,0)
 .   D SET("EMERGENCY RESPONSE INDICATOR: HURRICANE KATRINA",RCLINE,1,80)
"RTN","RCDPAPLI",128,0)
 ;
"RTN","RCDPAPLI",129,0)
 ;  show comments if they exist
"RTN","RCDPAPLI",130,0)
 I $O(^RCD(340,RCDEBTDA,2,0)) D
"RTN","RCDPAPLI",131,0)
 .   S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPAPLI",132,0)
 .   S RCLINE=RCLINE+1 D SET("Comments",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPAPLI",133,0)
 .   S RCCOMM=0 F  S RCCOMM=$O(^RCD(340,RCDEBTDA,2,RCCOMM)) Q:'RCCOMM  D
"RTN","RCDPAPLI",134,0)
 .   .   S RCLINE=RCLINE+1 D SET(^RCD(340,RCDEBTDA,2,RCCOMM,0),RCLINE,1,80)
"RTN","RCDPAPLI",135,0)
 ;
"RTN","RCDPAPLI",136,0)
 K ^TMP("RCDPAPST",$J)
"RTN","RCDPAPLI",137,0)
 ;
"RTN","RCDPAPLI",138,0)
 ;  set valmcnt to number of lines in the list
"RTN","RCDPAPLI",139,0)
 S VALMCNT=RCLINE
"RTN","RCDPAPLI",140,0)
 D HDR^RCDPAPLM
"RTN","RCDPAPLI",141,0)
 Q
"RTN","RCDPAPLI",142,0)
 ;
"RTN","RCDPAPLI",143,0)
 ;
"RTN","RCDPAPLI",144,0)
SETBILL ;  set a bill on the listmanager line
"RTN","RCDPAPLI",145,0)
 N DATE,IBCNDATA,RCDPDATA,REJECT,VALUE
"RTN","RCDPAPLI",146,0)
 D DIQ430^RCDPBPLM(RCBILLDA,".01;2;3;8;60;")
"RTN","RCDPAPLI",147,0)
 ;
"RTN","RCDPAPLI",148,0)
 S RCLINE=RCLINE+1
"RTN","RCDPAPLI",149,0)
 ;
"RTN","RCDPAPLI",150,0)
 ;  create an index array for bill lookup in list
"RTN","RCDPAPLI",151,0)
 S ^TMP("RCDPAPLM",$J,"IDX",RCLINE,RCLINE)=RCBILLDA
"RTN","RCDPAPLI",152,0)
 ;
"RTN","RCDPAPLI",153,0)
 ;  bill number
"RTN","RCDPAPLI",154,0)
 ;PRCA*4.5*303 - add reject indicator to kbill ; IA# 6060
"RTN","RCDPAPLI",155,0)
 S REJECT=$$BILLREJ^IBJTU6($P(RCDPDATA(430,RCBILLDA,.01,"E"),"-",2))
"RTN","RCDPAPLI",156,0)
 D SET(RCLINE,RCLINE,1,80,0,IORVON,IORVOFF)
"RTN","RCDPAPLI",157,0)
 D SET($S(REJECT:"c",1:"")_$E($P(RCDPDATA(430,RCBILLDA,.01,"E"),"-",2)_"       ",1,7),RCLINE,4,10,0)
"RTN","RCDPAPLI",158,0)
 ;PRCA*4.5*303 - End
"RTN","RCDPAPLI",159,0)
 ;
"RTN","RCDPAPLI",160,0)
 ;  get date of care
"RTN","RCDPAPLI",161,0)
 D DIQ399^RCXFMSUR(RCBILLDA)
"RTN","RCDPAPLI",162,0)
 S DATE=$G(IBCNDATA(399,RCBILLDA,151,"I"))
"RTN","RCDPAPLI",163,0)
 I 'DATE S DATE=$G(RCDPDATA(430,RCBILLDA,60,"I"))
"RTN","RCDPAPLI",164,0)
 S DATE=$E(DATE,4,5)_"/"_$E(DATE,6,7)_"/"_$E(DATE,2,3)
"RTN","RCDPAPLI",165,0)
 D SET(DATE,RCLINE,13,21,0)
"RTN","RCDPAPLI",166,0)
 ;
"RTN","RCDPAPLI",167,0)
 ;  status (field 8)
"RTN","RCDPAPLI",168,0)
 D SET("",RCLINE,23,26,8)
"RTN","RCDPAPLI",169,0)
 ;
"RTN","RCDPAPLI",170,0)
 ;  type of care
"RTN","RCDPAPLI",171,0)
 D SET("",RCLINE,29,71,2)
"RTN","RCDPAPLI",172,0)
 ;
"RTN","RCDPAPLI",173,0)
 ;  principle, interest, admin
"RTN","RCDPAPLI",174,0)
 D SET($J($P(RCDATA,"^"),9,2),RCLINE,53,62,0)
"RTN","RCDPAPLI",175,0)
 D SET($J($P(RCDATA,"^",2),9,2),RCLINE,62,71,0)
"RTN","RCDPAPLI",176,0)
 D SET($J($P(RCDATA,"^",3),9,2),RCLINE,71,80,0)
"RTN","RCDPAPLI",177,0)
 Q
"RTN","RCDPAPLI",178,0)
 ;
"RTN","RCDPAPLI",179,0)
 ;
"RTN","RCDPAPLI",180,0)
SET(STRING,LINE,COLBEG,COLEND,FIELD,ON,OFF) ;  set array
"RTN","RCDPAPLI",181,0)
 I $G(FIELD) S STRING=STRING_$S(STRING="":"",1:": ")_$G(RCDPDATA(430,RCBILLDA,FIELD,"E"))
"RTN","RCDPAPLI",182,0)
 I STRING="",'$G(FIELD) D SET^VALM10(LINE,$J("",80)) Q
"RTN","RCDPAPLI",183,0)
 I '$D(@VALMAR@(LINE,0)) D SET^VALM10(LINE,$J("",80))
"RTN","RCDPAPLI",184,0)
 D SET^VALM10(LINE,$$SETSTR^VALM1(STRING,@VALMAR@(LINE,0),COLBEG,COLEND-COLBEG+1))
"RTN","RCDPAPLI",185,0)
 I $G(ON)]""!($G(OFF)]"") D CNTRL^VALM10(LINE,COLBEG,$L(STRING),ON,OFF)
"RTN","RCDPAPLI",186,0)
 Q
"RTN","RCDPBPLI")
0^6^B57251656
"RTN","RCDPBPLI",1,0)
RCDPBPLI ;WISC/RFJ-bill profile (build array cont employee/vendor) ;1 Jun 99
"RTN","RCDPBPLI",2,0)
 ;;4.5;Accounts Receivable;**114,153,301**;Mar 20, 1995;Build 144
"RTN","RCDPBPLI",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPBPLI",4,0)
 Q
"RTN","RCDPBPLI",5,0)
 ;
"RTN","RCDPBPLI",6,0)
 ;
"RTN","RCDPBPLI",7,0)
INIT ;  initialization for list manager list
"RTN","RCDPBPLI",8,0)
 ;  report type for employee or vendor, show description field 106
"RTN","RCDPBPLI",9,0)
 N COMMDA,DATA,DESCDA,TEXT
"RTN","RCDPBPLI",10,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",11,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Date    ",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",12,0)
 D SET^RCDPBPLM("Description",RCLINE,12,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",13,0)
 D SET^RCDPBPLM("Quantity",RCLINE,35,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",14,0)
 D SET^RCDPBPLM("Units",RCLINE,46,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",15,0)
 D SET^RCDPBPLM("Cost",RCLINE,54,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",16,0)
 D SET^RCDPBPLM("Total Cost",RCLINE,64,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",17,0)
 S DESCDA=0 F  S DESCDA=$O(^PRCA(430,RCBILLDA,101,DESCDA)) Q:'DESCDA  D
"RTN","RCDPBPLI",18,0)
 .   S DATA=$G(^PRCA(430,RCBILLDA,101,DESCDA,0)) I DATA="" Q
"RTN","RCDPBPLI",19,0)
 .   S RCLINE=RCLINE+1
"RTN","RCDPBPLI",20,0)
 .   D SET^RCDPBPLM($E($P(DATA,"^"),4,5)_"/"_$E($P(DATA,"^"),6,7)_"/"_$E($P(DATA,"^"),2,3),RCLINE,1,80)
"RTN","RCDPBPLI",21,0)
 .   D SET^RCDPBPLM($J($P(DATA,"^",3),8,2),RCLINE,35,80)
"RTN","RCDPBPLI",22,0)
 .   D SET^RCDPBPLM($J($P($G(^PRCD(420.5,+$P(DATA,"^",5),0)),"^"),5),RCLINE,46,80)
"RTN","RCDPBPLI",23,0)
 .   D SET^RCDPBPLM($J($P(DATA,"^",4),0,4),RCLINE,54,80)
"RTN","RCDPBPLI",24,0)
 .   D SET^RCDPBPLM($J($P(DATA,"^",6),10,2),RCLINE,64,80)
"RTN","RCDPBPLI",25,0)
 .   ;  show description
"RTN","RCDPBPLI",26,0)
 .   S DATA=""
"RTN","RCDPBPLI",27,0)
 .   S COMMDA=0 F  S COMMDA=$O(^PRCA(430,RCBILLDA,101,DESCDA,1,COMMDA)) Q:'COMMDA  D
"RTN","RCDPBPLI",28,0)
 .   .   S TEXT=$G(^PRCA(430,RCBILLDA,101,DESCDA,1,COMMDA,0)) I TEXT="" Q
"RTN","RCDPBPLI",29,0)
 .   .   I $L(DATA_TEXT)>240 D SETDESC(11)
"RTN","RCDPBPLI",30,0)
 .   .   S DATA=DATA_$S(DATA="":"",1:" ")_TEXT
"RTN","RCDPBPLI",31,0)
 .   I DATA'="" D SETDESC(11)
"RTN","RCDPBPLI",32,0)
 .   ;  make sure all data is processed
"RTN","RCDPBPLI",33,0)
 .   I DATA'="" D SETDESC(11)
"RTN","RCDPBPLI",34,0)
 Q
"RTN","RCDPBPLI",35,0)
 ;
"RTN","RCDPBPLI",36,0)
 ;
"RTN","RCDPBPLI",37,0)
SETDESC(STARTCOL) ;  set the description line starting in column startcol+1
"RTN","RCDPBPLI",38,0)
 N %,LENGTH,SPACE
"RTN","RCDPBPLI",39,0)
 S LENGTH=80-STARTCOL-1
"RTN","RCDPBPLI",40,0)
 S SPACE="",$P(SPACE," ",80)=""
"RTN","RCDPBPLI",41,0)
 ;  break text at space if possible
"RTN","RCDPBPLI",42,0)
 I $L(DATA)>LENGTH D
"RTN","RCDPBPLI",43,0)
 .   F %=LENGTH-1:-1:0 Q:$E(DATA,%)=" "
"RTN","RCDPBPLI",44,0)
 .   I % S LENGTH=%
"RTN","RCDPBPLI",45,0)
 ;  set line
"RTN","RCDPBPLI",46,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM($E(SPACE,1,STARTCOL)_$E(DATA,1,LENGTH),RCLINE,1,80)
"RTN","RCDPBPLI",47,0)
 S DATA=$E(DATA,LENGTH+1,255)
"RTN","RCDPBPLI",48,0)
 I $L(DATA)>LENGTH D SETDESC(STARTCOL)
"RTN","RCDPBPLI",49,0)
 Q
"RTN","RCDPBPLI",50,0)
 ;
"RTN","RCDPBPLI",51,0)
 ;
"RTN","RCDPBPLI",52,0)
TRANINIT ;  initialization for transaction and ib data display
"RTN","RCDPBPLI",53,0)
 N BILLCAT,DATA,IBDA,RCDATE,RCLIST,RCTOTAL,RCTRANDA,X
"RTN","RCDPBPLI",54,0)
 ;  get the bill category
"RTN","RCDPBPLI",55,0)
 S BILLCAT=$P($G(^PRCA(430,RCBILLDA,0)),"^",2)
"RTN","RCDPBPLI",56,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",57,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",58,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Trans    Date      Type          Amount  Description                        ",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",59,0)
 S RCTOTAL=$$GETTRANS^RCDPBTLM(RCBILLDA)
"RTN","RCDPBPLI",60,0)
 S RCDATE=0 F  S RCDATE=$O(RCLIST(RCDATE)) Q:'RCDATE  D
"RTN","RCDPBPLI",61,0)
 .   S RCTRANDA=0 F  S RCTRANDA=$O(RCLIST(RCDATE,RCTRANDA)) Q:'RCTRANDA  D
"RTN","RCDPBPLI",62,0)
 .   .   S RCLINE=RCLINE+1
"RTN","RCDPBPLI",63,0)
 .   .   D SET^RCDPBPLM(RCTRANDA,RCLINE,1,80)
"RTN","RCDPBPLI",64,0)
 .   .   D SET^RCDPBPLM($E(RCDATE,4,5)_"/"_$E(RCDATE,6,7)_"/"_$E(RCDATE,2,3),RCLINE,10,20)
"RTN","RCDPBPLI",65,0)
 .   .   D SET^RCDPBPLM($E($P(RCLIST(RCDATE,RCTRANDA),"^"),1,9),RCLINE,20,29)
"RTN","RCDPBPLI",66,0)
 .   .   S X=$P(RCLIST(RCDATE,RCTRANDA),"^",2)+$P(RCLIST(RCDATE,RCTRANDA),"^",3)+$P(RCLIST(RCDATE,RCTRANDA),"^",4)+$P(RCLIST(RCDATE,RCTRANDA),"^",5)+$P(RCLIST(RCDATE,RCTRANDA),"^",6)
"RTN","RCDPBPLI",67,0)
 .   .   D SET^RCDPBPLM($J(X,10,2),RCLINE,30,40)
"RTN","RCDPBPLI",68,0)
 .   .   ;
"RTN","RCDPBPLI",69,0)
 .   .   ;  for category c-means test, rx copay (sc/nsc)
"RTN","RCDPBPLI",70,0)
 .   .   I BILLCAT=18!(BILLCAT=22)!(BILLCAT=23) D
"RTN","RCDPBPLI",71,0)
 .   .   .   D STMT^IBRFN1(RCTRANDA)
"RTN","RCDPBPLI",72,0)
 .   .   .   I '$D(^TMP("IBRFN1",$J)) Q
"RTN","RCDPBPLI",73,0)
 .   .   .   S IBDA=0 F  S IBDA=$O(^TMP("IBRFN1",$J,IBDA)) Q:'IBDA  D
"RTN","RCDPBPLI",74,0)
 .   .   .   .   S DATA=^TMP("IBRFN1",$J,IBDA)
"RTN","RCDPBPLI",75,0)
 .   .   .   .   ;  show rx
"RTN","RCDPBPLI",76,0)
 .   .   .   .   I BILLCAT=22!(BILLCAT=23) D  Q
"RTN","RCDPBPLI",77,0)
 .   .   .   .   .   D SET^RCDPBPLM("RX "_$P(DATA,"^",2),RCLINE,42,52)
"RTN","RCDPBPLI",78,0)
 .   .   .   .   .   D SET^RCDPBPLM($P(DATA,"^",3),RCLINE,54,68)
"RTN","RCDPBPLI",79,0)
 .   .   .   .   .   D SET^RCDPBPLM("Qty "_$P(DATA,"^",6),RCLINE,70,80)
"RTN","RCDPBPLI",80,0)
 .   .   .   .   ;  show outpatient (type of care 430.2 = 4 outpatient care)
"RTN","RCDPBPLI",81,0)
 .   .   .   .   I $P(^PRCA(430,RCBILLDA,0),"^",16)=4 D  Q
"RTN","RCDPBPLI",82,0)
 .   .   .   .   .   D SET^RCDPBPLM("Outpatient Visit Date: "_$E($P(DATA,"^",2),4,5)_"/"_$E($P(DATA,"^",2),6,7)_"/"_$E($P(DATA,"^",2),2,3),RCLINE,42,80)
"RTN","RCDPBPLI",83,0)
 .   .   .   .   ;  show inpatient
"RTN","RCDPBPLI",84,0)
 .   .   .   .   D SET^RCDPBPLM("Inpatient Adm Date: "_$E($P(DATA,"^",2),4,5)_"/"_$E($P(DATA,"^",2),6,7)_"/"_$E($P(DATA,"^",2),2,3),RCLINE,42,80)
"RTN","RCDPBPLI",85,0)
 .   .   .   K ^TMP("IBRFN1",$J)
"RTN","RCDPBPLI",86,0)
 Q
"RTN","RCDPBPLI",87,0)
 ;
"RTN","RCDPBPLI",88,0)
REJECT ;  ; prca*4.5*301 ; LEG
"RTN","RCDPBPLI",89,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",90,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",91,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("CS Reject Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",92,0)
 D PROFRJA^RCTCSJS1(RCBILLDA,.RCLINE,.OUTARY)
"RTN","RCDPBPLI",93,0)
 M @VALMAR=OUTARY
"RTN","RCDPBPLI",94,0)
 K OUTARY
"RTN","RCDPBPLI",95,0)
 Q
"RTN","RCDPBPLI",96,0)
 ;
"RTN","RCDPBPLI",97,0)
 ;
"RTN","RCDPBPLI",98,0)
 ;
"RTN","RCDPBPLI",99,0)
REPAY ;  show repayment plan
"RTN","RCDPBPLI",100,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",101,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Repayment Plan Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",102,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("     Repayment Plan Date",RCLINE,1,80,41)
"RTN","RCDPBPLI",103,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Day of Month Payment Due",RCLINE,1,80,42)
"RTN","RCDPBPLI",104,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("    Repayment Amount Due",RCLINE,1,80,43)
"RTN","RCDPBPLI",105,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("      Number of Payments",RCLINE,1,80,44)
"RTN","RCDPBPLI",106,0)
 Q
"RTN","RCDPBPLI",107,0)
 ;
"RTN","RCDPBPLI",108,0)
 ;
"RTN","RCDPBPLI",109,0)
IRS ;  irs data
"RTN","RCDPBPLI",110,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",111,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Forwarded to IRS",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",112,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("On Date",RCLINE,40,80,68.7)
"RTN","RCDPBPLI",113,0)
 D SET^RCDPBPLM("Amount",RCLINE,65,80,68.92)
"RTN","RCDPBPLI",114,0)
 S DATA=$G(^PRCA(430,RCBILLDA,6))
"RTN","RCDPBPLI",115,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("       Principal Balance: "_$J($P(DATA,"^",16),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",116,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("        Interest Balance: "_$J($P(DATA,"^",17),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",117,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("  Administrative Balance: "_$J($P(DATA,"^",18),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",118,0)
 Q
"RTN","RCDPBPLI",119,0)
 ;
"RTN","RCDPBPLI",120,0)
 ;
"RTN","RCDPBPLI",121,0)
DMC ;  dmc data
"RTN","RCDPBPLI",122,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",123,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Forwarded to DMC",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",124,0)
 D SET^RCDPBPLM("On Date",RCLINE,40,80,121)
"RTN","RCDPBPLI",125,0)
 S DATA=$G(^PRCA(430,RCBILLDA,12))
"RTN","RCDPBPLI",126,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("       Principal Balance: "_$J($P(DATA,"^",2),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",127,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("        Interest Balance: "_$J($P(DATA,"^",3),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",128,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("  Administrative Balance: "_$J($P(DATA,"^",4),10,2),RCLINE,1,80)
"RTN","RCDPBPLI",129,0)
 Q
"RTN","RCDPBPLI",130,0)
 ;
"RTN","RCDPBPLI",131,0)
 ;
"RTN","RCDPBPLI",132,0)
TOP ;  top data
"RTN","RCDPBPLI",133,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",134,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Forwarded to TOP",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",135,0)
 D SET^RCDPBPLM("On Date",RCLINE,40,80,141)
"RTN","RCDPBPLI",136,0)
 S DATA=$G(^RCD(340,+RCDPDATA(430,RCBILLDA,9,"I"),6))
"RTN","RCDPBPLI",137,0)
 I $P(DATA,"^",6) D
"RTN","RCDPBPLI",138,0)
 .   S Y=$P(DATA,"^",6) D DD^%DT
"RTN","RCDPBPLI",139,0)
 .   S RCLINE=RCLINE+1 D SET^RCDPBPLM("  TOP Hold Date: "_Y,RCLINE,1,80)
"RTN","RCDPBPLI",140,0)
 Q
"RTN","RCDPBPLI",141,0)
 ;
"RTN","RCDPBPLI",142,0)
 ;
"RTN","RCDPBPLI",143,0)
TCSP ;  cross-servicing data referral
"RTN","RCDPBPLI",144,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",145,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Debt Referred to Cross-Servicing",RCLINE,1,80)
"RTN","RCDPBPLI",146,0)
 D SET^RCDPBPLM("  CS Referred Date",RCLINE,48,80,151)
"RTN","RCDPBPLI",147,0)
 Q
"RTN","RCDPBPLI",148,0)
 ;
"RTN","RCDPBPLI",149,0)
 ;
"RTN","RCDPBPLI",150,0)
TCSPRC ;  cross-servicing data recall
"RTN","RCDPBPLI",151,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",152,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("CS Recall Reason:",RCLINE,1,80)
"RTN","RCDPBPLI",153,0)
 D SET^RCDPBPLM("",RCLINE,19,80,154)
"RTN","RCDPBPLI",154,0)
 D SET^RCDPBPLM("  CS Recall Date",RCLINE,50,80,153)
"RTN","RCDPBPLI",155,0)
 Q
"RTN","RCDPBPLI",156,0)
 ;
"RTN","RCDPBPLI",157,0)
 ;
"RTN","RCDPBPLI",158,0)
INSUR ;  show insurance data
"RTN","RCDPBPLI",159,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" ",RCLINE,1,80)
"RTN","RCDPBPLI",160,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Insurance Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLI",161,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("         Insured Name",RCLINE,1,80,239)
"RTN","RCDPBPLI",162,0)
 D SET^RCDPBPLM("Sex",RCLINE,50,80,240)
"RTN","RCDPBPLI",163,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("            ID Number",RCLINE,1,80,242)
"RTN","RCDPBPLI",164,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("           Group Name",RCLINE,1,80,243)
"RTN","RCDPBPLI",165,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("         Group Number",RCLINE,1,80,244)
"RTN","RCDPBPLI",166,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("        Employer Name",RCLINE,1,80,247)
"RTN","RCDPBPLI",167,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("   Employee ID Number",RCLINE,1,80,248)
"RTN","RCDPBPLI",168,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("    Employer Location",RCLINE,1,80,249)
"RTN","RCDPBPLI",169,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM("Secondary Ins Carrier",RCLINE,1,80,19)
"RTN","RCDPBPLI",170,0)
 S RCLINE=RCLINE+1 D SET^RCDPBPLM(" Tertiary Ins Carrier",RCLINE,1,80,19.1)
"RTN","RCDPBPLI",171,0)
 Q
"RTN","RCDPBPLM")
0^7^B61916200
"RTN","RCDPBPLM",1,0)
RCDPBPLM ;WISC/RFJ - bill profile ;1 Jun 99
"RTN","RCDPBPLM",2,0)
 ;;4.5;Accounts Receivable;**114,153,159,241,276,303,301**;Mar 20, 1995;Build 144
"RTN","RCDPBPLM",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPBPLM",4,0)
 ;
"RTN","RCDPBPLM",5,0)
 ;
"RTN","RCDPBPLM",6,0)
 ;  called from menu option (19)
"RTN","RCDPBPLM",7,0)
 ;
"RTN","RCDPBPLM",8,0)
 N RCBILLDA,RCDPFXIT
"RTN","RCDPBPLM",9,0)
 ;
"RTN","RCDPBPLM",10,0)
 F  D  Q:'RCBILLDA
"RTN","RCDPBPLM",11,0)
 . W !! S RCBILLDA=$$SELBILL^RCDPBTLM
"RTN","RCDPBPLM",12,0)
 . I RCBILLDA<1 S RCBILLDA=0 Q
"RTN","RCDPBPLM",13,0)
 . D EN^VALM("RCDP BILL PROFILE")
"RTN","RCDPBPLM",14,0)
 . ;  fast exit
"RTN","RCDPBPLM",15,0)
 . I $G(RCDPFXIT) S RCBILLDA=0
"RTN","RCDPBPLM",16,0)
 Q
"RTN","RCDPBPLM",17,0)
 ;
"RTN","RCDPBPLM",18,0)
 ;
"RTN","RCDPBPLM",19,0)
INIT ;  initialization for list manager list
"RTN","RCDPBPLM",20,0)
 ;  requires rcbillda
"RTN","RCDPBPLM",21,0)
 N BILLED,COMMDA,DATA,PAID,RCDPDATA,RCFYDA,RCLINE,REPTYPE,X1,X2,RCDEBTOR,DFN
"RTN","RCDPBPLM",22,0)
 K ^TMP("RCDPBPLM",$J),^TMP("VALM VIDEO",$J)
"RTN","RCDPBPLM",23,0)
 ;
"RTN","RCDPBPLM",24,0)
 ;  fast exit
"RTN","RCDPBPLM",25,0)
 I $G(RCDPFXIT) S VALMQUIT=1 Q
"RTN","RCDPBPLM",26,0)
 ;
"RTN","RCDPBPLM",27,0)
 D DIQ430(RCBILLDA,".01:300")
"RTN","RCDPBPLM",28,0)
 ;
"RTN","RCDPBPLM",29,0)
 ;  set the listmanager line number
"RTN","RCDPBPLM",30,0)
 S RCLINE=0
"RTN","RCDPBPLM",31,0)
 ;
"RTN","RCDPBPLM",32,0)
 S DATA=$$ACCNTHDR^RCDPAPLM(RCDPDATA(430,RCBILLDA,9,"I"))
"RTN","RCDPBPLM",33,0)
 S RCLINE=RCLINE+1 D SET("Account: "_$P(DATA,"^")_" "_$P(DATA,"^",2),RCLINE,1,80)
"RTN","RCDPBPLM",34,0)
 D SET($P(DATA,"^",3),RCLINE,60,80)
"RTN","RCDPBPLM",35,0)
 S %="" I $TR($P(DATA,"^",4,9),"^")'="" S %=$P(DATA,"^",4)_", "_$P(DATA,"^",7)_", "_$P(DATA,"^",8)_"  "_$P(DATA,"^",9)
"RTN","RCDPBPLM",36,0)
 S RCLINE=RCLINE+1 D SET("   Addr: "_%,RCLINE,1,80)
"RTN","RCDPBPLM",37,0)
 S RCLINE=RCLINE+1 D SET("  Phone: "_$P(DATA,"^",10),RCLINE,1,80)
"RTN","RCDPBPLM",38,0)
 S RCDEBTOR=$P(^PRCA(430,RCBILLDA,0),U,9)
"RTN","RCDPBPLM",39,0)
 I $P(^RCD(340,+RCDEBTOR,0),U)["DPT(" S DFN=+^(0) D
"RTN","RCDPBPLM",40,0)
 . Q:$$EMGRES^DGUTL(DFN)'["K"
"RTN","RCDPBPLM",41,0)
 . S RCLINE=RCLINE+1
"RTN","RCDPBPLM",42,0)
 . D SET("EMERGENCY RESPONSE INDICATOR: HURRICANE KATRINA",RCLINE,1,80)
"RTN","RCDPBPLM",43,0)
 ;
"RTN","RCDPBPLM",44,0)
 ;  bill descriptive data
"RTN","RCDPBPLM",45,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",46,0)
 ; PRCA*4.5*276 - get 1st/3rd party payment add EEOB indicator when applicable
"RTN","RCDPBPLM",47,0)
 S PRCOUT=$$COMP3^PRCAAPR(RCBILLDA)
"RTN","RCDPBPLM",48,0)
 I PRCOUT'="%" S PRCOUT=$$IBEEOBCK^PRCAAPR1(RCBILLDA)
"RTN","RCDPBPLM",49,0)
 S RCLINE=RCLINE+1 ; D SET("Bill Number",RCLINE,1,80,.01,IOUON,IOUOFF)
"RTN","RCDPBPLM",50,0)
 ; IA# 6060 for $$BILLREJ^IBJTU6
"RTN","RCDPBPLM",51,0)
 S PRCOUT=PRCOUT_$S($$BILLREJ^IBJTU6($P($P($G(RCDPDATA(430,RCBILLDA,.01,"E")),"^"),"-",2)):"c",1:"") ;PRCA*4.5*303 Add indicator for rejects
"RTN","RCDPBPLM",52,0)
 D SET("Bill Number: "_$G(PRCOUT)_$P(RCDPDATA(430,RCBILLDA,.01,"E"),"^"),RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",53,0)
 D SET("Category",RCLINE,40,80,2)
"RTN","RCDPBPLM",54,0)
 S RCLINE=RCLINE+1 D SET("Date  Prepared",RCLINE,1,80,10)
"RTN","RCDPBPLM",55,0)
 D SET("Status",RCLINE,42,80,8)
"RTN","RCDPBPLM",56,0)
 S RCLINE=RCLINE+1 D SET("Date Activated",RCLINE,1,80,60)
"RTN","RCDPBPLM",57,0)
 S RCLINE=RCLINE+1 D SET("Date Status Up",RCLINE,1,80,14)
"RTN","RCDPBPLM",58,0)
 D SET("By",RCLINE,46,80,17)
"RTN","RCDPBPLM",59,0)
 ;display TP bills Division of Care
"RTN","RCDPBPLM",60,0)
 I "T"=$P($G(^PRCA(430.2,+RCDPDATA(430,RCBILLDA,2,"I"),0)),"^",6) D
"RTN","RCDPBPLM",61,0)
 . S RCDIV=$$DIV^IBJDF2(RCBILLDA) I +RCDIV D
"RTN","RCDPBPLM",62,0)
 .. S RCDIV=$P($G(^DG(40.8,RCDIV,0)),U,1) I RCDIV="" Q
"RTN","RCDPBPLM",63,0)
 .. S RCLINE=RCLINE+1 D SET("Division of Care: "_RCDIV,RCLINE,1,80)
"RTN","RCDPBPLM",64,0)
 S RCLINE=RCLINE+1 D SET("Resulting From",RCLINE,1,80,4.5)
"RTN","RCDPBPLM",65,0)
 I RCDPDATA(430,RCBILLDA,15.1,"E")'="" D
"RTN","RCDPBPLM",66,0)
 . S RCLINE=RCLINE+1 D SET("  Type of Care",RCLINE,1,80,15.1)
"RTN","RCDPBPLM",67,0)
 S RCLINE=RCLINE+1 D SET("        Remark",RCLINE,1,80,15)
"RTN","RCDPBPLM",68,0)
 ;  display comments if there
"RTN","RCDPBPLM",69,0)
 I $O(^PRCA(430,RCBILLDA,10,0)) D
"RTN","RCDPBPLM",70,0)
 . S RCLINE=RCLINE+1 D SET("Comments:",RCLINE,1,80)
"RTN","RCDPBPLM",71,0)
 . S COMMDA=0 F  S COMMDA=$O(^PRCA(430,RCBILLDA,10,COMMDA)) Q:'COMMDA  D
"RTN","RCDPBPLM",72,0)
 .. S RCLINE=RCLINE+1 D SET("  "_$G(^PRCA(430,RCBILLDA,10,COMMDA,0)),RCLINE,1,80)
"RTN","RCDPBPLM",73,0)
 ;
"RTN","RCDPBPLM",74,0)
 ;  int/adm rate and date
"RTN","RCDPBPLM",75,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",76,0)
 S DATA=$$INT^RCMSFN01(RCDPDATA(430,RCBILLDA,10,"I"))
"RTN","RCDPBPLM",77,0)
 S Y=$P(DATA,"^",2) I Y D DD^%DT
"RTN","RCDPBPLM",78,0)
 S RCLINE=RCLINE+1 D SET("Interest Effective Rate Date: "_Y,RCLINE,1,80)
"RTN","RCDPBPLM",79,0)
 D SET(" Annual Rate: "_$P(DATA,"^"),RCLINE,55,80)
"RTN","RCDPBPLM",80,0)
 S DATA=$$ADM^RCMSFN01(RCDPDATA(430,RCBILLDA,10,"I"))
"RTN","RCDPBPLM",81,0)
 S Y=$P(DATA,"^",2) I Y D DD^%DT
"RTN","RCDPBPLM",82,0)
 S RCLINE=RCLINE+1 D SET("   Admin Effective Rate Date: "_Y,RCLINE,1,80)
"RTN","RCDPBPLM",83,0)
 D SET("Monthly Rate: "_$P(DATA,"^"),RCLINE,55,80)
"RTN","RCDPBPLM",84,0)
 S RCLINE=RCLINE+1 D SET("  Last Int/Admin Charge Date",RCLINE,1,80,67)
"RTN","RCDPBPLM",85,0)
 ;
"RTN","RCDPBPLM",86,0)
 ;  put bill balances on first line of second screen
"RTN","RCDPBPLM",87,0)
 F RCLINE=RCLINE+1:1:16 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",88,0)
 ;
"RTN","RCDPBPLM",89,0)
 ;  bill dollars
"RTN","RCDPBPLM",90,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",91,0)
 S RCLINE=RCLINE+1 D SET("Bill Balances           Billed          Paid",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",92,0)
 S RCLINE=RCLINE+1 D SET("     Principal: "_$J(RCDPDATA(430,RCBILLDA,71,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,77,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",93,0)
 D SET("       Original Amt: "_$J(RCDPDATA(430,RCBILLDA,3,"E"),11,2),RCLINE,48,80)
"RTN","RCDPBPLM",94,0)
 S RCLINE=RCLINE+1 D SET("      Interest: "_$J(RCDPDATA(430,RCBILLDA,72,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,78,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",95,0)
 I $G(RCDPDATA(430,RCBILLDA,131,"E")) D SET("Medicare Contr  Adj: "_$J(RCDPDATA(430,RCBILLDA,131,"E"),11,2),RCLINE,48,80)
"RTN","RCDPBPLM",96,0)
 I RCDPDATA(430,RCBILLDA,74,"E") D
"RTN","RCDPBPLM",97,0)
 . S RCLINE=RCLINE+1 D SET("  Marshall Fee: "_$J(RCDPDATA(430,RCBILLDA,74,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,79.1,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",98,0)
 I RCDPDATA(430,RCBILLDA,75,"E") D
"RTN","RCDPBPLM",99,0)
 . S RCLINE=RCLINE+1 D SET("    Court Cost: "_$J(RCDPDATA(430,RCBILLDA,75,"E"),14,2),RCLINE,1,80)
"RTN","RCDPBPLM",100,0)
 S RCLINE=RCLINE+1 D SET("Administrative: "_$J(RCDPDATA(430,RCBILLDA,73,"E"),14,2)_$J(RCDPDATA(430,RCBILLDA,79,"E"),14,2),RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",101,0)
 I $G(RCDPDATA(430,RCBILLDA,132,"E")) D SET("Medicare Unreim Exp: "_$J(RCDPDATA(430,RCBILLDA,132,"E"),11,2),RCLINE,48,80)
"RTN","RCDPBPLM",102,0)
 ;  compute totals
"RTN","RCDPBPLM",103,0)
 S BILLED=0 F %=71,72,73,74,75 S BILLED=BILLED+RCDPDATA(430,RCBILLDA,%,"E")
"RTN","RCDPBPLM",104,0)
 S PAID=0 F %=77,78,79,79.1 S PAID=PAID+RCDPDATA(430,RCBILLDA,%,"E")
"RTN","RCDPBPLM",105,0)
 S RCLINE=RCLINE+1 D SET("       Current: "_$J(BILLED,14,2)_$J(PAID,14,2),RCLINE,1,80)
"RTN","RCDPBPLM",106,0)
 ;
"RTN","RCDPBPLM",107,0)
 ;  show refund if there
"RTN","RCDPBPLM",108,0)
 I RCDPDATA(430,RCBILLDA,79.18,"E") D
"RTN","RCDPBPLM",109,0)
 . S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",110,0)
 . S RCLINE=RCLINE+1 D SET("Refunded Amount",RCLINE,1,80,79.18)
"RTN","RCDPBPLM",111,0)
 . D SET("Date",RCLINE,27,80,79.19)
"RTN","RCDPBPLM",112,0)
 . D SET("By",RCLINE,50,80,79.21)
"RTN","RCDPBPLM",113,0)
 ;
"RTN","RCDPBPLM",114,0)
 ;  accounting data
"RTN","RCDPBPLM",115,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",116,0)
 S RCLINE=RCLINE+1 D SET("Accounting Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",117,0)
 ;  fiscal year multiple
"RTN","RCDPBPLM",118,0)
 D SET("Fiscal Year",RCLINE,20,32,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",119,0)
 D SET("Approp Code",RCLINE,34,46,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",120,0)
 D SET("Amount",RCLINE,50,60,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",121,0)
 S RCFYDA=0 F  S RCFYDA=$O(^PRCA(430,RCBILLDA,2,RCFYDA)) Q:'RCFYDA  D
"RTN","RCDPBPLM",122,0)
 . S DATA=$G(^PRCA(430,RCBILLDA,2,RCFYDA,0))
"RTN","RCDPBPLM",123,0)
 . S RCLINE=RCLINE+1
"RTN","RCDPBPLM",124,0)
 . D SET($J($P(DATA,"^"),30),RCLINE,1,80)     ;fiscal year
"RTN","RCDPBPLM",125,0)
 . D SET($J(RCDPDATA(430,RCBILLDA,203,"E"),6),RCLINE,39,45) ;fund
"RTN","RCDPBPLM",126,0)
 . D SET($J($P(DATA,"^",2),8,2),RCLINE,48,80)   ;amount
"RTN","RCDPBPLM",127,0)
 ; determine which rsc to display
"RTN","RCDPBPLM",128,0)
 S %=RCDPDATA(430,RCBILLDA,255.1,"E") I %="" S %=RCDPDATA(430,RCBILLDA,255,"E")
"RTN","RCDPBPLM",129,0)
 S RCLINE=RCLINE+1 D SET("Rev Srce Code: "_%,RCLINE,1,80)
"RTN","RCDPBPLM",130,0)
 ;
"RTN","RCDPBPLM",131,0)
 ;  collection data
"RTN","RCDPBPLM",132,0)
 S RCLINE=RCLINE+1 D SET(" ",RCLINE,1,80)
"RTN","RCDPBPLM",133,0)
 S RCLINE=RCLINE+1 D SET("Collection Follow up Data",RCLINE,1,80,0,IOUON,IOUOFF)
"RTN","RCDPBPLM",134,0)
 S RCLINE=RCLINE+1 D SET("        Letter1",RCLINE,1,80,61)
"RTN","RCDPBPLM",135,0)
 S RCLINE=RCLINE+1 D SET("        Letter2",RCLINE,1,80,62)
"RTN","RCDPBPLM",136,0)
 S RCLINE=RCLINE+1 D SET("        Letter3",RCLINE,1,80,63)
"RTN","RCDPBPLM",137,0)
 S RCLINE=RCLINE+1 D SET("        Letter4",RCLINE,1,80,68)
"RTN","RCDPBPLM",138,0)
 I RCDPDATA(430,RCBILLDA,68.6,"I") D
"RTN","RCDPBPLM",139,0)
 . S RCLINE=RCLINE+1 D SET("     IRS Letter",RCLINE,1,80,68.6)
"RTN","RCDPBPLM",140,0)
 . D SET("Amount",RCLINE,65,80,68.93)
"RTN","RCDPBPLM",141,0)
 I RCDPDATA(430,RCBILLDA,64,"I") D
"RTN","RCDPBPLM",142,0)
 . S RCLINE=RCLINE+1 D SET("DC/DOJ Ref Date",RCLINE,1,80,64)
"RTN","RCDPBPLM",143,0)
 . D SET("To",RCLINE,40,80,65)
"RTN","RCDPBPLM",144,0)
 . D SET("Amount",RCLINE,65,80,66)
"RTN","RCDPBPLM",145,0)
 ;
"RTN","RCDPBPLM",146,0)
BILLRJ ;====== BILL PROFILE REJECT INSERTED HERE ;LEG
"RTN","RCDPBPLM",147,0)
 I $D(^PRCA(430,RCBILLDA,18)) D REJECT^RCDPBPLI ; prca*4.5*301
"RTN","RCDPBPLM",148,0)
 ;
"RTN","RCDPBPLM",149,0)
 ;  repayment plan (show only if there)
"RTN","RCDPBPLM",150,0)
 I RCDPDATA(430,RCBILLDA,41,"I") D REPAY^RCDPBPLI
"RTN","RCDPBPLM",151,0)
 ;
"RTN","RCDPBPLM",152,0)
 ;  irs data (show only if there)
"RTN","RCDPBPLM",153,0)
 I RCDPDATA(430,RCBILLDA,68.7,"I") D IRS^RCDPBPLI
"RTN","RCDPBPLM",154,0)
 ;
"RTN","RCDPBPLM",155,0)
 ;  dmc data (show only if there)
"RTN","RCDPBPLM",156,0)
 I RCDPDATA(430,RCBILLDA,121,"I") D DMC^RCDPBPLI
"RTN","RCDPBPLM",157,0)
 ;
"RTN","RCDPBPLM",158,0)
 ;  top data (show only if there)
"RTN","RCDPBPLM",159,0)
 I $G(RCDPDATA(430,RCBILLDA,141,"I")) D TOP^RCDPBPLI
"RTN","RCDPBPLM",160,0)
 ;
"RTN","RCDPBPLM",161,0)
 ;
"RTN","RCDPBPLM",162,0)
 ;  cross-servicing referral data(show only if there)
"RTN","RCDPBPLM",163,0)
 I $G(RCDPDATA(430,RCBILLDA,151,"I")) D TCSP^RCDPBPLI
"RTN","RCDPBPLM",164,0)
 ;
"RTN","RCDPBPLM",165,0)
 ;
"RTN","RCDPBPLM",166,0)
 ;  cross-servicing recall data(show only if there)
"RTN","RCDPBPLM",167,0)
 I $G(RCDPDATA(430,RCBILLDA,152,"I"))!$G(RCDPDATA(430,RCBILLDA,153,"I"))!$G(RCDPDATA(430,RCBILLDA,154,"I")) D TCSPRC^RCDPBPLI
"RTN","RCDPBPLM",168,0)
 ;
"RTN","RCDPBPLM",169,0)
 ;
"RTN","RCDPBPLM",170,0)
 ;  get the report type based on category.  if third party show
"RTN","RCDPBPLM",171,0)
 ;  insurance data
"RTN","RCDPBPLM",172,0)
 S REPTYPE=$P($G(^PRCA(430.2,+RCDPDATA(430,RCBILLDA,2,"I"),0)),"^",6)
"RTN","RCDPBPLM",173,0)
 I REPTYPE="T" D INSUR^RCDPBPLI
"RTN","RCDPBPLM",174,0)
 ;
"RTN","RCDPBPLM",175,0)
 ;  report type for employee or vendor, show description field 106
"RTN","RCDPBPLM",176,0)
 I REPTYPE="O"!(REPTYPE="V") D INIT^RCDPBPLI
"RTN","RCDPBPLM",177,0)
 ;
"RTN","RCDPBPLM",178,0)
 ;  show transactions and reasons
"RTN","RCDPBPLM",179,0)
 D TRANINIT^RCDPBPLI
"RTN","RCDPBPLM",180,0)
 ;
"RTN","RCDPBPLM",181,0)
 ;  set valmcnt to number of lines in the list
"RTN","RCDPBPLM",182,0)
 S VALMCNT=RCLINE
"RTN","RCDPBPLM",183,0)
 D HDR
"RTN","RCDPBPLM",184,0)
 Q
"RTN","RCDPBPLM",185,0)
 ;
"RTN","RCDPBPLM",186,0)
 ;
"RTN","RCDPBPLM",187,0)
HDR ;  header code for list manager display
"RTN","RCDPBPLM",188,0)
 ;  requires rcbillda
"RTN","RCDPBPLM",189,0)
 S VALMHDR(1)="***** ACCOUNTS RECEIVABLE BILL PROFILE FOR "_$P($G(^PRCA(430,RCBILLDA,0)),"^")_" *****"
"RTN","RCDPBPLM",190,0)
 ; PRCA*4.5*276 - add explanation of '%' for the user
"RTN","RCDPBPLM",191,0)
 S VALMSG="|% EEOB | Enter ?? for more actions|" ; PRCA*4.5*276
"RTN","RCDPBPLM",192,0)
 Q
"RTN","RCDPBPLM",193,0)
 ;
"RTN","RCDPBPLM",194,0)
 ;
"RTN","RCDPBPLM",195,0)
EXIT ;  exit list manager option and clean up
"RTN","RCDPBPLM",196,0)
 K ^TMP("RCDPBPLM",$J)
"RTN","RCDPBPLM",197,0)
 Q
"RTN","RCDPBPLM",198,0)
 ;
"RTN","RCDPBPLM",199,0)
 ;
"RTN","RCDPBPLM",200,0)
SET(STRING,LINE,COLBEG,COLEND,FIELD,ON,OFF) ;  set array
"RTN","RCDPBPLM",201,0)
 I $G(FIELD) S STRING=STRING_$S(STRING="":"",1:": ")_$G(RCDPDATA(430,RCBILLDA,FIELD,"E"))
"RTN","RCDPBPLM",202,0)
 I STRING="",'$G(FIELD) Q
"RTN","RCDPBPLM",203,0)
 I '$D(@VALMAR@(LINE,0)) D SET^VALM10(LINE,$J("",80))
"RTN","RCDPBPLM",204,0)
 D SET^VALM10(LINE,$$SETSTR^VALM1(STRING,@VALMAR@(LINE,0),COLBEG,COLEND-COLBEG+1))
"RTN","RCDPBPLM",205,0)
 I $G(ON)]""!($G(OFF)]"") D CNTRL^VALM10(LINE,COLBEG,$L(STRING),ON,OFF)
"RTN","RCDPBPLM",206,0)
 Q
"RTN","RCDPBPLM",207,0)
 ;
"RTN","RCDPBPLM",208,0)
 ;
"RTN","RCDPBPLM",209,0)
DIQ430(DA,DR) ;  diq call to retrieve data for dr fields in file 430
"RTN","RCDPBPLM",210,0)
 N D0,DIC,DIQ,DIQ2
"RTN","RCDPBPLM",211,0)
 K RCDPDATA(430,DA)
"RTN","RCDPBPLM",212,0)
 S DIQ(0)="IE",DIC="^PRCA(430,",DIQ="RCDPDATA" D EN^DIQ1
"RTN","RCDPBPLM",213,0)
 Q
"RTN","RCDPLPL3")
0^65^B54165729
"RTN","RCDPLPL3",1,0)
RCDPLPL3 ;WISC/RFJ - link payments listmanager options (link payment) ;1 Jun 00
"RTN","RCDPLPL3",2,0)
 ;;4.5;Accounts Receivable;**153,304,301**;Mar 20, 1995;Build 144
"RTN","RCDPLPL3",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPLPL3",4,0)
 Q
"RTN","RCDPLPL3",5,0)
 ;
"RTN","RCDPLPL3",6,0)
 ;
"RTN","RCDPLPL3",7,0)
LINKPAY ;  link a payment to an account
"RTN","RCDPLPL3",8,0)
 N DA,DIR,DIRUT,DIROUT,DTOUT,DUOUT,X,Y
"RTN","RCDPLPL3",9,0)
 ;
"RTN","RCDPLPL3",10,0)
 D FULL^VALM1
"RTN","RCDPLPL3",11,0)
 S VALMBCK="R"
"RTN","RCDPLPL3",12,0)
 ;
"RTN","RCDPLPL3",13,0)
 W !!,"This option will allow the account to be entered for an unapplied"
"RTN","RCDPLPL3",14,0)
 W !,"payment transaction selected from the above list.  If the selected"
"RTN","RCDPLPL3",15,0)
 W !,"receipt has been previously processed, the selected account in the"
"RTN","RCDPLPL3",16,0)
 W !,"accounts receivable package will be updated with the payment.",!
"RTN","RCDPLPL3",17,0)
 N INDEX,RCDPFLAG,RCERROR,RCGECSCR,RCPAY,RCRECTDA,RCSTATUS,RCTRANDA,RCDCHKSW,HRCDCKSW,RCDPTYPE
"RTN","RCDPLPL3",18,0)
 S INDEX=$$SELPAY^RCDPLPL1 I 'INDEX Q
"RTN","RCDPLPL3",19,0)
 S RCPAY=$G(^TMP("RCDPLPLM",$J,"IDX",INDEX,INDEX))
"RTN","RCDPLPL3",20,0)
 S RCRECTDA=+$P(RCPAY,"^"),RCTRANDA=+$P(RCPAY,"^",2)
"RTN","RCDPLPL3",21,0)
 ;
"RTN","RCDPLPL3",22,0)
 I '$$LOCKREC^RCDPRPLU(RCRECTDA) Q
"RTN","RCDPLPL3",23,0)
 S RCDPTYPE=$P(^RCY(344,RCRECTDA,1,RCTRANDA,0),"^",19)
"RTN","RCDPLPL3",24,0)
 ;
"RTN","RCDPLPL3",25,0)
 ;  check to see if the cr document has been sent for the receipt
"RTN","RCDPLPL3",26,0)
 S RCGECSCR=$P($G(^RCY(344,RCRECTDA,2)),"^")
"RTN","RCDPLPL3",27,0)
 ;  code sheet already sent once, this is a retransmission, check it
"RTN","RCDPLPL3",28,0)
 I RCGECSCR'="" D
"RTN","RCDPLPL3",29,0)
 .   S RCSTATUS=$$STATUS^GECSSGET(RCGECSCR)
"RTN","RCDPLPL3",30,0)
 .   W !!,"This receipt has been processed to FMS with cash receipt document"
"RTN","RCDPLPL3",31,0)
 .   W !,$TR(RCGECSCR," "),".  The current status for this document in the"
"RTN","RCDPLPL3",32,0)
 .   W !,"Generic Code Sheet Stack file is ",RCSTATUS,"."
"RTN","RCDPLPL3",33,0)
 .   ;
"RTN","RCDPLPL3",34,0)
 .   ;  okay to continue if status is Error, Rejected, or not defined (-1)
"RTN","RCDPLPL3",35,0)
 .   I $E(RCSTATUS)="E"!($E(RCSTATUS)="R")!(RCSTATUS=-1) Q
"RTN","RCDPLPL3",36,0)
 .   ;  okay to continue if status is Accepted
"RTN","RCDPLPL3",37,0)
 .   I $E(RCSTATUS)="A" Q
"RTN","RCDPLPL3",38,0)
 .   ;  okay to continue if document is transmitted for 2 days
"RTN","RCDPLPL3",39,0)
 .   I $E(RCSTATUS)="T",$$FMDIFF^XLFDT(DT,$P(^RCY(344,RCRECTDA,0),"^",8))>1 Q
"RTN","RCDPLPL3",40,0)
 .   ;
"RTN","RCDPLPL3",41,0)
 .   W !!,"You cannot link the payment to an account until the FMS cash receipt"
"RTN","RCDPLPL3",42,0)
 .   W !,"document is either Accepted or Rejected by FMS."
"RTN","RCDPLPL3",43,0)
 .   W !,"  1.  If the FMS cash receipt is Accepted by FMS, you will need to"
"RTN","RCDPLPL3",44,0)
 .   W !,"      remove the payment from the station's suspense account online"
"RTN","RCDPLPL3",45,0)
 .   W !,"      in FMS."
"RTN","RCDPLPL3",46,0)
 .   W !,"  2.  If the FMS cash receipt document is rejected by FMS, you can"
"RTN","RCDPLPL3",47,0)
 .   W !,"      use the option Process Receipt under the Receipt Processing"
"RTN","RCDPLPL3",48,0)
 .   W !,"      listmanager screen to regenerate the document.  The payment"
"RTN","RCDPLPL3",49,0)
 .   W !,"      has not been deposited in the station's suspense account by"
"RTN","RCDPLPL3",50,0)
 .   W !,"      FMS since the cash receipt document rejected.",!
"RTN","RCDPLPL3",51,0)
 .   S VALMSG="Try linking this payment again tomorrow."
"RTN","RCDPLPL3",52,0)
 .   D WRITE^RCDPRPLU(VALMSG)
"RTN","RCDPLPL3",53,0)
 .   S RCDPFLAG=1
"RTN","RCDPLPL3",54,0)
 I $G(RCDPFLAG) D QUIT Q
"RTN","RCDPLPL3",55,0)
 ;
"RTN","RCDPLPL3",56,0)
 ;  show payment transaction
"RTN","RCDPLPL3",57,0)
 W !!,"The current payment transaction:",?40,"RECEIPT: ",$P(^RCY(344,RCRECTDA,0),"^")
"RTN","RCDPLPL3",58,0)
 W !,"--------------------------------"
"RTN","RCDPLPL3",59,0)
 D SHOWPAY(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL3",60,0)
 ;
"RTN","RCDPLPL3",61,0)
 ;  transaction has account entered
"RTN","RCDPLPL3",62,0)
 I $P(^RCY(344,RCRECTDA,1,RCTRANDA,0),"^",3) D  Q
"RTN","RCDPLPL3",63,0)
 .   S VALMSG="An account has been assigned to this payment."
"RTN","RCDPLPL3",64,0)
 .   D QUIT
"RTN","RCDPLPL3",65,0)
 ;
"RTN","RCDPLPL3",66,0)
 ;  transaction is cancelled, cannot edit
"RTN","RCDPLPL3",67,0)
 I '$P(^RCY(344,RCRECTDA,1,RCTRANDA,0),"^",4),$P($G(^RCY(344,RCRECTDA,1,RCTRANDA,1)),"^")'="" D  Q
"RTN","RCDPLPL3",68,0)
 .   S VALMSG="Payment Transaction "_RCTRANDA_" is CANCELLED."
"RTN","RCDPLPL3",69,0)
 .   D WRITE^RCDPRPLU(VALMSG)
"RTN","RCDPLPL3",70,0)
 .   D QUIT
"RTN","RCDPLPL3",71,0)
 ;
"RTN","RCDPLPL3",72,0)
 ;PRCA*4.5*304
"RTN","RCDPLPL3",73,0)
 ; Will this link payment link to multiple bills
"RTN","RCDPLPL3",74,0)
 ; Note:  some of the code and logic below is also in tag PROCESS^RCDPLPL4.  
"RTN","RCDPLPL3",75,0)
 ;        If changes in logic are made below, please review this tag as well.
"RTN","RCDPLPL3",76,0)
 ;    
"RTN","RCDPLPL3",77,0)
 S DIR(0)="YO",DIR("B")="NO"
"RTN","RCDPLPL3",78,0)
 S DIR("A")="  Will this transaction be linked to multiple claims (Y/N)"
"RTN","RCDPLPL3",79,0)
 D ^DIR
"RTN","RCDPLPL3",80,0)
 I $G(DTOUT)!($G(DUOUT)) D QUIT Q
"RTN","RCDPLPL3",81,0)
 I +Y D MULTIPLE^RCDPLPL4(RCRECTDA,RCTRANDA,RCGECSCR,$G(RCSTATUS)) D QUIT Q
"RTN","RCDPLPL3",82,0)
 ;end PRCA*4.5*304
"RTN","RCDPLPL3",83,0)
 ;
"RTN","RCDPLPL3",84,0)
 W !!,"Editing Payment: ",RCTRANDA
"RTN","RCDPLPL3",85,0)
DBTRBIL S RCDCHKSW=1,HRCDCKSW=0 D EDITACCT^RCDPURET(RCRECTDA,RCTRANDA) I RCDCHKSW=0 G DBTRBIL   ;prca*4.5*301
"RTN","RCDPLPL3",86,0)
 W !
"RTN","RCDPLPL3",87,0)
 ;  account not entered
"RTN","RCDPLPL3",88,0)
 I '$P(^RCY(344,RCRECTDA,1,RCTRANDA,0),"^",3) D  Q
"RTN","RCDPLPL3",89,0)
 .   S VALMSG="Account was not linked."
"RTN","RCDPLPL3",90,0)
 .   D WRITE^RCDPRPLU(VALMSG)
"RTN","RCDPLPL3",91,0)
 .   D QUIT
"RTN","RCDPLPL3",92,0)
 ;
"RTN","RCDPLPL3",93,0)
 ;  show payment transaction
"RTN","RCDPLPL3",94,0)
 W !,"The NEW payment transaction:",?40,"RECEIPT: ",$P(^RCY(344,RCRECTDA,0),"^")
"RTN","RCDPLPL3",95,0)
 W !,"-----------------------------"
"RTN","RCDPLPL3",96,0)
 D SHOWPAY(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL3",97,0)
 ;
"RTN","RCDPLPL3",98,0)
 I $$ASKACCT()'=1 D  Q
"RTN","RCDPLPL3",99,0)
 .   D DELEACCT^RCDPURET(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL3",100,0)
 .   S VALMSG="Account was deleted and not linked."
"RTN","RCDPLPL3",101,0)
 .   D WRITE^RCDPRPLU(VALMSG)
"RTN","RCDPLPL3",102,0)
 .   D QUIT
"RTN","RCDPLPL3",103,0)
 ;
"RTN","RCDPLPL3",104,0)
 ;  receipt has been processed since the cash receipt document
"RTN","RCDPLPL3",105,0)
 ;  has been generated.  update the new account with payment
"RTN","RCDPLPL3",106,0)
 W !
"RTN","RCDPLPL3",107,0)
 I RCGECSCR'="" D  I RCERROR Q
"RTN","RCDPLPL3",108,0)
 .   W !,"Updating the Linked Account with the payment ..."
"RTN","RCDPLPL3",109,0)
 .   S RCERROR=$$PROCESS^RCBEPAY(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL3",110,0)
 .   ;  an error occurred during processing a payment
"RTN","RCDPLPL3",111,0)
 .   I RCERROR D  Q
"RTN","RCDPLPL3",112,0)
 .   .   W !
"RTN","RCDPLPL3",113,0)
 .   .   W !,"+------------------------------------------------------------------------------+"
"RTN","RCDPLPL3",114,0)
 .   .   W !,"|  An ERROR has occurred when processing payment ",RCTRANDA," on receipt ",$P(^RCY(344,RCRECTDA,0),"^"),".",?79,"|"
"RTN","RCDPLPL3",115,0)
 .   .   W !,"|  The error message returned during processing is:",?79,"|"
"RTN","RCDPLPL3",116,0)
 .   .   W !,"|",?79,"|"
"RTN","RCDPLPL3",117,0)
 .   .   W !,"|  ",$P(RCERROR,"^",2),?79,"|"
"RTN","RCDPLPL3",118,0)
 .   .   W !,"|",?79,"|"
"RTN","RCDPLPL3",119,0)
 .   .   W !,"|  You will need to correct the error before you can link the payment.",?79,"|"
"RTN","RCDPLPL3",120,0)
 .   .   W !,"+------------------------------------------------------------------------------+"
"RTN","RCDPLPL3",121,0)
 .   .   W !
"RTN","RCDPLPL3",122,0)
 .   .   D DELEACCT^RCDPURET(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL3",123,0)
 .   .   S VALMSG="Account was deleted and not linked."
"RTN","RCDPLPL3",124,0)
 .   .   D WRITE^RCDPRPLU(VALMSG)
"RTN","RCDPLPL3",125,0)
 .   .   D QUIT
"RTN","RCDPLPL3",126,0)
 .   ;
"RTN","RCDPLPL3",127,0)
 .   ;  payment processed correctly
"RTN","RCDPLPL3",128,0)
 .   W "  done."
"RTN","RCDPLPL3",129,0)
 .   W !
"RTN","RCDPLPL3",130,0)
 .   ;
"RTN","RCDPLPL3",131,0)
 .   ;PRCA*4.5*304
"RTN","RCDPLPL3",132,0)
 .   D REMCMT^RCDPLPL4(RCRECTDA,RCTRANDA)   ; Remove the supense comment.  No longer needed. 
"RTN","RCDPLPL3",133,0)
 .   ;
"RTN","RCDPLPL3",134,0)
 .   ;File entry in Audit Log
"RTN","RCDPLPL3",135,0)
 .   D AUDIT^RCBEPAY(RCRECTDA,RCTRANDA,"P")
"RTN","RCDPLPL3",136,0)
 .   ;
"RTN","RCDPLPL3",137,0)
 .   ; Update Suspense Status
"RTN","RCDPLPL3",138,0)
 .   D SUSPDIS^RCBEPAY(RCRECTDA,RCTRANDA,"PD")
"RTN","RCDPLPL3",139,0)
 .   ;end PRCA*4.5*304
"RTN","RCDPLPL3",140,0)
 .   ;
"RTN","RCDPLPL3",141,0)
 .   I $E(RCSTATUS)="A" D
"RTN","RCDPLPL3",142,0)
 .   .   W !,"Since the FMS cash receipt document is Accepted in FMS, you need to go"
"RTN","RCDPLPL3",143,0)
 .   .   W !,"online in FMS and transfer the amount paid out of the station's suspense"
"RTN","RCDPLPL3",144,0)
 .   .   W !,"account.",!
"RTN","RCDPLPL3",145,0)
 .   .   ;  send mail message to the RCDP PAYMENTS mail group
"RTN","RCDPLPL3",146,0)
 .   .   W !,"Sending mail message to RCDP PAYMENTS mail group."
"RTN","RCDPLPL3",147,0)
 .   .   D MAILMSG^RCDPLPSR(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL3",148,0)
 .   .   ;  place an x in the fms doc field so it will show on the
"RTN","RCDPLPL3",149,0)
 .   .   ;  suspense report
"RTN","RCDPLPL3",150,0)
 .   .   D EDITFMS^RCDPURET(RCRECTDA,RCTRANDA,"x")
"RTN","RCDPLPL3",151,0)
 .   I $E(RCSTATUS)'="A" D
"RTN","RCDPLPL3",152,0)
 .   .   W !,"Since the FMS cash receipt document is NOT Accepted in FMS, you can use"
"RTN","RCDPLPL3",153,0)
 .   .   W !,"the option Process Receipt located under the Receipt Processing Menu"
"RTN","RCDPLPL3",154,0)
 .   .   W !,"to regenerate the cash receipt document to FMS.",!
"RTN","RCDPLPL3",155,0)
 .   S VALMSG="Payment linked and removed from list."
"RTN","RCDPLPL3",156,0)
 .   D WRITE^RCDPRPLU(VALMSG)
"RTN","RCDPLPL3",157,0)
 ;
"RTN","RCDPLPL3",158,0)
 ;  receipt has not been processed
"RTN","RCDPLPL3",159,0)
 I RCGECSCR="" D
"RTN","RCDPLPL3",160,0)
 .   S VALMSG="Since the receipt has not been processed, accounts will not be updated."
"RTN","RCDPLPL3",161,0)
 .   D WRITE^RCDPRPLU(VALMSG)
"RTN","RCDPLPL3",162,0)
 .   S VALMSG="Payment linked and removed from list."
"RTN","RCDPLPL3",163,0)
 ;
"RTN","RCDPLPL3",164,0)
QUIT ;  call here to unlock and rebuild list
"RTN","RCDPLPL3",165,0)
 L -^RCY(344,RCRECTDA)
"RTN","RCDPLPL3",166,0)
 D INIT^RCDPLPLM
"RTN","RCDPLPL3",167,0)
 Q
"RTN","RCDPLPL3",168,0)
 ;
"RTN","RCDPLPL3",169,0)
 ;
"RTN","RCDPLPL3",170,0)
SHOWPAY(RCRECTDA,RCTRANDA) ;  show the payment transaction
"RTN","RCDPLPL3",171,0)
 N A,D0,DA,DIC,DIQ,DK,DL,DX,S,Y
"RTN","RCDPLPL3",172,0)
 S DIC="^RCY(344,"_RCRECTDA_",1,",DA(1)=RCRECTDA,DA=RCTRANDA,DIQ(0)="C"
"RTN","RCDPLPL3",173,0)
 D EN^DIQ
"RTN","RCDPLPL3",174,0)
 Q
"RTN","RCDPLPL3",175,0)
 ;
"RTN","RCDPLPL3",176,0)
 ;
"RTN","RCDPLPL3",177,0)
ASKACCT() ; ask if its the correct account
"RTN","RCDPLPL3",178,0)
 ;  1 is yes, otherwise no
"RTN","RCDPLPL3",179,0)
 N DIR,DIQ2,DTOUT,DUOUT,X,Y
"RTN","RCDPLPL3",180,0)
 S DIR(0)="YO",DIR("B")="NO"
"RTN","RCDPLPL3",181,0)
 S DIR("A")="  Is this the correct ACCOUNT to apply the payment to"
"RTN","RCDPLPL3",182,0)
 D ^DIR
"RTN","RCDPLPL3",183,0)
 I $G(DTOUT)!($G(DUOUT)) S Y=-1
"RTN","RCDPLPL3",184,0)
 Q Y
"RTN","RCDPLPL4")
0^66^B238259256
"RTN","RCDPLPL4",1,0)
RCDPLPL4 ;ALB/SAB - Multiple Bill Link Payments ;17 Mar 16
"RTN","RCDPLPL4",2,0)
 ;;4.5;Accounts Receivable;**304,301**;Mar 20, 1995;Build 144
"RTN","RCDPLPL4",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPLPL4",4,0)
 ;
"RTN","RCDPLPL4",5,0)
 Q
"RTN","RCDPLPL4",6,0)
 ;
"RTN","RCDPLPL4",7,0)
MULTIPLE(RCRECTDA,RCTRANDA,RCGECSCR,RCSTATUS) ; Process multiple bills for the same receipt transaction.
"RTN","RCDPLPL4",8,0)
 ;
"RTN","RCDPLPL4",9,0)
 N RCAMT,RCCT,RCAMTRM,RCEXIT,RCMSG,RCNWTRAN,RCTACCT,RCTAMT,RCTDATA,RCACT,RCARRAY,RCEXT,RCRSP,RCSPRSS
"RTN","RCDPLPL4",10,0)
 N RCDACNO,I,RCNM,RCBLIEN,RCDACNOI,RCUNAPN,RCQTSP,RCANS,RCDACT,RCDATA,RCPIEN,RCTACCTT
"RTN","RCDPLPL4",11,0)
 N RCTAMT,RCTCMT,RCTDNM,RCUNRCN,RCDCHKSW,HRCDCKSW
"RTN","RCDPLPL4",12,0)
 ;
"RTN","RCDPLPL4",13,0)
 S (RCSPRSS,RCEXIT,RCCT)=0
"RTN","RCDPLPL4",14,0)
 S RCTDATA=$G(^RCY(344,RCRECTDA,1,RCTRANDA,0))
"RTN","RCDPLPL4",15,0)
 I RCTDATA="" D  Q
"RTN","RCDPLPL4",16,0)
 .  S RCMSG="The initial receipt transaction data is missing.  Unable to link a claim to this transaction."
"RTN","RCDPLPL4",17,0)
 .  D WRITE^RCDPRPLU(RCMSG)
"RTN","RCDPLPL4",18,0)
 ;
"RTN","RCDPLPL4",19,0)
 ; Retrieve payment amount on the transaction
"RTN","RCDPLPL4",20,0)
 S (RCAMT,RCAMTRM)=+$P(RCTDATA,U,4)
"RTN","RCDPLPL4",21,0)
 ;
"RTN","RCDPLPL4",22,0)
 I RCAMT=0 D  Q
"RTN","RCDPLPL4",23,0)
 .  S RCMSG="The transaction balance is 0.  Unable to link a claim to this transaction."
"RTN","RCDPLPL4",24,0)
 .  D WRITE^RCDPRPLU(RCMSG)
"RTN","RCDPLPL4",25,0)
 ;
"RTN","RCDPLPL4",26,0)
 ;Retrieve list of Bills to link to payment
"RTN","RCDPLPL4",27,0)
 F  D  Q:RCAMTRM=0  Q:RCEXIT
"RTN","RCDPLPL4",28,0)
 . ;
"RTN","RCDPLPL4",29,0)
 . ;Re-init the suspense quit flag
"RTN","RCDPLPL4",30,0)
 . S RCQTSP=0
"RTN","RCDPLPL4",31,0)
 . ;
"RTN","RCDPLPL4",32,0)
 . ;Ask the user for the account
"RTN","RCDPLPL4",33,0)
 . S RCDCHKSW=1,HRCDCKSW=0,RCACCT=$$GETACCT(RCRECTDA) I RCDCHKSW=0 W ! Q    ;prca*4.5*301
"RTN","RCDPLPL4",34,0)
 . I RCACCT=-1 D  Q
"RTN","RCDPLPL4",35,0)
 . . S RCRSP=$$CONQUIT()
"RTN","RCDPLPL4",36,0)
 . . S:RCRSP=1 RCEXIT=1
"RTN","RCDPLPL4",37,0)
 . ;
"RTN","RCDPLPL4",38,0)
 . I RCACCT=0 D  Q
"RTN","RCDPLPL4",39,0)
 . . W !,?6,"Invalid Bill Number, Please try again...."
"RTN","RCDPLPL4",40,0)
 . S:RCACCT="SUSPENSE" RCACCT=""     ;Payment needs to remain in suspense.
"RTN","RCDPLPL4",41,0)
 . ;
"RTN","RCDPLPL4",42,0)
 . ;Ask the user for the amount
"RTN","RCDPLPL4",43,0)
 . S RCAMT=$$GETAMT(RCACCT,RCAMTRM)
"RTN","RCDPLPL4",44,0)
 . Q:RCAMT=-1
"RTN","RCDPLPL4",45,0)
 . ;
"RTN","RCDPLPL4",46,0)
 . ;Ask the user for Comment if no account is entered.
"RTN","RCDPLPL4",47,0)
 . S RCCMT=""
"RTN","RCDPLPL4",48,0)
 . I RCACCT="" S RCCMT=$$GETCMT()
"RTN","RCDPLPL4",49,0)
 . ;timed out or ^ - exit.
"RTN","RCDPLPL4",50,0)
 . I (RCCMT=-1)!(RCCMT="^") Q
"RTN","RCDPLPL4",51,0)
 . ;
"RTN","RCDPLPL4",52,0)
 . ;Update the array and amount remaining.
"RTN","RCDPLPL4",53,0)
 . S RCCT=RCCT+1
"RTN","RCDPLPL4",54,0)
 . S RCARRAY(RCCT)=RCACCT_U_RCAMT_U_RCCMT_U_$$GETACTNM(RCACCT)
"RTN","RCDPLPL4",55,0)
 . S RCAMTRM=RCAMTRM-RCAMT
"RTN","RCDPLPL4",56,0)
 . ;
"RTN","RCDPLPL4",57,0)
 . ;Check to see if user wishes to continue
"RTN","RCDPLPL4",58,0)
 . I RCAMTRM>0 D
"RTN","RCDPLPL4",59,0)
 . . ;
"RTN","RCDPLPL4",60,0)
 . . ;ask if user wishes to continue
"RTN","RCDPLPL4",61,0)
 . . S RCRSP=$$CONTINUE(RCAMTRM)
"RTN","RCDPLPL4",62,0)
 . . ;
"RTN","RCDPLPL4",63,0)
 . . ;User wishes to continue
"RTN","RCDPLPL4",64,0)
 . . Q:RCRSP=1
"RTN","RCDPLPL4",65,0)
 . . ;
"RTN","RCDPLPL4",66,0)
 . . ;if no, ask if user is sure and that all selected payments will not be linked.
"RTN","RCDPLPL4",67,0)
 . . S RCRSP=$$CONQUIT()
"RTN","RCDPLPL4",68,0)
 . . I RCRSP=1 S RCEXIT=1
"RTN","RCDPLPL4",69,0)
 ;
"RTN","RCDPLPL4",70,0)
 ; If the user is exiting before completion, quit.
"RTN","RCDPLPL4",71,0)
 Q:RCEXIT
"RTN","RCDPLPL4",72,0)
 ;
"RTN","RCDPLPL4",73,0)
 ;State all money is disbursed and display all accounts for confirmation
"RTN","RCDPLPL4",74,0)
 W !!,"*** RECEIPT HAS BEEN FULLY DISBURSED ***",!
"RTN","RCDPLPL4",75,0)
 ;
"RTN","RCDPLPL4",76,0)
 ; Ask if user wishes to review the list again
"RTN","RCDPLPL4",77,0)
 S RCANS=$$GETANS(1)
"RTN","RCDPLPL4",78,0)
 ;
"RTN","RCDPLPL4",79,0)
 ;Spacing line
"RTN","RCDPLPL4",80,0)
 W !
"RTN","RCDPLPL4",81,0)
 ;
"RTN","RCDPLPL4",82,0)
 ; Review the list if necessary
"RTN","RCDPLPL4",83,0)
 I RCANS=1 D
"RTN","RCDPLPL4",84,0)
 . S I=0
"RTN","RCDPLPL4",85,0)
 . W !,?5,"PATIENT NAME",?36,"ACCOUNT",?50,"PAYMENT TO APPLY",!
"RTN","RCDPLPL4",86,0)
 . F I=1:1:RCCT D
"RTN","RCDPLPL4",87,0)
 . . S (RCNM,RCDACNO,RCDACNOI)=""
"RTN","RCDPLPL4",88,0)
 . . S RCDATA=$G(RCARRAY(I))
"RTN","RCDPLPL4",89,0)
 . . S RCDACT=$P(RCDATA,U)
"RTN","RCDPLPL4",90,0)
 . . S:RCDACT="" RCNM="SUSPENSE"
"RTN","RCDPLPL4",91,0)
 . . I RCDACT[";DPT" D
"RTN","RCDPLPL4",92,0)
 . . . S RCNM=$P($G(^DPT($P(RCDACT,";"),0)),U)
"RTN","RCDPLPL4",93,0)
 . . . S RCDACNO=""
"RTN","RCDPLPL4",94,0)
 . . I RCDACT[";PRCA" D
"RTN","RCDPLPL4",95,0)
 . . . S RCDACNOI=$P(RCDACT,";")
"RTN","RCDPLPL4",96,0)
 . . . S RCDACNO=$P($G(^PRCA(430,$P(RCDACNOI,U),0)),U)
"RTN","RCDPLPL4",97,0)
 . . . S RCPIEN=$P($G(^DGCR(399,RCDACNOI,0)),U,2)
"RTN","RCDPLPL4",98,0)
 . . . I RCPIEN="" S RCNM="PATIENT NAME NOT FOUND" Q
"RTN","RCDPLPL4",99,0)
 . . . S RCNM=$P($G(^DPT(RCPIEN,0)),U)
"RTN","RCDPLPL4",100,0)
 . . . I RCNM="" S RCNM="PATIENT NAME NOT FOUND"
"RTN","RCDPLPL4",101,0)
 . . W ?5,RCNM,?36,RCDACNO,?50,"$",$J($FN($P(RCDATA,U,2),",",2),15),!
"RTN","RCDPLPL4",102,0)
 ;
"RTN","RCDPLPL4",103,0)
 ; Ask the user if they wish to update.  Quit if they time out, "^" out, or say No to updating.
"RTN","RCDPLPL4",104,0)
 S RCANS=$$GETANS(2)
"RTN","RCDPLPL4",105,0)
 Q:RCANS'=1
"RTN","RCDPLPL4",106,0)
 ;
"RTN","RCDPLPL4",107,0)
 ;Initialize error flag
"RTN","RCDPLPL4",108,0)
 S RCERROR=0
"RTN","RCDPLPL4",109,0)
 ;
"RTN","RCDPLPL4",110,0)
 ;Surpress PNORBILL^RCDPURED output
"RTN","RCDPLPL4",111,0)
 S RCSPRSS=1
"RTN","RCDPLPL4",112,0)
 ;
"RTN","RCDPLPL4",113,0)
 ;create line spacing
"RTN","RCDPLPL4",114,0)
 W !!
"RTN","RCDPLPL4",115,0)
 ;
"RTN","RCDPLPL4",116,0)
 ;Link the payments
"RTN","RCDPLPL4",117,0)
 F RCACT=1:1:RCCT D  Q:RCERROR
"RTN","RCDPLPL4",118,0)
 . ;
"RTN","RCDPLPL4",119,0)
 . ;Extract data to update
"RTN","RCDPLPL4",120,0)
 . S RCTAMT=$P(RCARRAY(RCACT),U,2)   ;Payment Amount
"RTN","RCDPLPL4",121,0)
 . S RCTACCT=$P(RCARRAY(RCACT),U,1)    ;Account to link to.
"RTN","RCDPLPL4",122,0)
 . S RCTCMT=$P(RCARRAY(RCACT),U,3)
"RTN","RCDPLPL4",123,0)
 . S RCTDNM=$P(RCARRAY(RCACT),U,4)
"RTN","RCDPLPL4",124,0)
 . S RCTACCTT=$S(RCTACCT="":"the Suspense Item",1:RCTACCT)
"RTN","RCDPLPL4",125,0)
 . ;
"RTN","RCDPLPL4",126,0)
 . ;If not the first transaction, create a new one
"RTN","RCDPLPL4",127,0)
 . I RCACT'=1 D  Q
"RTN","RCDPLPL4",128,0)
 . . ;
"RTN","RCDPLPL4",129,0)
 . . ; Create new transaction
"RTN","RCDPLPL4",130,0)
 . . S RCNWTRAN=$$COPYTRAN(RCRECTDA,RCTDATA,RCTAMT,RCGECSCR)
"RTN","RCDPLPL4",131,0)
 . . ;
"RTN","RCDPLPL4",132,0)
 . . ; Link the Payment using the display name
"RTN","RCDPLPL4",133,0)
 . . D LINKPAY(RCRECTDA,RCNWTRAN,RCTDNM)
"RTN","RCDPLPL4",134,0)
 . . ;
"RTN","RCDPLPL4",135,0)
 . . ; build unapplied deposit number
"RTN","RCDPLPL4",136,0)
 . . S RCUNRCN=$P($G(^RCY(344,RCRECTDA,0)),U)
"RTN","RCDPLPL4",137,0)
 . . S RCUNAPN=$S($L(RCUNRCN)>9:$E(RCUNRCN,$L(RCUNRCN-9),$L(RCUNRCN)),1:RCUNRCN)
"RTN","RCDPLPL4",138,0)
 . . S RCUNAPN=RCUNAPN_$E("0000",1,4-$L(RCNWTRAN))_RCNWTRAN
"RTN","RCDPLPL4",139,0)
 . . D SETUNAPP^RCDPURET(RCRECTDA,RCNWTRAN,RCUNAPN) ; add new unapplied deposit #
"RTN","RCDPLPL4",140,0)
 . . ;
"RTN","RCDPLPL4",141,0)
 . . ; If creating a new suspense item, update the comment field and audit logs
"RTN","RCDPLPL4",142,0)
 . . I RCTCMT'="" D
"RTN","RCDPLPL4",143,0)
 . . . ;
"RTN","RCDPLPL4",144,0)
 . . . D UPDCMT(RCRECTDA,RCNWTRAN,RCTCMT)  ; add comment
"RTN","RCDPLPL4",145,0)
 . . . I $G(RCGECSCR)'="" D
"RTN","RCDPLPL4",146,0)
 . . . . D AUDIT^RCBEPAY(RCRECTDA,RCNWTRAN,"I")
"RTN","RCDPLPL4",147,0)
 . . . . D SUSPDIS^RCBEPAY(RCRECTDA,RCNWTRAN,"P")
"RTN","RCDPLPL4",148,0)
 . . . W !,"***** PAYMENT AMOUNT LEFT IN SUSPENSE = $",$J(RCTAMT,"",2)," ... done."
"RTN","RCDPLPL4",149,0)
 . . ;
"RTN","RCDPLPL4",150,0)
 . . ; If linking an account, process the linking
"RTN","RCDPLPL4",151,0)
 . . I RCTCMT="" D
"RTN","RCDPLPL4",152,0)
 . . . ;
"RTN","RCDPLPL4",153,0)
 . . . ; If the receipt has been processed, process the payment
"RTN","RCDPLPL4",154,0)
 . . . I $G(RCGECSCR)'="" D  Q
"RTN","RCDPLPL4",155,0)
 . . . . W !,RCTDNM," - Updating the Linked Account with PMT = $",$J(RCTAMT,"",2)," ... done."
"RTN","RCDPLPL4",156,0)
 . . . . D REMCMT(RCRECTDA,RCNWTRAN)   ; Remove the supense comment.  No longer needed.
"RTN","RCDPLPL4",157,0)
 . . . . D PROCESS(RCRECTDA,RCNWTRAN,RCTDNM)
"RTN","RCDPLPL4",158,0)
 . . . ;
"RTN","RCDPLPL4",159,0)
 . . . ; The receipt has not been processed
"RTN","RCDPLPL4",160,0)
 . . . W !,RCTDNM," - Receipt has not been processed.  Account linked but not"
"RTN","RCDPLPL4",161,0)
 . . . W !,?6,"updated for the PMT = $",$J(RCTAMT,"",2)
"RTN","RCDPLPL4",162,0)
 . ;
"RTN","RCDPLPL4",163,0)
 . ;If this is the first transaction, adjust the payment amount to be the amount not split out.
"RTN","RCDPLPL4",164,0)
 . I RCACT=1 D
"RTN","RCDPLPL4",165,0)
 . . ;
"RTN","RCDPLPL4",166,0)
 . . ; Modify the original payment amount
"RTN","RCDPLPL4",167,0)
 . . D ADJTRAMT(RCRECTDA,RCTRANDA,RCTAMT,RCGECSCR)
"RTN","RCDPLPL4",168,0)
 . . ;
"RTN","RCDPLPL4",169,0)
 . . ; Adjusting the amount in suspense, update the comment field and audit logs
"RTN","RCDPLPL4",170,0)
 . . I RCTCMT'="" D  Q
"RTN","RCDPLPL4",171,0)
 . . . D UPDCMT(RCRECTDA,RCTRANDA,RCTCMT)  ; add comment
"RTN","RCDPLPL4",172,0)
 . . . I $G(RCGECSCR)'="" D
"RTN","RCDPLPL4",173,0)
 . . . . D AUDIT^RCBEPAY(RCRECTDA,RCTRANDA,"I")
"RTN","RCDPLPL4",174,0)
 . . . . D SUSPDIS^RCBEPAY(RCRECTDA,RCTRANDA,"P")
"RTN","RCDPLPL4",175,0)
 . . . W !,"***** PAYMENT AMOUNT LEFT IN SUSPENSE = $",$J(RCTAMT,"",2)," ... done."
"RTN","RCDPLPL4",176,0)
 . . ;
"RTN","RCDPLPL4",177,0)
 . . ; Link the Payment, send account if PRCA, Patient name in Patient
"RTN","RCDPLPL4",178,0)
 . . D LINKPAY(RCRECTDA,RCTRANDA,RCTDNM)
"RTN","RCDPLPL4",179,0)
 . . ;
"RTN","RCDPLPL4",180,0)
 . . ;Remove the comment, item is no longer in suspense
"RTN","RCDPLPL4",181,0)
 . . D REMCMT(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL4",182,0)
 . . ;
"RTN","RCDPLPL4",183,0)
 . . ; If the receipt has been processed, process the payment
"RTN","RCDPLPL4",184,0)
 . . I $G(RCGECSCR)'="" D  Q
"RTN","RCDPLPL4",185,0)
 . . . W !,RCTDNM," - Updating the Linked Account with PMT = $",$J(RCTAMT,"",2)," ... done."
"RTN","RCDPLPL4",186,0)
 . . . D PROCESS(RCRECTDA,RCTRANDA,RCTDNM)
"RTN","RCDPLPL4",187,0)
 . . ;
"RTN","RCDPLPL4",188,0)
 . . ; The receipt has not been processed
"RTN","RCDPLPL4",189,0)
 . . W !,RCTDNM," - Receipt has not been processed.  Account linked but not"
"RTN","RCDPLPL4",190,0)
 . . W !,?6,"updated for the PMT = $",$J(RCTAMT,"",2)
"RTN","RCDPLPL4",191,0)
 ;
"RTN","RCDPLPL4",192,0)
 W !!
"RTN","RCDPLPL4",193,0)
 ;
"RTN","RCDPLPL4",194,0)
 D ENDMSG(RCSTATUS)
"RTN","RCDPLPL4",195,0)
 ;
"RTN","RCDPLPL4",196,0)
 D WRITE^RCDPRPLU(" ")
"RTN","RCDPLPL4",197,0)
 ;
"RTN","RCDPLPL4",198,0)
 Q
"RTN","RCDPLPL4",199,0)
 ;
"RTN","RCDPLPL4",200,0)
GETACCT(RCRECTDA) ; Ask the user for the account
"RTN","RCDPLPL4",201,0)
 ;
"RTN","RCDPLPL4",202,0)
 N X,Y,DTOUT,DUOUT,DIR,DIROUT,DIRUT,DA,RCSUSFLG,RCSTAT
"RTN","RCDPLPL4",203,0)
 ;
"RTN","RCDPLPL4",204,0)
 S RCSUSFLG=0
"RTN","RCDPLPL4",205,0)
 S DIR("A")="BILL NUMBER: ",DIR(0)="FAO"
"RTN","RCDPLPL4",206,0)
 S DIR("PRE")="I X=""SUSPENSE"" S X=""^"",RCSUSFLG=1"
"RTN","RCDPLPL4",207,0)
 D ^DIR
"RTN","RCDPLPL4",208,0)
 Q:RCSUSFLG "SUSPENSE"
"RTN","RCDPLPL4",209,0)
 I $D(DTOUT)!$D(DUOUT)!(Y="")  Q -1
"RTN","RCDPLPL4",210,0)
 ;
"RTN","RCDPLPL4",211,0)
 ;Force to all caps
"RTN","RCDPLPL4",212,0)
 S Y=$$UP^XLFSTR(Y)
"RTN","RCDPLPL4",213,0)
 ;
"RTN","RCDPLPL4",214,0)
 ; Check for valid bill number
"RTN","RCDPLPL4",215,0)
 I '$O(^PRCA(430,"D",Y,"")) S Y=""      ; Not a valid bill number
"RTN","RCDPLPL4",216,0)
 ;
"RTN","RCDPLPL4",217,0)
 Q:Y="" 0   ; quit if invalid bill number or lookup number
"RTN","RCDPLPL4",218,0)
 ;
"RTN","RCDPLPL4",219,0)
 S X=Y
"RTN","RCDPLPL4",220,0)
 S DA(1)=RCRECTDA
"RTN","RCDPLPL4",221,0)
 D PNORBILL^RCDPURED
"RTN","RCDPLPL4",222,0)
 ; 
"RTN","RCDPLPL4",223,0)
 ;if this is an account, is it active?  If not, request a new account.
"RTN","RCDPLPL4",224,0)
 I $G(X)[";PRCA" D  Q:RCSTAT'="ACTIVE" 0
"RTN","RCDPLPL4",225,0)
 . S RCSTAT=$$GET1^DIQ(430,$P($G(X),";")_",",8,"E")
"RTN","RCDPLPL4",226,0)
 . I RCSTAT'="ACTIVE",$P($G(^RCD(340,+$P(^PRCA(430,$P($G(X),";"),0),"^",9),0)),"^")[";DPT(" W !,"This bill's status is currently ",RCSTAT,".",!,"Please select a different account."
"RTN","RCDPLPL4",227,0)
 ;
"RTN","RCDPLPL4",228,0)
 ;Something went wrong.  Try again.
"RTN","RCDPLPL4",229,0)
 I '$D(X) Q 0
"RTN","RCDPLPL4",230,0)
 ;
"RTN","RCDPLPL4",231,0)
 ; Account found, return it
"RTN","RCDPLPL4",232,0)
 Q X
"RTN","RCDPLPL4",233,0)
 ;
"RTN","RCDPLPL4",234,0)
GETAMT(RCACCT,RCAMT) ; Ask the user for the amount
"RTN","RCDPLPL4",235,0)
 ;
"RTN","RCDPLPL4",236,0)
 N X,Y,DTOUT,DUOUT,DIR,DIROUT,DIRUT,DA,RCFLG,AMTFLG
"RTN","RCDPLPL4",237,0)
 ;
"RTN","RCDPLPL4",238,0)
 ;
"RTN","RCDPLPL4",239,0)
 S RCFLG=0
"RTN","RCDPLPL4",240,0)
 F  D  Q:RCFLG
"RTN","RCDPLPL4",241,0)
 . S AMTFLG=1  ; Set amount flag check to 1 in case the account is a SUSPENSE account
"RTN","RCDPLPL4",242,0)
 . S DIR("A")="Amount to apply to Account",DIR(0)="N^0.01:"_$J(RCAMT,"",2)_":2"
"RTN","RCDPLPL4",243,0)
 . D ^DIR
"RTN","RCDPLPL4",244,0)
 . I $D(DTOUT)!$D(DUOUT)!(Y="")  S Y=-1,RCFLG=1 Q
"RTN","RCDPLPL4",245,0)
 . ;If not a SUSPENSE account, check the balance.
"RTN","RCDPLPL4",246,0)
 . I RCACCT'="" S AMTFLG=$$PAYCHK(RCACCT,Y)
"RTN","RCDPLPL4",247,0)
 . ;amount applied is greater than the amount owed.  Try again
"RTN","RCDPLPL4",248,0)
 . Q:'AMTFLG
"RTN","RCDPLPL4",249,0)
 . I +Y>0 S RCFLG=1 Q
"RTN","RCDPLPL4",250,0)
 . S Y=0,RCFLG=1
"RTN","RCDPLPL4",251,0)
 Q Y
"RTN","RCDPLPL4",252,0)
 ;
"RTN","RCDPLPL4",253,0)
GETCMT() ; Ask the user for the amount
"RTN","RCDPLPL4",254,0)
 ;
"RTN","RCDPLPL4",255,0)
 N X,Y,DTOUT,DUOUT,DIR,DIROUT,DIRUT
"RTN","RCDPLPL4",256,0)
 F  D  Q:Y'=""
"RTN","RCDPLPL4",257,0)
 . S DIR(0)="FAO^3:50"
"RTN","RCDPLPL4",258,0)
 . S DIR("A")="Comment: "
"RTN","RCDPLPL4",259,0)
 . D ^DIR
"RTN","RCDPLPL4",260,0)
 . ;strip all leading and trailing spaces
"RTN","RCDPLPL4",261,0)
 . S Y=$$TRIM^XLFSTR(Y)
"RTN","RCDPLPL4",262,0)
 . I Y="" W !,"A comment is required when changing the status of an item in Suspense.  Please",!,"try again." Q
"RTN","RCDPLPL4",263,0)
 . I $D(DTOUT) S Y=-1
"RTN","RCDPLPL4",264,0)
 Q Y
"RTN","RCDPLPL4",265,0)
 ;
"RTN","RCDPLPL4",266,0)
CONTINUE(RCAMTRM) ; Ask the user to see if they wish to continue
"RTN","RCDPLPL4",267,0)
 ;
"RTN","RCDPLPL4",268,0)
 N X,Y,DTOUT,DUOUT,DIR,DIROUT,DIRUT
"RTN","RCDPLPL4",269,0)
 S DIR("A")="Receipt has $"_$J(RCAMTRM,10,2)_" left to link.  Do you wish to link another? ",DIR(0)="YA"
"RTN","RCDPLPL4",270,0)
 D ^DIR
"RTN","RCDPLPL4",271,0)
 I $D(DTOUT)!$D(DUOUT)!(Y="")  Q -1
"RTN","RCDPLPL4",272,0)
 Q Y
"RTN","RCDPLPL4",273,0)
 ;
"RTN","RCDPLPL4",274,0)
 ; Confirm with the user that the wish to stop before completing the linking of payments
"RTN","RCDPLPL4",275,0)
CONQUIT() ;
"RTN","RCDPLPL4",276,0)
 ;
"RTN","RCDPLPL4",277,0)
 N X,Y,DTOUT,DUOUT,DIR,DIROUT,DIRUT
"RTN","RCDPLPL4",278,0)
 S DIR("A",1)="Exiting now will prevent the linking of any previously selected claims to this"
"RTN","RCDPLPL4",279,0)
 S DIR("A")="receipt.  Are you sure? ",DIR(0)="YA"
"RTN","RCDPLPL4",280,0)
 D ^DIR
"RTN","RCDPLPL4",281,0)
 I $D(DTOUT)!$D(DUOUT)!(Y="")  Q 1
"RTN","RCDPLPL4",282,0)
 Q Y
"RTN","RCDPLPL4",283,0)
 ;
"RTN","RCDPLPL4",284,0)
 ;Create a new transaction using an existing transaction as the foundation.
"RTN","RCDPLPL4",285,0)
COPYTRAN(RCRECTDA,RCTDATA,RCAMT,RCGECSCR) ;
"RTN","RCDPLPL4",286,0)
 ;
"RTN","RCDPLPL4",287,0)
 N RCNWTRAN,DR,DA,DTOUT,DIE,X,Y,RCTDATA3
"RTN","RCDPLPL4",288,0)
 ;
"RTN","RCDPLPL4",289,0)
 S RCTDATA3=$G(^RCY(344,RCRECTDA,1,RCTRANDA,3))
"RTN","RCDPLPL4",290,0)
 ;Create a new transaction
"RTN","RCDPLPL4",291,0)
 S RCNWTRAN=$$ADDTRAN^RCDPURET(RCRECTDA)
"RTN","RCDPLPL4",292,0)
 S RCCMT="Multi-Trans Split"
"RTN","RCDPLPL4",293,0)
 ;
"RTN","RCDPLPL4",294,0)
 ;Update Transaction
"RTN","RCDPLPL4",295,0)
 S DR=".02////"_$P(RCTDATA,U,2)       ;Original Confirmation #
"RTN","RCDPLPL4",296,0)
 S DR=DR_";.04///"_RCAMT              ;Amount
"RTN","RCDPLPL4",297,0)
 S DR=DR_";.06////"_$P(RCTDATA,U,6)   ;Original date of payment
"RTN","RCDPLPL4",298,0)
 S DR=DR_";.07////"_$P(RCTDATA,U,7)   ;Original Check #
"RTN","RCDPLPL4",299,0)
 S DR=DR_";.08////"_$P(RCTDATA,U,8)   ;Original Check routing #
"RTN","RCDPLPL4",300,0)
 S DR=DR_";.1////"_$P(RCTDATA,U,10)   ;Original date on the check
"RTN","RCDPLPL4",301,0)
 S DR=DR_";.11////"_$P(RCTDATA,U,11)  ;Original CC number
"RTN","RCDPLPL4",302,0)
 S DR=DR_";.12////"_$P(RCTDATA,U,12)  ;Original user who entered the check
"RTN","RCDPLPL4",303,0)
 S DR=DR_";.13////"_$P(RCTDATA,U,13)  ;Original check account #
"RTN","RCDPLPL4",304,0)
 S DR=DR_";.14///"_DUZ                ;User Linking the payment
"RTN","RCDPLPL4",305,0)
 S DR=DR_";1.02////"_RCCMT            ;Initial Comment
"RTN","RCDPLPL4",306,0)
 S DR=DR_";3.02////"_$P(RCTDATA3,U,2) ;Date Trans. originally suspense
"RTN","RCDPLPL4",307,0)
 S DR=DR_";3.03////"_$P(RCTDATA3,U,3) ;User who originally suspended Trans.
"RTN","RCDPLPL4",308,0)
 S DIE="^RCY(344,"_RCRECTDA_",1,"
"RTN","RCDPLPL4",309,0)
 S DA=RCNWTRAN,DA(1)=RCRECTDA
"RTN","RCDPLPL4",310,0)
 D ^DIE
"RTN","RCDPLPL4",311,0)
 S $P(^RCY(344,RCRECTDA,1,RCNWTRAN,0),"^",19)=$G(RCDPTYPE)
"RTN","RCDPLPL4",312,0)
 ;
"RTN","RCDPLPL4",313,0)
 ;Update the Audit Log
"RTN","RCDPLPL4",314,0)
 I $G(RCGECSCR)'="" D AUDIT^RCBEPAY(RCRECTDA,RCNWTRAN,"I")
"RTN","RCDPLPL4",315,0)
 ;
"RTN","RCDPLPL4",316,0)
 Q RCNWTRAN
"RTN","RCDPLPL4",317,0)
 ;
"RTN","RCDPLPL4",318,0)
 ;Adjust the original transaction's payment amount to match to the actual, split amount.
"RTN","RCDPLPL4",319,0)
ADJTRAMT(RCRECTDA,RCTRANDA,RCAMT,RCGECSCR) ;
"RTN","RCDPLPL4",320,0)
 ;
"RTN","RCDPLPL4",321,0)
 N RCCMT,DR,DIE,DA,DTOUT
"RTN","RCDPLPL4",322,0)
 S RCCMT="Multi-Trans Split"
"RTN","RCDPLPL4",323,0)
 ;
"RTN","RCDPLPL4",324,0)
 S DR=".04///"_RCAMT_";1.02///"_RCCMT
"RTN","RCDPLPL4",325,0)
 S DIE="^RCY(344,"_RCRECTDA_",1,"
"RTN","RCDPLPL4",326,0)
 S DA=RCTRANDA,DA(1)=RCRECTDA
"RTN","RCDPLPL4",327,0)
 D ^DIE
"RTN","RCDPLPL4",328,0)
 D LASTEDIT^RCDPUREC(RCRECTDA)
"RTN","RCDPLPL4",329,0)
 ;
"RTN","RCDPLPL4",330,0)
 ;Update the Audit Log
"RTN","RCDPLPL4",331,0)
 I $G(RCGECSCR)'="" D AUDIT^RCBEPAY(RCRECTDA,RCTRANDA,"I")
"RTN","RCDPLPL4",332,0)
 Q
"RTN","RCDPLPL4",333,0)
 ;
"RTN","RCDPLPL4",334,0)
 ;Link the Transaction to an existing account
"RTN","RCDPLPL4",335,0)
LINKPAY(RCRECTDA,RCTRANDA,RCACCT) ;
"RTN","RCDPLPL4",336,0)
 ;
"RTN","RCDPLPL4",337,0)
 N DR,DIE,DA,DTOUT
"RTN","RCDPLPL4",338,0)
 S DR=".09///"_RCACCT
"RTN","RCDPLPL4",339,0)
 S DIE="^RCY(344,"_RCRECTDA_",1,"
"RTN","RCDPLPL4",340,0)
 S DA=RCTRANDA,DA(1)=RCRECTDA
"RTN","RCDPLPL4",341,0)
 D ^DIE
"RTN","RCDPLPL4",342,0)
 D LASTEDIT^RCDPUREC(RCRECTDA)
"RTN","RCDPLPL4",343,0)
 Q
"RTN","RCDPLPL4",344,0)
 ;
"RTN","RCDPLPL4",345,0)
 ;Remove the suspense comment, item no longer in suspense
"RTN","RCDPLPL4",346,0)
REMCMT(RCRECTDA,RCTRANDA) ;
"RTN","RCDPLPL4",347,0)
 ;
"RTN","RCDPLPL4",348,0)
 N DR,DIE,DA,DTOUT
"RTN","RCDPLPL4",349,0)
 S DR="1.02///@"
"RTN","RCDPLPL4",350,0)
 S DIE="^RCY(344,"_RCRECTDA_",1,"
"RTN","RCDPLPL4",351,0)
 S DA=RCTRANDA,DA(1)=RCRECTDA
"RTN","RCDPLPL4",352,0)
 D ^DIE
"RTN","RCDPLPL4",353,0)
 D LASTEDIT^RCDPUREC(RCRECTDA)
"RTN","RCDPLPL4",354,0)
 Q
"RTN","RCDPLPL4",355,0)
 ;
"RTN","RCDPLPL4",356,0)
GETACTNM(RCACCT) ;
"RTN","RCDPLPL4",357,0)
 N RCACCTL,RCIEN,RCFILE
"RTN","RCDPLPL4",358,0)
 S RCACCTL=""
"RTN","RCDPLPL4",359,0)
 Q:RCACCT="" RCACCTL
"RTN","RCDPLPL4",360,0)
 S RCFILE=$S(RCACCT[";PRCA(430":430,1:2)
"RTN","RCDPLPL4",361,0)
 S RCIEN=$P(RCACCT,";")
"RTN","RCDPLPL4",362,0)
 S RCACCTL=$$GET1^DIQ(RCFILE,RCIEN_",",".01","E")
"RTN","RCDPLPL4",363,0)
 S:$L(RCACCTL,"-")>1 RCACCTL=$P(RCACCTL,"-",2)
"RTN","RCDPLPL4",364,0)
 Q RCACCTL
"RTN","RCDPLPL4",365,0)
 ;
"RTN","RCDPLPL4",366,0)
 ;Update the suspense comment
"RTN","RCDPLPL4",367,0)
UPDCMT(RCRECTDA,RCTRANDA,RCCMT) ;
"RTN","RCDPLPL4",368,0)
 ;
"RTN","RCDPLPL4",369,0)
 N DR,DIE,DA,DTOUT
"RTN","RCDPLPL4",370,0)
 S DR="1.02///"_RCCMT_";" S DIE="^RCY(344,"_RCRECTDA_",1,"
"RTN","RCDPLPL4",371,0)
 S DA=RCTRANDA,DA(1)=RCRECTDA
"RTN","RCDPLPL4",372,0)
 D ^DIE
"RTN","RCDPLPL4",373,0)
 Q
"RTN","RCDPLPL4",374,0)
 ;
"RTN","RCDPLPL4",375,0)
 ;Process and update the payment amounts
"RTN","RCDPLPL4",376,0)
 ;Note:  some of the code and logic below is also in tag PROCESS^RCDPLPL3.  
"RTN","RCDPLPL4",377,0)
 ;       If changes in logic are made below, please review this tag as well.
"RTN","RCDPLPL4",378,0)
PROCESS(RCRECTDA,RCTRANDA,RCTDNM) ;
"RTN","RCDPLPL4",379,0)
 ;
"RTN","RCDPLPL4",380,0)
 N RCERROR
"RTN","RCDPLPL4",381,0)
 S RCERROR=$$PROCESS^RCBEPAY(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL4",382,0)
 ;  an error occurred during processing a payment
"RTN","RCDPLPL4",383,0)
 I RCERROR D  Q
"RTN","RCDPLPL4",384,0)
 . W !
"RTN","RCDPLPL4",385,0)
 . W !,"+------------------------------------------------------------------------------+"
"RTN","RCDPLPL4",386,0)
 . W !,"|  An ERROR has occurred when processing payment ",RCTRANDA," on receipt ",$P(^RCY(344,RCRECTDA,0),"^"),".",?79,"|"
"RTN","RCDPLPL4",387,0)
 . W !,"|  The error message returned during processing is:",?79,"|"
"RTN","RCDPLPL4",388,0)
 . W !,"|",?79,"|"
"RTN","RCDPLPL4",389,0)
 . W !,"|  ",$P(RCERROR,"^",2),?79,"|"
"RTN","RCDPLPL4",390,0)
 . W !,"|",?79,"|"
"RTN","RCDPLPL4",391,0)
 . W !,"|  You will need to correct the error before you can link the payment.",?79,"|"
"RTN","RCDPLPL4",392,0)
 . W !,"+------------------------------------------------------------------------------+"
"RTN","RCDPLPL4",393,0)
 . W !
"RTN","RCDPLPL4",394,0)
 . D DELEACCT^RCDPURET(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL4",395,0)
 . W !,"Account "_RCTDNM_" was deleted and not linked."
"RTN","RCDPLPL4",396,0)
 ;
"RTN","RCDPLPL4",397,0)
 ;File entry in Audit Log
"RTN","RCDPLPL4",398,0)
 D AUDIT^RCBEPAY(RCRECTDA,RCTRANDA,"P")
"RTN","RCDPLPL4",399,0)
 ;
"RTN","RCDPLPL4",400,0)
 ; Update Suspense Status
"RTN","RCDPLPL4",401,0)
 D SUSPDIS^RCBEPAY(RCRECTDA,RCTRANDA,"PD")
"RTN","RCDPLPL4",402,0)
 ;
"RTN","RCDPLPL4",403,0)
 I $E(RCSTATUS)="A" D
"RTN","RCDPLPL4",404,0)
 . ;  send mail message to the RCDP PAYMENTS mail group
"RTN","RCDPLPL4",405,0)
 . D MAILMSG^RCDPLPSR(RCRECTDA,RCTRANDA)
"RTN","RCDPLPL4",406,0)
 . ;  place an x in the fms doc field so it will show on the
"RTN","RCDPLPL4",407,0)
 . ;  suspense report
"RTN","RCDPLPL4",408,0)
 . D EDITFMS^RCDPURET(RCRECTDA,RCTRANDA,"x")
"RTN","RCDPLPL4",409,0)
 Q
"RTN","RCDPLPL4",410,0)
 ;
"RTN","RCDPLPL4",411,0)
 ;Display end of processing message.
"RTN","RCDPLPL4",412,0)
ENDMSG(RCSTATUS) ;
"RTN","RCDPLPL4",413,0)
 ;
"RTN","RCDPLPL4",414,0)
 I $E(RCSTATUS)="A" D
"RTN","RCDPLPL4",415,0)
 . W !,"Since the FMS cash receipt document is Accepted in FMS, you need to go"
"RTN","RCDPLPL4",416,0)
 . W !,"online in FMS and transfer the amount paid out of the station's suspense"
"RTN","RCDPLPL4",417,0)
 . W !,"account.",!
"RTN","RCDPLPL4",418,0)
 . W !,"Mail message(s) sent to RCDP PAYMENTS mail group.",!
"RTN","RCDPLPL4",419,0)
 I $E(RCSTATUS)'="A" D
"RTN","RCDPLPL4",420,0)
 . W !,"Since the FMS cash receipt document is NOT Accepted in FMS, you can use"
"RTN","RCDPLPL4",421,0)
 . W !,"the option Process Receipt located under the Receipt Processing Menu"
"RTN","RCDPLPL4",422,0)
 . W !,"to regenerate the cash receipt document to FMS.",!
"RTN","RCDPLPL4",423,0)
 Q
"RTN","RCDPLPL4",424,0)
 ;
"RTN","RCDPLPL4",425,0)
 ;Get users answers to questions for reports.
"RTN","RCDPLPL4",426,0)
GETANS(RCIDX) ;
"RTN","RCDPLPL4",427,0)
 N DA,DIR,DTOUT,DUOUT,X,Y,DIRUT,DIROUT
"RTN","RCDPLPL4",428,0)
 ;
"RTN","RCDPLPL4",429,0)
 ; Ask the user what kind of report
"RTN","RCDPLPL4",430,0)
 I RCIDX=1 D
"RTN","RCDPLPL4",431,0)
 . S DIR("?")="Select to Y to review the payments, N to skip the review."
"RTN","RCDPLPL4",432,0)
 . S DIR("A")="Do you want to review the payment list before updating accounts (Y/N)? "
"RTN","RCDPLPL4",433,0)
 ;
"RTN","RCDPLPL4",434,0)
 ; Ask the user for the payer to start the reporting on (Range Option)
"RTN","RCDPLPL4",435,0)
 I RCIDX=2 D
"RTN","RCDPLPL4",436,0)
 . S DIR("?")="Enter Y to update the accounts, N to return to the LP menu"
"RTN","RCDPLPL4",437,0)
 . S DIR("A")="Do you want to update accounts with these payments (Y/N)? "
"RTN","RCDPLPL4",438,0)
 ;
"RTN","RCDPLPL4",439,0)
 S DIR(0)="YA"
"RTN","RCDPLPL4",440,0)
 D ^DIR
"RTN","RCDPLPL4",441,0)
 K DIR
"RTN","RCDPLPL4",442,0)
 I $G(DTOUT)!$G(DUOUT) Q -1
"RTN","RCDPLPL4",443,0)
 Q Y
"RTN","RCDPLPL4",444,0)
 ;
"RTN","RCDPLPL4",445,0)
 ;Retrieve the review response question from the user
"RTN","RCDPLPL4",446,0)
GETANS1() ;
"RTN","RCDPLPL4",447,0)
 ;
"RTN","RCDPLPL4",448,0)
 N FLG,X,Y
"RTN","RCDPLPL4",449,0)
 S FLG=0,Y=0
"RTN","RCDPLPL4",450,0)
 F  D  Q:FLG=1
"RTN","RCDPLPL4",451,0)
 . R !,"Do you want to review the payment list before updating accounts (Y/N)? ",X:DTIME
"RTN","RCDPLPL4",452,0)
 . ;I $G(DTOUT) S FLG=1 Q    ;If it times out, treat it like a No and go to the next prompt.
"RTN","RCDPLPL4",453,0)
 . I X="" W !,"Enter Y or N to continue." Q
"RTN","RCDPLPL4",454,0)
 . I X["?" W !,"Select to Y to review the payments, N to skip the review." Q
"RTN","RCDPLPL4",455,0)
 . S X=$$UP^XLFSTR(X)
"RTN","RCDPLPL4",456,0)
 . I X="Y" S Y=1,FLG=1 Q
"RTN","RCDPLPL4",457,0)
 . I X="N" S Y=0,FLG=1 Q
"RTN","RCDPLPL4",458,0)
 . W !,"Select to Y to review the payments, N to skip the review."
"RTN","RCDPLPL4",459,0)
 Q Y
"RTN","RCDPLPL4",460,0)
 ;
"RTN","RCDPLPL4",461,0)
 ;Is the amount entered < the amount owed. (AR ACCOUNTS ONLY, NO DEBTORS)
"RTN","RCDPLPL4",462,0)
PAYCHK(RCACCT,RCAMT) ;
"RTN","RCDPLPL4",463,0)
 ;
"RTN","RCDPLPL4",464,0)
 N OWED,FLG
"RTN","RCDPLPL4",465,0)
 ;
"RTN","RCDPLPL4",466,0)
 S FLG=0
"RTN","RCDPLPL4",467,0)
 ; account is the debtor account. No need to check...
"RTN","RCDPLPL4",468,0)
 Q:RCACCT'["PRCA" 1
"RTN","RCDPLPL4",469,0)
 ;  calculate amount owed for a bill
"RTN","RCDPLPL4",470,0)
 S OWED=$G(^PRCA(430,+RCACCT,7))
"RTN","RCDPLPL4",471,0)
 S OWED=$P(OWED,"^")+$P(OWED,"^",2)+$P(OWED,"^",3)+$P(OWED,"^",4)+$P(OWED,"^",5)
"RTN","RCDPLPL4",472,0)
 I RCAMT>OWED W !,"The requested payment is greater than then amount owed please try again.",! Q FLG
"RTN","RCDPLPL4",473,0)
 S FLG=1
"RTN","RCDPLPL4",474,0)
 Q FLG
"RTN","RCDPRPL3")
0^45^B81971704
"RTN","RCDPRPL3",1,0)
RCDPRPL3 ;WISC/RFJ-receipt profile listmanager options ;1 Jun 99
"RTN","RCDPRPL3",2,0)
 ;;4.5;Accounts Receivable;**114,148,153,173,301**;Mar 20, 1995;Build 144
"RTN","RCDPRPL3",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPRPL3",4,0)
 Q
"RTN","RCDPRPL3",5,0)
 ;
"RTN","RCDPRPL3",6,0)
 ;  routine contains the entry points for receipt management
"RTN","RCDPRPL3",7,0)
 ;
"RTN","RCDPRPL3",8,0)
 ;
"RTN","RCDPRPL3",9,0)
EDITREC ;  option: edit the receipt, deposit #
"RTN","RCDPRPL3",10,0)
 D FULL^VALM1
"RTN","RCDPRPL3",11,0)
 S VALMBCK="R"
"RTN","RCDPRPL3",12,0)
 ;
"RTN","RCDPRPL3",13,0)
 I '$$LOCKREC^RCDPRPLU(RCRECTDA) Q
"RTN","RCDPRPL3",14,0)
 ;
"RTN","RCDPRPL3",15,0)
 W !
"RTN","RCDPRPL3",16,0)
 D EDITREC^RCDPUREC(RCRECTDA)
"RTN","RCDPRPL3",17,0)
 L -^RCY(344,RCRECTDA)
"RTN","RCDPRPL3",18,0)
 ;
"RTN","RCDPRPL3",19,0)
 ;  rebuild the header
"RTN","RCDPRPL3",20,0)
 D HDR^RCDPRPLM
"RTN","RCDPRPL3",21,0)
 Q
"RTN","RCDPRPL3",22,0)
 ;
"RTN","RCDPRPL3",23,0)
 ;
"RTN","RCDPRPL3",24,0)
PROCESS ;  option: process receipt
"RTN","RCDPRPL3",25,0)
 N RCOK,RCEFT,RCEFT1,RCHAC,RC,RCERA,RCAMT,RCQUIT,CRTR,Z
"RTN","RCDPRPL3",26,0)
 D FULL^VALM1
"RTN","RCDPRPL3",27,0)
 S VALMBCK="R"
"RTN","RCDPRPL3",28,0)
 ;
"RTN","RCDPRPL3",29,0)
 S RC=$S('$P($G(^RCY(344,RCRECTDA,0)),U,6)&$$LBEVENT^RCDPEU():1,1:0),CRTR=$P("cash^transfer",U,RC+1)
"RTN","RCDPRPL3",30,0)
 W !!,"This option will process the payments for the receipt updating the AR"
"RTN","RCDPRPL3",31,0)
 W !,"Package and generate the "_CRTR_" receipt document to FMS.  Any decrease"
"RTN","RCDPRPL3",32,0)
 W !,"adjustments entered via the EDI Lockbox Worklist will also be generated."
"RTN","RCDPRPL3",33,0)
 W !,"Once a receipt has been processed, the receipt status will change to closed"
"RTN","RCDPRPL3",34,0)
 W !,"and no further processing of the receipt can occur.  If the FMS "_CRTR
"RTN","RCDPRPL3",35,0)
 W !," receipt document rejects, you can use this same option to reprocess the"
"RTN","RCDPRPL3",36,0)
 W !,"receipt.",!
"RTN","RCDPRPL3",37,0)
 ;
"RTN","RCDPRPL3",38,0)
 S RCEFT=+$P($G(^RCY(344,RCRECTDA,0)),U,17),RCERA=$P($G(^(0)),U,18),RCHAC=0
"RTN","RCDPRPL3",39,0)
 S RCAMT=+$$PAYTOTAL^RCDPURED(RCRECTDA)
"RTN","RCDPRPL3",40,0)
 ;
"RTN","RCDPRPL3",41,0)
 S RCQUIT=0
"RTN","RCDPRPL3",42,0)
 I RCERA,'RCEFT D  Q:RCQUIT
"RTN","RCDPRPL3",43,0)
 . I +$P($G(^RCY(344.4,+RCERA,0)),U,5)'=RCAMT D  S RCQUIT=1 Q
"RTN","RCDPRPL3",44,0)
 .. W !,"This receipt cannot be processed because the total amount of the associated",!," ERA ("_$J(+$P($G(^RCY(344.4,+RCERA,0)),U,5),"",2)_") does not equal the total amount on the receipt ("_$J(RCAMT,"",2)_")"
"RTN","RCDPRPL3",45,0)
 .. S VALMSG="Receipt total not = ERA total - Receipt NOT processed"
"RTN","RCDPRPL3",46,0)
 .. D RET^RCDPEWL2
"RTN","RCDPRPL3",47,0)
 ;
"RTN","RCDPRPL3",48,0)
 I RCEFT D  Q:'RCOK
"RTN","RCDPRPL3",49,0)
 . N RCOK1
"RTN","RCDPRPL3",50,0)
 . S RCOK=0,RCEFT1=+$G(^RCY(344.3,+RCEFT,0)),RCHAC=($E($P($G(^RCY(344.3,RCEFT1,0)),U,6),1,3)="HAC")
"RTN","RCDPRPL3",51,0)
 . N Z,DIR,DIE,DA,DR
"RTN","RCDPRPL3",52,0)
 . I $P($G(^RCY(344.3,+RCEFT1,0)),U,10) D  Q
"RTN","RCDPRPL3",53,0)
 .. W !,"This receipt cannot be processed until EDI Lockbox checksum exception is",!," cleared on the EFT transmission"
"RTN","RCDPRPL3",54,0)
 .. S VALMSG="EDI LOCKBOX exception still exists - Receipt NOT processed"
"RTN","RCDPRPL3",55,0)
 .. D RET^RCDPEWL2
"RTN","RCDPRPL3",56,0)
 . ;
"RTN","RCDPRPL3",57,0)
 . I +$P($G(^RCY(344.31,+RCEFT,0)),U,7)'=RCAMT D  Q
"RTN","RCDPRPL3",58,0)
 .. W !,"This receipt cannot be processed - the receipt total does not match the",!," EFT total for this EDI Lockbox receipt"
"RTN","RCDPRPL3",59,0)
 .. S VALMSG="EDI LOCKBOX total of receipt not = EFT - Receipt NOT processed"
"RTN","RCDPRPL3",60,0)
 .. D RET^RCDPEWL2
"RTN","RCDPRPL3",61,0)
 . ; Check that EFT funds were posted
"RTN","RCDPRPL3",62,0)
 . S RCOK1=1
"RTN","RCDPRPL3",63,0)
 . I $P($G(^RCY(344.3,+$G(^RCY(344.31,+RCEFT,0)),0)),U,8),$P($G(^RCY(344.31,+RCEFT,0)),U,7) D  Q:'RCOK1
"RTN","RCDPRPL3",64,0)
 .. N RCRECTDA,RCDEPDA
"RTN","RCDPRPL3",65,0)
 .. S RCDEPDA=+$P($G(^RCY(344.3,+$G(^RCY(344.31,+RCEFT,0)),0)),U,3),RCRECTDA=+$O(^RCY(344,"AD",+RCDEPDA,0)) ; Get deposit and its receipt
"RTN","RCDPRPL3",66,0)
 .. I RCRECTDA S Z=$P($$FMSSTAT^RCDPUREC(RCRECTDA),U,2) I $E(Z)="A" Q  ; Accepted by FMS
"RTN","RCDPRPL3",67,0)
 .. W !,"This receipt cannot be processed yet - the EFT's deposit has not been",!," successfully sent to FMS.  Status currently is "_Z
"RTN","RCDPRPL3",68,0)
 .. S VALMSG="EDI LOCKBOX EFT not yet posted",RCOK1=0
"RTN","RCDPRPL3",69,0)
 .. D RET^RCDPEWL2
"RTN","RCDPRPL3",70,0)
 . S RCOK=1
"RTN","RCDPRPL3",71,0)
 ;
"RTN","RCDPRPL3",72,0)
 I +$P($G(^RCY(344,RCRECTDA,0)),U,6),+$P(^(0),U,17) D  Q:'RCOK
"RTN","RCDPRPL3",73,0)
 . S RCOK=0
"RTN","RCDPRPL3",74,0)
 . S DIR("A",1)="A DEPOSIT CANNOT BE ASSOCIATED WITH AN EDI LOCKBOX EFT DETAIL RECEIPT"
"RTN","RCDPRPL3",75,0)
 . S DIR(0)="YA",DIR("A")="DO YOU WANT TO DELETE THIS RECEIPT'S DEPOSIT REFERENCE NOW?: ",DIR("B")="NO" W ! D ^DIR K DIR
"RTN","RCDPRPL3",76,0)
 . I Y=1 S DIE="^RCY(344,",DR=".06///@",DA=RCRECTDA D ^DIE S RCOK=1 Q
"RTN","RCDPRPL3",77,0)
 . S VALMSG="EDI LBOX ERA receipt cannot have a deposit - Receipt NOT processed"
"RTN","RCDPRPL3",78,0)
 ;
"RTN","RCDPRPL3",79,0)
 N RCDEPTDA,RCDPDATA,RCDPFLAG,RCDPFHLP,RCTRDA,RCSCR,STATUS,RCADJ
"RTN","RCDPRPL3",80,0)
 ;
"RTN","RCDPRPL3",81,0)
 ;  lock receipt
"RTN","RCDPRPL3",82,0)
 I '$$LOCKREC^RCDPRPLU(RCRECTDA) S VALMSG="Receipt NOT Processed." Q
"RTN","RCDPRPL3",83,0)
 ;
"RTN","RCDPRPL3",84,0)
 ;  apply decrease adjustments from worklist entry
"RTN","RCDPRPL3",85,0)
 S RCSCR=+$O(^RCY(344.4,"ARCT",RCRECTDA,0)),RCSCR=$S($D(^RCY(344.49,+RCSCR,0)):RCSCR,1:0)
"RTN","RCDPRPL3",86,0)
 S RCADJ=$$ERAWL^RCDPRPL4(RCSCR)
"RTN","RCDPRPL3",87,0)
 I RCADJ=2 D UNLOCK Q
"RTN","RCDPRPL3",88,0)
 I RCADJ<0 D  Q
"RTN","RCDPRPL3",89,0)
 . W !,"The bill balance for the bills listed above must be manually increased to",!,"accommodate the automatic ERA Worklist dec adjustment amounts and to allow",!,"the ERA receipt to be balanced - Receipt NOT processed."
"RTN","RCDPRPL3",90,0)
 . D UNLOCK
"RTN","RCDPRPL3",91,0)
 ;
"RTN","RCDPRPL3",92,0)
 ;  warning no transactions
"RTN","RCDPRPL3",93,0)
 I '$O(^RCY(344,RCRECTDA,1,0)) D
"RTN","RCDPRPL3",94,0)
 .   W !,"WARNING, no transactions are on the receipt.  Processing will only change"
"RTN","RCDPRPL3",95,0)
 .   W !,"the status of the receipt to closed."
"RTN","RCDPRPL3",96,0)
 ;
"RTN","RCDPRPL3",97,0)
 D DIQ344^RCDPRPLM(RCRECTDA,".06;.08;.17;.18;200;")
"RTN","RCDPRPL3",98,0)
 ;  code sheet already sent once, this is a retransmission, check it
"RTN","RCDPRPL3",99,0)
 I RCDPDATA(344,RCRECTDA,200,"E")'="" D
"RTN","RCDPRPL3",100,0)
 .   S STATUS=$$STATUS^GECSSGET(RCDPDATA(344,RCRECTDA,200,"E"))
"RTN","RCDPRPL3",101,0)
 .   W !,"This receipt has been previously processed to FMS in the cash receipt"
"RTN","RCDPRPL3",102,0)
 .   W !,"document ",$TR(RCDPDATA(344,RCRECTDA,200,"E")," "),".  The current status for this document in the"
"RTN","RCDPRPL3",103,0)
 .   W !,"Generic Code Sheet Stack file is ",STATUS,"."
"RTN","RCDPRPL3",104,0)
 .   ;
"RTN","RCDPRPL3",105,0)
 .   ;  okay to continue if status is Error, Rejected, or not defined (-1)
"RTN","RCDPRPL3",106,0)
 .   I $E(STATUS)="E"!($E(STATUS)="R")!(STATUS=-1) Q
"RTN","RCDPRPL3",107,0)
 .   ;  okay to continue if document has not been transmitted
"RTN","RCDPRPL3",108,0)
 .   I $E(STATUS)="Q"!($E(STATUS)="M") Q
"RTN","RCDPRPL3",109,0)
 .   ;  okay to continue if document is transmitted for 2 days
"RTN","RCDPRPL3",110,0)
 .   I $E(STATUS)="T",$$FMDIFF^XLFDT(DT,RCDPDATA(344,RCRECTDA,.08,"I"))>1 Q
"RTN","RCDPRPL3",111,0)
 .   ;
"RTN","RCDPRPL3",112,0)
 .   ;  do not allow reprocessing
"RTN","RCDPRPL3",113,0)
 .   S RCDPFLAG=1
"RTN","RCDPRPL3",114,0)
 .   I $E(STATUS)="A" W !!,"You cannot reprocess and retransmit an ACCEPTED document."
"RTN","RCDPRPL3",115,0)
 .   I $E(STATUS)="T" W !!,"You cannot reprocess and retransmit a document which has previously been",!,"transmitted and is waiting on confirmation (less than 2 days since",!,"processing)."
"RTN","RCDPRPL3",116,0)
 I $G(RCDPFLAG) D UNLOCK Q
"RTN","RCDPRPL3",117,0)
 ;
"RTN","RCDPRPL3",118,0)
 ;  check payments to verify it doesn't exceed bill amt
"RTN","RCDPRPL3",119,0)
 W !!,"Checking payment amounts versus billed amounts ..."
"RTN","RCDPRPL3",120,0)
 S RCTRDA=0 F  S RCTRDA=$O(^RCY(344,RCRECTDA,1,RCTRDA)) Q:'RCTRDA  D
"RTN","RCDPRPL3",121,0)
 .   S X=$$CHECKPAY(RCRECTDA,RCTRDA)
"RTN","RCDPRPL3",122,0)
 .   I 'X Q
"RTN","RCDPRPL3",123,0)
 .   ;  exceeds billed amt
"RTN","RCDPRPL3",124,0)
 .   S RCDPFLAG=1
"RTN","RCDPRPL3",125,0)
 .   ;  check for >1 pending payment for this transaction
"RTN","RCDPRPL3",126,0)
 .   I +$P(X,"^",3)'=$P(^RCY(344,RCRECTDA,1,RCTRDA,0),"^",4) S RCDPFLAG=2
"RTN","RCDPRPL3",127,0)
 .   W !," " I RCDPFLAG=2 W "*" S RCDPFHLP=1
"RTN","RCDPRPL3",128,0)
 .   W "WARNING: Trans# ",RCTRDA,". Pending Payments $ ",$J($P(X,"^",3),0,2)," exceed billed amount $ ",$J($P(X,"^",2),0,2)
"RTN","RCDPRPL3",129,0)
 I $G(RCDPFLAG) D  Q
"RTN","RCDPRPL3",130,0)
 .   I $G(RCDPFHLP) W !,"NOTE: * Indicates more than one pending payment entered against this bill."
"RTN","RCDPRPL3",131,0)
 .   W !,"Adjust payments listed above before processing."
"RTN","RCDPRPL3",132,0)
 .   D UNLOCK
"RTN","RCDPRPL3",133,0)
 ;
"RTN","RCDPRPL3",134,0)
 W "  payments okay."
"RTN","RCDPRPL3",135,0)
 ;
"RTN","RCDPRPL3",136,0)
 S RCDEPTDA=RCDPDATA(344,RCRECTDA,.06,"I")
"RTN","RCDPRPL3",137,0)
 ;  lock deposit tckt
"RTN","RCDPRPL3",138,0)
 I RCDEPTDA I '$$LOCKDEP^RCDPDPLU(RCDEPTDA) D UNLOCK Q
"RTN","RCDPRPL3",139,0)
 ;
"RTN","RCDPRPL3",140,0)
 ;  check for critical fields, deposit ticket, date of deposit
"RTN","RCDPRPL3",141,0)
 ; No deposit ticket is OK for ERA not related to an EFT or for HAC ERA
"RTN","RCDPRPL3",142,0)
 I 'RCDEPTDA,$S('$G(RCDPDATA(344,RCRECTDA,.18,"I")):1,$$EDILB^RCDPEU(RCRECTDA)=2:0,1:'$$HAC^RCDPURE1(RCRECTDA)) D
"RTN","RCDPRPL3",143,0)
 .   W !!,"WARNING, Deposit Ticket is missing.  If you continue with processing,"
"RTN","RCDPRPL3",144,0)
 .   W !,"the AR accounts will be updated and a cash receipt (CR) document will"
"RTN","RCDPRPL3",145,0)
 .   W !,"NOT be sent to FMS.  You have the option to add the Deposit Ticket now."
"RTN","RCDPRPL3",146,0)
 .   D EDITREC^RCDPUREC(RCRECTDA,".06;")
"RTN","RCDPRPL3",147,0)
 .   S (RCDEPTDA,RCDPDATA(344,RCRECTDA,.06,"I"))=$P(^RCY(344,RCRECTDA,0),"^",6)
"RTN","RCDPRPL3",148,0)
 ;
"RTN","RCDPRPL3",149,0)
 ;  deposit ticket added
"RTN","RCDPRPL3",150,0)
 I RCDEPTDA D
"RTN","RCDPRPL3",151,0)
 .   D EDITDEP^RCDPUDEP(RCDEPTDA,1)
"RTN","RCDPRPL3",152,0)
 .   D DIQ3441^RCDPDPLM(RCDEPTDA,".03;")
"RTN","RCDPRPL3",153,0)
 .   I RCDPDATA(344.1,RCDEPTDA,.03,"I") Q
"RTN","RCDPRPL3",154,0)
 .   W !!,"No DEPOSIT DATE, you can edit the deposit data now."
"RTN","RCDPRPL3",155,0)
 .   D EDITDEP^RCDPUDEP(RCDEPTDA,1)
"RTN","RCDPRPL3",156,0)
 .   D DIQ3441^RCDPDPLM(RCDEPTDA,".03;")
"RTN","RCDPRPL3",157,0)
 .   I RCDPDATA(344.1,RCDEPTDA,.03,"I") Q
"RTN","RCDPRPL3",158,0)
 .   W !!,"Still No DEPOSIT DATE, use the Edit Deposit option under Deposit Processing."
"RTN","RCDPRPL3",159,0)
 .   S RCDPFLAG=1
"RTN","RCDPRPL3",160,0)
 I $G(RCDPFLAG) D UNLOCK Q
"RTN","RCDPRPL3",161,0)
 ;
"RTN","RCDPRPL3",162,0)
 W !
"RTN","RCDPRPL3",163,0)
 I $$ASKPROC'=1 D  Q
"RTN","RCDPRPL3",164,0)
 . I $G(RCADJ)>0 W !!,*7,"WARNING - EDI Lbox Worklist auto dec adjustments have already been made for",!,"this receipt!!!"
"RTN","RCDPRPL3",165,0)
 . D UNLOCK
"RTN","RCDPRPL3",166,0)
 ;
"RTN","RCDPRPL3",167,0)
 ;  process receipt, pass 1 to show messages
"RTN","RCDPRPL3",168,0)
 D PROCESS^RCDPURE1(RCRECTDA,1) K CSRECPT
"RTN","RCDPRPL3",169,0)
 D UNLOCK
"RTN","RCDPRPL3",170,0)
 D INIT^RCDPRPLM
"RTN","RCDPRPL3",171,0)
 D HDR^RCDPRPLM
"RTN","RCDPRPL3",172,0)
 I $P(^RCY(344,RCRECTDA,0),"^",8) S VALMSG="Receipt PROCESSED."
"RTN","RCDPRPL3",173,0)
 Q
"RTN","RCDPRPL3",174,0)
 ;
"RTN","RCDPRPL3",175,0)
 ;
"RTN","RCDPRPL3",176,0)
UNLOCK ;  unlock/pause
"RTN","RCDPRPL3",177,0)
 L -^RCY(344,RCRECTDA)
"RTN","RCDPRPL3",178,0)
 I $G(RCDEPTDA) L -^RCY(344.1,RCDEPTDA)
"RTN","RCDPRPL3",179,0)
 W !!,"Press RETURN to continue: " R X:DTIME
"RTN","RCDPRPL3",180,0)
 S VALMSG="Receipt NOT Processed."
"RTN","RCDPRPL3",181,0)
 D HDR^RCDPRPLM
"RTN","RCDPRPL3",182,0)
 Q
"RTN","RCDPRPL3",183,0)
 ;
"RTN","RCDPRPL3",184,0)
 ;
"RTN","RCDPRPL3",185,0)
CHECKPAY(RCRECTDA,RCTRDA) ;  called to check amt pd against amt of bill
"RTN","RCDPRPL3",186,0)
 N PAYDATA,PENDING,X
"RTN","RCDPRPL3",187,0)
 ;  receipt already processed
"RTN","RCDPRPL3",188,0)
 I $P($G(^RCY(344,RCRECTDA,0)),"^",7) Q 0
"RTN","RCDPRPL3",189,0)
 S PAYDATA=$G(^RCY(344,RCRECTDA,1,RCTRDA,0))
"RTN","RCDPRPL3",190,0)
 ;  payment is 0
"RTN","RCDPRPL3",191,0)
 I '$P(PAYDATA,"^",4) Q 0
"RTN","RCDPRPL3",192,0)
 ;  payment processed
"RTN","RCDPRPL3",193,0)
 I $P(PAYDATA,"^",5) Q 0
"RTN","RCDPRPL3",194,0)
 ;  not a bill
"RTN","RCDPRPL3",195,0)
 I $P(PAYDATA,"^",3)'["PRCA(430," Q 0
"RTN","RCDPRPL3",196,0)
 ;  first party bill (do not check dollars)
"RTN","RCDPRPL3",197,0)
 I $P($G(^RCD(340,+$P($G(^PRCA(430,+$P(PAYDATA,"^",3),0)),"^",9),0)),"^")["DPT(" Q 0
"RTN","RCDPRPL3",198,0)
 ; TCSP bill, no payments allowed   prca*4.5*301 BB
"RTN","RCDPRPL3",199,0)
 I $D(^PRCA(430,"TCSP",+$P(PAYDATA,"^",3))) Q 0
"RTN","RCDPRPL3",200,0)
 ;  bill not activated or open
"RTN","RCDPRPL3",201,0)
 S X=$P($G(^PRCA(430,+$P(PAYDATA,"^",3),0)),"^",8)
"RTN","RCDPRPL3",202,0)
 I X'=42,X'=16 Q "1^0"
"RTN","RCDPRPL3",203,0)
 ;  calculate dollars on receivable
"RTN","RCDPRPL3",204,0)
 S X=$G(^PRCA(430,+$P(PAYDATA,"^",3),7)),X=$P(X,"^")+$P(X,"^",2)+$P(X,"^",3)+$P(X,"^",4)+$P(X,"^",5)
"RTN","RCDPRPL3",205,0)
 ;  get pending payments
"RTN","RCDPRPL3",206,0)
 ;  use pending since there may be more than one payment
"RTN","RCDPRPL3",207,0)
 ;  to the same bill on the receipt
"RTN","RCDPRPL3",208,0)
 S PENDING=$$PENDPAY^RCDPURET($P(PAYDATA,"^",3))
"RTN","RCDPRPL3",209,0)
 K ^TMP($J,"RCDPUREC","PP") ;set by pending payment call
"RTN","RCDPRPL3",210,0)
 ;  pending payments is not > billed
"RTN","RCDPRPL3",211,0)
 I PENDING'>X Q 0
"RTN","RCDPRPL3",212,0)
 ;  greater, return billed amt ^ pending payment amt
"RTN","RCDPRPL3",213,0)
 Q "1^"_X_"^"_PENDING
"RTN","RCDPRPL3",214,0)
 ;
"RTN","RCDPRPL3",215,0)
 ;
"RTN","RCDPRPL3",216,0)
ASKPROC() ;  ask if its okay to process the receipt
"RTN","RCDPRPL3",217,0)
 ;  1 is yes, otherwise no
"RTN","RCDPRPL3",218,0)
 N DIR,DIQ2,DTOUT,DUOUT,X,Y
"RTN","RCDPRPL3",219,0)
 S DIR(0)="YO",DIR("B")="NO"
"RTN","RCDPRPL3",220,0)
 S DIR("A")="  Are you sure you want to PROCESS this receipt"
"RTN","RCDPRPL3",221,0)
 D ^DIR
"RTN","RCDPRPL3",222,0)
 I $G(DTOUT)!($G(DUOUT)) S Y=-1
"RTN","RCDPRPL3",223,0)
 Q Y
"RTN","RCDPURED")
0^38^B50615527
"RTN","RCDPURED",1,0)
RCDPURED ;WISC/RFJ - File 344 receipt/payment dd calls ;1 Jun 99
"RTN","RCDPURED",2,0)
 ;;4.5;Accounts Receivable;**114,169,174,196,202,244,268,271,304,301**;Mar 20, 1995;Build 144
"RTN","RCDPURED",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPURED",4,0)
 ;
"RTN","RCDPURED",5,0)
 ; Reference to $$REC^IBRFN supported by DBIA 2031
"RTN","RCDPURED",6,0)
 ;
"RTN","RCDPURED",7,0)
 Q
"RTN","RCDPURED",8,0)
 ;
"RTN","RCDPURED",9,0)
 ;
"RTN","RCDPURED",10,0)
 ;  ***** dd references from file 344 (receipts) *****
"RTN","RCDPURED",11,0)
 ;
"RTN","RCDPURED",12,0)
 ;
"RTN","RCDPURED",13,0)
DUPLCATE ;  called by input transform receipt number (.01)
"RTN","RCDPURED",14,0)
 ;  make sure no duplicate receipt numbers
"RTN","RCDPURED",15,0)
 I $O(^RCY(344,"B",X,"")) K X W !,"This is a duplicate receipt number." Q
"RTN","RCDPURED",16,0)
 I $O(^PRCA(433,"AF",X,"")) K X W !,"This receipt number has already been used and has been purged from the system. " K X
"RTN","RCDPURED",17,0)
 Q
"RTN","RCDPURED",18,0)
 ;
"RTN","RCDPURED",19,0)
 ;
"RTN","RCDPURED",20,0)
PAYCOUNT(RCRECTDA) ;  called by computed field number of transactions (101)
"RTN","RCDPURED",21,0)
 ;  return the count of payments for the receipt
"RTN","RCDPURED",22,0)
 N COUNT,X
"RTN","RCDPURED",23,0)
 S COUNT=0
"RTN","RCDPURED",24,0)
 S X=0 F  S X=$O(^RCY(344,+$G(RCRECTDA),1,X)) Q:'X  S COUNT=COUNT+1
"RTN","RCDPURED",25,0)
 Q COUNT
"RTN","RCDPURED",26,0)
 ;
"RTN","RCDPURED",27,0)
 ;
"RTN","RCDPURED",28,0)
PAYTOTAL(RCRECTDA) ;  called by computed field total amount of receipts (.15)
"RTN","RCDPURED",29,0)
 ;  return the total dollars for payments entered for the receipt
"RTN","RCDPURED",30,0)
 N TOTAL,X
"RTN","RCDPURED",31,0)
 S TOTAL=0
"RTN","RCDPURED",32,0)
 S X=0 F  S X=$O(^RCY(344,+$G(RCRECTDA),1,X)) Q:'X  S TOTAL=TOTAL+$P($G(^(X,0)),"^",4)
"RTN","RCDPURED",33,0)
 Q TOTAL
"RTN","RCDPURED",34,0)
 ;
"RTN","RCDPURED",35,0)
 ;
"RTN","RCDPURED",36,0)
 ;  ***** dd references from sub-file 344.01 (transactions) *****
"RTN","RCDPURED",37,0)
 ;
"RTN","RCDPURED",38,0)
 ;
"RTN","RCDPURED",39,0)
CHGAMT ;  called from the input transform on the transaction amount (.04)
"RTN","RCDPURED",40,0)
 ;  field.  if the amount is changed, this will create a new cancelled
"RTN","RCDPURED",41,0)
 ;  transaction showing the original amount before the change.
"RTN","RCDPURED",42,0)
 Q:$G(CSNOPROC)  ; prca*4.5*301 ; LEG
"RTN","RCDPURED",43,0)
 N ORIGDATA,TRANDA
"RTN","RCDPURED",44,0)
 S ORIGDATA=^RCY(344,DA(1),1,DA,0)
"RTN","RCDPURED",45,0)
 ;  no original payment amount
"RTN","RCDPURED",46,0)
 I '$P(ORIGDATA,"^",4) Q
"RTN","RCDPURED",47,0)
 ;  payment amount did not change
"RTN","RCDPURED",48,0)
 I +$P(ORIGDATA,"^",4)=+X Q
"RTN","RCDPURED",49,0)
 ;  payment amount increased
"RTN","RCDPURED",50,0)
 I $P(ORIGDATA,"^",4)<X Q
"RTN","RCDPURED",51,0)
 ;PRCA*4.5*304 - surpress new transaction if from Multiple split Link Payment.
"RTN","RCDPURED",52,0)
 ;  undeclared parameter RCSPRSS is defined (only defined in RCDPLPL4)
"RTN","RCDPURED",53,0)
 I $G(RCSPRSS) Q
"RTN","RCDPURED",54,0)
 ;  amount was changed
"RTN","RCDPURED",55,0)
 ;  enter a new transaction
"RTN","RCDPURED",56,0)
 S TRANDA=$$ADDTRAN^RCDPURET(DA(1))
"RTN","RCDPURED",57,0)
 I 'TRANDA W !,"  Unable to edit amount." K X Q
"RTN","RCDPURED",58,0)
 ;  copy the current data for the transaction
"RTN","RCDPURED",59,0)
 ;  do not use fileman, will overwrite variables
"RTN","RCDPURED",60,0)
 ;  set the cancel comment (field 1.01)
"RTN","RCDPURED",61,0)
 S $P(^RCY(344,DA(1),1,TRANDA,1),"^")="Amount $"_$P(ORIGDATA,"^",4)_" decreased in original trans#"_DA
"RTN","RCDPURED",62,0)
 ;  set the payment amount to zero (for cancelled)
"RTN","RCDPURED",63,0)
 S $P(ORIGDATA,"^",4)=0
"RTN","RCDPURED",64,0)
 S $P(ORIGDATA,"^",14)=DUZ
"RTN","RCDPURED",65,0)
 S $P(^RCY(344,DA(1),1,TRANDA,0),"^",2,99)=$P(ORIGDATA,"^",2,99)
"RTN","RCDPURED",66,0)
 Q
"RTN","RCDPURED",67,0)
 ;
"RTN","RCDPURED",68,0)
 ;
"RTN","RCDPURED",69,0)
PAYCHK ;  called from the input transform on the transaction amount (.04)
"RTN","RCDPURED",70,0)
 ;  field.  This will compare the amount paid with the amount owed
"RTN","RCDPURED",71,0)
 ;  for a bill.
"RTN","RCDPURED",72,0)
 Q:$G(CSNOPROC)  ; prca*4.5*301 ; LEG
"RTN","RCDPURED",73,0)
 N ACCOUNT,AMOUNT,OWED
"RTN","RCDPURED",74,0)
 S ACCOUNT=$P($G(^RCY(344,DA(1),1,DA,0)),"^",3)
"RTN","RCDPURED",75,0)
 ;  quit, account not a bill
"RTN","RCDPURED",76,0)
 I ACCOUNT'["PRCA(430," Q
"RTN","RCDPURED",77,0)
 ;  quit, account is a patient
"RTN","RCDPURED",78,0)
 I $P($G(^RCD(340,+$P($G(^PRCA(430,+ACCOUNT,0)),"^",9),0)),"^")[";DPT(" Q
"RTN","RCDPURED",79,0)
 ;  calculate amount owed for a bill
"RTN","RCDPURED",80,0)
 S OWED=$G(^PRCA(430,+ACCOUNT,7))
"RTN","RCDPURED",81,0)
 S OWED=$P(OWED,"^")+$P(OWED,"^",2)+$P(OWED,"^",3)+$P(OWED,"^",4)+$P(OWED,"^",5)
"RTN","RCDPURED",82,0)
 ;  compare amount paid (in x) with amount owed (if not processed 0;7)
"RTN","RCDPURED",83,0)
 I X>OWED,'$P($G(^RCY(344,DA(1),0)),"^",7) W "  WARNING: Payment amount greater than amount of bill!"
"RTN","RCDPURED",84,0)
 ;  check for other bills
"RTN","RCDPURED",85,0)
 S AMOUNT=$$EOB^IBCNSBL2(+ACCOUNT,+$P($G(^PRCA(430,+ACCOUNT,0)),"^",3),$$PAID^PRCAFN1(+ACCOUNT))
"RTN","RCDPURED",86,0)
 I AMOUNT W !!,$P(AMOUNT,"^",2)," may also be billable.",!
"RTN","RCDPURED",87,0)
 Q
"RTN","RCDPURED",88,0)
 ;
"RTN","RCDPURED",89,0)
 ;
"RTN","RCDPURED",90,0)
PNORBILL ;  called by the input transform in receipt file 344, transaction
"RTN","RCDPURED",91,0)
 ;  multiple (field 1), patient name or bill number (sub field .09)
"RTN","RCDPURED",92,0)
 S CSNOPROC=0 I $G(RCDCHKSW)=0,$G(HRCDCKSW) S RCDCHKSW=1 ; prca*4.5*301 ; LEG
"RTN","RCDPURED",93,0)
 I $L(X)>20!($L(X)<1) K X Q
"RTN","RCDPURED",94,0)
 ;
"RTN","RCDPURED",95,0)
 N DFN,RCBILL,RCINPUT,RCOUTPUT,Y,RCTYP,DIC,RCDISP,RCLKFLG,RCPAY,RCPMTTYP,RCMSG
"RTN","RCDPURED",96,0)
 ;
"RTN","RCDPURED",97,0)
 S RCINPUT=$TR(X,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","RCDPURED",98,0)
 ;  try and lookup on bill number
"RTN","RCDPURED",99,0)
 I $G(RCDCHKSW),$G(RCRECTDA),$G(RCTRANDA) S RCPMTTYP=$P($G(^RCY(344,RCRECTDA,1,RCTRANDA,0)),"^",19)     ;prc*4.5*301
"RTN","RCDPURED",100,0)
 S X=$S($O(^PRCA(430,"B",RCINPUT,0)):$O(^(0))_";PRCA(430,",$O(^PRCA(430,"D",RCINPUT,0)):$O(^(0))_";PRCA(430,",1:RCINPUT)
"RTN","RCDPURED",101,0)
 I X[";PRCA(430," D DISPLAY(X)  ; PRCA*4.5*301; LEG
"RTN","RCDPURED",102,0)
 I '$G(RCDCHKSW),X[";PRCA(430," I $D(^PRCA(430,"TCSP",+X)) D  Q  ; PRCA*4.5*301
"RTN","RCDPURED",103,0)
 . W !," BILL HAS BEEN REFERRED TO CROSS-SERVICING.",!," NO MANUAL PAYMENTS ARE ALLOWED."
"RTN","RCDPURED",104,0)
 . S X="^",CSNOPROC=1
"RTN","RCDPURED",105,0)
 ;prca*4.5*301
"RTN","RCDPURED",106,0)
 I $G(RCDCHKSW),$G(RCPMTTYP),X[";PRCA(430," D  Q:CSNOPROC=1
"RTN","RCDPURED",107,0)
 . I RCPMTTYP=170,$D(^PRCA(430,"TCSP",+X)) Q
"RTN","RCDPURED",108,0)
 . I RCPMTTYP=170,'$D(^PRCA(430,"TCSP",+X)) S RCMSG=1 D ERRMSG Q
"RTN","RCDPURED",109,0)
 . I RCPMTTYP=168,$D(^PRCA(430,"TCSP",+X)) S RCMSG=3 D ERRMSG Q
"RTN","RCDPURED",110,0)
 . I RCPMTTYP=169,$D(^PRCA(430,"TCSP",+X)) S RCMSG=2 D ERRMSG Q
"RTN","RCDPURED",111,0)
 . I RCPMTTYP<168!(RCPMTTYP>170),$D(^PRCA(430,"TCSP",+X)) S RCMSG=4 D ERRMSG Q
"RTN","RCDPURED",112,0)
 ;  bill not found, try and lookup on patient
"RTN","RCDPURED",113,0)
 ;PRCA*4.5*304 - Echo info back to the user if not surpressed
"RTN","RCDPURED",114,0)
 I X=RCINPUT S DIC="^DPT(",DIC(0)=$S($G(RCSPRSS):"M",1:"EM") D ^DIC S X=+Y_";DPT("
"RTN","RCDPURED",115,0)
 ;  new value in variable X (output in X)
"RTN","RCDPURED",116,0)
 ;
"RTN","RCDPURED",117,0)
 ;PRCA*4.5*304 - allow EDI Lockbox payment type to look up bills by ECME and RX #'s
"RTN","RCDPURED",118,0)
 ;  patient not found, type of payment = check/mo or EDI LOCKBOX
"RTN","RCDPURED",119,0)
 S RCPAY=$P($G(^RCY(344,DA(1),0)),"^",4)
"RTN","RCDPURED",120,0)
 S RCLKFLG=$S(RCPAY=4:1,RCPAY=14:1,1:0)
"RTN","RCDPURED",121,0)
 I +$G(Y)<0,RCLKFLG D
"RTN","RCDPURED",122,0)
 .   S (X,Y)=$$REC^IBRFN(RCINPUT,.RCTYP,.RCDISP),(RCBILL,X)=X_";PRCA(430,"    ; DBIA 2031
"RTN","RCDPURED",123,0)
 .   I Y>0 D
"RTN","RCDPURED",124,0)
 .   .   N DIR,DIQ2,DIRUT,DTOUT,DUOUT,RCPRM
"RTN","RCDPURED",125,0)
 .   .   S RCTYP=$G(RCTYP,1)
"RTN","RCDPURED",126,0)
 .   .   S RCPRM=$S(RCTYP=1:"TRICARE reference number",RCTYP=2:"ECME Rx reference number",RCTYP=3:"prescription number",1:"reference number")
"RTN","RCDPURED",127,0)
 .   .   S DIR("A")="Is this "_RCPRM_" - "_$S($G(RCDISP)'="":RCDISP,1:RCINPUT)
"RTN","RCDPURED",128,0)
 .   .   S DIR("B")="No",DIR("A",1)=" "
"RTN","RCDPURED",129,0)
 .   .   S DIR(0)="Y^O" D ^DIR S:'Y Y=-1
"RTN","RCDPURED",130,0)
 .   .   I Y'>0 Q
"RTN","RCDPURED",131,0)
 .   .   I '$G(RCSPRSS) W !!,$P($G(^PRCA(430,+RCBILL,0)),"^")," "  ;PRCA*4.5*304
"RTN","RCDPURED",132,0)
 .   .   D DISPLAY(RCBILL)
"RTN","RCDPURED",133,0)
 .   .   S X=RCBILL
"RTN","RCDPURED",134,0)
 ;  output in variable X
"RTN","RCDPURED",135,0)
 ;
"RTN","RCDPURED",136,0)
 I +$G(Y)<0 K X Q
"RTN","RCDPURED",137,0)
 ;
"RTN","RCDPURED",138,0)
 S RCOUTPUT=X
"RTN","RCDPURED",139,0)
 ;
"RTN","RCDPURED",140,0)
 ;  patient account, show messages and quit (output still in variable X)
"RTN","RCDPURED",141,0)
 I RCOUTPUT[";DPT(" D CHECKPAT(+RCOUTPUT) Q
"RTN","RCDPURED",142,0)
 ;
"RTN","RCDPURED",143,0)
 ;  bill account
"RTN","RCDPURED",144,0)
 I $$IB^IBRUTL(+RCOUTPUT) W " ... This bill appears to have other patient bills on 'hold'."
"RTN","RCDPURED",145,0)
 S X=$P($G(^RCD(340,+$P(^PRCA(430,+RCOUTPUT,0),"^",9),0)),"^")
"RTN","RCDPURED",146,0)
 I X[";DPT(" D CHECKPAT(+X)
"RTN","RCDPURED",147,0)
 S X=RCOUTPUT
"RTN","RCDPURED",148,0)
 Q
"RTN","RCDPURED",149,0)
 ;
"RTN","RCDPURED",150,0)
 ;
"RTN","RCDPURED",151,0)
CHECKPAT(DFN) ;  check patient for other charges, etc., show message
"RTN","RCDPURED",152,0)
 N X
"RTN","RCDPURED",153,0)
 S X="IBARXEU" X ^%ZOSF("TEST")
"RTN","RCDPURED",154,0)
 I $T S X=$$RXST^IBARXEU(DFN,DT) I X D
"RTN","RCDPURED",155,0)
 .   W !?2,"* Patient is exempt from RX Copay: ",$P(X,"^",4)," *"
"RTN","RCDPURED",156,0)
 S X="PSOCOPAY" X ^%ZOSF("TEST")
"RTN","RCDPURED",157,0)
 I $T S X=$$POT^PSOCOPAY(DFN) I X D
"RTN","RCDPURED",158,0)
 .   N DA,VAEL,VAERR,X1,RCX
"RTN","RCDPURED",159,0)
 .   S RCX=X
"RTN","RCDPURED",160,0)
 .   D ELIG^VADPT S DA=$O(^IBE(350.1,"B","PSO "_$S(VAEL(3):"",1:"N")_"SC RX COPAY NEW",0)) I DA D COST^IBAUTL
"RTN","RCDPURED",161,0)
 .   S X1=+$G(X1)
"RTN","RCDPURED",162,0)
 .   W !?2,"* This patient has ",RCX,"-30 day RX's totaling $",$FN(RCX*X1,",",2)," that are potentially *"
"RTN","RCDPURED",163,0)
 .   W !?2,"* billable.  This represents any Window Rx's issued today. *"
"RTN","RCDPURED",164,0)
 Q
"RTN","RCDPURED",165,0)
 ;
"RTN","RCDPURED",166,0)
 ;
"RTN","RCDPURED",167,0)
DISPLAY(RCBILLDA) ;  display bill
"RTN","RCDPURED",168,0)
 N DATA
"RTN","RCDPURED",169,0)
 S DATA=$P(^PRCA(430,+RCBILLDA,0),"^",9) W:DATA "  ",$$NAM^RCFN01(DATA)
"RTN","RCDPURED",170,0)
 S DATA=$P(^PRCA(430,+RCBILLDA,0),"^",8) I DATA D
"RTN","RCDPURED",171,0)
 .   W "   ",$P(^PRCA(430.3,DATA,0),"^")
"RTN","RCDPURED",172,0)
 .   I $P(^PRCA(430.3,DATA,0),"^",3)'=102,$P($G(^RCD(340,+$P(^PRCA(430,+RCBILLDA,0),"^",9),0)),"^")'[";DPT(" W !,"This bill is not in 'active' status."
"RTN","RCDPURED",173,0)
 S DATA=$G(^PRCA(430,+RCBILLDA,7)) W "   $",$J($P(DATA,"^")+$P(DATA,"^",2)+$P(DATA,"^",3)+$P(DATA,"^",4)+$P(DATA,"^",5),1,2)
"RTN","RCDPURED",174,0)
 Q
"RTN","RCDPURED",175,0)
 ;
"RTN","RCDPURED",176,0)
PAYDATE ;  called by the input transform in receipt file 344, transaction
"RTN","RCDPURED",177,0)
 ;  multiple (field 1), date of payment (sub field .06)
"RTN","RCDPURED",178,0)
 ;  date of payment not in future or more than one month ago
"RTN","RCDPURED",179,0)
 N DAYSDIFF
"RTN","RCDPURED",180,0)
 S DAYSDIFF=$$FMDIFF^XLFDT(X,DT)
"RTN","RCDPURED",181,0)
 I DAYSDIFF<-31!(DAYSDIFF>0) K X
"RTN","RCDPURED",182,0)
 Q
"RTN","RCDPURED",183,0)
 ;
"RTN","RCDPURED",184,0)
 ;
"RTN","RCDPURED",185,0)
 ;  ***** dd references from file 344.1 (deposits) *****
"RTN","RCDPURED",186,0)
 ;
"RTN","RCDPURED",187,0)
 ;
"RTN","RCDPURED",188,0)
RECTOTAL(RCDEPTDA) ;  called from computed field TOTAL AMT OF RECEIPTS (.18) in
"RTN","RCDPURED",189,0)
 ;  deposit file (344.1)
"RTN","RCDPURED",190,0)
 ;  this returns the total dollars paid for all receipts on deposit ticket
"RTN","RCDPURED",191,0)
 N RCRECTDA,TOTAL
"RTN","RCDPURED",192,0)
 S TOTAL=0
"RTN","RCDPURED",193,0)
 S RCRECTDA=0 F  S RCRECTDA=$O(^RCY(344,"AD",+RCDEPTDA,RCRECTDA)) Q:'RCRECTDA  D
"RTN","RCDPURED",194,0)
 .   S TOTAL=TOTAL+$$PAYTOTAL(RCRECTDA)
"RTN","RCDPURED",195,0)
 Q TOTAL
"RTN","RCDPURED",196,0)
 ;
"RTN","RCDPURED",197,0)
 ;
"RTN","RCDPURED",198,0)
RECCOUNT(RCDEPTDA) ;  called from computed field TOTAL RECEIPTS (100) in deposit file (344.1)
"RTN","RCDPURED",199,0)
 ;  this returns a count of the number of receipts on a deposit ticket
"RTN","RCDPURED",200,0)
 N RCRECTDA,COUNT
"RTN","RCDPURED",201,0)
 S COUNT=0
"RTN","RCDPURED",202,0)
 S RCRECTDA=0 F  S RCRECTDA=$O(^RCY(344,"AD",+RCDEPTDA,RCRECTDA)) Q:'RCRECTDA  D
"RTN","RCDPURED",203,0)
 .   S COUNT=COUNT+1
"RTN","RCDPURED",204,0)
 Q COUNT
"RTN","RCDPURED",205,0)
ERRMSG ;prnt error message and set exit variables      ;prca*4.5*301
"RTN","RCDPURED",206,0)
 W !!,$P($T(LINKMSG+RCMSG),";",2),! S CSNOPROC=1,RCDCHKSW=0,HRCDCKSW=1 S X=0
"RTN","RCDPURED",207,0)
 Q
"RTN","RCDPURED",208,0)
LINKMSG ;Linking error messages      ;prca*4.5*301   
"RTN","RCDPURED",209,0)
 ;** Linking Treasury payment (170) to a non Cross-Servicing bill not allowed
"RTN","RCDPURED",210,0)
 ;** Linking a TOP payment (169) to a Cross-Servicing bill is not allowed
"RTN","RCDPURED",211,0)
 ;** Linking a DMC payment (168) to a Cross-Servicing bill is not allowed
"RTN","RCDPURED",212,0)
 ;** Linking a MISC payment to a Cross-Servicing bill is not allowed
"RTN","RCDPURET")
0^44^B75859214
"RTN","RCDPURET",1,0)
RCDPURET ;WISC/RFJ-Receipt utilities (transactions) ;1 Jun 99
"RTN","RCDPURET",2,0)
 ;;4.5;Accounts Receivable;**114,141,169,173,196,221,304,301**;Mar 20, 1995;Build 144
"RTN","RCDPURET",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPURET",4,0)
 ;
"RTN","RCDPURET",5,0)
 ;use of IBRFN in tag PB allowed by private IA 2031
"RTN","RCDPURET",6,0)
 Q
"RTN","RCDPURET",7,0)
 ;
"RTN","RCDPURET",8,0)
 ;
"RTN","RCDPURET",9,0)
SELTRAN(DA) ;  select a transaction for a receipt
"RTN","RCDPURET",10,0)
 ;  returns -1 for timeout or ^, 0 for no selection, or ien of trans
"RTN","RCDPURET",11,0)
 N %,DIC,DTOUT,DUOUT,RCDATA,X,Y
"RTN","RCDPURET",12,0)
 S DIC="^RCY(344,"_DA_",1,",DIC(0)="QEAM",DIC("A")="Select Receipt TRANSACTION #: "
"RTN","RCDPURET",13,0)
 S DIC("W")="S RCDATA=@(DIC_Y_"",0)"") W:$P(RCDATA,U,3) ?8,""  "",$P(@(U_$P($P(RCDATA,U,3),"";"",2)_+$P(RCDATA,U,3)_"",0)""),U) W ?40,""  $ "",$J($P(RCDATA,U,4),0,2)"
"RTN","RCDPURET",14,0)
 D ^DIC
"RTN","RCDPURET",15,0)
 I Y<0,'$G(DTOUT),'$G(DUOUT) S Y=0
"RTN","RCDPURET",16,0)
 Q +Y
"RTN","RCDPURET",17,0)
 ;
"RTN","RCDPURET",18,0)
 ;
"RTN","RCDPURET",19,0)
ADDTRAN(RECTDA) ;  add transaction for receipt (in da)
"RTN","RCDPURET",20,0)
 N %DT,%T,D0,DA,DD,DI,DIC,DIE,DINUM,DLAYGO,DO,DQ,DR,X,Y
"RTN","RCDPURET",21,0)
 I '$D(^RCY(344,RECTDA,1,0)) S ^(0)="^344.01A^"
"RTN","RCDPURET",22,0)
 ;
"RTN","RCDPURET",23,0)
 ;  find next transaction number
"RTN","RCDPURET",24,0)
 S X=$O(^RCY(344,RECTDA,1,9999999),-1)
"RTN","RCDPURET",25,0)
 F X=X+1:1 Q:'$D(^RCY(344,RECTDA,1,X,0))
"RTN","RCDPURET",26,0)
 S DINUM=X
"RTN","RCDPURET",27,0)
 ;
"RTN","RCDPURET",28,0)
 S DA(1)=RECTDA
"RTN","RCDPURET",29,0)
 S DIC="^RCY(344,"_RECTDA_",1,",DIC(0)="L",DLAYGO=344.01
"RTN","RCDPURET",30,0)
 S DIC("DR")=".12////"_DUZ_";.06///TODAY;"
"RTN","RCDPURET",31,0)
 D FILE^DICN
"RTN","RCDPURET",32,0)
 Q +Y
"RTN","RCDPURET",33,0)
 ;
"RTN","RCDPURET",34,0)
 ;
"RTN","RCDPURET",35,0)
CSTRAN(RECTDA,RCPAYAMT,CSRECORD) ;  add SUSPENSE transaction for receipt (in da) ;PRCA*4.5*301
"RTN","RCDPURET",36,0)
 ;DA=1,DA(1)=21,DIC="^RCY(344,21,1,",DIE="^RCY(344,21,1,",DILN=21,DILOCKTM=3,DISYS=18
"RTN","RCDPURET",37,0)
 ;DR=".09;              (#.09) PATIENT NAME OR BILL NUMBER [9F]
"RTN","RCDPURET",38,0)
 ;     S Y=$S('$P(^RCY(344,DA(1),1,DA,0),U,9):"@1",1:"@2");
"RTN","RCDPURET",39,0)
 ;     @1;X RCXSUSP;    (#.01) TRANSACTION [1N]
"RTN","RCDPURET",40,0)
 ;     1.02;            (#1.02) COMMENT [2F]
"RTN","RCDPURET",41,0)
 ;     S Y="@3";
"RTN","RCDPURET",42,0)
 ;     @2;
"RTN","RCDPURET",43,0)
 ;     X RCXAMONT;      W !,"  Amount Owed: $",$J($$PAYDEF^RCDPURET($P(^RCY(344,DA(1),1,DA,0),U,9)),0,2)
"RTN","RCDPURET",44,0)
 ;     @3;
"RTN","RCDPURET",45,0)
 ;     .04;             (#.04) PAYMENT AMOUNT [4N]
"RTN","RCDPURET",46,0)
 ;     .06;             (#.06) DATE OF PAYMENT [6D]
"RTN","RCDPURET",47,0)
 ;     .14////100882"   (#.14) EDITED BY [14P:200]
"RTN","RCDPURET",48,0)
 ;
"RTN","RCDPURET",49,0)
 N %DT,%T,D0,DA,DD,DI,DIC,DIE,DINUM,DLAYGO,DO,DQ,DR,X,Y
"RTN","RCDPURET",50,0)
 I '$D(^RCY(344,RECTDA,1,0)) S ^(0)="^344.01A^"
"RTN","RCDPURET",51,0)
 ;
"RTN","RCDPURET",52,0)
 ;  find next transaction number
"RTN","RCDPURET",53,0)
 S X=$O(^RCY(344,RECTDA,1,9999999),-1)
"RTN","RCDPURET",54,0)
 F X=X+1:1 Q:'$D(^RCY(344,RECTDA,1,X,0))
"RTN","RCDPURET",55,0)
 S DINUM=X
"RTN","RCDPURET",56,0)
 ;
"RTN","RCDPURET",57,0)
 ; set Payment Fields
"RTN","RCDPURET",58,0)
 K DD,DO
"RTN","RCDPURET",59,0)
 S DA(1)=RECTDA
"RTN","RCDPURET",60,0)
 S DA=DINUM
"RTN","RCDPURET",61,0)
 S DIE="^RCY(344,"_RECTDA_",1,"
"RTN","RCDPURET",62,0)
 K DIC
"RTN","RCDPURET",63,0)
 S DR=".01////"_DA_";.04////"_RCPAYAMT_";.06////"_$P(CSRECORD,U,6)_";.14////.5;"
"RTN","RCDPURET",64,0)
 S DR=DR_"1.02////"_$E(CSRECORD,1,9)_":"_$P(CSRECORD,U,8)_";.25////"_CSDEP_";"
"RTN","RCDPURET",65,0)
 S DIC("DR")=DR
"RTN","RCDPURET",66,0)
 D ^DIE
"RTN","RCDPURET",67,0)
 S $P(^RCY(344,RECTDA,1,0),U,3,4)=DA_U_($P(^RCY(344,RECTDA,1,0),U,4)+1)
"RTN","RCDPURET",68,0)
 D LASTEDIT^RCDPUREC(RECTDA)
"RTN","RCDPURET",69,0)
 Q
"RTN","RCDPURET",70,0)
 ;
"RTN","RCDPURET",71,0)
 ;
"RTN","RCDPURET",72,0)
EDITTRAN(RECTDA,TRANDA) ;  edit a receipt transaction
"RTN","RCDPURET",73,0)
 ;  returns 1 for success, or 0 (error message)
"RTN","RCDPURET",74,0)
 I '$D(^RCY(344,RECTDA,1,TRANDA,0)) Q 0
"RTN","RCDPURET",75,0)
 ;
"RTN","RCDPURET",76,0)
 N %,%DT,%T,%Y,C,D,D0,D1,DA,DATA,DDH,DI,DIC,DICR,DIE,DIG,DIH,DIPGM,DIU,DIV,DIW,DG,DQ,DR,DZ,RCAMOUNT,RCTYPE,RESULT,X,Y
"RTN","RCDPURET",77,0)
 N RCXAMONT,RCXSUSP,RCXSUSP1,RCXADJ,RCERA,RCADJ,RCXERA
"RTN","RCDPURET",78,0)
 ;
"RTN","RCDPURET",79,0)
 ;  build dr string based on type of payment on receipt
"RTN","RCDPURET",80,0)
 S RCTYPE=$P($G(^RC(341.1,+$P(^RCY(344,RECTDA,0),"^",4),0)),"^",2)
"RTN","RCDPURET",81,0)
 S RCADJ=0,RCERA=+$O(^RCY(344.4,"AREC",RECTDA,0))
"RTN","RCDPURET",82,0)
 S DR=""
"RTN","RCDPURET",83,0)
 I RCERA,$D(^RCY(344.49,+RCERA,0)),$P(^RCY(344,RECTDA,1,TRANDA,0),"^",28) D  ; Worklist has a dec adj associated with it
"RTN","RCDPURET",84,0)
 . N Z
"RTN","RCDPURET",85,0)
 . S Z=$$EXTERNAL^DILFD(344.01,.09,,$P($G(^RCY(344,RECTDA,1,TRANDA,0)),U,9))
"RTN","RCDPURET",86,0)
 . S RCADJ=1,RCXERA="W !,""NOTE: This payment has an EEOB Worklist dec adj associated with it."",!,""BILL NUMBER: "_Z_" (uneditable)""",DR="X RCXERA;"
"RTN","RCDPURET",87,0)
 E  D
"RTN","RCDPURET",88,0)
 . ;  patient name or bill number
"RTN","RCDPURET",89,0)
 . S DR=".09;"
"RTN","RCDPURET",90,0)
 S DR=DR_"S Y=$S('$P(^RCY(344,DA(1),1,DA,0),U,9):""@1"",1:""@2"");"
"RTN","RCDPURET",91,0)
 ;  ask comment if no acct (unapplied)
"RTN","RCDPURET",92,0)
 S RCXSUSP="W !?5,""NOTE: This payment will be posted to the station's suspense fund."""
"RTN","RCDPURET",93,0)
 ;
"RTN","RCDPURET",94,0)
 ; PRCA*4.5*304 - Force user to type something
"RTN","RCDPURET",95,0)
 ; Check for the the existance of a comment.  If none currently exists,
"RTN","RCDPURET",96,0)
 ;   go to new code to prompt user and enforce entry of a comment, otherwise
"RTN","RCDPURET",97,0)
 ;   use the existing field call to edit it.
"RTN","RCDPURET",98,0)
 S RCXSUSP1="S:$P($G(^RCY(344,DA(1),1,DA,1)),U,2)="""" Y=""@4"""
"RTN","RCDPURET",99,0)
 S DR=DR_"@1;X RCXSUSP;X RCXSUSP1;1.02R;S Y=""@3"";@4;1.02///^S X=$$GETRSN^RCDPURET;S Y=""@3"";"
"RTN","RCDPURET",100,0)
 ;
"RTN","RCDPURET",101,0)
 ;  payment amount
"RTN","RCDPURET",102,0)
 S RCXAMONT="W !,""  Amount Owed: $"",$J($$PAYDEF^RCDPURET($P(^RCY(344,DA(1),1,DA,0),U,9)),0,2)"
"RTN","RCDPURET",103,0)
 S DR=DR_"@2;X RCXAMONT;@3;.04;"
"RTN","RCDPURET",104,0)
 ;  date of payment
"RTN","RCDPURET",105,0)
 S DR=DR_".06;"
"RTN","RCDPURET",106,0)
 ;  type of payment = district counsel (3), check (4),
"RTN","RCDPURET",107,0)
 ;                    dept of justice  (5), irs (11),
"RTN","RCDPURET",108,0)
 ;                    lockbox (12)
"RTN","RCDPURET",109,0)
 I RCTYPE=3!(RCTYPE=4)!(RCTYPE=5)!(RCTYPE=11)!(RCTYPE=12)!(RCTYPE=13) D
"RTN","RCDPURET",110,0)
 .   S DR=DR_".07d;"     ; check number
"RTN","RCDPURET",111,0)
 .   S DR=DR_".08d;"     ; bank number
"RTN","RCDPURET",112,0)
 .   S DR=DR_".1d;"      ; date of check
"RTN","RCDPURET",113,0)
 ;  type of payment = credit card (7)
"RTN","RCDPURET",114,0)
 I RCTYPE=7 D
"RTN","RCDPURET",115,0)
 .   S DR=DR_".11d;"     ; credit card number
"RTN","RCDPURET",116,0)
 .   S DR=DR_".02d;"     ; confirmation number
"RTN","RCDPURET",117,0)
 ;
"RTN","RCDPURET",118,0)
 S (DIC,DIE)="^RCY(344,"_RECTDA_",1,"
"RTN","RCDPURET",119,0)
 S DA=TRANDA,DA(1)=RECTDA
"RTN","RCDPURET",120,0)
 ;  edited by
"RTN","RCDPURET",121,0)
 S DR=DR_".14////"_DUZ
"RTN","RCDPURET",122,0)
 D ^DIE
"RTN","RCDPURET",123,0)
 D LASTEDIT^RCDPUREC(RECTDA)
"RTN","RCDPURET",124,0)
 ;
"RTN","RCDPURET",125,0)
 ;  check for missing fields
"RTN","RCDPURET",126,0)
 S DATA=^RCY(344,RECTDA,1,TRANDA,0)
"RTN","RCDPURET",127,0)
 S RESULT=1
"RTN","RCDPURET",128,0)
 I RESULT,'$P(DATA,"^",4) S RESULT="Payment Amount is ZERO."
"RTN","RCDPURET",129,0)
 I RESULT,'$P(DATA,"^",6) S RESULT="Date of Payment NOT entered."
"RTN","RCDPURET",130,0)
 I RESULT,RCTYPE=13,$$TRACE($P(DATA,"^",3))="" S RESULT="TOP TRACE NUMBER NOT ENTERED"
"RTN","RCDPURET",131,0)
 I RESULT,RCTYPE=7,$P(DATA,"^",11)="" W !,"WARNING: Credit Card Number NOT entered."
"RTN","RCDPURET",132,0)
 I RESULT,$P(DATA,"^",6)<$P(DATA,"^",10) W !,"WARNING: Date of check is greater than the date of payment."
"RTN","RCDPURET",133,0)
 ;
"RTN","RCDPURET",134,0)
 ;  if field is missing, delete the transaction
"RTN","RCDPURET",135,0)
 I 'RESULT D DELETRAN(RECTDA,TRANDA)
"RTN","RCDPURET",136,0)
 ;
"RTN","RCDPURET",137,0)
 ;  if transaction okay, print receipt
"RTN","RCDPURET",138,0)
 I RESULT D RECEIPT^RCDPRECT(RECTDA,TRANDA)
"RTN","RCDPURET",139,0)
 ;
"RTN","RCDPURET",140,0)
 Q RESULT
"RTN","RCDPURET",141,0)
 ;
"RTN","RCDPURET",142,0)
 ;
"RTN","RCDPURET",143,0)
EDITACCT(RECTDA,TRANDA) ;  edit the account on a receipt
"RTN","RCDPURET",144,0)
 N C,D,D0,D1,DA,DDH,DI,DIC,DICR,DIE,DIG,DIH,DIPGM,DISYS,DIU,DIV,DIW,DQ,DR,DZ,X
"RTN","RCDPURET",145,0)
 S DR=".09;"
"RTN","RCDPURET",146,0)
 S (DIC,DIE)="^RCY(344,"_RECTDA_",1,"
"RTN","RCDPURET",147,0)
 S DA=TRANDA,DA(1)=RECTDA
"RTN","RCDPURET",148,0)
 D ^DIE
"RTN","RCDPURET",149,0)
 D LASTEDIT^RCDPUREC(RECTDA)
"RTN","RCDPURET",150,0)
 Q
"RTN","RCDPURET",151,0)
 ;
"RTN","RCDPURET",152,0)
 ;
"RTN","RCDPURET",153,0)
DELEACCT(RECTDA,TRANDA) ;  delete the account on a receipt
"RTN","RCDPURET",154,0)
 N D,D0,D1,DA,DI,DIC,DICR,DIE,DIG,DIH,DIU,DIV,DIW,DQ,DR,X
"RTN","RCDPURET",155,0)
 S DR=".09///@;.03///@;"
"RTN","RCDPURET",156,0)
 S (DIC,DIE)="^RCY(344,"_RECTDA_",1,"
"RTN","RCDPURET",157,0)
 S DA=TRANDA,DA(1)=RECTDA
"RTN","RCDPURET",158,0)
 D ^DIE
"RTN","RCDPURET",159,0)
 D LASTEDIT^RCDPUREC(RECTDA)
"RTN","RCDPURET",160,0)
 ;
"RTN","RCDPURET",161,0)
 ;PRCA*4.5*304
"RTN","RCDPURET",162,0)
 ;Update the Audit Log ans Suspense status back to Pending and In Suspense
"RTN","RCDPURET",163,0)
 D AUDIT^RCBEPAY(RECTDA,TRANDA,"I")
"RTN","RCDPURET",164,0)
 D SUSPDIS^RCBEPAY(RECTDA,TRANDA,"P")
"RTN","RCDPURET",165,0)
 Q
"RTN","RCDPURET",166,0)
 ;
"RTN","RCDPURET",167,0)
 ;
"RTN","RCDPURET",168,0)
EDITFMS(RECTDA,TRANDA,DEFAULT) ;  edit fms document number for clearing suspense
"RTN","RCDPURET",169,0)
 N C,D,D0,D1,DA,DDH,DI,DIC,DICR,DIE,DIG,DIH,DIPGM,DISYS,DIU,DIV,DIW,DQ,DR,DZ,X
"RTN","RCDPURET",170,0)
 S DR=".26;"
"RTN","RCDPURET",171,0)
 I $G(DEFAULT)'="" S DR=".26////"_DEFAULT_";"
"RTN","RCDPURET",172,0)
 S (DIC,DIE)="^RCY(344,"_RECTDA_",1,"
"RTN","RCDPURET",173,0)
 S DA=TRANDA,DA(1)=RECTDA
"RTN","RCDPURET",174,0)
 D ^DIE
"RTN","RCDPURET",175,0)
 Q
"RTN","RCDPURET",176,0)
 ;
"RTN","RCDPURET",177,0)
 ;
"RTN","RCDPURET",178,0)
MOVETRAN(RCOLDREC,RCOLDTRA,RCNEWREC) ;  move a transactions data
"RTN","RCDPURET",179,0)
 N %DT,%T,D0,D1,DA,DG,DIC,DICR,DIK,DIU,RCNEWTRA,RESULT,X,Y
"RTN","RCDPURET",180,0)
 ;
"RTN","RCDPURET",181,0)
 ;  add new transaction to 2nd receipt
"RTN","RCDPURET",182,0)
 W !,"Adding a NEW payment transaction to receipt "_$P(^RCY(344,RCNEWREC,0),"^")_": "
"RTN","RCDPURET",183,0)
 S RCNEWTRA=$$ADDTRAN(RCNEWREC)
"RTN","RCDPURET",184,0)
 I 'RCNEWTRA Q "Unable to ADD a new payment transaction."
"RTN","RCDPURET",185,0)
 ;
"RTN","RCDPURET",186,0)
 W "# ",RCNEWTRA
"RTN","RCDPURET",187,0)
 ;
"RTN","RCDPURET",188,0)
 ;  move data to selected receipt and re-index entry
"RTN","RCDPURET",189,0)
 S ^RCY(344,RCNEWREC,1,RCNEWTRA,0)=RCNEWTRA_"^"_$P(^RCY(344,RCOLDREC,1,RCOLDTRA,0),"^",2,99)
"RTN","RCDPURET",190,0)
 S DIK="^RCY(344,"_RCNEWREC_",1,",DA(1)=RCNEWREC,DA=RCNEWTRA
"RTN","RCDPURET",191,0)
 D IX^DIK
"RTN","RCDPURET",192,0)
 ;
"RTN","RCDPURET",193,0)
 S RESULT=$$EDITTRAN(RCNEWREC,RCNEWTRA)
"RTN","RCDPURET",194,0)
 Q RESULT
"RTN","RCDPURET",195,0)
 ;
"RTN","RCDPURET",196,0)
 ;
"RTN","RCDPURET",197,0)
CANCTRAN(RECTDA,RECTRAN) ;  cancel a transaction
"RTN","RCDPURET",198,0)
 N D,D0,DA,DI,DIC,DIE,DQ,DR,RCDATA,X,Y
"RTN","RCDPURET",199,0)
 S (DIC,DIE)="^RCY(344,"_RECTDA_",1,"
"RTN","RCDPURET",200,0)
 S RCDATA="Cancelled by: "_$P(^VA(200,DUZ,0),"^")_"    Amount: $ "_$J($P(^RCY(344,RECTDA,1,RECTRAN,0),"^",4),0,2)
"RTN","RCDPURET",201,0)
 S DR="1.01////^S X=RCDATA;.04////^S X=0;.05////^S X=0;1.02;"
"RTN","RCDPURET",202,0)
 S DA=RECTRAN,DA(1)=RECTDA
"RTN","RCDPURET",203,0)
 D ^DIE
"RTN","RCDPURET",204,0)
 D LASTEDIT^RCDPUREC(RECTDA)
"RTN","RCDPURET",205,0)
 Q
"RTN","RCDPURET",206,0)
 ;
"RTN","RCDPURET",207,0)
 ;
"RTN","RCDPURET",208,0)
DELETRAN(RECTDA,TRANDA) ;  delete a transaction
"RTN","RCDPURET",209,0)
 N %,D0,D1,DA,DIC,DICR,DIG,DIH,DIK,DIU,DIV,DIW,X,Y
"RTN","RCDPURET",210,0)
 S DIK="^RCY(344,"_RECTDA_",1,",DA(1)=RECTDA,DA=TRANDA
"RTN","RCDPURET",211,0)
 D ^DIK
"RTN","RCDPURET",212,0)
 D LASTEDIT^RCDPUREC(RECTDA)
"RTN","RCDPURET",213,0)
 Q
"RTN","RCDPURET",214,0)
 ;
"RTN","RCDPURET",215,0)
 ;
"RTN","RCDPURET",216,0)
SETUNAPP(RECTDA,TRANDA,UNAPPNUM) ;  store the unapplied deposit number
"RTN","RCDPURET",217,0)
 N D,D0,DA,DI,DIC,DIE,DQ,DR,X,Y
"RTN","RCDPURET",218,0)
 S (DIC,DIE)="^RCY(344,"_RECTDA_",1,"
"RTN","RCDPURET",219,0)
 S DR=".25////"_UNAPPNUM_";"
"RTN","RCDPURET",220,0)
 S DA=TRANDA,DA(1)=RECTDA
"RTN","RCDPURET",221,0)
 D ^DIE
"RTN","RCDPURET",222,0)
 Q
"RTN","RCDPURET",223,0)
 ;
"RTN","RCDPURET",224,0)
 ;
"RTN","RCDPURET",225,0)
PAYDEF(DEBTOR) ;  get default for payment amount (used in input templates for payments)
"RTN","RCDPURET",226,0)
 N X
"RTN","RCDPURET",227,0)
 I 'DEBTOR Q 0
"RTN","RCDPURET",228,0)
 I DEBTOR[";DPT(" S X=$$BAL^PRCAFN(DEBTOR)
"RTN","RCDPURET",229,0)
 I DEBTOR[";PRCA(430,",",112,107,102,"[(","_$P($G(^PRCA(430.3,+$P($G(^PRCA(430,+DEBTOR,0)),"^",8),0)),"^",3)_",") S X=$G(^PRCA(430,+DEBTOR,7)),X=$P(X,"^")+$P(X,"^",2)+$P(X,"^",3)+$P(X,"^",4)+$P(X,"^",5)
"RTN","RCDPURET",230,0)
 Q +$G(X)
"RTN","RCDPURET",231,0)
 ;
"RTN","RCDPURET",232,0)
 ;
"RTN","RCDPURET",233,0)
PENDPAY(DEBTOR) ;  return pending payments for a debtor
"RTN","RCDPURET",234,0)
 ;  returns ^tmp($j,"rcdpurec","pp",rectda,tranda)=data in 344.01
"RTN","RCDPURET",235,0)
 ;  and the total pending payment dollars
"RTN","RCDPURET",236,0)
 N DATA,RECTDA,TOTAL,TRANDA
"RTN","RCDPURET",237,0)
 K ^TMP($J,"RCDPUREC","PP")
"RTN","RCDPURET",238,0)
 ;  look at open receipts
"RTN","RCDPURET",239,0)
 S RECTDA=0 F  S RECTDA=$O(^RCY(344,"ASTAT",1,RECTDA)) Q:'RECTDA  D
"RTN","RCDPURET",240,0)
 .   S TRANDA=0 F  S TRANDA=$O(^RCY(344,"AACCT",DEBTOR,RECTDA,TRANDA)) Q:'TRANDA  D
"RTN","RCDPURET",241,0)
 .   .   S DATA=$G(^RCY(344,RECTDA,1,TRANDA,0)) I DATA="" Q
"RTN","RCDPURET",242,0)
 .   .   ;  total paid = total processed
"RTN","RCDPURET",243,0)
 .   .   I +$P(DATA,"^",4)=+$P(DATA,"^",5) Q
"RTN","RCDPURET",244,0)
 .   .   S ^TMP($J,"RCDPUREC","PP",RECTDA,TRANDA)=DATA
"RTN","RCDPURET",245,0)
 .   .   S TOTAL=$G(TOTAL)+$P(DATA,"^",4)
"RTN","RCDPURET",246,0)
 Q +$G(TOTAL)
"RTN","RCDPURET",247,0)
TRACE(DEBTOR) ;ENTER TOP TRACE NUMBER FOR TOP RECEIPTS
"RTN","RCDPURET",248,0)
 N TRACE,DIC,DIE,DR,DA
"RTN","RCDPURET",249,0)
 S TRACE="" G TRACEQ:'DEBTOR
"RTN","RCDPURET",250,0)
 S DA=$S(DEBTOR["DPT(":$O(^RCD(340,"B",DEBTOR,0)),1:$P($G(^PRCA(430,+DEBTOR,0)),U,9))
"RTN","RCDPURET",251,0)
 G TRACEQ:'DA
"RTN","RCDPURET",252,0)
 S (DIC,DIE)="^RCD(340,",DR=6.07 D ^DIE
"RTN","RCDPURET",253,0)
 S TRACE=$P($G(^RCD(340,DA,6)),"^",7)
"RTN","RCDPURET",254,0)
TRACEQ Q TRACE
"RTN","RCDPURET",255,0)
 ;
"RTN","RCDPURET",256,0)
 ;PRCA*4.5*304 - Force user to enter a comment if item is in suspense
"RTN","RCDPURET",257,0)
GETRSN() ;
"RTN","RCDPURET",258,0)
 ;
"RTN","RCDPURET",259,0)
 N X,Y,DTOUT,DUOUT,DIR,DIROUT,DIRUT,RCTODAY
"RTN","RCDPURET",260,0)
 ;
"RTN","RCDPURET",261,0)
 ; Get the Comment:  Assume the end date is today.
"RTN","RCDPURET",262,0)
 F  D  Q:Y'=""
"RTN","RCDPURET",263,0)
 . S DIR("?")="ENTER THE REASON FOR PLACING THE RECEIPT ITEM INTO THE SUSPENSE FUND"
"RTN","RCDPURET",264,0)
 . S DIR(0)="FA^1:60",DIR("A")="COMMENT: " D ^DIR K DIR
"RTN","RCDPURET",265,0)
 . I $G(DTOUT)!$G(DUOUT) S Y="^" Q
"RTN","RCDPURET",266,0)
 . S Y=$$TRIM^XLFSTR(Y)
"RTN","RCDPURET",267,0)
 . I Y="" W !,"A comment is required when changing the status of an item in Suspense.  Please",!,"try again." Q
"RTN","RCDPURET",268,0)
 Q Y
"RTN","RCDPXPAP")
0^62^B54412655
"RTN","RCDPXPAP",1,0)
RCDPXPAP ;WISC/RFJ-CS automatically process the deposits  ;1 Jun 99
"RTN","RCDPXPAP",2,0)
 ;;4.5;Accounts Receivable;**114,150,206,296,301**;Mar 20, 1995;Build 144
"RTN","RCDPXPAP",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPXPAP",4,0)
 Q
"RTN","RCDPXPAP",5,0)
 ;
"RTN","RCDPXPAP",6,0)
 ;PRCA*4.5*301 Add check for valid billing # on CS 170 transactions
"RTN","RCDPXPAP",7,0)
 ;             and create suspense entry if invalid.
"RTN","RCDPXPAP",8,0)
 ;
"RTN","RCDPXPAP",9,0)
PROCESS(RCDPDATE,RCPAYDA) ;  process the deposits
"RTN","RCDPXPAP",10,0)
 ;  rcdpdate is the transmission date;  rcpayda is ien for the payment
"RTN","RCDPXPAP",11,0)
 ;  type found in ^rc(341.1,rcpayda)
"RTN","RCDPXPAP",12,0)
 N DR,PAYDESC,RCDEPDAT,RCDEPOSI,RCDEPTDA,RCDFN,RCDPDATA,RCLINE,RCRECTDA,RCTRANDA,STATUS
"RTN","RCDPXPAP",13,0)
 K ^TMP($J,"RCDPXPAP")
"RTN","RCDPXPAP",14,0)
 ;
"RTN","RCDPXPAP",15,0)
 ;  file the data in the payment files 344 (AR BATCH PAYMENT) and 344.1 (AR DEPOSIT)
"RTN","RCDPXPAP",16,0)
 ;  tmp global = acct number(1) ^ amount(2) ^ batch#(3) ^ sequence#(4) ^
"RTN","RCDPXPAP",17,0)
 ;               pay type(5)    ^ pay desc fields(6)
"RTN","RCDPXPAP",18,0)
 S RCDEPOSI="" F  S RCDEPOSI=$O(^TMP($J,"RCDPXPAY","DEPOSIT",RCDEPOSI)) Q:RCDEPOSI=""  D
"RTN","RCDPXPAP",19,0)
 .   S RCDEPDAT=$G(^TMP($J,"RCDPXPAY","DEPDATE",RCDEPOSI))
"RTN","RCDPXPAP",20,0)
 .   ; *296 - event type 'a' or 't' or 'p' based on the prefix deposit #
"RTN","RCDPXPAP",21,0)
 .   N RCDETY S RCDETY=+$E(RCDEPOSI,1,3)
"RTN","RCDPXPAP",22,0)
 .   S RCPAYDA=$S(RCDETY=168:15,RCDETY=169:13,RCDETY=170:16,1:$G(RCPAYDA))
"RTN","RCDPXPAP",23,0)
 .   ; 
"RTN","RCDPXPAP",24,0)
 .   ;  add the deposit if not already in file
"RTN","RCDPXPAP",25,0)
 .   ;  make sure deposit is 6 characters in length
"RTN","RCDPXPAP",26,0)
 .   S X=$E("000000",1,6-$L(RCDEPOSI))_RCDEPOSI
"RTN","RCDPXPAP",27,0)
 .   S RCDEPTDA=$$ADDDEPT^RCDPUDEP(X,RCDEPDAT)
"RTN","RCDPXPAP",28,0)
 .   I 'RCDEPTDA D ERROR^RCDPXPAM(RCDPDATE,RCDPXMZ,"Unable to ADD deposit "_RCDEPOSI_" to the AR DEPOSIT file #344.1") Q
"RTN","RCDPXPAP",29,0)
 .   ;
"RTN","RCDPXPAP",30,0)
 .   ;  lock deposit
"RTN","RCDPXPAP",31,0)
 .   L +^RCY(344.1,RCDEPTDA)
"RTN","RCDPXPAP",32,0)
 .   ;  confirm deposit (close it to prevent modifications to it)
"RTN","RCDPXPAP",33,0)
 .   D CONFIRM^RCDPUDEP(RCDEPTDA)
"RTN","RCDPXPAP",34,0)
 .   ;  store the deposit for unlocking below
"RTN","RCDPXPAP",35,0)
 .   S ^TMP($J,"RCDPXPAP","DEPOSITLOCK",RCDEPTDA)=""
"RTN","RCDPXPAP",36,0)
 .   ;
"RTN","RCDPXPAP",37,0)
 .   ;  create receipt for transmission date and deposit
"RTN","RCDPXPAP",38,0)
 .   S RCRECTDA=$$ADDRECT^RCDPUREC(RCDPDATE,RCDEPTDA,RCPAYDA)
"RTN","RCDPXPAP",39,0)
 .   I 'RCRECTDA D ERROR^RCDPXPAM(RCDPDATE,RCDPXMZ,"Unable to ADD receipt "_RCDPDATE_" to the AR BATCH PAYMENT file #344") Q
"RTN","RCDPXPAP",40,0)
 .   ;
"RTN","RCDPXPAP",41,0)
 .   ;  lock receipt
"RTN","RCDPXPAP",42,0)
 .   L +^RCY(344,RCRECTDA)
"RTN","RCDPXPAP",43,0)
 .   ;  check to see if receipt has been processed (fms document)
"RTN","RCDPXPAP",44,0)
 .   D DIQ344^RCDPRPLM(RCRECTDA,"200;")
"RTN","RCDPXPAP",45,0)
 .   ;  code sheet already sent once, this is a retransmission, check it
"RTN","RCDPXPAP",46,0)
 .   I RCDPDATA(344,RCRECTDA,200,"E")'="" D
"RTN","RCDPXPAP",47,0)
 .   .   S STATUS=$$STATUS^GECSSGET(RCDPDATA(344,RCRECTDA,200,"E"))
"RTN","RCDPXPAP",48,0)
 .   .   ;  okay to continue if status is Error, Rejected, or not defined (-1)
"RTN","RCDPXPAP",49,0)
 .   .   I $E(STATUS)="E"!($E(STATUS)="R")!(STATUS=-1) Q
"RTN","RCDPXPAP",50,0)
 .   .   S ^TMP($J,"RCDPXPAP","DUPLICATE",RCRECTDA)="Receipt Not Changed^1"
"RTN","RCDPXPAP",51,0)
 .   I $D(^TMP($J,"RCDPXPAP","DUPLICATE",RCRECTDA)) L -^RCY(344,RCRECTDA) Q
"RTN","RCDPXPAP",52,0)
 .   ;
"RTN","RCDPXPAP",53,0)
 .   ;  mark receipt as processed (closed) to prevent editing
"RTN","RCDPXPAP",54,0)
 .   D MARKPROC^RCDPUREC(RCRECTDA,"")
"RTN","RCDPXPAP",55,0)
 .   ;  store the receipt for automatic processing (and unlock) below
"RTN","RCDPXPAP",56,0)
 .   ;  the 0 is the count of unlinked accts displayed in mail message
"RTN","RCDPXPAP",57,0)
 .   S ^TMP($J,"RCDPXPAP","PROCESS",RCRECTDA)=0
"RTN","RCDPXPAP",58,0)
 .   ;
"RTN","RCDPXPAP",59,0)
 .   ;  build a list of the current stored payments by batch_sequence
"RTN","RCDPXPAP",60,0)
 .   ;  number to prevent adding duplicates
"RTN","RCDPXPAP",61,0)
 .   K ^TMP($J,"RCDPXPAP",RCRECTDA)
"RTN","RCDPXPAP",62,0)
 .   S RCLINE=0 F  S RCLINE=$O(^RCY(344,RCRECTDA,1,RCLINE)) Q:'RCLINE  D
"RTN","RCDPXPAP",63,0)
 .   .   S RCDPDATA=$G(^RCY(344,RCRECTDA,1,RCLINE,2))
"RTN","RCDPXPAP",64,0)
 .   .   I '$P(RCDPDATA,"^",2)!('$P(RCDPDATA,"^",3)) Q
"RTN","RCDPXPAP",65,0)
 .   .   S ^TMP($J,"RCDPXPAP",RCRECTDA,$P(RCDPDATA,"^",2),$P(RCDPDATA,"^",3))=RCLINE
"RTN","RCDPXPAP",66,0)
 .   ;
"RTN","RCDPXPAP",67,0)
 .   ;  loop transactions and add them to the receipt
"RTN","RCDPXPAP",68,0)
 .   S RCLINE=0 F  S RCLINE=$O(^TMP($J,"RCDPXPAY","DEPOSIT",RCDEPOSI,RCLINE)) Q:'RCLINE  D
"RTN","RCDPXPAP",69,0)
 .   .   ;  data in the form:
"RTN","RCDPXPAP",70,0)
 .   .   ;  acct lookup(1)  ^ amount(2) ^ batch(3) ^ sequence(4) ^
"RTN","RCDPXPAP",71,0)
 .   .   ;  payment type(5) ^ payment description(6)
"RTN","RCDPXPAP",72,0)
 .   .   S RCDPDATA=^TMP($J,"RCDPXPAY","DEPOSIT",RCDEPOSI,RCLINE)
"RTN","RCDPXPAP",73,0)
 .   .   ;  if batch and sequence number already stored get current entry
"RTN","RCDPXPAP",74,0)
 .   .   ;  and do not add a new one
"RTN","RCDPXPAP",75,0)
 .   .   S RCTRANDA=0
"RTN","RCDPXPAP",76,0)
 .   .   I $P(RCDPDATA,"^",3),$P(RCDPDATA,"^",4) S RCTRANDA=+$G(^TMP($J,"RCDPXPAP",RCRECTDA,+$P(RCDPDATA,"^",3),+$P(RCDPDATA,"^",4)))
"RTN","RCDPXPAP",77,0)
 .   .   I 'RCTRANDA S RCTRANDA=+$$ADDTRAN^RCDPURET(RCRECTDA)
"RTN","RCDPXPAP",78,0)
 .   .   I 'RCTRANDA D ERROR^RCDPXPAM(RCDPDATE,RCDPXMZ,"Unable to ADD a new transaction to the AR BATCH PAYMENT file #344") Q
"RTN","RCDPXPAP",79,0)
 .   .   ;
"RTN","RCDPXPAP",80,0)
 .   .   ;  if the entry has already been processed, do not make any changes
"RTN","RCDPXPAP",81,0)
 .   .   I $P(^RCY(344,RCRECTDA,1,RCTRANDA,0),"^",5) S:'$D(^TMP($J,"RCDPXPAP","DUPLICATE",RCRECTDA)) ^(RCRECTDA)="Receipt Not Changed" Q
"RTN","RCDPXPAP",82,0)
 .   .   I $D(^TMP($J,"RCDPXPAP","DUPLICATE",RCRECTDA)) S ^(RCRECTDA)="Receipt Updated"
"RTN","RCDPXPAP",83,0)
 .   .   ;
"RTN","RCDPXPAP",84,0)
 .   .   ;  lookup account
"RTN","RCDPXPAP",85,0)
 .   .   S RCDFN=$$FINDACCT($P(RCDPDATA,"^"))_";DPT("
"RTN","RCDPXPAP",86,0)
 .   .   ;  acct not found, count as unlinked for mail message
"RTN","RCDPXPAP",87,0)
 .   .   I 'RCDFN S ^TMP($J,"RCDPXPAP","PROCESS",RCRECTDA)=^TMP($J,"RCDPXPAP","PROCESS",RCRECTDA)+1
"RTN","RCDPXPAP",88,0)
 .   .   ;
"RTN","RCDPXPAP",89,0)
 .   .   ;  build dr string to store the data
"RTN","RCDPXPAP",90,0)
 .   .   S DR=".21////"_$P(RCDPDATA,"^")_";"       ;account
"RTN","RCDPXPAP",91,0)
 .   .   I RCDFN S DR=DR_".03////^S X=RCDFN;.09////^S X=RCDFN;"
"RTN","RCDPXPAP",92,0)
 .   .   S DR=DR_".22////"_+$P(RCDPDATA,"^",3)_";" ;batch number
"RTN","RCDPXPAP",93,0)
 .   .   S DR=DR_".23////"_+$P(RCDPDATA,"^",4)_";" ;sequence number
"RTN","RCDPXPAP",94,0)
 .   .   S DR=DR_".24////"_$P(RCDPDATA,"^",5)_";"  ;payment type
"RTN","RCDPXPAP",95,0)
 .   .   S DR=DR_".04////"_($P(RCDPDATA,"^",2)/100)_";" ;payment amount
"RTN","RCDPXPAP",96,0)
 .   .   S DR=DR_".06////"_RCDEPDAT_";"            ;payment date = deposit date
"RTN","RCDPXPAP",97,0)
 .   .   ;
"RTN","RCDPXPAP",98,0)
 .   .   S PAYDESC=$P(RCDPDATA,"^",6)
"RTN","RCDPXPAP",99,0)
 .   .   ;  payment type check
"RTN","RCDPXPAP",100,0)
 .   .   I $P(RCDPDATA,"^",5)=2 D
"RTN","RCDPXPAP",101,0)
 .   .   .   ;  check number : account number : bank routing number
"RTN","RCDPXPAP",102,0)
 .   .   .   I $P(PAYDESC,":")'="" S DR=DR_".07////"_$P(PAYDESC,":")_";"
"RTN","RCDPXPAP",103,0)
 .   .   .   I $P(PAYDESC,":",2)'="" S DR=DR_".13////"_$P(PAYDESC,":",2)_";"
"RTN","RCDPXPAP",104,0)
 .   .   .   I $P(PAYDESC,":",3)'="" S DR=DR_".08////"_$P(PAYDESC,":",3)_";"
"RTN","RCDPXPAP",105,0)
 .   .   ;  payment type credit, store credit card number
"RTN","RCDPXPAP",106,0)
 .   .   I $P(RCDPDATA,"^",5)=3,$P(PAYDESC,":")'="" S DR=DR_".11////"_$P(PAYDESC,":")_";"
"RTN","RCDPXPAP",107,0)
 .   .   ;
"RTN","RCDPXPAP",108,0)
 .   .   ;  store the payment under the receipt
"RTN","RCDPXPAP",109,0)
 .   .   D FILETRAN(RCRECTDA,RCTRANDA,DR)
"RTN","RCDPXPAP",110,0)
 .   .   S $P(^RCY(344,RCRECTDA,1,RCTRANDA,0),"^",19)=$P(RCDPDATA,"^",7)     ;PRCA*4.5*301
"RTN","RCDPXPAP",111,0)
 ;
"RTN","RCDPXPAP",112,0)
 ;  automatically process the receipts added
"RTN","RCDPXPAP",113,0)
 ;  ^tmp($j,"rcdpxpap","process",receiptda)=""
"RTN","RCDPXPAP",114,0)
 S RCRECTDA=0 F  S RCRECTDA=$O(^TMP($J,"RCDPXPAP","PROCESS",RCRECTDA)) Q:'RCRECTDA  D
"RTN","RCDPXPAP",115,0)
 .   D PROCESS^RCDPURE1(RCRECTDA,0)
"RTN","RCDPXPAP",116,0)
 .   ;  clear the lock (set above)
"RTN","RCDPXPAP",117,0)
 .   L -^RCY(344,RCRECTDA)
"RTN","RCDPXPAP",118,0)
 ;
"RTN","RCDPXPAP",119,0)
 ;  clear all locked deposits
"RTN","RCDPXPAP",120,0)
 S RCDEPTDA=0 F  S RCDEPTDA=$O(^TMP($J,"RCDPXPAP","DEPOSITLOCK",RCDEPTDA)) Q:'RCDEPTDA  D
"RTN","RCDPXPAP",121,0)
 .   ;  confirm deposit (recalc totals)
"RTN","RCDPXPAP",122,0)
 .   D CONFIRM^RCDPUDEP(RCDEPTDA)
"RTN","RCDPXPAP",123,0)
 .   L -^RCY(344.1,RCDEPTDA)
"RTN","RCDPXPAP",124,0)
 ;
"RTN","RCDPXPAP",125,0)
 ;  send a message to the users showing what was processed
"RTN","RCDPXPAP",126,0)
 D PROCMSG^RCDPXPAM
"RTN","RCDPXPAP",127,0)
 ;
"RTN","RCDPXPAP",128,0)
 ;  need to delete the 344.2 entry
"RTN","RCDPXPAP",129,0)
 D DELETRAN^RCDPXPA1(RCDPDATE)
"RTN","RCDPXPAP",130,0)
 ;
"RTN","RCDPXPAP",131,0)
 K ^TMP($J,"RCDPXPAP")
"RTN","RCDPXPAP",132,0)
 Q
"RTN","RCDPXPAP",133,0)
 ;
"RTN","RCDPXPAP",134,0)
 ;
"RTN","RCDPXPAP",135,0)
FINDACCT(ACCT) ;  lookup the patient and return the dfn
"RTN","RCDPXPAP",136,0)
 ;  if more than one patient matches acct, return null
"RTN","RCDPXPAP",137,0)
 ;  acct in the form 123456789ABCDE
"RTN","RCDPXPAP",138,0)
 ; *296 - punctuation added to not process the acct in 9n1.5ap
"RTN","RCDPXPAP",139,0)
 I ACCT'?9N1.5AP  D  Q DFN
"RTN","RCDPXPAP",140,0)
 . S DFN=+ACCT I $G(^DPT(DFN,0))'="" Q
"RTN","RCDPXPAP",141,0)
 . S DFN=$E(DFN,1,10)_"."_$E(DFN,11,99) I $G(^DPT(DFN,0))'="" Q 
"RTN","RCDPXPAP",142,0)
 . S DFN=0
"RTN","RCDPXPAP",143,0)
 . ;
"RTN","RCDPXPAP",144,0)
 N COUNT,DFN,FOUND,NAME,SSN
"RTN","RCDPXPAP",145,0)
 S SSN=$E(ACCT,1,9),NAME=$E(ACCT,10,99)
"RTN","RCDPXPAP",146,0)
 I SSN="" Q 0
"RTN","RCDPXPAP",147,0)
 S NAME=$TR(NAME,"/","'")
"RTN","RCDPXPAP",148,0)
 S COUNT=0  ;used to count number of matches
"RTN","RCDPXPAP",149,0)
 S FOUND=0  ;used to store matching acct's DFN number
"RTN","RCDPXPAP",150,0)
 S DFN=0 F  S DFN=$O(^DPT("SSN",SSN,DFN)) Q:'DFN  I $E($TR($P($G(^DPT(DFN,0)),"^")," "),1,$L(NAME))=NAME S COUNT=COUNT+1,FOUND=DFN
"RTN","RCDPXPAP",151,0)
 ;  multiple acct matches, return null
"RTN","RCDPXPAP",152,0)
 I COUNT>1 Q 0
"RTN","RCDPXPAP",153,0)
 ;  acct found, return dfn of account which matches
"RTN","RCDPXPAP",154,0)
 I FOUND D:$G(RCDETY)=170 CHK170 Q FOUND     ;PRCA*4.5*301
"RTN","RCDPXPAP",155,0)
 ;
"RTN","RCDPXPAP",156,0)
 ;  *296 - remove spaces, periods, apostrophes, dashes from the name for treasury/c&p deposits
"RTN","RCDPXPAP",157,0)
 ;         lookup the first 3 chars in the last name for c&p
"RTN","RCDPXPAP",158,0)
 I $G(RCDETY)=168 S NAME=$E(NAME,3,5)
"RTN","RCDPXPAP",159,0)
 S NAME=$TR(NAME," .'-")
"RTN","RCDPXPAP",160,0)
 S DFN=0 F  S DFN=$O(^DPT("SSN",SSN,DFN)) Q:'DFN  I $E($TR($P($G(^DPT(DFN,0)),"^")," .'-"),1,$L(NAME))=NAME S COUNT=COUNT+1,FOUND=DFN
"RTN","RCDPXPAP",161,0)
 ;  multiple acct matches, return null
"RTN","RCDPXPAP",162,0)
 I COUNT>1 Q 0
"RTN","RCDPXPAP",163,0)
 ;  return dfn of account which matches, or 0 if not found
"RTN","RCDPXPAP",164,0)
 I +FOUND,$G(RCDETY)=170 D CHK170
"RTN","RCDPXPAP",165,0)
 Q +FOUND
"RTN","RCDPXPAP",166,0)
 ;
"RTN","RCDPXPAP",167,0)
CHK170 ;CHECK CS TX 170 FOR VALID BILL NUMER      ;PRCA*4.5*301
"RTN","RCDPXPAP",168,0)
 S PRCABIL1=$E($P(RCDPDATA,"^",6),1,3)_"-"_$E($P(RCDPDATA,"^",6),4,10)
"RTN","RCDPXPAP",169,0)
 S PRCABIL2=$O(^PRCA(430,"B",PRCABIL1,0)) I 'PRCABIL2 S FOUND=0 Q
"RTN","RCDPXPAP",170,0)
 S PRCABIL2=$P(^PRCA(430,PRCABIL2,0),"^",9)
"RTN","RCDPXPAP",171,0)
 I +$G(^RCD(340,PRCABIL2,0))'=+FOUND S FOUND=0
"RTN","RCDPXPAP",172,0)
 Q
"RTN","RCDPXPAP",173,0)
 ;
"RTN","RCDPXPAP",174,0)
FILETRAN(RECTDA,TRANDA,DR) ;  file the payment transaction
"RTN","RCDPXPAP",175,0)
 N %,D,D0,D1,DA,DI,DIC,DICR,DIE,DIG,DIH,DIU,DIV,DIW,DQ,X,Y
"RTN","RCDPXPAP",176,0)
 S (DIC,DIE)="^RCY(344,"_RECTDA_",1,"
"RTN","RCDPXPAP",177,0)
 S DA=TRANDA,DA(1)=RECTDA
"RTN","RCDPXPAP",178,0)
 D ^DIE
"RTN","RCDPXPAP",179,0)
 Q
"RTN","RCDPXPAP",180,0)
 ;
"RTN","RCDPXPAY")
0^46^B65069620
"RTN","RCDPXPAY",1,0)
RCDPXPAY ;WISC/RFJ-server top to receive electronic payments ;1 Jun 99
"RTN","RCDPXPAY",2,0)
 ;;4.5;Accounts Receivable;**114,148,150,301**;Mar 20, 1995;Build 144
"RTN","RCDPXPAY",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCDPXPAY",4,0)
 Q
"RTN","RCDPXPAY",5,0)
 ;
"RTN","RCDPXPAY",6,0)
 ;
"RTN","RCDPXPAY",7,0)
START ;  start receiving message
"RTN","RCDPXPAY",8,0)
 N RCDPCNTL,RCDPCSUM,RCDPDATA,RCDPDATE,RCDPFLAG,RCDPFSUM,RCDPLIDA,RCDPLINE,RCDPNEXT,RCDPSEQ,RCDPSITE,RCDPTOTL,RCDPXMZ,X,Y,RCBETYPE
"RTN","RCDPXPAY",9,0)
 K ^TMP($J,"RCDPXPAY") S U="^"
"RTN","RCDPXPAY",10,0)
 ;
"RTN","RCDPXPAY",11,0)
 ;  not a valid mail message
"RTN","RCDPXPAY",12,0)
 I '$D(^XMB(3.9,XMZ,0)) Q
"RTN","RCDPXPAY",13,0)
 ;
"RTN","RCDPXPAY",14,0)
 S RCDPXMZ=XMZ
"RTN","RCDPXPAY",15,0)
 ;  find line 1 of data and make sure it is correctly formatted
"RTN","RCDPXPAY",16,0)
 S RCDPLINE=.99 F  S RCDPLINE=$O(^XMB(3.9,RCDPXMZ,2,RCDPLINE)) Q:'RCDPLINE  S RCDPDATA=^(RCDPLINE,0) I $E(RCDPDATA,1,2)="RT" Q
"RTN","RCDPXPAY",17,0)
 ;  first 2 characters of line 1 must equal RT
"RTN","RCDPXPAY",18,0)
 I $E($G(RCDPDATA),1,2)'="RT" D ERROR^RCDPXPAM("",RCDPXMZ,"RT expected (line 1, piece 1)"),COMPLETE Q
"RTN","RCDPXPAY",19,0)
 ;  check the station number
"RTN","RCDPXPAY",20,0)
 S RCDPSITE=$$SITE^RCMSITE
"RTN","RCDPXPAY",21,0)
 I $P(RCDPDATA,"^",4)'=RCDPSITE D ERROR^RCDPXPAM("",RCDPXMZ,"Wrong station number (line 1, piece 4), station number should be "_RCDPSITE),COMPLETE Q
"RTN","RCDPXPAY",22,0)
 ;  get the transmission date and convert it to a fileman date
"RTN","RCDPXPAY",23,0)
 S RCDPDATE=$$CONVDATE($P(RCDPDATA,"^",8)) I RCDPDATE<0 D ERROR^RCDPXPAM("",RCDPXMZ,"Invalid transmission date (line 1, piece 8)"),COMPLETE Q
"RTN","RCDPXPAY",24,0)
 ;  get the sequence number
"RTN","RCDPXPAY",25,0)
 S RCDPSEQ=+$P(RCDPDATA,"^",2) I 'RCDPSEQ D ERROR^RCDPXPAM("",RCDPXMZ,"Sequence number of the message is missing (line 1, piece 2)"),COMPLETE Q
"RTN","RCDPXPAY",26,0)
 ;
"RTN","RCDPXPAY",27,0)
 ;  check for zero payments on message
"RTN","RCDPXPAY",28,0)
 ;  sequence=1          ,total sequence=1     ,no payments        ,no dollars on RT   ,no total dollars
"RTN","RCDPXPAY",29,0)
 I +$P(RCDPDATA,"^",2)=1,+$P(RCDPDATA,"^",3)=1,'$P(RCDPDATA,"^",5),'$P(RCDPDATA,"^",6),'$P(RCDPDATA,"^",7) D ZEROMSG^RCDPXPAM($P(RCDPDATA,"^",8)) Q
"RTN","RCDPXPAY",30,0)
 ;
"RTN","RCDPXPAY",31,0)
 ;  stay and wait for lock to clear
"RTN","RCDPXPAY",32,0)
 L +^RCY(344.2,RCDPDATE)
"RTN","RCDPXPAY",33,0)
 ;
"RTN","RCDPXPAY",34,0)
 ;  check for duplicate message, only store/process the first one
"RTN","RCDPXPAY",35,0)
 ;  still go and check to see if all messages have been received and can be processed
"RTN","RCDPXPAY",36,0)
 I $D(^RCY(344.2,RCDPDATE,1,RCDPSEQ,0)) D DUPLCATE^RCDPXPAM(RCDPDATE,RCDPSEQ,RCDPXMZ),STARPROC Q
"RTN","RCDPXPAY",37,0)
 ;
"RTN","RCDPXPAY",38,0)
 ;  add transmission date if not in file
"RTN","RCDPXPAY",39,0)
 I '$$ADDTRAN^RCDPXPA1(RCDPDATE) D ERROR^RCDPXPAM("",RCDPXMZ,"Unable to add transmission to AR PAYMENT TRANSACTIONS file 344.2"),COMPLETE Q
"RTN","RCDPXPAY",40,0)
 ;  store total sequences and dollars if available for transmission
"RTN","RCDPXPAY",41,0)
 D TRANDOLL^RCDPXPA1(RCDPDATE,+$P(RCDPDATA,"^",3),+$P(RCDPDATA,"^",7)/100)
"RTN","RCDPXPAY",42,0)
 ;
"RTN","RCDPXPAY",43,0)
 ;  add the sequence to the transmission multiple
"RTN","RCDPXPAY",44,0)
 S RCDPSEQ=$$ADDSEQ^RCDPXPA1(RCDPDATE,+$P(RCDPDATA,"^",2)) I 'RCDPSEQ D ERROR^RCDPXPAM(RCDPDATE,RCDPXMZ,"Unable to add the sequence number (line 1, piece 2)"),COMPLETE Q
"RTN","RCDPXPAY",45,0)
 ;  store number of transactions, total dollars for the sequence, mail message number
"RTN","RCDPXPAY",46,0)
 D SEQUDOLL^RCDPXPA1(RCDPDATE,RCDPSEQ,+$P(RCDPDATA,"^",5),+$P(RCDPDATA,"^",6)/100,RCDPXMZ)
"RTN","RCDPXPAY",47,0)
 ;
"RTN","RCDPXPAY",48,0)
 ;  once the sequence has been added, future errors must pass the
"RTN","RCDPXPAY",49,0)
 ;  variable rcdpdate to the label error to set the status to error
"RTN","RCDPXPAY",50,0)
 ;  and prevent further processing later on.
"RTN","RCDPXPAY",51,0)
 ;
"RTN","RCDPXPAY",52,0)
 ;  store control header line 1 for comparing count and dollars of transactions
"RTN","RCDPXPAY",53,0)
 S RCDPCNTL=RCDPDATA
"RTN","RCDPXPAY",54,0)
 ;
"RTN","RCDPXPAY",55,0)
 ;  loop transactions and store the data
"RTN","RCDPXPAY",56,0)
 S RCDPCSUM=0  ;used to compute checksum for sequence
"RTN","RCDPXPAY",57,0)
 S RCDPLIDA=0  ;used to count entries stored in the data wp field
"RTN","RCDPXPAY",58,0)
 S RCDPTOTL=0  ;used to total all payments (transactions)
"RTN","RCDPXPAY",59,0)
TXSET F  S RCDPLINE=$O(^XMB(3.9,RCDPXMZ,2,RCDPLINE)) Q:'RCDPLINE  D
"RTN","RCDPXPAY",60,0)
 .   S RCDPDATA=^XMB(3.9,RCDPXMZ,2,RCDPLINE,0)
"RTN","RCDPXPAY",61,0)
 .   I RCDPDATA=""!($E(RCDPDATA,1,4)="NNNN") Q
"RTN","RCDPXPAY",62,0)
 .   ;  convert deposit date to fm
"RTN","RCDPXPAY",63,0)
 .   S $P(RCDPDATA,"^",7)=$$CONVDATE($P(RCDPDATA,"^",7))
"RTN","RCDPXPAY",64,0)
 .   I $P(RCDPDATA,"^",7)<0 S $P(RCDPDATA,"^",7)=0
"RTN","RCDPXPAY",65,0)
 .   ;  check for errors
"RTN","RCDPXPAY",66,0)
 .   I $E(RCDPDATA,1,2)'="RD" S ^TMP($J,"RCDPXPAY","ERROR",RCDPLINE)="RD expected (line "_RCDPLINE_", piece 1)"
"RTN","RCDPXPAY",67,0)
 .   I '$P(RCDPDATA,"^",3) S ^TMP($J,"RCDPXPAY","ERROR",RCDPLINE)="No payment amount (line "_RCDPLINE_", piece 3)"
"RTN","RCDPXPAY",68,0)
 .   I $P(RCDPDATA,"^",6)="" S ^TMP($J,"RCDPXPAY","ERROR",RCDPLINE)="Deposit/215 number missing (line "_RCDPLINE_", piece 6)"
"RTN","RCDPXPAY",69,0)
 .   I '$P(RCDPDATA,"^",7) S ^TMP($J,"RCDPXPAY","ERROR",RCDPLINE)="Deposit date missing/invalid format (line "_RCDPLINE_", piece 7)"
"RTN","RCDPXPAY",70,0)
 .   ;  add up dollars
"RTN","RCDPXPAY",71,0)
 .   S RCDPTOTL=RCDPTOTL+($P(RCDPDATA,"^",3)/100)
"RTN","RCDPXPAY",72,0)
 .   ;  remove RT, remove station number from account (based on site length)
"RTN","RCDPXPAY",73,0)
 .   ;  since the station number is variable 3 to 5 characters
"RTN","RCDPXPAY",74,0)
 .   S RCDPDATA=$P(RCDPDATA,"^",2,99),RCDPDATA=$E(RCDPDATA,$L(RCDPSITE)+1,99999),$P(RCDPDATA,"^",9)=$E($P(RCDPDATA,"^",5),1,3)   ;PRCA*4.5*301
"RTN","RCDPXPAY",75,0)
 .   ;  store the data
"RTN","RCDPXPAY",76,0)
 .   S RCDPLIDA=RCDPLIDA+1
"RTN","RCDPXPAY",77,0)
 .   S ^RCY(344.2,RCDPDATE,1,RCDPSEQ,1,RCDPLIDA,0)=RCDPDATA
"RTN","RCDPXPAY",78,0)
 .   ;  compute checksum
"RTN","RCDPXPAY",79,0)
 .   S X=RCDPCSUM_RCDPDATA X $S($G(^%ZOSF("LPC"))'="":^("LPC"),1:"S Y=""""") S RCDPCSUM=Y
"RTN","RCDPXPAY",80,0)
 ;
"RTN","RCDPXPAY",81,0)
 ;  store 0th node with count of lines and date
"RTN","RCDPXPAY",82,0)
 S ^RCY(344.2,RCDPDATE,1,RCDPSEQ,1,0)="^^"_RCDPLIDA_"^"_RCDPLIDA_"^"_DT_"^"
"RTN","RCDPXPAY",83,0)
 ;  store the checksum for sequence
"RTN","RCDPXPAY",84,0)
 D TRANCSUM^RCDPXPA1(RCDPDATE,RCDPSEQ,RCDPCSUM)
"RTN","RCDPXPAY",85,0)
 ;
"RTN","RCDPXPAY",86,0)
 ;  check number of transactions for sequence
"RTN","RCDPXPAY",87,0)
 I $P(RCDPCNTL,"^",5)'=RCDPLIDA D ERROR^RCDPXPAM(RCDPDATE,RCDPXMZ,"Expected number of transactions not equal actual number (line 1, piece 5)"),COMPLETE Q
"RTN","RCDPXPAY",88,0)
 ;  check total dollars for sequence
"RTN","RCDPXPAY",89,0)
 I ($P(RCDPCNTL,"^",6)/100)'=RCDPTOTL D ERROR^RCDPXPAM(RCDPDATE,RCDPXMZ,"Expected dollars of transactions not equal actual dollars (line 1, piece 6)"),COMPLETE Q
"RTN","RCDPXPAY",90,0)
 ;
"RTN","RCDPXPAY",91,0)
 ;  if errors on rd lines, stop process
"RTN","RCDPXPAY",92,0)
 I $O(^TMP($J,"RCDPXPAY","ERROR",0)) D ERROR^RCDPXPAM(RCDPDATE,RCDPXMZ,""),COMPLETE Q
"RTN","RCDPXPAY",93,0)
 ;
"RTN","RCDPXPAY",94,0)
STARPROC ;  start processing
"RTN","RCDPXPAY",95,0)
 ;  check to see if all messages (sequences) have been received
"RTN","RCDPXPAY",96,0)
 S RCDPFLAG=1
"RTN","RCDPXPAY",97,0)
 S RCDPDATA=^RCY(344.2,RCDPDATE,0) I $P(RCDPDATA,"^",2) D
"RTN","RCDPXPAY",98,0)
 .   S RCDPFLAG=0
"RTN","RCDPXPAY",99,0)
 .   F RCDPSEQ=1:1:$P(RCDPDATA,"^",2) I '$D(^RCY(344.2,RCDPDATE,1,RCDPSEQ)) S RCDPFLAG=1 Q
"RTN","RCDPXPAY",100,0)
 ;  not all sequences received yet
"RTN","RCDPXPAY",101,0)
 I $G(RCDPFLAG) D COMPLETE Q
"RTN","RCDPXPAY",102,0)
 ;
"RTN","RCDPXPAY",103,0)
 ;  ***** all sequences received, start processing *****
"RTN","RCDPXPAY",104,0)
 ;  if status is error, quit and wait for tomorrow to send retransmission
"RTN","RCDPXPAY",105,0)
 ;  message to mail group
"RTN","RCDPXPAY",106,0)
 I $P(^RCY(344.2,RCDPDATE,0),"^",4)="e" D COMPLETE Q
"RTN","RCDPXPAY",107,0)
 ;  already processing/processed the payments
"RTN","RCDPXPAY",108,0)
 I $P(^RCY(344.2,RCDPDATE,0),"^",4)="p" D COMPLETE Q
"RTN","RCDPXPAY",109,0)
 ;
"RTN","RCDPXPAY",110,0)
 ;  set status to processing
"RTN","RCDPXPAY",111,0)
 D TRANSTAT^RCDPXPA1(RCDPDATE,"p")
"RTN","RCDPXPAY",112,0)
 S RCDPTOTL=0
"RTN","RCDPXPAY",113,0)
 S RCDPNEXT=0  ;used for making tmp global entry unique
"RTN","RCDPXPAY",114,0)
SETTMP F RCDPSEQ=1:1 Q:'$D(^RCY(344.2,RCDPDATE,1,RCDPSEQ))  D
"RTN","RCDPXPAY",115,0)
 .   S RCDPCSUM=0
"RTN","RCDPXPAY",116,0)
 .   S RCDPTOTL=RCDPTOTL+$P(^RCY(344.2,RCDPDATE,1,RCDPSEQ,0),"^",3)
"RTN","RCDPXPAY",117,0)
 .   F RCDPLIDA=1:1 Q:'$D(^RCY(344.2,RCDPDATE,1,RCDPSEQ,1,RCDPLIDA,0))  D
"RTN","RCDPXPAY",118,0)
 .   .   S RCDPDATA=^RCY(344.2,RCDPDATE,1,RCDPSEQ,1,RCDPLIDA,0)
"RTN","RCDPXPAY",119,0)
 .   .   ;  compute checksum
"RTN","RCDPXPAY",120,0)
 .   .   S X=RCDPCSUM_RCDPDATA X $S($G(^%ZOSF("LPC"))'="":^("LPC"),1:"S Y=""""") S RCDPCSUM=Y
"RTN","RCDPXPAY",121,0)
 .   .   ;  store transaction for processing
"RTN","RCDPXPAY",122,0)
 .   .   ;  the deposit number and date should not be null unless the
"RTN","RCDPXPAY",123,0)
 .   .   ;  data was modified after receipt
"RTN","RCDPXPAY",124,0)
 .   .   I $P(RCDPDATA,"^",5)="" S $P(RCDPDATA,"^",5)=" " ; deposit number
"RTN","RCDPXPAY",125,0)
 .   .   S RCDPNEXT=RCDPNEXT+1,^TMP($J,"RCDPXPAY","DEPOSIT",$P(RCDPDATA,"^",5),RCDPNEXT)=$P(RCDPDATA,"^",1,4)_"^"_$P(RCDPDATA,"^",7,99)
"RTN","RCDPXPAY",126,0)
 .   .   ; save original data for posting & suspense considerations   PRCA*4.5*301 BB 
"RTN","RCDPXPAY",127,0)
 .   .   ;  store deposit date for deposit if it is needed
"RTN","RCDPXPAY",128,0)
 .   .   I $P(RCDPDATA,"^",6),'$G(^TMP($J,"RCDPXPAY","DEPDATE",$P(RCDPDATA,"^",5))) S ^TMP($J,"RCDPXPAY","DEPDATE",$P(RCDPDATA,"^",5))=$P(RCDPDATA,"^",6)
"RTN","RCDPXPAY",129,0)
 .   ;  verify checksum
"RTN","RCDPXPAY",130,0)
 .   I $P(^RCY(344.2,RCDPDATE,1,RCDPSEQ,0),"^",5)'=RCDPCSUM S RCDPFSUM=1
"RTN","RCDPXPAY",131,0)
 ;
"RTN","RCDPXPAY",132,0)
 ;  verify totals for all sequences
"RTN","RCDPXPAY",133,0)
 I $P(^RCY(344.2,RCDPDATE,0),"^",3)'=RCDPTOTL D ERROR^RCDPXPAM(RCDPDATE,RCDPXMZ,"The total dollars for all sequences do not balance with expected total"),COMPLETE Q
"RTN","RCDPXPAY",134,0)
 ;  checksum error
"RTN","RCDPXPAY",135,0)
 I $G(RCDPFSUM) D ERROR^RCDPXPAM(RCDPDATE,RCDPXMZ,"The deposit information has been altered before processing occured"),COMPLETE Q
"RTN","RCDPXPAY",136,0)
 ;
"RTN","RCDPXPAY",137,0)
 ;  everything checks out, start processing
"RTN","RCDPXPAY",138,0)
 ;  modify the lockbox lookup for accepting payment from other systems
"RTN","RCDPXPAY",139,0)
 D PROCESS^RCDPXPAP(RCDPDATE,$O(^RC(341.1,"B","LOCKBOX",0)))
"RTN","RCDPXPAY",140,0)
 ;
"RTN","RCDPXPAY",141,0)
COMPLETE ;  complete the process
"RTN","RCDPXPAY",142,0)
 ;  check for errors in the transmission file for prior dates
"RTN","RCDPXPAY",143,0)
 ;  if they exist, mail a message to the users asking for retrans
"RTN","RCDPXPAY",144,0)
 ;  remove the entries
"RTN","RCDPXPAY",145,0)
 N DATA,DEPDATE,DEPOSIT,RCDPDA
"RTN","RCDPXPAY",146,0)
 S RCDPDA=DT F  S RCDPDA=$O(^RCY(344.2,RCDPDA),-1) Q:'RCDPDA  D
"RTN","RCDPXPAY",147,0)
 .   ;  if the status was last updated today, do not modify
"RTN","RCDPXPAY",148,0)
 .   I $P(^RCY(344.2,RCDPDA,0),"^",5)=DT Q
"RTN","RCDPXPAY",149,0)
 .   ;  try and find deposit number and deposit date
"RTN","RCDPXPAY",150,0)
 .   S (DEPOSIT,DEPDATE)="",RCDPFLAG=0
"RTN","RCDPXPAY",151,0)
 .   F RCDPSEQ=1:1 Q:'$D(^RCY(344.2,RCDPDA,1,RCDPSEQ))  D  Q:RCDPFLAG
"RTN","RCDPXPAY",152,0)
 .   .   F RCDPLIDA=1:1 Q:'$D(^RCY(344.2,RCDPDA,1,RCDPSEQ,1,RCDPLIDA,0))  D  Q:RCDPFLAG
"RTN","RCDPXPAY",153,0)
 .   .   .   S DATA=$G(^RCY(344.2,RCDPDA,1,RCDPSEQ,1,RCDPLIDA,0))
"RTN","RCDPXPAY",154,0)
 .   .   .   I $P(DATA,"^",5)'="" S DEPOSIT=$P(DATA,"^",5)
"RTN","RCDPXPAY",155,0)
 .   .   .   I $P(DATA,"^",6)'="" S DEPDATE=$P(DATA,"^",6)
"RTN","RCDPXPAY",156,0)
 .   .   .   I DEPOSIT'="",DEPDATE'="" S RCDPFLAG=1  ; used to stop for loops
"RTN","RCDPXPAY",157,0)
 .   ;
"RTN","RCDPXPAY",158,0)
 .   S ^TMP($J,"RCDPXPAY","RETRAN",RCDPDA)=DEPOSIT_"^"_DEPDATE_"^"_$P(^RCY(344.2,RCDPDA,0),"^",4)
"RTN","RCDPXPAY",159,0)
 .   ;  remove the entry from the file so it will not appear later
"RTN","RCDPXPAY",160,0)
 .   D DELETRAN^RCDPXPA1(RCDPDA)
"RTN","RCDPXPAY",161,0)
 ;  if there are any, send a message asking for retransmission
"RTN","RCDPXPAY",162,0)
 I $O(^TMP($J,"RCDPXPAY","RETRAN",0)) D RETRAN^RCDPXPAM
"RTN","RCDPXPAY",163,0)
 ;
"RTN","RCDPXPAY",164,0)
 ;  clear the current transmission date lock, clear it here to prevent
"RTN","RCDPXPAY",165,0)
 ;  two processes from sending the retransmission request message
"RTN","RCDPXPAY",166,0)
 I $G(RCDPDATE) L -^RCY(344.2,RCDPDATE)
"RTN","RCDPXPAY",167,0)
 ;
"RTN","RCDPXPAY",168,0)
 ;  clean up
"RTN","RCDPXPAY",169,0)
 K ^TMP($J,"RCDPXPAY")
"RTN","RCDPXPAY",170,0)
 ;
"RTN","RCDPXPAY",171,0)
 ;  remove message from server basket
"RTN","RCDPXPAY",172,0)
 N K,X,XMK,XMSER,Y
"RTN","RCDPXPAY",173,0)
 S XMSER="S.RCDP AUTOMATIC PAYMENTS",XMZ=RCDPXMZ
"RTN","RCDPXPAY",174,0)
 D REMSBMSG^XMA1C
"RTN","RCDPXPAY",175,0)
 Q
"RTN","RCDPXPAY",176,0)
 ;
"RTN","RCDPXPAY",177,0)
 ;
"RTN","RCDPXPAY",178,0)
CONVDATE(DATE) ;  convert date from mmddyyyy to fm date cyymmdd
"RTN","RCDPXPAY",179,0)
 Q ($E(DATE,5,6)-17)_$E(DATE,7,8)_$E(DATE,1,2)_$E(DATE,3,4)
"RTN","RCTCSJR")
0^28^B113325699
"RTN","RCTCSJR",1,0)
RCTCSJR ;ALBANY/LEG-CS DEBT REFERRAL REJECT REPORTING ;07/15/14 3:34 PM
"RTN","RCTCSJR",2,0)
 ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSJR",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSJR",4,0)
 ;
"RTN","RCTCSJR",5,0)
 Q
"RTN","RCTCSJR",6,0)
ECLIST ; prints IAI Error Codes List
"RTN","RCTCSJR",7,0)
 S DIC="^RC(348.5,",BY=.01
"RTN","RCTCSJR",8,0)
 S (FR,TO)=""
"RTN","RCTCSJR",9,0)
 S FLDS="[TCS IAI ERROR CODES LIST]"
"RTN","RCTCSJR",10,0)
 S DHD="TCS IAI ERROR CODES LIST"
"RTN","RCTCSJR",11,0)
 S DIOBEG="W !!"
"RTN","RCTCSJR",12,0)
 D EN1^DIP
"RTN","RCTCSJR",13,0)
 Q
"RTN","RCTCSJR",14,0)
 ;
"RTN","RCTCSJR",15,0)
 ; 
"RTN","RCTCSJR",16,0)
RJRPT ; for CS REJECT REPORT processing
"RTN","RCTCSJR",17,0)
 D INIT
"RTN","RCTCSJR",18,0)
 S STOP=0
"RTN","RCTCSJR",19,0)
 D PROMPTS
"RTN","RCTCSJR",20,0)
 Q:STOP
"RTN","RCTCSJR",21,0)
 D HEADING
"RTN","RCTCSJR",22,0)
 D GETRECS
"RTN","RCTCSJR",23,0)
 D PRTRECS
"RTN","RCTCSJR",24,0)
 K %ZIS,ACTN,ASCDES,BILLID,BILLIEN,BLNKS,BY,CD,CDIEN,CDREC,CDSH,CHDR,CHDRS,CNTR,COLDASH,COLHDRS,COLWIDTH1
"RTN","RCTCSJR",25,0)
 K COLWIDTH2,COLWIDTH3,CWID,DASH,DATA,DATAITMS,DATE,DEBTIDX,DEBTIEN,DEBTOR,DEBTREC,DEBTREF,DEFAULT,DESC,DHD,DIOBEG
"RTN","RCTCSJR",26,0)
 K DTFRM,DTFRMTO,DTFROM,DTTO,ECDS,EXCEL,FIELD,FLDS,FR,GROUPBD,HDTITLE,I,INCLUDE,INDATE,L,LEV1,LEV2,LEV3,LEV4,LN
"RTN","RCTCSJR",27,0)
 K OUTDATE,PAGE,POP,QUIT,RPTITEMS,RPTREC,RPTTYP,SEQ,SRC,SSN,STOP,STR,TO,TYP,UPDN,RECW1,RECW2
"RTN","RCTCSJR",28,0)
 Q
"RTN","RCTCSJR",29,0)
 ;
"RTN","RCTCSJR",30,0)
INIT ;
"RTN","RCTCSJR",31,0)
 K ^XTMP("RCTCSJS",$J)
"RTN","RCTCSJR",32,0)
 K REC
"RTN","RCTCSJR",33,0)
 S DASH="",$P(DASH,"-",81)=""
"RTN","RCTCSJR",34,0)
 S BLNKS="",$P(BLNKS," ",71)=""
"RTN","RCTCSJR",35,0)
 S DATAITMS="DATE^SRC^ECD(1)^ECD(2)^ECD(3)^ECD(4)^ECD(5)^ECD(6)^ECD(7)^ECD(8)^ECD(9)^TYP^ACTN"
"RTN","RCTCSJR",36,0)
 S RPTITEMS="BILLID^DEBTOR^SSN^TYP^ACTN^OUTDATE^SRC^ECDS"
"RTN","RCTCSJR",37,0)
 Q
"RTN","RCTCSJR",38,0)
 ;
"RTN","RCTCSJR",39,0)
GETRECS ;
"RTN","RCTCSJR",40,0)
 N PC
"RTN","RCTCSJR",41,0)
 S (DATE,DTFRM)=$P(DTFRMTO,U,2)-1,DTTO=$P(DTFRMTO,U,3)
"RTN","RCTCSJR",42,0)
 F  S DATE=$O(^PRCA(430,"AB",DATE)),BILLIEN=0 Q:DATE>DTTO!'DATE  D  ;
"RTN","RCTCSJR",43,0)
 . S INDATE=DATE,OUTDATE=$$UPPER^VALM1($$FMTE^XLFDT(DATE))
"RTN","RCTCSJR",44,0)
 . S OUTDATE=$P(OUTDATE,",")_","_$TR($P(OUTDATE,",",2)," ","")
"RTN","RCTCSJR",45,0)
 . F  S BILLIEN=$O(^PRCA(430,"AB",DATE,BILLIEN)),SEQ=0 Q:BILLIEN=""  D  ;
"RTN","RCTCSJR",46,0)
 .. S BILLID=$P(^PRCA(430,BILLIEN,0),U)
"RTN","RCTCSJR",47,0)
 .. S DEBTIEN=$P(^PRCA(430,BILLIEN,0),U,9) ;33460
"RTN","RCTCSJR",48,0)
 .. S DEBTIDX=$P(^RCD(340,DEBTIEN,0),U) ;777706050;DPT(
"RTN","RCTCSJR",49,0)
 .. S DEBTREF="^"_$P(DEBTIDX,";",2)_$P(DEBTIDX,";")_",0)"
"RTN","RCTCSJR",50,0)
 .. S DEBTREC=@(DEBTREF)
"RTN","RCTCSJR",51,0)
 .. S DEBTOR=$E($P(DEBTREC,U),1,19),SSN=$P(DEBTREC,U,9)
"RTN","RCTCSJR",52,0)
 .. F  S SEQ=$O(^PRCA(430,"AB",DATE,BILLIEN,SEQ)) Q:SEQ=""  D  ;
"RTN","RCTCSJR",53,0)
 ... S DATA=$G(^PRCA(430,BILLIEN,18,SEQ,0))
"RTN","RCTCSJR",54,0)
 ... Q:'$L(DATA)  ; in the event the X-REF is out of sync due to test clearing
"RTN","RCTCSJR",55,0)
 ... F PC=2,12,13 S CD=$P(DATA,U,PC),X=$P(DATAITMS,U,PC)_"="""_$S(CD="":CD,PC=2:CD,PC=12:$P($G(^RC(348.7,CD,0)),U),PC=13:$P($G(^RC(348.6,CD,0)),U),1:"")_"""",@X
"RTN","RCTCSJR",56,0)
 ... K ECD
"RTN","RCTCSJR",57,0)
 ... S ECDS=""
"RTN","RCTCSJR",58,0)
 ... F PC=3:1:11 S CD=$P(DATA,U,PC) Q:'$L(CD)  S CD=$S('$D(^RC(348.5,CD,0)):CD,1:$P(^RC(348.5,CD,0),U)) S X="S "_$P(DATAITMS,U,PC)_"="""_CD_"""" D  ;
"RTN","RCTCSJR",59,0)
 .... Q:'$D(^RC(348.5,$P(DATA,U,PC),0))  ; quits just in case bad error code got thru
"RTN","RCTCSJR",60,0)
 .... X X
"RTN","RCTCSJR",61,0)
 .... S ECDS=ECDS_$S(PC>3:"^",1:"")_ECD(PC-2)
"RTN","RCTCSJR",62,0)
 ... ;  gets record layout based on RPTTYP and places into RPTTYP sorting sequence
"RTN","RCTCSJR",63,0)
 ... D @RPTTYP ;1=BILL NO.  2=DEBTOR  3=REJECT DATE
"RTN","RCTCSJR",64,0)
 ... Q  ;
"RTN","RCTCSJR",65,0)
 ... ;
"RTN","RCTCSJR",66,0)
 S LEV1=""
"RTN","RCTCSJR",67,0)
 S CNTR=0
"RTN","RCTCSJR",68,0)
 K REC
"RTN","RCTCSJR",69,0)
 S UPDN=$S(ASCDES="D":-1,1:1) ; determines ASCending or DeSCending direction
"RTN","RCTCSJR",70,0)
 F  S LEV1=$O(^XTMP("RCTCSJS",$J,"RPT",LEV1),UPDN),LEV2="" Q:LEV1=""  D  ;
"RTN","RCTCSJR",71,0)
 . F  S LEV2=$O(^XTMP("RCTCSJS",$J,"RPT",LEV1,LEV2),UPDN),LEV3="" Q:LEV2=""  D  ;
"RTN","RCTCSJR",72,0)
 .. F  S LEV3=$O(^XTMP("RCTCSJS",$J,"RPT",LEV1,LEV2,LEV3),UPDN),LEV4="" Q:LEV3=""  D  ;
"RTN","RCTCSJR",73,0)
 ... F  S LEV4=$O(^XTMP("RCTCSJS",$J,"RPT",LEV1,LEV2,LEV3,LEV4),UPDN) Q:LEV4=""  D  ;
"RTN","RCTCSJR",74,0)
 .... S RPTREC=^XTMP("RCTCSJS",$J,"RPT",LEV1,LEV2,LEV3,LEV4)
"RTN","RCTCSJR",75,0)
 .... S SRC=$E(RPTREC,67)
"RTN","RCTCSJR",76,0)
 .... I INCLUDE'="ALL",INCLUDE'=SRC Q  ; unwanted source
"RTN","RCTCSJR",77,0)
 .... S CNTR=CNTR+1
"RTN","RCTCSJR",78,0)
 .... S REC(CNTR)=$P(RPTREC,"^",1,$S(EXCEL:10,1:4))
"RTN","RCTCSJR",79,0)
 .... I EXCEL S RECW1=$E(REC(CNTR),1,70),RECW2=$TR($E(REC(CNTR),71,999),"^","-"),REC(CNTR)=RECW1_RECW2
"RTN","RCTCSJR",80,0)
 .... Q:EXCEL  ;     only needs single line string if in Excel format
"RTN","RCTCSJR",81,0)
 .... S RECW1=$E(REC(CNTR),1,70),RECW2=$TR($E(REC(CNTR),71,999),"^","-"),REC(CNTR)=RECW1_RECW2
"RTN","RCTCSJR",82,0)
 .... I $L($P(RPTREC,"^",5,8)) D  ;
"RTN","RCTCSJR",83,0)
 ..... S CNTR=CNTR+1,REC(CNTR)=$E(BLNKS,1,69)_$TR($P(RPTREC,"^",5,8),"^","-")
"RTN","RCTCSJR",84,0)
 .... I $L($P(RPTREC,"^",9)) D  ;
"RTN","RCTCSJR",85,0)
 ..... S CNTR=CNTR+1,REC(CNTR)=$E(BLNKS,1,69)_$P(RPTREC,"^",9)
"RTN","RCTCSJR",86,0)
 .... I GROUPBD="D" D  ;
"RTN","RCTCSJR",87,0)
 ..... K ECD
"RTN","RCTCSJR",88,0)
 ..... S ECDS=$E(RPTREC,70,100)
"RTN","RCTCSJR",89,0)
 ..... F I=1:1:9 S ECD(I)=$P(ECDS,"^",I) Q:'$L(ECD(I))  D  ;
"RTN","RCTCSJR",90,0)
 ...... S CD=$P(ECDS,"^",I),CDIEN=$O(^RC(348.5,"B",CD,0))
"RTN","RCTCSJR",91,0)
 ...... S CDREC="",CDREC1="" I CDIEN,$D(^RC(348.5,CDIEN)) S CDREC=^RC(348.5,CDIEN,0),CDREC1=^RC(348.5,CDIEN,0)
"RTN","RCTCSJR",92,0)
 ...... S (X,DESC)="  "_CD_" "_$P(CDREC,U,2)_"~"_CDREC1
"RTN","RCTCSJR",93,0)
 ...... ;  I $L(DESC)<60 S CNTR=CNTR+1,REC(CNTR)=X
"RTN","RCTCSJR",94,0)
 ...... ;  I $L(DESC)>59 D  ;
"RTN","RCTCSJR",95,0)
 ...... ;   F  S STR=$E(X,1,59) D  Q:'$L(X)  ;
"RTN","RCTCSJR",96,0)
 ...... ;  I $L(X)<60 S CNTR=CNTR+1 S REC(CNTR)=X,X="" Q  ;
"RTN","RCTCSJR",97,0)
 ...... I $L(DESC)<81 S CNTR=CNTR+1,REC(CNTR)=X
"RTN","RCTCSJR",98,0)
 ...... ;  splits line if > 80 chars
"RTN","RCTCSJR",99,0)
 ...... I $L(DESC)>80 D  ;
"RTN","RCTCSJR",100,0)
 ....... F  S STR=$E(X,1,80) D  Q:'$L(X)  ;
"RTN","RCTCSJR",101,0)
 ........ I $L(X)<81 S CNTR=CNTR+1 S REC(CNTR)=X,X="" Q
"RTN","RCTCSJR",102,0)
 ........ F L=$L(STR):-1:1 I $F(STR," ",L) D  Q  ;
"RTN","RCTCSJR",103,0)
 ......... S CNTR=CNTR+1
"RTN","RCTCSJR",104,0)
 ......... S REC(CNTR)=$E(X,1,L),X=$E(X,L+1,999)
"RTN","RCTCSJR",105,0)
 ......... I $L(X) S X="     "_X
"RTN","RCTCSJR",106,0)
 ......... Q  ;
"RTN","RCTCSJR",107,0)
 M ^XTMP("RCTCSJS",$J,"REC")=REC
"RTN","RCTCSJR",108,0)
 Q
"RTN","RCTCSJR",109,0)
 ;
"RTN","RCTCSJR",110,0)
1 ; for report by 1) Bill Number
"RTN","RCTCSJR",111,0)
 S QUIT=0
"RTN","RCTCSJR",112,0)
 I EXCEL S RPTREC=BILLID_U_DEBTOR_U_SSN_U_TYP_U_ACTN_U_OUTDATE_U_SRC_U_ECDS
"RTN","RCTCSJR",113,0)
 I 'EXCEL D  Q:QUIT  ;
"RTN","RCTCSJR",114,0)
 . S RPTREC=""
"RTN","RCTCSJR",115,0)
 . F PC=1:1:7 D  Q:QUIT  ;
"RTN","RCTCSJR",116,0)
 .. S FIELD=$P(RPTITEMS,U,PC)
"RTN","RCTCSJR",117,0)
 .. I PC=7,INCLUDE'="ALL",@FIELD'=INCLUDE S QUIT=1 Q  ;
"RTN","RCTCSJR",118,0)
 .. S RPTREC=RPTREC_$E(@FIELD_BLNKS,1,$P(COLWIDTH1,U,PC))
"RTN","RCTCSJR",119,0)
 . F PC=8 S RPTREC=RPTREC_@$P(RPTITEMS,U,PC)
"RTN","RCTCSJR",120,0)
 S ^XTMP("RCTCSJS",$J,"RPT",BILLID,INDATE,DEBTOR,SEQ)=RPTREC
"RTN","RCTCSJR",121,0)
 Q
"RTN","RCTCSJR",122,0)
2 ; for report by 2) Debtor Name
"RTN","RCTCSJR",123,0)
 S QUIT=0
"RTN","RCTCSJR",124,0)
 I EXCEL S RPTREC=DEBTOR_U_BILLID_U_SSN_U_TYP_U_ACTN_U_OUTDATE_U_SRC_U_ECDS
"RTN","RCTCSJR",125,0)
 I 'EXCEL D  Q:QUIT  ;
"RTN","RCTCSJR",126,0)
 . S RPTREC=""
"RTN","RCTCSJR",127,0)
 . F PC=2,1,3:1:7 D  Q:QUIT  ;
"RTN","RCTCSJR",128,0)
 .. S FIELD=$P(RPTITEMS,U,PC)
"RTN","RCTCSJR",129,0)
 .. I PC=7,INCLUDE'="ALL",@FIELD'=INCLUDE S QUIT=1 Q  ;
"RTN","RCTCSJR",130,0)
 .. S RPTREC=RPTREC_$E(@FIELD_BLNKS,1,$P(COLWIDTH2,U,PC))
"RTN","RCTCSJR",131,0)
 . F PC=8 S RPTREC=RPTREC_@$P(RPTITEMS,U,PC)
"RTN","RCTCSJR",132,0)
 S ^XTMP("RCTCSJS",$J,"RPT",DEBTOR,BILLID,INDATE,SEQ)=RPTREC
"RTN","RCTCSJR",133,0)
 Q
"RTN","RCTCSJR",134,0)
3 ; for report by 3) CS Reject Date
"RTN","RCTCSJR",135,0)
 S QUIT=0
"RTN","RCTCSJR",136,0)
 I EXCEL S RPTREC=OUTDATE_U_BILLID_U_DEBTOR_U_SSN_U_TYP_U_ACTN_U_SRC_U_ECDS
"RTN","RCTCSJR",137,0)
 I 'EXCEL D  Q:QUIT  ;
"RTN","RCTCSJR",138,0)
 . S RPTREC=""
"RTN","RCTCSJR",139,0)
 . F PC=6,1:1:5,7 D  Q:QUIT  ;
"RTN","RCTCSJR",140,0)
 .. S FIELD=$P(RPTITEMS,U,PC)
"RTN","RCTCSJR",141,0)
 .. I PC=7,INCLUDE'="ALL",@FIELD'=INCLUDE S QUIT=1 Q  ;
"RTN","RCTCSJR",142,0)
 .. S RPTREC=RPTREC_$E(@$P(RPTITEMS,U,PC)_BLNKS,1,$P(COLWIDTH3,U,PC))
"RTN","RCTCSJR",143,0)
 . F PC=8 S RPTREC=RPTREC_@$P(RPTITEMS,U,PC)
"RTN","RCTCSJR",144,0)
 S ^XTMP("RCTCSJS",$J,"RPT",INDATE,BILLID,DEBTOR,SEQ)=RPTREC
"RTN","RCTCSJR",145,0)
 Q
"RTN","RCTCSJR",146,0)
PRTRECS ; prints report
"RTN","RCTCSJR",147,0)
 S PAGE=0
"RTN","RCTCSJR",148,0)
 D HEADING
"RTN","RCTCSJR",149,0)
 D REJREPH
"RTN","RCTCSJR",150,0)
 S LN=0
"RTN","RCTCSJR",151,0)
 F LN=1:1 Q:'$D(^XTMP("RCTCSJS",$J,"REC",LN))  D  Q:$D(DIRUT)!$D(DUOUT)!$D(DTOUT)
"RTN","RCTCSJR",152,0)
 . W ^XTMP("RCTCSJS",$J,"REC",LN),!
"RTN","RCTCSJR",153,0)
 . ;    check for end of page here, if necessary form feed and print header
"RTN","RCTCSJR",154,0)
 . I $Y+3>IOSL D
"RTN","RCTCSJR",155,0)
 .. I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR Q:$D(DIRUT)!$D(DUOUT)!$D(DTOUT)
"RTN","RCTCSJR",156,0)
 .. D REJREPH
"RTN","RCTCSJR",157,0)
 . Q
"RTN","RCTCSJR",158,0)
 I $E(IOST,1,2)="C-" R !!,"END OF REPORT...PRESS RETURN TO CONTINUE",X:DTIME W @IOF
"RTN","RCTCSJR",159,0)
 D ^%ZISC
"RTN","RCTCSJR",160,0)
 Q
"RTN","RCTCSJR",161,0)
REJREPH ;
"RTN","RCTCSJR",162,0)
 U IO
"RTN","RCTCSJR",163,0)
 W @IOF
"RTN","RCTCSJR",164,0)
 S PAGE=PAGE+1
"RTN","RCTCSJR",165,0)
 W "PAGE "_PAGE,?10,HDTITLE,?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSJR",166,0)
 W !,DASH,!,CHDR,!,CDSH,!
"RTN","RCTCSJR",167,0)
 Q
"RTN","RCTCSJR",168,0)
COLHDR ; sets report line based on type of report
"RTN","RCTCSJR",169,0)
 S CHDR=CHDR_$P(COLHDRS,U,PC)_$S(EXCEL:"^",1:"")
"RTN","RCTCSJR",170,0)
 S CDSH=CDSH_$P(COLDASH,U,PC)_$S(EXCEL:"^",1:"")
"RTN","RCTCSJR",171,0)
 ;  S CWID=CWID_$P(COLWIDTH,U,PC)
"RTN","RCTCSJR",172,0)
 Q
"RTN","RCTCSJR",173,0)
HEADING ;  compiles info for Heading and titles for cross-servicing reject report
"RTN","RCTCSJR",174,0)
 S HDTITLE="DEBT REFERRAL REJECT REPORT (SORTED BY "_$P("BILL NO.^DEBTOR^REJ DATE",U,RPTTYP)
"RTN","RCTCSJR",175,0)
 S HDTITLE=HDTITLE_" <"_$S(ASCDES="D":"DSC",1:"ASC")_">)"
"RTN","RCTCSJR",176,0)
 ;
"RTN","RCTCSJR",177,0)
 S COLWIDTH1="12^20^11^5^5^13^3^11"
"RTN","RCTCSJR",178,0)
 S COLWIDTH2="12^20^11^5^5^13^3^11"
"RTN","RCTCSJR",179,0)
 S COLWIDTH3="12^20^11^5^6^12^3^11"
"RTN","RCTCSJR",180,0)
 S COLHDRS="BILL NO.    ^DEBTOR              ^SSN       ^TYP ^ACTNCD ^REJECT DATE ^SRC ^ERROR CODES"
"RTN","RCTCSJR",181,0)
 S COLDASH="----------- ^------------------- ^--------- ^--- ^------ ^----------- ^--- ^-----------"
"RTN","RCTCSJR",182,0)
 S (CHDR,CDSH,CWID)=""
"RTN","RCTCSJR",183,0)
 I RPTTYP=1 S CWID=COLWIDTH1,CHDR=$S(EXCEL:COLHDRS,1:$TR(COLHDRS,"^","")),CDSH=$S(EXCEL:COLDASH,1:$TR(COLDASH,"^",""))
"RTN","RCTCSJR",184,0)
 I RPTTYP=2 F PC=2,1,3:1:8 D COLHDR
"RTN","RCTCSJR",185,0)
 I RPTTYP=3 F PC=6,1:1:5,7,8 D COLHDR
"RTN","RCTCSJR",186,0)
 I EXCEL S CHDRS=$TR(CHDR," ",""),CDSH=$TR(CDSH," ","")
"RTN","RCTCSJR",187,0)
 Q
"RTN","RCTCSJR",188,0)
PROMPTS S U="^"
"RTN","RCTCSJR",189,0)
 S STOP=0
"RTN","RCTCSJR",190,0)
 S PROMPT="*** DEBT REFERRAL REJECT REPORT ***"
"RTN","RCTCSJR",191,0)
 S DTFRMTO=$$DTFRMTO(PROMPT) I 'DTFRMTO S STOP=1 Q
"RTN","RCTCSJR",192,0)
 ;
"RTN","RCTCSJR",193,0)
 S PROMPT="Group Error Codes:  Brief or Detail"
"RTN","RCTCSJR",194,0)
 S DIR(0)="SB^B:Brief;D:Detail"
"RTN","RCTCSJR",195,0)
 S GROUPBD=$$SELECT(PROMPT,"B") I "BD"'[GROUPBD S STOP=1 Q
"RTN","RCTCSJR",196,0)
 ;
"RTN","RCTCSJR",197,0)
 S SET="S^1:Bill Number;2:Debtor Name;3:CS Reject Date"
"RTN","RCTCSJR",198,0)
 S RPTTYP=$$RPTTYP("Select One of the Following:",SET) I 'RPTTYP S STOP=1 Q
"RTN","RCTCSJR",199,0)
 ;
"RTN","RCTCSJR",200,0)
 S PROMPT="Include Only: AITC, DMC, TREASURY or 'ALL'"
"RTN","RCTCSJR",201,0)
 S DIR(0)="SB^A:AITC;D:DMC;T:TREASURY;ALL:ALL"
"RTN","RCTCSJR",202,0)
 S DIR("L")=PROMPT
"RTN","RCTCSJR",203,0)
 S INCLUDE=$$SELECT(PROMPT,"ALL") I "ADT"'[$E(INCLUDE) S STOP=1 Q
"RTN","RCTCSJR",204,0)
 ;
"RTN","RCTCSJR",205,0)
 S PROMPT="Sort ASCENDING or DESCENDING"
"RTN","RCTCSJR",206,0)
 S DIR(0)="SB^A:ASCENDING;D:DESCENDING"
"RTN","RCTCSJR",207,0)
 S DIR("L")=PROMPT
"RTN","RCTCSJR",208,0)
 S ASCDES=$$SELECT(PROMPT,"A") I "AD"'[ASCDES S STOP=1 Q
"RTN","RCTCSJR",209,0)
 ;
"RTN","RCTCSJR",210,0)
 S EXCEL=0
"RTN","RCTCSJR",211,0)
 IF GROUPBD="B" D  Q:STOP  ;
"RTN","RCTCSJR",212,0)
 . S PROMPT="CAPTURE Report data to an Excel Document?"
"RTN","RCTCSJR",213,0)
 . S DIR(0)="Y"
"RTN","RCTCSJR",214,0)
 . S DIR("?")="^D HEXC^RCTCSJR"
"RTN","RCTCSJR",215,0)
 . S EXCEL=$$SELECT(PROMPT,"NO") I "01"'[EXCEL S STOP=1 Q
"RTN","RCTCSJR",216,0)
 . I EXCEL=1 D EXCMSG^RCTCSJR ; Display Excel display message
"RTN","RCTCSJR",217,0)
 ;
"RTN","RCTCSJR",218,0)
 S %ZIS="AEQ" D ^%ZIS I POP S STOP=1 Q
"RTN","RCTCSJR",219,0)
 I $D(IO("Q")) D  Q  ;
"RTN","RCTCSJR",220,0)
    .S ZTSAVE("DEBTOR")=""
"RTN","RCTCSJR",221,0)
    .S ZTRTN="PRTRECS^RCTCSJR",ZTDESC="CROSS-SERVICING BILL REPORT"
"RTN","RCTCSJR",222,0)
    .D ^%ZTLOAD,^%ZISC
"RTN","RCTCSJR",223,0)
    .Q
"RTN","RCTCSJR",224,0)
 Q  ; PROMPTS
"RTN","RCTCSJR",225,0)
 ;
"RTN","RCTCSJR",226,0)
SELECT(PROMPT,DEFAULT) ; prompts for a selection
"RTN","RCTCSJR",227,0)
 ;INPUT:
"RTN","RCTCSJR",228,0)
 ;   PROMPT - Message to display prior to prompting for dates
"RTN","RCTCSJR",229,0)
 ;OUTPUT:
"RTN","RCTCSJR",230,0)
 ;    1^BEGDT^ENDDT - Data found
"RTN","RCTCSJR",231,0)
 ;    0             - User up arrowed or timed out
"RTN","RCTCSJR",232,0)
 ;
"RTN","RCTCSJR",233,0)
 N Y,X,DTOUT,OUT,DIRUT,DUOUT,DIROUT ;BEGDT,ENDDT,
"RTN","RCTCSJR",234,0)
 S OUT=0
"RTN","RCTCSJR",235,0)
 W !
"RTN","RCTCSJR",236,0)
 S DIR("A")=PROMPT
"RTN","RCTCSJR",237,0)
 S DIR("B")=DEFAULT
"RTN","RCTCSJR",238,0)
 D ^DIR K DIR
"RTN","RCTCSJR",239,0)
 ;Quit if user time out or didn't enter valid date
"RTN","RCTCSJR",240,0)
 Q:Y<0 OUT
"RTN","RCTCSJR",241,0)
 Q Y
"RTN","RCTCSJR",242,0)
 ;
"RTN","RCTCSJR",243,0)
RPTTYP(PROMPT,SET) ;PRINT CROSS-SERVICING REPORT; print cross-servicing report, prints sorted individual bills that make up a cross-servicing account
"RTN","RCTCSJR",244,0)
 N DIC,ZTSAVE,ZTDESC,ZTRTN,RCSORT
"RTN","RCTCSJR",245,0)
 S OUT=0
"RTN","RCTCSJR",246,0)
 W !
"RTN","RCTCSJR",247,0)
 S DIR(0)=SET ;"S^1:Bill Number;2:Debtor Name;3:CS Reject Date"
"RTN","RCTCSJR",248,0)
 S DIR("A")="Sort by"
"RTN","RCTCSJR",249,0)
 S DIR("B")=1 D ^DIR K DIR
"RTN","RCTCSJR",250,0)
 Q:Y<0 OUT
"RTN","RCTCSJR",251,0)
 Q Y
"RTN","RCTCSJR",252,0)
 ;
"RTN","RCTCSJR",253,0)
DTFRMTO(PROMPT) ;Get from and to dates
"RTN","RCTCSJR",254,0)
 ;INPUT:
"RTN","RCTCSJR",255,0)
 ;   PROMPT - Message to display prior to prompting for dates
"RTN","RCTCSJR",256,0)
 ;OUTPUT:
"RTN","RCTCSJR",257,0)
 ;    1^BEGDT^ENDDT - Data found
"RTN","RCTCSJR",258,0)
 ;    0             - User up arrowed or timed out
"RTN","RCTCSJR",259,0)
 ;
"RTN","RCTCSJR",260,0)
 N %DT,Y,X,BEGDT,ENDDT,DTOUT,OUT,DIRUT,DUOUT,DIROUT
"RTN","RCTCSJR",261,0)
 S OUT=0
"RTN","RCTCSJR",262,0)
 W !,$G(PROMPT)
"RTN","RCTCSJR",263,0)
 S %DT="AEX"
"RTN","RCTCSJR",264,0)
 S %DT("A")="Date Range: FROM: " ;Enter Beginning Date: "
"RTN","RCTCSJR",265,0)
 S %DT("B")="T-7"
"RTN","RCTCSJR",266,0)
 W !
"RTN","RCTCSJR",267,0)
 D ^%DT
"RTN","RCTCSJR",268,0)
 K %DT
"RTN","RCTCSJR",269,0)
 Q:Y<0 OUT  ;Quit if user time out or didn't enter valid date
"RTN","RCTCSJR",270,0)
 S DTFROM=+Y
"RTN","RCTCSJR",271,0)
 S %DT="AEX"
"RTN","RCTCSJR",272,0)
 S %DT("A")="              TO:   ",%DT("B")="T" ;"TODAY"
"RTN","RCTCSJR",273,0)
 D ^%DT
"RTN","RCTCSJR",274,0)
 K %DT
"RTN","RCTCSJR",275,0)
 ;Quit if user time out or didn't enter valid date
"RTN","RCTCSJR",276,0)
 Q:Y<0 OUT
"RTN","RCTCSJR",277,0)
 S DTTO=+Y
"RTN","RCTCSJR",278,0)
 S OUT=1_U_DTFROM_U_DTTO
"RTN","RCTCSJR",279,0)
 ;Switch dates if Begin Date is more recent than End Date
"RTN","RCTCSJR",280,0)
 S:DTFROM>DTTO OUT=1_U_DTTO_U_DTFROM
"RTN","RCTCSJR",281,0)
 Q OUT
"RTN","RCTCSJR",282,0)
 ;
"RTN","RCTCSJR",283,0)
HEXC ; - 'Do you want to capture data to EXCEL' prompt
"RTN","RCTCSJR",284,0)
 W !!,"      Enter:  'Y'   -  To capture detail report data to transfer"
"RTN","RCTCSJR",285,0)
 W !,"                        to an Excel document"
"RTN","RCTCSJR",286,0)
 W !,"              '<CR>' -  To skip this option"
"RTN","RCTCSJR",287,0)
 W !,"              '^'    -  To quit this option"
"RTN","RCTCSJR",288,0)
 Q
"RTN","RCTCSJR",289,0)
 ;
"RTN","RCTCSJR",290,0)
EXCMSG ; - Displays the message about capturing to an Excel file format
"RTN","RCTCSJR",291,0)
 ;
"RTN","RCTCSJR",292,0)
 W !!?5,"To capture as an Excel format, it is recommended that you queue this"
"RTN","RCTCSJR",293,0)
 W !?5,"report to a spool device with margins of 256 and page length of 99999"
"RTN","RCTCSJR",294,0)
 W !?5,"(e.g. spoolname;256;99999). This should help avoid wrapping problems."
"RTN","RCTCSJR",295,0)
 W !!?5,"Another method would be to set up your terminal to capture the detail"
"RTN","RCTCSJR",296,0)
 W !?5,"report data. On some terminals, this can be done by invoking 'Logging'"
"RTN","RCTCSJR",297,0)
 W !?5,"or clicking on the 'Tools' menu above, then click on 'Capture Incoming "
"RTN","RCTCSJR",298,0)
 W !?5,"Data' to save to Desktop. To avoid undesired wrapping of the data saved"
"RTN","RCTCSJR",299,0)
 W !?5,"to the file, change the DISPLAY screen width size to 132 and you can"
"RTN","RCTCSJR",300,0)
 W !?5,"enter '0;256;99999' at the 'DEVICE:' prompt.",!
"RTN","RCTCSJR",301,0)
 Q
"RTN","RCTCSJR",302,0)
 ; ========================================================================
"RTN","RCTCSJS")
0^26^B200131768
"RTN","RCTCSJS",1,0)
RCTCSJS ;ALBANY/LEG - CROSS-SERVICING REJECTS SERVER;02/19/14 3:21 PM
"RTN","RCTCSJS",2,0)
V ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSJS",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSJS",4,0)
 ;Program to process CS REJECT server messages from AITC
"RTN","RCTCSJS",5,0)
 ;
"RTN","RCTCSJS",6,0)
 ;===============================================================================
"RTN","RCTCSJS",7,0)
 ; 
"RTN","RCTCSJS",8,0)
SERVER ; entry from outside
"RTN","RCTCSJS",9,0)
 D INIT1
"RTN","RCTCSJS",10,0)
 S:'$L(XMZ1) XMZ1=$S($L(XMZ2):XMZ2,1:" ")
"RTN","RCTCSJS",11,0)
 S:'$L(XMZ2) XMZ2=$S($L(XMZ1):XMZ1,1:" ")
"RTN","RCTCSJS",12,0)
 I '$G(XMZ1)!'$G(XMZ2) D  G END
"RTN","RCTCSJS",13,0)
 . D RECERR(.ERRCNT,"Inv MM MSG","Invalid MM Msg# '"_$G(XMZ1)_"'"_$S(XMZ2'=XMZ1:" to '"_XMZ2_"'",1:""),0,.RECERR)
"RTN","RCTCSJS",14,0)
 I '$D(^XMB(3.9,XMZ1))!'$D(^XMB(3.9,XMZ2)) D  G END
"RTN","RCTCSJS",15,0)
 . D RECERR(.ERRCNT,"Inv MM MSG","Invalid MM Msg# '"_$G(XMZ1)_"'"_$S(XMZ2'=XMZ1:" to '"_XMZ2_"'",1:""),0,.RECERR)
"RTN","RCTCSJS",16,0)
 ;
"RTN","RCTCSJS",17,0)
 K LIST F XMZ=XMZ1:1:XMZ2 S LIST(XMZ)=""
"RTN","RCTCSJS",18,0)
 I '$D(LIST) D RECERR(.ERRCNT,"BAD QUEUE","No Valid MM Msgs are for REJECTS Queues for MM Msg: "_XMZ,0,.RECERR) G END
"RTN","RCTCSJS",19,0)
 F XMZ=XMZ1:1:XMZ2 I $D(LIST(XMZ)) D  ;
"RTN","RCTCSJS",20,0)
 . K ^XTMP(NMSPC,$J,"BILL")
"RTN","RCTCSJS",21,0)
 . K ^XTMP(NMSPC,$J,"REC")
"RTN","RCTCSJS",22,0)
 . S QNAM=$G(^XMB(3.9,XMZ,2,1,0)) ; Queue Name
"RTN","RCTCSJS",23,0)
 . I $D(^XMB(3.9,XMZ)) D  ;
"RTN","RCTCSJS",24,0)
 .. S BATFDT=$G(^XMB(3.9,XMZ,.6))
"RTN","RCTCSJS",25,0)
 .. S LSTREC=$P($G(^XMB(3.9,XMZ,2,0)),U,3) ; last record# of data
"RTN","RCTCSJS",26,0)
 .. S XNRECS=$P($G(^XMB(3.9,XMZ,2,0)),U,4) ; #records expected from file
"RTN","RCTCSJS",27,0)
 .. S HDR=$G(^XMB(3.9,XMZ,2,2,0)) ; AITC Header record
"RTN","RCTCSJS",28,0)
 .. S BCIDA=$E(HDR,2,9) ; AITC Batch Control ID
"RTN","RCTCSJS",29,0)
 .. I 'XNRECS!'$L(HDR) D  Q  ;
"RTN","RCTCSJS",30,0)
 ... D RECERR(.ERRCNT,"NO RECS/HDR","No Records Found: '"_XNRECS_"'",0,.RECERR)
"RTN","RCTCSJS",31,0)
 .. D START
"RTN","RCTCSJS",32,0)
END ;
"RTN","RCTCSJS",33,0)
 I '$D(^XTMP(NMSPC,$J,"BULTN")) D  ;
"RTN","RCTCSJS",34,0)
 . S BLTNCNT=$G(BLTNCNT)+1
"RTN","RCTCSJS",35,0)
 . S ^XTMP(NMSPC,$J,"BULTN",BLTNCNT)=" "
"RTN","RCTCSJS",36,0)
 . S BLTNCNT=$G(BLTNCNT)+1
"RTN","RCTCSJS",37,0)
 . S BLTNREC="NOTE: NO UNPROCESSABLE/REJECT RECORDS FOUND NEEDING TO BE PROCESSED"
"RTN","RCTCSJS",38,0)
 . S ^XTMP(NMSPC,$J,"BULTN",BLTNCNT)=BLTNREC
"RTN","RCTCSJS",39,0)
 D SENDBUL^RCTCSJS1
"RTN","RCTCSJS",40,0)
 I $D(^XTMP(NMSPC,$J,"ERR")) D SENDERR^RCTCSJS1
"RTN","RCTCSJS",41,0)
 D CLEANUP^RCTCSJS1
"RTN","RCTCSJS",42,0)
 Q  ; ENTER
"RTN","RCTCSJS",43,0)
 ;
"RTN","RCTCSJS",44,0)
INIT1 ;     initialize first time
"RTN","RCTCSJS",45,0)
 S NMSPC="RCTCSJS"
"RTN","RCTCSJS",46,0)
 S CSRCS=""
"RTN","RCTCSJS",47,0)
 S XMZ1=$P($G(XMZ),"-")
"RTN","RCTCSJS",48,0)
 S XMZ2=$P($G(XMZ),"-",2)
"RTN","RCTCSJS",49,0)
 K ^XTMP(NMSPC,$J)
"RTN","RCTCSJS",50,0)
 K TOTAMT,ARTXNID
"RTN","RCTCSJS",51,0)
 S U="^"
"RTN","RCTCSJS",52,0)
 S STATCNT=0 ; STATUS logging count
"RTN","RCTCSJS",53,0)
 D NOW^%DTC
"RTN","RCTCSJS",54,0)
 S (X1,RUNDT)=X,RUNDTTM=%
"RTN","RCTCSJS",55,0)
 S X2=30 D C^%DTC
"RTN","RCTCSJS",56,0)
 S ^XTMP(NMSPC,$J,0)=X_U_RUNDT_U_"CS REJECT FILE PROCESSING/"_DUZ
"RTN","RCTCSJS",57,0)
 S ERRCNT=0 ; ERROR logging count
"RTN","RCTCSJS",58,0)
 S NULLERR="",$P(NULLERR," ",19)="" ; for no error codes
"RTN","RCTCSJS",59,0)
 S BLNKS="",$P(BLNKS," ",25)=""
"RTN","RCTCSJS",60,0)
 S BLTNCNT=0
"RTN","RCTCSJS",61,0)
 S SITE=$$SITE^RCMSITE()
"RTN","RCTCSJS",62,0)
 Q  ; INIT1
"RTN","RCTCSJS",63,0)
 ;
"RTN","RCTCSJS",64,0)
START ; start of process
"RTN","RCTCSJS",65,0)
 D INIT2
"RTN","RCTCSJS",66,0)
 D XMB2XTMP   ; moves MM data from ^XMB(3.9,... to ^XTMP
"RTN","RCTCSJS",67,0)
 D SRTXTMP    ; sorts recs from ^XTMP into by Debtor, by BILL
"RTN","RCTCSJS",68,0)
 S STOPSET="" ; flag to determine if data is error free (or not)
"RTN","RCTCSJS",69,0)
 I RECNS'=XNRECS D  ; logs MailMan record COUNT error
"RTN","RCTCSJS",70,0)
 . S ZMSG="Expected MM RECS: '"_XNRECS_"' not same as # RECS FOUND: '"_RECNS_"'"
"RTN","RCTCSJS",71,0)
 . D RECERR(.ERRCNT,"RECNUMS",ZMSG,RECNS,.RECERR)
"RTN","RCTCSJS",72,0)
 . S STOPSET=1
"RTN","RCTCSJS",73,0)
TOT ;
"RTN","RCTCSJS",74,0)
 I $TR(TOTAMT,"-+","")'=(+ZTOTA*.01) D  ; logs record Total Amt error
"RTN","RCTCSJS",75,0)
 . S X=TOTAMT*.01,X2="2$",X3=4 D COMMA^%DTC S TOTAMOUT=$TR(X," ","")
"RTN","RCTCSJS",76,0)
 . S X=ZTOTA*.01,X2="2$",X3=4 D COMMA^%DTC S ZTOTAOUT=$TR(X," ","")
"RTN","RCTCSJS",77,0)
 . S ZMSG="Expected $Amt: '"_ZTOTAOUT_"' not same as ACCUMULATED AMT found: '"_TOTAMOUT_"'"
"RTN","RCTCSJS",78,0)
 . D RECERR(.ERRCNT,"TOTAL $ AMT",ZMSG,RECNS,.RECERR)
"RTN","RCTCSJS",79,0)
 . S STOPSET=STOPSET_2
"RTN","RCTCSJS",80,0)
 I CRCNT'=+$G(ZRCNT) D  ; logs record COUNT error
"RTN","RCTCSJS",81,0)
 . S ZMSG="Z record RECS: '"_$G(ZRCNT)_"' not same as # RECS FOUND: '"_CRCNT_"'"
"RTN","RCTCSJS",82,0)
 . D RECERR(.ERRCNT,"Z-REC-CNTS",ZMSG,RECNS,.RECERR)
"RTN","RCTCSJS",83,0)
 . S STOPSET=STOPSET_3
"RTN","RCTCSJS",84,0)
 I STOPSET S STOPMSG="" D  Q  ; whole file error detected, DO NOT PROCESS REJECTS
"RTN","RCTCSJS",85,0)
 . F I=1:1:3 I STOPSET[I D  ;
"RTN","RCTCSJS",86,0)
 .. I I[1 S STOPMSG="(#MM RECS("_XNRECS_") not same as #Recs found("_RECNS_")"
"RTN","RCTCSJS",87,0)
 .. I I[2 S STOPMSG="(ZTOTAMT("_+$G(ZTOTA)_") not same as Amt found("_TOTAMT_")"
"RTN","RCTCSJS",88,0)
 .. I I[3 S STOPMSG="(#Z RECCNT("_$G(ZRCNT)_") not same as #C Recs found("_CRCNT_")"
"RTN","RCTCSJS",89,0)
 .. S ZMSG="BILL Records NOT Updated: "_STOPMSG
"RTN","RCTCSJS",90,0)
 .. D RECERR(.ERRCNT,"FILE ERR",ZMSG,RECNS,.RECERR)
"RTN","RCTCSJS",91,0)
 I '$D(^XTMP(NMSPC,$J,"BILL")) D  Q  ; logs NO VALID BILLS found error
"RTN","RCTCSJS",92,0)
 . S ZMSG="Found NO REJECT Bill Errors"
"RTN","RCTCSJS",93,0)
 . D RECERR(.ERRCNT,"NO BILLS",ZMSG,0,.RECERR)
"RTN","RCTCSJS",94,0)
 D SETREJS
"RTN","RCTCSJS",95,0)
 Q  ; START
"RTN","RCTCSJS",96,0)
 ;
"RTN","RCTCSJS",97,0)
INIT2 ;     subsequent inits
"RTN","RCTCSJS",98,0)
 S CRCNT=0 ; "C" records count
"RTN","RCTCSJS",99,0)
 S TOTAMT=0 ; Total Amount of Referred Balance
"RTN","RCTCSJS",100,0)
 N I ; new variables
"RTN","RCTCSJS",101,0)
 ;
"RTN","RCTCSJS",102,0)
 S LSTREC=$P($G(^XMB(3.9,XMZ,2,0)),U,3) ; last record# of data
"RTN","RCTCSJS",103,0)
 S XNRECS=$P($G(^XMB(3.9,XMZ,2,0)),U,4) ; #records expected from file
"RTN","RCTCSJS",104,0)
 S HDR=$G(^XMB(3.9,XMZ,2,2,0)) ; AITC Header record
"RTN","RCTCSJS",105,0)
 S BCIDA=$E(HDR,2,9) ; AITC Batch Control ID
"RTN","RCTCSJS",106,0)
 I 'XNRECS!'$L(HDR) D  Q  ;
"RTN","RCTCSJS",107,0)
 . D RECERR(.ERRCNT,"NO RECS/HDR","No Records Found: '"_XNRECS_"'",0,.RECERR)
"RTN","RCTCSJS",108,0)
 Q  ; INIT2
"RTN","RCTCSJS",109,0)
 ;
"RTN","RCTCSJS",110,0)
FMDTM(%H) ;
"RTN","RCTCSJS",111,0)
 S %H=$H D YX^%DTC ;  X=FM Date, %=Time
"RTN","RCTCSJS",112,0)
 Q X_%
"RTN","RCTCSJS",113,0)
 ;
"RTN","RCTCSJS",114,0)
XMB2XTMP ;copies ^XMB(3.9,XMZ) to ^XTMP
"RTN","RCTCSJS",115,0)
 M ^XTMP(NMSPC,$J,"READ",BCIDA)=^XMB(3.9,XMZ,2)
"RTN","RCTCSJS",116,0)
 Q  ; XMB2XTMP
"RTN","RCTCSJS",117,0)
 ;
"RTN","RCTCSJS",118,0)
SRTXTMP ;sorts ^XTMP(...,"READ" recs into ^XTMP(..."BILL" which is sorted by Debtor ID, by BILL
"RTN","RCTCSJS",119,0)
 F RECN=2:2 Q:'$D(^XTMP(NMSPC,$J,"READ",BCIDA,RECN))  D  ;
"RTN","RCTCSJS",120,0)
 . S NOTPROC=""
"RTN","RCTCSJS",121,0)
 . K CERRS
"RTN","RCTCSJS",122,0)
 . S RECERR=0
"RTN","RCTCSJS",123,0)
 . S REC1=^XTMP(NMSPC,$J,"READ",BCIDA,RECN,0)
"RTN","RCTCSJS",124,0)
 . S REC2=^XTMP(NMSPC,$J,"READ",BCIDA,RECN+1,0)
"RTN","RCTCSJS",125,0)
 . S REC=$P(REC1,"^")_$P(REC2,"~") ; eliminate record delimiters
"RTN","RCTCSJS",126,0)
 . Q:$E(REC,1,4)="NNNN"
"RTN","RCTCSJS",127,0)
 . S RID=$E(REC) ; (H,C,Z)
"RTN","RCTCSJS",128,0)
 . S RTYP=$TR($E(REC,2,3)," ","") ; eliminate spaces
"RTN","RCTCSJS",129,0)
 . I RID="C",",1,2,2A,2B,2C,2D,2E,3,4,5A,5B,6,"'[(","_RTYP_",") D  Q  ; logs RTYP error
"RTN","RCTCSJS",130,0)
 .. S CBILL=$E(REC,20,29)
"RTN","RCTCSJS",131,0)
 .. S ZMSG="Invalid Record TYPE Received: '"_RTYP_"' from Record: "_CBILL_", record# "_RECN
"RTN","RCTCSJS",132,0)
 .. D RECERR(.ERRCNT,"INV REC TYPE",ZMSG,RECN,.RECERR)
"RTN","RCTCSJS",133,0)
 . S RACTN=$E(REC,4) ; (A,B,D,L,U,V)
"RTN","RCTCSJS",134,0)
 . I $L(REC)'=471 D  Q  ; logs record LEN error
"RTN","RCTCSJS",135,0)
 .. D RECERR(.ERRCNT,"RECLEN","Record Length Error: "_$L(REC),RECN,.RECERR)
"RTN","RCTCSJS",136,0)
 . D @RID
"RTN","RCTCSJS",137,0)
 . Q:RECERR  ; quit, process err detected and logged via RECERR
"RTN","RCTCSJS",138,0)
 . Q:$G(CERRS(RTYP))=NULLERR!'$D(CERRS(RTYP))  ; ignore, no errors in this record
"RTN","RCTCSJS",139,0)
 . I CERRS(RTYP)["9A" S REFBATCH=$E(CERRS(RTYP),11,18) D  ;
"RTN","RCTCSJS",140,0)
 .. S ZMSG="Invalid Referral Batch: '"_REFBATCH_"'  from Message: '"_XMZ_"'"
"RTN","RCTCSJS",141,0)
 .. D RECERR(.ERRCNT,"INV REF BATCH",ZMSG,RECN,.RECERR)
"RTN","RCTCSJS",142,0)
 .. S ERRSFND("9A",REFBATCH,XMZ)=""
"RTN","RCTCSJS",143,0)
 . I '$G(SAMESITE) D  ;
"RTN","RCTCSJS",144,0)
 .. S ZMSG="Expecting: '"_SITE_"', Found: '"_SITENUM_"'/"_CBILL_"/"_RID_RTYP
"RTN","RCTCSJS",145,0)
 .. D RECERR(.ERRCNT,"WRONG REC SITE",ZMSG,RECN,.RECERR)
"RTN","RCTCSJS",146,0)
 . Q:'$G(SAMESITE)  ; ignore, this record belongs to a different site
"RTN","RCTCSJS",147,0)
 . ;  Q:$G(NOTPROC)  ; last Z record shows first THRU last batches were not all completely satisfied
"RTN","RCTCSJS",148,0)
 . ;
"RTN","RCTCSJS",149,0)
 . I RID="C" D LOGREJS
"RTN","RCTCSJS",150,0)
 S RECNS=RECN-1
"RTN","RCTCSJS",151,0)
 Q  ; SRTXTMP
"RTN","RCTCSJS",152,0)
 ;
"RTN","RCTCSJS",153,0)
LOGREJS ; compiles the varied reject errors by BILL
"RTN","RCTCSJS",154,0)
 K Z
"RTN","RCTCSJS",155,0)
 S CERRS=$P($G(^XTMP(NMSPC,$J,"BILL",CDEBTIEN,CBILL,HDATE,CSRC,RTYP,RACTN)),U)
"RTN","RCTCSJS",156,0)
 F I=2:2:18 S ERR=$E(CERRS(RTYP),I-1,I) Q:ERR="  "  D  ;
"RTN","RCTCSJS",157,0)
 . I '$D(^RC(348.5,"B",ERR)) D  Q  ;
"RTN","RCTCSJS",158,0)
 .. S ZMSG="Unknown Error Code: '"_ERR_"', FOUND IN: "_CBILL_"/"_RID_RTYP
"RTN","RCTCSJS",159,0)
 .. D RECERR(.ERRCNT,"UNK ERR CD",ZMSG,RECN,.RECERR)
"RTN","RCTCSJS",160,0)
 . S:CERRS'[ERR CERRS=CERRS_ERR_"," ; captures new errs
"RTN","RCTCSJS",161,0)
 I $L(CERRS) S ^XTMP(NMSPC,$J,"BILL",CDEBTIEN,CBILL,HDATE,CSRC,RTYP,RACTN)=CERRS_U_$G(ARTXNID(CDEBTIEN,CBILL))
"RTN","RCTCSJS",162,0)
 Q  ; LOGREJS
"RTN","RCTCSJS",163,0)
 ;
"RTN","RCTCSJS",164,0)
SETREJS ;
"RTN","RCTCSJS",165,0)
 S IDXS=".01;1;2;3;4;5;6;7;8;9;10;11;12;13;14"
"RTN","RCTCSJS",166,0)
 S BILLIEN=""
"RTN","RCTCSJS",167,0)
 F  S BILLIEN=$O(^XTMP(NMSPC,$J,"BILL",BILLIEN)),SBILL="" Q:'$L(BILLIEN)  D  ;
"RTN","RCTCSJS",168,0)
 . F  S SBILL=$O(^XTMP(NMSPC,$J,"BILL",BILLIEN,SBILL)),HDATE="" Q:'$L(SBILL)  D  ;
"RTN","RCTCSJS",169,0)
 .. F  S HDATE=$O(^XTMP(NMSPC,$J,"BILL",BILLIEN,SBILL,HDATE)),CSRC="" Q:'$L(HDATE)  D  ;
"RTN","RCTCSJS",170,0)
 ... F  S CSRC=$O(^XTMP(NMSPC,$J,"BILL",BILLIEN,SBILL,HDATE,CSRC)),RTYP="" Q:CSRC=""  D  ;
"RTN","RCTCSJS",171,0)
 .... F  S RTYP=$O(^XTMP(NMSPC,$J,"BILL",BILLIEN,SBILL,HDATE,CSRC,RTYP)),RACTN="" Q:RTYP=""  D  ;
"RTN","RCTCSJS",172,0)
 ..... F  S RACTN=$O(^XTMP(NMSPC,$J,"BILL",BILLIEN,SBILL,HDATE,CSRC,RTYP,RACTN)) Q:RACTN=""  D  ;
"RTN","RCTCSJS",173,0)
 ...... S CERRS=$P(^XTMP(NMSPC,$J,"BILL",BILLIEN,SBILL,HDATE,CSRC,RTYP,RACTN),U)
"RTN","RCTCSJS",174,0)
 ...... S ^XTMP(NMSPC,$J,"ERRCDS",CERRS,BILLIEN)="" ; log by errs found
"RTN","RCTCSJS",175,0)
 ...... S REC=ZDATE_U_CSRC_U_$TR(CERRS,",","^")
"RTN","RCTCSJS",176,0)
 ...... S $P(REC,U,12)=RTYP,$P(REC,U,13)=RACTN,$P(REC,U,14)=BCIDA,$P(REC,U,15)=XMZ
"RTN","RCTCSJS",177,0)
 ...... S PATID=$P(^PRCA(430,BILLIEN,0),U,7),OTHERID=$P(^PRCA(430,BILLIEN,0),U,9)
"RTN","RCTCSJS",178,0)
 ...... I OTHERID D  ;
"RTN","RCTCSJS",179,0)
 ....... S IDNUMGLB=$P(^RCD(340,OTHERID,0),U),IDGLOB=$P(IDNUMGLB,";",2),IDNUM=+IDNUMGLB
"RTN","RCTCSJS",180,0)
 ....... S IDREC0=@("^"_IDGLOB_IDNUM_",0)")
"RTN","RCTCSJS",181,0)
 ....... S NAM=$P(IDREC0,U),SSN=$P(IDREC0,U,9)
"RTN","RCTCSJS",182,0)
 ...... I PATID S NAM=$P(^DPT(PATID,0),U),SSN=$P(^DPT(PATID,0),U,9)
"RTN","RCTCSJS",183,0)
 ...... S STATCNT=STATCNT-1
"RTN","RCTCSJS",184,0)
 ...... D UPDREJ
"RTN","RCTCSJS",185,0)
 Q  ; SETREJS
"RTN","RCTCSJS",186,0)
 ;
"RTN","RCTCSJS",187,0)
UPDREJ ;
"RTN","RCTCSJS",188,0)
 K DR,DA,DD,DO,Y
"RTN","RCTCSJS",189,0)
 ;
"RTN","RCTCSJS",190,0)
 ; checks for valid bill
"RTN","RCTCSJS",191,0)
 S DIC="^PRCA(430,",DIC(0)="KMNZ",X=BILLIEN D ^DIC
"RTN","RCTCSJS",192,0)
 S KBILL=$E(SBILL,5,11)
"RTN","RCTCSJS",193,0)
 ; 
"RTN","RCTCSJS",194,0)
 ; Set ID for errors if ARTXNID not available
"RTN","RCTCSJS",195,0)
 N ERRORID
"RTN","RCTCSJS",196,0)
 S ERRORID=$S($G(ARTXNID(BILLIEN))="":U_U_RECN,1:ARTXNID(BILLIEN))
"RTN","RCTCSJS",197,0)
 ;
"RTN","RCTCSJS",198,0)
 I Y=-1 D  Q  ;
"RTN","RCTCSJS",199,0)
 . S ZMSG="Unknown Bill: "_BILLIEN_"/"_SBILL_"/"_RTYP
"RTN","RCTCSJS",200,0)
 . D RECERR(.ERRCNT,"UNK-BILL:",ZMSG,$P(ERRORID,U,3),.RECERR) Q  ; UPDREJ ;
"RTN","RCTCSJS",201,0)
 ; checks if REJECT record was previously logged
"RTN","RCTCSJS",202,0)
 S COMMENT="XMB "_XMZ_" "_BCIDA
"RTN","RCTCSJS",203,0)
 ;I $D(^PRCA(430,BILLIEN,18,"B",ZDATE)) D  Q:PREV  ;UPDREJ
"RTN","RCTCSJS",204,0)
 ;. S IDX="",PREV=0
"RTN","RCTCSJS",205,0)
 ;. F  S IDX=$O(^PRCA(430,BILLIEN,18,"B",ZDATE,IDX)) Q:'IDX  D  ;
"RTN","RCTCSJS",206,0)
 ;.. I $P(^PRCA(430,BILLIEN,18,IDX,0),U,1,14)=$P(REC,U,1,14) S PREV=1 Q
"RTN","RCTCSJS",207,0)
 ;. I PREV D  ;
"RTN","RCTCSJS",208,0)
 ;. . S ZMSG="BILL Previously Logged IEN: "_BILLIEN_"/"_SBILL_"/"_RTYP
"RTN","RCTCSJS",209,0)
 ;. . D RECERR(.ERRCNT,"BILL PREV LOGGED",ZMSG,$P(ERRORID,U,3),.RECERR)
"RTN","RCTCSJS",210,0)
 ;
"RTN","RCTCSJS",211,0)
 ; gets next rejects subfile entry number
"RTN","RCTCSJS",212,0)
 K DR,DA,DD,DO
"RTN","RCTCSJS",213,0)
 S DA(1)=+Y
"RTN","RCTCSJS",214,0)
 S DIC="^PRCA(430,"_DA(1)_",18,"
"RTN","RCTCSJS",215,0)
 S DIC(0)="KMNZ"
"RTN","RCTCSJS",216,0)
 S DIC("P")=$P(^DD(430,172,0),"^",2)
"RTN","RCTCSJS",217,0)
 S (DA,X)=$O(@(DIC_"""A"")"),-1)
"RTN","RCTCSJS",218,0)
 D ^DIC
"RTN","RCTCSJS",219,0)
 ;
"RTN","RCTCSJS",220,0)
 ; set Reject Fields
"RTN","RCTCSJS",221,0)
 K DD,DO
"RTN","RCTCSJS",222,0)
 S DA(1)=BILLIEN
"RTN","RCTCSJS",223,0)
 ; S DA=$S(Y=-1:1,1:DA+1)
"RTN","RCTCSJS",224,0)
 S DA=$S($O(^PRCA(430,BILLIEN,18,"A"),-1):($O(^PRCA(430,BILLIEN,18,"A"),-1)+1),1:1)
"RTN","RCTCSJS",225,0)
 S DIE=DIC K DIC
"RTN","RCTCSJS",226,0)
 S DR=""
"RTN","RCTCSJS",227,0)
 D RJCDCONV
"RTN","RCTCSJS",228,0)
 F PC=1:1:15 S DTA=$P(REC,U,PC) I $L(DTA) S DR=DR_$P(IDXS,";",PC)_"////"_DTA_";"
"RTN","RCTCSJS",229,0)
 S DIC("DR")=DR
"RTN","RCTCSJS",230,0)
 I $L(DR) D  ;
"RTN","RCTCSJS",231,0)
 . D ^DIE
"RTN","RCTCSJS",232,0)
 . ; Re-Index AB x_ref
"RTN","RCTCSJS",233,0)
 . S DIK(1)=".01^AB^B"
"RTN","RCTCSJS",234,0)
 . S DIK="^PRCA(430,"_BILLIEN_",18," D ENALL^DIK ;,DA(1)=HDATE
"RTN","RCTCSJS",235,0)
 . S $P(^PRCA(430,BILLIEN,18,0),U,3)=$O(^PRCA(430,BILLIEN,18,"A"),-1)
"RTN","RCTCSJS",236,0)
 . ;
"RTN","RCTCSJS",237,0)
 . D STOPFILE ; resets STOP TCSP REFERRAL FLAG 
"RTN","RCTCSJS",238,0)
 . D LOGBULTN ; logs data into Bulletin
"RTN","RCTCSJS",239,0)
 Q  ;UPDREJ
"RTN","RCTCSJS",240,0)
 ;
"RTN","RCTCSJS",241,0)
STOPFILE ;set stop referral data in file 430
"RTN","RCTCSJS",242,0)
 N B0,DEBTOR,BTRNNUM
"RTN","RCTCSJS",243,0)
 S B0=$G(^PRCA(430,BILLIEN,0))
"RTN","RCTCSJS",244,0)
 S $P(^PRCA(430,BILLIEN,15),U,7,10)="1^"_RUNDT_U_"R"_U_$G(COMMENT)
"RTN","RCTCSJS",245,0)
 I RTYP=1 D  Q
"RTN","RCTCSJS",246,0)
 .I RACTN="A" K ^PRCA(430,BILLIEN,15),^(16),^PRCA(430,"TCSP",BILLIEN)
"RTN","RCTCSJS",247,0)
 .I RACTN="U" S $P(^PRCA(430,BILLIEN,19),U,1)="1" Q
"RTN","RCTCSJS",248,0)
 .I RACTN="L" S ^PRCA(430,"TCSP",BILLIEN)="",$P(^PRCA(430,BILLIEN,15),U,3)="" Q
"RTN","RCTCSJS",249,0)
 I RTYP="2" S DEBTOR=$P(B0,U,9) D  Q
"RTN","RCTCSJS",250,0)
 .I RACTN="A" K ^RCD(340,DEBTOR,7),^RCD(340,"TCSP",DEBTOR) Q
"RTN","RCTCSJS",251,0)
 .I RACTN="L" S ^RCD(340,"TCSP",DEBTOR)="",$P(^RCD(340,DEBTOR,7),U,3)="",^PRCA(430,"TCSP",BILLIEN)="",$P(^PRCA(430,BILLIEN,15),U,1)=DT,$P(^(15),U,2)="",$P(^(15),U,3)="",$P(^(15),U,4)="",$P(^(15),U,5)="" Q
"RTN","RCTCSJS",252,0)
 .I RACTN="U" S $P(^PRCA(430,BILLIEN,19),U,2)="1" Q
"RTN","RCTCSJS",253,0)
 I RTYP="2A" D  Q
"RTN","RCTCSJS",254,0)
 .I RACTN="A" Q
"RTN","RCTCSJS",255,0)
 .I RACTN="U" S $P(^PRCA(430,BILLIEN,19),U,3)="1" Q
"RTN","RCTCSJS",256,0)
 I RTYP="2C" D  Q
"RTN","RCTCSJS",257,0)
 . I RACTN="A" S $P(^PRCA(430,BILLIEN,19),U,4)="1" Q
"RTN","RCTCSJS",258,0)
 I RTYP=3 Q
"RTN","RCTCSJS",259,0)
 I RTYP="5B" D  Q
"RTN","RCTCSJS",260,0)
 .I RACTN="U" I $D(ARTXNID(BILLIEN)) S TRNNUM=+$P(ARTXNID(BILLIEN),U,1) I TRNNUM D
"RTN","RCTCSJS",261,0)
 ..;N INDX 
"RTN","RCTCSJS",262,0)
 ..S INDX=0
"RTN","RCTCSJS",263,0)
 ..F  S INDX=$O(^PRCA(430,BILLIEN,17,INDX)) Q:+INDX=0  I $P($G(^PRCA(430,BILLIEN,17,INDX,0)),U,1)=TRNNUM S $P(^PRCA(430,BILLIEN,17,INDX,0),U,2)=1 S DR="151///DT",DIE="^PRCA(430,",DA=BILLIEN D ^DIE Q
"RTN","RCTCSJS",264,0)
 Q
"RTN","RCTCSJS",265,0)
 ;
"RTN","RCTCSJS",266,0)
C S CRCNT=CRCNT+1
"RTN","RCTCSJS",267,0)
 S CERRS(RTYP)=$E(REC,452,469)
"RTN","RCTCSJS",268,0)
 F PC=1:2 S CHKEC=$E(CERRS(RTYP),PC,PC+1) Q:CHKEC=""  Q:CHKEC="  "  I '$D(^RC(348.5,"B",CHKEC)) D  ;
"RTN","RCTCSJS",269,0)
 . S ZMSG="Invalid Error Code: '"_CHKEC_"' in Batch: "_BCIDA_"/"_RID_RTYP
"RTN","RCTCSJS",270,0)
 . S ERR=1 D RECERR(.ERRCNT,"INV ERR CODE",ZMSG,RECN,.RECERR)
"RTN","RCTCSJS",271,0)
 S CSRC=$E(REC,470),CSRC=$S(CSRC=" ":"T",1:CSRC)
"RTN","RCTCSJS",272,0)
 I CSRCS'[CSRC S CSRCS=CSRCS_CSRC
"RTN","RCTCSJS",273,0)
 S LBL="L"_RTYP
"RTN","RCTCSJS",274,0)
 D @LBL ; perform record type parsing of data
"RTN","RCTCSJS",275,0)
 Q  ; C
"RTN","RCTCSJS",276,0)
H ; Header record
"RTN","RCTCSJS",277,0)
 S BCIDA=$E(REC,2,9)
"RTN","RCTCSJS",278,0)
 S HREC=REC
"RTN","RCTCSJS",279,0)
 S HFAST=$E(REC,24,25),HALC=$E(REC,26,33),HERRS=$E(REC,452,469),HSRC=$E(REC,470,471)
"RTN","RCTCSJS",280,0)
 S H4DATE=$E(BCIDA,1,4),HSEQ=$E(BCIDA,5,9) ; (note: H4DATE is Y_DOY)
"RTN","RCTCSJS",281,0)
 D DOY2EXT(H4DATE,.HDATE)
"RTN","RCTCSJS",282,0)
 I HDATE'?7N S ERR=1 D RECERR(.ERRCNT,"INV DATE","Invalid Date: '"_HDATE_"' /"_RID_RTYP,RECN,.RECERR) Q  ;
"RTN","RCTCSJS",283,0)
 I HERRS'=NULLERR S FILERR=$E(HERRS,1,10),BCIDV=$E(HERRS,11,18)
"RTN","RCTCSJS",284,0)
 Q  ; H
"RTN","RCTCSJS",285,0)
Z ; Trailer record
"RTN","RCTCSJS",286,0)
 S ZREC=REC
"RTN","RCTCSJS",287,0)
 S ZRCNT=$E(REC,2,9),ZTOTA=$E(REC,10,23)
"RTN","RCTCSJS",288,0)
 S Z4DOY=$E(REC,24,27)
"RTN","RCTCSJS",289,0)
 S ZSEQ=$E(REC,28,31)
"RTN","RCTCSJS",290,0)
 S ZFAST=$E(REC,46,47),ZALC=$E(REC,48,55)
"RTN","RCTCSJS",291,0)
 S ZERRS=$S($E(REC,452)'=" ":$E(REC,452,469),1:NULLERR)
"RTN","RCTCSJS",292,0)
 S ZBAT1=$E(REC,459,462),ZBAT2=$E(REC,463,466)
"RTN","RCTCSJS",293,0)
 S ZSRC=$E(REC,470,471)
"RTN","RCTCSJS",294,0)
 D DOY2EXT(Z4DOY,.ZDATE)
"RTN","RCTCSJS",295,0)
 Q  ; Z
"RTN","RCTCSJS",296,0)
DOY2EXT(YDOY,ZDATE) ; gets Date from DOY;
"RTN","RCTCSJS",297,0)
 N X
"RTN","RCTCSJS",298,0)
 S ZLYR=$E(YDOY),ZDOY=$E(YDOY,2,4)
"RTN","RCTCSJS",299,0)
 S %H=$H D YX^%DTC
"RTN","RCTCSJS",300,0)
 S X1=$S($E(X,3)=ZLYR:$E(X,1,3)-1,$E(X,3)<ZLYR:$E(X,1,2)_ZLYR-11,$E(X,3)>ZLYR:$E(X,1,2)_ZLYR-1)_"1231"
"RTN","RCTCSJS",301,0)
 S X2=ZDOY D C^%DTC
"RTN","RCTCSJS",302,0)
 S NX=X
"RTN","RCTCSJS",303,0)
 S ZDATE=$S(ZDOY>365&($E(X,4,7)'="1231"):-1,1:NX) ; error if DOY >365 and not a Leap Year 
"RTN","RCTCSJS",304,0)
 Q  ; DOY2EXT
"RTN","RCTCSJS",305,0)
 ;
"RTN","RCTCSJS",306,0)
L1 ; Debt Record
"RTN","RCTCSJS",307,0)
 S CORIGD=$E(REC,77,90)*.01,CREFBAL=$E(REC,91,104)*.01
"RTN","RCTCSJS",308,0)
 S TOTAMT=$G(TOTAMT)+CREFBAL
"RTN","RCTCSJS",309,0)
 D GETPCS1
"RTN","RCTCSJS",310,0)
 Q  ; L1
"RTN","RCTCSJS",311,0)
L2 ;; Debtor Record
"RTN","RCTCSJS",312,0)
 S CDEBTIN=$E(REC,65,73),CDEBNAML=$E(REC,77,111),CDEBNAMF=$E(REC,112,146)
"RTN","RCTCSJS",313,0)
 S CDEBNAMM=$E(REC,147,181)
"RTN","RCTCSJS",314,0)
 D GETPCS1
"RTN","RCTCSJS",315,0)
 Q  ;L2
"RTN","RCTCSJS",316,0)
L2A ;; Individual Debtor Record
"RTN","RCTCSJS",317,0)
 S CDEBSEX=$E(REC,68),CDOB=$E(REC,69,76)
"RTN","RCTCSJS",318,0)
 D GETPCS1
"RTN","RCTCSJS",319,0)
 Q  ;L2A
"RTN","RCTCSJS",320,0)
L2B ; Business Debtor Record
"RTN","RCTCSJS",321,0)
 D GETPCS1
"RTN","RCTCSJS",322,0)
 Q  ; L2B
"RTN","RCTCSJS",323,0)
L2C ; Debtor Contact Information
"RTN","RCTCSJS",324,0)
 S CDEBTIN=$E(REC,65,73)
"RTN","RCTCSJS",325,0)
 D GETPCS1
"RTN","RCTCSJS",326,0)
 Q  ; L2C
"RTN","RCTCSJS",327,0)
L2D ; Debtor Record (Property Information)
"RTN","RCTCSJS",328,0)
 D GETPCS1
"RTN","RCTCSJS",329,0)
 Q  ; L2D
"RTN","RCTCSJS",330,0)
L2E ; Debtor Record (Employment Information for Individual Debtor)
"RTN","RCTCSJS",331,0)
 D GETPCS1
"RTN","RCTCSJS",332,0)
 Q  ; L2E
"RTN","RCTCSJS",333,0)
L3 ; Case Record
"RTN","RCTCSJS",334,0)
 D GETPCS1
"RTN","RCTCSJS",335,0)
 Q  ; L3
"RTN","RCTCSJS",336,0)
L4 ; Alias Name
"RTN","RCTCSJS",337,0)
 S CDEBTIN=$E(REC,65,73)
"RTN","RCTCSJS",338,0)
 D GETPCS1
"RTN","RCTCSJS",339,0)
 Q  ; L4
"RTN","RCTCSJS",340,0)
L5A ; Creditor Agency Financial Transactions (Collections)
"RTN","RCTCSJS",341,0)
 S CTRAMT=$E(REC,117,130)*.01,CORIGPMT=$E(REC,117,130)*.01
"RTN","RCTCSJS",342,0)
 S TOTAMT=+$G(TOTAMT)+($E(REC,117,130)*.01)
"RTN","RCTCSJS",343,0)
 D GETPCS2
"RTN","RCTCSJS",344,0)
 Q  ; L5A
"RTN","RCTCSJS",345,0)
L5B ; Creditor Agency Financial Transactions (Adjustments)
"RTN","RCTCSJS",346,0)
 S CSPAMT=$E(REC,117,130)*.01,CSTAMT=$E(REC,173,186)*.01
"RTN","RCTCSJS",347,0)
 S CSTADJ=$E(REC,211,224)*.01
"RTN","RCTCSJS",348,0)
 S TOTAMT=+$G(TOTAMT)+($E(REC,173,186)*.01)
"RTN","RCTCSJS",349,0)
 D GETPCS2
"RTN","RCTCSJS",350,0)
 S ARTXNID=$E(REC,93,107),ARTXNID(CDEBTIEN)=+ARTXNID_U_CBILL_U_RECN
"RTN","RCTCSJS",351,0)
 Q  ; L5B
"RTN","RCTCSJS",352,0)
L6 ; Payment Bypass/Offset
"RTN","RCTCSJS",353,0)
 S CDEBTIN=$E(REC,65,73)
"RTN","RCTCSJS",354,0)
 D GETPCS1
"RTN","RCTCSJS",355,0)
 Q  ; L6
"RTN","RCTCSJS",356,0)
GETPCS1 ; 
"RTN","RCTCSJS",357,0)
 Q:CERRS(RTYP)=NULLERR
"RTN","RCTCSJS",358,0)
 S CDEBTID=$E(REC,20,49)
"RTN","RCTCSJS",359,0)
 S SITENUM=$E(CDEBTID,1,3)
"RTN","RCTCSJS",360,0)
 S SAMESITE=$S(SITENUM=SITE:1,1:0)
"RTN","RCTCSJS",361,0)
 I 'SAMESITE D  Q  ;
"RTN","RCTCSJS",362,0)
 . S ZMSG="Wrong Rec Site ('"_SITENUM_"' vs. '"_SITE_"') /"_CDEBTID_"/"_CBILL_"/"_RID_RTYP
"RTN","RCTCSJS",363,0)
 . D RECERR(.ERRCNT,"WRONG REC SITE",ZMSG,RECN,.RECERR)
"RTN","RCTCSJS",364,0)
 S CACT=$E(REC,4),CFAST=$E(REC,5,6),CALC=$E(REC,7,14),CSTATN=$E(REC,15,19)
"RTN","RCTCSJS",365,0)
 S CDEBTOR=$E(REC,50,64)
"RTN","RCTCSJS",366,0)
 D CHKBD ; check for valid Bill/Debtor
"RTN","RCTCSJS",367,0)
 S (CORIDG,CREFBAL)=""
"RTN","RCTCSJS",368,0)
 Q  ;GETPC1
"RTN","RCTCSJS",369,0)
GETPCS2 ;
"RTN","RCTCSJS",370,0)
 Q:CERRS(RTYP)=NULLERR
"RTN","RCTCSJS",371,0)
 S CDEBTID=$E(REC,21,50)
"RTN","RCTCSJS",372,0)
 S SITENUM=$E(CDEBTID,1,3)
"RTN","RCTCSJS",373,0)
 S SAMESITE=$S(SITENUM=SITE:1,1:0)
"RTN","RCTCSJS",374,0)
 I 'SAMESITE D  Q  ;
"RTN","RCTCSJS",375,0)
 . S ZMSG="Wrong RecSite ('"_SITENUM_"' vs. '"_SITE_"') /"_CDEBTID_"/"_CBILL_"/"_RID_RTYP
"RTN","RCTCSJS",376,0)
 . D RECERR(.ERRCNT,"WRONG REC SITE",ZMSG,RECN,.RECERR)
"RTN","RCTCSJS",377,0)
 S CACT=$E(REC,4),CFAST=$E(REC,5,6),CALC=$E(REC,7,14),CSTATN=$E(REC,15,19)
"RTN","RCTCSJS",378,0)
 S CDEBTOR=$E(REC,51,65)
"RTN","RCTCSJS",379,0)
 D CHKBD ; check for valid Bill/Debtor
"RTN","RCTCSJS",380,0)
 S (CORIDG,CREFBAL)=""
"RTN","RCTCSJS",381,0)
 Q  ;GETPC2
"RTN","RCTCSJS",382,0)
CHKBD ; checks for valid Bill/Debtor
"RTN","RCTCSJS",383,0)
 S RECERR=""
"RTN","RCTCSJS",384,0)
 S CBILL=$E(CDEBTID,1,3)_"-"_$E(CDEBTID,4,10),CDEBTIEN=+$E(CDEBTID,11,30)
"RTN","RCTCSJS",385,0)
 I '$D(^PRCA(430,"B",CBILL,CDEBTIEN)) D  ;
"RTN","RCTCSJS",386,0)
 . S ZMSG="Bill IEN: "_CDEBTIEN_"/"_CBILL_"/"_RID_RTYP
"RTN","RCTCSJS",387,0)
 . D RECERR(.ERRCNT,"NO BILL/DEBTOR ",ZMSG,RECN,.RECERR)
"RTN","RCTCSJS",388,0)
 Q
"RTN","RCTCSJS",389,0)
RECERR(ERRCNT,ETYP,ERRDATA,RECN,RECERR) ; log TRANSMITTED FORMAT err
"RTN","RCTCSJS",390,0)
 S (ERRCNT,^XTMP(NMSPC,$J,"ERR",0))=$G(^XTMP(NMSPC,$J,"ERR",0))+1
"RTN","RCTCSJS",391,0)
 S ^XTMP(NMSPC,$J,"ERR",ERRCNT)=RECN_U_ERRDATA
"RTN","RCTCSJS",392,0)
 S RECERR=1
"RTN","RCTCSJS",393,0)
 Q  ;
"RTN","RCTCSJS",394,0)
LOGBULTN ; logs the bulletin records
"RTN","RCTCSJS",395,0)
 S ERRS=$S($E(CERRS,$L(CERRS))=",":$E(CERRS,1,$L(CERRS)-1),1:CERRS)
"RTN","RCTCSJS",396,0)
 S BLTNCNT=$G(BLTNCNT)+1
"RTN","RCTCSJS",397,0)
 S BLTNREC=$E(NAM_BLNKS,1,20)_" "_$E(SSN_BLNKS,1,10)_$E(SBILL_BLNKS,1,12)
"RTN","RCTCSJS",398,0)
 S BLTNREC=BLTNREC_$E(RTYP_BLNKS,1,5)_$E(RACTN_BLNKS,1,5)_$E($P(CERRS,",",1,$L(CERRS,",")-1)_BLNKS,1,26)
"RTN","RCTCSJS",399,0)
 ;
"RTN","RCTCSJS",400,0)
 S ^XTMP(NMSPC,$J,"BULTN",BLTNCNT)=BLTNREC
"RTN","RCTCSJS",401,0)
 S ^XTMP(NMSPC,$J,"SRC",CSRC,NAM,SBILL,BLTNCNT)=""
"RTN","RCTCSJS",402,0)
 Q
"RTN","RCTCSJS",403,0)
RJCDCONV ;Will modify code string to convert code data to linked file pointer
"RTN","RCTCSJS",404,0)
 N COD,CVI
"RTN","RCTCSJS",405,0)
 F CVI=3:1:13 S COD=$P(REC,U,CVI) D:COD'=""
"RTN","RCTCSJS",406,0)
 . I CVI>2,CVI<12 S COD=$O(^RC(348.5,"B",COD,0)),$P(REC,U,CVI)=COD Q
"RTN","RCTCSJS",407,0)
 . I CVI=12 S COD=$O(^RC(348.7,"B",COD,0)),$P(REC,U,CVI)=COD Q
"RTN","RCTCSJS",408,0)
 . I CVI=13 S COD=$O(^RC(348.6,"B",COD,0)),$P(REC,U,CVI)=COD
"RTN","RCTCSJS",409,0)
 . Q
"RTN","RCTCSJS1")
0^27^B57381357
"RTN","RCTCSJS1",1,0)
RCTCSJS1 ;ALBANY/LEG - RCTCS REFERRAL REJECTS SUPPORT RTN;02/19/14 3:21 PM
"RTN","RCTCSJS1",2,0)
V ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSJS1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSJS1",4,0)
 ;Overflow Program for RCTCSJS, to process CS REJECT server messages from AITC
"RTN","RCTCSJS1",5,0)
 ;
"RTN","RCTCSJS1",6,0)
 ;Variables
"RTN","RCTCSJS1",7,0)
 ; Input
"RTN","RCTCSJS1",8,0)
 ; XMZ - (r) MailMan internal message number (IEN)
"RTN","RCTCSJS1",9,0)
 ; 
"RTN","RCTCSJS1",10,0)
 ;;RCTCS REFERRAL REJECTS SUPPORT RTN
"RTN","RCTCSJS1",11,0)
 ;===============================================================================
"RTN","RCTCSJS1",12,0)
 Q  ; 
"RTN","RCTCSJS1",13,0)
PROFRJ(D0) ; displays Reject History on ACCOUNT RECEIVABLE PROFILE
"RTN","RCTCSJS1",14,0)
 ;
"RTN","RCTCSJS1",15,0)
 ; display summary
"RTN","RCTCSJS1",16,0)
 K ARY
"RTN","RCTCSJS1",17,0)
 I '$D(^PRCA(430,D0,18)) Q  ;
"RTN","RCTCSJS1",18,0)
 W !,"CS REJECTS:" S D1=0
"RTN","RCTCSJS1",19,0)
 ; collapses rejects records 
"RTN","RCTCSJS1",20,0)
 F  S D1=$O(^PRCA(430,D0,18,D1)) Q:'D1  D  ;
"RTN","RCTCSJS1",21,0)
 . S RJREC=^PRCA(430,D0,18,D1,0)
"RTN","RCTCSJS1",22,0)
 . S FDAT=$P(RJREC,"^")   ; date
"RTN","RCTCSJS1",23,0)
 . S SRCE=$P(RJREC,"^",2) ;source
"RTN","RCTCSJS1",24,0)
 . S ERRCDS=$S($D(ARY(FDAT,SRCE)):ARY(FDAT,SRCE),1:",")
"RTN","RCTCSJS1",25,0)
 . F PC=3:1:11 S ERRCD=$P(RJREC,"^",PC) Q:'$L(ERRCD)  D  ;
"RTN","RCTCSJS1",26,0)
 . . S ARY(FDAT,SRCE,PC)=$P($G(^RC(348.5,ERRCD,0)),"^"),ERRCD=$P($G(^RC(348.5,ERRCD,0)),U)
"RTN","RCTCSJS1",27,0)
 . . I ERRCDS'[(","_ERRCD_",") S ERRCDS=ERRCDS_ERRCD_","
"RTN","RCTCSJS1",28,0)
 . S ARY(FDAT,SRCE)=ERRCDS
"RTN","RCTCSJS1",29,0)
 . ;
"RTN","RCTCSJS1",30,0)
 S FDAT=""
"RTN","RCTCSJS1",31,0)
 F  S FDAT=$O(ARY(FDAT)),SRCE="" Q:FDAT=""  D  ; 
"RTN","RCTCSJS1",32,0)
 . S Y=FDAT D DD^%DT S EXTDAT=Y ; 
"RTN","RCTCSJS1",33,0)
 . F  S SRCE=$O(ARY(FDAT,SRCE)),CDIDX="" Q:SRCE=""  D  ;
"RTN","RCTCSJS1",34,0)
 . . S ERRCDS=$TR($E(ARY(FDAT,SRCE),2,$L(ARY(FDAT,SRCE))-1),",","-")
"RTN","RCTCSJS1",35,0)
 . . W ?12,"DATE: ",EXTDAT
"RTN","RCTCSJS1",36,0)
 . . W ?33,"CODE(s): ",ERRCDS
"RTN","RCTCSJS1",37,0)
 . . W ?71,"SOURCE: ",SRCE
"RTN","RCTCSJS1",38,0)
 . W !
"RTN","RCTCSJS1",39,0)
 ;
"RTN","RCTCSJS1",40,0)
 ; display detail
"RTN","RCTCSJS1",41,0)
 S FDAT=""
"RTN","RCTCSJS1",42,0)
 F  S FDAT=$O(ARY(FDAT)),SRCE="" Q:FDAT=""  D  ;
"RTN","RCTCSJS1",43,0)
 . S Y=FDAT D DD^%DT S EXTDAT=Y ;
"RTN","RCTCSJS1",44,0)
 . F  S SRCE=$O(ARY(FDAT,SRCE)),CDIDX="" Q:SRCE=""  D  ; 
"RTN","RCTCSJS1",45,0)
 . . W !!,"CS REJECT DATE:",?16,EXTDAT
"RTN","RCTCSJS1",46,0)
 . . W ?34,"REJECT SOURCE: ",SRCE
"RTN","RCTCSJS1",47,0)
 . . F RR=1:1 S CDIDX=$O(ARY(FDAT,SRCE,CDIDX)) Q:CDIDX=""  D  ;
"RTN","RCTCSJS1",48,0)
 . . . W !?2,"REJECT REASON",RR,":"
"RTN","RCTCSJS1",49,0)
 . . . W ?18,ARY(FDAT,SRCE,CDIDX) ; code
"RTN","RCTCSJS1",50,0)
 . . . S (X,DESC)=$P(^RC(348.5,CDIDX,0),"^",2)_"~"_$G(^RC(348.5,CDIDX,1))
"RTN","RCTCSJS1",51,0)
 . . . I $L(DESC)<60 S ARY(FDAT,SRCE,CDIDX,1)=X
"RTN","RCTCSJS1",52,0)
 . . . I $L(DESC)>59 D  ;
"RTN","RCTCSJS1",53,0)
 . . . . F LN=1:1 S STR=$E(X,1,59) D  Q:'$L(X)  ;
"RTN","RCTCSJS1",54,0)
 . . . . . I $L(X)<60 S ARY(FDAT,SRCE,CDIDX,LN)=X,X="" Q
"RTN","RCTCSJS1",55,0)
 . . . . . F L=$L(STR):-1:1 I $F(STR," ",L) S ARY(FDAT,SRCE,CDIDX,LN)=$E(X,1,L),X=$E(X,L+1,999) Q  ;
"RTN","RCTCSJS1",56,0)
 . . . F LN=1:1 Q:'$D(ARY(FDAT,SRCE,CDIDX,LN))  W:LN>1 ! W ?21,ARY(FDAT,SRCE,CDIDX,LN)
"RTN","RCTCSJS1",57,0)
 . W !
"RTN","RCTCSJS1",58,0)
 Q  ;
"RTN","RCTCSJS1",59,0)
 ;
"RTN","RCTCSJS1",60,0)
PROFRJA(D0,LN,OUTARY) ; sets into ^TMP Reject History on BILL PROFILE
"RTN","RCTCSJS1",61,0)
 ;
"RTN","RCTCSJS1",62,0)
 ; display summary
"RTN","RCTCSJS1",63,0)
 S BLANK="",$P(BLANK," ",99)=""
"RTN","RCTCSJS1",64,0)
 K ARY,OUTARY
"RTN","RCTCSJS1",65,0)
 I '$D(^PRCA(430,D0,18)) Q  ;
"RTN","RCTCSJS1",66,0)
 S LN=LN+1,OUTARY(LN,0)="CS REJECTS: " S D1=0
"RTN","RCTCSJS1",67,0)
 ; collapses rejects records 
"RTN","RCTCSJS1",68,0)
 F  S D1=$O(^PRCA(430,D0,18,D1)) Q:'D1  D  ;
"RTN","RCTCSJS1",69,0)
 . S RJREC=^PRCA(430,D0,18,D1,0)
"RTN","RCTCSJS1",70,0)
 . S FDAT=$P(RJREC,"^")   ; date
"RTN","RCTCSJS1",71,0)
 . S SRCE=$P(RJREC,"^",2) ;source
"RTN","RCTCSJS1",72,0)
 . S ERRCDS=$S($D(ARY(FDAT,SRCE)):ARY(FDAT,SRCE),1:",")
"RTN","RCTCSJS1",73,0)
 . F PC=3:1:11 S ERRCD=$P(RJREC,"^",PC) Q:'$L(ERRCD)  D  ;
"RTN","RCTCSJS1",74,0)
 . . S ARY(FDAT,SRCE,PC)=$P(^RC(348.5,ERRCD,0),"^"),ERRCD=$P($G(^RC(348.5,ERRCD,0)),U)
"RTN","RCTCSJS1",75,0)
 . . I ERRCDS'[(","_ERRCD_",") S ERRCDS=ERRCDS_ERRCD_","
"RTN","RCTCSJS1",76,0)
 . S ARY(FDAT,SRCE)=ERRCDS
"RTN","RCTCSJS1",77,0)
 . ;
"RTN","RCTCSJS1",78,0)
 S FDAT=""
"RTN","RCTCSJS1",79,0)
 F  S FDAT=$O(ARY(FDAT)),SRCE="" Q:FDAT=""  D  ; 
"RTN","RCTCSJS1",80,0)
 . S Y=FDAT D DD^%DT S EXTDAT=Y ; 
"RTN","RCTCSJS1",81,0)
 . F  S SRCE=$O(ARY(FDAT,SRCE)),CDIDX="" Q:SRCE=""  D  ;
"RTN","RCTCSJS1",82,0)
 . . S ERRCDS=$TR($E(ARY(FDAT,SRCE),2,$L(ARY(FDAT,SRCE))-1),",","-")
"RTN","RCTCSJS1",83,0)
 . . S OUTARY(LN,0)=$E(OUTARY(LN,0)_BLANK,1,11)_"DATE: "_EXTDAT
"RTN","RCTCSJS1",84,0)
 . . S OUTARY(LN,0)=$E(OUTARY(LN,0)_BLANK,1,32)_"CODE(s): "_ERRCDS
"RTN","RCTCSJS1",85,0)
 . . S OUTARY(LN,0)=$E(OUTARY(LN,0)_BLANK,1,70)_"SOURCE: "_SRCE
"RTN","RCTCSJS1",86,0)
 . S LN=LN+1,OUTARY(LN,0)=""
"RTN","RCTCSJS1",87,0)
 ;
"RTN","RCTCSJS1",88,0)
 ; display detail
"RTN","RCTCSJS1",89,0)
 S FDAT=""
"RTN","RCTCSJS1",90,0)
 F  S FDAT=$O(ARY(FDAT)),SRCE="" Q:FDAT=""  D  ;
"RTN","RCTCSJS1",91,0)
 . S Y=FDAT D DD^%DT S EXTDAT=Y ;
"RTN","RCTCSJS1",92,0)
 . F  S SRCE=$O(ARY(FDAT,SRCE)),CDIDX="" Q:SRCE=""  D  ; 
"RTN","RCTCSJS1",93,0)
 . . S LN=LN+1,(OUTARY(LN,0),OUTARY(LN+1,0))=""
"RTN","RCTCSJS1",94,0)
 . . S LN=LN+1,OUTARY(LN,0)="CS REJECT DATE: "_EXTDAT
"RTN","RCTCSJS1",95,0)
 . . S OUTARY(LN,0)=$E(OUTARY(LN,0)_BLANK,1,34)_"REJECT SOURCE: "_SRCE
"RTN","RCTCSJS1",96,0)
 . . F RR=1:1 S CDIDX=$O(ARY(FDAT,SRCE,CDIDX)) Q:CDIDX=""  D  ;
"RTN","RCTCSJS1",97,0)
 . . . S LN=LN+1,OUTARY(LN,0)="  REJECT REASON"_RR_": "
"RTN","RCTCSJS1",98,0)
 . . . S OUTARY(LN,0)=OUTARY(LN,0)_ARY(FDAT,SRCE,CDIDX)_" " ; code
"RTN","RCTCSJS1",99,0)
 . . . S (X,DESC)=$P(^RC(348.5,CDIDX,0),"^",2)_"~"_$G(^RC(348.5,CDIDX,1))
"RTN","RCTCSJS1",100,0)
 . . . I $L(DESC)<60 S ARY(FDAT,SRCE,CDIDX,1)=X
"RTN","RCTCSJS1",101,0)
 . . . I $L(DESC)>59 D  ;
"RTN","RCTCSJS1",102,0)
 . . . . F LN2=1:1 S STR=$E(X,1,59) D  Q:'$L(X)  ;
"RTN","RCTCSJS1",103,0)
 . . . . . I $L(X)<60 S ARY(FDAT,SRCE,CDIDX,LN2)=X,X="" Q
"RTN","RCTCSJS1",104,0)
 . . . . . F L=$L(STR):-1:1 I $F(STR," ",L) S ARY(FDAT,SRCE,CDIDX,LN2)=$E(X,1,L),X=$E(X,L+1,999) Q  ;
"RTN","RCTCSJS1",105,0)
 . . . F LN2=1:1 Q:'$D(ARY(FDAT,SRCE,CDIDX,LN2))  D  ;
"RTN","RCTCSJS1",106,0)
 . . . . S:LN2>1 LN=LN+1,OUTARY(LN,0)="                     "
"RTN","RCTCSJS1",107,0)
 . . . . S OUTARY(LN,0)=OUTARY(LN,0)_ARY(FDAT,SRCE,CDIDX,LN2)
"RTN","RCTCSJS1",108,0)
 . S LN=LN+1,OUTARY(LN,0)=""
"RTN","RCTCSJS1",109,0)
 Q  ;
"RTN","RCTCSJS1",110,0)
 ;
"RTN","RCTCSJS1",111,0)
SENDBUL ;
"RTN","RCTCSJS1",112,0)
 I '$G(BADQUE) D  ;
"RTN","RCTCSJS1",113,0)
 . S FROM=$G(H4DATE)_$G(ZBAT1),TO=$G(H4DATE)_$G(ZBAT2)
"RTN","RCTCSJS1",114,0)
 . S BATMSG="     from MM Message"_$S(XMZ1=XMZ2:": "_XMZ1,1:"es: "_XMZ1_" to "_XMZ2)
"RTN","RCTCSJS1",115,0)
 . S BATMSG=BATMSG_"     from Batch"_$S(FROM=TO:": "_FROM,1:"es: "_FROM_" to "_TO)
"RTN","RCTCSJS1",116,0)
 ;
"RTN","RCTCSJS1",117,0)
 D NOW^%DTC,YX^%DTC
"RTN","RCTCSJS1",118,0)
 S DTTM=$E(Y,5,6)_" "_$E(Y,1,3)_" "_$E(Y,11,12)_" "_$E(Y,14,18)_" "
"RTN","RCTCSJS1",119,0)
 ;
"RTN","RCTCSJS1",120,0)
 ; If there is no Source data or Errors, check and send Bulletin Data if available
"RTN","RCTCSJS1",121,0)
 I $O(^XTMP("RCTCSJS",$J,"SRC",""))=""&($O(^XTMP("RCTCSJS",$J,"ERR",""))="") D BULERR
"RTN","RCTCSJS1",122,0)
 ;
"RTN","RCTCSJS1",123,0)
 F SOURCE="AITC","DMC","TREASURY" S SRC=$E(SOURCE) I $D(^XTMP("RCTCSJS",$J,"SRC",SRC)) D  ;
"RTN","RCTCSJS1",124,0)
 . D REJMSG
"RTN","RCTCSJS1",125,0)
 . D ALPHA
"RTN","RCTCSJS1",126,0)
 . S XMSUB="CS REJECTS ("_SOURCE_") ["_XMZ_"] "_DTTM_" "_CNTR_" lines"
"RTN","RCTCSJS1",127,0)
 . D SEND
"RTN","RCTCSJS1",128,0)
 . ;
"RTN","RCTCSJS1",129,0)
 Q
"RTN","RCTCSJS1",130,0)
SENDERR ;
"RTN","RCTCSJS1",131,0)
 I $D(^XTMP("RCTCSJS",$J,"ERR")) D  ;
"RTN","RCTCSJS1",132,0)
 . S SOURCES=""
"RTN","RCTCSJS1",133,0)
 . F SRCPC=1:1:3 Q:$E(CSRCS,SRCPC)=""  D
"RTN","RCTCSJS1",134,0)
 . . S SOURCE=$P("???,AITC,DMC,TREASURY",",",$F("ADT",$E(CSRCS,SRCPC)))
"RTN","RCTCSJS1",135,0)
 . . S SOURCES=SOURCES_","_$S(SOURCE="":"???",1:SOURCE)
"RTN","RCTCSJS1",136,0)
 . S SOURCES=$E(SOURCES,2,999)
"RTN","RCTCSJS1",137,0)
 . I '$L(SOURCES) S SOURCES="UNSPECIFIED SOURCE"
"RTN","RCTCSJS1",138,0)
 . D ERRMSG
"RTN","RCTCSJS1",139,0)
 . D ERRSFND
"RTN","RCTCSJS1",140,0)
 . S XMSUB="CS ("_SOURCES_") REJECT RECORD ***ERRORS FOUND***  ["_XMZ_"] "_DTTM_" "_CNTR_" lines"
"RTN","RCTCSJS1",141,0)
 . D SEND
"RTN","RCTCSJS1",142,0)
 . ;
"RTN","RCTCSJS1",143,0)
 Q  ;
"RTN","RCTCSJS1",144,0)
CLEANUP ; This cleans up the ^XTMP global.
"RTN","RCTCSJS1",145,0)
 ;K ^XTMP("RCTCSJS",$J)
"RTN","RCTCSJS1",146,0)
 Q
"RTN","RCTCSJS1",147,0)
 ;
"RTN","RCTCSJS1",148,0)
BULERR ;  If there is Bulletin data, send email with error or note
"RTN","RCTCSJS1",149,0)
 N HIT,CNT,CNTR
"RTN","RCTCSJS1",150,0)
 S HIT=0,CNT=""
"RTN","RCTCSJS1",151,0)
 I $O(^XTMP("RCTCSJS",$J,"BULTN",""))'="" S HIT=1
"RTN","RCTCSJS1",152,0)
 I 'HIT Q
"RTN","RCTCSJS1",153,0)
 S CNTR=$O(^XTMP("RCTCSJS",$J,"REC",$G(CNTR)),-1)
"RTN","RCTCSJS1",154,0)
 S CNTR=CNTR+1
"RTN","RCTCSJS1",155,0)
 S ^XTMP("RCTCSJS",$J,"REC",CNTR)="The following CS REJECTS transmissions have been processed"
"RTN","RCTCSJS1",156,0)
 S CNTR=CNTR+1
"RTN","RCTCSJS1",157,0)
 S ^XTMP("RCTCSJS",$J,"REC",CNTR)=BATMSG
"RTN","RCTCSJS1",158,0)
 F  S CNT=$O(^XTMP("RCTCSJS",$J,"BULTN",CNT)) Q:CNT=""  S BULDAT=^(CNT) D
"RTN","RCTCSJS1",159,0)
 . S CNTR=CNTR+1
"RTN","RCTCSJS1",160,0)
 . S ^XTMP("RCTCSJS",$J,"REC",CNTR)=BULDAT
"RTN","RCTCSJS1",161,0)
 S XMSUB="CS REJECTS ["_XMZ_"] "_DTTM_" "_CNTR_" lines"
"RTN","RCTCSJS1",162,0)
 D SEND
"RTN","RCTCSJS1",163,0)
 Q  ; BULERR
"RTN","RCTCSJS1",164,0)
 ;
"RTN","RCTCSJS1",165,0)
REJMSG ;Send list of rejected documents
"RTN","RCTCSJS1",166,0)
 S ^XTMP("RCTCSJS",$J,"REC",1)="The following CS DEBT REFERRAL transmissions have been rejected"
"RTN","RCTCSJS1",167,0)
 S ^XTMP("RCTCSJS",$J,"REC",2)=BATMSG
"RTN","RCTCSJS1",168,0)
 S ^XTMP("RCTCSJS",$J,"REC",3)=""
"RTN","RCTCSJS1",169,0)
 S ^XTMP("RCTCSJS",$J,"REC",4)="NAME                 SSN       BILL NUMBER TYPE ACTN ERROR CODES"
"RTN","RCTCSJS1",170,0)
 S ^XTMP("RCTCSJS",$J,"REC",5)=""
"RTN","RCTCSJS1",171,0)
 S CNTR=5
"RTN","RCTCSJS1",172,0)
 Q  ; REJMSG
"RTN","RCTCSJS1",173,0)
ALPHA ; orders BULLETIN by SRC, Patient NAME, BILL NO. sequence
"RTN","RCTCSJS1",174,0)
 S NAM=""
"RTN","RCTCSJS1",175,0)
 F  S NAM=$O(^XTMP("RCTCSJS",$J,"SRC",SRC,NAM)),SBILL="" Q:NAM=""  D  ;
"RTN","RCTCSJS1",176,0)
 . F  S SBILL=$O(^XTMP("RCTCSJS",$J,"SRC",SRC,NAM,SBILL)),BLTNCNT="" Q:SBILL=""  D  ;
"RTN","RCTCSJS1",177,0)
 .. F  S BLTNCNT=$O(^XTMP("RCTCSJS",$J,"SRC",SRC,NAM,SBILL,BLTNCNT)) Q:BLTNCNT=""  D  ;
"RTN","RCTCSJS1",178,0)
 ... S BLTNREC=^XTMP("RCTCSJS",$J,"BULTN",BLTNCNT)
"RTN","RCTCSJS1",179,0)
 ... S CNTR=CNTR+1,^XTMP("RCTCSJS",$J,"REC",CNTR)=BLTNREC
"RTN","RCTCSJS1",180,0)
 Q  ;
"RTN","RCTCSJS1",181,0)
 ;
"RTN","RCTCSJS1",182,0)
ERRMSG ;Send list of ERRORS FOUND document
"RTN","RCTCSJS1",183,0)
 S ^XTMP("RCTCSJS",$J,"REC",1)="The following **ERRORS** found in the ("_SOURCES_") CS DEBT REFERRAL Reject File"
"RTN","RCTCSJS1",184,0)
 S ^XTMP("RCTCSJS",$J,"REC",2)=BATMSG
"RTN","RCTCSJS1",185,0)
 S ^XTMP("RCTCSJS",$J,"REC",3)=""
"RTN","RCTCSJS1",186,0)
 S ^XTMP("RCTCSJS",$J,"REC",4)="  #  REC#    TYPE OF ERROR ENCOUNTERED                                       "
"RTN","RCTCSJS1",187,0)
 S ^XTMP("RCTCSJS",$J,"REC",5)=""
"RTN","RCTCSJS1",188,0)
 S CNTR=5
"RTN","RCTCSJS1",189,0)
 Q  ; ERRMSG
"RTN","RCTCSJS1",190,0)
 ;
"RTN","RCTCSJS1",191,0)
ERRSFND ; places ERRORS FOUND records into BULLETIN sequence
"RTN","RCTCSJS1",192,0)
 ;      S ^XTMP("RCTCSJS",$J,"ERR",ERRCNT)=RECN_U_ERRDATA
"RTN","RCTCSJS1",193,0)
 S ERRCNT=0
"RTN","RCTCSJS1",194,0)
 F  S ERRCNT=$O(^XTMP("RCTCSJS",$J,"ERR",ERRCNT)) Q:'ERRCNT  D  ;
"RTN","RCTCSJS1",195,0)
 . S REC=^XTMP("RCTCSJS",$J,"ERR",ERRCNT)
"RTN","RCTCSJS1",196,0)
 . S RECN=$P(REC,U),ERRDATA=$P(REC,U,2)
"RTN","RCTCSJS1",197,0)
 . S ERRREC=$E($J(ERRCNT,4)_BLNKS,1,5)_$E(RECN_BLNKS,1,8)_$E(ERRDATA_BLNKS,1,66)
"RTN","RCTCSJS1",198,0)
 . S CNTR=CNTR+1
"RTN","RCTCSJS1",199,0)
 . S ^XTMP("RCTCSJS",$J,"REC",CNTR)=ERRREC
"RTN","RCTCSJS1",200,0)
 Q  ; ERRSFND
"RTN","RCTCSJS1",201,0)
 ;
"RTN","RCTCSJS1",202,0)
SEND ;
"RTN","RCTCSJS1",203,0)
 S XMY("G.TCSP")="",XMDUZ="AR PACKAGE",XMTEXT="^XTMP(""RCTCSJS"","_$J_",""REC"","
"RTN","RCTCSJS1",204,0)
 D ^XMD
"RTN","RCTCSJS1",205,0)
 Q
"RTN","RCTCSP1")
0^11^B168147966
"RTN","RCTCSP1",1,0)
RCTCSP1 ;ALBANY/BDB-CROSS-SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSP1",2,0)
 ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSP1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP1",4,0)
 ;
"RTN","RCTCSP1",5,0)
 Q
"RTN","RCTCSP1",6,0)
 ;
"RTN","RCTCSP1",7,0)
BILLREP ;cross-servicing bill report, prints individual bills that make up a cross-servicing account
"RTN","RCTCSP1",8,0)
 N DIC,DEBTOR,ZTSAVE,ZTDESC,ZTRTN,POP
"RTN","RCTCSP1",9,0)
 S DIC=340,DIC(0)="AEQM",DIC("S")="I $D(^RCD(340,""TCSP"",+Y))" D ^DIC
"RTN","RCTCSP1",10,0)
 Q:Y<1  S DEBTOR=+Y
"RTN","RCTCSP1",11,0)
 K IOP,IO("Q") S %ZIS="MQ",%ZIS("B")="" D ^%ZIS G:POP BILLREPQ S IOP=ION_";"_IOM_";"_IOSL
"RTN","RCTCSP1",12,0)
 I $D(IO("Q")) D  G BILLREPQ
"RTN","RCTCSP1",13,0)
    .S ZTSAVE("DEBTOR")=""
"RTN","RCTCSP1",14,0)
    .S ZTRTN="BILLREPP^RCTCSP1",ZTDESC="CROSS-SERVICING BILL REPORT"
"RTN","RCTCSP1",15,0)
    .D ^%ZTLOAD,HOME^%ZIS
"RTN","RCTCSP1",16,0)
    .Q
"RTN","RCTCSP1",17,0)
 ;
"RTN","RCTCSP1",18,0)
BILLREPP ;Call to build array of bills referred
"RTN","RCTCSP1",19,0)
 U IO
"RTN","RCTCSP1",20,0)
 N BILL,B7,B14,B15,B16,D4,FND,BAMT,TAMT,DIRUT,TNM,TID,TDT,DASH,CSTAT,PAGE,DASH,TMP,I
"RTN","RCTCSP1",21,0)
 S DASH="",$P(DASH,"-",81)=""
"RTN","RCTCSP1",22,0)
 S (BAMT,TAMT,BILL,PAGE)=0 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:('BILL)!($D(DIRUT))  D
"RTN","RCTCSP1",23,0)
 .Q:'+$G(^PRCA(430,BILL,15))
"RTN","RCTCSP1",24,0)
 .S B7=$G(^PRCA(430,BILL,7))
"RTN","RCTCSP1",25,0)
 .S BAMT=0 F I=1:1:5 S BAMT=BAMT+$P(B7,U,I)
"RTN","RCTCSP1",26,0)
 .S TAMT=TAMT+BAMT
"RTN","RCTCSP1",27,0)
 D BILLREPH
"RTN","RCTCSP1",28,0)
 S (FND,BILL)=0 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:('BILL)!($D(DIRUT))  D
"RTN","RCTCSP1",29,0)
    .Q:'+$G(^PRCA(430,BILL,15))
"RTN","RCTCSP1",30,0)
    .S FND=1 W !,$P(^PRCA(430,BILL,0),U) S CSTAT=$P(^(0),U,8),B7=$G(^(7)),B15=$G(^(15)),B16=$G(^(16))
"RTN","RCTCSP1",31,0)
    .W ?13,$P(^PRCA(430.3,CSTAT,0),U,2)
"RTN","RCTCSP1",32,0)
    .W ?17,$J($P(B16,U,9),8,2)
"RTN","RCTCSP1",33,0)
    .S BAMT=0 F I=1:1:5 S BAMT=BAMT+$P(B7,U,I)
"RTN","RCTCSP1",34,0)
    .W ?27,$J(BAMT,8,2)
"RTN","RCTCSP1",35,0)
    .W $J($P(B7,U,1),10,2)
"RTN","RCTCSP1",36,0)
    .W $J($P(B7,U,2),7,2)
"RTN","RCTCSP1",37,0)
    .W $J($P(B7,U,3),7,2)
"RTN","RCTCSP1",38,0)
    .W $J($P(B7,U,4),8,2)
"RTN","RCTCSP1",39,0)
    .S TMP=$$UPPER^VALM1($$FMTE^XLFDT($P(B15,U,1)))
"RTN","RCTCSP1",40,0)
    .W ?69,$P(TMP,", ",1)_","_$P(TMP,", ",2)
"RTN","RCTCSP1",41,0)
    .;check for end of page here, if necessary form feed and print header
"RTN","RCTCSP1",42,0)
    .I ($Y+3)>IOSL D
"RTN","RCTCSP1",43,0)
    ..I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR Q:$D(DIRUT)
"RTN","RCTCSP1",44,0)
    ..D BILLREPH
"RTN","RCTCSP1",45,0)
 I $E(IOST,1,2)="C-" R !!,"END OF REPORT...PRESS RETURN TO CONTINUE",X:DTIME W @IOF
"RTN","RCTCSP1",46,0)
 D:'$D(ZTQUEUED) ^%ZISC
"RTN","RCTCSP1",47,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RCTCSP1",48,0)
 K IOP,%ZIS,ZTQUEUED
"RTN","RCTCSP1",49,0)
BILLREPQ Q
"RTN","RCTCSP1",50,0)
 ;
"RTN","RCTCSP1",51,0)
BILLREPH ;header for cross-servicing bill report
"RTN","RCTCSP1",52,0)
 W @IOF
"RTN","RCTCSP1",53,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",54,0)
 W "PAGE "_PAGE,?24,"CROSS-SERVICING BILL REPORT",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",55,0)
 W !,DASH
"RTN","RCTCSP1",56,0)
 N RCHDR
"RTN","RCTCSP1",57,0)
 S RCHDR=$$ACCNTHDR^RCDPAPLM(DEBTOR)
"RTN","RCTCSP1",58,0)
 W !!,"DEBTOR: ",$E($P(RCHDR,U,1),1,18),?32,"SSN: ",$E($P(RCHDR,U,2),2,$L($P(RCHDR,U,2))-1),?55,"CURRENT CS DEBT: ",$J(TAMT,8,2)
"RTN","RCTCSP1",59,0)
 W !,DASH
"RTN","RCTCSP1",60,0)
 W !,"BILL NO.",?13,"ST",?17,"ORIG AMT",?27,"CURR AMT",?41,"PRIN",?49,"INT",?54,"ADMIN",?62,"COURT",?69,"CS REF DATE"
"RTN","RCTCSP1",61,0)
 W !,"---- ---",?13,"--",?17,"---- ---",?27,"---- ---",?41,"----",?49,"---",?54,"-----",?62,"-----",?69,"-- --- ----"
"RTN","RCTCSP1",62,0)
 Q
"RTN","RCTCSP1",63,0)
 ;
"RTN","RCTCSP1",64,0)
CSRPRT ;print cross-servicing report, prints sorted individual bills that make up a cross-servicing account
"RTN","RCTCSP1",65,0)
 N DIC,RCSORT,PAGE,DASH,DTOUT,DUOUT,DIROUT,BY,FROM,TO,FLDS,L
"RTN","RCTCSP1",66,0)
 S PAGE=0,DASH="",$P(DASH,"-",81)=""
"RTN","RCTCSP1",67,0)
 W !
"RTN","RCTCSP1",68,0)
 S DIR(0)="S^1:Bill Number;2:Debtor Name;3:CS Referred Date",DIR("A")="Sort by" D ^DIR K DIR
"RTN","RCTCSP1",69,0)
 S RCSORT=Y Q:($D(DTOUT)!$D(DUOUT)!$D(DIROUT))
"RTN","RCTCSP1",70,0)
 I RCSORT=1 D
"RTN","RCTCSP1",71,0)
 .S DIC="^PRCA(430,",L=0,L(0)=1,BY(0)="^PRCA(430,""TCSP"","
"RTN","RCTCSP1",72,0)
 .S FLDS=".01;L12,9;L18,161;R10,169;R9,151;R12,11;R9",DHD="W ?0 D CSRPRTH1^RCTCSP1"
"RTN","RCTCSP1",73,0)
 .D EN1^DIP
"RTN","RCTCSP1",74,0)
 .Q
"RTN","RCTCSP1",75,0)
 ;
"RTN","RCTCSP1",76,0)
 I RCSORT=2 D
"RTN","RCTCSP1",77,0)
 .S DIC="^PRCA(430,",L=0,L(0)=1,BY(0)="^PRCA(430,""TCSP"",",BY=9,(FR,TO)=""
"RTN","RCTCSP1",78,0)
 .S FLDS="9;L18,.01;R12,161;R10,169;R9,151;R12,11;R9",DHD="W ?0 D CSRPRTH2^RCTCSP1"
"RTN","RCTCSP1",79,0)
 .D EN1^DIP
"RTN","RCTCSP1",80,0)
 .Q
"RTN","RCTCSP1",81,0)
 ;
"RTN","RCTCSP1",82,0)
 I RCSORT=3 D
"RTN","RCTCSP1",83,0)
 .S DIC="^PRCA(430,",L=0,L(0)=1,BY(0)="^PRCA(430,""TCSP"",",BY=151,(FR,TO)=""
"RTN","RCTCSP1",84,0)
 .S FLDS="151;L12,9;L18,.01;R12,161;R10,169;R9,11;R9",DHD="W ?0 D CSRPRTH3^RCTCSP1"
"RTN","RCTCSP1",85,0)
 .D EN1^DIP
"RTN","RCTCSP1",86,0)
 .Q
"RTN","RCTCSP1",87,0)
 Q
"RTN","RCTCSP1",88,0)
 ;
"RTN","RCTCSP1",89,0)
CSRPRTH1 ;header for cross-servicing print report 1
"RTN","RCTCSP1",90,0)
 W @IOF
"RTN","RCTCSP1",91,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",92,0)
 W !,"PAGE "_PAGE,?16,"BILLS AT CROSS-SERVICING (SORTED BY BILL NO.)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",93,0)
 W !,DASH,!
"RTN","RCTCSP1",94,0)
 W !,"BILL NO.",?14,"DEBTOR",?35,"SSN",?47,"ORIG AMT",?58,"CS REF DATE",?71," CURR AMT"
"RTN","RCTCSP1",95,0)
 W !,"---- ---",?14,"------",?35,"---",?47,"---- ---",?58,"-- --- ----",?71," ---- ---",!
"RTN","RCTCSP1",96,0)
 Q
"RTN","RCTCSP1",97,0)
 ;
"RTN","RCTCSP1",98,0)
CSRPRTH2 ;header for cross-servicing print report 2
"RTN","RCTCSP1",99,0)
 W @IOF
"RTN","RCTCSP1",100,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",101,0)
 W !,"PAGE "_PAGE,?16,"BILLS AT CROSS-SERVICING (SORTED BY DEBTOR)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",102,0)
 W !,DASH,!
"RTN","RCTCSP1",103,0)
 W !,"DEBTOR",?21,"BILL NO.",?35,"SSN",?47,"ORIG AMT",?58,"CS REF DATE",?71," CURR AMT"
"RTN","RCTCSP1",104,0)
 W !,"------",?21,"---- ---",?35,"---",?47,"---- ---",?58,"-- --- ----",?71," ---- ---",!
"RTN","RCTCSP1",105,0)
 Q
"RTN","RCTCSP1",106,0)
 ;
"RTN","RCTCSP1",107,0)
CSRPRTH3 ;header for cross-servicing print report 3
"RTN","RCTCSP1",108,0)
 W @IOF
"RTN","RCTCSP1",109,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",110,0)
 W !,"PAGE "_PAGE,?11,"BILLS AT CROSS-SERVICING (SORTED BY CS REFERRED DATE)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",111,0)
 W !,DASH,!
"RTN","RCTCSP1",112,0)
 W !,"CS REF DATE",?14,"DEBTOR",?35,"BILL NO.",?49,"SSN",?61,"ORIG AMT",?71," CURR AMT"
"RTN","RCTCSP1",113,0)
 W !,"-- --- ----",?14,"------",?35,"---- ---",?49,"---",?61,"---- ---",?71," ---- ---",!
"RTN","RCTCSP1",114,0)
 Q
"RTN","RCTCSP1",115,0)
 ;
"RTN","RCTCSP1",116,0)
CSRCLRT ;cross-servicing recall report, prints sorted individual bills that make up a cross-servicing account
"RTN","RCTCSP1",117,0)
 N DIC,RCSORT,PAGE,DASH,DTOUT,DUOUT,DIROUT,DHD,FLDS,L,BY,FR,TO,DIS
"RTN","RCTCSP1",118,0)
 S PAGE=0,DASH="",$P(DASH,"-",81)=""
"RTN","RCTCSP1",119,0)
 W !
"RTN","RCTCSP1",120,0)
 S DIR(0)="S^1:Bill Number;2:Debtor Name",DIR("A")="Sort by" D ^DIR K DIR
"RTN","RCTCSP1",121,0)
 S RCSORT=Y Q:($D(DTOUT)!$D(DUOUT)!$D(DIROUT))
"RTN","RCTCSP1",122,0)
 I RCSORT=1 D
"RTN","RCTCSP1",123,0)
 .S DIC="^PRCA(430,",DIS(0)="I ($P($G(^PRCA(430,D0,15)),U,2)>0)!((+$P($G(^RCD(340,+$P(^PRCA(430,D0,0),U,9),7)),U,2))&$D(^PRCA(430,""TCSP"",D0)))",L=0,BY=.01,(FR,TO)=""
"RTN","RCTCSP1",124,0)
 .S FLDS="[PRCA TCSP RECALLB]",DHD="W ?0 D CSRCLH1^RCTCSP1"
"RTN","RCTCSP1",125,0)
 .D EN1^DIP
"RTN","RCTCSP1",126,0)
 .Q
"RTN","RCTCSP1",127,0)
 ;
"RTN","RCTCSP1",128,0)
 I RCSORT=2 D
"RTN","RCTCSP1",129,0)
 .S DIC="^PRCA(430,",DIS(0)="I ($P($G(^PRCA(430,D0,15)),U,2)>0)!((+$P($G(^RCD(340,+$P(^PRCA(430,D0,0),U,9),7)),U,2))&$D(^PRCA(430,""TCSP"",D0)))",L=0,BY=9,(FR,TO)=""
"RTN","RCTCSP1",130,0)
 .S FLDS="[PRCA TCSP RECALLD]",DHD="W ?0 D CSRCLH2^RCTCSP1"
"RTN","RCTCSP1",131,0)
 .D EN1^DIP
"RTN","RCTCSP1",132,0)
 .Q
"RTN","RCTCSP1",133,0)
 Q
"RTN","RCTCSP1",134,0)
 ;
"RTN","RCTCSP1",135,0)
CSRCLH1 ;header for cross-servicing recall report 1
"RTN","RCTCSP1",136,0)
 W @IOF
"RTN","RCTCSP1",137,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",138,0)
 W !,"PAGE "_PAGE,?12,"CROSS-SERVICING RECALL REPORT (SORTED BY BILL NUMBER)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",139,0)
 W !,DASH,!
"RTN","RCTCSP1",140,0)
 W !,"BILL NO.",?13,"DEBTOR",?33,"SSN",?44,"RCLL AMT",?54,"RECALL DATE",?67,"RECALL RSN"
"RTN","RCTCSP1",141,0)
 W !,"---- ---",?13,"------",?33,"---",?44,"---- ---",?54,"------ ----",?67,"------ ---",!
"RTN","RCTCSP1",142,0)
 Q
"RTN","RCTCSP1",143,0)
 ;
"RTN","RCTCSP1",144,0)
CSRCLH2 ;header for cross-servicing recall report 2
"RTN","RCTCSP1",145,0)
 W @IOF
"RTN","RCTCSP1",146,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",147,0)
 W !,"PAGE "_PAGE,?14,"CROSS-SERVICING RECALL REPORT (SORTED BY DEBTOR)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",148,0)
 W !,DASH,!
"RTN","RCTCSP1",149,0)
 W !,"DEBTOR",?20,"BILL NO.",?33,"SSN",?44,"RCLL AMT",?54,"RECALL DATE",?67,"RECALL RSN"
"RTN","RCTCSP1",150,0)
 W !,"------",?20,"--------",?33,"---",?44,"---- ---",?54,"------ ----",?67,"------ ---",!
"RTN","RCTCSP1",151,0)
 Q
"RTN","RCTCSP1",152,0)
 ;
"RTN","RCTCSP1",153,0)
HEADER ;
"RTN","RCTCSP1",154,0)
 ;increment batch sequence number, build new header
"RTN","RCTCSP1",155,0)
 N RCMSG
"RTN","RCTCSP1",156,0)
 S SEQ=SEQ+1
"RTN","RCTCSP1",157,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP1",158,0)
 K ^XTMP("RCTCSPD",$J,ACTION,"BUILD",SEQ)
"RTN","RCTCSP1",159,0)
 ;header is record type H
"RTN","RCTCSP1",160,0)
 S RCMSG="H"_CNTLID_$$BLANK(14)_"3636001200"
"RTN","RCTCSP1",161,0)
 S RCMSG=RCMSG_$$BLANK(450-$L(RCMSG))
"RTN","RCTCSP1",162,0)
 S REC=REC+1
"RTN","RCTCSP1",163,0)
 S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(RCMSG,1,225)_$C(94)
"RTN","RCTCSP1",164,0)
 S REC=REC+1
"RTN","RCTCSP1",165,0)
 S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(RCMSG,226,999)_$C(126)
"RTN","RCTCSP1",166,0)
 Q
"RTN","RCTCSP1",167,0)
 ;
"RTN","RCTCSP1",168,0)
TRAILER ;
"RTN","RCTCSP1",169,0)
 ;trailer is type Z record
"RTN","RCTCSP1",170,0)
 I REC=0 K ^XTMP("RCTCSPD",$J,SEQ,"BUILD") Q  ;delete batch if no records processed
"RTN","RCTCSP1",171,0)
 N RCMSG
"RTN","RCTCSP1",172,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP1",173,0)
 S RCMSG="Z"_$$RJZF(RECC,8)_$$AMOUNT(AMOUNT/100)_CNTLID_$$BLANK(14)_"3636001200"
"RTN","RCTCSP1",174,0)
 S RCMSG=RCMSG_$$BLANK(450-$L(RCMSG))
"RTN","RCTCSP1",175,0)
 S REC=REC+1
"RTN","RCTCSP1",176,0)
 S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(RCMSG,1,225)_$C(94)
"RTN","RCTCSP1",177,0)
 S REC=REC+1
"RTN","RCTCSP1",178,0)
 S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(RCMSG,226,999)_$C(126)
"RTN","RCTCSP1",179,0)
 S REC=0,RECC=0,AMOUNT=0
"RTN","RCTCSP1",180,0)
 Q
"RTN","RCTCSP1",181,0)
 ;
"RTN","RCTCSP1",182,0)
REC5B ;
"RTN","RCTCSP1",183,0)
 ;  trnnum     transaction number file #433 pass in
"RTN","RCTCSP1",184,0)
 ;  trntyp     transaction type pointer to 430.3
"RTN","RCTCSP1",185,0)
 ;  trntypa    aia transaction type  (aio: dmc agency internal offset, abal: decrease adjustment) 
"RTN","RCTCSP1",186,0)
 N REC,KNUM,DEBTNR,DEBTORNB,TAMOUNT,TAMTPBAL,TAMTIBAL,TAMTABAL,TAMTFBAL,TAMTCBAL,AMTRFRRD,TRNTYP,TRNTYPA,TRANSNB
"RTN","RCTCSP1",187,0)
 N AMTPBAL,AMTIBAL,AMTABAL,AMTFBAL,AMTCBAL,TRN3,TRNNUME
"RTN","RCTCSP1",188,0)
 S TRNTYPA="AIO"
"RTN","RCTCSP1",189,0)
 S REC="C5B"_ACTION_"3636001200"_"DM1D "_"L"
"RTN","RCTCSP1",190,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSP1",191,0)
 S DEBTNR=$E(SITE,1,3)_$$RJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSP1",192,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSP1",193,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSP1",194,0)
 S TRNTYP=$P($G(^PRCA(433,TRNNUM,1)),U,2) I TRNTYP=35 S TRNTYPA="ABAL"
"RTN","RCTCSP1",195,0)
 S REC=REC_$$LJSF(TRNTYPA,9)
"RTN","RCTCSP1",196,0)
 S TRNNUME=$$RJZF(TRNNUM,10)
"RTN","RCTCSP1",197,0)
 S TRNNUME=$E(TRNNUME,5,10) ;max is 999999
"RTN","RCTCSP1",198,0)
 I TRNNUME="000000" S TRNNUME="000001" ;min is 1
"RTN","RCTCSP1",199,0)
 S REC=REC_$$RJZF(TRNNUME,10)
"RTN","RCTCSP1",200,0)
 S REC=REC_$$DATE8(DT)
"RTN","RCTCSP1",201,0)
 S TRANSNB=$E(SITE,1,3)_$TR($J(TRNNUM,12)," ",0)
"RTN","RCTCSP1",202,0)
 S REC=REC_TRANSNB
"RTN","RCTCSP1",203,0)
 S REC=REC_$$BLANK(9)
"RTN","RCTCSP1",204,0)
 S TRN3=$G(^PRCA(433,TRNNUM,3))
"RTN","RCTCSP1",205,0)
 S TAMTPBAL=$P(TRN3,U,1) ;transaction principle balance
"RTN","RCTCSP1",206,0)
 S TAMTIBAL=$P(TRN3,U,2) ;transaction interest balance
"RTN","RCTCSP1",207,0)
 S TAMTABAL=$P(TRN3,U,3) ;transaction administrative balance
"RTN","RCTCSP1",208,0)
 S TAMTFBAL=$P(TRN3,U,4) ;transaction marshal fee
"RTN","RCTCSP1",209,0)
 S TAMTCBAL=$P(TRN3,U,5) ;transaction court cost
"RTN","RCTCSP1",210,0)
 I (TAMTPBAL+TAMTIBAL+TAMTABAL+TAMTFBAL+TAMTCBAL)=0 S TAMTPBAL=TRNAMT
"RTN","RCTCSP1",211,0)
 S TAMOUNT=$S(+TAMTPBAL:"-",1:"0")_$E($$AMOUNT(TAMTPBAL),2,14)
"RTN","RCTCSP1",212,0)
 S TAMOUNT=TAMOUNT_$S(+TAMTIBAL:"-",1:"0")_$E($$AMOUNT(TAMTIBAL),2,14)
"RTN","RCTCSP1",213,0)
 S TAMOUNT=TAMOUNT_$S(+TAMTABAL:"-",1:"0")_$E($$AMOUNT(TAMTABAL),2,14)
"RTN","RCTCSP1",214,0)
 S TAMOUNT=TAMOUNT_$S(+(TAMTFBAL+TAMTCBAL):"-",1:"0")_$E($$AMOUNT(TAMTFBAL+TAMTCBAL),2,14)
"RTN","RCTCSP1",215,0)
 S REC=REC_TAMOUNT
"RTN","RCTCSP1",216,0)
 S REC=REC_"-"_$E($$AMOUNT(TRNAMT),2,14)
"RTN","RCTCSP1",217,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSP1",218,0)
 S AMTPBAL=$P(B7,U,1) ;principle balance
"RTN","RCTCSP1",219,0)
 S AMTIBAL=$P(B7,U,2) ;interest balance
"RTN","RCTCSP1",220,0)
 S AMTABAL=$P(B7,U,3) ;administrative balance
"RTN","RCTCSP1",221,0)
 S AMTFBAL=$P(B7,U,4) ;marshal fee
"RTN","RCTCSP1",222,0)
 S AMTCBAL=$P(B7,U,5) ;court cost
"RTN","RCTCSP1",223,0)
 S AMTRFRRD=AMTPBAL+AMTIBAL+AMTABAL+AMTFBAL+AMTCBAL
"RTN","RCTCSP1",224,0)
 I ACTION="U" S $P(^PRCA(430,BILL,16),U,10)=AMTRFRRD
"RTN","RCTCSP1",225,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,"5B",TRNNUM)=REC
"RTN","RCTCSP1",226,0)
 S ^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL)=$$TAXID(DEBTOR)_"^-"_+$E(REC,174,184)_"."_$E(REC,185,186)
"RTN","RCTCSP1",227,0)
 Q
"RTN","RCTCSP1",228,0)
 ;
"RTN","RCTCSP1",229,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSP1",230,0)
 I +X S X=X+17000000
"RTN","RCTCSP1",231,0)
 S X=$E(X,1,8)
"RTN","RCTCSP1",232,0)
 Q X
"RTN","RCTCSP1",233,0)
 ;
"RTN","RCTCSP1",234,0)
AMOUNT(X) ;changes amount to zero filled, right justified
"RTN","RCTCSP1",235,0)
 S:X<0 X=-X
"RTN","RCTCSP1",236,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP1",237,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSP1",238,0)
 Q X
"RTN","RCTCSP1",239,0)
 ;
"RTN","RCTCSP1",240,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP1",241,0)
 N BLANK
"RTN","RCTCSP1",242,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP1",243,0)
 Q BLANK
"RTN","RCTCSP1",244,0)
 ;
"RTN","RCTCSP1",245,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSP1",246,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSP1",247,0)
 Q X
"RTN","RCTCSP1",248,0)
 ;
"RTN","RCTCSP1",249,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSP1",250,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP1",251,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP1",252,0)
 Q X
"RTN","RCTCSP1",253,0)
 ;
"RTN","RCTCSP1",254,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP1",255,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP1",256,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP1",257,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP1",258,0)
 Q TAXID
"RTN","RCTCSP1",259,0)
 ;
"RTN","RCTCSP1",260,0)
JD() ; returns today's Julian date YDOY
"RTN","RCTCSP1",261,0)
 N XMDDD,XMNOW,XMDT
"RTN","RCTCSP1",262,0)
 S XMNOW=$$NOW^XLFDT
"RTN","RCTCSP1",263,0)
 S XMDT=$E(XMNOW,1,7)
"RTN","RCTCSP1",264,0)
 S XMDDD=$$RJ^XLFSTR($$FMDIFF^XLFDT(XMDT,$E(XMDT,1,3)_"0101",1)+1,3,"0")
"RTN","RCTCSP1",265,0)
 Q $E(DT,3)_XMDDD
"RTN","RCTCSP1",266,0)
 ;
"RTN","RCTCSP1",267,0)
ADDR(RCDFN) ; returns patient file address
"RTN","RCTCSP1",268,0)
 N DFN,ADDRCS,STATEIEN,STATEAB,VAPA
"RTN","RCTCSP1",269,0)
 S DFN=RCDFN
"RTN","RCTCSP1",270,0)
 D ADD^VADPT
"RTN","RCTCSP1",271,0)
 S STATEIEN=+VAPA(5),STATEAB=$$GET1^DIQ(5,STATEIEN,1)
"RTN","RCTCSP1",272,0)
 S ADDRCS=VAPA(1)_U_VAPA(2)_U_VAPA(4)_U_STATEAB_U_VAPA(6)_U_VAPA(8)_U_+VAPA(25)
"RTN","RCTCSP1",273,0)
 I $L(DEBTOR1)>0 I $P(DEBTOR1,U,1,5)'?1"^"."^" D
"RTN","RCTCSP1",274,0)
 .N ADDR340
"RTN","RCTCSP1",275,0)
 .S ADDR340=$P($$DADD^RCAMADD(DEBTOR),U,1,7)_"^"_1
"RTN","RCTCSP1",276,0)
 .S ADDR340=$P(ADDR340,U,1,2)_"^"_$P(ADDR340,U,4,99)
"RTN","RCTCSP1",277,0)
 .I $P(ADDR340,U,6)="" S $P(ADDR340,U,6)=$P(ADDRCS,U,6)
"RTN","RCTCSP1",278,0)
 .S ADDRCS=ADDR340
"RTN","RCTCSP1",279,0)
 Q ADDRCS
"RTN","RCTCSP1",280,0)
 ;
"RTN","RCTCSP1",281,0)
DEM(RCDFN) ; returns patient file gender and dob
"RTN","RCTCSP1",282,0)
 N DFN,VADM
"RTN","RCTCSP1",283,0)
 S DFN=RCDFN
"RTN","RCTCSP1",284,0)
 D DEM^VADPT
"RTN","RCTCSP1",285,0)
 ; return string   sex:m/f ^ dob: yyyymmdd ^ ssn ^ deceased
"RTN","RCTCSP1",286,0)
 Q $P(VADM(5),U,1)_U_$P(VADM(3),U,1)_U_$P(VADM(2),U,1)_U_VADM(6)
"RTN","RCTCSP1",287,0)
 ; 
"RTN","RCTCSP1",288,0)
COUNTRY(Z) ;
"RTN","RCTCSP1",289,0)
 N PRCACC
"RTN","RCTCSP1",290,0)
 ;get treasury country code
"RTN","RCTCSP1",291,0)
 I Z=1 S PRCACC="US" G COUNTRYQ
"RTN","RCTCSP1",292,0)
 I Z="" S PRCACC="US" G COUNTRYQ
"RTN","RCTCSP1",293,0)
 S PRCACC=$S(Z=4:"AF",Z=5:"AL",Z=7:"DZ",Z=8:"AD",Z=9:"AO",Z=180:"AI",Z=10:"AG",Z=12:"AR",Z=18:"AM",Z=151:"AW",Z=13:"AU",Z=14:"AT",Z=11:"AZ",Z=15:"BS",Z=16:"BH",Z=17:"BD",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",294,0)
 S PRCACC=$S(Z=19:"BB",Z=36:"BY",Z=20:"BE",Z=28:"BZ",Z=61:"BJ",Z=21:"BM",Z=22:"BT",Z=23:"BO",Z=24:"BA",Z=25:"BW",Z=27:"BR",Z=29:"IO",Z=32:"BN",Z=33:"BG",Z=223:"Faso",Z=35:"BI",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",295,0)
 S PRCACC=$S(Z=37:"KH",Z=38:"CM",Z=39:"CA",Z=40:"CV",Z=41:"KY",Z=42:"CF",Z=44:"TD",Z=45:"CL",Z=46:"CN",Z=50:"CO",Z=51:"KM",Z=53:"CG",Z=54:"CD",Z=55:"CK",Z=56:"CR",Z=109:"CI",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",296,0)
 S PRCACC=$S(Z=57:"HR",Z=58:"CU",Z=59:"CY",Z=60:"CZ",Z=115:"KP",Z=62:"DK",Z=80:"DJ",Z=63:"DM",Z=64:"DO",Z=172:"TP",Z=65:"EC",Z=220:"EG",Z=66:"SV",Z=67:"GQ",Z=69:"ER",Z=70:"EE",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",297,0)
 S PRCACC=$S(Z=68:"ET",Z=72:"FK",Z=71:"FO",Z=74:"FJ",Z=75:"FI",Z=76:"FR",Z=77:"GF",Z=78:"PF",Z=79:"TF",Z=81:"GA",Z=83:"GM",Z=82:"GE",Z=84:"DE",Z=85:"GH",Z=86:"GI",Z=221:"GB",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",298,0)
 S PRCACC=$S(Z=88:"GR",Z=89:"GL",Z=90:"GD",Z=91:"GP",Z=92:"GT",Z=93:"GN",Z=171:"GW",Z=94:"GY",Z=95:"HT",Z=98:"HN",Z=99:"HK",Z=100:"HU",Z=101:"IS",Z=102:"IN",Z=103:"ID",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",299,0)
 S PRCACC=$S(Z=105:"IQ",Z=106:"IE",Z=107:"IL",Z=108:"IT",Z=110:"JM",Z=111:"JP",Z=113:"JO",Z=112:"KZ",Z=114:"KE",Z=87:"KI",Z=116:"KR",Z=117:"KW",Z=118:"KG",Z=119:"LA",Z=122:"LV",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",300,0)
 S PRCACC=$S(Z=120:"LB",Z=121:"LS",Z=123:"LR",Z=124:"LY",Z=125:"LI",Z=126:"LT",Z=127:"LU",Z=128:"MO",Z=129:"MG",Z=130:"MW",Z=131:"MY",Z=132:"MV",Z=133:"ML",Z=134:"MT",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",301,0)
 S PRCACC=$S(Z=999:"MH",Z=135:"MQ",Z=136:"MR",Z=137:"MU",Z=52:"YT",Z=138:"MX",Z=161:"FM",Z=141:"MD",Z=139:"MC",Z=140:"MN",Z=142:"MS",Z=143:"MA",Z=144:"MZ",Z=34:"MM",Z=146:"NA",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",302,0)
 S PRCACC=$S(Z=147:"NR",Z=148:"NP",Z=149:"NL",Z=150:"AN",Z=152:"NC",Z=154:"NZ",Z=155:"NI",Z=156:"NE",Z=157:"NG",Z=158:"NU",Z=159:"NF",Z=160:"NO",Z=145:"OM",Z=162:"PK",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",303,0)
 S PRCACC=$S(Z=999:"PW",Z=163:"PA",Z=164:"PG",Z=165:"PY",Z=166:"PE",Z=167:"PH",Z=168:"PN",Z=169:"PL",Z=170:"PT",Z=173:"QA",Z=999:"RE",Z=175:"RO",Z=176:"RU",Z=177:"RW",Z=178:"SH",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",304,0)
 S PRCACC=$S(Z=179:"KN",Z=181:"LC",Z=183:"VC",Z=999:"WS",Z=184:"SM",Z=185:"ST",Z=186:"SA",Z=187:"SN",Z=188:"SC",Z=189:"SL",Z=190:"SG",Z=191:"SK",Z=193:"SI",Z=30:"SB",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",305,0)
 S PRCACC=$S(Z=194:"SO",Z=195:"ZA",Z=197:"ES",Z=43:"LK",Z=199:"SD",Z=200:"SR",Z=201:"SZ",Z=202:"SE",Z=203:"CH",Z=204:"SY",Z=205:"TJ",Z=222:"TZ",Z=182:"PM",Z=206:"TH",Z=219:"MK",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",306,0)
 S PRCACC=$S(Z=207:"TG",Z=208:"TK",Z=209:"TO",Z=210:"TT",Z=212:"TN",Z=213:"TR",Z=214:"TM",Z=215:"TC",Z=216:"TV",Z=217:"UG",Z=218:"UA",Z=211:"AE",Z=1:"US",Z=224:"UY",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",307,0)
 S PRCACC=$S(Z=104:"IR",Z=225:"UZ",Z=153:"VU",Z=97:"VA",Z=226:"VE",Z=183:"VN",Z=31:"VG",Z=227:"WF",Z=228:"YE",Z=229:"YU",Z=230:"ZM",Z=196:"ZW",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",308,0)
COUNTRYQ ;
"RTN","RCTCSP1",309,0)
 Q PRCACC
"RTN","RCTCSP1",310,0)
 ;
"RTN","RCTCSP2")
0^18^B87861761
"RTN","RCTCSP2",1,0)
RCTCSP2 ;ALBANY/BDB-CROSS-SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSP2",2,0)
 ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSP2",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP2",4,0)
 ;
"RTN","RCTCSP2",5,0)
 Q
"RTN","RCTCSP2",6,0)
 ;
"RTN","RCTCSP2",7,0)
COMPILE ;
"RTN","RCTCSP2",8,0)
 N RCMSG,BCNTR,REC,RECC,AMOUNT,RCNTR,ACTION,SEQ
"RTN","RCTCSP2",9,0)
 S BCNTR=0,REC=0,RECC=0,AMOUNT=0,SEQ=0
"RTN","RCTCSP2",10,0)
 F  S BCNTR=$O(^XTMP("RCTCSPD",$J,BCNTR)) Q:+BCNTR'>0  D
"RTN","RCTCSP2",11,0)
 .I REC>50 D
"RTN","RCTCSP2",12,0)
 ..D TRAILER^RCTCSP1
"RTN","RCTCSP2",13,0)
 ..D AITCMSG
"RTN","RCTCSP2",14,0)
 ..S REC=0,RECC=0
"RTN","RCTCSP2",15,0)
 ..Q
"RTN","RCTCSP2",16,0)
 .S ACTION="" F  S ACTION=$O(^XTMP("RCTCSPD",$J,BCNTR,ACTION)) Q:ACTION=""  D
"RTN","RCTCSP2",17,0)
 ..I REC=0 D HEADER^RCTCSP1
"RTN","RCTCSP2",18,0)
 ..F RCNTR=1,2,"2A","2C",3 I $D(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR)) D
"RTN","RCTCSP2",19,0)
 ...S REC=REC+1
"RTN","RCTCSP2",20,0)
 ...S RECC=RECC+1 ;record count for 'c' records on trailer record
"RTN","RCTCSP2",21,0)
 ...S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR),1,225)_$C(94)
"RTN","RCTCSP2",22,0)
 ...S REC=REC+1
"RTN","RCTCSP2",23,0)
 ...S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR),226,999)_$C(126)
"RTN","RCTCSP2",24,0)
 ...I $E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR),2)="1" S AMOUNT=AMOUNT+$E(^(RCNTR),91,104)
"RTN","RCTCSP2",25,0)
 ...Q
"RTN","RCTCSP2",26,0)
 ..I $D(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B")) D
"RTN","RCTCSP2",27,0)
 ...N TRNNUM
"RTN","RCTCSP2",28,0)
 ...S TRNNUM=0
"RTN","RCTCSP2",29,0)
 ...F  S TRNNUM=$O(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM)) Q:TRNNUM'?1N.N  D
"RTN","RCTCSP2",30,0)
 ....S REC=REC+1
"RTN","RCTCSP2",31,0)
 ....S RECC=RECC+1 ;record count for 'c' records on trailer record
"RTN","RCTCSP2",32,0)
 ....S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM),1,225)_$C(94)
"RTN","RCTCSP2",33,0)
 ....S REC=REC+1
"RTN","RCTCSP2",34,0)
 ....S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM),226,999)_$C(126)
"RTN","RCTCSP2",35,0)
 ....S AMOUNT=AMOUNT+$TR($E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM),173,186),"-")
"RTN","RCTCSP2",36,0)
 ....Q
"RTN","RCTCSP2",37,0)
 ...Q
"RTN","RCTCSP2",38,0)
 ..Q
"RTN","RCTCSP2",39,0)
 .Q
"RTN","RCTCSP2",40,0)
 D TRAILER^RCTCSP1
"RTN","RCTCSP2",41,0)
 D AITCMSG
"RTN","RCTCSP2",42,0)
 D USRMSG
"RTN","RCTCSP2",43,0)
 Q
"RTN","RCTCSP2",44,0)
 ;
"RTN","RCTCSP2",45,0)
RCLLCHK(BILL) ;
"RTN","RCTCSP2",46,0)
 N TOTAL
"RTN","RCTCSP2",47,0)
 I $P(B15,U,7) Q 0 ;check stop tcsp referral flag
"RTN","RCTCSP2",48,0)
 I $P(B15,U,2),'$P(B15,U,3) D  ;recall bill
"RTN","RCTCSP2",49,0)
 .N ACTION,BILLCSL
"RTN","RCTCSP2",50,0)
 .S ACTION="L"
"RTN","RCTCSP2",51,0)
 .S $P(^PRCA(430,BILL,15),U,1)="" ;clear the date referred
"RTN","RCTCSP2",52,0)
 .S $P(^PRCA(430,BILL,15),U,3)=DT ;set the recall date
"RTN","RCTCSP2",53,0)
 .S $P(^PRCA(430,BILL,15),U,5)=$$GET1^DIQ(430,BILL,11) ;set the recall amount to the current amount
"RTN","RCTCSP2",54,0)
 .S B15=^PRCA(430,BILL,15)
"RTN","RCTCSP2",55,0)
 .S BILLCSL=BILL ;last cs bill
"RTN","RCTCSP2",56,0)
 .D REC1^RCTCSPD
"RTN","RCTCSP2",57,0)
 .K ^PRCA(430,"TCSP",BILL) ;set the bill to not sent to cross-servicing
"RTN","RCTCSP2",58,0)
 ;
"RTN","RCTCSP2",59,0)
 ;recall bill if total <$25
"RTN","RCTCSP2",60,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSP2",61,0)
 I TOTAL<25 D  Q 0
"RTN","RCTCSP2",62,0)
 .N X1,X2,P366DT,X,PRCAEN,I,RECALL
"RTN","RCTCSP2",63,0)
 .S RECALL=0
"RTN","RCTCSP2",64,0)
 .S X1=DT,X2=-366 D C^%DTC S P366DT=X
"RTN","RCTCSP2",65,0)
 .S PRCAEN=0 F I=0:0 S PRCAEN=$O(^PRCA(433,"C",BILL,PRCAEN)) Q:'PRCAEN  S:$P($G(^PRCA(433,PRCAEN,1)),U,1)>P366DT RECALL=1
"RTN","RCTCSP2",66,0)
 .I RECALL=0 D  Q
"RTN","RCTCSP2",67,0)
 ..S ACTION="L"
"RTN","RCTCSP2",68,0)
 ..S $P(^PRCA(430,BILL,15),U,1)="" ;clear the date referred
"RTN","RCTCSP2",69,0)
 ..S $P(^PRCA(430,BILL,15),U,2)=1 ;set the recall flag
"RTN","RCTCSP2",70,0)
 ..S $P(^PRCA(430,BILL,15),U,3)=DT ;set the recall date
"RTN","RCTCSP2",71,0)
 ..S $P(^PRCA(430,BILL,15),U,4)="07" ;set the recall reason
"RTN","RCTCSP2",72,0)
 ..S $P(^PRCA(430,BILL,15),U,5)=$P(^PRCA(430,BILL,16),U,10) ;set the recall amount to the current tcsp amount
"RTN","RCTCSP2",73,0)
 ..S $P(^PRCA(430,BILL,15),U,7)=1 ;set the stop flag
"RTN","RCTCSP2",74,0)
 ..S $P(^PRCA(430,BILL,15),U,8)=DT ;set the stop date
"RTN","RCTCSP2",75,0)
 ..S $P(^PRCA(430,BILL,15),U,9)="O" ;set the stop date
"RTN","RCTCSP2",76,0)
 ..S $P(^PRCA(430,BILL,15),U,10)="AUTORECALL <$25" ;set the stop reason
"RTN","RCTCSP2",77,0)
 ..S B15=^PRCA(430,BILL,15)
"RTN","RCTCSP2",78,0)
 ..D REC1^RCTCSPD
"RTN","RCTCSP2",79,0)
 ..K ^PRCA(430,"TCSP",BILL) ;set the bill to not sent to cross-servicing
"RTN","RCTCSP2",80,0)
 ..S $P(^PRCA(430,BILL,19),U,10)=1 ;stop interest admin calc
"RTN","RCTCSP2",81,0)
 ..S B19=$G(^PRCA(430,BILL,19))
"RTN","RCTCSP2",82,0)
 ..Q
"RTN","RCTCSP2",83,0)
 .Q
"RTN","RCTCSP2",84,0)
 Q 0
"RTN","RCTCSP2",85,0)
 ;
"RTN","RCTCSP2",86,0)
RCRPRT ;print reconciliation report
"RTN","RCTCSP2",87,0)
 N ZTDESC,ZTRTN,POP,%ZIS
"RTN","RCTCSP2",88,0)
 W !
"RTN","RCTCSP2",89,0)
 K IOP,IO("Q") S %ZIS="MQ",%ZIS("B")="" D ^%ZIS Q:POP  S IOP=ION_";"_IOM_";"_IOSL
"RTN","RCTCSP2",90,0)
 I $D(IO("Q")) D  Q
"RTN","RCTCSP2",91,0)
 .S ZTRTN="RCRPRTP^RCTCSP2",ZTDESC="RECONCILIATION REPORT"
"RTN","RCTCSP2",92,0)
 .D ^%ZTLOAD,HOME^%ZIS
"RTN","RCTCSP2",93,0)
 .Q
"RTN","RCTCSP2",94,0)
 ;
"RTN","RCTCSP2",95,0)
RCRPRTP ;print reconciliation report, call to build array of bills returned
"RTN","RCTCSP2",96,0)
 U IO
"RTN","RCTCSP2",97,0)
 N DASH,PAGE,DBTR,DBTRN,RCOUT
"RTN","RCTCSP2",98,0)
 K ^XTMP("RCTCSPP",$J)
"RTN","RCTCSP2",99,0)
 S ^XTMP("RCTCSPP",0)=$$FMADD^XLFDT(DT,3)_"^"_DT
"RTN","RCTCSP2",100,0)
 S DBTR=0
"RTN","RCTCSP2",101,0)
 F  S DBTR=$O(^PRCA(430,"C",DBTR)) Q:DBTR'?1N.N  D
"RTN","RCTCSP2",102,0)
 .N BILL
"RTN","RCTCSP2",103,0)
 .S BILL=0,FND1=0
"RTN","RCTCSP2",104,0)
 .F  S BILL=$O(^PRCA(430,"C",DBTR,BILL)) Q:BILL'?1N.N  D  Q:FND1
"RTN","RCTCSP2",105,0)
 ..I +$P($G(^PRCA(430,BILL,30)),U,1)=0 Q
"RTN","RCTCSP2",106,0)
 ..S DBTRN=$$GET1^DIQ(430,BILL,9) Q:DBTRN']""
"RTN","RCTCSP2",107,0)
 ..S ^XTMP("RCTCSPP",$J,DBTRN,DBTR)=""
"RTN","RCTCSP2",108,0)
 ..S FND1=1
"RTN","RCTCSP2",109,0)
 S PAGE=0,RCOUT=0
"RTN","RCTCSP2",110,0)
 S DASH="",$P(DASH,"-",81)=""
"RTN","RCTCSP2",111,0)
 D RCRPRTH2
"RTN","RCTCSP2",112,0)
 S DBTRN=0
"RTN","RCTCSP2",113,0)
 F  S DBTRN=$O(^XTMP("RCTCSPP",$J,DBTRN)) Q:DBTRN=""  D  Q:RCOUT
"RTN","RCTCSP2",114,0)
 .S DBTR=$O(^XTMP("RCTCSPP",$J,DBTRN,0)) Q:'+DBTR
"RTN","RCTCSP2",115,0)
 .S BILL=0
"RTN","RCTCSP2",116,0)
 .F  S BILL=$O(^PRCA(430,"C",DBTR,BILL)) Q:BILL'?1N.N  D  Q:RCOUT
"RTN","RCTCSP2",117,0)
 ..N B0,B30
"RTN","RCTCSP2",118,0)
 ..S B0=$G(^PRCA(430,BILL,0)),B30=$G(^PRCA(430,BILL,30))
"RTN","RCTCSP2",119,0)
 ..I +$P($G(^PRCA(430,BILL,30)),U,1)=0 Q
"RTN","RCTCSP2",120,0)
 ..W $E($$GET1^DIQ(430,BILL,9),1,30)
"RTN","RCTCSP2",121,0)
 ..W ?33,$P(B0,U,1)
"RTN","RCTCSP2",122,0)
 ..W ?50,$$GET1^DIQ(430,BILL,301)
"RTN","RCTCSP2",123,0)
 ..W ?68,$E($$GET1^DIQ(430,BILL,305),1,12)
"RTN","RCTCSP2",124,0)
 ..I $P(B30,U,2)]"" W !,?6,$$GET1^DIQ(430.5,$P(B30,U,2),1),!
"RTN","RCTCSP2",125,0)
 ..W:$P($G(^PRCA(430,BILL,30)),U,3)="Y" ?6,"COMPROMISE, PLEASE WRITE THIS BILL OFF BY THE MANUAL PROCESS.",!,?6,"COMPROMISED AMOUNT (NOT COLLECTED): "_$J($P($G(^PRCA(430,BILL,30)),U,4),9,2),!
"RTN","RCTCSP2",126,0)
 ..W:+$P($G(^PRCA(430,BILL,30)),U,7) ?6,"DATE OF DEATH:  "_$$UPPER^VALM1($$FMTE^XLFDT($P($G(^PRCA(430,BILL,30)),U,7))),!
"RTN","RCTCSP2",127,0)
 ..W:+$P($G(^PRCA(430,BILL,30)),U,6) ?6,"BANKRUPTCY DATE:  "_$$UPPER^VALM1($$FMTE^XLFDT($P($G(^PRCA(430,BILL,30)),U,6))),!
"RTN","RCTCSP2",128,0)
 ..W:+$P($G(^PRCA(430,BILL,30)),U,8) ?6,"DATE OF DISSOLUTION:  "_$$UPPER^VALM1($$FMTE^XLFDT($P($G(^PRCA(430,BILL,30)),U,8))),!
"RTN","RCTCSP2",129,0)
 ..;check for end of page here, if necessary form feed and print header
"RTN","RCTCSP2",130,0)
 ..W ! I ($Y+3)>IOSL D
"RTN","RCTCSP2",131,0)
 ...I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S RCOUT=1 K X,Y,DIRUT,DTOUT,DUOUT,DIROUT Q
"RTN","RCTCSP2",132,0)
 ...D RCRPRTH2
"RTN","RCTCSP2",133,0)
 I $E(IOST,1,2)="C-" R !!,"END OF REPORT...PRESS RETURN TO CONTINUE",X:DTIME W @IOF
"RTN","RCTCSP2",134,0)
 D:'$D(ZTQUEUED) ^%ZISC
"RTN","RCTCSP2",135,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RCTCSP2",136,0)
 K ZTQUEUED
"RTN","RCTCSP2",137,0)
 Q
"RTN","RCTCSP2",138,0)
 ;
"RTN","RCTCSP2",139,0)
RCRPRTH2 ;header for reconciliation report print report 2
"RTN","RCTCSP2",140,0)
 W @IOF
"RTN","RCTCSP2",141,0)
 S PAGE=PAGE+1
"RTN","RCTCSP2",142,0)
 W "PAGE "_PAGE,?12,"BILLS RETURNED FROM CROSS-SERVICING (SORTED BY DEBTOR)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP2",143,0)
 W !,DASH,!
"RTN","RCTCSP2",144,0)
 W !,"DEBTOR",?33,"BILL NO.",?50,"RETURNED DATE",?68,"CLOSED DATE"
"RTN","RCTCSP2",145,0)
 W !,"------",?33,"---- ---",?50,"-------- ----",?68,"------ ----",!
"RTN","RCTCSP2",146,0)
 Q
"RTN","RCTCSP2",147,0)
 ;
"RTN","RCTCSP2",148,0)
AITCMSG ;
"RTN","RCTCSP2",149,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,CNTLID
"RTN","RCTCSP2",150,0)
 S CNTLID=$$JD^RCTCSP1()_$$RJZF^RCTCSP1(SEQ,4)
"RTN","RCTCSP2",151,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP2",152,0)
 S XMY("XXX@Q-TPC.domain.ext")=""
"RTN","RCTCSP2",153,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP2",154,0)
 S XMSUB=SITE_"/CS TRANSMISSION/BATCH#: "_CNTLID
"RTN","RCTCSP2",155,0)
 S XMTEXT="^XTMP(""RCTCSPD"","_$J_","""_SEQ_""",""BUILD"","
"RTN","RCTCSP2",156,0)
 D ^XMD
"RTN","RCTCSP2",157,0)
 Q
"RTN","RCTCSP2",158,0)
 ;
"RTN","RCTCSP2",159,0)
USRMSG ;sends mailman message of documents sent to user
"RTN","RCTCSP2",160,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,X,RCNT,RCDAT1,RCDAT2
"RTN","RCTCSP2",161,0)
 S ACTION="" F  S ACTION=$O(^XTMP("RCTCSPD",$J,"BILL",ACTION)) Q:ACTION=""  D
"RTN","RCTCSP2",162,0)
 .K ^XTMP("RCTCSPD",$J,"BILL","MSG")
"RTN","RCTCSP2",163,0)
 .S XMDUZ="AR PACKAGE"
"RTN","RCTCSP2",164,0)
 .S XMY("G.TCSP")=""
"RTN","RCTCSP2",165,0)
 .S XMSUB="CS "_$S(ACTION="A":"ADD REFERRAL",ACTION="U":"UPDATES",ACTION="L":"RECALLS",ACTION="B":"EXISTING DEBTOR",1:"UNKNOWN")_" SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)_" BATCH ID: "_CNTLID
"RTN","RCTCSP2",166,0)
 .S ^XTMP("RCTCSPD",$J,"BILL","MSG",1)="Bill#                             TIN        TYPE       AMOUNT"
"RTN","RCTCSP2",167,0)
 .S ^XTMP("RCTCSPD",$J,"BILL","MSG",2)="-----                             ---        ----       ------"
"RTN","RCTCSP2",168,0)
 .S X=0,RCNT=2 F  S X=$O(^XTMP("RCTCSPD",$J,"BILL",ACTION,X)) Q:X=""  D
"RTN","RCTCSP2",169,0)
 ..S RCNT=RCNT+1
"RTN","RCTCSP2",170,0)
 ..S RCDAT1=$P(^XTMP("RCTCSPD",$J,"BILL",ACTION,X),U,1)
"RTN","RCTCSP2",171,0)
 ..S RCDAT2=$P(^XTMP("RCTCSPD",$J,"BILL",ACTION,X),U,2)
"RTN","RCTCSP2",172,0)
 ..S ^XTMP("RCTCSPD",$J,"BILL","MSG",RCNT)=$$RJZF($P($G(^PRCA(430,X,0)),U,1),7)_$$BLANK(22)_RCDAT1_"     "_ACTION_"        "_$S(RCDAT2]"":RCDAT2,1:"")
"RTN","RCTCSP2",173,0)
 ..Q
"RTN","RCTCSP2",174,0)
 .S ^XTMP("RCTCSPD",$J,"BILL","MSG",RCNT+1)="Total Bills: "_(RCNT-2)
"RTN","RCTCSP2",175,0)
 .S XMTEXT="^XTMP(""RCTCSPD"","_$J_",""BILL"",""MSG"","
"RTN","RCTCSP2",176,0)
 .D ^XMD
"RTN","RCTCSP2",177,0)
 .K ^XTMP("RCTCSPD",$J,"BILL","MSG")
"RTN","RCTCSP2",178,0)
 Q
"RTN","RCTCSP2",179,0)
 ;
"RTN","RCTCSP2",180,0)
THIRD ;sends mailman message to user if no third letter found
"RTN","RCTCSP2",181,0)
 Q:'$D(^XTMP("RCTCSPD",$J,"THIRD"))
"RTN","RCTCSP2",182,0)
 N XMY,XMDUZ,XMSUB,XMTEXT
"RTN","RCTCSP2",183,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP2",184,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP2",185,0)
 N TCT,TDEB,TDEB0,TBIL,TSP,FST
"RTN","RCTCSP2",186,0)
 S XMSUB="TCSP QUALIFIED/NO 3RD LETTER SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTCSP2",187,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",1)="The following list of debtor bills were not sent to TCSP."
"RTN","RCTCSP2",188,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",2)="Please review debtor's account to determine why the third"
"RTN","RCTCSP2",189,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",3)="notice letter has not been sent:"
"RTN","RCTCSP2",190,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",4)="Name                               Bill #"
"RTN","RCTCSP2",191,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",5)="----                               ------"
"RTN","RCTCSP2",192,0)
 S TCT=6,TSP=0,TDEB=""
"RTN","RCTCSP2",193,0)
 F  S TDEB=$O(^XTMP("RCTCSPD",$J,"THIRD",TDEB)) Q:TDEB=""  D
"RTN","RCTCSP2",194,0)
 .S FST=1,TBIL=""
"RTN","RCTCSP2",195,0)
 .I FST,TCT'=6 S ^XTMP("RCTCSPD",$J,"THIRD",TCT)="",TCT=TCT+1,TSP=TSP+1
"RTN","RCTCSP2",196,0)
 .F  S TBIL=$O(^XTMP("RCTCSPD",$J,"THIRD",TDEB,TBIL)) Q:TBIL=""  D
"RTN","RCTCSP2",197,0)
 ..S TDEB0=$S(FST:TDEB,1:"")
"RTN","RCTCSP2",198,0)
 ..S ^XTMP("RCTCSPD",$J,"THIRD",TCT)=TDEB0_$J(" ",35-$L(TDEB0))_TBIL
"RTN","RCTCSP2",199,0)
 ..S TCT=TCT+1,FST=0
"RTN","RCTCSP2",200,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",TCT)="Total records: "_(TCT-(6+TSP))
"RTN","RCTCSP2",201,0)
 S XMTEXT="^XTMP(""RCTCSPD"","_$J_",""THIRD"","
"RTN","RCTCSP2",202,0)
 D ^XMD
"RTN","RCTCSP2",203,0)
 K ^XTMP("RCTCSPD",$J,"THIRD")
"RTN","RCTCSP2",204,0)
THIRDQ Q
"RTN","RCTCSP2",205,0)
 ;
"RTN","RCTCSP2",206,0)
REC3 ;
"RTN","RCTCSP2",207,0)
 N REC,KNUM,DEBTNR,DEBTORNB
"RTN","RCTCSP2",208,0)
 S REC="C3 "_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSP2",209,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSP2",210,0)
 S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSP2",211,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSP2",212,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSP2",213,0)
 S REC=REC_$S(ACTION="L":"15",1:"  ")
"RTN","RCTCSP2",214,0)
 S REC=REC_"SLF"
"RTN","RCTCSP2",215,0)
 S REC=REC_$$BLANK(8)
"RTN","RCTCSP2",216,0)
 S REC=REC_$$AMOUNT(0)
"RTN","RCTCSP2",217,0)
 S REC=REC_$$BLANK(16)
"RTN","RCTCSP2",218,0)
 S REC=REC_"SLFIND"
"RTN","RCTCSP2",219,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSP2",220,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,3)=REC
"RTN","RCTCSP2",221,0)
 S $P(^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL),U,1)=$$TAXID(DEBTOR)
"RTN","RCTCSP2",222,0)
 Q
"RTN","RCTCSP2",223,0)
 ;
"RTN","RCTCSP2",224,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSP2",225,0)
 I +X S X=X+17000000
"RTN","RCTCSP2",226,0)
 S X=$E(X,1,8)
"RTN","RCTCSP2",227,0)
 Q X
"RTN","RCTCSP2",228,0)
 ;
"RTN","RCTCSP2",229,0)
AMOUNT(X) ;changes amount to zero filled, right justified
"RTN","RCTCSP2",230,0)
 S:X<0 X=-X
"RTN","RCTCSP2",231,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP2",232,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSP2",233,0)
 Q X
"RTN","RCTCSP2",234,0)
 ;
"RTN","RCTCSP2",235,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP2",236,0)
 N BLANK
"RTN","RCTCSP2",237,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP2",238,0)
 Q BLANK
"RTN","RCTCSP2",239,0)
 ;
"RTN","RCTCSP2",240,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSP2",241,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSP2",242,0)
 Q X
"RTN","RCTCSP2",243,0)
 ;
"RTN","RCTCSP2",244,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSP2",245,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP2",246,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP2",247,0)
 Q X
"RTN","RCTCSP2",248,0)
 ;
"RTN","RCTCSP2",249,0)
LJZF(X,Y) ;x left justified, y zero filled
"RTN","RCTCSP2",250,0)
 S X=X_"0000000000"
"RTN","RCTCSP2",251,0)
 S X=$E(X,X,Y)
"RTN","RCTCSP2",252,0)
 Q X
"RTN","RCTCSP2",253,0)
 ;
"RTN","RCTCSP2",254,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP2",255,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP2",256,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP2",257,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP2",258,0)
 Q TAXID
"RTN","RCTCSP2",259,0)
 ;
"RTN","RCTCSP3")
0^41^B79802534
"RTN","RCTCSP3",1,0)
RCTCSP3 ;ALBANY/BDB-CROSS-SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSP3",2,0)
 ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSP3",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP3",4,0)
 ;
"RTN","RCTCSP3",5,0)
 Q
"RTN","RCTCSP3",6,0)
 ;
"RTN","RCTCSP3",7,0)
ENTER ;Entry point from the post initialization
"RTN","RCTCSP3",8,0)
RCCSTUP I '$D(^XTMP("REJCDCONV")) D
"RTN","RCTCSP3",9,0)
 . D NOW^%DTC S RCCSTART=%
"RTN","RCTCSP3",10,0)
 . S ^XTMP("REJCDCONV","START COMPILE")=RCCSTART
"RTN","RCTCSP3",11,0)
 . S ^XTMP("REJCDCONV","STATUS")="RUNNING"
"RTN","RCTCSP3",12,0)
 . S ^XTMP("REJCDCONV",0)=$$FMADD^XLFDT(RCCSTART,730)_"^"_RCCSTART
"RTN","RCTCSP3",13,0)
 S RCCCMPLT=0 I $G(^XTMP("REJCDCONV","STATUS"))="COMPLETE" S RCCCMPLT=1
"RTN","RCTCSP3",14,0)
AA N DEBTOR
"RTN","RCTCSP3",15,0)
 S DEBTOR=0
"RTN","RCTCSP3",16,0)
 F  S DEBTOR=$O(^PRCA(430,"C",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTCSP3",17,0)
 .N X,RCDFN,DEMCS,DEBTOR0,DEBTOR1,DEBTOR7,BILL
"RTN","RCTCSP3",18,0)
 .S DEBTOR0=^RCD(340,DEBTOR,0),DEBTOR1=$G(^(1)),DEBTOR7=$G(^(7))
"RTN","RCTCSP3",19,0)
 .S RCDFN=+DEBTOR0
"RTN","RCTCSP3",20,0)
 .S DEMCS=$$DEM^RCTCSP1(RCDFN) Q:$E($P(DEMCS,U,3),1,5)="00000"
"RTN","RCTCSP3",21,0)
 .Q:+$P(DEMCS,U,4)  ;deceased patient
"RTN","RCTCSP3",22,0)
 .S BILL=0
"RTN","RCTCSP3",23,0)
 .F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSP3",24,0)
 ..N B0,B6,B7,B14,CAT,TOTAL
"RTN","RCTCSP3",25,0)
 ..S B0=$G(^PRCA(430,BILL,0)),B6=$G(^(6)),B7=$G(^(7)),B14=$G(^(14))
"RTN","RCTCSP3",26,0)
 ..I 'RCCCMPLT,$D(^PRCA(430,BILL,18)) D REJCODE
"RTN","RCTCSP3",27,0)
 ..I $D(^PRCA(430,"TCSP",BILL)) Q  ;no dpn for cs bills
"RTN","RCTCSP3",28,0)
 ..Q:'$P(B0,U,2)  ;no category
"RTN","RCTCSP3",29,0)
 ..S CAT=$P($G(^PRCA(430.2,$P(B0,U,2),0)),U,7)
"RTN","RCTCSP3",30,0)
 ..Q:'CAT
"RTN","RCTCSP3",31,0)
 ..I ",4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,25,26,27,28,33,34,35,36,37,38,39,"[(","_CAT_",") Q  ;1st party check
"RTN","RCTCSP3",32,0)
 ..I +$P(B14,U,1) Q  ;bill referred to TOP
"RTN","RCTCSP3",33,0)
 ..S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSP3",34,0)
 ..I TOTAL'>0 Q  ;total must be greater than zero
"RTN","RCTCSP3",35,0)
 ..I '$P(B0,U,8) Q  ;if no current status
"RTN","RCTCSP3",36,0)
 ..I $P(B0,U,8)=23 Q  ;quit if write-off
"RTN","RCTCSP3",37,0)
 ..I $P(B0,U,8)=26 Q  ;quit if cancelled
"RTN","RCTCSP3",38,0)
 ..I $P(B0,U,8)=39 Q  ;quit if cancellation
"RTN","RCTCSP3",39,0)
 ..I TOTAL<25 S $P(^PRCA(430,BILL,20),U,3,8)="1^^^^^" ;set dpn flag
"RTN","RCTCSP3",40,0)
 ..Q
"RTN","RCTCSP3",41,0)
 .Q
"RTN","RCTCSP3",42,0)
 I RCCCMPLT'=1 D
"RTN","RCTCSP3",43,0)
 . D NOW^%DTC S RCCEND=%
"RTN","RCTCSP3",44,0)
 . S ^XTMP("REJCDCONV","END REJ CODE CONV")=RCCEND
"RTN","RCTCSP3",45,0)
 . S ^XTMP("REJCDCONV","STATUS")="COMPLETE"
"RTN","RCTCSP3",46,0)
 Q
"RTN","RCTCSP3",47,0)
 ;  
"RTN","RCTCSP3",48,0)
DUEPROC ; called from rctcspd
"RTN","RCTCSP3",49,0)
 N TOTAL
"RTN","RCTCSP3",50,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSP3",51,0)
 I TOTAL<25 Q  ;no dpn record for bills less than $25
"RTN","RCTCSP3",52,0)
 I $P($G(DEBTOR3),U,10) Q  ;check site delete flag null
"RTN","RCTCSP3",53,0)
 I +$P(B12,U,1) Q  ;check date bill sent to dmc
"RTN","RCTCSP3",54,0)
 I $P(B6,U,4),($P(B6,U,5)="DOJ") Q  ;bill referred to doj
"RTN","RCTCSP3",55,0)
 I $P(B0,U,8)'=16 Q  ;status active
"RTN","RCTCSP3",56,0)
 I '$P(B6,U,3) Q  ;must have a 3rd letter
"RTN","RCTCSP3",57,0)
 D RECDPN ;create a dpn record
"RTN","RCTCSP3",58,0)
 Q
"RTN","RCTCSP3",59,0)
 ;
"RTN","RCTCSP3",60,0)
RECDPN ;
"RTN","RCTCSP3",61,0)
 N KNUM,NAME
"RTN","RCTCSP3",62,0)
 S REC="C"
"RTN","RCTCSP3",63,0)
 S REC=REC_$$RJZF(BILL,10)
"RTN","RCTCSP3",64,0)
 S REC=REC_$$TAXID(DEBTOR)
"RTN","RCTCSP3",65,0)
 S NAME=$$NAMEFF(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSP3",66,0)
 S REC=REC_$$LJSF(NAME,30)
"RTN","RCTCSP3",67,0)
 S RCDFN=+DEBTOR0
"RTN","RCTCSP3",68,0)
 S ADDRCS=$$ADDR(RCDFN)
"RTN","RCTCSP3",69,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,1),35)_$$LJSF($P(ADDRCS,U,2),35)_$$LJSF($P(ADDRCS,U,3),15)
"RTN","RCTCSP3",70,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,8),20)
"RTN","RCTCSP3",71,0)
 S REC=REC_$$BLANK(5)
"RTN","RCTCSP3",72,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,4),2)_$$LJSF($P(ADDRCS,U,5),9)
"RTN","RCTCSP3",73,0)
 S REC=REC_$$COUNTRY^RCTCSP1($P(ADDRCS,U,7))
"RTN","RCTCSP3",74,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSP3",75,0)
 S REC=REC_$$BLANK(9)
"RTN","RCTCSP3",76,0)
 S REC=REC_$$DATE8(+$P(B6,U,21))
"RTN","RCTCSP3",77,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSP3",78,0)
 S REC=REC_$E(SITE,1,3)_$$LJSF(KNUM,7)
"RTN","RCTCSP3",79,0)
 S REC=REC_$$AMOUNT9(TOTAL)
"RTN","RCTCSP3",80,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,9),10)
"RTN","RCTCSP3",81,0)
 S REC=REC_$S($P(ADDRCS,U,9)="":" ",$P(ADDRCS,U,9)="US":" ",1:"F")
"RTN","RCTCSP3",82,0)
 S REC=REC_$$BLANK(250-$L(REC))
"RTN","RCTCSP3",83,0)
 S $P(^PRCA(430,BILL,20),U,4)=DT ;set the dpn request date
"RTN","RCTCSP3",84,0)
 S $P(^PRCA(430,BILL,20),U,5,8)="^^^" ;clear the print date and error codes
"RTN","RCTCSP3",85,0)
 S ^XTMP("RCTCSPDN",$J,BILL,"DPN",1)=REC
"RTN","RCTCSP3",86,0)
 S ^XTMP("RCTCSPDN",$J,"BILL","DPN",BILL)=$$TAXID(DEBTOR)_"^"_+$E(REC,201,207)_"."_$E(REC,208,209) ;sends mailman message of documents sent to user
"RTN","RCTCSP3",87,0)
 Q
"RTN","RCTCSP3",88,0)
 ;
"RTN","RCTCSP3",89,0)
COMPILED ;
"RTN","RCTCSP3",90,0)
 N RCMSG,BCNTR,REC,RECC,AMOUNT,AMOUNT,RCNTR,ACTION,SEQ,EOF
"RTN","RCTCSP3",91,0)
 S BCNTR=0,REC=0,RECC=0,AMOUNT=0,SEQ=0,EOF=0
"RTN","RCTCSP3",92,0)
 F  S BCNTR=$O(^XTMP("RCTCSPDN",$J,BCNTR)) S:+BCNTR'>0 EOF=1 Q:+BCNTR'>0  D
"RTN","RCTCSP3",93,0)
 .I REC>120 D
"RTN","RCTCSP3",94,0)
 ..D TRAILERD
"RTN","RCTCSP3",95,0)
 ..D AITCMSGD
"RTN","RCTCSP3",96,0)
 ..S REC=0,RECC=0
"RTN","RCTCSP3",97,0)
 ..Q
"RTN","RCTCSP3",98,0)
 .S ACTION="DPN"
"RTN","RCTCSP3",99,0)
 .I REC=0 D HEADERD
"RTN","RCTCSP3",100,0)
 .S RCNTR=1 I $D(^XTMP("RCTCSPDN",$J,BCNTR,ACTION,RCNTR)) D
"RTN","RCTCSP3",101,0)
 ..S REC=REC+1
"RTN","RCTCSP3",102,0)
 ..S RECC=RECC+1 ;record count for 'c' records on trailer record
"RTN","RCTCSP3",103,0)
 ..S ^XTMP("RCTCSPDN",$J,SEQ,"BUILD",REC)=^XTMP("RCTCSPDN",$J,BCNTR,ACTION,RCNTR)_$C(126)
"RTN","RCTCSP3",104,0)
 ..S AMOUNT=AMOUNT+$E(^XTMP("RCTCSPDN",$J,BCNTR,ACTION,RCNTR),201,209)
"RTN","RCTCSP3",105,0)
 ..Q
"RTN","RCTCSP3",106,0)
 .Q
"RTN","RCTCSP3",107,0)
 D TRAILERD
"RTN","RCTCSP3",108,0)
 D AITCMSGD
"RTN","RCTCSP3",109,0)
 D USRMSGD
"RTN","RCTCSP3",110,0)
 Q
"RTN","RCTCSP3",111,0)
 ;
"RTN","RCTCSP3",112,0)
AITCMSGD ;
"RTN","RCTCSP3",113,0)
 N XMY,XMDUZ,XMSUB,XMTEXT
"RTN","RCTCSP3",114,0)
 Q:'$D(^XTMP("RCTCSPDN",$J))
"RTN","RCTCSP3",115,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP3",116,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP3",117,0)
 S XMY("XXX@Q-TPL.domain.ext")=""
"RTN","RCTCSP3",118,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP3",119,0)
 S XMSUB=SITE_"/DPN TRANSMISSION/BATCH#: "_CNTLID
"RTN","RCTCSP3",120,0)
 S XMTEXT="^XTMP(""RCTCSPDN"","_$J_","""_SEQ_""",""BUILD"","
"RTN","RCTCSP3",121,0)
 D ^XMD
"RTN","RCTCSP3",122,0)
 Q
"RTN","RCTCSP3",123,0)
 ;
"RTN","RCTCSP3",124,0)
USRMSGD ;sends mailman message of documents sent to user
"RTN","RCTCSP3",125,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,X,RCNT,RCDAT1,RCDAT2
"RTN","RCTCSP3",126,0)
 Q:'$D(^XTMP("RCTCSPDN",$J))
"RTN","RCTCSP3",127,0)
 S ACTION="DPN"
"RTN","RCTCSP3",128,0)
 K ^XTMP("RCTCSPDN",$J,"BILL","MSG")
"RTN","RCTCSP3",129,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP3",130,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP3",131,0)
 S XMSUB="CS DUE PROCESS"_" SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)_" BATCH ID: "_CNTLID
"RTN","RCTCSP3",132,0)
 S ^XTMP("RCTCSPDN",$J,"BILL","MSG",1)="Bill#                            TIN         TYPE       AMOUNT"
"RTN","RCTCSP3",133,0)
 S ^XTMP("RCTCSPDN",$J,"BILL","MSG",2)="-----                            ---         ----       ------"
"RTN","RCTCSP3",134,0)
 S X=0,RCNT=2 F  S X=$O(^XTMP("RCTCSPDN",$J,"BILL",ACTION,X)) Q:X=""  D
"RTN","RCTCSP3",135,0)
 .S RCNT=RCNT+1
"RTN","RCTCSP3",136,0)
 .S RCDAT1=$P(^XTMP("RCTCSPDN",$J,"BILL",ACTION,X),U,1)
"RTN","RCTCSP3",137,0)
 .S RCDAT2=$P(^XTMP("RCTCSPDN",$J,"BILL",ACTION,X),U,2)
"RTN","RCTCSP3",138,0)
 .S ^XTMP("RCTCSPDN",$J,"BILL","MSG",RCNT)=$$RJZF($P($G(^PRCA(430,X,0)),U,1),7)_$$BLANK(22)_RCDAT1_"   "_ACTION_"        "_$S(RCDAT2]"":RCDAT2,1:"")
"RTN","RCTCSP3",139,0)
 .Q
"RTN","RCTCSP3",140,0)
 S ^XTMP("RCTCSPDN",$J,"BILL","MSG",RCNT+1)="Total Bills: "_(RCNT-2)
"RTN","RCTCSP3",141,0)
 S XMTEXT="^XTMP(""RCTCSPDN"","_$J_",""BILL"",""MSG"","
"RTN","RCTCSP3",142,0)
 D ^XMD
"RTN","RCTCSP3",143,0)
 K ^XTMP("RCTCSPDN",$J,"BILL","MSG")
"RTN","RCTCSP3",144,0)
 Q
"RTN","RCTCSP3",145,0)
 ;
"RTN","RCTCSP3",146,0)
HEADERD ;
"RTN","RCTCSP3",147,0)
 ;increment batch sequence number, build new header
"RTN","RCTCSP3",148,0)
 N RCMSG
"RTN","RCTCSP3",149,0)
 S SEQ=SEQ+1
"RTN","RCTCSP3",150,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP3",151,0)
 K ^XTMP("RCTCSPDN",$J,ACTION,"BUILD",SEQ)
"RTN","RCTCSP3",152,0)
 S RCMSG="H"_CNTLID_$$BLANK(14)_"3636001200" ;header is record type H
"RTN","RCTCSP3",153,0)
 S RCMSG=RCMSG_$$BLANK(250-$L(RCMSG))
"RTN","RCTCSP3",154,0)
 S REC=REC+1
"RTN","RCTCSP3",155,0)
 S ^XTMP("RCTCSPDN",$J,SEQ,"BUILD",REC)=RCMSG_$C(126)
"RTN","RCTCSP3",156,0)
 Q
"RTN","RCTCSP3",157,0)
 ;
"RTN","RCTCSP3",158,0)
TRAILERD ;
"RTN","RCTCSP3",159,0)
 ;trailer is type Z record
"RTN","RCTCSP3",160,0)
 I REC=0 K ^XTMP("RCTCSPDN",$J,SEQ,"BUILD") Q  ;delete batch if no records processed
"RTN","RCTCSP3",161,0)
 N RCMSG
"RTN","RCTCSP3",162,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP3",163,0)
 S RCMSG="Z"_$$RJZF(RECC,8)_$$AMOUNT(AMOUNT/100)_CNTLID_$$BLANK(14)_"3636001200"
"RTN","RCTCSP3",164,0)
 S RCMSG=RCMSG_$$BLANK(250-$L(RCMSG))
"RTN","RCTCSP3",165,0)
 S:EOF $E(RCMSG,229,236)="0001"_$$RJZF(SEQ,4)
"RTN","RCTCSP3",166,0)
 S REC=REC+1
"RTN","RCTCSP3",167,0)
 S ^XTMP("RCTCSPDN",$J,SEQ,"BUILD",REC)=RCMSG_$C(126)
"RTN","RCTCSP3",168,0)
 S REC=0,RECC=0,AMOUNT=0
"RTN","RCTCSP3",169,0)
 Q
"RTN","RCTCSP3",170,0)
 ;
"RTN","RCTCSP3",171,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSP3",172,0)
 I +X S X=X+17000000
"RTN","RCTCSP3",173,0)
 S X=$E(X,1,8)
"RTN","RCTCSP3",174,0)
 Q X
"RTN","RCTCSP3",175,0)
 ;
"RTN","RCTCSP3",176,0)
AMOUNT(X) ;changes amount to zero filled, right justified, 14 characters
"RTN","RCTCSP3",177,0)
 S:X<0 X=-X
"RTN","RCTCSP3",178,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP3",179,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSP3",180,0)
 Q X
"RTN","RCTCSP3",181,0)
 ;
"RTN","RCTCSP3",182,0)
AMOUNT9(X) ;changes amount to zero filled, right justified
"RTN","RCTCSP3",183,0)
 S:X<0 X=-X
"RTN","RCTCSP3",184,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP3",185,0)
 S X=$E("000000000000",1,9-$L(X))_X
"RTN","RCTCSP3",186,0)
 Q X
"RTN","RCTCSP3",187,0)
 ;
"RTN","RCTCSP3",188,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP3",189,0)
 N BLANK
"RTN","RCTCSP3",190,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP3",191,0)
 Q BLANK
"RTN","RCTCSP3",192,0)
 ;
"RTN","RCTCSP3",193,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSP3",194,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSP3",195,0)
 Q X
"RTN","RCTCSP3",196,0)
 ;
"RTN","RCTCSP3",197,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSP3",198,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP3",199,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP3",200,0)
 Q X
"RTN","RCTCSP3",201,0)
 ;
"RTN","RCTCSP3",202,0)
LJZF(X,Y) ;x left justified, y zero filled
"RTN","RCTCSP3",203,0)
 S X=X_"0000000000"
"RTN","RCTCSP3",204,0)
 S X=$E(X,X,Y)
"RTN","RCTCSP3",205,0)
 Q X
"RTN","RCTCSP3",206,0)
 ;
"RTN","RCTCSP3",207,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP3",208,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP3",209,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP3",210,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP3",211,0)
 Q TAXID
"RTN","RCTCSP3",212,0)
 ;
"RTN","RCTCSP3",213,0)
JD() ; returns today's Julian date YDOY
"RTN","RCTCSP3",214,0)
 N XMDDD,XMNOW,XMDT
"RTN","RCTCSP3",215,0)
 S XMNOW=$$NOW^XLFDT
"RTN","RCTCSP3",216,0)
 S XMDT=$E(XMNOW,1,7)
"RTN","RCTCSP3",217,0)
 S XMDDD=$$RJ^XLFSTR($$FMDIFF^XLFDT(XMDT,$E(XMDT,1,3)_"0101",1)+1,3,"0")
"RTN","RCTCSP3",218,0)
 Q $E(DT,3)_XMDDD
"RTN","RCTCSP3",219,0)
 ;
"RTN","RCTCSP3",220,0)
NAMEFF(DFN) ;returns name for document and name in file
"RTN","RCTCSP3",221,0)
 N FN,LN,MN,NM,DOCNM,VA,VADM
"RTN","RCTCSP3",222,0)
 S NM=""
"RTN","RCTCSP3",223,0)
 D DEM^VADPT
"RTN","RCTCSP3",224,0)
 I $D(VADM) S NM=VADM(1)
"RTN","RCTCSP3",225,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCTCSP3",226,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S MN=""
"RTN","RCTCSP3",227,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCTCSP3",228,0)
 S DOCNM=LN_", "_FN_" "_MN
"RTN","RCTCSP3",229,0)
 Q DOCNM
"RTN","RCTCSP3",230,0)
 ;
"RTN","RCTCSP3",231,0)
ADDR(RCDFN) ; returns patient file address
"RTN","RCTCSP3",232,0)
 N DFN,ADDRCS,STATEIEN,STATEAB,VAPA
"RTN","RCTCSP3",233,0)
 S DFN=RCDFN
"RTN","RCTCSP3",234,0)
 D ADD^VADPT
"RTN","RCTCSP3",235,0)
 S STATEIEN=+VAPA(5),STATEAB=$$GET1^DIQ(5,STATEIEN,1)
"RTN","RCTCSP3",236,0)
 S ADDRCS=VAPA(1)_U_VAPA(2)_U_VAPA(4)_U_STATEAB_U_VAPA(6)_U_VAPA(8)_U_+VAPA(25)_U_VAPA(23)_U_VAPA(24) ;25-country,23-province,24-postal code
"RTN","RCTCSP3",237,0)
 I $L(DEBTOR1)>0 I $P(DEBTOR1,U,1,5)'?1"^"."^" D
"RTN","RCTCSP3",238,0)
 .N ADDR340
"RTN","RCTCSP3",239,0)
 .S ADDR340=$P($$DADD^RCAMADD(DEBTOR),U,1,7)_"^"_1
"RTN","RCTCSP3",240,0)
 .S ADDR340=$P(ADDR340,U,1,2)_"^"_$P(ADDR340,U,4,99)
"RTN","RCTCSP3",241,0)
 .I $P(ADDR340,U,6)="" S $P(ADDR340,U,6)=$P(ADDRCS,U,6)
"RTN","RCTCSP3",242,0)
 .S ADDRCS=ADDR340
"RTN","RCTCSP3",243,0)
 Q ADDRCS
"RTN","RCTCSP3",244,0)
 ;
"RTN","RCTCSP3",245,0)
REJCODE ;Converts AITC reject codes in reject multiple to pointer to file 348.5
"RTN","RCTCSP3",246,0)
 N RRI,REJI,REJCD,HREJREC,REJREC S RRI=0
"RTN","RCTCSP3",247,0)
REJA S RRI=$O(^PRCA(430,BILL,18,RRI)) Q:'RRI
"RTN","RCTCSP3",248,0)
 S REJREC=$G(^PRCA(430,BILL,18,RRI,0)),HREJREC=REJREC,REJI=3 G REJA:REJREC=""
"RTN","RCTCSP3",249,0)
 I $D(^XTMP("REJCDCONV","BB",BILL,18,RRI,0)) G REJA
"RTN","RCTCSP3",250,0)
 F REJI=REJI:1:13 S REJCD=$P(REJREC,U,REJI) I REJCD'="" D
"RTN","RCTCSP3",251,0)
 . I REJI=12,$D(^RC(348.7,"B",REJCD)) S $P(REJREC,U,REJI)=$O(^RC(348.7,"B",REJCD,0)) Q
"RTN","RCTCSP3",252,0)
 . I REJI=13,$D(^RC(348.6,"B",REJCD)) S $P(REJREC,U,REJI)=$O(^RC(348.6,"B",REJCD,0)) Q
"RTN","RCTCSP3",253,0)
 . I REJI>11 S ^XTMP("REJCDCONV","XX",BILL,18,RRI,0)=REJI_U_HREJREC Q
"RTN","RCTCSP3",254,0)
 . I REJCD>9,REJCD<100 Q
"RTN","RCTCSP3",255,0)
 . I REJCD?1.N,((REJCD>"00")&(REJCD<"10"))!((+REJCD>0)&(+REJCD<10)) S $P(REJREC,U,REJI)=+REJCD Q
"RTN","RCTCSP3",256,0)
 . I $D(^RC(348.5,"B",REJCD)) S $P(REJREC,U,REJI)=$O(^RC(348.5,"B",REJCD,0)) Q
"RTN","RCTCSP3",257,0)
 . S $P(REJREC,U,REJI)=298,^XTMP("REJCDCONV","ZZ",BILL,18,RRI,0)=$P(HREJREC,U,REJI)
"RTN","RCTCSP3",258,0)
 . Q
"RTN","RCTCSP3",259,0)
 I HREJREC'=REJREC S ^XTMP("REJCDCONV","BB",BILL,18,RRI,0)=HREJREC,^XTMP("REJCDCONV","BB",BILL,18,RRI,1)=REJREC,^PRCA(430,BILL,18,RRI,0)=REJREC
"RTN","RCTCSP3",260,0)
 G REJA
"RTN","RCTCSP3S")
0^42^B30705650
"RTN","RCTCSP3S",1,0)
RCTCSP3S ;ALBANY/BDB-CROSS-SERVICING DPN SERVER ;03/15/14 3:34 PM
"RTN","RCTCSP3S",2,0)
 ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSP3S",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP3S",4,0)
 ;
"RTN","RCTCSP3S",5,0)
READ ;READS MESSAGE INTO TEMPORARY GLOBAL
"RTN","RCTCSP3S",6,0)
 N FDT S FDT=0
"RTN","RCTCSP3S",7,0)
 K ^XTMP("RCTCSP3S",$J)
"RTN","RCTCSP3S",8,0)
 S ^XTMP("RCTCSP3S",0)=$$FMADD^XLFDT(DT,3)_"^"_DT
"RTN","RCTCSP3S",9,0)
 K ^XTMP("RCTCSPD",$J)
"RTN","RCTCSP3S",10,0)
 S ^XTMP("RCTCSPD",0)=$$FMADD^XLFDT(DT,3)_"^"_DT
"RTN","RCTCSP3S",11,0)
 S XMA=0
"RTN","RCTCSP3S",12,0)
READ1 X XMREC I $D(XMER) G:XMER<0 READQ
"RTN","RCTCSP3S",13,0)
 I $E(XMRG,1)="H" S FDT=$E(XMRG,2,9)
"RTN","RCTCSP3S",14,0)
 S ^XTMP("RCTCSP3S",$J,"READ",FDT,XMPOS)=XMRG
"RTN","RCTCSP3S",15,0)
 G READ1
"RTN","RCTCSP3S",16,0)
 ;
"RTN","RCTCSP3S",17,0)
READQ K XMA,XMER,XMREC,XMPOS,XMRG
"RTN","RCTCSP3S",18,0)
 N REC
"RTN","RCTCSP3S",19,0)
 S LN=0
"RTN","RCTCSP3S",20,0)
 F  S LN=$O(^XTMP("RCTCSP3S",$J,"READ",FDT,LN)) Q:LN=""  S REC=$G(^(LN)) D
"RTN","RCTCSP3S",21,0)
 .S TYPE=$E(REC,1)
"RTN","RCTCSP3S",22,0)
 .I TYPE="H" K TYPE Q
"RTN","RCTCSP3S",23,0)
 .I TYPE="C" D DPN K TYPE Q
"RTN","RCTCSP3S",24,0)
 .I TYPE="Z" K TYPE Q
"RTN","RCTCSP3S",25,0)
 .Q
"RTN","RCTCSP3S",26,0)
 ;
"RTN","RCTCSP3S",27,0)
 D LTRPDT
"RTN","RCTCSP3S",28,0)
 D ERRCD
"RTN","RCTCSP3S",29,0)
 Q
"RTN","RCTCSP3S",30,0)
 ;
"RTN","RCTCSP3S",31,0)
LTRPDT ;sends mailman message to user for due process notification letter print date
"RTN","RCTCSP3S",32,0)
 Q:'$D(^XTMP("RCTCSPD",$J,"L"))
"RTN","RCTCSP3S",33,0)
 S XMDUZ="AR PACKAGE",XMY("G.TCSP")=""
"RTN","RCTCSP3S",34,0)
 N TCT,TDEB,TBIL,TBCNT
"RTN","RCTCSP3S",35,0)
 S XMSUB="CS DUE PROCESS NOTIFICATION LETTERS "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTCSP3S",36,0)
 S ^XTMP("RCTCSPD",$J,"LTR",1)="The following Debt Due Process Notification letters have been printed."
"RTN","RCTCSP3S",37,0)
 S ^XTMP("RCTCSPD",$J,"LTR",2)=""
"RTN","RCTCSP3S",38,0)
 S ^XTMP("RCTCSPD",$J,"LTR",3)="Name                             Bill #    DPN File Date   Letter Print Date"
"RTN","RCTCSP3S",39,0)
 S ^XTMP("RCTCSPD",$J,"LTR",4)="----                             ------    -------------   -----------------"
"RTN","RCTCSP3S",40,0)
 S TDEB="",TBCNT=0,TCT=4
"RTN","RCTCSP3S",41,0)
 F  S TDEB=$O(^XTMP("RCTCSPD",$J,"L",TDEB)) Q:TDEB=""  D
"RTN","RCTCSP3S",42,0)
 .S TBIL=""
"RTN","RCTCSP3S",43,0)
 .F  S TBIL=$O(^XTMP("RCTCSPD",$J,"L",TDEB,TBIL)) Q:TBIL=""  S TBCNT=TBCNT+1 D
"RTN","RCTCSP3S",44,0)
 ..S TCT=TCT+1
"RTN","RCTCSP3S",45,0)
 ..S ^XTMP("RCTCSPD",$J,"LTR",TCT)=^XTMP("RCTCSPD",$J,"L",TDEB,TBIL)
"RTN","RCTCSP3S",46,0)
 S TCT=TCT+1
"RTN","RCTCSP3S",47,0)
 S ^XTMP("RCTCSPD",$J,"LTR",TCT)="Total records: "_TBCNT
"RTN","RCTCSP3S",48,0)
 S XMTEXT="^XTMP(""RCTCSPD"","_$J_",""LTR"","
"RTN","RCTCSP3S",49,0)
 D ^XMD K XMDUZ,XMSUB,XMTEXT,XMY
"RTN","RCTCSP3S",50,0)
LTRQ Q
"RTN","RCTCSP3S",51,0)
 ;
"RTN","RCTCSP3S",52,0)
ERRCD ;sends mailman message to user for due process notification letter print date
"RTN","RCTCSP3S",53,0)
 Q:'$D(^XTMP("RCTCSPD",$J,"E"))
"RTN","RCTCSP3S",54,0)
 S XMDUZ="AR PACKAGE",XMY("G.TCSP")=""
"RTN","RCTCSP3S",55,0)
 N TCT,TDEB,TBIL,TBCNT
"RTN","RCTCSP3S",56,0)
 S XMSUB="CS DUE PROCESS NOTIFICATION REJECT RECORDS "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTCSP3S",57,0)
 S ^XTMP("RCTCSPD",$J,"ERRCD",1)="The following Debt Due Process Notification file records have been rejected."
"RTN","RCTCSP3S",58,0)
 S ^XTMP("RCTCSPD",$J,"ERRCD",2)=""
"RTN","RCTCSP3S",59,0)
 S ^XTMP("RCTCSPD",$J,"ERRCD",3)="Name                     Bill #   DPN File Date  Reject Error Codes"
"RTN","RCTCSP3S",60,0)
 S ^XTMP("RCTCSPD",$J,"ERRCD",4)="----                     ------   -------------  ------------------"
"RTN","RCTCSP3S",61,0)
 S TDEB="",TBCNT=0,TCT=4
"RTN","RCTCSP3S",62,0)
 F  S TDEB=$O(^XTMP("RCTCSPD",$J,"E",TDEB)) Q:TDEB=""  D
"RTN","RCTCSP3S",63,0)
 .S TBIL=""
"RTN","RCTCSP3S",64,0)
 .F  S TBIL=$O(^XTMP("RCTCSPD",$J,"E",TDEB,TBIL)) Q:TBIL=""  S TBCNT=TBCNT+1 D
"RTN","RCTCSP3S",65,0)
 ..S TCT=TCT+1
"RTN","RCTCSP3S",66,0)
 ..S ^XTMP("RCTCSPD",$J,"ERRCD",TCT)=^XTMP("RCTCSPD",$J,"E",TDEB,TBIL)
"RTN","RCTCSP3S",67,0)
 S TCT=TCT+1
"RTN","RCTCSP3S",68,0)
 S ^XTMP("RCTCSPD",$J,"ERRCD",TCT)="Total records: "_TBCNT
"RTN","RCTCSP3S",69,0)
 S XMTEXT="^XTMP(""RCTCSPD"","_$J_",""ERRCD"","
"RTN","RCTCSP3S",70,0)
 D ^XMD
"RTN","RCTCSP3S",71,0)
ERRQ Q
"RTN","RCTCSP3S",72,0)
 ;
"RTN","RCTCSP3S",73,0)
DPN ;due process notification record
"RTN","RCTCSP3S",74,0)
 N BILL,X,ERRCD,ERRCDD,Y,PRNTDT,DEBTOR,DEBTORN,REC1
"RTN","RCTCSP3S",75,0)
 S BILL=+$E(REC,2,11)
"RTN","RCTCSP3S",76,0)
 S X=$E(REC,221,228) I +X D  Q  ;check for a letter print date
"RTN","RCTCSP3S",77,0)
 .D ^%DT S PRNTDT=Y
"RTN","RCTCSP3S",78,0)
 .S $P(^PRCA(430,BILL,20),U,5)=PRNTDT ;set the aitc print date
"RTN","RCTCSP3S",79,0)
 .S DEBTOR=$P($G(^PRCA(430,BILL,0)),U,9)
"RTN","RCTCSP3S",80,0)
 .I DEBTOR D
"RTN","RCTCSP3S",81,0)
 ..S DEBTORN=$$GET1^DIQ(430,BILL,9)
"RTN","RCTCSP3S",82,0)
 ..S DEBTORN=$E(DEBTORN,1,31)
"RTN","RCTCSP3S",83,0)
 ..S REC1=DEBTORN_$$BLANK(33-$L(DEBTORN))_$$LJSF($P($P(^PRCA(430,BILL,0),U,1),"-",2),7)_"   "
"RTN","RCTCSP3S",84,0)
 ..S REC1=REC1_$$LJSF($$FMTE^XLFDT($P($G(^PRCA(430,BILL,20)),U,4)),13)_"   "_$$LJSF($$FMTE^XLFDT(PRNTDT),13)
"RTN","RCTCSP3S",85,0)
 ..S ^XTMP("RCTCSPD",$J,"L",DEBTOR,BILL)=REC1
"RTN","RCTCSP3S",86,0)
 .S $P(^PRCA(430,BILL,20),U,6,8)="^^" ;clear the error codes
"RTN","RCTCSP3S",87,0)
 S ERRCD=$E(REC,231,248) I ERRCD'?1" "." " D  Q  ;check for error codes
"RTN","RCTCSP3S",88,0)
 .S DEBTOR=$P($G(^PRCA(430,BILL,0)),U,9)
"RTN","RCTCSP3S",89,0)
 .I DEBTOR D
"RTN","RCTCSP3S",90,0)
 ..N ERRCDD,RCJ
"RTN","RCTCSP3S",91,0)
 ..S DEBTORN=$$GET1^DIQ(430,BILL,9)
"RTN","RCTCSP3S",92,0)
 ..S DEBTORN=$E(DEBTORN,1,23)
"RTN","RCTCSP3S",93,0)
 ..S REC1=DEBTORN_$$BLANK(25-$L(DEBTORN))_$$LJSF($P($P(^PRCA(430,BILL,0),U,1),"-",2),7)_"  "
"RTN","RCTCSP3S",94,0)
 ..S REC1=REC1_$$LJSF($$FMTE^XLFDT($P($G(^PRCA(430,BILL,20)),U,4)),13)_"  "
"RTN","RCTCSP3S",95,0)
 ..S ERRCDD=$E(ERRCD,1,2)
"RTN","RCTCSP3S",96,0)
 ..F RCJ=3:2:17 Q:$E(ERRCD,RCJ)'?1AN  S ERRCDD=ERRCDD_","_$E(ERRCD,RCJ,RCJ+1)
"RTN","RCTCSP3S",97,0)
 ..S REC1=REC1_$$LJSF(ERRCDD,27)
"RTN","RCTCSP3S",98,0)
 ..S ^XTMP("RCTCSPD",$J,"E",DEBTOR,BILL)=REC1
"RTN","RCTCSP3S",99,0)
 .S $P(^PRCA(430,BILL,20),U,7)=DT ;set the aitc error date
"RTN","RCTCSP3S",100,0)
 .S $P(^PRCA(430,BILL,20),U,8)=ERRCD ;set the aitc error codes
"RTN","RCTCSP3S",101,0)
 .S $P(^PRCA(430,BILL,20),U,4,6)="^^" ;clear the request date, referral date, and the print date
"RTN","RCTCSP3S",102,0)
 Q
"RTN","RCTCSP3S",103,0)
 ;
"RTN","RCTCSP3S",104,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSP3S",105,0)
 I +X S X=X+17000000
"RTN","RCTCSP3S",106,0)
 S X=$E(X,1,8)
"RTN","RCTCSP3S",107,0)
 Q X
"RTN","RCTCSP3S",108,0)
 ;
"RTN","RCTCSP3S",109,0)
AMOUNT(X) ;changes amount to zero filled, right justified
"RTN","RCTCSP3S",110,0)
 S:X<0 X=-X
"RTN","RCTCSP3S",111,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP3S",112,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSP3S",113,0)
 Q X
"RTN","RCTCSP3S",114,0)
 ;
"RTN","RCTCSP3S",115,0)
AMOUNT9(X) ;changes amount to zero filled, right justified
"RTN","RCTCSP3S",116,0)
 S:X<0 X=-X
"RTN","RCTCSP3S",117,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP3S",118,0)
 S X=$E("000000000000",1,9-$L(X))_X
"RTN","RCTCSP3S",119,0)
 Q X
"RTN","RCTCSP3S",120,0)
 ;
"RTN","RCTCSP3S",121,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP3S",122,0)
 N BLANK
"RTN","RCTCSP3S",123,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP3S",124,0)
 Q BLANK
"RTN","RCTCSP3S",125,0)
 ;
"RTN","RCTCSP3S",126,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSP3S",127,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSP3S",128,0)
 Q X
"RTN","RCTCSP3S",129,0)
 ;
"RTN","RCTCSP3S",130,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSP3S",131,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP3S",132,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP3S",133,0)
 Q X
"RTN","RCTCSP3S",134,0)
 ;
"RTN","RCTCSP3S",135,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP3S",136,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP3S",137,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP3S",138,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP3S",139,0)
 Q TAXID
"RTN","RCTCSP3S",140,0)
 ;
"RTN","RCTCSP3S",141,0)
JD() ; returns today's Julian date YDOY
"RTN","RCTCSP3S",142,0)
 N XMDDD,XMNOW,XMDT
"RTN","RCTCSP3S",143,0)
 S XMNOW=$$NOW^XLFDT
"RTN","RCTCSP3S",144,0)
 S XMDT=$E(XMNOW,1,7)
"RTN","RCTCSP3S",145,0)
 S XMDDD=$$RJ^XLFSTR($$FMDIFF^XLFDT(XMDT,$E(XMDT,1,3)_"0101",1)+1,3,"0")
"RTN","RCTCSP3S",146,0)
 Q $E(DT,3)_XMDDD
"RTN","RCTCSP3S",147,0)
 ;
"RTN","RCTCSP3S",148,0)
NAMEFF(DFN) ;returns name for document and name in file
"RTN","RCTCSP3S",149,0)
 N FN,LN,MN,NM,DOCNM,VA,VADM
"RTN","RCTCSP3S",150,0)
 S NM=""
"RTN","RCTCSP3S",151,0)
 D DEM^VADPT
"RTN","RCTCSP3S",152,0)
 I $D(VADM) S NM=VADM(1)
"RTN","RCTCSP3S",153,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCTCSP3S",154,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S MN=""
"RTN","RCTCSP3S",155,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCTCSP3S",156,0)
 S DOCNM=LN_", "_FN_" "_MN
"RTN","RCTCSP3S",157,0)
 Q DOCNM
"RTN","RCTCSP3S",158,0)
 ;
"RTN","RCTCSPD")
0^1^B168545559
"RTN","RCTCSPD",1,0)
RCTCSPD ;ALBANY/BDB-CROSS-SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSPD",2,0)
 ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSPD",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSPD",4,0)
ENTER ;Entry point from nightly process PRCABJ
"RTN","RCTCSPD",5,0)
 N DEBTOR,P150DT,PRIN,INT,ADMIN,TDEB,TFIL
"RTN","RCTCSPD",6,0)
 N RCDFN,CNTR,SITE,LN,FN,MN,SITE,F60DT,VADM
"RTN","RCTCSPD",7,0)
 N PHONE,QUIT,TOTAL,ZIPCODE,FULLNM,RCNT,REPAY,X1,X2
"RTN","RCTCSPD",8,0)
 N ERROR,ADDR,CAT,BILLDT,CURRTOT,SITECD
"RTN","RCTCSPD",9,0)
 N SEQ,CNTLID,PREPDT,X1,X2,X,DELDT,ACTDT
"RTN","RCTCSPD",10,0)
 ;
"RTN","RCTCSPD",11,0)
 ;initialize temporary global, variables
"RTN","RCTCSPD",12,0)
 ;
"RTN","RCTCSPD",13,0)
 K ^TMP("RCTCSPD",$J)
"RTN","RCTCSPD",14,0)
 K ^XTMP("RCTCSPD",$J)
"RTN","RCTCSPD",15,0)
 K ^XTMP("RCTCSPDN",$J)
"RTN","RCTCSPD",16,0)
 S ^XTMP("RCTCSPD",0)=$$FMADD^XLFDT(DT,3)_"^"_DT
"RTN","RCTCSPD",17,0)
 S ^XTMP("RCTCSPDN",0)=$$FMADD^XLFDT(DT,3)_"^"_DT
"RTN","RCTCSPD",18,0)
 S SITE=$E($$SITE^RCMSITE(),1,3),SITECD=$P(^RC(342,1,3),U,5)
"RTN","RCTCSPD",19,0)
 S ACTDT=3150801 ;activation date for all sites except beckley, little rock, upstate ny 
"RTN","RCTCSPD",20,0)
 S:SITE=598 ACTDT=3150201 ;activation date for little rock
"RTN","RCTCSPD",21,0)
 S:SITE=517 ACTDT=3150201 ;activation date for beckley
"RTN","RCTCSPD",22,0)
 S:SITE=528 ACTDT=3150201 ;activation date for upstate ny
"RTN","RCTCSPD",23,0)
 S X1=DT,X2=-150 D C^%DTC S P150DT=X
"RTN","RCTCSPD",24,0)
 S X1=DT,X2=+60 D C^%DTC S F60DT=X
"RTN","RCTCSPD",25,0)
 S (CNTR(1),CNTR(2),CNTR("2A"),CNTR("2C"),CNTR(3),CNTR("5A"),CNTR("5B"))=0
"RTN","RCTCSPD",26,0)
 S (DEBTOR,RCNT)=0,SEQ=0
"RTN","RCTCSPD",27,0)
 ;
"RTN","RCTCSPD",28,0)
 F  S DEBTOR=$O(^PRCA(430,"C",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTCSPD",29,0)
 .N X,RCDFN,DEMCS,DOB,GNDR,DEBTOR0,DEBTOR1,DEBTOR3,DEBTOR7,BILL
"RTN","RCTCSPD",30,0)
 .S DEBTOR0=^RCD(340,DEBTOR,0),DEBTOR1=$G(^(1)),DEBTOR3=$G(^(3)),DEBTOR7=$G(^(7))
"RTN","RCTCSPD",31,0)
 .S RCDFN=+DEBTOR0
"RTN","RCTCSPD",32,0)
 .S DEMCS=$$DEM^RCTCSP1(RCDFN)
"RTN","RCTCSPD",33,0)
 .S DOB=$P(DEMCS,U,2)
"RTN","RCTCSPD",34,0)
 .S GNDR=$P(DEMCS,U,1) S:"MF"'[GNDR GNDR="U"
"RTN","RCTCSPD",35,0)
 .I $P(DEBTOR7,U,2) I '+$P(DEBTOR7,U,3) D  ;send type 2 recall record
"RTN","RCTCSPD",36,0)
 ..N ACTION,B0,B15,BILL
"RTN","RCTCSPD",37,0)
 ..S ACTION="L"
"RTN","RCTCSPD",38,0)
 ..S B0="",B15="",BILL=0
"RTN","RCTCSPD",39,0)
 ..F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  I $D(^PRCA(430,"TCSP",BILL)) I $P(^PRCA(430,BILL,15),U,7)'=1 S B0=$G(^PRCA(430,BILL,0)),B15=$G(^(15)) Q  ;get one bill
"RTN","RCTCSPD",40,0)
 ..I BILL="" S BILL=0 S $P(^RCD(340,DEBTOR,7),U,2,4)="^^",$P(DEBTOR7,U,2,4)="^^" Q  ;cs debtor with no cs bill, clear the debtor recall flag, quit
"RTN","RCTCSPD",41,0)
 ..D REC2
"RTN","RCTCSPD",42,0)
 ..S $P(^RCD(340,DEBTOR,7),U,3)=DT
"RTN","RCTCSPD",43,0)
 ..S DEBTOR7=^RCD(340,DEBTOR,7)
"RTN","RCTCSPD",44,0)
 ..S BILL=0 ;set debtor cross-serviced bills as recalled
"RTN","RCTCSPD",45,0)
 ..F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPD",46,0)
 ...I $D(^PRCA(430,"TCSP",BILL)) D  Q  ;bill previously sent to TCSP
"RTN","RCTCSPD",47,0)
 ....S $P(^PRCA(430,BILL,15),U,1)="" ;clear the date referred
"RTN","RCTCSPD",48,0)
 ....S $P(^PRCA(430,BILL,15),U,2)=1 ;set the recall flag
"RTN","RCTCSPD",49,0)
 ....S $P(^PRCA(430,BILL,15),U,3)=DT ;set the recall date
"RTN","RCTCSPD",50,0)
 ....S $P(^PRCA(430,BILL,15),U,4)=$P(DEBTOR7,U,4) ;set the recall reason
"RTN","RCTCSPD",51,0)
 ....S $P(^PRCA(430,BILL,15),U,5)=$$GET1^DIQ(430,BILL,11) ;set the recall amount to the current amount
"RTN","RCTCSPD",52,0)
 ....K ^PRCA(430,"TCSP",BILL) ;set the bill to not sent to cross-servicing
"RTN","RCTCSPD",53,0)
 .S (BILL,TOTAL,REPAY)=0
"RTN","RCTCSPD",54,0)
 .F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPD",55,0)
 ..N B0,B4,B6,B7,B9,B12,B121,B14,B15,B16,B19,B20,ACTION
"RTN","RCTCSPD",56,0)
 ..S B0=$G(^PRCA(430,BILL,0)),B4=$G(^(4)),B6=$G(^(6)),B7=$G(^(7)),B9=$G(^(9)),B12=$G(^(12)),B121=$G(^(12.1)),B14=$G(^(14)),B15=$G(^(15)),B16=$G(^(16)),B19=$G(^(19)),B20=$G(^(20))
"RTN","RCTCSPD",57,0)
 ..Q:($P(B6,U,21)\1)<ACTDT  ;cs activation date cutoff
"RTN","RCTCSPD",58,0)
 ..I $D(^PRCA(430,"TCSP",BILL)),$$RCLLCHK^RCTCSP2(BILL) Q  ;bill previously sent to TCSP
"RTN","RCTCSPD",59,0)
 ..I $$UPDCHK(BILL) Q
"RTN","RCTCSPD",60,0)
 ..Q:B4  ;repayment plan
"RTN","RCTCSPD",61,0)
 ..Q:+$P(B15,U,7)  ;quit if bill is stopped
"RTN","RCTCSPD",62,0)
 ..Q:+$P(B14,U,1)  ;bill referred to TOP
"RTN","RCTCSPD",63,0)
 ..Q:$P(DEBTOR1,"^",9)=1  ;quit if debtor address marked unknown
"RTN","RCTCSPD",64,0)
 ..Q:$E($P(DEMCS,U,3),1,5)="00000"  ;quit if the ssn is not valid
"RTN","RCTCSPD",65,0)
 ..I +$P(B12,U,1) Q  ;check date bill sent to dmc
"RTN","RCTCSPD",66,0)
 ..Q:($P(B121,U,1)="N")!($P(B121,U,1)="P")  ;dmc debt valid
"RTN","RCTCSPD",67,0)
 ..I $P(B6,U,4),($P(B6,U,5)="DOJ") Q
"RTN","RCTCSPD",68,0)
 ..Q:+$P(DEMCS,U,4)  ;deceased patient
"RTN","RCTCSPD",69,0)
 ..Q:'$P(B0,U,2)  ;no category
"RTN","RCTCSPD",70,0)
 ..S CAT=$P($G(^PRCA(430.2,$P(B0,U,2),0)),U,7)
"RTN","RCTCSPD",71,0)
 ..Q:'CAT
"RTN","RCTCSPD",72,0)
 ..I ",4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,25,26,27,28,33,34,35,36,37,38,39,"[(","_CAT_",") Q
"RTN","RCTCSPD",73,0)
 ..;dpn checks
"RTN","RCTCSPD",74,0)
 ..I $P(B20,U,3)=1,(10000+$G(^RC(342,1,"CS")))>DT,'$P(B20,U,4) D DUEPROC^RCTCSP3 Q  ;check to send dpn file to aitc
"RTN","RCTCSPD",75,0)
 ..I $P(B20,U,3)=1,(10000+$G(^RC(342,1,"CS")))>DT,$P(B20,U,4),'$P(B20,U,5) Q  ;check for print letter date
"RTN","RCTCSPD",76,0)
 ..I $P(B20,U,3)=1,(10000+$G(^RC(342,1,"CS")))>DT,$P(B20,U,4),$P(B20,U,5) D  I X<60 Q  ;check for 60 day wait from print letter date
"RTN","RCTCSPD",77,0)
 ...N X1,X2
"RTN","RCTCSPD",78,0)
 ...S X1=DT,X2=$P(B20,U,5) D ^%DTC
"RTN","RCTCSPD",79,0)
 ...I X'<60 S $P(B20,U,6)=DT,^PRCA(430,BILL,20)=B20 ;set the bill referral date to the current date
"RTN","RCTCSPD",80,0)
 ..S BILLDT=$P(B6,U,21),PREPDT=$P(B0,U,10)
"RTN","RCTCSPD",81,0)
 ..I BILLDT>P150DT Q  ;150 day old check
"RTN","RCTCSPD",82,0)
 ..I ($P(B0,U,8)=16),('$P(B6,U,3)) D  Q
"RTN","RCTCSPD",83,0)
 ...;no 3rd letter being sent
"RTN","RCTCSPD",84,0)
 ...N DNM
"RTN","RCTCSPD",85,0)
 ...S DNM=$$NAMEFF(+DEBTOR0),^XTMP("RCTCSPD",$J,"THIRD",DNM,$P(B0,U))=""
"RTN","RCTCSPD",86,0)
 ..I $P(B0,U,8)=16 I $$ADDCHKND(BILL) Q
"RTN","RCTCSPD",87,0)
 ..I $P(B0,U,8)=16 I $$ADDCHKNB(BILL) Q
"RTN","RCTCSPD",88,0)
 ..Q
"RTN","RCTCSPD",89,0)
 .Q
"RTN","RCTCSPD",90,0)
 ;
"RTN","RCTCSPD",91,0)
 D THIRD^RCTCSP2
"RTN","RCTCSPD",92,0)
 D COMPILE^RCTCSP2 ;compile cross-serviced records
"RTN","RCTCSPD",93,0)
 D COMPILED^RCTCSP3 ;compile the aitc due process notification records
"RTN","RCTCSPD",94,0)
 Q
"RTN","RCTCSPD",95,0)
 ;
"RTN","RCTCSPD",96,0)
ADDCHKND(BILL) ;add a new bill referral, new debtor
"RTN","RCTCSPD",97,0)
 N TOTAL,ACTION,X
"RTN","RCTCSPD",98,0)
 S ACTION="A"
"RTN","RCTCSPD",99,0)
 I $D(^RCD(340,"TCSP",DEBTOR)) Q 0 ;check debtor previously referred
"RTN","RCTCSPD",100,0)
 I $P(B15,U,2) Q 0 ;check tcsp bill recall flag
"RTN","RCTCSPD",101,0)
 I $P(DEBTOR7,U,2) Q 0 ;check debtor recall
"RTN","RCTCSPD",102,0)
 I $P(B15,U,7) Q 0 ;check stop tcsp referral flag
"RTN","RCTCSPD",103,0)
 I $D(^PRCA(430,"TCSP",BILL)) Q 0 ;bill previously sent to TCSP
"RTN","RCTCSPD",104,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSPD",105,0)
 I TOTAL<25 Q 1 ;no adds for bills less than $25
"RTN","RCTCSPD",106,0)
 D REC1
"RTN","RCTCSPD",107,0)
 D REC2
"RTN","RCTCSPD",108,0)
 D REC2A
"RTN","RCTCSPD",109,0)
 S $P(^PRCA(430,BILL,16),U,13)=DOB,B16=^(16)
"RTN","RCTCSPD",110,0)
 S $P(^PRCA(430,BILL,15),U,14)=GNDR,B15=^(15)
"RTN","RCTCSPD",111,0)
 D REC2C
"RTN","RCTCSPD",112,0)
 S ADDRCS=$$ADDR^RCTCSP1(RCDFN)
"RTN","RCTCSPD",113,0)
 S $P(^PRCA(430,BILL,16),U,4,8)=$P(ADDRCS,U,1,5),$P(^(16),U,11)=$P(ADDRCS,U,6),$P(^(16),U,12)=$P(ADDRCS,U,7)
"RTN","RCTCSPD",114,0)
 S B16=^PRCA(430,BILL,16)
"RTN","RCTCSPD",115,0)
 D REC3^RCTCSP2
"RTN","RCTCSPD",116,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSPD",117,0)
 S NAME=$$NAME(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSPD",118,0)
 S $P(^PRCA(430,BILL,15),U,1)=DT,$P(^(16),U,1)=TAXID,$P(^(16),U,2)=NAME
"RTN","RCTCSPD",119,0)
 S X1=BILLDT,X2=+30 D C^%DTC S DELDT=X
"RTN","RCTCSPD",120,0)
 S $P(^PRCA(430,BILL,16),U,3)=DELDT,^PRCA(430,"TCSP",BILL)=""
"RTN","RCTCSPD",121,0)
 I '$D(^RCD(340,"TCSP",DEBTOR)) S $P(^RCD(340,DEBTOR,7),U,5)=DT,^RCD(340,"TCSP",DEBTOR)=""
"RTN","RCTCSPD",122,0)
 Q 1
"RTN","RCTCSPD",123,0)
 ;
"RTN","RCTCSPD",124,0)
ADDCHKNB(BILL) ;add a new bill referral, existing debtor
"RTN","RCTCSPD",125,0)
 N TOTAL,ACTION,TAXID,NAME,ADDRCS,X
"RTN","RCTCSPD",126,0)
 I '$D(^RCD(340,"TCSP",DEBTOR)) Q 0 ;check debtor previously referred
"RTN","RCTCSPD",127,0)
 I $P(B15,U,2) Q 0 ;check tcsp bill recall flag
"RTN","RCTCSPD",128,0)
 I $P(B15,U,7) Q 0 ;check stop tcsp referral flag
"RTN","RCTCSPD",129,0)
 I $D(^PRCA(430,"TCSP",BILL)) Q 0 ;bill previously sent to TCSP
"RTN","RCTCSPD",130,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSPD",131,0)
 I TOTAL<25 Q 0 ;no adds for bills less than $25
"RTN","RCTCSPD",132,0)
 S ACTION="A" D REC1
"RTN","RCTCSPD",133,0)
 S ACTION="B" D REC2
"RTN","RCTCSPD",134,0)
 S ACTION="A" D REC3^RCTCSP2
"RTN","RCTCSPD",135,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSPD",136,0)
 S NAME=$$NAME(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSPD",137,0)
 S $P(^PRCA(430,BILL,15),U,1)=DT,$P(^(16),U,1)=TAXID,$P(^(16),U,2)=NAME,$P(^(16),U,3)=BILLDT,^PRCA(430,"TCSP",BILL)=""
"RTN","RCTCSPD",138,0)
 S ADDRCS=$$ADDR^RCTCSP1(RCDFN)
"RTN","RCTCSPD",139,0)
 S $P(^PRCA(430,BILL,16),U,4,8)=$P(ADDRCS,U,1,5),$P(^(16),U,11)=$P(ADDRCS,U,6),$P(^(16),U,12)=$P(ADDRCS,U,7)
"RTN","RCTCSPD",140,0)
 S $P(^PRCA(430,BILL,16),U,13)=DOB,B16=^(16)
"RTN","RCTCSPD",141,0)
 S $P(^PRCA(430,BILL,15),U,14)=GNDR,B15=^(15)
"RTN","RCTCSPD",142,0)
 I '$D(^RCD(340,"TCSP",DEBTOR)) S $P(^RCD(340,DEBTOR,7),U,5)=DT,^RCD(340,"TCSP",DEBTOR)=""
"RTN","RCTCSPD",143,0)
 Q 1
"RTN","RCTCSPD",144,0)
 ;
"RTN","RCTCSPD",145,0)
UPDCHK(BILL) ;update 5b or existing bill
"RTN","RCTCSPD",146,0)
 I '$D(^PRCA(430,BILL,16)) Q 0 ;quit null node 16 old address
"RTN","RCTCSPD",147,0)
 N TOTAL,TAXID,OTAXID,NAME,ONAME,ADDR,OADDR,ADDRCS,COUNTRY,OCOUNTRY,OPHONE
"RTN","RCTCSPD",148,0)
 N ODOB,OGNDR
"RTN","RCTCSPD",149,0)
 N TRNIDX,TRN1,TRN8,TRNAMT,TRNNUM,TRNFLG,FIVBFLG
"RTN","RCTCSPD",150,0)
 I $P(B15,U,2) Q 0 ;check tcsp bill recall flag
"RTN","RCTCSPD",151,0)
 I $P(B15,U,7) Q 0 ;check stop tcsp referral flag
"RTN","RCTCSPD",152,0)
 ;5b check
"RTN","RCTCSPD",153,0)
 S FIVBFLG=0
"RTN","RCTCSPD",154,0)
 S TRNIDX=0 F  S TRNIDX=$O(^PRCA(430,BILL,17,TRNIDX)) Q:+TRNIDX=0  D
"RTN","RCTCSPD",155,0)
 .S TRNNUM=$P($G(^PRCA(430,BILL,17,TRNIDX,0)),U,1),TRNFLG=$P($G(^PRCA(430,BILL,17,TRNIDX,0)),U,2)
"RTN","RCTCSPD",156,0)
 .Q:+TRNFLG=0
"RTN","RCTCSPD",157,0)
 .S TRN1=$G(^PRCA(433,TRNNUM,1)),TRNAMT=$P(TRN1,U,5) S:TRNAMT<0 TRNAMT=-TRNAMT
"RTN","RCTCSPD",158,0)
 .S TRN8=$G(^PRCA(433,TRNNUM,8))
"RTN","RCTCSPD",159,0)
 .S ACTION="U"
"RTN","RCTCSPD",160,0)
 .D REC5B^RCTCSP1
"RTN","RCTCSPD",161,0)
 .S $P(^PRCA(430,BILL,17,TRNIDX,0),U,2)=""
"RTN","RCTCSPD",162,0)
 .S FIVBFLG=1
"RTN","RCTCSPD",163,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSPD",164,0)
 I FIVBFLG,(TOTAL=0) S DR="151///@",DIE="^PRCA(430,",DA=BILL D ^DIE K DR,DIE,DA
"RTN","RCTCSPD",165,0)
 I $P(B19,U,1)=1 S ACTION="U" D REC1 S $P(B19,U,1)="" S $P(^PRCA(430,BILL,19),U,1)=""
"RTN","RCTCSPD",166,0)
 I $P(B19,U,2)=1 S ACTION="U" D REC2 S $P(B19,U,2)="" S $P(^PRCA(430,BILL,19),U,2)=""
"RTN","RCTCSPD",167,0)
 I $P(B19,U,3)=1 S ACTION="U" D REC2A S $P(B19,U,3)="" S $P(^PRCA(430,BILL,19),U,3)=""
"RTN","RCTCSPD",168,0)
 I $P(B19,U,4)=1 S ACTION="A" D REC2C S $P(B19,U,4)="" S $P(^PRCA(430,BILL,19),U,4)=""
"RTN","RCTCSPD",169,0)
 I FIVBFLG=1 Q 1 ;if 5b sent, then do not continue to referral check
"RTN","RCTCSPD",170,0)
 I '$D(^PRCA(430,"TCSP",BILL)) Q 0 ;if not cross-serviced, then continue referral check
"RTN","RCTCSPD",171,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSPD",172,0)
 S OTAXID=$P(B16,U,1)
"RTN","RCTCSPD",173,0)
 S NAME=$$NAME(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSPD",174,0)
 S ONAME=$P(B16,U,2)
"RTN","RCTCSPD",175,0)
 I $P(B0,U,8)=16,$D(^PRCA(430,"TCSP",BILL)) I (NAME'=ONAME)!(TAXID'=OTAXID) D
"RTN","RCTCSPD",176,0)
 .S ACTION="U"
"RTN","RCTCSPD",177,0)
 .D REC2
"RTN","RCTCSPD",178,0)
 .S $P(^PRCA(430,BILL,16),U,1)=TAXID,$P(^(16),U,2)=NAME,$P(^(19),U,2)="",$P(B19,U,2)=""
"RTN","RCTCSPD",179,0)
 S OADDR=$P(^PRCA(430,BILL,16),U,4,8),OPHONE=$P(^(16),U,11),OCOUNTRY=$P(^(16),U,12)
"RTN","RCTCSPD",180,0)
 S ADDRCS=$$ADDR^RCTCSP1(RCDFN),PHONE=$P(ADDRCS,U,6),COUNTRY=$P(ADDRCS,U,7)
"RTN","RCTCSPD",181,0)
 I $P(DEBTOR1,"^",9)'=1 D  ;if debtor address is not marked unknown, then check address
"RTN","RCTCSPD",182,0)
 .I $P(B0,U,8)=16,$D(^PRCA(430,"TCSP",BILL)) I ($P(ADDRCS,U,1,5)'=$P(OADDR,U,1,5))!(PHONE'=OPHONE)!(COUNTRY'=OCOUNTRY) D
"RTN","RCTCSPD",183,0)
 ..S ACTION="A" ;2c records have action code 'a'
"RTN","RCTCSPD",184,0)
 ..D REC2C
"RTN","RCTCSPD",185,0)
 ..S $P(B19,U,4)=""
"RTN","RCTCSPD",186,0)
 ..S $P(^PRCA(430,BILL,16),U,4,8)=$P(ADDRCS,U,1,5),$P(^(16),U,11)=PHONE,$P(^(16),U,12)=$P(ADDRCS,U,7)
"RTN","RCTCSPD",187,0)
 S B16=^PRCA(430,BILL,16)
"RTN","RCTCSPD",188,0)
 S ODOB=$P(^PRCA(430,BILL,16),U,13)
"RTN","RCTCSPD",189,0)
 S OGNDR=$P(^PRCA(430,BILL,15),U,14)
"RTN","RCTCSPD",190,0)
 I $P(B0,U,8)=16,$D(^PRCA(430,"TCSP",BILL)) I (DOB'=ODOB)!(GNDR'=OGNDR) D
"RTN","RCTCSPD",191,0)
 .S ACTION="U"
"RTN","RCTCSPD",192,0)
 .D REC2A
"RTN","RCTCSPD",193,0)
 .S $P(^PRCA(430,BILL,16),U,13)=DOB,B16=^(16)
"RTN","RCTCSPD",194,0)
 .S $P(^PRCA(430,BILL,15),U,14)=GNDR,B15=^(15)
"RTN","RCTCSPD",195,0)
 .Q
"RTN","RCTCSPD",196,0)
 Q 1 ;bill is cross-serviced so do not continue referral check
"RTN","RCTCSPD",197,0)
 ;
"RTN","RCTCSPD",198,0)
REC1 ;record type 1
"RTN","RCTCSPD",199,0)
 N REC,KNUM,DEBTNR,AMTORIG,AMTPBAL,AMTIBAL,AMTABAL,AMTFBAL,AMTCBAL,AMTRFRRD,AMOUNT,DELDT,X,X1,X2,BILLDT,PREPDT
"RTN","RCTCSPD",200,0)
 S REC="C1 "_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSPD",201,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSPD",202,0)
 S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR_" "
"RTN","RCTCSPD",203,0)
 S REC=REC_"I   A MSCC"
"RTN","RCTCSPD",204,0)
 S BILLDT=$P(B6,U,21),PREPDT=$P(B0,U,10)
"RTN","RCTCSPD",205,0)
 S REC=REC_$$DATE8(PREPDT)
"RTN","RCTCSPD",206,0)
 S X1=BILLDT,X2=+30 D C^%DTC S DELDT=X
"RTN","RCTCSPD",207,0)
 S REC=REC_$$DATE8(DELDT)
"RTN","RCTCSPD",208,0)
 S AMTPBAL=$P(B7,U,1) ;principle balance
"RTN","RCTCSPD",209,0)
 S AMTIBAL=$P(B7,U,2) ;interest balance
"RTN","RCTCSPD",210,0)
 S AMTABAL=$P(B7,U,3) ;administrative balance
"RTN","RCTCSPD",211,0)
 S AMTFBAL=$P(B7,U,4) ;marshal fee
"RTN","RCTCSPD",212,0)
 S AMTCBAL=$P(B7,U,5) ;court cost
"RTN","RCTCSPD",213,0)
 S AMTRFRRD=AMTPBAL+AMTIBAL+AMTABAL+AMTFBAL+AMTCBAL
"RTN","RCTCSPD",214,0)
 S AMTORIG=$P(B0,U,3)
"RTN","RCTCSPD",215,0)
 D  ;
"RTN","RCTCSPD",216,0)
 .I ACTION="A" S REC=REC_$$AMOUNT(AMTRFRRD)_$$AMOUNT(AMTRFRRD) Q
"RTN","RCTCSPD",217,0)
 .I ACTION="L" S AMTRFRRD=0 S REC=REC_$$AMOUNT(AMTRFRRD)_$$AMOUNT(AMTRFRRD) Q
"RTN","RCTCSPD",218,0)
 .S REC=REC_$$BLANK(28)
"RTN","RCTCSPD",219,0)
 S REC=REC_"                                             N        "
"RTN","RCTCSPD",220,0)
 S AMOUNT=$$AMOUNT(AMTPBAL)_$$AMOUNT(AMTIBAL)_$$AMOUNT(AMTABAL)_$$AMOUNT(AMTFBAL+AMTCBAL)
"RTN","RCTCSPD",221,0)
 I ACTION="L" S AMOUNT=$$AMOUNT(0)_$$AMOUNT(0)_$$AMOUNT(0)_$$AMOUNT(0) ;by iai spec
"RTN","RCTCSPD",222,0)
 I ACTION="U" S AMOUNT=$$BLANK(56) ;by iai spec
"RTN","RCTCSPD",223,0)
 S REC=REC_AMOUNT
"RTN","RCTCSPD",224,0)
 I ACTION="L" D
"RTN","RCTCSPD",225,0)
 .S REC=REC_$$BLANK(252-$L(REC))
"RTN","RCTCSPD",226,0)
 .S RCD=$P(B15,U,4)
"RTN","RCTCSPD",227,0)
 .S REC=REC_$S(RCD="01":"01",RCD="07":"07",RCD="08":"08",RCD="15":"01",RCD="03":"01",RCD="05":"01",RCD="06":"01",1:"01")
"RTN","RCTCSPD",228,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSPD",229,0)
 I ACTION="A" S $P(^PRCA(430,BILL,16),U,9)=AMTRFRRD,$P(^(16),U,10)=AMTRFRRD
"RTN","RCTCSPD",230,0)
 I ACTION="L" S $P(^PRCA(430,BILL,16),U,9)="",$P(^(16),U,10)=""
"RTN","RCTCSPD",231,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,1)=REC
"RTN","RCTCSPD",232,0)
 S ^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL)=$$TAXID(DEBTOR)_"^"_+$E(REC,91,102)_"."_$E(REC,103,104) ;sends mailman message of documents sent to user
"RTN","RCTCSPD",233,0)
 D CLR19(BILL,1)
"RTN","RCTCSPD",234,0)
 Q
"RTN","RCTCSPD",235,0)
 ;
"RTN","RCTCSPD",236,0)
REC2 ;
"RTN","RCTCSPD",237,0)
 N REC,KNUM,DEBTNR,DEBTORNB,TAXID,NAME,RCD
"RTN","RCTCSPD",238,0)
 S REC="C2 "_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSPD",239,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSPD",240,0)
 S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSPD",241,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSPD",242,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSPD",243,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSPD",244,0)
 S REC=REC_TAXID_"SSN"
"RTN","RCTCSPD",245,0)
 S NAME=$$NAME(+DEBTOR0),NAME=$P(NAME,U)
"RTN","RCTCSPD",246,0)
 S REC=REC_NAME_$$BLANK(5)_"I"
"RTN","RCTCSPD",247,0)
 I ACTION="L" D
"RTN","RCTCSPD",248,0)
 .S REC=REC_$$BLANK(232-$L(REC))
"RTN","RCTCSPD",249,0)
 .S RCD=$P(B15,U,4)
"RTN","RCTCSPD",250,0)
 .S REC=REC_$S(RCD="01":"12",RCD="07":"12",RCD="08":"12",RCD="15":"12",RCD="03":"03",RCD="05":"05",RCD="06":"06",1:"12")
"RTN","RCTCSPD",251,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSPD",252,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,2)=REC
"RTN","RCTCSPD",253,0)
 S $P(^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL),U,1)=$$TAXID(DEBTOR)
"RTN","RCTCSPD",254,0)
 D CLR19(BILL,2)
"RTN","RCTCSPD",255,0)
 Q
"RTN","RCTCSPD",256,0)
 ;
"RTN","RCTCSPD",257,0)
REC2A ;
"RTN","RCTCSPD",258,0)
 N REC,KNUM,DEBTNR,DEBTORNB
"RTN","RCTCSPD",259,0)
 S REC="C2A"_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSPD",260,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSPD",261,0)
 S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSPD",262,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSPD",263,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSPD",264,0)
 S REC=REC_$$BLANK(3)
"RTN","RCTCSPD",265,0)
 S REC=REC_GNDR
"RTN","RCTCSPD",266,0)
 S REC=REC_$$DATE8($P(DEMCS,U,2))
"RTN","RCTCSPD",267,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSPD",268,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,"2A")=REC
"RTN","RCTCSPD",269,0)
 S $P(^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL),U,1)=$$TAXID(DEBTOR)
"RTN","RCTCSPD",270,0)
 D CLR19(BILL,3)
"RTN","RCTCSPD",271,0)
 Q
"RTN","RCTCSPD",272,0)
 ;
"RTN","RCTCSPD",273,0)
REC2C ;
"RTN","RCTCSPD",274,0)
 N REC,KNUM,DEBTNR,DEBTORNB,TAXID,RCDFN,PHONE,ADDRCS
"RTN","RCTCSPD",275,0)
 S REC="C2C"_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSPD",276,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSPD",277,0)
 S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSPD",278,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSPD",279,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSPD",280,0)
 S TAXID=$$TAXID(DEBTOR)
"RTN","RCTCSPD",281,0)
 S REC=REC_TAXID
"RTN","RCTCSPD",282,0)
 S REC=REC_"SLFIND"
"RTN","RCTCSPD",283,0)
 S REC=REC_$$BLANK(20)
"RTN","RCTCSPD",284,0)
 S RCDFN=+DEBTOR0
"RTN","RCTCSPD",285,0)
 S REC=REC_$$LJSF($$NAMEFF(RCDFN),60)_"Y"
"RTN","RCTCSPD",286,0)
 S ADDRCS=$$ADDR^RCTCSP1(RCDFN),PHONE=$P(ADDRCS,U,6)
"RTN","RCTCSPD",287,0)
 S REC=REC_$$LJSF($P(ADDRCS,U,1),35)_$$LJSF($P(ADDRCS,U,2),35)_$$LJSF($P(ADDRCS,U,3),15)_$$LJSF($P(ADDRCS,U,4),2)_$$LJSF($P(ADDRCS,U,5),9)
"RTN","RCTCSPD",288,0)
 S REC=REC_$$COUNTRY^RCTCSP1($P(ADDRCS,U,7))
"RTN","RCTCSPD",289,0)
 S REC=REC_"Y"
"RTN","RCTCSPD",290,0)
 S REC=REC_$S(PHONE]"":"P",1:" ")
"RTN","RCTCSPD",291,0)
 S REC=REC_$$LJSF($TR(PHONE,"() -"),10)_$$BLANK(4)
"RTN","RCTCSPD",292,0)
 S REC=REC_$S(PHONE]"":"Y",1:" ")
"RTN","RCTCSPD",293,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSPD",294,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,"2C")=REC
"RTN","RCTCSPD",295,0)
 S $P(^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL),U,1)=$$TAXID(DEBTOR)
"RTN","RCTCSPD",296,0)
 D CLR19(BILL,4)
"RTN","RCTCSPD",297,0)
 Q
"RTN","RCTCSPD",298,0)
 ;
"RTN","RCTCSPD",299,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSPD",300,0)
 I +X S X=X+17000000
"RTN","RCTCSPD",301,0)
 S X=$E(X,1,8)
"RTN","RCTCSPD",302,0)
 Q X
"RTN","RCTCSPD",303,0)
 ;
"RTN","RCTCSPD",304,0)
AMOUNT(X) ;changes amount to zero filled, right justified
"RTN","RCTCSPD",305,0)
 S:X<0 X=-X
"RTN","RCTCSPD",306,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSPD",307,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSPD",308,0)
 Q X
"RTN","RCTCSPD",309,0)
 ;
"RTN","RCTCSPD",310,0)
NAME(DFN) ;returns name for document and name in file
"RTN","RCTCSPD",311,0)
 N FN,LN,MN,NM,DOCNM,VA,VADM
"RTN","RCTCSPD",312,0)
 S NM=""
"RTN","RCTCSPD",313,0)
 D DEM^VADPT
"RTN","RCTCSPD",314,0)
 I $D(VADM) S NM=VADM(1)
"RTN","RCTCSPD",315,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCTCSPD",316,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S MN=""
"RTN","RCTCSPD",317,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCTCSPD",318,0)
 S DOCNM=$$LJ^XLFSTR($E(LN,1,35),35)_$$LJ^XLFSTR($E(FN,1,35),35)_$$LJ^XLFSTR($E(MN,1,35),35)
"RTN","RCTCSPD",319,0)
 Q DOCNM
"RTN","RCTCSPD",320,0)
 ;
"RTN","RCTCSPD",321,0)
NAMEFF(DFN) ;returns name for document and name in file
"RTN","RCTCSPD",322,0)
 N FN,LN,MN,NM,DOCNM,VA,VADM
"RTN","RCTCSPD",323,0)
 S NM=""
"RTN","RCTCSPD",324,0)
 D DEM^VADPT
"RTN","RCTCSPD",325,0)
 I $D(VADM) S NM=VADM(1)
"RTN","RCTCSPD",326,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCTCSPD",327,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S MN=""
"RTN","RCTCSPD",328,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCTCSPD",329,0)
 S DOCNM=LN_" "_FN_" "_MN
"RTN","RCTCSPD",330,0)
 Q DOCNM
"RTN","RCTCSPD",331,0)
 ;
"RTN","RCTCSPD",332,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSPD",333,0)
 N BLANK
"RTN","RCTCSPD",334,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSPD",335,0)
 Q BLANK
"RTN","RCTCSPD",336,0)
 ;
"RTN","RCTCSPD",337,0)
NOW() ;compiles current date,time
"RTN","RCTCSPD",338,0)
 N X,Y,%,%H
"RTN","RCTCSPD",339,0)
 S %H=$H D YX^%DTC
"RTN","RCTCSPD",340,0)
 Q Y
"RTN","RCTCSPD",341,0)
 ;
"RTN","RCTCSPD",342,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSPD",343,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSPD",344,0)
 Q X
"RTN","RCTCSPD",345,0)
 ;
"RTN","RCTCSPD",346,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSPD",347,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSPD",348,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSPD",349,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSPD",350,0)
 Q TAXID
"RTN","RCTCSPD",351,0)
 ;
"RTN","RCTCSPD",352,0)
LJSF(X,Y) ;x left justified, y space filled
"RTN","RCTCSPD",353,0)
 S X=$E(X,1,Y)
"RTN","RCTCSPD",354,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSPD",355,0)
 Q X
"RTN","RCTCSPD",356,0)
 ;
"RTN","RCTCSPD",357,0)
LJZF(X,Y) ;x left justified, y zero filled
"RTN","RCTCSPD",358,0)
 S X=X_"0000000000"
"RTN","RCTCSPD",359,0)
 S X=$E(X,X,Y)
"RTN","RCTCSPD",360,0)
 Q X
"RTN","RCTCSPD",361,0)
 ;
"RTN","RCTCSPD",362,0)
RECALL(BILL) ; set the recall flag
"RTN","RCTCSPD",363,0)
 S $P(^PRCA(430,BILL,15),U,2)=1
"RTN","RCTCSPD",364,0)
 Q
"RTN","RCTCSPD",365,0)
 ;
"RTN","RCTCSPD",366,0)
CLR19(BILL,X) ; clear the send flag
"RTN","RCTCSPD",367,0)
 S $P(^PRCA(430,BILL,19),U,X)=""
"RTN","RCTCSPD",368,0)
 ;
"RTN","RCTCSPRS")
0^16^B53928265
"RTN","RCTCSPRS",1,0)
RCTCSPRS ;ALBANY/BDB - CROSS-SERVICING (RECONCILIATION SERVER);02/19/14 3:21 PM
"RTN","RCTCSPRS",2,0)
V ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSPRS",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSPRS",4,0)
 ;Program to process reconciliation server messages from AITC
"RTN","RCTCSPRS",5,0)
 ;
"RTN","RCTCSPRS",6,0)
 ;
"RTN","RCTCSPRS",7,0)
READ ;READS MESSAGE INTO TEMPORARY GLOBAL
"RTN","RCTCSPRS",8,0)
 N FDT S FDT=0
"RTN","RCTCSPRS",9,0)
 K ^XTMP("RCTCSPRS",$J)
"RTN","RCTCSPRS",10,0)
 S ^XTMP("RCTCSPRS",0)=$$FMADD^XLFDT(DT,3)_"^"_DT
"RTN","RCTCSPRS",11,0)
 K ^XTMP("RCTCSPD",$J)
"RTN","RCTCSPRS",12,0)
 S ^XTMP("RCTCSPD",0)=$$FMADD^XLFDT(DT,3)_"^"_DT
"RTN","RCTCSPRS",13,0)
 S XMA=0
"RTN","RCTCSPRS",14,0)
READ1 X XMREC I $D(XMER) G:XMER<0 READQ
"RTN","RCTCSPRS",15,0)
 I $E(XMRG,1)="H" S FDT=$E(XMRG,2,9)
"RTN","RCTCSPRS",16,0)
 S ^XTMP("RCTCSPRS",$J,"READ",FDT,XMPOS)=XMRG
"RTN","RCTCSPRS",17,0)
 G READ1
"RTN","RCTCSPRS",18,0)
 ;
"RTN","RCTCSPRS",19,0)
READQ K XMA,XMER,XMREC,XMPOS,XMRG
"RTN","RCTCSPRS",20,0)
 N TYPE,VALC,VFASTCD,VSTTN,VSITE,LN,REC,REC1,REC2
"RTN","RCTCSPRS",21,0)
 S VALC="36001200"
"RTN","RCTCSPRS",22,0)
 S VFASTCD="36"
"RTN","RCTCSPRS",23,0)
 S VSTTN="DM1D "
"RTN","RCTCSPRS",24,0)
 S VSITE=$E($$SITE^RCMSITE(),1,3)
"RTN","RCTCSPRS",25,0)
 S LN=0
"RTN","RCTCSPRS",26,0)
 F  S LN=$O(^XTMP("RCTCSPRS",$J,"READ",FDT,LN)) Q:LN=""  S REC1=$G(^(LN)),LN=LN+1,REC2=$G(^(LN)),REC=$E(REC1,1,225)_$E(REC2,1,225) D
"RTN","RCTCSPRS",27,0)
 .S TYPE=$E(REC,1,2)
"RTN","RCTCSPRS",28,0)
 .I TYPE["H" D HDR Q
"RTN","RCTCSPRS",29,0)
 .I TYPE="A1" Q
"RTN","RCTCSPRS",30,0)
 .I TYPE="C1" Q
"RTN","RCTCSPRS",31,0)
 .I TYPE="R1" D R1 Q
"RTN","RCTCSPRS",32,0)
 .I TYPE="R2" D R2 Q
"RTN","RCTCSPRS",33,0)
 .I TYPE["Z" K TYPE Q
"RTN","RCTCSPRS",34,0)
 .Q
"RTN","RCTCSPRS",35,0)
 ;
"RTN","RCTCSPRS",36,0)
TRDT ;sends mailman message to user for returned debts
"RTN","RCTCSPRS",37,0)
 Q:'$D(^XTMP("RCTCSPD",$J,"TRDTRDB"))
"RTN","RCTCSPRS",38,0)
 S XMDUZ="AR PACKAGE",XMY("G.TCSP")=""
"RTN","RCTCSPRS",39,0)
 N TCT1,TDEB1,TDEB10,TBIL1,TSP1,FST1,TBCNT,TTXT1
"RTN","RCTCSPRS",40,0)
 S XMSUB="CS QUALIFIED/RETURNED DEBTS "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTCSPRS",41,0)
 S ^XTMP("RCTCSPD",$J,"TRDT",1)="The following Debtors and Debts were Returned by Reconciliation."
"RTN","RCTCSPRS",42,0)
 S ^XTMP("RCTCSPD",$J,"TRDT",2)=""
"RTN","RCTCSPRS",43,0)
 S ^XTMP("RCTCSPD",$J,"TRDT",3)="Name                                     Bill #    Returned Date   Closed Date"
"RTN","RCTCSPRS",44,0)
 S ^XTMP("RCTCSPD",$J,"TRDT",4)="----                                     ------    -------- ----   ------ ----"
"RTN","RCTCSPRS",45,0)
 S TCT1=5,TSP1=0,TDEB1="",TBCNT=0
"RTN","RCTCSPRS",46,0)
 F  S TDEB1=$O(^XTMP("RCTCSPD",$J,"TRDTRDB",TDEB1)) Q:TDEB1=""  D
"RTN","RCTCSPRS",47,0)
 .S FST1=1,TBIL1=""
"RTN","RCTCSPRS",48,0)
 .I FST1,TCT1'=5 S ^XTMP("RCTCSPD",$J,"TRDT",TCT1)="",TCT1=TCT1+1,TSP1=TSP1+1
"RTN","RCTCSPRS",49,0)
 .F  S TBIL1=$O(^XTMP("RCTCSPD",$J,"TRDTRDB",TDEB1,TBIL1)) Q:TBIL1=""  S TBCNT=TBCNT+1 D
"RTN","RCTCSPRS",50,0)
 ..S TDEB10=$S(FST1:TDEB1,1:""),TTXT1=""
"RTN","RCTCSPRS",51,0)
 ..F  S TTXT1=$O(^XTMP("RCTCSPD",$J,"TRDTRDB",TDEB1,TBIL1,TTXT1)) Q:TTXT1=""  S ^XTMP("RCTCSPD",$J,"TRDT",TCT1)=^XTMP("RCTCSPD",$J,"TRDTRDB",TDEB1,TBIL1,TTXT1) S TCT1=TCT1+1
"RTN","RCTCSPRS",52,0)
 ..S TCT1=TCT1+1,FST1=0
"RTN","RCTCSPRS",53,0)
 S ^XTMP("RCTCSPD",$J,"TRDT",TCT1)="Total records: "_TBCNT
"RTN","RCTCSPRS",54,0)
 S XMTEXT="^XTMP(""RCTCSPD"","_$J_",""TRDT"","
"RTN","RCTCSPRS",55,0)
 D ^XMD K XMDUZ,XMSUB,XMTEXT,XMY
"RTN","RCTCSPRS",56,0)
 K ^XTMP("RCTCSPD",$J,"TRDT")
"RTN","RCTCSPRS",57,0)
TRDTQ Q
"RTN","RCTCSPRS",58,0)
 ;
"RTN","RCTCSPRS",59,0)
HDR ; header record
"RTN","RCTCSPRS",60,0)
 S TFASTCD=$E(REC,10,11),TALC=$E(REC,12,19) ;repeated on r1 AND r2
"RTN","RCTCSPRS",61,0)
 Q
"RTN","RCTCSPRS",62,0)
 ;
"RTN","RCTCSPRS",63,0)
R1 ;returned debt record
"RTN","RCTCSPRS",64,0)
 N TFASTCD,TALC,TSTTN,TDBTID,TRDT,TSITE,BILLNO,BILL,B0,B4,B6,B7,B9,B14,B15,B16,DEBTOR,RJND
"RTN","RCTCSPRS",65,0)
 S TFASTCD=$E(REC,3,4),TALC=$E(REC,5,12),TSTTN=$E(REC,13,17),TDBTID=$E(REC,18,47),TRDT=$E(REC,58,65)
"RTN","RCTCSPRS",66,0)
 I TFASTCD'=VFASTCD D NPMSG("FASTCD",TFASTCD,VFASTCD) Q
"RTN","RCTCSPRS",67,0)
 I TALC'=VALC D NPMSG("ALC",TALC,VALC) Q
"RTN","RCTCSPRS",68,0)
 I TSTTN'=VSTTN D NPMSG("STATION",TSTTN,VSTTN)
"RTN","RCTCSPRS",69,0)
 S TSITE=$E(TDBTID,1,3) I TSITE'=VSITE D NPMSG("SITE",TSITE,VSITE) Q
"RTN","RCTCSPRS",70,0)
 S BILLNO=$E(TDBTID,4,10),BILL=+$E(TDBTID,11,30)
"RTN","RCTCSPRS",71,0)
 S B0=$G(^PRCA(430,BILL,0)),B4=$G(^(4)),B6=$G(^(6)),B7=$G(^(7)),B9=$G(^(9)),B14=$G(^(14)),B15=$G(^(15)),B16=$G(^(16))
"RTN","RCTCSPRS",72,0)
 S DEBTOR=$P(B0,U,9)
"RTN","RCTCSPRS",73,0)
 S RJND=0 F  S RJND=$O(^PRCA(430,BILL,18,RJND)) Q:'RJND  D
"RTN","RCTCSPRS",74,0)
 .N DAT
"RTN","RCTCSPRS",75,0)
 .S DAT=+$G(^PRCA(430,BILL,18,RJND,0))
"RTN","RCTCSPRS",76,0)
 .I DAT K ^PRCA(430,"AB",DAT,BILL)
"RTN","RCTCSPRS",77,0)
 K ^PRCA(430,BILL,15),^(16),^(17),^(18),^(19),^(20)
"RTN","RCTCSPRS",78,0)
 I +TRDT D
"RTN","RCTCSPRS",79,0)
 .N DNM
"RTN","RCTCSPRS",80,0)
 .I $D(^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,1)) S $E(^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,1),52,63)=$$DTT2E(TRDT) Q
"RTN","RCTCSPRS",81,0)
 .S DNM=$E($$NAMEFF(+^RCD(340,DEBTOR,0)),1,30),DNM=$$LJSF(DNM,30)
"RTN","RCTCSPRS",82,0)
 .S ^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,1)=$$LJSF(DNM,30)_"           "_$$LJSF(BILLNO,7)_"   "_$$DTT2E(TRDT)
"RTN","RCTCSPRS",83,0)
 .S EFFDT=$$HL7TFM^XLFDT(TRDT),REASON="O",COMMENT="BY RECONCILIATION"
"RTN","RCTCSPRS",84,0)
 .S $P(^PRCA(430,BILL,15),U,7,10)="1^"_EFFDT_U_REASON_U_$G(COMMENT)
"RTN","RCTCSPRS",85,0)
 .S $P(^PRCA(430,BILL,30),U,1)=$$HL7TFM^XLFDT(TRDT)
"RTN","RCTCSPRS",86,0)
 K ^PRCA(430,"TCSP",BILL) ;set the bill to not sent to cross-servicing
"RTN","RCTCSPRS",87,0)
 Q
"RTN","RCTCSPRS",88,0)
 ;
"RTN","RCTCSPRS",89,0)
R2 ;returned debtor record
"RTN","RCTCSPRS",90,0)
 N TFASTCD,TALC,TSTTN,TDBTID,TSITE,TFDA,TDBTORID,TRRSNCD,TCMPIND,TCMPAMT,TCLSDT,TBNKDT,TDTHDT,TDISDT,RJND
"RTN","RCTCSPRS",91,0)
 S TFASTCD=$E(REC,3,4),TALC=$E(REC,5,12),TSTTN=$E(REC,13,17),TDBTID=$E(REC,18,47),TDBTORID=$E(REC,48,62),TRRSNCD=$E(REC,261,262)
"RTN","RCTCSPRS",92,0)
 S TCMPIND=$E(REC,263,263),TCMPAMT=$E(REC,264,277),TCLSDT=$E(REC,278,285),TBNKDT=$E(REC,286,293),TDTHDT=$E(REC,294,301),TDISDT=$E(REC,302,309)
"RTN","RCTCSPRS",93,0)
 I TFASTCD'=VFASTCD D NPMSG("FASTCD",TFASTCD,VFASTCD) Q
"RTN","RCTCSPRS",94,0)
 I TALC'=VALC D NPMSG("ALC",TALC,VALC) Q
"RTN","RCTCSPRS",95,0)
 I TSTTN'=VSTTN D NPMSG("STATION",TSTTN,VSTTN)
"RTN","RCTCSPRS",96,0)
 S TSITE=$E(TDBTID,1,3) I TSITE'=VSITE D NPMSG("SITE",TSITE,VSITE) Q
"RTN","RCTCSPRS",97,0)
 S BILLNO=$E(TDBTID,4,10),BILL=+$E(TDBTID,11,30)
"RTN","RCTCSPRS",98,0)
 S B0=$G(^PRCA(430,BILL,0))
"RTN","RCTCSPRS",99,0)
 S TRRSNCD=$$CLRBLNK(TRRSNCD)
"RTN","RCTCSPRS",100,0)
 S DEBTOR=$P(B0,U,9)
"RTN","RCTCSPRS",101,0)
 S RJND=0 F  S RJND=$O(^PRCA(430,BILL,18,RJND)) Q:'RJND  D
"RTN","RCTCSPRS",102,0)
 .N DAT
"RTN","RCTCSPRS",103,0)
 .S DAT=+$G(^PRCA(430,BILL,18,RJND,0))
"RTN","RCTCSPRS",104,0)
 .I DAT K ^PRCA(430,"AB",DAT,BILL)
"RTN","RCTCSPRS",105,0)
 K ^PRCA(430,BILL,15),^(16),^(17),^(18),^(19),^(20)
"RTN","RCTCSPRS",106,0)
 I TRRSNCD]"" D
"RTN","RCTCSPRS",107,0)
 .N DNM,EFFDT,REASON,COMMENT
"RTN","RCTCSPRS",108,0)
 .I $D(^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,1)) S $E(^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,1),68,79)=$S($G(TCLSDT)]"":$$DTT2E(TCLSDT),1:"")
"RTN","RCTCSPRS",109,0)
 .I '$D(^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,1)) D
"RTN","RCTCSPRS",110,0)
 ..S DNM=$E($$NAMEFF(+^RCD(340,DEBTOR,0)),1,30),DNM=$$LJSF(DNM,30),^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,1)=DNM_"           "_$$LJSF(BILLNO,7)_"                   "_$S($G(TCLSDT)]"":$$DTT2E(TCLSDT),1:"")
"RTN","RCTCSPRS",111,0)
 .S DIC="^PRCA(430.5,",DIC(0)="Z",X=TRRSNCD D ^DIC K DIC I +Y>0 D
"RTN","RCTCSPRS",112,0)
 ..S ^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,2)="     "_$P(Y(0),U,2)
"RTN","RCTCSPRS",113,0)
 ..S $P(^PRCA(430,BILL,30),U,2)=+Y
"RTN","RCTCSPRS",114,0)
 I TCMPIND="Y" D
"RTN","RCTCSPRS",115,0)
 .S ^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,3)="     COMPROMISE, PLEASE WRITE THIS BILL OFF BY THE MANUAL PROCESS."
"RTN","RCTCSPRS",116,0)
 .S $P(^PRCA(430,BILL,30),U,3)=TCMPIND
"RTN","RCTCSPRS",117,0)
 .I +TCMPAMT D
"RTN","RCTCSPRS",118,0)
 ..S ^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,4)="     COMPROMISED AMOUNT (NOT COLLECTED):"_$J(TCMPAMT/100,9,2)
"RTN","RCTCSPRS",119,0)
 ..S $P(^PRCA(430,BILL,30),U,4)=TCMPAMT/100
"RTN","RCTCSPRS",120,0)
 I +TBNKDT D
"RTN","RCTCSPRS",121,0)
 .S ^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,5)="     BANKRUPTCY DATE: "_$$DTT2E(TBNKDT)
"RTN","RCTCSPRS",122,0)
 .S $P(^PRCA(430,BILL,30),U,6)=$$HL7TFM^XLFDT(TBNKDT)
"RTN","RCTCSPRS",123,0)
 I +TDTHDT D
"RTN","RCTCSPRS",124,0)
 .S ^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,6)="     DATE OF DEATH:  "_$$DTT2E(TDTHDT)
"RTN","RCTCSPRS",125,0)
 .S $P(^PRCA(430,BILL,30),U,7)=$$HL7TFM^XLFDT(TDTHDT)
"RTN","RCTCSPRS",126,0)
 I +TDISDT D
"RTN","RCTCSPRS",127,0)
 .S ^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,7)="     DATE OF DISSOLUTION:  "_$$DTT2E(TDISDT)
"RTN","RCTCSPRS",128,0)
 .S $P(^PRCA(430,BILL,30),U,8)=$$HL7TFM^XLFDT(TDISDT)
"RTN","RCTCSPRS",129,0)
 I +TCLSDT D
"RTN","RCTCSPRS",130,0)
 .S EFFDT=$$HL7TFM^XLFDT(TCLSDT),REASON="O",COMMENT="BY RECONCILIATION"
"RTN","RCTCSPRS",131,0)
 .S $P(^PRCA(430,BILL,15),U,7,10)="1^"_EFFDT_U_REASON_U_$G(COMMENT)
"RTN","RCTCSPRS",132,0)
 .S $P(^PRCA(430,BILL,30),U,5)=$$HL7TFM^XLFDT(TCLSDT)
"RTN","RCTCSPRS",133,0)
 K ^PRCA(430,"TCSP",BILL) ;set the bill to not sent to cross-servicing
"RTN","RCTCSPRS",134,0)
 S ^XTMP("RCTCSPD",$J,"TRDTRDB",DEBTOR,BILL,8)=""
"RTN","RCTCSPRS",135,0)
 I +DEBTOR D
"RTN","RCTCSPRS",136,0)
 .N TCSPFL,BILLX
"RTN","RCTCSPRS",137,0)
 .S BILLX="",TCSPFL=0 ;check if last cross-serviced bill
"RTN","RCTCSPRS",138,0)
 .F  S BILLX=$O(^PRCA(430,"C",DEBTOR,BILLX)) Q:BILLX'?1N.N  I $D(^PRCA(430,"TCSP",BILLX)) S TCSPFL=1 Q
"RTN","RCTCSPRS",139,0)
 .I 'TCSPFL D  Q
"RTN","RCTCSPRS",140,0)
 ..N BILL
"RTN","RCTCSPRS",141,0)
 ..S $P(^RCD(340,DEBTOR,7),U,5)=""
"RTN","RCTCSPRS",142,0)
 ..K ^RCD(340,"TCSP",DEBTOR) ;set the debtor to not sent to cross-servicing
"RTN","RCTCSPRS",143,0)
 Q
"RTN","RCTCSPRS",144,0)
 ;
"RTN","RCTCSPRS",145,0)
NPMSG(FLD,TCD,VCD) ;error not processed
"RTN","RCTCSPRS",146,0)
 Q
"RTN","RCTCSPRS",147,0)
 ;
"RTN","RCTCSPRS",148,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSPRS",149,0)
 S X=$E(X,1,Y)
"RTN","RCTCSPRS",150,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSPRS",151,0)
 Q X
"RTN","RCTCSPRS",152,0)
 ;
"RTN","RCTCSPRS",153,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSPRS",154,0)
 N BLANK
"RTN","RCTCSPRS",155,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSPRS",156,0)
 Q BLANK
"RTN","RCTCSPRS",157,0)
 ;
"RTN","RCTCSPRS",158,0)
CLRBLNK(X) ;clear blanks
"RTN","RCTCSPRS",159,0)
 S X=$TR(X," ","")
"RTN","RCTCSPRS",160,0)
 Q X
"RTN","RCTCSPRS",161,0)
 ;
"RTN","RCTCSPRS",162,0)
NAMEFF(DFN) ;returns name for document and name in file
"RTN","RCTCSPRS",163,0)
 N FN,LN,MN,NM,DOCNM,VA,VADM
"RTN","RCTCSPRS",164,0)
 S NM=""
"RTN","RCTCSPRS",165,0)
 D DEM^VADPT
"RTN","RCTCSPRS",166,0)
 I $D(VADM) S NM=VADM(1)
"RTN","RCTCSPRS",167,0)
 S LN=$TR($P(NM,",")," .'-"),MN=$P($P(NM,",",2)," ",2)
"RTN","RCTCSPRS",168,0)
 I ($E(MN,1,2)="SR")!($E(MN,1,2)="JR")!(MN?2.3"I")!(MN?0.1"I"1"V"1.3"I") S MN=""
"RTN","RCTCSPRS",169,0)
 S FN=$P($P(NM,",",2)," ")
"RTN","RCTCSPRS",170,0)
 S DOCNM=LN_" "_FN_" "_MN
"RTN","RCTCSPRS",171,0)
 Q DOCNM
"RTN","RCTCSPRS",172,0)
 ;
"RTN","RCTCSPRS",173,0)
DTT2E(TDT) ;date treasury to external format
"RTN","RCTCSPRS",174,0)
 Q $$UPPER^VALM1($$FMTE^XLFDT($$HL7TFM^XLFDT(TDT)))
"RTN","RCTCSPRS",175,0)
 ;
"RTN","RCTCSPU")
0^5^B55616924
"RTN","RCTCSPU",1,0)
RCTCSPU ;ALBANY/BDB-CROSS-SERVICING UTILITIES ;03/15/14 3:34 PM
"RTN","RCTCSPU",2,0)
 ;;4.5;Accounts Receivable;**301**;Mar 20, 1995;Build 144
"RTN","RCTCSPU",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSPU",4,0)
 Q
"RTN","RCTCSPU",5,0)
 ;
"RTN","RCTCSPU",6,0)
 ;total amount of bills for a debtor
"RTN","RCTCSPU",7,0)
TOTALB(DEBTOR) ;
"RTN","RCTCSPU",8,0)
 N TOTAL,BILL,B7
"RTN","RCTCSPU",9,0)
 S TOTAL=0,BILL=0
"RTN","RCTCSPU",10,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPU",11,0)
 .Q:'$D(^PRCA(430,"TCSP",BILL))
"RTN","RCTCSPU",12,0)
 .S B7=$G(^PRCA(430,BILL,7))
"RTN","RCTCSPU",13,0)
 .S TOTAL=TOTAL+$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSPU",14,0)
 Q TOTAL
"RTN","RCTCSPU",15,0)
 ;
"RTN","RCTCSPU",16,0)
 ;stop TCSP referral on a bill
"RTN","RCTCSPU",17,0)
STOP ;stop Cross-Servicing referral
"RTN","RCTCSPU",18,0)
 N DIC,DIE,DA,DIR,Y,BILL,REASON,COMMENT,EFFDT
"RTN","RCTCSPU",19,0)
 S DIC=430,DIC(0)="AEQM" D ^DIC Q:Y<0
"RTN","RCTCSPU",20,0)
 S BILL=+Y
"RTN","RCTCSPU",21,0)
 I $P($G(^PRCA(430,BILL,15)),U,7) G DELSTOP
"RTN","RCTCSPU",22,0)
 W !,"Stop flag for Cross-Servicing Referral set? : NO"
"RTN","RCTCSPU",23,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to stop the Cross-Servicing Referral for this bill" D ^DIR
"RTN","RCTCSPU",24,0)
 I 'Y W !,*7,"No action taken" Q
"RTN","RCTCSPU",25,0)
 ;
"RTN","RCTCSPU",26,0)
REASON ;ask referral reason
"RTN","RCTCSPU",27,0)
 K DIR S DIR("A")="Enter Stop Cross-Servicing Reason ",DA=BILL,DIR(0)="430,159" D ^DIR
"RTN","RCTCSPU",28,0)
 Q:(Y="")!(Y=U)
"RTN","RCTCSPU",29,0)
 S REASON=Y I REASON="O" D  Q:COMMENT=U  G REASON:COMMENT=""
"RTN","RCTCSPU",30,0)
    .S COMMENT="",DIR("A")="Enter Stop Reason Comment ",DA=BILL,DIR(0)="430,159.1" D ^DIR S COMMENT=Y
"RTN","RCTCSPU",31,0)
    .I COMMENT="" W !,"A Reason of Other requires a comment to be entered"
"RTN","RCTCSPU",32,0)
    .Q
"RTN","RCTCSPU",33,0)
 I REASON'="O",$P($G(^PRCA(430,BILL,15)),U,10)'="" S $P(^(15),U,10)=""
"RTN","RCTCSPU",34,0)
 ;
"RTN","RCTCSPU",35,0)
 ;ask effective date
"RTN","RCTCSPU",36,0)
 ;
"RTN","RCTCSPU",37,0)
 S DIR(0)="430,158",DA=BILL,DIR("A")="Enter Effective Date " D ^DIR G:Y=U STOPQ S EFFDT=Y
"RTN","RCTCSPU",38,0)
 ;
"RTN","RCTCSPU",39,0)
STOPFILE ;set stop referral data in file 430
"RTN","RCTCSPU",40,0)
 S $P(^PRCA(430,BILL,15),U,7,10)="1^"_EFFDT_U_REASON_U_$G(COMMENT)
"RTN","RCTCSPU",41,0)
 ;
"RTN","RCTCSPU",42,0)
 W !,"Stop Cross-Servicing Referral complete"
"RTN","RCTCSPU",43,0)
 G STOPQ
"RTN","RCTCSPU",44,0)
 ;
"RTN","RCTCSPU",45,0)
DELSTOP ;Allows Cross-Servicing Referral to be re-instituted for bill
"RTN","RCTCSPU",46,0)
 N I
"RTN","RCTCSPU",47,0)
 W !!,*7,"Referral to Cross-Servicing has already been stopped for this bill."
"RTN","RCTCSPU",48,0)
 W !,"Stop Cross-Servicing referral effective date: ",$$GET1^DIQ(430,BILL,158,"E")
"RTN","RCTCSPU",49,0)
 W !,"Stop Cross-Servicing referral reason        : ",$$GET1^DIQ(430,BILL,159,"E")
"RTN","RCTCSPU",50,0)
 I $$GET1^DIQ(430,BILL,159,"E")="OTHER" W !,"Stop Cross-Servicing referral comment       : ",$$GET1^DIQ(430,BILL,159.1,"E")
"RTN","RCTCSPU",51,0)
 S DIR(0)="Y",DIR("A")="Do you wish to re-institute Cross-Servicing Referral for this bill",DIR("B")="NO" D ^DIR G EDSTOP:'Y
"RTN","RCTCSPU",52,0)
 ;
"RTN","RCTCSPU",53,0)
 ;reset file to allow cross-servicing referral to be re-started
"RTN","RCTCSPU",54,0)
 F I=7:1:10 S $P(^PRCA(430,BILL,15),U,I)=""
"RTN","RCTCSPU",55,0)
 W !!,"Bill is now eligible to be Referred to Cross-Servicing" G STOPQ
"RTN","RCTCSPU",56,0)
 ;
"RTN","RCTCSPU",57,0)
EDSTOP S DIR(0)="Y",DIR("A")="Do you wish to edit the Stop Referral Data for this bill",DIR("B")="NO" D ^DIR G REASON:Y
"RTN","RCTCSPU",58,0)
STOPQ Q
"RTN","RCTCSPU",59,0)
 ;
"RTN","RCTCSPU",60,0)
 ;Set Cross-Servicing recall for a bill
"RTN","RCTCSPU",61,0)
RCLLSETB ;Set Cross-Servicing recall
"RTN","RCTCSPU",62,0)
 N DIC,DIE,DA,DIR,Y,BILL,REASON
"RTN","RCTCSPU",63,0)
 S DIC=430,DIC(0)="AEQM" D ^DIC Q:Y<0
"RTN","RCTCSPU",64,0)
 S BILL=+Y
"RTN","RCTCSPU",65,0)
 I $P($G(^PRCA(430,BILL,15)),U,2) G DELSETB
"RTN","RCTCSPU",66,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to set this bill to be recalled from Cross-Servicing" D ^DIR
"RTN","RCTCSPU",67,0)
 I 'Y W !,*7,"No action taken" Q
"RTN","RCTCSPU",68,0)
 I '$D(^PRCA(430,"TCSP",BILL)) W !,*7,"No action taken.  Bill has not been referred to Cross-Servicing." Q
"RTN","RCTCSPU",69,0)
 ; 
"RTN","RCTCSPU",70,0)
RCRSB ;ask recall reason
"RTN","RCTCSPU",71,0)
 K DIR S DIR(0)="S^01:DEBT REFERRED IN ERROR;07:AGENCY IS FORGIVING DEBT;08:AGENCY CAN COLLECT THROUGH INTERNAL OFFSET" D ^DIR
"RTN","RCTCSPU",72,0)
 Q:(Y="")!(Y=U)
"RTN","RCTCSPU",73,0)
 ;set recall data in file 430
"RTN","RCTCSPU",74,0)
 S REASON=Y
"RTN","RCTCSPU",75,0)
 S $P(^PRCA(430,BILL,15),U,2,4)="1^^"_REASON
"RTN","RCTCSPU",76,0)
 ;
"RTN","RCTCSPU",77,0)
 W !,"Setting this bill for Recall from Cross-Servicing is complete"
"RTN","RCTCSPU",78,0)
 G SETBQ
"RTN","RCTCSPU",79,0)
 ;
"RTN","RCTCSPU",80,0)
DELSETB ;Allows Cross-Servicing Recall to be deleted for bill
"RTN","RCTCSPU",81,0)
 W !!,*7,"This bill has already been set for recall from Cross-Servicing."
"RTN","RCTCSPU",82,0)
 I +$P($G(^PRCA(430,BILL,15)),U,3) W !!,"Not available for reactivation.  The Recall request has already been processed." G SETBQ
"RTN","RCTCSPU",83,0)
 S DIR(0)="Y",DIR("A")="Do you wish to delete the Cross-Servicing Recall for this bill",DIR("B")="NO" D ^DIR G EDSETB:'Y
"RTN","RCTCSPU",84,0)
 ;
"RTN","RCTCSPU",85,0)
 ;delete the recall
"RTN","RCTCSPU",86,0)
 F I=2:1:5 S $P(^PRCA(430,BILL,15),U,I)=""
"RTN","RCTCSPU",87,0)
 W !!,"Recall from Cross-Servicing has been deleted for this bill."
"RTN","RCTCSPU",88,0)
 G SETBQ
"RTN","RCTCSPU",89,0)
 ;
"RTN","RCTCSPU",90,0)
EDSETB S DIR(0)="Y",DIR("A")="Do you wish to edit the Recall data for this bill",DIR("B")="NO" D ^DIR G RCRSB:Y
"RTN","RCTCSPU",91,0)
SETBQ Q
"RTN","RCTCSPU",92,0)
 ;
"RTN","RCTCSPU",93,0)
 ;Set Cross-Servicing recall for a debtor
"RTN","RCTCSPU",94,0)
RCLLSETD ;Set Cross-Servicing debtor recall
"RTN","RCTCSPU",95,0)
 N DIC,DIE,DA,DIR,Y,DEBTOR,REASON,BILL
"RTN","RCTCSPU",96,0)
 S DIC=340,DIC(0)="AEQM" D ^DIC Q:Y<0
"RTN","RCTCSPU",97,0)
 S DEBTOR=+Y
"RTN","RCTCSPU",98,0)
 I $P($G(^RCD(340,DEBTOR,7)),U,2),'$P($G(^RCD(340,DEBTOR,7)),U,3) G DELSETD
"RTN","RCTCSPU",99,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to recall this debtor and bills from Cross-Servicing" D ^DIR
"RTN","RCTCSPU",100,0)
 I 'Y W !,*7,"No action taken" Q
"RTN","RCTCSPU",101,0)
 I '$D(^RCD(340,"TCSP",DEBTOR)) W !,*7,"No action taken.  Debtor has not been referred to Cross-Servicing." Q
"RTN","RCTCSPU",102,0)
 ;
"RTN","RCTCSPU",103,0)
RCRSD ;ask debtor recall reason
"RTN","RCTCSPU",104,0)
 K DIR S DIR(0)="340,7.04" D ^DIR
"RTN","RCTCSPU",105,0)
 Q:(Y="")!(Y=U)
"RTN","RCTCSPU",106,0)
 ;set debtor recall data in file 340
"RTN","RCTCSPU",107,0)
 S REASON=Y
"RTN","RCTCSPU",108,0)
 S $P(^RCD(340,DEBTOR,7),U,2,4)="1^^"_REASON
"RTN","RCTCSPU",109,0)
 ;go through debtor bills and set reason in the bill recall reason
"RTN","RCTCSPU",110,0)
 S BILL=0
"RTN","RCTCSPU",111,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPU",112,0)
 .I $D(^PRCA(430,"TCSP",BILL)) D  Q  ;bill previously sent to TCSP
"RTN","RCTCSPU",113,0)
 ..S $P(^PRCA(430,BILL,15),U,4)=REASON ;set the recall reason
"RTN","RCTCSPU",114,0)
 ;
"RTN","RCTCSPU",115,0)
 W !,"Setting this debtor for Recall from Cross-Servicing is complete"
"RTN","RCTCSPU",116,0)
 G SETDQ
"RTN","RCTCSPU",117,0)
 ;
"RTN","RCTCSPU",118,0)
DELSETD ;Allows Cross-Servicing Recall to be deleted for debtor
"RTN","RCTCSPU",119,0)
 W !!,*7,"This debtor has already been set for recall from Cross-Servicing."
"RTN","RCTCSPU",120,0)
 S DIR(0)="Y",DIR("A")="Do you wish to delete the Cross-Servicing Recall for this debtor",DIR("B")="NO" D ^DIR G EDSETD:'Y
"RTN","RCTCSPU",121,0)
 ;
"RTN","RCTCSPU",122,0)
 ;delete the recall in file 340
"RTN","RCTCSPU",123,0)
 F I=2:1:4 S $P(^RCD(340,DEBTOR,7),U,I)=""
"RTN","RCTCSPU",124,0)
 ;go through debtor bills and delete the reason in the bill recall reason
"RTN","RCTCSPU",125,0)
 S BILL=0
"RTN","RCTCSPU",126,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTCSPU",127,0)
 .I $D(^PRCA(430,"TCSP",BILL)) D  Q  ;bill previously sent to TCSP
"RTN","RCTCSPU",128,0)
 ..S $P(^PRCA(430,BILL,15),U,4)="" ;delete the recall reason
"RTN","RCTCSPU",129,0)
 ;
"RTN","RCTCSPU",130,0)
 W !!,"Recall from Cross-Servicing has been deleted for this debtor."
"RTN","RCTCSPU",131,0)
 G SETDQ
"RTN","RCTCSPU",132,0)
 ;
"RTN","RCTCSPU",133,0)
EDSETD S DIR(0)="Y",DIR("A")="Do you wish to edit the Recall data for this debtor",DIR("B")="NO" D ^DIR G RCRSD:Y
"RTN","RCTCSPU",134,0)
SETDQ Q
"RTN","RCTCSPU",135,0)
 ;
"RTN","RCTCSPU",136,0)
DECADJ(RCBILLDA,RCTRANDA) ;decrease adjustment transaction history for 5b cross-servicing record
"RTN","RCTCSPU",137,0)
 ;rcbillda - file 430 bill ien
"RTN","RCTCSPU",138,0)
 ;rctranda - file 433 transaction ien
"RTN","RCTCSPU",139,0)
 N DIC,DA,DIE,DR,Y,X
"RTN","RCTCSPU",140,0)
 I '$D(RCBILLDA)!('$D(RCTRANDA)) Q
"RTN","RCTCSPU",141,0)
 S X=RCTRANDA
"RTN","RCTCSPU",142,0)
 S DIC="^PRCA(430,"_RCBILLDA_",17,",DIC(0)="L"
"RTN","RCTCSPU",143,0)
 I '$D(^PRCA(430,RCBILLDA,17,0)) S ^PRCA(430,RCBILLDA,17,0)="^430.0171PA^0^0"
"RTN","RCTCSPU",144,0)
 S DIC("P")=$P(^PRCA(430,RCBILLDA,17,0),"^",2)
"RTN","RCTCSPU",145,0)
 S DA(1)=RCBILLDA
"RTN","RCTCSPU",146,0)
 D ^DIC I Y=-1 K DIC,DA Q
"RTN","RCTCSPU",147,0)
 S DIE=DIC K DIC
"RTN","RCTCSPU",148,0)
 S DA=+Y
"RTN","RCTCSPU",149,0)
 S DR="1////1" D ^DIE
"RTN","RCTCSPU",150,0)
 Q
"RTN","RCTCSPU",151,0)
 ;
"RTN","RCTCSPU",152,0)
 ;Set Cross-Servicing recall for a case
"RTN","RCTCSPU",153,0)
RCLLSETC ;Set Cross-Servicing recall for a case
"RTN","RCTCSPU",154,0)
 N DIC,DIE,DA,DIR,Y,BILL,REASON
"RTN","RCTCSPU",155,0)
 S DIC=430,DIC(0)="AEQM" D ^DIC Q:Y<0
"RTN","RCTCSPU",156,0)
 S BILL=+Y
"RTN","RCTCSPU",157,0)
 I $P($G(^PRCA(430,BILL,15)),U,11) G DELSETC
"RTN","RCTCSPU",158,0)
 S DIR(0)="Y",DIR("B")="NO",DIR("A")="Are you sure you want to set this case to be recalled from Cross-Servicing" D ^DIR
"RTN","RCTCSPU",159,0)
 I 'Y W !,*7,"No action taken" Q
"RTN","RCTCSPU",160,0)
 I '$D(^PRCA(430,"TCSP",BILL)) W !,*7,"No action taken.  Case has not been referred to Cross-Servicing." Q
"RTN","RCTCSPU",161,0)
 ; 
"RTN","RCTCSPU",162,0)
RCRSC ;set case recall reason
"RTN","RCTCSPU",163,0)
 ;set recall data in file 430 for the bill and the case
"RTN","RCTCSPU",164,0)
 S REASON=15
"RTN","RCTCSPU",165,0)
 S $P(^PRCA(430,BILL,15),U,11,13)="1^^"_REASON
"RTN","RCTCSPU",166,0)
 S $P(^PRCA(430,BILL,15),U,2,4)="1^^"_REASON
"RTN","RCTCSPU",167,0)
 ;
"RTN","RCTCSPU",168,0)
 W !,"Setting this case for Recall from Cross-Servicing is complete"
"RTN","RCTCSPU",169,0)
 G SETCQ
"RTN","RCTCSPU",170,0)
 ;
"RTN","RCTCSPU",171,0)
DELSETC ;Allows Cross-Servicing Recall to be deleted for case
"RTN","RCTCSPU",172,0)
 W !!,*7,"This case has already been set for recall from Cross-Servicing."
"RTN","RCTCSPU",173,0)
 S DIR(0)="Y",DIR("A")="Do you wish to delete the Cross-Servicing Recall for this case",DIR("B")="NO" D ^DIR G SETCQ:'Y
"RTN","RCTCSPU",174,0)
 ;
"RTN","RCTCSPU",175,0)
 ;delete the case recall
"RTN","RCTCSPU",176,0)
 F I=11:1:13 S $P(^PRCA(430,BILL,15),U,I)=""
"RTN","RCTCSPU",177,0)
 F I=2:1:5 S $P(^PRCA(430,BILL,15),U,I)=""
"RTN","RCTCSPU",178,0)
 W !!,"Recall from Cross-Servicing has been deleted for this case."
"RTN","RCTCSPU",179,0)
 G SETCQ
"RTN","RCTCSPU",180,0)
 ;
"RTN","RCTCSPU",181,0)
SETCQ Q
"RTN","RCTCSPU",182,0)
 ;
"RTN","RCTOPD")
0^3^B70123756
"RTN","RCTOPD",1,0)
RCTOPD ;WASH IRMFO@ALTOONA,PA/TJK-TOP TRANSMISSION ;2/11/00 3:34 PM
"RTN","RCTOPD",2,0)
V ;;4.5;Accounts Receivable;**141,187,224,236,229,301**;Mar 20, 1995;Build 144
"RTN","RCTOPD",3,0)
 ;;Per VHA Directive 10-93-142, this routine should not be modified.
"RTN","RCTOPD",4,0)
ENTER ;Entry point from nightly process
"RTN","RCTOPD",5,0)
 Q:'$D(RCDOC)
"RTN","RCTOPD",6,0)
 N DEBTOR,BILL,DEBTOR0,B0,B6,B7,P181DT,PRIN,INT,ADMIN,B4,B14
"RTN","RCTOPD",7,0)
 N EFFDT,DFN,CNTR,SITE,LN,FN,MN,DOB,SITE,F60DT,VADM
"RTN","RCTOPD",8,0)
 N PHONE,QUIT,TOTAL,ZIPCODE,FULLNM,RCNT,REPAY,X1,X2
"RTN","RCTOPD",9,0)
 N ERROR,ADDR,CAT,BILLDT,P10YDT,CURRTOT,HOLD,SITECD,RCNEW,ACTDT
"RTN","RCTOPD",10,0)
 ;
"RTN","RCTOPD",11,0)
 ;initialize temporary global, variables
"RTN","RCTOPD",12,0)
 ;
"RTN","RCTOPD",13,0)
 K ^XTMP("RCTOPD") S ^XTMP("RCTOPD",0)=DT_U_DT
"RTN","RCTOPD",14,0)
 S SITE=$E($$SITE^RCMSITE(),1,3),SITECD=$P(^RC(342,1,3),U,5)
"RTN","RCTOPD",15,0)
 S X1=DT,X2=-181 D C^%DTC S (P181DT,EFFDT)=X
"RTN","RCTOPD",16,0)
 S X1=DT,X2=-3650 D C^%DTC S P10YDT=X
"RTN","RCTOPD",17,0)
 S X1=DT,X2=+60 D C^%DTC S F60DT=X
"RTN","RCTOPD",18,0)
 S ACTDT=3150801 ;activation date for all sites except beckley, little rock, upstate ny 
"RTN","RCTOPD",19,0)
 S:SITE=598 ACTDT=3150201 ;activation date for little rock
"RTN","RCTOPD",20,0)
 S:SITE=517 ACTDT=3150201 ;activation date for beckley
"RTN","RCTOPD",21,0)
 S:SITE=528 ACTDT=3150201 ;activation date for upstate ny
"RTN","RCTOPD",22,0)
 S (CNTR(1),CNTR(2),CNTR(4),DEBTOR,RCNT)=0
"RTN","RCTOPD",23,0)
 ;
"RTN","RCTOPD",24,0)
 ;branch if recertification document
"RTN","RCTOPD",25,0)
 I RCDOC="Y" D RECERT G EXIT
"RTN","RCTOPD",26,0)
 ;
"RTN","RCTOPD",27,0)
 ;branch to do update documents
"RTN","RCTOPD",28,0)
 D UPDATE I RCDOC="U" G EXIT
"RTN","RCTOPD",29,0)
 ;
"RTN","RCTOPD",30,0)
 ;master sheet compilation
"RTN","RCTOPD",31,0)
 ;
"RTN","RCTOPD",32,0)
 F  S DEBTOR=$O(^PRCA(430,"C",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTOPD",33,0)
 .N X,RCDFN
"RTN","RCTOPD",34,0)
 .S RCDFN=$G(^RCD(340,DEBTOR,0))
"RTN","RCTOPD",35,0)
 .I $P(RCDFN,";",2)["DPT",$$EMERES^PRCAUTL(+RCDFN)]"" Q  ;stop the master sheet compilation for hurricane Katrina sites (patients)
"RTN","RCTOPD",36,0)
    .Q:$D(^RCD(340,"TOP",DEBTOR))
"RTN","RCTOPD",37,0)
    .; quit if debtor address marked unknown
"RTN","RCTOPD",38,0)
    .Q:$P($G(^RCD(340,+DEBTOR,1)),"^",9)=1
"RTN","RCTOPD",39,0)
    .S DEBTOR6=$G(^RCD(340,DEBTOR,6)),DEBTOR0=$G(^(0)),HOLD=0,RCNEW=1
"RTN","RCTOPD",40,0)
    .I $P(DEBTOR6,U,2),'$P(DEBTOR6,U,3) Q
"RTN","RCTOPD",41,0)
    .S QUIT=1,FILE=$$FILE(DEBTOR0) Q:'FILE
"RTN","RCTOPD",42,0)
    .S EFFDT=P181DT
"RTN","RCTOPD",43,0)
    .D PROC(DEBTOR,.QUIT,FILE,.HOLD,.EFFDT) Q:QUIT
"RTN","RCTOPD",44,0)
    .D EN1^RCTOP2(DEBTOR,"M",FILE)
"RTN","RCTOPD",45,0)
    .D EN1^RCTOP1(DEBTOR,TOTAL,"M",EFFDT,0,FILE)
"RTN","RCTOPD",46,0)
    .;set hold date in file for employee, ex-employee, vendor records
"RTN","RCTOPD",47,0)
    .;Austin holds these for 60 days before transmitting to TOP
"RTN","RCTOPD",48,0)
    .I $G(HOLD) S $P(^RCD(340,DEBTOR,6),U,6)=F60DT
"RTN","RCTOPD",49,0)
    .Q
"RTN","RCTOPD",50,0)
 ;compile documents into mail messages--sets referral date in 430
"RTN","RCTOPD",51,0)
 D COMPILE
"RTN","RCTOPD",52,0)
EXIT K RCDOC,^XTMP("RCTOPD"),^TMP("RCTOPD"),XMDUZ D KVAR^VADPT
"RTN","RCTOPD",53,0)
 Q
"RTN","RCTOPD",54,0)
 ;
"RTN","RCTOPD",55,0)
UPDATE ;weekly update compilation
"RTN","RCTOPD",56,0)
 F  S DEBTOR=$O(^RCD(340,"TOP",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTOPD",57,0)
    .S QUIT=1,DEBTOR0=^RCD(340,DEBTOR,0),DEBTOR6=^(6),DEBTOR4=^(4),FILE=$$FILE(DEBTOR0),EFFDT=$P(DEBTOR4,U,6),RCNEW=0
"RTN","RCTOPD",58,0)
    .D EN1^RCTOP2(DEBTOR,"U",FILE)
"RTN","RCTOPD",59,0)
    .D PROC(DEBTOR,.QUIT,FILE,0,.EFFDT) I QUIT D  Q
"RTN","RCTOPD",60,0)
       ..;process type 4 document if necessary
"RTN","RCTOPD",61,0)
       ..S TAXID=$$TAXID^RCTOP1(DEBTOR,FILE),OTAXID=$P(DEBTOR4,U)
"RTN","RCTOPD",62,0)
       ..S NAME=$$NAME^RCTOP1(+DEBTOR0,FILE),ONAME=$P(DEBTOR4,U,2),NAME=$P(NAME,U)
"RTN","RCTOPD",63,0)
       ..I NAME=ONAME,TAXID=OTAXID Q
"RTN","RCTOPD",64,0)
       ..D EN1^RCTOP4(NAME,TAXID,DEBTOR4,DEBTOR,FILE)
"RTN","RCTOPD",65,0)
       ..Q
"RTN","RCTOPD",66,0)
    .D EN1^RCTOP1(DEBTOR,TOTAL,"U",EFFDT,0,FILE)
"RTN","RCTOPD",67,0)
    .Q
"RTN","RCTOPD",68,0)
 ;refund/refund reversal documents
"RTN","RCTOPD",69,0)
 D REFDOC
"RTN","RCTOPD",70,0)
 ;compile documents into mail messages--sets referral date in 430
"RTN","RCTOPD",71,0)
 D:$G(RCDOC)="U" COMPILE
"RTN","RCTOPD",72,0)
 Q
"RTN","RCTOPD",73,0)
 ;
"RTN","RCTOPD",74,0)
RECERT ;send yearly recertification documents
"RTN","RCTOPD",75,0)
 F  S DEBTOR=$O(^RCD(340,"TOP",DEBTOR)) Q:DEBTOR'?1N.N  D
"RTN","RCTOPD",76,0)
    .S DEBTOR4=$G(^RCD(340,DEBTOR,4)),TOTAL=$P(DEBTOR4,U,3),EFFDT=$P(DEBTOR4,U,6),DEBTOR0=$G(^(0)),FILE=$$FILE(DEBTOR0)
"RTN","RCTOPD",77,0)
    .I TOTAL D EN1^RCTOP1(DEBTOR,TOTAL,"Y",EFFDT,0,FILE)
"RTN","RCTOPD",78,0)
    .Q
"RTN","RCTOPD",79,0)
 ;compile documents into mail messages
"RTN","RCTOPD",80,0)
 D COMPILE
"RTN","RCTOPD",81,0)
 Q
"RTN","RCTOPD",82,0)
 ;
"RTN","RCTOPD",83,0)
REFDOC ; refund, refund reversal documents
"RTN","RCTOPD",84,0)
 N CODE,BILL,DEBTOR,TOTAL,EFFDT,FILE,RFCODE
"RTN","RCTOPD",85,0)
 F RFCODE=1,3 S CODE=$S(RFCODE=1:"R",1:"RV") D
"RTN","RCTOPD",86,0)
    .S BILL=0 F  S BILL=$O(^PRCA(430,"TREF",RFCODE,BILL)) Q:'BILL  D
"RTN","RCTOPD",87,0)
       ..S DEBTOR=$P($G(^PRCA(430,BILL,0)),U,9) Q:'DEBTOR
"RTN","RCTOPD",88,0)
       ..S TOTAL=$P($G(^(7)),U,18) Q:'TOTAL  ;NAKED TO LINE ABOVE
"RTN","RCTOPD",89,0)
       ..S EFFDT=$P($G(^RCD(340,+DEBTOR,4)),U,6),FILE=$$FILE(^(0))
"RTN","RCTOPD",90,0)
       ..D EN1^RCTOP1(DEBTOR,TOTAL,CODE,EFFDT,BILL,FILE)
"RTN","RCTOPD",91,0)
      ..Q
"RTN","RCTOPD",92,0)
    .Q
"RTN","RCTOPD",93,0)
 Q
"RTN","RCTOPD",94,0)
 ;
"RTN","RCTOPD",95,0)
COMPILE ;compiles documents into mail messages and transmits them
"RTN","RCTOPD",96,0)
 ;builds message array
"RTN","RCTOPD",97,0)
 N CNT,SEQ,REC,XMDUZ,DOCTYPE,LRTYPE,XMSUB,XMTEXT,XMY,TSEQ,DOCAMT
"RTN","RCTOPD",98,0)
 S (SEQ,TSEQ)=0
"RTN","RCTOPD",99,0)
 F I=1,2,4 S TSEQ=TSEQ+($G(CNTR(I))\150)+$S($G(CNTR(I))#150:1,1:0)
"RTN","RCTOPD",100,0)
 F DOCTYPE=1,2,4 D:$D(^XTMP("RCTOPD",$J,DOCTYPE)) COMPILE1(DOCTYPE,CNTR(DOCTYPE))
"RTN","RCTOPD",101,0)
 D USRMSG
"RTN","RCTOPD",102,0)
 Q
"RTN","RCTOPD",103,0)
COMPILE1(DOCTYPE,CNTR) ; compiles each type of document separately
"RTN","RCTOPD",104,0)
 S RCNT=RCNT+CNTR
"RTN","RCTOPD",105,0)
 I '$G(LRTYPE) F I=1,2,4 S:$D(^XTMP("RCTOPD",$J,I)) LRTYPE=I
"RTN","RCTOPD",106,0)
 F CNT=1:1:CNTR D
"RTN","RCTOPD",107,0)
    .D:CNT#150=1
"RTN","RCTOPD",108,0)
       ..K ^XTMP("RCTOPD",$J,"BUILD") S SEQ=SEQ+1
"RTN","RCTOPD",109,0)
       ..S REC=1,DOCAMT=0
"RTN","RCTOPD",110,0)
       ..Q
"RTN","RCTOPD",111,0)
    .S REC=REC+1,^XTMP("RCTOPD",$J,"BUILD",REC)=^XTMP("RCTOPD",$J,DOCTYPE,CNT)_U S:DOCTYPE=1 DOCAMT=DOCAMT+($E(^(REC),135,146)/100)
"RTN","RCTOPD",112,0)
    .I CNTR=CNT,LRTYPE=DOCTYPE S ^XTMP("RCTOPD",$J,"BUILD",REC+1)="END OF TRANSMISSION FOR SITE# "_SITE_":  TOTAL RECORDS: "_RCNT
"RTN","RCTOPD",113,0)
    .I $S(CNTR=CNT:1,CNT#150=0:1,1:0) D
"RTN","RCTOPD",114,0)
       ..S ^XTMP("RCTOPD",$J,"BUILD",1)=SITE_U_$TR($J(SEQ,2)," ",0)_U_$TR($J(TSEQ,2)," ",0)_U_(REC-1)_U_DOCAMT_U
"RTN","RCTOPD",115,0)
       ..S XMDUZ="AR PACKAGE"
"RTN","RCTOPD",116,0)
       ..S XMY("XXX@Q-TOP.domain.ext")=""
"RTN","RCTOPD",117,0)
       ..S XMY("G.TOP")=""
"RTN","RCTOPD",118,0)
       ..S XMSUB=SITE_"/TOP TRANSMISSION/SEQ#: "_SEQ_"/"_$$NOW()
"RTN","RCTOPD",119,0)
       ..S XMTEXT="^XTMP(""RCTOPD"","_$J_",""BUILD"","
"RTN","RCTOPD",120,0)
       ..D ^XMD
"RTN","RCTOPD",121,0)
       ..Q
"RTN","RCTOPD",122,0)
    .Q
"RTN","RCTOPD",123,0)
 Q
"RTN","RCTOPD",124,0)
 ;
"RTN","RCTOPD",125,0)
USRMSG ;sends mailman message of documents sent to user
"RTN","RCTOPD",126,0)
 N XMY,XMDUZ,XMSUB,X,RCNT
"RTN","RCTOPD",127,0)
 S XMDUZ="AR PACKAGE",XMY("G.TOP")=""
"RTN","RCTOPD",128,0)
 S XMSUB="TOP "_$S(RCDOC="M":"MASTER/UPDATE",RCDOC="U":"UPDATE",1:"RECERTIFICATION")_" RECORDS SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTOPD",129,0)
 S ^XTMP("RCTOPD",$J,"REC1",1)="Name                             TIN        TYPE       AMOUNT"
"RTN","RCTOPD",130,0)
 S ^XTMP("RCTOPD",$J,"REC1",2)="----                             ---        ----       ------"
"RTN","RCTOPD",131,0)
 S X="",RCNT=3 F  S X=$O(^XTMP("RCTOPD",$J,"REC",X)) Q:X=""  S ^XTMP("RCTOPD",$J,"REC1",RCNT)=^(X),RCNT=RCNT+1
"RTN","RCTOPD",132,0)
 S ^XTMP("RCTOPD",$J,"REC1",RCNT)="Total Records: "_(RCNT-3)
"RTN","RCTOPD",133,0)
 S XMTEXT="^XTMP(""RCTOPD"","_$J_",""REC1"","
"RTN","RCTOPD",134,0)
 D ^XMD
"RTN","RCTOPD",135,0)
 ;
"RTN","RCTOPD",136,0)
THIRD ;sends mailman message to user if no third letter found
"RTN","RCTOPD",137,0)
 Q:'$D(^XTMP("RCTOPD",$J,"THIRD"))
"RTN","RCTOPD",138,0)
 K ^XTMP("RCTOPD",$J,"REC1")
"RTN","RCTOPD",139,0)
 S XMDUZ="AR PACKAGE",XMY("G.TOP")=""
"RTN","RCTOPD",140,0)
 N TCT,TDEB,TDEB0,TBIL,TSP,FST
"RTN","RCTOPD",141,0)
 S XMSUB="TOP QUALIFIED/NO 3RD LETTER SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTOPD",142,0)
 S ^XTMP("RCTOPD",$J,"REC1",1)="The following list of debtor bills were not sent to TOP."
"RTN","RCTOPD",143,0)
 S ^XTMP("RCTOPD",$J,"REC1",2)="Please review debtor's account to determine why the third"
"RTN","RCTOPD",144,0)
        S ^XTMP("RCTOPD",$J,"REC1",3)="notice letter has not been sent:"
"RTN","RCTOPD",145,0)
 S ^XTMP("RCTOPD",$J,"REC1",4)="Name                               Bill #"
"RTN","RCTOPD",146,0)
 S ^XTMP("RCTOPD",$J,"REC1",5)="----                               ------"
"RTN","RCTOPD",147,0)
 S TCT=6,TSP=0,TDEB=""
"RTN","RCTOPD",148,0)
 F  S TDEB=$O(^XTMP("RCTOPD",$J,"THIRD",TDEB)) Q:TDEB=""  D
"RTN","RCTOPD",149,0)
 .S FST=1,TBIL=""
"RTN","RCTOPD",150,0)
 .I FST,TCT'=6 S ^XTMP("RCTOPD",$J,"REC1",TCT)="",TCT=TCT+1,TSP=TSP+1
"RTN","RCTOPD",151,0)
 .F  S TBIL=$O(^XTMP("RCTOPD",$J,"THIRD",TDEB,TBIL)) Q:TBIL=""  D
"RTN","RCTOPD",152,0)
 ..S TDEB0=$S(FST:TDEB,1:"")
"RTN","RCTOPD",153,0)
 ..S ^XTMP("RCTOPD",$J,"REC1",TCT)=TDEB0_$J(" ",35-$L(TDEB0))_TBIL
"RTN","RCTOPD",154,0)
 ..S TCT=TCT+1,FST=0
"RTN","RCTOPD",155,0)
 S ^XTMP("RCTOPD",$J,"REC1",TCT)="Total records: "_(TCT-(6+TSP))
"RTN","RCTOPD",156,0)
 S XMTEXT="^XTMP(""RCTOPD"","_$J_",""REC1"","
"RTN","RCTOPD",157,0)
 D ^XMD
"RTN","RCTOPD",158,0)
COMPQ Q
"RTN","RCTOPD",159,0)
 ;
"RTN","RCTOPD",160,0)
PROC(DEBTOR,QUIT,FILE,HOLD,EFFDT) ;process bills for a specific debtor
"RTN","RCTOPD",161,0)
 K ^TMP("RCTOPD",$J,"BILL")
"RTN","RCTOPD",162,0)
 S DEBTOR0=$G(^RCD(340,DEBTOR,0))
"RTN","RCTOPD",163,0)
 Q:'FILE
"RTN","RCTOPD",164,0)
 I FILE=2 S DFN=+DEBTOR0 D DEM^VADPT Q:$E(VADM(2),1,5)="00000"
"RTN","RCTOPD",165,0)
 S (BILL,TOTAL,REPAY)=0
"RTN","RCTOPD",166,0)
 I RCNEW,FILE=440 S HOLD=1
"RTN","RCTOPD",167,0)
 I 'RCNEW,$P(^RCD(340,DEBTOR,6),U,2),'$P(^(6),U,3) G TOTAL
"RTN","RCTOPD",168,0)
 I RCNEW,$D(^RCD(340,"DMC",1,DEBTOR)) G TOTAL
"RTN","RCTOPD",169,0)
 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:BILL'?1N.N  D
"RTN","RCTOPD",170,0)
    .I FILE=2,+VADM(6) S TOTAL=0,REPAY=1 Q
"RTN","RCTOPD",171,0)
    .S B0=$G(^PRCA(430,BILL,0)),B4=$G(^(4)),B6=$G(^(6)),B7=$G(^(7)),B14=$G(^(14))
"RTN","RCTOPD",172,0)
    .Q:$P(B0,U,8)'=16
"RTN","RCTOPD",173,0)
    .Q:B4
"RTN","RCTOPD",174,0)
    .Q:'$P(B0,U,2)  S CAT=$P($G(^PRCA(430.2,$P(B0,U,2),0)),U,7)
"RTN","RCTOPD",175,0)
    .Q:'CAT  I ",16,17,21,22,23,26,27,33,"[(","_CAT_",") Q
"RTN","RCTOPD",176,0)
    .Q:$D(^PRCA(430,"TCSP",BILL))  ;cross-serviced bills
"RTN","RCTOPD",177,0)
    .I '+B14,($P(B6,U,21)'<ACTDT) I ",1,2,3,24,29,30,31,32,40,41,42,43,44,45,46,"[(","_CAT_",") Q  ;prca*4.5*301 cs activation date and 1st party bill
"RTN","RCTOPD",178,0)
    .;check for DOJ referral here
"RTN","RCTOPD",179,0)
    .I $P(B6,U,4),($P(B6,U,5)="DOJ") Q
"RTN","RCTOPD",180,0)
    .S BILLDT=$P(B6,U,21) I (BILLDT<P10YDT)!(BILLDT>P181DT)!(BILLDT<$P(DEBTOR6,U,3)) Q
"RTN","RCTOPD",181,0)
    .I '$P(B6,U,3) D  Q
"RTN","RCTOPD",182,0)
    ..;no 3rd letter being sent 
"RTN","RCTOPD",183,0)
    ..N TDEB,TFIL
"RTN","RCTOPD",184,0)
    ..S TDEB=$G(^RCD(340,DEBTOR,0)),TFIL=$$FILE(TDEB),TDEB=$$NAME^RCTOP1(+TDEB,TFIL),TDEB=$P(TDEB,U,2),^XTMP("RCTOPD",$J,"THIRD",TDEB,$P(B0,U))=""
"RTN","RCTOPD",185,0)
    .I RCNEW,CAT>12,CAT<15 S HOLD=1
"RTN","RCTOPD",186,0)
    .I BILLDT,BILLDT<EFFDT S EFFDT=BILLDT
"RTN","RCTOPD",187,0)
    .S TOTAL=TOTAL+$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTOPD",188,0)
    .S ^TMP("RCTOPD",$J,"BILL",BILL)=""
"RTN","RCTOPD",189,0)
    .Q
"RTN","RCTOPD",190,0)
 ;
"RTN","RCTOPD",191,0)
TOTAL ;set transmission total, reset quit variable
"RTN","RCTOPD",192,0)
 N RCSWINFO S RCSWINFO=$$SWSTAT^IBBAPI()                  ;PRCA*4.5*229
"RTN","RCTOPD",193,0)
 I RCNEW,'+RCSWINFO Q:TOTAL<25                            ;PRCA*4.5*229
"RTN","RCTOPD",194,0)
 I RCNEW,+RCSWINFO Q:TOTAL'>0                             ;PRCA*4.5*229
"RTN","RCTOPD",195,0)
 ;
"RTN","RCTOPD",196,0)
 I 'RCNEW S:TOTAL<25 TOTAL=0  S CURRTOT=$P($G(^RCD(340,DEBTOR,4)),U,3) Q:CURRTOT=TOTAL  S TOTAL=TOTAL-CURRTOT
"RTN","RCTOPD",197,0)
 S QUIT=0
"RTN","RCTOPD",198,0)
PROCQ Q
"RTN","RCTOPD",199,0)
 ;
"RTN","RCTOPD",200,0)
NOW() ;compiles current date,time
"RTN","RCTOPD",201,0)
 N X,Y,%,%H
"RTN","RCTOPD",202,0)
 S %H=$H D YX^%DTC
"RTN","RCTOPD",203,0)
 Q Y
"RTN","RCTOPD",204,0)
 ;
"RTN","RCTOPD",205,0)
FILE(DEBTOR0) ;gets file number for debtor
"RTN","RCTOPD",206,0)
 S FILE=$P($P(DEBTOR0,U),";",2)
"RTN","RCTOPD",207,0)
 S FILE=$S(FILE["DPT(":2,FILE["PRC(440":440,FILE["VA(200":200,1:0)
"RTN","RCTOPD",208,0)
FILEQ Q FILE
"RTN","RCWROFF")
0^50^B38468960
"RTN","RCWROFF",1,0)
RCWROFF ;WISC/RFJ-write off, terminated ;1 Feb 2000
"RTN","RCWROFF",2,0)
 ;;4.5;Accounts Receivable;**168,204,309,301**;Mar 20, 1995;Build 144
"RTN","RCWROFF",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCWROFF",4,0)
 Q
"RTN","RCWROFF",5,0)
 ;
"RTN","RCWROFF",6,0)
 ;
"RTN","RCWROFF",7,0)
8 ;  terminated by fiscal officer (trantype=8) (menu option)
"RTN","RCWROFF",8,0)
 N RCDRSTRG
"RTN","RCWROFF",9,0)
 S RCDRSTRG="11TERMINATION DATE;"
"RTN","RCWROFF",10,0)
 S RCDRSTRG=RCDRSTRG_"17;"  ;termination reason
"RTN","RCWROFF",11,0)
 D MAIN("8^Fiscal Officer Termination",RCDRSTRG)
"RTN","RCWROFF",12,0)
 Q
"RTN","RCWROFF",13,0)
 ;
"RTN","RCWROFF",14,0)
 ;
"RTN","RCWROFF",15,0)
9 ;  terminated by compromise (trantype=9) (menu option)
"RTN","RCWROFF",16,0)
 N RCDRSTRG
"RTN","RCWROFF",17,0)
 S RCDRSTRG="11TERMINATION DATE;"
"RTN","RCWROFF",18,0)
 S RCDRSTRG=RCDRSTRG_"17;"  ;termination reason
"RTN","RCWROFF",19,0)
 D MAIN("9^Compromise Termination",RCDRSTRG)
"RTN","RCWROFF",20,0)
 Q
"RTN","RCWROFF",21,0)
 ;
"RTN","RCWROFF",22,0)
 ;
"RTN","RCWROFF",23,0)
A9 ;  compromised by rc/doj (use trantype=9) (menu option)
"RTN","RCWROFF",24,0)
 N RCDRSTRG
"RTN","RCWROFF",25,0)
 S RCDRSTRG="11TERMINATION DATE;"
"RTN","RCWROFF",26,0)
 S RCDRSTRG=RCDRSTRG_"17;"  ;termination reason
"RTN","RCWROFF",27,0)
 D MAIN("9^Compromise Termination by RC/DOJ",RCDRSTRG)
"RTN","RCWROFF",28,0)
 Q
"RTN","RCWROFF",29,0)
 ;
"RTN","RCWROFF",30,0)
 ;
"RTN","RCWROFF",31,0)
10 ;  waived in full transaction (trantype=10) (menu option)
"RTN","RCWROFF",32,0)
 D MAIN("10^Waiver","11WAIVED DATE;")
"RTN","RCWROFF",33,0)
 Q
"RTN","RCWROFF",34,0)
 ;
"RTN","RCWROFF",35,0)
 ;
"RTN","RCWROFF",36,0)
A10 ;  waived by rc/doj (use trantype=10) (menu option)
"RTN","RCWROFF",37,0)
 D MAIN("10^RC/DOJ Waiver","11WAIVED DATE;")
"RTN","RCWROFF",38,0)
 Q
"RTN","RCWROFF",39,0)
 ;
"RTN","RCWROFF",40,0)
 ;
"RTN","RCWROFF",41,0)
29 ;  terminated by rc/doj (trantype=29) (menu option)
"RTN","RCWROFF",42,0)
 N RCDRSTRG
"RTN","RCWROFF",43,0)
 S RCDRSTRG="11TERMINATION DATE;"
"RTN","RCWROFF",44,0)
 S RCDRSTRG=RCDRSTRG_"17;"  ;termination reason
"RTN","RCWROFF",45,0)
 D MAIN("29^RC/DOJ Termination",RCDRSTRG)
"RTN","RCWROFF",46,0)
 Q
"RTN","RCWROFF",47,0)
 ;
"RTN","RCWROFF",48,0)
 ;
"RTN","RCWROFF",49,0)
47 ;  suspended (trantype=47) (menu option)
"RTN","RCWROFF",50,0)
 N RCDRSTRG
"RTN","RCWROFF",51,0)
 S RCDRSTRG="11SUSPENDED DATE;"
"RTN","RCWROFF",52,0)
 S RCDRSTRG=RCDRSTRG_"90R;"  ;suspension type
"RTN","RCWROFF",53,0)
 S RCDRSTRG=RCDRSTRG_"S RCX=$$SUSTP^RCWROFF(X);"
"RTN","RCWROFF",54,0)
 S RCDRSTRG=RCDRSTRG_"5.02////^S X=RCX;"  ;brief comment
"RTN","RCWROFF",55,0)
 S RCDRSTRG=RCDRSTRG_"K RCX;"
"RTN","RCWROFF",56,0)
 D MAIN("47^Suspension",RCDRSTRG)
"RTN","RCWROFF",57,0)
 Q
"RTN","RCWROFF",58,0)
 ;
"RTN","RCWROFF",59,0)
SUSTP(X) ; suspension types for brief comment in *309
"RTN","RCWROFF",60,0)
 ; input-code between 0 to 11
"RTN","RCWROFF",61,0)
 ; output-text
"RTN","RCWROFF",62,0)
 N IBX
"RTN","RCWROFF",63,0)
 S IBX=$P($T(SUSTX+X),";;",2)
"RTN","RCWROFF",64,0)
 Q IBX
"RTN","RCWROFF",65,0)
 ;
"RTN","RCWROFF",66,0)
SUSTX ;;NOT CO-PAY SUSPENSION
"RTN","RCWROFF",67,0)
 ;;INITIAL CO-PAY WAIVER
"RTN","RCWROFF",68,0)
 ;;APPEAL CO-PAY WAIVER
"RTN","RCWROFF",69,0)
 ;;ADMINISTRATIVE SUSPENSION
"RTN","RCWROFF",70,0)
 ;;COMPROMISE
"RTN","RCWROFF",71,0)
 ;;TERMINATION
"RTN","RCWROFF",72,0)
 ;;BANKRUPTCY CHAP 7
"RTN","RCWROFF",73,0)
 ;;BANKRUPTCY CHAP 13
"RTN","RCWROFF",74,0)
 ;;BANKRUPTCY OTHER
"RTN","RCWROFF",75,0)
 ;;PROBATE
"RTN","RCWROFF",76,0)
 ;;CHOICE
"RTN","RCWROFF",77,0)
 ;;DISPUTE
"RTN","RCWROFF",78,0)
 ;
"RTN","RCWROFF",79,0)
 ;
"RTN","RCWROFF",80,0)
MAIN(RCTRTYPE,RCDRSTRG) ;  main subroutine to process a waiver, termination, suspended transaction
"RTN","RCWROFF",81,0)
 ;  rctrtype = transaction type^description, example 10^waiver
"RTN","RCWROFF",82,0)
 ;  rcdrstrg = dr string used when calling die
"RTN","RCWROFF",83,0)
 N BALANCE,DR,RCBILLDA,RCTRANDA,Y
"RTN","RCWROFF",84,0)
 F  D  Q:RCBILLDA<1
"RTN","RCWROFF",85,0)
 .   K RCTRANDA  ;do not leave around in for loop
"RTN","RCWROFF",86,0)
 .   ;  select a bill
"RTN","RCWROFF",87,0)
 .   S RCBILLDA=$$GETABILL^RCBEUBIL I RCBILLDA<1 Q
"RTN","RCWROFF",88,0)
 .   I $D(^PRCA(430,"TCSP",RCBILLDA)) W !,"BILL HAS BEEN REFERRED TO CROSS-SERVICING.",!,"NO TRANSACTIONS ARE ALLOWED." D  Q  ;prca*4.5*301
"RTN","RCWROFF",89,0)
 . .  I +RCTRTYPE=10!(+RCTRTYPE=47)!(+RCTRTYPE=9)!(+RCTRTYPE=8) W !,"** THE RECALL PROCESS MUST BE UTILIZED PRIOR TO PERFORMING THIS FUNCTION **"   ;prca*4.5*301  
"RTN","RCWROFF",90,0)
 .   ;  check to see if bill has been referred to rc/doj (6;4 = referral date)
"RTN","RCWROFF",91,0)
 .   I $P(RCTRTYPE,"^",2)["RC/DOJ",$P($G(^PRCA(430,RCBILLDA,6)),"^",4)="" W !,"THIS ACCOUNT IS NOT REFERRED TO RC/DOJ." Q
"RTN","RCWROFF",92,0)
 .   ;  lock the bill
"RTN","RCWROFF",93,0)
 .   L +^PRCA(430,RCBILLDA):5 I '$T W !,"ANOTHER USER IS CURRENTLY WORKING WITH THIS BILL." Q
"RTN","RCWROFF",94,0)
 .   D SHOWBILL^RCWROFF1(RCBILLDA)
"RTN","RCWROFF",95,0)
 .   I '$G(^PRCA(430,RCBILLDA,7)) W !,"THIS BILL HAS NO PRINCIPAL BALANCE." D UNLOCK Q
"RTN","RCWROFF",96,0)
 .   ;  ask to enter transaction
"RTN","RCWROFF",97,0)
 .   S Y=$$ASKOK($P(RCTRTYPE,"^",2)) I Y'=1 D UNLOCK S:Y<0 RCBILLDA=0 Q
"RTN","RCWROFF",98,0)
 .   ;  add a new transaction to file 433
"RTN","RCWROFF",99,0)
 .   S RCTRANDA=$$ADD433^RCBEUTRA(RCBILLDA,$P(RCTRTYPE,"^")) I 'RCTRANDA W !,$P(RCTRANDA,"^",2) D UNLOCK Q
"RTN","RCWROFF",100,0)
 .   W !,"  Transaction number ",RCTRANDA," added ..."
"RTN","RCWROFF",101,0)
 .   ;
"RTN","RCWROFF",102,0)
 .   ;  set up dr string for die call
"RTN","RCWROFF",103,0)
 .   S DR=RCDRSTRG_"41;"  ;comment
"RTN","RCWROFF",104,0)
 .   ;  bill amount moved to transaction amount
"RTN","RCWROFF",105,0)
 .   S BALANCE=$P($G(^PRCA(430,RCBILLDA,7)),"^",1,5)
"RTN","RCWROFF",106,0)
 .   S DR=DR_"15////"_($P(BALANCE,"^")+$P(BALANCE,"^",2)+$P(BALANCE,"^",3)+$P(BALANCE,"^",4)+$P(BALANCE,"^",5))_";"
"RTN","RCWROFF",107,0)
 .   I $P(BALANCE,"^",1) S DR=DR_"81////"_+$P(BALANCE,"^",1)_";"   ;principal
"RTN","RCWROFF",108,0)
 .   I $P(BALANCE,"^",2) S DR=DR_"82////"_+$P(BALANCE,"^",2)_";"   ;interest
"RTN","RCWROFF",109,0)
 .   I $P(BALANCE,"^",3) S DR=DR_"83////"_+$P(BALANCE,"^",3)_";"   ;admin
"RTN","RCWROFF",110,0)
 .   I $P(BALANCE,"^",4) S DR=DR_"84////"_+$P(BALANCE,"^",4)_";"   ;marshal fee
"RTN","RCWROFF",111,0)
 .   I $P(BALANCE,"^",5) S DR=DR_"85////"_+$P(BALANCE,"^",5)_";"   ;court cost
"RTN","RCWROFF",112,0)
 .   ;
"RTN","RCWROFF",113,0)
 .   ;  edit the fields
"RTN","RCWROFF",114,0)
 .   S Y=$$EDIT433^RCBEUTRA(RCTRANDA,DR)
"RTN","RCWROFF",115,0)
 .   I 'Y W !,$P(Y,"^",2) D DEL433^RCBEUTRA(RCTRANDA,"",0),UNLOCK Q
"RTN","RCWROFF",116,0)
 .   ;  set the bill and transaction as RC/DOJ
"RTN","RCWROFF",117,0)
 .   I $P(RCTRTYPE,"^",2)["RC/DOJ" D SETRCDOJ^RCBEUBIL(RCBILLDA,RCTRANDA,"RC")
"RTN","RCWROFF",118,0)
 .   ;  change the status of the bill
"RTN","RCWROFF",119,0)
 .   I $P(RCTRTYPE,"^")'=47 D CHGSTAT^RCBEUBIL(RCBILLDA,23)  ;write off
"RTN","RCWROFF",120,0)
 .   I $P(RCTRTYPE,"^")=47 D CHGSTAT^RCBEUBIL(RCBILLDA,40)   ;suspended
"RTN","RCWROFF",121,0)
 .   ;  mark transaction as processed
"RTN","RCWROFF",122,0)
 .   D PROCESS^RCBEUTRA(RCTRANDA)
"RTN","RCWROFF",123,0)
 .   ;
"RTN","RCWROFF",124,0)
 .   ;  create fms write off document, if not accrued and not suspended (47) transaction
"RTN","RCWROFF",125,0)
 .   I '$$ACCK^PRCAACC(RCBILLDA),$P($G(^PRCA(433,RCTRANDA,1)),"^",2)'=47 D FMSDOC(RCTRANDA)
"RTN","RCWROFF",126,0)
 .   ;
"RTN","RCWROFF",127,0)
 .   W !,"  * * * * * ",$P(RCTRTYPE,"^",2)," has been PROCESSED! * * * * *"
"RTN","RCWROFF",128,0)
 .   I '$G(REFMS)&(DT>$$LDATE^RCRJR(DT)) S Y=$E($$FPS^RCAMFN01(DT,1),1,5)_"01" D DD^%DT W !!,"   * * * * Transmission will be held until "_Y_" * * * *"
"RTN","RCWROFF",129,0)
 .   D UNLOCK
"RTN","RCWROFF",130,0)
 Q
"RTN","RCWROFF",131,0)
 ;
"RTN","RCWROFF",132,0)
 ;
"RTN","RCWROFF",133,0)
FMSDOC(RCTRANDA) ;  create fms write off document
"RTN","RCWROFF",134,0)
 N Y
"RTN","RCWROFF",135,0)
 W !!,"Creating FMS Write-off document ... "
"RTN","RCWROFF",136,0)
 S Y=$$BUILDWR^RCXFMSW1(RCTRANDA)
"RTN","RCWROFF",137,0)
 I Y W $P(Y,"^",2)," created."
"RTN","RCWROFF",138,0)
 E  W "ERROR: ",$P(Y,"^",2)
"RTN","RCWROFF",139,0)
 Q
"RTN","RCWROFF",140,0)
 ;
"RTN","RCWROFF",141,0)
 ;
"RTN","RCWROFF",142,0)
UNLOCK ;  unlock bill and transaction
"RTN","RCWROFF",143,0)
 L -^PRCA(430,RCBILLDA)
"RTN","RCWROFF",144,0)
 I $G(RCTRANDA) L -^PRCA(433,RCTRANDA)
"RTN","RCWROFF",145,0)
 Q
"RTN","RCWROFF",146,0)
 ;
"RTN","RCWROFF",147,0)
 ;
"RTN","RCWROFF",148,0)
ASKOK(TRANTYPE) ;  ask record transaction
"RTN","RCWROFF",149,0)
 N DIR,DIQ2,DIRUT,DTOUT,DUOUT,X,Y
"RTN","RCWROFF",150,0)
 S DIR(0)="YO",DIR("B")="NO"
"RTN","RCWROFF",151,0)
 S DIR("A")="  Are you sure you want to record this bill as a "
"RTN","RCWROFF",152,0)
 I $L(TRANTYPE)<20 S DIR("A")=DIR("A")_TRANTYPE
"RTN","RCWROFF",153,0)
 E  S DIR("A",1)=DIR("A"),DIR("A")="  "_TRANTYPE
"RTN","RCWROFF",154,0)
 W ! D ^DIR
"RTN","RCWROFF",155,0)
 I $G(DTOUT)!($G(DUOUT)) S Y=-1
"RTN","RCWROFF",156,0)
 Q Y
"RTN","RCWROFF1")
0^51^B35416905
"RTN","RCWROFF1",1,0)
RCWROFF1 ;WISC/RFJ-partial waiver ;1 Feb 2000
"RTN","RCWROFF1",2,0)
 ;;4.5;Accounts Receivable;**168,204,233,301**;Mar 20, 1995;Build 144
"RTN","RCWROFF1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCWROFF1",4,0)
 Q
"RTN","RCWROFF1",5,0)
 ;
"RTN","RCWROFF1",6,0)
 ;
"RTN","RCWROFF1",7,0)
PARTIAL ;  enter a partial waived (menu option)
"RTN","RCWROFF1",8,0)
 N DR,RCBILLDA,RCCURPRI,RCFYCNT,RCTOTAL,RCTRANDA,RCWAIVED,Y
"RTN","RCWROFF1",9,0)
 F  D  Q:RCBILLDA<1
"RTN","RCWROFF1",10,0)
 .   K RCTRANDA  ;do not leave around in for loop
"RTN","RCWROFF1",11,0)
 .   ;  select a bill
"RTN","RCWROFF1",12,0)
 .   S RCBILLDA=$$GETABILL^RCBEUBIL I RCBILLDA<1 Q
"RTN","RCWROFF1",13,0)
 .   I $D(^PRCA(430,"TCSP",RCBILLDA)) D  Q  ;prca*4.5*301
"RTN","RCWROFF1",14,0)
 . .   W !,"BILL HAS BEEN REFERRED TO CROSS-SERVICING.",!,"NO TRANSACTIONS ARE ALLOWED.",!,"** THE RECALL PROCESS MUST BE UTILIZED PRIOR TO PERFORMING THIS FUNCTION **"   ;prca*4.5*301 Q
"RTN","RCWROFF1",15,0)
 .   ;  lock the bill
"RTN","RCWROFF1",16,0)
 .   L +^PRCA(430,RCBILLDA):5 I '$T W !,"ANOTHER USER IS CURRENTLY WORKING WITH THIS BILL." Q
"RTN","RCWROFF1",17,0)
 .   D SHOWBILL(RCBILLDA)
"RTN","RCWROFF1",18,0)
 .   I '$G(^PRCA(430,RCBILLDA,7)) W !,"THIS BILL HAS NO PRINCIPAL BALANCE." D UNLOCK^RCWROFF Q
"RTN","RCWROFF1",19,0)
 .   W !
"RTN","RCWROFF1",20,0)
 .   ;  add a new partial waiver transaction to file 433
"RTN","RCWROFF1",21,0)
 .   S RCTRANDA=$$ADD433^RCBEUTRA(RCBILLDA,11) I 'RCTRANDA W !,$P(RCTRANDA,"^",2) D UNLOCK^RCWROFF Q
"RTN","RCWROFF1",22,0)
 .   W !,"  Transaction number ",RCTRANDA," added ..."
"RTN","RCWROFF1",23,0)
 .   ;  transfer fy multiple from bill
"RTN","RCWROFF1",24,0)
 .   D FY433^RCBEUTRA(RCTRANDA)
"RTN","RCWROFF1",25,0)
 .   ;
"RTN","RCWROFF1",26,0)
 .   ;  build dr string for call to die
"RTN","RCWROFF1",27,0)
 .   S DR="11WAIVED IN PART DATE;"
"RTN","RCWROFF1",28,0)
 .   ;  determine if there is more than one fiscal year for build DR string
"RTN","RCWROFF1",29,0)
 .   S RCFYCNT=$P($G(^PRCA(433,RCTRANDA,4,0)),"^",4)
"RTN","RCWROFF1",30,0)
 .   ;  single fiscal year in multiple
"RTN","RCWROFF1",31,0)
 .   I RCFYCNT'>1 D
"RTN","RCWROFF1",32,0)
 .   .   ;  get the current principal balance
"RTN","RCWROFF1",33,0)
 .   .   S RCCURPRI=+$P($G(^PRCA(433,RCTRANDA,4,+$O(^PRCA(433,RCTRANDA,4,0)),0)),"^",2)
"RTN","RCWROFF1",34,0)
 .   .   S DR=DR_"15WAIVED AMOUNT;"
"RTN","RCWROFF1",35,0)
 .   .   S DR=DR_"S RCWAIVED=+X;"
"RTN","RCWROFF1",36,0)
 .   .   S DR=DR_"I RCWAIVED'>0 W !,""Amount must be greater than ZERO.  Press ^ to exit."" S Y=15;"
"RTN","RCWROFF1",37,0)
 .   .   S DR=DR_"I RCWAIVED>RCCURPRI W !,""Waived amount CAN NOT EXCEED Principal amount ($ "",$J(RCCURPRI,0,2),"")."" S Y=15;"
"RTN","RCWROFF1",38,0)
 .   .   S DR=DR_"I RCWAIVED=RCCURPRI W !,""If you are creating a waiver for the FULL AMOUNT, use the option Full Waiver."" S Y=15;"
"RTN","RCWROFF1",39,0)
 .   .   S DR=DR_"81///^S X=RCWAIVED;"
"RTN","RCWROFF1",40,0)
 .   ;  multiple fiscal years in multiple
"RTN","RCWROFF1",41,0)
 .   I RCFYCNT>1 D
"RTN","RCWROFF1",42,0)
 .   .   S DR=DR_"S RCTOTAL=0;"
"RTN","RCWROFF1",43,0)
 .   .   S DR=DR_".02;"
"RTN","RCWROFF1",44,0)
 .   .   S DR(2,433.01)="4WAIVED AMOUNT;"
"RTN","RCWROFF1",45,0)
 .   .   S DR(2,433.01)=DR(2,433.01)_"S RCWAIVED=+X,RCCURPRI=+$P(^PRCA(433,DA(1),4,DA,0),U,2);"
"RTN","RCWROFF1",46,0)
 .   .   S DR(2,433.01)=DR(2,433.01)_"I RCWAIVED>RCCURPRI W !,""Waived amount CAN NOT EXCEED Principal Amount ($ "",$J(RCCURPRI,0,2),"") for this Fiscal Year."" S Y=4;"
"RTN","RCWROFF1",47,0)
 .   .   S DR(2,433.01,1)="I RCWAIVED=RCCURPRI W !,""If you are creating a waiver for the FULL AMOUNT, use the option Full Waiver."" S Y=4;"
"RTN","RCWROFF1",48,0)
 .   .   S DR(2,433.01,1)=DR(2,433.01,1)_"1///^S X=$P(^PRCA(433,DA(1),4,DA,0),U,2)-RCWAIVED;"
"RTN","RCWROFF1",49,0)
 .   .   S DR(2,433.01,1)=DR(2,433.01,1)_"S RCTOTAL=$G(RCTOTAL)+RCWAIVED;"
"RTN","RCWROFF1",50,0)
 .   .   S DR=DR_"I RCTOTAL'>0 W !,""Amount must be greater than ZERO.  Press ^ to exit."" S Y=.02;"
"RTN","RCWROFF1",51,0)
 .   .   S DR=DR_"15///^S X=RCTOTAL;"
"RTN","RCWROFF1",52,0)
 .   .   S DR=DR_"81///^S X=RCTOTAL;"
"RTN","RCWROFF1",53,0)
 .   ;
"RTN","RCWROFF1",54,0)
 .   ;  allow user to edit key fields
"RTN","RCWROFF1",55,0)
 .   S Y=$$EDIT433^RCBEUTRA(RCTRANDA,.DR)
"RTN","RCWROFF1",56,0)
 .   I 'Y W !,$P(Y,"^",2) D DEL433^RCBEUTRA(RCTRANDA,"",0),UNLOCK^RCWROFF Q
"RTN","RCWROFF1",57,0)
 .   ;
"RTN","RCWROFF1",58,0)
 .   ;  if only one fiscal year, update the multiple since it was not done
"RTN","RCWROFF1",59,0)
 .   ;  by the user in the die call
"RTN","RCWROFF1",60,0)
 .   I RCFYCNT=1 D
"RTN","RCWROFF1",61,0)
 .   .   N DA40,DATA40,RCTOTAL
"RTN","RCWROFF1",62,0)
 .   .   S RCTOTAL=$P($G(^PRCA(433,RCTRANDA,8)),"^")  ;amount waived
"RTN","RCWROFF1",63,0)
 .   .   S DA40=+$O(^PRCA(433,RCTRANDA,4,0)) I 'DA40 Q
"RTN","RCWROFF1",64,0)
 .   .   S DATA40=$G(^PRCA(433,RCTRANDA,4,DA40,0)) I DATA40="" Q
"RTN","RCWROFF1",65,0)
 .   .   S $P(DATA40,"^",2)=$P(DATA40,"^",2)-RCTOTAL  ;principal remaining
"RTN","RCWROFF1",66,0)
 .   .   S $P(DATA40,"^",5)=RCTOTAL                   ;amount waived
"RTN","RCWROFF1",67,0)
 .   .   S ^PRCA(433,RCTRANDA,4,DA40,0)=DATA40
"RTN","RCWROFF1",68,0)
 .   ;
"RTN","RCWROFF1",69,0)
 .   D SHOWTRAN(RCTRANDA)
"RTN","RCWROFF1",70,0)
 .   I $$ASKOK^RCWROFF("Partial Waiver")'=1 D DEL433^RCBEUTRA(RCTRANDA,"",0),UNLOCK^RCWROFF Q
"RTN","RCWROFF1",71,0)
 .   ;
"RTN","RCWROFF1",72,0)
 .   ;  move the fy multiple from 433 to 430
"RTN","RCWROFF1",73,0)
 .   D FYMULT^RCBEUBIL(RCTRANDA)
"RTN","RCWROFF1",74,0)
 .   ;  mark transaction as processed
"RTN","RCWROFF1",75,0)
 .   D PROCESS^RCBEUTRA(RCTRANDA)
"RTN","RCWROFF1",76,0)
 .   ;  update the principal balance on the bill (subtract the waived amount)
"RTN","RCWROFF1",77,0)
 .   D SETBAL^RCBEUBIL(RCTRANDA)
"RTN","RCWROFF1",78,0)
 .   ;  create fms write off document, if not accrued
"RTN","RCWROFF1",79,0)
 .   I '$$ACCK^PRCAACC(RCBILLDA) D FMSDOC^RCWROFF(RCTRANDA)
"RTN","RCWROFF1",80,0)
 .   ;
"RTN","RCWROFF1",81,0)
 .   W !,"  * * * * * Partial Waiver has been PROCESSED! * * * * *"
"RTN","RCWROFF1",82,0)
 .I '$G(REFMS)&(DT>$$LDATE^RCRJR(DT)) S Y=$E($$FPS^RCAMFN01(DT,1),1,5)_"01" D DD^%DT W !!,"   * * * * Transmission will be held until "_Y_" * * * *"
"RTN","RCWROFF1",83,0)
 .   D UNLOCK^RCWROFF
"RTN","RCWROFF1",84,0)
 Q
"RTN","RCWROFF1",85,0)
 ;
"RTN","RCWROFF1",86,0)
 ;
"RTN","RCWROFF1",87,0)
SHOWTRAN(RCTRANDA) ;  show data for transaction
"RTN","RCWROFF1",88,0)
 N %,DATA0,DATA1,DATA40,RCWRLINE,Y
"RTN","RCWROFF1",89,0)
 S DATA0=$G(^PRCA(433,RCTRANDA,0))
"RTN","RCWROFF1",90,0)
 S DATA1=$G(^PRCA(433,RCTRANDA,1))
"RTN","RCWROFF1",91,0)
 S RCWRLINE="",$P(RCWRLINE,"=",79)=""
"RTN","RCWROFF1",92,0)
 W !!,RCWRLINE
"RTN","RCWROFF1",93,0)
 W !,"BILL NUMBER: ",$P($G(^PRCA(430,+$P(DATA0,"^",2),0)),"^")
"RTN","RCWROFF1",94,0)
 W ?40,"WAIVED AMOUNT: ",$J($P(DATA1,"^",5),0,2)
"RTN","RCWROFF1",95,0)
 S Y=$P($P(DATA1,"^"),".") I Y D DD^%DT
"RTN","RCWROFF1",96,0)
 W !?42,"WAIVED DATE: ",Y
"RTN","RCWROFF1",97,0)
 W !!,"FISCAL YEAR",?30,"WAIVED AMOUNT",?50,"NEW PRINCIPAL BALANCE DUE"
"RTN","RCWROFF1",98,0)
 S %=0 F  S %=$O(^PRCA(433,RCTRANDA,4,%)) Q:'%  D
"RTN","RCWROFF1",99,0)
 .   S DATA40=$G(^PRCA(433,RCTRANDA,4,%,0))
"RTN","RCWROFF1",100,0)
 .   W !,$P(DATA40,"^"),?30,$J($P(DATA40,"^",5),13,2),?50,$J($P(DATA40,"^",2),25,2)
"RTN","RCWROFF1",101,0)
 W !!,RCWRLINE
"RTN","RCWROFF1",102,0)
 Q
"RTN","RCWROFF1",103,0)
 ;
"RTN","RCWROFF1",104,0)
 ;
"RTN","RCWROFF1",105,0)
SHOWBILL(RCBILLDA) ;  show data for bill
"RTN","RCWROFF1",106,0)
 N DATA7,DATA20,FYDA
"RTN","RCWROFF1",107,0)
 S DATA7=$G(^PRCA(430,RCBILLDA,7))
"RTN","RCWROFF1",108,0)
 W !?8,"Principal Balance: ",$J($P(DATA7,"^"),11,2)
"RTN","RCWROFF1",109,0)
 ;
"RTN","RCWROFF1",110,0)
 ;  show fy data
"RTN","RCWROFF1",111,0)
 S FYDA=$O(^PRCA(430,RCBILLDA,2,0)),DATA20=$G(^PRCA(430,RCBILLDA,2,FYDA,0))
"RTN","RCWROFF1",112,0)
 W ?40,"FY: ",$P(DATA20,"^"),?48,"Principal Balance: ",$J($P(DATA20,"^",2),0,2)
"RTN","RCWROFF1",113,0)
 ;  if multiple fiscal years, show them here
"RTN","RCWROFF1",114,0)
 F  S FYDA=$O(^PRCA(430,RCBILLDA,2,FYDA)) Q:'FYDA  D
"RTN","RCWROFF1",115,0)
 .   S DATA20=$G(^PRCA(430,RCBILLDA,2,FYDA,0))
"RTN","RCWROFF1",116,0)
 .   W !?40,"FY: ",$P(DATA20,"^"),?48,"Principal Balance: ",$J($P(DATA20,"^",2),0,2)
"RTN","RCWROFF1",117,0)
 ;
"RTN","RCWROFF1",118,0)
 W !?8," Interest Balance: ",$J($P(DATA7,"^",2),11,2)
"RTN","RCWROFF1",119,0)
 W !?8,"    Admin Balance: ",$J($P(DATA7,"^",3)+$P(DATA7,"^",4)+$P(DATA7,"^",5),11,2)
"RTN","RCWROFF1",120,0)
 W !?27,"-----------"
"RTN","RCWROFF1",121,0)
 W !?8,"    TOTAL Balance: ",$J($P(DATA7,"^")+$P(DATA7,"^",2)+$P(DATA7,"^",3)+$P(DATA7,"^",4)+$P(DATA7,"^",5),11,2)
"RTN","RCWROFF1",122,0)
 Q
"SEC","^DIC",348.5,348.5,0,"AUDIT")
@
"SEC","^DIC",348.5,348.5,0,"DD")
@
"SEC","^DIC",348.5,348.5,0,"DEL")
@
"SEC","^DIC",348.5,348.5,0,"LAYGO")
@
"SEC","^DIC",348.5,348.5,0,"RD")
@
"SEC","^DIC",348.5,348.5,0,"WR")
@
"SEC","^DIC",348.6,348.6,0,"AUDIT")
@
"SEC","^DIC",348.6,348.6,0,"DD")
@
"SEC","^DIC",348.6,348.6,0,"DEL")
@
"SEC","^DIC",348.6,348.6,0,"LAYGO")
@
"SEC","^DIC",348.6,348.6,0,"RD")
@
"SEC","^DIC",348.6,348.6,0,"WR")
@
"SEC","^DIC",348.7,348.7,0,"AUDIT")
@
"SEC","^DIC",348.7,348.7,0,"DD")
@
"SEC","^DIC",348.7,348.7,0,"DEL")
@
"SEC","^DIC",348.7,348.7,0,"LAYGO")
@
"SEC","^DIC",348.7,348.7,0,"RD")
@
"SEC","^DIC",348.7,348.7,0,"WR")
@
"UP",344,344.01,-1)
344^1
"UP",344,344.01,0)
344.01
"UP",430,430.0171,-1)
430^17
"UP",430,430.0171,0)
430.0171
"UP",430,430.0172,-1)
430^18
"UP",430,430.0172,0)
430.0172
"VER")
8.0^22.0
"^DD",340,340,7.02,0)
TCSP RECALL FLAG^S^1:TCSP RECALL FLAG SET;^7;2^Q
"^DD",340,340,7.02,3)
Type a '1' to set the Cross-Servicing recall flag.
"^DD",340,340,7.02,21,0)
^.001^3^3^3150511^^^^
"^DD",340,340,7.02,21,1,0)
The flag that marks this debtor for recall from
"^DD",340,340,7.02,21,2,0)
Cross-Servicing together with all of the debts
"^DD",340,340,7.02,21,3,0)
at Cross-Servicing.
"^DD",340,340,7.02,"DT")
3140406
"^DD",340,340,7.03,0)
TCSP RECALL DATE^D^^7;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",340,340,7.03,3)
Type the date that the recall was sent to Cross-Servicing.
"^DD",340,340,7.03,21,0)
^.001^2^2^3150511^^^^
"^DD",340,340,7.03,21,1,0)
The date that the Cross-Servicing recall record
"^DD",340,340,7.03,21,2,0)
was sent to Cross-Servicing.
"^DD",340,340,7.03,"DT")
3140406
"^DD",340,340,7.04,0)
TCSP RECALL REASON^S^03:BANKRUPTCY WITH AUTOMATIC STAY;05:DEBTOR IS DISABLED WITH INABILITY TO PAY;06:DEBTOR IS DECEASED;^7;4^Q
"^DD",340,340,7.04,3)
Type a reason code for the recall from Cross-Servicing.
"^DD",340,340,7.04,21,0)
^.001^5^5^3150113^^^^
"^DD",340,340,7.04,21,1,0)
The reason that the debtor is being recalled
"^DD",340,340,7.04,21,2,0)
from Cross-Servicing.  Select from:
"^DD",340,340,7.04,21,3,0)
'03' for bankruptcy, 
"^DD",340,340,7.04,21,4,0)
'05' for debtor is disabled with inability to pay, 
"^DD",340,340,7.04,21,5,0)
'06' for debtor is deceased.
"^DD",340,340,7.04,"DT")
3140508
"^DD",340,340,7.05,0)
DATE DEBTOR REFERRED TO TCSP^D^^7;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",340,340,7.05,1,0)
^.1
"^DD",340,340,7.05,1,1,0)
340^TCSP^MUMPS
"^DD",340,340,7.05,1,1,1)
S ^RCD(340,"TCSP",DA)=""
"^DD",340,340,7.05,1,1,2)
K ^RCD(340,"TCSP",DA)
"^DD",340,340,7.05,1,1,"%D",0)
^.101^2^2^3150226^^
"^DD",340,340,7.05,1,1,"%D",1,0)
This Cross-Reference indicates whether a debtor
"^DD",340,340,7.05,1,1,"%D",2,0)
has been sent to Cross-Servicing.
"^DD",340,340,7.05,1,1,"DT")
3141104
"^DD",340,340,7.05,3)
Type the date that the debt was referred to Cross-Servicing.
"^DD",340,340,7.05,21,0)
^.001^2^2^3150511^^^^
"^DD",340,340,7.05,21,1,0)
The date that the debtor was first referred to
"^DD",340,340,7.05,21,2,0)
Cross-Servicing.
"^DD",340,340,7.05,"DT")
3141104
"^DD",342,342,100,0)
CROSS-SERVICING START DATE^D^^CS;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",342,342,100,3)
Enter the date that the Cross-Servicing Process begins.
"^DD",342,342,100,21,0)
^^4^4^3150314^
"^DD",342,342,100,21,1,0)
The date that the Cross-Servicing Process begins.
"^DD",342,342,100,21,2,0)
The Due Process Notification for debts originally
"^DD",342,342,100,21,3,0)
less than $25.00 will stop after one year from
"^DD",342,342,100,21,4,0)
this date.
"^DD",342,342,100,"DT")
3150314
"^DD",344,344,.19,0)
RECEIPT PAY TYPE^F^^0;19^K:$L(X)>3!($L(X)<1) X
"^DD",344,344,.19,3)
Answer must be 1-3 characters in length.
"^DD",344,344,.19,21,0)
^^2^2^3160610^
"^DD",344,344,.19,21,1,0)
Pay type will be auto set during lockbox posting to drive the pay type 
"^DD",344,344,.19,21,2,0)
needed for receipt re-processing.
"^DD",344,344,.19,23,0)
^^1^1^3160610^
"^DD",344,344,.19,23,1,0)
Set in routine RCBEPAY as a result of lockboc type post
"^DD",344,344,.19,"DT")
3160610
"^DD",344,344.01,.09,0)
PATIENT NAME OR BILL NUMBER^FXO^^0;9^D PNORBILL^RCDPURED K:'$G(X) X
"^DD",344,344.01,.09,.1)

"^DD",344,344.01,.09,1,0)
^.1
"^DD",344,344.01,.09,1,1,0)
^^TRIGGER^344.01^.03
"^DD",344,344.01,.09,1,1,1)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(1)=$S($D(^RCY(344,D0,1,D1,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X=DIV S X=DIV,X=X X ^DD(344.01,.09,1,1,1.4)
"^DD",344,344.01,.09,1,1,1.4)
S DIH=$S($D(^RCY(344,DIV(0),1,DIV(1),0)):^(0),1:""),DIV=X S $P(^(0),U,3)=DIV,DIH=344.01,DIG=.03 D ^DICR:$O(^DD(DIH,DIG,1,0))
"^DD",344,344.01,.09,1,1,2)
K DIV S DIV=X,D0=DA(1),DIV(0)=D0,D1=DA,DIV(1)=D1 S Y(1)=$S($D(^RCY(344,D0,1,D1,0)):^(0),1:"") S X=$P(Y(1),U,3),X=X S DIU=X K Y S X="" X ^DD(344.01,.09,1,1,2.4)
"^DD",344,344.01,.09,1,1,2.4)
S DIH=$S($D(^RCY(344,DIV(0),1,DIV(1),0)):^(0),1:""),DIV=X S $P(^(0),U,3)=DIV,DIH=344.01,DIG=.03 D ^DICR:$O(^DD(DIH,DIG,1,0))
"^DD",344,344.01,.09,1,1,3)
Needed to set Account field
"^DD",344,344.01,.09,1,1,"%D",0)
^^5^5^2930923^
"^DD",344,344.01,.09,1,1,"%D",1,0)
This field allows a customized look-up to the Patient file
"^DD",344,344.01,.09,1,1,"%D",2,0)
and Bill number file when prompting the user for "PATIENT NAME
"^DD",344,344.01,.09,1,1,"%D",3,0)
OR BILL NUMBER" during payment entry.  Once the user selects
"^DD",344,344.01,.09,1,1,"%D",4,0)
the Patient or Bill Number, this data is then moved to the
"^DD",344,344.01,.09,1,1,"%D",5,0)
"Account" field for VA FileMan Compatiblity for printing.
"^DD",344,344.01,.09,1,1,"CREATE VALUE")
INTERNAL(#.09)
"^DD",344,344.01,.09,1,1,"DELETE VALUE")
@
"^DD",344,344.01,.09,1,1,"DT")
2920619
"^DD",344,344.01,.09,1,1,"FIELD")
ACCOUNT
"^DD",344,344.01,.09,2)
S Y(0)=Y S Y=$P(@("^"_$P(Y,";",2)_+Y_",0)"),"^")
"^DD",344,344.01,.09,2.1)
S Y=$P(@("^"_$P(Y,";",2)_+Y_",0)"),"^")
"^DD",344,344.01,.09,3)
Enter one of following: Patient Name, Bill No, TRICARE Authorization No, ECME Rx Reference Number or Prescription Number.
"^DD",344,344.01,.09,22)

"^DD",344,344.01,.09,"DT")
3161004
"^DD",344,344.01,.15,0)
LOCKBOX TRANSACTION CODE^NJ3,0^^0;19^K:+X'=X!(X>999)!(X<100)!(X?.E1"."1N.N) X
"^DD",344,344.01,.15,3)
Type a number between 100 and 999, 0 decimal digits.
"^DD",344,344.01,.15,21,0)
^^1^1^3160928^
"^DD",344,344.01,.15,21,1,0)
This field indentifies the transaction type as the receipt is posted or re-processed.
"^DD",344,344.01,.15,"DT")
3160928
"^DD",348.5,348.5,0)
FIELD^^3^4
"^DD",348.5,348.5,0,"DDA")
N
"^DD",348.5,348.5,0,"DT")
3140825
"^DD",348.5,348.5,0,"IX","B",348.5,.01)

"^DD",348.5,348.5,0,"NM","TCS IAI ERROR CODES")

"^DD",348.5,348.5,0,"PT",430.0172,2)

"^DD",348.5,348.5,0,"PT",430.0172,3)

"^DD",348.5,348.5,0,"PT",430.0172,4)

"^DD",348.5,348.5,0,"PT",430.0172,5)

"^DD",348.5,348.5,0,"PT",430.0172,6)

"^DD",348.5,348.5,0,"PT",430.0172,7)

"^DD",348.5,348.5,0,"PT",430.0172,8)

"^DD",348.5,348.5,0,"PT",430.0172,9)

"^DD",348.5,348.5,0,"PT",430.0172,10)

"^DD",348.5,348.5,0,"VRPK")
PRCA
"^DD",348.5,348.5,.01,0)
ERROR CODE ID^RF^^0;1^K:$L(X)>2!($L(X)<2)!'(X?1AN1AN) X
"^DD",348.5,348.5,.01,1,0)
^.1
"^DD",348.5,348.5,.01,1,1,0)
348.5^B
"^DD",348.5,348.5,.01,1,1,1)
S ^RC(348.5,"B",$E(X,1,30),DA)=""
"^DD",348.5,348.5,.01,1,1,2)
K ^RC(348.5,"B",$E(X,1,30),DA)
"^DD",348.5,348.5,.01,3)
Answer must be 2 characters in length.
"^DD",348.5,348.5,.01,21,0)
^.001^1^1^3150511^^
"^DD",348.5,348.5,.01,21,1,0)
Input is number identifying the IAI Error Code.
"^DD",348.5,348.5,.01,"DT")
3150304
"^DD",348.5,348.5,1,0)
FIELD NAME/ACTION^F^^0;2^K:$L(X)>100!($L(X)<3) X
"^DD",348.5,348.5,1,3)
Answer must be 3-100 characters in length.
"^DD",348.5,348.5,1,21,0)
^^1^1^3150511^
"^DD",348.5,348.5,1,21,1,0)
The identifying information of the error code.
"^DD",348.5,348.5,1,"DT")
3140715
"^DD",348.5,348.5,2,0)
RECORD TYPE^F^^0;3^K:$L(X)>50!($L(X)<1) X
"^DD",348.5,348.5,2,3)
Answer must be 1-50 characters in length.
"^DD",348.5,348.5,2,21,0)
^^1^1^3150511^
"^DD",348.5,348.5,2,21,1,0)
The possible record types for this error code.
"^DD",348.5,348.5,2,"DT")
3140715
"^DD",348.5,348.5,3,0)
ERROR MESSAGE^F^^1;1^K:$L(X)>250!($L(X)<2) X
"^DD",348.5,348.5,3,3)
Answer must be 2-250 characters in length.
"^DD",348.5,348.5,3,21,0)
^^1^1^3150511^
"^DD",348.5,348.5,3,21,1,0)
The error message for incorrect error codes.
"^DD",348.5,348.5,3,"DT")
3140715
"^DD",348.6,348.6,0)
FIELD^^2^3
"^DD",348.6,348.6,0,"DT")
3140909
"^DD",348.6,348.6,0,"IX","B",348.6,.01)

"^DD",348.6,348.6,0,"NM","TCS IAI ACTION CODES")

"^DD",348.6,348.6,0,"PT",430.0172,12)

"^DD",348.6,348.6,0,"VRPK")
PRCA
"^DD",348.6,348.6,.01,0)
ACTION CODE^RF^^0;1^K:$L(X)>1!($L(X)<1)!'(X'?1P.E) X
"^DD",348.6,348.6,.01,1,0)
^.1
"^DD",348.6,348.6,.01,1,1,0)
348.6^B
"^DD",348.6,348.6,.01,1,1,1)
S ^RC(348.6,"B",$E(X,1,30),DA)=""
"^DD",348.6,348.6,.01,1,1,2)
K ^RC(348.6,"B",$E(X,1,30),DA)
"^DD",348.6,348.6,.01,3)
Answer must be 1 character in length.
"^DD",348.6,348.6,.01,21,0)
^^2^2^3150511^
"^DD",348.6,348.6,.01,21,1,0)
The possible action codes for Cross-Servicing records
"^DD",348.6,348.6,.01,21,2,0)
being sent to Treasury.
"^DD",348.6,348.6,.01,"DT")
3140909
"^DD",348.6,348.6,1,0)
ACTION DESCRIPTION^RF^^0;2^K:$L(X)>50!($L(X)<3) X
"^DD",348.6,348.6,1,3)
Answer must be 3-50 characters in length.
"^DD",348.6,348.6,1,21,0)
^^1^1^3150511^
"^DD",348.6,348.6,1,21,1,0)
The type of action code.
"^DD",348.6,348.6,1,"DT")
3140909
"^DD",348.6,348.6,2,0)
RECORD TYPE^RF^^0;3^K:$L(X)>50!($L(X)<3) X
"^DD",348.6,348.6,2,3)
Answer must be 3-50 characters in length.
"^DD",348.6,348.6,2,21,0)
^^1^1^3150511^
"^DD",348.6,348.6,2,21,1,0)
The record type for this action code.
"^DD",348.6,348.6,2,"DT")
3140909
"^DD",348.7,348.7,0)
FIELD^^2^3
"^DD",348.7,348.7,0,"DT")
3140909
"^DD",348.7,348.7,0,"IX","B",348.7,.01)

"^DD",348.7,348.7,0,"NM","TCS IAI RECORD TYPES")

"^DD",348.7,348.7,0,"PT",430.0172,11)

"^DD",348.7,348.7,0,"VRPK")
PRCA
"^DD",348.7,348.7,.01,0)
RECORD TYPE ID^RF^^0;1^K:$L(X)>2!($L(X)<1)!'(X'?1P.E) X
"^DD",348.7,348.7,.01,1,0)
^.1
"^DD",348.7,348.7,.01,1,1,0)
348.7^B
"^DD",348.7,348.7,.01,1,1,1)
S ^RC(348.7,"B",$E(X,1,30),DA)=""
"^DD",348.7,348.7,.01,1,1,2)
K ^RC(348.7,"B",$E(X,1,30),DA)
"^DD",348.7,348.7,.01,3)
Answer must be 1-2 characters in length.
"^DD",348.7,348.7,.01,21,0)
^^1^1^3150511^
"^DD",348.7,348.7,.01,21,1,0)
The possible Cross-Servicing record types.
"^DD",348.7,348.7,.01,"DT")
3140909
"^DD",348.7,348.7,1,0)
RECORD TYPE DESCRIPTION^RF^^0;2^K:$L(X)>75!($L(X)<3) X
"^DD",348.7,348.7,1,3)
Answer must be 3-75 characters in length.
"^DD",348.7,348.7,1,21,0)
^^2^2^3150511^
"^DD",348.7,348.7,1,21,1,0)
The Cross-Servicing record type that the record
"^DD",348.7,348.7,1,21,2,0)
type ID applies to.
"^DD",348.7,348.7,1,"DT")
3140909
"^DD",348.7,348.7,2,0)
DATA TYPE^F^^0;3^K:$L(X)>50!($L(X)<3) X
"^DD",348.7,348.7,2,3)
Answer must be 3-50 characters in length.
"^DD",348.7,348.7,2,21,0)
^^2^2^3150511^
"^DD",348.7,348.7,2,21,1,0)
Additional descriptive information for this
"^DD",348.7,348.7,2,21,2,0)
record type ID.
"^DD",348.7,348.7,2,"DT")
3140909
"^DD",430,430,151,0)
DATE BILL REFERRED TO TCSP^D^^15;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,151,1,0)
^.1
"^DD",430,430,151,1,1,0)
430^TCSP^MUMPS
"^DD",430,430,151,1,1,1)
S ^PRCA(430,"TCSP",DA)=""
"^DD",430,430,151,1,1,2)
K ^PRCA(430,"TCSP",DA)
"^DD",430,430,151,1,1,"%D",0)
^^2^2^3150226^
"^DD",430,430,151,1,1,"%D",1,0)
This Cross-Reference indicates whether a debt
"^DD",430,430,151,1,1,"%D",2,0)
has been sent to Cross-Servicing.
"^DD",430,430,151,1,1,"DT")
3141104
"^DD",430,430,151,3)
Type the date that the debt was referred to Cross-Servicing.
"^DD",430,430,151,21,0)
^.001^2^2^3150226^^^^
"^DD",430,430,151,21,1,0)
The date that the debt was referred to Cross
"^DD",430,430,151,21,2,0)
Servicing.
"^DD",430,430,151,"DT")
3141104
"^DD",430,430,152,0)
TCSP RECALL FLAG^S^1:CROSS-SERVICING RECALL SET;^15;2^Q
"^DD",430,430,152,3)
Type a '1' to set the Cross-Servicing recall flag.
"^DD",430,430,152,21,0)
^.001^3^3^3150113^^
"^DD",430,430,152,21,1,0)
The flag that marks this debt for recall record
"^DD",430,430,152,21,2,0)
creation from Cross-Servicing when the AR
"^DD",430,430,152,21,3,0)
nightly background job is run.
"^DD",430,430,152,"DT")
3150113
"^DD",430,430,153,0)
TCSP RECALL EFF. DATE^D^^15;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,153,3)
Type a date greater than 1/1/2014.
"^DD",430,430,153,21,0)
^.001^2^2^3141008^^
"^DD",430,430,153,21,1,0)
The date that the recall flag is set for the
"^DD",430,430,153,21,2,0)
debt.
"^DD",430,430,153,"DT")
3140316
"^DD",430,430,154,0)
TCSP RECALL REASON^S^01:DEBT REFERRED IN ERROR;07:AGENCY IS FORGIVING DEBT;08:AGENCY CAN COLLECT THROUGH INTERNAL OFFSET;15:DEBTOR WAS INCORRECTLY ASSOCIATED WITH THE DEBT;03:BANKRUPTCY;05:DEBTOR DISABLED;06:DEBTOR DECEASED;^15;4^Q
"^DD",430,430,154,3)
Type a reason code for the recall from Cross-Servicing.
"^DD",430,430,154,21,0)
^.001^2^2^3150113^^^^
"^DD",430,430,154,21,1,0)
The reason that the debt is being recalled
"^DD",430,430,154,21,2,0)
from Cross-Servicing.
"^DD",430,430,154,"DT")
3140703
"^DD",430,430,155,0)
RECALL AMOUNT^NJ8,2^^15;5^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>99999.99)!(X<0) X
"^DD",430,430,155,3)
Type a dollar amount between 0 and 99999.99, 2 decimal digits.
"^DD",430,430,155,21,0)
^.001^2^2^3150113^^^
"^DD",430,430,155,21,1,0)
The amount of the debt being recalled from
"^DD",430,430,155,21,2,0)
Cross-Servicing.
"^DD",430,430,155,"DT")
3141008
"^DD",430,430,157,0)
STOP TCSP REFERRAL FLAG^S^1:STOP TCSP REFERRAL SET;^15;7^Q
"^DD",430,430,157,3)
Type a '1' to set the Cross-Servicing stop flag for this debt.
"^DD",430,430,157,21,0)
^.001^2^2^3150113^^^
"^DD",430,430,157,21,1,0)
The flag that stops further Cross-Servicing
"^DD",430,430,157,21,2,0)
activity for this debt.
"^DD",430,430,157,"DT")
3140406
"^DD",430,430,158,0)
STOP TCSP REFERRAL EFF. DATE^RD^^15;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,158,3)
Type a date greater than 1/1/2014.
"^DD",430,430,158,21,0)
^.001^2^2^3141117^^
"^DD",430,430,158,21,1,0)
The date that the stop flag was set for the
"^DD",430,430,158,21,2,0)
debt.
"^DD",430,430,158,"DT")
3141117
"^DD",430,430,159,0)
STOP TCSP REFERRAL REASON^S^B:BANKRUPTCY;W:WAIVER;O:OTHER;R:REJECTED BY CROSS-SERVICING;^15;9^Q
"^DD",430,430,159,3)
Type a reason code for the stop Cross-Servicing activity.
"^DD",430,430,159,21,0)
^.001^5^5^3150113^^^
"^DD",430,430,159,21,1,0)
The reason that the debt is being stopped
"^DD",430,430,159,21,2,0)
for further Cross-Servicing activity.
"^DD",430,430,159,21,3,0)
Select from 'B' for bankruptcy, 'W' for
"^DD",430,430,159,21,4,0)
waiver, 'O' for other, and 'R' for
"^DD",430,430,159,21,5,0)
rejected by Cross-Servicing.
"^DD",430,430,159,"DT")
3150113
"^DD",430,430,159.1,0)
STOP TCSP REFERRAL COMMENT^F^^15;10^K:$L(X)>20!($L(X)<1) X
"^DD",430,430,159.1,3)
Type a reason comment up to 20 characters in length.
"^DD",430,430,159.1,21,0)
^.001^4^4^3141009^^
"^DD",430,430,159.1,21,1,0)
Type a comment to support the reason that a
"^DD",430,430,159.1,21,2,0)
stop flag has been set for this debt.  A
"^DD",430,430,159.1,21,3,0)
comment is required in the case of 'Other'
"^DD",430,430,159.1,21,4,0)
as a reason code.
"^DD",430,430,159.1,"DT")
3140414
"^DD",430,430,159.2,0)
TCSP CASE RECALL FLAG^S^1:CROSS-SERVICING CASE RECALL SET;^15;11^Q
"^DD",430,430,159.2,3)
Type a '1' to set the Cross-Servicing recall flag.
"^DD",430,430,159.2,21,0)
^.001^3^3^3150113^^
"^DD",430,430,159.2,21,1,0)
The flag that marks this case for recall record
"^DD",430,430,159.2,21,2,0)
creation from Cross-Servicing when the AR
"^DD",430,430,159.2,21,3,0)
nightly background job is run.
"^DD",430,430,159.2,"DT")
3150113
"^DD",430,430,159.3,0)
TCSP CASE RECALL EFF. DATE^D^^15;12^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,159.3,3)
Type a date greater than 1/1/2014.
"^DD",430,430,159.3,21,0)
^^2^2^3141009^
"^DD",430,430,159.3,21,1,0)
The date that the recall flag is set for the
"^DD",430,430,159.3,21,2,0)
case.
"^DD",430,430,159.3,"DT")
3140813
"^DD",430,430,159.4,0)
TCSP CASE RECALL REASON^S^15:DEBTOR WAS INCORRECTLY ASSOCIATED WITH THE DEBT;^15;13^Q
"^DD",430,430,159.4,3)
Type a reason code for the recall of the case.
"^DD",430,430,159.4,21,0)
^.001^2^2^3150113^^
"^DD",430,430,159.4,21,1,0)
The reason that the case is being recalled from
"^DD",430,430,159.4,21,2,0)
Cross-Servicing.
"^DD",430,430,159.4,"DT")
3140813
"^DD",430,430,159.5,0)
TCSP GENDER^S^M:MALE;F:FEMALE;^15;14^Q
"^DD",430,430,159.5,3)
Type the gender of the debtor.
"^DD",430,430,159.5,21,0)
^.001^1^1^3150511^^
"^DD",430,430,159.5,21,1,0)
The Debtor's gender, 'M' for Male or 'F' for Female.
"^DD",430,430,159.5,"DT")
3150206
"^DD",430,430,161,0)
TCSP TIN^F^^16;1^K:$L(X)>9!($L(X)<9) X
"^DD",430,430,161,3)
Answer must be 9 characters in length.
"^DD",430,430,161,21,0)
^.001^1^1^3150113^^
"^DD",430,430,161,21,1,0)
The SSN sent on the Cross-Servicing debtor record.
"^DD",430,430,161,"DT")
3140627
"^DD",430,430,162,0)
TCSP DEBTOR NAME^F^^16;2^K:$L(X)>71!($L(X)<1) X
"^DD",430,430,162,3)
Answer must be 1-71 characters in length.
"^DD",430,430,162,21,0)
^.001^2^2^3150113^^
"^DD",430,430,162,21,1,0)
The debtor name sent on the Cross-Servicing
"^DD",430,430,162,21,2,0)
record.
"^DD",430,430,162,"DT")
3140627
"^DD",430,430,163,0)
TCSP DELINQUENCY DATE^D^^16;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,163,3)
Type a date greater than 1/1/2000.
"^DD",430,430,163,21,0)
^.001^4^4^3150212^^^
"^DD",430,430,163,21,1,0)
The date that the bill became active.  The
"^DD",430,430,163,21,2,0)
debt is referred to Cross-Servicing when
"^DD",430,430,163,21,3,0)
the debt is 120 days old counted from
"^DD",430,430,163,21,4,0)
the delinquency date.
"^DD",430,430,163,"DT")
3140316
"^DD",430,430,164,0)
TCSP DEBTOR ADDRESS, LINE 1^F^^16;4^K:$L(X)>35!($L(X)<1) X
"^DD",430,430,164,3)
Answer must be 1-35 characters in length.
"^DD",430,430,164,21,0)
^.001^1^1^3141009^^
"^DD",430,430,164,21,1,0)
The street address line 1 from the Patient file (#2)
"^DD",430,430,164,"DT")
3140316
"^DD",430,430,165,0)
TCSP DEBTOR ADDRESS, LINE 2^F^^16;5^K:$L(X)>35!($L(X)<1) X
"^DD",430,430,165,3)
Answer must be 1-35 characters in length.
"^DD",430,430,165,21,0)
^.001^1^1^3150226^^
"^DD",430,430,165,21,1,0)
The street address line 2 from the Patient file (#2).
"^DD",430,430,165,"DT")
3140316
"^DD",430,430,166,0)
TCSP DEBTOR ADDRESS, CITY^F^^16;6^K:$L(X)>15!($L(X)<1) X
"^DD",430,430,166,3)
Answer must be 1-15 characters in length.
"^DD",430,430,166,21,0)
^^1^1^3141009^
"^DD",430,430,166,21,1,0)
The city from the Patient file (#2).
"^DD",430,430,166,"DT")
3140316
"^DD",430,430,167,0)
TCSP DEBTOR ADDRESS, STATE^F^^16;7^K:$L(X)>2!($L(X)<2) X
"^DD",430,430,167,3)
Answer must be 2 characters in length.
"^DD",430,430,167,21,0)
^^1^1^3141009^
"^DD",430,430,167,21,1,0)
The state from the Patient file (#2).
"^DD",430,430,167,"DT")
3140316
"^DD",430,430,168,0)
TCSP DEBTOR ZIP CODE^F^^16;8^K:$L(X)>9!($L(X)<5) X
"^DD",430,430,168,3)
Answer must be 5-9 characters in length.
"^DD",430,430,168,21,0)
^^1^1^3141009^
"^DD",430,430,168,21,1,0)
The zip code from the Patient file (#2).
"^DD",430,430,168,"DT")
3140316
"^DD",430,430,169,0)
ORIGINAL TCSP AMOUNT^NJ10,2^^16;9^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>9999999)!(X<0) X
"^DD",430,430,169,3)
Type a dollar amount between 0 and 9999999, 2 decimal digits.
"^DD",430,430,169,21,0)
^.001^1^1^3150113^^^^
"^DD",430,430,169,21,1,0)
The original amount referred to Cross-Servicing.
"^DD",430,430,169,"DT")
3141009
"^DD",430,430,169.1,0)
CURRENT TCSP AMOUNT^NJ9,2^^16;10^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999.99)!(X<0) X
"^DD",430,430,169.1,3)
Type a dollar amount between 0 and 999999.99, 2 decimal digits.
"^DD",430,430,169.1,21,0)
^.001^1^1^3150113^^
"^DD",430,430,169.1,21,1,0)
The current debt amount at Cross-Servicing.
"^DD",430,430,169.1,"DT")
3141009
"^DD",430,430,169.2,0)
TCSP DEBTOR PHONE^F^^16;11^K:$L(X)>20!($L(X)<4) X
"^DD",430,430,169.2,3)
Answer must be 4-20 characters in length.
"^DD",430,430,169.2,21,0)
^^1^1^3141009^
"^DD",430,430,169.2,21,1,0)
The residence phone number from the Patient file (#2).
"^DD",430,430,169.2,"DT")
3140829
"^DD",430,430,169.3,0)
TCSP COUNTRY CODE^P779.004'^HL(779.004,^16;12^Q
"^DD",430,430,169.3,3)
Type the country code for the patient's address.
"^DD",430,430,169.3,21,0)
^.001^1^1^3150511^^
"^DD",430,430,169.3,21,1,0)
The country code from the Patient file (#2).
"^DD",430,430,169.3,"DT")
3141015
"^DD",430,430,169.4,0)
TCSP DOB^D^^16;13^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,169.4,3)
Type the patient's date of birth.
"^DD",430,430,169.4,21,0)
^^1^1^3150511^
"^DD",430,430,169.4,21,1,0)
The patient date of birth.
"^DD",430,430,169.4,"DT")
3141206
"^DD",430,430,171,0)
CS DECREASE ADJ TRANS NUMBER^430.0171PA^^17;0
"^DD",430,430,171,21,0)
^.001^3^3^3150612^^^^
"^DD",430,430,171,21,1,0)
The transaction numbers in the AR Transaction
"^DD",430,430,171,21,2,0)
file (#433) for transactions to be included
"^DD",430,430,171,21,3,0)
in a 5B record to be sent to Cross-Servicing.
"^DD",430,430,171,"DT")
3140621
"^DD",430,430,172,0)
REJECT DATE^430.0172DA^^18;0
"^DD",430,430,172,21,0)
^.001^2^2^3150612^^^^
"^DD",430,430,172,21,1,0)
The dates that the Cross-Servicing record
"^DD",430,430,172,21,2,0)
was received and processed.
"^DD",430,430,173,0)
DUE PROCESS NOTIFICATION FLAG^S^1:YES, CHECK FOR DPN;^20;3^Q
"^DD",430,430,173,3)
Type YES if this bill is to be tracked for Due Process Notification.
"^DD",430,430,173,21,0)
^.001^4^4^3150511^^
"^DD",430,430,173,21,1,0)
This flag is set during the install post
"^DD",430,430,173,21,2,0)
initialization to identify this bill as
"^DD",430,430,173,21,3,0)
requiring a Due Process notification when and
"^DD",430,430,173,21,4,0)
if the current balance equals or exceeds $25.00.
"^DD",430,430,173,"DT")
3150325
"^DD",430,430,174,0)
DUE PROCESS REQUEST DATE^D^^20;4^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,174,3)
Enter the date of the DPN request.
"^DD",430,430,174,21,0)
^^3^3^3150325^
"^DD",430,430,174,21,1,0)
The date that the request was made to AITC
"^DD",430,430,174,21,2,0)
to send a Due Process Notification letter
"^DD",430,430,174,21,3,0)
to the patient.
"^DD",430,430,174,"DT")
3150325
"^DD",430,430,175,0)
DUE PROCESS LETTER PRINT DATE^D^^20;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,175,3)
Enter the date that the DPN letter was printed.
"^DD",430,430,175,21,0)
^^2^2^3150325^
"^DD",430,430,175,21,1,0)
The date that the Due Process Notification
"^DD",430,430,175,21,2,0)
letter was printed by AITC.
"^DD",430,430,175,"DT")
3150325
"^DD",430,430,176,0)
DUE PROCESS REFERRAL DATE^D^^20;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,176,3)
Enter the date that the bill was referred to Cross-Servicing.
"^DD",430,430,176,21,0)
^.001^2^2^3150325^^^
"^DD",430,430,176,21,1,0)
The date that the bill was referred to
"^DD",430,430,176,21,2,0)
Cross-Servicing.
"^DD",430,430,176,"DT")
3150325
"^DD",430,430,177,0)
DUE PROCESS ERROR DATE^D^^20;7^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,177,3)
Enter the date of the Due Process error.
"^DD",430,430,177,21,0)
^^3^3^3150325^
"^DD",430,430,177,21,1,0)
The date that the error codes were returned
"^DD",430,430,177,21,2,0)
for the Due Process Notification letter
"^DD",430,430,177,21,3,0)
request to AITC.
"^DD",430,430,177,"DT")
3150325
"^DD",430,430,178,0)
DUE PROCESS ERROR CODES^F^^20;8^K:$L(X)>30!($L(X)<2) X
"^DD",430,430,178,3)
Answer must be 2-30 characters in length.
"^DD",430,430,178,21,0)
^^4^4^3150325^
"^DD",430,430,178,21,1,0)
The error codes returned by AITC for the Due
"^DD",430,430,178,21,2,0)
Process Notification file sent to AITC
"^DD",430,430,178,21,3,0)
requesting that a Due Process Notification
"^DD",430,430,178,21,4,0)
letter be sent to the patient.
"^DD",430,430,178,"DT")
3150325
"^DD",430,430,191,0)
SEND TCSP RECORD 1^S^1:SEND 1 ACTION U;^19;1^Q
"^DD",430,430,191,3)
Type a '1' to set the Cross-Servicing referral flag for this debt.
"^DD",430,430,191,21,0)
^.001^3^3^3150113^^^^
"^DD",430,430,191,21,1,0)
The flag set by the unprocessable file to
"^DD",430,430,191,21,2,0)
request that a record 1 be sent for this
"^DD",430,430,191,21,3,0)
debt.
"^DD",430,430,191,"DT")
3140727
"^DD",430,430,192,0)
SEND TCSP RECORD 2^S^1:SEND 2 ACTION U;^19;2^Q
"^DD",430,430,192,3)
Type a '1' to set the Cross-Servicing referral flag for this debt.
"^DD",430,430,192,21,0)
^.001^2^2^3150113^^^^
"^DD",430,430,192,21,1,0)
The flag set by the unprocessable file to
"^DD",430,430,192,21,2,0)
request that a record 2 be sent for this debt.
"^DD",430,430,192,"DT")
3140727
"^DD",430,430,193,0)
SEND TCSP RECORD 2A^S^1:SEND 2A ACTION U;^19;3^Q
"^DD",430,430,193,3)
Type a '1' to set the Cross-Servicing referral flag for this debt.
"^DD",430,430,193,21,0)
^.001^2^2^3150113^^
"^DD",430,430,193,21,1,0)
The flag set by the unprocessable file to
"^DD",430,430,193,21,2,0)
request that a record 2A be sent for this debt.
"^DD",430,430,193,"DT")
3140727
"^DD",430,430,194,0)
SEND TCSP RECORD 2C^S^1:SEND 2C ACTION A;^19;4^Q
"^DD",430,430,194,3)
Type a '1' to set the Cross-Servicing referral flag for this debt.
"^DD",430,430,194,21,0)
^.001^2^2^3150113^^
"^DD",430,430,194,21,1,0)
The flag set by the unprocessable file to
"^DD",430,430,194,21,2,0)
request that a record 2C be sent for this debt.
"^DD",430,430,194,"DT")
3140727
"^DD",430,430,199.2,0)
STOP INTEREST ADMIN CALC^S^1:YES;^19;11^Q
"^DD",430,430,199.2,3)
Type a '1' to set the Cross-Servicing stop of interest and admin calculation.
"^DD",430,430,199.2,21,0)
^.001^3^3^3150113^^
"^DD",430,430,199.2,21,1,0)
The flag to stop interest and admin
"^DD",430,430,199.2,21,2,0)
calculation for debts referred
"^DD",430,430,199.2,21,3,0)
to Cross-Servicing.
"^DD",430,430,199.2,"DT")
3140809
"^DD",430,430,301,0)
RETURNED DATE^D^^30;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,301,3)
Type the returned date for this reconciliation record.
"^DD",430,430,301,21,0)
^.001^3^3^3150511^^^^
"^DD",430,430,301,21,1,0)
The returned date field on the reconciliation
"^DD",430,430,301,21,2,0)
file for records returned by Treasury from
"^DD",430,430,301,21,3,0)
Cross-Servicing.
"^DD",430,430,301,"DT")
3140902
"^DD",430,430,302,0)
RETURN REASON CODE^P430.5'^PRCA(430.5,^30;2^Q
"^DD",430,430,302,3)
Type a returned reason code.
"^DD",430,430,302,21,0)
^.001^3^3^3150113^^
"^DD",430,430,302,21,1,0)
The returned reason code field on the
"^DD",430,430,302,21,2,0)
reconciliation file for records returned by
"^DD",430,430,302,21,3,0)
Treasury from Cross-Servicing.
"^DD",430,430,302,"DT")
3140902
"^DD",430,430,303,0)
COMPROMISE INDICATOR^S^Y:YES;N:NO;^30;3^Q
"^DD",430,430,303,3)
Type a YES if a compromise is indicated, otherwise NO.
"^DD",430,430,303,21,0)
^.001^3^3^3150511^^^^
"^DD",430,430,303,21,1,0)
The compromise indicator field on the
"^DD",430,430,303,21,2,0)
reconciliation file for records returned by
"^DD",430,430,303,21,3,0)
Treasury from Cross-Servicing.
"^DD",430,430,303,"DT")
3141009
"^DD",430,430,304,0)
COMPROMISE AMOUNT^NJ9,2^^30;4^S:X["$" X=$P(X,"$",2) K:X'?.N.1".".2N!(X>999999)!(X<0) X
"^DD",430,430,304,3)
Type a dollar amount between 0 and 999999, 2 decimal digits.
"^DD",430,430,304,21,0)
^.001^3^3^3150113^^
"^DD",430,430,304,21,1,0)
The compromise amount field on the
"^DD",430,430,304,21,2,0)
reconciliation file for records returned by
"^DD",430,430,304,21,3,0)
Treasury from Cross-Servicing.
"^DD",430,430,304,"DT")
3140902
"^DD",430,430,305,0)
CLOSED DATE^D^^30;5^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,305,3)
Type the closed date for this reconciliation record.
"^DD",430,430,305,21,0)
^.001^3^3^3150511^^^
"^DD",430,430,305,21,1,0)
The closed date field on the reconciliation
"^DD",430,430,305,21,2,0)
file for records returned by Treasury from
"^DD",430,430,305,21,3,0)
Cross-Servicing.
"^DD",430,430,305,"DT")
3140902
"^DD",430,430,306,0)
BANKRUPTCY DATE^D^^30;6^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,306,3)
Type the date of the bankruptcy.
"^DD",430,430,306,21,0)
^.001^3^3^3150226^^^
"^DD",430,430,306,21,1,0)
The bankruptcy date field on the reconciliation
"^DD",430,430,306,21,2,0)
file for records returned by Treasury from
"^DD",430,430,306,21,3,0)
Cross-Servicing.
"^DD",430,430,306,"DT")
3150226
"^DD",430,430,307,0)
DATE OF DEATH^D^^30;7^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,307,3)
Type the date of death.
"^DD",430,430,307,21,0)
^.001^3^3^3150226^^^
"^DD",430,430,307,21,1,0)
The date of death field on the reconciliation
"^DD",430,430,307,21,2,0)
file for records returned by Treasury from
"^DD",430,430,307,21,3,0)
Cross-Servicing.
"^DD",430,430,307,"DT")
3150226
"^DD",430,430,308,0)
DATE OF DISSOLUTION^D^^30;8^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430,308,3)
Type the date of dissolution.
"^DD",430,430,308,21,0)
^.001^3^3^3150226^^^
"^DD",430,430,308,21,1,0)
The date of dissolution field on the
"^DD",430,430,308,21,2,0)
reconciliation file for records returned by
"^DD",430,430,308,21,3,0)
Treasury from Cross-Servicing.
"^DD",430,430,308,"DT")
3150226
"^DD",430,430.0171,0)
CS DECREASE ADJ TRANS NUMBER SUB-FIELD^^1^2
"^DD",430,430.0171,0,"DT")
3140621
"^DD",430,430.0171,0,"IX","B",430.0171,.01)

"^DD",430,430.0171,0,"NM","CS DECREASE ADJ TRANS NUMBER")

"^DD",430,430.0171,0,"UP")
430
"^DD",430,430.0171,.01,0)
CS DECREASE ADJ TRANS NUMBER^P433'^PRCA(433,^0;1^Q
"^DD",430,430.0171,.01,1,0)
^.1
"^DD",430,430.0171,.01,1,1,0)
430.0171^B
"^DD",430,430.0171,.01,1,1,1)
S ^PRCA(430,DA(1),17,"B",$E(X,1,30),DA)=""
"^DD",430,430.0171,.01,1,1,2)
K ^PRCA(430,DA(1),17,"B",$E(X,1,30),DA)
"^DD",430,430.0171,.01,3)
Enter a transaction number for the 5B record.
"^DD",430,430.0171,.01,21,0)
^.001^3^3^3150511^^^^
"^DD",430,430.0171,.01,21,1,0)
The transaction number in the AR Transaction
"^DD",430,430.0171,.01,21,2,0)
file (#433) for transactions to be included
"^DD",430,430.0171,.01,21,3,0)
in a 5B record to be sent to Cross-Servicing.
"^DD",430,430.0171,.01,"DT")
3140621
"^DD",430,430.0171,1,0)
SEND TCSP RECORD 5B^S^1:YES;^0;2^Q
"^DD",430,430.0171,1,3)
Type a '1' to set this transaction for transmission to Cross-Servicing.
"^DD",430,430.0171,1,21,0)
^.001^3^3^3150113^^^^
"^DD",430,430.0171,1,21,1,0)
The flag that marks this transaction to be sent
"^DD",430,430.0171,1,21,2,0)
to Cross-Servicing in a 5B record when the
"^DD",430,430.0171,1,21,3,0)
AR nightly background job is run.
"^DD",430,430.0171,1,"DT")
3140723
"^DD",430,430.0172,0)
REJECT DATE SUB-FIELD^^14^15
"^DD",430,430.0172,0,"DT")
3150612
"^DD",430,430.0172,0,"IX","B",430.0172,.01)

"^DD",430,430.0172,0,"NM","REJECT DATE")

"^DD",430,430.0172,0,"UP")
430
"^DD",430,430.0172,.01,0)
REJECT DATE^RD^^0;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",430,430.0172,.01,1,0)
^.1
"^DD",430,430.0172,.01,1,1,0)
430.0172^B
"^DD",430,430.0172,.01,1,1,1)
S ^PRCA(430,DA(1),18,"B",$E(X,1,30),DA)=""
"^DD",430,430.0172,.01,1,1,2)
K ^PRCA(430,DA(1),18,"B",$E(X,1,30),DA)
"^DD",430,430.0172,.01,1,18,0)
430^AB
"^DD",430,430.0172,.01,1,18,1)
S ^PRCA(430,"AB",$E(X,1,30),DA(1),DA)=""
"^DD",430,430.0172,.01,1,18,2)
K ^PRCA(430,"AB",$E(X,1,30),DA(1),DA)
"^DD",430,430.0172,.01,1,18,"%D",0)
^.101^2^2^3150612^^
"^DD",430,430.0172,.01,1,18,"%D",1,0)
This cross-reference supports the Cross-Servicing
"^DD",430,430.0172,.01,1,18,"%D",2,0)
reject report for rejected Cross-Servicing records.
"^DD",430,430.0172,.01,1,18,"DT")
3150116
"^DD",430,430.0172,.01,3)
Enter a date for TCSP Reject review and process.
"^DD",430,430.0172,.01,21,0)
^.001^2^2^3150612^^^^
"^DD",430,430.0172,.01,21,1,0)
The date that the Cross-Servicing record
"^DD",430,430.0172,.01,21,2,0)
was received and processed.
"^DD",430,430.0172,.01,"DT")
3150612
"^DD",430,430.0172,1,0)
REJECT SOURCE^RS^A:AITC;D:DMC;T:TREASURY;^0;2^Q
"^DD",430,430.0172,1,3)
Enter TCSP Reject Source, 'A' for AITC, 'D' for DMC, 'T' for Treasury
"^DD",430,430.0172,1,21,0)
^^1^1^3150511^
"^DD",430,430.0172,1,21,1,0)
The source of the Cross-Servicing reject records.
"^DD",430,430.0172,1,"DT")
3150303
"^DD",430,430.0172,2,0)
REJECT REASON1^RP348.5'^RC(348.5,^0;3^Q
"^DD",430,430.0172,2,3)
Type a Cross-Servicing reject reason code.
"^DD",430,430.0172,2,21,0)
^.001^1^1^3150511^^^^
"^DD",430,430.0172,2,21,1,0)
The error code that applies to this Cross-Servicing reject record.
"^DD",430,430.0172,2,"DT")
3140716
"^DD",430,430.0172,3,0)
REJECT REASON2^P348.5'^RC(348.5,^0;4^Q
"^DD",430,430.0172,3,3)
Type a Cross-Servicing reject reason code.
"^DD",430,430.0172,3,21,0)
^^1^1^3150511^
"^DD",430,430.0172,3,21,1,0)
The error code that applies to this Cross-Servicing reject record.
"^DD",430,430.0172,3,"DT")
3140716
"^DD",430,430.0172,4,0)
REJECT REASON3^P348.5'^RC(348.5,^0;5^Q
"^DD",430,430.0172,4,3)
Type a Cross-Servicing reject reason code.
"^DD",430,430.0172,4,21,0)
^^1^1^3150511^
"^DD",430,430.0172,4,21,1,0)
The error code that applies to this Cross-Servicing reject record.
"^DD",430,430.0172,4,"DT")
3140716
"^DD",430,430.0172,5,0)
REJECT REASON4^P348.5'^RC(348.5,^0;6^Q
"^DD",430,430.0172,5,3)
Type a Cross-Servicing reject reason code.
"^DD",430,430.0172,5,21,0)
^^1^1^3150511^
"^DD",430,430.0172,5,21,1,0)
The error code that applies to this Cross-Servicing reject record.
"^DD",430,430.0172,5,"DT")
3140716
"^DD",430,430.0172,6,0)
REJECT REASON5^P348.5'^RC(348.5,^0;7^Q
"^DD",430,430.0172,6,3)
Type a Cross-Servicing reject reason code.
"^DD",430,430.0172,6,21,0)
^^1^1^3150511^
"^DD",430,430.0172,6,21,1,0)
The error code that applies to this Cross-Servicing reject record.
"^DD",430,430.0172,6,"DT")
3140716
"^DD",430,430.0172,7,0)
REJECT REASON6^P348.5'^RC(348.5,^0;8^Q
"^DD",430,430.0172,7,3)
Type a Cross-Servicing reject reason code.
"^DD",430,430.0172,7,21,0)
^^1^1^3150511^
"^DD",430,430.0172,7,21,1,0)
The error code that applies to this Cross-Servicing reject record.
"^DD",430,430.0172,7,"DT")
3140716
"^DD",430,430.0172,8,0)
REJECT REASON7^P348.5'^RC(348.5,^0;9^Q
"^DD",430,430.0172,8,3)
Type a Cross-Servicing reject reason code.
"^DD",430,430.0172,8,21,0)
^^1^1^3150511^
"^DD",430,430.0172,8,21,1,0)
The error code that applies to this Cross-Servicing reject record.
"^DD",430,430.0172,8,"DT")
3140716
"^DD",430,430.0172,9,0)
REJECT REASON8^P348.5'^RC(348.5,^0;10^Q
"^DD",430,430.0172,9,3)
Type a Cross-Servicing reject reason code.
"^DD",430,430.0172,9,21,0)
^.001^1^1^3150511^^
"^DD",430,430.0172,9,21,1,0)
The error code that applies to this Cross-Servicing reject record.
"^DD",430,430.0172,9,"DT")
3140716
"^DD",430,430.0172,10,0)
REJECT REASON9^P348.5'^RC(348.5,^0;11^Q
"^DD",430,430.0172,10,3)
Type a Cross-Servicing reject reason code.
"^DD",430,430.0172,10,21,0)
^^1^1^3150511^
"^DD",430,430.0172,10,21,1,0)
The error code that applies to this Cross-Servicing reject record.
"^DD",430,430.0172,10,"DT")
3140716
"^DD",430,430.0172,11,0)
RECORD TYPE^RP348.7'^RC(348.7,^0;12^Q
"^DD",430,430.0172,11,3)
Type the record type for this Cross-Servicing reject record.
"^DD",430,430.0172,11,21,0)
^^1^1^3150511^
"^DD",430,430.0172,11,21,1,0)
The record type that is associated with this Cross-Servicing reject record.
"^DD",430,430.0172,11,"DT")
3140909
"^DD",430,430.0172,12,0)
RECORD ACTION CODE^RP348.6'^RC(348.6,^0;13^Q
"^DD",430,430.0172,12,3)
Type this action code of this Cross-Servicing reject record.
"^DD",430,430.0172,12,21,0)
^^1^1^3150511^
"^DD",430,430.0172,12,21,1,0)
The action code of this Cross-Servicing record.
"^DD",430,430.0172,12,"DT")
3140909
"^DD",430,430.0172,13,0)
REJECT BATCH ID^RNJ8,0^^0;14^K:+X'=X!(X>99999999)!(X<40000000)!(X?.E1"."1N.N) X
"^DD",430,430.0172,13,3)
Type a number between 40000000 and 99999999, 0 decimal digits.
"^DD",430,430.0172,13,21,0)
^.001^2^2^3150511^^
"^DD",430,430.0172,13,21,1,0)
This is the AITC Reject File Batch Control ID which in the format YDOYnnnn
"^DD",430,430.0172,13,21,2,0)
where Y=last digit of year, DOY=day of year, nnnn=seq Batch number (i.e. 42910001)
"^DD",430,430.0172,13,"DT")
3141103
"^DD",430,430.0172,14,0)
REJECT MM MSG NO.^RNJ8,0^^0;15^K:+X'=X!(X>99999999)!(X<1)!(X?.E1"."1N.N) X
"^DD",430,430.0172,14,3)
Type a number between 1 and 99999999, 0 decimal digits.
"^DD",430,430.0172,14,21,0)
^^2^2^3150511^
"^DD",430,430.0172,14,21,1,0)
The MailMan message number associated with this
"^DD",430,430.0172,14,21,2,0)
Cross-Servicing reject record.
"^DD",430,430.0172,14,"DT")
3141124
"^DD",430.5,430.5,0)
FIELD^^2^3
"^DD",430.5,430.5,0,"DT")
3140902
"^DD",430.5,430.5,0,"IX","B",430.5,.01)

"^DD",430.5,430.5,0,"NM","AR RETURN REASON CODE")

"^DD",430.5,430.5,0,"PT",430,302)

"^DD",430.5,430.5,0,"VRPK")
PRCA
"^DD",430.5,430.5,.01,0)
CODE^RF^^0;1^K:$L(X)>1!($L(X)<1)!'(X'?1P.E) X
"^DD",430.5,430.5,.01,1,0)
^.1
"^DD",430.5,430.5,.01,1,1,0)
430.5^B
"^DD",430.5,430.5,.01,1,1,1)
S ^PRCA(430.5,"B",$E(X,1,30),DA)=""
"^DD",430.5,430.5,.01,1,1,2)
K ^PRCA(430.5,"B",$E(X,1,30),DA)
"^DD",430.5,430.5,.01,3)
Answer must be 1 character in length.
"^DD",430.5,430.5,.01,21,0)
^.001^3^3^3150113^^
"^DD",430.5,430.5,.01,21,1,0)
The returned reason code field on the
"^DD",430.5,430.5,.01,21,2,0)
reconciliation file for records returned by
"^DD",430.5,430.5,.01,21,3,0)
Treasury from Cross-Servicing.
"^DD",430.5,430.5,.01,"DT")
3140902
"^DD",430.5,430.5,1,0)
DESCRIPTION^F^^0;2^K:$L(X)>70!($L(X)<1) X
"^DD",430.5,430.5,1,3)
Answer must be 1-70 characters in length.
"^DD",430.5,430.5,1,21,0)
^.001^3^3^3150511^^^
"^DD",430.5,430.5,1,21,1,0)
The text description of the returned reason
"^DD",430.5,430.5,1,21,2,0)
code on the reconciliation file for records
"^DD",430.5,430.5,1,21,3,0)
returned by Treasury from Cross-Servicing.
"^DD",430.5,430.5,1,"DT")
3140902
"^DD",430.5,430.5,2,0)
CATEGORY^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",430.5,430.5,2,3)
Answer must be 1-30 characters in length.
"^DD",430.5,430.5,2,21,0)
^.001^3^3^3150113^^
"^DD",430.5,430.5,2,21,1,0)
The category of the returned reason code
"^DD",430.5,430.5,2,21,2,0)
of the reconciliation file for records
"^DD",430.5,430.5,2,21,3,0)
returned by Treasury from Cross-Servicing.
"^DD",430.5,430.5,2,"DT")
3140902
"^DIC",348.5,348.5,0)
TCS IAI ERROR CODES^348.5
"^DIC",348.5,348.5,0,"GL")
^RC(348.5,
"^DIC",348.5,348.5,"%D",0)
^1.001^5^5^3150612^^^
"^DIC",348.5,348.5,"%D",1,0)
This file holds the Cross-Servicing error codes for the
"^DIC",348.5,348.5,"%D",2,0)
Integrated Agency Interface (IAI) file transmission of
"^DIC",348.5,348.5,"%D",3,0)
debt/debtor records into FedDebt.
"^DIC",348.5,348.5,"%D",4,0)
  
"^DIC",348.5,348.5,"%D",5,0)
Per VA Directive 6402, this file should not be modified.
"^DIC",348.5,"B","TCS IAI ERROR CODES",348.5)

"^DIC",348.6,348.6,0)
TCS IAI ACTION CODES^348.6
"^DIC",348.6,348.6,0,"GL")
^RC(348.6,
"^DIC",348.6,348.6,"%D",0)
^1.001^5^5^3150612^^^
"^DIC",348.6,348.6,"%D",1,0)
This file holds the Cross-Servicing action codes for the
"^DIC",348.6,348.6,"%D",2,0)
Integrated Agency Interface (IAI) file transmission of
"^DIC",348.6,348.6,"%D",3,0)
debt/debtor records into FedDebt.
"^DIC",348.6,348.6,"%D",4,0)
  
"^DIC",348.6,348.6,"%D",5,0)
Per VA Directive 6402, this file should not be modified.
"^DIC",348.6,"B","TCS IAI ACTION CODES",348.6)

"^DIC",348.7,348.7,0)
TCS IAI RECORD TYPES^348.7
"^DIC",348.7,348.7,0,"GL")
^RC(348.7,
"^DIC",348.7,348.7,"%D",0)
^1.001^5^5^3150612^^^
"^DIC",348.7,348.7,"%D",1,0)
This file holds the Cross-Servicing record types for the
"^DIC",348.7,348.7,"%D",2,0)
Integrated Agency Interface (IAI) file transmission of
"^DIC",348.7,348.7,"%D",3,0)
debt/debtor records into FedDebt.
"^DIC",348.7,348.7,"%D",4,0)
  
"^DIC",348.7,348.7,"%D",5,0)
Per VA Directive 6402, this file should not be modified.
"^DIC",348.7,"B","TCS IAI RECORD TYPES",348.7)

"^DIC",430.5,430.5,0)
AR RETURN REASON CODE^430.5
"^DIC",430.5,430.5,0,"GL")
^PRCA(430.5,
"^DIC",430.5,430.5,"%D",0)
^^5^5^3150612^
"^DIC",430.5,430.5,"%D",1,0)
This file holds the Cross-Servicing return reason codes
"^DIC",430.5,430.5,"%D",2,0)
for the Integrated Agency Interface (IAI) file transmission
"^DIC",430.5,430.5,"%D",3,0)
of debt/debtor reconciliation file records from FedDebt.
"^DIC",430.5,430.5,"%D",4,0)
  
"^DIC",430.5,430.5,"%D",5,0)
Per VA Directive 6402, this file should not be modified.
"^DIC",430.5,"B","AR RETURN REASON CODE",430.5)

**END**
**END**
