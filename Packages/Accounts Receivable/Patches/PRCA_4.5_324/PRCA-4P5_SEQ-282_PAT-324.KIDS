EMERGENCY Released PRCA*4.5*324 SEQ #282
Extracted from mail message
**KIDS**:PRCA*4.5*324^

**INSTALL NAME**
PRCA*4.5*324
"BLD",10479,0)
PRCA*4.5*324^ACCOUNTS RECEIVABLE^0^3170317^y
"BLD",10479,1,0)
^^2^2^3170317^
"BLD",10479,1,1,0)
1. Modify internal resolution of reject reason display on profile view of 
"BLD",10479,1,2,0)
   bills.
"BLD",10479,4,0)
^9.64PA^^
"BLD",10479,6.3)
2
"BLD",10479,"ABPKG")
n
"BLD",10479,"KRN",0)
^9.67PA^779.2^20
"BLD",10479,"KRN",.4,0)
.4
"BLD",10479,"KRN",.401,0)
.401
"BLD",10479,"KRN",.402,0)
.402
"BLD",10479,"KRN",.403,0)
.403
"BLD",10479,"KRN",.5,0)
.5
"BLD",10479,"KRN",.84,0)
.84
"BLD",10479,"KRN",3.6,0)
3.6
"BLD",10479,"KRN",3.8,0)
3.8
"BLD",10479,"KRN",9.2,0)
9.2
"BLD",10479,"KRN",9.8,0)
9.8
"BLD",10479,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10479,"KRN",9.8,"NM",1,0)
RCTCSJS1^^0^B60511914
"BLD",10479,"KRN",9.8,"NM","B","RCTCSJS1",1)

"BLD",10479,"KRN",19,0)
19
"BLD",10479,"KRN",19.1,0)
19.1
"BLD",10479,"KRN",101,0)
101
"BLD",10479,"KRN",409.61,0)
409.61
"BLD",10479,"KRN",771,0)
771
"BLD",10479,"KRN",779.2,0)
779.2
"BLD",10479,"KRN",870,0)
870
"BLD",10479,"KRN",8989.51,0)
8989.51
"BLD",10479,"KRN",8989.52,0)
8989.52
"BLD",10479,"KRN",8994,0)
8994
"BLD",10479,"KRN","B",.4,.4)

"BLD",10479,"KRN","B",.401,.401)

"BLD",10479,"KRN","B",.402,.402)

"BLD",10479,"KRN","B",.403,.403)

"BLD",10479,"KRN","B",.5,.5)

"BLD",10479,"KRN","B",.84,.84)

"BLD",10479,"KRN","B",3.6,3.6)

"BLD",10479,"KRN","B",3.8,3.8)

"BLD",10479,"KRN","B",9.2,9.2)

"BLD",10479,"KRN","B",9.8,9.8)

"BLD",10479,"KRN","B",19,19)

"BLD",10479,"KRN","B",19.1,19.1)

"BLD",10479,"KRN","B",101,101)

"BLD",10479,"KRN","B",409.61,409.61)

"BLD",10479,"KRN","B",771,771)

"BLD",10479,"KRN","B",779.2,779.2)

"BLD",10479,"KRN","B",870,870)

"BLD",10479,"KRN","B",8989.51,8989.51)

"BLD",10479,"KRN","B",8989.52,8989.52)

"BLD",10479,"KRN","B",8994,8994)

"BLD",10479,"QDEF")
^^^^NO^^^^NO^^YES
"BLD",10479,"QUES",0)
^9.62^^
"BLD",10479,"REQB",0)
^9.611^1^1
"BLD",10479,"REQB",1,0)
PRCA*4.5*301^2
"BLD",10479,"REQB","B","PRCA*4.5*301",1)

"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^^0
"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
324^3170317
"PKG",142,22,1,"PAH",1,1,0)
^^2^2^3170317
"PKG",142,22,1,"PAH",1,1,1,0)
1. Modify internal resolution of reject reason display on profile view of 
"PKG",142,22,1,"PAH",1,1,2,0)
   bills.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RCTCSJS1")
0^1^B60511914^B57381357
"RTN","RCTCSJS1",1,0)
RCTCSJS1 ;ALBANY/LEG - RCTCS REFERRAL REJECTS SUPPORT RTN;02/19/14 3:21 PM
"RTN","RCTCSJS1",2,0)
V ;;4.5;Accounts Receivable;**301,324**;Mar 20, 1995;Build 2
"RTN","RCTCSJS1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSJS1",4,0)
 ;Overflow Program for RCTCSJS, to process CS REJECT server messages from AITC
"RTN","RCTCSJS1",5,0)
 ;
"RTN","RCTCSJS1",6,0)
 ;Patch PRCA*4.5*324 Modify internal resolution of reject reason
"RTN","RCTCSJS1",7,0)
 ;                   display on profile view of bills
"RTN","RCTCSJS1",8,0)
 ;
"RTN","RCTCSJS1",9,0)
 ;Variables
"RTN","RCTCSJS1",10,0)
 ; Input
"RTN","RCTCSJS1",11,0)
 ; XMZ - (r) MailMan internal message number (IEN)
"RTN","RCTCSJS1",12,0)
 ; 
"RTN","RCTCSJS1",13,0)
 ;;RCTCS REFERRAL REJECTS SUPPORT RTN
"RTN","RCTCSJS1",14,0)
 ;===============================================================================
"RTN","RCTCSJS1",15,0)
 Q  ; 
"RTN","RCTCSJS1",16,0)
PROFRJ(D0) ; displays Reject History on ACCOUNT RECEIVABLE PROFILE
"RTN","RCTCSJS1",17,0)
 ;
"RTN","RCTCSJS1",18,0)
 ; display summary
"RTN","RCTCSJS1",19,0)
 K ARY N CDINT
"RTN","RCTCSJS1",20,0)
 I '$D(^PRCA(430,D0,18)) Q  ;
"RTN","RCTCSJS1",21,0)
 W !,"CS REJECTS:" S D1=0
"RTN","RCTCSJS1",22,0)
 ; collapses rejects records 
"RTN","RCTCSJS1",23,0)
 F  S D1=$O(^PRCA(430,D0,18,D1)) Q:'D1  D  ;
"RTN","RCTCSJS1",24,0)
 . S RJREC=^PRCA(430,D0,18,D1,0)
"RTN","RCTCSJS1",25,0)
 . S FDAT=$P(RJREC,"^")   ; date
"RTN","RCTCSJS1",26,0)
 . S SRCE=$P(RJREC,"^",2) ;source
"RTN","RCTCSJS1",27,0)
 . S ERRCDS=$S($D(ARY(FDAT,SRCE)):ARY(FDAT,SRCE),1:",")
"RTN","RCTCSJS1",28,0)
 . F PC=3:1:11 S ERRCD=$P(RJREC,"^",PC) Q:'$L(ERRCD)  D  ;
"RTN","RCTCSJS1",29,0)
 . . S ARY(FDAT,SRCE,PC)=$P($G(^RC(348.5,ERRCD,0)),"^")_U_ERRCD,ERRCD=$P($G(^RC(348.5,ERRCD,0)),U)   ;PRCA*4.5*324
"RTN","RCTCSJS1",30,0)
 . . I ERRCDS'[(","_ERRCD_",") S ERRCDS=ERRCDS_ERRCD_","
"RTN","RCTCSJS1",31,0)
 . S ARY(FDAT,SRCE)=ERRCDS
"RTN","RCTCSJS1",32,0)
 . ;
"RTN","RCTCSJS1",33,0)
 S FDAT=""
"RTN","RCTCSJS1",34,0)
 F  S FDAT=$O(ARY(FDAT)),SRCE="" Q:FDAT=""  D  ; 
"RTN","RCTCSJS1",35,0)
 . S Y=FDAT D DD^%DT S EXTDAT=Y ; 
"RTN","RCTCSJS1",36,0)
 . F  S SRCE=$O(ARY(FDAT,SRCE)),CDIDX="" Q:SRCE=""  D  ;
"RTN","RCTCSJS1",37,0)
 . . S ERRCDS=$TR($E(ARY(FDAT,SRCE),2,$L(ARY(FDAT,SRCE))-1),",","-")
"RTN","RCTCSJS1",38,0)
 . . W ?12,"DATE: ",EXTDAT
"RTN","RCTCSJS1",39,0)
 . . W ?33,"CODE(s): ",ERRCDS
"RTN","RCTCSJS1",40,0)
 . . W ?71,"SOURCE: ",SRCE
"RTN","RCTCSJS1",41,0)
 . W !
"RTN","RCTCSJS1",42,0)
 ;
"RTN","RCTCSJS1",43,0)
 ; display detail
"RTN","RCTCSJS1",44,0)
 S FDAT="" N CDINT
"RTN","RCTCSJS1",45,0)
 F  S FDAT=$O(ARY(FDAT)),SRCE="" Q:FDAT=""  D  ;
"RTN","RCTCSJS1",46,0)
 . S Y=FDAT D DD^%DT S EXTDAT=Y ;
"RTN","RCTCSJS1",47,0)
 . F  S SRCE=$O(ARY(FDAT,SRCE)),CDIDX="" Q:SRCE=""  D  ; 
"RTN","RCTCSJS1",48,0)
 . . W !!,"CS REJECT DATE:",?16,EXTDAT
"RTN","RCTCSJS1",49,0)
 . . W ?34,"REJECT SOURCE: ",SRCE
"RTN","RCTCSJS1",50,0)
 . . F RR=1:1 S CDIDX=$O(ARY(FDAT,SRCE,CDIDX)) Q:CDIDX=""  D  ;
"RTN","RCTCSJS1",51,0)
 . . . W !?2,"REJECT REASON",RR,":"
"RTN","RCTCSJS1",52,0)
 . . . W ?18,$P(ARY(FDAT,SRCE,CDIDX),U) S CDINT=$P(ARY(FDAT,SRCE,CDIDX),U,2) ; code   ;PRCA*4.5*324
"RTN","RCTCSJS1",53,0)
 . . . S (X,DESC)=$P(^RC(348.5,CDINT,0),"^",2)_"~"_$G(^RC(348.5,CDINT,1))   ;PRCA*4.5*324
"RTN","RCTCSJS1",54,0)
 . . . I $L(DESC)<60 S ARY(FDAT,SRCE,CDIDX,1)=X
"RTN","RCTCSJS1",55,0)
 . . . I $L(DESC)>59 D  ;
"RTN","RCTCSJS1",56,0)
 . . . . F LN=1:1 S STR=$E(X,1,59) D  Q:'$L(X)  ;
"RTN","RCTCSJS1",57,0)
 . . . . . I $L(X)<60 S ARY(FDAT,SRCE,CDIDX,LN)=X,X="" Q
"RTN","RCTCSJS1",58,0)
 . . . . . F L=$L(STR):-1:1 I $F(STR," ",L) S ARY(FDAT,SRCE,CDIDX,LN)=$E(X,1,L),X=$E(X,L+1,999) Q  ;
"RTN","RCTCSJS1",59,0)
 . . . F LN=1:1 Q:'$D(ARY(FDAT,SRCE,CDIDX,LN))  W:LN>1 ! W ?21,ARY(FDAT,SRCE,CDIDX,LN)
"RTN","RCTCSJS1",60,0)
 . W !
"RTN","RCTCSJS1",61,0)
 Q  ;
"RTN","RCTCSJS1",62,0)
 ;
"RTN","RCTCSJS1",63,0)
PROFRJA(D0,LN,OUTARY) ; sets into ^TMP Reject History on BILL PROFILE
"RTN","RCTCSJS1",64,0)
 ;
"RTN","RCTCSJS1",65,0)
 ; display summary
"RTN","RCTCSJS1",66,0)
 S BLANK="",$P(BLANK," ",99)=""
"RTN","RCTCSJS1",67,0)
 K ARY,OUTARY N CDINT
"RTN","RCTCSJS1",68,0)
 I '$D(^PRCA(430,D0,18)) Q  ;
"RTN","RCTCSJS1",69,0)
 S LN=LN+1,OUTARY(LN,0)="CS REJECTS: " S D1=0
"RTN","RCTCSJS1",70,0)
 ; collapses rejects records 
"RTN","RCTCSJS1",71,0)
 F  S D1=$O(^PRCA(430,D0,18,D1)) Q:'D1  D  ;
"RTN","RCTCSJS1",72,0)
 . S RJREC=^PRCA(430,D0,18,D1,0)
"RTN","RCTCSJS1",73,0)
 . S FDAT=$P(RJREC,"^")   ; date
"RTN","RCTCSJS1",74,0)
 . S SRCE=$P(RJREC,"^",2) ;source
"RTN","RCTCSJS1",75,0)
 . S ERRCDS=$S($D(ARY(FDAT,SRCE)):ARY(FDAT,SRCE),1:",")
"RTN","RCTCSJS1",76,0)
 . F PC=3:1:11 S ERRCD=$P(RJREC,"^",PC) Q:'$L(ERRCD)  D  ;
"RTN","RCTCSJS1",77,0)
 . . S ARY(FDAT,SRCE,PC)=$P(^RC(348.5,ERRCD,0),"^")_U_ERRCD,ERRCD=$P($G(^RC(348.5,ERRCD,0)),U)   ;PRCA*4.5*324
"RTN","RCTCSJS1",78,0)
 . . I ERRCDS'[(","_ERRCD_",") S ERRCDS=ERRCDS_ERRCD_","
"RTN","RCTCSJS1",79,0)
 . S ARY(FDAT,SRCE)=ERRCDS
"RTN","RCTCSJS1",80,0)
 . ;
"RTN","RCTCSJS1",81,0)
 S FDAT=""
"RTN","RCTCSJS1",82,0)
 F  S FDAT=$O(ARY(FDAT)),SRCE="" Q:FDAT=""  D  ; 
"RTN","RCTCSJS1",83,0)
 . S Y=FDAT D DD^%DT S EXTDAT=Y ; 
"RTN","RCTCSJS1",84,0)
 . F  S SRCE=$O(ARY(FDAT,SRCE)),CDIDX="" Q:SRCE=""  D  ;
"RTN","RCTCSJS1",85,0)
 . . S ERRCDS=$TR($E(ARY(FDAT,SRCE),2,$L(ARY(FDAT,SRCE))-1),",","-")
"RTN","RCTCSJS1",86,0)
 . . S OUTARY(LN,0)=$E(OUTARY(LN,0)_BLANK,1,11)_"DATE: "_EXTDAT
"RTN","RCTCSJS1",87,0)
 . . S OUTARY(LN,0)=$E(OUTARY(LN,0)_BLANK,1,32)_"CODE(s): "_ERRCDS
"RTN","RCTCSJS1",88,0)
 . . S OUTARY(LN,0)=$E(OUTARY(LN,0)_BLANK,1,70)_"SOURCE: "_SRCE
"RTN","RCTCSJS1",89,0)
 . S LN=LN+1,OUTARY(LN,0)=""
"RTN","RCTCSJS1",90,0)
 ;
"RTN","RCTCSJS1",91,0)
 ; display detail
"RTN","RCTCSJS1",92,0)
 S FDAT=""
"RTN","RCTCSJS1",93,0)
 F  S FDAT=$O(ARY(FDAT)),SRCE="" Q:FDAT=""  D  ;
"RTN","RCTCSJS1",94,0)
 . S Y=FDAT D DD^%DT S EXTDAT=Y ;
"RTN","RCTCSJS1",95,0)
 . F  S SRCE=$O(ARY(FDAT,SRCE)),CDIDX="" Q:SRCE=""  D  ; 
"RTN","RCTCSJS1",96,0)
 . . S LN=LN+1,(OUTARY(LN,0),OUTARY(LN+1,0))=""
"RTN","RCTCSJS1",97,0)
 . . S LN=LN+1,OUTARY(LN,0)="CS REJECT DATE: "_EXTDAT
"RTN","RCTCSJS1",98,0)
 . . S OUTARY(LN,0)=$E(OUTARY(LN,0)_BLANK,1,34)_"REJECT SOURCE: "_SRCE
"RTN","RCTCSJS1",99,0)
 . . F RR=1:1 S CDIDX=$O(ARY(FDAT,SRCE,CDIDX)) Q:CDIDX=""  D  ;
"RTN","RCTCSJS1",100,0)
 . . . S LN=LN+1,OUTARY(LN,0)="  REJECT REASON"_RR_": "
"RTN","RCTCSJS1",101,0)
 . . . S OUTARY(LN,0)=OUTARY(LN,0)_$P(ARY(FDAT,SRCE,CDIDX),U)_" ",CDINT=$P(ARY(FDAT,SRCE,CDIDX),U,2) ; code   ;PRCA*4.5*324
"RTN","RCTCSJS1",102,0)
 . . . S (X,DESC)=$P(^RC(348.5,CDINT,0),"^",2)_"~"_$G(^RC(348.5,CDINT,1))   ;PRCA*4.5*324
"RTN","RCTCSJS1",103,0)
 . . . I $L(DESC)<60 S ARY(FDAT,SRCE,CDIDX,1)=X
"RTN","RCTCSJS1",104,0)
 . . . I $L(DESC)>59 D  ;
"RTN","RCTCSJS1",105,0)
 . . . . F LN2=1:1 S STR=$E(X,1,59) D  Q:'$L(X)  ;
"RTN","RCTCSJS1",106,0)
 . . . . . I $L(X)<60 S ARY(FDAT,SRCE,CDIDX,LN2)=X,X="" Q
"RTN","RCTCSJS1",107,0)
 . . . . . F L=$L(STR):-1:1 I $F(STR," ",L) S ARY(FDAT,SRCE,CDIDX,LN2)=$E(X,1,L),X=$E(X,L+1,999) Q  ;
"RTN","RCTCSJS1",108,0)
 . . . F LN2=1:1 Q:'$D(ARY(FDAT,SRCE,CDIDX,LN2))  D  ;
"RTN","RCTCSJS1",109,0)
 . . . . S:LN2>1 LN=LN+1,OUTARY(LN,0)="                     "
"RTN","RCTCSJS1",110,0)
 . . . . S OUTARY(LN,0)=OUTARY(LN,0)_ARY(FDAT,SRCE,CDIDX,LN2)
"RTN","RCTCSJS1",111,0)
 . S LN=LN+1,OUTARY(LN,0)=""
"RTN","RCTCSJS1",112,0)
 Q  ;
"RTN","RCTCSJS1",113,0)
 ;
"RTN","RCTCSJS1",114,0)
SENDBUL ;
"RTN","RCTCSJS1",115,0)
 I '$G(BADQUE) D  ;
"RTN","RCTCSJS1",116,0)
 . S FROM=$G(H4DATE)_$G(ZBAT1),TO=$G(H4DATE)_$G(ZBAT2)
"RTN","RCTCSJS1",117,0)
 . S BATMSG="     from MM Message"_$S(XMZ1=XMZ2:": "_XMZ1,1:"es: "_XMZ1_" to "_XMZ2)
"RTN","RCTCSJS1",118,0)
 . S BATMSG=BATMSG_"     from Batch"_$S(FROM=TO:": "_FROM,1:"es: "_FROM_" to "_TO)
"RTN","RCTCSJS1",119,0)
 ;
"RTN","RCTCSJS1",120,0)
 D NOW^%DTC,YX^%DTC
"RTN","RCTCSJS1",121,0)
 S DTTM=$E(Y,5,6)_" "_$E(Y,1,3)_" "_$E(Y,11,12)_" "_$E(Y,14,18)_" "
"RTN","RCTCSJS1",122,0)
 ;
"RTN","RCTCSJS1",123,0)
 ; If there is no Source data or Errors, check and send Bulletin Data if available
"RTN","RCTCSJS1",124,0)
 I $O(^XTMP("RCTCSJS",$J,"SRC",""))=""&($O(^XTMP("RCTCSJS",$J,"ERR",""))="") D BULERR
"RTN","RCTCSJS1",125,0)
 ;
"RTN","RCTCSJS1",126,0)
 F SOURCE="AITC","DMC","TREASURY" S SRC=$E(SOURCE) I $D(^XTMP("RCTCSJS",$J,"SRC",SRC)) D  ;
"RTN","RCTCSJS1",127,0)
 . D REJMSG
"RTN","RCTCSJS1",128,0)
 . D ALPHA
"RTN","RCTCSJS1",129,0)
 . S XMSUB="CS REJECTS ("_SOURCE_") ["_XMZ_"] "_DTTM_" "_CNTR_" lines"
"RTN","RCTCSJS1",130,0)
 . D SEND
"RTN","RCTCSJS1",131,0)
 . ;
"RTN","RCTCSJS1",132,0)
 Q
"RTN","RCTCSJS1",133,0)
SENDERR ;
"RTN","RCTCSJS1",134,0)
 I $D(^XTMP("RCTCSJS",$J,"ERR")) D  ;
"RTN","RCTCSJS1",135,0)
 . S SOURCES=""
"RTN","RCTCSJS1",136,0)
 . F SRCPC=1:1:3 Q:$E(CSRCS,SRCPC)=""  D
"RTN","RCTCSJS1",137,0)
 . . S SOURCE=$P("???,AITC,DMC,TREASURY",",",$F("ADT",$E(CSRCS,SRCPC)))
"RTN","RCTCSJS1",138,0)
 . . S SOURCES=SOURCES_","_$S(SOURCE="":"???",1:SOURCE)
"RTN","RCTCSJS1",139,0)
 . S SOURCES=$E(SOURCES,2,999)
"RTN","RCTCSJS1",140,0)
 . I '$L(SOURCES) S SOURCES="UNSPECIFIED SOURCE"
"RTN","RCTCSJS1",141,0)
 . D ERRMSG
"RTN","RCTCSJS1",142,0)
 . D ERRSFND
"RTN","RCTCSJS1",143,0)
 . S XMSUB="CS ("_SOURCES_") REJECT RECORD ***ERRORS FOUND***  ["_XMZ_"] "_DTTM_" "_CNTR_" lines"
"RTN","RCTCSJS1",144,0)
 . D SEND
"RTN","RCTCSJS1",145,0)
 . ;
"RTN","RCTCSJS1",146,0)
 Q  ;
"RTN","RCTCSJS1",147,0)
CLEANUP ; This cleans up the ^XTMP global.
"RTN","RCTCSJS1",148,0)
 ;K ^XTMP("RCTCSJS",$J)
"RTN","RCTCSJS1",149,0)
 Q
"RTN","RCTCSJS1",150,0)
 ;
"RTN","RCTCSJS1",151,0)
BULERR ;  If there is Bulletin data, send email with error or note
"RTN","RCTCSJS1",152,0)
 N HIT,CNT,CNTR
"RTN","RCTCSJS1",153,0)
 S HIT=0,CNT=""
"RTN","RCTCSJS1",154,0)
 I $O(^XTMP("RCTCSJS",$J,"BULTN",""))'="" S HIT=1
"RTN","RCTCSJS1",155,0)
 I 'HIT Q
"RTN","RCTCSJS1",156,0)
 S CNTR=$O(^XTMP("RCTCSJS",$J,"REC",$G(CNTR)),-1)
"RTN","RCTCSJS1",157,0)
 S CNTR=CNTR+1
"RTN","RCTCSJS1",158,0)
 S ^XTMP("RCTCSJS",$J,"REC",CNTR)="The following CS REJECTS transmissions have been processed"
"RTN","RCTCSJS1",159,0)
 S CNTR=CNTR+1
"RTN","RCTCSJS1",160,0)
 S ^XTMP("RCTCSJS",$J,"REC",CNTR)=BATMSG
"RTN","RCTCSJS1",161,0)
 F  S CNT=$O(^XTMP("RCTCSJS",$J,"BULTN",CNT)) Q:CNT=""  S BULDAT=^(CNT) D
"RTN","RCTCSJS1",162,0)
 . S CNTR=CNTR+1
"RTN","RCTCSJS1",163,0)
 . S ^XTMP("RCTCSJS",$J,"REC",CNTR)=BULDAT
"RTN","RCTCSJS1",164,0)
 S XMSUB="CS REJECTS ["_XMZ_"] "_DTTM_" "_CNTR_" lines"
"RTN","RCTCSJS1",165,0)
 D SEND
"RTN","RCTCSJS1",166,0)
 Q  ; BULERR
"RTN","RCTCSJS1",167,0)
 ;
"RTN","RCTCSJS1",168,0)
REJMSG ;Send list of rejected documents
"RTN","RCTCSJS1",169,0)
 S ^XTMP("RCTCSJS",$J,"REC",1)="The following CS DEBT REFERRAL transmissions have been rejected"
"RTN","RCTCSJS1",170,0)
 S ^XTMP("RCTCSJS",$J,"REC",2)=BATMSG
"RTN","RCTCSJS1",171,0)
 S ^XTMP("RCTCSJS",$J,"REC",3)=""
"RTN","RCTCSJS1",172,0)
 S ^XTMP("RCTCSJS",$J,"REC",4)="NAME                 SSN       BILL NUMBER TYPE ACTN ERROR CODES"
"RTN","RCTCSJS1",173,0)
 S ^XTMP("RCTCSJS",$J,"REC",5)=""
"RTN","RCTCSJS1",174,0)
 S CNTR=5
"RTN","RCTCSJS1",175,0)
 Q  ; REJMSG
"RTN","RCTCSJS1",176,0)
ALPHA ; orders BULLETIN by SRC, Patient NAME, BILL NO. sequence
"RTN","RCTCSJS1",177,0)
 S NAM=""
"RTN","RCTCSJS1",178,0)
 F  S NAM=$O(^XTMP("RCTCSJS",$J,"SRC",SRC,NAM)),SBILL="" Q:NAM=""  D  ;
"RTN","RCTCSJS1",179,0)
 . F  S SBILL=$O(^XTMP("RCTCSJS",$J,"SRC",SRC,NAM,SBILL)),BLTNCNT="" Q:SBILL=""  D  ;
"RTN","RCTCSJS1",180,0)
 .. F  S BLTNCNT=$O(^XTMP("RCTCSJS",$J,"SRC",SRC,NAM,SBILL,BLTNCNT)) Q:BLTNCNT=""  D  ;
"RTN","RCTCSJS1",181,0)
 ... S BLTNREC=^XTMP("RCTCSJS",$J,"BULTN",BLTNCNT)
"RTN","RCTCSJS1",182,0)
 ... S CNTR=CNTR+1,^XTMP("RCTCSJS",$J,"REC",CNTR)=BLTNREC
"RTN","RCTCSJS1",183,0)
 Q  ;
"RTN","RCTCSJS1",184,0)
 ;
"RTN","RCTCSJS1",185,0)
ERRMSG ;Send list of ERRORS FOUND document
"RTN","RCTCSJS1",186,0)
 S ^XTMP("RCTCSJS",$J,"REC",1)="The following **ERRORS** found in the ("_SOURCES_") CS DEBT REFERRAL Reject File"
"RTN","RCTCSJS1",187,0)
 S ^XTMP("RCTCSJS",$J,"REC",2)=BATMSG
"RTN","RCTCSJS1",188,0)
 S ^XTMP("RCTCSJS",$J,"REC",3)=""
"RTN","RCTCSJS1",189,0)
 S ^XTMP("RCTCSJS",$J,"REC",4)="  #  REC#    TYPE OF ERROR ENCOUNTERED                                       "
"RTN","RCTCSJS1",190,0)
 S ^XTMP("RCTCSJS",$J,"REC",5)=""
"RTN","RCTCSJS1",191,0)
 S CNTR=5
"RTN","RCTCSJS1",192,0)
 Q  ; ERRMSG
"RTN","RCTCSJS1",193,0)
 ;
"RTN","RCTCSJS1",194,0)
ERRSFND ; places ERRORS FOUND records into BULLETIN sequence
"RTN","RCTCSJS1",195,0)
 ;      S ^XTMP("RCTCSJS",$J,"ERR",ERRCNT)=RECN_U_ERRDATA
"RTN","RCTCSJS1",196,0)
 S ERRCNT=0
"RTN","RCTCSJS1",197,0)
 F  S ERRCNT=$O(^XTMP("RCTCSJS",$J,"ERR",ERRCNT)) Q:'ERRCNT  D  ;
"RTN","RCTCSJS1",198,0)
 . S REC=^XTMP("RCTCSJS",$J,"ERR",ERRCNT)
"RTN","RCTCSJS1",199,0)
 . S RECN=$P(REC,U),ERRDATA=$P(REC,U,2)
"RTN","RCTCSJS1",200,0)
 . S ERRREC=$E($J(ERRCNT,4)_BLNKS,1,5)_$E(RECN_BLNKS,1,8)_$E(ERRDATA_BLNKS,1,66)
"RTN","RCTCSJS1",201,0)
 . S CNTR=CNTR+1
"RTN","RCTCSJS1",202,0)
 . S ^XTMP("RCTCSJS",$J,"REC",CNTR)=ERRREC
"RTN","RCTCSJS1",203,0)
 Q  ; ERRSFND
"RTN","RCTCSJS1",204,0)
 ;
"RTN","RCTCSJS1",205,0)
SEND ;
"RTN","RCTCSJS1",206,0)
 S XMY("G.TCSP")="",XMDUZ="AR PACKAGE",XMTEXT="^XTMP(""RCTCSJS"","_$J_",""REC"","
"RTN","RCTCSJS1",207,0)
 D ^XMD
"RTN","RCTCSJS1",208,0)
 Q
"VER")
8.0^22.0
"BLD",10479,6)
^282
**END**
**END**

