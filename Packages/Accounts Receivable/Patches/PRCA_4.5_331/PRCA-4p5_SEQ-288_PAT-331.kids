EMERGENCY Released PRCA*4.5*331 SEQ #288
Extracted from mail message
**KIDS**:PRCA*4.5*331^

**INSTALL NAME**
PRCA*4.5*331
"BLD",10673,0)
PRCA*4.5*331^ACCOUNTS RECEIVABLE^0^3170811^y
"BLD",10673,1,0)
^^3^3^3170803^^^^
"BLD",10673,1,1,0)
The weekly TCSP (Treasury Cross Service) batch run at site does not set 
"BLD",10673,1,2,0)
the correct address information in the C2CA message segment for veterans 
"BLD",10673,1,3,0)
living in a foreign country.
"BLD",10673,4,0)
^9.64PA^^
"BLD",10673,6.3)
3
"BLD",10673,"ABPKG")
n
"BLD",10673,"KRN",0)
^9.67PA^779.2^20
"BLD",10673,"KRN",.4,0)
.4
"BLD",10673,"KRN",.401,0)
.401
"BLD",10673,"KRN",.402,0)
.402
"BLD",10673,"KRN",.403,0)
.403
"BLD",10673,"KRN",.5,0)
.5
"BLD",10673,"KRN",.84,0)
.84
"BLD",10673,"KRN",3.6,0)
3.6
"BLD",10673,"KRN",3.8,0)
3.8
"BLD",10673,"KRN",9.2,0)
9.2
"BLD",10673,"KRN",9.8,0)
9.8
"BLD",10673,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10673,"KRN",9.8,"NM",1,0)
RCTCSP1^^0^B174226266
"BLD",10673,"KRN",9.8,"NM","B","RCTCSP1",1)

"BLD",10673,"KRN",19,0)
19
"BLD",10673,"KRN",19.1,0)
19.1
"BLD",10673,"KRN",101,0)
101
"BLD",10673,"KRN",409.61,0)
409.61
"BLD",10673,"KRN",771,0)
771
"BLD",10673,"KRN",779.2,0)
779.2
"BLD",10673,"KRN",870,0)
870
"BLD",10673,"KRN",8989.51,0)
8989.51
"BLD",10673,"KRN",8989.52,0)
8989.52
"BLD",10673,"KRN",8994,0)
8994
"BLD",10673,"KRN","B",.4,.4)

"BLD",10673,"KRN","B",.401,.401)

"BLD",10673,"KRN","B",.402,.402)

"BLD",10673,"KRN","B",.403,.403)

"BLD",10673,"KRN","B",.5,.5)

"BLD",10673,"KRN","B",.84,.84)

"BLD",10673,"KRN","B",3.6,3.6)

"BLD",10673,"KRN","B",3.8,3.8)

"BLD",10673,"KRN","B",9.2,9.2)

"BLD",10673,"KRN","B",9.8,9.8)

"BLD",10673,"KRN","B",19,19)

"BLD",10673,"KRN","B",19.1,19.1)

"BLD",10673,"KRN","B",101,101)

"BLD",10673,"KRN","B",409.61,409.61)

"BLD",10673,"KRN","B",771,771)

"BLD",10673,"KRN","B",779.2,779.2)

"BLD",10673,"KRN","B",870,870)

"BLD",10673,"KRN","B",8989.51,8989.51)

"BLD",10673,"KRN","B",8989.52,8989.52)

"BLD",10673,"KRN","B",8994,8994)

"BLD",10673,"QDEF")
^^^^NO^^^^^^NO
"BLD",10673,"QUES",0)
^9.62^^
"BLD",10673,"REQB",0)
^9.611^1^1
"BLD",10673,"REQB",1,0)
PRCA*4.5*301^2
"BLD",10673,"REQB","B","PRCA*4.5*301",1)

"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^^0
"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
331^3170811
"PKG",142,22,1,"PAH",1,1,0)
^^3^3^3170811
"PKG",142,22,1,"PAH",1,1,1,0)
The weekly TCSP (Treasury Cross Service) batch run at site does not set 
"PKG",142,22,1,"PAH",1,1,2,0)
the correct address information in the C2CA message segment for veterans 
"PKG",142,22,1,"PAH",1,1,3,0)
living in a foreign country.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RCTCSP1")
0^1^B174226266^B168147966
"RTN","RCTCSP1",1,0)
RCTCSP1 ;ALBANY/BDB-CROSS-SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSP1",2,0)
 ;;4.5;Accounts Receivable;**301,331**;Mar 20, 1995;Build 3
"RTN","RCTCSP1",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP1",4,0)
 ;
"RTN","RCTCSP1",5,0)
 ;PRCA*4.5*331 Modify code to ensure that the debtor address info
"RTN","RCTCSP1",6,0)
 ;             is correct on transmission of foreign veterans 
"RTN","RCTCSP1",7,0)
 ;             debtor/bills to Treasury.
"RTN","RCTCSP1",8,0)
 Q
"RTN","RCTCSP1",9,0)
 ;
"RTN","RCTCSP1",10,0)
BILLREP ;cross-servicing bill report, prints individual bills that make up a cross-servicing account
"RTN","RCTCSP1",11,0)
 N DIC,DEBTOR,ZTSAVE,ZTDESC,ZTRTN,POP
"RTN","RCTCSP1",12,0)
 S DIC=340,DIC(0)="AEQM",DIC("S")="I $D(^RCD(340,""TCSP"",+Y))" D ^DIC
"RTN","RCTCSP1",13,0)
 Q:Y<1  S DEBTOR=+Y
"RTN","RCTCSP1",14,0)
 K IOP,IO("Q") S %ZIS="MQ",%ZIS("B")="" D ^%ZIS G:POP BILLREPQ S IOP=ION_";"_IOM_";"_IOSL
"RTN","RCTCSP1",15,0)
 I $D(IO("Q")) D  G BILLREPQ
"RTN","RCTCSP1",16,0)
    .S ZTSAVE("DEBTOR")=""
"RTN","RCTCSP1",17,0)
    .S ZTRTN="BILLREPP^RCTCSP1",ZTDESC="CROSS-SERVICING BILL REPORT"
"RTN","RCTCSP1",18,0)
    .D ^%ZTLOAD,HOME^%ZIS
"RTN","RCTCSP1",19,0)
    .Q
"RTN","RCTCSP1",20,0)
 ;
"RTN","RCTCSP1",21,0)
BILLREPP ;Call to build array of bills referred
"RTN","RCTCSP1",22,0)
 U IO
"RTN","RCTCSP1",23,0)
 N BILL,B7,B14,B15,B16,D4,FND,BAMT,TAMT,DIRUT,TNM,TID,TDT,DASH,CSTAT,PAGE,DASH,TMP,I
"RTN","RCTCSP1",24,0)
 S DASH="",$P(DASH,"-",81)=""
"RTN","RCTCSP1",25,0)
 S (BAMT,TAMT,BILL,PAGE)=0 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:('BILL)!($D(DIRUT))  D
"RTN","RCTCSP1",26,0)
 .Q:'+$G(^PRCA(430,BILL,15))
"RTN","RCTCSP1",27,0)
 .S B7=$G(^PRCA(430,BILL,7))
"RTN","RCTCSP1",28,0)
 .S BAMT=0 F I=1:1:5 S BAMT=BAMT+$P(B7,U,I)
"RTN","RCTCSP1",29,0)
 .S TAMT=TAMT+BAMT
"RTN","RCTCSP1",30,0)
 D BILLREPH
"RTN","RCTCSP1",31,0)
 S (FND,BILL)=0 F  S BILL=$O(^PRCA(430,"C",DEBTOR,BILL)) Q:('BILL)!($D(DIRUT))  D
"RTN","RCTCSP1",32,0)
    .Q:'+$G(^PRCA(430,BILL,15))
"RTN","RCTCSP1",33,0)
    .S FND=1 W !,$P(^PRCA(430,BILL,0),U) S CSTAT=$P(^(0),U,8),B7=$G(^(7)),B15=$G(^(15)),B16=$G(^(16))
"RTN","RCTCSP1",34,0)
    .W ?13,$P(^PRCA(430.3,CSTAT,0),U,2)
"RTN","RCTCSP1",35,0)
    .W ?17,$J($P(B16,U,9),8,2)
"RTN","RCTCSP1",36,0)
    .S BAMT=0 F I=1:1:5 S BAMT=BAMT+$P(B7,U,I)
"RTN","RCTCSP1",37,0)
    .W ?27,$J(BAMT,8,2)
"RTN","RCTCSP1",38,0)
    .W $J($P(B7,U,1),10,2)
"RTN","RCTCSP1",39,0)
    .W $J($P(B7,U,2),7,2)
"RTN","RCTCSP1",40,0)
    .W $J($P(B7,U,3),7,2)
"RTN","RCTCSP1",41,0)
    .W $J($P(B7,U,4),8,2)
"RTN","RCTCSP1",42,0)
    .S TMP=$$UPPER^VALM1($$FMTE^XLFDT($P(B15,U,1)))
"RTN","RCTCSP1",43,0)
    .W ?69,$P(TMP,", ",1)_","_$P(TMP,", ",2)
"RTN","RCTCSP1",44,0)
    .;check for end of page here, if necessary form feed and print header
"RTN","RCTCSP1",45,0)
    .I ($Y+3)>IOSL D
"RTN","RCTCSP1",46,0)
    ..I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR Q:$D(DIRUT)
"RTN","RCTCSP1",47,0)
    ..D BILLREPH
"RTN","RCTCSP1",48,0)
 I $E(IOST,1,2)="C-" R !!,"END OF REPORT...PRESS RETURN TO CONTINUE",X:DTIME W @IOF
"RTN","RCTCSP1",49,0)
 D:'$D(ZTQUEUED) ^%ZISC
"RTN","RCTCSP1",50,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RCTCSP1",51,0)
 K IOP,%ZIS,ZTQUEUED
"RTN","RCTCSP1",52,0)
BILLREPQ Q
"RTN","RCTCSP1",53,0)
 ;
"RTN","RCTCSP1",54,0)
BILLREPH ;header for cross-servicing bill report
"RTN","RCTCSP1",55,0)
 W @IOF
"RTN","RCTCSP1",56,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",57,0)
 W "PAGE "_PAGE,?24,"CROSS-SERVICING BILL REPORT",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",58,0)
 W !,DASH
"RTN","RCTCSP1",59,0)
 N RCHDR
"RTN","RCTCSP1",60,0)
 S RCHDR=$$ACCNTHDR^RCDPAPLM(DEBTOR)
"RTN","RCTCSP1",61,0)
 W !!,"DEBTOR: ",$E($P(RCHDR,U,1),1,18),?32,"SSN: ",$E($P(RCHDR,U,2),2,$L($P(RCHDR,U,2))-1),?55,"CURRENT CS DEBT: ",$J(TAMT,8,2)
"RTN","RCTCSP1",62,0)
 W !,DASH
"RTN","RCTCSP1",63,0)
 W !,"BILL NO.",?13,"ST",?17,"ORIG AMT",?27,"CURR AMT",?41,"PRIN",?49,"INT",?54,"ADMIN",?62,"COURT",?69,"CS REF DATE"
"RTN","RCTCSP1",64,0)
 W !,"---- ---",?13,"--",?17,"---- ---",?27,"---- ---",?41,"----",?49,"---",?54,"-----",?62,"-----",?69,"-- --- ----"
"RTN","RCTCSP1",65,0)
 Q
"RTN","RCTCSP1",66,0)
 ;
"RTN","RCTCSP1",67,0)
CSRPRT ;print cross-servicing report, prints sorted individual bills that make up a cross-servicing account
"RTN","RCTCSP1",68,0)
 N DIC,RCSORT,PAGE,DASH,DTOUT,DUOUT,DIROUT,BY,FROM,TO,FLDS,L
"RTN","RCTCSP1",69,0)
 S PAGE=0,DASH="",$P(DASH,"-",81)=""
"RTN","RCTCSP1",70,0)
 W !
"RTN","RCTCSP1",71,0)
 S DIR(0)="S^1:Bill Number;2:Debtor Name;3:CS Referred Date",DIR("A")="Sort by" D ^DIR K DIR
"RTN","RCTCSP1",72,0)
 S RCSORT=Y Q:($D(DTOUT)!$D(DUOUT)!$D(DIROUT))
"RTN","RCTCSP1",73,0)
 I RCSORT=1 D
"RTN","RCTCSP1",74,0)
 .S DIC="^PRCA(430,",L=0,L(0)=1,BY(0)="^PRCA(430,""TCSP"","
"RTN","RCTCSP1",75,0)
 .S FLDS=".01;L12,9;L18,161;R10,169;R9,151;R12,11;R9",DHD="W ?0 D CSRPRTH1^RCTCSP1"
"RTN","RCTCSP1",76,0)
 .D EN1^DIP
"RTN","RCTCSP1",77,0)
 .Q
"RTN","RCTCSP1",78,0)
 ;
"RTN","RCTCSP1",79,0)
 I RCSORT=2 D
"RTN","RCTCSP1",80,0)
 .S DIC="^PRCA(430,",L=0,L(0)=1,BY(0)="^PRCA(430,""TCSP"",",BY=9,(FR,TO)=""
"RTN","RCTCSP1",81,0)
 .S FLDS="9;L18,.01;R12,161;R10,169;R9,151;R12,11;R9",DHD="W ?0 D CSRPRTH2^RCTCSP1"
"RTN","RCTCSP1",82,0)
 .D EN1^DIP
"RTN","RCTCSP1",83,0)
 .Q
"RTN","RCTCSP1",84,0)
 ;
"RTN","RCTCSP1",85,0)
 I RCSORT=3 D
"RTN","RCTCSP1",86,0)
 .S DIC="^PRCA(430,",L=0,L(0)=1,BY(0)="^PRCA(430,""TCSP"",",BY=151,(FR,TO)=""
"RTN","RCTCSP1",87,0)
 .S FLDS="151;L12,9;L18,.01;R12,161;R10,169;R9,11;R9",DHD="W ?0 D CSRPRTH3^RCTCSP1"
"RTN","RCTCSP1",88,0)
 .D EN1^DIP
"RTN","RCTCSP1",89,0)
 .Q
"RTN","RCTCSP1",90,0)
 Q
"RTN","RCTCSP1",91,0)
 ;
"RTN","RCTCSP1",92,0)
CSRPRTH1 ;header for cross-servicing print report 1
"RTN","RCTCSP1",93,0)
 W @IOF
"RTN","RCTCSP1",94,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",95,0)
 W !,"PAGE "_PAGE,?16,"BILLS AT CROSS-SERVICING (SORTED BY BILL NO.)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",96,0)
 W !,DASH,!
"RTN","RCTCSP1",97,0)
 W !,"BILL NO.",?14,"DEBTOR",?35,"SSN",?47,"ORIG AMT",?58,"CS REF DATE",?71," CURR AMT"
"RTN","RCTCSP1",98,0)
 W !,"---- ---",?14,"------",?35,"---",?47,"---- ---",?58,"-- --- ----",?71," ---- ---",!
"RTN","RCTCSP1",99,0)
 Q
"RTN","RCTCSP1",100,0)
 ;
"RTN","RCTCSP1",101,0)
CSRPRTH2 ;header for cross-servicing print report 2
"RTN","RCTCSP1",102,0)
 W @IOF
"RTN","RCTCSP1",103,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",104,0)
 W !,"PAGE "_PAGE,?16,"BILLS AT CROSS-SERVICING (SORTED BY DEBTOR)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",105,0)
 W !,DASH,!
"RTN","RCTCSP1",106,0)
 W !,"DEBTOR",?21,"BILL NO.",?35,"SSN",?47,"ORIG AMT",?58,"CS REF DATE",?71," CURR AMT"
"RTN","RCTCSP1",107,0)
 W !,"------",?21,"---- ---",?35,"---",?47,"---- ---",?58,"-- --- ----",?71," ---- ---",!
"RTN","RCTCSP1",108,0)
 Q
"RTN","RCTCSP1",109,0)
 ;
"RTN","RCTCSP1",110,0)
CSRPRTH3 ;header for cross-servicing print report 3
"RTN","RCTCSP1",111,0)
 W @IOF
"RTN","RCTCSP1",112,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",113,0)
 W !,"PAGE "_PAGE,?11,"BILLS AT CROSS-SERVICING (SORTED BY CS REFERRED DATE)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",114,0)
 W !,DASH,!
"RTN","RCTCSP1",115,0)
 W !,"CS REF DATE",?14,"DEBTOR",?35,"BILL NO.",?49,"SSN",?61,"ORIG AMT",?71," CURR AMT"
"RTN","RCTCSP1",116,0)
 W !,"-- --- ----",?14,"------",?35,"---- ---",?49,"---",?61,"---- ---",?71," ---- ---",!
"RTN","RCTCSP1",117,0)
 Q
"RTN","RCTCSP1",118,0)
 ;
"RTN","RCTCSP1",119,0)
CSRCLRT ;cross-servicing recall report, prints sorted individual bills that make up a cross-servicing account
"RTN","RCTCSP1",120,0)
 N DIC,RCSORT,PAGE,DASH,DTOUT,DUOUT,DIROUT,DHD,FLDS,L,BY,FR,TO,DIS
"RTN","RCTCSP1",121,0)
 S PAGE=0,DASH="",$P(DASH,"-",81)=""
"RTN","RCTCSP1",122,0)
 W !
"RTN","RCTCSP1",123,0)
 S DIR(0)="S^1:Bill Number;2:Debtor Name",DIR("A")="Sort by" D ^DIR K DIR
"RTN","RCTCSP1",124,0)
 S RCSORT=Y Q:($D(DTOUT)!$D(DUOUT)!$D(DIROUT))
"RTN","RCTCSP1",125,0)
 I RCSORT=1 D
"RTN","RCTCSP1",126,0)
 .S DIC="^PRCA(430,",DIS(0)="I ($P($G(^PRCA(430,D0,15)),U,2)>0)!((+$P($G(^RCD(340,+$P(^PRCA(430,D0,0),U,9),7)),U,2))&$D(^PRCA(430,""TCSP"",D0)))",L=0,BY=.01,(FR,TO)=""
"RTN","RCTCSP1",127,0)
 .S FLDS="[PRCA TCSP RECALLB]",DHD="W ?0 D CSRCLH1^RCTCSP1"
"RTN","RCTCSP1",128,0)
 .D EN1^DIP
"RTN","RCTCSP1",129,0)
 .Q
"RTN","RCTCSP1",130,0)
 ;
"RTN","RCTCSP1",131,0)
 I RCSORT=2 D
"RTN","RCTCSP1",132,0)
 .S DIC="^PRCA(430,",DIS(0)="I ($P($G(^PRCA(430,D0,15)),U,2)>0)!((+$P($G(^RCD(340,+$P(^PRCA(430,D0,0),U,9),7)),U,2))&$D(^PRCA(430,""TCSP"",D0)))",L=0,BY=9,(FR,TO)=""
"RTN","RCTCSP1",133,0)
 .S FLDS="[PRCA TCSP RECALLD]",DHD="W ?0 D CSRCLH2^RCTCSP1"
"RTN","RCTCSP1",134,0)
 .D EN1^DIP
"RTN","RCTCSP1",135,0)
 .Q
"RTN","RCTCSP1",136,0)
 Q
"RTN","RCTCSP1",137,0)
 ;
"RTN","RCTCSP1",138,0)
CSRCLH1 ;header for cross-servicing recall report 1
"RTN","RCTCSP1",139,0)
 W @IOF
"RTN","RCTCSP1",140,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",141,0)
 W !,"PAGE "_PAGE,?12,"CROSS-SERVICING RECALL REPORT (SORTED BY BILL NUMBER)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",142,0)
 W !,DASH,!
"RTN","RCTCSP1",143,0)
 W !,"BILL NO.",?13,"DEBTOR",?33,"SSN",?44,"RCLL AMT",?54,"RECALL DATE",?67,"RECALL RSN"
"RTN","RCTCSP1",144,0)
 W !,"---- ---",?13,"------",?33,"---",?44,"---- ---",?54,"------ ----",?67,"------ ---",!
"RTN","RCTCSP1",145,0)
 Q
"RTN","RCTCSP1",146,0)
 ;
"RTN","RCTCSP1",147,0)
CSRCLH2 ;header for cross-servicing recall report 2
"RTN","RCTCSP1",148,0)
 W @IOF
"RTN","RCTCSP1",149,0)
 S PAGE=PAGE+1
"RTN","RCTCSP1",150,0)
 W !,"PAGE "_PAGE,?14,"CROSS-SERVICING RECALL REPORT (SORTED BY DEBTOR)",?68,$$UPPER^VALM1($$FMTE^XLFDT(DT))
"RTN","RCTCSP1",151,0)
 W !,DASH,!
"RTN","RCTCSP1",152,0)
 W !,"DEBTOR",?20,"BILL NO.",?33,"SSN",?44,"RCLL AMT",?54,"RECALL DATE",?67,"RECALL RSN"
"RTN","RCTCSP1",153,0)
 W !,"------",?20,"--------",?33,"---",?44,"---- ---",?54,"------ ----",?67,"------ ---",!
"RTN","RCTCSP1",154,0)
 Q
"RTN","RCTCSP1",155,0)
 ;
"RTN","RCTCSP1",156,0)
HEADER ;
"RTN","RCTCSP1",157,0)
 ;increment batch sequence number, build new header
"RTN","RCTCSP1",158,0)
 N RCMSG
"RTN","RCTCSP1",159,0)
 S SEQ=SEQ+1
"RTN","RCTCSP1",160,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP1",161,0)
 K ^XTMP("RCTCSPD",$J,ACTION,"BUILD",SEQ)
"RTN","RCTCSP1",162,0)
 ;header is record type H
"RTN","RCTCSP1",163,0)
 S RCMSG="H"_CNTLID_$$BLANK(14)_"3636001200"
"RTN","RCTCSP1",164,0)
 S RCMSG=RCMSG_$$BLANK(450-$L(RCMSG))
"RTN","RCTCSP1",165,0)
 S REC=REC+1
"RTN","RCTCSP1",166,0)
 S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(RCMSG,1,225)_$C(94)
"RTN","RCTCSP1",167,0)
 S REC=REC+1
"RTN","RCTCSP1",168,0)
 S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(RCMSG,226,999)_$C(126)
"RTN","RCTCSP1",169,0)
 Q
"RTN","RCTCSP1",170,0)
 ;
"RTN","RCTCSP1",171,0)
TRAILER ;
"RTN","RCTCSP1",172,0)
 ;trailer is type Z record
"RTN","RCTCSP1",173,0)
 I REC=0 K ^XTMP("RCTCSPD",$J,SEQ,"BUILD") Q  ;delete batch if no records processed
"RTN","RCTCSP1",174,0)
 N RCMSG
"RTN","RCTCSP1",175,0)
 S CNTLID=$$JD()_$$RJZF(SEQ,4)
"RTN","RCTCSP1",176,0)
 S RCMSG="Z"_$$RJZF(RECC,8)_$$AMOUNT(AMOUNT/100)_CNTLID_$$BLANK(14)_"3636001200"
"RTN","RCTCSP1",177,0)
 S RCMSG=RCMSG_$$BLANK(450-$L(RCMSG))
"RTN","RCTCSP1",178,0)
 S REC=REC+1
"RTN","RCTCSP1",179,0)
 S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(RCMSG,1,225)_$C(94)
"RTN","RCTCSP1",180,0)
 S REC=REC+1
"RTN","RCTCSP1",181,0)
 S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(RCMSG,226,999)_$C(126)
"RTN","RCTCSP1",182,0)
 S REC=0,RECC=0,AMOUNT=0
"RTN","RCTCSP1",183,0)
 Q
"RTN","RCTCSP1",184,0)
 ;
"RTN","RCTCSP1",185,0)
REC5B ;
"RTN","RCTCSP1",186,0)
 ;  trnnum     transaction number file #433 pass in
"RTN","RCTCSP1",187,0)
 ;  trntyp     transaction type pointer to 430.3
"RTN","RCTCSP1",188,0)
 ;  trntypa    aia transaction type  (aio: dmc agency internal offset, abal: decrease adjustment) 
"RTN","RCTCSP1",189,0)
 N REC,KNUM,DEBTNR,DEBTORNB,TAMOUNT,TAMTPBAL,TAMTIBAL,TAMTABAL,TAMTFBAL,TAMTCBAL,AMTRFRRD,TRNTYP,TRNTYPA,TRANSNB
"RTN","RCTCSP1",190,0)
 N AMTPBAL,AMTIBAL,AMTABAL,AMTFBAL,AMTCBAL,TRN3,TRNNUME
"RTN","RCTCSP1",191,0)
 S TRNTYPA="AIO"
"RTN","RCTCSP1",192,0)
 S REC="C5B"_ACTION_"3636001200"_"DM1D "_"L"
"RTN","RCTCSP1",193,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSP1",194,0)
 S DEBTNR=$E(SITE,1,3)_$$RJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSP1",195,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSP1",196,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSP1",197,0)
 S TRNTYP=$P($G(^PRCA(433,TRNNUM,1)),U,2) I TRNTYP=35 S TRNTYPA="ABAL"
"RTN","RCTCSP1",198,0)
 S REC=REC_$$LJSF(TRNTYPA,9)
"RTN","RCTCSP1",199,0)
 S TRNNUME=$$RJZF(TRNNUM,10)
"RTN","RCTCSP1",200,0)
 S TRNNUME=$E(TRNNUME,5,10) ;max is 999999
"RTN","RCTCSP1",201,0)
 I TRNNUME="000000" S TRNNUME="000001" ;min is 1
"RTN","RCTCSP1",202,0)
 S REC=REC_$$RJZF(TRNNUME,10)
"RTN","RCTCSP1",203,0)
 S REC=REC_$$DATE8(DT)
"RTN","RCTCSP1",204,0)
 S TRANSNB=$E(SITE,1,3)_$TR($J(TRNNUM,12)," ",0)
"RTN","RCTCSP1",205,0)
 S REC=REC_TRANSNB
"RTN","RCTCSP1",206,0)
 S REC=REC_$$BLANK(9)
"RTN","RCTCSP1",207,0)
 S TRN3=$G(^PRCA(433,TRNNUM,3))
"RTN","RCTCSP1",208,0)
 S TAMTPBAL=$P(TRN3,U,1) ;transaction principle balance
"RTN","RCTCSP1",209,0)
 S TAMTIBAL=$P(TRN3,U,2) ;transaction interest balance
"RTN","RCTCSP1",210,0)
 S TAMTABAL=$P(TRN3,U,3) ;transaction administrative balance
"RTN","RCTCSP1",211,0)
 S TAMTFBAL=$P(TRN3,U,4) ;transaction marshal fee
"RTN","RCTCSP1",212,0)
 S TAMTCBAL=$P(TRN3,U,5) ;transaction court cost
"RTN","RCTCSP1",213,0)
 I (TAMTPBAL+TAMTIBAL+TAMTABAL+TAMTFBAL+TAMTCBAL)=0 S TAMTPBAL=TRNAMT
"RTN","RCTCSP1",214,0)
 S TAMOUNT=$S(+TAMTPBAL:"-",1:"0")_$E($$AMOUNT(TAMTPBAL),2,14)
"RTN","RCTCSP1",215,0)
 S TAMOUNT=TAMOUNT_$S(+TAMTIBAL:"-",1:"0")_$E($$AMOUNT(TAMTIBAL),2,14)
"RTN","RCTCSP1",216,0)
 S TAMOUNT=TAMOUNT_$S(+TAMTABAL:"-",1:"0")_$E($$AMOUNT(TAMTABAL),2,14)
"RTN","RCTCSP1",217,0)
 S TAMOUNT=TAMOUNT_$S(+(TAMTFBAL+TAMTCBAL):"-",1:"0")_$E($$AMOUNT(TAMTFBAL+TAMTCBAL),2,14)
"RTN","RCTCSP1",218,0)
 S REC=REC_TAMOUNT
"RTN","RCTCSP1",219,0)
 S REC=REC_"-"_$E($$AMOUNT(TRNAMT),2,14)
"RTN","RCTCSP1",220,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSP1",221,0)
 S AMTPBAL=$P(B7,U,1) ;principle balance
"RTN","RCTCSP1",222,0)
 S AMTIBAL=$P(B7,U,2) ;interest balance
"RTN","RCTCSP1",223,0)
 S AMTABAL=$P(B7,U,3) ;administrative balance
"RTN","RCTCSP1",224,0)
 S AMTFBAL=$P(B7,U,4) ;marshal fee
"RTN","RCTCSP1",225,0)
 S AMTCBAL=$P(B7,U,5) ;court cost
"RTN","RCTCSP1",226,0)
 S AMTRFRRD=AMTPBAL+AMTIBAL+AMTABAL+AMTFBAL+AMTCBAL
"RTN","RCTCSP1",227,0)
 I ACTION="U" S $P(^PRCA(430,BILL,16),U,10)=AMTRFRRD
"RTN","RCTCSP1",228,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,"5B",TRNNUM)=REC
"RTN","RCTCSP1",229,0)
 S ^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL)=$$TAXID(DEBTOR)_"^-"_+$E(REC,174,184)_"."_$E(REC,185,186)
"RTN","RCTCSP1",230,0)
 Q
"RTN","RCTCSP1",231,0)
 ;
"RTN","RCTCSP1",232,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSP1",233,0)
 I +X S X=X+17000000
"RTN","RCTCSP1",234,0)
 S X=$E(X,1,8)
"RTN","RCTCSP1",235,0)
 Q X
"RTN","RCTCSP1",236,0)
 ;
"RTN","RCTCSP1",237,0)
AMOUNT(X) ;changes amount to zero filled, right justified
"RTN","RCTCSP1",238,0)
 S:X<0 X=-X
"RTN","RCTCSP1",239,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP1",240,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSP1",241,0)
 Q X
"RTN","RCTCSP1",242,0)
 ;
"RTN","RCTCSP1",243,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP1",244,0)
 N BLANK
"RTN","RCTCSP1",245,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP1",246,0)
 Q BLANK
"RTN","RCTCSP1",247,0)
 ;
"RTN","RCTCSP1",248,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSP1",249,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSP1",250,0)
 Q X
"RTN","RCTCSP1",251,0)
 ;
"RTN","RCTCSP1",252,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSP1",253,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP1",254,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP1",255,0)
 Q X
"RTN","RCTCSP1",256,0)
 ;
"RTN","RCTCSP1",257,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP1",258,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP1",259,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP1",260,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP1",261,0)
 Q TAXID
"RTN","RCTCSP1",262,0)
 ;
"RTN","RCTCSP1",263,0)
JD() ; returns today's Julian date YDOY
"RTN","RCTCSP1",264,0)
 N XMDDD,XMNOW,XMDT
"RTN","RCTCSP1",265,0)
 S XMNOW=$$NOW^XLFDT
"RTN","RCTCSP1",266,0)
 S XMDT=$E(XMNOW,1,7)
"RTN","RCTCSP1",267,0)
 S XMDDD=$$RJ^XLFSTR($$FMDIFF^XLFDT(XMDT,$E(XMDT,1,3)_"0101",1)+1,3,"0")
"RTN","RCTCSP1",268,0)
 Q $E(DT,3)_XMDDD
"RTN","RCTCSP1",269,0)
 ;
"RTN","RCTCSP1",270,0)
ADDR(RCDFN) ; returns patient file address
"RTN","RCTCSP1",271,0)
 N DFN,ADDRCS,STATEIEN,STATEAB,VAPA
"RTN","RCTCSP1",272,0)
 S DFN=RCDFN
"RTN","RCTCSP1",273,0)
 D ADD^VADPT
"RTN","RCTCSP1",274,0)
 S STATEIEN=+VAPA(5),STATEAB=$$GET1^DIQ(5,STATEIEN,1)
"RTN","RCTCSP1",275,0)
 S ADDRCS=VAPA(1)_U_VAPA(2)_U_VAPA(4)_U_STATEAB_U_VAPA(6)_U_VAPA(8)_U_+VAPA(25)
"RTN","RCTCSP1",276,0)
 I $L(DEBTOR1)>0 I $P(DEBTOR1,U,1,5)'?1"^"."^" D
"RTN","RCTCSP1",277,0)
 .N ADDR340
"RTN","RCTCSP1",278,0)
 .S ADDR340=$P($$DADD^RCAMADD(DEBTOR),U,1,8)
"RTN","RCTCSP1",279,0)
 .I $P(ADDRCS,U,7)>1 S $P(ADDR340,U,6)="     "    ;PRCA*4.5*331
"RTN","RCTCSP1",280,0)
 .S ADDR340=$P(ADDR340,U,1,2)_"^"_$P(ADDR340,U,4,7)_U_$S($P(ADDRCS,U,7)'="":$P(ADDRCS,U,7),1:1)    ;PRCA*4.5*331
"RTN","RCTCSP1",281,0)
 .I $P(ADDR340,U,7)="" S $P(ADDR340,U,7)=$P(ADDRCS,U,7)     ;PRCA*4.5*331
"RTN","RCTCSP1",282,0)
 .I $P(ADDR340,U,7)'=1 S $P(ADDR340,U,4)="  "     ;PRCA*4.5*331
"RTN","RCTCSP1",283,0)
 .S ADDRCS=ADDR340
"RTN","RCTCSP1",284,0)
 Q ADDRCS
"RTN","RCTCSP1",285,0)
 ;
"RTN","RCTCSP1",286,0)
DEM(RCDFN) ; returns patient file gender and dob
"RTN","RCTCSP1",287,0)
 N DFN,VADM
"RTN","RCTCSP1",288,0)
 S DFN=RCDFN
"RTN","RCTCSP1",289,0)
 D DEM^VADPT
"RTN","RCTCSP1",290,0)
 ; return string   sex:m/f ^ dob: yyyymmdd ^ ssn ^ deceased
"RTN","RCTCSP1",291,0)
 Q $P(VADM(5),U,1)_U_$P(VADM(3),U,1)_U_$P(VADM(2),U,1)_U_VADM(6)
"RTN","RCTCSP1",292,0)
 ; 
"RTN","RCTCSP1",293,0)
COUNTRY(Z) ;
"RTN","RCTCSP1",294,0)
 N PRCACC
"RTN","RCTCSP1",295,0)
 ;get treasury country code
"RTN","RCTCSP1",296,0)
 I Z=1 S PRCACC="US" G COUNTRYQ
"RTN","RCTCSP1",297,0)
 I Z="" S PRCACC="US" G COUNTRYQ
"RTN","RCTCSP1",298,0)
 S PRCACC=$S(Z=4:"AF",Z=5:"AL",Z=7:"DZ",Z=8:"AD",Z=9:"AO",Z=180:"AI",Z=10:"AG",Z=12:"AR",Z=18:"AM",Z=151:"AW",Z=13:"AU",Z=14:"AT",Z=11:"AZ",Z=15:"BS",Z=16:"BH",Z=17:"BD",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",299,0)
 S PRCACC=$S(Z=19:"BB",Z=36:"BY",Z=20:"BE",Z=28:"BZ",Z=61:"BJ",Z=21:"BM",Z=22:"BT",Z=23:"BO",Z=24:"BA",Z=25:"BW",Z=27:"BR",Z=29:"IO",Z=32:"BN",Z=33:"BG",Z=223:"Faso",Z=35:"BI",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",300,0)
 S PRCACC=$S(Z=37:"KH",Z=38:"CM",Z=39:"CA",Z=40:"CV",Z=41:"KY",Z=42:"CF",Z=44:"TD",Z=45:"CL",Z=46:"CN",Z=50:"CO",Z=51:"KM",Z=53:"CG",Z=54:"CD",Z=55:"CK",Z=56:"CR",Z=109:"CI",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",301,0)
 S PRCACC=$S(Z=57:"HR",Z=58:"CU",Z=59:"CY",Z=60:"CZ",Z=115:"KP",Z=62:"DK",Z=80:"DJ",Z=63:"DM",Z=64:"DO",Z=172:"TP",Z=65:"EC",Z=220:"EG",Z=66:"SV",Z=67:"GQ",Z=69:"ER",Z=70:"EE",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",302,0)
 S PRCACC=$S(Z=68:"ET",Z=72:"FK",Z=71:"FO",Z=74:"FJ",Z=75:"FI",Z=76:"FR",Z=77:"GF",Z=78:"PF",Z=79:"TF",Z=81:"GA",Z=83:"GM",Z=82:"GE",Z=84:"DE",Z=85:"GH",Z=86:"GI",Z=221:"GB",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",303,0)
 S PRCACC=$S(Z=88:"GR",Z=89:"GL",Z=90:"GD",Z=91:"GP",Z=92:"GT",Z=93:"GN",Z=171:"GW",Z=94:"GY",Z=95:"HT",Z=98:"HN",Z=99:"HK",Z=100:"HU",Z=101:"IS",Z=102:"IN",Z=103:"ID",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",304,0)
 S PRCACC=$S(Z=105:"IQ",Z=106:"IE",Z=107:"IL",Z=108:"IT",Z=110:"JM",Z=111:"JP",Z=113:"JO",Z=112:"KZ",Z=114:"KE",Z=87:"KI",Z=116:"KR",Z=117:"KW",Z=118:"KG",Z=119:"LA",Z=122:"LV",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",305,0)
 S PRCACC=$S(Z=120:"LB",Z=121:"LS",Z=123:"LR",Z=124:"LY",Z=125:"LI",Z=126:"LT",Z=127:"LU",Z=128:"MO",Z=129:"MG",Z=130:"MW",Z=131:"MY",Z=132:"MV",Z=133:"ML",Z=134:"MT",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",306,0)
 S PRCACC=$S(Z=999:"MH",Z=135:"MQ",Z=136:"MR",Z=137:"MU",Z=52:"YT",Z=138:"MX",Z=161:"FM",Z=141:"MD",Z=139:"MC",Z=140:"MN",Z=142:"MS",Z=143:"MA",Z=144:"MZ",Z=34:"MM",Z=146:"NA",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",307,0)
 S PRCACC=$S(Z=147:"NR",Z=148:"NP",Z=149:"NL",Z=150:"AN",Z=152:"NC",Z=154:"NZ",Z=155:"NI",Z=156:"NE",Z=157:"NG",Z=158:"NU",Z=159:"NF",Z=160:"NO",Z=145:"OM",Z=162:"PK",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",308,0)
 S PRCACC=$S(Z=999:"PW",Z=163:"PA",Z=164:"PG",Z=165:"PY",Z=166:"PE",Z=167:"PH",Z=168:"PN",Z=169:"PL",Z=170:"PT",Z=173:"QA",Z=999:"RE",Z=175:"RO",Z=176:"RU",Z=177:"RW",Z=178:"SH",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",309,0)
 S PRCACC=$S(Z=179:"KN",Z=181:"LC",Z=183:"VC",Z=999:"WS",Z=184:"SM",Z=185:"ST",Z=186:"SA",Z=187:"SN",Z=188:"SC",Z=189:"SL",Z=190:"SG",Z=191:"SK",Z=193:"SI",Z=30:"SB",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",310,0)
 S PRCACC=$S(Z=194:"SO",Z=195:"ZA",Z=197:"ES",Z=43:"LK",Z=199:"SD",Z=200:"SR",Z=201:"SZ",Z=202:"SE",Z=203:"CH",Z=204:"SY",Z=205:"TJ",Z=222:"TZ",Z=182:"PM",Z=206:"TH",Z=219:"MK",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",311,0)
 S PRCACC=$S(Z=207:"TG",Z=208:"TK",Z=209:"TO",Z=210:"TT",Z=212:"TN",Z=213:"TR",Z=214:"TM",Z=215:"TC",Z=216:"TV",Z=217:"UG",Z=218:"UA",Z=211:"AE",Z=1:"US",Z=224:"UY",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",312,0)
 S PRCACC=$S(Z=104:"IR",Z=225:"UZ",Z=153:"VU",Z=97:"VA",Z=226:"VE",Z=183:"VN",Z=31:"VG",Z=227:"WF",Z=228:"YE",Z=229:"YU",Z=230:"ZM",Z=196:"ZW",1:"  ") G:PRCACC'="  " COUNTRYQ
"RTN","RCTCSP1",313,0)
COUNTRYQ ;
"RTN","RCTCSP1",314,0)
 Q PRCACC
"RTN","RCTCSP1",315,0)
 ;
"VER")
8.0^22.2
"BLD",10673,6)
^288
**END**
**END**

