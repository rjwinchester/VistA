Released PRCA*4.5*344 SEQ #300
Extracted from mail message
**KIDS**:PRCA*4.5*344^

**INSTALL NAME**
PRCA*4.5*344
"BLD",11212,0)
PRCA*4.5*344^ACCOUNTS RECEIVABLE^0^3181004^y
"BLD",11212,1,0)
^^1^1^3180907^^
"BLD",11212,1,1,0)
1. CS BATCH RUN: 5B MAIL MESSAGE HANDLING
"BLD",11212,4,0)
^9.64PA^^
"BLD",11212,6.3)
9
"BLD",11212,"ABPKG")
n
"BLD",11212,"KRN",0)
^9.67PA^779.2^20
"BLD",11212,"KRN",.4,0)
.4
"BLD",11212,"KRN",.401,0)
.401
"BLD",11212,"KRN",.402,0)
.402
"BLD",11212,"KRN",.403,0)
.403
"BLD",11212,"KRN",.5,0)
.5
"BLD",11212,"KRN",.84,0)
.84
"BLD",11212,"KRN",3.6,0)
3.6
"BLD",11212,"KRN",3.8,0)
3.8
"BLD",11212,"KRN",9.2,0)
9.2
"BLD",11212,"KRN",9.8,0)
9.8
"BLD",11212,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",11212,"KRN",9.8,"NM",1,0)
RCTCSP2^^0^B135421242
"BLD",11212,"KRN",9.8,"NM","B","RCTCSP2",1)

"BLD",11212,"KRN",19,0)
19
"BLD",11212,"KRN",19.1,0)
19.1
"BLD",11212,"KRN",101,0)
101
"BLD",11212,"KRN",409.61,0)
409.61
"BLD",11212,"KRN",771,0)
771
"BLD",11212,"KRN",779.2,0)
779.2
"BLD",11212,"KRN",870,0)
870
"BLD",11212,"KRN",8989.51,0)
8989.51
"BLD",11212,"KRN",8989.52,0)
8989.52
"BLD",11212,"KRN",8994,0)
8994
"BLD",11212,"KRN","B",.4,.4)

"BLD",11212,"KRN","B",.401,.401)

"BLD",11212,"KRN","B",.402,.402)

"BLD",11212,"KRN","B",.403,.403)

"BLD",11212,"KRN","B",.5,.5)

"BLD",11212,"KRN","B",.84,.84)

"BLD",11212,"KRN","B",3.6,3.6)

"BLD",11212,"KRN","B",3.8,3.8)

"BLD",11212,"KRN","B",9.2,9.2)

"BLD",11212,"KRN","B",9.8,9.8)

"BLD",11212,"KRN","B",19,19)

"BLD",11212,"KRN","B",19.1,19.1)

"BLD",11212,"KRN","B",101,101)

"BLD",11212,"KRN","B",409.61,409.61)

"BLD",11212,"KRN","B",771,771)

"BLD",11212,"KRN","B",779.2,779.2)

"BLD",11212,"KRN","B",870,870)

"BLD",11212,"KRN","B",8989.51,8989.51)

"BLD",11212,"KRN","B",8989.52,8989.52)

"BLD",11212,"KRN","B",8994,8994)

"BLD",11212,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",11212,"QUES",0)
^9.62^^
"BLD",11212,"REQB",0)
^9.611^1^1
"BLD",11212,"REQB",1,0)
PRCA*4.5*340^2
"BLD",11212,"REQB","B","PRCA*4.5*340",1)

"MBREQ")
0
"PKG",142,-1)
1^1
"PKG",142,0)
ACCOUNTS RECEIVABLE^PRCA^BILL COLLECTIONS
"PKG",142,20,0)
^9.402P^^0
"PKG",142,22,0)
^9.49I^1^1
"PKG",142,22,1,0)
4.5^^2950320
"PKG",142,22,1,"PAH",1,0)
344^3181004
"PKG",142,22,1,"PAH",1,1,0)
^^1^1^3181004
"PKG",142,22,1,"PAH",1,1,1,0)
1. CS BATCH RUN: 5B MAIL MESSAGE HANDLING
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","RCTCSP2")
0^1^B135421242^B128258214
"RTN","RCTCSP2",1,0)
RCTCSP2 ;ALBANY/BDB - CROSS-SERVICING TRANSMISSION ;03/15/14 3:34 PM
"RTN","RCTCSP2",2,0)
 ;;4.5;Accounts Receivable;**301,315,339,340,344**;Mar 20, 1995;Build 9
"RTN","RCTCSP2",3,0)
 ;;Per VA Directive 6402, this routine should not be modified.
"RTN","RCTCSP2",4,0)
 ;
"RTN","RCTCSP2",5,0)
 ;PRCA*4.5*344 Added total record control (>50) to 5B transaction
"RTN","RCTCSP2",6,0)
 ;             handler to insure mail messages stay within a
"RTN","RCTCSP2",7,0)
 ;             record count of 50 transactions.
"RTN","RCTCSP2",8,0)
 ;
"RTN","RCTCSP2",9,0)
 Q
"RTN","RCTCSP2",10,0)
 ;
"RTN","RCTCSP2",11,0)
COMPILE ;
"RTN","RCTCSP2",12,0)
 N RCMSG,BCNTR,REC,RECC,AMOUNT,RCNTR,ACTION,SEQ
"RTN","RCTCSP2",13,0)
 S BCNTR=0,REC=0,RECC=0,AMOUNT=0,SEQ=0
"RTN","RCTCSP2",14,0)
 F  S BCNTR=$O(^XTMP("RCTCSPD",$J,BCNTR)) Q:+BCNTR'>0  D
"RTN","RCTCSP2",15,0)
 .I REC>50 D
"RTN","RCTCSP2",16,0)
 ..D TRAILER^RCTCSP1A
"RTN","RCTCSP2",17,0)
 ..D AITCMSG
"RTN","RCTCSP2",18,0)
 ..S REC=0,RECC=0
"RTN","RCTCSP2",19,0)
 ..Q
"RTN","RCTCSP2",20,0)
 .S ACTION="" F  S ACTION=$O(^XTMP("RCTCSPD",$J,BCNTR,ACTION)) Q:ACTION=""  D
"RTN","RCTCSP2",21,0)
 ..I REC=0 D HEADER^RCTCSP1A
"RTN","RCTCSP2",22,0)
 ..F RCNTR=1,2,"2A","2C",3 I $D(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR)) D
"RTN","RCTCSP2",23,0)
 ...S REC=REC+1
"RTN","RCTCSP2",24,0)
 ...S RECC=RECC+1 ;record count for 'c' records on trailer record
"RTN","RCTCSP2",25,0)
 ...S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR),1,225)_$C(94)
"RTN","RCTCSP2",26,0)
 ...S REC=REC+1
"RTN","RCTCSP2",27,0)
 ...S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR),226,999)_$C(126)
"RTN","RCTCSP2",28,0)
 ...I $E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,RCNTR),2)="1" S AMOUNT=AMOUNT+$E(^(RCNTR),91,104)
"RTN","RCTCSP2",29,0)
 ...Q
"RTN","RCTCSP2",30,0)
 ..I $D(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B")) D
"RTN","RCTCSP2",31,0)
 ...N TRNNUM
"RTN","RCTCSP2",32,0)
 ...S TRNNUM=0
"RTN","RCTCSP2",33,0)
 ...F  S TRNNUM=$O(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM)) Q:TRNNUM'?1N.N  D
"RTN","RCTCSP2",34,0)
 ....I REC>50 D    ;PRCA*4.5*344
"RTN","RCTCSP2",35,0)
 .....D TRAILER^RCTCSP1A
"RTN","RCTCSP2",36,0)
 .....D AITCMSG
"RTN","RCTCSP2",37,0)
 .....S REC=0,RECC=0
"RTN","RCTCSP2",38,0)
 .....Q
"RTN","RCTCSP2",39,0)
 ....I REC=0 D HEADER^RCTCSP1A   ;PRCA*4.5*344
"RTN","RCTCSP2",40,0)
 ....S REC=REC+1
"RTN","RCTCSP2",41,0)
 ....S RECC=RECC+1 ;record count for 'c' records on trailer record
"RTN","RCTCSP2",42,0)
 ....S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM),1,225)_$C(94)
"RTN","RCTCSP2",43,0)
 ....S REC=REC+1
"RTN","RCTCSP2",44,0)
 ....S ^XTMP("RCTCSPD",$J,SEQ,"BUILD",REC)=$E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM),226,999)_$C(126)
"RTN","RCTCSP2",45,0)
 ....S AMOUNT=AMOUNT+$TR($E(^XTMP("RCTCSPD",$J,BCNTR,ACTION,"5B",TRNNUM),173,186),"-")
"RTN","RCTCSP2",46,0)
 ....Q
"RTN","RCTCSP2",47,0)
 ...Q
"RTN","RCTCSP2",48,0)
 ..Q
"RTN","RCTCSP2",49,0)
 .Q
"RTN","RCTCSP2",50,0)
 D TRAILER^RCTCSP1A
"RTN","RCTCSP2",51,0)
 D AITCMSG
"RTN","RCTCSP2",52,0)
 D USRMSG
"RTN","RCTCSP2",53,0)
 Q
"RTN","RCTCSP2",54,0)
 ;
"RTN","RCTCSP2",55,0)
RCLLCHK(BILL) ;
"RTN","RCTCSP2",56,0)
 N TOTAL
"RTN","RCTCSP2",57,0)
 I $P(B15,U,7) Q 0 ;check stop tcsp referral flag
"RTN","RCTCSP2",58,0)
 I $P(B15,U,2),'$P(B15,U,3) D  ;recall bill
"RTN","RCTCSP2",59,0)
 .N ACTION,BILLCSL
"RTN","RCTCSP2",60,0)
 .S ACTION="L"
"RTN","RCTCSP2",61,0)
 .S $P(^PRCA(430,BILL,15),U,1)="" ;clear the date referred
"RTN","RCTCSP2",62,0)
 .S $P(^PRCA(430,BILL,15),U,3)=DT ;set the recall date
"RTN","RCTCSP2",63,0)
 .S $P(^PRCA(430,BILL,15),U,5)=$$GET1^DIQ(430,BILL,11) ;set the recall amount to the current amount
"RTN","RCTCSP2",64,0)
 .S B15=^PRCA(430,BILL,15)
"RTN","RCTCSP2",65,0)
 .S BILLCSL=BILL ;last cs bill
"RTN","RCTCSP2",66,0)
 .D REC1^RCTCSPD
"RTN","RCTCSP2",67,0)
 .K ^PRCA(430,"TCSP",BILL) ;set the bill to not sent to cross-servicing
"RTN","RCTCSP2",68,0)
 .D RCLL^RCTCSPD4 ; set bill recall non-financial transaction PRCA*4.5*315
"RTN","RCTCSP2",69,0)
 ;
"RTN","RCTCSP2",70,0)
 ;recall bill if total <$25
"RTN","RCTCSP2",71,0)
 S TOTAL=$P(B7,U)+$P(B7,U,2)+$P(B7,U,3)+$P(B7,U,4)+$P(B7,U,5)
"RTN","RCTCSP2",72,0)
 I TOTAL<25 D  Q 0
"RTN","RCTCSP2",73,0)
 .N X1,X2,P366DT,X,PRCAEN,I,RECALL
"RTN","RCTCSP2",74,0)
 .S RECALL=0
"RTN","RCTCSP2",75,0)
 .S X1=DT,X2=-366 D C^%DTC S P366DT=X
"RTN","RCTCSP2",76,0)
 .S PRCAEN=0 F I=0:0 S PRCAEN=$O(^PRCA(433,"C",BILL,PRCAEN)) Q:'PRCAEN  S:$P($G(^PRCA(433,PRCAEN,1)),U,1)>P366DT RECALL=1
"RTN","RCTCSP2",77,0)
 .I RECALL=0 D  Q
"RTN","RCTCSP2",78,0)
 ..S ACTION="L"
"RTN","RCTCSP2",79,0)
 ..S $P(^PRCA(430,BILL,15),U,1)="" ;clear the date referred
"RTN","RCTCSP2",80,0)
 ..S $P(^PRCA(430,BILL,15),U,2)=1 ;set the recall flag
"RTN","RCTCSP2",81,0)
 ..S $P(^PRCA(430,BILL,15),U,3)=DT ;set the recall date
"RTN","RCTCSP2",82,0)
 ..S $P(^PRCA(430,BILL,15),U,4)="07" ;set the recall reason
"RTN","RCTCSP2",83,0)
 ..S $P(^PRCA(430,BILL,15),U,5)=$P($G(^PRCA(430,BILL,16)),U,10) ;set the recall amount to the current tcsp amount
"RTN","RCTCSP2",84,0)
 ..S $P(^PRCA(430,BILL,15),U,7)=1 ;set the stop flag
"RTN","RCTCSP2",85,0)
 ..S $P(^PRCA(430,BILL,15),U,8)=DT ;set the stop date
"RTN","RCTCSP2",86,0)
 ..S $P(^PRCA(430,BILL,15),U,9)="O" ;set the stop date
"RTN","RCTCSP2",87,0)
 ..S $P(^PRCA(430,BILL,15),U,10)="AUTORECALL <$25" ;set the stop reason
"RTN","RCTCSP2",88,0)
 ..S B15=^PRCA(430,BILL,15)
"RTN","RCTCSP2",89,0)
 ..D REC1^RCTCSPD,RCLL^RCTCSPD4 ; set CS Bill Recall transaction PRCA*4.5*315
"RTN","RCTCSP2",90,0)
 ..K ^PRCA(430,"TCSP",BILL) ;set the bill to not sent to cross-servicing
"RTN","RCTCSP2",91,0)
 ..S $P(^PRCA(430,BILL,19),U,10)=1 ;stop interest admin calc
"RTN","RCTCSP2",92,0)
 ..S B19=$G(^PRCA(430,BILL,19))
"RTN","RCTCSP2",93,0)
 ..Q
"RTN","RCTCSP2",94,0)
 .Q
"RTN","RCTCSP2",95,0)
 Q 0
"RTN","RCTCSP2",96,0)
 ;
"RTN","RCTCSP2",97,0)
RCRPRT ;Reconciliation report
"RTN","RCTCSP2",98,0)
 N ZTDESC,ZTRTN,POP,%ZIS,DTFRMTO,DTFRM,DTTO,PROMPT,EXCEL,DATE
"RTN","RCTCSP2",99,0)
 S DTFRMTO=$$DTFRMTO Q:'DTFRMTO  ;Get date range as per PRCA*4.5*315
"RTN","RCTCSP2",100,0)
 S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2),-1),DTTO=$P(DTFRMTO,U,3),CURDT=0
"RTN","RCTCSP2",101,0)
 S EXCEL=0,PROMPT="CAPTURE Report data to an Excel Document",DIR(0)="Y",DIR("?")="^D HEXC^RCTCSJR"
"RTN","RCTCSP2",102,0)
 S EXCEL=$$SELECT^RCTCSJR(PROMPT,"NO") I "01"'[EXCEL S STOP=1 Q
"RTN","RCTCSP2",103,0)
 I EXCEL=1 D EXCMSG^RCTCSJR ; Display Excel display message
"RTN","RCTCSP2",104,0)
 K IOP,IO("Q") S %ZIS="MQ",%ZIS("B")="" D ^%ZIS Q:POP
"RTN","RCTCSP2",105,0)
 I $D(IO("Q")) D  Q  ;
"RTN","RCTCSP2",106,0)
 .S ZTSAVE("DTFRMTO")="",ZTSAVE("EXCEL")=""
"RTN","RCTCSP2",107,0)
 .S ZTRTN="RCRPRTP^RCTCSP2",ZTDESC="RECONCILIATION REPORT"
"RTN","RCTCSP2",108,0)
 .D ^%ZTLOAD,HOME^%ZIS
"RTN","RCTCSP2",109,0)
 .I $G(ZTSK) W !!,"Report compilation has started with task# ",ZTSK,".",! S DIR(0)="E" D ^DIR K DIR
"RTN","RCTCSP2",110,0)
 .Q
"RTN","RCTCSP2",111,0)
 ;
"RTN","RCTCSP2",112,0)
RCRPRTP ;print the - reconciliation report, call to build array of bills returned
"RTN","RCTCSP2",113,0)
 U IO
"RTN","RCTCSP2",114,0)
 N DASH,PAGE,DBTR,DBTRN,RCOUT,CURDT,RC18,RCRTCD,BILLIEN,DATE
"RTN","RCTCSP2",115,0)
 K ^TMP("RCTCSP2",$J)
"RTN","RCTCSP2",116,0)
 S (DATE,DTFRM)=$$FMADD^XLFDT(+$P(DTFRMTO,U,2),-1),DTTO=$P(DTFRMTO,U,3),CURDT=0
"RTN","RCTCSP2",117,0)
 F  S DATE=$O(^PRCA(430,"AN",DATE)),BILLIEN=0 Q:DATE=""!(DATE>DTTO)  D  ;Use new AN xref PRCA*4.5*315
"RTN","RCTCSP2",118,0)
 . F  S BILLIEN=$O(^PRCA(430,"AN",DATE,BILLIEN)) Q:BILLIEN=""  D
"RTN","RCTCSP2",119,0)
 ..I +$P($G(^PRCA(430,BILLIEN,30)),U,1)=0 Q   ;Returned date is NULL
"RTN","RCTCSP2",120,0)
 ..S DBTR=$P($G(^PRCA(430,BILLIEN,0)),U,9),DBTRN=$$GET1^DIQ(430,BILLIEN,9)
"RTN","RCTCSP2",121,0)
 ..Q:DBTRN']""
"RTN","RCTCSP2",122,0)
 ..S ^TMP("RCTCSP2",$J,DBTRN,DBTR)=""   ; store scratch by Debtor Name, Debtor IEN
"RTN","RCTCSP2",123,0)
 S PAGE=0,RCOUT=0
"RTN","RCTCSP2",124,0)
 S DASH="",$P(DASH,"-",78)=""
"RTN","RCTCSP2",125,0)
 D RCRPRTH2
"RTN","RCTCSP2",126,0)
 ;
"RTN","RCTCSP2",127,0)
 ;New fields added in PRCA*4.5*315:
"RTN","RCTCSP2",128,0)
 ;AMTREF:(#310) REC ORIGINAL TCSP AMOUNT stored in ^PRCA(430,BILL,30), piece 10
"RTN","RCTCSP2",129,0)
 ;CORDT:(#312) REC TCSP RECALL EFF. DATE stored in ^PRCA(430,BILL,30), piece 12
"RTN","RCTCSP2",130,0)
 ;DTREJ: (#172) REJECT DATE (multiple)
"RTN","RCTCSP2",131,0)
 ;See RCTCSPRS for more information on these fields
"RTN","RCTCSP2",132,0)
 ;
"RTN","RCTCSP2",133,0)
 S DBTRN=0
"RTN","RCTCSP2",134,0)
 F  S DBTRN=$O(^TMP("RCTCSP2",$J,DBTRN)) Q:DBTRN=""!RCOUT  S DBTR=0 F  S DBTR=$O(^TMP("RCTCSP2",$J,DBTRN,DBTR)) Q:'DBTR!RCOUT  D  Q:RCOUT
"RTN","RCTCSP2",135,0)
 .S BILL=0
"RTN","RCTCSP2",136,0)
 .F  S BILL=$O(^PRCA(430,"C",DBTR,BILL)) Q:BILL'?1N.N  D  Q:RCOUT
"RTN","RCTCSP2",137,0)
 ..N B0,B30,AMTREF,DTRET,CORDT,SSN
"RTN","RCTCSP2",138,0)
 ..S B0=$G(^PRCA(430,BILL,0)),B30=$G(^PRCA(430,BILL,30))
"RTN","RCTCSP2",139,0)
 ..S AMTREF=$J($P(B30,U,10),8,2)
"RTN","RCTCSP2",140,0)
 ..S DEBTOR=$P(B0,U,9),SSN=$$SSN^RCFN01($P(^RCD(340,DEBTOR,0),"^")),SSN=$S(SSN=-1:"",1:$E(DBTRN))_$E(SSN,6,9)
"RTN","RCTCSP2",141,0)
 ..S CORDT=$$FMTE^XLFDT($P(B30,U,12),"2Z"),DTRET=""
"RTN","RCTCSP2",142,0)
 ..S DTRET=$P(B30,U) I DTRET S DTRET=$$FMTE^XLFDT(DTRET,"2Z")
"RTN","RCTCSP2",143,0)
 ..I +$P(B30,U,1)=0 Q
"RTN","RCTCSP2",144,0)
 ..I 'EXCEL W $E(DBTRN,1,16)
"RTN","RCTCSP2",145,0)
 ..I EXCEL W !,$E(DBTRN,1,14)
"RTN","RCTCSP2",146,0)
 ..I 'EXCEL W ?17,$P(B0,U,1),?29,SSN,?35,AMTREF,?44,CORDT,?53,DTRET,!
"RTN","RCTCSP2",147,0)
 ..I EXCEL W U_$P($P(B0,U,1),"-",2)_U_SSN_U_AMTREF_U_CORDT_U_DTRET
"RTN","RCTCSP2",148,0)
 ..S RCRTCD=$P(B30,U,2)
"RTN","RCTCSP2",149,0)
 ..I 'EXCEL D
"RTN","RCTCSP2",150,0)
 ...D  ;Display return reason code
"RTN","RCTCSP2",151,0)
 ....I RCRTCD="" W ?6,"NO RETURN REASON CODE",! Q
"RTN","RCTCSP2",152,0)
 ....W:$D(^PRCA(430.5,RCRTCD,0)) ?6,$P(^PRCA(430.5,RCRTCD,0),U,2),!
"RTN","RCTCSP2",153,0)
 ....W:'$D(^PRCA(430.5,RCRTCD,0)) ?6,"UNKNOWN RETURN REASON CODE: ",RCRTCD,!
"RTN","RCTCSP2",154,0)
 ....W:RCRTCD=14 ?7,"Compromise, Please write this bill off by the manual process",!,?8,"Amount (not collected): "_$J($P(B30,U,4),9,2),!  ;Added PRCA*4.5*315
"RTN","RCTCSP2",155,0)
 ....W:RCRTCD=2 ?8,"Date of Death:  "_$$FMTE^XLFDT($P(B30,U,7),"2Z"),!  ;date type (as per PRCA*4.5*315)
"RTN","RCTCSP2",156,0)
 ....W:RCRTCD=3 ?8,"Bankruptcy Date:  "_$$FMTE^XLFDT($P(B30,U,6),"2Z"),!
"RTN","RCTCSP2",157,0)
 ...W:+$P(B30,U,8) ?6,"Date of Dissolution:  "_$$FMTE^XLFDT($P(B30,U,8),"2Z"),!
"RTN","RCTCSP2",158,0)
 ..I EXCEL D
"RTN","RCTCSP2",159,0)
 ...I RCRTCD=14 W U_$P(^PRCA(430.5,RCRTCD,0),U,2)_U_"AMT NOT COLL"_U_$P(B30,U,4)
"RTN","RCTCSP2",160,0)
 ...I $P(B30,U,3)="Y" W U_"CP"_U_$J($P(B30,U,4),4,2) Q
"RTN","RCTCSP2",161,0)
 ...I RCRTCD=2 W U_$P(^PRCA(430.5,RCRTCD,0),U,2)_" "_$$FMTE^XLFDT($P(B30,U,7),"2Z") Q
"RTN","RCTCSP2",162,0)
 ...I RCRTCD=3 W U_$P(^PRCA(430.5,RCRTCD,0),U,2)_" "_$$FMTE^XLFDT($P(B30,U,6),"2Z") Q
"RTN","RCTCSP2",163,0)
 ...I RCRTCD]"" W U_$S($D(^PRCA(430.5,RCRTCD,0)):$$GET1^DIQ(430.5,RCRTCD,1),1:RCRTCD) Q
"RTN","RCTCSP2",164,0)
 ..;check for end of page here, if necessary form feed and print header
"RTN","RCTCSP2",165,0)
 ..I 'EXCEL W ! I ($Y+5)>IOSL D
"RTN","RCTCSP2",166,0)
 ...I $E(IOST,1,2)="C-" S DIR(0)="E" K DIRUT D ^DIR K DIR I $D(DTOUT)!($D(DUOUT)) S RCOUT=1 K X,Y,DIRUT,DTOUT,DUOUT,DIROUT Q
"RTN","RCTCSP2",167,0)
 ...D RCRPRTH2
"RTN","RCTCSP2",168,0)
 I $E(IOST,1,2)="C-" R !!,"END OF REPORT...PRESS RETURN TO CONTINUE",X:DTIME W @IOF
"RTN","RCTCSP2",169,0)
 D ^%ZISC
"RTN","RCTCSP2",170,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RCTCSP2",171,0)
 K IOP,%ZIS,ZTQUEUED
"RTN","RCTCSP2",172,0)
 K ^TMP("RCTCSP2",$J)
"RTN","RCTCSP2",173,0)
 Q
"RTN","RCTCSP2",174,0)
 ;
"RTN","RCTCSP2",175,0)
RCRPRTH2 ;header for reconciliation report print report 2
"RTN","RCTCSP2",176,0)
 W @IOF
"RTN","RCTCSP2",177,0)
 S PAGE=PAGE+1
"RTN","RCTCSP2",178,0)
 I 'EXCEL W "PAGE "_PAGE,?12,"RECONCILIATION REPORT ",?65,$$FMTE^XLFDT(DT,"2Z")
"RTN","RCTCSP2",179,0)
 I 'EXCEL D  Q
"RTN","RCTCSP2",180,0)
 .W !,DASH
"RTN","RCTCSP2",181,0)
 .W !,"DEBTOR",?17,"BILL NO.",?29,"Pt ID",?35,"Amount",?44,"Recall",?53,"Date",!
"RTN","RCTCSP2",182,0)
 .W ?35,"Refer",?44,"Eff. Dt",?53,"Return"
"RTN","RCTCSP2",183,0)
 .W !,"----------------",?17,"-----------",?29,"-----",?35,"--------",?44,"--------",?53,"--------",!
"RTN","RCTCSP2",184,0)
 ;EXCEL FORMAT
"RTN","RCTCSP2",185,0)
 W "PAGE "_PAGE_U_"RECONCILIATION REPORT "_U_$$FMTE^XLFDT(DT,"2Z")
"RTN","RCTCSP2",186,0)
 W !,"DEBTOR"_U_"BILL #"_U_"PT ID"_U_"AMT REF"_U_"DT RCL"_U_"DT RET"_U_"COMMENT"
"RTN","RCTCSP2",187,0)
 Q
"RTN","RCTCSP2",188,0)
 ;
"RTN","RCTCSP2",189,0)
AITCMSG ;
"RTN","RCTCSP2",190,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,CNTLID,SYSTYP
"RTN","RCTCSP2",191,0)
 S SYSTYP=$$PROD^XUPROD(1)
"RTN","RCTCSP2",192,0)
 S CNTLID=$$JD^RCTCSP1A()_$$RJZF^RCTCSP1(SEQ,4)
"RTN","RCTCSP2",193,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP2",194,0)
 I SYSTYP S XMY("XXX@Q-TPC.DOMAIN.EXT")=""
"RTN","RCTCSP2",195,0)
 I 'SYSTYP S XMY("XXX@Q-TXC.DOMAIN.EXT")=""
"RTN","RCTCSP2",196,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP2",197,0)
 S XMSUB=SITE_"/CS TRANSMISSION/BATCH#: "_CNTLID
"RTN","RCTCSP2",198,0)
 S XMTEXT="^XTMP(""RCTCSPD"","_$J_","""_SEQ_""",""BUILD"","
"RTN","RCTCSP2",199,0)
 D ^XMD
"RTN","RCTCSP2",200,0)
 Q
"RTN","RCTCSP2",201,0)
 ;
"RTN","RCTCSP2",202,0)
USRMSG ;sends mailman message of documents sent to user
"RTN","RCTCSP2",203,0)
 N XMY,XMDUZ,XMSUB,XMTEXT,X,RCNT,RCDAT1,RCDAT2
"RTN","RCTCSP2",204,0)
 S ACTION="" F  S ACTION=$O(^XTMP("RCTCSPD",$J,"BILL",ACTION)) Q:ACTION=""  D
"RTN","RCTCSP2",205,0)
 .K ^XTMP("RCTCSPD",$J,"BILL","MSG")
"RTN","RCTCSP2",206,0)
 .S XMDUZ="AR PACKAGE"
"RTN","RCTCSP2",207,0)
 .S XMY("G.TCSP")=""
"RTN","RCTCSP2",208,0)
 .S XMSUB="CS "_$S(ACTION="A":"ADD REFERRAL",ACTION="U":"UPDATES",ACTION="L":"RECALLS",ACTION="B":"EXISTING DEBTOR",1:"UNKNOWN")_" SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)_" BATCH ID: "_CNTLID
"RTN","RCTCSP2",209,0)
 .S ^XTMP("RCTCSPD",$J,"BILL","MSG",1)="Bill#     TIN        TYPE       AMOUNT"
"RTN","RCTCSP2",210,0)
 .S ^XTMP("RCTCSPD",$J,"BILL","MSG",2)="-----     ---        ----       ------"
"RTN","RCTCSP2",211,0)
 .S X=0,RCNT=2 F  S X=$O(^XTMP("RCTCSPD",$J,"BILL",ACTION,X)) Q:X=""  D
"RTN","RCTCSP2",212,0)
 ..S RCNT=RCNT+1
"RTN","RCTCSP2",213,0)
 ..S RCDAT1=$P(^XTMP("RCTCSPD",$J,"BILL",ACTION,X),U,1)
"RTN","RCTCSP2",214,0)
 ..S RCDAT2=$P(^XTMP("RCTCSPD",$J,"BILL",ACTION,X),U,2)
"RTN","RCTCSP2",215,0)
 ..S ^XTMP("RCTCSPD",$J,"BILL","MSG",RCNT)=$$RJZF($P($G(^PRCA(430,X,0)),U,1),7)_$$BLANK(22)_RCDAT1_"     "_ACTION_"        "_$S(RCDAT2]"":RCDAT2,1:"")
"RTN","RCTCSP2",216,0)
 ..Q
"RTN","RCTCSP2",217,0)
 .S ^XTMP("RCTCSPD",$J,"BILL","MSG",RCNT+1)="Total Bills: "_(RCNT-2)
"RTN","RCTCSP2",218,0)
 .S XMTEXT="^XTMP(""RCTCSPD"","_$J_",""BILL"",""MSG"","
"RTN","RCTCSP2",219,0)
 .D ^XMD
"RTN","RCTCSP2",220,0)
 .K ^XTMP("RCTCSPD",$J,"BILL","MSG")
"RTN","RCTCSP2",221,0)
 Q
"RTN","RCTCSP2",222,0)
 ;
"RTN","RCTCSP2",223,0)
THIRD ;sends mailman message to user if no third letter found
"RTN","RCTCSP2",224,0)
 Q:'$D(^XTMP("RCTCSPD",$J,"THIRD"))
"RTN","RCTCSP2",225,0)
 N XMY,XMDUZ,XMSUB,XMTEXT
"RTN","RCTCSP2",226,0)
 S XMDUZ="AR PACKAGE"
"RTN","RCTCSP2",227,0)
 S XMY("G.TCSP")=""
"RTN","RCTCSP2",228,0)
 N TCT,TDEB,TDEB0,TBIL,TSP,FST
"RTN","RCTCSP2",229,0)
 S XMSUB="TCSP QUALIFIED/NO 3RD LETTER SENT ON "_$E(DT,4,5)_"/"_$E(DT,6,7)_"/"_$E(DT,2,3)
"RTN","RCTCSP2",230,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",1)="The following list of debtor bills were not sent to TCSP."
"RTN","RCTCSP2",231,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",2)="Please review debtor's account to determine why the third"
"RTN","RCTCSP2",232,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",3)="notice letter has not been sent:"
"RTN","RCTCSP2",233,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",4)="Name       Bill #"
"RTN","RCTCSP2",234,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",5)="----       ------"
"RTN","RCTCSP2",235,0)
 S TCT=6,TSP=0,TDEB=""
"RTN","RCTCSP2",236,0)
 F  S TDEB=$O(^XTMP("RCTCSPD",$J,"THIRD",TDEB)) Q:TDEB=""  D
"RTN","RCTCSP2",237,0)
 .S FST=1,TBIL=""
"RTN","RCTCSP2",238,0)
 .I FST,TCT'=6 S ^XTMP("RCTCSPD",$J,"THIRD",TCT)="",TCT=TCT+1,TSP=TSP+1
"RTN","RCTCSP2",239,0)
 .F  S TBIL=$O(^XTMP("RCTCSPD",$J,"THIRD",TDEB,TBIL)) Q:TBIL=""  D
"RTN","RCTCSP2",240,0)
 ..S TDEB0=$S(FST:TDEB,1:"")
"RTN","RCTCSP2",241,0)
 ..S ^XTMP("RCTCSPD",$J,"THIRD",TCT)=TDEB0_$J(" ",35-$L(TDEB0))_TBIL
"RTN","RCTCSP2",242,0)
 ..S TCT=TCT+1,FST=0
"RTN","RCTCSP2",243,0)
 S ^XTMP("RCTCSPD",$J,"THIRD",TCT)="Total records: "_(TCT-(6+TSP))
"RTN","RCTCSP2",244,0)
 S XMTEXT="^XTMP(""RCTCSPD"","_$J_",""THIRD"","
"RTN","RCTCSP2",245,0)
 D ^XMD
"RTN","RCTCSP2",246,0)
 K ^XTMP("RCTCSPD",$J,"THIRD")
"RTN","RCTCSP2",247,0)
THIRDQ Q
"RTN","RCTCSP2",248,0)
 ;
"RTN","RCTCSP2",249,0)
REC3 ;
"RTN","RCTCSP2",250,0)
 N REC,KNUM,DEBTNR,DEBTORNB
"RTN","RCTCSP2",251,0)
 S REC="C3 "_ACTION_"3636001200"_"DM1D "
"RTN","RCTCSP2",252,0)
 S KNUM=$P($P(B0,U,1),"-",2)
"RTN","RCTCSP2",253,0)
 S DEBTNR=$E(SITE,1,3)_$$LJZF(KNUM,7)_$TR($J(BILL,20)," ",0),REC=REC_DEBTNR
"RTN","RCTCSP2",254,0)
 S DEBTORNB=$E(SITE,1,3)_$TR($J(DEBTOR,12)," ",0)
"RTN","RCTCSP2",255,0)
 S REC=REC_DEBTORNB
"RTN","RCTCSP2",256,0)
 S REC=REC_$S(ACTION="L":"15",1:"  ")
"RTN","RCTCSP2",257,0)
 S REC=REC_"SLF"
"RTN","RCTCSP2",258,0)
 S REC=REC_$$BLANK(8)
"RTN","RCTCSP2",259,0)
 S REC=REC_$$AMOUNT(0)
"RTN","RCTCSP2",260,0)
 S REC=REC_$$BLANK(16)
"RTN","RCTCSP2",261,0)
 S REC=REC_"SLFIND"
"RTN","RCTCSP2",262,0)
 S REC=REC_$$BLANK(450-$L(REC))
"RTN","RCTCSP2",263,0)
 S ^XTMP("RCTCSPD",$J,BILL,ACTION,3)=REC
"RTN","RCTCSP2",264,0)
 S $P(^XTMP("RCTCSPD",$J,"BILL",ACTION,BILL),U,1)=$$TAXID(DEBTOR)
"RTN","RCTCSP2",265,0)
 Q
"RTN","RCTCSP2",266,0)
 ;
"RTN","RCTCSP2",267,0)
DATE8(X) ;changes fileman date into 8 digit date yyyymmdd
"RTN","RCTCSP2",268,0)
 I +X S X=X+17000000
"RTN","RCTCSP2",269,0)
 S X=$E(X,1,8)
"RTN","RCTCSP2",270,0)
 Q X
"RTN","RCTCSP2",271,0)
 ;
"RTN","RCTCSP2",272,0)
AMOUNT(X) ;changes amount to zero filled, right justified
"RTN","RCTCSP2",273,0)
 S:X<0 X=-X
"RTN","RCTCSP2",274,0)
 S X=$TR($J(X,0,2),".")
"RTN","RCTCSP2",275,0)
 S X=$E("000000000000",1,14-$L(X))_X
"RTN","RCTCSP2",276,0)
 Q X
"RTN","RCTCSP2",277,0)
 ;
"RTN","RCTCSP2",278,0)
BLANK(X) ;returns 'x' blank spaces
"RTN","RCTCSP2",279,0)
 N BLANK
"RTN","RCTCSP2",280,0)
 S BLANK="",$P(BLANK," ",X+1)=""
"RTN","RCTCSP2",281,0)
 Q BLANK
"RTN","RCTCSP2",282,0)
 ;
"RTN","RCTCSP2",283,0)
RJZF(X,Y) ;right justify zero fill width Y
"RTN","RCTCSP2",284,0)
 S X=$E("000000000000",1,Y-$L(X))_X
"RTN","RCTCSP2",285,0)
 Q X
"RTN","RCTCSP2",286,0)
 ;
"RTN","RCTCSP2",287,0)
LJSF(X,Y) ;left justified space filled
"RTN","RCTCSP2",288,0)
 S X=$E(X,1,Y)
"RTN","RCTCSP2",289,0)
 S X=X_$$BLANK(Y-$L(X))
"RTN","RCTCSP2",290,0)
 Q X
"RTN","RCTCSP2",291,0)
 ;
"RTN","RCTCSP2",292,0)
LJZF(X,Y) ;x left justified, y zero filled
"RTN","RCTCSP2",293,0)
 S X=X_"0000000000"
"RTN","RCTCSP2",294,0)
 S X=$E(X,X,Y)
"RTN","RCTCSP2",295,0)
 Q X
"RTN","RCTCSP2",296,0)
 ;
"RTN","RCTCSP2",297,0)
TAXID(DEBTOR) ;computes TAXID to place on documents
"RTN","RCTCSP2",298,0)
 N TAXID,DIC,DA,DR,DIQ
"RTN","RCTCSP2",299,0)
 S TAXID=$$SSN^RCFN01(DEBTOR)
"RTN","RCTCSP2",300,0)
 S TAXID=$$LJSF(TAXID,9)
"RTN","RCTCSP2",301,0)
 Q TAXID
"RTN","RCTCSP2",302,0)
 ;
"RTN","RCTCSP2",303,0)
DTFRMTO(PROMPT) ;Get from and to dates  (added as per PRCA*4.5*315 to be able to sort by dates for reports)
"RTN","RCTCSP2",304,0)
 ;INPUT:
"RTN","RCTCSP2",305,0)
 ;   PROMPT - Message to display prior to prompting for dates
"RTN","RCTCSP2",306,0)
 ;OUTPUT:
"RTN","RCTCSP2",307,0)
 ;    1^BEGDT^ENDDT - Data found
"RTN","RCTCSP2",308,0)
 ;    0     - User up arrowed or timed out
"RTN","RCTCSP2",309,0)
 ;
"RTN","RCTCSP2",310,0)
 N %DT,Y,X,BEGDT,ENDDT,DTOUT,OUT,DIRUT,DUOUT,DIROUT,DTFROM,DTTO
"RTN","RCTCSP2",311,0)
 S OUT=0
"RTN","RCTCSP2",312,0)
 W !,$G(PROMPT)
"RTN","RCTCSP2",313,0)
 S %DT="AEX"
"RTN","RCTCSP2",314,0)
 S %DT("A")="Date Range: FROM: " ;Enter Beginning Date: "
"RTN","RCTCSP2",315,0)
 S %DT("B")="T-30"
"RTN","RCTCSP2",316,0)
 W !
"RTN","RCTCSP2",317,0)
 D ^%DT
"RTN","RCTCSP2",318,0)
 K %DT
"RTN","RCTCSP2",319,0)
 Q:Y<0 OUT  ;Quit if user time out or didn't enter valid date
"RTN","RCTCSP2",320,0)
 S DTFROM=+Y
"RTN","RCTCSP2",321,0)
 S %DT="AEX"
"RTN","RCTCSP2",322,0)
 S %DT("A")="      TO:   ",%DT("B")="T" ;"TODAY"
"RTN","RCTCSP2",323,0)
 D ^%DT
"RTN","RCTCSP2",324,0)
 K %DT
"RTN","RCTCSP2",325,0)
 ;Quit if user time out or didn't enter valid date
"RTN","RCTCSP2",326,0)
 Q:Y<0 OUT
"RTN","RCTCSP2",327,0)
 S DTTO=+Y
"RTN","RCTCSP2",328,0)
 S OUT=1_U_DTFROM_U_DTTO
"RTN","RCTCSP2",329,0)
 ;Switch dates if Begin Date is more recent than End Date
"RTN","RCTCSP2",330,0)
 S:DTFROM>DTTO OUT=1_U_DTTO_U_DTFROM
"RTN","RCTCSP2",331,0)
 Q OUT
"RTN","RCTCSP2",332,0)
 ;
"VER")
8.0^22.2
"BLD",11212,6)
^300
**END**
**END**

