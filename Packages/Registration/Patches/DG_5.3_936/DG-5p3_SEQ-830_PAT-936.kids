Released DG*5.3*936 SEQ #830
Extracted from mail message
**KIDS**:DG*5.3*936^

**INSTALL NAME**
DG*5.3*936
"BLD",9965,0)
DG*5.3*936^REGISTRATION^0^3170817^y
"BLD",9965,1,0)
^^1^1^3170130^
"BLD",9965,1,1,0)
ENROLLMENT SYSTEMS COMMUNITY CARE(ESCC) HEALTH BENEFIT PLAN UPDATES
"BLD",9965,4,0)
^9.64PA^25.11^1
"BLD",9965,4,25.11,0)
25.11
"BLD",9965,4,25.11,2,0)
^9.641^25.11^1
"BLD",9965,4,25.11,2,25.11,0)
HEALTH BENEFIT PLAN  (File-top level)
"BLD",9965,4,25.11,2,25.11,1,0)
^9.6411^.05^1
"BLD",9965,4,25.11,2,25.11,1,.05,0)
COVERAGE CODE
"BLD",9965,4,25.11,222)
y^y^p^^^^n^^n
"BLD",9965,4,25.11,224)

"BLD",9965,4,"APDD",25.11,25.11)

"BLD",9965,4,"APDD",25.11,25.11,.05)

"BLD",9965,4,"B",25.11,25.11)

"BLD",9965,6)
10^
"BLD",9965,6.3)
20
"BLD",9965,"ABPKG")
n
"BLD",9965,"INIT")
POST^DG53P936
"BLD",9965,"KRN",0)
^9.67PA^779.2^20
"BLD",9965,"KRN",.4,0)
.4
"BLD",9965,"KRN",.401,0)
.401
"BLD",9965,"KRN",.402,0)
.402
"BLD",9965,"KRN",.403,0)
.403
"BLD",9965,"KRN",.5,0)
.5
"BLD",9965,"KRN",.84,0)
.84
"BLD",9965,"KRN",3.6,0)
3.6
"BLD",9965,"KRN",3.8,0)
3.8
"BLD",9965,"KRN",9.2,0)
9.2
"BLD",9965,"KRN",9.8,0)
9.8
"BLD",9965,"KRN",9.8,"NM",0)
^9.68A^2^2
"BLD",9965,"KRN",9.8,"NM",1,0)
DGRPD^^0^B77747984
"BLD",9965,"KRN",9.8,"NM",2,0)
DG53P936^^0^B99859550
"BLD",9965,"KRN",9.8,"NM","B","DG53P936",2)

"BLD",9965,"KRN",9.8,"NM","B","DGRPD",1)

"BLD",9965,"KRN",19,0)
19
"BLD",9965,"KRN",19,"NM",0)
^9.68A^^
"BLD",9965,"KRN",19.1,0)
19.1
"BLD",9965,"KRN",19.1,"NM",0)
^9.68A^^
"BLD",9965,"KRN",101,0)
101
"BLD",9965,"KRN",101,"NM",0)
^9.68A^^
"BLD",9965,"KRN",409.61,0)
409.61
"BLD",9965,"KRN",409.61,"NM",0)
^9.68A^^
"BLD",9965,"KRN",771,0)
771
"BLD",9965,"KRN",779.2,0)
779.2
"BLD",9965,"KRN",870,0)
870
"BLD",9965,"KRN",8989.51,0)
8989.51
"BLD",9965,"KRN",8989.52,0)
8989.52
"BLD",9965,"KRN",8994,0)
8994
"BLD",9965,"KRN","B",.4,.4)

"BLD",9965,"KRN","B",.401,.401)

"BLD",9965,"KRN","B",.402,.402)

"BLD",9965,"KRN","B",.403,.403)

"BLD",9965,"KRN","B",.5,.5)

"BLD",9965,"KRN","B",.84,.84)

"BLD",9965,"KRN","B",3.6,3.6)

"BLD",9965,"KRN","B",3.8,3.8)

"BLD",9965,"KRN","B",9.2,9.2)

"BLD",9965,"KRN","B",9.8,9.8)

"BLD",9965,"KRN","B",19,19)

"BLD",9965,"KRN","B",19.1,19.1)

"BLD",9965,"KRN","B",101,101)

"BLD",9965,"KRN","B",409.61,409.61)

"BLD",9965,"KRN","B",771,771)

"BLD",9965,"KRN","B",779.2,779.2)

"BLD",9965,"KRN","B",870,870)

"BLD",9965,"KRN","B",8989.51,8989.51)

"BLD",9965,"KRN","B",8989.52,8989.52)

"BLD",9965,"KRN","B",8994,8994)

"BLD",9965,"QUES",0)
^9.62^^
"BLD",9965,"REQB",0)
^9.611^1^1
"BLD",9965,"REQB",1,0)
DG*5.3*925^1
"BLD",9965,"REQB","B","DG*5.3*925",1)

"FIA",25.11)
HEALTH BENEFIT PLAN
"FIA",25.11,0)
^DGHBP(25.11,
"FIA",25.11,0,0)
25.11I
"FIA",25.11,0,1)
y^y^p^^^^n^^n
"FIA",25.11,0,10)

"FIA",25.11,0,11)

"FIA",25.11,0,"RLRO")

"FIA",25.11,0,"VR")
5.3^DG
"FIA",25.11,25.11)
1
"FIA",25.11,25.11,.05)

"INIT")
POST^DG53P936
"MBREQ")
0
"PKG",47,-1)
1^1
"PKG",47,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",47,20,0)
^9.402P^^
"PKG",47,22,0)
^9.49I^1^1
"PKG",47,22,1,0)
5.3^2930813^2960613
"PKG",47,22,1,"PAH",1,0)
936^3170817^101100
"PKG",47,22,1,"PAH",1,1,0)
^^1^1^3170817
"PKG",47,22,1,"PAH",1,1,1,0)
ENROLLMENT SYSTEMS COMMUNITY CARE(ESCC) HEALTH BENEFIT PLAN UPDATES
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
2
"RTN","DG53P936")
0^2^B99859550^n/a
"RTN","DG53P936",1,0)
DG53P936 ;KUM - HEALTH BENEFIT PLANS UPDATE ;1/08/17 9:18am
"RTN","DG53P936",2,0)
 ;;5.3;Registration;**936**;Aug 13, 1993;Build 20
"RTN","DG53P936",3,0)
 ;;Per VHA Directive 2004-038, this routine should not be modified.
"RTN","DG53P936",4,0)
 ;
"RTN","DG53P936",5,0)
 ; KUM; DG*5.3*936 Post Install routine to add data about 6 new plans
"RTN","DG53P936",6,0)
 ;  Integration Agreements:
"RTN","DG53P936",7,0)
 ;        10141 : BMES^XPDUTL
"RTN","DG53P936",8,0)
 ;              : MES^XPDUTL
"RTN","DG53P936",9,0)
 ;        10018 : UPDATE^DIE
"RTN","DG53P936",10,0)
 ;
"RTN","DG53P936",11,0)
 Q
"RTN","DG53P936",12,0)
 ;
"RTN","DG53P936",13,0)
POST ;Update 6 Health Benefit Plans
"RTN","DG53P936",14,0)
 ;
"RTN","DG53P936",15,0)
 L +^DGHBP(25.11,0):10 I '$T D BMES^XPDUTL("     Health Benefit Plan (#25.11) File is locked by another user. Try later.   ") Q
"RTN","DG53P936",16,0)
 N HBPERR
"RTN","DG53P936",17,0)
 S HBPERR=""
"RTN","DG53P936",18,0)
 D BMES^XPDUTL("    Checking Entry in HEALTH BENEFIT PLAN File - Veteran Plan - Veterans Choice Basic   ")
"RTN","DG53P936",19,0)
 D UPDPS1
"RTN","DG53P936",20,0)
 D BMES^XPDUTL("    Checking Entry in HEALTH BENEFIT PLAN File - Veteran Plan - Veterans Choice Mileage   ")
"RTN","DG53P936",21,0)
 D UPDPS2
"RTN","DG53P936",22,0)
 D BMES^XPDUTL("    Checking Entry in HEALTH BENEFIT PLAN File - Veteran Plan - Veterans Choice Wait Time   ")
"RTN","DG53P936",23,0)
 D UPDPS3
"RTN","DG53P936",24,0)
 D BMES^XPDUTL("    Checking Entry in HEALTH BENEFIT PLAN File - Veteran Plan - VC Unusual and Excessive Burden   ")
"RTN","DG53P936",25,0)
 D UPDPS4
"RTN","DG53P936",26,0)
 D BMES^XPDUTL("    Checking Entry in HEALTH BENEFIT PLAN File - Veteran Plan - Veterans Choice Air, Boat, or Ferry   ")
"RTN","DG53P936",27,0)
 D UPDPS5
"RTN","DG53P936",28,0)
 D BMES^XPDUTL("    Checking Entry in HEALTH BENEFIT PLAN File - Veteran Plan - Military Sexual Trauma   ")
"RTN","DG53P936",29,0)
 D UPDPS6
"RTN","DG53P936",30,0)
 L -^DGHBP(25.11,0)
"RTN","DG53P936",31,0)
 Q
"RTN","DG53P936",32,0)
 ;
"RTN","DG53P936",33,0)
UPDPS1 ;Setup new Health Benefit Plan - Veteran Plan - Veterans Choice Basic
"RTN","DG53P936",34,0)
 ;
"RTN","DG53P936",35,0)
 N FIELDS,ERR
"RTN","DG53P936",36,0)
 S ERR=""
"RTN","DG53P936",37,0)
 S FIELDS("NAME")="Veteran Plan - Veterans Choice Basic"
"RTN","DG53P936",38,0)
 S FIELDS("PLANCODE")=200
"RTN","DG53P936",39,0)
 S FIELDS("COVERAGECODE")="VC01001"
"RTN","DG53P936",40,0)
 S FIELDS("SD",1)="The Veteran must be enrolled in the VA health care system and does not "
"RTN","DG53P936",41,0)
 S FIELDS("SD",2)="qualify for the Services at this time."
"RTN","DG53P936",42,0)
 S FIELDS("LD",1)="The Veteran must be enrolled in the VA health care system and does not "
"RTN","DG53P936",43,0)
 S FIELDS("LD",2)="qualify for the Services at this time."
"RTN","DG53P936",44,0)
 D UPDREQ(.FIELDS,1,.ERR)
"RTN","DG53P936",45,0)
 I ERR'="" D
"RTN","DG53P936",46,0)
 . D BMES^XPDUTL("     *** An Error occurred during updating Plan: Veteran Plan - Veterans Choice Basic.")
"RTN","DG53P936",47,0)
 . D MES^XPDUTL("     Please log CA SDM ticket.")
"RTN","DG53P936",48,0)
 . S HBPERR=ERR
"RTN","DG53P936",49,0)
 . Q
"RTN","DG53P936",50,0)
 ;
"RTN","DG53P936",51,0)
 Q
"RTN","DG53P936",52,0)
UPDPS2 ;Setup new Health Benefit Plan - Veteran Plan - Veterans Choice Mileage
"RTN","DG53P936",53,0)
 ;
"RTN","DG53P936",54,0)
 N FIELDS,ERR
"RTN","DG53P936",55,0)
 S ERR=""
"RTN","DG53P936",56,0)
 S FIELDS("NAME")="Veteran Plan - Veterans Choice Mileage"
"RTN","DG53P936",57,0)
 S FIELDS("PLANCODE")=201
"RTN","DG53P936",58,0)
 S FIELDS("COVERAGECODE")="VC01002"
"RTN","DG53P936",59,0)
 S FIELDS("SD",1)="The Veteran must be enrolled in the VA health care system.  The Veteran meets "
"RTN","DG53P936",60,0)
 S FIELDS("SD",2)="mileage criteria as described by legislation. This is calculated from the "
"RTN","DG53P936",61,0)
 S FIELDS("SD",3)="VA medical facility that is closest to the residence of the Veteran, defined "
"RTN","DG53P936",62,0)
 S FIELDS("SD",4)="as a VA hospital, community-based outpatient clinic, or VA health care center "
"RTN","DG53P936",63,0)
 S FIELDS("SD",5)="with at least one full-time primary care physician. The distance is calculated "
"RTN","DG53P936",64,0)
 S FIELDS("SD",6)="using driving distance."
"RTN","DG53P936",65,0)
 S FIELDS("LD",1)="The Veteran must be enrolled in the VA health care system.  The Veteran meets "
"RTN","DG53P936",66,0)
 S FIELDS("LD",2)="mileage criteria as described by legislation. This is calculated from the "
"RTN","DG53P936",67,0)
 S FIELDS("LD",3)="VA medical facility that is closest to the residence of the Veteran, defined "
"RTN","DG53P936",68,0)
 S FIELDS("LD",4)="as a VA hospital, community-based outpatient clinic, or VA health care center "
"RTN","DG53P936",69,0)
 S FIELDS("LD",5)="with at least one full-time primary care physician. The distance is calculated "
"RTN","DG53P936",70,0)
 S FIELDS("LD",6)="using driving distance."
"RTN","DG53P936",71,0)
 D UPDREQ(.FIELDS,1,.ERR)
"RTN","DG53P936",72,0)
 I ERR'="" D
"RTN","DG53P936",73,0)
 . D BMES^XPDUTL("     *** An Error occurred during updating Plan: Veteran Plan - Veterans Choice Mileage.")
"RTN","DG53P936",74,0)
 . D MES^XPDUTL("     Please log CA SDM ticket.")
"RTN","DG53P936",75,0)
 . S HBPERR=ERR
"RTN","DG53P936",76,0)
 . Q
"RTN","DG53P936",77,0)
 ;
"RTN","DG53P936",78,0)
 Q
"RTN","DG53P936",79,0)
UPDPS3 ;Setup new Health Benefit Plan - Veteran Plan - Veterans Choice Wait Time
"RTN","DG53P936",80,0)
 ;
"RTN","DG53P936",81,0)
 N FIELDS,ERR
"RTN","DG53P936",82,0)
 S ERR=""
"RTN","DG53P936",83,0)
 S FIELDS("NAME")="Veteran Plan - Veterans Choice Wait Time"
"RTN","DG53P936",84,0)
 S FIELDS("PLANCODE")=202
"RTN","DG53P936",85,0)
 S FIELDS("COVERAGECODE")="VC01003"
"RTN","DG53P936",86,0)
 S FIELDS("SD",1)="The Veteran must be enrolled in the VA health care system. Veteran is told "
"RTN","DG53P936",87,0)
 S FIELDS("SD",2)="by his/her local VA medical facility that he/she will need to wait more than "
"RTN","DG53P936",88,0)
 S FIELDS("SD",3)="30 days for an appointment from the date clinically determined by his/her "
"RTN","DG53P936",89,0)
 S FIELDS("SD",4)="VA health care provider or the date they wish to be seen if there is no "
"RTN","DG53P936",90,0)
 S FIELDS("SD",5)="clinically determined date."
"RTN","DG53P936",91,0)
 S FIELDS("LD",1)="The Veteran must be enrolled in the VA health care system. Veteran is told "
"RTN","DG53P936",92,0)
 S FIELDS("LD",2)="by his/her local VA medical facility that he/she will need to wait more than "
"RTN","DG53P936",93,0)
 S FIELDS("LD",3)="30 days for an appointment from the date clinically determined by his/her "
"RTN","DG53P936",94,0)
 S FIELDS("LD",4)="VA health care provider or the date they wish to be seen if there is no "
"RTN","DG53P936",95,0)
 S FIELDS("LD",5)="clinically determined date."
"RTN","DG53P936",96,0)
 D UPDREQ(.FIELDS,1,.ERR)
"RTN","DG53P936",97,0)
 I ERR'="" D
"RTN","DG53P936",98,0)
 . D BMES^XPDUTL("     *** An Error occurred during updating Plan: Veteran Plan - Veterans Choice Wait Time")
"RTN","DG53P936",99,0)
 . D MES^XPDUTL("     Please log CA SDM ticket.")
"RTN","DG53P936",100,0)
 . S HBPERR=ERR
"RTN","DG53P936",101,0)
 . Q
"RTN","DG53P936",102,0)
 ;
"RTN","DG53P936",103,0)
 Q
"RTN","DG53P936",104,0)
UPDPS4 ;Setup new Health Benefit Plan - Veteran Plan - VC Unusual and Excessive Burden
"RTN","DG53P936",105,0)
 ;
"RTN","DG53P936",106,0)
 N FIELDS,ERR
"RTN","DG53P936",107,0)
 S ERR=""
"RTN","DG53P936",108,0)
 S FIELDS("NAME")="Veteran Plan - VC Unusual and Excessive Burden"
"RTN","DG53P936",109,0)
 S FIELDS("PLANCODE")=203
"RTN","DG53P936",110,0)
 S FIELDS("COVERAGECODE")="VC01004"
"RTN","DG53P936",111,0)
 S FIELDS("SD",1)="The Veteran must be enrolled in the VA health care system. The Veteran who "
"RTN","DG53P936",112,0)
 S FIELDS("SD",2)="resides 40 miles or less from the nearest VA medical facility may face an "
"RTN","DG53P936",113,0)
 S FIELDS("SD",3)="unusual or excessive burden in accessing such a facility based on: "
"RTN","DG53P936",114,0)
 S FIELDS("SD",4)=". Geographical challenges"
"RTN","DG53P936",115,0)
 S FIELDS("SD",5)=". Environmental factors such as:"
"RTN","DG53P936",116,0)
 S FIELDS("SD",6)=" o Roads that are not accessible to the general public, such as a road through "
"RTN","DG53P936",117,0)
 S FIELDS("SD",7)="   a military base or restricted area"
"RTN","DG53P936",118,0)
 S FIELDS("SD",8)=" o Traffic, or"
"RTN","DG53P936",119,0)
 S FIELDS("SD",9)=" o Hazardous weather conditions"
"RTN","DG53P936",120,0)
 S FIELDS("SD",10)=". A medical condition that impacts the ability to travel"
"RTN","DG53P936",121,0)
 S FIELDS("SD",11)=". Other factors (as determined by the Secretary of VA)"
"RTN","DG53P936",122,0)
 S FIELDS("LD",1)="The Veteran must be enrolled in the VA health care system. The Veteran who "
"RTN","DG53P936",123,0)
 S FIELDS("LD",2)="resides 40 miles or less from the nearest VA medical facility may face an "
"RTN","DG53P936",124,0)
 S FIELDS("LD",3)="unusual or excessive burden in accessing such a facility based on: "
"RTN","DG53P936",125,0)
 S FIELDS("LD",4)=". Geographical challenges"
"RTN","DG53P936",126,0)
 S FIELDS("LD",5)=". Environmental factors such as:"
"RTN","DG53P936",127,0)
 S FIELDS("LD",6)=" o Roads that are not accessible to the general public, such as a road through "
"RTN","DG53P936",128,0)
 S FIELDS("LD",7)="   a military base or restricted area"
"RTN","DG53P936",129,0)
 S FIELDS("LD",8)=" o Traffic, or"
"RTN","DG53P936",130,0)
 S FIELDS("LD",9)=" o Hazardous weather conditions"
"RTN","DG53P936",131,0)
 S FIELDS("LD",10)=". A medical condition that impacts the ability to travel"
"RTN","DG53P936",132,0)
 S FIELDS("LD",11)=". Other factors (as determined by the Secretary of VA)"
"RTN","DG53P936",133,0)
 D UPDREQ(.FIELDS,1,.ERR)
"RTN","DG53P936",134,0)
 I ERR'="" D
"RTN","DG53P936",135,0)
 . D BMES^XPDUTL("     *** An Error occurred during updating Plan: Veteran Plan - Veterans Choice Wait Time")
"RTN","DG53P936",136,0)
 . D MES^XPDUTL("     Please log CA SDM ticket.")
"RTN","DG53P936",137,0)
 . S HBPERR=ERR
"RTN","DG53P936",138,0)
 . Q
"RTN","DG53P936",139,0)
 ;
"RTN","DG53P936",140,0)
 Q
"RTN","DG53P936",141,0)
UPDPS5 ;Setup new Health Benefit Plan - Veteran Plan - Veterans Choice Air, Boat, or Ferry
"RTN","DG53P936",142,0)
 ;
"RTN","DG53P936",143,0)
 N FIELDS,ERR
"RTN","DG53P936",144,0)
 S ERR=""
"RTN","DG53P936",145,0)
 S FIELDS("NAME")="Veteran Plan - Veterans Choice Air, Boat, or Ferry"
"RTN","DG53P936",146,0)
 S FIELDS("PLANCODE")=204
"RTN","DG53P936",147,0)
 S FIELDS("COVERAGECODE")="VC01005"
"RTN","DG53P936",148,0)
 S FIELDS("SD",1)="The Veteran must be enrolled in the VA health care system. The Veteran who "
"RTN","DG53P936",149,0)
 S FIELDS("SD",2)="resides 40 miles or less from the nearest VA medical facility and must travel "
"RTN","DG53P936",150,0)
 S FIELDS("SD",3)="by air, boat, or ferry to reach such a facility."
"RTN","DG53P936",151,0)
 S FIELDS("LD",1)="The Veteran must be enrolled in the VA health care system. The Veteran who "
"RTN","DG53P936",152,0)
 S FIELDS("LD",2)="resides 40 miles or less from the nearest VA medical facility and must travel "
"RTN","DG53P936",153,0)
 S FIELDS("LD",3)="by air, boat, or ferry to reach such a facility."
"RTN","DG53P936",154,0)
 D UPDREQ(.FIELDS,1,.ERR)
"RTN","DG53P936",155,0)
 I ERR'="" D
"RTN","DG53P936",156,0)
 . D BMES^XPDUTL("     *** An Error occurred during updating Plan: Veteran Plan - Veterans Choice Air, Boat, or Ferry    ;")
"RTN","DG53P936",157,0)
 . D MES^XPDUTL("     Please log CA SDM ticket.")
"RTN","DG53P936",158,0)
 . S HBPERR=ERR
"RTN","DG53P936",159,0)
 . Q
"RTN","DG53P936",160,0)
 ;
"RTN","DG53P936",161,0)
 Q
"RTN","DG53P936",162,0)
UPDPS6 ;Setup new Health Benefit Plan - Veteran Plan - Military Sexual Trauma
"RTN","DG53P936",163,0)
 ;
"RTN","DG53P936",164,0)
 N FIELDS,ERR
"RTN","DG53P936",165,0)
 S ERR=""
"RTN","DG53P936",166,0)
 S FIELDS("NAME")="Veteran Plan - Military Sexual Trauma"
"RTN","DG53P936",167,0)
 S FIELDS("PLANCODE")=205
"RTN","DG53P936",168,0)
 S FIELDS("COVERAGECODE")="MS01001"
"RTN","DG53P936",169,0)
 S FIELDS("SD",1)=""
"RTN","DG53P936",170,0)
 S FIELDS("LD",1)=""
"RTN","DG53P936",171,0)
 D UPDREQ(.FIELDS,1,.ERR)
"RTN","DG53P936",172,0)
 I ERR'="" D
"RTN","DG53P936",173,0)
 . D BMES^XPDUTL("     *** An Error occurred during updating Plan: Veteran Plan - Military Sexual Trauma    ;")
"RTN","DG53P936",174,0)
 . D MES^XPDUTL("     Please log CA SDM ticket.")
"RTN","DG53P936",175,0)
 . S HBPERR=ERR
"RTN","DG53P936",176,0)
 . Q
"RTN","DG53P936",177,0)
 ;
"RTN","DG53P936",178,0)
 Q
"RTN","DG53P936",179,0)
UPDREQ(FIELDS,NEW,ERR) ; Update entries in the HEALTH BENEFIT PLAN File (25.11)
"RTN","DG53P936",180,0)
 ;
"RTN","DG53P936",181,0)
 ;  Input: FIELDS - Array of Field Values
"RTN","DG53P936",182,0)
 ;            NEW - 0 to edit, 1 to create new entry
"RTN","DG53P936",183,0)
 ;
"RTN","DG53P936",184,0)
 ;  Output:   ERR - Error Text
"RTN","DG53P936",185,0)
 ;
"RTN","DG53P936",186,0)
 N IEN,NAME,PLANCODE,COVERAGECODE,SD,LD,FDA,DGPFMSG,DGPFMS1
"RTN","DG53P936",187,0)
 K ERR
"RTN","DG53P936",188,0)
 S ERR=""
"RTN","DG53P936",189,0)
 S NAME=$G(FIELDS("NAME"))
"RTN","DG53P936",190,0)
 S PLANCODE=$G(FIELDS("PLANCODE"))
"RTN","DG53P936",191,0)
 M SD=FIELDS("SD")
"RTN","DG53P936",192,0)
 M LD=FIELDS("LD")
"RTN","DG53P936",193,0)
 S COVERAGECODE=$G(FIELDS("COVERAGECODE"))
"RTN","DG53P936",194,0)
 I NAME="" S ERR="Missing Health Benefit Plan Name" Q
"RTN","DG53P936",195,0)
 I NEW D  Q:ERR'="" 
"RTN","DG53P936",196,0)
 . I PLANCODE="" S ERR="Missing Plan Code" Q
"RTN","DG53P936",197,0)
 . I '$D(SD) S ERR="Missing Short Description" Q
"RTN","DG53P936",198,0)
 . I '$D(LD) S ERR="Missing Long Description" Q
"RTN","DG53P936",199,0)
 . I COVERAGECODE="" S ERR="Missing Coverage Code" Q
"RTN","DG53P936",200,0)
 . Q
"RTN","DG53P936",201,0)
 ;
"RTN","DG53P936",202,0)
 ; Check if entry exists, use it if it does
"RTN","DG53P936",203,0)
 S IEN=$O(^DGHBP(25.11,"B",NAME,0))
"RTN","DG53P936",204,0)
 I IEN D BMES^XPDUTL("    "_NAME_" already exists, no action is taken.  ") Q
"RTN","DG53P936",205,0)
 I NEW,'IEN S IEN="+1"
"RTN","DG53P936",206,0)
 I 'NEW,'IEN S ERR="Health Benefit Plan Not Defined" Q 0
"RTN","DG53P936",207,0)
 S IEN=IEN_","
"RTN","DG53P936",208,0)
 ;
"RTN","DG53P936",209,0)
 S FDA(25.11,IEN,.01)=NAME
"RTN","DG53P936",210,0)
 S:PLANCODE'="" FDA(25.11,IEN,.02)=PLANCODE
"RTN","DG53P936",211,0)
 S:COVERAGECODE'="" FDA(25.11,IEN,.05)=COVERAGECODE
"RTN","DG53P936",212,0)
 D UPDATE^DIE("E","FDA","","ERR")
"RTN","DG53P936",213,0)
 I $D(ERR("DIERR")) S ERR=$G(ERR("DIERR",1,"TEXT",1)) Q
"RTN","DG53P936",214,0)
 S IEN=$O(^DGHBP(25.11,"B",NAME,0))
"RTN","DG53P936",215,0)
 I 'IEN D BMES^XPDUTL("    "_IEN_" entry is not found to update Short and Long Descripton fields.  ") Q
"RTN","DG53P936",216,0)
 D WP^DIE(25.11,IEN_",",.03,"","SD","DGPFMSG") ; SHORT DESCRIPTION
"RTN","DG53P936",217,0)
 I $D(DGPFMSG) S ERR=$G(DGPFMSG("DIERR",1,"TEXT",1)) Q
"RTN","DG53P936",218,0)
 D WP^DIE(25.11,IEN_",",.04,"","LD","DGPFMS1") ; LONG DESCRIPTION
"RTN","DG53P936",219,0)
 I $D(DGPFMS1) S ERR=$G(DGPFMS1("DIERR",1,"TEXT",1)) Q
"RTN","DG53P936",220,0)
 D BMES^XPDUTL("    "_NAME_" is added in HEALTH BENEFIT PLAN File.    ")
"RTN","DG53P936",221,0)
 Q
"RTN","DG53P936",222,0)
 ;
"RTN","DGRPD")
0^1^B77747984^B71290433
"RTN","DGRPD",1,0)
DGRPD ;ALB/MRL,MLR,JAN,LBD,EG,BRM,JRC,BAJ,KUM - PATIENT INQUIRY (NEW) ;August 16, 2017
"RTN","DGRPD",2,0)
 ;;5.3;Registration;**109,124,121,57,161,149,286,358,436,445,489,498,506,513,518,550,545,568,585,677,703,688,887,907,925,936**;Aug 13, 1993;Build 20
"RTN","DGRPD",3,0)
 ;  *286*  Newing variables X,Y in OKLINE subroutine
"RTN","DGRPD",4,0)
 ;  *358*  If a patient is on a domiciliary ward, don't display MEANS
"RTN","DGRPD",5,0)
 ;         TEST required/Medication Copayment Exemption messages
"RTN","DGRPD",6,0)
 ;  *436*  If an inpatient is not on a domiciliary ward, don't display
"RTN","DGRPD",7,0)
 ;         Medication Copayment Exemption message
"RTN","DGRPD",8,0)
 ;  *545*  Add death information near the remarks field
"RTN","DGRPD",9,0)
 ;  *677*  Added Emergency Response
"RTN","DGRPD",10,0)
 ;  *688*  Modified to display Country and Foreign Address
"RTN","DGRPD",11,0)
 ;  *936*  Modified to display Health Benefit Plans
"RTN","DGRPD",12,0)
 ;
"RTN","DGRPD",13,0)
 ;  Integration Agreements:
"RTN","DGRPD",14,0)
 ;        6138 - DGHBPUTL API
"RTN","DGRPD",15,0)
 ;
"RTN","DGRPD",16,0)
SEL K DFN,DGRPOUT W ! S DIC="^DPT(",DIC(0)="AEQMZ" D ^DIC G Q:Y'>0 S DFN=+Y N Y W ! S DIR(0)="E" D ^DIR G SEL:$D(DTOUT)!($D(DUOUT)) D EN G SEL
"RTN","DGRPD",17,0)
EN ;call to display patient inquiry - input DFN
"RTN","DGRPD",18,0)
 ;MPI/PD CHANGE
"RTN","DGRPD",19,0)
 S DGCMOR="UNSPECIFIED",DGMPI=$G(^DPT(+DFN,"MPI"))
"RTN","DGRPD",20,0)
 S DGLOCATN=$$FIND1^DIC(4,"","MX","`"_+$P(DGMPI,U,3)),DGLOCATN=$S(+DGLOCATN>0:$P($$NS^XUAF4(DGLOCATN),U),1:"NOT LISTED")
"RTN","DGRPD",21,0)
 I $D(DGMPI),$D(DGLOCATN) S DGCMOR=$P(DGLOCATN,"^")
"RTN","DGRPD",22,0)
 ;END MPI/PD CHANGE
"RTN","DGRPD",23,0)
 K DGRPOUT,DGHOW S DGABBRV=$S($D(^DG(43,1,0)):+$P(^(0),"^",38),1:0),DGRPU="UNSPECIFIED" D DEM^VADPT,HDR^DGRPD1 F I=0,.11,.13,.121,.122,.31,.32,.36,.361,.141,.3 S DGRP(I)=$S($D(^DPT(DFN,I)):^(I),1:"")
"RTN","DGRPD",24,0)
 S DGAD=.11,(DGA1,DGA2)=1 D A^DGRPU S DGTMPAD=0 I $P(DGRP(.121),"^",9)="Y" S DGTMPAD=$S('$P(DGRP(.121),"^",8):1,$P(DGRP(.121),"^",8)'<DT:1,1:0) I DGTMPAD S DGAD=.121,DGA1=1,DGA2=2 D A^DGRPU
"RTN","DGRPD",25,0)
 ;jam DG*5.3*925 RM#788099 Add/Edit Residential address - move addresses down 1 line below the field labels
"RTN","DGRPD",26,0)
 ; and change labels to "Permanent Mailing Address" and "Temporary Mailing Address"
"RTN","DGRPD",27,0)
 W ?1,"Permanent Mailing Address: ",?40,"Temporary Mailing Address: "
"RTN","DGRPD",28,0)
 W !,?9,$S($D(DGA(1)):DGA(1),1:"NONE ON FILE"),?48,$S($D(DGA(2)):DGA(2),1:"NO TEMPORARY MAILING")
"RTN","DGRPD",29,0)
 S I=2 F I1=0:0 S I=$O(DGA(I)) Q:I=""  W:(I#2)!($X>50) !?9 W:'(I#2) ?48 W DGA(I)
"RTN","DGRPD",30,0)
 S DGCC=+$P(DGRP(.11),U,7),DGST=+$P(DGRP(.11),U,5),DGCC=$S($D(^DIC(5,DGST,1,DGCC,0)):$E($P(^(0),U,1),1,20)_$S($P(^(0),U,3)]"":" ("_$P(^(0),U,3)_")",1:""),1:DGRPU)
"RTN","DGRPD",31,0)
 N DGCNTRY,DGFORGN S DGCNTRY=$P(DGRP(.11),"^",10),DGFORGN=$$FORIEN^DGADDUTL(DGCNTRY) I 'DGFORGN W !?2,"County: ",DGCC
"RTN","DGRPD",32,0)
 S X="NOT APPLICABLE" I DGTMPAD S Y=$P(DGRP(.121),U,7) X:Y]"" ^DD("DD") S X=$S(Y]"":Y,1:DGRPU)_"-",Y=$P(DGRP(.121),U,8) X:Y]"" ^DD("DD") S X=X_$S(Y]"":Y,1:DGRPU)
"RTN","DGRPD",33,0)
 N DGSKIP S DGSKIP=$S(DGFORGN:"!,?42,""From/To: """,1:"?42, ""From/To: """)
"RTN","DGRPD",34,0)
 W @DGSKIP,X,!?3,"Phone: ",$S($P(DGRP(.13),U,1)]"":$P(DGRP(.13),U,1),1:DGRPU),?44,"Phone: ",$S('DGTMPAD:X,$P(DGRP(.121),U,10)]"":$P(DGRP(.121),U,10),1:DGRPU) K DGTMPADW
"RTN","DGRPD",35,0)
 W !?2,"Office: ",$S($P(DGRP(.13),U,2)]"":$P(DGRP(.13),U,2),1:DGRPU)
"RTN","DGRPD",36,0)
 W !?4,"Cell: ",$S($P(DGRP(.13),U,4)]"":$P(DGRP(.13),U,4),1:DGRPU)
"RTN","DGRPD",37,0)
 W !?2,"E-mail: ",$S($P(DGRP(.13),U,3)]"":$P(DGRP(.13),U,3),1:DGRPU)
"RTN","DGRPD",38,0)
 W !,"Bad Addr: ",$$EXTERNAL^DILFD(2,.121,"",$$BADADR^DGUTL3(+DFN))
"RTN","DGRPD",39,0)
 D CA
"RTN","DGRPD",40,0)
 N DGEMER S DGEMER=$$EXTERNAL^DILFD(2,.181,"",$P($G(^DPT(DFN,.18)),"^"))
"RTN","DGRPD",41,0)
 W:DGEMER]"" !?32,"Emergency Response: ",DGEMER
"RTN","DGRPD",42,0)
 I 'DGABBRV W !!?4,"POS: ",$S($D(^DIC(21,+$P(DGRP(.32),"^",3),0)):$P(^(0),"^",1),1:DGRPU),?42,"Claim #: ",$S($P(DGRP(.31),"^",3)]"":$P(DGRP(.31),"^",3),1:"UNSPECIFIED")
"RTN","DGRPD",43,0)
 I 'DGABBRV W !?2,"Relig: ",$S($D(^DIC(13,+$P(DGRP(0),"^",8),0)):$P(^(0),"^",1),1:DGRPU),?46,"Birth Sex: ",$S($P(VADM(5),"^",2)]"":$P(VADM(5),"^",2),1:"UNSPECIFIED") ; DG*5.3*907
"RTN","DGRPD",44,0)
 I 'DGABBRV W ! D
"RTN","DGRPD",45,0)
 .N RACE,ETHNIC,PTR,VAL,X,DIWL,DIWR,DIWF
"RTN","DGRPD",46,0)
 .K ^UTILITY($J,"W")
"RTN","DGRPD",47,0)
 .S PTR=0 F  S PTR=+$O(^DPT(DFN,.02,PTR)) Q:'PTR  D
"RTN","DGRPD",48,0)
 ..S VAL=+$G(^DPT(DFN,.02,PTR,0))
"RTN","DGRPD",49,0)
 ..Q:$$INACTIVE^DGUTL4(VAL,1)
"RTN","DGRPD",50,0)
 ..S VAL=$$PTR2TEXT^DGUTL4(VAL,1) S:+$O(^DPT(DFN,.02,PTR)) VAL=VAL_", "
"RTN","DGRPD",51,0)
 ..S X=VAL,DIWL=0,DIWR=30,DIWF="" D ^DIWP
"RTN","DGRPD",52,0)
 .M RACE=^UTILITY($J,"W",0) S:$G(RACE(1,0))="" RACE(1,0)="UNANSWERED"
"RTN","DGRPD",53,0)
 .K ^UTILITY($J,"W")
"RTN","DGRPD",54,0)
 .S PTR=0 F  S PTR=+$O(^DPT(DFN,.06,PTR)) Q:'PTR  D
"RTN","DGRPD",55,0)
 ..S VAL=+$G(^DPT(DFN,.06,PTR,0))
"RTN","DGRPD",56,0)
 ..Q:$$INACTIVE^DGUTL4(VAL,2)
"RTN","DGRPD",57,0)
 ..S VAL=$$PTR2TEXT^DGUTL4(VAL,2) S:+$O(^DPT(DFN,.06,PTR)) VAL=VAL_", "
"RTN","DGRPD",58,0)
 ..S X=VAL,DIWL=0,DIWR=30,DIWF="" D ^DIWP
"RTN","DGRPD",59,0)
 .M ETHNIC=^UTILITY($J,"W",0) S:$G(ETHNIC(1,0))="" ETHNIC(1,0)="UNANSWERED"
"RTN","DGRPD",60,0)
 .K ^UTILITY($J,"W")
"RTN","DGRPD",61,0)
 .W ?3,"Race: ",RACE(1,0),?40,"Ethnicity: ",ETHNIC(1,0)
"RTN","DGRPD",62,0)
 .F X=2:1 Q:'$D(RACE(X,0))&'$D(ETHNIC(X,0))  W !,?9,$G(RACE(X,0)),?51,$G(ETHNIC(X,0))
"RTN","DGRPD",63,0)
 I '$$OKLINE^DGRPD1(16) G Q
"RTN","DGRPD",64,0)
 D LANGUAGE
"RTN","DGRPD",65,0)
 I '$$OKLINE^DGRPD1(10) G Q
"RTN","DGRPD",66,0)
 ;display cv status #4156
"RTN","DGRPD",67,0)
 N DGCV S DGCV=$$CVEDT^DGCV(+DFN)
"RTN","DGRPD",68,0)
 W !!,?2,"Combat Vet Status: "_$S($P(DGCV,U,3)=1:"ELIGIBLE",$P(DGCV,U,3)="":"NOT ELIGIBLE",1:"EXPIRED") I DGCV>0 W ?45,"End Date: "_$$FMTE^XLFDT($P(DGCV,U,2),"5DZ")
"RTN","DGRPD",69,0)
 ;display primary eligibility
"RTN","DGRPD",70,0)
 S X1=DGRP(.36),X=$P(DGRP(.361),"^",1) W !,"Primary Eligibility: ",$S($D(^DIC(8,+X1,0)):$P(^(0),"^",1)_" ("_$S(X="V":"VERIFIED",X="P":"PENDING VERIFICATION",X="R":"PENDING REVERIFICATION",1:"NOT VERIFIED")_")",1:DGRPU)
"RTN","DGRPD",71,0)
 W !,"Other Eligibilities: " F I=0:0 S I=$O(^DIC(8,I)) Q:'I  I $D(^DIC(8,I,0)),I'=+X1 S X=$P(^(0),"^",1)_", " I $D(^DPT("AEL",DFN,I)) W:$X+$L(X)>79 !?21 W X
"RTN","DGRPD",72,0)
 I '$$OKLINE^DGRPD1(16) G Q
"RTN","DGRPD",73,0)
 ;employability status
"RTN","DGRPD",74,0)
 W !?6,"Unemployable: ",$S($P(DGRP(.3),U,5)="Y":"YES",1:"NO")
"RTN","DGRPD",75,0)
 I '$$OKLINE^DGRPD1(19) G Q
"RTN","DGRPD",76,0)
 ;display the catastrophic disability review date if there is one
"RTN","DGRPD",77,0)
 D CATDIS^DGRPD1
"RTN","DGRPD",78,0)
 I $G(DGPRFLG)=1 G Q:'$$OKLINE^DGRPD1(19) D
"RTN","DGRPD",79,0)
 . N DGPDT,DGPTM
"RTN","DGRPD",80,0)
 . W !,$$REPEAT^XLFSTR("-",78)
"RTN","DGRPD",81,0)
 . S DGPDT="",DGPDT=$O(^DGS(41.41,"ADC",DFN,DGPDT),-1)
"RTN","DGRPD",82,0)
 . W !,"[PRE-REGISTER DATE:]  "_$S(DGPDT]"":$$FMTE^XLFDT(DGPDT,"1D"),1:"NONE ON FILE")
"RTN","DGRPD",83,0)
 . S DGPTM=$$PCTEAM^DGSDUTL(DFN)
"RTN","DGRPD",84,0)
 . I $P(DGPTM,U,2)]"" W !,"[PRIMARY CARE TEAM:] "_$P(DGPTM,U,2)
"RTN","DGRPD",85,0)
 . W !,$$REPEAT^XLFSTR("-",78)
"RTN","DGRPD",86,0)
 ; Check if patient is an inpatient and on a DOM ward
"RTN","DGRPD",87,0)
 ; If inpatient is on a DOM ward, don't display MT or CP messages
"RTN","DGRPD",88,0)
 ; If inpatient is NOT on a DOM ward, don't display CP message
"RTN","DGRPD",89,0)
 N DGDOM,DGDOM1,VAHOW,VAROOT,VAINDT,VAIP,VAERR
"RTN","DGRPD",90,0)
 G Q:'$$OKLINE^DGRPD1(16)
"RTN","DGRPD",91,0)
 D DOM^DGMTR
"RTN","DGRPD",92,0)
 I '$G(DGDOM) D
"RTN","DGRPD",93,0)
 .D DIS^DGMTU(DFN)
"RTN","DGRPD",94,0)
 .D IN5^VADPT
"RTN","DGRPD",95,0)
 .I $G(VAIP(1))="" D DISP^IBARXEU(DFN,DT,3,1)
"RTN","DGRPD",96,0)
 ;I 'DGABBRV,$E(IOST,1,2)="C-" F I=$Y:1:20 W !
"RTN","DGRPD",97,0)
 D DIS^EASECU(DFN)   ;Added for LTC III (DG*5.3*518)
"RTN","DGRPD",98,0)
 S VAIP("L")=""
"RTN","DGRPD",99,0)
 I $$OKLINE^DGRPD1(14) D INP
"RTN","DGRPD",100,0)
 I '$G(DGRPOUT),($$OKLINE^DGRPD1(10)) D SA ;*KNR*
"RTN","DGRPD",101,0)
 ;MPI/PD CHANGE
"RTN","DGRPD",102,0)
Q D KVA^VADPT K %DT,D0,D1,DGA,DGA1,DGA2,DGABBRV,DGAD,DGCC,DGCMOR,DGDOM,DGLOCATN,DGMPI,DGRP,DGRPU,DGS,DGST,DGXFR0,DIC,DIR,DTOUT,DUOUT,DIRUT,DIROUT,I,I1,L,LDM,POP,SDCT,VA,X,X1,Y Q
"RTN","DGRPD",103,0)
CA ;Confidential Address
"RTN","DGRPD",104,0)
 W !!?1,"Confidential Address:  ",?44,"Confidential Address Categories:"
"RTN","DGRPD",105,0)
 N DGCABEG,DGCAEND,DGA,DGARRAY,DGERROR
"RTN","DGRPD",106,0)
 S DGCABEG=$P(DGRP(.141),U,7),DGCAEND=$P(DGRP(.141),U,8)
"RTN","DGRPD",107,0)
 I 'DGCABEG!(DGCABEG>DT)!(DGCAEND&(DGCAEND<DT)) D  Q
"RTN","DGRPD",108,0)
 .W !?9,"NO CONFIDENTIAL ADDRESS"
"RTN","DGRPD",109,0)
 .W !?1,"From/To: NOT APPLICABLE"
"RTN","DGRPD",110,0)
 S DGAD=.141,(DGA1,DGA2)=1
"RTN","DGRPD",111,0)
 D AL^DGRPU(30)
"RTN","DGRPD",112,0)
 D GETS^DIQ(2,DFN,".141*,","E","DGARRAY","DGERROR")
"RTN","DGRPD",113,0)
 ;Format Confidential Address categories
"RTN","DGRPD",114,0)
 N DGIEN,DGCAST
"RTN","DGRPD",115,0)
 S DGIEN=0
"RTN","DGRPD",116,0)
 S DGA2=2
"RTN","DGRPD",117,0)
 F  S DGIEN=$O(DGARRAY(2.141,DGIEN)) Q:'DGIEN  D
"RTN","DGRPD",118,0)
 .S DGA(DGA2)=DGARRAY(2.141,DGIEN,.01,"E")
"RTN","DGRPD",119,0)
 .S DGCAST=DGARRAY(2.141,DGIEN,1,"E")
"RTN","DGRPD",120,0)
 .S DGA(DGA2)=DGA(DGA2)_"("_$S(DGCAST="YES":"Active",1:"Inactive")_")"
"RTN","DGRPD",121,0)
 .S DGA2=DGA2+2
"RTN","DGRPD",122,0)
 S I=0 F I1=0:0 S I=$O(DGA(I)) Q:I=""  W:(I#2)!($X>43) !?9 W:'(I#2) ?44 W DGA(I)
"RTN","DGRPD",123,0)
 W !?1,"From/To:  ",$$FMTE^XLFDT(DGCABEG)_"-"_$S(DGCAEND'="":$$FMTE^XLFDT(DGCAEND),1:"UNANSWERED")
"RTN","DGRPD",124,0)
 Q
"RTN","DGRPD",125,0)
INP S VAIP("D")="L" D INP^DGPMV10
"RTN","DGRPD",126,0)
 S DGPMT=0
"RTN","DGRPD",127,0)
 D CS^DGPMV10 K DGPMT,DGPMIFN K:'$D(DGSWITCH) DGPMVI,DGPMDCD Q
"RTN","DGRPD",128,0)
SA F I=0:0 S I=$O(^DGS(41.1,"B",DFN,I)) G CL:'I S X=^DGS(41.1,I,0) I $P(X,"^",2)>(DT-1),$P(X,"^",13)']"",'$P(X,"^",17) S L=$P(X,"^",2) D:$$OKLINE^DGRPD1(17) SAA Q:$G(DGRPOUT)
"RTN","DGRPD",129,0)
 Q
"RTN","DGRPD",130,0)
SAA ;Scheduled Admit Data
"RTN","DGRPD",131,0)
 W !!?14,"Scheduled Admit"
"RTN","DGRPD",132,0)
 W:$D(^DIC(42,+$P(X,U,8),0)) " on ward "_$P(^(0),U)
"RTN","DGRPD",133,0)
 W:$D(^DIC(45.7,+$P(X,U,9),0)) " for treating specialty "_$P(^(0),U)
"RTN","DGRPD",134,0)
 W " on "_$$FMTE^XLFDT(L,"5DZ")
"RTN","DGRPD",135,0)
 Q  ;SAA
"RTN","DGRPD",136,0)
 ;
"RTN","DGRPD",137,0)
CL G FA:$O(^DPT(DFN,"DE",0))="" S SDCT=0 F I=0:0 S I=$O(^DPT(DFN,"DE",I)) Q:'I  I $D(^(I,0)),$P(^(0),"^",2)'="I",$O(^(0)) S SDCT=SDCT+1 W:SDCT=1 !!,"Currently enrolled in " W:$X>50 !?22 W $S($D(^SC(+^(0),0)):$P(^(0),"^",1)_", ",1:"")
"RTN","DGRPD",138,0)
 ;
"RTN","DGRPD",139,0)
FA ;
"RTN","DGRPD",140,0)
 N DGARRAY,SDCNT
"RTN","DGRPD",141,0)
 S DGARRAY("FLDS")="1;2;3;18",DGARRAY(4)=DFN,DGARRAY(1)=DT,DGARRAY("SORT")="P"
"RTN","DGRPD",142,0)
 S SDCNT=$$SDAPI^SDAMA301(.DGARRAY),CT=0 W !!,"Future Appointments: "
"RTN","DGRPD",143,0)
 ;if there is lower subscripts hanging from the 101 node,
"RTN","DGRPD",144,0)
 ;then it is a valid appointment, otherwise it is
"RTN","DGRPD",145,0)
 ;an error eg 01/20/2005
"RTN","DGRPD",146,0)
 ;G:'$$OKLINE^DGRPD1(13) RMK ;*///*
"RTN","DGRPD",147,0)
 I $D(^TMP($J,"SDAMA301",101))=1 W "Appointment Database is Unavailable" G RMK
"RTN","DGRPD",148,0)
 I $O(^TMP($J,"SDAMA301",DFN,DT))'>0 W "NONE" G RMK
"RTN","DGRPD",149,0)
 ;
"RTN","DGRPD",150,0)
 W ?22,"Date",?33,"Time",?39,"Clinic",!?22 F I=22:1:75 W "="
"RTN","DGRPD",151,0)
 F FA=DT:0 S FA=$O(^TMP($J,"SDAMA301",DFN,FA)) G RMK:'FA D  Q:CT>5
"RTN","DGRPD",152,0)
 .N STAT S STAT=$P($P(^TMP($J,"SDAMA301",DFN,FA),U,3),";")
"RTN","DGRPD",153,0)
 .S C=+$P(^TMP($J,"SDAMA301",DFN,FA),U,2) I STAT'["C" D
"RTN","DGRPD",154,0)
 ..D COV
"RTN","DGRPD",155,0)
 ..N DGAPPT S DGAPPT=$$FMTE^XLFDT($E(FA,1,12),"5Z")
"RTN","DGRPD",156,0)
 ..W !?22,$P(DGAPPT,"@"),?33,$P(DGAPPT,"@",2)
"RTN","DGRPD",157,0)
 ..W ?39,$P($P(^TMP($J,"SDAMA301",DFN,FA),U,2),";",2)," ",COV
"RTN","DGRPD",158,0)
 ..Q
"RTN","DGRPD",159,0)
 I $O(^TMP($J,"SDAMA301",DFN,FA))>0 W !,"See Scheduling options for additional appointments."
"RTN","DGRPD",160,0)
RMK I '$G(DGRPOUT),($$OKLINE^DGRPD1(15)) W !!,"Remarks: ",$P(^DPT(DFN,0),"^",10) ;*///*
"RTN","DGRPD",161,0)
 D GETS^DIQ(2,DFN_",",".351;.353;.354;.355","E","PDTHINFO")
"RTN","DGRPD",162,0)
 W !!
"RTN","DGRPD",163,0)
 W "Date of Death Information"
"RTN","DGRPD",164,0)
 W !,?5,"Date of Death: ",$G(PDTHINFO(2,DFN_",",.351,"E"))
"RTN","DGRPD",165,0)
 W !,?5,"Source of Notification: ",$G(PDTHINFO(2,DFN_",",.353,"E"))
"RTN","DGRPD",166,0)
 W !,?5,"Updated Date/Time: ",$G(PDTHINFO(2,DFN_",",.354,"E"))
"RTN","DGRPD",167,0)
 W !,?5,"Last Edited By: ",$G(PDTHINFO(2,DFN_",",.355,"E")),!
"RTN","DGRPD",168,0)
 I $$OKLINE^DGRPD1(14) D EC^DGRPD1
"RTN","DGRPD",169,0)
 D HBP
"RTN","DGRPD",170,0)
 K DGARRAY,SDCNT,^TMP($J,"SDAMA301"),ADM,L,TRN,DIS,SSN,FA,C,COV,NOW,CT,DGD,DGD1,I ;Y killed after dghinqky
"RTN","DGRPD",171,0)
 Q
"RTN","DGRPD",172,0)
 ; KUM DG*5.3*936 Display Health Benefit Plans assigned to Veteran
"RTN","DGRPD",173,0)
HBP W !!,"Health Benefit Plans Currently Assigned to Veteran:"
"RTN","DGRPD",174,0)
 N DGHBP,HBP,DGCOUNT
"RTN","DGRPD",175,0)
 S DGCOUNT=0
"RTN","DGRPD",176,0)
 D GETHBP^DGHBPUTL(DFN)
"RTN","DGRPD",177,0)
 S DGHBP="" F  S DGHBP=$O(HBP("CUR",DGHBP)) Q:DGHBP=""  D
"RTN","DGRPD",178,0)
 .W !,?3,DGHBP
"RTN","DGRPD",179,0)
 .S DGCOUNT=DGCOUNT+1
"RTN","DGRPD",180,0)
 I DGCOUNT=0 W !,?3,"None"
"RTN","DGRPD",181,0)
 Q
"RTN","DGRPD",182,0)
 ;
"RTN","DGRPD",183,0)
COV S COV=$S(+$P(^TMP($J,"SDAMA301",DFN,FA),U,18)=7:" (Collateral) ",1:"")
"RTN","DGRPD",184,0)
 S COV=COV_$S(STAT["NT":" * NO ACTION TAKEN *",STAT["N":" * NO-SHOW *",1:""),CT=CT+1 Q
"RTN","DGRPD",185,0)
 Q
"RTN","DGRPD",186,0)
 ;
"RTN","DGRPD",187,0)
OREN S XQORQUIT=1 Q:'$D(ORVP)  S DFN=+ORVP D EN R !!,"Press RETURN to CONTINUE: ",X:DTIME
"RTN","DGRPD",188,0)
 Q
"RTN","DGRPD",189,0)
LANGUAGE ; Get language data *///*
"RTN","DGRPD",190,0)
 S DGLANGDT=9999999,(DGPRFLAN,DGLANG0)=""
"RTN","DGRPD",191,0)
 S DGLANGDT=$O(^DPT(DFN,.207,"B",DGLANGDT),-1)
"RTN","DGRPD",192,0)
 I DGLANGDT="" G L1
"RTN","DGRPD",193,0)
 S DGLANGDA=$O(^DPT(DFN,.207,"B",DGLANGDT,0))
"RTN","DGRPD",194,0)
 S DGLANG0=$G(^DPT(DFN,.207,DGLANGDA,0)),Y=$P(DGLANG0,U),DGPRFLAN=$P(DGLANG0,U,2)
"RTN","DGRPD",195,0)
 S Y=DGLANGDT X ^DD("DD") S DGLANGDT=Y
"RTN","DGRPD",196,0)
L1 W !!,"Language Date/Time: ",$S(DGLANGDT="":"UNANSWERED",1:DGLANGDT),!
"RTN","DGRPD",197,0)
 W ?1,"Preferred Language: ",$S(DGPRFLAN="":"UNANSWERED",1:DGPRFLAN)
"RTN","DGRPD",198,0)
 K DGLANGDT,DGPRFLAN,DGLANG0,DGLANGDA
"RTN","DGRPD",199,0)
 Q
"VER")
8.0^22.2
"^DD",25.11,25.11,.05,0)
COVERAGE CODE^F^^0;3^K:$L(X)>30!($L(X)<1) X
"^DD",25.11,25.11,.05,3)
Answer must be 1-30 characters in length.
"^DD",25.11,25.11,.05,21,0)
^^1^1^3170117^
"^DD",25.11,25.11,.05,21,1,0)
This field contains the Coverage Code associated with the Health Benefit Plan.
"^DD",25.11,25.11,.05,"DT")
3170117
"BLD",9965,6)
^830
**END**
**END**

