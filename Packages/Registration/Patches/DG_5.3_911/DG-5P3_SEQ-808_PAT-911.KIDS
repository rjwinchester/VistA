Released DG*5.3*911 SEQ #808
Extracted from mail message
**KIDS**:DG*5.3*911^

**INSTALL NAME**
DG*5.3*911
"BLD",10013,0)
DG*5.3*911^REGISTRATION^0^3150821^y
"BLD",10013,1,0)
^^5^5^3150623^
"BLD",10013,1,1,0)
Patch DG*5.3*911 will address one issue:
"BLD",10013,1,2,0)
Integrated Sites working with a Patient Record Flag must first
"BLD",10013,1,3,0)
assign the flag to their "main" site and then edit the flag for
"BLD",10013,1,4,0)
other sites to be able to receive/process the incoming HL7 messages, or
"BLD",10013,1,5,0)
else the message is rejected as not coming from owning site.
"BLD",10013,4,0)
^9.64PA^^
"BLD",10013,6.3)
2
"BLD",10013,"KRN",0)
^9.67PA^779.2^20
"BLD",10013,"KRN",.4,0)
.4
"BLD",10013,"KRN",.4,"NM",0)
^9.68A^^
"BLD",10013,"KRN",.401,0)
.401
"BLD",10013,"KRN",.402,0)
.402
"BLD",10013,"KRN",.403,0)
.403
"BLD",10013,"KRN",.5,0)
.5
"BLD",10013,"KRN",.84,0)
.84
"BLD",10013,"KRN",3.6,0)
3.6
"BLD",10013,"KRN",3.8,0)
3.8
"BLD",10013,"KRN",9.2,0)
9.2
"BLD",10013,"KRN",9.8,0)
9.8
"BLD",10013,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",10013,"KRN",9.8,"NM",1,0)
DGPFAA3^^0^B36294863
"BLD",10013,"KRN",9.8,"NM","B","DGPFAA3",1)

"BLD",10013,"KRN",19,0)
19
"BLD",10013,"KRN",19.1,0)
19.1
"BLD",10013,"KRN",101,0)
101
"BLD",10013,"KRN",409.61,0)
409.61
"BLD",10013,"KRN",771,0)
771
"BLD",10013,"KRN",779.2,0)
779.2
"BLD",10013,"KRN",870,0)
870
"BLD",10013,"KRN",8989.51,0)
8989.51
"BLD",10013,"KRN",8989.52,0)
8989.52
"BLD",10013,"KRN",8994,0)
8994
"BLD",10013,"KRN","B",.4,.4)

"BLD",10013,"KRN","B",.401,.401)

"BLD",10013,"KRN","B",.402,.402)

"BLD",10013,"KRN","B",.403,.403)

"BLD",10013,"KRN","B",.5,.5)

"BLD",10013,"KRN","B",.84,.84)

"BLD",10013,"KRN","B",3.6,3.6)

"BLD",10013,"KRN","B",3.8,3.8)

"BLD",10013,"KRN","B",9.2,9.2)

"BLD",10013,"KRN","B",9.8,9.8)

"BLD",10013,"KRN","B",19,19)

"BLD",10013,"KRN","B",19.1,19.1)

"BLD",10013,"KRN","B",101,101)

"BLD",10013,"KRN","B",409.61,409.61)

"BLD",10013,"KRN","B",771,771)

"BLD",10013,"KRN","B",779.2,779.2)

"BLD",10013,"KRN","B",870,870)

"BLD",10013,"KRN","B",8989.51,8989.51)

"BLD",10013,"KRN","B",8989.52,8989.52)

"BLD",10013,"KRN","B",8994,8994)

"BLD",10013,"QDEF")
^^^^^^^^^^YES
"BLD",10013,"QUES",0)
^9.62^^
"BLD",10013,"REQB",0)
^9.611^1^1
"BLD",10013,"REQB",1,0)
DG*5.3*650^2
"BLD",10013,"REQB","B","DG*5.3*650",1)

"MBREQ")
0
"PKG",5,-1)
1^1
"PKG",5,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",5,20,0)
^9.402P^^
"PKG",5,22,0)
^9.49I^1^1
"PKG",5,22,1,0)
5.3^2930813
"PKG",5,22,1,"PAH",1,0)
911^3150821
"PKG",5,22,1,"PAH",1,1,0)
^^5^5^3150821
"PKG",5,22,1,"PAH",1,1,1,0)
Patch DG*5.3*911 will address one issue:
"PKG",5,22,1,"PAH",1,1,2,0)
Integrated Sites working with a Patient Record Flag must first
"PKG",5,22,1,"PAH",1,1,3,0)
assign the flag to their "main" site and then edit the flag for
"PKG",5,22,1,"PAH",1,1,4,0)
other sites to be able to receive/process the incoming HL7 messages, or
"PKG",5,22,1,"PAH",1,1,5,0)
else the message is rejected as not coming from owning site.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
YES
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DGPFAA3")
0^1^B36294863^B33716755
"RTN","DGPFAA3",1,0)
DGPFAA3 ;ALB/RPM - PRF ASSIGNMENT API'S CONTINUED ; 3/28/03
"RTN","DGPFAA3",2,0)
 ;;5.3;Registration;**425,650,911**;Aug 13, 1993;Build 2
"RTN","DGPFAA3",3,0)
 ;
"RTN","DGPFAA3",4,0)
 Q  ;no direct entry
"RTN","DGPFAA3",5,0)
 ;
"RTN","DGPFAA3",6,0)
NOTIFYDT(DGFLG,DGRDT) ;calculate the notification date
"RTN","DGPFAA3",7,0)
 ;
"RTN","DGPFAA3",8,0)
 ;  Input:
"RTN","DGPFAA3",9,0)
 ;    DGFLG - (required) pointer to PRF LOCAL FLAG (#26.11) file or 
"RTN","DGPFAA3",10,0)
 ;            PRF NATIONAL FLAG (#26.15) file
"RTN","DGPFAA3",11,0)
 ;    DGRDT - (required) review date in FM format
"RTN","DGPFAA3",12,0)
 ;
"RTN","DGPFAA3",13,0)
 ;  Output:
"RTN","DGPFAA3",14,0)
 ;   Function Value - notification date in FM format on success, 0 on
"RTN","DGPFAA3",15,0)
 ;                    failure.
"RTN","DGPFAA3",16,0)
 ;
"RTN","DGPFAA3",17,0)
 N DGFLGA   ;flag file data array
"RTN","DGPFAA3",18,0)
 N DGNDT    ;function value
"RTN","DGPFAA3",19,0)
 ;
"RTN","DGPFAA3",20,0)
 S DGNDT=0
"RTN","DGPFAA3",21,0)
 I $G(DGFLG)]"",+$G(DGRDT)>0 D
"RTN","DGPFAA3",22,0)
 . ;
"RTN","DGPFAA3",23,0)
 . ;Retrieve the flag data array
"RTN","DGPFAA3",24,0)
 . Q:'$$GETFLAG^DGPFUT1(DGFLG,.DGFLGA)
"RTN","DGPFAA3",25,0)
 . ;
"RTN","DGPFAA3",26,0)
 . ;must have a review frequency 
"RTN","DGPFAA3",27,0)
 . Q:(+$G(DGFLGA("REVFREQ"))=0)
"RTN","DGPFAA3",28,0)
 . ;
"RTN","DGPFAA3",29,0)
 . ;determine notification date
"RTN","DGPFAA3",30,0)
 . S DGFLGA("NOTIDAYS")=$G(DGFLGA("NOTIDAYS"),0)
"RTN","DGPFAA3",31,0)
 . S DGRDT=+$$FMTH^XLFDT(DGRDT)
"RTN","DGPFAA3",32,0)
 . S DGNDT=+$$HTFM^XLFDT(DGRDT-DGFLGA("NOTIDAYS"))
"RTN","DGPFAA3",33,0)
 ;
"RTN","DGPFAA3",34,0)
 Q DGNDT
"RTN","DGPFAA3",35,0)
 ;
"RTN","DGPFAA3",36,0)
GETRDT(DGFLG,DGADT) ;calculate the review date
"RTN","DGPFAA3",37,0)
 ;
"RTN","DGPFAA3",38,0)
 ;  Input:
"RTN","DGPFAA3",39,0)
 ;    DGFLG - (required) pointer to PRF LOCAL FLAG (#26.11) file or 
"RTN","DGPFAA3",40,0)
 ;            PRF NATIONAL FLAG (#26.15) file
"RTN","DGPFAA3",41,0)
 ;    DGADT - (required) assignment date in FM format
"RTN","DGPFAA3",42,0)
 ;
"RTN","DGPFAA3",43,0)
 ;  Output:
"RTN","DGPFAA3",44,0)
 ;   Function Value - review date in FM format on success, 0 on failure
"RTN","DGPFAA3",45,0)
 ;
"RTN","DGPFAA3",46,0)
 N DGFLGA   ;flag file data array
"RTN","DGPFAA3",47,0)
 N DGRDT  ;function value
"RTN","DGPFAA3",48,0)
 ;
"RTN","DGPFAA3",49,0)
 S DGRDT=0
"RTN","DGPFAA3",50,0)
 I $G(DGFLG)]"",+$G(DGADT)>0 D
"RTN","DGPFAA3",51,0)
 . ;
"RTN","DGPFAA3",52,0)
 . ;Retrieve the flag data array
"RTN","DGPFAA3",53,0)
 . Q:'$$GETFLAG^DGPFUT1(DGFLG,.DGFLGA)
"RTN","DGPFAA3",54,0)
 . ;
"RTN","DGPFAA3",55,0)
 . ;must have a review frequency
"RTN","DGPFAA3",56,0)
 . Q:(+$G(DGFLGA("REVFREQ"))=0)
"RTN","DGPFAA3",57,0)
 . ;
"RTN","DGPFAA3",58,0)
 . ;determine review date
"RTN","DGPFAA3",59,0)
 . S DGADT=+$$FMTH^XLFDT(DGADT)
"RTN","DGPFAA3",60,0)
 . S DGRDT=+$$HTFM^XLFDT(DGADT+DGFLGA("REVFREQ"))
"RTN","DGPFAA3",61,0)
 ;
"RTN","DGPFAA3",62,0)
 Q DGRDT
"RTN","DGPFAA3",63,0)
 ;
"RTN","DGPFAA3",64,0)
LOCK(DGAIEN) ;Lock assignment record.
"RTN","DGPFAA3",65,0)
 ;
"RTN","DGPFAA3",66,0)
 ; This function is used to prevent another process from editing a
"RTN","DGPFAA3",67,0)
 ; patient's record flag assignment.
"RTN","DGPFAA3",68,0)
 ;
"RTN","DGPFAA3",69,0)
 ;  Input:
"RTN","DGPFAA3",70,0)
 ;   DGAIEN - IEN of record in the PRF ASSIGNMENT (#26.13) file
"RTN","DGPFAA3",71,0)
 ;
"RTN","DGPFAA3",72,0)
 ; Output:
"RTN","DGPFAA3",73,0)
 ;  Function Value - Returns 1 if the lock was successful, 0 otherwise
"RTN","DGPFAA3",74,0)
 ;
"RTN","DGPFAA3",75,0)
 I $G(DGAIEN) L +^DGPF(26.13,DGAIEN):10
"RTN","DGPFAA3",76,0)
 ;
"RTN","DGPFAA3",77,0)
 Q $T
"RTN","DGPFAA3",78,0)
 ;
"RTN","DGPFAA3",79,0)
UNLOCK(DGAIEN) ;Unlock assignment record.
"RTN","DGPFAA3",80,0)
 ;
"RTN","DGPFAA3",81,0)
 ; This procedure is used to release the lock created by $$LOCK.
"RTN","DGPFAA3",82,0)
 ;
"RTN","DGPFAA3",83,0)
 ;  Input:
"RTN","DGPFAA3",84,0)
 ;   DGAIEN - IEN of record in the PRF ASSIGNMENT (#26.13) file
"RTN","DGPFAA3",85,0)
 ;
"RTN","DGPFAA3",86,0)
 ; Output: None
"RTN","DGPFAA3",87,0)
 ;
"RTN","DGPFAA3",88,0)
 I $G(DGAIEN) L -^DGPF(26.13,DGAIEN)
"RTN","DGPFAA3",89,0)
 ;
"RTN","DGPFAA3",90,0)
 Q
"RTN","DGPFAA3",91,0)
 ;
"RTN","DGPFAA3",92,0)
STOHL7(DGPFA,DGPFAH,DGEROOT) ;store a valid assignment from HL7 message
"RTN","DGPFAA3",93,0)
 ; This function files an assignment if the originating site is 
"RTN","DGPFAA3",94,0)
 ; authorized to update an existing record and if the action is valid for
"RTN","DGPFAA3",95,0)
 ; the status of an existing record. 
"RTN","DGPFAA3",96,0)
 ;
"RTN","DGPFAA3",97,0)
 ;  Input:
"RTN","DGPFAA3",98,0)
 ;    DGPFA - (required) array of assignment values to be filed (see
"RTN","DGPFAA3",99,0)
 ;            $$GETASGN^DGPFAA for valid array structure)
"RTN","DGPFAA3",100,0)
 ;   DGPFAH - (required) array of assignment history values to be filed
"RTN","DGPFAA3",101,0)
 ;            (see $$STOHIST^DGPFAAH for valid array structure)
"RTN","DGPFAA3",102,0)
 ;  DGEROOT - (optional) closed root array name (i.e. "DGERROR") for
"RTN","DGPFAA3",103,0)
 ;            error dialog returned from BLD^DIALOG. If not passed, error
"RTN","DGPFAA3",104,0)
 ;            dialog is returned in ^TMP("DIERR",$J) global.
"RTN","DGPFAA3",105,0)
 ;
"RTN","DGPFAA3",106,0)
 ;  Output:
"RTN","DGPFAA3",107,0)
 ;   Function Value - Returns 1 on success, 0 on failure
"RTN","DGPFAA3",108,0)
 ;        DGEROOT() - error output array from BLD^DIALOG
"RTN","DGPFAA3",109,0)
 ;
"RTN","DGPFAA3",110,0)
 N DGDFN
"RTN","DGPFAA3",111,0)
 N DGFLG
"RTN","DGPFAA3",112,0)
 N DGORIG
"RTN","DGPFAA3",113,0)
 N DGACT
"RTN","DGPFAA3",114,0)
 N DGMSG
"RTN","DGPFAA3",115,0)
 N DGRSLT
"RTN","DGPFAA3",116,0)
 N DIERR  ;var returned from BLD^DIALOG
"RTN","DGPFAA3",117,0)
 ;
"RTN","DGPFAA3",118,0)
 S DGDFN=+$G(DGPFA("DFN"))
"RTN","DGPFAA3",119,0)
 S DGFLG=$G(DGPFA("FLAG"))
"RTN","DGPFAA3",120,0)
 S DGORIG=+$G(DGPFA("SNDFAC"))
"RTN","DGPFAA3",121,0)
 S DGACT=+$G(DGPFAH("ACTION"))
"RTN","DGPFAA3",122,0)
 ;
"RTN","DGPFAA3",123,0)
 S DGRSLT=0
"RTN","DGPFAA3",124,0)
 ;
"RTN","DGPFAA3",125,0)
 D  ;drops out of block on failure
"RTN","DGPFAA3",126,0)
 . ;
"RTN","DGPFAA3",127,0)
 . ;check input params
"RTN","DGPFAA3",128,0)
 . I DGDFN'>0 D BLD^DIALOG(261110,,,DGEROOT,"F") Q
"RTN","DGPFAA3",129,0)
 . I DGFLG']"" D BLD^DIALOG(261111,,,DGEROOT,"F") Q
"RTN","DGPFAA3",130,0)
 . I DGORIG'>0 D BLD^DIALOG(261125,,,DGEROOT,"F") Q
"RTN","DGPFAA3",131,0)
 . I DGACT'>0 D BLD^DIALOG(261118,,,DGEROOT,"F") Q
"RTN","DGPFAA3",132,0)
 . ;
"RTN","DGPFAA3",133,0)
 . ;new assignment action
"RTN","DGPFAA3",134,0)
 . I DGACT=1,'$$ADDOK^DGPFAA2(DGDFN,DGFLG,DGEROOT) Q
"RTN","DGPFAA3",135,0)
 . ;
"RTN","DGPFAA3",136,0)
 . ;all other actions
"RTN","DGPFAA3",137,0)
 . I DGACT'=1,'$$HL7EDTOK(DGDFN,DGFLG,DGORIG,DGACT,DGEROOT) Q
"RTN","DGPFAA3",138,0)
 . ;
"RTN","DGPFAA3",139,0)
 . ;file the assignment and history
"RTN","DGPFAA3",140,0)
 . I '$$STOALL^DGPFAA(.DGPFA,.DGPFAH,.DGMSG)!($D(DGMSG)) D  Q
"RTN","DGPFAA3",141,0)
 . . D BLD^DIALOG(261120,,,DGEROOT,"F")
"RTN","DGPFAA3",142,0)
 . ;
"RTN","DGPFAA3",143,0)
 . ;success
"RTN","DGPFAA3",144,0)
 . S DGRSLT=1
"RTN","DGPFAA3",145,0)
 ;
"RTN","DGPFAA3",146,0)
 Q DGRSLT
"RTN","DGPFAA3",147,0)
 ;
"RTN","DGPFAA3",148,0)
HL7EDTOK(DGDFN,DGFLG,DGORIG,DGACT,DGEROOT) ;Is site allowed to edit assignment?
"RTN","DGPFAA3",149,0)
 ; This function acts as wrapper for $$EDTOK and $$ACTIONOK for edits
"RTN","DGPFAA3",150,0)
 ; that originate from PRF HL7 message processing.
"RTN","DGPFAA3",151,0)
 ;
"RTN","DGPFAA3",152,0)
 ;  Supported DBIA #2171:  This DBIA is used to access the KERNEL
"RTN","DGPFAA3",153,0)
 ;                         INSTITUTION (#4) file API PARENT^XUAF4.
"RTN","DGPFAA3",154,0)
 ;
"RTN","DGPFAA3",155,0)
 ;  Input:
"RTN","DGPFAA3",156,0)
 ;    DGDFN - IEN of patient in PATIENT (#2) file
"RTN","DGPFAA3",157,0)
 ;    DGFLG - IEN of patient record flag in PRF NATIONAL FLAG (#26.15)
"RTN","DGPFAA3",158,0)
 ;            file or PRF LOCAL FLAG (#26.11) file. [ex: "1;DGPF(26.15,"]
"RTN","DGPFAA3",159,0)
 ;   DGORIG - IEN of originating site in INSTITUTION (#4) file
"RTN","DGPFAA3",160,0)
 ;    DGACT - Assignment edit action in internal format
"RTN","DGPFAA3",161,0)
 ;            [1:NEW ASSIGNMENT,2:CONTINUE,3:INACTIVATE,4:REACTIVATE,5:ENTERED IN ERROR]
"RTN","DGPFAA3",162,0)
 ;  DGEROOT - (optional) closed root array name (i.e. "DGERROR") for
"RTN","DGPFAA3",163,0)
 ;            error dialog returned from BLD^DIALOG. If not passed, error
"RTN","DGPFAA3",164,0)
 ;            dialog is returned in ^TMP("DIERR",$J) global.
"RTN","DGPFAA3",165,0)
 ;
"RTN","DGPFAA3",166,0)
 ;  Output:
"RTN","DGPFAA3",167,0)
 ;   Function value - 1 if authorized, 0 if not authorized
"RTN","DGPFAA3",168,0)
 ;          DGEROOT() - error output array from BLD^DIALOG
"RTN","DGPFAA3",169,0)
 ;
"RTN","DGPFAA3",170,0)
 N DGIEN    ;pointer to PRF ASSIGNMENT (#26.13) file
"RTN","DGPFAA3",171,0)
 N DGPFA    ;assignment data array
"RTN","DGPFAA3",172,0)
 N DGFARRY  ;flag data array
"RTN","DGPFAA3",173,0)
 N DGOWNER  ;IEN of owner site in INSTITUTION (#4) file
"RTN","DGPFAA3",174,0)
 N DGRSLT   ;function value
"RTN","DGPFAA3",175,0)
 N DIERR    ;var returned from BLD^DIALOG
"RTN","DGPFAA3",176,0)
 ;
"RTN","DGPFAA3",177,0)
 ;init error output array if passed
"RTN","DGPFAA3",178,0)
 S DGEROOT=$G(DGEROOT)
"RTN","DGPFAA3",179,0)
 I DGEROOT]"" K @DGEROOT
"RTN","DGPFAA3",180,0)
 ;
"RTN","DGPFAA3",181,0)
 S DGACT=+$G(DGACT)
"RTN","DGPFAA3",182,0)
 S DGDFN=+$G(DGDFN)
"RTN","DGPFAA3",183,0)
 S DGFLG=$G(DGFLG)
"RTN","DGPFAA3",184,0)
 S DGORIG=+$G(DGORIG)
"RTN","DGPFAA3",185,0)
 S DGRSLT=0
"RTN","DGPFAA3",186,0)
 ;
"RTN","DGPFAA3",187,0)
 D  ;drops out of block on failure
"RTN","DGPFAA3",188,0)
 . ;
"RTN","DGPFAA3",189,0)
 . ;check input params
"RTN","DGPFAA3",190,0)
 . I DGDFN'>0 D BLD^DIALOG(261110,,,DGEROOT,"F") Q
"RTN","DGPFAA3",191,0)
 . I DGACT'>0 D BLD^DIALOG(261118,,,DGEROOT,"F") Q
"RTN","DGPFAA3",192,0)
 . I DGORIG'>0 D BLD^DIALOG(261125,,,DGEROOT,"F") Q
"RTN","DGPFAA3",193,0)
 . I DGFLG']"" D BLD^DIALOG(261111,,,DGEROOT,"F") Q
"RTN","DGPFAA3",194,0)
 . ;
"RTN","DGPFAA3",195,0)
 . ;retrieve existing assignment data
"RTN","DGPFAA3",196,0)
 . S DGIEN=$$FNDASGN^DGPFAA(DGDFN,DGFLG)
"RTN","DGPFAA3",197,0)
 . I '$$GETASGN^DGPFAA(DGIEN,.DGPFA) D  Q
"RTN","DGPFAA3",198,0)
 . . D BLD^DIALOG(261102,,,DGEROOT,"F")
"RTN","DGPFAA3",199,0)
 . ;
"RTN","DGPFAA3",200,0)
 . ;Patch 911, removing sending facility check, this does not allow 
"RTN","DGPFAA3",201,0)
 . ;sites to process msgs from integrated sites-BG
"RTN","DGPFAA3",202,0)
 . ;SENDING FACILITY be the OWNER or parent of the OWNER
"RTN","DGPFAA3",203,0)
 . ;S DGOWNER=+$G(DGPFA("OWNER"))
"RTN","DGPFAA3",204,0)
 . ;I DGORIG'=DGOWNER,DGORIG'=+$$PARENT^DGPFUT1(DGOWNER) D  Q
"RTN","DGPFAA3",205,0)
 . ;. D BLD^DIALOG(261116,,,DGEROOT,"F")
"RTN","DGPFAA3",206,0)
 . ;
"RTN","DGPFAA3",207,0)
 . ;quit if flag STATUS is INACTIVE
"RTN","DGPFAA3",208,0)
 . I $$GETFLAG^DGPFUT1($P($G(DGPFA("FLAG")),U),.DGFARRY)
"RTN","DGPFAA3",209,0)
 . I '+$G(DGFARRY("STAT")) D  Q
"RTN","DGPFAA3",210,0)
 . . D BLD^DIALOG(261113,,,DGEROOT,"F")
"RTN","DGPFAA3",211,0)
 . ;
"RTN","DGPFAA3",212,0)
 . ;quit if no TIU PN TITLE IEN is found for the record flag
"RTN","DGPFAA3",213,0)
 . I '+$P($G(DGFARRY("TIUTITLE")),U) D  Q
"RTN","DGPFAA3",214,0)
 . . D BLD^DIALOG(261114,,,DGEROOT,"F")
"RTN","DGPFAA3",215,0)
 . ;
"RTN","DGPFAA3",216,0)
 . ;ACTION must be valid for current assignment STATUS
"RTN","DGPFAA3",217,0)
 . Q:('$$ACTIONOK^DGPFAA2(.DGPFA,DGACT,DGEROOT))
"RTN","DGPFAA3",218,0)
 . ;
"RTN","DGPFAA3",219,0)
 . ;success
"RTN","DGPFAA3",220,0)
 . S DGRSLT=1
"RTN","DGPFAA3",221,0)
 ;
"RTN","DGPFAA3",222,0)
 Q DGRSLT
"VER")
8.0^22.0
"BLD",10013,6)
^808
**END**
**END**

