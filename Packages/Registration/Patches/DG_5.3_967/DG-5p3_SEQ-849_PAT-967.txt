$TXT Created by                  DEVCRN.DOMAIN.EXT  (KIDS) on Wednesday, 10/31/18 at 14:24
=============================================================================
Run Date: NOV 29, 2018                     Designation: DG*5.3*967
Package : DG - REGISTRATION                   Priority: Mandatory
Version : 5.3       SEQ #849                    Status: Released
                  Compliance Date: DEC 30, 2018
=============================================================================

Associated patches: (v)DG*5.3*926  <<= must be installed BEFORE `DG*5.3*967'
                    (v)DG*5.3*944  <<= must be installed BEFORE `DG*5.3*967'

Subject: MASTER VETERAN INDEX VISTA ENHANCEMENTS - MVI SENSITIVITY

Category: 
  - Routine
  - Enhancement (Mandatory)
  - Data Dictionary

Description:
============

 NOTE: Master Patient Index (MPI) 'Sensitivity' enhancements are being
       distributed in three VistA namespaces: DG, MPIF and RG.
       The only build enforced requirement is that:
         - DG*5.3*967 be installed before MPIF*1.0*68 and RG*1.0*70
       
         *** MPIF*1.0*68 and RG*1.0*70 can be installed in any order
             as there are NO dependencies between these patches.
       (Do NOT install MPIF*1.0*68 or RG*1.0*70 on legacy sites or on
        the FORUM CLAIMS system).  
  
 NOTE: Legacy sites and the FORUM CLAIMS system can install just the
       DG*5.3*967 patch. MPIF*1.0*68 and RG*1.0*70 should NOT be
       installed on legacy sites or on the FORUM CLAIMS system.  
  
 DG*5.3*926 and DG*5.3*944 are the required builds for patch DG*5.3*967.
  
 The following enhancement exported in this patch requested by the
 Healthcare Identity Management (HC IdM) business group will allow the
 Master Veteran Index (MVI) to now track a patient's sensitivity level,
 as recorded in the SECURITY LEVEL field (#2) of the DG SECURITY LOG
 File (#38.1). 
  
 Enhancement
 The following changes were incorporated to support the changes to allow
 MVI to document/monitor the changes to a patient's sensitivity level: 
     
  -  The Health Level Seven (HL7) message response builder for the Admit
     Discharge Transfer Response (ADR) A19 (Patient Query) message that
     is transmitted to the Master Veteran Index (MVI) system was
     enhanced in routines 'VAFCQRY' and 'VAFCSB' to now create an
     additional 'Observation/Result' (OBX) message segment that will
     include the patient's 'Sensitivity' level. This new OBX HL7 message
     segment will include both the internal and external values of the
     SECURITY LEVEL field (#2) contained in the DG SECURITY LOG File
     (#38.1) that is associated with the patient. 
  
         Example: OBX^^CE^SECURITY LEVEL^^1~SENSITIVE~L^^^^^^F
                                          * *********
  
     NOTE: The NEW application programming interface (API) in routine
           VAFCSB to create the new OBX HL7 message segment for the
           patient's sensitivity will also be used in the following
           routines:
            
            - MPIFA31B (Patch: MPIF*1.0*68) for building the Admit
              Discharge Transfer (ADT) A31 (Update Person) HL7 message 
            - RGADTP (Patch: RG*1.0*70) for building the ADT-A08
              (Update Patient) HL7 message
  
  -  Added a FIELD INDEX type cross-reference (X-Ref) AVAFC2 and HELP
     PROMPT to the SECURITY LEVEL field (#2) in the DG SECURITY LOG File
     (#38.1).
  
     Note: The new X-Ref above makes use of the DG FIELD MONITOR tool
           that was released in patch DG*5.3*527. This tool utilizes
           the VAFC MPIPD FIELD TRIGGER protocol, which creates an
           entry in the ADT/HL7 PIVOT (#391.71) file, as well as sets
           the VAFC variable to capture the fields that have been
           modified during an edit. This field will be included in the
           Health Level Seven (HL7) 2.4 messages generated by the
           MPI/PD applications.
           Routine VAFCTR supports this effort and was modified to
           support the addition of this file and field.
  
  -  The Post-Install routine DG967PST will perform the initial 
     "Sensitive" seeding of MVI by scanning through the DG SECURITY LOG
     File (#38.1) and triggering Admit Discharge Transfer Update Person
     (ADT A31) HL7 messages when the SECURITY LEVEL (e.g. sensitivity)
     field (#2) for the record is equal to 1. This process will be
     tasked to the background and scheduled to run after 10:00pm local
     time. A mailman-message indicating the results of the seeding will
     be generated and delivered to the individual installing this patch,
     as well as to MVI developers, upon completion.
    
 Issue:
 Developers of the Hospital Based Home Care (HBH) package reported seeing
 extraneous dashes ('-') in the ZIP+4 field (#.1112) in the PATIENT file
 (#2) which was causing data format issues for transmissions sent to
 Austin. After analysis, it was determined that during Enterprise
 Registration if an address with a Zip Code extension (eg. Zip+4) is
 returned from the Web Service call (MPI_PSIM_NEW_EXECUTE) that it was
 stuffing (4 slash '////') that returned value, bypassing the INPUT
 TRANSFORM that would have removed the dash. Therefore, routine DPTLK7 was
 updated to now store the Zip+4 in the local variable with the dash removed
 so that when the PATIENT File (#2) is updated that the correct Zip+4 value
 (eg. without dash) is stored in the ZIP+4 field (#.1112).
  
  Note: To clean-up the existing entries in the PATIENT file (#2) that
        have a dash ('-') stored in the ZIP+4 field (#.1112), an additional
        task will be created in the post-install routine DG967PST that will
        be scheduled to run after 10:00pm local time. A mailman-message
        indicating the results of this clean-up process will be generated
        and delivered to the individual installing this patch, as well as
        to MVI developers, upon completion.
      
 Patch Components
 ================
   
 Files & Fields Associated:
   
 File Name (Number)       Field Name (Number)       New/Modified/Deleted
 ------------------       -------------------       --------------------
 DG SECURITY LOG (#38.1)  SECURITY LEVEL (#2)       MODIFIED
   
 Forms Associated:
   
 Form Name             File #       New/Modified/Deleted
 ---------             ------       --------------------
 N/A
   
   
 Mail Groups Associated:
   
 Mail Group Name          New/Modified/Deleted
 ---------------          --------------------
 N/A
   
   
 Options Associated:
   
 Option Name            Type               New/Modified/Deleted
 -----------            ----               -------------------- 
 N/A
   
   
 Protocols Associated:
   
 Protocol Name       New/Modified/Deleted
 -------------       -------------------- 
 N/A
  
   
 Security Keys Associated:
   
 Security Key Name
 -----------------
 N/A
   
   
 Templates Associated:
   
 Template Name      Type      File Name (Number)  New/Modified/Deleted 
 -------------      ----      ------------------  --------------------
 N/A
   
  
 Remote Procedures Associated:
   
 Remote Procedure Name             New/Modified/Deleted
 ---------------------------       -------------------- 
 N/A
  
  
 Parameter Definitions Associated:
  
 Parameter Name                    New/Modified/Deleted
 ---------------------------       -------------------- 
 N/A 
  
  
 Additional Information:
   
 New Service Requests (NSRs)
 ----------------------------  
 N/A
   
   
 Patient Safety Issues (PSIs)
 -----------------------------
 N/A
   
   
 Defect Tracking System Ticket(s) & Overview
 -------------------------------------------
 1. INC1436133 - HBPC VISTA data transmitted from Station 757-
                 Columbus OH to HBH queue in Austin in erroneous format
 2. INC1436206 - HBPC VISTA data transmitted from Station 589A4-
                 Columbia, MO to HBH queue in Austin in erroneous format
  
 Problem:
 --------
 It was reported by the developers of the Hospital Based Home Care (HBH)
 package that extraneous dashes ('-') in the ZIP+4 field (#.1112) in the
 PATIENT file (#2) was causing data format issues for transmissions sent
 to Austin. After analysis, it was determined that during Enterprise
 Registration if an address with a Zip Code extension (eg. Zip+4) is
 returned from the Web Service call (MPI_PSIM_NEW_EXECUTE) that it was
 stuffing (4 slash '////') that returned value into the ZIP+4 field
 (#.1112), bypassing the INPUT TRANSFORM that would have removed the
 dash ('-').
   
 Resolution:
 -----------
 Routine DPTLK7 was updated to now store the returned Zip+4 in the local
 variable with the dash removed so that when the PATIENT File (#2) is
 updated the correct Zip+4 value (eg. without dash) is correctly stored
 in the ZIP+4 field (#.1112) in the PATIENT file (#2).
  
   
 Test Sites:
 ----------
 Louisville Kentucky VAMC
 Richard L. Roudebush VAMC (Indianapolis, Indiana)
  
  
 Software and Documentation Retrieval Instructions:
 ---------------------------------------------------- 
 Software being released as a host file and/or documentation describing 
 the new functionality introduced by this patch are available.
  
 The preferred method is to retrieve files from download.vista.domain.ext.
 This transmits the files from the first available server. Sites may 
 also elect to retrieve files directly from a specific server. 
  
 Sites may retrieve the software and/or documentation directly using Secure 
 File Transfer Protocol (SFTP) from the ANONYMOUS.SOFTWARE directory at 
 the following OI Field Offices:
    
 Hines:                  domain.ext    
 Salt Lake City:         domain.ext
    
 MPI/PD VistA Documentation can also be found on the VA Software 
 Documentation Library at: http://www.domain.ext/vdl/application.asp?appid=16
   
 Title                                       File Name              FTP Mode
 ---------------------------------------------------------------------------
 MPI/PD VISTA User Manual                RG_1_0_P70_UM.PDF          (binary)
 MPI/PD VISTA Programmer Manual          RG_1_0_P70_PM.PDF          (binary)
 MPI/PD VISTA Technical Manual           RG_1_0_P70_TM.PDF          (binary)
     
  
 Patch Installation:
   
  
 Pre/Post Installation Overview
 ------------------------------
 The post-installation process will task off the following processes
 to the background:
      - The initial seeding of "Sensitive" patient records to the MVI
        by triggering ADT A08 HL7 messages.
      - The clean-up of the ZIP+4 field (#.1112) in the PATIENT file
        (#2) by removing the dash ('-') if it exists.
  
 Note: These tasks will both be scheduled to run after 10:00pm local time.
       
       Separate Mailman messages will be generated to the installer
       after the seeding has completed and the ZIP+4 clean-up has
       completed. 
  
  
 Pre-Installation Instructions
 ----------------------------- 
 This patch takes less than a minute to install. This patch may be 
 installed with users on the system, but it is recommended that
 installation occur during off hours. 
  
 The following OPTIONs should be disabled during installation:
      Load/Edit Patient Data                      [DG LOAD PATIENT DATA]
      Register a Patient                          [DG REGISTER PATIENT]
      Preregister a Patient                       [DGPRE PRE-REGISTER OPTION]
      Electronic 10-10EZ Processing               [EAS EZ 1010EZ PROCESSING] 
      UPDATE BATCH JOB FOR HL7 v2.3               [VAFC BATCH UPDATE]
      MPI/PD Patient Admin Coordinator Menu       [RG ADMIN COORD MENU]
      Local/Missing ICN Resolution Background Job [MPIF LOC/MIS ICN RES]
      Enter/Edit Patient Security Level           [DG SECURITY ENTER/EDIT]
   
 The HL7 incoming filers should be stopped.  Use the Monitor, Start, Stop
 Filers [HL FILER MONITOR] option on the Filer and Link Management Options
 [HL MENU FILER LINK MGT] menu on the HL7 Main Menu [HL MAIN MENU].
     
  
 Installation Instructions
 -------------------------
 1.  Choose the PackMan message containing this patch.
   
 2.  Choose the INSTALL/CHECK MESSAGE PackMan option.  
   
 3.  From the Kernel Installation and Distribution System Menu, select
     the Installation Menu.  From this menu, you may elect to use the
     following options. When prompted for the INSTALL enter the patch 
     number (i.e. DG*5.3*967):
   
     a.  Verify Checksums in Transport Global - This option will allow
         you to ensure the integrity of the routines that are in the
         transport global.
     b.  Print Transport Global - This option will allow you to view the
         components of the KIDS build.
     c.  Compare Transport Global to Current System - This option will
         allow you to view all changes that will be made when this patch
         is installed.  It compares all components of this patch, such as
         routines, DDs, templates, etc.
     d.  Backup a Transport Global - This option will create a backup
         message of any routines exported with this patch. It will not
         backup any other changes such as DDs or templates.
       
 4.  From the Installation Menu, select the Install Package(s) option and
     choose the patch to install.
   
 5.  If prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
     Install? NO//', respond NO.
   
 6.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? NO//',
     respond NO.
   
 7.  When prompted 'Want to DISABLE Scheduled Options, Menu Options, 
     and Protocols? YES// respond YES.  The following OPTIONS should be
     disabled during the installation.
      
     a. When prompted 'Enter options you wish to mark as 'Out Of Order':',
        select the following options:
     
          Option Name                    Menu Text                       
          -----------                    ---------
          [DG LOAD PATIENT DATA]         Load/Edit Patient Data
          [DG REGISTER PATIENT]          Register a Patient 
          [DGPRE PRE-REGISTER OPTION]    Preregister a Patient
          [EAS EZ 1010EZ PROCESSING]     Electronic 10-10EZ Processing
          [VAFC BATCH UPDATE]            UPDATE BATCH JOB FOR HL7 v2.3
          [RG ADMIN COORD MENU]          MPI/PD Patient Admin Coordinator
                                          Menu
          [MPIF LOC/MIS ICN RES]         Local/Missing ICN Resolution
                                          Background Job 
          [DG SECURITY ENTER/EDIT]       Enter/Edit Patient Security Level
     
     b. When prompted 'Enter protocols you wish to mark as 'Out Of Order':
        press the Enter key.
  
     c. When prompted 'Delay Install (Minutes):  (0 - 60): 0//', respond 0.
  
  
 Post-Installation Instructions
 ------------------------------
 After patch installation has completed, restart the HL7 incoming filers.
 Use the Monitor, Start, Stop Filers [HL FILER MONITOR] option on the Filer
 and Link Management Options [HL MENU FILER LINK MGT] menu on the HL7 Main
 Menu [HL MAIN MENU]. Routine DG967PST can be deleted once the tasked
 post-installation "Sensitive" seeding process to MVI and the Patient ZIP+4 
 clean-up process for removing dashes ('-') have both completed.
  
 Back-Out Plan
 -------------
 The DG back-out procedure would consist of restoring the original
 routines using the back-up message created during the patch installation
 and removing the AVAFC2 X-Ref on the SECURITY LEVEL field (#2) in the
 DG SECURITY LOG File (#38.1) using the CROSS-REFERENCE A FIELD OR FILE
 menu option under the UTILITY FUNCTIONS menu in FileMan (FM).
    
      Note: This process should only be done with the concurrence and
            participation of the development team and the appropriate
            VA Site/Region personnel.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;5.3;Registration;**[Patch List]**;Aug 13, 1993;Build 3

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DG967PST
    Before:       n/a   After: B32284319  **967**
Routine Name: DPTLK7
    Before:B199396274   After:B199815452  **915,919,926,967**
Routine Name: VAFCQRY
    Before: B26626095   After: B27513336  **428,575,627,707,863,902,926,967**
Routine Name: VAFCSB
    Before: B45868659   After: B50707887  **707,756,825,876,902,926,967**
Routine Name: VAFCTR
    Before:  B5564926   After:  B6623304  **575,648,653,712,876,902,926,
                                           937,944,967**
 
Routine list of preceding patches: 944

=============================================================================
User Information:
Entered By  :                               Date Entered  : AUG 07, 2018
Completed By:                               Date Completed: NOV 29, 2018
Released By :                               Date Released : NOV 29, 2018
=============================================================================


Packman Mail Message:
=====================

$END TXT
