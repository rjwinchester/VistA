Released DG*5.3*898 SEQ #783
Extracted from mail message
**KIDS**:DG*5.3*898^

**INSTALL NAME**
DG*5.3*898
"BLD",9445,0)
DG*5.3*898^REGISTRATION^0^3140828^y
"BLD",9445,4,0)
^9.64PA^^
"BLD",9445,6.3)
3
"BLD",9445,"ABPKG")
n
"BLD",9445,"KRN",0)
^9.67PA^779.2^20
"BLD",9445,"KRN",.4,0)
.4
"BLD",9445,"KRN",.401,0)
.401
"BLD",9445,"KRN",.402,0)
.402
"BLD",9445,"KRN",.403,0)
.403
"BLD",9445,"KRN",.5,0)
.5
"BLD",9445,"KRN",.84,0)
.84
"BLD",9445,"KRN",3.6,0)
3.6
"BLD",9445,"KRN",3.8,0)
3.8
"BLD",9445,"KRN",9.2,0)
9.2
"BLD",9445,"KRN",9.8,0)
9.8
"BLD",9445,"KRN",9.8,"NM",0)
^9.68A^1^1
"BLD",9445,"KRN",9.8,"NM",1,0)
DGPTFM6^^0^B28907671
"BLD",9445,"KRN",9.8,"NM","B","DGPTFM6",1)

"BLD",9445,"KRN",19,0)
19
"BLD",9445,"KRN",19.1,0)
19.1
"BLD",9445,"KRN",101,0)
101
"BLD",9445,"KRN",409.61,0)
409.61
"BLD",9445,"KRN",771,0)
771
"BLD",9445,"KRN",779.2,0)
779.2
"BLD",9445,"KRN",870,0)
870
"BLD",9445,"KRN",8989.51,0)
8989.51
"BLD",9445,"KRN",8989.52,0)
8989.52
"BLD",9445,"KRN",8994,0)
8994
"BLD",9445,"KRN","B",.4,.4)

"BLD",9445,"KRN","B",.401,.401)

"BLD",9445,"KRN","B",.402,.402)

"BLD",9445,"KRN","B",.403,.403)

"BLD",9445,"KRN","B",.5,.5)

"BLD",9445,"KRN","B",.84,.84)

"BLD",9445,"KRN","B",3.6,3.6)

"BLD",9445,"KRN","B",3.8,3.8)

"BLD",9445,"KRN","B",9.2,9.2)

"BLD",9445,"KRN","B",9.8,9.8)

"BLD",9445,"KRN","B",19,19)

"BLD",9445,"KRN","B",19.1,19.1)

"BLD",9445,"KRN","B",101,101)

"BLD",9445,"KRN","B",409.61,409.61)

"BLD",9445,"KRN","B",771,771)

"BLD",9445,"KRN","B",779.2,779.2)

"BLD",9445,"KRN","B",870,870)

"BLD",9445,"KRN","B",8989.51,8989.51)

"BLD",9445,"KRN","B",8989.52,8989.52)

"BLD",9445,"KRN","B",8994,8994)

"BLD",9445,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",9445,"QUES",0)
^9.62^^
"BLD",9445,"REQB",0)
^9.611^1^1
"BLD",9445,"REQB",1,0)
DG*5.3*850^1
"BLD",9445,"REQB","B","DG*5.3*850",1)

"MBREQ")
0
"PKG",47,-1)
1^1
"PKG",47,0)
REGISTRATION^DG^PATIENT REGISTRATION, ADMISSION, DISCHARGE, EMBOSSER 
"PKG",47,20,0)
^9.402P^^
"PKG",47,22,0)
^9.49I^1^1
"PKG",47,22,1,0)
5.3^2930813^2960613
"PKG",47,22,1,"PAH",1,0)
898^3140828
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
1
"RTN","DGPTFM6")
0^1^B28907671^B27555849
"RTN","DGPTFM6",1,0)
DGPTFM6 ;ALB/BOK/ADL - 601 SCREEN: PROCEDURE ENTER/EDIT ;21 JUL 88 @ 0900
"RTN","DGPTFM6",2,0)
 ;;5.3;Registration;**164,510,729,850,898**;Aug 13, 1993;Build 3
"RTN","DGPTFM6",3,0)
 ;;ADL;Update for CSV Project;;Mar 26, 2003
"RTN","DGPTFM6",4,0)
EN ; Entry point - begin date checks
"RTN","DGPTFM6",5,0)
 I $D(^DGPTF(PTF,70)),+^(70)<2871000 W !!,"Data cannot be entered into these fields until after 10/1/1987" H 5 G ^DGPTFM
"RTN","DGPTFM6",6,0)
 I DT<2871000 W !!,"Data can not be entered into these fields until after 10/1/1987" H 5 G ^DGPTFM
"RTN","DGPTFM6",7,0)
 G @($S(X=6:"E",1:X))
"RTN","DGPTFM6",8,0)
T ;ADD PROCEDURE RECORD
"RTN","DGPTFM6",9,0)
 S DGZP=0 S:'$D(^DGPT(PTF,"P",0)) ^(0)="^45.05DA^^"
"RTN","DGPTFM6",10,0)
 S DIC="^DGPT("_PTF_",""P"",",DIC(0)="AEQLMZ",DA(1)=PTF D ^DIC G ^DGPTFM:Y'>0!('$D(^DGPT(PTF,"P",+Y))) S DGPROCM=+Y,DGPROCD=$P(Y,U,2) D MOB I DGPC F I=1:1:DGPC S:P(I,1)=DGPROCM DGZP=I
"RTN","DGPTFM6",11,0)
 G:'DGZP ^DGPTFM S DGPROC(DGZP)=DGPROCM,X="1,2"
"RTN","DGPTFM6",12,0)
EDIT ;
"RTN","DGPTFM6",13,0)
 G HELP:X<1!(X>2) S DIE="^DGPT(",(DA,DGPTF)=PTF,DR="[DG601]",DGJUMP=X
"RTN","DGPTFM6",14,0)
 S DIE="^DGPT(",DGJUMP=X D ^DIE,CHK601^DGPTSCAN K DR,DIE,DIC,DA,DGADD,DGJUMP D MOB
"RTN","DGPTFM6",15,0)
SET D MOB:'$D(P) S:'$D(DGZP) DGZP=1 S P(DGZP,1)=$S($D(P(DGZP,1)):P(DGZP,1),1:"") I P(DGZP,1)="" K P(DGZP) G NEXP
"RTN","DGPTFM6",16,0)
 S (P1,P(DGZP))=$S($D(^DGPT(PTF,"P",P(DGZP,1),0)):^(0),1:"")
"RTN","DGPTFM6",17,0)
WRT ;
"RTN","DGPTFM6",18,0)
 N EFFDATE,IMPDATE
"RTN","DGPTFM6",19,0)
 D EFFDATE^DGPTIC10(PTF)
"RTN","DGPTFM6",20,0)
 G:'$D(^DGPT(PTF,"P",P(DGZP,1),0)) ^DGPTFM S DGPROCI=^(0) W @IOF,HEAD,?68 S Z="<601-"_DGZP_">" W @DGVI,Z,@DGVO,!! S (Y,L)=+P(DGZP),Z=1 D D^DGPTUTL,Z^DGPTFM5 W $J("Date of Proc:  ",32),Y,!,$J("Specialty:  ",35)
"RTN","DGPTFM6",21,0)
 W $S($D(^DIC(42.4,+$P(P(DGZP),U,2),0)):$P(^(0),U),1:""),! I $P(P(DGZP),U,4) W "   Number of Dialysis Treatments:  ",$P(P(DGZP),U,4),!
"RTN","DGPTFM6",22,0)
 W !! S Z=2 D Z^DGPTFM5 W "  Procedures: ",$$GETLABEL^DGPTIC10(EFFDATE,"P")
"RTN","DGPTFM6",23,0)
 F I=1:1:5 S L=$P(P(DGZP),U,4+I) I L D
"RTN","DGPTFM6",24,0)
 . S DGPTTMP=$$ICDDATA^ICDXCODE("PROC",+L,EFFDATE)
"RTN","DGPTFM6",25,0)
 . D WRITECOD^DGPTIC10("PROC",+L,EFFDATE,2,1,7) W $S(+DGPTTMP<1!('$P(DGPTTMP,U,10)):"*",1:"") ;W !?7
"RTN","DGPTFM6",26,0)
 F I=1:1:(IOSL-$Y-5) W !
"RTN","DGPTFM6",27,0)
 S DGNUM=$S($D(P(DGZP+1)):601_"-"_(DGZP+1),1:"MAS") G 601^DGPTFJC:DGST
"RTN","DGPTFM6",28,0)
 W "Enter <RET> to continue, 1-2 to edit,",!,"'T' to add a Procedure Segment, '^N' for screen N, or '^' to abort: <",DGNUM,">//"
"RTN","DGPTFM6",29,0)
 R X:DTIME S:'$T X="^",DGPTOUT=""
"RTN","DGPTFM6",30,0)
 K DGNUM G Q^DGPTF:X="^"
"RTN","DGPTFM6",31,0)
 I X?1"^".E S DGPTSCRN=601 G ^DGPTFJ
"RTN","DGPTFM6",32,0)
 G T:X="T"!(X="t"),HELP:X["?"
"RTN","DGPTFM6",33,0)
 I X[1!(X[2) S DA=+P(DGZP) G EDIT
"RTN","DGPTFM6",34,0)
 I X'="" G HELP
"RTN","DGPTFM6",35,0)
NEXP ;S DGZP=DGZP+1 G ^DGPTFM:'$D(P(DGZP)),SET
"RTN","DGPTFM6",36,0)
 S DGZP=DGZP+1 I '$D(P(DGZP)) S DGZP=1 G ^DGPTFM
"RTN","DGPTFM6",37,0)
 G SET
"RTN","DGPTFM6",38,0)
HELP W !,"Enter '^' to stop display and edit of data",!,"'^N' to jump to screen #N (appears in upper right of screen as <N>)",!,"<RET> to continue on to next screen or 1-2 to edit:"
"RTN","DGPTFM6",39,0)
 W !?10,"1-Procedure information",!,?10,"2-Procedure codes",!,"You may also enter any combination of the above, separated by commas (ex:1,2)",!
"RTN","DGPTFM6",40,0)
 R !!,"Enter <RET>: ",X:DTIME G WRT
"RTN","DGPTFM6",41,0)
MOB K P,P1,P2 S (I,P2)=0 F I1=1:1 S I=$O(^DGPT(PTF,"P",I)) Q:I'>0  S P(I1)=^(I,0),P(I1,1)=I I P(I1)']"" K P(I1) S I1=I1-1
"RTN","DGPTFM6",42,0)
 S DGPC=I1-1 Q
"RTN","DGPTFM6",43,0)
BS ;CALLED FROM [DG601]
"RTN","DGPTFM6",44,0)
 S I=$O(^DGPT(PTF,"M","AM",^DGPT(PTF,"P",DA,0)-.0000001)),I=$O(^(+I,0))
"RTN","DGPTFM6",45,0)
 S DGMOVM=$S($D(^DGPT(PTF,"M",$S(I:I,1:1),0)):$P(^(0),U,2),1:"")
"RTN","DGPTFM6",46,0)
 Q
"RTN","DGPTFM6",47,0)
R ;DELETE PROCEDURE RECORD
"RTN","DGPTFM6",48,0)
 G R^DGPTFM4
"RTN","DGPTFM6",49,0)
E ;EDIT PROCEDURE RECORD
"RTN","DGPTFM6",50,0)
 G E^DGPTFM1
"RTN","DGPTFM6",51,0)
P I $D(^DGPT(PTF,70)),+^(70)<2871000 G FY86
"RTN","DGPTFM6",52,0)
 I DT<2871000 G FY86
"RTN","DGPTFM6",53,0)
 S L="" F I=1:1:DGPC S L2=1 F J=5:1:9 I L2,$P(P(I),U,J)="" S L=L_I_",",L2=0
"RTN","DGPTFM6",54,0)
 I L="" W !!,"There are no procedure records that can be added to.",*7 H 2 G ^DGPTFM
"RTN","DGPTFM6",55,0)
 S L=$E(L,1,$L(L)-1) I L=+L S DGRC=+L G P2
"RTN","DGPTFM6",56,0)
P1 I 'Z W !!,"Add to procedure record <",L,"> : " R DGRC:DTIME G ^DGPTFM:DGRC[U!(DGRC="")
"RTN","DGPTFM6",57,0)
 E  S DGRC=+$E(A,2,99)
"RTN","DGPTFM6",58,0)
P2 I +DGRC'=DGRC!(","_L_","'[(","_DGRC_",")) W !!,"Enter the procedure record number to add ICD operation codes to: ",L G P1:'Z S Z="" G P1
"RTN","DGPTFM6",59,0)
 S DP=45.05,DIE="^DGPT("_PTF_",""P"",",DA(1)=PTF,DR="" F I=5:1:9 I $P(P(DGRC),U,I)="" S DR=DR_(I-1)_";"
"RTN","DGPTFM6",60,0)
 S DR=$E(DR,1,$L(DR)-1),DA=+P(DGRC,1),DA(1)=PTF D ^DIE K DR,DIE G ^DGPTFM
"RTN","DGPTFM6",61,0)
FY86 S DR="" F J=1:1:5 I $P(PROC,U,J)="" S DR=DR_(J/100+45)_";"
"RTN","DGPTFM6",62,0)
 I DR="" W !!,"No more procedures can be added.",*7 H 2 G ^DGPTFM
"RTN","DGPTFM6",63,0)
 S DR=$E(DR,1,$L(DR)-1),DP=45,DIE="^DGPT(",DA=PTF D ^DIE K DR,DIE G ^DGPTFM
"RTN","DGPTFM6",64,0)
GETVAR ;CALLED FROM GET+1^DGPTFM
"RTN","DGPTFM6",65,0)
 S PM=I1-1,I=0 F I1=1:1 S I=$O(^DGPT(PTF,"S",I)) Q:I'>0  S S(I1)=^(I,0),S(I1,1)=I
"RTN","DGPTFM6",66,0)
 K P2 S SU=I1-1 S PROC=$S($D(^DGPT(PTF,"401P")):^("401P"),1:""),P2=0 F J1=1:1:5 S:$P(PROC,U,J1) P2=P2+1,P2(P2)=J1
"RTN","DGPTFM6",67,0)
 K P S I=0 F I1=1:1 S I=$O(^DGPT(PTF,"P",I)) Q:I'>0  S P(I1)=^(I,0),P(I1,1)=I
"RTN","DGPTFM6",68,0)
 Q
"RTN","DGPTFM6",69,0)
 ;
"RTN","DGPTFM6",70,0)
BADDT(DGPROCD) ; Check patients admit date and entered date against census DATE
"RTN","DGPTFM6",71,0)
 ; If admit date is after census date then we're done
"RTN","DGPTFM6",72,0)
 ; checks to see if Patient has been discharged or has a closed census and returns false 
"RTN","DGPTFM6",73,0)
 ; If not discharged or closed and the admit and procedure date is within census date range then return false
"RTN","DGPTFM6",74,0)
 ; If admit date and procedure date is past the date range then return true
"RTN","DGPTFM6",75,0)
 S:$G(DGADM)="" DGADM=$P(^DGPT(DA(1),0),U,2) ; DGADM gets killed at end of option
"RTN","DGPTFM6",76,0)
 I $G(DGPROCD,0)<DGADM D EN^DDIOL("Not Before Admission ") Q 1
"RTN","DGPTFM6",77,0)
 I $G(DGPROCD,0)>($S($D(^DGPT(DA(1),70)):$S(+^(70):+^(70),1:9999999),1:9999999)) D EN^DDIOL("Not After discharge") Q 1
"RTN","DGPTFM6",78,0)
 I (DGADM>DGPTDAT) Q 0 ; Admit date is after census date
"RTN","DGPTFM6",79,0)
 I ($G(DGADM,$P(^DGPT(PTF,0),U,2))>DGPTDAT) Q 0 ; Admit date is after census date
"RTN","DGPTFM6",80,0)
 K DGI N DG601DT
"RTN","DGPTFM6",81,0)
 F DGI=0:0 S DGI=$O(^DGPT("ACENSUS",PTF,DGI)) Q:'DGI  I $D(^DGPT(DGI,0)),$P(^(0),U,12)=PTF,$D(^DG(45.86,+$P(^(0),U,13),0)) S Y=+^(0) X ^DD("DD") S DGI(DGI)=Y
"RTN","DGPTFM6",82,0)
 Q:($D(DGI)>1) 0 ;Closed Census
"RTN","DGPTFM6",83,0)
 I $D(^DGPT(PTF,70)),$P($G(^(70)),U)'="" Q 0 ; Patient has been discharged
"RTN","DGPTFM6",84,0)
 S DG601DT=$S($G(DGPROCD):DGPROCD,1:$G(EFFDATE))
"RTN","DGPTFM6",85,0)
 Q:(DGADM<(DGPTDAT+.09))&(DG601DT<(DGPTDAT+.09)) 0 ;Admit and procedure Date in Census Range
"RTN","DGPTFM6",86,0)
 D EN^DDIOL("Not After Census Date") Q 1 ; Reject date
"VER")
8.0^22.0
"BLD",9445,6)
^783
**END**
**END**

