$TXT Created by                  DEVCRN.DOMAIN.EXT  (KIDS) on Friday, 08/04/17 at 11:30
=============================================================================
Run Date: NOV 02, 2017                     Designation: DG*5.3*944
Package : DG - REGISTRATION                   Priority: Mandatory
Version : 5.3       SEQ #828                    Status: Released
                  Compliance Date: NOV 16, 2017
=============================================================================

Associated patches: (v)DG*5.3*754  <<= must be installed BEFORE `DG*5.3*944'
                    (v)DG*5.3*876  <<= must be installed BEFORE `DG*5.3*944'
                    (v)DG*5.3*937  <<= must be installed BEFORE `DG*5.3*944'
                    (v)DG*5.3*939  <<= must be installed BEFORE `DG*5.3*944'

Subject: MASTER VETERAN INDEX VISTA ENHANCEMENTS - POB COUNTRY/PROVINCE

Category: 
  - Enhancement (Mandatory)
  - Data Dictionary
  - Routine
  - PATCH FOR A PATCH
  - Other

Description:
============

 NOTE: Master Patient Index (MPI) enhancements are being distributed in
       two VistA namespaces: DG and MPIF.
       Patches DG*5.3*944 and MPIF*1.0*65 can be installed in any order
       as there are NO dependencies between these patches. 
  
 NOTE: Legacy sites can install just the DG*5.3*944 patch. MPIF*1.0*65
       should NOT be installed on legacy sites. 
  
 DG*5.3*754, DG*5.3*876, DG*5.3*937 and DG*5.3*939 are the required builds
 for patch DG*5.3*944.
  
 Enhancements
 The following enhancements exported in this patch will allow the Master
 Veteran Index (MVI) to support the new PLACE OF BIRTH COUNTRY (#.0931)
 and PLACE OF BIRTH PROVINCE (#.0932) fields in the PATIENT (#2) file,
 as well as address a couple of defect issues. 
  
 Enhancement #1
 The following Data Dictionary changes have been made to the PATIENT (#2)
 file:
   
   - Enabled auditing on the PLACE OF BIRTH [CITY] (#.092) and PLACE OF
     BIRTH [STATE] (#.093) fields.
   - Added a new field PLACE OF BIRTH COUNTRY (#.0931), which is a
     pointer field to the COUNTRY CODE (#779.004) file that identifies
     the country where the patient was born in.  
     NOTE: This field is NOT required, but will be audited for changes.
   - Added a FIELD INDEX type cross-reference (X-Ref) AVAFC0931 to the
     PLACE OF BIRTH COUNTRY(#.0931) field.
   - Added a new field PLACE OF BIRTH PROVINCE(#.0932), which is a
     free text field that allows the user to enter a province (1-20
     characters) which will identify the location within certain countries
     containing additional divisions for where the patient was born.  
     NOTE: This field is NOT required, but will be audited for changes.
   - Added a FIELD INDEX type X-Ref AVAFC0932 to the PLACE OF BIRTH
     PROVINCE(#.0932) field.
   
 Note:  The new cross-references above make use of the DG FIELD MONITOR 
        tool that was released in patch DG*5.3*527. This tool utilizes
        the VAFC MPIPD FIELD TRIGGER protocol, which creates an entry
        in the ADT/HL7 PIVOT (#391.71) file, as well as sets the VAFCF
        variable to capture the fields that have been modified during
        an edit. This field will be included in the Health Level Seven
        (HL7) 2.4 messages generated by the MPI/PD applications. 
        Routine VAFCTR supports this effort and was modified to support
        these two new fields.  
  
   - Modified the SUPPORTING DOCUMENT TYPE (#.357) field to add a Data
     Dictionary (DD) screen to limit the users selection by ensuring that
     only valid/active Supporting Document Types are shown based on the
     current business rules defined in the new SOURCE OF NOTIFICATION
     BUSINESS RULES (#47.761) file. 
     (See Enhancement #5 below for additional details on this file.)
   
 Enhancement #2
 The Patient Identification (PID) Health Level Seven (HL7) segment
 generator in routine VAFCQRY3 was updated to include the PLACE OF BIRTH
 COUNTRY (#.0931) and PLACE OF BIRTH PROVINCE (#.0932) field in the PATIENT
 (#2) file if they are populated. The PLACE OF BIRTH COUNTRY (#.0931) and
 PLACE OF BIRTH PROVINCE (#.0932) values will be placed in the repeatable
 'Patient Address' element when transmitting HL7 messages with patient
 information to the MPI.
  
 Enhancement #3
 Routine VAFCPDT2 associated with the Patient MPI/PD Data Inquiry
 [RG EXCEPTION TF INQUIRY] menu option was modified to make the PLACE OF
 BIRTH COUNTRY (#.0931) and PLACE OF BIRTH PROVINCE (#.0932) from the
 PATIENT (#2) file viewable along with the other patient identity
 information upon execution if it exists.
  
 Enhancement #4
 The Healthcare Identity Management (HC IdM) team has requested that
 'Department of Defense' be added as a new entry to the SOURCE OF 
 NOTIFICATIONS file (#47.76). As part of the POST-INSTALL process,
 the following new entry will be added to the SOURCE OF NOTIFICATIONS
 file (#47.76):
  
          SOURCE OF NOTIFICATION (Field #.01): Department of Defense
               NOTIFICATION CODE (Field #1)  : 14
                         ACTIVE? (Field #2)  : 1
  
 Enhancement #5
 The following Data Dictionary addition has been made to support a
 more dynamic implementation of the business rule for determining the
 SUPPORTING DOCUMENTATION TYPES (#47.75) and SOURCE OF NOTIFICATIONS
 (#47.76) combinations that are allowed to exist between these two
 files. This new file will be primarily used when executing the Death
 Entry [DG DEATH ENTRY] menu option, to validate the SOURCE OF
 NOTIFICATION (#2..353) and SUPPORTING DOCUMENT TYPE (#2..357)
 combination selected when entering a patient's death.      
  
   - Added the new SOURCE OF NOTIFICATION BUSINESS RULES (#47.761)
     file that will identify the allowable SUPPORTING DOCUMENTATION
     TYPES (#47.75) and SOURCE OF NOTIFICATIONS (#47.76) combinations
     that can be used when entering a patient's death using the
     Death Entry [DG DEATH ENTRY] menu option.
  
 Note: The post-install routine DG944PST will do the initial seeding
       of this file with all the currently allowable combinations of
       SOURCE OF NOTIFICATIONS (#47.76) and SUPPORTING DOCUMENTATION
       TYPES (#47.75), including those for the Electronic Verification
       of Vital Events (EVVE).
 Note: Future combination additions/changes (including inactivation) will
       be performed remotely through the Remote Procedure Call (RPC)
       [DG DEATH SOURCE/DOC UPDATE] by the MPI and will be distributed
       out to all the sites as needed, which will allow for an immediate
       (dynamic) update in the application of this business rule.
  
 Enhancement #6
 Currently when a patient is created through the Veterans Online Access
 (VOA) process the following fields in the PATIENT (#2) file are NOT
 being populated:
  
       - FULL ICN (#991.1)
       - WHO ENTERED PATIENT (#.096)
       - DATE ENTERED INTO FILE (#.097) 
  
 Routine VAFCPTAD was modified so that when a patient is created through
 the VOA process, that these fields noted above will now be populated
 when the record is added to the PATIENT (#2) file.
   
 Note: The post-install routine DG944PST will perform a clean-up of any
       incomplete VOA records by populating the FULL ICN (#991.1) field
       values in the PATIENT (#2) file. An email will be generated to the
       installer and to MVI developers (Only for production systems)
       indicating the process start/completion date/times, number of
       patient records processed for the site and the total number of
       patient records entries updated.
   
 Issue #1
 The VOA process had previously allowed names to be entered into the
 PATIENT (#2) file that were of mixed case, which has subsequently been
 addressed. The Healthcare Identity Management (HC IdM) business office
 has now requested a cleanup of the NAME (#.01) field in the PATIENT (#2)
 file that will be executed during the post-initialization process in
 routine DG944PST. The cleanup process will convert all non-uppercase
 letters to uppercase, ignoring names that have been previously merged
 that may contain "MERGING", or have a "-9" subscript [Ie. ^DPT(DFN, -9)].
 Emails will be generated to the installer and to MVI developers (Only for
 production systems) indicating the process start/completion date/times,
 number of patient records processed for the site and the total number of
 patient records entries updated. 
  
 NOTE: 'Name Change' bulletins for each patient name that is converted to
       uppercase will be transmitted to site personnel who are designated
       to receive them. Depending on how many names are converted, there
       is a potential for a large number of 'Name Change' bulletins to be
       generated.
  
 Issue #2
 The following issues with routine DGDEATH after Patch DG*5.3*939 was
 installed at sites have been addressed:
  
  - Corrected errant kill of global-reference ^DIR("A") instead of DIR("A")
  - Restored FileMan (FM) read calls to allow the EXECUTABLE HELP text to
    display content correctly when a '?', '??' or an invalid Supporting
    Documentation Type entry is entered when executing the Death Entry
    [DG DEATH ENTRY] menu option.
  
 Patch Components
 ================
   
 Files & Fields Associated:
   
 File Name (Number)       Field Name (Number)       New/Modified/Deleted
 ------------------       -------------------       --------------------
 PATIENT (#2)             PLACE OF BIRTH [CITY]     MODIFIED (Post-Init)
                           (#.092)
                          PLACE OF BIRTH [STATE]    MODIFIED (Post-Init)
                           (#.093)
                          PLACE OF BIRTH COUNTRY    NEW
                           (#.0931)
                          PLACE OF BIRTH PROVINCE   NEW
                           (#.0932)
                          SUPPORTING DOCUMENT TYPE  MODIFIED
                           (#.357)
 SOURCE OF NOTIFICATION BUSINESS RULES (#47.761)    NEW File
   
 Forms Associated:
   
 Form Name             File #       New/Modified/Deleted
 ---------             ------       --------------------
 N/A
   
   
 Mail Groups Associated:
   
 Mail Group Name          New/Modified/Deleted
 ---------------          --------------------
 N/A
   
   
 Options Associated:
   
 Option Name            Type               New/Modified/Deleted
 -----------            ----               -------------------- 
 N/A
   
   
 Protocols Associated:
   
 Protocol Name       New/Modified/Deleted
 -------------       -------------------- 
 N/A
  
   
 Security Keys Associated:
   
 Security Key Name
 -----------------
 N/A
   
   
 Templates Associated:
   
 Template Name      Type      File Name (Number)  New/Modified/Deleted 
 -------------      ----      ------------------  --------------------
 N/A
   
  
 Remote Procedures Associated:
   
 Remote Procedure Name             New/Modified/Deleted
 ---------------------------       -------------------- 
 DG DEATH SOURCE/DOC UPDATE        NEW
  
  
 Parameter Definitions Associated:
  
 Parameter Name                    New/Modified/Deleted
 ---------------------------       -------------------- 
 N/A 
  
  
 Additional Information:
   
 New Service Requests (NSRs)
 ----------------------------  
 N/A
   
   
 Patient Safety Issues (PSIs)
 -----------------------------
 N/A
   
   
 Defect Tracking System Ticket(s) & Overview
 -------------------------------------------
 1. I14487659FY17 - Incorrect KILL found in Medical Administration
                    Service (MAS) routine DGDEATH during patch review.
  
 Problem:
 --------
 During review of patch DG*5.3*939, as part of the Initial Operating
 Capabilities (IOC) tasks, an incorrect kill at line CONT+4 in routine
 DGDEATH was discovered. Variable DIR("A") is referenced and used, but
 the global-reference ^DIR("A") is inadvertently killed instead of
 DIR("A").
   
 Resolution:
 -----------
 Routine DGDEATH was modified at CONT+4 to kill the appropriate variable
 DIR("A") instead of the global-reference ^DIR("A").  
   
 2. R15278374FY17 - VistA Patch DG*5.3*939 removed existing supporting
                    documentation Help Text...
  
 Problem:
 --------
 Patch DG*5.3*939 inadvertently caused the EXECUTABLE HELP on the 
 SUPPORTING DOCUMENT TYPE (Field #.357) in the PATIENT (#2) file to stop 
 functioning properly when the FileMan (FM) calls in routine DGDEATH were
 updated to restrict the displaying of SUPPORTING DOCUMENTATION TYPES
 (File #47.75) when using the Death Entry [DG DEATH ENTRY] menu option.
    
 Resolution:
 -----------
 The FM calls in routine DGDEATH were restored to allow the EXECUTABLE HELP
 to function properly when a '?', '??' or invalid Supporting Documentation
 Type entry is entered. A Data Dictionary (DD) screen was added to the
 SUPPORTING DOCUMENTATION TYPE (#.357) field in the PATIENT (#2) file to
 limit the users selection to only allowed Supporting Documentation Types.
   
  
 Test Sites:
 ----------
 Central Alabama HCS
 Durham (NC) VAMC
    
  
 Software and Documentation Retrieval Instructions:
 ---------------------------------------------------- 
 Software being released as a host file and/or documentation describing 
 the new functionality introduced by this patch are available.
  
 The preferred method is to retrieve files from download.vista.domain.ext.
 This transmits the files from the first available server. Sites may 
 also elect to retrieve files directly from a specific server. 
  
 Sites may retrieve the software and/or documentation directly using Secure 
 File Transfer Protocol (SFTP) from the ANONYMOUS.SOFTWARE directory at 
 the following OI Field Offices:
    
 Hines:                  domain.ext    
 Salt Lake City:         domain.ext
    
 PIMS ADT Documentation can also be found on the VA Software Documentation
 Library at: http://www4.domain.ext/vdl/application.asp?appid=55
   
 Title                                       File Name              FTP Mode
 ---------------------------------------------------------------------------
 PIMS ADT User Manual - Registration Menu    DG_5_3_P944_REG_UM.PDF (binary)
    
 MPI/PD VistA Documentation can also be found on the VA Software 
 Documentation Library at: http://www.domain.ext/vdl/application.asp?appid=16
   
 Title                                       File Name              FTP Mode
 ---------------------------------------------------------------------------
 MPI/PD VISTA User Manual                DG_5_3_P944_UM.PDF         (binary)
 MPI/PD VISTA Programmer Manual          DG_5_3_P944_PM.PDF         (binary)
 MPI/PD VISTA Technical Manual           DG_5_3_P944_TM.PDF         (binary)
    
   
 Patch Installation:
   
  
 Pre/Post Installation Overview
 ------------------------------
 The post-installation process will accomplish the following items:
  
  - Turn on Auditing of the PLACE OF BIRTH [CITY] (#.092) and the PLACE OF
    BIRTH [STATE] (#.093) fields in the PATIENT (#2) file if not currently
    enabled.
  - Add 'Department of 'Defense' with a NOTIFICATION CODE (#1) value of 14
    as an active entry to the SOURCE OF NOTIFICATIONS file (#47.76) if it
    does not already exist.
  - Seed the new SOURCE OF NOTIFICATION BUSINESS RULES (#47.761) file with
    the valid Source of Notifications and Document Type combinations
    allowed.
     Note: Seeding will only occur if there are no entries in the file,
           this is to prevent overwriting changes that might have been
           broadcasted from the Master Patient Index.
  - Loop through the PATIENT (#2) file global (^DPT) to ensure that all NAMEs
    (#.01) are stored as uppercase and that each patient record contains a
    FULL ICN (#991.1) value if it contains an INTEGRATION CONTROL NUMBER
    (#991.01) and ICN CHECKSUM (#991.02). This process will automatically be
    tasked to run in the background and will generate a Mailman message to
    the installer displaying the results upon completion. Execution time for
    this process may take several hours to complete and will ultimately vary
    depending on the number of records stored in the site's PATIENT (#2)
    file.   
   
  
 Pre-Installation Instructions
 ----------------------------- 
 This patch takes less than 2 minutes to install.  This patch may be 
 installed with users on the system.   
  
 The following OPTIONs should be disabled during installation:
      Load/Edit Patient Data                      [DG LOAD PATIENT DATA]
      Register a Patient                          [DG REGISTER PATIENT]
      Preregister a Patient                       [DGPRE PRE-REGISTER OPTION]
      Electronic 10-10EZ Processing               [EAS EZ 1010EZ PROCESSING] 
      UPDATE BATCH JOB FOR HL7 v2.3               [VAFC BATCH UPDATE]
      MPI/PD Patient Admin Coordinator Menu       [RG ADMIN COORD MENU]
      Local/Missing ICN Resolution Background Job [MPIF LOC/MIS ICN RES]
  
 The HL7 incoming filers should be stopped.  Use the Monitor, Start, Stop
 Filers [HL FILER MONITOR] option on the Filer and Link Management Options
 [HL MENU FILER LINK MGT] menu on the HL7 Main Menu [HL MAIN MENU].
   
  
 Installation Instructions
 -------------------------
 1.  Choose the PackMan message containing this patch.
   
 2.  Choose the INSTALL/CHECK MESSAGE PackMan option.  
   
 3.  From the Kernel Installation and Distribution System Menu, select
     the Installation Menu.  From this menu, you may elect to use the
     following options. When prompted for the INSTALL enter the patch 
     number (i.e. DG*5.3*944):
   
     a.  Verify Checksums in Transport Global - This option will allow
         you to ensure the integrity of the routines that are in the
         transport global.
     b.  Print Transport Global - This option will allow you to view the
         components of the KIDS build.
     c.  Compare Transport Global to Current System - This option will
         allow you to view all changes that will be made when this patch
         is installed.  It compares all components of this patch, such as
         routines, DDs, templates, etc.
     d.  Backup a Transport Global - This option will create a backup
         message of any routines exported with this patch. It will not
         backup any other changes such as DDs or templates.
       
 4.  From the Installation Menu, select the Install Package(s) option and
     choose the patch to install.
   
 5.  If prompted 'Want KIDS to Rebuild Menu Trees Upon Completion of
     Install? NO//', respond NO.
   
 6.  When prompted 'Want KIDS to INHIBIT LOGONs during the install? NO//',
     respond NO.
   
 7.  When prompted 'Want to DISABLE Scheduled Options, Menu Options, 
     and Protocols? YES// respond YES.  The following OPTIONS should be
     disabled during the installation.
      
     a. When prompted 'Enter options you wish to mark as 'Out Of Order':',
        select the following options:
     
          Option Name                    Menu Text                       
          -----------                    ---------
          [DG LOAD PATIENT DATA]         Load/Edit Patient Data
          [DG REGISTER PATIENT]          Register a Patient 
          [DGPRE PRE-REGISTER OPTION]    Preregister a Patient
          [EAS EZ 1010EZ PROCESSING]     Electronic 10-10EZ Processing
          [VAFC BATCH UPDATE]            UPDATE BATCH JOB FOR HL7 v2.3
          [RG ADMIN COORD MENU]          MPI/PD Patient Admin Coordinator
                                          Menu
          [MPIF LOC/MIS ICN RES]         Local/Missing ICN Resolution
                                          Background Job 
     
     b. When prompted 'Enter protocols you wish to mark as 'Out Of Order':
        press the Enter key.
  
     c. When prompted 'Delay Install (Minutes):  (0 - 60): 0//', respond 0.
  
  
 Post-Installation Instructions
 ------------------------------
 After patch installation has completed, restart the HL7 incoming filers.
 Use the Monitor, Start, Stop Filers [HL FILER MONITOR] option on the Filer
 and Link Management Options [HL MENU FILER LINK MGT] menu on the HL7 Main
 Menu [HL MAIN MENU]. Routine DG944PST can be deleted once the tasked
 post-installation PATIENT NAME update process has completed.

Routine Information:
====================
The second line of each of these routines now looks like:
 ;;5.3;Registration;**[Patch List]**;Aug 13, 1993;Build 2

The checksums below are new checksums, and
 can be checked with CHECK1^XTSUMBLD.

Routine Name: DG944PST
    Before:       n/a   After: B47916202  **944**
Routine Name: DGDEATH
    Before: B60550348   After: B63218481  **45,84,101,149,392,545,595,
                                           568,563,725,772,863,901,926,
                                           939,944**
Routine Name: DGDTHBR
    Before:       n/a   After:  B4998998  **944**
Routine Name: VAFCPDT2
    Before: B28878305   After: B31881197  **414,505,627,697,797,876,937,944**
Routine Name: VAFCPTAD
    Before: B69026178   After: B70394677  **149,800,876,944**
Routine Name: VAFCQRY3
    Before: B59042687   After: B63911334  **575,707,754,944**
Routine Name: VAFCTR
    Before:  B5086343   After:  B5564926  **575,648,653,712,876,902,926,
                                           937,944**
 
Routine list of preceding patches: 754, 937, 939

=============================================================================
User Information:
Entered By  :                               Date Entered  : APR 13, 2017
Completed By:                               Date Completed: OCT 30, 2017
Released By :                               Date Released : NOV 02, 2017
=============================================================================


Packman Mail Message:
=====================

$END TXT
