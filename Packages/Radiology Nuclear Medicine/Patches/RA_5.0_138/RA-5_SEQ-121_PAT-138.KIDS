Released RA*5*138 SEQ #121
Extracted from mail message
**KIDS**:RA*5.0*138^

**INSTALL NAME**
RA*5.0*138
"BLD",10142,0)
RA*5.0*138^RADIOLOGY/NUCLEAR MEDICINE^0^3170509^y
"BLD",10142,1,0)
^^3^3^3170505^
"BLD",10142,1,1,0)
Patch RA*5.0*138 corrects defects introduced by patch RA*5.0*127.
"BLD",10142,1,2,0)
 
"BLD",10142,1,3,0)
Please see FORUM for full patch description and installation instructions.
"BLD",10142,4,0)
^9.64PA^71.11^1
"BLD",10142,4,71.11,0)
71.11
"BLD",10142,4,71.11,2,0)
^9.641^71.1105^2
"BLD",10142,4,71.11,2,71.11,0)
NEW RAD PROCEDURE WORKUP  (File-top level)
"BLD",10142,4,71.11,2,71.11,1,0)
^9.6411^^
"BLD",10142,4,71.11,2,71.1105,0)
DESCENDENTS  (sub-file)
"BLD",10142,4,71.11,2,71.1105,1,0)
^9.6411^.01^1
"BLD",10142,4,71.11,2,71.1105,1,.01,0)
DESCENDENTS
"BLD",10142,4,71.11,222)
y^y^p^^^^n^^n
"BLD",10142,4,71.11,224)

"BLD",10142,4,"APDD",71.11,71.11)

"BLD",10142,4,"APDD",71.11,71.1105)

"BLD",10142,4,"APDD",71.11,71.1105,.01)

"BLD",10142,4,"B",71.11,71.11)

"BLD",10142,6.3)
22
"BLD",10142,"KRN",0)
^9.67PA^779.2^20
"BLD",10142,"KRN",.4,0)
.4
"BLD",10142,"KRN",.401,0)
.401
"BLD",10142,"KRN",.402,0)
.402
"BLD",10142,"KRN",.402,"NM",0)
^9.68A^2^2
"BLD",10142,"KRN",.402,"NM",1,0)
RA PROCEDURE EDIT    FILE #71^71^0
"BLD",10142,"KRN",.402,"NM",2,0)
NEW RAD PROCEDURE    FILE #71.11^71.11^0
"BLD",10142,"KRN",.402,"NM","B","NEW RAD PROCEDURE    FILE #71.11",2)

"BLD",10142,"KRN",.402,"NM","B","RA PROCEDURE EDIT    FILE #71",1)

"BLD",10142,"KRN",.403,0)
.403
"BLD",10142,"KRN",.5,0)
.5
"BLD",10142,"KRN",.84,0)
.84
"BLD",10142,"KRN",3.6,0)
3.6
"BLD",10142,"KRN",3.8,0)
3.8
"BLD",10142,"KRN",9.2,0)
9.2
"BLD",10142,"KRN",9.8,0)
9.8
"BLD",10142,"KRN",9.8,"NM",0)
^9.68A^9^9
"BLD",10142,"KRN",9.8,"NM",1,0)
RANPRO^^0^B121872781
"BLD",10142,"KRN",9.8,"NM",2,0)
RAMAIN2^^0^B63318644
"BLD",10142,"KRN",9.8,"NM",3,0)
RAMAIN4^^0^B31310933
"BLD",10142,"KRN",9.8,"NM",4,0)
RANPRO1^^0^B1214199
"BLD",10142,"KRN",9.8,"NM",5,0)
RAMAIN5^^0^B36683496
"BLD",10142,"KRN",9.8,"NM",6,0)
RANPRO5^^0^B39057526
"BLD",10142,"KRN",9.8,"NM",7,0)
RANPRO4^^0^B38438908
"BLD",10142,"KRN",9.8,"NM",8,0)
RAPSAPI2^^0^B44028189
"BLD",10142,"KRN",9.8,"NM",9,0)
RAXMLSND^^0^B53343651
"BLD",10142,"KRN",9.8,"NM","B","RAMAIN2",2)

"BLD",10142,"KRN",9.8,"NM","B","RAMAIN4",3)

"BLD",10142,"KRN",9.8,"NM","B","RAMAIN5",5)

"BLD",10142,"KRN",9.8,"NM","B","RANPRO",1)

"BLD",10142,"KRN",9.8,"NM","B","RANPRO1",4)

"BLD",10142,"KRN",9.8,"NM","B","RANPRO4",7)

"BLD",10142,"KRN",9.8,"NM","B","RANPRO5",6)

"BLD",10142,"KRN",9.8,"NM","B","RAPSAPI2",8)

"BLD",10142,"KRN",9.8,"NM","B","RAXMLSND",9)

"BLD",10142,"KRN",19,0)
19
"BLD",10142,"KRN",19.1,0)
19.1
"BLD",10142,"KRN",101,0)
101
"BLD",10142,"KRN",409.61,0)
409.61
"BLD",10142,"KRN",771,0)
771
"BLD",10142,"KRN",779.2,0)
779.2
"BLD",10142,"KRN",870,0)
870
"BLD",10142,"KRN",8989.51,0)
8989.51
"BLD",10142,"KRN",8989.52,0)
8989.52
"BLD",10142,"KRN",8994,0)
8994
"BLD",10142,"KRN","B",.4,.4)

"BLD",10142,"KRN","B",.401,.401)

"BLD",10142,"KRN","B",.402,.402)

"BLD",10142,"KRN","B",.403,.403)

"BLD",10142,"KRN","B",.5,.5)

"BLD",10142,"KRN","B",.84,.84)

"BLD",10142,"KRN","B",3.6,3.6)

"BLD",10142,"KRN","B",3.8,3.8)

"BLD",10142,"KRN","B",9.2,9.2)

"BLD",10142,"KRN","B",9.8,9.8)

"BLD",10142,"KRN","B",19,19)

"BLD",10142,"KRN","B",19.1,19.1)

"BLD",10142,"KRN","B",101,101)

"BLD",10142,"KRN","B",409.61,409.61)

"BLD",10142,"KRN","B",771,771)

"BLD",10142,"KRN","B",779.2,779.2)

"BLD",10142,"KRN","B",870,870)

"BLD",10142,"KRN","B",8989.51,8989.51)

"BLD",10142,"KRN","B",8989.52,8989.52)

"BLD",10142,"KRN","B",8994,8994)

"BLD",10142,"QUES",0)
^9.62^^
"BLD",10142,"REQB",0)
^9.611^1^1
"BLD",10142,"REQB",1,0)
RA*5.0*127^1
"BLD",10142,"REQB","B","RA*5.0*127",1)

"FIA",71.11)
NEW RAD PROCEDURE WORKUP
"FIA",71.11,0)
^RAMRPF(71.11,
"FIA",71.11,0,0)
71.11
"FIA",71.11,0,1)
y^y^f^^^^n^^n
"FIA",71.11,0,10)

"FIA",71.11,0,11)

"FIA",71.11,0,"RLRO")

"FIA",71.11,0,"VR")
5.0^RA
"FIA",71.11,71.11)
0
"FIA",71.11,71.1102)
0
"FIA",71.11,71.1103)
0
"FIA",71.11,71.1105)
0
"FIA",71.11,71.1105,.01)

"FIA",71.11,71.1108)
0
"FIA",71.11,71.111)
0
"FIA",71.11,71.11125)
0
"FIA",71.11,71.11135)
0
"FIA",71.11,71.1155)
0
"FIA",71.11,71.11731)
0
"FIA",71.11,71.12)
0
"FIA",71.11,71.13)
0
"KRN",.402,777,-1)
0^1
"KRN",.402,777,0)
RA PROCEDURE EDIT^3170405.1111^^71^^^3170509
"KRN",.402,777,"DIAB",1,1,71.01,0)
ALL
"KRN",.402,777,"DIAB",1,1,71.0125,0)
ALL
"KRN",.402,777,"DIAB",1,1,71.0135,0)
ALL
"KRN",.402,777,"DIAB",1,1,71.04,0)
ALL
"KRN",.402,777,"DIAB",1,1,71.0731,0)
ALL
"KRN",.402,777,"DIAB",3,1,71.08,0)
LOW ADULT DOSE;T
"KRN",.402,777,"DIAB",5,1,71.08,0)
HIGH ADULT DOSE;T
"KRN",.402,777,"DIAB",8,1,71.08,0)
USUAL DOSE;T
"KRN",.402,777,"DIAB",9,0,71,11)
DISPLAY ED DESC WHEN ORDERED;"DISPLAY EDUCATIONAL DESCRIPTION WHEN ORDERED"
"KRN",.402,777,"DR",1,71)
S DIE("NO^")="BACKOUTOK";S:$P(^RAMIS(71,DA,0),U,8)="Y" Y="@01";S:$G(RAEND)=1 Y="@999";.01;@01;S RARMPF=$P($G(^RAMIS(71,DA,"NTRT")),U,1),RAEXC=$P($G(^RAMIS(71,DA,"NTRT")),U,2);12;S RAIMAG=$$IMAG^RASITE(+X);K RADIO;
"KRN",.402,777,"DR",1,71,1)
S:$P($G(^RA(79.2,+$P($G(^RAMIS(71,DA,0)),"^",12),0)),"^",5)="Y" RADIO="";6//BROAD;S RAPTY=$E(X);I $P($G(^RAMIS(71,DA,"NTRT")),U,1)'="" W !!?3,"Mapped to MRPF procedure: "_$P(^RAMRPF(71.99,$P(^RAMIS(71,DA,"NTRT"),U,1),0),U,1),!;
"KRN",.402,777,"DR",1,71,2)
K DIE("NO^");S:(RAPTY="B")!(RAPTY="P") Y="@7";20//NO;S RAREM="check if user answered 'no' to 'CM Used'" K RAREM;S:$P($G(^RAMIS(71,DA,0)),U,20)="Y" Y="@5";N RADELCMQ S RAREM="if 'no' or null to 'CM Used' kill CM data" K RAREM;
"KRN",.402,777,"DR",1,71,3)
S:+$O(^RAMIS(71,DA,"CM",0))=0 Y="@6";S RADELCMQ=$$DELCM^RAUTL2(DA);S:$G(RADELCMQ)="^" Y="@999";S:$G(RADELCMQ)="N" Y="@5";K ^RAMIS(71,DA,"CM") S Y="@6";@5;125;@6;731;@7;S:RAPTY'="P" Y="@10";18;@10;13;150;S:"BP"[RAPTY Y="@50";5;
"KRN",.402,777,"DR",1,71,4)
K RA65 S RA65="P";55///^S X=$$RXMEDIT^RAPSAPI3(.RA65,","_DA_",",71,55,DT);S:$G(RA65("RESULT"))'="" Y="DEFAULT MEDICATIONS";S:'$D(RADIO) Y="@50";@20;W !!?3,"Reminder --";
"KRN",.402,777,"DR",1,71,5)
W !!?3,"Selection of 'Suppress' for 'SUPPRESS RADIOPHARM PROMPT' will result in";W !?3,"the deletion of all default radiopharmaceutical information for this";W !?3,"procedure.",!;2;S:X'=1 Y="@40";
"KRN",.402,777,"DR",1,71,6)
S:'$O(^RAMIS(71,DA,"NUC",0))&($P(^RAMIS(71,DA,0),U,19)="") Y="@70";W:$O(^RAMIS(71,DA,"NUC",0)) !!?3,"Radiopharmaceutical information entered previously",!?3,"for this procedure will be delete.",$C(7);
"KRN",.402,777,"DR",1,71,7)
W:$P(^RAMIS(71,DA,0),U,19)]"" !!?3,"PROMPT FOR RADIOPHARM RX will be deleted.",$C(7);S RAASK="" R !!,"Are you sure you want those data deleted ? : N//",RAASK;S:$E(RAASK)=""!("Yy"'[$E(RAASK)) Y="@20";
"KRN",.402,777,"DR",1,71,8)
S RAREM="default radiopharms will be deleted from calling rtn RAMAIN2" K RAREM;19///@;S:RAPTY="B" Y="@150";S:RAPTY="P" Y="@200";S Y="@70";@40;19;@50;S:RAPTY="B" Y="@150";S:RAPTY="P" Y="@200";S:'$D(RADIO) Y="@70";K RA65 S RA65="R";
"KRN",.402,777,"DR",1,71,9)
50///^S X=$$RXMEDIT^RAPSAPI3(.RA65,","_DA_",",71,50,DT);S:$G(RA65("RESULT"))'="" Y="DEFAULT RADIOPHARMACEUTICALS";@70;175;S RAREM="edit CPT for new records only RAPNM=proc. name" K RAREM;S:'$G(RANEW71) Y="@15";
"KRN",.402,777,"DR",1,71,10)
D CPT^RAMAINU(DA,RAPNM);@15;W:'$G(RANEW71) !,"CPT CODE// "_$P($$NAMCODE^RACPTMSC($P(^RAMIS(71,DA,0),U,9),DT),U)_" (no editing)";D:$T(DISDCM^RACPTMSC)]"" DISDCM^RACPTMSC;135;7//NO;11//NO;@150;3;4;75;@200;S:"BP"'[RAPTY Y="@250";
"KRN",.402,777,"DR",1,71,11)
11//NO;@250;200;S:RAPTY'="P" Y="@290";300;@290;500;S:'$O(^RAMIS(71,DA,"EDU",0)) Y="@300";17DISPLAY EDUCATIONAL DESCRIPTION WHEN ORDERED~;@300;100//^S X=$S(RAPTY="P"&('$O(^RAMIS(71,DA,4,0))):DT,1:"");@999;
"KRN",.402,777,"DR",1,71,12)
K RADIO,RAMIS,RAPTY,RAIMAG,RA65,RARMPF,RAEXC;
"KRN",.402,777,"DR",2,71.01)
.01
"KRN",.402,777,"DR",2,71.0125)
.01
"KRN",.402,777,"DR",2,71.0135)
.01
"KRN",.402,777,"DR",2,71.02)
.01;2;
"KRN",.402,777,"DR",2,71.03)
.01;S RAMIS=X;2;S:$P(RAIMAG,U,3)="NM" Y="@99";3;S:RAMIS'=21 Y="@99";4;@99;
"KRN",.402,777,"DR",2,71.04)
.01
"KRN",.402,777,"DR",2,71.05)
.01;
"KRN",.402,777,"DR",2,71.055)
S:$G(X)="" Y=0;.01///^S X=$$RXMEDIT^RAPSAPI3(.RA65,DA_","_DA(1)_",");2;
"KRN",.402,777,"DR",2,71.0731)
.01
"KRN",.402,777,"DR",2,71.08)
S:$G(X)="" Y=0;.01///^S X=$$RXMEDIT^RAPSAPI3(.RA65,DA_","_DA(1)_",");6T~;S X=X;5T~;S X=X;D EN^DDIOL("Input a 'Usual Dose' value within the range of: "_$$RANGE^RADD2(.DA),"","!?5");2T~;S X=X;3;S RAROUTE=+$G(X);
"KRN",.402,777,"DR",2,71.08,1)
S:'$O(^RAMIS(71.6,RAROUTE,"SITE",0)) Y="@49";S:$P(^RAMIS(71.6,RAROUTE,0),U,3)="Y" Y="@49";4;S Y="@55";@49;4///@;@55;7;
"KRN",.402,2778,-1)
0^2
"KRN",.402,2778,0)
NEW RAD PROCEDURE^3170405.1113^^71.11^^^3170509
"KRN",.402,2778,"DIAB",1,1,71.111,0)
ALL
"KRN",.402,2778,"DIAB",1,1,71.11125,0)
ALL
"KRN",.402,2778,"DIAB",1,1,71.11135,0)
ALL
"KRN",.402,2778,"DIAB",1,1,71.11731,0)
ALL
"KRN",.402,2778,"DIAB",1,1,71.12,0)
ALL
"KRN",.402,2778,"DIAB",3,1,71.1108,0)
LOW ADULT DOSE;T
"KRN",.402,2778,"DIAB",5,1,71.1108,0)
HIGH ADULT DOSE;T
"KRN",.402,2778,"DIAB",8,1,71.1108,0)
USUAL DOSE;T
"KRN",.402,2778,"DIAB",9,0,71.11,12)
DISPLAY ED DESC WHEN ORDERED;"DISPLAY EDUCATIONAL DESCRIPTION WHEN ORDERED"
"KRN",.402,2778,"DR",1,71.11)
S DIE("NO^")="BACKOUTOK";S:$P($G(^RAMRPF(71.11,DA,0)),U,8)="Y" Y="@01";S:$G(RAEND)=1 Y="@999";.01//^S X=RANM;@01;S RARMPF=$P($G(^RAMRPF(71.11,DA,"NTRT")),U,1),RAEXC=$P($G(^RAMRPF(71.11,DA,"NTRT")),U,2);12;
"KRN",.402,2778,"DR",1,71.11,1)
S RAIMAG=$$IMAG^RASITE(+X);K RADIO;S:$P($G(^RA(79.2,+$P($G(^RAMRPF(71.11,DA,0)),"^",12),0)),"^",5)="Y" RADIO="";6//BROAD;S RAPTY=$E(X);
"KRN",.402,2778,"DR",1,71.11,2)
I $P($G(^RAMRPF(71.11,DA,"NTRT")),U,1)'="" W !!?3,"Mapped to MRPF procedure: "_$P(^RAMRPF(71.99,$P(^RAMRPF(71.11,DA,"NTRT"),U,1),0),U,1),!;K DIE("NO^");S:(RAPTY="B")!(RAPTY="P") Y="@7";20//NO;
"KRN",.402,2778,"DR",1,71.11,3)
S RAREM="check if user answered 'no' to 'CM Used'" K RAREM;S:$P($G(^RAMRPF(71.11,DA,0)),U,20)="Y" Y="@5";N RADELCMQ S RAREM="if 'no' or null to 'CM Used' kill CM data" K RAREM;S:+$O(^RAMRPF(71.11,DA,"CM",0))=0 Y="@6";
"KRN",.402,2778,"DR",1,71.11,4)
S RADELCMQ=$$DELCM^RAUTL2(DA);S:$G(RADELCMQ)="^" Y="@999";S:$G(RADELCMQ)="N" Y="@5";K ^RAMRPF(71.11,DA,"CM") S Y="@6";@5;125;@6;731;@7;S:RAPTY'="P" Y="@10";18;@10;13;150;S:"BP"[RAPTY Y="@50";5;K RA65 S RA65="P";
"KRN",.402,2778,"DR",1,71.11,5)
55///^S X=$$RXMEDIT^RAPSAPI3(.RA65,","_DA_",",71.11,55,DT);S:$G(RA65("RESULT"))'="" Y="DEFAULT MEDICATIONS";S:'$D(RADIO) Y="@50";@20;W !!?3,"Reminder --";
"KRN",.402,2778,"DR",1,71.11,6)
W !!?3,"Selection of 'Suppress' for 'SUPPRESS RADIOPHARM PROMPT' will result in";W !?3,"the deletion of all default radiopharmaceutical information for this";W !?3,"procedure.",!;2;S:X'=1 Y="@40";
"KRN",.402,2778,"DR",1,71.11,7)
S:'$O(^RAMRPF(71.11,DA,"NUC",0))&($P(^RAMRPF(71.11,DA,0),U,19)="") Y="@70";W:$O(^RAMRPF(71.11,DA,"NUC",0)) !!?3,"Radiopharmaceutical information entered previously",!?3,"for this procedure will be delete.",$C(7);
"KRN",.402,2778,"DR",1,71.11,8)
W:$P(^RAMRPF(71.11,DA,0),U,19)]"" !!?3,"PROMPT FOR RADIOPHARM RX will be deleted.",$C(7);S RAASK="" R !!,"Are you sure you want those data deleted ? : N//",RAASK;S:$E(RAASK)=""!("Yy"'[$E(RAASK)) Y="@20";
"KRN",.402,2778,"DR",1,71.11,9)
S RAREM="default radiopharms will be deleted from calling rtn RAMAIN2" K RAREM;S:RAPTY="B" Y="@150";S:RAPTY="B" Y="@200";S Y="@70";@40;19;@50;S:RAPTY="B" Y="@150";S:RAPTY="P" Y="@200";S:'$D(RADIO) Y="@70";K RA65 S RA65="R";
"KRN",.402,2778,"DR",1,71.11,10)
50///^S X=$$RXMEDIT^RAPSAPI3(.RA65,","_DA_",",71.11,50,DT);S:$G(RA65("RESULT"))'="" Y="DEFAULT RADIOPHARMACEUTICALS";@70;175;S RAREM="edit CPT for new records only RAPNM=proc. name" K RAREM;S:'$G(RANEW) Y="@15";
"KRN",.402,2778,"DR",1,71.11,11)
D CPT^RANPROU(DA,RAPNM);@15;W:'$G(RANEW) !,"CPT CODE// "_$P($$NAMCODE^RACPTMSC($P(^RAMRPF(71.11,DA,0),U,9),DT),U)_" (no editing)";D:$T(DISDCM^RACPTMSC)]"" DISDCM^RACPTMSC;135;7//NO;11//NO;@150;3;4;75;@200;S:"BP"'[RAPTY Y="@250";
"KRN",.402,2778,"DR",1,71.11,12)
11//NO;@250;200;S:RAPTY'="P" Y="@290";300;@290;500;S:'$O(^RAMRPF(71.11,DA,"EDU",0)) Y="@300";17DISPLAY EDUCATIONAL DESCRIPTION WHEN ORDERED~;@300;100//^S X=$S(RAPTY="P"&('$O(^RAMRPF(71.11,DA,71.1105,0))):DT,1:"");@999;
"KRN",.402,2778,"DR",1,71.11,13)
K RADIO,RAMIS,RAPTY,RAIMAG,RA65,RARMPF,RAEXC;
"KRN",.402,2778,"DR",2,71.1102)
.01;
"KRN",.402,2778,"DR",2,71.1103)
.01;S RAMIS=X;2;S:$P(RAIMAG,U,3)="NM" Y="@99";3;S:RAMIS'=21 Y="@99";@99;
"KRN",.402,2778,"DR",2,71.1105)
.01;
"KRN",.402,2778,"DR",2,71.1108)
S:$G(X)="" Y=0;.01///^S X=$$RXMEDIT^RAPSAPI3(.RA65,DA_","_DA(1)_",");6T~;S X=X;5T~;S X=X;D EN^DDIOL("Input a 'Usual  Dose' value within the range of: "_$$RANGE^RADD2(.DA),"","!?5");2T~;S X=X;3;S RAROUTE=+$G(X);
"KRN",.402,2778,"DR",2,71.1108,1)
S:'$O(^RAMIS(71.6,RAROUTE,"SITE",0)) Y="@49";4;S Y="@55";@49;4///@;@55;7;
"KRN",.402,2778,"DR",2,71.111)
.01
"KRN",.402,2778,"DR",2,71.11125)
.01
"KRN",.402,2778,"DR",2,71.11135)
.01
"KRN",.402,2778,"DR",2,71.1155)
S:$G(X)="" Y=0;.01///^S X=$$RXMEDIT^RAPSAPI3(.RA65,DA_","_DA(1)_",");2;
"KRN",.402,2778,"DR",2,71.11731)
.01
"KRN",.402,2778,"DR",2,71.12)
.01
"MBREQ")
0
"ORD",7,.402)
.402;7;;;EDEOUT^DIFROMSO(.402,DA,"",XPDA);FPRE^DIFROMSI(.402,"",XPDA);EPRE^DIFROMSI(.402,DA,$E("N",$G(XPDNEW)),XPDA,"",OLDA);;EPOST^DIFROMSI(.402,DA,"",XPDA);DEL^DIFROMSK(.402,"",%)
"ORD",7,.402,0)
INPUT TEMPLATE
"PKG",31,-1)
1^1
"PKG",31,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",31,20,0)
^9.402P^^
"PKG",31,22,0)
^9.49I^1^1
"PKG",31,22,1,0)
5.0^2980317^2980805^1
"PKG",31,22,1,"PAH",1,0)
138^3170509^520651136
"PKG",31,22,1,"PAH",1,1,0)
^^3^3^3170509
"PKG",31,22,1,"PAH",1,1,1,0)
Patch RA*5.0*138 corrects defects introduced by patch RA*5.0*127.
"PKG",31,22,1,"PAH",1,1,2,0)
 
"PKG",31,22,1,"PAH",1,1,3,0)
Please see FORUM for full patch description and installation instructions.
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
9
"RTN","RAMAIN2")
0^2^B63318644^B63613910
"RTN","RAMAIN2",1,0)
RAMAIN2 ;HISC/GJC-Radiology Utility File Maintenance (Part Two) ; 21 Oct 2016  3:21 PM
"RTN","RAMAIN2",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**45,62,71,65,127,138**;Mar 16, 1998;Build 22
"RTN","RAMAIN2",3,0)
 ; 08/12/2005 bay/kam Remedy Call 104630 Patch 62
"RTN","RAMAIN2",4,0)
 ; 03/02/2006 BAY/KAM Remedy Call 131482 Patch RA*5*71
"RTN","RAMAIN2",5,0)
 ; 
"RTN","RAMAIN2",6,0)
 ;Supported IA #10141 reference to MES^XPDUTL
"RTN","RAMAIN2",7,0)
 ;Supported IA #10142 reference to EN^DDIOL
"RTN","RAMAIN2",8,0)
 ;Supported IA #10103 reference to DT^XLFDT
"RTN","RAMAIN2",9,0)
 ; 
"RTN","RAMAIN2",10,0)
2 ;;Procedure Enter/Edit
"RTN","RAMAIN2",11,0)
 ; *** This subroutine once resided in RAMAIN i.e, '2^RAMAIN'. ***
"RTN","RAMAIN2",12,0)
 ; RA PROCEDURE option
"RTN","RAMAIN2",13,0)
 N RACTIVE,RAENALL,RAY,RAFILE,RASTAT,RAXIT,RAIEN,RANEW,RASEED,RANEWPRO K ^XTMP("RAMAIN4",$J)
"RTN","RAMAIN2",14,0)
 S (RAENALL,RANEW71,RAXIT,RANEW)=0 K ^XTMP("RAMAIN4",$J)
"RTN","RAMAIN2",15,0)
 N RADIO,RAPTY,RAASK,RAROUTE ;used by the edit template
"RTN","RAMAIN2",16,0)
 F  D  Q:$G(RAXIT)=0!($G(RAXIT)="")!($G(^XTMP("RAMAIN4",$J,"RAEND"))=1)  G:$G(^XTMP("RAMAIN4",$J,"RAEND"))=1 END
"RTN","RAMAIN2",17,0)
 . K DA,DD,DIC,DINUM,DLAYGO,DO,RACMDIFF,RATRKCMA,RATRKCMB
"RTN","RAMAIN2",18,0)
 . S DIC="^RAMIS(71,",DIC(0)="QEAMLZ",DLAYGO=71,DIC("DR")=6
"RTN","RAMAIN2",19,0)
 . W ! D ^DIC K D,DD,DIC,DINUM,DLAYGO,DO
"RTN","RAMAIN2",20,0)
 . I $G(Y)<0!($G(Y)="") S ^XTMP("RAMAIN4",$J,"RAEND")=1 Q
"RTN","RAMAIN2",21,0)
 . S (DA,RADA)=+Y,RAY=Y,RAFILE=71
"RTN","RAMAIN2",22,0)
 . ;RA*5*71 changed next line for Remedy Call 131482
"RTN","RAMAIN2",23,0)
 . S RANEW71=$S($P(Y,U,3)=1:1,1:0) ;used in template, edit CPT Code if new rec.
"RTN","RAMAIN2",24,0)
 . L +^RAMIS(RAFILE,RADA):5
"RTN","RAMAIN2",25,0)
 . I '$T D  Q
"RTN","RAMAIN2",26,0)
 .. W !?5,"This record is currently being edited by another user."
"RTN","RAMAIN2",27,0)
 .. W !?5,"Try again later!",$C(7) S RAXIT=1
"RTN","RAMAIN2",28,0)
 .. Q
"RTN","RAMAIN2",29,0)
 . Q
"RTN","RAMAIN2",30,0)
21 ;ENTRY POINT FROM RANPRO, RA*5.0*127
"RTN","RAMAIN2",31,0)
 S (RAENALL,RANEW71,RAXIT,RANEW)=0 S:$G(RACTIVE)="" RACTIVE="" K ^XTMP("RAMAIN4",$J)
"RTN","RAMAIN2",32,0)
 I RACTIVE="" S RACTIVE=$P($G(^RAMIS(71,RADA,"I")),"^")
"RTN","RAMAIN2",33,0)
 S RAFILE=71,RAY=RAYY S:$G(RASTAT)="" RASTAT=$S(RACTIVE="":1,RACTIVE>DT:1,1:0)
"RTN","RAMAIN2",34,0)
 D  ;ENTER INTO STRUCTURE PROCESS
"RTN","RAMAIN2",35,0)
 . S RAPNM=$P($G(Y(0)),U) ;proc. name for display purposes in template
"RTN","RAMAIN2",36,0)
 . S RACTIVE=$P($G(^RAMIS(71,RADA,"I")),"^")
"RTN","RAMAIN2",37,0)
 . S RASTAT=$S(RACTIVE="":1,RACTIVE>DT:1,1:0)
"RTN","RAMAIN2",38,0)
 . D TRKCMB^RAMAINU(DA,.RATRKCMB) ;tracks existing
"RTN","RAMAIN2",39,0)
 . ; CM definition before editing. RATRKCMB ids the before CM values
"RTN","RAMAIN2",40,0)
 . I $G(RANEW)=1 Q  ;RA*50*127 NEW PROCEDURE
"RTN","RAMAIN2",41,0)
 . S DIE="^RAMIS(71,",DR="[RA PROCEDURE EDIT]" D ^DIE
"RTN","RAMAIN2",42,0)
 . S RACPT=$P(^RAMIS(71,RADA,0),U,9)
"RTN","RAMAIN2",43,0)
 . K RAPNM S RAPROC(0)=$G(^RAMIS(71,RADA,0))
"RTN","RAMAIN2",44,0)
 . ;
"RTN","RAMAIN2",45,0)
 . ;check for data consistency between the 'CONTRAST MEDIA USED' &
"RTN","RAMAIN2",46,0)
 . ;'CONTRAST MEDIA' fields.
"RTN","RAMAIN2",47,0)
 . D CMINTEG^RAMAINU1(RADA,RAPROC(0))
"RTN","RAMAIN2",48,0)
 . ;
"RTN","RAMAIN2",49,0)
 . D TRKCMA^RAMAINU(RADA,RATRKCMB,.RATRKCMA,.RACMDIFF)
"RTN","RAMAIN2",50,0)
 . I $O(^RAMIS(71,RADA,"NUC",0)),($P(RAPROC(0),"^",2)=1) D DELRADE(RADA)
"RTN","RAMAIN2",51,0)
 . S RACTIVE=$P($G(^RAMIS(71,RADA,"I")),"^")
"RTN","RAMAIN2",52,0)
 . S RASTAT=RASTAT_"^"_$S(RACTIVE="":1,RACTIVE>DT:1,1:0)
"RTN","RAMAIN2",53,0)
 . ; 08/12/2005 104630 KAM - added '$G(RANEW71) to next line
"RTN","RAMAIN2",54,0)
 . I RAPROC(0)]"",("^B^P^"'[(U_$P(RAPROC(0),"^",6)_U)),('+$P(RAPROC(0),"^",9)),'+$G(RANEW71) D
"RTN","RAMAIN2",55,0)
 .. K %,C,D0,DE,DI,DIE,DQ,DR
"RTN","RAMAIN2",56,0)
 .. W !?5,$C(7),"...no CPT code entered..."
"RTN","RAMAIN2",57,0)
 .. W !?5,"...will change type to a 'broad' procedure.",!
"RTN","RAMAIN2",58,0)
 .. S DA=RADA,DIE="^RAMIS(71,",DR="6///B" D ^DIE
"RTN","RAMAIN2",59,0)
 .. Q
"RTN","RAMAIN2",60,0)
 . ;08/12/2005 104630 - KAM added next 5 lines
"RTN","RAMAIN2",61,0)
 . I RAPROC(0)]"",("^B^P^"'[(U_$P(RAPROC(0),"^",6)_U)),('+$P(RAPROC(0),"^",9)),+$G(RANEW71) D
"RTN","RAMAIN2",62,0)
 .. K %,C,D0,DE,DI,DIK,DQ,DR
"RTN","RAMAIN2",63,0)
 .. W !?5,$C(7),"...no CPT code entered..."
"RTN","RAMAIN2",64,0)
 .. W !?5,"...will delete the record at this time.",!
"RTN","RAMAIN2",65,0)
 .. S DIK="^RAMIS(71,",DA=RADA D ^DIK K DIK
"RTN","RAMAIN2",66,0)
 . ;if an active parent w/o descendants, inactivate the parent
"RTN","RAMAIN2",67,0)
 . I $P(RASTAT,U,2),($P(RAPROC(0),U,6)="P"),('$O(^RAMIS(71,RADA,4,0))) D
"RTN","RAMAIN2",68,0)
 .. K D,D0,D1,DA,DI,DIC,DIE,DQ,DR
"RTN","RAMAIN2",69,0)
 .. W !!?5,"Inactivating this parent procedure - no descendents.",!,$C(7)
"RTN","RAMAIN2",70,0)
 .. S DA=RADA,DIE="^RAMIS(71,",DR="100///"_$S($D(DT):DT,1:$$DT^XLFDT())
"RTN","RAMAIN2",71,0)
 .. D ^DIE K D,D0,D1,DA,DI,DIC,DIE,DQ,DR S $P(RASTAT,U,2)=0 ;inactive
"RTN","RAMAIN2",72,0)
 .. Q
"RTN","RAMAIN2",73,0)
 . I $P($G(^RA(79.2,+$P(RAPROC(0),U,12),0)),U,5)="Y",(+$O(^RAMIS(71,RADA,"NUC",0))) D VRDIO(RADA)
"RTN","RAMAIN2",74,0)
 . I "^B^P^"[(U_$P(RAPROC(0),U,6)_U),($P(RAPROC(0),U,9)]"") D
"RTN","RAMAIN2",75,0)
 .. K %,D,D0,DA,DE,DIC,DIE,DQ,DR
"RTN","RAMAIN2",76,0)
 .. S DA=RADA,DIE="^RAMIS(71,",DR="9///@" D ^DIE
"RTN","RAMAIN2",77,0)
 .. W !!?5,"...CPT code deleted because "_$S($P(RAPROC(0),U,6)="B":"Broad",1:"Parent")_" procedures",!?5,"should not have CPT codes.",!,$C(7)
"RTN","RAMAIN2",78,0)
 .. Q
"RTN","RAMAIN2",79,0)
 . K %,%X,%Y,C,D,D0,D1,DA,DE,DI,DIE,DQ,DR,RAIMAG,RAMIS,RAPROC,X,Y
"RTN","RAMAIN2",80,0)
 .;send Orderable Item HL7 msg to CPRS if the ORDER DIALOG (#101.41)
"RTN","RAMAIN2",81,0)
 .;file exists unconditionally
"RTN","RAMAIN2",82,0)
 .D:$$ORQUIK^RAORDU()=1 PROC^RAO7MFN(RAENALL,RAFILE,RASTAT,RAY)
"RTN","RAMAIN2",83,0)
 .;
"RTN","RAMAIN2",84,0)
 . L -^RAMIS(RAFILE,RADA) K RADA
"RTN","RAMAIN2",85,0)
 .;unconditionally update the parent procedure if the descendent
"RTN","RAMAIN2",86,0)
 .I $O(^RAMIS(71,"ADESC",+RAY,0)) D UPDATP^RAO7UTL(RAY)
"RTN","RAMAIN2",87,0)
 .;has been edited
"RTN","RAMAIN2",88,0)
 . Q
"RTN","RAMAIN2",89,0)
 I $G(RANEW)=1 D EN^RANPRO(RAYY,RATYPE,RANEW)  ;RA*5.0*127 NEW PROCEDURE
"RTN","RAMAIN2",90,0)
 K DIR,RACMDIFF,RATRKCMA,RATRKCMB
"RTN","RAMAIN2",91,0)
 I $G(^XTMP("RAMAIN4",$J,"RAEND"))=1 G END
"RTN","RAMAIN2",92,0)
 D EXIT G END
"RTN","RAMAIN2",93,0)
 Q
"RTN","RAMAIN2",94,0)
 ;W !,?3,"Running validity check on CPT and stop codes." H 1 D ^RAPERR G EXIT  ;RA*5*127
"RTN","RAMAIN2",95,0)
22 ; RA*5*127
"RTN","RAMAIN2",96,0)
 K DIR
"RTN","RAMAIN2",97,0)
 S DIR(0)="YAO",DIR("B")="NO"
"RTN","RAMAIN2",98,0)
 S DIR("A")="Want to run a validity check on CPT and stop codes? "
"RTN","RAMAIN2",99,0)
 S DIR("?",1)="Answer 'YES' to print a list of Radiology/Nuclear Medicine Procedures"
"RTN","RAMAIN2",100,0)
 S DIR("?",2)="with missing or invalid CPT's and/or Credit Clinic Stop Code(s)."
"RTN","RAMAIN2",101,0)
 S DIR("?",3)="Broad procedures with invalid codes are included for information"
"RTN","RAMAIN2",102,0)
 S DIR("?",4)="only.  Inactive procedures are not required to have valid codes."
"RTN","RAMAIN2",103,0)
 S DIR("?",5)="To be valid, Stop Codes must be in the Imaging Stop Codes file 71.5;"
"RTN","RAMAIN2",104,0)
 S DIR("?",6)="CPT's must be nationally active."
"RTN","RAMAIN2",105,0)
 S DIR("?")="Please answer 'YES' or 'NO'."
"RTN","RAMAIN2",106,0)
 W ! D ^DIR K DIR G:$D(DIRUT) EXIT
"RTN","RAMAIN2",107,0)
 D:Y ^RAPERR
"RTN","RAMAIN2",108,0)
EXIT K RADA,RANEW71,X,Y
"RTN","RAMAIN2",109,0)
 Q
"RTN","RAMAIN2",110,0)
13 ;;Rad/Nuc Med Common Procedure File Enter/Edit
"RTN","RAMAIN2",111,0)
 ; RA COMMON PROCEDURE option
"RTN","RAMAIN2",112,0)
 N RADA,RAENALL,RAY,RAFILE,RALOW,RAMIS713,RASTAT,RAIMGTYI S RAENALL=0
"RTN","RAMAIN2",113,0)
 W ! D EN1^RAUTL17 G:Y'>0 Q13 S RAIMGTYI=Y
"RTN","RAMAIN2",114,0)
131 S DIC="^RAMIS(71.3,",DIC(0)="AELMQZ",DLAYGO=71.3
"RTN","RAMAIN2",115,0)
 S DIC("S")="N RA S RA=+$P(^(0),U) I RAIMGTYI=$P($G(^RAMIS(71,RA,0)),U,12)"
"RTN","RAMAIN2",116,0)
 S DIC("W")="N RA4 S RA4=$P($G(^(0)),""^"",4) W:RA4]"""" ""   (""_RA4_"")"" W:RA4']"""" ""   (no sequence number)"""
"RTN","RAMAIN2",117,0)
 W ! D ^DIC K DIC,DLAYGO,D,X
"RTN","RAMAIN2",118,0)
 I Y<0 D Q13 G RESEQ
"RTN","RAMAIN2",119,0)
 ; If a sequence # exists, the Common Proc. is active
"RTN","RAMAIN2",120,0)
 S RADA=+Y,RAY=Y,RAFILE=71.3 L +^RAMIS(RAFILE,RADA):5
"RTN","RAMAIN2",121,0)
 I '$T D  G Q13
"RTN","RAMAIN2",122,0)
 . W !?5,"This record is currently being edited by another user."
"RTN","RAMAIN2",123,0)
 . W !?5,"Try again later!",$C(7)
"RTN","RAMAIN2",124,0)
 . Q
"RTN","RAMAIN2",125,0)
 S RASTAT=$S($P(Y(0),"^",4)]"":1,1:0)_"^"
"RTN","RAMAIN2",126,0)
 I '+$P(RASTAT,"^") S RALOW=$$LOW(RAIMGTYI)
"RTN","RAMAIN2",127,0)
 S DA=RADA,DIE="^RAMIS(71.3,",DR="[RA COMMON PROCEDURE EDIT]" D ^DIE
"RTN","RAMAIN2",128,0)
 S RAMIS713(0)=$G(^RAMIS(71.3,RADA,0))
"RTN","RAMAIN2",129,0)
 ; If the procedure is different than the one originally selected and
"RTN","RAMAIN2",130,0)
 ; the CPRS Order Dialog file exists, send the Orderable Item Update
"RTN","RAMAIN2",131,0)
 ; message to CPRS.
"RTN","RAMAIN2",132,0)
 I $P(RAMIS713(0),"^")'=$P(RAY,"^",2),($$ORQUIK^RAORDU()=1) D
"RTN","RAMAIN2",133,0)
 . S RASTAT=RASTAT_0 D PROC^RAO7MFN(RAENALL,RAFILE,RASTAT,RAY)
"RTN","RAMAIN2",134,0)
 . S RAY=RADA_"^"_$P($G(^RAMIS(71.3,RADA,0)),"^")_"^"_1,RASTAT=0_"^"
"RTN","RAMAIN2",135,0)
 . Q
"RTN","RAMAIN2",136,0)
 K %,%X,%Y,C,D,D0,DA,DE,DI,DIE,DQ,DR,X,Y
"RTN","RAMAIN2",137,0)
 S RASTAT=RASTAT_$S($P($G(^RAMIS(71.3,+RAY,0)),"^",4)]"":1,1:0)
"RTN","RAMAIN2",138,0)
 ; If before & after statuses differ, and the CPRS Order Dialog file
"RTN","RAMAIN2",139,0)
 ; exists, send the Orderable Item Update message to CPRS.
"RTN","RAMAIN2",140,0)
 I $$ORQUIK^RAORDU()=1,(($P(RASTAT,"^")+$P(RASTAT,"^",2))=1) D
"RTN","RAMAIN2",141,0)
 . D PROC^RAO7MFN(RAENALL,RAFILE,RASTAT,RAY)
"RTN","RAMAIN2",142,0)
 . Q
"RTN","RAMAIN2",143,0)
 L -^RAMIS(RAFILE,RADA)
"RTN","RAMAIN2",144,0)
 G 131
"RTN","RAMAIN2",145,0)
Q13 K DDC,DDH,DISYS,I,POP,RA713
"RTN","RAMAIN2",146,0)
 Q
"RTN","RAMAIN2",147,0)
RESEQ ;Resequence the common procedure list
"RTN","RAMAIN2",148,0)
 N D,D0,DI,DQ,H,I,J,CNT,DIC,DIE,DR,DA,TXT,X
"RTN","RAMAIN2",149,0)
 I $D(XPDNM) D  ; if called during package install
"RTN","RAMAIN2",150,0)
 . S TXT(1)=" "
"RTN","RAMAIN2",151,0)
 . S TXT(2)="Resequencing the Rad/Nuc Med Common Procedure List."
"RTN","RAMAIN2",152,0)
 . Q
"RTN","RAMAIN2",153,0)
 E  W !!?5,"Resequencing the Rad/Nuc Med Common Procedure List"
"RTN","RAMAIN2",154,0)
 S DIE="^RAMIS(71.3,",(I,CNT)=0
"RTN","RAMAIN2",155,0)
 F  S I=$O(^RAMIS(71.3,"AA",RAIMGTYI,I)) Q:I'>0  D
"RTN","RAMAIN2",156,0)
 . S J=0
"RTN","RAMAIN2",157,0)
 . F  S J=$O(^RAMIS(71.3,"AA",RAIMGTYI,I,J)) Q:J'>0  I $D(^RAMIS(71.3,J,0)) D
"RTN","RAMAIN2",158,0)
 .. S DA=J,CNT=CNT+1 N I,J
"RTN","RAMAIN2",159,0)
 .. S DR="3////^S X=CNT" D ^DIE W:'$D(XPDNM) "."
"RTN","RAMAIN2",160,0)
 .. Q
"RTN","RAMAIN2",161,0)
 . Q
"RTN","RAMAIN2",162,0)
 I $D(XPDNM) D  ; if called during package install
"RTN","RAMAIN2",163,0)
 . S TXT(2)=$G(TXT(2))_"  Done!"
"RTN","RAMAIN2",164,0)
 . D MES^XPDUTL(.TXT)
"RTN","RAMAIN2",165,0)
 . Q
"RTN","RAMAIN2",166,0)
 E  W "  Done!"
"RTN","RAMAIN2",167,0)
 Q
"RTN","RAMAIN2",168,0)
LOW(X) ; Find the lowest available sequence number for a procedure within
"RTN","RAMAIN2",169,0)
 ; a specific Imaging Type.  Seq. #'s range from 1 to 40.  If the
"RTN","RAMAIN2",170,0)
 ; range changes in the DD i.e, ^DD(71.3,3, this code as well as the 
"RTN","RAMAIN2",171,0)
 ; code if EN3^RAUTL18 must also be altered.
"RTN","RAMAIN2",172,0)
 ; If RAHIT is passed back as "", there is no available sequence number.
"RTN","RAMAIN2",173,0)
 N RA,RAHIT S RAHIT=""
"RTN","RAMAIN2",174,0)
 F RA=1:1:40 D  Q:RAHIT
"RTN","RAMAIN2",175,0)
 . Q:$D(^RAMIS(71.3,"AA",X,RA))
"RTN","RAMAIN2",176,0)
 . S:RAHIT="" RAHIT=RA
"RTN","RAMAIN2",177,0)
 . Q
"RTN","RAMAIN2",178,0)
 Q RAHIT
"RTN","RAMAIN2",179,0)
VRDIO(RADA) ; Validate the 'Usual Dose' field within the 'Default Radiopha-
"RTN","RAMAIN2",180,0)
 ; rmaceuticals' multiple.  'Usual Dose' must fall within the 'Low Adult
"RTN","RAMAIN2",181,0)
 ; Dose' & 'High Adult Dose' range.  This subroutine will display the
"RTN","RAMAIN2",182,0)
 ; Radiopharmaceutical in question along with the values in question if
"RTN","RAMAIN2",183,0)
 ; inconsistencies are found.
"RTN","RAMAIN2",184,0)
 ;
"RTN","RAMAIN2",185,0)
 ; Input Variable: 'RADA' the ien of the Procedure
"RTN","RAMAIN2",186,0)
 N RANUC S RADA(1)=RADA,RADA=0 D EN^DDIOL("","","!")
"RTN","RAMAIN2",187,0)
 F  S RADA=$O(^RAMIS(71,RADA(1),"NUC",RADA)) Q:RADA'>0  D
"RTN","RAMAIN2",188,0)
 . S RANUC(0)=$G(^RAMIS(71,RADA(1),"NUC",RADA,0))
"RTN","RAMAIN2",189,0)
 . Q:$P(RANUC(0),"^",2)=""  ; no need to validate, nothing input
"RTN","RAMAIN2",190,0)
 . I '$$USUAL^RADD2(.RADA,$P(RANUC(0),"^",2)) D
"RTN","RAMAIN2",191,0)
 .. N RARRY S RARRY(1)="For Radiopharmaceutical: "
"RTN","RAMAIN2",192,0)
 .. S RARRY(1)=RARRY(1)_$$EN1^RAPSAPI(+$P(RANUC(0),"^"),.01)_$C(7)
"RTN","RAMAIN2",193,0)
 .. S RARRY(2)="" D EN^DDIOL(.RARRY,"")
"RTN","RAMAIN2",194,0)
 .. Q
"RTN","RAMAIN2",195,0)
 . Q
"RTN","RAMAIN2",196,0)
 Q
"RTN","RAMAIN2",197,0)
DELRADE(RADA) ; Delete the Default Radiopharmaceuticals multiple 
"RTN","RAMAIN2",198,0)
 N RADA1 S RADA1=0
"RTN","RAMAIN2",199,0)
 W !!?3,"Deleting default radiopharmaceuticals for this procedure...",!
"RTN","RAMAIN2",200,0)
 F  S RADA1=$O(^RAMIS(71,RADA,"NUC",RADA1)) Q:RADA1'>0  D
"RTN","RAMAIN2",201,0)
 . K %,%X,%Y,D,D0,DA,DI,DIC,DIE,DQ,DR,X,Y
"RTN","RAMAIN2",202,0)
 . S DA(1)=RADA,DA=RADA1,DIE="^RAMIS(71,"_RADA_",""NUC"","
"RTN","RAMAIN2",203,0)
 . S DR=".01///@" D ^DIE
"RTN","RAMAIN2",204,0)
 . Q
"RTN","RAMAIN2",205,0)
 K %,%X,%Y,D,D0,DA,DI,DIC,DIE,DQ,DR,X,Y
"RTN","RAMAIN2",206,0)
 Q
"RTN","RAMAIN2",207,0)
 ;
"RTN","RAMAIN2",208,0)
END ;KILL LOGIC AND END ROUTINE
"RTN","RAMAIN2",209,0)
 K RACODE,RACPT,RAGOLD,RAMATCH,RANEW71,RANM,RAPROIEN,RATYPE,RAYY
"RTN","RAMAIN2",210,0)
 K DDC,DDH,DISYS,I,POP,RA713,DIK,DA
"RTN","RAMAIN2",211,0)
 Q
"RTN","RAMAIN4")
0^3^B31310933^B30460135
"RTN","RAMAIN4",1,0)
RAMAIN4 ;BPFO/CLT - RADIOLOGY NEW PROCEDURE UTILITIES ; 28 Sep 2016  12:04 PM
"RTN","RAMAIN4",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**127,138**;Mar 16, 1998;Build 22
"RTN","RAMAIN4",3,0)
 ;
"RTN","RAMAIN4",4,0)
 Q
"RTN","RAMAIN4",5,0)
EN(RADA) ;PRIMARY ENTRY POINT
"RTN","RAMAIN4",6,0)
 N DIR,RATYPE,RAFAC,RAFN,RACODE,RAGOLD,RAMATCH,RANM,RANOT,RAPLUSY,RAPROIEN,RAYY,XMDUN,RANEWPRO
"RTN","RAMAIN4",7,0)
 N P1,P2,RA901
"RTN","RAMAIN4",8,0)
 I $G(DA)'="",$G(RADA)="" S RADA=DA
"RTN","RAMAIN4",9,0)
 S RANM=$P(^RAMIS(71,+RADA,0),U,1),^XTMP("RAMAIN4",$J,"RAEND")=0,RADA=+RADA
"RTN","RAMAIN4",10,0)
GOOD ;ACCEPT ENTRY AND ASSIGN CPT
"RTN","RAMAIN4",11,0)
 S RATYPE=$P(^RAMIS(71,RADA,0),U,6) D:RATYPE'="D"
"RTN","RAMAIN4",12,0)
 .W !!?3,"The type of this exam has been chosen not to be DETAILED.","  An NTRT process",!?3,"will not be initiated.  And no MRPF matching will be performed.",!
"RTN","RAMAIN4",13,0)
 .Q
"RTN","RAMAIN4",14,0)
 Q:RATYPE'="D"
"RTN","RAMAIN4",15,0)
 K DIR S DIR(0)="Y",DIR("A")="Are you sure you are entering "_RANM_" as a new procedure"
"RTN","RAMAIN4",16,0)
 S RASEED=" " S RASEED=$S($P($G(^RAMRPF(71.98,1,0)),U,10)'="Y":" not ",1:" ")
"RTN","RAMAIN4",17,0)
 S DIR("A",1)="This entry will"_RASEED_"be submitted for NTRT processing."
"RTN","RAMAIN4",18,0)
 S DIR("B")="YES"
"RTN","RAMAIN4",19,0)
 W ! D ^DIR S:Y=0 ^XTMP("RAMAIN4",$J,"RAEND")=1 G:^XTMP("RAMAIN4",$J,"RAEND")=1 END
"RTN","RAMAIN4",20,0)
CPTEN ;Enter the CPT code
"RTN","RAMAIN4",21,0)
 I $G(RAX)="QUIT"!(X["^") G END
"RTN","RAMAIN4",22,0)
 W !!,"The CPT code is needed to match to an entry within the MASTER",!,"RADIOLOGY PROCEDURE file."
"RTN","RAMAIN4",23,0)
 I $G(RACPT)'="" W !!,"The CPT code for this procedure is ",RACPT,"."
"RTN","RAMAIN4",24,0)
 I $G(RACPT)="" K DIR S DIR(0)="71,9^^",DIR("A")="Enter the CPT code for this procedure, if the CPT code is known"
"RTN","RAMAIN4",25,0)
 I $G(RACPT)="" K DIRUT,DIROUT,DUOUT W ! D ^DIR I $G(DIRUT)=1  G END
"RTN","RAMAIN4",26,0)
 S:X>0 $P(^RAMIS(71,RADA,0),U,9)=X,RACPT=X
"RTN","RAMAIN4",27,0)
 S DA=RADA,RAGOLD=$$MRPF^RAMAIN5() I $G(DUOUT)=1!($G(Y(0))="") W !!,*7,"No MRPF match made.  Use the Edit MRPF Association on One Procedure",!,"option to make a match later.",!! G END
"RTN","RAMAIN4",28,0)
 I $G(RAPROIEN)'="",$D(^RAMIS(71,"MRPF",$S($G(RAPROIEN)'="":RAPROIEN,1:0))) S RAMTCH=1 D MTCH^RAUTL23
"RTN","RAMAIN4",29,0)
 G:$G(^XTMP("RAMAIN4",$J,"RAEND"))=1 END
"RTN","RAMAIN4",30,0)
 ; RA*5.0*138 correct set of 900 to IEN
"RTN","RAMAIN4",31,0)
 I Y(0)'["NONE LISTED" S DA=RADA,DIE="^RAMIS(71,",DIE(0)="L",DR="900///"_RAPROIEN_";902///"_DT S DA=RADA D ^DIE D
"RTN","RAMAIN4",32,0)
 . I $G(RAPROIEN)'="" W !?3,"You have mapped this procedure to "_$P($G(^RAMRPF(71.99,RAPROIEN,0)),U,1) Q
"RTN","RAMAIN4",33,0)
 I $G(Y(0))["NONE LISTED" D
"RTN","RAMAIN4",34,0)
 . ; PATCH RA*5.0*138 START
"RTN","RAMAIN4",35,0)
 . ;S DA=RADA,DIE="^RAMIA(71,",DIE(0)="L"
"RTN","RAMAIN4",36,0)
 . S DA=RADA,DIE="^RAMIS(71,",DIE(0)="L"
"RTN","RAMAIN4",37,0)
 . ; PATCH RA*5.0*138 END
"RTN","RAMAIN4",38,0)
 . S DR="901///" S RA901=$S($P($G(^RAMRPF(71.98,1,0)),U,10)="Y":"Y",1:"")
"RTN","RAMAIN4",39,0)
 . S DR=DR_RA901_";902///"_DT D ^DIE
"RTN","RAMAIN4",40,0)
 . Q
"RTN","RAMAIN4",41,0)
 S $P(^RAMIS(71,RADA,"NTRT"),U,3)=DT,^RAMIS(71,"CREAT",DT,RADA)=""
"RTN","RAMAIN4",42,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,10)'="Y" S $P(^RAMIS(71,RADA,"NTRT"),U,3)=""
"RTN","RAMAIN4",43,0)
MSG ;SEND A MESSAGE TO GATEKEEPER
"RTN","RAMAIN4",44,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,10)'="Y" Q RADA
"RTN","RAMAIN4",45,0)
 N XMSUB,XMY,XMTEXT,RATXT Q:$P($G(^RAMIS(71,RADA,"NTRT")),U,1)'="" RADA
"RTN","RAMAIN4",46,0)
 S XMSUB="NEW RADIOLOGY PROCEDURE"
"RTN","RAMAIN4",47,0)
 S XMY(DUZ)=""
"RTN","RAMAIN4",48,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,2)'="" S XMY($P(^RAMRPF(71.98,1,0),U,2))=""
"RTN","RAMAIN4",49,0)
 S RATXT(1)="A new Radiology procedure has been entered."
"RTN","RAMAIN4",50,0)
 S RATXT(3)="This procedure will be submitted for NTRT processing."
"RTN","RAMAIN4",51,0)
 S RATXT(4)=" "
"RTN","RAMAIN4",52,0)
 S RATXT(5)=" "
"RTN","RAMAIN4",53,0)
 ;S RATXT(7)=" "
"RTN","RAMAIN4",54,0)
 S RATXT(7)="Procedure Name: "_RANM
"RTN","RAMAIN4",55,0)
 S RATXT(7)="CPT: "_$P($G(^RAMIS(71,RADA,0)),U,9)
"RTN","RAMAIN4",56,0)
 S XMTEXT="RATXT(" D ^XMD
"RTN","RAMAIN4",57,0)
 ;G END
"RTN","RAMAIN4",58,0)
MSG1 ;MESSAGE TO NTRT
"RTN","RAMAIN4",59,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,10)'="Y" Q RADA
"RTN","RAMAIN4",60,0)
 N XMSUB,XMY,XMTEXT,RATXT Q:$P($G(^RAMIS(71,RADA,"NTRT")),U,1)'="" RADA
"RTN","RAMAIN4",61,0)
 S RAFAC=$$KSP^XUPARAM("INST"),RAFAC=$$NS^XUAF4(RAFAC)
"RTN","RAMAIN4",62,0)
 S RAFN=$P(RAFAC,U,1),RAFAC=$P(RAFAC,U,2),$P(^RAMIS(71,RADA,"NTRT"),U,2)="Y"
"RTN","RAMAIN4",63,0)
 S XMSUB="NEW RADIOLOGY PROCEDURE"
"RTN","RAMAIN4",64,0)
 S XMY("G.RADIOLOGY NTRT@FORUM.DOMAIN.EXT")=""
"RTN","RAMAIN4",65,0)
 S XMY("G.RADNTRT")=""
"RTN","RAMAIN4",66,0)
 S XMDUZ("G.RADNTRT")=""
"RTN","RAMAIN4",67,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,2)'="" S XMY($P(^RAMRPF(71.98,1,0),U,2))=""
"RTN","RAMAIN4",68,0)
 ;S XMY("G.RADIOLOGY NTRT@FORUM.DOMAIN.EXT")=""
"RTN","RAMAIN4",69,0)
 S RATXT(1)="A new Radiology procedure has been entered at "_RAFN
"RTN","RAMAIN4",70,0)
 S RATXT(2)=" "
"RTN","RAMAIN4",71,0)
 S RATXT(3)="Facility Name/number: "_RAFN_" / "_RAFAC
"RTN","RAMAIN4",72,0)
 S RATXT(4)=" "
"RTN","RAMAIN4",73,0)
 S RATXT(5)="Procedure name: "_RANM
"RTN","RAMAIN4",74,0)
 S RATXT(6)=" "
"RTN","RAMAIN4",75,0)
 S RATXT(7)="CPT code: "_$P($G(^RAMIS(71,RADA,0)),U,9)
"RTN","RAMAIN4",76,0)
 S RATXT(8)="Local IEN: "_RADA
"RTN","RAMAIN4",77,0)
 S RATXT(9)="For questions or notification respond to: "_"G.RADNTRT@"_$$KSP^XUPARAM("WHERE")
"RTN","RAMAIN4",78,0)
 S RATXT(10)="For NTRT results respond to: "_"S.RANEWPRO@"_$$KSP^XUPARAM("WHERE")
"RTN","RAMAIN4",79,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,9)="Y" D XML G END
"RTN","RAMAIN4",80,0)
 S $P(^RAMIS(71,RADA,"NTRT"),U,4)=DT
"RTN","RAMAIN4",81,0)
 S XMTEXT="RATXT(" D ^XMD
"RTN","RAMAIN4",82,0)
 S $P(^RAMIS(71,RADA,"NTRT"),U,4)=DT
"RTN","RAMAIN4",83,0)
 G END
"RTN","RAMAIN4",84,0)
XML ; NTRT message for ISAAC
"RTN","RAMAIN4",85,0)
 ; Need P1 ISAAC SCHEMA NAME
"RTN","RAMAIN4",86,0)
 ; Need P2 ISAAC SCHEMA PATH
"RTN","RAMAIN4",87,0)
 ; get the schemea name and the schema path
"RTN","RAMAIN4",88,0)
 S P1=$$GET1^DIQ(71.98,"1,",11)
"RTN","RAMAIN4",89,0)
 S P2=$$GET1^DIQ(71.98,"1,",11.5)
"RTN","RAMAIN4",90,0)
 S A=$TR(P1,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","RAMAIN4",91,0)
 I P1'=""&($E(A,($L(A)-4),$L(A)))'=".XSD" S P1=P1_".XSD"
"RTN","RAMAIN4",92,0)
 I P2'="" D  ;<
"RTN","RAMAIN4",93,0)
 . I $E(P2,1,2)'="//" S P2="//"_P2
"RTN","RAMAIN4",94,0)
 . I $E(P2,$L(P2))'="/" S P2=P2_"/"
"RTN","RAMAIN4",95,0)
 S A="uri:"_P2_P1
"RTN","RAMAIN4",96,0)
 K RATXT
"RTN","RAMAIN4",97,0)
 S RATXT(1)=$$XMLHDR^MXMLUTL()
"RTN","RAMAIN4",98,0)
 S RATXT(2)="<DATAEXTRACTS xmlns="""_A_""" xmlns:xsi=""$P(^RAMRPF(71.98,1,0),U,8)"""
"RTN","RAMAIN4",99,0)
 S RATXT(3)=">"
"RTN","RAMAIN4",100,0)
 S RATXT(4)="<RAD_NTRT>"
"RTN","RAMAIN4",101,0)
 S RATXT(5)="<Facility_Name/number>"_RAFN_" / "_RAFAC_"</Facility_Name/number>"
"RTN","RAMAIN4",102,0)
 S RATXT(6)="<Facility_Group_e-mail>"_"G.RADNTRT@"_$$KSP^XUPARAM("WHERE")_"</Facility_Group_e-mail>"
"RTN","RAMAIN4",103,0)
 S RATXT(7)="<Procedure_name>"_RANM_"</Procedure_name>"
"RTN","RAMAIN4",104,0)
 S RATXT(8)="<CPT_code>"_$P($G(^RAMIS(71,RADA,0)),U,9)_"</CPT_code>"
"RTN","RAMAIN4",105,0)
 S RATXT(9)="<Local_IEN>"_RADA_"</Local_IEN>"
"RTN","RAMAIN4",106,0)
 S RATXT(10)="<NTRT_results_response_e-mail>"_"S.RANEWPRO@"_$$KSP^XUPARAM("WHERE")_"</NTRT_results_response_e-mail>"
"RTN","RAMAIN4",107,0)
 S RATXT(11)="</RAD_NTRT>"
"RTN","RAMAIN4",108,0)
 S RATXT(12)="</DATAEXTRACTS>"
"RTN","RAMAIN4",109,0)
 S RAXTMPNM=XMSUB
"RTN","RAMAIN4",110,0)
 D XMLSND^RAXMLSND(RAXTMPNM)
"RTN","RAMAIN4",111,0)
 Q
"RTN","RAMAIN4",112,0)
 ;
"RTN","RAMAIN4",113,0)
DEACT ;BLOCK INACTIVATION DATE
"RTN","RAMAIN4",114,0)
 Q
"RTN","RAMAIN4",115,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,3)'="" D
"RTN","RAMAIN4",116,0)
 . S X1=DT,X2=$P(^RAMRPF(71.98,1,0),U,3)
"RTN","RAMAIN4",117,0)
 . D C^%DTC
"RTN","RAMAIN4",118,0)
 . S ^RAMIS(71,RADA,"I")=X,$P(^RAMIS(71,RADA,"NTRT"),U,2)="Y"
"RTN","RAMAIN4",119,0)
 Q
"RTN","RAMAIN4",120,0)
END ;KILL LOCAL VARIABLES AND END
"RTN","RAMAIN4",121,0)
 K RATXT,XMZ,XMDUN,XMDUZ,RAIEN,X,Y
"RTN","RAMAIN4",122,0)
 Q $G(RANEWPRO)
"RTN","RAMAIN5")
0^5^B36683496^B38646269
"RTN","RAMAIN5",1,0)
RAMAIN5 ;BPFO/CLT - RADIOLOGY MAPPING TO MRPF ; 28 Oct 2016  3:08 PM
"RTN","RAMAIN5",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**127,138**;Mar 16, 1998;Build 22
"RTN","RAMAIN5",3,0)
 ;
"RTN","RAMAIN5",4,0)
 ;  This routine uses the following IA's:
"RTN","RAMAIN5",5,0)
 ; #1995 - CPT calls (supported)
"RTN","RAMAIN5",6,0)
 Q
"RTN","RAMAIN5",7,0)
EN ;MAIN ENTRY POINT
"RTN","RAMAIN5",8,0)
 ; RA*5.0*138 added RAMAIN5I usage
"RTN","RAMAIN5",9,0)
 N RADA,RAIEN,RAPROIEN,DIE,DIC,DA,DR,X,Y,RACONT,RAMATCH,XC,RANOT,RAX,RACODE,RAFN,RAFAC,DUOUT,DIR
"RTN","RAMAIN5",10,0)
 N DTOUT,DUOUT,DIRUT,DIROUT,RATMP,XC2,RAXTMP,DIWF,DIWL,DIWR,RA99,RAWALK,RAMAIN5I
"RTN","RAMAIN5",11,0)
 S RADA="",RACONT="" K ^XTMP("RAMAIN4") S ^XTMP("RAMAIN4",$J,0)=""
"RTN","RAMAIN5",12,0)
LOOK ;LOOK FOR MAPPABLE PROCEDURES
"RTN","RAMAIN5",13,0)
 S RADA=$P($G(^RAMRPF(71.98,1,0)),U,5) S:$G(RADA)="" RADA="" S:$G(RAWALK)="" RAWALK=""
"RTN","RAMAIN5",14,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,4)="Y" W !!?3,"Matching has been completed.",!?3,"Do you want to map exceptions?" S DIR(0)="Y",DIR("B")="NO" D ^DIR G:Y=0 END
"RTN","RAMAIN5",15,0)
 F  W !! S RACODE="",RATMP="",RADA=$O(^RAMIS(71,"B",RADA)) S:RADA="" $P(^RAMRPF(71.98,1,0),U,4)="Y" Q:RADA=""!(RACONT["^")!($G(RAX)="QUIT"&($G(RAWALK)=1))  D
"RTN","RAMAIN5",16,0)
 . S $P(^RAMRPF(71.98,1,0),U,5)=RADA
"RTN","RAMAIN5",17,0)
 . S RAIEN=$O(^RAMIS(71,"B",RADA,"")) Q:RAIEN=""  D  Q:$G(DIRUT)=1
"RTN","RAMAIN5",18,0)
 .. I $P(^RAMIS(71,RAIEN,0),U,6)'="D" Q
"RTN","RAMAIN5",19,0)
 .. I $G(^RAMIS(71,RAIEN,"I"))'=""&($G(^RAMIS(71,RAIEN,"I"))<DT) Q
"RTN","RAMAIN5",20,0)
 .. I $P($G(^RAMIS(71,RAIEN,"NTRT")),U,1)'="" Q
"RTN","RAMAIN5",21,0)
 .. ;I $G(^XTMP("RAMAIN4",$J,"RAEND"))=1 Q
"RTN","RAMAIN5",22,0)
 .. W !!,"PROCEDURE NAME: ",$P(^RAMIS(71,RAIEN,0),U,1)
"RTN","RAMAIN5",23,0)
 .. W !,"CPT CODE: ",$P(^RAMIS(71,RAIEN,0),U,9) S RACPT=$P(^RAMIS(71,RAIEN,0),U,9)
"RTN","RAMAIN5",24,0)
 .. ; RA*5.0*138 added RAMAIN51
"RTN","RAMAIN5",25,0)
 .. S RAMATCH="",DR="900///",RAWALK=1,RAMAIN5I=1
"RTN","RAMAIN5",26,0)
 .. S RAX=$$MRPF() Q:RAX["QUIT"!(RAMATCH="")
"RTN","RAMAIN5",27,0)
 .. S RATMP=$S(RAPROIEN="":"",1:^RAMRPF(71.99,RAPROIEN,0))
"RTN","RAMAIN5",28,0)
 .. S DR=DR_$P(RATMP,U,1)_";903///"_$P(RATMP,U,4) D:$G(^XTMP("RAMAIN4",$J,"RAEND"))=""
"RTN","RAMAIN5",29,0)
 ... S DIE="^RAMIS(71,",DA=RAIEN
"RTN","RAMAIN5",30,0)
 ... Q:$G(X)=""
"RTN","RAMAIN5",31,0)
 ... Q:$G(X)="NONE LISTED"
"RTN","RAMAIN5",32,0)
 ... Q:$G(Y(0))="NONE LISTED"
"RTN","RAMAIN5",33,0)
 ... D ^DIE W !!,"MATCH MADE",! K X,Y Q
"RTN","RAMAIN5",34,0)
 ... Q
"RTN","RAMAIN5",35,0)
 .. ; RA*5.0*138 added RAMAIN5I check
"RTN","RAMAIN5",36,0)
 .. I $G(Y(0))="NONE LISTED" D:$G(RAMAIN5I)'=1 MSG
"RTN","RAMAIN5",37,0)
 .. K DIR W ! S RACONT="" S DIR(0)="F^1:8",DIR("A")="Hit <RETURN> to continue or '^' to quit.",DIR("B")="Continue" D ^DIR S RACONT=Y
"RTN","RAMAIN5",38,0)
 .. Q
"RTN","RAMAIN5",39,0)
 . Q
"RTN","RAMAIN5",40,0)
 ;G:RACONT="Continue" EN
"RTN","RAMAIN5",41,0)
 I RACONT["^" K RAWALK G END
"RTN","RAMAIN5",42,0)
 I $D(DUOUT) K RAWALK G END
"RTN","RAMAIN5",43,0)
MRPF() ;FIND POSSIBLE MATCHES BY CPT
"RTN","RAMAIN5",44,0)
MRPF2 ;SECOND ENTRY POINT
"RTN","RAMAIN5",45,0)
 N RACINF
"RTN","RAMAIN5",46,0)
 Q:$G(RACPT)="" RAMATCH=""
"RTN","RAMAIN5",47,0)
 S RACODE="",RAPROIEN="",I=0 K XC,XC2
"RTN","RAMAIN5",48,0)
 S:$G(RAPROIEN)="" RAPROIEN="" F I=1:1 S RAPROIEN=$O(^RAMRPF(71.99,"C",RACPT,RAPROIEN)) D:'$D(^RAMRPF(71.99,"C",RACPT)) MSG Q:RAPROIEN=""  D ACTIVE^RAUTL23 D:$G(RA99)'="INACTIVE"
"RTN","RAMAIN5",49,0)
 . ; RA*5.0*138 change '/' to '~'
"RTN","RAMAIN5",50,0)
 .S:$G(RACODE)="" RACODE="" S RACINF=$$CPT^ICPTCOD(RACPT),RACODE=RACODE_I_":"_$P(^RAMRPF(71.99,RAPROIEN,0),U,1)_"~"_$P(RACINF,"^",3)_";",^XTMP("RAMAIN4",$J,I)=RAPROIEN
"RTN","RAMAIN5",51,0)
 . Q
"RTN","RAMAIN5",52,0)
 K RACINF
"RTN","RAMAIN5",53,0)
 S RACODE=$G(RACODE)_$S($G(I)'="":I,1:1)_":NONE LISTED",RANOT=$S($G(I)'="":I,1:1)
"RTN","RAMAIN5",54,0)
 Q:$G(RACODE)="" $G(RAMATCH)
"RTN","RAMAIN5",55,0)
MRPF3 K XC,XC2  ;LOOP POINT
"RTN","RAMAIN5",56,0)
 K DIR,DIE S DIR(0)="S^"_RACODE_"^",DIR("A",1)="Select the number of the Master Procedure that best matches",DIR("A")="or enter a number followed by'C' for the long name. e.g. 1C"
"RTN","RAMAIN5",57,0)
 S DIR("PRE")="I X["_"""C"""_" S X=+X,XC=1"
"RTN","RAMAIN5",58,0)
 D ^DIR G:$D(DUOUT) MEND G:Y["^"!(X["^") END S RAPLUSY=+Y I $G(XC)=1 D
"RTN","RAMAIN5",59,0)
 . S ^XTMP("RAMAIN4",$J,"C")=$G(RACPT)_U_RACODE_U_$G(RAMATCH)_U_RAPROIEN_U_$G(XC)_U_RANOT_U_RAPLUSY,XC2=1
"RTN","RAMAIN5",60,0)
 . I Y(0)["NONE LISTED" S XC2=XC Q
"RTN","RAMAIN5",61,0)
 . S RAMATCH=$P(RACODE,";",+Y),RAMATCH=$P(RAMATCH,":",2),RAPLUSY=+Y
"RTN","RAMAIN5",62,0)
 . S ^XTMP("RAMAIN4",$J,"C")=$G(RACPT)_U_RACODE_U_RAMATCH_U_RAPROIEN_U_XC_U_RANOT_U_RAPLUSY
"RTN","RAMAIN5",63,0)
 . I $P(^XTMP("RAMAIN4",$J,"C"),U,2)="1:NON LISTED" S XC2=1 Q
"RTN","RAMAIN5",64,0)
 . K ^UTILITY($J,"W") S DIWL=10,DIWR=70,DIWF="WC60"
"RTN","RAMAIN5",65,0)
 . S RAPRO1=^XTMP("RAMAIN4",$J,+Y),RAPLUSY=+Y
"RTN","RAMAIN5",66,0)
 . S X1=0 F  S X1=$O(^RAMRPF(71.99,RAPRO1,1,X1)) Q:X1=""  D
"RTN","RAMAIN5",67,0)
 .. S X=^RAMRPF(71.99,RAPRO1,1,X1,0) D ^DIWP
"RTN","RAMAIN5",68,0)
 .. Q
"RTN","RAMAIN5",69,0)
 . D ^DIWW
"RTN","RAMAIN5",70,0)
 . W !?3,"Enter <RETURN> to continue:" R X:600 Q
"RTN","RAMAIN5",71,0)
 I $G(XC2)=1 S RAXTMP=^XTMP("RAMAIN4",$J,"C") D
"RTN","RAMAIN5",72,0)
 . S RACPT=$P(RAXTMP,U,1),RACODE=$P(RAXTMP,U,2),RAMATCH=$P(RAXTMP,U,3),RAPROIEN=$P(RAXTMP,U,4),XC=$P(RAXTMP,U,5),RANOT=$P(RAXTMP,U,7),(RAPLUSY,Y)=$P(RAXTMP,U,8) S I=""
"RTN","RAMAIN5",73,0)
 G:$G(XC2)=1 MRPF3 S:$G(Y)'=$G(RANOT) RAMATCH=$P(RACODE,";",RAPLUSY),RAMATCH=$P(RAMATCH,":",2)
"RTN","RAMAIN5",74,0)
 I RACODE'="1:NONE LISTED"&(Y(0)'="NONE LISTED") S:$G(RAPROIEN)="" RAPROIEN=^XTMP("RAMAIN4",$J,+Y)
"RTN","RAMAIN5",75,0)
 I $G(RACODE)["1:NONE LISTED"!($G(Y(0))["NONE LISTED") S RAX="QUIT",RAMATCH="",RAWALK=0 G MEND
"RTN","RAMAIN5",76,0)
 I $G(RAPROIEN)'="",$D(^RAMIS(71,"MRPF",$S($G(RAPROIEN)'="":RAPROIEN,1:0))) S RAMTCH=2 D:RAMATCH'="GO" MTCH^RAUTL23
"RTN","RAMAIN5",77,0)
 ; RA*5.0*138 change '/' to '~'
"RTN","RAMAIN5",78,0)
 S:+Y'=RANOT RAMATCH=$P(RAMATCH,"~",1) I $P(RACODE,";",Y)'["NONE LISTED" S RAPROIEN=^XTMP("RAMAIN4",$J,+Y)
"RTN","RAMAIN5",79,0)
MEND ;GO HERE WHEN AN UPARROW ENTERED ON A DIR
"RTN","RAMAIN5",80,0)
 ;W !!,X," ",$G(DUOUT,999)," ",$G(RAMATCH,9999)
"RTN","RAMAIN5",81,0)
 I $D(DUOUT) S RAX="QUIT",RAMATCH="" Q RAX
"RTN","RAMAIN5",82,0)
 I $G(RAMATCH)="NONE LISTED" S RAMATCH="" Q
"RTN","RAMAIN5",83,0)
 I $G(RAMATCH)="",$G(Y(0))["NONE LISTED" S RAMATCH="QUIT" Q RAMATCH
"RTN","RAMAIN5",84,0)
 I $G(DUOUT)=1 S RAX="QUIT",RAMATCH="" Q RAMATCH
"RTN","RAMAIN5",85,0)
 S RAMATCH="GO" Q RAMATCH
"RTN","RAMAIN5",86,0)
END ;END ROUTINE
"RTN","RAMAIN5",87,0)
 K RACPT,RACODE,DIR,D,I,%X,%Y,D0,DI,DQ,DIRUT,DUOUT,XMDUN,XMDUZ,XMZ,^XTMP("RAMAIN4"),RALOINC
"RTN","RAMAIN5",88,0)
 K RAPLUSY,RAPRO1,X1,XC,XY,Z,DA,^UTILITY($J,"W"),RAMAIN5I
"RTN","RAMAIN5",89,0)
 K ^XTMP("RAMAIN4",$J),RAMATCH,RAMTCH
"RTN","RAMAIN5",90,0)
 Q
"RTN","RAMAIN5",91,0)
MSG K RACPT,RACODE,DIR,D,I,%X,%Y,D0,DI,DQ,DIRUT,DUOUT
"RTN","RAMAIN5",92,0)
 ; RA*5.0*138 added RAMAIN5I check
"RTN","RAMAIN5",93,0)
 I $G(RAMAIN5I)=1 G END
"RTN","RAMAIN5",94,0)
 I $P($G(^RARMPF(71.98,1,0)),U,10)'="Y" G END
"RTN","RAMAIN5",95,0)
 N XMSUB,XMY,XMTEXT,RATXT
"RTN","RAMAIN5",96,0)
 S RAFAC=$$KSP^XUPARAM("INST"),RAFAC=$$NS^XUAF4(RAFAC)
"RTN","RAMAIN5",97,0)
 S RAFN=$P(RAFAC,U,1),RAFAC=$P(RAFAC,U,2),$P(^RAMIS(71,DA,"NTRT"),U,2)="Y"
"RTN","RAMAIN5",98,0)
 S XMSUB="NEW RADIOLOGY PROCEDURE"
"RTN","RAMAIN5",99,0)
 S XMY(DUZ)=""
"RTN","RAMAIN5",100,0)
 S XMY("G.RADIOLOGY NTRT@FORUM.DOMAIN.EXT")=""
"RTN","RAMAIN5",101,0)
 S XMY("G.NTRT")=""
"RTN","RAMAIN5",102,0)
 S XMDUZ("G.RADNTRT")=""
"RTN","RAMAIN5",103,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,2)'="" S XMY($P(^RAMRPF(71.98,1,0),U,2))=""
"RTN","RAMAIN5",104,0)
 S RATXT(1)="An existing Radiology procedure at "_RAFN
"RTN","RAMAIN5",105,0)
 S RATXT(2)="does not have a match in the MASTER RADIOLOGY PROCEDURE file"
"RTN","RAMAIN5",106,0)
 S RATXT(3)=" "
"RTN","RAMAIN5",107,0)
 S RATXT(4)="Facility Name/number: "_RAFN_" / "_RAFAC
"RTN","RAMAIN5",108,0)
 S RATXT(5)=" "
"RTN","RAMAIN5",109,0)
 S RATXT(6)="Procedure name: "_RADA
"RTN","RAMAIN5",110,0)
 S RATXT(7)=" "
"RTN","RAMAIN5",111,0)
 S RATXT(8)="CPT code: "_$P($G(^RAMIS(71,DA,0)),U,9)
"RTN","RAMAIN5",112,0)
 S RATXT(9)="Local IEN: "_DA
"RTN","RAMAIN5",113,0)
 S RATXT(10)="For questions or notification respond to: "_"G.RADNTRT@"_$$KSP^XUPARAM("WHERE")
"RTN","RAMAIN5",114,0)
 S RATXT(11)="For NTRT results respond to: "_"S.RADNEWPRO@"_$$KSP^XUPARAM("WHERE")
"RTN","RAMAIN5",115,0)
 S $P(^RAMIS(71,DA,"NTRT"),U,3)=DT
"RTN","RAMAIN5",116,0)
 S XMTEXT="RATXT(" D ^XMD
"RTN","RAMAIN5",117,0)
 S $P(^RAMIS(71,DA,"NTRT"),U,3)=DT
"RTN","RAMAIN5",118,0)
 G END
"RTN","RANPRO")
0^1^B121872781^B93138436
"RTN","RANPRO",1,0)
RANPRO ;BPFO/CLT - NEW RADIOLOGY PROCEDURE ; 27 Oct 2016  4:57 PM
"RTN","RANPRO",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**127,138**;Mar 16, 1998;Build 22
"RTN","RANPRO",3,0)
 ;
"RTN","RANPRO",4,0)
EN ; Main entry point - driver for PROCEDURE prompt loop
"RTN","RANPRO",5,0)
 ;
"RTN","RANPRO",6,0)
 N RANQUIT,RANHIT,RADIO,RAMIS,RAPTY,RAIMAG,RA65,RARMPF,RAEXC
"RTN","RANPRO",7,0)
 S RANQUIT=0,RANHIT=0
"RTN","RANPRO",8,0)
 F  Q:$G(RANQUIT)  D EN2
"RTN","RANPRO",9,0)
 I $G(RANHIT) D 22^RAMAIN2
"RTN","RANPRO",10,0)
 Q
"RTN","RANPRO",11,0)
 ;
"RTN","RANPRO",12,0)
EN2 ; Loop entry point for PROCEDURE prompt
"RTN","RANPRO",13,0)
 N RACPT,RADA,RANM,RAPNM,RASEED,RATYP,RAX,RAYY,X,Y,RAMV,RACODE,RANEW,RAP3,RATYPE,I,RA7111DA
"RTN","RANPRO",14,0)
 N RANEW71,ARY,A,B,C,D,E,F,RALRDA,RACMDIFF,RACTIVE,RAENALL,RAFILE,RAY,RAPROC,RASTAT,RATRKCMA,RAXTMPNM
"RTN","RANPRO",15,0)
 N DD,DA,DO,DIC,DIR,DR,RAEND,RACODE1,RAOLDIEN,DIE,RANMSG,RATRKCMB,RADANEW1,RAFOUND,AA,EE
"RTN","RANPRO",16,0)
 N DIK,XX,RADUZ,RAFN,RAINADT,RAS,XMDUN,DTOUT,DUOUT
"RTN","RANPRO",17,0)
 S RANQUIT="",RANMSG="",RAMV=0
"RTN","RANPRO",18,0)
 K ^XTMP("RAMAIN4",$J)
"RTN","RANPRO",19,0)
 S (RANEW,RANEW71,RANQUIT)=0
"RTN","RANPRO",20,0)
 F  D  Q:$G(RAFOUND)!$G(RANQUIT)!$G(RANEW)
"RTN","RANPRO",21,0)
 .K X,Y,RAEND,DIR
"RTN","RANPRO",22,0)
 .S DIR(0)="FUO^1:60",DIR("A",1)=" ",DIR("A")="RAD/NUC MED PROCEDURE NAME"
"RTN","RANPRO",23,0)
 .S DIR("PRE")="S:$D(X) X=$$UP^XLFSTR(X) K:$L(X)>60 X S:$G(X)[""?"" X=-99"
"RTN","RANPRO",24,0)
 .D ^DIR S:Y=-99 (X,Y)="?" S RANM=Y I X=""!(X["^") S RANQUIT=1 Q
"RTN","RANPRO",25,0)
 .S RAPNM=RANM
"RTN","RANPRO",26,0)
 .K Y D SEARCH(RAPNM,.Y)
"RTN","RANPRO",27,0)
 .Q:(Y="")!(Y<0)!(Y="?")
"RTN","RANPRO",28,0)
 .S (RAPNM,RANM)=Y
"RTN","RANPRO",29,0)
 .I $G(Y)>0&$L($P(Y,"^",2)) S RAFOUND=1 D  Q  ; Match found
"RTN","RANPRO",30,0)
 .. I $P(Y,"^",2)]"" S (RAPNM,RANM)=$P(Y,"^",2) M RAYY=Y
"RTN","RANPRO",31,0)
 .I $L($G(Y)) S (RAPNM,RANM)=Y S RAFOUND=1  ; Not found, but something entered, ask if adding new
"RTN","RANPRO",32,0)
 .;
"RTN","RANPRO",33,0)
 .I '$D(^RAMIS(71,"B",RANM))!($G(RANEW)&'$G(RAYY)) S RAMV=3 D
"RTN","RANPRO",34,0)
 .. N Y K DIR S DIR(0)="Y",DIR("A")="Are you adding "_RANM_" as a new Radiology Procedure",DIR("B")="YES" D ^DIR
"RTN","RANPRO",35,0)
 .. I $G(Y)=1 S RANEW=1 Q
"RTN","RANPRO",36,0)
 .. I $G(Y)'=1 S RAMV=2,RANEW=0,RAEND=2
"RTN","RANPRO",37,0)
 ;
"RTN","RANPRO",38,0)
 S RANHIT=1 ; Flag to indicate at least one procedure was entered; ensure validity checker is run before exiting option
"RTN","RANPRO",39,0)
 I ('$G(RANEW)&($G(RAEND)=2))!($G(RAEND)=1) D END Q
"RTN","RANPRO",40,0)
 I $G(RAEND)=1!$G(RANQUIT) D END Q
"RTN","RANPRO",41,0)
TEMP ;ENTER THE TEMPORARY NEW PROCEDURE INTO 71.11
"RTN","RANPRO",42,0)
 I '$G(RANEW) G:$L(RANM) OLD G:'$L(RANM) END
"RTN","RANPRO",43,0)
 G:$G(RAEND) END
"RTN","RANPRO",44,0)
 ; create DA in temp file
"RTN","RANPRO",45,0)
 K DD,DO,DIC,X,Y S DIC="^RAMRPF(71.11,",DIC(0)="L",X=RANM D FILE^DICN
"RTN","RANPRO",46,0)
 I +Y<1 W !!,"Not able to create entry in temporary area" G END
"RTN","RANPRO",47,0)
 S (RADA,RA7111DA)=+Y K ^TMP("RA7111DA",$J) S ^TMP("RA7111DA",$J)=RA7111DA K DIC,X,Y
"RTN","RANPRO",48,0)
 ; do check of name and procedure type"
"RTN","RANPRO",49,0)
 S DIE="^RAMRPF(71.11,",DA=RA7111DA,DR="6" D ^DIE
"RTN","RANPRO",50,0)
 ; If Category was bypassed by entering "^", remove temp entry and quit
"RTN","RANPRO",51,0)
 I $P($G(^RAMRPF(71.11,RADA,0)),"^",6)="" W !,"Nothing Saved" G TD
"RTN","RANPRO",52,0)
 S RACTIVE=$P($G(^RAMPRF(71.11,RADA,"I")),"^"),RASTAT=$S(RACTIVE="":1,RACTIVE>DT:1,1:0)
"RTN","RANPRO",53,0)
 D TRKCMB^RAMAINU(DA,.RATRKCMB) ;tracks existing
"RTN","RANPRO",54,0)
 ; CM definition before editing. RATRKCMB ids the before CM values
"RTN","RANPRO",55,0)
 ;
"RTN","RANPRO",56,0)
 S DIE="^RAMRPF(71.11,",DR="[NEW RAD PROCEDURE]",DA=RA7111DA D ^DIE
"RTN","RANPRO",57,0)
 I $G(Y)="^" W !,"Nothing Saved" G TD
"RTN","RANPRO",58,0)
 S RADA=DA,RACPT=$P(^RAMRPF(71.11,DA,0),U,9)
"RTN","RANPRO",59,0)
 I $G(RA7111DA)="" S RA7111DA=$G(^TMP("RA7111DA",$J))
"RTN","RANPRO",60,0)
 I $P(^RAMRPF(71.11,RA7111DA,0),U,6)'="D" D
"RTN","RANPRO",61,0)
 . W !!,"This procedure was not created as a DETAILED exam and will not be matched",!,"to the MASTER RADIOLOGY PROCEDURE FILE." H 2
"RTN","RANPRO",62,0)
 . Q
"RTN","RANPRO",63,0)
 I $G(RACPT)'="",$P(^RAMRPF(71.11,RA7111DA,0),U,6)="D" I $G(RANEW)=1 D EN^RANPRO4(RADA) G:$G(RANQUIT)=1 TD
"RTN","RANPRO",64,0)
 I $P($G(^RAMRPF(71.11,RA7111DA,0)),U,9)="",$P($G(^RAMRPF(71.11,RA7111DA,0)),U,6)="D" W !!,"No CPT Code has been entered.  This new procedure will be deleted.",*7 G TD
"RTN","RANPRO",65,0)
 S RADA=RA7111DA,RAPROC(0)=$G(^RAMRPF(71.11,RADA,0))
"RTN","RANPRO",66,0)
 S RACTIVE=$P($G(^RAMPRF(71.11,RADA,"I")),"^"),$P(RASTAT,"^",2)=$S(RACTIVE="":1,RACTIVE>DT:1,1:0)
"RTN","RANPRO",67,0)
 ;
"RTN","RANPRO",68,0)
 I RAPROC(0)]"",("^B^P^"'[(U_$P(RAPROC(0),"^",6)_U)),('+$P(RAPROC(0),"^",9)) D  G TD
"RTN","RANPRO",69,0)
 . W !?5,$C(7),"Procedure Type: ",$S($P(RAPROC(0),"^",6)="S":"SERIES",1:"DETAILED")," ...no CPT code entered..."
"RTN","RANPRO",70,0)
 . W !?5,"...will delete the record at this time.",!
"RTN","RANPRO",71,0)
 ;
"RTN","RANPRO",72,0)
MV ;MOVE TEMPORARY ENTRY TO PERMANENT ENTRY
"RTN","RANPRO",73,0)
 ; changes for RA*5.0*138
"RTN","RANPRO",74,0)
 ;S RAP3=$P(^RAMIS(71,0),U,3)+1
"RTN","RANPRO",75,0)
 I $G(RA7111DA)="" S RA7111DA=$G(^TMP("RA7111DA",$J))
"RTN","RANPRO",76,0)
 ;S $P(^RAMIS(71,0),U,3)=RAP3
"RTN","RANPRO",77,0)
 ;S (RADA,RADANEW1)=RAP3
"RTN","RANPRO",78,0)
 ;get 71.11 data
"RTN","RANPRO",79,0)
 K ARY D GETS^DIQ(71.11,RA7111DA_",","**","I","ARY") S AA=RA7111DA_","
"RTN","RANPRO",80,0)
 ;
"RTN","RANPRO",81,0)
 ; use DICN to get next file 71 entry
"RTN","RANPRO",82,0)
 K DIC S DIC="^RAMIS(71,",DA="",X=ARY(71.11,AA,.01,"I"),DIC(0)="L",Y="" I X'="" D FILE^DICN
"RTN","RANPRO",83,0)
 S DA=+Y I DA<1 W !,"Not Able to Create File 71 entry" G TD
"RTN","RANPRO",84,0)
 S (RADA,RAP3,RADANEW1)=DA
"RTN","RANPRO",85,0)
 ;
"RTN","RANPRO",86,0)
 ; place temp file (71.11) data into Procedure file (71)
"RTN","RANPRO",87,0)
 ;
"RTN","RANPRO",88,0)
 S AA=RA7111DA_","
"RTN","RANPRO",89,0)
 K DR S DA=+RADA,DR=".01///"_ARY(71.11,AA,.01,"I"),DIE="^RAMIS(71," D ^DIE
"RTN","RANPRO",90,0)
 ;
"RTN","RANPRO",91,0)
 K DR S DIE="^RAMIS(71,",DR="",DA=+RADA F I=2,3,4,5,6,7,9,11,12,13,17,18,19,20 I $G(ARY(71.11,AA,I,"I"))'="" S:DR'="" DR=DR_";" S DR=DR_I_"///"_$G(ARY(71.11,AA,I,"I"))
"RTN","RANPRO",92,0)
 D ^DIE
"RTN","RANPRO",93,0)
 K DR S DR="",DA=+RADA F I=100,900,901,902,903 I $G(ARY(71.11,AA,I,"I"))'="" S:DR'="" DR=DR_";" S DR=DR_I_"///"_$G(ARY(71.11,AA,I,"I"))
"RTN","RANPRO",94,0)
 D ^DIE
"RTN","RANPRO",95,0)
 ; education description
"RTN","RANPRO",96,0)
 K DR S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",""EDU"",",B=0 F  S B=$O(ARY(71.11,AA,500,B)) Q:'B  D
"RTN","RANPRO",97,0)
 . S C=ARY(71.11,AA,500,B),DA=0,X=C K DIC,DD,DO S DIC=RALRDA,DIC(0)="L" I X'="" D FILE^DICN
"RTN","RANPRO",98,0)
 ; synonym
"RTN","RANPRO",99,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",1," I $D(ARY(71.111)) D
"RTN","RANPRO",100,0)
 . K EE M EE(71.111)=ARY(71.111)
"RTN","RANPRO",101,0)
 . S B="EE(71.111",A=B_")" F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A D
"RTN","RANPRO",102,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="QEAL",X=C I X'="" D FILE^DICN
"RTN","RANPRO",103,0)
 ; descendents
"RTN","RANPRO",104,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",4," I $D(ARY(71.1105)) D
"RTN","RANPRO",105,0)
 . K EE M EE(71.1105)=ARY(71.1105)
"RTN","RANPRO",106,0)
 . S B="EE(71.1105",A=B_")"
"RTN","RANPRO",107,0)
 . F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A I $QS(A,3)=".01" D
"RTN","RANPRO",108,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="L",X=C I X'="" D FILE^DICN Q:+Y<1  S DA=+Y D
"RTN","RANPRO",109,0)
 . . . S DIE=RALRDA,DR=""
"RTN","RANPRO",110,0)
 . . . S D=B_","_$C(34)_$QS(A,2)_$C(34),E=D_")"
"RTN","RANPRO",111,0)
 . . . F  S E=$Q(@E) Q:$E(E,1,$L(D))'=D  S F=@E S:DR'="" DR=DR_";" S DR=DR_$QS(E,3)_"///"_F
"RTN","RANPRO",112,0)
 . . . I DR'="" D ^DIE
"RTN","RANPRO",113,0)
 ; message
"RTN","RANPRO",114,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",3," I $D(ARY(71.12)) D
"RTN","RANPRO",115,0)
 . K EE M EE(71.12)=ARY(71.12)
"RTN","RANPRO",116,0)
 . S B="EE(71.12",A=B_")" F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A D
"RTN","RANPRO",117,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="L",X=C I X'="" D FILE^DICN
"RTN","RANPRO",118,0)
 ; film type
"RTN","RANPRO",119,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",""F""," I $D(ARY(71.1102)) D
"RTN","RANPRO",120,0)
 . K EE M EE(71.1102)=ARY(71.1102)
"RTN","RANPRO",121,0)
 . S B="EE(71.1102",A=B_")" F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A D
"RTN","RANPRO",122,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="L",X=C I X'="" D FILE^DICN
"RTN","RANPRO",123,0)
 ; amis code
"RTN","RANPRO",124,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",2," I $D(ARY(71.1103)) D
"RTN","RANPRO",125,0)
 . K EE M EE(71.1103)=ARY(71.1103)
"RTN","RANPRO",126,0)
 . S B="EE(71.1103",A=B_")"
"RTN","RANPRO",127,0)
 . F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A I $QS(A,3)=".01" D
"RTN","RANPRO",128,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="L",X=C I X'="" D FILE^DICN Q:+Y<1  S DA=+Y D
"RTN","RANPRO",129,0)
 . . . S DIE=RALRDA,DR=""
"RTN","RANPRO",130,0)
 . . . S D=B_","_$C(34)_$QS(A,2)_$C(34),E=D_")"
"RTN","RANPRO",131,0)
 . . . F  S E=$Q(@E) Q:$E(E,1,$L(D))'=D  S F=@E S:DR'="" DR=DR_";" S DR=DR_$QS(E,3)_"///"_F
"RTN","RANPRO",132,0)
 . . . I DR'="" D ^DIE
"RTN","RANPRO",133,0)
 ; contrast media
"RTN","RANPRO",134,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",""CM""," I $D(ARY(71.11125)) D
"RTN","RANPRO",135,0)
 . K EE M EE(71.11125)=ARY(71.11125)
"RTN","RANPRO",136,0)
 . S B="EE(71.11125",A=B_")" F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A D
"RTN","RANPRO",137,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="L",X=C I X'="" D FILE^DICN
"RTN","RANPRO",138,0)
 ; default cpt modifiers
"RTN","RANPRO",139,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",""DCM""," I $D(ARY(71.11135)) D
"RTN","RANPRO",140,0)
 . K EE M EE(71.11135)=ARY(71.11135)
"RTN","RANPRO",141,0)
 . S B="EE(71.11135",A=B_")" F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A D
"RTN","RANPRO",142,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="L",X=C I X'="" D FILE^DICN
"RTN","RANPRO",143,0)
 ; default medications
"RTN","RANPRO",144,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",""P""," I $D(ARY(71.1155)) D
"RTN","RANPRO",145,0)
 . K EE M EE(71.1155)=ARY(71.1155)
"RTN","RANPRO",146,0)
 . S B="EE(71.1155",A=B_")"
"RTN","RANPRO",147,0)
 . F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A I $QS(A,3)=".01" D
"RTN","RANPRO",148,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="L",X=C I X'="" D FILE^DICN Q:+Y<1  S DA=+Y D
"RTN","RANPRO",149,0)
 . . . S DIE=RALRDA,DR=""
"RTN","RANPRO",150,0)
 . . . S D=B_","_$C(34)_$QS(A,2)_$C(34),E=D_")"
"RTN","RANPRO",151,0)
 . . . F  S E=$Q(@E) Q:$E(E,1,$L(D))'=D  S F=@E S:DR'="" DR=DR_";" S DR=DR_$QS(E,3)_"///"_F
"RTN","RANPRO",152,0)
 . . . I DR'="" D ^DIE
"RTN","RANPRO",153,0)
 ; default radiopharmaceuticals
"RTN","RANPRO",154,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",""NUC""," I $D(ARY(71.1108)) D
"RTN","RANPRO",155,0)
 . K EE M EE(71.1108)=ARY(71.1108)
"RTN","RANPRO",156,0)
 . S B="EE(71.1108",A=B_")"
"RTN","RANPRO",157,0)
 . F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A I $QS(A,3)=".01" D
"RTN","RANPRO",158,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="L",X=C I X'="" D FILE^DICN Q:+Y<1  S DA=+Y D
"RTN","RANPRO",159,0)
 . . . S DIE=RALRDA,DR=""
"RTN","RANPRO",160,0)
 . . . S D=B_","_$C(34)_$QS(A,2)_$C(34),E=D_")"
"RTN","RANPRO",161,0)
 . . . F  S E=$Q(@E) Q:$E(E,1,$L(D))'=D  S F=@E S:DR'="" DR=DR_";" S DR=DR_$QS(E,3)_"///"_F
"RTN","RANPRO",162,0)
 . . . I DR'="" D ^DIE
"RTN","RANPRO",163,0)
 ; modality
"RTN","RANPRO",164,0)
 S DA(1)=RADA,RALRDA="^RAMIS(71,"_DA(1)_",""MDL""," I $D(ARY(71.11731)) D
"RTN","RANPRO",165,0)
 . K EE M EE(71.11731)=ARY(71.11731)
"RTN","RANPRO",166,0)
 . S B="EE(71.11731",A=B_")" F  S A=$Q(@A) Q:$E(A,1,$L(B))'=B  S C=@A D
"RTN","RANPRO",167,0)
 . . K DIC,DD,DO S DA=0,DIC=RALRDA,DIC(0)="L",X=C I X'="" D FILE^DICN
"RTN","RANPRO",168,0)
 ;
"RTN","RANPRO",169,0)
 S (RADA,RADANEW1)=RAP3
"RTN","RANPRO",170,0)
 W !!,"Temporary new procedure entry has been moved to the permanent ",!,"RAD/NUC MED PROCEDURE file." H 1
"RTN","RANPRO",171,0)
 ; make sure indexes are set up.
"RTN","RANPRO",172,0)
 K DA,DIK S DIK="^RAMIS(71,",DA=RADA D IX^DIK K DA,DIK ; populate indexes for (newly created procedure.
"RTN","RANPRO",173,0)
 ;
"RTN","RANPRO",174,0)
 ;tracking items
"RTN","RANPRO",175,0)
 S RAPROC(0)=$G(^RAMIS(71,RADA,0))
"RTN","RANPRO",176,0)
 ;check for data consistency between the 'CONTRAST MEDIA USED' &
"RTN","RANPRO",177,0)
 ;'CONTRAST MEDIA' fields.
"RTN","RANPRO",178,0)
 D CMINTEG^RAMAINU1(RADA,RAPROC(0))
"RTN","RANPRO",179,0)
 D TRKCMA^RAMAINU(RADA,RATRKCMB,.RATRKCMA,.RACMDIFF)
"RTN","RANPRO",180,0)
 I $O(^RAMIS(71,RADA,"NUC",0)),($P(RAPROC(0),"^",2)=1) D DELRADE(RADA)
"RTN","RANPRO",181,0)
 S RACTIVE=$P($G(^RAMIS(71,RADA,"I")),"^"),RASTAT=RASTAT_"^"_$S(RACTIVE="":1,RACTIVE>DT:1,1:0)
"RTN","RANPRO",182,0)
 ;if an active parent w/o descendants, inactivate the parent
"RTN","RANPRO",183,0)
 I $P(RASTAT,U,2),($P(RAPROC(0),U,6)="P"),('$O(^RAMIS(71,RADA,4,0))) D
"RTN","RANPRO",184,0)
  . K D,D0,D1,DA,DI,DIC,DIE,DQ,DR
"RTN","RANPRO",185,0)
  . W !!?5,"Inactivating this parent procedure - no descendents.",!,$C(7)
"RTN","RANPRO",186,0)
  . S DA=RADA,DIE="^RAMIS(71,",DR="100///"_$S($D(DT):DT,1:$$DT^XLFDT())
"RTN","RANPRO",187,0)
  . D ^DIE K D,D0,D1,DA,DI,DIC,DIE,DQ,DR S $P(RASTAT,U,2)=0 ;inactive
"RTN","RANPRO",188,0)
  I $P($G(^RA(79.2,+$P(RAPROC(0),U,12),0)),U,5)="Y",(+$O(^RAMIS(71,RADA,"NUC",0))) D VRDIO(RADA)
"RTN","RANPRO",189,0)
  I "^B^P^"[(U_$P(RAPROC(0),U,6)_U),($P(RAPROC(0),U,9)]"") D
"RTN","RANPRO",190,0)
  . K %,D,D0,DA,DE,DIC,DIE,DQ,DR
"RTN","RANPRO",191,0)
  . S DA=RADA,DIE="^RAMIS(71,",DR="9///@" D ^DIE
"RTN","RANPRO",192,0)
  . W !!?5,"...CPT code deleted because "_$S($P(RAPROC(0),U,6)="B":"Broad",1:"Parent")_" procedures",!?5,"should not have CPT codes.",!,$C(7)
"RTN","RANPRO",193,0)
  . Q
"RTN","RANPRO",194,0)
 ;
"RTN","RANPRO",195,0)
ORDITM ;ORDERABLE ITEM ENTRY
"RTN","RANPRO",196,0)
 W !,"Updating ORDERABLE ITEMS file" ;S RAMSG=RADA,RAMLNB=""
"RTN","RANPRO",197,0)
 ;S ZTREQ="@"
"RTN","RANPRO",198,0)
 K RADA,RAINADT,RASTAT,RAFILE,RAY,RAENALL
"RTN","RANPRO",199,0)
 ; update orderable file for newly created procedure
"RTN","RANPRO",200,0)
 S RADA=RADANEW1,RAINADT=$P($G(^RAMIS(71,RADA,"I")),"^")
"RTN","RANPRO",201,0)
 S RASTAT="1^"_$S(RAINADT="":1,RAINADT>DT:1,1:0)
"RTN","RANPRO",202,0)
 ;S RASTAT="1^1"
"RTN","RANPRO",203,0)
 S RAENALL=0,RAY=RADA,RAFILE=71
"RTN","RANPRO",204,0)
 S $P(RAY,"^",2)=$P($G(^RAMIS(71,RADA,0)),"^",1)
"RTN","RANPRO",205,0)
 D:$$ORQUIK^RAORDU()=1 PROC^RAO7MFN(RAENALL,RAFILE,RASTAT,RAY)
"RTN","RANPRO",206,0)
 ;D PROC^RAO7MFN(RAENALL,RAFILE,RASTAT,RAY)
"RTN","RANPRO",207,0)
 I $G(RANMSG)=1 D MSGRAN^RANPRO4(RADA)
"RTN","RANPRO",208,0)
 K RADA,RAINADT,RASTAT,RAFILE,RAY,RAENALL
"RTN","RANPRO",209,0)
 ;
"RTN","RANPRO",210,0)
TD ;DELETE THE TEMPORARY FILE ENTRY
"RTN","RANPRO",211,0)
 W !,"Deleting temporary entry in file 71.11"
"RTN","RANPRO",212,0)
 I $G(RA7111DA)="" S RA7111DA=$G(^TMP("RA7111DA",$J))
"RTN","RANPRO",213,0)
 I RA7111DA>0 D
"RTN","RANPRO",214,0)
 . K DIK S DIK="^RAMRPF(71.11,",DA=RA7111DA D ^DIK K DIK
"RTN","RANPRO",215,0)
 . K ^RAMRPF(71.11,"CREAT",DT,DA)
"RTN","RANPRO",216,0)
 K ^TMP("RA7111DA",$J)
"RTN","RANPRO",217,0)
 ;
"RTN","RANPRO",218,0)
 ;D 22^RAMAIN2
"RTN","RANPRO",219,0)
 ;
"RTN","RANPRO",220,0)
END ;ROUTINE END
"RTN","RANPRO",221,0)
 K RACPT,RADA,RANM,RAPNM,RASEED,RATYP,RAX,RAYY,X,Y,RAMV,RACODE,RANEW,RAP3,RATYPE,I,RA7111DA
"RTN","RANPRO",222,0)
 K RANEW71,ARY,A,B,C,D,E,F,RALRDA,RACMDIFF,RACTIVE,RAENALL,RAFILE,RAY,RAPROC,RASTAT,RATRKCMA,RAXTMPNM
"RTN","RANPRO",223,0)
 K DD,DA,DO,DIC,DIR,DR,RAEND,RACODE1,RAOLDIEN,DIE,RANMSG,RATRKCMB,RADANEW1,RAFOUND,AA,EE
"RTN","RANPRO",224,0)
 K DIK,XX,RADUZ,RAFN,RAINADT,RAS,XMDUN,DTOUT,DUOUT
"RTN","RANPRO",225,0)
 K ^XTMP("RAMAIN4",$J)
"RTN","RANPRO",226,0)
 Q
"RTN","RANPRO",227,0)
 ;
"RTN","RANPRO",228,0)
OLD ;EXISTING PROCEDUREX ^%
"RTN","RANPRO",229,0)
 S RANEW=0  ; Make absolutely sure recursive deadlock doesn't occur - 21^RAMAIN2 calls EN^RANPRO. 
"RTN","RANPRO",230,0)
 I $G(RAYY) S (RADA,DA)=+RAYY
"RTN","RANPRO",231,0)
 I '$G(RAYY) S DIC="^RAMIS(71,",X=RANM D ^DIC S (RADA,DA)=+Y,RAYY=Y
"RTN","RANPRO",232,0)
 D 21^RAMAIN2
"RTN","RANPRO",233,0)
 G END
"RTN","RANPRO",234,0)
 ;
"RTN","RANPRO",235,0)
VRDIO(RADA) ; Validate the 'Usual Dose' field within the 'Default Radiopha-
"RTN","RANPRO",236,0)
 ; rmaceuticals' multiple.  'Usual Dose' must fall within the 'Low Adult
"RTN","RANPRO",237,0)
 ; Dose' & 'High Adult Dose' range.  This subroutine will display the
"RTN","RANPRO",238,0)
 ; Radiopharmaceutical in question along with the values in question if
"RTN","RANPRO",239,0)
 ; inconsistencies are found.
"RTN","RANPRO",240,0)
 ;
"RTN","RANPRO",241,0)
 ; Input Variable: 'RADA' the ien of the Procedure
"RTN","RANPRO",242,0)
 N RANUC S RADA(1)=RADA,RADA=0 D EN^DDIOL("","","!")
"RTN","RANPRO",243,0)
 F  S RADA=$O(^RAMIS(71,RADA(1),"NUC",RADA)) Q:RADA'>0  D
"RTN","RANPRO",244,0)
 . S RANUC(0)=$G(^RAMIS(71,RADA(1),"NUC",RADA,0))
"RTN","RANPRO",245,0)
 . Q:$P(RANUC(0),"^",2)=""  ; no need to validate, nothing input
"RTN","RANPRO",246,0)
 . I '$$USUAL^RADD2(.RADA,$P(RANUC(0),"^",2)) D
"RTN","RANPRO",247,0)
 .. N RARRY S RARRY(1)="For Radiopharmaceutical: "
"RTN","RANPRO",248,0)
 .. S RARRY(1)=RARRY(1)_$$EN1^RAPSAPI(+$P(RANUC(0),"^"),.01)_$C(7)
"RTN","RANPRO",249,0)
 .. S RARRY(2)="" D EN^DDIOL(.RARRY,"")
"RTN","RANPRO",250,0)
 .. Q
"RTN","RANPRO",251,0)
 . Q
"RTN","RANPRO",252,0)
 S RADA=RADA(1) K RADA(1)
"RTN","RANPRO",253,0)
 Q
"RTN","RANPRO",254,0)
 ;
"RTN","RANPRO",255,0)
DELRADE(RADA) ; Delete the Default Radiopharmaceuticals multiple 
"RTN","RANPRO",256,0)
 N RADA1 S RADA1=0
"RTN","RANPRO",257,0)
 W !!?3,"Deleting default radiopharmaceuticals for this procedure...",!
"RTN","RANPRO",258,0)
 F  S RADA1=$O(^RAMIS(71,RADA,"NUC",RADA1)) Q:RADA1'>0  D
"RTN","RANPRO",259,0)
 . K %,%X,%Y,D,D0,DA,DI,DIC,DIE,DQ,DR,X,Y
"RTN","RANPRO",260,0)
 . S DA(1)=RADA,DA=RADA1,DIE="^RAMIS(71,"_RADA_",""NUC"","
"RTN","RANPRO",261,0)
 . S DR=".01///@" D ^DIE
"RTN","RANPRO",262,0)
 . Q
"RTN","RANPRO",263,0)
 K %,%X,%Y,D,D0,DA,DI,DIC,DIE,DQ,DR,X,Y
"RTN","RANPRO",264,0)
 Q
"RTN","RANPRO",265,0)
 ;
"RTN","RANPRO",266,0)
SEARCH(RAINPUT,RAOUTPUT) ; Search file 71 for RAINPUT
"RTN","RANPRO",267,0)
 ; INPUT  : RAINPUT  = Input value to use in search of file 71
"RTN","RANPRO",268,0)
 ; OUTPUT : RAOUTPUT = Y array, from ^DIC, of entry selected from file 71
"RTN","RANPRO",269,0)
 ;
"RTN","RANPRO",270,0)
 I $G(RAINPUT)="" D END Q
"RTN","RANPRO",271,0)
 N RAFILE,X,Y,DD,DIC,DINUM,DLAYGO,DO,RAY,DTOUT,DUOUT
"RTN","RANPRO",272,0)
 S (RAENALL,RANEW71)=0
"RTN","RANPRO",273,0)
 S (X,RAOUTPUT)=$G(RAINPUT)
"RTN","RANPRO",274,0)
 S DIC="^RAMIS(71,",DIC(0)="MEZ"
"RTN","RANPRO",275,0)
 W ! D ^DIC
"RTN","RANPRO",276,0)
 ; To replicate legacy lookup, if no entry returned from DIC call:
"RTN","RANPRO",277,0)
 ;    1) If exact or partial match of RAINPUT in ^RAMIS(71,"B", return nothing. Calling routine should re-prompt for procedure.
"RTN","RANPRO",278,0)
 ;    2) If NO exact or partial match of RAINPUT in ^RAMIS(71, return output=RAINPUT, calling routine should prompt to add new.
"RTN","RANPRO",279,0)
 I Y=-1!$G(DUOUT)!$G(DTOUT) D  Q
"RTN","RANPRO",280,0)
 . I $L($G(RAINPUT)) D  Q:Y=""
"RTN","RANPRO",281,0)
 .. I $D(^RAMIS(71,"B",RAINPUT))!($E($O(^RAMIS(71,"B",RAINPUT)),1,$L(RAINPUT))=RAINPUT)!($G(X)="?") S (RAOUTPUT,Y)=""  ; Nothing selected
"RTN","RANPRO",282,0)
 .. I $L($G(X))<3 S (RAOUTPUT,Y)=""
"RTN","RANPRO",283,0)
 . S RAINPUT=$TR($G(RAINPUT),"""","") S (RAOUTPUT,Y)=RAINPUT S (RANEW71,RANEW)=1
"RTN","RANPRO",284,0)
 ;    Exact match found (no user interaction), or selected (user interaction)
"RTN","RANPRO",285,0)
 I +$G(Y)>0 S RAY=+Y
"RTN","RANPRO",286,0)
 I $G(RAY) S (DA)=+Y,RAFILE=71 I DA M RAOUTPUT=Y L +^RAMIS(RAFILE,DA):5 I '$T D  Q
"RTN","RANPRO",287,0)
 . W !?5,"This record is currently being edited by another user."
"RTN","RANPRO",288,0)
 . W !?5,"Try again later!",$C(7)
"RTN","RANPRO",289,0)
 . K RAOUTPUT S RAOUTPUT=""
"RTN","RANPRO",290,0)
 Q
"RTN","RANPRO1")
0^4^B1214199^n/a
"RTN","RANPRO1",1,0)
RANPRO1 ;BPFO/DTG - NEW RADIOLOGY PROCEDURE ; 27 Oct 2016  4:57 PM
"RTN","RANPRO1",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**138**;Mar 16, 1998;Build 22
"RTN","RANPRO1",3,0)
 ;
"RTN","RANPRO1",4,0)
 ; This section of the routine emulates DESC^RAUTL17 for parent and descendents
"RTN","RANPRO1",5,0)
 ;
"RTN","RANPRO1",6,0)
DESC(RAD0,RAY) ; Detemine if a procedure qualifies as a descendent for this
"RTN","RANPRO1",7,0)
 ; parent procedure.  Descendent must be either a detailed or series
"RTN","RANPRO1",8,0)
 ; type procedure, must be of same imaging type of the parent, and must
"RTN","RANPRO1",9,0)
 ; not be inactive.  Called from ^DD(71.1105,.01,0)
"RTN","RANPRO1",10,0)
 ; 'RAD0' ien of parent procedure in file 71.11
"RTN","RANPRO1",11,0)
 ; 'RAY'  ien of pointed to procedure in file 71
"RTN","RANPRO1",12,0)
 ; Returns: 'RA' i.e, 0:invalid procedure, 1:valid procedure
"RTN","RANPRO1",13,0)
 ; RAPARNT: zero node of parent procedure
"RTN","RANPRO1",14,0)
 ; RAPARNT(12): i-type of parent procedure
"RTN","RANPRO1",15,0)
 ; RADESC     : zero node of descendent procedure
"RTN","RANPRO1",16,0)
 ; RADESC("I"): inactivation date (if any) of descendent
"RTN","RANPRO1",17,0)
 ; RADESC(6)  : procedure type of descendent
"RTN","RANPRO1",18,0)
 ; RADESC(12) : i-type of descendent procedure
"RTN","RANPRO1",19,0)
 Q:RAD0'>0!(RAY'>0) 0
"RTN","RANPRO1",20,0)
 Q:'$D(^RAMRPF(71.11,RAD0,0))!('$D(^RAMIS(71,RAY,0))) 0
"RTN","RANPRO1",21,0)
 N RA,RAI,RADESC,RAPARNT S RA=0
"RTN","RANPRO1",22,0)
 S RAPARNT=$G(^RAMRPF(71.11,RAD0,0)),RAPARNT(12)=+$P(RAPARNT,U,12)
"RTN","RANPRO1",23,0)
 S RADESC=$G(^RAMIS(71,RAY,0)),RADESC(6)=$P(RADESC,U,6)
"RTN","RANPRO1",24,0)
 S RADESC(12)=$P(RADESC,U,12)
"RTN","RANPRO1",25,0)
 S RADESC("I")=+$G(^RAMIS(71,RAY,"I"))
"RTN","RANPRO1",26,0)
 S RAI=$S(RADESC("I")=0:1,RADESC("I")>DT:1,1:0)
"RTN","RANPRO1",27,0)
 I RADESC(12)=RAPARNT(12),("^D^S^"[(U_RADESC(6)_U)),(RAI) S RA=1
"RTN","RANPRO1",28,0)
 Q RA
"RTN","RANPRO1",29,0)
 ;
"RTN","RANPRO4")
0^7^B38438908^B38023574
"RTN","RANPRO4",1,0)
RANPRO4 ;BPFO/CLT - RADIOLOGY NEW PROCEDURE UTILITIES ; 27 Oct 2016  4:32 PM
"RTN","RANPRO4",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**127,138**;Mar 16, 1998;Build 22
"RTN","RANPRO4",3,0)
 ;
"RTN","RANPRO4",4,0)
 Q
"RTN","RANPRO4",5,0)
EN(RADA) ;PRIMARY ENTRY POINT
"RTN","RANPRO4",6,0)
 N DIR,RATYPE,RAFAC,RAFN,RACODE,RAGOLD,RAMATCH,RANM,RANOT,RAPLUSY,RAPROIEN,XMDUN,RANEWPRO
"RTN","RANPRO4",7,0)
 N P1,P2,RA901
"RTN","RANPRO4",8,0)
 I $G(DA)'="",$G(RADA)="" S RADA=DA
"RTN","RANPRO4",9,0)
 S RANM=RAPNM,^XTMP("RAMAIN4",$J,"RAEND")=0,RADA=+RADA
"RTN","RANPRO4",10,0)
GOOD ;ACCEPT ENTRY AND ASSIGN CPT
"RTN","RANPRO4",11,0)
 S RATYPE=$P(^RAMRPF(71.11,RADA,0),U,6) D:RATYPE'="D"
"RTN","RANPRO4",12,0)
 .W !!?3,"The type of this exam has been chosen not to be DETAILED.","  An NTRT process",!?3,"will not be initiated.  And no MRPF matching will be performed.",!
"RTN","RANPRO4",13,0)
 .Q
"RTN","RANPRO4",14,0)
 Q:RATYPE'="D"
"RTN","RANPRO4",15,0)
 K DIR,DIR(0),DIR("A"),DIR("B")
"RTN","RANPRO4",16,0)
 I $G(RA7111DA)="" S RA7111DA=$G(^TMP("RA7111DA",$J))
"RTN","RANPRO4",17,0)
 K DIR S DIR(0)="Y",DIR("A")="Are you sure you are entering "_$P(^RAMRPF(71.11,RA7111DA,0),U,1)_" as a new procedure"
"RTN","RANPRO4",18,0)
 ;K DIR S DIR(0)="Y",DIR("A")="Are you sure you are entering "_$P(^RAMRPF(71.11,1,0),U,1)_" as a new procedure"
"RTN","RANPRO4",19,0)
 S RASEED=" " S RASEED=$S($P($G(^RAMRPF(71.98,1,0)),U,10)'="Y":" not ",1:" ")
"RTN","RANPRO4",20,0)
 S DIR("A",1)="This entry will"_RASEED_"be submitted for NTRT processing."
"RTN","RANPRO4",21,0)
 S DIR("B")="YES"
"RTN","RANPRO4",22,0)
 W ! D ^DIR S:Y=0 ^XTMP("RAMAIN4",$J,"RAEND")=1 G:^XTMP("RAMAIN4",$J,"RAEND")=1 END
"RTN","RANPRO4",23,0)
CPTEN ;Enter the CPT code
"RTN","RANPRO4",24,0)
 I $G(RAX)="QUIT"!(X["^") G END
"RTN","RANPRO4",25,0)
 W !!,"The CPT code is needed to match to an entry within the MASTER",!,"RADIOLOGY PROCEDURE file."
"RTN","RANPRO4",26,0)
 I $G(RACPT)'="" W !!,"The CPT code for this procedure is ",RACPT,"."
"RTN","RANPRO4",27,0)
 I $G(RACPT)="" K DIR S DIR(0)="71,9^^",DIR("A")="Enter the CPT code for this procedure, if the CPT code is known"
"RTN","RANPRO4",28,0)
 I $G(RACPT)="" K DIRUT,DIROUT,DUOUT W ! D ^DIR I $G(DIRUT)=1  G END
"RTN","RANPRO4",29,0)
 S:X>0 $P(^RAMRPF(71.11,RADA,0),U,9)=X,RACPT=X
"RTN","RANPRO4",30,0)
 S DA=RADA D MRPF^RANPRO5 S RAGOLD=RAMATCH
"RTN","RANPRO4",31,0)
 I $D(DUOUT)!($G(Y(0))="")!($G(RANQUIT)=1) W !!,*7,"No MRPF match made.",!! G END
"RTN","RANPRO4",32,0)
 I $G(RAPROIEN)'="",($G(RANQUIT)'=1),$D(^RAMIS(71,"MRPF",$S($G(RAPROIEN)'="":RAPROIEN,1:0))) S RAMTCH=1 D MTCH^RANPROU2
"RTN","RANPRO4",33,0)
 G:$G(RANQUIT)=1 END
"RTN","RANPRO4",34,0)
 ; RA*5.0*138 corrected set value of 900, added check for active NTRT on 903 set
"RTN","RANPRO4",35,0)
 I Y(0)'["NONE LISTED" S DA=RADA,DIE="^RAMRPF(71.11,",DIE(0)="L",DR="900///"_RAPROIEN_";902///"_DT_";903///"_($S($P($G(^RAMRPF(71.98,1,0)),U,10)'="Y":"",1:$P($G(^RAMRPF(71.99,RAPROIEN,0)),U,4))) S DA=RADA D ^DIE D
"RTN","RANPRO4",36,0)
 . I $G(RAPROIEN)'="" W !?3,"You have mapped this procedure to "_$P($G(^RAMRPF(71.99,RAPROIEN,0)),U,1) Q
"RTN","RANPRO4",37,0)
 I $G(Y(0))["NONE LISTED" D
"RTN","RANPRO4",38,0)
 . ; RA*5.0*138 change RAMIS(71 to RAMRPF(71.11
"RTN","RANPRO4",39,0)
 . S DA=RADA,DIE="^RAMRPF(71.11,",DIE(0)="L"
"RTN","RANPRO4",40,0)
 . S DR="901///" S RA901=$S($P($G(^RAMRPF(71.98,1,0)),U,10)="Y":"Y",1:"")
"RTN","RANPRO4",41,0)
 . S DR=DR_RA901_";902///"_DT D ^DIE
"RTN","RANPRO4",42,0)
 . Q
"RTN","RANPRO4",43,0)
 ; RA*5.0*138 remove hard set of indexes
"RTN","RANPRO4",44,0)
 ;S $P(^RAMRPF(71.11,RADA,"NTRT"),U,3)=DT,^RAMRPF(71.11,"CREAT",DT,RADA)=""
"RTN","RANPRO4",45,0)
 ;I $P($G(^RAMRPF(71.98,1,0)),U,10)'="Y" S $P(^RAMRPF(71.11,RADA,"NTRT"),U,3)=""
"RTN","RANPRO4",46,0)
MSG ;SEND A MESSAGE TO GATEKEEPER
"RTN","RANPRO4",47,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,10)'="Y" Q RADA
"RTN","RANPRO4",48,0)
 N XMSUB,XMY,XMTEXT,RATXT Q:$P($G(^RAMRPF(71.11,RADA,"NTRT")),U,1)'="" RADA
"RTN","RANPRO4",49,0)
 S XMSUB="NEW RADIOLOGY PROCEDURE"
"RTN","RANPRO4",50,0)
 S XMY(DUZ)=""
"RTN","RANPRO4",51,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,2)'="" S XMY($P(^RAMRPF(71.98,1,0),U,2))=""
"RTN","RANPRO4",52,0)
 S RATXT(1)="A new Radiology procedure has been entered."
"RTN","RANPRO4",53,0)
 S RATXT(3)="This procedure will be submitted for NTRT processing."
"RTN","RANPRO4",54,0)
 S RATXT(4)=" "
"RTN","RANPRO4",55,0)
 S RATXT(5)=" "
"RTN","RANPRO4",56,0)
 ;S RATXT(7)=" "
"RTN","RANPRO4",57,0)
 I $G(RA7111DA)="" S RA7111DA=$G(^TMP("RA7111DA",$J))
"RTN","RANPRO4",58,0)
 S RATXT(7)="Procedure Name: "_$P(^RAMRPF(71.11,RA7111DA,0),U,1)
"RTN","RANPRO4",59,0)
 ;S RATXT(7)="Procedure Name: "_$P(^RAMRPF(71.11,1,0),U,1)
"RTN","RANPRO4",60,0)
 S RATXT(8)="CPT: "_$P($G(^RAMRPF(71.11,RADA,0)),U,9)
"RTN","RANPRO4",61,0)
 S XMTEXT="RATXT(" D ^XMD
"RTN","RANPRO4",62,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,10)'="Y" Q RADA
"RTN","RANPRO4",63,0)
 Q:$P($G(^RAMRPF(71.11,RADA,"NTRT")),U,1)'="" RADA
"RTN","RANPRO4",64,0)
 S RANMSG=1
"RTN","RANPRO4",65,0)
 G END
"RTN","RANPRO4",66,0)
MSG1 ;MESSAGE TO NTRT
"RTN","RANPRO4",67,0)
 ;I $P($G(^RAMRPF(71.98,1,0)),U,10)'="Y" Q RADA
"RTN","RANPRO4",68,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,10)'="Y" Q
"RTN","RANPRO4",69,0)
 ;N XMSUB,XMY,XMTEXT,RATXT Q:$P($G(^RAMIS(71,RADA,"NTRT")),U,1)'="" RADA
"RTN","RANPRO4",70,0)
 N XMSUB,XMY,XMTEXT,RATXT,XMDUN,XMDUZ,XMZ,RAFAC,RAFN
"RTN","RANPRO4",71,0)
 I $P($G(^RAMIS(71,RADA,"NTRT")),U,1)'="" Q
"RTN","RANPRO4",72,0)
 S RAFAC=$$KSP^XUPARAM("INST"),RAFAC=$$NS^XUAF4(RAFAC)
"RTN","RANPRO4",73,0)
 ;S RAFN=$P(RAFAC,U,1),RAFAC=$P(RAFAC,U,2),$P(^RAMRPF(71.11,RADA,"NTRT"),U,2)="Y"
"RTN","RANPRO4",74,0)
 N DA,DIE,DR S DIE="^RAMIS(71,",DR="901///Y",DA=RADA D ^DIE K DA,DIE,DR
"RTN","RANPRO4",75,0)
 S RAFN=$P(RAFAC,U,1),RAFAC=$P(RAFAC,U,2)
"RTN","RANPRO4",76,0)
 ;S RAFN=$P(RAFAC,U,1),RAFAC=$P(RAFAC,U,2),$P(^RAMIS(71,RADA,"NTRT"),U,2)="Y"
"RTN","RANPRO4",77,0)
 S XMSUB="NEW RADIOLOGY PROCEDURE"
"RTN","RANPRO4",78,0)
 S XMY("G.RADIOLOGY NTRT@FORUM.DOMAIN.EXT")=""
"RTN","RANPRO4",79,0)
 S XMY("G.RADNTRT")=""
"RTN","RANPRO4",80,0)
 S XMDUZ("G.RADNTRT")=""
"RTN","RANPRO4",81,0)
 S XMY(DUZ)=""
"RTN","RANPRO4",82,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,2)'="" S XMY($P(^RAMRPF(71.98,1,0),U,2))=""
"RTN","RANPRO4",83,0)
 ;S XMY("G.RADIOLOGY NTRT@FORUM.DOMAIN.EXT")=""
"RTN","RANPRO4",84,0)
 S RATXT(1)="A new Radiology procedure has been entered at "_RAFN
"RTN","RANPRO4",85,0)
 S RATXT(2)=" "
"RTN","RANPRO4",86,0)
 S RATXT(3)="Facility Name/number: "_RAFN_" / "_RAFAC
"RTN","RANPRO4",87,0)
 S RATXT(4)=" "
"RTN","RANPRO4",88,0)
 I $G(RA7111DA)="" S RA7111DA=$G(^TMP("RA7111DA",$J))
"RTN","RANPRO4",89,0)
 S RATXT(5)="Procedure name: "_$P(^RAMIS(71,RADA,0),U,1)
"RTN","RANPRO4",90,0)
 ;S RATXT(5)="Procedure name: "_$P(^RAMRPF(71.11,RA7111DA,0),U,1)
"RTN","RANPRO4",91,0)
 ;S RATXT(5)="Procedure name: "_$P(^RAMRPF(71.11,1,0),U,1)
"RTN","RANPRO4",92,0)
 S RATXT(6)=" "
"RTN","RANPRO4",93,0)
 S RATXT(7)="CPT code: "_$P($G(^RAMIS(71,RADA,0)),U,9)
"RTN","RANPRO4",94,0)
 ;S RATXT(7)="CPT code: "_$P($G(^RAMRPF(71.11,RADA,0)),U,9)
"RTN","RANPRO4",95,0)
 S RATXT(8)="Local IEN: "_RADA
"RTN","RANPRO4",96,0)
 S RATXT(9)="For questions or notification respond to: "_"G.RADNTRT@"_$$KSP^XUPARAM("WHERE")
"RTN","RANPRO4",97,0)
 S RATXT(10)="For NTRT results respond to: "_"S.RANEWPRO@"_$$KSP^XUPARAM("WHERE")
"RTN","RANPRO4",98,0)
 ;I $P($G(^RAMRPF(71.98,1,0)),U,9)="Y" D XML G END
"RTN","RANPRO4",99,0)
 S $P(^RAMIS(71,RADA,"NTRT"),U,4)=DT
"RTN","RANPRO4",100,0)
 ;S $P(^RAMRPF(71.11,RADA,"NTRT"),U,4)=DT
"RTN","RANPRO4",101,0)
 S XMTEXT="RATXT(" D ^XMD
"RTN","RANPRO4",102,0)
 ;S $P(^RAMIS(71,RADA,"NTRT"),U,4)=DT
"RTN","RANPRO4",103,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,9)="Y" D XML
"RTN","RANPRO4",104,0)
 K XMSUB,XMY,XMTEXT,RATXT,XMDUN,XMDUZ,XMZ,RAFAC,RAFN
"RTN","RANPRO4",105,0)
 Q
"RTN","RANPRO4",106,0)
 ;
"RTN","RANPRO4",107,0)
XML ; NTRT message for ISAAC
"RTN","RANPRO4",108,0)
 ; Need P1 ISAAC SCHEMA NAME
"RTN","RANPRO4",109,0)
 ; Need P2 ISAAC SCHEMA PATH
"RTN","RANPRO4",110,0)
 ; get the schemea name and the schema path
"RTN","RANPRO4",111,0)
 N P1,P2,A,C
"RTN","RANPRO4",112,0)
 S P1=$$GET1^DIQ(71.98,"1,",11.6)
"RTN","RANPRO4",113,0)
 S P2=$$GET1^DIQ(71.98,"1,",7)
"RTN","RANPRO4",114,0)
 S A=$TR(P1,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","RANPRO4",115,0)
 I P1'=""&($E(A,($L(A)-4),$L(A)))'=".XSD" S P1=P1_".XSD"
"RTN","RANPRO4",116,0)
 I P2'="" D  ;<
"RTN","RANPRO4",117,0)
 . I $E(P2,1,2)'="//" S P2="//"_P2
"RTN","RANPRO4",118,0)
 . I $E(P2,$L(P2))="/" S P2=P2_$E(P2,1,($L(P2)-1))
"RTN","RANPRO4",119,0)
 S A="uri:"_P2_P1
"RTN","RANPRO4",120,0)
 S XMSUB="NEW RADIOLOGY PROCEDURE"
"RTN","RANPRO4",121,0)
 K RATXT
"RTN","RANPRO4",122,0)
 S RATXT(1)=$$XMLHDR^MXMLUTL()
"RTN","RANPRO4",123,0)
 S RATXT(2)="<DATAEXTRACTS xmlns="""_A_""" xmlns:xsi=""http://www.w3.org/2001/XMLSchema-instance"""
"RTN","RANPRO4",124,0)
 S RATXT(3)=">"
"RTN","RANPRO4",125,0)
 S RATXT(4)="<RAD_NTRT>"
"RTN","RANPRO4",126,0)
 S RATXT(5)="<Facility_Name/number>"_RAFN_" / "_RAFAC_"</Facility_Name/number>"
"RTN","RANPRO4",127,0)
 S RATXT(6)="<Facility_Group_e-mail>"_"G.RADNTRT@"_$$KSP^XUPARAM("WHERE")_"</Facility_Group_e-mail>"
"RTN","RANPRO4",128,0)
 S RATXT(7)="<Procedure_name>"_RANM_"</Procedure_name>"
"RTN","RANPRO4",129,0)
 S RATXT(8)="<CPT_code>"_$P($G(^RAMIS(71,RADA,0)),U,9)_"</CPT_code>"
"RTN","RANPRO4",130,0)
 ;S RATXT(8)="<CPT_code>"_$P($G(^RAMRPF(71.11,RADA,0)),U,9)_"</CPT_code>"
"RTN","RANPRO4",131,0)
 S RATXT(9)="<Local_IEN>"_RADA_"</Local_IEN>"
"RTN","RANPRO4",132,0)
 S RATXT(10)="<NTRT_results_response_e-mail>"_"S.RANEWPRO@"_$$KSP^XUPARAM("WHERE")_"</NTRT_results_response_e-mail>"
"RTN","RANPRO4",133,0)
 S RATXT(11)="</RAD_NTRT>"
"RTN","RANPRO4",134,0)
 S RATXT(12)="</DATAEXTRACTS>"
"RTN","RANPRO4",135,0)
 S RAXTMPNM=XMSUB
"RTN","RANPRO4",136,0)
 ;D XMLSND^RAXMLSND(RAXTMPNM)
"RTN","RANPRO4",137,0)
 N RADUZ,RA71IEN,RAS
"RTN","RANPRO4",138,0)
 S RADUZ=DUZ,RA71IEN=RADA,RAS=""
"RTN","RANPRO4",139,0)
 D EN^RAXMLSND
"RTN","RANPRO4",140,0)
 K RADUZ,RA71IEN,RAS,RATXT
"RTN","RANPRO4",141,0)
 Q
"RTN","RANPRO4",142,0)
 ;
"RTN","RANPRO4",143,0)
DEACT ;BLOCK INACTIVATION DATE
"RTN","RANPRO4",144,0)
 Q
"RTN","RANPRO4",145,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,3)'="" D
"RTN","RANPRO4",146,0)
 . S X1=DT,X2=$P(^RAMRPF(71.98,1,0),U,3)
"RTN","RANPRO4",147,0)
 . D C^%DTC
"RTN","RANPRO4",148,0)
 . S ^RAMRPF(71.11,RADA,"I")=X,$P(^RAMRPF(71.11,RADA,"NTRT"),U,2)="Y"
"RTN","RANPRO4",149,0)
 Q
"RTN","RANPRO4",150,0)
END ;KILL LOCAL VARIABLES AND END
"RTN","RANPRO4",151,0)
 K RATXT,XMZ,XMDUN,XMDUZ,X,Y
"RTN","RANPRO4",152,0)
 Q $G(RANEWPRO)
"RTN","RANPRO4",153,0)
 ;
"RTN","RANPRO4",154,0)
MSGRAN(RADA) ; entry from RANPRO after file to 71 to send NTRT message
"RTN","RANPRO4",155,0)
 G MSG1
"RTN","RANPRO5")
0^6^B39057526^B42155834
"RTN","RANPRO5",1,0)
RANPRO5 ;BPFO/CLT - RADIOLOGY MAPPING TO MRPF ; 27 Oct 2016  4:28 PM
"RTN","RANPRO5",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**127,138**;Mar 16, 1998;Build 22
"RTN","RANPRO5",3,0)
 ;
"RTN","RANPRO5",4,0)
 ;  This routine uses the following IA's:
"RTN","RANPRO5",5,0)
 ; #1995 - CPT calls (supported)
"RTN","RANPRO5",6,0)
 Q
"RTN","RANPRO5",7,0)
EN ;MAIN ENTRY POINT
"RTN","RANPRO5",8,0)
 N RADA,RAPROIEN,DIE,DIC,DA,DR,X,Y,RACONT,RAMATCH,XC,RANOT,RAX,RACODE,RAFN,RAFAC,DUOUT,DIR
"RTN","RANPRO5",9,0)
 N DTOUT,DUOUT,DIRUT,DIROUT,RATMP,XC2,RAXTMP,DIWF,DIWL,DIWR,RA99,RAIEN
"RTN","RANPRO5",10,0)
 S RADA="",RACONT="" K ^XTMP("RANPRO4") S ^XTMP("RAMAIN4",$J,0)=""
"RTN","RANPRO5",11,0)
LOOK ;LOOK FOR MAPPABLE PROCEDURES
"RTN","RANPRO5",12,0)
 S RADA=$P($G(^RAMRPF(71.98,1,0)),U,5) S:$G(RADA)="" RADA=""
"RTN","RANPRO5",13,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,4)="Y" W !!?3,"Matching has been completed.",!?3,"Do you want to map exceptions?" S DIR(0)="Y",DIR("B")="NO" D ^DIR G:Y=0 END
"RTN","RANPRO5",14,0)
 F  W !! S RACODE="",RATMP="",RADA=$O(^RAMRPF(71.11,"B",RADA)) S:RADA="" $P(^RAMRPF(71.98,1,0),U,4)="Y" Q:RADA=""  Q:RACONT["^"  D
"RTN","RANPRO5",15,0)
 . S $P(^RAMRPF(71.98,1,0),U,5)=RADA
"RTN","RANPRO5",16,0)
 . S RAIEN=$O(^RAMRPF(71.11,"B",RADA,"")) Q:RAIEN=""  D  Q:$G(DIRUT)=1
"RTN","RANPRO5",17,0)
 .. I $P(^RAMRPF(71.11,RAIEN,0),U,6)'="D" Q
"RTN","RANPRO5",18,0)
 .. I $G(^RAMRPF(71.11,RAIEN,"I"))'=""&($G(^RAMRPF(71.11,RAIEN,"I"))<DT) Q
"RTN","RANPRO5",19,0)
 .. I $P($G(^RAMRPF(71.11,RAIEN,"NTRT")),U,1)'="" Q
"RTN","RANPRO5",20,0)
 .. ;I $G(^XTMP("RAMAIN4",$J,"RAEND"))=1 Q
"RTN","RANPRO5",21,0)
 .. K DIR S DIR(0)="71,.01",DIR("A")="LOCAL PROCEDURE NAME",DIR("?")="Enter the procedure name: ",DA=RAIEN D ^DIR
"RTN","RANPRO5",22,0)
 .. I X="^" S RAX="QUIT",RACONT="^" Q
"RTN","RANPRO5",23,0)
 .. ;K DIR,DIRUT S DIR(0)="71,9",DIR("?")="Enter the CPT code for this procedure:",DA=RAIEN D ^DIR Q:$G(DIRUT)=1  S RACPT=+Y
"RTN","RANPRO5",24,0)
 .. I X["^" Q
"RTN","RANPRO5",25,0)
 .. I $G(RAIEN)="" Q
"RTN","RANPRO5",26,0)
 .. I $G(Y(0))="NONE LISTED" Q
"RTN","RANPRO5",27,0)
 .. I $G(RANOT)=X Q
"RTN","RANPRO5",28,0)
 .. S RACPT=$P($G(^RAMIS(71,RAIEN,0)),"^",9) I RACPT="" Q
"RTN","RANPRO5",29,0)
 .. S RAMATCH="",DR="900///",RAX=$$MRPF Q:RAX["QUIT"!(RAMATCH="")
"RTN","RANPRO5",30,0)
 .. S RATMP=$S(RAPROIEN="":"",1:^RAMRPF(71.99,RAPROIEN,0))
"RTN","RANPRO5",31,0)
 .. S DR=DR_$P(RATMP,U,1)_";903///"_$P(RATMP,U,4) D:$G(^XTMP("RAMAIN4",$J,"RAEND"))=""
"RTN","RANPRO5",32,0)
 ... S DIE="^RAMRPF(71.11,",DA=RAIEN
"RTN","RANPRO5",33,0)
 ... Q:$G(X)=""
"RTN","RANPRO5",34,0)
 ... Q:$G(X)="NONE LISTED"
"RTN","RANPRO5",35,0)
 ... Q:$G(Y(0))="NONE LISTED"
"RTN","RANPRO5",36,0)
 ... D ^DIE W !!,"MATCH MADE",! K X,Y Q
"RTN","RANPRO5",37,0)
 ... ;I $G(X)="NONE LISTED" D MSG
"RTN","RANPRO5",38,0)
 ... Q
"RTN","RANPRO5",39,0)
 .. I $G(Y(0))="NONE LISTED" D MSG
"RTN","RANPRO5",40,0)
 .. K DIR W ! S RACONT="" S DIR(0)="F^1:8",DIR("A")="Hit <RETURN> to continue or '^' to quit.",DIR("B")="Continue" D ^DIR S RACONT=Y
"RTN","RANPRO5",41,0)
 .. Q
"RTN","RANPRO5",42,0)
 . Q
"RTN","RANPRO5",43,0)
 ;G:RACONT="Continue" EN
"RTN","RANPRO5",44,0)
 G:RACONT["^" END
"RTN","RANPRO5",45,0)
 G:$D(DUOUT) END
"RTN","RANPRO5",46,0)
MRPF ;FIND POSSIBLE MATCHES BY CPT
"RTN","RANPRO5",47,0)
MRPF2 ;SECOND ENTRY POINT
"RTN","RANPRO5",48,0)
 Q:$G(RACPT)="" RAMATCH=""
"RTN","RANPRO5",49,0)
 N CNT,RAMERR,CNT1,II,A,RACINF
"RTN","RANPRO5",50,0)
 S RACODE="",RAPROIEN="",(CNT,I,II,CNT1)=0 K XC,XC2,RAMERR
"RTN","RANPRO5",51,0)
 S:$G(RAPROIEN)="" RAPROIEN=""
"RTN","RANPRO5",52,0)
 S:$G(RAPROIEN)="" RAPROIEN="" F I=1:1 S RAPROIEN=$O(^RAMRPF(71.99,"C",RACPT,RAPROIEN)) D:'$D(^RAMRPF(71.99,"C",RACPT)) MSG Q:RAPROIEN=""  D ACTIVE^RANPROU2 D:$G(RA99)'="INACTIVE"
"RTN","RANPRO5",53,0)
 . ; RA*5.0*138 change '/' to '~'
"RTN","RANPRO5",54,0)
 .S:$G(RACODE)="" RACODE="" S RACINF=$$CPT^ICPTCOD(RACPT),RACODE=RACODE_I_":"_$P(^RAMRPF(71.99,RAPROIEN,0),U,1)_"~"_$P(RACINF,"^",3)_";",^XTMP("RAMAIN4",$J,I)=RAPROIEN
"RTN","RANPRO5",55,0)
 . Q
"RTN","RANPRO5",56,0)
 K RACINF
"RTN","RANPRO5",57,0)
MRPFL ; come here if no entries
"RTN","RANPRO5",58,0)
 K RAMERR,CNT1,II,A
"RTN","RANPRO5",59,0)
 ;S RACODE=$G(RACODE)_$S($G(CNT)'="":(CNT+1),1:1)_":NONE LISTED",RANOT=$S($G(CNT)'="":(CNT+1),1:1)
"RTN","RANPRO5",60,0)
 S RACODE=$G(RACODE)_$S($G(I)'="":I,1:1)_":NONE LISTED",RANOT=$S($G(I)'="":I,1:1)
"RTN","RANPRO5",61,0)
 Q:$G(RACODE)="" $G(RAMATCH)
"RTN","RANPRO5",62,0)
MRPF3 K XC,XC2,CNT  ;LOOP POINT
"RTN","RANPRO5",63,0)
 K DIR,DIE S DIR(0)="S^"_RACODE_"^",DIR("A",1)="Select the number of the Master Procedure that best matches",DIR("A")="or enter a number followed by 'C' for the long name. e.g. 1C"
"RTN","RANPRO5",64,0)
 S DIR("PRE")="I X["_"""C"""_" S X=+X,XC=1"
"RTN","RANPRO5",65,0)
 D ^DIR G:$D(DUOUT) MEND G:Y["^"!(X["^") END S RAPLUSY=+Y I $G(XC)=1 D
"RTN","RANPRO5",66,0)
 . S ^XTMP("RAMAIN4",$J,"C")=$G(RACPT)_U_RACODE_U_$G(RAMATCH)_U_RAPROIEN_U_$G(XC)_U_RANOT_U_RAPLUSY,XC2=1
"RTN","RANPRO5",67,0)
 . I Y(0)["NONE LISTED" S XC2=XC Q
"RTN","RANPRO5",68,0)
 . S RAMATCH=$P(RACODE,";",+Y),RAMATCH=$P(RAMATCH,":",2),RAPLUSY=+Y
"RTN","RANPRO5",69,0)
 . S ^XTMP("RAMAIN4",$J,"C")=$G(RACPT)_U_RACODE_U_RAMATCH_U_RAPROIEN_U_XC_U_RANOT_U_RAPLUSY
"RTN","RANPRO5",70,0)
 . I $P(^XTMP("RAMAIN4",$J,"C"),U,2)="1:NON LISTED" S XC2=1 Q
"RTN","RANPRO5",71,0)
 . K ^UTILITY($J,"W") S DIWL=10,DIWR=70,DIWF="WC60"
"RTN","RANPRO5",72,0)
 . S RAPRO1=^XTMP("RAMAIN4",$J,+Y),RAPLUSY=+Y
"RTN","RANPRO5",73,0)
 . S X1=0 F  S X1=$O(^RAMRPF(71.99,RAPRO1,1,X1)) Q:X1=""  D
"RTN","RANPRO5",74,0)
 .. S X=^RAMRPF(71.99,RAPRO1,1,X1,0) D ^DIWP
"RTN","RANPRO5",75,0)
 .. Q
"RTN","RANPRO5",76,0)
 . D ^DIWW
"RTN","RANPRO5",77,0)
 . W !?3,"Enter <RETURN> to continue:" R X:600 Q
"RTN","RANPRO5",78,0)
 I $G(XC2)=1 S RAXTMP=^XTMP("RAMAIN4",$J,"C") D
"RTN","RANPRO5",79,0)
 . S RACPT=$P(RAXTMP,U,1),RACODE=$P(RAXTMP,U,2),RAMATCH=$P(RAXTMP,U,3),RAPROIEN=$P(RAXTMP,U,4),XC=$P(RAXTMP,U,5),RANOT=$P(RAXTMP,U,7),(RAPLUSY,Y)=$P(RAXTMP,U,8) S I=""
"RTN","RANPRO5",80,0)
 G:$G(XC2)=1 MRPF3 S:$G(Y)'=$G(RANOT) RAMATCH=$P(RACODE,";",RAPLUSY),RAMATCH=$P(RAMATCH,":",2)
"RTN","RANPRO5",81,0)
 I RACODE'="1:NONE LISTED"&(Y(0)'="NONE LISTED") S:$G(RAPROIEN)="" RAPROIEN=^XTMP("RAMAIN4",$J,+Y)
"RTN","RANPRO5",82,0)
 I $G(RACODE)["1:NONE LISTED"!($G(Y(0))["NONE LISTED") S RAX="QUIT",RAMATCH="" G MEND
"RTN","RANPRO5",83,0)
 I $G(RAPROIEN)'="",$D(^RAMIS(71,"MRPF",$S($G(RAPROIEN)'="":RAPROIEN,1:0))) S RAMTCH=2 D:RAMATCH'="" MTCH^RANPROU2 I RAMATCH="QUIT"  S RAMV=1 G END
"RTN","RANPRO5",84,0)
 ; RA*5.0*138 change '/' to '~'
"RTN","RANPRO5",85,0)
 S:+Y'=RANOT RAMATCH=$P(RAMATCH,"~",1) I $P(RACODE,";",Y)'["NONE LISTED" S RAPROIEN=^XTMP("RAMAIN4",$J,+Y)
"RTN","RANPRO5",86,0)
MEND ;GO HERE WHEN AN UPARROW ENTERED ON A DIR
"RTN","RANPRO5",87,0)
 I $G(RAMATCH)="NONE LISTED" S RAMATCH="" Q
"RTN","RANPRO5",88,0)
 I $G(RAMATCH)="",$G(Y(0))["NONE LISTED" S RAMATCH="QUIT" Q RAMATCH
"RTN","RANPRO5",89,0)
 I $G(DUOUT)=1 S RAX="QUIT",RAMATCH="" Q RAMATCH
"RTN","RANPRO5",90,0)
 S RAMATCH="GO" Q RAMATCH
"RTN","RANPRO5",91,0)
END ;END ROUTINE
"RTN","RANPRO5",92,0)
 K RACPT,RACODE,DIR,D,I,%X,%Y,D0,DI,DQ,DIRUT,DUOUT,XMDUN,XMDUZ,XMZ,^XTMP("RANPRO4"),RALOINC
"RTN","RANPRO5",93,0)
 K RAPLUSY,RAPRO1,X1,XC,XY,Z,DA,^UTILITY($J,"W")
"RTN","RANPRO5",94,0)
 K ^XTMP("RAMAIN4",$J),RAMTCH
"RTN","RANPRO5",95,0)
 Q
"RTN","RANPRO5",96,0)
MSG K RACPT,RACODE,DIR,D,I,%X,%Y,D0,DI,DQ,DIRUT,DUOUT
"RTN","RANPRO5",97,0)
 I $P($G(^RARMPF(71.98,1,0)),U,10)'="Y" G END
"RTN","RANPRO5",98,0)
 N XMSUB,XMY,XMTEXT,RATXT
"RTN","RANPRO5",99,0)
 S RAFAC=$$KSP^XUPARAM("INST"),RAFAC=$$NS^XUAF4(RAFAC)
"RTN","RANPRO5",100,0)
 S RAFN=$P(RAFAC,U,1),RAFAC=$P(RAFAC,U,2),$P(^RAMRPF(71.11,DA,"NTRT"),U,2)="Y"
"RTN","RANPRO5",101,0)
 S XMSUB="NEW RADIOLOGY PROCEDURE"
"RTN","RANPRO5",102,0)
 S XMY(DUZ)=""
"RTN","RANPRO5",103,0)
 S XMY("G.RADIOLOGY NTRT@FORUM.DOMAIN.EXT")=""
"RTN","RANPRO5",104,0)
 S XMY("G.NTRT")=""
"RTN","RANPRO5",105,0)
 S XMDUZ("G.RADNTRT")=""
"RTN","RANPRO5",106,0)
 I $P($G(^RAMRPF(71.98,1,0)),U,2)'="" S XMY($P(^RAMRPF(71.98,1,0),U,2))=""
"RTN","RANPRO5",107,0)
 S RATXT(1)="An existing Radiology procedure at "_RAFN
"RTN","RANPRO5",108,0)
 S RATXT(2)="does not have a match in the MASTER RADIOLOGY PROCEDURE file"
"RTN","RANPRO5",109,0)
 S RATXT(3)=" "
"RTN","RANPRO5",110,0)
 S RATXT(4)="Facility Name/number: "_RAFN_" / "_RAFAC
"RTN","RANPRO5",111,0)
 S RATXT(5)=" "
"RTN","RANPRO5",112,0)
 S RATXT(6)="Procedure name: "_RADA
"RTN","RANPRO5",113,0)
 S RATXT(7)=" "
"RTN","RANPRO5",114,0)
 S RATXT(8)="CPT code: "_$P($G(^RAMRPF(71.11,DA,0)),U,9)
"RTN","RANPRO5",115,0)
 S RATXT(9)="Local IEN: "_DA
"RTN","RANPRO5",116,0)
 S RATXT(10)="For questions or notification respond to: "_"G.RADNTRT@"_$$KSP^XUPARAM("WHERE")
"RTN","RANPRO5",117,0)
 S RATXT(11)="For NTRT results respond to: "_"S.RADNEWPRO@"_$$KSP^XUPARAM("WHERE")
"RTN","RANPRO5",118,0)
 S $P(^RAMRPF(71.11,DA,"NTRT"),U,3)=DT
"RTN","RANPRO5",119,0)
 S XMTEXT="RATXT(" D ^XMD
"RTN","RANPRO5",120,0)
 S $P(^RAMRPF(71.11,DA,"NTRT"),U,3)=DT
"RTN","RANPRO5",121,0)
 G END
"RTN","RAPSAPI2")
0^8^B44028189^B40591298
"RTN","RAPSAPI2",1,0)
RAPSAPI2 ;HOIFO/SG - INPUT TEMPLATE UTILS FOR PHARM. POINTERS ; 4/6/07 3:43pm
"RTN","RAPSAPI2",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**65,138**;Mar 16, 1998;Build 22
"RTN","RAPSAPI2",3,0)
 ;
"RTN","RAPSAPI2",4,0)
 ;Supported IA #2053 reference to FILE^DIE
"RTN","RAPSAPI2",5,0)
 ;Supported IA #2052 reference to FIELD^DID and GET1^DID
"RTN","RAPSAPI2",6,0)
 ;Supported IA #2055 reference to ROOT^DILFD and OREF^DILFD
"RTN","RAPSAPI2",7,0)
 ;Supported IA #10007 reference to DO^DIC1
"RTN","RAPSAPI2",8,0)
 ;Supported IA #4551 reference to DIC^PSSDI
"RTN","RAPSAPI2",9,0)
 ;Supported IA #10029 reference to ^DIWW
"RTN","RAPSAPI2",10,0)
 ;
"RTN","RAPSAPI2",11,0)
 Q
"RTN","RAPSAPI2",12,0)
 ;
"RTN","RAPSAPI2",13,0)
 ;***** DISPLAYS RECORD DELETE PROMPT AND GETS USER RESPONSE
"RTN","RAPSAPI2",14,0)
 ;
"RTN","RAPSAPI2",15,0)
 ; RAIEN         IEN of the record of the multiple
"RTN","RAPSAPI2",16,0)
 ;
"RTN","RAPSAPI2",17,0)
 ; IEN50         Internal value of the .01 field
"RTN","RAPSAPI2",18,0)
 ;
"RTN","RAPSAPI2",19,0)
 ; Return values:
"RTN","RAPSAPI2",20,0)
 ;        0  Keep the record or there is nothing to delete
"RTN","RAPSAPI2",21,0)
 ;        1  Delete the record
"RTN","RAPSAPI2",22,0)
 ;
"RTN","RAPSAPI2",23,0)
 ; Note: This is an internal function. Do not call it from outside
"RTN","RAPSAPI2",24,0)
 ;       of the RAPSAPI3 routine.
"RTN","RAPSAPI2",25,0)
 ;
"RTN","RAPSAPI2",26,0)
DELCONF(RAIEN,IEN50) ;
"RTN","RAPSAPI2",27,0)
 I (RAIEN'>0)!(IEN50'>0)  W "??"  Q 0
"RTN","RAPSAPI2",28,0)
 N DA,DIR,DIROUT,DIRUT,DTOUT,DUOUT,TMP,X,Y
"RTN","RAPSAPI2",29,0)
 S DIR(0)="YAO"
"RTN","RAPSAPI2",30,0)
 S DIR("A")="   SURE YOU WANT TO DELETE",TMP=$G(RADESCR("FLDNAME"))
"RTN","RAPSAPI2",31,0)
 S DIR("A")=DIR("A")_$S(TMP'="":" THE ENTIRE "_TMP,1:"")_"? "
"RTN","RAPSAPI2",32,0)
 D ^DIR
"RTN","RAPSAPI2",33,0)
 W:Y'=1 "  <NOTHING DELETED>"
"RTN","RAPSAPI2",34,0)
 Q (Y=1)
"RTN","RAPSAPI2",35,0)
 ;
"RTN","RAPSAPI2",36,0)
 ;***** DELETES A (SUB)FILE RECORD
"RTN","RAPSAPI2",37,0)
 ;
"RTN","RAPSAPI2",38,0)
 ; FILE          File/subfile number
"RTN","RAPSAPI2",39,0)
 ; IENS          IENS of the record
"RTN","RAPSAPI2",40,0)
 ;
"RTN","RAPSAPI2",41,0)
DELETE(FILE,IENS) ;
"RTN","RAPSAPI2",42,0)
 N RAFDA,RAMSG
"RTN","RAPSAPI2",43,0)
 S RAFDA(FILE,IENS,.01)="@"
"RTN","RAPSAPI2",44,0)
 D FILE^DIE(,"RAFDA","RAMSG")
"RTN","RAPSAPI2",45,0)
 Q
"RTN","RAPSAPI2",46,0)
 ;
"RTN","RAPSAPI2",47,0)
 ;***** DISPLAYS HELP (? and ??)
"RTN","RAPSAPI2",48,0)
 ;
"RTN","RAPSAPI2",49,0)
 ; VAL           User input ("?" or "??")
"RTN","RAPSAPI2",50,0)
 ;
"RTN","RAPSAPI2",51,0)
 ; FILE          File number
"RTN","RAPSAPI2",52,0)
 ;
"RTN","RAPSAPI2",53,0)
 ; FIELD         Field number
"RTN","RAPSAPI2",54,0)
 ;
"RTN","RAPSAPI2",55,0)
 ; [IENS]        IENS of the multiple defined by the FIELD parameter
"RTN","RAPSAPI2",56,0)
 ;               (1st comma piece should be empty). Specify this
"RTN","RAPSAPI2",57,0)
 ;               parameter if help information for a "Select..."
"RTN","RAPSAPI2",58,0)
 ;               prompt is needed.
"RTN","RAPSAPI2",59,0)
 ;
"RTN","RAPSAPI2",60,0)
HELP(VAL,FILE,FIELD,IENS) ;
"RTN","RAPSAPI2",61,0)
 Q:'($G(VAL)?1"?".1"?")
"RTN","RAPSAPI2",62,0)
 N LM,RABUF,RAMSG,TMP
"RTN","RAPSAPI2",63,0)
 S TMP="LABEL;MULTIPLE-VALUED;SPECIFIER"
"RTN","RAPSAPI2",64,0)
 D FIELD^DID(FILE,FIELD,,TMP,"RABUF","RAMSG")
"RTN","RAPSAPI2",65,0)
 Q:$G(RABUF("LABEL"))=""
"RTN","RAPSAPI2",66,0)
 ;---
"RTN","RAPSAPI2",67,0)
 I $G(RABUF("MULTIPLE-VALUED"))  D  S LM=9
"RTN","RAPSAPI2",68,0)
 . S FILE=+$G(RABUF("SPECIFIER")),FIELD=.01
"RTN","RAPSAPI2",69,0)
 . S TMP=$$ROOT^DILFD(FILE,$G(IENS),1)
"RTN","RAPSAPI2",70,0)
 . D:TMP'="" HLPMULT(VAL,TMP,RABUF("LABEL"))
"RTN","RAPSAPI2",71,0)
 E  S LM=5
"RTN","RAPSAPI2",72,0)
 ;---
"RTN","RAPSAPI2",73,0)
 I VAL="?"  D
"RTN","RAPSAPI2",74,0)
 . D HLPROMPT(LM,FILE,FIELD)
"RTN","RAPSAPI2",75,0)
 E  D HLPDESCR(9,FILE,FIELD)
"RTN","RAPSAPI2",76,0)
 ;---
"RTN","RAPSAPI2",77,0)
 W !
"RTN","RAPSAPI2",78,0)
 Q
"RTN","RAPSAPI2",79,0)
 ;
"RTN","RAPSAPI2",80,0)
 ;***** DISPLAYS FIELD DESCRIPTION
"RTN","RAPSAPI2",81,0)
 ;
"RTN","RAPSAPI2",82,0)
 ; LM            Left margin for the output
"RTN","RAPSAPI2",83,0)
 ;
"RTN","RAPSAPI2",84,0)
 ; FILE          File number
"RTN","RAPSAPI2",85,0)
 ;
"RTN","RAPSAPI2",86,0)
 ; FIELD         Field number
"RTN","RAPSAPI2",87,0)
 ;
"RTN","RAPSAPI2",88,0)
HLPDESCR(LM,FILE,FIELD) ;
"RTN","RAPSAPI2",89,0)
 N I,RAHLP,RAMSG
"RTN","RAPSAPI2",90,0)
 S I=$$GET1^DID(FILE,FIELD,,"DESCRIPTION","RAHLP","RAMSG")
"RTN","RAPSAPI2",91,0)
 D:$D(RAHLP)>1 HLPWR(LM,.RAHLP)
"RTN","RAPSAPI2",92,0)
 Q
"RTN","RAPSAPI2",93,0)
 ;
"RTN","RAPSAPI2",94,0)
 ;***** DISPLAYS CONTENT OF THE MULTIPLE AND RELATED PROMPTS
"RTN","RAPSAPI2",95,0)
 ;
"RTN","RAPSAPI2",96,0)
 ; VAL           User input ("?" or "??")
"RTN","RAPSAPI2",97,0)
 ;
"RTN","RAPSAPI2",98,0)
 ; LM            Left margin for the output
"RTN","RAPSAPI2",99,0)
 ;
"RTN","RAPSAPI2",100,0)
 ; RAROOT        Closed root of the multiple's sub-file
"RTN","RAPSAPI2",101,0)
 ;
"RTN","RAPSAPI2",102,0)
 ; MLTNAME       Name of the multiple
"RTN","RAPSAPI2",103,0)
 ;
"RTN","RAPSAPI2",104,0)
HLPMULT(VAL,RAROOT,MLTNAME) ;
"RTN","RAPSAPI2",105,0)
 N DA,DIC,DIR,DIROUT,DIRUT,DTOUT,DO,DUOUT,RA50IEN,RAI,RARC,RAY,TMP,X,Y
"RTN","RAPSAPI2",106,0)
 S RARC=0
"RTN","RAPSAPI2",107,0)
 I $O(@RAROOT@(0))>0  D  Q:RARC
"RTN","RAPSAPI2",108,0)
 . ;--- Get confirmation if the multiple contains more than 10 records
"RTN","RAPSAPI2",109,0)
 . S DIC=$$OREF^DILF(RAROOT),DIC(0)=""
"RTN","RAPSAPI2",110,0)
 . D DO^DIC1
"RTN","RAPSAPI2",111,0)
 . I VAL'="??",$P(DO,U,4)>10  D  I 'Y  S RARC=1  Q
"RTN","RAPSAPI2",112,0)
 . . K DIR  S DIR(0)="YAO"
"RTN","RAPSAPI2",113,0)
 . . S DIR("A")="Do you want the entire "_$P(DO,U,4)_"-Entry "_MLTNAME_" List? "
"RTN","RAPSAPI2",114,0)
 . . D ^DIR
"RTN","RAPSAPI2",115,0)
 . ;--- Write related prompts
"RTN","RAPSAPI2",116,0)
 . S RAY=$Y-1
"RTN","RAPSAPI2",117,0)
 . W !?4,$S(VAL="?":"Answer with "_MLTNAME,1:"")
"RTN","RAPSAPI2",118,0)
 . W !?3,"Choose from:"
"RTN","RAPSAPI2",119,0)
 . ;--- Write content of the multiple
"RTN","RAPSAPI2",120,0)
 . S RAI=0
"RTN","RAPSAPI2",121,0)
 . F  S RAI=$O(@RAROOT@(RAI))  Q:RAI'>0  D  Q:'RAI
"RTN","RAPSAPI2",122,0)
 . . S RA50IEN=+$P($G(@RAROOT@(RAI,0)),U)
"RTN","RAPSAPI2",123,0)
 . . I ($Y-RAY)'<IOSL  D  S RAY=$Y-1  I 'Y  S RAI=0  Q
"RTN","RAPSAPI2",124,0)
 . . . K DIR  S DIR(0)="EOA"
"RTN","RAPSAPI2",125,0)
 . . . S DIR("A")="   '^' TO STOP: "
"RTN","RAPSAPI2",126,0)
 . . . D ^DIR
"RTN","RAPSAPI2",127,0)
 . . S TMP=$$EN1^RAPSAPI(RA50IEN,.01)
"RTN","RAPSAPI2",128,0)
 . . W !?3,$S(TMP'="":TMP,1:RA50IEN)
"RTN","RAPSAPI2",129,0)
 . W !
"RTN","RAPSAPI2",130,0)
 ;===
"RTN","RAPSAPI2",131,0)
 W !?8,"You may enter a new "_MLTNAME_", if you wish"
"RTN","RAPSAPI2",132,0)
 Q
"RTN","RAPSAPI2",133,0)
 ;
"RTN","RAPSAPI2",134,0)
 ;***** DISPLAYS HELP PROMPT AND SCREEN DESCRIPTION
"RTN","RAPSAPI2",135,0)
 ;
"RTN","RAPSAPI2",136,0)
 ; LM            Left margin for the output
"RTN","RAPSAPI2",137,0)
 ;
"RTN","RAPSAPI2",138,0)
 ; FILE          File number
"RTN","RAPSAPI2",139,0)
 ;
"RTN","RAPSAPI2",140,0)
 ; FIELD         Field number
"RTN","RAPSAPI2",141,0)
 ;
"RTN","RAPSAPI2",142,0)
HLPROMPT(LM,FILE,FIELD) ;
"RTN","RAPSAPI2",143,0)
 ;;70.15^.01^Only pharmaceuticals that are active on this exam date are allowed.
"RTN","RAPSAPI2",144,0)
 ;;70.21^.01^Enter only active radiopharmaceuticals with an appropriate drug classification.
"RTN","RAPSAPI2",145,0)
 ;;71.055^.01^Only active non-radiopharmaceuticals may be selected.
"RTN","RAPSAPI2",146,0)
 ;;71.08^.01^Only active radiopharmaceuticals are valid.
"RTN","RAPSAPI2",147,0)
 ;;71.9^5^Only active radiopharmaceuticals are valid.
"RTN","RAPSAPI2",148,0)
 ;
"RTN","RAPSAPI2",149,0)
 N RAI,RAMSG,TMP
"RTN","RAPSAPI2",150,0)
 ;--- Help prompt
"RTN","RAPSAPI2",151,0)
 S TMP=$$GET1^DID(FILE,FIELD,,"HELP-PROMPT",,"RAMSG")
"RTN","RAPSAPI2",152,0)
 D:TMP'="" HLPWR(LM,TMP)
"RTN","RAPSAPI2",153,0)
 ;--- Optional screen description
"RTN","RAPSAPI2",154,0)
 F RAI=1:1  S TMP=$P($T(HLPROMPT+RAI),";;",2)  Q:TMP=""  D  Q:TMP=""
"RTN","RAPSAPI2",155,0)
 . I +TMP=FILE,$P(TMP,U,2)=FIELD  D HLPWR(LM,$P(TMP,U,3))  S TMP=""
"RTN","RAPSAPI2",156,0)
 Q
"RTN","RAPSAPI2",157,0)
 ;
"RTN","RAPSAPI2",158,0)
 ;***** FORMATS THE TEXT AND WRITES IT TO THE CURRRENT DEVICE
"RTN","RAPSAPI2",159,0)
 ;
"RTN","RAPSAPI2",160,0)
 ; DIWL          Left margin for the text
"RTN","RAPSAPI2",161,0)
 ;
"RTN","RAPSAPI2",162,0)
 ; [.]TEXT       Either a string or a reference to a local array
"RTN","RAPSAPI2",163,0)
 ;               that contains the text
"RTN","RAPSAPI2",164,0)
 ;
"RTN","RAPSAPI2",165,0)
 ; Note: This function uses the ^UTILITY($J,"W") global node.
"RTN","RAPSAPI2",166,0)
 ;
"RTN","RAPSAPI2",167,0)
HLPWR(DIWL,TEXT) ;
"RTN","RAPSAPI2",168,0)
 N DIWF,DIWR,RAI,X
"RTN","RAPSAPI2",169,0)
 K ^UTILITY($J,"W")
"RTN","RAPSAPI2",170,0)
 S DIWF="W",DIWR=IOM-3
"RTN","RAPSAPI2",171,0)
 I $D(TEXT)>1  S RAI=""  D
"RTN","RAPSAPI2",172,0)
 . F  S RAI=$O(TEXT(RAI))  Q:RAI=""  D
"RTN","RAPSAPI2",173,0)
 .. I $D(TEXT(RAI))#2 S X=TEXT(RAI)  D ^DIWP
"RTN","RAPSAPI2",174,0)
 .. ; JCH/RA*5.0*138 - Accomodate additional text in sub-nodes of TEXT(RAI)
"RTN","RAPSAPI2",175,0)
 .. I $O(TEXT(RAI,"")) N RAI2 S RAI2=0 F  S RAI2=$O(TEXT(RAI,RAI2)) Q:'RAI2  D
"RTN","RAPSAPI2",176,0)
 ... I $D(TEXT(RAI,RAI2))#2 S X=$G(TEXT(RAI,RAI2)) D ^DIWP
"RTN","RAPSAPI2",177,0)
 E  S X=$G(TEXT)  D ^DIWP
"RTN","RAPSAPI2",178,0)
 D ^DIWW
"RTN","RAPSAPI2",179,0)
 K ^UTILITY($J,"W")
"RTN","RAPSAPI2",180,0)
 Q
"RTN","RAPSAPI2",181,0)
 ;
"RTN","RAPSAPI2",182,0)
 ;***** VALIDATES DIRECT IEN INPUT (i.e. `IEN)
"RTN","RAPSAPI2",183,0)
 ;
"RTN","RAPSAPI2",184,0)
 ; .VAL          User input (`IEN)
"RTN","RAPSAPI2",185,0)
 ;
"RTN","RAPSAPI2",186,0)
 ; Return values:
"RTN","RAPSAPI2",187,0)
 ;        0  Ignore the input
"RTN","RAPSAPI2",188,0)
 ;        1  Process the input
"RTN","RAPSAPI2",189,0)
 ;
"RTN","RAPSAPI2",190,0)
 ; Note: This is an internal function. Do not call it from outside
"RTN","RAPSAPI2",191,0)
 ;       of the RAPSAPI3 routine.
"RTN","RAPSAPI2",192,0)
 ;
"RTN","RAPSAPI2",193,0)
IEN(VAL) ;
"RTN","RAPSAPI2",194,0)
 N IEN,RADIC,PSSDIY
"RTN","RAPSAPI2",195,0)
 S IEN=+$P(VAL,"`",2,$L(VAL))
"RTN","RAPSAPI2",196,0)
 I IEN'>0  W "??"  Q 0
"RTN","RAPSAPI2",197,0)
 S VAL="`"_IEN
"RTN","RAPSAPI2",198,0)
 ;--- Check the multiple
"RTN","RAPSAPI2",199,0)
 Q:$D(@(RADESCR("ROOT"))@(IEN)) 1
"RTN","RAPSAPI2",200,0)
 ;--- Check the DRUG file (#50)
"RTN","RAPSAPI2",201,0)
 S RADIC="^PSDRUG(",RADIC(0)=""
"RTN","RAPSAPI2",202,0)
 D SETVACL(RADESCR)
"RTN","RAPSAPI2",203,0)
 D DIC^PSSDI(50,"RA",.RADIC,VAL,,RADESCR("SCRDATE"),,.RAVACL)
"RTN","RAPSAPI2",204,0)
 W:Y'>0 "??"
"RTN","RAPSAPI2",205,0)
 Q (Y>0)
"RTN","RAPSAPI2",206,0)
 ;
"RTN","RAPSAPI2",207,0)
 ;***** SELECTS A RECORD FROM THE MULTIPLE
"RTN","RAPSAPI2",208,0)
 ;
"RTN","RAPSAPI2",209,0)
 ; NODE          Node of the cross-reference
"RTN","RAPSAPI2",210,0)
 ; MLTNAME       Name of the multiple
"RTN","RAPSAPI2",211,0)
 ; DRUGNAME      Drug name
"RTN","RAPSAPI2",212,0)
 ;
"RTN","RAPSAPI2",213,0)
 ; Return values:
"RTN","RAPSAPI2",214,0)
 ;        0  No selection
"RTN","RAPSAPI2",215,0)
 ;       >0  IEN of a multiple's record
"RTN","RAPSAPI2",216,0)
 ;
"RTN","RAPSAPI2",217,0)
MULTSEL(NODE,MLTNAME,DRUGNAME) ;
"RTN","RAPSAPI2",218,0)
 N CNT,DA,DIR,DIROUT,DIRUT,DTOUT,DUOUT,RAI,RATMP,RC,TMP,X,Y
"RTN","RAPSAPI2",219,0)
 S RATMP=$NA(^TMP($J,$T(+0)_"-MULTSEL"))  K @RATMP
"RTN","RAPSAPI2",220,0)
 ;===
"RTN","RAPSAPI2",221,0)
 S (CNT,IEN,RC)=0
"RTN","RAPSAPI2",222,0)
 F  D  Q:RC!(IEN'>0)
"RTN","RAPSAPI2",223,0)
 . ;--- Display the next portion of records
"RTN","RAPSAPI2",224,0)
 . F RAI=1:1:5  S IEN=$O(@NODE@(IEN))  Q:IEN'>0  D
"RTN","RAPSAPI2",225,0)
 . . S CNT=CNT+1,@RATMP@(CNT)=IEN
"RTN","RAPSAPI2",226,0)
 . . W !?5,CNT,?9,DRUGNAME
"RTN","RAPSAPI2",227,0)
 . Q:CNT'>0
"RTN","RAPSAPI2",228,0)
 . ;--- Ask the user
"RTN","RAPSAPI2",229,0)
 . K DIR  S DIR(0)="NAO^1:"_CNT_":0"
"RTN","RAPSAPI2",230,0)
 . S DIR("A")="CHOOSE 1-"_CNT_": "
"RTN","RAPSAPI2",231,0)
 . I IEN>0  D:$O(@NODE@(IEN))>0
"RTN","RAPSAPI2",232,0)
 . . S DIR("A",1)="Press <RETURN> to see more, '^' to exit this list, OR"
"RTN","RAPSAPI2",233,0)
 . S DIR("?")="Select a record of the "_MLTNAME_" multivalued field."
"RTN","RAPSAPI2",234,0)
 . D ^DIR
"RTN","RAPSAPI2",235,0)
 . I $D(DTOUT)!$D(DUOUT)  S RC=-1  Q
"RTN","RAPSAPI2",236,0)
 . S:X'="" IEN=+@RATMP@(+Y),RC=1
"RTN","RAPSAPI2",237,0)
 ;=== Cleanup
"RTN","RAPSAPI2",238,0)
 K @RATMP
"RTN","RAPSAPI2",239,0)
 Q $S(RC>0:IEN,1:0)
"RTN","RAPSAPI2",240,0)
 ;
"RTN","RAPSAPI2",241,0)
 ;***** INITIALIZES THE RAVACL ARRAY FOR SCREENING MEDS
"RTN","RAPSAPI2",242,0)
 ;
"RTN","RAPSAPI2",243,0)
 ; FLAGS         Mode flags
"RTN","RAPSAPI2",244,0)
 ;
"RTN","RAPSAPI2",245,0)
SETVACL(FLAGS) ;
"RTN","RAPSAPI2",246,0)
 N I
"RTN","RAPSAPI2",247,0)
 F I="DX200","DX201","DX202"  S RAVACL(I)=""
"RTN","RAPSAPI2",248,0)
 S:FLAGS["P" RAVACL("P")=""
"RTN","RAPSAPI2",249,0)
 S:FLAGS["R" RAVACL("R")=""
"RTN","RAPSAPI2",250,0)
 Q
"RTN","RAXMLSND")
0^9^B53343651^B52260194
"RTN","RAXMLSND",1,0)
RAXMLSND ;BPFO/DTG - NTRT MESSAGE PROCESS AND EDITS UPDATE;02/10/2016 ; 23 Sep 2016  3:43 PM
"RTN","RAXMLSND",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**127,138**;Mar 16, 1998;Build 22
"RTN","RAXMLSND",3,0)
 ;
"RTN","RAXMLSND",4,0)
 ; This section is for sending the XML message to ISAAC via HTTP/HTTPS
"RTN","RAXMLSND",5,0)
 ;
"RTN","RAXMLSND",6,0)
 ; first we save to ^XTMP
"RTN","RAXMLSND",7,0)
 Q
"RTN","RAXMLSND",8,0)
EN ; XTMP save
"RTN","RAXMLSND",9,0)
 N RAXTMPNM,RAXTMPNUM,CNT,E,LACT,STATUS,ZTQUEUED,ZTREQ
"RTN","RAXMLSND",10,0)
 S CNT=0
"RTN","RAXMLSND",11,0)
ENA S RAXTMPNM="RANTRTSAV"
"RTN","RAXMLSND",12,0)
 L +^XTMP(RAXTMPNM):30 I '$T H 10 S CNT=CNT+1 G ENA:CNT<11,ENO
"RTN","RAXMLSND",13,0)
 S ^XTMP(RAXTMPNM,0)=$$FMADD^XLFDT(DT,365)_U_$$NOW^XLFDT()_U_"Radiology New Term to NTRT STS XML"
"RTN","RAXMLSND",14,0)
 S RAXTMPNUM=$G(^XTMP(RAXTMPNM,"CTRL")),RAXTMPNUM=RAXTMPNUM+1,^XTMP(RAXTMPNM,"CTRL")=RAXTMPNUM
"RTN","RAXMLSND",15,0)
 L -^XTMP(RAXTMPNM)
"RTN","RAXMLSND",16,0)
 S CNT=0
"RTN","RAXMLSND",17,0)
 ; RATEXT is the built XML send array
"RTN","RAXMLSND",18,0)
 ; RA71IEN is the file 71 Procedure IEN
"RTN","RAXMLSND",19,0)
 ; RAS is the Specimen IEN from the 60 specimen multiple (60.01)
"RTN","RAXMLSND",20,0)
 ; RADUZ is the DUZ of the person saving the test/specimen item
"RTN","RAXMLSND",21,0)
ENL L +^XTMP(RAXTMPNM,"SEND",RAXTMPNUM):20 I '$T H 2 S CNT=CNT+1 G ENL:CNT<11,ENO
"RTN","RAXMLSND",22,0)
 M ^XTMP(RAXTMPNM,"SEND",RAXTMPNUM,"I")=RATXT
"RTN","RAXMLSND",23,0)
 S ^XTMP(RAXTMPNM,"SEND",RAXTMPNUM,"DUZ")=RADUZ
"RTN","RAXMLSND",24,0)
 S ^XTMP(RAXTMPNM,"SEND",RAXTMPNUM,"RA71IEN")=RA71IEN
"RTN","RAXMLSND",25,0)
 ;S ^XTMP(RAXTMPNM,"SEND",RAXTMPNUM,"RAS")=RAS
"RTN","RAXMLSND",26,0)
 S ^XTMP(RAXTMPNM,"SEND",RAXTMPNUM,"ERROR")=0
"RTN","RAXMLSND",27,0)
 L -^XTMP(RAXTMPNM,"SEND",RAXTMPNUM)
"RTN","RAXMLSND",28,0)
ENSL L +^XTMP(RAXTMPNM,"O"):5 I '$T G ENO
"RTN","RAXMLSND",29,0)
 N ZTDTH,ZTRTN,ZTSAVE,ZTIO,ZTSK,ZTDESC
"RTN","RAXMLSND",30,0)
 S ZTDTH=$$NOW^XLFDT,ZTDESC="RAD Send NTRT message to ISAAC"
"RTN","RAXMLSND",31,0)
 ; start RA*5.0*138 edit
"RTN","RAXMLSND",32,0)
 S ZTSAVE("RAXTMPNM")=""
"RTN","RAXMLSND",33,0)
 S ZTRTN="XMLSND^RAXMLSND(RAXTMPNM)",ZTIO=""
"RTN","RAXMLSND",34,0)
 ; end RA*5.0*138 edit
"RTN","RAXMLSND",35,0)
 D ^%ZTLOAD
"RTN","RAXMLSND",36,0)
 L -^XTMP(RAXTMPNM,"O")
"RTN","RAXMLSND",37,0)
 K ZTDTH,ZTRTN,ZTSAVE,ZTIO,ZTSK,ZTDESC
"RTN","RAXMLSND",38,0)
ENO K RAXTMPNM,RAXTMPNUM,CNT
"RTN","RAXMLSND",39,0)
 Q
"RTN","RAXMLSND",40,0)
 ;
"RTN","RAXMLSND",41,0)
 ; entry to send messages to ISAAC
"RTN","RAXMLSND",42,0)
 ;
"RTN","RAXMLSND",43,0)
XMLSND(RAXTMPNM) ;
"RTN","RAXMLSND",44,0)
 N CNT,A,B,C,RAT,RADUZ,RAG,RAS,RA71IEN,RAA,RATEXT,RARDAT,RASDAT,RARHD,RASHD,RAFLG,RAMETH,URL,RAXTVER
"RTN","RAXMLSND",45,0)
 N RASITE,RANT,RANTI,AR,RANMAIL,RAGMAIL,RAIS,RAPRT,RAIPATH,LXA,LXB,RANOS1,RANOS2,RAERR,RADUZ
"RTN","RAXMLSND",46,0)
 S CNT=0
"RTN","RAXMLSND",47,0)
X1 L +^XTMP(RAXTMPNM,"O"):20 I '$T S CNT=CNT+1 G X1:CNT<11,XMLOUT
"RTN","RAXMLSND",48,0)
 I $G(DT)="" S DT=$$DT^XLFDT
"RTN","RAXMLSND",49,0)
 ; get file 71.98 current info
"RTN","RAXMLSND",50,0)
 S RASITE=$$SITE^VASITE,RASITE=$P(RASITE,U,1)
"RTN","RAXMLSND",51,0)
 S RANT=$O(^RAMRPF(71.98,"B",RASITE,0))
"RTN","RAXMLSND",52,0)
 D GETS^DIQ(71.98,RANT_",","**","IE","AR")
"RTN","RAXMLSND",53,0)
 M RANTI=AR("71.98",RANT_",") K AR
"RTN","RAXMLSND",54,0)
 ;site number and name
"RTN","RAXMLSND",55,0)
 S RASITE=$G(RANTI(.01,"I")),RASITEN=$G(RANTI(.01,"E"))
"RTN","RAXMLSND",56,0)
 ;ntrt mail group
"RTN","RAXMLSND",57,0)
 S RANMAIL="NTRT RADIOLOGY"
"RTN","RAXMLSND",58,0)
 ;RAD send mail group
"RTN","RAXMLSND",59,0)
 S RAGMAIL=$G(RANTI(6,"I"))
"RTN","RAXMLSND",60,0)
 ; Isaac web address
"RTN","RAXMLSND",61,0)
 S RAIS=$G(RANTI(11,"I"))
"RTN","RAXMLSND",62,0)
 S AA=$$XUP(RAIS) S:$E(AA,1,4)="HTTP" RAIS=$P(RAIS,"//",2,999) S:$E(RAIS,($L(RAIS)))="/" RAIS=$E(RAIS,1,($L(RAIS)-1))
"RTN","RAXMLSND",63,0)
 ; Isaac port number
"RTN","RAXMLSND",64,0)
 S RAPRT=$G(RANTI(10,"I"))
"RTN","RAXMLSND",65,0)
 ; Isaac path
"RTN","RAXMLSND",66,0)
 S RAIPATH=$G(RANTI(11.5,"I")) I RAIPATH'="" D  ;<
"RTN","RAXMLSND",67,0)
 . S RAIPATH=$TR(RAIPATH,"~","/")
"RTN","RAXMLSND",68,0)
 . S:$E(RAIPATH,1)'="/" RAIPATH="/"_RAIPATH
"RTN","RAXMLSND",69,0)
 S URL=RAIS_":"_RAPRT_RAIPATH
"RTN","RAXMLSND",70,0)
 ; if web address or port number are nill do not send
"RTN","RAXMLSND",71,0)
 S RANOS3=0 I $G(RANTI(11,"I"))=""!($G(RANTI(10,"I"))="") S RANOS3=1
"RTN","RAXMLSND",72,0)
 ;if no send method
"RTN","RAXMLSND",73,0)
 S RANOS1=0 I $G(RANTI(8,"I"))="N" S RANOS1=1
"RTN","RAXMLSND",74,0)
 S AA=$$XUP(RAGMAIL)
"RTN","RAXMLSND",75,0)
 ; if not production or not VA
"RTN","RAXMLSND",76,0)
 S RANOS2=0 I '$$PROD^XUPROD()!(AA'["DOMAIN.EXT") S RANOS2=1
"RTN","RAXMLSND",77,0)
 ;
"RTN","RAXMLSND",78,0)
 S RAA=0,RAXTVER=1+($$PATCH^XPDUTL("XT*7.3*138"))
"RTN","RAXMLSND",79,0)
 S RAFLG=10
"RTN","RAXMLSND",80,0)
X2 S RAA=$O(^XTMP(RAXTMPNM,"SEND",RAA)) I 'RAA L -^XTMP(RAXTMPNM,"O") G XMLOUT
"RTN","RAXMLSND",81,0)
 S CNT=0
"RTN","RAXMLSND",82,0)
X2A L +^XTMP(RAXTMPNM,"SEND",RAA):5 I '$T S CNT=CNT+1 G X2A:CNT<11,XMLOUT
"RTN","RAXMLSND",83,0)
 K RAT,RARHD,RARHD,RASDAT,RASHD,REDIR
"RTN","RAXMLSND",84,0)
 S (RARHD,RASHD,RARDAT)=""
"RTN","RAXMLSND",85,0)
 S REDIR=0,RASHD("CONTENT-TYPE")="application/xml",STATUS=""
"RTN","RAXMLSND",86,0)
 M RAT=^XTMP(RAXTMPNM,"SEND",RAA,"I")
"RTN","RAXMLSND",87,0)
 S RADUZ=^XTMP(RAXTMPNM,"SEND",RAA,"DUZ"),RA71IEN=^XTMP(RAXTMPNM,"SEND",RAA,"RA71IEN")
"RTN","RAXMLSND",88,0)
 ;S RAS=^XTMP(RAXTMPNM,"SEND",RAA,"RAS"),RAERR=^XTMP(RAXTMPNM,"SEND",RAA,"ERROR")
"RTN","RAXMLSND",89,0)
 S RAERR=^XTMP(RAXTMPNM,"SEND",RAA,"ERROR")
"RTN","RAXMLSND",90,0)
 ;
"RTN","RAXMLSND",91,0)
 ; check if ok to send a message
"RTN","RAXMLSND",92,0)
 I RANOS1=1!(RANOS2=1)!(RANOS3=1) D NOTVALID G X2
"RTN","RAXMLSND",93,0)
 ;
"RTN","RAXMLSND",94,0)
 S STATUS=$$GETURL^XTHC10(URL,RAFLG,"RARDAT",.RARHD,"RAT",.RASHD,$G(REDIR)+1)
"RTN","RAXMLSND",95,0)
 S A=$TR(STATUS,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","RAXMLSND",96,0)
 I A["OK"!(A["ACCEPTED") D  G X2
"RTN","RAXMLSND",97,0)
 .; send message to order and group that message was sent to ISAAC NTRT
"RTN","RAXMLSND",98,0)
 . K XMY,RATEXT
"RTN","RAXMLSND",99,0)
 . S XMSUB="NEW NTRT REQUEST FOR LABORATORY HAS BEEN SENT"
"RTN","RAXMLSND",100,0)
 . S XMY(RADUZ)=""
"RTN","RAXMLSND",101,0)
 . S XMDUZ("AUTO ISAAC NTRT PROCESS")="" I RAGMAIL'="" S XMY($P(RAGMAIL,"@",1))=""
"RTN","RAXMLSND",102,0)
 . S RATEXT(1)="A new Radiology Procedure has been entered at: "_RASITEN_" / "_RASITE
"RTN","RAXMLSND",103,0)
 . S RATEXT(2)=""
"RTN","RAXMLSND",104,0)
 . S RATEXT(3)="Radiology Procedure Name : "_$G(LXA(.01,"I"))
"RTN","RAXMLSND",105,0)
 . S RATEXT(4)=""
"RTN","RAXMLSND",106,0)
 . S RATEXT(5)="Send Status: "_STATUS
"RTN","RAXMLSND",107,0)
 . S RATEXT(6)=""
"RTN","RAXMLSND",108,0)
 . S A=0,B="",I=6 F  S A=$O(RARDAT(A)) Q:'A  S B=$G(RARDAT(A)) S:B'="" I=I+1,RATEXT(I)="ISAAC Reference Information: "_B
"RTN","RAXMLSND",109,0)
 . S RATEXT(I+1)=""
"RTN","RAXMLSND",110,0)
 . S XMTEXT="RATEXT(" D ^XMD
"RTN","RAXMLSND",111,0)
 . ; remove item from send
"RTN","RAXMLSND",112,0)
 . S ^XTMP(RAXTMPNM,"DONE",RAA)=RA71IEN_U_RAS_$$NOW^XLFDT_U_RADUZ
"RTN","RAXMLSND",113,0)
 . K ^XTMP(RAXTMPNM,"SEND",RAA)
"RTN","RAXMLSND",114,0)
 . L -^XTMP(RAXTMPNM,"SEND",RAA)
"RTN","RAXMLSND",115,0)
 . ;
"RTN","RAXMLSND",116,0)
 S RAERR=RAERR+1,^XTMP(RAXTMPNM,"SEND",RAA,"ERROR")=RAERR,^XTMP(RAXTMPNM,"SEND",RAA,"ERROR",RAERR)=STATUS
"RTN","RAXMLSND",117,0)
 L -^XTMP(RAXTMPNM,"SEND",RAA)
"RTN","RAXMLSND",118,0)
 G X2
"RTN","RAXMLSND",119,0)
 ;
"RTN","RAXMLSND",120,0)
XMLOUT K CNT,A,B,C,RAT,RADUZ,RAG,RAS,RA71IEN,RAA,RATEXT,RARDAT,RASDAT,RARHD,RASHD,RAFLG,RAMETH,URL,RAXTVER,RANOS3,RASITEN,RAXTMPNM
"RTN","RAXMLSND",121,0)
 K RASITE,RANT,RANTI,AR,RANMAIL,RAGMAIL,RAIS,RAPRT,RAIPATH,LXA,LXB,RANOS1,RANOS2,RAERR,RADUZ,AA
"RTN","RAXMLSND",122,0)
 I $D(ZTQUEUED) S ZTREQ="@"
"RTN","RAXMLSND",123,0)
 Q
"RTN","RAXMLSND",124,0)
 ;
"RTN","RAXMLSND",125,0)
XUP(UP) ;change to upper case
"RTN","RAXMLSND",126,0)
 I UP="" Q ""
"RTN","RAXMLSND",127,0)
 N A
"RTN","RAXMLSND",128,0)
 S A=$TR(UP,"abcdefghijklmnopqrstuvwxyz","ABCDEFGHIJKLMNOPQRSTUVWXYZ")
"RTN","RAXMLSND",129,0)
 Q A
"RTN","RAXMLSND",130,0)
 ;
"RTN","RAXMLSND",131,0)
XMERR ; If error count is above 9 send message to RA ADPAC that request did not go out and include request in message
"RTN","RAXMLSND",132,0)
 ;
"RTN","RAXMLSND",133,0)
 K XMY,RATEXT
"RTN","RAXMLSND",134,0)
 S XMSUB="NOT ABLE TO SEND NEW NTRT REQUEST FOR RADIOLOGY"
"RTN","RAXMLSND",135,0)
 S XMY(RADUZ)=""
"RTN","RAXMLSND",136,0)
 S XMDUZ("AUTO ISAAC NTRT PROCESS")="" I RAGMAIL'="" S XMY($P(RAGMAIL,"@",1))=""
"RTN","RAXMLSND",137,0)
 S RATEXT(1)="A new Radiology Procedure has been entered at: "_RASITEN_" / "_RASITE
"RTN","RAXMLSND",138,0)
 S RATEXT(2)=""
"RTN","RAXMLSND",139,0)
 S RATEXT(3)="Radiology Procedure Name : "_$G(LXA(.01,"I"))
"RTN","RAXMLSND",140,0)
 S RATEXT(4)=""
"RTN","RAXMLSND",141,0)
 ; the error statuses
"RTN","RAXMLSND",142,0)
 S A=0,C=5 F  S A=$O(^XTMP(RAXTMPNM,"SEND",RAA,"ERROR",A)) Q:'A  S B=^XTMP(RAXTMPNM,"SEND",RAA,"ERROR",A) D  ;<
"RTN","RAXMLSND",143,0)
 . S RATEXT(C)="Error number: "_A_" Error Reason: "_B,RATEXT(C+1)=""
"RTN","RAXMLSND",144,0)
 . S C=C+2
"RTN","RAXMLSND",145,0)
 S RATEXT(C)="Original Message Contents:",RATEXT(C+1)="",C=C+2
"RTN","RAXMLSND",146,0)
 S A=0 F  S A=$O(RAT(A)) Q:'A  S B=RAT(A),RATEXT(C)=B,C=C+1
"RTN","RAXMLSND",147,0)
 S RATEXT(C)=""
"RTN","RAXMLSND",148,0)
 S XMTEXT="RATEXT(" D ^XMD
"RTN","RAXMLSND",149,0)
 M ^XTMP(RAXTMPNM,"NOTSENT",RAA)=^XTMP(RAXTMPNM,"SEND",RAA)
"RTN","RAXMLSND",150,0)
 K ^XTMP(RAXTMPNM,"SEND",RAA)
"RTN","RAXMLSND",151,0)
 L -^XTMP(RAXTMPNM,"SEND",RAA)
"RTN","RAXMLSND",152,0)
 Q
"RTN","RAXMLSND",153,0)
 ;
"RTN","RAXMLSND",154,0)
NOTVALID ; if not valid to send to ISAAC then only send MAILMAN message to RANTRT group
"RTN","RAXMLSND",155,0)
 K XMY,RATEXT
"RTN","RAXMLSND",156,0)
 S XMSUB="NOT ABLE TO SEND NEW NTRT REQUEST FOR RADIOLOGY."
"RTN","RAXMLSND",157,0)
 S XMY(RADUZ)=""
"RTN","RAXMLSND",158,0)
 S XMDUZ("AUTO ISAAC NTRT PROCESS")="" I RAGMAIL'="" S XMY($P(RAGMAIL,"@",1))=""
"RTN","RAXMLSND",159,0)
 S RATEXT(1)="A new Radiology Procedure has been entered at: "_RASITEN_" / "_RASITE
"RTN","RAXMLSND",160,0)
 S RATEXT(2)=""
"RTN","RAXMLSND",161,0)
 S RATEXT(3)="Radiology Procedure Name : "_$G(LXA(.01,"I"))
"RTN","RAXMLSND",162,0)
 S RATEXT(4)=""
"RTN","RAXMLSND",163,0)
 S RATEXT(5)=" **** This message was not sent to ISAAC due to one of the following reasons: ****"
"RTN","RAXMLSND",164,0)
 S A="",B="",C="",D="",E="" S:RANOS1=1 A="No Send Location" S:'$$PROD^XUPROD() B="Not a Production System" S:AA'["DOMAIN.EXT" C="Not a VA System"
"RTN","RAXMLSND",165,0)
 I RANOS3=1 S:$G(RANTI(11,"I"))="" D="Missing ISAAC Web Address" S:$G(RANTI(10,"I"))="" E="Missing ISAAC Port Number"
"RTN","RAXMLSND",166,0)
 I B'=""!(C'="") D  ;<
"RTN","RAXMLSND",167,0)
 . I B'="" S:A'="" A=A_" , " S A=A_B
"RTN","RAXMLSND",168,0)
 . I C'="" S:A'="" A=A_" , " S A=A_C
"RTN","RAXMLSND",169,0)
 . I D'="" S:A'="" A=A_" , " S A=A_D
"RTN","RAXMLSND",170,0)
 . I E'="" S:A'="" A=A_" , " S A=A_E
"RTN","RAXMLSND",171,0)
 S RATEXT(6)=A,RATEXT(7)="",C=8
"RTN","RAXMLSND",172,0)
 S RATEXT(C)="Original Message Contents:",RATEXT(C+1)="",C=C+2
"RTN","RAXMLSND",173,0)
 S A=0 F  S A=$O(RAT(A)) Q:'A  S B=RAT(A),RATEXT(C)=B,C=C+1
"RTN","RAXMLSND",174,0)
 S RATEXT(C)=""
"RTN","RAXMLSND",175,0)
 S XMTEXT="RATEXT(" D ^XMD
"RTN","RAXMLSND",176,0)
 K ^XTMP(RAXTMPNM,"SEND",RAA)
"RTN","RAXMLSND",177,0)
 L -^XTMP(RAXTMPNM,"SEND",RAA)
"RTN","RAXMLSND",178,0)
 Q
"RTN","RAXMLSND",179,0)
 ;
"SEC","^DIC",71.11,71.11,0,"AUDIT")
@
"SEC","^DIC",71.11,71.11,0,"DD")
@
"SEC","^DIC",71.11,71.11,0,"DEL")
@
"SEC","^DIC",71.11,71.11,0,"LAYGO")
@
"SEC","^DIC",71.11,71.11,0,"RD")
@
"SEC","^DIC",71.11,71.11,0,"WR")
@
"VER")
8.0^22.2
"^DD",71.11,71.11,0)
FIELD^^17^31
"^DD",71.11,71.11,0,"DDA")
N
"^DD",71.11,71.11,0,"DT")
3170331
"^DD",71.11,71.11,0,"IX","B",71.11,.01)

"^DD",71.11,71.11,0,"NM","NEW RAD PROCEDURE WORKUP")

"^DD",71.11,71.11,0,"VRPK")
RA
"^DD",71.11,71.11,.01,0)
NAME^RFX^^0;1^K:X[""""!($A(X)=45) X S:$D(X) X=$$UP^XLFSTR(X) K:$L(X)>60!($L(X)<3) X I $D(X) K:'+$$UNI30^RAUTL14(+$G(DA),X) X
"^DD",71.11,71.11,.01,1,0)
^.1
"^DD",71.11,71.11,.01,1,1,0)
71.11^B
"^DD",71.11,71.11,.01,1,1,1)
S ^RAMRPF(71.11,"B",$E(X,1,30),DA)=""
"^DD",71.11,71.11,.01,1,1,2)
K ^RAMRPF(71.11,"B",$E(X,1,30),DA)
"^DD",71.11,71.11,.01,3)
Answer must be 1-60 characters in length. First 30 must be unique.
"^DD",71.11,71.11,.01,21,0)
^^2^2^3161018^
"^DD",71.11,71.11,.01,21,1,0)
This field contains the name of a new radiology procedure of a detailed
"^DD",71.11,71.11,.01,21,2,0)
type.
"^DD",71.11,71.11,.01,"DT")
3161129
"^DD",71.11,71.11,2,0)
SUPPRESS RADIOPHARM PROMPT^S^0:Ask Radiopharmaceutical;1:Suppress Radiopharmaceutical prompt;^0;2^Q
"^DD",71.11,71.11,2,3)
Enter '1' if the radiopharmaceutical prompt(s) should be suppressed.
"^DD",71.11,71.11,2,21,0)
^.001^9^9^3161129^^
"^DD",71.11,71.11,2,21,1,0)
This question only applies to procedures with
"^DD",71.11,71.11,2,21,2,0)
an imaging type that use radiopharmaceuticals
"^DD",71.11,71.11,2,21,3,0)
(i.e. nuclear medicine or cardiology studies).
"^DD",71.11,71.11,2,21,4,0)
If the exam status set-up for the affected
"^DD",71.11,71.11,2,21,5,0)
imaging types specifies that 
"^DD",71.11,71.11,2,21,6,0)
radiopharmaceutical data should be asked and/or
"^DD",71.11,71.11,2,21,7,0)
required to progress to various statuses, this
"^DD",71.11,71.11,2,21,8,0)
field can be used to over-ride that
"^DD",71.11,71.11,2,21,9,0)
requirement. 
"^DD",71.11,71.11,2,"DT")
3161129
"^DD",71.11,71.11,3,0)
REQUIRED FLASH CARD PRINTER^P3.5'^%ZIS(1,^0;3^Q
"^DD",71.11,71.11,3,3)
Select a device which will print flash cards for this procedure.
"^DD",71.11,71.11,3,21,0)
^^7^7^3161018^
"^DD",71.11,71.11,3,21,1,0)
This field contains the name (1-20 characters)
"^DD",71.11,71.11,3,21,2,0)
of the location where the flash cards for this
"^DD",71.11,71.11,3,21,3,0)
procedure are to be printed.  Normally, the
"^DD",71.11,71.11,3,21,4,0)
flash cards are printed at the reception desk,
"^DD",71.11,71.11,3,21,5,0)
however, for particular procedures the flash
"^DD",71.11,71.11,3,21,6,0)
cards may be printed at a different location
"^DD",71.11,71.11,3,21,7,0)
such as where the exam is to be performed.
"^DD",71.11,71.11,3,"DT")
3161018
"^DD",71.11,71.11,4,0)
REQUIRED FLASH CARD FORMAT^P78.2'^RA(78.2,^0;4^Q
"^DD",71.11,71.11,4,3)
Enter the format for this flash card. 
"^DD",71.11,71.11,4,21,0)
^^6^6^3161018^
"^DD",71.11,71.11,4,21,1,0)
This field is used to define the format of the
"^DD",71.11,71.11,4,21,2,0)
flash card.  Normally, the standard default
"^DD",71.11,71.11,4,21,3,0)
format for the user's rad/nuc med location is
"^DD",71.11,71.11,4,21,4,0)
used, however, particular procedures may
"^DD",71.11,71.11,4,21,5,0)
require a flash card format that is different
"^DD",71.11,71.11,4,21,6,0)
than the standard format.
"^DD",71.11,71.11,4,"DT")
3161018
"^DD",71.11,71.11,5,0)
PROMPT FOR MEDS^S^Y:YES;^0;5^Q
"^DD",71.11,71.11,5,3)
Enter 'Y' if case edits and status tracking should prompt for meds.
"^DD",71.11,71.11,5,21,0)
^^5^5^3161018^
"^DD",71.11,71.11,5,21,1,0)
If this field is set to YES, case edits will prompt for meds administered 
"^DD",71.11,71.11,5,21,2,0)
for this procedure.  To make Status Tracking prompt for meds administered, 
"^DD",71.11,71.11,5,21,3,0)
this field is set to YES, and the Examination Status parameter 'Ask 
"^DD",71.11,71.11,5,21,4,0)
Medications & Dosages' is set to yes for one or
"^DD",71.11,71.11,5,21,5,0)
more statuses of the procedure's imaging type.
"^DD",71.11,71.11,5,"DT")
3161018
"^DD",71.11,71.11,6,0)
TYPE OF PROCEDURE^RS^B:BROAD;D:DETAILED;S:SERIES;P:PARENT;^0;6^Q
"^DD",71.11,71.11,6,3)
Select 'B', 'D', 'S' or 'P' for type of procedure.
"^DD",71.11,71.11,6,21,0)
^^2^2^3161018^
"^DD",71.11,71.11,6,21,1,0)
This field holds the type of procedure.  This must be 'D' for Detailed
"^DD",71.11,71.11,6,21,2,0)
to be included in the MRPF association process.
"^DD",71.11,71.11,6,"DT")
3161018
"^DD",71.11,71.11,7,0)
STAFF REVIEW REQUIRED^S^Y:YES;N:NO;^0;7^Q
"^DD",71.11,71.11,7,3)
 Enter a 'YES' if this procedure requires staff physician review.
"^DD",71.11,71.11,7,21,0)
^.001^4^4^3161027^^
"^DD",71.11,71.11,7,21,1,0)
This field contains a 'Yes' or 'No' value to
"^DD",71.11,71.11,7,21,2,0)
indicate if this procedure requires an
"^DD",71.11,71.11,7,21,3,0)
interpreting staff physician's review of the
"^DD",71.11,71.11,7,21,4,0)
interpreting resident's report results.
"^DD",71.11,71.11,7,"DT")
3161018
"^DD",71.11,71.11,9,0)
CPT CODE^P81'^ICPT(^0;9^Q
"^DD",71.11,71.11,9,3)
Enter the appropriate CPT for this procedure.
"^DD",71.11,71.11,9,21,0)
^^4^4^3161018^
"^DD",71.11,71.11,9,21,1,0)
This field contains the CPT code (must be a
"^DD",71.11,71.11,9,21,2,0)
number) for this procedure. All CPT (Current
"^DD",71.11,71.11,9,21,3,0)
Procedural Terminology) codes are issued by the
"^DD",71.11,71.11,9,21,4,0)
AMA. The CPT File is the responsibility of MAS.
"^DD",71.11,71.11,9,"DT")
3161018
"^DD",71.11,71.11,11,0)
RAD/NM PHYS APPROVAL REQUIRED^S^y:YES;n:NO;^0;11^Q
"^DD",71.11,71.11,11,3)
Enter a 'YES' if requesting this procedure need RAD M.D. approval.
"^DD",71.11,71.11,11,21,0)
^.001^8^8^3161028^^
"^DD",71.11,71.11,11,21,1,0)
This field is set to indicate whether or not
"^DD",71.11,71.11,11,21,2,0)
requesting this procedure requires a Radiology
"^DD",71.11,71.11,11,21,3,0)
or Nuclear Med physician 's approval. If this
"^DD",71.11,71.11,11,21,4,0)
field contains a 'Yes', the appropriate Imaging
"^DD",71.11,71.11,11,21,5,0)
Service must be contacted to request the
"^DD",71.11,71.11,11,21,6,0)
procedure. If this field is set to 'No', the
"^DD",71.11,71.11,11,21,7,0)
procedure can be requested without this
"^DD",71.11,71.11,11,21,8,0)
approval. 
"^DD",71.11,71.11,11,"DT")
3161018
"^DD",71.11,71.11,12,0)
TYPE OF IMAGING^RP79.2'^RA(79.2,^0;12^Q
"^DD",71.11,71.11,12,3)
Enter the type of imaging to be used for this procedure.
"^DD",71.11,71.11,12,21,0)
^^1^1^3161018^
"^DD",71.11,71.11,12,21,1,0)
This is the type of imaging that will be used for this procedure.
"^DD",71.11,71.11,12,"DT")
3161018
"^DD",71.11,71.11,13,0)
HEALTH SUMMARY WITH REQUEST^P142'^GMT(142,^0;13^Q
"^DD",71.11,71.11,13,3)
Enter the type of Health Summary to include with this procedure.
"^DD",71.11,71.11,13,21,0)
^.001^3^3^3161028^^
"^DD",71.11,71.11,13,21,1,0)
This field points to the HEALTH SUMMARY TYPE file.  When a request is made 
"^DD",71.11,71.11,13,21,2,0)
this field is checked for an associated Health Summary type and, if one 
"^DD",71.11,71.11,13,21,3,0)
exists, it is printed along with the request.
"^DD",71.11,71.11,13,"DT")
3161018
"^DD",71.11,71.11,17,0)
DISPLAY ED DESC WHEN ORDERED^S^y:YES;n:NO;^0;17^Q
"^DD",71.11,71.11,17,3)
Enter 'YES' if the Educational Description is to be displayed when this procedure is ordered.
"^DD",71.11,71.11,17,21,0)
^^5^5^3161129^
"^DD",71.11,71.11,17,21,1,0)
If the Educational Description of a procedure
"^DD",71.11,71.11,17,21,2,0)
should be displayed along with the procedure
"^DD",71.11,71.11,17,21,3,0)
message (if any) at the time the procedure is
"^DD",71.11,71.11,17,21,4,0)
ordered, enter 'Yes'.  If only the procedure
"^DD",71.11,71.11,17,21,5,0)
message should be displayed, enter 'No'.
"^DD",71.11,71.11,17,"DT")
3161129
"^DD",71.11,71.11,18,0)
SINGLE REPORT^S^Y:YES;^0;18^Q
"^DD",71.11,71.11,18,3)
Enter YES if the descendants from this procedure should have their data combined into 1 report.
"^DD",71.11,71.11,18,21,0)
^^11^11^3161019^
"^DD",71.11,71.11,18,21,1,0)
This field should only be used for parent
"^DD",71.11,71.11,18,21,2,0)
procedures.  If this field is left un-answered,
"^DD",71.11,71.11,18,21,3,0)
then the reporting of this procedure's 
"^DD",71.11,71.11,18,21,4,0)
descendants will be put into separate
"^DD",71.11,71.11,18,21,5,0)
reports, as in Rad/NM v4.5 If this field is
"^DD",71.11,71.11,18,21,6,0)
answered 'Y', then the reporting of this
"^DD",71.11,71.11,18,21,7,0)
procedure's  descendants will be combined into one
"^DD",71.11,71.11,18,21,8,0)
report, where the case  records for these descendants will have the
"^DD",71.11,71.11,18,21,9,0)
same data for  report text, impression, verifier,
"^DD",71.11,71.11,18,21,10,0)
pre-verifier, verifier,  staff(prim & sec), residents(prim & sec),
"^DD",71.11,71.11,18,21,11,0)
and diagnoses, and  all other report-related fields.  
"^DD",71.11,71.11,18,"DT")
3161019
"^DD",71.11,71.11,19,0)
PROMPT FOR RADIOPHARM RX^S^y:YES;^0;19^Q
"^DD",71.11,71.11,19,3)
Answer 'Yes' if case edits should prompt for Radiopharmaceutical Prescription information for this procedure.
"^DD",71.11,71.11,19,21,0)
^^16^16^3161019^
"^DD",71.11,71.11,19,21,1,0)
This field applies only to Detailed or Series
"^DD",71.11,71.11,19,21,2,0)
procedures with an Imaging Type that uses
"^DD",71.11,71.11,19,21,3,0)
radiopharmaceuticals. It controls whether case
"^DD",71.11,71.11,19,21,4,0)
edit and status tracking options prompt for
"^DD",71.11,71.11,19,21,5,0)
prescribing physician, prescribed 
"^DD",71.11,71.11,19,21,6,0)
radiopharmaceutical dose and witness to dose
"^DD",71.11,71.11,19,21,7,0)
administration. If you answer 'YES' to this
"^DD",71.11,71.11,19,21,8,0)
field, prescriber prompts will appear for any 
"^DD",71.11,71.11,19,21,9,0)
radiopharmaceuticals entered for this
"^DD",71.11,71.11,19,21,10,0)
procedure.  If this field is left blank,
"^DD",71.11,71.11,19,21,11,0)
prescriber and witness prompts will not appear. 
"^DD",71.11,71.11,19,21,12,0)
If this field is set to 'YES', Status Tracking
"^DD",71.11,71.11,19,21,13,0)
will prompt during each edit session until the
"^DD",71.11,71.11,19,21,14,0)
data is entered; case edits will always prompt,
"^DD",71.11,71.11,19,21,15,0)
even if prescriber and witness data has already
"^DD",71.11,71.11,19,21,16,0)
been entered. 
"^DD",71.11,71.11,19,"DT")
3161019
"^DD",71.11,71.11,20,0)
CONTRAST MEDIA USED^S^Y:YES;N:NO;^0;20^Q
"^DD",71.11,71.11,20,3)
Enter 'Yes' if a contrast agent is used with the procedure.
"^DD",71.11,71.11,20,21,0)
^^3^3^3161018^
"^DD",71.11,71.11,20,21,1,0)
This field contains a value to indicate if a contrast agent is used
"^DD",71.11,71.11,20,21,2,0)
with this Rad/Nuc Med procedure. Acceptable values are: 'Y' for 'Yes'
"^DD",71.11,71.11,20,21,3,0)
and 'N' for 'No'.
"^DD",71.11,71.11,20,"DT")
3161018
"^DD",71.11,71.11,50,0)
DEFAULT RADIOPHARMACEUTICALS^71.1108PA^^71.1108;0
"^DD",71.11,71.11,50,21,0)
^.001^10^10^3161129^^^
"^DD",71.11,71.11,50,21,1,0)
Default radiopharmaceuticals and related
"^DD",71.11,71.11,50,21,2,0)
information are edited by ADPACs during system
"^DD",71.11,71.11,50,21,3,0)
set-up.  If default radiopharmaceutical(s) are 
"^DD",71.11,71.11,50,21,4,0)
entered for a procedure, they will be
"^DD",71.11,71.11,50,21,5,0)
automatically entered on the patient record
"^DD",71.11,71.11,50,21,6,0)
each time this procedure is registered. 
"^DD",71.11,71.11,50,21,7,0)
Information entered by the ADPAC related to the
"^DD",71.11,71.11,50,21,8,0)
radiopharmaceutical may appear during case edit
"^DD",71.11,71.11,50,21,9,0)
as a default response or may be used for edit
"^DD",71.11,71.11,50,21,10,0)
checking.
"^DD",71.11,71.11,55,0)
DEFAULT MEDICATIONS^71.1155P^^P;0
"^DD",71.11,71.11,55,21,0)
^.001^7^7^3161129^^^
"^DD",71.11,71.11,55,21,1,0)
Default medication(s) may be entered by the
"^DD",71.11,71.11,55,21,2,0)
ADPAC for a procedure.  If they are entered,
"^DD",71.11,71.11,55,21,3,0)
the system will automatically enter them on the 
"^DD",71.11,71.11,55,21,4,0)
patient's exam record whenever the procedure is
"^DD",71.11,71.11,55,21,5,0)
registered.  NOTE: Default Radiopharmaceuticals
"^DD",71.11,71.11,55,21,6,0)
may NOT be entered here; they should be entered
"^DD",71.11,71.11,55,21,7,0)
on a separate field. 
"^DD",71.11,71.11,75,0)
FILMS NEEDED^71.1102P^^F;0
"^DD",71.11,71.11,75,21,0)
^.001^3^3^3161129^^^^
"^DD",71.11,71.11,75,21,1,0)
This is a multiple field containing information
"^DD",71.11,71.11,75,21,2,0)
about the films usually needed for this
"^DD",71.11,71.11,75,21,3,0)
procedure.
"^DD",71.11,71.11,100,0)
INACTIVATION DATE^D^^I;1^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",71.11,71.11,100,3)
Enter the date this procedure became inactive.
"^DD",71.11,71.11,100,21,0)
^^8^8^3161018^
"^DD",71.11,71.11,100,21,1,0)
This field contains the date this procedure was
"^DD",71.11,71.11,100,21,2,0)
inactivated by the rad/nuc med coordinator.
"^DD",71.11,71.11,100,21,3,0)
Until the day following the inactivation date, 
"^DD",71.11,71.11,100,21,4,0)
the procedure appears on the active procedure
"^DD",71.11,71.11,100,21,5,0)
list and may be selected.  If this procedure is
"^DD",71.11,71.11,100,21,6,0)
active in the Common Procedure file, it must be 
"^DD",71.11,71.11,100,21,7,0)
removed from the active common procedure list
"^DD",71.11,71.11,100,21,8,0)
before an inactivation date can be entered. 
"^DD",71.11,71.11,100,"DT")
3161018
"^DD",71.11,71.11,125,0)
CONTRAST MEDIA^71.11125S^^CM;0
"^DD",71.11,71.11,125,21,0)
^.001^2^2^3161028^^
"^DD",71.11,71.11,125,21,1,0)
This field identifies the contrast agent(s)
"^DD",71.11,71.11,125,21,2,0)
associated with this Rad/Nuc Med procedure.
"^DD",71.11,71.11,135,0)
DEFAULT CPT MODIFIERS(PROC)^71.11135P^^DCM;0
"^DD",71.11,71.11,135,21,0)
^^4^4^3161018^
"^DD",71.11,71.11,135,21,1,0)
One or more default CPT Modifiers may be
"^DD",71.11,71.11,135,21,2,0)
entered for this procedure.  Each entry will be
"^DD",71.11,71.11,135,21,3,0)
screened against the CPT CODE for this
"^DD",71.11,71.11,135,21,4,0)
procedure.
"^DD",71.11,71.11,150,0)
SYNONYM^71.111^^1;0
"^DD",71.11,71.11,150,21,0)
^.001^3^3^3161103^^^^
"^DD",71.11,71.11,150,21,1,0)
This is a multiple field which allows
"^DD",71.11,71.11,150,21,2,0)
procedure names to be cross-referenced by
"^DD",71.11,71.11,150,21,3,0)
other names. They may be locally preferred names, or a common misspelling.
"^DD",71.11,71.11,175,0)
AMIS CODES^71.1103P^^2;0
"^DD",71.11,71.11,175,21,0)
^.001^3^3^3161028^^
"^DD",71.11,71.11,175,21,1,0)
This is a multiple field containing information
"^DD",71.11,71.11,175,21,2,0)
for the AMIS codes associated with this
"^DD",71.11,71.11,175,21,3,0)
procedure. 
"^DD",71.11,71.11,200,0)
MESSAGE^71.12P^^3;0
"^DD",71.11,71.11,200,21,0)
^.001^2^2^3161028^^
"^DD",71.11,71.11,200,21,1,0)
This is a multiple, used to select messages
"^DD",71.11,71.11,200,21,2,0)
that pertain to this procedure. 
"^DD",71.11,71.11,300,0)
DESCENDENTS^71.1105P^^71.1105;0
"^DD",71.11,71.11,300,21,0)
^^6^6^3170331^^^^
"^DD",71.11,71.11,300,21,1,0)
This is a multiple field containing procedures
"^DD",71.11,71.11,300,21,2,0)
that are considered descendents of this parent
"^DD",71.11,71.11,300,21,3,0)
procedure.  Only 'Parent' procedures may have 
"^DD",71.11,71.11,300,21,4,0)
descendents.  If a 'Parent' procedure is
"^DD",71.11,71.11,300,21,5,0)
ordered, its descendents will be registered
"^DD",71.11,71.11,300,21,6,0)
during the registration function.
"^DD",71.11,71.11,500,0)
EDUCATIONAL DESCRIPTION^71.13^^EDU;0
"^DD",71.11,71.11,500,21,0)
^.001^10^10^3161028^^
"^DD",71.11,71.11,500,21,1,0)
The text entered here should describe the
"^DD",71.11,71.11,500,21,2,0)
procedure.  It may be used by clinicians who
"^DD",71.11,71.11,500,21,3,0)
are trying to familiarize themselves with
"^DD",71.11,71.11,500,21,4,0)
imaging procedures that are available via an
"^DD",71.11,71.11,500,21,5,0)
option within this software system.  This text
"^DD",71.11,71.11,500,21,6,0)
can also be displayed along with the procedure
"^DD",71.11,71.11,500,21,7,0)
message during the ordering process if the
"^DD",71.11,71.11,500,21,8,0)
Rad/Nuc Med Procedure file parameter that 
"^DD",71.11,71.11,500,21,9,0)
controls displaying it when ordered is set to
"^DD",71.11,71.11,500,21,10,0)
'Yes'.
"^DD",71.11,71.11,731,0)
MODALITY^71.11731P^^MDL;0
"^DD",71.11,71.11,731,21,0)
^.001^3^3^3161028^^
"^DD",71.11,71.11,731,21,1,0)
This multiple field points to the RAD MODALITY DEFINED
"^DD",71.11,71.11,731,21,2,0)
TERMS file (#73.1).  Which is a list of
"^DD",71.11,71.11,731,21,3,0)
procedure modes.  
"^DD",71.11,71.11,900,0)
MRPF NAME^P71.99'^RAMRPF(71.99,^NTRT;1^Q
"^DD",71.11,71.11,900,3)
Enter the Master Radiology Procedure Gold Name that matches this entry.
"^DD",71.11,71.11,900,21,0)
^^4^4^3161018^
"^DD",71.11,71.11,900,21,1,0)
This field is a pointer to the MASTER RADIOLOGY
"^DD",71.11,71.11,900,21,2,0)
PROCEDURE file (#71.99).  This is the link to
"^DD",71.11,71.11,900,21,3,0)
the national standard names for radiology
"^DD",71.11,71.11,900,21,4,0)
procedures.
"^DD",71.11,71.11,900,"DT")
3161018
"^DD",71.11,71.11,901,0)
Exception Flag^S^Y:YES;^NTRT;2^Q
"^DD",71.11,71.11,901,3)
Enter Yes if NTRT request is approved by the procedure.
"^DD",71.11,71.11,901,21,0)
^^9^9^3161018^
"^DD",71.11,71.11,901,21,1,0)
When a new procedure is entered or if there is
"^DD",71.11,71.11,901,21,2,0)
no match to this procedure in the MASTER
"^DD",71.11,71.11,901,21,3,0)
RADIOLOGY PROCEDURE file (#71.99) this field
"^DD",71.11,71.11,901,21,4,0)
will be set to 'YES' to indicate that this
"^DD",71.11,71.11,901,21,5,0)
procedure has been submitted to the New 
"^DD",71.11,71.11,901,21,6,0)
Terminology Rapid Turnaround (NTRT) team for
"^DD",71.11,71.11,901,21,7,0)
action.  When a new procedure is created for
"^DD",71.11,71.11,901,21,8,0)
the MRPF that is a match to this procedure this 
"^DD",71.11,71.11,901,21,9,0)
field will be set to null.
"^DD",71.11,71.11,901,"DT")
3161018
"^DD",71.11,71.11,902,0)
ENTRY CREATION DATE^D^^NTRT;3^S %DT="EX" D ^%DT S X=Y K:Y<1 X
"^DD",71.11,71.11,902,3)
Enter the date that this procedure  was entered.
"^DD",71.11,71.11,902,21,0)
^^2^2^3161018^
"^DD",71.11,71.11,902,21,1,0)
This is the date that this procedure was
"^DD",71.11,71.11,902,21,2,0)
created in this file.
"^DD",71.11,71.11,902,"DT")
3161018
"^DD",71.11,71.11,903,0)
LOINC^F^^NTRT;4^K:$L(X)>20!($L(X)<3) X
"^DD",71.11,71.11,903,3)
Answer must be 3-20 characters in length.
"^DD",71.11,71.11,903,21,0)
^^3^3^3161018^
"^DD",71.11,71.11,903,21,1,0)
This field holds the LOINC from the mapped
"^DD",71.11,71.11,903,21,2,0)
Procedure in the MASTER RADIOLOGY PROCEDURE
"^DD",71.11,71.11,903,21,3,0)
file (#71.99).
"^DD",71.11,71.11,903,"DT")
3161018
"^DD",71.11,71.1102,0)
FILMS NEEDED SUB-FIELD^^.01^1
"^DD",71.11,71.1102,0,"DT")
3161018
"^DD",71.11,71.1102,0,"IX","B",71.1102,.01)

"^DD",71.11,71.1102,0,"NM","FILMS NEEDED")

"^DD",71.11,71.1102,0,"UP")
71.11
"^DD",71.11,71.1102,.01,0)
FILM TYPE^M*P78.4'^RA(78.4,^0;1^S DIC("S")="I $S('$D(^(""I"")):1,'^(""I""):1,DT'>^(""I""):1,1:0),('$D(^RA(78.4,""AW"",1,+Y)))" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",71.11,71.1102,.01,1,0)
^.1
"^DD",71.11,71.1102,.01,1,1,0)
71.1102^B
"^DD",71.11,71.1102,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),"F","B",$E(X,1,30),DA)=""
"^DD",71.11,71.1102,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),"F","B",$E(X,1,30),DA)
"^DD",71.11,71.1102,.01,3)
For those frequently performed procedures, enter a film type.
"^DD",71.11,71.1102,.01,12)
Only active non wasted film types are selectable.
"^DD",71.11,71.1102,.01,12.1)
S DIC("S")="I $S('$D(^(""I"")):1,'^(""I""):1,DT'>^(""I""):1,1:0),('$D(^RA(78.4,""AW"",1,+Y)))"
"^DD",71.11,71.1102,.01,21,0)
^.001^3^3^3161018^^
"^DD",71.11,71.1102,.01,21,1,0)
This field contains a default value of the type
"^DD",71.11,71.1102,.01,21,2,0)
of film (from the Film Sizes File) usually
"^DD",71.11,71.1102,.01,21,3,0)
needed for this procedure.
"^DD",71.11,71.1102,.01,"DT")
3161018
"^DD",71.11,71.1103,0)
AMIS CODES SUB-FIELD^^3^3
"^DD",71.11,71.1103,0,"DT")
3161018
"^DD",71.11,71.1103,0,"IX","B",71.1103,.01)

"^DD",71.11,71.1103,0,"NM","AMIS CODES")

"^DD",71.11,71.1103,0,"UP")
71.11
"^DD",71.11,71.1103,.01,0)
AMIS CODE^MP71.1'^RAMIS(71.1,^0;1^Q
"^DD",71.11,71.1103,.01,1,0)
^.1
"^DD",71.11,71.1103,.01,1,1,0)
71.1103^B
"^DD",71.11,71.1103,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),2,"B",$E(X,1,30),DA)=""
"^DD",71.11,71.1103,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),2,"B",$E(X,1,30),DA)
"^DD",71.11,71.1103,.01,3)
Enter a valid AMIS code for this procedure.
"^DD",71.11,71.1103,.01,21,0)
^^3^3^3161018^
"^DD",71.11,71.1103,.01,21,1,0)
This field contains the valid AMIS code(s)
"^DD",71.11,71.1103,.01,21,2,0)
(from the Major AMIS Codes File) associated
"^DD",71.11,71.1103,.01,21,3,0)
with this exam procedure.
"^DD",71.11,71.1103,.01,"DT")
3161018
"^DD",71.11,71.1103,2,0)
AMIS WEIGHT MULTIPLIER^NJ2,0^^0;2^K:+X'=X!(X>99)!(X<1)!(X?.E1"."1N.N) X
"^DD",71.11,71.1103,2,3)
Type a number between 1 and 99, 0 decimal digits.
"^DD",71.11,71.1103,2,21,0)
^^24^24^3161018^
"^DD",71.11,71.1103,2,21,1,0)
This field contains a number (0-99) to
"^DD",71.11,71.1103,2,21,2,0)
indicate to the various workload report
"^DD",71.11,71.1103,2,21,3,0)
routines how many times to multiply the
"^DD",71.11,71.1103,2,21,4,0)
weighted work units associated with the AMIS
"^DD",71.11,71.1103,2,21,5,0)
code.  The weight for each AMIS code is
"^DD",71.11,71.1103,2,21,6,0)
stored in the 'MAJOR RAD/NUC MED AMIS CODE'
"^DD",71.11,71.1103,2,21,7,0)
file.
"^DD",71.11,71.1103,2,21,8,0)
 
"^DD",71.11,71.1103,2,21,9,0)
Most multipliers will be 1.  However, there
"^DD",71.11,71.1103,2,21,10,0)
are some that are greater than 1.  For
"^DD",71.11,71.1103,2,21,11,0)
example, the procedure called 'UPPER GI +
"^DD",71.11,71.1103,2,21,12,0)
SMALL BOWEL' has the AMIS code
"^DD",71.11,71.1103,2,21,13,0)
9-GASTROINTESTINAL which has a weight of 6
"^DD",71.11,71.1103,2,21,14,0)
work units.  But, the AMIS multiplier is 2. 
"^DD",71.11,71.1103,2,21,15,0)
Therefore on the workload reports, the site
"^DD",71.11,71.1103,2,21,16,0)
will get credit for 12 weighted work units
"^DD",71.11,71.1103,2,21,17,0)
each time it is performed. 
"^DD",71.11,71.1103,2,21,18,0)
 
"^DD",71.11,71.1103,2,21,19,0)
Radiology Central Office has directed that
"^DD",71.11,71.1103,2,21,20,0)
the weighted work unit for Ultrasound
"^DD",71.11,71.1103,2,21,21,0)
procedures involving multiple organs in the
"^DD",71.11,71.1103,2,21,22,0)
same visit can be counted only once if the
"^DD",71.11,71.1103,2,21,23,0)
organs are located close to each other. 
"^DD",71.11,71.1103,2,21,24,0)
(i.e.  Liver and Gallbladder) 
"^DD",71.11,71.1103,2,"DT")
3161018
"^DD",71.11,71.1103,3,0)
BILATERAL?^S^Y:YES;N:NO;^0;3^Q
"^DD",71.11,71.1103,3,3)
Enter a 'YES' if this procedure is considered bilateral.
"^DD",71.11,71.1103,3,21,0)
^.001^5^5^3161028^^
"^DD",71.11,71.1103,3,21,1,0)
This field will contain a 'Yes' to indicate
"^DD",71.11,71.1103,3,21,2,0)
that this is a bilateral procedure or a 'No'
"^DD",71.11,71.1103,3,21,3,0)
if it is not a bilateral procedure.  If it
"^DD",71.11,71.1103,3,21,4,0)
contains a 'Yes', then the system multiplies
"^DD",71.11,71.1103,3,21,5,0)
the AMIS weight by 2.
"^DD",71.11,71.1103,3,"DT")
3161018
"^DD",71.11,71.1105,0)
DESCENDENTS SUB-FIELD^^.01^1
"^DD",71.11,71.1105,0,"DT")
3170331
"^DD",71.11,71.1105,0,"IX","B",71.1105,.01)

"^DD",71.11,71.1105,0,"NM","DESCENDENTS")

"^DD",71.11,71.1105,0,"UP")
71.11
"^DD",71.11,71.1105,.01,0)
DESCENDENTS^M*P71'^RAMIS(71,^0;1^S DIC("S")="I $$DESC^RANPRO1(D0,+Y)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",71.11,71.1105,.01,1,0)
^.1
"^DD",71.11,71.1105,.01,1,1,0)
71.1105^B
"^DD",71.11,71.1105,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),71.1105,"B",$E(X,1,30),DA)=""
"^DD",71.11,71.1105,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),71.1105,"B",$E(X,1,30),DA)
"^DD",71.11,71.1105,.01,3)
Enter a procedure name which is related to the parent procedure.
"^DD",71.11,71.1105,.01,12)
Select only active detailed or series procedures of the same imaging type as the parent.
"^DD",71.11,71.1105,.01,12.1)
S DIC("S")="I $$DESC^RANPRO1(D0,+Y)"
"^DD",71.11,71.1105,.01,21,0)
^.001^6^6^3170331^^
"^DD",71.11,71.1105,.01,21,1,0)
This is a multiple field containing procedures
"^DD",71.11,71.1105,.01,21,2,0)
that are considered descendents of this parent
"^DD",71.11,71.1105,.01,21,3,0)
procedure.  Only 'Parent' procedures may have 
"^DD",71.11,71.1105,.01,21,4,0)
descendents.  If a 'Parent' procedure is
"^DD",71.11,71.1105,.01,21,5,0)
ordered, its descendents will be registered
"^DD",71.11,71.1105,.01,21,6,0)
during the registration function.
"^DD",71.11,71.1105,.01,"DT")
3170331
"^DD",71.11,71.1108,0)
DEFAULT RADIOPHARMACEUTICALS SUB-FIELD^^7^7
"^DD",71.11,71.1108,0,"DT")
3161019
"^DD",71.11,71.1108,0,"IX","B",71.1108,.01)

"^DD",71.11,71.1108,0,"NM","DEFAULT RADIOPHARMACEUTICALS")

"^DD",71.11,71.1108,0,"UP")
71.11
"^DD",71.11,71.1108,.01,0)
DEFAULT RADIOPHARMACEUTICALS^MP50'^PSDRUG(^0;1^Q
"^DD",71.11,71.1108,.01,1,0)
^.1
"^DD",71.11,71.1108,.01,1,1,0)
71.1108^B
"^DD",71.11,71.1108,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),71.1108,"B",$E(X,1,30),DA)=""
"^DD",71.11,71.1108,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),71.1108,"B",$E(X,1,30),DA)
"^DD",71.11,71.1108,.01,3)
Enter default radiopharmaceutical associated with this nuclear medicine procedure.
"^DD",71.11,71.1108,.01,21,0)
^.001^12^12^3161019^^^
"^DD",71.11,71.1108,.01,21,1,0)
Default radiopharmaceuticals and related
"^DD",71.11,71.1108,.01,21,2,0)
information are edited by ADPACs during system
"^DD",71.11,71.1108,.01,21,3,0)
set-up.  If default radiopharmaceutical(s) are 
"^DD",71.11,71.1108,.01,21,4,0)
entered for a procedure, they will be
"^DD",71.11,71.1108,.01,21,5,0)
automatically entered on the patient record
"^DD",71.11,71.1108,.01,21,6,0)
Default radiopharmaceuticals and related
"^DD",71.11,71.1108,.01,21,7,0)
Information entered by the ADPAC related to the
"^DD",71.11,71.1108,.01,21,8,0)
radiopharmaceutical may appear during case edit
"^DD",71.11,71.1108,.01,21,9,0)
as a default response or may be used for edit
"^DD",71.11,71.1108,.01,21,10,0)
checking.   No default
"^DD",71.11,71.1108,.01,21,11,0)
radiopharmaceuticals may be used on 'parent'
"^DD",71.11,71.1108,.01,21,12,0)
or 'broad' type procedures.
"^DD",71.11,71.1108,.01,"DT")
3161019
"^DD",71.11,71.1108,2,0)
USUAL DOSE^NJ10,4^^0;2^K:+X'=X!(X>99999.9999)!(X<.0001)!(X?.E1"."5N.N) X
"^DD",71.11,71.1108,2,3)
Type a number between .0001 and 99999.9999, 4 decimal digits.
"^DD",71.11,71.1108,2,21,0)
^^6^6^3161019^
"^DD",71.11,71.1108,2,21,1,0)
This is the usual dosage (in mCi) associated
"^DD",71.11,71.1108,2,21,2,0)
with this radiopharmaceutical.  It will appear
"^DD",71.11,71.1108,2,21,3,0)
as an informational item on the screen just
"^DD",71.11,71.1108,2,21,4,0)
before the user is prompted for the actual
"^DD",71.11,71.1108,2,21,5,0)
Dose.  If nothing is entered in this field, no
"^DD",71.11,71.1108,2,21,6,0)
usual dose information will be displayed. 
"^DD",71.11,71.1108,2,"DT")
3161019
"^DD",71.11,71.1108,3,0)
DFLT ROUTE OF ADMINISTRATION^P71.6'^RAMIS(71.6,^0;3^Q
"^DD",71.11,71.1108,3,3)
Enter the default route of administration when this radiopharmaceutical is administered for this procedure.
"^DD",71.11,71.1108,3,21,0)
^.001^7^7^3161129^^
"^DD",71.11,71.1108,3,21,1,0)
This is the route of administration commonly
"^DD",71.11,71.1108,3,21,2,0)
associated with this radiopharmaceutical for
"^DD",71.11,71.1108,3,21,3,0)
this procedure.  It will appear as the default 
"^DD",71.11,71.1108,3,21,4,0)
response when the route of administration is
"^DD",71.11,71.1108,3,21,5,0)
asked during case editing.  If nothing is
"^DD",71.11,71.1108,3,21,6,0)
entered in this field, no default route of
"^DD",71.11,71.1108,3,21,7,0)
administration will be displayed.
"^DD",71.11,71.1108,3,"DT")
3161129
"^DD",71.11,71.1108,4,0)
DEFAULT SITE OF ADMINISTRATION^*P71.7'^RAMIS(71.7,^0;4^S DIC("S")="N RA7108 S RA7108=$G(^RAMIS(71,DA(1),""NUC"",DA,0)) I $S(+$P(RA7108,""^"",3):$D(^RAMIS(71.6,+$P(RA7108,""^"",3),""SITE"",""B"",+Y)),1:1)" D ^DIC K DIC S DIC=DIE,X=+Y K:Y<0 X
"^DD",71.11,71.1108,4,3)
Enter the default site of administration when this radiopharmaceutical is entered for this procedure.
"^DD",71.11,71.1108,4,12)
for nuclear med only, must be valid site defined for this route.
"^DD",71.11,71.1108,4,12.1)
S DIC("S")="N RA7108 S RA7108=$G(^RAMIS(71,DA(1),""NUC"",DA,0)) I $S(+$P(RA7108,""^"",3):$D(^RAMIS(71.6,+$P(RA7108,""^"",3),""SITE"",""B"",+Y)),1:1)"
"^DD",71.11,71.1108,4,21,0)
^.001^7^7^3161019^^
"^DD",71.11,71.1108,4,21,1,0)
The default bodily site for administering this
"^DD",71.11,71.1108,4,21,2,0)
radiopharmaceutical for this procedure should
"^DD",71.11,71.1108,4,21,3,0)
be entered here.  The system will use this as a 
"^DD",71.11,71.1108,4,21,4,0)
default response during case editing.  If
"^DD",71.11,71.1108,4,21,5,0)
nothing is entered here, there will be no
"^DD",71.11,71.1108,4,21,6,0)
default response to the Site of Administration
"^DD",71.11,71.1108,4,21,7,0)
question during case editing. 
"^DD",71.11,71.1108,4,"DT")
3161019
"^DD",71.11,71.1108,5,0)
HIGH ADULT DOSE^NJ10,4^^0;5^K:+X'=X!(X>99999.9999)!(X<.0001)!(X?.E1"."5N.N) X
"^DD",71.11,71.1108,5,3)
Type a number between .0001 and 99999.9999, 4 decimal digits.
"^DD",71.11,71.1108,5,21,0)
^.001^9^9^3161028^^
"^DD",71.11,71.1108,5,21,1,0)
This is the highest usual adult dosage commonly
"^DD",71.11,71.1108,5,21,2,0)
associated with this radiopharmaceutical when
"^DD",71.11,71.1108,5,21,3,0)
administered for this procedure.  The system
"^DD",71.11,71.1108,5,21,4,0)
will display this value and the low adult dose
"^DD",71.11,71.1108,5,21,5,0)
when asking for the actual dosage during case
"^DD",71.11,71.1108,5,21,6,0)
editing.  If the dosage entered for an exam
"^DD",71.11,71.1108,5,21,7,0)
falls outside of the usual high/low range, the
"^DD",71.11,71.1108,5,21,8,0)
person editing the case will see a warning
"^DD",71.11,71.1108,5,21,9,0)
message.  This is a mandatory data item.
"^DD",71.11,71.1108,5,"DT")
3161019
"^DD",71.11,71.1108,6,0)
LOW ADULT DOSE^NJ10,4^^0;6^K:+X'=X!(X>99999.9999)!(X<.0001)!(X?.E1"."5N.N) X
"^DD",71.11,71.1108,6,3)
Type a number between .0001 and 99999.9999, 4 decimal digits.
"^DD",71.11,71.1108,6,21,0)
^^11^11^3161019^
"^DD",71.11,71.1108,6,21,1,0)
This is the lowest usual adult dosage commonly
"^DD",71.11,71.1108,6,21,2,0)
associated with this radiopharmaceutical when
"^DD",71.11,71.1108,6,21,3,0)
administered for this procedure.  The system
"^DD",71.11,71.1108,6,21,4,0)
will display this value and the high adult dose
"^DD",71.11,71.1108,6,21,5,0)
when asking for the actual dosage during case
"^DD",71.11,71.1108,6,21,6,0)
editing.  If the dosage entered for an exam
"^DD",71.11,71.1108,6,21,7,0)
falls outside of the usual high/low range, the
"^DD",71.11,71.1108,6,21,8,0)
person editing the case will see a warning
"^DD",71.11,71.1108,6,21,9,0)
message.  If you do not want a warning to
"^DD",71.11,71.1108,6,21,10,0)
appear no matter how low the dosage entered, do
"^DD",71.11,71.1108,6,21,11,0)
not enter a low range dosage here.
"^DD",71.11,71.1108,6,"DT")
3161019
"^DD",71.11,71.1108,7,0)
DEFAULT FORM^S^L:Liquid;G:Gas;A:Aerosol;P:Solid (Pill);S:Solid (Other);^0;7^Q
"^DD",71.11,71.1108,7,3)
Enter the default form of the  Radiopharmaceutical.
"^DD",71.11,71.1108,7,21,0)
^^13^13^3161019^
"^DD",71.11,71.1108,7,21,1,0)
This is the form of this Radiopharmaceutical
"^DD",71.11,71.1108,7,21,2,0)
when used in this procedure.  If entered, it
"^DD",71.11,71.1108,7,21,3,0)
will be used as the default answer to the
"^DD",71.11,71.1108,7,21,4,0)
'Form' prompt during case edits.  Choices are
"^DD",71.11,71.1108,7,21,5,0)
as follows: 
"^DD",71.11,71.1108,7,21,6,0)
 
"^DD",71.11,71.1108,7,21,7,0)
    Liquid          (e.g. all injections) 
"^DD",71.11,71.1108,7,21,8,0)
    Gas             (e.g. xenon, krypton) 
"^DD",71.11,71.1108,7,21,9,0)
    Aerosol         (e.g.  DTPA aerosol) 
"^DD",71.11,71.1108,7,21,10,0)
    Solid (Pill)    (e.g. I-123 or I-131 pill,
"^DD",71.11,71.1108,7,21,11,0)
       schilling test) 
"^DD",71.11,71.1108,7,21,12,0)
    Solid (Other)   (e.g. radioactive egg for
"^DD",71.11,71.1108,7,21,13,0)
       gastric emptying time) 2
"^DD",71.11,71.1108,7,"DT")
3161019
"^DD",71.11,71.111,0)
SYNONYM SUB-FIELD^^.01^1
"^DD",71.11,71.111,0,"DT")
3161018
"^DD",71.11,71.111,0,"IX","B",71.111,.01)

"^DD",71.11,71.111,0,"NM","SYNONYM")

"^DD",71.11,71.111,0,"UP")
71.11
"^DD",71.11,71.111,.01,0)
SYNONYM^MF^^0;1^K:$L(X)>15!($L(X)<2) X
"^DD",71.11,71.111,.01,1,0)
^.1
"^DD",71.11,71.111,.01,1,1,0)
71.111^B
"^DD",71.11,71.111,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),1,"B",$E(X,1,30),DA)=""
"^DD",71.11,71.111,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),1,"B",$E(X,1,30),DA)
"^DD",71.11,71.111,.01,3)
Answer must be 2-15 characters in length.
"^DD",71.11,71.111,.01,21,0)
^.001^1^1^3161103^^^
"^DD",71.11,71.111,.01,21,1,0)
This is another name for the Procedure. It may be the locally preferred name, or a common misspelling.
"^DD",71.11,71.111,.01,"DT")
3161018
"^DD",71.11,71.11125,0)
CONTRAST MEDIA SUB-FIELD^^.01^1
"^DD",71.11,71.11125,0,"DT")
3161018
"^DD",71.11,71.11125,0,"IX","B",71.11125,.01)

"^DD",71.11,71.11125,0,"NM","CONTRAST MEDIA")

"^DD",71.11,71.11125,0,"UP")
71.11
"^DD",71.11,71.11125,.01,0)
CONTRAST MEDIA^MS^I:Ionic Iodinated;N:Non-ionic Iodinated;L:Gadolinium;C:Cholecystographic;G:Gastrografin;B:Barium;M:unspecified contrast media;^0;1^Q
"^DD",71.11,71.11125,.01,1,0)
^.1
"^DD",71.11,71.11125,.01,1,1,0)
71.11125^B
"^DD",71.11,71.11125,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),"CM","B",$E(X,1,30),DA)=""
"^DD",71.11,71.11125,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),"CM","B",$E(X,1,30),DA)
"^DD",71.11,71.11125,.01,3)
Enter the contrast agent(s) associated with this procedure.
"^DD",71.11,71.11125,.01,21,0)
^.001^2^2^3161018^^
"^DD",71.11,71.11125,.01,21,1,0)
This field identifies the contrast agent(s) associated with this Rad/Nuc 
"^DD",71.11,71.11125,.01,21,2,0)
Med procedure.
"^DD",71.11,71.11125,.01,"DT")
3161018
"^DD",71.11,71.11135,0)
DEFAULT CPT MODIFIERS(PROC) SUB-FIELD^^.01^1
"^DD",71.11,71.11135,0,"DT")
3161018
"^DD",71.11,71.11135,0,"IX","B",71.11135,.01)

"^DD",71.11,71.11135,0,"NM","DEFAULT CPT MODIFIERS(PROC)")

"^DD",71.11,71.11135,0,"UP")
71.11
"^DD",71.11,71.11135,.01,0)
DEFAULT CPT MODIFIERS(PROC)^MP81.3'^DIC(81.3,^0;1^Q
"^DD",71.11,71.11135,.01,1,0)
^.1
"^DD",71.11,71.11135,.01,1,1,0)
71.11135^B
"^DD",71.11,71.11135,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),"DCM","B",$E(X,1,30),DA)=""
"^DD",71.11,71.11135,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),"DCM","B",$E(X,1,30),DA)
"^DD",71.11,71.11135,.01,3)
Enter one or more default CPT Modifiers for this CPT code.
"^DD",71.11,71.11135,.01,21,0)
^^4^4^3161018^
"^DD",71.11,71.11135,.01,21,1,0)
One or more default CPT Modifiers may be
"^DD",71.11,71.11135,.01,21,2,0)
entered for this procedure.  Each entry will be
"^DD",71.11,71.11135,.01,21,3,0)
screened against the CPT CODE for this
"^DD",71.11,71.11135,.01,21,4,0)
procedure.
"^DD",71.11,71.11135,.01,"DT")
3161018
"^DD",71.11,71.1155,0)
DEFAULT MEDICATIONS SUB-FIELD^^2^2
"^DD",71.11,71.1155,0,"DT")
3161018
"^DD",71.11,71.1155,0,"IX","B",71.1155,.01)

"^DD",71.11,71.1155,0,"NM","DEFAULT MEDICATIONS")

"^DD",71.11,71.1155,0,"UP")
71.11
"^DD",71.11,71.1155,.01,0)
DEFAULT MEDICATION^MP50'^PSDRUG(^0;1^Q
"^DD",71.11,71.1155,.01,1,0)
^.1
"^DD",71.11,71.1155,.01,1,1,0)
71.1155^B
"^DD",71.11,71.1155,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),"P","B",$E(X,1,30),DA)=""
"^DD",71.11,71.1155,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),"P","B",$E(X,1,30),DA)
"^DD",71.11,71.1155,.01,3)
Enter a medication routinely used with this procedure.
"^DD",71.11,71.1155,.01,21,0)
^^7^7^3161018^
"^DD",71.11,71.1155,.01,21,1,0)
Default medication(s) may be entered by the
"^DD",71.11,71.1155,.01,21,2,0)
ADPAC for a procedure.  If they are entered,
"^DD",71.11,71.1155,.01,21,3,0)
the system will automatically enter them on
"^DD",71.11,71.1155,.01,21,4,0)
the patient's exam record whenever the
"^DD",71.11,71.1155,.01,21,5,0)
procedure is registered.  NOTE:  Default
"^DD",71.11,71.1155,.01,21,6,0)
Radiopharmaceuticals may NOT be entered here;
"^DD",71.11,71.1155,.01,21,7,0)
they should be entered on a separate field.
"^DD",71.11,71.1155,.01,"DT")
3161018
"^DD",71.11,71.1155,2,0)
DEFAULT MED DOSE^F^^0;2^K:$L(X)>40!($L(X)<3) X
"^DD",71.11,71.1155,2,3)
Answer must be 3-40 characters in length.
"^DD",71.11,71.1155,2,21,0)
^.001^9^9^3161018^^
"^DD",71.11,71.1155,2,21,1,0)
This is the default dose of this medication
"^DD",71.11,71.1155,2,21,2,0)
when administered for this procedure.  If a
"^DD",71.11,71.1155,2,21,3,0)
default dose is entered for this medication it
"^DD",71.11,71.1155,2,21,4,0)
will be automatically entered on the patient's
"^DD",71.11,71.1155,2,21,5,0)
exam record at the time this procedure is
"^DD",71.11,71.1155,2,21,6,0)
registered.  Acceptable formats are: 99999.999 
"^DD",71.11,71.1155,2,21,7,0)
unit_of_measure -OR- 99999 unit_of_measure. 
"^DD",71.11,71.1155,2,21,8,0)
Unit_Of_Measure may be between 1-30 characters
"^DD",71.11,71.1155,2,21,9,0)
in length.  Example:  2.5 m
"^DD",71.11,71.1155,2,"DT")
3161018
"^DD",71.11,71.11731,0)
MODALITY SUB-FIELD^^.01^1
"^DD",71.11,71.11731,0,"DT")
3161018
"^DD",71.11,71.11731,0,"IX","B",71.11731,.01)

"^DD",71.11,71.11731,0,"NM","MODALITY")

"^DD",71.11,71.11731,0,"UP")
71.11
"^DD",71.11,71.11731,.01,0)
MODALITY^MP73.1'^RAMIS(73.1,^0;1^Q
"^DD",71.11,71.11731,.01,1,0)
^.1
"^DD",71.11,71.11731,.01,1,1,0)
71.11731^B
"^DD",71.11,71.11731,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),"MDL","B",$E(X,1,30),DA)=""
"^DD",71.11,71.11731,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),"MDL","B",$E(X,1,30),DA)
"^DD",71.11,71.11731,.01,3)
Choose a modality from the pre-defined list.
"^DD",71.11,71.11731,.01,21,0)
^^2^2^3161018^
"^DD",71.11,71.11731,.01,21,1,0)
This field points to the RAD MODALITY DEFINED TERMS file (#73.1).  Which is
"^DD",71.11,71.11731,.01,21,2,0)
a list of procedure modes.
"^DD",71.11,71.11731,.01,"DT")
3161018
"^DD",71.11,71.12,0)
MESSAGE SUB-FIELD^^.01^1
"^DD",71.11,71.12,0,"DT")
3161018
"^DD",71.11,71.12,0,"IX","B",71.12,.01)

"^DD",71.11,71.12,0,"NM","MESSAGE")

"^DD",71.11,71.12,0,"UP")
71.11
"^DD",71.11,71.12,.01,0)
MESSAGE^MP71.4'^RAMIS(71.4,^0;1^Q
"^DD",71.11,71.12,.01,1,0)
^.1
"^DD",71.11,71.12,.01,1,1,0)
71.12^B
"^DD",71.11,71.12,.01,1,1,1)
S ^RAMRPF(71.11,DA(1),3,"B",$E(X,1,30),DA)=""
"^DD",71.11,71.12,.01,1,1,2)
K ^RAMRPF(71.11,DA(1),3,"B",$E(X,1,30),DA)
"^DD",71.11,71.12,.01,3)
 Select one or more messages that should be displayed for this procedure.
"^DD",71.11,71.12,.01,21,0)
^.001^3^3^3161018^^
"^DD",71.11,71.12,.01,21,1,0)
This field contains any message from the
"^DD",71.11,71.12,.01,21,2,0)
RAD/NUC PROCEDURE MESSAGE file that relate to
"^DD",71.11,71.12,.01,21,3,0)
this procedure.
"^DD",71.11,71.12,.01,"DT")
3161018
"^DD",71.11,71.13,0)
EDUCATIONAL DESCRIPTION SUB-FIELD^^.01^1
"^DD",71.11,71.13,0,"DT")
3161018
"^DD",71.11,71.13,0,"NM","EDUCATIONAL DESCRIPTION")

"^DD",71.11,71.13,0,"UP")
71.11
"^DD",71.11,71.13,.01,0)
EDUCATIONAL DESCRIPTION^Wx^^0;1^Q
"^DD",71.11,71.13,.01,3)
The text entered here should describe the procedure.
"^DD",71.11,71.13,.01,21,0)
^.001^10^10^3161028^^
"^DD",71.11,71.13,.01,21,1,0)
The text entered here should describe the
"^DD",71.11,71.13,.01,21,2,0)
procedure.  It may be used by clinicians who
"^DD",71.11,71.13,.01,21,3,0)
are trying to familiarize themselves with
"^DD",71.11,71.13,.01,21,4,0)
imaging procedures that are available via an
"^DD",71.11,71.13,.01,21,5,0)
option within this software system.  This text
"^DD",71.11,71.13,.01,21,6,0)
can also be displayed along with the procedure
"^DD",71.11,71.13,.01,21,7,0)
message during the ordering process if the
"^DD",71.11,71.13,.01,21,8,0)
Rad/Nuc Med Procedure file parameter that 
"^DD",71.11,71.13,.01,21,9,0)
controls displaying it when ordered is set to
"^DD",71.11,71.13,.01,21,10,0)
'Yes'.
"^DD",71.11,71.13,.01,"DT")
3161018
"^DIC",71.11,71.11,0)
NEW RAD PROCEDURE WORKUP^71.11
"^DIC",71.11,71.11,0,"GL")
^RAMRPF(71.11,
"^DIC",71.11,71.11,"%D",0)
^^4^4^3161027^
"^DIC",71.11,71.11,"%D",1,0)
This file temporarily hold a new radiology procedure while it is being 
"^DIC",71.11,71.11,"%D",2,0)
developed and associated to the MASTER RADIOLOGY PROCEDURE file (#71.11).
"^DIC",71.11,71.11,"%D",3,0)
After the procedure is created and matched it will be moved to the
"^DIC",71.11,71.11,"%D",4,0)
RAD/NUC MED PROCEDURE file (#71) and then deleted from 71.11.
"^DIC",71.11,"B","NEW RAD PROCEDURE WORKUP",71.11)

"BLD",10142,6)
^121
**END**
**END**

