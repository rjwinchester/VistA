Released RA*5*123 SEQ #110
Extracted from mail message
**KIDS**:RA*5.0*123^

**INSTALL NAME**
RA*5.0*123
"BLD",9255,0)
RA*5.0*123^RADIOLOGY/NUCLEAR MEDICINE^0^3151209^y
"BLD",9255,1,0)
^^2^2^3150721^
"BLD",9255,1,1,0)
RA*5*123  ADD PATIENT WEIGHT TO ORDER & EMAIL REPORT TO PRIMARY CARE
"BLD",9255,1,2,0)
PHYSICIAN
"BLD",9255,4,0)
^9.64PA^79^1
"BLD",9255,4,79,0)
79
"BLD",9255,4,79,2,0)
^9.641^79^1
"BLD",9255,4,79,2,79,0)
RAD/NUC MED DIVISION  (File-top level)
"BLD",9255,4,79,2,79,1,0)
^9.6411^.126^1
"BLD",9255,4,79,2,79,1,.126,0)
AUTO E-MAIL TO REQ. PHYS?
"BLD",9255,4,79,222)
y^y^p^^^^n^^n
"BLD",9255,4,79,224)

"BLD",9255,4,"APDD",79,79)

"BLD",9255,4,"APDD",79,79,.126)

"BLD",9255,4,"B",79,79)

"BLD",9255,6)
1^
"BLD",9255,6.3)
7
"BLD",9255,"KRN",0)
^9.67PA^779.2^20
"BLD",9255,"KRN",.4,0)
.4
"BLD",9255,"KRN",.401,0)
.401
"BLD",9255,"KRN",.402,0)
.402
"BLD",9255,"KRN",.403,0)
.403
"BLD",9255,"KRN",.5,0)
.5
"BLD",9255,"KRN",.84,0)
.84
"BLD",9255,"KRN",3.6,0)
3.6
"BLD",9255,"KRN",3.8,0)
3.8
"BLD",9255,"KRN",9.2,0)
9.2
"BLD",9255,"KRN",9.8,0)
9.8
"BLD",9255,"KRN",9.8,"NM",0)
^9.68A^4^4
"BLD",9255,"KRN",9.8,"NM",1,0)
RAORD5^^0^B30588485
"BLD",9255,"KRN",9.8,"NM",2,0)
RAORD6^^0^B60840367
"BLD",9255,"KRN",9.8,"NM",3,0)
RAORD61^^0^B7261744
"BLD",9255,"KRN",9.8,"NM",4,0)
RAUTL4^^0^B29392357
"BLD",9255,"KRN",9.8,"NM","B","RAORD5",1)

"BLD",9255,"KRN",9.8,"NM","B","RAORD6",2)

"BLD",9255,"KRN",9.8,"NM","B","RAORD61",3)

"BLD",9255,"KRN",9.8,"NM","B","RAUTL4",4)

"BLD",9255,"KRN",19,0)
19
"BLD",9255,"KRN",19.1,0)
19.1
"BLD",9255,"KRN",101,0)
101
"BLD",9255,"KRN",409.61,0)
409.61
"BLD",9255,"KRN",771,0)
771
"BLD",9255,"KRN",779.2,0)
779.2
"BLD",9255,"KRN",870,0)
870
"BLD",9255,"KRN",8989.51,0)
8989.51
"BLD",9255,"KRN",8989.52,0)
8989.52
"BLD",9255,"KRN",8994,0)
8994
"BLD",9255,"KRN","B",.4,.4)

"BLD",9255,"KRN","B",.401,.401)

"BLD",9255,"KRN","B",.402,.402)

"BLD",9255,"KRN","B",.403,.403)

"BLD",9255,"KRN","B",.5,.5)

"BLD",9255,"KRN","B",.84,.84)

"BLD",9255,"KRN","B",3.6,3.6)

"BLD",9255,"KRN","B",3.8,3.8)

"BLD",9255,"KRN","B",9.2,9.2)

"BLD",9255,"KRN","B",9.8,9.8)

"BLD",9255,"KRN","B",19,19)

"BLD",9255,"KRN","B",19.1,19.1)

"BLD",9255,"KRN","B",101,101)

"BLD",9255,"KRN","B",409.61,409.61)

"BLD",9255,"KRN","B",771,771)

"BLD",9255,"KRN","B",779.2,779.2)

"BLD",9255,"KRN","B",870,870)

"BLD",9255,"KRN","B",8989.51,8989.51)

"BLD",9255,"KRN","B",8989.52,8989.52)

"BLD",9255,"KRN","B",8994,8994)

"BLD",9255,"QDEF")
^^^^NO^^^^NO^^NO
"BLD",9255,"QUES",0)
^9.62^^
"BLD",9255,"REQB",0)
^9.611^3^2
"BLD",9255,"REQB",2,0)
RA*5.0*99^1
"BLD",9255,"REQB",3,0)
RA*5.0*47^1
"BLD",9255,"REQB","B","RA*5.0*47",3)

"BLD",9255,"REQB","B","RA*5.0*99",2)

"FIA",79)
RAD/NUC MED DIVISION
"FIA",79,0)
^RA(79,
"FIA",79,0,0)
79P
"FIA",79,0,1)
y^y^p^^^^n^^n
"FIA",79,0,10)

"FIA",79,0,11)

"FIA",79,0,"RLRO")

"FIA",79,0,"VR")
5.0^RA
"FIA",79,79)
1
"FIA",79,79,.126)

"MBREQ")
0
"PKG",31,-1)
1^1
"PKG",31,0)
RADIOLOGY/NUCLEAR MEDICINE^RA^REGISTERS PATIENTS,RECORDS EXAMS,PROFILES,AMIS REPORTS
"PKG",31,22,0)
^9.49I^1^1
"PKG",31,22,1,0)
5.0^2980317^2980619^11712
"PKG",31,22,1,"PAH",1,0)
123^3151209^100000000074
"PKG",31,22,1,"PAH",1,1,0)
^^2^2^3151209
"PKG",31,22,1,"PAH",1,1,1,0)
RA*5*123  ADD PATIENT WEIGHT TO ORDER & EMAIL REPORT TO PRIMARY CARE
"PKG",31,22,1,"PAH",1,1,2,0)
PHYSICIAN
"QUES","XPF1",0)
Y
"QUES","XPF1","??")
^D REP^XPDH
"QUES","XPF1","A")
Shall I write over your |FLAG| File
"QUES","XPF1","B")
YES
"QUES","XPF1","M")
D XPF1^XPDIQ
"QUES","XPF2",0)
Y
"QUES","XPF2","??")
^D DTA^XPDH
"QUES","XPF2","A")
Want my data |FLAG| yours
"QUES","XPF2","B")
YES
"QUES","XPF2","M")
D XPF2^XPDIQ
"QUES","XPI1",0)
YO
"QUES","XPI1","??")
^D INHIBIT^XPDH
"QUES","XPI1","A")
Want KIDS to INHIBIT LOGONs during the install
"QUES","XPI1","B")
NO
"QUES","XPI1","M")
D XPI1^XPDIQ
"QUES","XPM1",0)
PO^VA(200,:EM
"QUES","XPM1","??")
^D MG^XPDH
"QUES","XPM1","A")
Enter the Coordinator for Mail Group '|FLAG|'
"QUES","XPM1","B")

"QUES","XPM1","M")
D XPM1^XPDIQ
"QUES","XPO1",0)
Y
"QUES","XPO1","??")
^D MENU^XPDH
"QUES","XPO1","A")
Want KIDS to Rebuild Menu Trees Upon Completion of Install
"QUES","XPO1","B")
NO
"QUES","XPO1","M")
D XPO1^XPDIQ
"QUES","XPZ1",0)
Y
"QUES","XPZ1","??")
^D OPT^XPDH
"QUES","XPZ1","A")
Want to DISABLE Scheduled Options, Menu Options, and Protocols
"QUES","XPZ1","B")
NO
"QUES","XPZ1","M")
D XPZ1^XPDIQ
"QUES","XPZ2",0)
Y
"QUES","XPZ2","??")
^D RTN^XPDH
"QUES","XPZ2","A")
Want to MOVE routines to other CPUs
"QUES","XPZ2","B")
NO
"QUES","XPZ2","M")
D XPZ2^XPDIQ
"RTN")
4
"RTN","RAORD5")
0^1^B30588485^B27804066
"RTN","RAORD5",1,0)
RAORD5 ;HISC/CAH,FPT,GJC AISC/RMO-Print A Request ;8/4/97  14:47
"RTN","RAORD5",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**8,10,15,31,45,75,123**;Mar 16, 1998;Build 7
"RTN","RAORD5",3,0)
 ; Input:  RADFN= Internal Number to Rad/Nuc Med Patient File #70
"RTN","RAORD5",4,0)
 ;         RAOIFN= Internal Number to Rad/Nuc Med Orders File #75.1
"RTN","RAORD5",5,0)
 ;         RAX= Null (Used to check for an '^')
"RTN","RAORD5",6,0)
 ;         RAPGE= 0 (Used as a page counter)
"RTN","RAORD5",7,0)
 ;
"RTN","RAORD5",8,0)
 ; Supported IA #1120 reference to EN6^GMRVUTL  5-P123
"RTN","RAORD5",9,0)
 ;
"RTN","RAORD5",10,0)
 ; 1-p75 10/12/2006 GJC RA*5*75 Remedy 162508 Modify Patient AGE calc
"RTN","RAORD5",11,0)
 ; 2-p75 10/12/2006 GJC RA*5*75 set REASON FOR STUDY to a local variable
"RTN","RAORD5",12,0)
 ; 5-P123 6/23/2015 MJT RA*5*123 NSR 20140507 print weight & date taken in Radiology requests
"RTN","RAORD5",13,0)
 ; 
"RTN","RAORD5",14,0)
 S:$D(ZTQUEUED) ZTREQ="@"
"RTN","RAORD5",15,0)
 G Q:'$D(^DPT(RADFN,0)) S RADPT0=^(0) G Q:'$D(^RAO(75.1,RAOIFN,0)) S RAORD0=^(0)
"RTN","RAORD5",16,0)
 K ^UTILITY($J,"W"),^(1) S RAOSTSYM="dc^c^h^^p^^^s",$P(RALNE,"-",79)="",$P(RALNE1,"=",79)="",DIWL=5,DIWR=75,DIWF="WC75"
"RTN","RAORD5",17,0)
 S RA("NME")=$P(RADPT0,"^"),RA("SEX")=$P(RADPT0,"^",2),RA("DOB")=$P(RADPT0,"^",3),RASSN=$$SSN^RAUTL
"RTN","RAORD5",18,0)
 S RA("AGE")=($$FMDIFF^XLFDT($P(RAORD0,U,16),RA("DOB")))\365.25 ;1-p75 
"RTN","RAORD5",19,0)
 S RA("STY_REA")=$P($G(^RAO(75.1,RAOIFN,.1)),U) ;2-p75
"RTN","RAORD5",20,0)
 S RA("PRC NODE")=$G(^RAMIS(71,+$P(RAORD0,U,2),0))
"RTN","RAORD5",21,0)
 S RA("PRC")=$E($P(RA("PRC NODE"),U),1,36)
"RTN","RAORD5",22,0)
 S RA("PRC")=$S(RA("PRC")]"":RA("PRC"),1:"UNKNOWN")
"RTN","RAORD5",23,0)
 S RA("PRCTY")=$P(RA("PRC NODE"),U,6)
"RTN","RAORD5",24,0)
 S RA("PRCTY")=$$XTERNAL^RAUTL5(RA("PRCTY"),$P($G(^DD(71,6,0)),U,2))
"RTN","RAORD5",25,0)
 S RA("PRCTY")=$E(RA("PRCTY"))_$$LOW^XLFSTR($E(RA("PRCTY"),2,99))
"RTN","RAORD5",26,0)
 S RA("CPT")=+$P(RA("PRC NODE"),U,9)
"RTN","RAORD5",27,0)
 S RA("CPT")=$P($$NAMCODE^RACPTMSC(RA("CPT"),DT),U)
"RTN","RAORD5",28,0)
 S RA("PRCIT")=+$P(RA("PRC NODE"),U,12)
"RTN","RAORD5",29,0)
 S RA("PRCIT")=$P($G(^RA(79.2,RA("PRCIT"),0)),U,3)
"RTN","RAORD5",30,0)
 S RA("CNCAT")="("_RA("PRCIT")_" "_RA("PRCTY")_" "_RA("CPT")_")"
"RTN","RAORD5",31,0)
 S RA("PRC INFO")="",$E(RA("PRC INFO"),1,36)=RA("PRC")
"RTN","RAORD5",32,0)
 S $E(RA("PRC INFO"),38,60)=RA("CNCAT") K RA("CNCAT")
"RTN","RAORD5",33,0)
 S RA("PRC MSG")=$S(+$O(^RAMIS(71,+$P(RAORD0,"^",2),3,0))>0:1,1:0)
"RTN","RAORD5",34,0)
 S RA("OUG")=$P($P(^DD(75.1,6,0),$P(RAORD0,"^",6)_":",2),";")
"RTN","RAORD5",35,0)
 K RA("MOD") F I=0:0 S I=$O(^RAO(75.1,RAOIFN,"M","B",I)) Q:'I  I $D(^RAMIS(71.2,+I,0)) S RA("MOD")=$S('$D(RA("MOD")):$P(^(0),"^"),1:RA("MOD")_", "_$P(^(0),"^")) S:$P($G(^(0)),U,2)="p" RA("PORTABLE")=""
"RTN","RAORD5",36,0)
 S RA("OST")=$$GET1^DIQ(75.1,RAOIFN_",",5)_$S($P(RAOSTSYM,"^",$P(RAORD0,"^",5))="":"",1:" ("_$P(RAOSTSYM,"^",$P(RAORD0,"^",5))_")")
"RTN","RAORD5",37,0)
 S RA("PHY")=$S($D(^VA(200,+$P(RAORD0,"^",14),0)):$P(^(0),"^"),1:"UNKNOWN")
"RTN","RAORD5",38,0)
 ; Requesting Physician Phone info
"RTN","RAORD5",39,0)
 D:RA("PHY")'="UNKNOWN" PHONE("R",+$P(RAORD0,"^",14))
"RTN","RAORD5",40,0)
 ; Get current primary and attending physicians
"RTN","RAORD5",41,0)
 S DFN=RADFN,VA200=1 D IN5^VADPT K VA200 S:'$D(VAIP(18)) VAIP(18)=""
"RTN","RAORD5",42,0)
 ; *** NSR 20140507 Start Mod to print weight & date taken in Radiology requests 5-P123 ***
"RTN","RAORD5",43,0)
 S DFN=RADFN,GMRVSTR="WT"
"RTN","RAORD5",44,0)
 D EN6^GMRVUTL
"RTN","RAORD5",45,0)
 S RA("WT")=$P(X,U,8)
"RTN","RAORD5",46,0)
 S Y=$P(X,U) D DD^%DT S RA("WTDT")=Y
"RTN","RAORD5",47,0)
 ; actual print code located in RAORD6
"RTN","RAORD5",48,0)
 ; *** NSR 20140507 End Mod to print weight & date taken in Radiology requests ***
"RTN","RAORD5",49,0)
 I '+$G(VAIP(7)) D
"RTN","RAORD5",50,0)
 . ; If the Primary Physician is not found (based on inpatient episode)
"RTN","RAORD5",51,0)
 . ; find the current Primary Care Practitioner (See patch SD*5.3*30)
"RTN","RAORD5",52,0)
 . ; VAIP(7) is null at this point.  VAIP(7) will exit this DO block
"RTN","RAORD5",53,0)
 . ; set to the Primary Care Practitioner or null.
"RTN","RAORD5",54,0)
 . N X S X="SDUTL3" X ^%ZOSF("TEST")
"RTN","RAORD5",55,0)
 . S:$T VAIP(7)=$$OUTPTPR^SDUTL3(RADFN)
"RTN","RAORD5",56,0)
 . Q
"RTN","RAORD5",57,0)
 ; Get Current Primary and Attending Physician Phone info
"RTN","RAORD5",58,0)
 S RA("ATTEN")=$S($P(VAIP(18),"^",2)]"":$P(VAIP(18),"^",2),1:"UNKNOWN")
"RTN","RAORD5",59,0)
 D:RA("ATTEN")'="UNKNOWN" PHONE("A",+$G(VAIP(18)))
"RTN","RAORD5",60,0)
 S RA("PRIM")=$S($P(VAIP(7),"^",2)]"":$P(VAIP(7),"^",2),1:"UNKNOWN")
"RTN","RAORD5",61,0)
 D:RA("PRIM")'="UNKNOWN" PHONE("P",+$G(VAIP(7)))
"RTN","RAORD5",62,0)
 ; Requesting location, room-bed
"RTN","RAORD5",63,0)
 S RA("HLC")=$S($D(^SC(+$P(RAORD0,"^",22),0)):$P(^(0),"^"),1:"UNKNOWN"),RA("HPH")=$S($D(^SC(+$P(RAORD0,"^",22),99)):$P(^(99),"^"),1:"") I VAIP(1) S RA("ROOM-BED")=$S(+VAIP(6):$P(VAIP(6),"^",2),1:"")
"RTN","RAORD5",64,0)
 ; Get primary and attending phys as of order date and their phone, etc.
"RTN","RAORD5",65,0)
 K RA("ODT") S Y=$P(RAORD0,"^",16) I Y S:$P(Y,".",2) Y=$P(Y,".")_"."_$$NOSECNDS^RAORD3($P(Y,".",2)) S RA("ODT")=$$FMTE^XLFDT(Y,"1P")
"RTN","RAORD5",66,0)
 K VAIP S DFN=RADFN,VAIP("D")=+$P(RAORD0,"^",16),VA200=1 D:VAIP("D") IN5^VADPT K VA200
"RTN","RAORD5",67,0)
 S RA("OATTEN")=$S($P($G(VAIP(18)),"^",2)]"":$P(VAIP(18),"^",2),1:"UNKNOWN")
"RTN","RAORD5",68,0)
 D:RA("OATTEN")'="UNKNOWN" PHONE("OA",+$G(VAIP(18)))
"RTN","RAORD5",69,0)
 S RA("OPRIM")=$S($P($G(VAIP(7)),"^",2)]"":$P(VAIP(7),"^",2),1:"UNKNOWN")
"RTN","RAORD5",70,0)
 D:RA("OPRIM")'="UNKNOWN" PHONE("OP",+$G(VAIP(7)))
"RTN","RAORD5",71,0)
 ; Get other order info (orderer, transport mode, etc.)
"RTN","RAORD5",72,0)
 S RA("USR")=$S($D(^VA(200,+$P(RAORD0,"^",15),0)):$P(^(0),"^"),1:"UNKNOWN"),RA("TRAN")=$S($P(RAORD0,"^",19)']"":"UNKNOWN",1:$P($P(^DD(75.1,19,0),$P(RAORD0,"^",19)_":",2),";")) S:$P(RAORD0,"^",19)="p" RA("PORTABLE")=""
"RTN","RAORD5",73,0)
 K RA("ST"),^TMP($J,"RA DIFF PRC")
"RTN","RAORD5",74,0)
 ;determine if ordered procedure has CM assoc.; return null if none
"RTN","RAORD5",75,0)
 S RACMFLG("O")=$$CMEDIA^RAO7UTL(+$P(RAORD0,U,2),$P(RA("PRC NODE"),U,6))
"RTN","RAORD5",76,0)
 ; If appropriate, determine exam status and descendant exams
"RTN","RAORD5",77,0)
 I $D(^RADPT("AO",RAOIFN,RADFN)) D DPRC^RAORD2(RAOIFN,RADFN)
"RTN","RAORD5",78,0)
 S RADIV(0)=$G(^SC(+$P(RAORD0,"^",22),0))
"RTN","RAORD5",79,0)
 S RADIV=+$$SITE^VASITE(DT,+$P(RADIV(0),"^",15)) S:RADIV<0 RADIV=0
"RTN","RAORD5",80,0)
 S RADIV=$S($D(^RA(79,RADIV,0)):RADIV,1:$O(^RA(79,0)))
"RTN","RAORD5",81,0)
 S RADIVPAR=$S($D(^RA(79,+RADIV,.1)):^(.1),1:"")
"RTN","RAORD5",82,0)
 K RA("RDT") S Y=$P(RAORD0,"^",21) I Y S:$P(Y,".",2) Y=$P(Y,".")_"."_$$NOSECNDS^RAORD3($P(Y,".",2)) S RA("RDT")=$$FMTE^XLFDT(Y,"1P")
"RTN","RAORD5",83,0)
 K RA("PDT") S Y=$P(RAORD0,"^",12) I Y S:$P(Y,".",2) Y=$P(Y,".")_"."_$$NOSECNDS^RAORD3($P(Y,".",2)) S RA("PDT")=$$FMTE^XLFDT(Y,"1P")
"RTN","RAORD5",84,0)
 K RA("VDT") S Y=$P(RAORD0,"^",17) I Y S:$P(Y,".",2) Y=$P(Y,".")_"."_$$NOSECNDS^RAORD3($P(Y,".",2)) S RA("VDT")=$$FMTE^XLFDT(Y,"1P")
"RTN","RAORD5",85,0)
 K RA("SDT") S Y=$P(RAORD0,"^",23) I Y S:$P(Y,".",2) Y=$P(Y,".")_"."_$$NOSECNDS^RAORD3($P(Y,".",2)) S RA("SDT")=$$FMTE^XLFDT(Y,"1P")
"RTN","RAORD5",86,0)
 S RA("ILC")=$S('$P(RAORD0,"^",20):"UNKNOWN",'$D(^RA(79.1,+$P(RAORD0,"^",20),0)):"UNKNOWN",$D(^SC(+^(0),0)):$P(^(0),"^"),1:"UNKNOWN")
"RTN","RAORD5",87,0)
 D ^RAORD6
"RTN","RAORD5",88,0)
 ;
"RTN","RAORD5",89,0)
Q K DIWF,DIWL,DIWR,I,RA,RABARC,RABARC0,RABARC1,RADIV,RADIVPAR,RADPT0,RALNE,RALNE1,RAORD0,RAOSTSYM,RATAB,RAV,RASSN,RAXX,VA200,VAERR,VAIP,X,X1,X2,X3,Y,ZZ
"RTN","RAORD5",90,0)
 K RACMFLG,RALOC,^TMP($J,"RA DIFF PRC")
"RTN","RAORD5",91,0)
 Q
"RTN","RAORD5",92,0)
PHONE(X,Y) ; Setup phone information for Resident Physicians, Attending
"RTN","RAORD5",93,0)
 ; Physicians, and Primary Physicians.
"RTN","RAORD5",94,0)
 ; 'X' -> $S('A':'Attending','OA':'Old Attending','OP':'Old Primary',
"RTN","RAORD5",95,0)
 ; ,'P':'Primary','R':'Resident')
"RTN","RAORD5",96,0)
 ; 'Y' -> ien for file 200
"RTN","RAORD5",97,0)
 ; RA(X_"PHON")=Phone node  <> RA(X_"OPHO")=Office phone
"RTN","RAORD5",98,0)
 ; RA(X_"VPGR")=Voice pager <> RA(X_"DPGR")=Digital pager
"RTN","RAORD5",99,0)
 ; RA(X_"PHOINFO")=office phone/voice pager/digital pager
"RTN","RAORD5",100,0)
 S RA(X_"PHON")=$G(^VA(200,+Y,.13))
"RTN","RAORD5",101,0)
 S RA(X_"OPHO")=$P(RA(X_"PHON"),U,2),RA(X_"VPGR")=$P(RA(X_"PHON"),U,7)
"RTN","RAORD5",102,0)
 S RA(X_"DPGR")=$P(RA(X_"PHON"),U,8)
"RTN","RAORD5",103,0)
 S RA(X_"PHOINFO")=RA(X_"OPHO")_" / "_RA(X_"VPGR")_" / "_RA(X_"DPGR")
"RTN","RAORD5",104,0)
 S:RA(X_"PHOINFO")=" /  / " RA(X_"PHOINFO")="Unknown"
"RTN","RAORD5",105,0)
 Q
"RTN","RAORD6")
0^2^B60840367^B56757723
"RTN","RAORD6",1,0)
RAORD6 ;HISC/CAH - AISC/RMO-Print A Request Cont. ;05/20/09  07:28
"RTN","RAORD6",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**5,10,15,18,27,45,41,75,85,99,123**;Mar 16, 1998;Build 7
"RTN","RAORD6",3,0)
 ; 3-p75 10/12/2006 GJC RA*5*75 print Reason for Study
"RTN","RAORD6",4,0)
 ; 4-p75 10/12/2006 KAM RA*5*75 display the request print date in the header
"RTN","RAORD6",5,0)
 ; 5-p75 10/12/2006 KAM RA*5*75 update header "Age" to "Age at req"
"RTN","RAORD6",6,0)
 ; 6-p85 06/20/2007 KAM RA*5*85 Reason for Study/Bar Code print issue
"RTN","RAORD6",7,0)
 ;                              Remedy Call - 193859
"RTN","RAORD6",8,0)
 ; 5-P123 6/23/2015 MJT RA*5*123 NSR 20140507 print weight & date taken in Radiology requests
"RTN","RAORD6",9,0)
 ; 
"RTN","RAORD6",10,0)
 ;Supported IA #10104 reference to ^XLFSTR
"RTN","RAORD6",11,0)
 ;Supported IA #10060 reference to ^VA(200
"RTN","RAORD6",12,0)
 D HD Q:RAX["^"
"RTN","RAORD6",13,0)
 I $$PTSEX^RAUTL8(RADFN)="F" D  ;display pregnancy status for females ptch 45
"RTN","RAORD6",14,0)
 .W !,"Pregnant at time of order entry: ",?22,$S($P(RAORD0,"^",13)="y":"YES",$P(RAORD0,"^",13)="n":"NO",1:"UNKNOWN")
"RTN","RAORD6",15,0)
 .Q:'$D(RAOIFN)
"RTN","RAORD6",16,0)
 .Q:'$D(^RADPT("AO",$G(RAOIFN),RADFN))
"RTN","RAORD6",17,0)
 .N RAINVDT,RA5
"RTN","RAORD6",18,0)
 .S RAINVDT=$O(^RADPT("AO",RAOIFN,RADFN,0))
"RTN","RAORD6",19,0)
 .Q:'$G(RAINVDT)
"RTN","RAORD6",20,0)
 .S RA5=$O(^RADPT("AO",RAOIFN,RADFN,RAINVDT,0))
"RTN","RAORD6",21,0)
 .Q:'$G(RA5)
"RTN","RAORD6",22,0)
 .N R3,RAPCOMM S R3=$G(^RADPT(RADFN,"DT",$G(RAINVDT),"P",$G(RA5),0))
"RTN","RAORD6",23,0)
 .S RAPCOMM=$G(^RADPT(RADFN,"DT",+$G(RAINVDT),"P",+$G(RA5),"PCOMM"))
"RTN","RAORD6",24,0)
 .W:$P(R3,U,32)'="" !,"Pregnancy Screen: ",$S($P(R3,"^",32)="y":"Patient answered yes",$P(R3,"^",32)="n":"Patient answered no",$P(R3,"^",32)="u":"Patient is unable to answer or is unsure",1:"")
"RTN","RAORD6",25,0)
 .W:$P(R3,U,32)'="n"&$L(RAPCOMM) !,"Pregnancy Screen Comment: ",RAPCOMM
"RTN","RAORD6",26,0)
 .Q
"RTN","RAORD6",27,0)
 W:$P(RAORD0,"^",24)="y" !!?12,"*** Universal Isolation Precautions ***"
"RTN","RAORD6",28,0)
 W:$D(RA("VDT")) !!?8,"** Note Request Associated with Visit on ",RA("VDT")," **"
"RTN","RAORD6",29,0)
 W !!,"Requested:",?18,RA("PRC INFO")
"RTN","RAORD6",30,0)
 I $D(^TMP($J,"RA DIFF PRC")),('$D(RAFOERR)),('$D(RAOPT("REG"))),('$D(RAOPT("ORDEREXAM"))),('$D(RAOPT("ADDEXAM"))) D  Q:RAX["^"
"RTN","RAORD6",31,0)
 . ; don't print registered procedure info (CPT, Proc Type, Imaging
"RTN","RAORD6",32,0)
 . ; Type) if entering through 'Request An Exam', 'Register Patient
"RTN","RAORD6",33,0)
 . ; for Exams' or 'Add Exams To Last Visit'.  Don't print if ordered
"RTN","RAORD6",34,0)
 . ; through ANY version of OE/RR.  If ordered through OE/RR, RAFOERR
"RTN","RAORD6",35,0)
 . ; will be defined. (Set in RAORD1 & RAO7RO)
"RTN","RAORD6",36,0)
 . N RAT,RA18NLIN S RAT="",RA18NLIN=0 W !,"Registered:"
"RTN","RAORD6",37,0)
 . F  S RAT=$O(^TMP($J,"RA DIFF PRC",RAT)) Q:RAT=""  D  Q:RAX["^"
"RTN","RAORD6",38,0)
 .. D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",39,0)
 .. W:RA18NLIN ! W ?12,RAT
"RTN","RAORD6",40,0)
 .. S RA18NLIN=1
"RTN","RAORD6",41,0)
 .. Q
"RTN","RAORD6",42,0)
 . Q
"RTN","RAORD6",43,0)
 I $G(RACMFLG("O"))'="" W !?12,"** The requested procedure has contrast media assigned **"
"RTN","RAORD6",44,0)
 I $G(RACMFLG("R"))'="" W !?12,"** A registered procedure uses contrast media **"
"RTN","RAORD6",45,0)
 W:$D(RA("MOD")) !,"Procedure Modifiers:",?22,RA("MOD")
"RTN","RAORD6",46,0)
 I RA("PRC MSG") D  Q:RAX["^"
"RTN","RAORD6",47,0)
 . N A,B,C,X S (A,C)=0 W !,"Procedure Message: ",!
"RTN","RAORD6",48,0)
 . F  S A=$O(^RAMIS(71,+$P(RAORD0,"^",2),3,A)) Q:A'>0!(RAX["^")  D
"RTN","RAORD6",49,0)
 .. S B=+$G(^RAMIS(71,+$P(RAORD0,"^",2),3,A,0))
"RTN","RAORD6",50,0)
 .. S X=$G(^RAMIS(71.4,B,0))
"RTN","RAORD6",51,0)
 .. W:'C ?3,"-" W:C !?3,"-"
"RTN","RAORD6",52,0)
 .. D OUTTEXT^RAUTL9(X,"",5,80,4,"","!")
"RTN","RAORD6",53,0)
 .. D HD:($Y+10)>IOSL S C=C+1  ; 5-P123
"RTN","RAORD6",54,0)
 .. Q
"RTN","RAORD6",55,0)
 . Q
"RTN","RAORD6",56,0)
 W !,"Request Status:",?22,$E(RA("OST"),1,24)
"RTN","RAORD6",57,0)
 I $P(RAORD0,"^",5)=1!($P(RAORD0,"^",5)=3) D  Q:RAX["^"
"RTN","RAORD6",58,0)
 . W !,"Reason ",$S($P(RAORD0,"^",5)=1:"Cancelled",1:"Held"),":"
"RTN","RAORD6",59,0)
 . W ?22,$S($D(^RA(75.2,+$P(RAORD0,"^",10),0)):$E($P(^(0),"^"),1,50),$P(RAORD0,"^",27)]"":$E($P(RAORD0,"^",27),1,50),1:"UNKNOWN")
"RTN","RAORD6",60,0)
 . D HD:($Y+10)>IOSL Q:RAX["X"  ; 5-P123
"RTN","RAORD6",61,0)
 . I $D(^RAO(75.1,RAOIFN,1)) D  Q:RAX["^"
"RTN","RAORD6",62,0)
 .. N X,I,RAXX
"RTN","RAORD6",63,0)
 .. K ^UTILITY($J,"W")
"RTN","RAORD6",64,0)
 .. W !,"Hold Description:",!
"RTN","RAORD6",65,0)
 .. S I=0 F  S I=$O(^RAO(75.1,RAOIFN,1,I)) Q:'I  S (RAXX,X)=^(I,0) D HD:($Y+10)>IOSL Q:RAX["^"  S X=RAXX D ^DIWP  ; 5-P123
"RTN","RAORD6",66,0)
 .. Q:RAX["^"
"RTN","RAORD6",67,0)
 .. D HD:($Y+10)>IOSL Q:RAX["X"  ; 5-P123
"RTN","RAORD6",68,0)
 .. D ^DIWW:$D(RAXX)
"RTN","RAORD6",69,0)
 .. D HD:($Y+10)>IOSL Q:RAX["X"  ; 5-P123
"RTN","RAORD6",70,0)
 . I $P(RAORD0,"^",5)=1 D
"RTN","RAORD6",71,0)
 .. W !!,?(IOM-(IOM/2+15)),"*********************",!,?(IOM-(IOM/2+15)),"* C A N C E L L E D *",!,?(IOM-(IOM/2+15)),"*********************"
"RTN","RAORD6",72,0)
 W:$P(RAORD0,"^",5)=6&($D(RA("ST"))) !,"Exam Status:",?22,RA("ST")
"RTN","RAORD6",73,0)
 W:$P(RAORD0,"^",5)=8&($D(RA("SDT"))) !,"Exam Scheduled:",?22,RA("SDT")
"RTN","RAORD6",74,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",75,0)
 W !!,"Requester:",?22,$E(RA("PHY"),1,20)
"RTN","RAORD6",76,0)
 W:RA("PHY")'="UNKNOWN" !?1,"Tel/Page/Dig Page: ",$G(RA("RPHOINFO"))
"RTN","RAORD6",77,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",78,0)
 W !,"Attend Phy Current:",?22,$E(RA("ATTEN"),1,20)
"RTN","RAORD6",79,0)
 W:RA("ATTEN")'="UNKNOWN" !?1,"Tel/Page/Dig Page: ",$G(RA("APHOINFO"))
"RTN","RAORD6",80,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",81,0)
 W !,"Prim Phy Current:",?22,$E(RA("PRIM"),1,20)
"RTN","RAORD6",82,0)
 W:RA("PRIM")'="UNKNOWN" !?1,"Tel/Page/Dig Page: ",$G(RA("PPHOINFO"))
"RTN","RAORD6",83,0)
 K RAPASS1,RAPASS2
"RTN","RAORD6",84,0)
 S RAPASS1=RA("ATTEN"),RAPASS2=RA("OATTEN")
"RTN","RAORD6",85,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",86,0)
 I $$ID^RAORD6(RAPASS1,RAPASS2) D
"RTN","RAORD6",87,0)
 . W !,"Attend Phy At Order:",?22,$E(RA("OATTEN"),1,20)
"RTN","RAORD6",88,0)
 . W:RA("OATTEN")'="UNKNOWN" !?1,"Tel/Page/Dig Page: ",$G(RA("OAPHOINFO"))
"RTN","RAORD6",89,0)
 . Q
"RTN","RAORD6",90,0)
 S RAPASS1=RA("PRIM"),RAPASS2=RA("OPRIM")
"RTN","RAORD6",91,0)
 I $$ID^RAORD6(RAPASS1,RAPASS2) D
"RTN","RAORD6",92,0)
 . W !,"Prim Phy At Order:",?22,$E(RA("OPRIM"),1,20)
"RTN","RAORD6",93,0)
 . W:RA("OPRIM")'="UNKNOWN" !?1,"Tel/Page/Dig Page: ",$G(RA("OPPHOINFO"))
"RTN","RAORD6",94,0)
 . Q
"RTN","RAORD6",95,0)
 K RAPASS1,RAPASS2
"RTN","RAORD6",96,0)
 I +$P(RAORD0,"^",8) D
"RTN","RAORD6",97,0)
 . N RAPPRAD S RAPPRAD=+$P(RAORD0,"^",8)
"RTN","RAORD6",98,0)
 . S:$P($G(^VA(200,RAPPRAD,20)),"^",2)]"" RAPPRAD=$P(^(20),"^",2)
"RTN","RAORD6",99,0)
 . S:RAPPRAD=+RAPPRAD RAPPRAD=$P(^VA(200,RAPPRAD,0),"^")
"RTN","RAORD6",100,0)
 . W !,"Approved by: ",?22,RAPPRAD
"RTN","RAORD6",101,0)
 . Q
"RTN","RAORD6",102,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",103,0)
 W !,"Date/Time Ordered:",?22,$S($D(RA("ODT")):RA("ODT"),1:""),"  by ",$E(RA("USR"),1,20)
"RTN","RAORD6",104,0)
 W:$D(RA("RDT")) !,"Date Desired:",?22,RA("RDT")
"RTN","RAORD6",105,0)
 D:$P(RAORD0,"^",5)=1 USERCAN^RAORD3
"RTN","RAORD6",106,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",107,0)
 W:$D(RA("PDT")) !,"Pre-op Date/Time:",?22,RA("PDT"),!!?26,"**** P R E - O P ****",!
"RTN","RAORD6",108,0)
BAR ;Print bar-coded SSN on request form if term type has bar code setup
"RTN","RAORD6",109,0)
 I $G(RASSN)'?3N1"-"2N1"-".E G CONT
"RTN","RAORD6",110,0)
 S X3=$E(RASSN,1,3)_$E(RASSN,5,6)_$E(RASSN,8,11)
"RTN","RAORD6",111,0)
 ; 06/20/2007 KAM/BAY RA*5*85 Added 2 line feeds
"RTN","RAORD6",112,0)
 D PSET^%ZISP I IOBARON]"",(IOBAROFF]"") W !!!?49,@IOBARON,X3,@IOBAROFF,!
"RTN","RAORD6",113,0)
 D PKILL^%ZISP
"RTN","RAORD6",114,0)
 ;
"RTN","RAORD6",115,0)
CONT D HD:($Y+10)>IOSL Q:RAX["^"  D ODX^RABWUTL(RAOIFN) ; * Billing Aware *  ; 5-P123
"RTN","RAORD6",116,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",117,0)
 ; 06/20/2007 KAM/BAY RA*5*85 Added line feed to the next line
"RTN","RAORD6",118,0)
 I $L(RA("STY_REA")) W ! D DIWP^RAUTL5(1,68,"Reason for Study: "_RA("STY_REA")) ;3-p75
"RTN","RAORD6",119,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  K ^UTILITY($J,"W"),^(1) W !,"Clinical History:",! K RAXX F RAV=0:0 S RAV=$O(^RAO(75.1,RAOIFN,"H",RAV)) Q:'RAV  I $D(^(RAV,0)) S RAXX=^(0) D HD:($Y+10)>IOSL Q:RAX["^"  S X=RAXX D ^DIWP  ; 5-P123
"RTN","RAORD6",120,0)
 Q:RAX["^"  D HD:($Y+10)>IOSL Q:RAX["^"  D ^DIWW:$D(RAXX),HD:($Y+10)>IOSL Q:RAX["^"  D WORK ;always print bottom section of form 012601  ; 5-P123
"RTN","RAORD6",121,0)
 W ! S BOT=IOSL-($Y+4) S:($E(IOST,1,6)="P-BROW"&($D(DDBRZIS))) BOT=5 F BT=1:1:BOT W !
"RTN","RAORD6",122,0)
 K BOT,BT
"RTN","RAORD6",123,0)
 W !,"VA Form 519a-ADP"
"RTN","RAORD6",124,0)
 Q
"RTN","RAORD6",125,0)
 ;
"RTN","RAORD6",126,0)
WORK W !,RALNE,!,"Date Performed: ________________________",?46
"RTN","RAORD6",127,0)
 I $O(^RADPT("AO",RAOIFN,0))="" W "Case No.: ______________________"
"RTN","RAORD6",128,0)
 E  W "Case No.: ______see above_______"
"RTN","RAORD6",129,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",130,0)
 W !,"Technologist Initials: _________________"
"RTN","RAORD6",131,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",132,0)
 W !?46,"Number/Size Films: _____________",!,"Interpreting Phys. Initials: ___________",?65,"_____________",!?65,"_____________",!
"RTN","RAORD6",133,0)
 D HD:($Y+10)>IOSL Q:RAX["^"  ; 5-P123
"RTN","RAORD6",134,0)
 W !,"Comments:"
"RTN","RAORD6",135,0)
 ;
"RTN","RAORD6",136,0)
TC D EN30^RAO7PC1(RAOIFN),TC^RAORD61 Q:RAX["^"
"RTN","RAORD6",137,0)
 ;
"RTN","RAORD6",138,0)
DASHLN W ! F I=1:1:5 D HD:($Y+10)>IOSL Q:RAX["^"  W !,RALNE ;P18  ; 5-P123
"RTN","RAORD6",139,0)
 Q
"RTN","RAORD6",140,0)
 ;
"RTN","RAORD6",141,0)
HD S:'$D(RAPGE) RAPGE=0 D CRCHK Q:$G(RAX)["^"  S RATAB=$S($D(RA("ILC")):1,1:16)
"RTN","RAORD6",142,0)
 ;10/12/2006 KAM Remedy tk 162508 Changed next line added "Printed:"
"RTN","RAORD6",143,0)
 W:$Y @IOF W !?RATAB,">>"_$S($D(RACRHD):"Discontinued ",1:"")_"Rad/NM Consultation" W:$D(RA("ILC")) " for ",$E(RA("ILC"),1,17) W "<<Printed:" S X="NOW",%DT="T" D ^%DT K %DT D D^RAUTL W ?52,Y ;P18 4-P74
"RTN","RAORD6",144,0)
 S RAPGE=RAPGE+1 W ?71,"Page ",RAPGE ;P18
"RTN","RAORD6",145,0)
 W !,RALNE1,!,"Name         : ",RA("NME"),?46,"Urgency    : ",RA("OUG") W:$D(RA("PORTABLE")) "  *PORTABLE*"
"RTN","RAORD6",146,0)
 W !,"Pt ID Num    : ",RASSN,?46,"Transport  : ",RA("TRAN")
"RTN","RAORD6",147,0)
 S Y=RA("DOB") D D^RAUTL W !,"Date of Birth: ",Y,?46,"Patient Loc: ",$E(RA("HLC"),1,20)
"RTN","RAORD6",148,0)
 ;10/12/2006 KAM Remedy Ticket 162508 changed next line
"RTN","RAORD6",149,0)
 W !,"Age at req   : ",RA("AGE"),?46,"Phone Ext  : ",RA("HPH") ;5-P75
"RTN","RAORD6",150,0)
 W !,"Sex          : ",$S(RA("SEX")="M":"MALE",1:"FEMALE") W:$D(RA("ROOM-BED")) ?46,"Room-Bed   : ",RA("ROOM-BED")
"RTN","RAORD6",151,0)
 ; *** NSR 20140507 Start Mod to print weight & date taken in Radiology requests ***
"RTN","RAORD6",152,0)
 W !,"Weight (lbs) : ",$S($D(RA("WT")):RA("WT"),1:"") W ?46,"Weight Date: ",$S($D(RA("WTDT")):RA("WTDT"),1:"") ;5-P123
"RTN","RAORD6",153,0)
 ; *** NSR 20140507 End Mod to print weight & date taken in Radiology requests ***
"RTN","RAORD6",154,0)
 ; 5-P123 moved next line to here from line above Start Mod
"RTN","RAORD6",155,0)
 W !,RALNE1
"RTN","RAORD6",156,0)
 W:$P(RAORD0,U,5)=1 !,"***C A N C E L L E D***",?56,"***C A N C E L L E D***"
"RTN","RAORD6",157,0)
 Q
"RTN","RAORD6",158,0)
 ;
"RTN","RAORD6",159,0)
CRCHK I RAPGE,$E(IOST)="C" W !!,$C(7),"Press RETURN to continue or '^' to stop " R X:DTIME S RAX=X
"RTN","RAORD6",160,0)
 Q
"RTN","RAORD6",161,0)
ID(X,Y) ; Checks for the following condition:
"RTN","RAORD6",162,0)
 ; 1) Attending Phy. Current & Attending Phy. At Order are the same.
"RTN","RAORD6",163,0)
 ; 2) Primary Phy. Current & Primary Phy. At Order are the same.
"RTN","RAORD6",164,0)
 ; Input Variables:
"RTN","RAORD6",165,0)
 ; 'X'-> Attending/Primary Phy. Current
"RTN","RAORD6",166,0)
 ; 'Y'-> Attending/Primary Phy. At Order
"RTN","RAORD6",167,0)
 I X']""!(Y']"") Q 0
"RTN","RAORD6",168,0)
 I $$UP^XLFSTR(X)="UNKNOWN",($$UP^XLFSTR(Y)="UNKNOWN") Q 0
"RTN","RAORD6",169,0)
 N A,B,Z S A=+$O(^VA(200,"B",X,"")),B=+$O(^VA(200,"B",Y,""))
"RTN","RAORD6",170,0)
 I A>0,(B>0),(A=B) S Z=0
"RTN","RAORD6",171,0)
 E  S Z=1
"RTN","RAORD6",172,0)
 Q Z ; $S(Z=1:"different physician",Z=0:"same physician")
"RTN","RAORD61")
0^3^B7261744^B7128704
"RTN","RAORD61",1,0)
RAORD61 ;HISC/GJC-Print A Request Cont. ;2/2/98  15:28
"RTN","RAORD61",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**45,68,47,123**;Mar 16, 1998;Build 7
"RTN","RAORD61",3,0)
 ;11/18/05 KAM Remedy Call 100930 Remove extra dash lines
"RTN","RAORD61",4,0)
 ; 5-P123 6/23/2015 MJT RA*5*123 NSR 20140507 print weight & date taken in Radiology requests
"RTN","RAORD61",5,0)
 ;
"RTN","RAORD61",6,0)
TC ;technologist information & comment (called from RAORD6)
"RTN","RAORD61",7,0)
 N RA18FL,RA18ARR,RA18EX,RA18CNI,RA18DTI,RA18PRC,RA18ND,RA18TC S RA18EX=0,RA18CNI=0
"RTN","RAORD61",8,0)
 ;11/18/05 KAM Modified next line - was G:RA18DTI="" DASHLN^RAORD6
"RTN","RAORD61",9,0)
 S RA18DTI=$O(^RADPT("AO",RAOIFN,RADFN,0)) Q:RA18DTI=""
"RTN","RAORD61",10,0)
 F  S RA18CNI=$O(^TMP($J,"RAE2",RADFN,RA18CNI)) Q:+RA18CNI=0  D  Q:RAX["^"
"RTN","RAORD61",11,0)
 . S RA18PRC=""
"RTN","RAORD61",12,0)
 . F  S RA18PRC=$O(^TMP($J,"RAE2",RADFN,RA18CNI,RA18PRC)) Q:RA18PRC=""  D  Q:RAX["^"
"RTN","RAORD61",13,0)
 .. ;case info
"RTN","RAORD61",14,0)
 .. I $$USESSAN^RAHLRU1() W !,"Case No: "_$P($G(^RADPT(RADFN,"DT",RA18DTI,"P",RA18CNI,0)),"^",31),!
"RTN","RAORD61",15,0)
 .. I '$$USESSAN^RAHLRU1() W !,"Case No: "_$P($G(^RADPT(RADFN,"DT",RA18DTI,"P",RA18CNI,0)),"^")
"RTN","RAORD61",16,0)
 .. S RA18FL=0,RA18ARR("FT")=""
"RTN","RAORD61",17,0)
 .. S RA18TC=0 F  S RA18TC=$O(^RADPT(RADFN,"DT",RA18DTI,"P",RA18CNI,"F",RA18TC)) Q:RA18TC=""  S RA18ARR("F")=$G(^RADPT(RADFN,"DT",RA18DTI,"P",RA18CNI,"F",RA18TC,0),0) D  Q:$L(RA18ARR("FT"))>32
"RTN","RAORD61",18,0)
 ... I RA18ARR("F")'=0 S RA18ARR("FT")=RA18ARR("FT")_$P($G(RA18ARR("F")),"^",2)_"-"_$P($G(^RA(78.4,$P($G(RA18ARR("F")),"^",1),0)),"^",1)_";"
"RTN","RAORD61",19,0)
 .. S RA18TC=0 F  S RA18TC=$O(^RADPT(RADFN,"DT",RA18DTI,"P",RA18CNI,"TC",RA18TC)) Q:RA18TC=""  S RA18ARR("T",RA18TC,0)=$G(^RADPT(RADFN,"DT",RA18DTI,"P",RA18CNI,"TC",RA18TC,0),0) D
"RTN","RAORD61",20,0)
 ... I RA18ARR("T",RA18TC,0)'=0 W:RA18FL>0 ! W ?14,"Tech: " I RA18ARR("T",RA18TC,0)'="" S RA18ARR("N")=$$GET1^DIQ(200,RA18ARR("T",RA18TC,0),.01) W $E($P(RA18ARR("N"),"^",1),1,18)
"RTN","RAORD61",21,0)
 ... W:(RA18FL'>0) ?38,"  Film: "_$E(RA18ARR("FT"),1,32)
"RTN","RAORD61",22,0)
 ... S RA18FL=RA18FL+1
"RTN","RAORD61",23,0)
 .. I '$D(RA18ARR("T")) W ?14,"Tech: ",?38,"  Film: "_$E(RA18ARR("FT"),1,32)
"RTN","RAORD61",24,0)
 .. K RA18ARR("T"),RA18ARR("F"),RA18ARR("N")
"RTN","RAORD61",25,0)
 .. I $O(^TMP($J,"RAE2",RADFN,RA18CNI,RA18PRC,"TCOM",0))>0 D  Q
"RTN","RAORD61",26,0)
 ... ;tech comm
"RTN","RAORD61",27,0)
 ... W !
"RTN","RAORD61",28,0)
 ... S RA18EX=$$TXTOUT^RAUTL11(^TMP($J,"RAE2",RADFN,RA18CNI,RA18PRC,"TCOM",1),1,70,-1,"",4,1,1,1)
"RTN","RAORD61",29,0)
 ... D HD^RAORD6:($Y+10)>IOSL   ; 5-P123
"RTN","RAORD61",30,0)
 Q
"RTN","RAORD61",31,0)
 ;
"RTN","RAUTL4")
0^4^B29392357^B25705072
"RTN","RAUTL4",1,0)
RAUTL4 ;HISC/CAH,FPT,GJC AISC/SAW-Utility Routine ; 13 Jul 2015  5:10 PM
"RTN","RAUTL4",2,0)
 ;;5.0;Radiology/Nuclear Medicine;**123**;Mar 16, 1998;Build 7
"RTN","RAUTL4",3,0)
 ;
"RTN","RAUTL4",4,0)
 ; Supported IA #1252 reference to $$OUTPTPR^SDUTL3 & $$OUTPTAP^SDUTL3  5-P123
"RTN","RAUTL4",5,0)
 ; Supported IA #10035 reference to (^DPT(DFN,.1)  5-P123
"RTN","RAUTL4",6,0)
 ;
"RTN","RAUTL4",7,0)
 ; 5-P123 6/25/2015 MJT RA*5*123 NSR 20140515 add primary care provider if pt is outpatient
"RTN","RAUTL4",8,0)
 ;
"RTN","RAUTL4",9,0)
EN1 ;ENTRY POINT FOR INPUT TRANSFORM FOR FIELD 5, FILE 74
"RTN","RAUTL4",10,0)
 S RAX=$G(^RARPT(DA,0))
"RTN","RAUTL4",11,0)
 I X="R",$D(^RA(79.1,+$P(^RADPT(+$P(RAX,U,2),"DT",(9999999.9999-$P(RAX,U,3)),0),U,4),0)),$P(^(0),U,17)'["Y" K X W !,"This Imaging Location does not allow the use of 'RELEASED/NOT VERIFIED' status!" G EXIT
"RTN","RAUTL4",12,0)
 G EXIT:X'="V" S RACI=$S($D(RACNI):+RACNI,1:+$O(^RADPT(+$P(RAX,U,2),"DT",9999999.9999-$P(RAX,U,3),"P","B",+$P(RAX,U,4),0)))
"RTN","RAUTL4",13,0)
 I '$D(^RADPT(+$P(RAX,U,2),"DT",9999999.9999-$P(RAX,U,3),"P",RACI,0)) K X W !?3,"Exam information is missing.  Unable to continue." G EXIT
"RTN","RAUTL4",14,0)
 S RA0=^RADPT(+$P(RAX,U,2),"DT",9999999.9999-$P(RAX,U,3),"P",RACI,0),RAY=$S($D(^RAMIS(71,+$P(RA0,U,2),0)):$P(^(0),U,7),1:"N")
"RTN","RAUTL4",15,0)
 I RAY'["Y",$D(^VA(200,+$P(RA0,U,12),0)) S RAY=$S($D(^("RA")):$P(^("RA"),U),1:"N")
"RTN","RAUTL4",16,0)
 I RAY["Y",'$D(^VA(200,+$P(RA0,U,15),0)) K X W !?3,"Staff review is required to verify this report!" G EXIT
"RTN","RAUTL4",17,0)
 I '$P(RA0,U,12),'$P(RA0,U,15) K X W !?3,"You must have at least an interpreting 'resident' or 'staff' entered before you can verify this report!" G EXIT
"RTN","RAUTL4",18,0)
 I $D(^RA(79,+$P(^RADPT(+$P(RAX,U,2),"DT",(9999999.9999-$P(RAX,U,3)),0),U,3),.1)),$P(^(.1),U,16)="Y",$O(^RARPT(DA,"I",0))<0 K X W !?3,"An impression was not entered. Verifying is not allowed!"
"RTN","RAUTL4",19,0)
 ; Handle the situation where a report moves from no report status
"RTN","RAUTL4",20,0)
 ; (null) to a report status of verified.  This situation happens at
"RTN","RAUTL4",21,0)
 ; sites when creating stub reports through the Imaging software.
"RTN","RAUTL4",22,0)
 I $P(RAX,"^",5)="",(X="V") D
"RTN","RAUTL4",23,0)
 . X:$D(^DD(74,5,1,2,2))#2 ^(2) ; kill 'ARES' xref
"RTN","RAUTL4",24,0)
 . X:$D(^DD(74,5,1,3,2))#2 ^(2) ; kill 'ASTF' xref
"RTN","RAUTL4",25,0)
 . Q
"RTN","RAUTL4",26,0)
EXIT K RA0,RAX,RAY Q
"RTN","RAUTL4",27,0)
ASK ;Prompt for range of entries, parse response
"RTN","RAUTL4",28,0)
 ;INPUT VARIABLES:     ;ch
"RTN","RAUTL4",29,0)
 ; RAF1: If defined, a list or range of numbers are permitted i.e,
"RTN","RAUTL4",30,0)
 ;       1,2,3-8.  If not defined, only single number input is permitted.
"RTN","RAUTL4",31,0)
 ; RACNT=highest possible number in range
"RTN","RAUTL4",32,0)
 ; ^TMP($J,"RAEX",n)=array of acceptable numeric responses
"RTN","RAUTL4",33,0)
 ;OUTPUT VARIABLES:
"RTN","RAUTL4",34,0)
 ;  RADUP(n)=array of all selected numeric responses
"RTN","RAUTL4",35,0)
 K RADUP S (RAERR,RAI)=0
"RTN","RAUTL4",36,0)
 S X=$$USRSEL($D(RAF1)#2,$G(RACNT)) Q:X="^"!(X="")
"RTN","RAUTL4",37,0)
 ; X returns: a single # -OR- a list of #'s i.e, 1-3,8 or 2,3,4 -OR- '^' 
"RTN","RAUTL4",38,0)
 I '$D(RAF1),'$D(^TMP($J,"RAEX",+X)) W !!?3,*7,"Item ",+X," is not a valid selection.",! G ASK
"RTN","RAUTL4",39,0)
 I '$D(RAF1) S X=+X,Y=^TMP($J,"RAEX",+X) Q
"RTN","RAUTL4",40,0)
PARSE ; Parse out the list of numbers entered by the user.
"RTN","RAUTL4",41,0)
 S RAI=RAI+1,RAPAR=$P(X,",",RAI) G EX:RAPAR="" I RAPAR?.N1"-".N S RADASH="" F RASEL=$P(RAPAR,"-"):1:$P(RAPAR,"-",2) D CHK G ASK:RAERR
"RTN","RAUTL4",42,0)
 I '$D(RADASH) S RASEL=RAPAR D CHK
"RTN","RAUTL4",43,0)
 K RADASH G ASK:RAERR,PARSE
"RTN","RAUTL4",44,0)
 ;
"RTN","RAUTL4",45,0)
CHK I $D(RADASH),+$P(RAPAR,"-",2)<+$P(RAPAR,"-") S RAERR=1 W !?3,*7,"Invalid range of numbers specified." Q
"RTN","RAUTL4",46,0)
 I RASEL'?.N!(RASEL'=+RASEL)!(RASEL?16.N.E) D  Q
"RTN","RAUTL4",47,0)
 . W !?3,$C(7),"Item ",RASEL," is not a valid selection.",!
"RTN","RAUTL4",48,0)
 . S RAERR=1
"RTN","RAUTL4",49,0)
 . Q
"RTN","RAUTL4",50,0)
 I '$D(^TMP($J,"RAEX",RASEL)) W !?3,*7,"Item ",RASEL," is not a valid selection.",! S RAERR=1 Q
"RTN","RAUTL4",51,0)
 I $D(RADUP(RASEL)) W !?3,*7,"Item ",RASEL," was already selected.",! S RAERR=1 Q
"RTN","RAUTL4",52,0)
 S RADUP(RASEL)="" Q
"RTN","RAUTL4",53,0)
EX S X="" I 'RAERR,$D(RADUP) S X=1
"RTN","RAUTL4",54,0)
 Q
"RTN","RAUTL4",55,0)
 ;
"RTN","RAUTL4",56,0)
UPPER ;Convert X to uppercase letters, return as Y
"RTN","RAUTL4",57,0)
 S Y=$$UP^XLFSTR(X)
"RTN","RAUTL4",58,0)
 Q
"RTN","RAUTL4",59,0)
ORDEL ; Inform the 'Rad' user that the 'Order' field is null!
"RTN","RAUTL4",60,0)
 ; Called from the [RA STATUS ENTRY] template.
"RTN","RAUTL4",61,0)
 W !!?5,"The value for the 'Order' field has been deleted, this"
"RTN","RAUTL4",62,0)
 W !?5,"Examination Status is now inactive/invalid.  Please use"
"RTN","RAUTL4",63,0)
 W !?5,"the 'List Exams with Inactive/Invalid Statuses' option to"
"RTN","RAUTL4",64,0)
 W !?5,"generate a report showing all inactive/invalid exams.",!,$C(7)
"RTN","RAUTL4",65,0)
 Q
"RTN","RAUTL4",66,0)
EMAIL ; Sent the message off to the req. physician
"RTN","RAUTL4",67,0)
 Q:'$D(DUZ)#2  ; DUZ not defined!
"RTN","RAUTL4",68,0)
 Q:'($D(^TMP($J,"RA AUTOE"))\10)  ; no report data, abort
"RTN","RAUTL4",69,0)
 N DUZ,XMDUZ,XMSUB,XMTEXT,XMY S XMDUZ=.5
"RTN","RAUTL4",70,0)
 S XMTEXT="^TMP($J,""RA AUTOE"","
"RTN","RAUTL4",71,0)
 S XMSUB="Rad/Nuc Med Report ("_$P($G(^RARPT(RA74IEN,0)),"^")_")"
"RTN","RAUTL4",72,0)
 ;  ***  NSR 20140515  Start Mod  add primary care provider if pt is outpatient  5-P123  ***
"RTN","RAUTL4",73,0)
 ;  ***  Also sends to associate provider if one identified  ; 5-P123
"RTN","RAUTL4",74,0)
 S DFN=$P(RA74(0),U,2)
"RTN","RAUTL4",75,0)
 I '$D(^DPT(DFN,.1)) S RAPCP=$$OUTPTPR^SDUTL3(DFN) S:RAPCP'="" XMY($P(RAPCP,U,1))="" S RAAP=$$OUTPTAP^SDUTL3(DFN) S:RAAP'="" XMY($P(RAAP,U,1))=""  ; 5-P123
"RTN","RAUTL4",76,0)
 S XMY(RARPHYS)="" D ^XMD K ^TMP($J,"RA AUTOE")
"RTN","RAUTL4",77,0)
 K RAAP,RAPCP    ; 5-P123
"RTN","RAUTL4",78,0)
 ;  ***  NSR 20140515  End Mod  add primary care provider if pt is outpatient  5-P123  ***
"RTN","RAUTL4",79,0)
 Q
"RTN","RAUTL4",80,0)
ENV() ; Check the current environment the software is running under.
"RTN","RAUTL4",81,0)
 ; If package is being installed DO NOT fire off message (0)
"RTN","RAUTL4",82,0)
 ; If package wide variables are missing, DO NOT fire off message (0)
"RTN","RAUTL4",83,0)
 Q:'$D(RACCESS(DUZ))\10!('$D(RAIMGTY))!('$D(RAMDIV))!('$D(RAMDV))!('$D(RAMLC)) 0 ; not in package
"RTN","RAUTL4",84,0)
 Q:$D(XPDNM) 0 ; in environment check OR pre/post install routine
"RTN","RAUTL4",85,0)
 Q 1
"RTN","RAUTL4",86,0)
INCR(X) ; increment a variable by one
"RTN","RAUTL4",87,0)
 S X=X+1,RAACNT=X
"RTN","RAUTL4",88,0)
 Q RAACNT
"RTN","RAUTL4",89,0)
 ;
"RTN","RAUTL4",90,0)
USRSEL(RABOOL,RACNT) ; Allows the user to select a number or list of
"RTN","RAUTL4",91,0)
 ; numbers within a certain range.
"RTN","RAUTL4",92,0)
 ; Vars: RABOOL=1 if a list of #'s can be entered i.e, 1-3,8 -or- 2,3,4
"RTN","RAUTL4",93,0)
 ;             =0 a single number is the only valid input
"RTN","RAUTL4",94,0)
 ;        RACNT=the upper value within the valid range of numbers
"RTN","RAUTL4",95,0)
 N DIR,DIROUT,DIRUT,DTOUT,DUOUT,X,Y
"RTN","RAUTL4",96,0)
 S DIR("A",1)="Type a '^' to STOP, or"
"RTN","RAUTL4",97,0)
 S DIR("A")="CHOOSE FROM 1-"_RACNT_": "
"RTN","RAUTL4",98,0)
 I RABOOL D  ; setup DIR to accept a list of #'s within our range
"RTN","RAUTL4",99,0)
 . S DIR(0)="LACO^1:"_RACNT_":0",DIR("?",1)="Please enter a number or range of numbers seperated by a dash,",DIR("?")="or two or more numbers seperated by a combination of commas and dashes."
"RTN","RAUTL4",100,0)
 . Q
"RTN","RAUTL4",101,0)
 E  D  ; setup DIR to accept a single number within our range
"RTN","RAUTL4",102,0)
 . S DIR(0)="NAO^1:"_RACNT_":0",DIR("?",1)="Enter the number corresponding to the exam you wish to select.",DIR("?")="A list or range of numbers will not be accepted."
"RTN","RAUTL4",103,0)
 . Q
"RTN","RAUTL4",104,0)
 D ^DIR S:$D(DTOUT)!($D(DUOUT)) Y="^" ; exit iff timeout or '^'
"RTN","RAUTL4",105,0)
 ; this code effects the selection of exam record data when presented
"RTN","RAUTL4",106,0)
 ; to the user from options: 'Profile of Rad/Nuc Med Exams', 'Case
"RTN","RAUTL4",107,0)
 ; No. Exam Edit' & 'Select Report to Print by Patient'.
"RTN","RAUTL4",108,0)
 ; Called from ^RAPTLU (patient exam lookup)
"RTN","RAUTL4",109,0)
 S:$E(Y,$L(Y))="," Y=$$COMMA(Y)
"RTN","RAUTL4",110,0)
 Q Y
"RTN","RAUTL4",111,0)
COMMA(Y) ; If the last character in a string is a comma, strip it off
"RTN","RAUTL4",112,0)
 ; example: 1-100, becomes 1-100
"RTN","RAUTL4",113,0)
 N RA F RA=$L(Y):-1 Q:$E(Y,RA)'=","
"RTN","RAUTL4",114,0)
 Q $E(Y,1,RA)
"VER")
8.0^22.0
"^DD",79,79,.126,0)
AUTO E-MAIL TO REQ. PHYS?^S^1:yes;^.1;26^Q
"^DD",79,79,.126,3)
Enter 'Y'es to automatically send Requesting Physicians the radiology reports via e-mail.
"^DD",79,79,.126,21,0)
^^6^6^3151209^
"^DD",79,79,.126,21,1,0)
Entering 'Y'es will turn on a feature that automatically sends the 
"^DD",79,79,.126,21,2,0)
Radiology/Nuclear Medicine findings report to the Requesting Physician, 
"^DD",79,79,.126,21,3,0)
Primary Care Physician, and Associated Provider (if one exists), via 
"^DD",79,79,.126,21,4,0)
e-mail at the time it is verified.  If this field is left blank, verified
"^DD",79,79,.126,21,5,0)
reports will not be e-mailed to the Requesting Physician, Primary Care
"^DD",79,79,.126,21,6,0)
Physician, or Associated Provider.
"^DD",79,79,.126,"DT")
2960129
"BLD",9255,6)
^110
**END**
**END**

